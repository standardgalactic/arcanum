Ï•
U Ã— W
(The same result holds for C
n and C
m). See Figure 39.8.
1436 CHAPTER 39. DIFFERENTIAL CALCULUS
f
a U
V
f(a)
A
f(U)
Ï†
U x W
W =
~ (0,1)
Figure 39.8: Let n = 2 and m = 3. The immersion maps the purple circular base of the
cylinder U Ã— W to circular cup on the surface of the solid purple gourd.
39.5 Tangent Spaces and Differentials
In this section, we discuss briefly a geometric interpretation of the notion of derivative. We
consider sets of points defined by a differentiable function. This is a special case of the notion
of a (differential) manifold.
Given two normed affine spaces E and F, let A be an open subset of E, and let f : A â†’ F
be a function.
Definition 39.10. Given f : A â†’ F as above, its graph Î“(f) is the set of all points
Î“(f) = {(x, y) âˆˆ E Ã— F | x âˆˆ A, y = f(x)}.
If Df is defined on A, we say that Î“(f) is a differential submanifold of E Ã— F of equation
y = f(x).
It should be noted that this is a very particular kind of differential manifold.
Example 39.9. If E = R and F = R
2
, letting f = (g, h), where g : R â†’ R and h: R â†’ R,
Î“(f) is a curve in R
3
, of equations y = g(x), z = h(x). When E = R
2 and F = R, Î“(f) is a
surface in R
3
, of equation z = f(x, y).
39.5. TANGENT SPACES AND DIFFERENTIALS 1437
We now define the notion of affine tangent space in a very general way. Next, we will see
what it means for manifolds Î“(f), as in Definition 39.10.
Definition 39.11. Given a normed affine space E, given any nonempty subset M of E,
given any point a âˆˆ M, we say that a vector u âˆˆ
âˆ’â†’E is tangent at a to M if there exist a
sequence (an)nâˆˆN of points in M converging to a, and a sequence (Î»n)nâˆˆN, with Î»i âˆˆ R and
Î»n â‰¥ 0, such that the sequence (Î»n(an âˆ’ a))nâˆˆN converges to u.
The set of all vectors tangent at a to M is called the family of tangent vectors at a to
M and the set of all points of E of the form a + u where u belongs to the family of tangent
vectors at a to M is called the affine tangent family at a to M.
Clearly, 0 is always tangent, and if u is tangent, then so is every Î»u, for Î» âˆˆ R, Î» â‰¥ 0. If
u 6 = 0, then the sequence (Î»n)nâˆˆN must tend towards +âˆ. We have the following proposition.
Proposition 39.18. Let E and F be two normed affine spaces, let A be an open subset of
E, let a âˆˆ A, and let f : A â†’ F be a function. If Df(a) exists, then the family of tangent
vectors at (a, f(a)) to Î“ is a subspace Ta(Î“) of âˆ’â†’E Ã—
âˆ’â†’F , defined by the condition (equation)
(u, v) âˆˆ Ta(Î“) iff v = Df(a)(u),
and the affine tangent family at (a, f(a)) to Î“ is an affine variety Ta(Î“) of E Ã— F, defined
by the condition (equation)
(x, y) âˆˆ Ta(Î“) iff y = f(a) + Df(a)(x âˆ’ a),
where Î“ is the graph of f.
The proof is actually rather simple. We have Ta(Î“) = a + Ta(Î“), and since Ta(Î“) is a
subspace of âˆ’â†’E Ã—
âˆ’â†’F , the set Ta(Î“) is an affine variety. Thus, the affine tangent space at a
point (a, f(a)) is a familar object, a line, a plane, etc.
As an illustration, when E = R
2 and F = R, the affine tangent plane at the point (a, b, c)
to the surface of equation z = f(x, y), is defined by the equation
z = c +
âˆ‚f
âˆ‚x(a, b)(x âˆ’ a) + âˆ‚f
âˆ‚y (a, b)(y âˆ’ b).
If E = R and F = R
2
, the tangent line at (a, b, c), to the curve of equations y = g(x),
z = h(x), is defined by the equations
y = b + Dg(a)(x âˆ’ a),
z = c + Dh(a)(x âˆ’ a).
Thus, derivatives and partial derivatives have the desired intended geometric interpretaï¿¾tion as tangent spaces. Of course, in order to deal with this topic properly, we really would
have to go deeper into the study of (differential) manifolds.
We now briefly consider second-order and higher-order derivatives.
1438 CHAPTER 39. DIFFERENTIAL CALCULUS
39.6 Second-Order and Higher-Order Derivatives
Given two normed affine spaces E and F, and some open subset A of E, if Df(a) is defined
for every a âˆˆ A, then we have a mapping Df : A â†’ L(
âˆ’â†’E ;
âˆ’â†’F ). Since L(
âˆ’â†’E ;
âˆ’â†’F ) is a normed
vector space, if Df exists on an open subset U of A containing a, we can consider taking the
derivative of Df at some a âˆˆ A.
Definition 39.12. Given a function f : A â†’ F defined on some open subset A of E
such that Df(a) is defined for every a âˆˆ A, If D(Df)(a) exists for every a âˆˆ A, we
get a mapping D2
f : A â†’ L(
âˆ’â†’E ;L(
âˆ’â†’E ;
âˆ’â†’F )) called the second derivative of f on A, where
D2
f(a) = D(Df)(a), for every a âˆˆ A.
As in the case of the first derivative Dfa where Dfa(u) = Duf(a), where Duf(a) is the
directional derivative of f at a in the direction u, it would be useful to express D2
f(a)(u)(v)
in terms of two directional derivatives. This can indeed be done. If D2
f(a) exists, then for
every u âˆˆ
âˆ’â†’E ,
D
2
f(a)(u) = D(Df)(a)(u) = Du(Df)(a) âˆˆ L(
âˆ’â†’E ;
âˆ’â†’F ).
We have the following result.
Proposition 39.19. If D2
f(a) exists, then Du(Dvf)(a) exists and
D
2
f(a)(u)(v) = Du(Dvf)(a), for all u, v âˆˆ
âˆ’â†’E .
Proof. Recall from Proposition 37.61, that the map app from L(
âˆ’â†’E ;
âˆ’â†’F ) Ã—
âˆ’â†’E to
âˆ’â†’F , defined
such that for every L âˆˆ L(
âˆ’â†’E ;
âˆ’â†’F ), for every v âˆˆ
âˆ’â†’E ,
app(L, v) = L(v),
is a continuous bilinear map. Thus, in particular, given a fixed v âˆˆ
âˆ’â†’E , the linear map
appv
: L(
âˆ’â†’E ;
âˆ’â†’F ) â†’
âˆ’â†’F , defined such that appv
(L) = L(v), is a continuous map.
Also recall from Proposition 39.7, that if h: A â†’ G is a function such that Dh(a) exits,
and k : G â†’ H is a continuous linear map, then, D(k â—¦ h)(a) exists, and
k(Dh(a)(u)) = D(k â—¦ h)(a)(u),
that is,
k(Duh(a)) = Du(k â—¦ h)(a),
Applying these two facts to h = Df, and to k = appv
, we have
Du(Df)(a)(v) = Du(appv â—¦ Df)(a).
But (appv â—¦ Df)(x) = Df(x)(v) = Dvf(x), for every x âˆˆ A, that is, appv â—¦ Df = Dvf on A.
So, we have
Du(Df)(a)(v) = Du(Dvf)(a),
39.6. SECOND-ORDER AND HIGHER-ORDER DERIVATIVES 1439
and since D2
f(a)(u) = Du(Df)(a), we get
D
2
f(a)(u)(v) = Du(Dvf)(a).
Thus, when D2
f(a) exists, Du(Dvf)(a) exists, and
D
2
f(a)(u)(v) = Du(Dvf)(a),
for all u, v âˆˆ
âˆ’â†’E .
Definition 39.13. We denote Du(Dvf)(a) by D2
u,vf(a) (or DuDvf(a)).
Recall from Proposition 37.60, that the map from L2(
âˆ’â†’E ,
âˆ’â†’E ;
âˆ’â†’F ) to L(
âˆ’â†’E ;L(
âˆ’â†’E ;
âˆ’â†’F )) de-
fined such that g 7â†’ Ï• iff for every g âˆˆ L2(
âˆ’â†’E ,
âˆ’â†’E ;
âˆ’â†’F ),
Ï•(u)(v) = g(u, v),
is an isomorphism of vector spaces. Thus, we will consider D2
f(a) âˆˆ L(
âˆ’â†’E ;L(
âˆ’â†’E ;
âˆ’â†’F ))
as a continuous bilinear map in L2(
âˆ’â†’E ,
âˆ’â†’E ;
âˆ’â†’F ), and we will write D2
f(a)(u, v), instead of
D2
f(a)(u)(v).
Then, the above discussion can be summarized by saying that when D2
f(a) is defined,
we have
D
2
f(a)(u, v) = DuDvf(a).
Definition 39.14. When E has finite dimension and (a0,(e1, . . . , en)) is a frame for E, we
denote DejDei
f(a) by âˆ‚
2
f
âˆ‚xiâˆ‚xj
(a), when i 6 = j, and we denote DeiDei
f(a) by âˆ‚
2
f
âˆ‚x2
i
(a).
The following important lemma attributed to Schwarz can be shown, using Proposition
39.12. Given a bilinear map f :
âˆ’â†’E Ã—
âˆ’â†’E â†’
âˆ’â†’F , recall that f is symmetric, if
f(u, v) = f(v, u),
for all u, v âˆˆ
âˆ’â†’E .
Proposition 39.20. (Schwarzâ€™s lemma) Given two normed affine spaces E and F, given
any open subset A of E, given any f : A â†’ F, for every a âˆˆ A, if D2
f(a) exists, then
D2
f(a) âˆˆ L2(
âˆ’â†’E ,
âˆ’â†’E ;
âˆ’â†’F ) is a continuous symmetric bilinear map. As a corollary, if E is of
finite dimension n, and (a0,(e1, . . . , en)) is a frame for E, we have
âˆ‚
2
f
âˆ‚xiâˆ‚xj
(a) = âˆ‚
2
f
âˆ‚xjâˆ‚xi
(a).
Remark: There is a variation of the above result which does not assume the existence of
D2
f(a), but instead assumes that DuDvf and DvDuf exist on an open subset containing a
and are continuous at a, and concludes that DuDvf(a) = DvDuf(a). This is just a different
result which does not imply Proposition 39.20, and is not a consequence of Proposition 39.20.
1440 CHAPTER 39. DIFFERENTIAL CALCULUS

When E = R
2
, the only existence of âˆ‚
2
f
âˆ‚xâˆ‚y (a) and âˆ‚
2
f
âˆ‚yâˆ‚x(a) is not sufficient to insure the
existence of D2
f(a).
When E if of finite dimension n and (a0,(e1, . . . , en)) is a frame for E, if D2
f(a) exists,
for every u = u1e1 + Â· Â· Â· + unen and v = v1e1 + Â· Â· Â· + vnen in
âˆ’â†’E , since D2
f(a) is a symmetric
bilinear form, we have
D
2
f(a)(u, v) =
nX
i=1,j=1
uivj
âˆ‚
2
f
âˆ‚xiâˆ‚xj
(a),
which can be written in matrix form as:
D
2
f(a)(u, v) = U
>
ï£«
ï£¬ï£¬ï£¬ï£¬ï£¬ï£¬ï£¬ï£¬ï£¬ï£¬ï£­
âˆ‚
2
f
âˆ‚x2
1
(a)
âˆ‚
2
f
âˆ‚x1âˆ‚x2
(a) . . .
âˆ‚
2
f
âˆ‚x1âˆ‚xn
(a)
âˆ‚
2
f
âˆ‚x1âˆ‚x2
(a)
âˆ‚
2
f
âˆ‚x2
2
(a) . . .
âˆ‚
2
f
âˆ‚x2âˆ‚xn
(a)
.
.
.
.
.
.
.
.
.
.
.
.
âˆ‚
2
f
âˆ‚x1âˆ‚xn
(a)
âˆ‚
2
f
âˆ‚x2âˆ‚xn
(a) . . .
âˆ‚
2
f
âˆ‚x2
n
(a)
ï£¶
ï£·ï£·ï£·ï£·ï£·ï£·ï£·ï£·ï£·ï£·ï£¸
V
where U is the column matrix representing u, and V is the column matrix representing v,
over the frame (a0,(e1, . . . , en)).
Definition 39.15. The above symmetric matrix is called the Hessian of f at a.
Example 39.10. Consider the function f defined on real invertible 2Ã—2 matrices such that
ad âˆ’ bc > 0 given by
f(a, b, c, d) = log(ad âˆ’ bc).
We immediately verify that the Jacobian matrix of f is given by
dfa,b,c,d =
ad âˆ’
1
bc
ï¿¾
d âˆ’c âˆ’b a .
It is easily checked that if
A =

a b
c d , X =

x1 x2
x3 x4

,
then
dfA(X) = tr(A
âˆ’1X) = 1
ad âˆ’ bctr 
âˆ’
d
c a
âˆ’b
  x1 x2
x3 x4

.
Computing second-order derivatives, we find that the Hessian matrix of f is given by
Hf(A) = 1
(ad âˆ’ bc)
2
ï£«
ï£¬ï£¬ï£­
âˆ’
cd
d
2
âˆ’
cd bd
c
2 âˆ’ad ac
âˆ’bc
âˆ’
bd
bc ac ab
âˆ’ad âˆ’b
2
âˆ’
ab
a
2
ï£¶
ï£·ï£·ï£¸ .
39.6. SECOND-ORDER AND HIGHER-ORDER DERIVATIVES 1441
Using the formula for the derivative of the inversion map and the chain rule we can show
that
D
2
f(A)(X1, X2) = âˆ’tr(A
âˆ’1X1A
âˆ’1X2),
and so
Hf(A)(X1, X2) = âˆ’tr(A
âˆ’1X1A
âˆ’1X2),
a formula which is far from obvious.
The function f can be generalized to matrices A âˆˆ GL+
(n, R), that is, nÃ—n real invertible
matrices of positive determinants, as
f(A) = log det(A).
It can be shown that the formulae
dfA(X) = tr(A
âˆ’1X)
D
2
f(A)(X1, X2) = âˆ’tr(A
âˆ’1X1A
âˆ’1X2)
also hold.
Example 39.11. If we restrict the function of Example 39.10 to symmetric positive definite
matrices we obtain the function g defined by
g(a, b, c) = log(ac âˆ’ b
2
).
We immediately verify that the Jacobian matrix of g is given by
dga,b,c =
ac âˆ’
1
b
2
ï¿¾
c âˆ’2b a .
Computing second-order derivatives, we find that the Hessian matrix of g is given by
Hg(a, b, c) = 1
(ac âˆ’ b
2
)
2
ï£«
ï£­
âˆ’c
2 2bc âˆ’b
2
2bc âˆ’2(b
2 + ac) 2ab
âˆ’b
2 2ab âˆ’a
2
ï£¶
ï£¸ .
Although this is not obvious, it can be shown that if ac âˆ’ b
2 > 0 and a, c > 0, then the
matrix âˆ’Hg(a, b, c) is symmetric positive definite.
If F itself is of finite dimension, and (b0,(v1, . . . , vm)) is a frame for F, then f =
(f1, . . . , fm), and each component D2
f(a)i(u, v) of D2
f(a)(u, v) (1 â‰¤ i â‰¤ m), can be written
as
D
2
f(a)i(u, v) = U
>
ï£«
ï£¬ï£¬ï£¬ï£¬ï£¬ï£¬ï£¬ï£¬ï£¬ï£¬ï£­
âˆ‚
2
fi
âˆ‚x2
1
(a)
âˆ‚
2
fi
âˆ‚x1âˆ‚x2
(a) . . .
âˆ‚
2
fi
âˆ‚x1âˆ‚xn
(a)
âˆ‚
2
fi
âˆ‚x1âˆ‚x2
(a)
âˆ‚
2
fi
âˆ‚x2
2
(a) . . .
âˆ‚
2
fi
âˆ‚x2âˆ‚xn
(a)
.
.
.
.
.
.
.
.
.
.
.
.
âˆ‚
2
fi
âˆ‚x1âˆ‚xn
(a)
âˆ‚
2
fi
âˆ‚x2âˆ‚xn
(a) . . .
âˆ‚
2
fi
âˆ‚x2
n
(a)
ï£¶
ï£·ï£·ï£·ï£·ï£·ï£·ï£·ï£·ï£·ï£·ï£¸
V
1442 CHAPTER 39. DIFFERENTIAL CALCULUS
Thus, we could describe the vector D2
f(a)(u, v) in terms of an mnÃ—mn-matrix consisting
of m diagonal blocks, which are the above Hessians, and the row matrix (U
> , . . . , U > ) (m
times) and the column matrix consisting of m copies of V .
We now indicate briefly how higher-order derivatives are defined. Let m â‰¥ 2. Given
a function f : A â†’ F as before, for any a âˆˆ A, if the derivatives Di
f exist on A for all
i, 1 â‰¤ i â‰¤ m âˆ’ 1, by induction, Dmâˆ’1
f can be considered to be a continuous function
Dmâˆ’1
f : A â†’ Lmâˆ’1(
âˆ’âˆ’âˆ’â†’
E
mâˆ’1
;
âˆ’â†’F ).
Definition 39.16. Define Dmf(a), the m-th derivative of f at a, as
D
mf(a) = D(Dmâˆ’1
f)(a).
Then Dmf(a) can be identified with a continuous m-multilinear map in Lm(
âˆ’â†’E
m;
âˆ’â†’F ). We
can then show (as we did before), that if Dmf(a) is defined, then
D
mf(a)(u1, . . . , um) = Du1
. . . Dumf(a).
Definition 39.17. When E if of finite dimension n and (a0,(e1, . . . , en)) is a frame for E,
if Dmf(a) exists, for every j1, . . . , jm âˆˆ {1, . . . , n}, we denote Dejm
. . . Dej1
f(a) by
âˆ‚
mf
âˆ‚xj1
. . . âˆ‚xjm
(a).
Example 39.12. Going back to the function f of Example 39.10 given by f(A) = log det(A),
using the formula for the derivative of the inversion map, the chain rule and the product
rule, we can show that
D
mf(A)(X1, . . . , Xm) = (âˆ’1)mâˆ’1 X
ÏƒâˆˆSmâˆ’1
tr(A
âˆ’1X1A
âˆ’1XÏƒ(1)+1A
âˆ’1XÏƒ(2)+1 Â· Â· Â· A
âˆ’1XÏƒ(mâˆ’1)+1)
for any m â‰¥ 1, where A âˆˆ GL+
(n, R) and X1, . . . Xm are any n Ã— n real matrices.
Given a m-multilinear map f âˆˆ Lm(
âˆ’â†’E
m;
âˆ’â†’F ), recall that f is symmetric if
f(uÏ€(1), . . . , uÏ€(m)) = f(u1, . . . , um),
for all u1, . . . , um âˆˆ
âˆ’â†’E , and all permutations Ï€ on {1, . . . , m}. Then, the following generalï¿¾ization of Schwarzâ€™s lemma holds.
Proposition 39.21. Given two normed affine spaces E and F, given any open subset A
of E, given any f : A â†’ F, for every a âˆˆ A, for every m â‰¥ 1, if Dmf(a) exists, then
Dmf(a) âˆˆ Lm(
âˆ’â†’E
m;
âˆ’â†’F ) is a continuous symmetric m-multilinear map. As a corollary, if E
is of finite dimension n, and (a0,(e1, . . . , en)) is a frame for E, we have
âˆ‚
mf
âˆ‚xj1
. . . âˆ‚xjm
(a) = âˆ‚
mf
âˆ‚xÏ€(j1)
. . . âˆ‚xÏ€(jm)
(a),
for every j1, . . . , jm âˆˆ {1, . . . , n}, and for every permutation Ï€ on {1, . . . , m}.
39.6. SECOND-ORDER AND HIGHER-ORDER DERIVATIVES 1443
Because the trace function is invariant under permutation of its arguments (tr(XY ) =
tr(Y X)), we see that the m-th derivatives in Example 39.12 are indeed symmetric multilinear
maps.
If E is of finite dimension n, and (a0,(e1, . . . , en)) is a frame for E, Dmf(a) is a symmetric
m-multilinear map, and we have
D
mf(a)(u1, . . . , um) = X
j
u1,j1
Â· Â· Â· um,jm
âˆ‚
mf
âˆ‚xj1
. . . âˆ‚xjm
(a),
where j ranges over all functions j : {1, . . . , m} â†’ {1, . . . , n}, for any m vectors
uj = uj,1e1 + Â· Â· Â· + uj,nen.
The concept of C
1
-function is generalized to the concept of C
m-function, and Theorem
39.13 can also be generalized.
Definition 39.18. Given two normed affine spaces E and F, and an open subset A of E,
for any m â‰¥ 1, we say that a function f : A â†’ F is of class C
m on A or a C
m-function on
A if Dk
f exists and is continuous on A for every k, 1 â‰¤ k â‰¤ m. We say that f : A â†’ F
is of class C
âˆ on A or a C
âˆ-function on A if Dk
f exists and is continuous on A for every
k â‰¥ 1. A C
âˆ-function (on A) is also called a smooth function (on A). A C
m-diffeomorphism
f : A â†’ B between A and B (where A is an open subset of E and B is an open subset
of B) is a bijection between A and B = f(A), such that both f : A â†’ B and its inverse
f
âˆ’1
: B â†’ A are C
m-functions.
Equivalently, f is a C
m-function on A if f is a C
1
-function on A and Df is a C
mâˆ’1
-
function on A.
We have the following theorem giving a necessary and sufficient condition for f to a
C
m-function on A. A generalization to the case where E = (E1, a1) âŠ• Â· Â· Â· âŠ• (En, an) also
holds.
Theorem 39.22. Given two normed affine spaces E and F, where E is of finite dimension
n, and where (a0,(u1, . . . , un)) is a frame of E, given any open subset A of E, given any
function f : A â†’ F, for any m â‰¥ 1, the derivative Dmf is a C
m-function on A iff every
partial derivative Dujk
. . . Duj1
f (or âˆ‚
k
f
âˆ‚xj1
. . . âˆ‚xjk
(a)) is defined and continuous on A, for all
k, 1 â‰¤ k â‰¤ m, and all j1, . . . , jk âˆˆ {1, . . . , n}. As a corollary, if F is of finite dimension p,
and (b0,(v1, . . . , vp)) is a frame of F, the derivative Dmf is defined and continuous on A iff
every partial derivative Dujk
. . . Duj1
fi (or âˆ‚
k
fi
âˆ‚xj1
. . . âˆ‚xjk
(a)) is defined and continuous on A,
for all k, 1 â‰¤ k â‰¤ m, for all i, 1 â‰¤ i â‰¤ p, and all j1, . . . , jk âˆˆ {1, . . . , n}.
Definition 39.19. When E = R (or E = C), for any a âˆˆ E, Dmf(a)(1, . . . , 1) is a vector
in
âˆ’â†’F , called the mth-order vector derivative. As in the case m = 1, we will usually identify
the multilinear map Dmf(a) with the vector Dmf(a)(1, . . . , 1).
1444 CHAPTER 39. DIFFERENTIAL CALCULUS
Some notational conventions can also be introduced to simplify the notation of higherï¿¾order derivatives, and we discuss such conventions very briefly.
Recall that when E is of finite dimension n, and (a0,(e1, . . . , en)) is a frame for E, Dmf(a)
is a symmetric m-multilinear map, and we have
D
mf(a)(u1, . . . , um) = X
j
u1,j1
Â· Â· Â· um,jm
âˆ‚
mf
âˆ‚xj1
. . . âˆ‚xjm
(a),
where j ranges over all functions j : {1, . . . , m} â†’ {1, . . . , n}, for any m vectors
uj = uj,1e1 + Â· Â· Â· + uj,nen.
We can then group the various occurrences of âˆ‚xjk
corresponding to the same variable xjk
,
and this leads to the notation

âˆ‚x
âˆ‚
1

Î±1

âˆ‚x
âˆ‚
2

Î±2
Â· Â· Â·  âˆ‚x
âˆ‚
n

Î±n
f(a),
where Î±1 + Î±2 + Â· Â· Â· + Î±n = m.
If we denote (Î±1, . . . , Î±n) simply by Î±, then we denote

âˆ‚x
âˆ‚
1

Î±1

âˆ‚x
âˆ‚
2

Î±2
Â· Â· Â·  âˆ‚x
âˆ‚
n

Î±n
f
by
âˆ‚
Î±
f, or  âˆ‚x
âˆ‚
 Î±
f.
If Î± = (Î±1, . . . , Î±n), we let |Î±| = Î±1 + Î±2 + Â· Â· Â· + Î±n, Î±! = Î±1! Â· Â· Â· Î±n!, and if h = (h1, . . . , hn),
we denote h
Î±
1
1
Â· Â· Â· h
Î±
n
n by h
Î±
.
In the next section, we survey various versions of Taylorâ€™s formula.
39.7 Taylorâ€™s formula, Fa`a di Brunoâ€™s formula
We discuss, without proofs, several versions of Taylorâ€™s formula. The hypotheses required in
each version become increasingly stronger. The first version can be viewed as a generalization
of the notion of derivative. Given an m-linear map f :
âˆ’â†’E
m â†’
âˆ’â†’F , for any vector h âˆˆ
âˆ’â†’E , we
abbreviate
f(h, . . . , h
|
{z
}
m
)
by f(h
m). The version of Taylorâ€™s formula given next is sometimes referred to as the formula
of Taylorâ€“Young.
39.7. TAYLORâ€™S FORMULA, FAA DI BRUNOâ€™S FORMULA ` 1445
Theorem 39.23. (Taylorâ€“Young) Given two normed affine spaces E and F, for any open
subset A âŠ† E, for any function f : A â†’ F, for any a âˆˆ A, if Dk
f exists in A for all k,
1 â‰¤ k â‰¤ m âˆ’ 1, and if Dmf(a) exists, then we have:
f(a + h) = f(a) + 1
1!D
1
f(a)(h) + Â· Â· Â· +
1
m!
D
mf(a)(h
m) + k hk
m (h),
for any h such that a + h âˆˆ A, and where limhâ†’0, h6=0  (h) = 0.
The above version of Taylorâ€™s formula has applications to the study of relative maxima
(or minima) of real-valued functions. It is also used to study the local properties of curves
and surfaces.
The next version of Taylorâ€™s formula can be viewed as a generalization of Proposition
39.12. It is sometimes called the Taylor formula with Lagrange remainder or generalized
mean value theorem.
Theorem 39.24. (Generalized mean value theorem) Let E and F be two normed affine
spaces, let A be an open subset of E, and let f : A â†’ F be a function on A. Given any
a âˆˆ A and any h 6 = 0 in
âˆ’â†’E , if the closed segment [a, a + h] is contained in A, Dk
f exists in
A for all k, 1 â‰¤ k â‰¤ m, Dm+1f(x) exists at every point x of the open segment ]a, a + h[, and
max
xâˆˆ(a,a+h)


D
m+1f(x)
 â‰¤ M,
for some M â‰¥ 0, then




f(a + h) âˆ’ f(a) âˆ’

1!
1
D
1
f(a)(h) + Â· Â· Â· +
m
1
!
D
mf(a)(h
m)


 
 â‰¤ M
k
hk
m+1
(m + 1)!.
As a corollary, if L:
âˆ’âˆ’âˆ’â†’
E
m+1 â†’
âˆ’â†’F is a continuous (m + 1)-linear map, then




f(a + h) âˆ’ f(a) âˆ’

1!
1
D
1
f(a)(h) + Â· Â· Â· +
m
1
!
D
mf(a)(h
m) + L(h
m+1)
(m + 1)!



  â‰¤ M
k
hk
m+1
(m + 1)!,
where M = maxxâˆˆ(a,a+h) k Dm+1f(x) âˆ’ Lk .
The above theorem is sometimes stated under the slightly stronger assumption that f is
a C
m-function on A. If f : A â†’ R is a real-valued function, Theorem 39.24 can be refined a
little bit. This version is often called the formula of Taylorâ€“MacLaurin.
Theorem 39.25. (Taylorâ€“MacLaurin) Let E be a normed affine space, let A be an open
subset of E, and let f : A â†’ R be a real-valued function on A. Given any a âˆˆ A and any
h 6 = 0 in
âˆ’â†’E , if the closed segment [a, a + h] is contained in A, if Dk
f exists in A for all k,
1 â‰¤ k â‰¤ m, and Dm+1f(x) exists at every point x of the open segment ]a, a + h[, then there
is some Î¸ âˆˆ R, with 0 < Î¸ < 1, such that
f(a + h) = f(a) + 1
1!D
1
f(a)(h) + Â· Â· Â· +
1
m!
D
mf(a)(h
m) + 1
(m + 1)!D
m+1f(a + Î¸h)(h
m+1).
1446 CHAPTER 39. DIFFERENTIAL CALCULUS
Example 39.13. Going back to the function f of Example 39.10 given by f(A) = log det(A),
we know from Example 39.12 that
D
mf(A)(X1, . . . , Xm) = (âˆ’1)mâˆ’1 X
ÏƒâˆˆSmâˆ’1
tr(A
âˆ’1X1A
âˆ’1XÏƒ(1)+1 Â· Â· Â· A
âˆ’1XÏƒ(mâˆ’1)+1) (âˆ—)
for all m â‰¥ 1, with A âˆˆ GL+
(n, R). If we make the stronger assumption that A is symmetric
positive definite, then for any other symmetric positive definite matrix B, since the symmetric
positive definite matrices form a convex set, the matrices A + Î¸(B âˆ’ A) = (1 âˆ’ Î¸)A + Î¸B are
also symmetric positive definite for Î¸ âˆˆ [0, 1]. Theorem 39.25 applies with H = B âˆ’ A (a
symmetric matrix), and using (âˆ—), we obtain
log det(A + H) = log det(A) + tr  A
âˆ’1H âˆ’
1
2
(A
âˆ’1H)
2 + Â· Â· Â· +
(âˆ’1)mâˆ’1
m
(A
âˆ’1H)
m
+
(âˆ’1)m
m + 1
((A + Î¸H)
âˆ’1H)
m+1
,
for some Î¸ such that 0 < Î¸ < 1. In particular, if A = I, for any symmetric matrix H such
that I + H is symmetric positive definite, we obtain
log det(I + H) = tr  H âˆ’
1
2
H
2 + Â· Â· Â· +
(âˆ’1)mâˆ’1
m
H
m
+
(âˆ’1)m
m + 1
((I + Î¸H)
âˆ’1H)
m+1
,
for some Î¸ such that 0 < Î¸ < 1. In the special case when n = 1, we have I = 1, H is a real
such that 1 + H > 0 and the trace function is the identity, so we recognize the partial sum
of the series for x 7â†’ log(1 + x),
log(1 + H) = H âˆ’
1
2
H
2 + Â· Â· Â· +
(âˆ’1)mâˆ’1
m
H
m
+
(âˆ’1)m
m + 1
(1 + Î¸H)
âˆ’(m+1)H
m+1
.
We also mention for â€œmathematical culture,â€ a version with integral remainder, in the
case of a real-valued function. This is usually called Taylorâ€™s formula with integral remainder .
Theorem 39.26. (Taylorâ€™s formula with integral remainder) Let E be a normed affine space,
let A be an open subset of E, and let f : A â†’ R be a real-valued function on A. Given any
a âˆˆ A and any h 6 = 0 in
âˆ’â†’E , if the closed segment [a, a + h] is contained in A, and if f is a
C
m+1-function on A, then we have
f(a + h) = f(a) + 1
1!D
1
f(a)(h) + Â· Â· Â· +
1
m!
D
mf(a)(h
m)
+
Z
1
0
(1 âˆ’ t)
m
m!
h
D
m+1f(a + th)(h
m+1)
