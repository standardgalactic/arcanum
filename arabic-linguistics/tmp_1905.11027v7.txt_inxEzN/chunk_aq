2 log |diag (σ) | −1
2θ⊺diag
 1
σ

θ

dθ
= D
2 log 2π + 1
2 log |diag (σ) |.
The third (last) term on the RHS is
−log
Z
M
κ(θ) exp

−N
2 (θ −ˆθ)⊺J(ˆθ)(θ −ˆθ)

dθ
= −log
Z
M
exp

−1
2θ⊺diag
 1
σ

θ −N
2 (θ −ˆθ)⊺J(ˆθ)(θ −ˆθ)

dθ
= −log
Z
M
exp

−1
2θ⊺Aθ + b⊺θ + c

dθ,
where
A = NJ(ˆθ) + diag
 1
σ

≻0,
b = NJ(ˆθ)ˆθ,
c = −N
2
ˆθ⊺J(ˆθ)ˆθ.
Then,
−log
Z
M
κ(θ) exp

−N
2 (θ −ˆθ)⊺J(ˆθ)(θ −ˆθ)

dθ
= −log
Z
M
exp

−1
2(θ −¯θ)⊺A(θ −¯θ) + c + 1
2
¯θ⊺A¯θ

dθ
= −D
2 log 2π + 1
2 log |A| −c −1
2
¯θ⊺A¯θ
−log
Z
M
exp

−D
2 log 2π + 1
2 log |A| −1
2(θ −¯θ)⊺A(θ −¯θ)

dθ
= −D
2 log 2π + 1
2 log |A| −c −1
2
¯θ⊺A¯θ,
21

where A¯θ = b. To sum up,
OG = −log p(X | ˆθ) + D
