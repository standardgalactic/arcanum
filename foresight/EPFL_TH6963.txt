POUR L'OBTENTION DU GRADE DE DOCTEUR ÈS SCIENCES
acceptée sur proposition du jury:
Prof. D. Van De Ville, président du jury
Prof. R. Gruetter, Dr G. Krüger, directeurs de thèse
Dr M. Zaitsev, rapporteur
Prof. M. Stuber, rapporteur
Prof. J.-Ph. Thiran, rapporteur
Motion Correction in Magnetic Resonance Imaging Using the 
Signal of Free-Induction-Decay
THÈSE NO 6963 (2016)
ÉCOLE POLYTECHNIQUE FÉDÉRALE DE LAUSANNE
PRÉSENTÉE LE 6 JUIN 2016
À LA FACULTÉ DES SCIENCES DE BASE
LABORATOIRE LEENAARDS-JEANTET D'IMAGERIE FONCTIONNELLE ET MÉTABOLIQUE
PROGRAMME DOCTORAL EN GÉNIE ÉLECTRIQUE 
Suisse
2016
PAR
Maryna Volodimirivna WASZAK


Für alle Bären dieser Welt.


Acknowledgement
From Alessandro Daducci I got the one important peace of information that there might be
an open PhD position at the so called ’Siemens group’ at the CIBM if not because of him I
would have never known and of course have never written to Gunnar Krueger asking about
that opportunity - thank you Alessandro for that. Gunnar Krueger was very fast at replying to
my request and we met already only couple of days later. He invited me to come to introduce
myself at a group meeting and a month later I have started to work on this project. Gunnar
was very supportive in most of my ideas during this work but also guided me through them
such that I wouldn’t loose my focus. I would like to also thank Tobias Kober for showing to me
how to operate the scanner and the art of IDEA programming and introducing me to the world
of motion correction. I am grateful to you, Bénédicte Maréchal, for being such a great role
model – a woman, mother, an engineer and a successful researcher - I hope I will be able to
reach up to your standards. Thanks to you Alexis Roche I am now a bit more knowledgeable in
statistics and know that there is more in life reaching signiﬁcance. Tom Hilbert, you helped me
during my ﬁrst steps in ICE programming and were always there when I had troubles accessing
the servers. Moreover, your head was the best for testing my motion correction sequence I
wished all subjects’ heads were more like yours. Cristina Granziera – you introduced me to
the delicious Italian wines and cuisine and also entrusted me to watch over your wonderful
daughters. Pavel Falkovskiy, I could always rely on you when it came to the numerous tests of
our motion correction sequence. It is a pleasure to know you as colleague and a friend. Davide
Piccini through you I learned that there are more body parts that can be visualized by MRI.
Thank you for your efforts of fostering collaboration between the ’cardiac people’ and the
’Siemens group’ by organizing the cross team meetings. Guillaume Bonnier you have shared
your precious patient data with me, thank you for listening to my motion correction problems.
You had always some suggestions which were out of the box. Thank you Kieran O’Brien for
being a constant motivation to do some sports during the lunch breaks and healthy eating
culture. Mário João Oliveira, thank you for being such a patient colleague and subject. You
never said no to a scan although I never managed to run my sequence on you. Pascal Forny
and Théo Galy–Fajou, you were not only great interns but also awesome subjects even though
I sometimes had problems ﬁtting all your hair Théo into the head coil :).
I am grateful to you, Rolf Gruetter, for kindly agreeing to be my thesis director even though
your time is scarce through having to look after so many PhD students. Thank you Reto Meuli
for not only providing the funds for this work but also together with Malik Babaker and Frank
Tobalem the expertise in advising me from a medical perspective. Meritxell Bach, I would like
i

Acknowledgements
to thank you for sharing your expertise on how to write an ethics application and getting it
approved easily.
Alexander Loktyushin, I would like to thank you for our great collaboration. I enjoyed
working with you. That is how science can be great fun when it allows to meet people like you.
Dylan Tisdall and Andre van der Kouwe, it was a great pleasure discussing with you one of my
projects. I am grateful to you for sharing your experience with me.
Michael Herbst, Maxim Zaitsev, and Benjamin Knowles thank you guys for our fruitful
collaboration. I always enjoyed coming to your site in Freiburg.
Onur Afacan, Burak Erem it was fun collaborating with you. I hope our project will be
continued also after my graduation.
Last but not least I would like to thank my husband, friend and life companion Sebastian
Waszak.
Lausanne, March 6, 2016
M. W.
ii

Abstract
Magnetic resonance imaging (MRI) is highly susceptible to subject’s motion and can signiﬁ-
cantly degrade image quality. In brain MRI exams, involuntary head movements can affect the
sampled k-space data. Such unintended alterations may result in visible image artifacts such
as blurring, ghosting and others, and therefore potentially disqualify the image from diagnostic
purposes. Methods to characterize motion in order to mitigate its impact on image quality
exist and range from MR sequence based techniques to scanner independent tracking systems.
Although, many motion detection and correction strategies have been proposed in the past, a
universal solution to the problem does not exist yet. The work of this thesis was focused on the
exploitation of the motion information from a multi-channel Free Induction Decay Navigator
(FID) to develop and to optimize motion detection and correction methods in structural brain
MRI. After a short introduction to the motion problem in MRI the fundamental methodology
behind FID based motion detection is presented and used in this thesis. Considerable work
has already been done in the ﬁeld of motion correction for MRI that is summarized by review-
ing the most recent literature, which allowed to reveal some pitfalls in the present approaches
and to demonstrate the motivation behind an FID-based method for motion correction in
MRI. The ﬁrst study was conducted to demonstrate that substantial motion information is
contained in the multi-channel FID signal, whereby the FID signal is correlated with motion
parameters that were obtained from a highly accurate optical tracking system. This work was
able to conﬁrm the theoretical foundations from the Biot-Savart law, however, also revealed
that a pure FID-based method is not sufﬁcient to exactly calculate the underlying motion
trajectory. It is speculated that scanner and subject related information might lead to a closed
form solution, yet it was not possible to derive one due to a high dimensionality of the motion
problem. Therefore, two alternative approaches were developed to utilize the FID signal for
motion detection and correction in MRI. First, a prospective motion correction strategy for an
MP-RAGE sequence is demonstrated, whereby the FID signal is used to trigger a prospective
motion correction mechanism. The second alternative approach describes how the FID signal
can be used to evaluate the quality of an already acquired image and how the FID signal can
be used as an optimizer for an autofocusing based retrospective motion correction technique.
Key words: Structural MRI, FID navigator, motion detection, motion correction
iii


Zusammenfassung
Magnetresonanztomographie (MRT) ist sehr anfällig für Bewegung, wodurch die Bildquali-
tät erheblich beeinträchtigt werden kann. Unwillkürliche Kopfbewegungen während einer
MRT-Untersuchungen können sich negativ auf die gesammelten Daten auswirken. Solche
unbeabsichtigte Inkonsistenzen im k-Raum können als Bildartefakte wie Unschärfe oder
Geisterbilder in Erscheinung treten und das Bild von Diagnosezwecken disqualiﬁzieren. Me-
thoden, um Bewegung und ihre Auswirkungen auf die Bildqualität zu mindern, existieren
und reichen von MR basierten Techniken zu sequenz- und scannerunabhängigen Trackings-
systemen. Obwohl viele Bewegungserkennungs- und Korrekturstrategien in der Vergangen-
heit vorgeschlagen worden sind, ist eine universelle Lösung für das Problem noch nicht in
Sicht. Diese Arbeit konzentrierte sich auf die Ausschöpfung der Bewegungsinformation eines
Mehrkanal-FID-Navigators (FID) mit dem Ziel eine entsprechende Methode zu entwickeln,
um Bewegungserkennungs- und Korrekturverfahren in struktureller MRT zu optimieren. Nach
einer kurzen Einführung in die Problematik von Bewegung in der Magnetresonanztomo-
graphie, wird die Methodologie der FID-basierten Bewegungserkennung dargestellt, welche
dieser Arbeit zur Grunde liegt. Substanzielle Arbeit auf dem Gebiet der Bewegungskorrek-
tur in der MRT wurde bereits durchgeführt, die wir durch eine Betrachtung der neuesten
Literatur sowie einiger erwähnenswerter, bereits etablierter Methoden präsentieren. Dies
ermöglichte einige Fallstricke in den vorliegenden Ansätzen zu offenbaren und die Motivation
für die Verwendung der FID-basierten Methode darzulegen. Um zu zeigen, dass beträchtli-
che Bewegungsinformation in dem Mehrkanal-FID-Signal enthalten ist, wurde eine Studie
durchgeführt, in der das FID-Signal mit Bewegungsparametern korreliert wurden, die von
einem hochgenauen optischen Trackingsystem stammen. Diese Studie hat es ermöglicht die
Theorie zu bestätigen, aber auch gezeigt, dass nur das FID-Signal alleine nicht ausreicht, um
die Bewegungsparameter exakt zu bestimmen. Es kann spekuliert werden, dass scanner- und
sequenzabhängige Informationen zu einer analytisch geschlossenen Lösung führen können,
aber es war noch nicht möglich solch eine Lösung zu präsentieren. Daher wurde untersucht
wie das FID-Signal auf eine andere Art verwendet werden kann, um Bewegung in der MRT
zu detektieren und zu korrigieren. Es wurde eine prospektive Bewegungskorrekturstrategie
für eine MP-RAGE-Sequenz vorgeschlagen, wo die FID-Signale verwendet werden, um einen
Bewegungskorrekturmechanismus zu triggern. In einem anderen Ansatz wird vorgeschlagen
die FID-Signals als Qualitätsmaß für bereits akquirierte Bilder zu verwenden. Ausserdem
konnte gezeigt werden, dass das FID-Signal auch zur Optimierung eines retrospektiven Bewe-
gungskorrekturverfahren verwendet werden kann.
v

Acknowledgements
Stichwörter: Strukturelle MRT, FID-Navigator, Bewegungsdetektion, Bewegungskorrektur
vi

Contents
Acknowledgement
i
Abstract (English/Deutsch)
iii
Contents
vii
List of ﬁgures
xi
List of tables
xiii
1
Preface
1
1.1
Objectives and Overview of this Thesis
. . . . . . . . . . . . . . . . . . . . . . . .
1
1.2
Main Contributions . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .
2
2
Introduction
3
2.1
Free Induction Decay and Motion . . . . . . . . . . . . . . . . . . . . . . . . . . .
3
2.2
Motion Effects in Magnetic Resonance Imaging . . . . . . . . . . . . . . . . . . .
5
2.3
Clinical Impact of Motion in MRI . . . . . . . . . . . . . . . . . . . . . . . . . . . .
6
3
State of the Art and Problem Statement
7
3.1
Prospective Motion Correction . . . . . . . . . . . . . . . . . . . . . . . . . . . . .
8
3.2
Retrospective Motion Correction . . . . . . . . . . . . . . . . . . . . . . . . . . . .
10
3.3
Problem Statement and Motivation . . . . . . . . . . . . . . . . . . . . . . . . . .
11
4
Accuracy and Precision of Head Motion Information in Multi-Channel Free Induc-
tion Decay Navigators for Magnetic Resonance Imaging
13
4.1
Introduction . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .
14
4.2
Methods . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .
15
4.2.1
Motion and FID Signals . . . . . . . . . . . . . . . . . . . . . . . . . . . . .
15
4.2.2
Experimental Set-Up and Data Acquisition . . . . . . . . . . . . . . . . . .
17
4.3
Results . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .
18
4.3.1
FID Navigator Signal-to-Noise Ratio and Steady-State . . . . . . . . . . .
18
4.3.2
Accuracy and Precision of Motion Prediction Based on FID Navigator Data 19
4.3.3
FID Navigator Signal Stability . . . . . . . . . . . . . . . . . . . . . . . . . .
21
vii

Contents
4.3.4
The Ability of the Linear Model to Extrapolate Between Different Motion
Types . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .
23
4.3.5
Minimal Training Data Requirements . . . . . . . . . . . . . . . . . . . . .
25
4.3.6
Inter-Scan and Inter-Subject Model Differences . . . . . . . . . . . . . . .
27
4.4
Discussion . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .
28
4.4.1
Prediction Accuracy of the Multi-Channel FID Navigator
. . . . . . . . .
28
4.4.2
FID Navigator Signal Stability . . . . . . . . . . . . . . . . . . . . . . . . . .
29
4.4.3
Advantages and Limitations of the FID Navigator Approach . . . . . . . .
29
4.4.4
Future Work . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .
31
4.5
Acknowledgement
. . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .
32
5
FID-based Motion Sensitive Quality Metric and Retrospective Motion Correction for
Clinical Magnetic Resonance Images
33
5.1
Introduction . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .
33
5.2
Methods . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .
35
5.2.1
Data Acquisition
. . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .
35
5.2.2
Retrospective Motion Correction . . . . . . . . . . . . . . . . . . . . . . . .
35
5.2.3
Qualitative Image Quality Assessment . . . . . . . . . . . . . . . . . . . . .
36
5.2.4
FID-Based Motion Detection . . . . . . . . . . . . . . . . . . . . . . . . . .
37
5.3
Results . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .
39
5.3.1
Prevalence and Nature of Motion Artifacts in the Collected Data . . . . .
39
5.3.2
Image Quality Before and After Correction . . . . . . . . . . . . . . . . . .
39
5.3.3
FIDnav Based Quality Metric Design
. . . . . . . . . . . . . . . . . . . . .
40
5.3.4
FIDnav Based Motion Classiﬁcation Based on k-space Location . . . . .
44
5.4
Discussion . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .
45
5.4.1
Advantages and Limitations of the Utilized Motion Correction . . . . . .
45
5.4.2
Advantages and Limitations of FIDnav-Based Motion Detection . . . . .
46
5.4.3
Future Work . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .
47
5.5
Acknowledgement
. . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .
47
6
Prospective Head Motion Correction with FID-Triggered Image Navigators
49
6.1
Introduction . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .
49
6.2
Methods . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .
51
6.2.1
FIDnav Acquisition and Calculation . . . . . . . . . . . . . . . . . . . . . .
51
6.2.2
MP-RAGE Data Acquisition and Experimental Design
. . . . . . . . . . .
53
6.2.3
IMGnav Acquisition and Image Registration Accuracy . . . . . . . . . . .
54
6.2.4
Quantitative Image Quality Assessment . . . . . . . . . . . . . . . . . . . .
56
6.3
Results . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .
57
6.3.1
IMGnav and Its Registration Accuracy . . . . . . . . . . . . . . . . . . . . .
57
6.3.2
FIDnav, Triggering Events, and Detected Motion
. . . . . . . . . . . . . .
58
6.3.3
Quantitative Assessment of Image Quality Improvements after Motion
Correction . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .
63
6.3.4
Effect of Reacquisition on Image Quality . . . . . . . . . . . . . . . . . . .
64
viii

Contents
6.4
Discussion . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .
65
6.4.1
Registration Accuracy of IMGnav . . . . . . . . . . . . . . . . . . . . . . . .
65
6.4.2
FIDnav Triggered Motion Detection and Correction
. . . . . . . . . . . .
66
6.4.3
Advantages and Limitation of the Proposed Motion Correction Method .
67
6.4.4
Future Work . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .
68
6.5
Acknowledgement
. . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .
68
7
Host Sequence Inﬂuence on FID Signal
69
8
Outlook and Conclusion
73
8.1
Direction for Future Research . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .
75
8.2
Conclusion . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .
77
Bibliography
85
Curriculum Vitae
87
Publications
89
ix


List of Figures
2.1
FID navigator signal formation . . . . . . . . . . . . . . . . . . . . . . . . . . . . .
4
2.2
Multi-channel head coil and symbolic depiction of FID signal reacting to motion
4
2.3
Effect of motion on image quality
. . . . . . . . . . . . . . . . . . . . . . . . . . .
5
3.1
Publication trend over the past years
. . . . . . . . . . . . . . . . . . . . . . . . .
8
3.2
Overview of external hardware based correction methods . . . . . . . . . . . . .
9
3.3
Overview of MR based correction methods . . . . . . . . . . . . . . . . . . . . . .
9
3.4
Overview of retrospective correction methods based on dedicated sampling
strategies . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .
10
4.1
FID signal steady-state . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .
20
4.2
Translational and rotational motion parameters as captured by the camera
system from a subject scan
. . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .
21
4.3
Accuracy and precision of FID based motion prediction . . . . . . . . . . . . . .
22
4.4
Correlation plot of FID predicted vs. true motion parameters . . . . . . . . . . .
22
4.5
Motion prediction error for all subjects and scans individually . . . . . . . . . .
23
4.6
FID navigator signal from a subject at rest and a phantom . . . . . . . . . . . . .
24
4.7
Closed up depiction of FID predicted breathing motion . . . . . . . . . . . . . .
25
4.8
Training and validation blocks
. . . . . . . . . . . . . . . . . . . . . . . . . . . . .
26
4.9
Prediction error for different motions patterns for training . . . . . . . . . . . . .
26
4.10 Prediction reliability for different training data (number of samples, motion
magnitudes) . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .
27
5.1
Motion artifact prevalence in clinical data
. . . . . . . . . . . . . . . . . . . . . .
39
5.2
Expert rating results of clinical data . . . . . . . . . . . . . . . . . . . . . . . . . .
40
5.3
Retrospective motion correction results of clinical data
. . . . . . . . . . . . . .
41
5.4
FID signal change for different motion severity
. . . . . . . . . . . . . . . . . . .
42
5.5
ROC curves for different FID based motion detectors . . . . . . . . . . . . . . . .
42
5.6
ROC curves for FID signal standard deviation when used as motion detector . .
43
5.7
ROC curves for different modiﬁcations of and FID based detector . . . . . . . .
44
5.8
ROC curves for FID-based motion detectors with different k-space location
weightings . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .
45
5.9
Logistic regression for FIDI . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .
45
5.10 FIDI and QI with their respective thresholds . . . . . . . . . . . . . . . . . . . . .
46
xi

List of Figures
6.1
Symbolic depiction of the proposed prospective motion correction strategy . .
54
6.2
IMGnav acquisition pattern . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .
55
6.3
IMGnav and its registration reliability . . . . . . . . . . . . . . . . . . . . . . . . .
57
6.4
Different FID navigators with detected motion events
. . . . . . . . . . . . . . .
59
6.5
Prospective motion correction results from experiment A . . . . . . . . . . . . .
61
6.6
Prospective motion correction results from experiment B . . . . . . . . . . . . .
62
6.7
Quantitative evaluation of motion correction results . . . . . . . . . . . . . . . .
63
6.8
Image correction results with and without reacquisition . . . . . . . . . . . . . .
64
6.9
Quantitative motion correction results with and without reacquisition
. . . . .
64
7.1
FID navigator signal change inﬂuenced by the host sequence . . . . . . . . . . .
70
7.2
FIDnav signal magnitude change in a single coil element for a phantom and
human scan . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .
71
xii

List of Tables
4.1
Model input variants with and without the temporal component that have been
tested. . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .
16
4.2
Acquisition parameters. . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .
17
4.3
SNR and prediction power of the FIDnav. . . . . . . . . . . . . . . . . . . . . . . .
19
5.1
Data overview . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .
36
6.1
Data set acquisition variants
. . . . . . . . . . . . . . . . . . . . . . . . . . . . . .
55
6.2
Summary of all acquired data . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .
60
7.1
Acquisition parameters. . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .
70
xiii


1 Preface
1.1
Objectives and Overview of this Thesis
Magnetic resonance imaging (MRI) is widely used in clinics to visualize the human body
noninvasively. Although, this imaging modality has many advantages in comparison to other
techniques as X-ray, computed tomography or ultrasound it poses some challenges to the
clinical routine as well. One of the major limitation of the technique is its acquisition time and
with it the high susceptibility to subject motion. Motion during an MRI examination leads
to artifacts and may degrade the image quality to a non-diagnostic level. In this thesis it was
investigated how the problem of motion can be tackled for head scans with the use of a very
simple MR signal - the free induction decay (FID) when acquired with a multi-channel head
coil array. The structure of the thesis is as follows.
Chapter 1 provides an overview of the thesis and summarizes its main contributions.
Chapter 2 gives a general introduction. First, the FID signal is explained and how it can be
used as the so called multi-channel FID navigator. Second, the effect of motion in MRI
is described and lastly the problem of motion in clinical MRI is presented.
Chapter 3 reviews the literature in the ﬁeld of head motion correction in MRI and states the
current problems in the ﬁeld, which motivates the use of the FID navigator.
Chapter 4 describes the relationship between head motion and a multi-channel FID signal.
Here, the results of a study are presented where the multi-channel FID signals are
correlated with motion parameters from a highly accurate optical motion tracking
system.
Chapter 5 presents a use of the FID signal as means for detection of motion corrupted images.
An FID based image quality metric is proposed and its performance is validated on a
clinical data set where the images were rated by expert radiologist. Further, the results
of a retrospective motion correction method based on autofocusing combined with the
FID signal information are shown.
1

Chapter 1. Preface
Chapter 6 describes a technique for prospective motion correction utilizing the FID signal
for motion detection. The FID signal is used here to trigger the acquisition of a low
resolution imaging navigator for obtaining the motion parameters through image regis-
tration. Brain volume segmentation results as well as an automated quality index were
used as a quality metric for images before and after correction.
Chapter 7 presents a study on how the host sequence inﬂuences the FID-signal and what
implications it might have on FID based motion detection methods.
Chapter 8 summarizes the thesis and provides a conclusion and an outlook on future work
and investigations.
1.2
Main Contributions
The main contributions of this thesis are:
• Implementation of the FID navigator acquisition module in a gradient-echo and in an
MP-RAGE sequence.
• Demonstration of the relationship between head motion and a multi-channel FID signal.
Results were published in Babayeva et al. (2013) and Babayeva et al. (2015b).
• Investigation of the potential of the FID signal to be used for a retrospective motion
correction method based on autofocusing. Results were published in Babayeva et al.
(2014b) and Loktyushin et al. (2015a).
• Presentation of a novel use of the FID signal to derive a quality index for motion artifacts.
• Presentation and implementation of an FID-based prospective motion correction tech-
nique for MP-RAGE sequences. Results were published in Babayeva et al. (2014a) and
Babayeva et al. (2015a).
2

2 Introduction
In this chapter the necessary basics of magnetic resonance signal and image formation are
described. The focus is put on the topics which are considered relevant for understanding
the problem of motion in magnetic resonance imaging (MRI) as well as the free induction
decay (FID) signal as a tool to tackle it. For further reference and for a detailed description of
physical phenomena and notation behind MR physics the reference to the books by Haacke
et al. (1999) and McRobbie et al. (2006) is proposed.
2.1
Free Induction Decay and Motion
The free induction decay (FID) signal is the basic signal in MRI (Haacke et al., 1999). It is
created by ﬂipping the magnetization towards the transverse plane and is measured by a
receive coil which is sensitive to magnetization perpendicular to the main magnetic ﬁeld B0 of
the scanner. The strong B0 ﬁeld aligns the magnetic moment of the protons in the body of
a subject. To generate an MR signal, a pulse is generated by a radio frequency (RF) ﬁeld and
tuned to the resonance frequency of a proton. The RF pulse is brieﬂy applied forcing the nuclei
to ﬂip their spins. After the RF ﬁeld is turned off, the magnetization of the protons returns to
its initial state, where it aligns again with the B0 ﬁeld. This process is called relaxation and is
called the free induction decay. This signal can be measured again with an RF receive coil.
This transverse magnetization oscillates at the Larmor frequency and its magnitude decays
rapidly in form of an exponential as shown in Fig. 2.1.
In accordance with the Biot-Savart law the relationship between the magnetic ﬁeld B
generated by an electric current I in a thin wire is proportional to the position r as shown in
Eq. 2.1 (taken from Haacke et al. (1999)) with dl being the vector differential along the wire
and μ0 being the magnetic permeability constant. Or according to the principle of reciprocity
3

Chapter 2. Introduction
Figure 2.1: The FID signal can be picked up by an analog digital converter (ADC) which measures the voltage in
a receiver coil. The measured voltage magnitude decays with a T2∗damping. The FID signal is induced by an
excitation pulse also called radio frequency (RF) pulse.
the current in a wire is proportional to the magnetic ﬁeld.
B(r) = μ0
4π

wire
Idl×r
|r|3
(2.1)
When we apply the law of Biot-Savart to MR that means that the signal magnitude of
the FID depends on the distance of the measured object from the receiver coil element.
Nowadays, so called multi-channel coil arrays are used for MR imaging and with sufﬁciently
many coil elements positioned around the object of interest it should be theoretically possible
to determine the displacement of this object within the coil array.
(a)
(b)
Figure 2.2: a: A multi-channel head coil with 32 coil elements (courtesy of Siemens). b: FID signal changes with
respect to its position within a multi-channel coil array.
4

2.2. Motion Effects in Magnetic Resonance Imaging
2.2
Motion Effects in Magnetic Resonance Imaging
To obtain a spatially encoded MR image, one of the orthogonally oriented gradients alters the
static magnetic ﬁeld, such that the resonance frequency of the protons varies with position
and only protons in one layer (slice) are in resonance and can be ﬂipped by the RF ﬁeld. Shortly
after the RF excitation, another gradient is turned on. This induces a controlled dephasing
of the spins in a way that the precession phase of the proton spins is different at each line
of the slice. This gradient is the phase encoding gradient. A third gradient is responsible for
frequency encoding and makes the spins precess with different frequencies, such that again
only the signal from the ones in resonance can be detected by the RF coils. From here, the
origin of the MR signal can be recovered mathematically by means of its phase-frequency
relationship and transformed into image space by applying an inverse Fourier transform to
the acquired signal.
	B
	C
Figure 2.3: The effect of translational motion in the frequency encoding head-feet direction on image quality of an
MP-RAGE sequence. a: motion free image b: translational motion causing blurring and ghosting artifacts in the
image
The described principle relies on the assumption that the imaged object is rigid and its
position does not change signiﬁcantly during the acquisition. However, an MR scan can
last from seconds to minutes, making this modality highly vulnerable to subject motion
(Malamateniou et al., 2013). Especially elderly patients and children have difﬁculties to remain
still throughout the procedure. Therefore, motion is the most common artifact cause in MRI
(Erasmus et al., 2004) leading to increased diagnosis costs and patient stress, due to necessary
repetition of the scan or even patient sedation.
5

Chapter 2. Introduction
As the ﬁnal image is created by an inverse Fourier transform of the raw data, where a
data point in image space corresponds to a weighted sum of all points in Fourier or k-space,
motion causes data inconsistencies. This means that alteration of one data point in k-space
results in changes of the whole image, manifesting themselves as image blurring, ghosting
or contrast changes (Wood and Henkelman, 1985) (Fig. 2.3). Consequently, many motion
correction strategies have been developed to minimize or eliminate motion artifacts. Besides
of bulk subject motion, physiologic motion (cardiac and respiratory motion, peristalsis etc.) is
another source of motion artifacts in MR imaging. However, the focus here is on correction of
bulk motion of the patient’s head.
2.3
Clinical Impact of Motion in MRI
Several extensive studies have been conducted to investigate the effect of motion in clinical
MRI. Especially elderly and pediatric patient cohorts often experience an elevated level of
distress and discomfort during the scan due to claustrophobia, anxiety and simply long scan
times. This might lead to agitation and patient motion during the data acquisition procedure
and affect the image quality such that a rescan or even patient sedation might be necessary.
In a study by (Maréchal et al., 2015) 764 clinical images have been reviewed by clinical
experts and 1.7% have been identiﬁed to be unusable. Another large multicenter study
reported that motion occurs in 40% of the medical examinations, in 10% being caused by
motoric unrest of the patient leading to severely impaired image quality (Oberstein et al.,
1990). Similar values of artifact occurrence in clinical MR scans were found in (Dantendorfer
et al., 1997) where 12.8% of the images were motion corrupted and 6.4% had a non-diagnostic
image quality. Thus, motion during MR examinations can be well considered to be the major
source of image artifacts with substantial ﬁnancial implications (Andre et al., 2015).
6

3 State of the Art and Problem State-
ment
Here, recently proposed motion correction techniques are reviewed based on published
literature and its advantages and disadvantages are discussed in order to reveal the motivation
behind the use of the FID signal to address the problem arising from bulk subject motion
during an MRI acquisition.
In the past decades the number of publications addressing or discussing the problem of
motion increased each year (see Fig. 3.1). The methods to mitigate motion artifacts range
from MR signal based techniques to scanner independent (external sensor-based) tracking
systems.
MR Signal Based Methods: Some sequence or acquisition-based methods sample the
center of k-space in a redundant fashion to reduce the effects of motion. Other sequence
dependent methods use so-called navigators, where additional MR signal, apart from imaging
data, is acquired and subsequently utilized to obtain positional information. This information
is used either prospectively to tie the scanner coordinate system to the subject during the
measurement in order to make the sequence robust against motion artifacts or retrospectively,
where the motion artifacts are corrected after acquisition. Most sequence-based techniques
have in common that they increase the already long acquisition time, which is undesirable in
a clinical context.
External Sensor-Based Techniques: External tracking systems are largely independent of
the imaging sequence, thus the acquisition time is not affected. However, the use of additional
hardware is needed, whose system components must be designed in an MR-compatible way,
making it an expensive method. Also, calibration and set-up of the system, i.e., positioning
of external markers, in the beginning of the scan may be an obstacle for the use in clinical
applications.
7

Chapter 3. State of the Art and Problem Statement
1987
1988
1989
1990
1991
1992
1993
1994
1995
1996
1997
1998
1999
2000
2001
2002
2003
2004
2005
2006
2007
2008
2009
2010
2011
2012
2013
2014
2015
Publication year
Number of publications
0
20
40
60
80
100
Figure 3.1: Number of publications by year as appeared on http://www.ncbi.nlm.nih.gov/pubmed (search was
performed with the keywords ’motion correction mri’ on Aug. 6th 2015). This list includes publications discussiong
rigid and non-rigid motion correction methods.
In the context of this thesis, we focus on structural brain imaging and for the purpose of
this thesis work the motion will be approximated as rigid and described with three transla-
tional and three rotational parameters. Depending on the type of motion, prospective or
retrospective correction strategies may be applied to reduce or to eliminate the artifacts.
Through-plane motion is more difﬁcult to compensate for and causes severe image distor-
tions, whereas in-plane motion is less demanding and can be even corrected with image
post-processing methods. The most adequate way to correct for through-plane motion is by
means of prospective motion correction techniques, where the gradient coordinate system
follows the moving subject during the whole acquisition.
3.1
Prospective Motion Correction
Prospective motion correction schemes are traditionally based on navigators (Tisdall et al.,
2012), inter-volume (Thesen et al., 2000) or inter-slice (Kim et al., 1999) image registration or
external tracking systems (Ooi et al., 2009; Peshkovsky et al., 2003; Qin et al., 2013). External
optical tracking devices, where a marker is attached to the patient’s head and is tracked by
a camera (Aksoy et al., 2011; Herbst et al., 2012; Zaitsev et al., 2006), have a good tracking
accuracy and can correct for motion in real-time (Fig. 3.2a and Fig. 3.2b). An external
system, based on miniature RF coils, was also proposed recently (Ooi et al., 2013). Here,
active markers in form of little coils are placed on the head of a patient and can be tracked
with the scanner receive coils and gradients (Fig. 3.2c). Another, recently proposed motion
8

3.1. Prospective Motion Correction
correction technology is using ﬁeld probes which are attached to subject’s head to track its
motion (Haeberlin et al., 2014) (Fig. 3.2d). Such systems provide sub millimeter accuracy and
very good tracking speed.
(a)
(b)
(c)
(d)
Figure 3.2: External motion correction tracking systems.a: In-bore camera and self-encoded marker (Aksoy et al.,
2011) b: Retro-reﬂective markers with mouth piece (Zaitsev et al., 2006) c: Active markers (Ooi et al., 2009) d: Field
probes (Haeberlin et al., 2014)
MR-signal based i.e., navigator techniques for prospective motion correction are also be-
coming increasingly popular and sophisticated. Numerous strategies with various complexity
of the navigator have been proposed during the past years (Alhamud et al., 2012; Tisdall
et al., 2012; White et al., 2010). Depending on its design, the navigator can provide different
information about the occurred motion. The simplest one is the FID navigator (Kober et al.,
2011), which monitors the center of k-space and is not spatially encoded. Nevertheless, this
signal contains motion information and can be used to identify motion corrupted images
and trigger a correction mechanism (Kober et al., 2012). The FID navigator was ﬁrst proposed
to reduce respiration- and system-induced B0 shifts (Hu and Kim, 1994; Pfeuffer et al., 2002)
and it was also used to correct for chest motion in abdominal acquisitions (Brau and Brittain,
2006). Spherical (Welch et al., 2002), Cloverleaf (van der Kouwe et al., 2006) or volumetric
navigators (Tisdall et al., 2012) are able to provide exact motion parameters for translation and
rotation and correct the coordinate system of the gradients for subsequent scans (Fig. 3.3).
Such navigators are acquired during the scan and can detect and quantify motion in real-time.
(a)
(b)
(c)
(d)
Figure 3.3: Navigator based motion tracking techniques. a: Spherical (Welch et al., 2002) b: Cloverleaf (van der
Kouwe et al., 2006) c: vNAV (Tisdall et al., 2012) d: PROMO (White et al., 2010)
9

Chapter 3. State of the Art and Problem Statement
3.2
Retrospective Motion Correction
Retrospective methods are applied after raw data acquisition during image reconstruction.
These correction schemes require information on the occurred motion, which is usually
delivered by the images themselves or based on some motion tracking mechanism during the
scan (e.g., navigators).
PROPELLER (Pipe, 1999) is a well-known self-navigating method and is routinely used in
clinical scans. It collects data in k-space on concentrically rotated strips (’blades’) of parallel
lines (Fig. 3.4a). The redundant k-space information from the center, holding most of the
image information, is exploited to conclude on the underlying motion to be able to correct for
it. Another technique uses spiral-shaped sampling of the k-space to offer robustness against
motion (Liao et al., 1997) (Fig. 3.4b). TRELLIS (Maclaren et al., 2008) uses a similar approach as
PROPELLER but it samples the k-space uniformly and uses the redundant parts of the ’blades’
to correct for motion before image reconstruction (Fig. 3.4c).
A different class of retrospective correction is based on autofocusing where chunks of
k-space data are adjusted such that an image based quality criterion i.e., cost-function is
optimized (Atkinson et al., 1999; Loktyushin et al., 2013). Such methods have the advantage of
not to require addition data and report adequate correction results for small motions. However,
their capability of correction for small motions is limited and the computation times are still
beyond clinical requirements.
(a)
(b)
(c)
Figure 3.4: Retrospective motion correction strategies using different k-space sampling trajectories to make the
acquisition more robust towards motion. a: PROPELLER (Pipe, 1999) b: SPIRAL (Liao et al., 1997) c: TRELLIS
(Maclaren et al., 2008)
10

3.3. Problem Statement and Motivation
3.3
Problem Statement and Motivation
Reducing motion sensitivity of MR imaging would be a great asset for clinical and research
applications, increasing the efﬁcacy of clinical studies as well as the patient throughput
by avoiding rescans of motion corrupted data sets. Even though many motion correction
strategies have been proposed and some of them are already used in clinical applications,
fundamental limitations remain and no ’one-size-ﬁts-all’ solution could yet be found (Zaitsev
et al., 2015).
Retrospective techniques as for example PROPELLER or TRELLIS approaches require long
scan times due to redundant data acquisition, which is undesirable for clinical use. Also,
retrospective correction techniques don’t allow for thru-plane motion correction, thus the
need for prospective strategies as MR sequence independent external tracking devices. They
require, however, additional hardware, which is usually expensive, as it has to meet clinical
standards and be able to operate at high magnetic ﬁeld strengths. In addition to that, when
a ﬁducial marker is used for tracking and placed on subject’s skin, skin slippage can be an
issue. Moreover, these approaches add to the complexity of an already elaborate MR scanner.
Navigators, on the other hand, do not rely on additional hardware, and with their use it is
possible to correct for motion prospectively. But still, additional scan time has to be sacriﬁced,
as more data needs to be acquired only for motion tracking.
In the context of structural brain MRI, little successful work has been done to compre-
hensively detect and correct for subject motion using the MR signal. This is despite the fact
that many of clinical scans are neuroimaging exams, most of them being structural MRI
exams. The reason for this mismatch is based on two aspects: a) structural brain scans are
performed with high spatial resolution (around 1 mm in-plane resolution or higher) and
motion characterization needs to provide a precision greater or equal to half of the voxel
dimension (Maclaren et al., 2013); b) the scan times are in the range of several minutes and
the object is not repetitively imaged as in other methods such as EPI. Hence, due to already
long acquisition times, additional scans for motion characterization are prohibitive in clinical
scenarios.
To meet the stringent MR sequence and imaging requirements on timing and accuracy, the
subject of this thesis is to explore in detail and to optimize a method for motion detection and
correction, which utilizes a multi-channel FID signal. An FID acquisition is unpretentious
in terms of timing requirements and can be easily added to any MR sequence, making it an
attractive solution for the motion problem. It has been recently shown that motion can be
reliably detected with an FID signal (Kober et al., 2011), however, no positional information
can be provided by this method without relying on other means to extract the underlying
motion parameters. Therefore, we propose to exploit the information of the FID signal when
acquired by a spatially distributed multi-channel coil array and also to explore other means of
obtaining the exact motion parameters.
11


4 Accuracy and Precision of Head Mo-
tion Information in Multi-Channel
Free Induction Decay Navigators for
Magnetic Resonance Imaging
This chapter was published in Babayeva et al. (2015b).
Abstract Free-induction-decay (FID) navigators were found to qualitatively detect rigid-body
head movements, yet it is unknown to what extent they can provide quantitative motion
estimates. Here, we acquired FID navigators at different sampling rates and measured
simultaneously head movements using a highly accurate optical motion tracking system.
This strategy allowed us to estimate the accuracy of FID navigators for quantiﬁcation of
rigid-body head movements. Five subjects were scanned with a 32-channel head coil ar-
ray on a clinical 3T MR scanner during several resting and guided head movement peri-
ods. For each subject we trained a linear regression model based on FID navigator and
optical motion tracking signals. FID-based motion model accuracy and precision was eval-
uated using cross-validation. FID-based prediction of rigid-body head motion was found
to be with a mean translational and rotational error of 0.14±0.21 mm and 0.08±0.13°, re-
spectively. Robust model training with sub-millimeter and sub-degree accuracy could be
achieved with 100 data points. The obtained linear models appeared to be subject-speciﬁc
as inter-subject application of a ’universal’ FID-based motion model resulted in weak pre-
diction accuracy. The results show that substantial rigid-body motion information is en-
coded in FID navigator signal time courses. Although the applied method currently requires
the simultaneous acquisition of FID signals and optical tracking data, the ﬁndings suggest
that multi-channel FID navigators have a potential to complement existing MR and camera
based tracking technology for accurate rigid-body motion detection and correction in MRI.
13

Chapter 4. Accuracy and Precision of Head Motion Information in Multi-Channel Free
Induction Decay Navigators for Magnetic Resonance Imaging
4.1
Introduction
Motion artifacts degrade the quality of MR images and may render them unsuitable for
diagnostic purposes or automated post-processing methods as in, for example, automated
brain segmentation (Maréchal et al., 2012). The implications of subject motion during an
MR examination have been extensively studied ((Ehman and Felmlee, 1989; Erasmus et al.,
2004; Gedamu and Gedamu, 2012; Malamateniou et al., 2013; Mortamet et al., 2009; Smith and
Nayak, 2010), among others). Intuitively, shortened acquisition times will reduce the likelihood
that motion occurs. However, despite substantial developments on faster acquisition methods,
sequence design and new reconstruction techniques during the past decades, scan times still
reach several minutes in clinical routine brain MRI protocols, leaving images susceptible to
motion artifacts. To address this problem, numerous methods have been proposed to track
subject motion and to reduce its consequential impact on image quality. These methods are
applied either retrospectively or prospectively.
One class of retrospective correction methods mitigates motion artifacts through dedicated
acquisition schemes (for example by oversampling the k-space center). These additional data
allow an estimation of motion parameters as performed in the PROPELLER method and its
variants (Johnson et al., 2011; Pipe, 1999). Such self-navigating techniques, however, reduce
scanning efﬁciency due to inherent oversampling. Other, image-based correction strategies
optimize a cost function which evaluates a speciﬁc image quality parameter (e.g., sharpness)
(Atkinson et al., 1997; Loktyushin et al., 2013; Manduca et al., 2000). Although these methods
do not require redundant sampling and report good correction results for small motion, they
have been shown to be of limited utility at greater motion amplitudes, have a high dependency
on the employed cost function (McGee et al., 2000) and require computation times which
are at present still beyond clinical requirements. Prospective motion correction schemes
present a more challenging task from an engineering viewpoint; however, these schemes are of
increasing popularity and have several advantages over retrospective techniques. They allow
for real-time adjustments of the scanner gradients and RF system, thus enabling consistent
sampling of the k-space in the presence of motion and suppress spin-history effects or signal
dropouts. Such correction strategies are either based on MR navigators (Alhamud et al., 2012;
Hess et al., 2011; Ordidge et al., 1994; Sachs et al., 1994; Thesen et al., 2000; Tisdall et al., 2012;
van der Kouwe et al., 2006; Welch et al., 2002; White et al., 2010) or external tracking systems
(Aksoy et al., 2011; Maclaren et al., 2012; Ooi et al., 2009; Peshkovsky et al., 2003; Qin et al.,
2013, 2009; Zaitsev et al., 2006).
Current optical tracking systems have been demonstrated to provide excellent precision in
the order of 10μm and 0.01° at high sampling rates (Qin et al., 2013), allowing for real-time
and sequence-independent motion correction of rigid-body motion. It is noteworthy that
all external tracking systems, however, require the integration of additional MR-compatible
hardware and need to perform reliably in clinical routine, especially when used for prospective
motion correction. Moreover, most of the currently existing MR-compatible optical tracking
systems are based on tracking a ﬁducial marker which must be physically attached to the
14

4.2. Methods
body. This may compromise the clinical workﬂow and pose problems with patients who do
not tolerate the markers. Additionally, any marker motion which is not correlated to the head
motion for example due to face mimics will lead to motion artifacts.
MR-based navigator techniques, on the other hand, do not require dedicated hardware but
use portions of the image data or acquire supplementary data to derive positional information
of the examined body part during the MR acquisition. Numerous navigator strategies have
been proposed during the past years that allow for the adjustment of the coordinate system of
the gradients and excitation pulses in real-time (Brau and Brittain, 2006; Hu and Kim, 1994;
Kober et al., 2012, 2011; Pfeuffer et al., 2002).
The simplest possible navigator acquisition is the free induction decay navigator (FIDnav),
which monitors the MR signal without any spatial encoding. It was originally proposed to
reduce B0-ﬁeld ﬂuctuations (Hu and Kim, 1994; Pfeuffer et al., 2002). It also proved useful
for shimming (Splitthoff and Zaitsev, 2009) and for improvements in abdominal acquisitions
(Brau and Brittain, 2006). Recently, the FID signals have been explored in more detail to
qualitatively detect motion events and trigger correction mechanisms if the observed FIDnav
signal exceeds an empirical threshold value (Babayeva et al., 2014a; Kober et al., 2012, 2011).
In this work, we investigate the accuracy and precision of positional information contained in
multi-channel FID navigators beyond the previously reported simple qualitative detection
schemes.
4.2
Methods
4.2.1
Motion and FID Signals
Today, multi-channel coil arrays are routinely used in clinical MR imaging. These coils offer
good coverage of the imaged object, enable the employment of parallel imaging strategies,
and provide increased signal-to-noise ratio due to the close proximity of the coil elements
to the object. We hypothesize that complex FID navigators (FIDnav) signal-time courses
acquired with a receive coil array with a large number of channels can be used for motion
tracking of a rigid body under the assumption of a sufﬁcient spatial coverage of the imaged
object. In the following experiments, we restrict our investigation to head imaging where the
motion can be assumed to be rigid. We postulate that head motion is systematically related to
changes in the multi-channel FIDnav signals. The position of the head in a three-dimensional
space is denoted as a response variable Y (t) ≡(Y1(t);Y2(t);...;Y6(t)) for three translational
and three rotational coordinates and different time points t = 1,2,...,T . The position can
be then expressed by a combination of FIDnav signals from different coil elements, i.e., the
explanatory variables with intercept as the ﬁrst entry X (t) ≡(X1(t); X2(t);...;XN(t)) where N
is the number of coil elements and Xc is the FIDnav signal as detected by a single coil element
c = 1,2,...,N. Hereby, the FIDnav signal at time t is a scalar value calculated from samples in
a single read-out.
15

Chapter 4. Accuracy and Precision of Head Motion Information in Multi-Channel Free
Induction Decay Navigators for Magnetic Resonance Imaging
X ≡(m∗
1 ,m∗
2 ,...,m∗
N)
X ≡(m∗
1 ,m∗
2 ,...,m∗
N) and γt = 0
X ≡(φ∗
1,φ∗
2,...,φ∗
N)
X ≡(φ∗
1,φ∗
2,...,φ∗
N) and γt = 0
X ≡(m∗
1 ,m∗
2 ,...,m∗
N,φ∗
1,φ∗
2,...,φ∗
N)
X ≡(m∗
1 ,m∗
2 ,...,m∗
N,φ∗
1,φ∗
2,...,φ∗
N) and γt = 0
X ≡(r ∗
1 ,r ∗
2 ,...,r ∗
N)
X ≡(r ∗
1 ,r ∗
2 ,...,r ∗
N) and γt = 0
X ≡(z∗
1 ,z∗
2 ,...,z∗
N)
X ≡(z∗
1 ,z∗
2 ,...,z∗
N) and γt = 0
X ≡(r ∗
1 ,r ∗
2 ,...,r ∗
N,z∗
1 ,z∗
2 ,...,z∗
N)
X ≡(r ∗
1 ,r ∗
2 ,...,r ∗
N,z∗
1 ,z∗
2 ,...,z∗
N) and γt = 0
X ≡(r ∗
1 ,r ∗
2 ,...,r ∗
N,z∗
1 ,z∗
2 ,...,z∗
Nm∗
1 ,m∗
2 ,...,m∗
N,φ∗
1,φ∗
2,...,φ∗
N)
X ≡(r ∗
1 ,r ∗
2 ,...,r ∗
N,z∗
1 ,z∗
2 ,...,z∗
Nm∗
1 ,m∗
2 ,...,m∗
N,φ∗
1,φ∗
2,...,φ∗
N) and γt = 0
Table 4.1: Model input variants with and without the temporal component that have been tested.
Different selections of points are considered and are described in detail in the Results
section 4.3.1. The general form of the model is thenYj = f j(X )+ϵj, where f j is a regression
function with a residual error ϵj in the j th motion direction (translational and rotational
motion parameters). We will investigate a linear model of the form f (t)j = αj +B j X (t)+γj t for
the estimation of the motion parameters Y . The time component t is added as an explanatory
variable to account for possible linear, time-dependent signal changes of the FIDnav or
the camera data with γ being its estimated contribution to the model. Furthermore, α is
the intercept estimate and B j = (βj
1,βj
2,...,βj
N) is a vector with βj
c as the unknown model
parameters for each of the channels c and motion directions j. The head position in the j th
dimension Yj(t) is then related to the FID signal X (t) from N channels as follows:
⎛
⎜⎜⎝
Yj(t1)
...
Yj(tT )
⎞
⎟⎟⎠=
⎛
⎜⎜⎝
1
X1(t1)
···
XN(t1)
t1
...
...
...
...
...
1
X1(tT )
···
XN(tT )
tT
⎞
⎟⎟⎠
⎛
⎜⎜⎜⎜⎜⎜⎜⎝
αj
βj
1
...
βj
N
γj
⎞
⎟⎟⎟⎟⎟⎟⎟⎠
+
⎛
⎜⎜⎝
ϵj(t1)
...
ϵj(tT )
⎞
⎟⎟⎠
We will evaluate the residual error ϵj for different model inputs X . To achieve this, FIDnav
will be calculated from the complex FID signal as shown in Table 4.1 with
r ∗
c (t) =
(rc(t)−rre f ,c)
rre f ,c
,z∗
c =
(zc(t)−zre f ,c)
zre f ,c
,
m∗
c (t) =
(mc(t)−mre f ,c)
mre f ,c
,φ∗
c =
(φc(t)−φre f ,c)
φre f ,c
16

4.2. Methods
Parameter
3D GRE + FIDnav
FIDnav only
TR
25.0 ms
12.5 ms
TE
3.0 ms
3.0 ms
α
12◦
8◦
TA
6:07 min
6:11 min
Band width
240 Hz/Px
240 Hz/Px
Matrix (RO×PE×PAR)
256×256×144
n.a.
Voxel size
1.0×1.0×1.2 mm3
n.a.
GRAPPA
×2, 24 ref. lines
n.a.
Field of view in phase
87.5%
n.a.
Slice partial Fourier
6/8
n.a.
Total number of FIDnav
1328
29568
samples during the scan
Table 4.2: Acquisition parameters.
where the real and imaginary components or the magnitude and the phase of the complex
FID signal sc from a coil element c at any time point are given by sc = rc +izc = mceiφc and
were normalized using a complex reference signal from the beginning of the scan sre f ,c =
rre f ,c +izre f ,c = mre f ,ceiφre f ,c. Note that only normalized signal changes, i.e., relative to the
reference position, were used for motion estimation. Both camera data and FIDnavs used
the same point in time as reference. The exact time point will be deﬁned in the section 4.3
‘Results’.
Provided that X and Y are known, the model parameters α, β, and γ will be estimated
through least-squares optimization. In the following investigations, we assume a linear rela-
tionship between the multi-channel FIDnav signal changes and the underlying rigid-body
head movements as expressed in the deﬁnition of f j. To assess the quality of the estimates
we evaluate the mean absolute error (accuracy) and the standard deviation (precision) of the
error ϵj. All calculations are performed using MATLAB (MathWorks, Natick, MA, USA).
4.2.2
Experimental Set-Up and Data Acquisition
To determine the model parameters α, β, and γ a sequence of experiments were conducted in
which the subjects were instructed to perform different head movements inside the scanner.
The FIDnavs were acquired and the motion was tracked simultaneously by an optical system
comprising a spatially encoded retro-reﬂective marker and an in-bore camera (Maclaren et al.,
2012). The tracking marker was placed on a customized mouth piece for rigid-coupling to the
skull.
After obtaining written consent, ﬁve healthy volunteers were scanned at 3T (Magnetom
Tim Trio, Siemens, Germany) using a 32-channel head coil array. Each subject underwent
the acquisition of six scans per session of which four involved voluntary head motion. The
17

Chapter 4. Accuracy and Precision of Head Motion Information in Multi-Channel Free
Induction Decay Navigators for Magnetic Resonance Imaging
subjects were instructed to perform a sequence of head movements consisting of four different
motion patterns: nodding (’nod’), translation in the scanner z-direction (’z-tra’), head-shaking
(’shake’), and drawing a virtual eight with the nose tip (’ﬁg 8’). Motion periods of 20 s in
duration were interleaved with 10 s periods without motion and were guided by commands
using the intercom system of the scanner. This sequence of motion patterns was repeated
three times during one scan. For two series with motion, a non-selective 3D gradient-echo
sequence was modiﬁed such that one FIDnav was acquired after ten imaging excitations (3D
GRE + FIDnav), i.e., every eleventh TR or every 275 ms, corresponding to a sampling rate of 3.6
Hz. During each FID readout, 512 complex data points were sampled. Another two datasets
were acquired with a protocol where solely the FID signal was sampled every TR without any
additional gradients for image formation (FIDnav only), matching the sampling frequency of
the optical system of 80 Hz in order to exploit the sampling capability of the FIDnav signal
(see Table 4.2 for an overview). Also, in addition to RF-spoiling a spoiling gradient has been
incorporated after each FID read-out to guarantee signal dephasing prior to the next RF-pulse.
Finally, each of the subjects underwent an additional scan with both sequences where they
were asked not to move. For this study the shimming condition was set only once in the
beginning of the scanning session for each subject.
In addition, phantom scans were performed to observe the stability of the FID navigator
signal in absence of physiological inﬂuences. Here, a spherical water phantom from Siemens
(175 mm diameter; 1.25g NiSO4 + 6H2O per 1000g H2O) was used and stabilized by padded
head cushions inside the coil. The optical marker was attached to the phantom and tracked
by the camera as in the human scans.
4.3
Results
4.3.1
FID Navigator Signal-to-Noise Ratio and Steady-State
One data point of the FIDnav signal intensity time course series from each coil element was
calculated by taking the average of all 512 data samples from a single, spatially non-encoded
read-out, to increase the signal-to-noise ratio of the FIDnav without any substantial loss in
temporal resolution of the FIDnav data. The decision of averaging over the whole FID read-out
was motivated by an initial evaluation where we compared the signal-to-noise ratio (SNR)
of the FIDnav time course depending on the utilized read-out samples i.e., samples from
the beginning, the middle, the end of the read-out and the average over all points. SNR is
hereby deﬁned as the ratio between the mean of the signal over the whole time course and its
standard deviation. This evaluation was based on the data from the phantom experiments.
It was evident that taking the average over all points as well as taking only a single point
from the beginning of the read-out samples provided the highest SNR value (see Table 4.3). A
further evaluation of the volunteer motion prediction performance based on the used read-out
samples showed that using the average over the whole ADC provided the best accuracy and
precision and therefore motivated taking this setting for the FIDnav calculation.
18

4.3. Results
SNR**
read-out samples
averaged over all coil elements
translation
rotation
used for the FIDnav
r: real component
error [mm]***
error [deg]***
z: imaginary component
middle (215)
r: 206; z: 102
0.16±0.14
0.14±0.16
average over points 4 to 509
r: 268; z: 142
0.15±0.12
0.12±0.13
4th sample point*
r: 257; z: 286
0.24±0.17
0.15±0.17
509th sample point*
r: 106; z: 71
0.16±0.14
0.15±0.15
∗The three ﬁrst and last points of the read-out do not contain any valid information due to digital ﬁlter
adjustments in the beginning and the end of the acquisition window
∗∗Evaluation was done on phantom data from a single 3D GRE + FIDnav scan
∗∗∗Results from cross validation on data from a single 3D GRE + FIDnav scan from a moving subject
Table 4.3: SNR and prediction power of the FIDnav.
The FID read-out in our experiment takes approximately 4 ms and it can be assumed that
during this time no signiﬁcant positional changes of the head occur; therefore the reduction of
all read-out samples to a single data point is justiﬁed. Furthermore, we assumed that no signal
cancellation occurred, as could be caused by off-resonance, due to appropriate shimming.
The real and imaginary components as well as the magnitude and the phase of the complex
FIDnav signal from a coil element were normalized using a reference signal from the beginning
of the scan. The reference signal was calculated as the mean of all FIDnavs acquired during a 3
seconds time window starting after the steady-state was reached. Fig. 4.1 shows the magnitude
of the FIDnav signal for one coil element and for two different acquisitions, where the FIDnav
signal was acquired during a ’3D GRE + FIDnav’ sequence and where only the FIDnav signal
was acquired during the scan.
Steady-state was considered as achieved when the signal changes i.e., the partial derivative
over time was less than 1%, which, according to Bloch simulations, occurs after approximately
4.1 seconds or 165 excitations in the modiﬁed gradient-echo case and after approximately 3.7
seconds or 296 excitations in the FID only acquisition. For matters of consistency, the ﬁrst 5
seconds of all data sets were discarded from the evaluations.
4.3.2
Accuracy and Precision of Motion Prediction Based on FID Navigator Data
One third of the measurement was used to compute the model parameters α, β, and γ by
performing a linear regression through least-squares optimization of FIDnav signals and
camera data (’training’. The training period corresponds to 442 and 9856 data points for
’3D GRE+FIDnav’ and ’FIDnav only’ acquisition, respectively. Subsequently, the model was
validated by predicting the head motion parameters during the remaining 2/3 (4 minutes) of
the measurement using the previously obtained model parameters (’validation’, see Fig. 4.2).
The training and validation was performed within each six-minute scan of the same subject.
19

Chapter 4. Accuracy and Precision of Head Motion Information in Multi-Channel Free
Induction Decay Navigators for Magnetic Resonance Imaging
Figure 4.1: Normalized FIDnav signal magnitude time course from one subject acquired without voluntary motion
for the ﬁrst 50 sec of the scan. The ﬁrst 5 seconds of the FIDnav prior to steady-state are discarded. The following 3
seconds of the signal in steady-state are taken as reference. The difference in the magnitudes can be explained by
the different acquisition parameters with respect to repetition time and excitation angle in the 3D GRE+FIDnav
acquisition and the FIDnav only acquisition.
The prediction accuracy and precision of the model was evaluated using 4-fold-cross-
validation within one single scan (intra-scan) by shifting the training block to the beginning,
middle, and the end of the same scan (I-III) as well as by choosing the training and validation
data points at random (IV). Also, an inter-scan cross validation was performed by training the
model with data from one scan and performing the validation on motion data from another
scan but the same subject. The motion trajectories of one exemplary series with head motion
as obtained from the camera system and the FIDnav time course of a single coil element
are shown in Fig. 4.2. For the presented experiment, motion quantiﬁcation with the camera
system revealed translational and rotational motion up to 24 mm and 11◦, respectively.
The validation over all subjects and scans showed that the linear model performs best when
using the real/imaginary parts or the magnitude/phase of the FIDnav as model input among
all tested input variants (Fig. 4.2). Such a model predicts the camera measurements for all six
motion parameters with an overall translational and rotational mean accuracy and precision
of 0.14±0.21 mm and 0.08±0.13◦(Fig. 4.4). Notably, also for larger motion, the assumption of
linearity between the FIDnav signal changes and the motion parameters appears to be valid
(cf. Fig. 4.4).
Systematic differences in the prediction accuracy are visible for different motion directions
and scans (’3D GRE+FIDnav’ compared to ’FIDnav only’ sequence set-up) as can be seen in
Fig. 4.5. For some subjects and experiments (e.g., subject 5, 2nd scan, translation in x; subject
4, 1st scan, translation in z), the error variance is higher than for other experiments. The
differences in the prediction error for different scans and motion directions are signiﬁcant,
however, on the order of magnitude of 10−2 mm or degrees for translational and rotational
motions respectively. Rotational motion in z direction and translational motion in y direction
can be predicted with lower errors as compared to the remaining directions.
20

4.3. Results
0
50
100
150
200
250
300
350
-10
0
10
time [s]
translation [mm]
0
50
100
150
200
250
300
350
-5
0
5
time [s]
rotation [deg]
0
50
100
150
200
250
300
350
-40
-20
0
20
40
time [s]
FID signal change [%]
nod
z-tra
shake
fig 8
nod
z-tra
shake
fig 8
nod
z-tra
shake
fig 8
training
validation
x
y
z
r*c
z*c
m*c
I*c
Figure 4.2: Translational and rotational motion parameters as captured by the camera system from a subject scan.
Real r* and imaginary parts z* as well as the magnitude m* and the phase φ* of the FIDnav time course for one
single coil elements; The subject was instructed to perform the 4 motion patterns nodding, z-translation, head
shaking and drawing a virtual eight with the nose during the training (green box) and the validation parts (red box).
Grey bars at the bottom mark the motion periods. During intermediate periods the subjects were asked to rest in one
position.
Further, the data from the ’3D GRE+FIDnav’ scans reveal a lower prediction power than
from the ’FIDnav only’ scans. This can be explained by the much denser sampling rate of the
’FIDnav only’ experiments and more robust regression results due to a bigger sample size.
Prediction errors larger than three times the standard deviation of the error were considered
as outliers and account for of the total data points. We observed maximal translational and
rotational errors of up to ∼3 mm and ∼3°.
4.3.3
FID Navigator Signal Stability
As described in (Babayeva et al., 2014a), an FID navigator signal may also be subject to changes
due to scanner-related signal ﬂuctuations. Indeed, time-dependent FIDnav signal drifts were
observed, especially for the phase and the imaginary part of the FIDnav signal, as can be
seen in Fig. 4.6. However, these drifts are slow compared to FIDnav signal changes caused by
motion, which was conﬁrmed by phantom scans. The differences in the slopes of the drifts in
different experiments could have been caused by the different warm-up times of the scanner
due to previous experiments and its temperature induced shim changes.
21

Chapter 4. Accuracy and Precision of Head Motion Information in Multi-Channel Free
Induction Decay Navigators for Magnetic Resonance Imaging
-0.15
0.1
0.35
0.6
0.85
Translation
prediction error [mm]
I*+t
z*+t
m*+t
r*+t
I*
z*
m*
r*
r*+z*+m*+I*+t
m*+I*+t
r*+z*+t
r*+z*+m*+I*
r*+z*
m* +I*
Data (Pabs r V)
-0.2
0
0.2
0.4
  Rotation
prediction error [GHJ]
m*+t
I*+t
z*+t
r*+t
m*
I*
r*
r*+z*+m*+I*+t
z*
m*+I*+t
r*+z*+t
r*+z*+m*+I*
m* +I*
r*+z*
Figure 4.3: Accuracy (μabs) and precision (σ) for all subjects after cross-validation and different model inputs with
and without the temporal component. The output is sorted according to the absolute mean prediction error. Using
the magnitude and the phase or the real and the imaginary parts of the FIDnav provides the best performance of the
linear model.
Figure 4.4: Predicted FID-based translational (left) and rotational (right) motion versus camera-detected motion
from 20 scans of 5 volunteers (4 scans with motion per volunteer). As model input the real and the imaginary
component of the FIDnav signal was taken. The extent of the motion parameter error ϵ is coded with different colors
corresponding to multiples of the standard deviation σ (black ϵ < 2σ, red 2σ ≤ϵ < 3σ, and blue ϵ ≥3σ) together with
their proportion relative to the data set. Line-of-identity is indicated in green.
22

4.3. Results
1
2
3
4
5
-1
0
1
subject
translation error[ [mm]
|H|max : 1.98 mm
|H|mean:  0.16 mm
V
:  0.17 mm
1
2
3
4
5
-1
0
1
subject
translation error \[mm]
|H|max :    2.80 mm
|H|mean:    0.11 mm
V
:    0.10 mm      
1
2
3
4
5
-1
0
1
subject
translation error] [mm]
|H|max :  3.32 mm
|H|mean:  0.16 mm
V
:  0.15 mm
1
2
3
4
5
-1
0
1
subject
rotation error[ [deg]
|H|PD[3.02°
:
|H|mean:
0.10°
V
1
2
3
4
5
-1
0
1
subject
rotation error\ [deg]
|H|max
 3.13°
:
|H|mean:
0.09°
 V

1
2
3
4
5
-1
0
1
subject
rotation error] [deg]
|H|max   
|H|mean:     0.06°
V 
0.08°
mean
median
Figure 4.5: Prediction error for all 5 subjects and experiments (3D GRE+FID in green and FID only in orange) where
the subject was moving and motion directions with the respective maximal absolute error, absolute error mean and
the error standard deviation. The boxplot visualizes the distribution of the error with the mean and the median
where the box encapsulates the data between the 25th (Q1) and 75th (Q3) percentiles, the whiskers extend to the
most extreme data points not considered outliers. As outliers were considered data points further away from the
mean than 1.5(IQR) with IQR = Q3-Q1 being the inter quartile range.
Motivated by these time dependent FIDnav signal changes, an additional time component
was added to the model. However, as shown in Fig. 4.3, this does not contribute to a better
motion prediction in terms of accuracy and precision. Physiological effects from respiration
and cardiac cycles may introduce spurious signal ﬂuctuations. The FIDnav signal exhibited
modulations due to breathing, which correlate with small head movements caused by res-
piratory motion, also detected by the camera system. A linear model can be trained with
these data without voluntary motion; the resulting model is able to predict also the small
periodic head displacements in the sub-millimeter range (Fig. 4.7). Cross-validation only
for data without voluntary motion revealed an accuracy and precision of 0.12±0.18 mm for
translational and 0.06±0.09° for rotational motion and r ∗
c and z∗
c as model inputs.
4.3.4
The Ability of the Linear Model to Extrapolate Between Different Motion
Types
We propose the use of a linear model to show the correlation between subject head motion
and the multi-channel FIDnav signal. The employed subject head motion consisted of four
23

Chapter 4. Accuracy and Precision of Head Motion Information in Multi-Channel Free
Induction Decay Navigators for Magnetic Resonance Imaging
0
100
200
300
-20
-10
0
10
20
time [sec]
r*c signal change [%]
3D GRE + FIDnav acquisition
0
100
200
300
-20
-10
0
10
20
time [sec]
z*c signal change [%]
0
100
200
300
-20
-10
0
10
20
time [sec]
m*c signal change [%]
0
100
200
300
-20
-10
0
10
20
time [sec]
I*c signal change [%]
0
100
200
300
-20
-10
0
10
20
time [sec]
r*c signal change [%]
FIDQDY only acquisition
0
100
200
300
-20
-10
0
10
20
time [sec]
z*c signal change [%]
0
100
200
300
-20
-10
0
10
20
time [sec]
m*c signal change [%]
0
100
200
300
-20
-10
0
10
20
time [sec]
I*c signal change [%]
subject at rest
phantom
subject PRYLQJ
Figure 4.6: Real and imaginary parts as well as the magnitude and the phase of the FIDnav signal time course from
a subject that performed motion (black) and at rest (red) as well as from a phantom scan (green). A time dependent
signal trend is visible in both human and phantom scans.
different motion patterns raising the question whether such a linear model is capable of
extrapolating to motion types which are different from the training data set. To evaluate this
ability, the model was trained with one motion type e.g., ’z-tra’ and validated on data from a
different motion type e.g., ’ﬁg 8’ (Fig. 4.8) for all scans with motion. We evaluated the accuracy
and precision for all motion type combinations used for the training and validation procedure
(Fig. 4.9). Using head shaking and translational motion in the z-direction of the scanner for
training produces best prediction results. It is possible to predict translational and rotational
motion with an overall accuracy and precision of 0.21±0.31 mm and 0.12±0.18◦(’shake’) and
0.24±0.39 mm and 0.14±0.28◦(‘z-tra’).
24

4.3. Results
335
340
345
350
-0.5
0
0.5
time [s]
WUDQVODWLRQx [mm]
335
340
345
350
-0.5
0
0.5
time [s]
WUDQVODWLRQy [mm]
335
340
345
350
-0.5
0
0.5
time [s]
WUDQVODWLRQz [mm]
335
340
345
350
-0.5
0
0.5
time [s]
URWDWLRQx [deg]
335
340
345
350
-0.5
0
time [s]
URWDWLRQy [deg]
335
340
345
350
-0.5
0
time [s]
URWDWLRQz [deg]
predicted ),'QDYRQO\
FDPHUDGDWD '*5(),'QDY
SUHGLFWHG'*5(),'QDY
FDPHUDGDWD FIDQDYRQO\
Figure 4.7: Ground-truth motion trajectory as provided by the camera system as well as FIDnav-based predicted
motion trajectories from acquisitions with the modiﬁed gradient-echo acquisition as well as FID only scans. Only 15
seconds of the total time course are shown. The subject was asked not to move. Breathing motion is clearly visible in
both predicted and ground-truth trajectories.
Furthermore, the analysis showed that prediction errors are comparably higher (0.41±0.84
mm and 0.19±0.39◦for translations and rotations) when training the model with nodding
motion and validating it on data from the ‘z-tra’ motion type.
Also, a model trained with data from ’ﬁg 8’ motion performs with a lower accuracy and
precision when validated with the ’z-tra’ motion type (0.41±0.75 mm and 0.17±0.31◦). By
utilizing two different motion types such as nodding and shaking at the same time for training,
the prediction accuracy can be improved to and when performing the validation on ’z-tra’ and
’ﬁg 8’ motion data.
4.3.5
Minimal Training Data Requirements
To assess the minimal data requirements in terms of the number of data points that are needed
to reliably train the linear model, the following analysis was performed. The training data
were randomly chosen from a single time series for all scans and subjects and varied between
5 and 250 data points. The validation data set was also chosen at random and consisted of
1000 data points that were different from the training data set but from the same scan. As
input the real/imaginary components of the FIDnav were taken. The described training and
validation procedure was repeated 400 times to ensure statistical signiﬁcance based on the
25

Chapter 4. Accuracy and Precision of Head Motion Information in Multi-Channel Free
Induction Decay Navigators for Magnetic Resonance Imaging
0
00
400
-5
0
5
WUDQVODWLRQx [mm]
camera dataXVHGIRUYDOLGDWLRQ
FDPHUDGDWDXVed for training
0
200
400
-5
0
5
time [sec]
WUDQVODWLRQy [mm]
0
200
400
-5
0
5
time [sec]
WUDQVODWLRQz [mm]
0
200
400
-2
0
2
time [sec]
URWDWLRQx [deg]
0
200
400
-2
0
2
time [sec]
URWDWLRQy [deg]
0
200
400
-2
0
2
time [sec]
URWDWLRQz [deg]
time [sec]
predicteGPRWLRQ
Figure 4.8: Ground truth motion trajectories as provided by the camera system together the FIDnav based predicted
data. The training (blue) was performed with translation in the scanner z-direction (’z-tra’) whereas validation (red,
black) was done with data where the subject was drawing a virtual eight with the nose tip (’ﬁg 8’). The data shown
here is from a 3D GRE + FID nav acquisition.
validation
training
Pabs error for translation in x [mm]
nod z-tra shake fig 8
nod
z-tra
shake
fig 8
0
0.2
0.4
0.6
validation
training
Pabs error for translation in y [mm]
nod z-tra shake fig 8
nod
z-tra
shake
fig 8
0
0.2
0.4
0.6
validation
training
Pabs error for translation in z [mm]
nod z-tra shake fig 8
nod
z-tra
shake
fig 8
0
0.2
0.4
0.6
validation
training
Pabs error for rotation in x [deg]
nod z-tra shake fig 8
nod
z-tra
shake
fig 8
0
0.2
0.4
0.6
validation
training
Pabs error for rotation in y [deg]
nod z-tra shake fig 8
nod
z-tra
shake
fig 8
0
0.2
0.4
0.6
validation
training
Pabs error for rotation in z [deg]
nod z-tra shake fig 8
nod
z-tra
shake
fig 8
0
0.2
0.4
0.6
Figure 4.9: Mean absolute prediction error for all scans and different combinations of motion types used for model
training and validation. The color code represents the value of the prediction error.
Wilcoxon rank sum test. The test showed that the mean of the prediction error is the same
as with 1000 repetitions for a single data set. The accuracy and precision was evaluated to
assess the reliability of the predicted motion parameters. Fig. 4.10 shows that approximately
100 points are sufﬁcient to train a model which is able to predict head movements with an
accuracy and precision of 0.21±0.31 mm and 0.12±0.18°. Using 240 samples as applied here
the accuracy can be improved by another 40% to and 0.13±0.17 mm and 0.07±0.10◦.
26

4.3. Results
Another analysis has been performed with regard to required motion shape or magnitude,
complementing the analysis performed in the previous section. We evaluated the prediction
power of models trained with 100 data samples of motions with different magnitudes. These
samples were selected to have a uniform distribution over a ﬁxed range (i.e., uniform distri-
bution of motion samples in the interval [−2+2] mm). A 4-fold cross-validation was used
to assess the accuracy and the precision of the model by shifting the training and validation
blocks to the beginning, the middle and the end of the data set while randomly choosing the
samples. The training set was chosen from 1/3 of the data and the validation was done on the
remaining 2/3 of the data points.
The results from all experiments showed that already motion magnitudes of ±2 mm and
±1◦for translations and rotations, respectively, allow the model to be trained and to predict
previously ’unseen’ motion of bigger amplitudes with an absolute error of 0.30±0.30 mm and
0.14±0.14◦(see Fig. 4.10). Also, motion magnitudes > 2 mm and > 1◦do not seem to improve
the model and only the number of samples has a signiﬁcant effect on the prediction quality in
terms of prediction error.
0
1
2
3
4
5
0
0.5
1
1.5
Translational motion magnitudeXVHG
IRUPRGHOWUDLQLQJ [mm]
Translation
prediction error [mm]
Data (Pabs r V)
0
1
2
3
4
5
0
0.5
1
Rotational motion magnitude XVHG
IRUPRGHOWUDLQLQJ[deg]
Rotation
prediction error [deg]
0
50
100
150
200
250
-1
0
1
2
3
4
Number of training data points
Translation
prediction error [mm]
Data (Pabs r V)
0
50
100
150
200
250
0
1
2
Number of training data points
 Rotation
prediction error [deg]
Figure 4.10: The mean prediction accuracy μabs and precision σ for linear models which have been trained with
different amount of sample points and motion magnitudes. The data is shown for translational and rotational
motion.
4.3.6
Inter-Scan and Inter-Subject Model Differences
Ideally, the motion model could be universally applied, i.e., would be applicable to all subjects
in a given head coil, which would enable the use of FIDnavs for motion correction without
using ground-truth motion parameter data (as obtained by the camera system here). With this
goal in mind, we investigated the prediction ability of the motion model between different
subjects and scans. However, a model which is trained on data from a different subject was not
able to provide good prediction results. In this case, a prediction error larger than the motion
27

Chapter 4. Accuracy and Precision of Head Motion Information in Multi-Channel Free
Induction Decay Navigators for Magnetic Resonance Imaging
magnitude was observed. Consequently, we state that FIDnav signal changes are to a great
extent subject- and coil-speciﬁc due to different head and coil geometries, positioning, as
well as different coil loading and shimming conditions. This is currently the limiting factor for
extending this motion quantiﬁcation technique to inter-subject use, i.e., for ﬁnding a generic
FIDnav-motion model. However, once a model has been trained for a certain subject and
session, it can be reused for different scans within this session as long as the subject remains
in the scanner and the FIDnav is acquired in the same manner. The prediction accuracy
and precision of inter-scan cross-validation was found to be 0.75±1.3 mm and 0.40±0.67◦for
translational and rotational motion in comparison to 0.14±0.21 mm and 0.08±0.13◦when
the training and validation was done within the data from the same scan. We found that the
scenario where training and validation is done with data from different scans is only possible
using the magnitude signal m∗
c as model input. This suggests that the phase is more sensitive
to changes between scans.
4.4
Discussion
4.4.1
Prediction Accuracy of the Multi-Channel FID Navigator
According to theory the tracking accuracy of a motion detection device has to be several times
higher than the image resolution in order to ensure successful motion correction with low
artifact-to-noise ratio (Maclaren et al., 2013, 2010). It was recently shown that translations
and rotations in the range of 0.5-1.5 mm or 0.5-1.5 degrees cause a loss of information in MRI
data with a voxel size of 1×1×3 mm3 of 23.7% and 11.8% respectively, leading to errors in
quantitative evaluations of brain lesions (Gedamu and Gedamu, 2012). However, another study
showed that slow, predominantly through-slice motion of 0.1 mm as caused by breathing does
not cause signiﬁcant artifacts for high resolution RARE images with a voxel size of 0.27×0.27×2
mm3 (Herbst et al., 2014). Taking into account the aforementioned studies and the result
of our experimental work, we state that a multi-channel FID navigator technology with the
presented accuracy and precision of 0.14±0.21 mm and 0.08±0.13° for translation and rotation
could be considered sufﬁcient for rigid-body motion correction in MR acquisitions with a
voxel size of up to ∼1 mm3. Despite the sufﬁcient mean accuracy, the detected outliers of up
to 3 mm and degrees could potentially cause artifacts. Hence, it is important to understand
the exact source of such outliers in order to eliminate them. It is further to mention that for the
prediction performance the use of the real/imaginary signal representation is advantageous
to the magnitude/phase representation due to phase wraps occurring in the latter case.
However, even though with bigger prediction errors, the use of only the magnitude of
the FIDnav enables the model to be reusable for several scans within one session and the
same subject. In order to assess the real impact of the FIDnav prediction errors on the image
reconstruction, a strategy is needed where the FIDnav predicted trajectory is used to correct for
the occurred motion which is subject to future investigation. It was evident that the prediction
performance was better in certain motion directions as well as outliers (up to 3 mm and
28

4.4. Discussion
degrees for translations and rotations respectively) were detected. These rare outliers might
be caused by several effects: non-rigid motion as jaw or tongue movements, marker shifts of
the optical system, and the non-symmetrical geometry of the utilized head coil. The non-rigid
motion as well as the marker shifts lead to discrepancies in the FIDnav signal and optical
data. Missing coils in one speciﬁc direction of possible head movements might reduce the
performance of the proposed FIDnav based motion prediction approach.
4.4.2
FID Navigator Signal Stability
The phantom scans as well as human scans at rest were analyzed with respect to the effect
of gradient activity near the FIDnav sampling in the 3D GRE acquisition. We suspected that
thermal effects may have an inﬂuence on the FIDnav stability and possibly manifest them-
selves in higher temporal dependency of FIDnav signal in the ’3D GRE+FIDnav’ acquisition.
However, our data did not exhibit such effects. One might speculate that the eddy currents
were sufﬁciently canceled in the applied protocols or that a steady-state was reached; the
picture may however change in gradient-demanding acquisitions such as diffusion scans. Nev-
ertheless, the observed temporal dependency of the FIDnav signal motivated us to include the
time as an additional input parameter into the model. The evaluation of the residual motion
prediction error revealed, however, that the temporal component reduces the performance of
the model in terms of accuracy and precision. We thus assume that the model is intrinsically
capable of compensating for potential drifts by combining FIDnav signal from channels with
opposed temporal dependency. Another explanation might be that the model is not able to
ﬁnd a correct relationship between the temporal component and the time-varying motion
trajectory, especially in experiments with intended subject movements.
The FIDnav-based model was also able to predict small head movements as caused by
respiration. This result indicates that the multi-channel FIDnav is very sensitive not only for
substantial head movements, but is also able to detect small signal changes originating from
involuntary physiological movements of the subject.
4.4.3
Advantages and Limitations of the FID Navigator Approach
The accuracy and precision assessments performed in this work were assuming that the
accuracy of the available camera system (reported precision: 10 μm / 0.01° (Maclaren et al.,
2012)) is to date the best possible measurement of head motion within an MR scanner. Relying
on the positional information as provided by the camera system, this work demonstrates that
substantial rigid-body motion information is encoded in multi-channel FIDnavs and can
be decoded with mean errors in the sub-millimeter and sub-degree range. The FIDnav uses
hereby the simplest form of MR-signal acquisition by rapidly measuring the FID and can be
added to practically any sequence without inﬂuencing the magnetization (e.g., by placing a
read-out after an excitation of the host-sequence) and thus does not affect the overall image
quality.
29

Chapter 4. Accuracy and Precision of Head Motion Information in Multi-Channel Free
Induction Decay Navigators for Magnetic Resonance Imaging
As described previously, the ﬁrst ﬁve seconds of the FIDnav are ignored since the magne-
tization is not yet in a steady-state in the employed gradient-echo sequence and additional
three seconds are used for normalization. This has to be taken into account as no motion
information is available during this time. Methods to accelerate the stabilization of the signal
as for example suggested in (Busse and Riederer, 2001) by introducing a saturation pulse can
be considered to reduce this dead time. In the performed experiments, we assume a simple
linear relationship between the FIDnav signal and the motion data provided by an in-bore
camera. With this in mind, it should be theoretically possible to extract the parameters of such
a linear model with only few data points of the ground-truth motion and the corresponding
FIDnav signal. We have shown that 100 data points of low motion magnitudes are sufﬁcient
to train a linear model and still be able to obtain prediction results with an accuracy and
precision below 1 mm/1°.
Furthermore, although the proposed linear model is capable of extrapolating between
different motion types when different motion patterns were used for training and validation,
the best performance was obtained when using nodding and shaking motion together for
model training. Using only one motion type to predict before ’unseen’ motion types showed
considerably lower performance. Predicting translational motion along the scanner bore
proved to be most difﬁcult if only one motion type was used for model training. We assume
that this is caused by the physiological shape of the head and the coil geometry (i.e., the
positioning of the different coil elements with respect to ’z-tra’ motion).
This raises the question of the practicability of the method as a ’standalone’ motion man-
agement approach. One strategy is to use the knowledge about the ability of the multi-channel
FIDnavs to provide accurate quantitative motion information for its applicability in robust
motion detection applications as proposed in (Kober et al., 2011). These techniques, where
the FIDnav is used to classify segments of acquired data as corrupted by motion and to trigger
a reacquisition, heavily rely on the sensitivity and speciﬁcity of the employed threshold of
the FIDnav evaluation. Such technologies could be improved by including the quantitative
knowledge about the motion magnitude in such a classiﬁer.
Another way of using this information could be to establish a model training step without
the need of a camera system. From a theoretical point of view, such training ideally would
take place before an examination scan and should be signiﬁcantly shorter than the imag-
ing sequence itself, as a re-scan might be otherwise more appealing than a long pre-scan.
The subject would be asked to change the head position during the prescan to acquire a
training data set speciﬁcally designed for the sequence targeted for motion correction. The
motion parameters for the model training would be obtained by co-registration of the image
navigators.
It can also be considered to collect a sufﬁcient amount of data to train a universal motion
model, which takes into account the subject-speciﬁc model features such as head geometry,
initial head position inside the coil-array, and shim settings. However, as of now, we do not
30

4.4. Discussion
consider this approach promising, due to the vast parameter space which would have to
be covered. We could show that by considering only the magnitude of the FIDnav signal,
it is possible to train a subject-speciﬁc model that is able to provide prediction results in a
subsequent scan (inter-scan validation) with a mean accuracy below 1mm/1°. Although, the
prediction errors are larger compared to intra-scan validation and the different acquisitions
are within the same 3D GRE sequence, it is a promising result towards a model training strategy
which could yield a model for the entire scan session comprising different acquisitions. This,
however, would be compromised even further by different sequences with possible artefactual
effects on the incorporated FIDnav signal (e.g., diffusion weighting, turbo-spin-echo etc.)
and would require an appropriate strategy to render the FIDnav signal inter comparable
throughout the whole scan session.
Another limitation to the FIDnav technique concerns slice-selective imaging. Motion
detection relies on signal changes arising from different head positions relative to the receive
coil. With respect to slice-selective sequences the FIDnav signal is subject to changes as caused
by differences in the selected anatomy of the head in case the 2D pulse is used for the FIDnav
acquisition. Hence, the FIDnav will detect possibly counter balancing signal changes arising
not only from the head motion but also from the differences in the slice positions. Therefore,
additional investigations are needed in this regard to propose another FIDnav acquisition
strategy and to draw further conclusions.
Different coil geometries might present another challenge to the FIDnav ability to track mo-
tion reliably. It might be expected that missing coils in certain directions e.g., open cage coils
without an antennae in the z-direction of the scanner would lead to difﬁculties in predicting
motion in this speciﬁc direction based on the FIDnav signal.
Furthermore, non-rigid motion which is not necessary related to displacements in the
brain regions but would cause signal changes in the FIDnav is a limitation of the presented
technology. Certain coil elements which are located close to the jaw and neck region could be
excluded to reduce this effect.
4.4.4
Future Work
Future work should aim at extracting the subject-speciﬁc mapping from the FIDnav signal
changes to rigid head movements without relying on the optical tracking system.
One possible direction towards enabling the back-calculation of the motion parameters
from the FIDnav signals is to train a linear model by measuring the coil sensitivities of the
employed head coil and the subject-speciﬁc head geometry (e.g., low resolution head and body
coil images) as proposed in (Kober et al., 2010). This data could be used to simulate the FIDnav
signal by ’moving’ the MR image of the head in silico i.e., applying a mathematical matrix
transformation and weighting the ’moved’ image by the estimated coil sensitivity proﬁles to
subsequently translate FID signal changes during image acquisition in quantitative motion
31

Chapter 4. Accuracy and Precision of Head Motion Information in Multi-Channel Free
Induction Decay Navigators for Magnetic Resonance Imaging
parameters for motion correction.
An alternative approach is to use the FIDnav for motion detection and to trigger a sub-
sequent motion quantiﬁcation mechanism (e.g., imaging navigator) during the scan, if the
FIDnav exceeds a certain threshold indicating subject head movement as already proposed
in (Babayeva et al., 2014a; Kober et al., 2012). After several (≥100 data points as shown in
this work) triggering events, there should be enough data (positional information and the
corresponding FIDnav data from individual coil elements) to train a model and with it be able
to quantify the head movements based on the FIDnav signal alone.
Also, models of higher complexity than linear additive ones could be considered. However,
an initial investigation in employing quadratic and interaction terms or other machine learning
paradigms as neural networks, did not indicate improvements in the motion assessment and
a detailed investigation would go beyond the scope of this work.
Due to the simplicity of the FIDnav, it could be also used to complement existing motion
tracking methodologies by providing a means of validation or guiding mechanism through
additional information e.g., additional regularization of retrospective correction methods
based on autofocusing (Babayeva et al., 2014b) or validation of optical tracking technology
which is heavily relying on rigid coupling of the tracking marker with the skull and could be
perturbed by marker shifts.
4.5
Acknowledgement
We would like to thank Sebastian M. Waszak, Kieran O’Brien, Alexis Roche, Matthias Seeger,
Bénédicte Maréchal, Rolf Gruetter, and Pavel Falkovskiy for valuable discussions and sugges-
tions.
32

5 FID-based Motion Sensitive Qual-
ity Metric and Retrospective Motion
Correction for Clinical Magnetic Reso-
nance Images
This chapter is based on published work from Babayeva et al. (2014b) and
Loktyushin et al. (2013).
Abstract Motion is a major source of artifacts in clinical magnetic resonance imaging. We
have collected a representative data set of 109 clinical MP-RAGE images where the acquisition
sequence was equipped with FID navigators and applied a recently proposed retrospective
motion correction technique to all data. An expert radiologist then rated the images before and
after correction to assess the image quality improvement. It was shown that severely motion
corrupted images of non-diagnostic quality were improved to an extent that they were rated
as clinically useful after motion correction. The image quality of data with less severe artifacts
was also improved according to the rating. Additionally, we propose a novel image quality
index based on the FID signal, which can detect images according to the strength and extent
of its motion artifacts. The higher the FID-based quality index the higher is the probability
for the corresponding data to be motion corrupted. This study shows that substantial image
quality improvement can be achieved using the retrospective motion correction method and
indicates that the technique bears the potential to improve the way the problem of motion is
handled in the clinical context by providing automated means of motion artifact detection.
5.1
Introduction
Motion is prevalent in clinical magnetic resonance (MR) acquisitions especially with elderly
and pediatric cohorts. Patients often experience a high level of distress and discomfort due
to claustrophobia, anxiety and long scan times. This may lead to agitation and increased
patient motion during an MR examination and degrade the quality of acquired images to
33

Chapter 5. FID-based Motion Sensitive Quality Metric and Retrospective Motion
Correction for Clinical Magnetic Resonance Images
a non-diagnostic level such that a rescan and even patient sedation might be necessary
(Munn and Jordan, 2013). A large multicenter study reported that motion occurs in 40%
of the medical examinations, in 10% being caused by motoric unrest of the patient leading
to severely impaired image quality (Oberstein et al., 1990). Another study reported similar
values of artifact occurrence in clinical MR scans where 12.8% of the images were motion
corrupted and 6.4% had a non-diagnostic image quality (Dantendorfer et al., 1997). Thus, not
surprisingly, motion during MR examinations is considered to be the major source of image
artifacts with substantial ﬁnancial implications (Andre et al., 2015).
Advances in quantitative interpretation of MR-based data using morphological brain seg-
mentation (Schmitter et al., 2014) require high-resolution and artifact free images. It was
recently shown that motion-related artifacts cause a signiﬁcant bias in the estimates of the
cortical gray matter volume with an average apparent volume loss of roughly 0.7%/mm/min of
subject motion (Reuter et al., 2015). The high-resolution imaging is associated with prolonged
scan times, which again increases the risk of motion artifacts to be present.
Numerous motion detection and correction strategies have been proposed during the past
decades, however, no universal solution that ﬁts all imaging paradigms could be identiﬁed so
far (Zaitsev et al., 2015). Most correction techniques are sequence speciﬁc or can only correct
for special types of motion as in-plane motion. The existing motion correction methodologies
can be split into two broad classes: prospective and retrospective motion correction tech-
niques. Prospective motion correction is applied during the scan time, whereas retrospective
correction is performed after the image is acquired. Most prospective correction techniques
require either equipping the imaging sequence with navigators (Tisdall et al., 2012; White
et al., 2010) or additional hard-ware to track the subject’s motion, for example, optical cameras
(Zaitsev et al., 2006). Both, prospective and retrospective motion correction techniques have
their advantages and limitations. Prospective methods can correct for spin-history effects
and prevent Nyquist violations due to inadequately sampled k-space. They require, however,
sequence modiﬁcations to include the acquisition of the navigator, and depending on the
navigator complexity these are not always easy to implement in all sequences. Prospective
methods also often rely on external motion tracking hardware, which might not be compatible
with the scanner setup i.e., because of an obstructed camera view due to a closed coil design.
Retrospective correction techniques, on the other hand, can be applied to the data acquired
with most of the sequences as the methods based on autofocusing (Atkinson et al., 1997;
Loktyushin et al., 2013) but they fail in cases with severe motion degradation, which causes
unrecoverable k-space data loss or can only be applied to in-plane motion as in case of the
PROPELLER method (Pipe, 1999).
Further, the high sensitivity of computer-based quantitative image evaluations to motion
artifacts motivates the development of automatic detection of even benign image degradations.
Thus the possibility to assess the image quality quantitatively has an increased value in
determination of the validity of morphological segmentation results. Such an automated
quality assessment methodology, which is capable of identifying images of non-diagnostic
34

5.2. Methods
quality, can be based on background noise evaluation (Mortamet et al., 2009).
We have developed a novel motion artifact detection technique based on the recently
proposed free-induction-decay navigator (FIDnav) (Kober et al., 2011). The manifestations of
the motion artifacts depend on the affected k-space position (Maréchal et al., 2012; Zaitsev
et al., 2015). FIDnav-based motion detection provides a means of determining at what time i.e.,
k-space position during the acquisition, subject motion occurred. We utilize this information
to perform the FID-guided retrospective motion correction based on autofocusing (Babayeva
et al., 2014b; Loktyushin et al., 2013). Further, we evaluate the performance of the proposed
techniques with the use of the expert’s ratings and rankings of the corrected and uncorrected
clinical MP-RAGE images and also assess the rating correlation with FIDnav-based motion
artifact detection.
5.2
Methods
5.2.1
Data Acquisition
We have collected a data set of 109 MP-RAGE images (α/TI/TR/TA = 9◦/900ms/2300ms/5:12
min, GRAPPA 2× with 32 reference lines, different matrix and voxel sizes in the range of 1 mm)
acquired for clinical purposes at our site (CHUV, Lausanne, Switzerland) over a time period
of roughly 1 year. The images were acquired with ﬁve different scanners (Verio, Skyra, Aera,
Trio, Prisma from Siemens Healthcare, Erlangen, Germany) and different head-coils (see Table
5.1 for a detailed overview). The data was anonymized in correspondence with local ethics
regulations, hence, no information on demographics or disease diagnosis can be provided
here. The prototype MP-RAGE sequence was modiﬁed in such a way that at the end of the
read-out train in every TR an FIDnav acquisition was inserted (α = 5◦, 512 samples in 2 ms).
5.2.2
Retrospective Motion Correction
All images were retrospectively motion corrected using two different motion correction tech-
niques. First method used for correction was the recently proposed blind retrospective mo-
tion correction based on autofocusing (Loktyushin et al., 2013). This method relies on an
optimization-based search of unknown motion parameters, where the cost function involves
the image quality metric evaluated on intermediary motion corrected images. We call this
method ’blind’ due to the fact that the only source of information needed for optimization is
the k-space data itself. The second method was a modiﬁcation of the blind correction tech-
nique, where the information from FIDnav is used to constrain the optimization by restricting
the set of explored motion trajectories (Babayeva et al., 2014b; Loktyushin et al., 2013). In
this study, we are going to call it FID-guided correction. Additionally, we also reconstruct our
data ’as is’ (no motion correction) resulting in a total of three different image sets: without
motion correction, with blind motion correction, and FID-guided motion correction. All
computations were performed in MATLAB (Mathworks, USA).
35

Chapter 5. FID-based Motion Sensitive Quality Metric and Retrospective Motion
Correction for Clinical Magnetic Resonance Images

@>?B
@>?C
$)!
##').%1
!()'#)1
($),'
+'($#
)!/$!(
*"'$
##!(*(
$'&*()$#
'
%'
.
*#
*!
*
%
)
$+

#


'$1A1
?E
	8A@
	)'-8?@H )'-H%#)'-
	)'-8?@H )'-
	)'-8?@H )'-
	)'-8?@
A@
?G
?D
?>
?@
?
>
A
B
B
A
C
B
?
>
?A
?E
AF
C
F
?
@
 .'1A1
?A

	 8DB
	8A@
	8A@H%#8A@
	 8@>
DB
A@
AD
@>
>
>
@
?
>
>
>
>
>
>
@
C
E
?
?
?
'1?3C1
?A
	 8@>
	 8@>
	 8@>H%#8A@
@>
?D
@B
@
?
>
>
E
>
@
A
?
@
D
F
@>
?
?@
'$1A1
?E
	8A@
A@
>
?
?
>
>
>
>
>
>
>
>
>
@
'("1A1
??
	 8DB

DB
>
>
>
>
@
>
>
B
@
>
?
?
?>
$)!
A
@
D
C
?A
A
E
??
B
@
@@
A?
?>G
Table 5.1: Overview of the clinical MPRAGE datasets collected for this study. The ’Utilized coils’ column shows a
description of the head coil as well as additional coils used for data acquisition. The number after the underscore
indicates how many coil elements in the selected coil matrix are available.
5.2.3
Qualitative Image Quality Assessment
Two different evaluations were performed to assess the image quality before and after cor-
rection. During both quality assessment procedures the rater was blinded to the respective
reconstruction method. First, the image quality was rated in terms of blurring, ringing and
ghosting artifacts inside (BGR inside) and outside (BGR outside) the brain region to be none,
mild, moderate, or severe in accordance with the image quality criteria within the Alzheimer’s
Disease Neuroimaging Initiative (ADNI) study (Jack et al., 2008). Further, the images were
rated to be either useful for clinical analysis or to be non-diagnostic when extensively motion
corrupted. Second, the uncorrected images and those corrected with blind and with FID-
guided method were ranked against each other according to their perceived image quality
characterized in terms of blurring, ghosting, and ringing. The image with the best image
quality was ranked ﬁrst and the one with the worst quality was ranked third. If the images
were perceived to be of the same quality they were assigned the same rank, i.e., if blind and
FID-guided corrections were perceived to be similar but better than the uncorrected image
then they both would be ranked ﬁrst and the uncorrected image second.
One rater, a radiologist with 6 years of MR brain imaging experience, reviewed the images.
These qualitative results were used as the ’gold-standard’ for further FIDnav-based motion
detection assessments.
36

5.2. Methods
5.2.4
FID-Based Motion Detection
It was shown that the FIDnav is able to detect motion events reliably (Kober et al., 2011)
and even allow prediction of the underlying rigid head motion with a submillimeter and
sub-degree precision (Babayeva et al., 2015b), when acquired with a multi-channel coil array.
However, so far it is not possible to extract the motion trajectory from the FID-signal without
the knowledge on its correlation with the underlying motion parameters.
Here, we would like to make use of the multi-channel FIDnav signal as means of quality
index estimation for motion artifact detection of the our data set. The FID signal from a
read-out is reduced to a single point for every channel by taking the complex average of all
read-out samples and consider just the magnitude mc(t) of the complex signal as proposed in
(Babayeva et al., 2015b).
For motion detection we will consider several FIDnav-based metrics and evaluate their
performance with respect to their sensitivity and speciﬁcity to identify the images with none,
mild, moderate, and severe motion artifacts inside the brain region using the radiologist’s
ratings as ’gold-standard’. We will further consider images having no visible motion artifacts
as ’no motion’ scans and all the others as ’motion’ scans. Hereby, we excluded the FID signal
from the neck and spine region coils, as only bulk rigid head movements were of interest for
this study. Please note that for this classiﬁcation problem it would be also possible to make
use of classical machine learning tools such as support vector machines. However, we decided
to show the differences between the artifact groups based only on selected FIDnav features
to avoid the ’black box’ problem caused by such tools making it difﬁcult to draw a direct link
between the classiﬁer and the data. Also the relatively small sample size restricts us to the use
of simple statistical methods.
We will call the ﬁrst detector F IDnavAllC, where ’AllC’ stands for all channels. For this
metric we evaluate the relative ﬁnite difference FIDnav signal magnitude (mc(t) −mc(t −
1))/mc(tre f ). First two samples from the FID time series were omitted to ensure that the signal
is in a steady-state meaning that tre f = 3rd repetition. Also the mean μAllC and standard
deviation σAllC over the whole time course of the acquisition for every channel is calculated
separately. If a realitive signal change higher than 3σAllC in more than N channels then the
part of k-space acquired during this TR is considered to contain a motion event i.e, outlier. We
sought to ﬁnd the optimal number of relevant channels N by correlating the FIDnav-based
artifact detection to the ’gold-standard’ visual evaluation of the image quality with respect to
best sensitivity and speciﬁcity. We will also consider another threshold mechanism that we
will call moving standard deviation σAllCmov, which is calculated based on the moving average
over the whole FIDnav time course and does not take the FIDnav values of the identiﬁed
motion events into consideration i.e., standard deviation for t is calculated from all data
points acquired up to t −1, if FID signal at t is higher than 3 times the standard deviation then
it is considered as a motion event and not taken into the calculation for the reference standard
deviation at the next time point. This detector will be referred to as F IDnavAllCmov.
37

Chapter 5. FID-based Motion Sensitive Quality Metric and Retrospective Motion
Correction for Clinical Magnetic Resonance Images
We pose that the FID signal changes if motion is present during the acquisition this would
mean that the temporal variation of the signal would become higher and would be reﬂected by
the standard deviation of the signal. We propose to calculate the standard deviation over the
normalized ﬁnite difference of the FID signal (mc(t)−mc(t −1))/mc(tre f ) over all channels
σF IDnav and will investigate its performance as a potential motion detector.
Another FIDnav-based detector will be referred to as F IDnavNCmax, where ’NCmax’
stands for N number of channels with maximal signal change among the channels at every
time point. Here, we use the mean of the FIDnav ﬁnite difference signal (mc(t) −mc(t −
1))/mc(tre f ) from NNCmax channels where the absolute signal change was maximal as the
metric for each time point. The optimal number of the channels NNCmax is estimated through
speciﬁcity and sensitivity measures of the proposed metric. If the obtained F IDnavNCmax
value exceeds the empirical threshold τNCmax then the corresponding time point is considered
to be a motion event as described in (Babayeva et al., 2015a). In contrast to F IDnavAllC where
the threshold is calculated for each scan individually, here, the empirical threshold τNCmax
is obtained from the three times the standard deviation 3σNCmax of the ’no motion’ scans
over the whole scan time. Hence, it is also important to investigate which inﬂuence does the
ﬁeld strength, scanner or coil type used for data acquisition has on this threshold, otherwise
τNCmax needs to be calculated separately for each group (i.e., ﬁeld strength, scanner or coil
type).
It is known that motion artifacts manifest themselves differently depending on the location
in k-space affected by motion (Maréchal et al., 2012; Zaitsev et al., 2015). If motion is present
during the acquisition of high frequencies then the artifacts are less visible and the image
quality may be less deteriorated than in cases where the central low-frequency parts of k-space
are affected by motion. We exploit this information in our FID-based motion detection by
applying larger weights to the FIDnav corresponding to the center of k-space. Again, the
optimal weighting curve parameters are found by correlating the FID-based detection and
qualitative ratings. Here, we evaluate a parabolic
wParabola(t) = 1−
	t −σk−space
μk−space/a

2
(5.1)
and a Gaussian weight curve
wGauss(t) = e
(t−μk−space )2
2σ2
k−space
(5.2)
Both weight curves are centered at k-space center μk−space (i.e., corresponding to t where
the data from the center of k-space are acquired). The curves have also a ’width’ σk−space =
38

5.3. Results
Nlin/a and Nlin being the total number of k-space lines. The variable a is set based on
sensitivity and speciﬁcity evaluations of the speciﬁc weighted FID-based motion detector. We
introduce the optimal FID-based quality index, which is calculated as a weighted sum over all
FIDnav values and which we call FIDI (Eq. 5.3). Finally, we propose FIDI bounds for different
artifact classes based on a logistic regression ﬁt of the data.
F IDI =

t
w(t)F IDnav(t)
(5.3)
Additionally, we have calculated the quality index (QI) proposed by (Mortamet et al., 2009)
for all uncorrected images in order to compare the results to the FIDnav-based quality metrics.
5.3
Results
5.3.1
Prevalence and Nature of Motion Artifacts in the Collected Data
The expert ratings revealed that 4% (4 cases) of the original (uncorrected) images had severe,
13% (14 cases) moderate, and 15% (17 cases) mild artifacts inside the brain region and 9% (10
cases) severe, 14% (15 cases) moderate, and 43% (47 cases) mild artifacts in the background.
6% (6 cases) of images were rated to be of non-diagnostic quality (Fig. 5.1).
Figure 5.1: Blurring, ghosting, and ringing (BGR) artifact prevalence inside and outside the brain region in the
images according to qualitative ratings as well as their clinical utility.
5.3.2
Image Quality Before and After Correction
Retrospective motion correction was found to improve the overall image quality (Fig. 5.2
and Fig. 5.3) as assessed by the expert’s ratings. When considering BGR artifacts inside the
brain the number of severely corrupted images was reduced with blind correction from 4 to 2
cases and eliminated in the FID-guided correction. Moderate artifacts inside the brain region
could be reduced through both correction algorithms from 14 to 8 cases and the number of
39

Chapter 5. FID-based Motion Sensitive Quality Metric and Retrospective Motion
Correction for Clinical Magnetic Resonance Images
cases with mild motion artifacts was changed from 17 to 26 by blind and to 21 by FID-guided
correction. Mild background artifacts (mainly N/2 GRAPPA related ghosts) were however
increased after applying the correction from 47 to 75 cases after blind and 68 cases after
FID-guided correction. Moderate background artifacts increased from 15 to 17 cases after
blind and decreased to 12 after FID-guided correction. Severe artifacts were reduced after
both corrections from 10 to 3 and to 2 cases for blind and FID-guided correction respectively.
After blind correction only 2 images were ﬂagged as having no clinical utility, however after
FID-guided correction all images were found clinically useful.
FID-guided motion corrected images were ranked ﬁrst in 83 cases compared to blind
correction (58 cases) and without any correction (60 cases). In a single case, the image quality
was found to deteriorate after FID-guided correction. In this case, moderate ringing artifacts
appeared inside the brain region, which were rated as mild in the original image before
correction, however were removed by blind correction (Fig. 5.3c). The images were assigned
the second rank in 51 cases after blind and in 25 cases after FID-guided correction compared
to 20 without correction.
Figure 5.2: Qualitative expert ratings results for blurring, ghosting, and ringing artifacts inside and outside of the
brain region as well as clinical utility before and after blind and FID-guided retrospective motion correction.
5.3.3
FIDnav Based Quality Metric Design
The FID signal is a multi-dimensional time series signal and it was prepared as described in
the Methods section in order to eventually be able to identify motion corrupted images based
on a single index derived from the FID data. In Fig. 5.4 it is shown how the FID signal and the
respective detector change depending on the underlying motion.
When using the motion detectors F IDnavAllC and F IDnavAllCmov several variables have
to be set. It was to determine what number of relevant coil elements N, as well as the amount
of detected motion events provide the best results to distinguish images with different artifact
severity. We have investigated the mentioned variables with respect to its inﬂuence on the
receiver operating characteristics (ROC) of the related F IDnavAllC and F IDnavAllCmov. The
speciﬁcity and sensitivity for different number of coil elements as well as detected motion
events are shown in Fig. 5.5.
The results show a low performance of the proposed detectors (F IDnavAllC and
F IDnavAllCmov) due to the dependency of the FIDnav temporal variance on motion leading
40

5.3. Results
Figure 5.3: Images before and after blind and FID-guided retrospective motion correction from different subjects
with a zoom on a part of the brain and different severity of blurring, ghosting, ringing artifacts inside the brain
before correction: (a) severe; (b) moderate; (c) mild. Blind correction: (a) severe; (b) moderate; (c) none. FID-guided
correction: (a) moderate; (b) mild; (c) moderate;
to an increased number of false positives with a speciﬁcity close to 50%. Only when detecting
images with moderate artifacts among images with none artifacts a speciﬁcity of 87% and
sensitivity of 78% for N=2 and 4 motion events can be reached (see Fig. 5.5c). However, setting
the threshold empirically e.g., to the multiple of standard deviation of ’no motion’ FIDnav
data in the case of F IDnavAllCmov, does not provide a compelling improvement in the ROC.
Hence, this ﬁnding leads us to investigate the temporal variability of the FIDnav from all
coil elements as a detector σF IDnav. We noticed that only the ﬁeld strength of the scanner
has a signiﬁcant inﬂuence on the standard deviation of the FIDnav. Number of utilized coil
41

Chapter 5. FID-based Motion Sensitive Quality Metric and Retrospective Motion
Correction for Clinical Magnetic Resonance Images
Figure 5.4: FID signal in its raw form (a, e) after normalization mc(t)/mc(tre f )(b, f) and after modiﬁcation for
motion detection as F IDnav3Cmax (c, g) and F IDnavAllC (d, h) for data sets without any motion artifacts and
moderate motion.
0
0.5
1
0
0.2
0.4
0.6
0.8
1
1-Specificity
Sensitivity
ROC: motion - no motion
0
0.5
1
0
0.2
0.4
0.6
0.8
1
1-Specificity
Sensitivity
ROC: visible artifacts: none - mild
0
0.5
1
0
0.2
0.4
0.6
0.8
1
1-Specificity
Sensitivity
ROC: visible artifacts: none - moderate
0
0.5
1
0
0.2
0.4
0.6
0.8
1
1-Specificity
Sensitivity
ROC: visible artifacts: none - severe
N = 1
N = 2
N = 3
N = 4
N = 5
N = 6
#events = 1
#events = 2
#events = 3
#events = 4
#events = 5
#events = 6
#events = 8
#events = 10
	B
	C
	D
	E
0
0.5
1
0
0.2
0.4
0.6
0.8
1
1-Specificity
Sensitivity
ROC: motion - no motion
0
0.5
1
0
0.2
0.4
0.6
0.8
1
1-Specificity
Sensitivity
ROC: visible artifacts: none - mild
0
0.5
1
0
0.2
0.4
0.6
0.8
1
1-Specificity
Sensitivity
ROC: visible artifacts: none - moderate
0
0.5
1
0
0.2
0.4
0.6
0.8
1
1-Specificity
Sensitivity
ROC: visible artifacts: none - severe
N = 1
N = 2
N = 3
N = 4
N = 5
N = 6
#events = 1
#events = 2
#events = 3
#events = 4
#events = 5
#events = 6
#events = 8
#events = 10
	F
	G
	H
	I
Figure 5.5: For F IDnavAllC (a-d) and for F IDnavAllCmov (e-h): show receiver operating characteristic (ROC)
curves for different settings of relevant channels N (N) and the number of detected motion events (#events) during
the scan and its respective speciﬁcity and sensitivity for identifying the level of motion corruption.
elements as well as the scanner type does not have a signiﬁcant effect on the FIDnav variability.
Therefore, all following FIDnav evaluations will be performed separately for the 1.5 and 3T
data.
Going back to the FIDnav signal standard deviation σF IDnav among all channels the
42

5.3. Results
motion detection capabilities were as following. Data from 1.5T scanners are detected to
be motion corrupted or not with a sensitivity of 82% and a speciﬁcity of 87% (Fig. 5.6a).
Images with mild motion corruption are identiﬁed with a sensitivity of 83% and a speciﬁcity
of 80%. Sensitivity and speciﬁcity of 89% and 87% respectively is observed for moderate
motion. Severely corrupted images can be detected with a 100% reliability. For 3T data
according to Fig. 5.6b images with mild artifacts can be identiﬁed with a sensitivity and
speciﬁcity of 73% and 81% respectively. Images with moderate artifacts can be detected with a
sensitivity and speciﬁcity of 80% and 90%. Images corrupted by severe motion are detected
with 100% sensitivity and speciﬁcity. Images with and without motion cluster at a sensitivity
and speciﬁcity rate of 78% and 81% respectively.
0
0.2
0.4
0.6
0.8
1
0
0.2
0.4
0.6
0.8
1
1-Specificity
Sensitivity
ROC: VFIDnav for 1.5T
motion - no motion
none - mild
none - moderate
none - severe
	B
0
0.2
0.4
0.6
0.8
1
0
0.2
0.4
0.6
0.8
1
1-Specificity
Sensitivity
ROC: VFIDnav for 3T
motion - no motion
none - mild
none - moderate
none - severe
	C
Figure 5.6: Shows the receiver operating characteristic (ROC) curves for a range of the standard deviation chosen as
a detection limit [0.5 2.3] and its respective speciﬁcity and sensitivity for distinguishing groups of different artifact
severity for the scanners of 1.5T and 3T ﬁeld strength.
A similar evaluation was performed to ﬁnd an optimal design for a detector based on
F IDnavNCmax with respect to the number of relevant coil elements NNCmax (Fig. 5.7). The
results show that for NNCmax = 3 and without any motion events the best sensitivity and
speciﬁcity can be achieved to identify images without artifacts. Here, a sensitivity of 69% and
a speciﬁcity of 92% were possible. Setting NNCmax to 5 provided the best ROC for identifying
images with mild artifacts of 53% and 85% sensitivity and speciﬁcity respectively. To detect
images with moderate artifacts best results are achieved for NNCmax = 3 with sensitivity at
93% and speciﬁcity at 92%. For identifying images with severe artifacts NNCmax seems to
be irrelevant. Data with ≥20 motion events correspond to severe image degradations with
sensitivity and speciﬁcity equal to 100%. We could also observe that taking more than 6 coil
elements for the calculation of the F IDnavNCmax did not improve the motion detection
results. Hence, for further analysis we will set the number of relevant coil elements to N = 3
and refer to this FIDnav based detector as F IDnav3Cmax i.e., a mean of the maximal signal
change from three channels is taken for all further analysis.
43

Chapter 5. FID-based Motion Sensitive Quality Metric and Retrospective Motion
Correction for Clinical Magnetic Resonance Images
0
0.5
1
0
0.2
0.4
0.6
0.8
1
1-Specificity
Sensitivity
ROC: motion - no motion
0
0.5
1
0
0.2
0.4
0.6
0.8
1
1-Specificity
Sensitivity
ROC: visible artifacts: none - mild
0
0.5
1
0
0.2
0.4
0.6
0.8
1
1-Specificity
Sensitivity
ROC: visible artifacts: none - moderate
0
0.5
1
0
0.2
0.4
0.6
0.8
1
1-Specificity
Sensitivity
ROC: visible artifacts: none - severe
N = 1
N = 2
N = 3
N = 4
N = 5
N = 6
#events = 1
#events = 2
#events = 3
#events = 4
#events = 5
#events = 6
#events = 8
#events = 10
Figure 5.7: Receiver operating characteristic (ROC) curves for F IDnavNCmax as motion detector with different
settings of relevant channels NNCmax (N) and number of detected motion events (#events) during the scan and its
respective speciﬁcity and sensitivity for distinguishing groups of different artifact severity.
5.3.4
FIDnav Based Motion Classiﬁcation Based on k-space Location
To make use of the additional information in the FIDnav on the time where motion was present
during the acquisition we apply a weight to every motion event depending on its location in
k-space. We will investigate a parabolic as well as a Gaussian weight curve and will aim at
ﬁnding the optimal parameters for the respective curves. For the parabola we aim at ﬁnding
the optimal crossing with the horizontal axis and for the Gaussian at the optimal σ. For both
weight curves the vertex is ﬁxed to be 1 for a motion event occurring at k-space center. The
ﬁnal FIDnav motion score FIDI is then calculated as a sum of weighted F IDnav3Cmax values
at the k–space location, where a motion event was identiﬁed. We investigated different weight
curves again with respect to sensitivity and speciﬁcity of the resulting weighted F IDnav3Cmax
for its ability to detect motion in the underlying data set. Both, Gaussian and parabolic weight
curves present near to identical results (Fig. 5.8). For the Gauss weight curve the best setting
was identiﬁed to be σ = Nlin/2.3 and the parabola to cross the horizontal axis at Nlin/1.5 with
Nlin being the total number of k–space lines. The Gauss weighting performs by 1% better than
the parabolic weighing in identifying the data with mild artifacts with a sensitivity of 53% and
a speciﬁcity of 86%. For other groups the performance is identical. Images with moderate
artifacts can be identiﬁed with a speciﬁcity of 100% and sensitivity of 92%. Severely motion
corrupted images can be detected with a 100% sensitivity and speciﬁcity rate.
Due to better performance of the Gaussian weight curve we continue our evaluation
with it. Now we aim at ﬁnding the optimal thresholds for the FIDnav based motion index
FIDI which divides the given data into the four artifact groups (none, mild, moderate, and
severe) by performing a logistic regression (Fig. 5.9). Based on the regression results we
identiﬁed the following FIDI thresholds for each of the groups: FIDImotion ≥8, FIDImild ≥13,
FIDImoderate ≥40, FIDIsevere ≥205. These are the values of FIDI where the regression curve
crosses the 0.5 probability value. The higher the FIDnav based index FIDI the higher the
chance of the image to be motion corrupted e.g., a FIDI higher or equal 8 may correspond to a
dataset with motion artifacts.
Also, a comparison with an existing quality metric QI as proposed by (Maréchal, 2011;
Mortamet et al., 2009) was performed (Fig. 5.10). Both, QI and FIDI perform well on the
44

5.4. Discussion
0
50
100
0
0.2
0.4
0.6
0.8
1
Weight curves
line number in k−space
weight
0
0.5
1
0
0.2
0.4
0.6
0.8
1
1−Specificity
Sensitivity
ROC: motion − no motion
0
0.5
1
0
0.2
0.4
0.6
0.8
1
1−Specificity
Sensitivity
ROC: visible artifacts: none − mild
0
0.5
1
0
0.2
0.4
0.6
0.8
1
1−Specificity
Sensitivity
ROC: visible artifacts: none − moderate
0
0.5
1
0
0.2
0.4
0.6
0.8
1
1−Specificity
Sensitivity
ROC: visible artifacts: none − severe
	B

	C
	D
	E
	F
0
50
100
0
0.2
0.4
0.6
0.8
1
Weight curves
line number in k−space
weight
0
0.5
1
0
0.2
0.4
0.6
0.8
1
1−Specificity
Sensitivity
ROC: motion − no motion
0
0.5
1
0
0.2
0.4
0.6
0.8
1
1−Specificity
Sensitivity
ROC: visible artifacts: none − mild
0
0.5
1
0
0.2
0.4
0.6
0.8
1
1−Specificity
Sensitivity
ROC: visible artifacts: none − moderate
0
0.5
1
0
0.2
0.4
0.6
0.8
1
1−Specificity
Sensitivity
ROC: visible artifacts: none − severe
	G
	H
	I
	J
	K
Figure 5.8: ROC curves for the weighted F IDnav3Cmax with different shapes of the weight functions and its ability
to distinguish data sets of different artifacts groups: (a-d) Gaussian weights (f-i) parabolic weights. Color code
corresponds to the respective shape of the weight function in (e) and (j).
0
50
100
150
200
250
300
350
0
0.2
0.4
0.6
0.8
1
FIDI
P(artifact)
Logistic regression for artifact classification based on FIDI
motion-no motion
none-mild
mild-moderate
moderate-severe
Figure 5.9: Logistic regression for FIDI and its probability to correspond to a different artifact groups.
detection of data sets with severe and no motion artifacts. For mild and moderate motion
there is a discrepancy in both indexes.
5.4
Discussion
5.4.1
Advantages and Limitations of the Utilized Motion Correction
The recent studies have shown that motion in MRI examinations has a noticeable effect on
the clinical workﬂow and presents a non-negligible ﬁnancial impact due to rescans or patient
sedation. In this study we further explore the problem of motion in a clinical setting by
analyzing 109 clinical MP–RAGE images. Based on the expert radiologist ratings we report
the estimates on the prevalence and severity of motion artifacts and ﬁnd them similar to the
45

Chapter 5. FID-based Motion Sensitive Quality Metric and Retrospective Motion
Correction for Clinical Magnetic Resonance Images
0.5
1
1.5
0
2
4
6
8
QI
log(FIDI)
FIDI vs. QI
none
mild
moderate
severe
Figure 5.10: FIDI with its threshold indicated by a dashed line at 8 for FIDI for detection motion corrupted images.
The lower the QI value the better the image quality.
previous studies. We also apply a retrospective motion correction technique to the collected
data and based on the expert ratings conﬁrm the ability of the method to improve the image
quality.
We have evaluated blind and FID–guided motion correction methods in order to assess
their ability to handle the clinical data. We observed that FID-guided motion correction
approach performed better than blind correction except for a single case, where the correction
introduced spurious ringing to the image. Since the original image is preserved, however,
unlike after prospective motion correction, it would be still possible to use the uncorrected
data for a ﬁnal diagnosis.
Although, after FID–guided motion correction the images were all rated to be of a clinically
useful quality, not all motion artifacts could be fully removed. This is due to a major limitation
of retrospective correction techniques when it comes to severe head motion that leads to
missing k-space data, which cannot be restored after the image has been acquired.
5.4.2
Advantages and Limitations of FIDnav-Based Motion Detection
Computer-aided disease prediction from quantitative image analysis requires high resolution
MR data which should not have artifacts due to motion. This opens a new ﬁeld of automated
image quality calculations that assess the reliability of the quantitative results, for example
in brain volume segmentations. A reliable image quality index might be able to eliminate
the necessity to visually examine the image itself and for disease prediction just rely on the
reported volume numbers instead. To our knowledge, only few automated and reference free
motion sensitive quality criteria have been explored. Mortamet et al. (2009) rely on evaluations
of the background noise in the image to assess the image quality quantitatively. Lin et al. (2007)
and McGee et al. (2000) propose the use of a gradient entropy which evaluates the edges i.e.,
sharpness of an image. Another index for image quality is the signal-to-noise ratio (SNR) and
46

5.5. Acknowledgement
is traditionally used for MR images (Kaufman et al., 1989).
We present a novel methodology to quantitatively assess the image quality based on the
recently proposed FID signal. Such FID signal or FIDnav can be added easily to a sequence
with only minimal timing requirements and be used to observe the signal ﬂuctuations during
the scans. Since it is known that the FIDnav, as any MR signal, depends on the proximity of the
examined object to the receive coil it is possible to relate ﬂuctuations in the acquired signal
directly to motion. By observing the FIDnav temporal behavior it is also possible to provide
information on the time when motion occurred during the acquisition and stop the scanning
if too many motion events are identiﬁed. We propose a novel formulation of an FID signal
based quality index FIDI and suggest an empirical threshold to identify motion corrupted
images for FIDI≥8. In this study we decided not to use any of the established classiﬁcation
techniques from the ﬁeld of machine learning and rather design a classiﬁer ’by hand’ for better
understanding of the chosen classiﬁer features. This ’white box’ approach, however, limits
us to fully investigate the reliability of the classiﬁer as well as potentially more features that
could yield better performance. Further, the relatively low sample size of 109 cases might not
be sufﬁcient to show robust statistical behavior of the classiﬁer. However, due to the high time
effort for the rating and ranking of the images we consider the current data set adequate to
derive ﬁrst conclusions from this pilot study. Although, our data set exhibits similar numbers
for prevalence of motion as in studies with higher sample size indicating representative results,
we assume that higher classiﬁcation robustness would be achieved with more data sets.
The FIDnav signal is not only sensitive to rigid head motion, it can be also inﬂuenced
by any non-rigid motion as swallowing or other mouth movements. Such non-rigid motion
might not have a severe impact on the resulting image quality, hence, this would lead to a
discrepancy in the reported FIDI and the underlying, possibly nonexistent, motion artifacts in
the region of interest, i.e., anatomies relevant for diagnosis.
5.4.3
Future Work
Future work will focus on the integration the retrospective motion correction techniques as
well as the proposed quality index into the clinical workﬂow. This would make it possible to
conduct large scale studies and to assess the direct impact on the diagnosis. Other FIDnav-
based classiﬁers for the detection of motion corrupted images as well as classical data mining
methods such as random forests or support vector machines could be investigated to identify
motion relevant features of the FID signal and classify the data even more reliably.
5.5
Acknowledgement
We would like to thank Sebastian M. Waszak, Alexis Roche, Davide Piccini, Guillaume Bonnier,
Tom Hilbert, Mario Fartaria De Oliveira, and last but not least Pavel Falkovskiy for valuable
discussions and suggestions.
47


6 Prospective Head Motion Correction
with FID-Triggered Image Navigators
This chapter is based on published work from Babayeva et al. (2014a) and
Babayeva et al. (2015a).
Abstract Motion is still a major source of artifacts in clinical magnetic resonance imaging. To
manage motion we explore the utilization of a multi-channel FID signal for subject’s head
movement monitoring in order to employ an MR image navigator based correction only when
relevant motion occurred. The acquisition of the FID signal as well as the image navigator is
integrated into a three-dimensional MP-RAGE sequence to correct for rigid head motion dur-
ing the acquisition. We introduce two different methods to extract binary motion information
from the FID signal, which is highly sensitive to positional changes of the head and is used
to trigger the acquisition of the image navigator. The image navigator is then co-registered
to a reference image to obtain the motion parameters and to adjust the scanning orientation
respectively when needed. The image navigator is speciﬁcally designed to match the acoustic
and magnetization characteristics of the MP-RAGE sequence targeted for correction. We
perform brain volume segmentation and quality index calculations to quantitatively assess
the motion correction performance of the proposed approach.
6.1
Introduction
Reducing motion impact on brain MR imaging would be a great asset to routine and clinical
research applications, making studies more cost-efﬁcient and leading to increased patient
throughput. Despite of many advances in the ﬁeld of rigid motion correction in MRI no
general solution could yet be found (Zaitsev et al., 2015). All suggested correction techniques
target speciﬁc sequences or can correct for only speciﬁc motion types as for example only
in-plane motion.
49

Chapter 6. Prospective Head Motion Correction with FID-Triggered Image Navigators
Motion correction methods are categorized into prospective and retrospective ones. Prospec-
tive methods are applied during the sequence run time by periodically adapting the acquisition
coordinate system to follow the imaged object and have the advantage to be able to com-
pensate even for considerably big motion magnitudes and also to correct for spin history
effects. The prospective motion correction strategies are traditionally based on MR-based
navigators of various complexity (Tisdall et al., 2012; van der Kouwe et al., 2006; White et al.,
2010), external tracking systems as an optical camera with a marker (Zaitsev et al., 2006), or
active coils (Ooi et al., 2013). External tracking hardware can provide very accurate motion
information, be integrated with various sequences, and correct for spin history effects. How-
ever it relies on ﬁducial markers that might not be well tolerated by the subject, and on an
unobstructed ﬁeld of view, which can be compromised by a closed coil design. MR-based
navigators are potentially valuable complements for prospective motion correction as no
additional hardware for external devices is required but a tradeoff between tracking accuracy
and navigator complexity has to be considered. Higher navigator complexity provides better
tracking and hence correction results but may cost more additional scan time or be incompat-
ible with the target sequence design. Retrospective methods address the problem of motion
after the image has been acquired and are ideally independent of the MR imaging modality. A
famous retrospective correction method is called PROPELLER (Pipe, 1999) (also called BLADE
at Siemens context (Fries et al., 2009)), where the center of k-space is oversampled to have
redundant information that is then used to adjust k-space lines to achieve better image quality.
Another class of retrospective correction techniques is based on autofocusing (Atkinson et al.,
1997; Loktyushin et al., 2013). The advantage of these methods is that they can even correct
for non-rigid motion (Loktyushin et al., 2015b), however they are limited by their inability to
address large motion magnitudes, which lead to unrecoverable missing k-space data.
In this investigation, we explore the possibility of a new prospective motion correction
strategy, which utilizes the recently proposed free-induction-decay navigator (FIDnav) (Kober
et al., 2011) for motion monitoring and detection to drive the acquisition of a more complex
image navigator (IMGnav) for motion tracking and correction when needed. This helps to
reduce the scan time and/or gradient activity overhead as required for a repetitive acquisition
of an IMGnav. Moreover, the scan time for FIDnav is almost negligible and the time costly
IMGnav is triggered only if motion occurred.
In this study we focus on the MP-RAGE sequence and a dedicated, i.e., a speciﬁcally for
this sequence designed IMGnav. It needs one TR for its acquisition and has the same number
of RF-pulses in order to have minimum impact on the magnetization proﬁle of the target
MP-RAGE sequence, and has a similar acoustic noise pattern. The FID signal, however, is
acquired every TR at the end of each read-out train during sequence runtime. Only if motion
is detected according to the changes in the FIDnav signal, an IMGnav acquisition is triggered,
followed by registering of the IMGnav to a reference IMGnav volume in order to obtain new
positional information and to change the orientation of the gradients prospectively.
50

6.2. Methods
6.2
Methods
6.2.1
FIDnav Acquisition and Calculation
The purpose of this study was to
1. present different ways of combining the multi-channel FID signal from different coil
elements into a single scalar FIDnav, which is then used for motion detection as already
shown in Chapter 5 for retrospective labeling of motion events in clinical MP-RAGE
images. In order to detect motion events based on the FIDnav a threshold is necessary.
We propose two different ways of setting the threshold. One way is to set the value a
priory to be the same for all subjects and scans (F ID f ast
nav and F IDslow
nav ). This approach
is considered to be more sensitive to motion than the method prosed in (Kober et al.,
2011) as only channels with maximal signal change are considered. The other way is to
set the threshold according to statistical characteristics of the signal which are estimated
during the scan based on few FIDnav samples from the beginning of the acquisition
(F IDtheo
nav ) similar to the technique proposed in (Kober et al., 2011). Both threshold
setting scenarios have their advantages and disadvantages and will be discussed later.
2. investigate how well the FIDnav reacts to different types of motion (head nodding,
shaking, and head-feet translation)
The functionality was implemented in a prototype MP-RAGE sequence. An FID signal
was sampled (α = 9◦, 64 points in 0.2 ms, TI = 1532 ms) following an additional non-selective
excitation pulse at the end of the GRE block of the MP-RAGE sequence. The FIDnav was
evaluated in different ways to detect motion events. One modiﬁcation of the FIDnav was
meant to be able to detect slow motion (e.g., muscle relaxation) and fast head motion (e.g.,
rapid head turning). To distinguish signal changes due to motion an empirical threshold was
chosen. These FID signal calculations we will refer to as F ID f ast
nav and F IDslow
nav . The other
way of the FIDnav calculation relies on an adaptive threshold which was calculated based on
several FID signal values from the beginning of the scan to avoid the need for an empirical
setting of threshold. These values were used to calculate expected statistical properties i.e.,
mean and variance of the signal to detect outliers. Outliers were then classiﬁed as motion
events. We will refer to this FIDnav as F IDtheo
nav .
For the detection of rapid and slow head movements with an empirical threshold, a scalar
FIDnav value was calculated by combining the signals from coil elements where the signal
change was maximal among all channels. Rapid motion at a time point t is observed by
signal changes as compared to the preceding repetition at (t −1), whereas slow movements
at time t are reﬂected by FIDnav changes as compared to the ﬁrst repetition of the scan (see
Eq. 6.1). An empirically derived threshold of 5% increase in FID signal for slow movements
and 8% signal change for fast movements was chosen to trigger the acquisition of an IMGnav.
During pre-scans these thresholds proved appropriate with respect to non-motion related FID
51

Chapter 6. Prospective Head Motion Correction with FID-Triggered Image Navigators
signal ﬂuctuations, which cause higher scan run times due to unnecessary motion correction,
and sensitivity to detect real motion events. Here, |s(n)| is the absolute value of the complex
average of all points from one single FID read-out acquired in the t th repetition, and c denotes
the coil element. The avg3Cmax operator takes the FIDnav from those three coil elements
where the signal change is maximal and averages them and the avg AllC takes the average over
all coil elements. We used the average of three coils to minimize the effect of random signal
ﬂuctuations. The ﬁrst two signal time points (equals the ﬁrst two TRs) were excluded from
the FIDnav calculation due to the signal not being in steady-state yet i.e., |s(3)| is used for
signal normalization. Hence the motion detection starts at the third TR. If either F ID f ast
nav or
F IDslow
nav exceeded the empirical threshold then the respective TR was considered to contain a
motion event.
F ID f ast
nav (t) = avg3Cmax

|s(t)|−|s(t −1)|
|s(3)|
 F IDslow
nav (t) = avg AllC

|s(t)|−|s(3)|
|s(3)|

(6.1)
The adaptive threshold for the FIDnav with a theoretical value was calculated based on
statistical behavior of the signal. For this FIDnav we evaluated the FID signal by calculating its
temporal standard deviation σAllC for every channel separately (see Eq. 6.2). If the FIDnav
of any single time point t revealed a signal change higher than 3σAllC in comparison to the
previous repetition t −1 in more than one channel then this TR was considered to contain
a motion event similar to F ID f ast
nav . If only one channel detects a signal change no action is
taken as due the symmetry of the acquisition head coil it is considered not plausible that
signal changes in only one channel can be caused by rigid body motion. We assume that if
only one single channel detects FID signal changes, then these changes might be caused by
other effects than motion. The detected motion events were excluded from the calculation of
σAllC. The ﬁrst two signal time points were again excluded from the evaluation as the signal
was not considered to be in steady state yet. The next two time points were used to calculate
the initial value of σAllC, such that motion detection could start only at the ﬁfth signal point
or TR after the start of the scan. Once, the ﬁfth TR is reached motion detection is possible at
any TR.
F IDtheo
nav (t,c) =

|s(t,c)|−|s(t −1,c)|
|s(3,c)|

(6.2)
52

6.2. Methods
6.2.2
MP-RAGE Data Acquisition and Experimental Design
The MP-RAGE images were acquired with the following parameters: TI/TR/TE/α/TA =
900ms/2300ms/2.86ms/9°/5:21min, echo-spacing 7 ms, matrix 256 × 256 × 176, 1.0 mm3
isotropic, 2×iPAT with 32 ref. lines.
Two datasets were collected using different modiﬁcations of the FIDnav (F ID f ast
nav , F IDslow
nav
and F IDtheo
nav ) as described in the previous section and different motion patterns were inves-
tigated. After obtaining written consent, 10 healthy volunteers were scanned - ﬁve for each
dataset. Based on the FIDnav, motion events were detected and the prospective acquisition
of the IMGnav was triggered. The IMGnav was then co-registered to its reference from the
beginning of the scan to derive new positional information of the head and to adjust the
acquisition orientation accordingly (Fig. 6.1). The motion corrupted repetition was reacquired
immediately after.
The ﬁrst dataset A was acquired at 3T (MAGNETOM Verio, Siemens AG, Erlangen, Germany)
operating under the VB17 software version and using a commercial 32-channel head coil. The
subjects were instructed to change their head position three times during a scan upon verbal
commands and to follow frequently observed motion patterns (Gedamu and Gedamu, 2012):
translation in head-feet direction, head nodding, and shaking. The motion was performed as
a one-time-event by repositioning the head accordingly and remaining in this position until
the next verbal command. These scans were repeated by having the motion correction turned
on and off to see the image quality changes from the correction technique. Two additional
datasets (I, II) for scan – re scan comparison of images acquired without voluntary motion
and with motion correction turned off but with the acquisition of the IMGnav were acquired
for each subject, resulting in a total of 40 MP-RAGE volumes. To drive the motion correction
F ID f ast
nav and F IDslow
nav were utilized for motion detection. To assess the effect of reacquisition
two sets of images were reconstructed. The ﬁrst set by utilizing the reacquired repetition after
a motion event and the second set without the reacquired data.
The second dataset B was as well acquired a 3T (MAGNETOM Skyra, Siemens AG, Erlangen,
Germany) operating under the VD13 software version and using a commercial 32-channel
head coil and the subjects were again asked to change their head position three times during
the scan but now following a different motion pattern to save scan time due to an extended
experimental design (data acquisition for the evaluation from Chapter 6.2.3). The ﬁrst po-
sitional change is rotating the head to the left side, the second is moving the head back to
center and down at the same time similar to nodding, and last is rotating the head to the right.
Before the next scan the subject was instructed to return its head to the initial position looking
straight up (left-down-right). Each subject was scanned by having the motion correction
mechanism turned on and the motion parameters were stored in a ﬁle. This recorded motion
trajectory was then used in order to recreate the motion artifacts that would appear if no
motion correction was applied as described in (Herbst et al., 2014). This was accomplished
by acquiring a dataset where the subject was instructed to remain still and the previously
53

Chapter 6. Prospective Head Motion Correction with FID-Triggered Image Navigators
180°
MP-RAGE RO-train
FIDnav
TR
rigid registration
…
IMGnav ref
IMGnav
TAIMGnav
IMGnav 1
…
change orientation
no motion detected
motion detected
Figure 6.1: Symbolic depiction of the proposed MP-RAGE acquisition strategy with motion correction based on
FIDnav triggered IMGnavs.
acquired motion trajectory was applied during the scan to change the coordinate system for
each TR. Two additional datasets without voluntary motion and without motion correction
were acquired for each subject for reference. For these datasets without motion no IMGnav
were acquired. This resulted in a total of 20 MP-RAGE volumes. This dataset was used to
explore the triggering reliability of F IDtheo
nav . The images were reconstructed by utilizing the
reacquired repetitions.
We would like to mention here that the data was acquired unintentionally from different
scanners due to the unavailability of the Verio scanner during the study caused by a scanner
software upgrade. Please, refer to Tab. 6.1 for an overview of the acquisition settings and
utilized FIDnav calculation variants. Further, to reduce the scan time per subject due to
an additional experiment that is described in 6.2.3 only one motion scan per subject was
performed in the dataset B. Therefore, a heterogeneous motion pattern (left-down-right) was
introduced to cover different motion directions in a single scan.
6.2.3
IMGnav Acquisition and Image Registration Accuracy
For the IMGnav we used a modiﬁcation of a recently proposed multi-echo segmented 3D-
GRE (Falkovskiy et al., 2016, 2013) but with a cylindrical k-space sampling pattern as shown
in Fig. 6.2b (α/TA = 9°/1.2sec, echo-spacing 7 ms, 6 echoes, matrix size 64×64×32, voxel
size 4.1×4.1×6.0 mm3). The standard MP-RAGE acquisition scheme was adapted to acquire
multiple echoes using bipolar readout gradients. Phase-encoding gradients were inserted
between the readout gradients to sample multiple portions of k-space per each excitation
pulse. The reordering scheme was modiﬁed to group ﬁrst echoes in the center of k-space to
54

6.2. Methods
dataset
MoCo setting
motion pattern
scanner type and
FIDnav and
software version
threshold variant
A.1-A.5
MoCo ON
nodding motion
Verio, 3T, VB17
F IDslow
nav , F ID f ast
nav ,
empirical
thresh-
old
shaking motion
z-translation
MoCo OFF
nodding motion
shaking motion
z-translation
no motion × 2
B.1-B.5
MoCo ON
left-down-right
Skyra, 3T, VD13
F IDtheo
nav , adaptive
threshold
MoCo OFF
inject motion
no motion × 2
Table 6.1: An overview of the acquired datasets with its respective settings for FIDnav variants and motion patterns.
ensure the intended contrast (see Fig. 6.2a). A phase correction algorithm similar to the one
used for EPI acquisitions was applied to remove phase inconsistencies between k-space lines
acquired in the echoes with differing polarity. This correction was computed based on the
lines acquired in the center of k-space.
The acquisition parameters of the IMGnav were speciﬁcally designed to acquire a whole-
brain volume with very similar properties as the GRE block of the host MP-RAGE with respect
to the acoustic noise and impact on longitudinal magnetization. The unacquired k-space
lines and partitions resulting from the cylindrical sampling pattern were zero ﬁlled for image
reconstruction (see Fig. 6.2b).
PAR
LIN
5
10
15
20
25
30
10
20
30
40
50
60
	C

Figure 6.2: a: Acquisition sequence of the IMGnav on an example with two echoes. b: Acquisition design of the
IMGnav; different colors label echo number (red 1st echo, orange 2nd echo, yellow 3rd echo, green 4th echo, blue 5th
echo and purple 6th echo), whereas in white unacquired k-space locations are labeled and are ﬁlled with zeroes for
reconstruction.
55

Chapter 6. Prospective Head Motion Correction with FID-Triggered Image Navigators
To derive the motion parameters from an IMGnav image registration was used. For that we
utilized the 3D PACE registration algorithm used in the motion correction technique (Thesen
et al., 2000). In order to assess the image registration accuracy we performed a simulated
motion experiment. For that we acquired 100 IMGnavs volumes of a human subject in a row.
Each IMGnav was preceded by an inversion pulse resembling the acquisition settings as it
would be embedded into an MP-RAGE host sequence with a TR/TI of 2300/900 ms. For each of
the volumes we changed the orientation or the acquisition according to a prescribed motion
trajectory resembling frequently observed motion patterns (Gedamu and Gedamu, 2012) head
nodding, shaking, and translation along the head-feet direction. This trajectory was recorded
from a moving subject by an optical motion tracking system (Zaitsev et al., 2006) in an earlier
study (Babayeva et al., 2015b) and was provided to the sequence in form of a text ﬁle.
After obtaining written consent ﬁve healthy volunteers were scanned with this sequence at
3T (MAGNETOM Skyra, Siemens AG, Erlangen, Germany) operating under the VD13 software
and using a commercial 32-channel head coil. Subjects were instructed to remain motionless
during the whole experiment. Additionally, 60 IMGnav volumes of a volunteer were acquired
without changing the orientation, while the subject was again instructed to remain still during
the scan in order to assess the registration variance when the subject is at rest.
6.2.4
Quantitative Image Quality Assessment
Motivated by a recent studies in Maréchal et al. (2012); Reuter et al. (2015) the performance
of the proposed correction method was assessed by conducting brain volume segmentation
in three regions using an automated morphometry package (Schmitter et al., 2014). The
segmentation results of the scans with motion and correction, with motion but without
correction or simulated motion respectively, and without motion and without correction were
compared to the reference without motion and correction. We calculated the relative volume
differences between the ‘no motion’ Vnomotion and ‘motion’ Vmotion cases for total intracranial
volume (ΔT IV ), white matter (ΔW M), and gray matter (ΔGM).
Δ =

Vmotion −Vnomotion
Vnomotion
∗100
Further, a quantitative image quality assessment based on the background noise evaluation as
described in (Maréchal, 2011; Mortamet et al., 2009) was performed on all MP-RAGE volumes
to assess the change in the quality index (QI) with and without correction quantitatively as
well with and without reacquisition on the dataset A.
56

6.3. Results
6.3
Results
6.3.1
IMGnav and Its Registration Accuracy
The proposed motion correction can be only as good as the image registration reliability of
the utilized IMGnav. Our experiments revealed that the employed registration framework
was able to extract the motion parameters with a mean absolute error of 0.27±0.38 mm and
0.19±0.24° for translational and rotational motion, however with maximal registration errors
of up to 2.0 mm and 1.3° (see Fig. 6.3c-d). The prescribed artiﬁcial trajectory was in the range
of up to 17.9 mm and 5.5° for translations and rotations respectively (Fig. 6.3b). In Fig. 6.3a the
IMGnav as acquired from one subject is shown and ghosting artifacts in the anterior-posterior
direction on the sagittal and axial view are visible. This is also the phase encoding direction
of the IMGnav acquisition. These artifacts are present in all IMGnav acquisitions from all
subjects. In the experiment where 60 IMGnavs were acquired sequentially and the subject
was asked to stay as still as possible the registration parameters showed motion around the
zero line with the mean absolute translation and rotation of 0.02±0.02 mm and 0.01±0.02°
respectively.
(a)
0
50
100
-10
0
10
tra x [mm]
volume #
0
50
100
-10
0
10
tra y [mm]
volume #
0
50
100
-10
0
10
volume #
tra z [mm]
0
50
100
-5
0
5
rot x [deg]
volume #
0
50
100
-5
0
5
rot y [deg]
volume #
0
50
100
-5
0
5
rot z [deg]
volume #
no motion
nod
z-tra
shake
Subject 1
Subject 2
Subject 3
Subject 4
Subject 5
ground truth
(b)
−20
0
20
−20
−10
0
10
20
registration results
 translation [mm]
prescribed motion
 translation[mm]
−5
0
5
−5
0
5
registration results
 rotation [deg]
prescribed motion
 rotation [deg]
x direction
y direction
z direction
(c)
x
y
z
-0.5
-0.4
-0.3
-0.2
-0.1
0
0.1
0.2
0.3
0.4
0.5
0.6
0.7
0.8
0.9
1
Motion direction
    Translation 
 registration error H [mm]
max. Hx = 0.62 mm
max. Hy = 1.2 mm
max. Hz = 2 mm
x
y
y
-0.5
-0.4
-0.3
-0.2
-0.1
0
0.1
0.2
0.3
0.4
0.5
0.6
0.7
0.8
0.9
1
Motion direction
   Rotation 
 registration error H [deg]
max. Hx = 1.3°
max. Hy = 0.47°
max. Hz = 0.86°
Data (Pabs r V)
(d)
Figure 6.3: a: Sagittal, coronal and axial view of the IMGnav. b: Prescribed motion trajectory for the assessment of
the registration reliability of the IMGnav. Artiﬁcial motion patterns for head nodding ‘nod’, head shaking ‘shake’, and
moving the head in the head-foot direction ‘z-tra’, as well as periods without motion are depicted for rotation and
translation in all six degrees of freedom. The resulting registration results for ﬁve different subjects are also shown. c:
Registration results from all subjects versus the applied motion trajectory for translation and rotation in x, y, and z
directions. d: Registration error for translations and rotations for all ﬁve subjects with its mean of the absolute error
and standard deviation. Also, the maxima of the detected registration errors are shown.
57

Chapter 6. Prospective Head Motion Correction with FID-Triggered Image Navigators
6.3.2
FIDnav, Triggering Events, and Detected Motion
In our motion correction experiments we detected motion of up to 11 mm translation and
9° rotation as can be seen in Table 6.2. The motion correction took place only if the FIDnav
reported a motion event in the corresponding repetition as described in Chapter 6.2.1 i.e.,
deliberate positional changes of the head after verbal commands. Verbal commands were
given to the subjects three times during the acquisition of one MP-RAGE volume, however
more motion events were detected by the FIDnav indicating its high sensitivity to motion or
high amount of false positives (5%). During scans where the subject was asked to remain still
few triggering events occurred. In the case of the dataset A, where F ID f ast
nav and F IDslow
nav was
used to detect motion, the acquisition of the IMGnav was sometimes (in 3 cases) initiated by
the F IDslow
nav approximately after 2/3 of the total scan time as can be seen in Fig. 6.4a. Here,
the registration parameters indicated very small positional changes of the head in the range of
1 mm and 1°.
In the case of subject A.1 for the ‘no motion’ scan a high number of triggering events was
detected but the reported registration parameters did not indicate any signiﬁcant positional
changes of the head and also the image did not show any obvious motion artifacts. For the
dataset B, where F IDtheo
nav was driving the motion correction functionality, a higher amount
of triggering events was detected at the beginning of the scan indicating that the dynamic
threshold is inappropriate due to a low count of data points used for its calculation. True
motion events, which we assume to take place only after verbal commands, were detected in
all cases and the acquisition of the IMGnav was reliably triggered to provide the new positional
parameters to the sequence and to reacquire the motion corrupted repetition.
In some cases several triggering events were detected after a verbal command was given
to the subject to change its head position. In these cases the registration parameters showed
that indeed the subject could not hold the new position immediately and moved its head
even further or slightly back towards the original position (Fig. 6.4b, Fig. 6.5a, Fig. 6.6). This
behavior was also conﬁrmed by the subject in a discussion after the experiment. Overall a
sensitivity of 100% and a speciﬁcity of 95% could be reported if the detected motion events
are considered to be true only after a verbal command. In total there are 139 repetitions and
3 expected motion events per scan (60 scans in total) for acquisitions with intended head
movements. Therefore, out of 8340 total repetitions there were 105 true positive and 395 false
positive motion events.
58

6.3. Results
0
100
200
300
0
10
20
30
FIDnav [%]
time [sec]
0
100
200
300
-2
0
2
x 10
-3
FID signal magnitude 
 for all channels
time [sec]
0
100
200
300
-10
0
10
translation [mm] 
 rotation [deg]
time [sec]
0
100
200
300
0
10
20
30
FIDnav [%]
time [sec]
FIDnav
fast
FIDnav
slow
threshold fast
threshold slow
0
100
200
300
-2
0
2
x 10
-3
FID signal magnitude 
 for all channels
time [sec]
0
100
200
300
-10
0
10
translation [mm] 
 rotation [deg]
time [sec]
tra x
tra y
tra z
rot x
rot y
rot z
(a)
0
100
200
300
0
0.05
0.1
FIDnav signal
time [sec]
abs(FIDnav-P) CH 22
3*V
trigger event
0
100
200
300
-1
0
1
x 10
-3
FID signal magnitude 
 for all channels
time [sec]
0
100
200
300
0
0.05
0.1
FIDnav signal
time [sec]
0
100
200
300
-1
0
1
x 10
-3
FID signal magnitude 
 for all channels
time [sec]
0
100
200
300
-10
0
10
translation [mm] 
 rotation [deg]
time [sec]
tra x
tra y
tra z
rot x
rot y
rot z
(b)
Figure 6.4: The triggering events and the corresponding motion trajectories as well as the normalized FID signal
magnitude from all 32 coil elements are shown. The shown FID signal was shifted to zero for better visual represen-
tation. a: F IDslow
nav and F ID f ast
nav for a subject at rest and performing shaking motion. b: F IDtheo
nav for a subject at
rest and changing head positions to the left, down, and right sides. The absolute FIDnav signal magnitude after
normalization by the moving average μ is shown for one channel. The triggering events, where the dynamic threshold
was exceeded in more than one channel, are also marked.
The proposed motion correction mechanism prolongs the scan time by two TRs after
each triggering event: one TR (2300 msec) for the acquisition of the IMGnav and one TR
for the reacquisition of presumably motion corrupted repetition. On average 8.3 motion
events per volume scan were detected (see Tab. 6.2). The mean extra time, which is spent
due to the enabled motion correction, was 41 seconds per volume scan if we consider all
acquired data sets. In the scans where the subject was asked to stay still on average 4.9 motion
events were detected by the F IDnav f ast and F IDnavslow that correspond to 25 sec extra
scan time per scan. The F IDnavtheo detected on average 7.5 motion events in no motion
scans corresponding to 37 sec additional scan time per scan.
As shown in Fig. 6.5 and Fig. 6.6 artifacts are visible in images without motion correction.
Although, visual improvement of motion corrected compared to uncorrected images is ap-
parent, not all motion artifacts could be removed. In the motion corrected images residual
ringing artifacts or even blurring or ghosting was visible (Fig. 6.5b).
59

Chapter 6. Prospective Head Motion Correction with FID-Triggered Image Navigators
subject
experiment
number of
extra time
maximal
maximal
QI [a.u.]
TIV [ml]
WM [%]
GM [%]
trigger events
[sec]
translation [mm]
rotation [deg]
A.1
MoCo ON, nodding motion
22
103.5
1.79
0.83
0.76
1420.1
27.70
52.67
MoCo OFF, nodding motion
41
190.9
1.20
0.80
0.94
1419.7
27.82
51.42
MoCo ON, shaking motion
18
85.1
2.42
3.50
0.83
1417.8
27.08
52.97
MoCo OFF, shaking motion
20
94.3
2.96
3.38
1.29
1419.7
28.40
51.70
MoCo ON, z-translation
32
149.5
2.87
1.81
0.78
1425.5
27.68
51.56
MoCo OFF, z-translation
17
80.5
3.15
0.30
1.02
1372.7
24.87
54.49
MoCo OFF, no motion I
16
75.9
0.68
0.43
0.69
1420.2
27.85
51.19
MoCo OFF, no motion II
23
108.1
1.17
0.22
0.70
1422.2
28.23
51.19
A.2
MoCo ON, nodding motion
10
48.3
7.03
2.52
0.76
1209.5
28.23
49.61
MoCo OFF, nodding motion
6
29.9
2.32
4.56
0.89
1183.3
27.34
51.72
MoCo ON, shaking motion
4
20.7
7.19
6.40
0.95
1184.3
27.47
51.42
MoCo OFF, shaking motion
5
25.3
10.97
9.26
1.34
1133.4
28.87
50.47
MoCo ON, z-translation
13
62.1
7.15
1.74
0.74
1204.4
28.16
48.57
MoCo OFF, z-translation
9
43.7
6.49
1.14
0.90
1145.5
27.09
51.07
MoCo OFF, no motion I
5
25.3
0.89
0.11
0.72
1204.9
28.15
48.97
MoCo OFF, no motion II
0
2.3
n.a.
n.a.
0.73
1207.9
27.94
48.51
A.3
MoCo ON, nodding motion
4
20.7
2.83
8.09
0.89
1411.9
27.39
53.83
MoCo OFF, nodding motion
3
16.1
3.02
9.46
0.99
1385.8
26.63
52.89
MoCo ON, shaking motion
3
16.1
4.82
4.47
0.89
1410.1
28.08
51.27
MoCo OFF, shaking motion
3
16.1
4.52
4.07
1.11
1369.5
27.38
52.94
MoCo ON, z-translation
13
62.1
10.51
1.90
1.03
1405.8
29.24
49.94
MoCo OFF, z-translation
3
16.1
5.31
0.81
0.92
1373.1
26.04
53.16
MoCo OFF, no motion I
1
6.9
0.58
0.53
0.7
1426.6
29.15
50.05
MoCo OFF, no motion II
1
6.9
1.80
0.78
0.72
1426.4
29.16
49.71
A.4
MoCo ON, nodding motion
3
16.1
2.84
5.85
0.79
1447.9
27.49
55.94
MoCo OFF, nodding motion
4
20.7
3.34
6.00
0.97
1425.8
26.55
54.78
MoCo ON, shaking motion
5
25.3
3.78
6.46
0.92
1447.2
27.07
56.18
MoCo OFF, shaking motion
3
16.1
3.70
3.80
1.13
1423.9
25.44
56.68
MoCo ON, z-translation
4
20.7
2.25
0.16
1.08
1429.0
25.93
55.98
MoCo OFF, z-translation
5
25.3
3.96
0.86
1.18
1440.4
27.54
55.68
MoCo OFF, no motion I
2
11.5
0.83
0.07
0.80
1460.9
28.22
54.08
MoCo OFF, no motion II
1
6.9
0.23
0.03
0.82
1466.4
28.22
53.94
A.5
MoCo ON, nodding motion
4
20.7
6.61
9.30
0.79
1506.4
30.15
49.79
MoCo OFF, nodding motion
3
16.1
4.08
5.27
0.84
1454.2
29.03
50.47
MoCo ON, shaking motion
3
16.1
5.92
6.83
0.76
1500.6
31.15
45.38
MoCo OFF, shaking motion
3
16.1
6.28
7.51
0.79
1481.5
29.38
50.42
MoCo ON, z-translation
6
29.9
7.60
6.09
0.79
1498.3
32.09
46.92
MoCo OFF, z-translation
7
34.5
10.53
3.09
0.91
1476.8
31.88
48.01
MoCo OFF, no motion I
0
2.3
n.a.
n.a.
0.75
1509.8
31.21
46.96
MoCo OFF, no motion II
0
2.3
n.a.
n.a.
0.76
1510.5
31.65
47.40
B.1
MoCo ON, left-down-right motion
9
43.7
2.57
2.51
0.75
1647.0
27.11
54.22
inject motion
5
25.3
n.a.
n.a.
0.81
1645.1
26.12
53.74
no motion I
13
62.1
n.a.
n.a.
0.71
1650.2
27.83
53.57
no motion II
11
52.9
n.a.
n.a.
0.73
1650.3
27.92
54.23
B.2
MoCo ON, left-down-right motion
13
62.1
2.60
3.05
0.68
1581.4
29.99
46.54
inject motion
4
20.7
n.a.
n.a.
0.82
1579.5
28.30
49.95
no motion I
7
34.5
n.a.
n.a.
0.63
1582.9
30.21
47.63
no motion II
11
52.9
n.a.
n.a.
0.63
1584.5
30.10
47.90
B.3
MoCo ON, left-down-right motion
18
85.1
2.41
3.91
0.76
1738.3
27.57
55.28
inject motion
6
29.9
n.a.
n.a.
0.76
1728.6
26.00
55.88
no motion I
4
20.7
n.a.
n.a.
0.63
1753.4
33.00
50.70
no motion II
3
16.1
n.a.
n.a.
0.64
1754.7
32.92
50.95
B.4
MoCo ON, left-down-right motion
9
43.7
3.23
4.31
0.69
1567.8
31.33
48.73
inject motion
12
57.5
n.a.
n.a.
0.84
1553.1
29.08
52.99
no motion I
2
52.9
n.a.
n.a.
0.71
1571.0
32.89
48.25
no motion II
10
25.3
n.a.
n.a.
0.78
1570.4
29.32
52.15
B.5
MoCo ON, left-down-right motion
10
62.1
6.12
6.02
0.79
1855.3
29.98
51.64
inject motion
6
48.3
n.a.
n.a.
0.88
1750.9
28.75
52.14
no motion I
9
29.9
n.a.
n.a.
0.65
1744.9
33.65
48.77
no motion II
13
43.7
n.a.
n.a.
0.64
1707.5
33.39
50.66
Table 6.2: An overview of all acquired data from all subjects with the corresponding number of detected motion
events and the extra scan time which is needed for a the acquisition of the IMGnav and the rescan of the previous
train-echo, which is considered motion corrupted. Also the maxima of the detected motion are shown together with
the results from quantitative image quality assessment through the quality index (QI) and morphological brain
segmentation results for total intracranial volume (TIV), relative white matter (WM), and gray matter (GM).
60

6.3. Results
Subject A.2
0
50
100
150
200
250
300
-10
0
10
translation [mm] 
 rotation [deg]
time [sec]
0
50
100
150
200
250
300
-10
0
10
translation [mm] 
 rotation [deg]
time [sec]
0
50
100
150
200
250
300
-10
0
10
translation [mm] 
 rotation [deg]
time [sec]
tra x
tra y
tra z
rot x
rot y
rot z
0R&R2))
QRPRWLRQ
0R&R2))
]WUDQVODWLRQ
0R&R21
]WUDQVODWLRQ
(a)
Subject A.3
0
50
100
150
200
250
300
-10
0
10
translation [mm] 
 rotation [deg]
time [sec]
0
50
100
150
200
250
300
-10
0
10
translation [mm] 
 rotation [deg]
time [sec]
0
50
100
150
200
250
300
-10
0
10
translation [mm] 
 rotation [deg]
time [sec]
tra x
tra y
tra z
rot x
rot y
rot z
0R&R2))
QRPRWLRQ
0R&R2))
VKDNLQJ
0R&R21
VKDNLQJ
(b)
Subject A.4
0
50
100
150
200
250
300
-10
0
10
translation [mm] 
 rotation [deg]
time [sec]
0
50
100
150
200
250
300
-10
0
10
translation [mm] 
 rotation [deg]
time [sec]
0
50
100
150
200
250
300
-10
0
10
translation [mm] 
 rotation [deg]
time [sec]
tra x
tra y
tra z
rot x
rot y
rot z
0R&R2))
QRPRWLRQ
0R&R2))
QRGGLQJ
0R&R21
QRGGLQJ
(c)
Figure 6.5: Motion correction results from the dataset A together with the detected motion trajectory for different
subjects and motion patterns. An image acquired without any deliberate subject motion is shown for reference
compared to the images with and without the motion correction mechanism in place. Here, the F IDslow
nav and
F ID f ast
nav was used for the detection of motion events a: Subject A.2 with z-translation motion pattern b: Subject A.3
with shaking motion pattern c: Subject A.4 with nodding motion pattern.
61

Chapter 6. Prospective Head Motion Correction with FID-Triggered Image Navigators
Subject B.2
0
50
100
150
200
250
300
-10
0
10
translation [mm] 
 rotation [deg]
time [sec]
0
100
200
300
-10
0
10
translation [mm] 
 rotation [deg]
time [sec]
tra x
tra y
tra z
rot x
rot y
rot z
0R&R2))
QRPRWLRQ
0R&R2))
LQMHFWPRWLRQ
0R&R21
OHIWGRZQULJKW
PRWLRQ
(a)
Subject B.4
0
100
200
300
-10
0
10
translation [mm] 
 rotation [deg]
Wime [sec]
0
100
200
300
-10
0
10
translation [mm] 
 rotation [deg]
time [sec]
tra x
tra y
tra z
rot x
rot y
rot z
0R&R2))
QRPRWLRQ
0R&R2))
LQMHFWPRWLRQ
0R&R21
OHIWGRZQULJKW
PRWLRQ
(b)
Figure 6.6: Motion correction results from the dataset B together with the detected motion trajectory for different
subjects and the left-down-right motion pattern. An image acquired without any deliberate subject motion is
shown for reference compared to the images with and without the motion correction mechanism in place. Here, the
F IDtheo
nav was used for the detection of motion events for a: subject B.2 and b: subject B.4. No motion trajectory for
the ’no motion’ case is provided as no IMGnavs were acquired.
62

6.3. Results
6.3.3
Quantitative Assessment of Image Quality Improvements after Motion Cor-
rection
Quantitative evaluation comparing segmentation results showed a mean absolute segmenta-
tion discrepancy of the data without motion to be at ΔT IV =0.3%, ΔW M=1.6%, and ΔGM=1.7%
with a standard deviation at 0.7% for TIV, at 2.5% for gray matter, and at 3.3% for white matter.
This is similar to values reported in (Falkovskiy et al., 2016). By applying the proposed mo-
tion correction methodology the mean absolute discrepancy in volumes to the ’no motion’
measurements could be signiﬁcantly reduced in our experiments from 2.2% to 0.9% for ΔT IV
and from 7.3% to 3.4% for ΔW M (wrt. the volumes acquired without motion) (Fig. 6.7). The
mean volume difference for gray matter ΔGM was changed from 4.9% to 3.2% but above the
signiﬁcance level at p=0.06.
While, a visual image quality improvement was visible in all motion corrected data not in all
cases a ’no motion’ image quality could be achieved, which is also attested by the segmentation
and QI evaluations. The mean segmentation discrepancy between scan and re-scan data
(ΔT IV =0.3%, ΔW M=1.6%, and ΔGM=1.7%) was less than in the images with motion correction
(ΔT IV =0.9%, ΔW M=3.4%, and ΔGM=3.2%).
The mean QI could be reduced from 0.82 to 0.73 for the dataset B and from 1.01 to 0.86 for
the dataset A. The overall mean QI (datasets A and B) could be reduced signiﬁcantly from 0.96
to 0.83. The lower the QI value the higher the image quality and a mean QI for ’no motion’
data was calculated to be at 0.71. The odd ratio reveals that by using the motion correction
mechanism it is seven times more likely to obtain high quality images according to QI (when
setting the threshold for motion corrupted images to be at QI≤0.82) than without motion
correction in place.
It could be observed that the method had increased difﬁculties with respect to the segmen-
tation discrepancies and QI values in correction for nodding and shaking motion, whereas the
correction of z-translation was providing better qualitative (visible artifacts) and quantitative
results (see Table 6.2).
0R&R2)) 0R&R21 QRPRWLRQ







4,>DX@
0R&R2))0R&R21 QRPRWLRQ







'7,9>@
0R&R2))0R&R21 QRPRWLRQ








':0>@
0R&R2))0R&R21 QRPRWLRQ








'*0>@


Figure 6.7: Quantitative evaluation of the image quality metric QI and the morphological brain volume segmenta-
tion results for data acquired with and without any motion correction (MoCo) compared to data acquired without
motion (no motion) and without motion correction. Data from all subjects and experiments are shown. The stars
indicate the signiﬁcance level p of a rank-sum test (no star represents p>0.05, * represents p≤0.05, ** represents
p≤10−2, *** represents p≤10−3.
63

Chapter 6. Prospective Head Motion Correction with FID-Triggered Image Navigators
6.3.4
Effect of Reacquisition on Image Quality
We also investigated whether the reacquisition of presumably motion corrupted repetition
adds value to the images in terms of image quality and segmentation results. For that two
different reconstructions were compared for the dataset A where the reacquired k-space lines
were utilized or discarded. It could be observed that less ringing in the brain region as well as
in the background was visible for all inspected motion patterns in the reconstructions with
reacquisition (Fig. 6.8). This observation was also conﬁrmed by the quantitative evaluation of
the quality index.
6XEMHFW$QRGGLQJPRWLRQ
ZLWK
UHDFTXLVLWLRQ
ZLWKRXW
UHDFTXLVLWLRQ
DEVROXWH
GLIIHUHQFH
(a)
6XEMHFW$]WUDQVODWLRQ
(b)
6XEMHFW$VKDNLQJPRWLRQ
(c)
Figure 6.8: Reconstruction results from data with and without utilizing the reacquired repetitions as well as the
absolute difference image from the two different reconstructions. a: Subject A.1 performing nodding motion. b:
Subject A.3 performing motion in head-feet direction i.e., z-translation. c: Subject A.4 performing shaking motion.
As shown in Fig. 6.9 a mean QI of 1.07 was observed for images where no reacquisition
was applied that is not signiﬁcantly different from the QI of images without any motion
correction (QI without correction: 1.01). This can be explained by QI’s sensitivity to remaining
background artifacts in images that were reconstructed without the use of reacquired lines.
However, no signiﬁcant differences in the brain volume segmentation discrepancies between
motion corrected images with and without reacquisition was evident (Fig. 6.9).
0.8
1
1.2
1.4
1.6
QRUHDFTXLVLWLRQ
ZLWKUHDFTXLVWLRQ
QI [a.u.]
0
5
10
'TIV [%]
0
5
10
'WM [%]
0
5
10
'GM [%]
QRUHDFTXLVLWLRQ
ZLWKUHDFTXLVWLRQ
QRUHDFTXLVLWLRQ
ZLWKUHDFTXLVWLRQ
QRUHDFTXLVLWLRQ
ZLWKUHDFTXLVWLRQ
Figure 6.9: Quantitative evaluation of the image quality metric QI and the morphological brain volume segmenta-
tion results for data acquired with motion correction on but reconstructed with and without the use of the reacquired
repetitions. Data from all subjects from set A are shown. The stars indicate the signiﬁcance level p of a rank-sum test
(no star represents p>0.05, * represents p≤0.05, ** represents p≤10−2, *** represents p≤10−3.
64

6.4. Discussion
6.4
Discussion
6.4.1
Registration Accuracy of IMGnav
To properly assess the motion estimation capabilities of the proposed method in the best
possible way would be the use of a physically moving object e.g., a moving phantom where
the motion coordinates are exactly known and can serve as ground truth. Such a device
must be furthermore MR compatible and the applied motion should be synchronous to
the sequence. Unfortunately, it is not trivial to create such a device. Hence, other ways of
estimating the accuracy of the correction method have to be established. Several motion
correction techniques utilizing an imaging navigator have been already proposed. For each
of the methods also the motion prediction performance of the navigator was assessed. The
registration parameters of the vNAV (Tisdall et al., 2012) were estimated through a stationary
phantom resembling a pineapple. The authors report registration accuracies in the μm and
10−5° range. Another study showed that the motion detected by the vNAV from a subject at rest
was below 1 mm and 1° (Alhamud et al., 2012) and did not inﬂuence the sequence targeted for
correction. PROMO (White et al., 2010) reports motion prediction errors below 10% of applied
ground truth motion and tNAV is able to provide motion parameters with an accuracy of ±0.5
mm and ±0.5° (Lin et al., 2014). In a study where the motion detection accuracy of PROMO
was compared to a camera system for motion tracking (Gumus et al., 2015) the authors report
a registration accuracy with a mean absolute error within 1 mm and 1 degree with maximal
errors up to approximately 2.2 mm and 2.9 degrees.
We proposed a novel approach to estimate the accuracy of the IMGnav by changing the
ﬁeld of view position and orientation during the scanning process to simulate motion and
hence having ground truth motion trajectory for the registration. This enabled us to assess the
registration accuracy of our IMGnav and the reliability of the motion correction methodology.
This approach, however, does not resemble the real effects of motion within a scanner and its
implications on the image quality of the IMGnav. Positional changes during the acquisition
process might not only invalidate the shimming settings but also change the appearance of
the IMGnav or even introduce additional artifacts. These effects are not considered in this
simulated motion case. Therefore we consider our reported accuracy, which also congruent
with reviewed literature, to be the ’best case’ accuracy without taking into account the pos-
sible unintentional movements of the subject during the artiﬁcial application of the motion
trajectory.
The proposed IMGnav also shows ghosting artifacts in the anterior-posterior phase encod-
ing direction. These artifacts might be the reason for the reduced registration accuracy for
motion in this direction (translation in z, rotation in x).
65

Chapter 6. Prospective Head Motion Correction with FID-Triggered Image Navigators
6.4.2
FIDnav Triggered Motion Detection and Correction
We proposed several ways to calculate an FIDnav from the multi-channel FID signal magnitude.
The FID signal can be added to practically any sequence without having an impact on scan
time or the magnetization proﬁle of the host sequence. The F IDslow
nav and F ID f ast
nav allow to
detect motion events reliably already after reaching a steady-state (after two repetitions in the
MP-RAGE case). However, the main challenge is the setting of the triggering threshold. Our
choice of the threshold was based on experience values (F IDslow
nav , F ID f ast
nav ), although, setting
a ﬁxed threshold for all subjects contradicts the reported ﬁnding from (Babayeva et al., 2015b).
Here, it was shown that nevertheless the FID-signal contains accurate motion information the
correlation to actual motion parameters is subject speciﬁc. Hence, the motivation to propose
another FIDnav F IDtheo
nav , where the threshold is set dynamically during the acquisition. In
order to achieve this two data points from the beginning of the scan have to be sacriﬁced
to assess the statistical behavior of the FIDnav and to initialize the thresholding process.
Although, this method eliminates the need of an empirical value for the detection of the motion
events it highly relies on the fact that no motion is expected during the initialization time. If
motion would be present already at the beginning of the acquisition the dynamic threshold
would be set too high and the FIDnav would be blind towards true motion in subsequent scan.
Hence, the ﬁrst approach with the use of a empirical threshold is considered advantageous
over the second proposal for reliable motion detection. This, however, would require a training
data set to establish such a threshold which includes patient, hardware and sequence speciﬁc
parameters as demonstrated in (Babayeva et al., 2015b). Nevertheless, it was possible to
detect all motion events reliably and also to trigger the motion correction functionality of the
sequence in our experiments. The relatively high number of false positive triggering events
indicate that our choice of the threshold was set too sensitive to apparently motion non-related
FIDnav signal ﬂuctuations as no image artifacts were visible in the corresponding datasets.
These additional triggering events prolong the scan-time unnecessarily. For both FIDnav
variants false positive motion events occurred such that no conclusion on the sensitivity of
them can be derived.
Further, it is to mention that our experiments did not include all motion patterns as
continuous motion or non-rigid motion. Non-rigid motion as swallowing would have an
inﬂuence on the FIDnav and might lead to false positive triggering events. It would be possible
to detect slow continuous motion by the F IDslow
nav but not by F IDtheo
nav as it calculated based on
the ﬁrst temporal derivative of the FID signal. Additionally, FID signal drifts, as also observed
in (Babayeva et al., 2015b), cause the F IDslow
nav to detect a false positive motion event. We
observed this to be a rare scenario and the beneﬁt of the ability to detect also slow motion
justiﬁes its use.
In order to be able to set the optimal threshold for the chosen FIDnav it would be best to
start the sequence with a set of IMGnavs together with FIDnavs which is then used to assess
the possible presence of motion. If motion was present during the acquisition of the IMGnav
set, then the resulting motion parameters could be used to ﬁnd the linear combination of the
66

6.4. Discussion
multi-channel FIDs and be able to predict the motion during the image acquisition without
the further need of the IMGnav but based only on the FID signal. Such an approach would
even beneﬁt from a wide range of motion. Another, scenario would be when no motion was
present during the acquisition of the IMGnav set. This would then allow us to trust into the
calculated statistics of the FIDnav and to rely on the ’dynamic’ threshold.
6.4.3
Advantages and Limitation of the Proposed Motion Correction Method
The present approach extends recent work on MR-based motion correction (Tisdall et al., 2012)
in the sense, that motion is monitored with practically no penalty with fast and low-impact
FIDnavs and the imaging navigators are employed only when needed without inﬂuencing the
magnetization proﬁle of the host sequence. We propose a novel IMGnav which is speciﬁcally
designed to match the properties of the host MP-RAGE sequence in terms of acoustic noise
and magnetization proﬁle i.e., the same number of excitations during a read-out train. The
sound during the acquisition of the IMGnav differs slightly from the MP-RAGE read-out and
can be considered beneﬁcial as a means of signalizing the subject that a motion event was
detected and the subject has to remain still. It could be shown that signiﬁcant improvement
in image quality from scans with deliberate subject motion could be achieved. For that we
chose to use as markers for image quality the segmentation results as well as a quality index
based on image background evaluations. The segmentation discrepancies could be reduced
by the proposed motion correction for the total intracranial volume and for white matter but
not for grey matter.
While the motion related artifacts could be reduced in all cases achieving the quality of the
’no motion’ images was difﬁcult. Residual ringing and ghosting artifacts were visible in images
with motion correction. We assume that it is caused by the limited registration accuracy of the
IMGnav due to ghosting artifacts in its anterior–posterior direction. We showed in simulated
motion experiments that the registration reliability of the IMGnav had a mean absolute error
of 0.24±0.34 mm and 0.18±0.22°. However, we assume that real motion within the scanner
bore could signiﬁcantly impair this result. At the same time, this experiment was performed
on a human such that the reported registration accuracy also includes additional errors due
to physiological or unintentional motion of the subject’s head during the acquisition. As the
main design decision for the IMGnav was the same number of excitations as the MP-RAGE
host sequence the settings of the IMGnav have to change in case the number of partitions of
the MP-RAGE sequence needs to be adapted.
Also, in the current proof-of-concept implementation we did not set any limit to the
reacquisition of the presumably corrupted echo-trains. Theoretically if the subject would
continue moving there will be an inﬁnite number of reacquisitions and the sequence would
never stop. In (Tisdall et al., 2012) the authors propose to move the reacquisition to the end
of the scan and limit it to a preset number of echo-trains with most severe motion. Another
reacquisition strategy might be to reacquire the corrupted repetitions immediately but limit
67

Chapter 6. Prospective Head Motion Correction with FID-Triggered Image Navigators
it to a single reacquisition per repetition to ensure that the sequence would end eventually.
The simplest and most efﬁcient solution would be not to reacquire any repetitions at all. Our
evaluations showed that reacquisition, while providing visually more appealing images, does
not add signiﬁcant value in terms of volume segmentation discrepancies. Nevertheless, it was
possible to show that such a concept towards a motion correction method which utilized the
FID-signal can provide valuable improvement in image quality when motion is present during
the acquisition.
6.4.4
Future Work
Future work should aim at the implementation of an automated and subject speciﬁc FIDnav
threshold adaptation and at reducing the scan time overhead due to IMGnav acquisition
through a motion prediction approach as proposed in (Babayeva et al., 2013, 2015b). Also,
the implementation of an efﬁcient reacquisition strategy would reﬁne the motion correction
capability of the proposed method. Furthermore, additional experiments are needed to
reveal the reason for imperfect correction results and to set the limits for correctable motion
magnitudes similar to PACE (Thesen et al., 2000). It would be also interesting to extend the
proposed motion correction strategy, employing FIDnav driven triggering of IMGnavs, to
other sequences. Especially 2D might be of interest here (e.g., the turbo-spin-echo sequence
(TSE)).
6.5
Acknowledgement
We would like to thank Sebastian M. Waszak, Alexis Roche, Davide Piccini, and Mario Fartaria
De Oliveira for valuable discussions and suggestions.
68

7 Host Sequence Inﬂuence on FID Sig-
nal
Abstract When acquiring a free induction decay (FID) signal within another sequence, also
called host sequence, the FID might be inﬂuenced by it. Here, we investigated two differ-
ent imaging sequences: the gradient–echo (GRE) and the magnetization–prepared rapid
gradient–echo (MP–RAGE) sequences and their effects on the FID signal on phantom scans in
comparison to an acquisition where only the FID signal (FIDnav only) was acquired without
embedding it into another sequence.
In this thesis work we have exploited the ability of the FID signal to detect subject’s motion.
Therefore, we investigated two different imaging sequences: GRE and the MP–RAGE sequences
where an FID acquisition was added to the normal imaging sequence. In this context it was
important to investigate to which extent the FID signal is affected by the surrounding gradients
and excitations pulses.
In the GRE case the FID acquisition was added every 10th repetition or TR (temporal
resolution of 100 ms) and in the MP–RAGE at the end of every read-out train every TR. The
acquisition parameters were as shown in Tab. 7.1. In the ’FIDnav only’ acquisition only the
FID signal was sampled every TR with an excitation pulse of 8◦in order to have a reference
FIDnav signal without any inﬂuence of surrounding gradients of an imaging host sequence.
Further, embedded in the MP–RAGE acquisition, noise scans were performed by switching
the transmit/receive frequency to zero in order to just acquire the thermal noise without any
excitation pulse. All scans were performed on a phantom (spherical water phantom, 175 mm
diameter; 1.25g NiSO4 + 6H2O per 1000g H2O) but two ’MP–RAGE + FIDnav’ scans were taken
from a human subject at rest and while changing the head position three times during the
scan. The experiments were done at 3T and with a 32 channel head coil.
When the FID signal is acquired within a gradient-echo ’3D GRE+FIDnav’ sequence or
as a stand alone ’FIDnav only’ only a decay towards the steady-state as well as a slow time
dependent drift are visible as depicted in Fig. 7.1a and Fig. 4.6. On the other hand when the
69

Chapter 7. Host Sequence Inﬂuence on FID Signal
Parameter
3D GRE + FIDnav
FIDnav only
MP–RAGE + FIDnav
TI
n.a.
n.a.
900 ms
TR
25.0 ms
12.5 ms
2300 ms
TE
3.0 ms
3.0 ms
2.86 ms
α
12◦
8◦
18◦/9◦/0◦
TA
6:07 min
6:11 min
5:21 min
Band width
240 Hz/Px
240 Hz/Px
Matrix (ROxPExPAR)
256×256×144
n.a.
256×256×176
Voxel size
1.0×1.0×1.2 mm3
n.a.
1.0×1.0×1.0 mm3
GRAPPA
×2, 24 ref. lines
n.a.
×2, 24 ref. lines
Field of view in phase
87.5%
n.a.
100%
Slice partial Fourier
6/8
n.a.
1/1
Total number of FIDnav
1328
29568
139
samples during the scan
Table 7.1: Acquisition parameters.
FID signal is acquired within an MP–RAGE sequence then rapid temporal signal ﬂuctuations
are noticeable. These signal variations are more prominent at higher excitation angles as can
be seen in Fig. 7.1b and then change their temporal frequency depending on the acquired line
number of the MP-RAGE image i.e., the FIDnav signals that are acquired with the TR number
belonging to reference lines have a different ﬂuctuation pattern. By setting the excitation angle
to zero degrees for the ’MP–RAGE+FIDnav’ acquisition we aimed at acquiring just the thermal
noise. This signal variance is very small compared to the variance caused by the sequence
gradients i.e., eddy currents.
0
20
40
60
80
100
120
−10
−5
0
5
10
15
20
25
30
FIDnav signal magnitude [%]
TR #
MP−RAGE + FIDnav
GRE + FIDnav
FIDnav only
(a)
(b)
Figure 7.1: a: FIDnav signal magnitude change in % for the different acquisition schemes; 140 TRs are shown. b:
FIDnav signal magnitude change for different excitation angles. Inﬂuence of the phase encoding gradients is visible.
Further, when looking at the FIDnav magnitude change from a human subject the signal
variation due to motion is much stronger compared to signal changes due to host signal
inﬂuence as seen in Fig. 4.6 and Fig. 7.2, which allows to establish a threshold based on
the standard deviation of the FIDnav signal to detect signal changes due to motion. Also,
70

as already described in Chapter 4.3.3 a temporal signal drift can be observed in all FIDnav
acquisitions ’3D GRE + FIDnav’, ’FIDnav only’, and ’MP-RAGE + FIDnav’.
0
20
40
60
80
100
120
140
-30
-20
-10
0
10
20
30
FIDnav signal magnitude [%]
TR #
MP-RAGE + FIDnav, motion
MP-RAGE + FIDnav, no motion
MP-RAGE + FIDnav, phantom
Figure 7.2: FIDnav signal magnitude change in a single coil element for a phantom and human scan. For the
human scan the signal is shown for a subject at rest and performing head motion of around 3° rotation 3 mm
translation.
Here, we performed some experiments to reveal and describe the inﬂuence of the host
sequence on the FIDnav signal. We could show that when the FIDnav acquisition is imbedded
into an MP–RAGE sequence then signal ﬂuctuations as caused by the phase encoding gradients
are visible. Also, we observed temporal signal drifts in all FIDnav acquisitions. As this slow
drift is also present in the ’FIDnav only’ scans we can conclude that they are not gradient
related as no gradients are present during the signal acquisition. The drift might be caused by
B0 drifts due to temperature induced shim changes of the scanner.
These observations are of interest for the use of the FIDnav signal to detect motion within a
host sequence. In order to do so, the FIDnav signal is observed over time and if a signal change
compared to a reference higher than a preset threshold is detected then the corresponding
part of k-space data acquired around the FIDnav signal acquisition can be considered as
motion corrupted. This threshold can be set in two ways: either to an empirical value based
on a set of scans with the same acquisition scheme but different subjects (training set) and
without motion or to a value obtained from FIDnav signal points from the beginning of the
acquisition. Both variants have their advantages and disadvantaged. In the ﬁrst case it is hard
to trust an empirical value and false positive or negative motion events would be inevitable. In
the second case some FIDnav samples must be sacriﬁced to establish a trustworthy threshold
estimation. Moreover, this relies on the scenario that no motion occurs during the acquisition
of this threshold data otherwise the threshold would be set too high and the FID based motion
detection would be blind to motion events occurring at a later stage. Therefore, the ﬁrst
approach with the use of a empirical threshold which is estimated based on previous scans
is considered advantageous over the second proposal for reliable motion detection. This,
however, would require a training data set to establish such a threshold which includes patient,
hardware and sequence speciﬁc parameters as demonstrated in (Babayeva et al., 2015b).
71


8 Outlook and Conclusion
This is perhaps 5 per cent empirical
information and 95 per cent speculation,
some of it possibly tainted by wishful
thinking.
SIMON S KUZNETS
MRI is a powerful tool in medical imaging allowing to visualize the anatomy of a human
body non–invasively. This technology is however highly susceptible to motion as the scanning
times are usually on the order of minutes. As of today many motion mitigation strategies have
been proposed but with only little success in clinical use. Hence, there was a motivation to
examine a new approach to motion detection and correction utilizing the simplest MR signal –
a free induction decay (FID) – for motion tracking.
The physical theory behind the ability of the FID signal to react to motion seems natural
as stated by the Biot–Savart law: the closer an object is located to the receive coil the higher
will be the detected signal. Similar to any other sensor for distance detection e.g., ultrasound
or infrared in order to determine a location and its exact motion trajectory of an object in
the three dimensional space it is necessary to measure the motion trajectory in six degrees of
freedom (three translation and three rotational parameters). Therefore, at least six orthogonal
measures of the posture or rigid body motion are needed to determine the objects position
and orientation or positional changes. Here, we postulate that the limited motion ability of
the human head and a sufﬁcient number of spatially distributed receive coil elements allows
us to perform such motion tracking.
In order to show the validity of our hypothesis we performed a set of experiments where
the accurate motion of a human head was tracked by a highly precise optical tracking device
while the FID signal was acquired with a 32–channel head coil. Five subjects participated
in this study performing various types of motions (head nodding, head shaking, moving the
head in the head foot direction and drawing a virtual eight with the nose tip). Our results
73

Chapter 8. Outlook and Conclusion
as shown in Chapter 4 could show that the the FID signal is linearly correlated with the six
motion parameters with a sub–millimeter and sub–degree accuracy and precision. However,
we were not able to ﬁnd a closed form solution which would apply to all subjects. Therefore,
we assume that in order to be able to ﬁnd a universal mapping from FID signal changes to
exact motion parameters more information is required as the individual shape of the head
and its initial position within the head coil.
Computer aided quantitative evaluations of medical MR images have become more popular
in the recent years e.g., automatic disease prediction based on volumetric measurements
of the brain anatomy. Such techniques rely heavily on high image quality which may be
compromised by motion. If an image is corrupted by motion the validity of the segmentation
results is questionable. Therefore, it is important to be able to assess the image quality
quantitatively before the image is used for further computer based analysis. We proposed to
acquire the FID signal along the normal imaging sequence in order to calculate an FID based
motion sensitive quality metric. This metric has also the advantage of labeling the acquired
data as motion corrupted even if the scan is has not ﬁnalized yet in order to terminate the
exam to save time and possibly advise the subject to remain still. We called the proposed
quality index FIDI (FID index) and could show in Chapter 5 on 109 clinical data sets that it
could reliably identify motion corrupted images.
Further, also in Chapter 5, we could show that the FID signal could be used for a retro-
spective motion correction technique based on autofocusing. This correction method adjusts
the already acquired k-space data chunks such that a cost function is optimized according
to the underlying motion trajectory. We proposed to extent this cost function by the use of
the FID signal as an additional parameter to guide the optimization process. This FID guided
approach allows for faster convergence of the algorithm (Babayeva et al., 2014b; Loktyushin
et al., 2013). We could also show on clinical data sets which were evaluated by an expert that
the FID guided method leads to better correction results compared to the blind autofocusing
approach.
To show a method how the FID signal can be used for prospective motion correction in
MRI we proposed a technique where the FID is used for binary motion detection to drive
another motion estimation mechanism. On an example of an MP–RAGE sequence the FID
signal was periodically sampled (every TR) and if head motion was detected according to FID
signal changes then an acquisition of a low resolution image (IMGnav) of the whole head was
triggered. This IMGnav was used to determine the underlying motion parameters through
image registration to a reference IMGnav from the beginning of the scan. This acquisition
scheme provides an efﬁcient way of motion correction during and MRI scan as the motion
correction mechanism is only active when motion happens. A disadvantage of this technique
is the temporal resolution with which the motion can be detected i.e., only every TR. Hence, it
is not possible to avoid the acquisition of uncorrected data that has to be discarded resulting in
additional scan time overhead. Another bottleneck of this technique is the limited registration
accuracy of the IMGnav as a trade–off between scan time and image resolution needs to be
74

8.1. Direction for Future Research
made. We evaluated the registration accuracy and precision of our IMGnav by acquiring
successively several volumes of the IMGnav from a human subject and by introducing an
artiﬁcial motion trajectory through a text ﬁle. This approach provided us with a notion of
the reliability of our motion correction method. This strategy, however, does not take into
account the possible real and involuntary motion of the subject during the experiment. Hence,
a moving phantom to prescribe an accurate motion trajectory or a precise motion tracking
device (i.e., optical camera system) to track real human subject movements would render this
experimental validation more realistic. Another challenge of this motion correction method
is the adjustment of the FID threshold when the signal change is considered high enough
to correspond to a potential head motion. One way is to set this threshold empirically or
to use few FID signal samples from the beginning of the scan as reference to calculate its
standard deviation and to set the threshold above a multiple of this value. The drawback of
the latter value is that it relies on the fact that no motion was present during the acquisition
of the reference FID signal values otherwise the method would be blind to eventual latter
motion events. The ﬁrst approach to set the threshold may lead to many false positives or false
negatives if it is set too high or too low. Despite the evident drawbacks of the method we were
able to demonstrate the efﬁcacy of our proposed technique with a study on 10 subjects and
different motion patterns and presented the results in Chapter 6.
Finally, we performed a study on how the FID signal may be inﬂuenced be the host se-
quence i.e., the imaging sequence which includes the acquisition of the FID. We could show
that it is important to consider the ’magnetic’ environment of the FID acquisition as it may
introduce additional non-motion related signal ﬂuctuations.
8.1
Direction for Future Research
Future work should be focused on further understand which additional information is needed
to ﬁnd a universal mapping of the multi-channel FID signal to exact motion parameters. This
could be achieved through collecting more data sets from different subjects but also acquired
by head coils of different geometry to extend the search space. Hereby, a clinical dataset
containing motion trajectory information, radiological image quality ratings, as well as the
FID signal would be of high interest. The motion trajectory could be assessed by introducing
the acquisition of an IMGnav throughout all clinical routine scans in either triggered approach
or by inserting a ﬁxed number of acquired volumes e.g., every 10 seconds during the scan.
The FID signal acquisition could be added to virtually any sequence without or only a small
impact on its scan time and magnetization proﬁle. The collection of image quality ratings
should be systematically included in all radiological readings as part of the clinical routine.
From our evaluations we think that the most promising approach towards a motion correc-
tion method would be to acquire a training data set prior the actual imaging scan to collect
the necessary information to obtain a subject, scanner, utilized coil, and sequence speciﬁc
model. Other models than linear ones can be considered here as well and might provide a
75

Chapter 8. Outlook and Conclusion
different view on the problem. The acquisition of this training data should, however, take not
longer than the imaging scan itself as otherwise a reacquisition of a potentially corrupted data
set might be more appealing.
In this thesis we propose to use the FID as a novel technique to calculate a motion sensitive
quality index FIDI of the acquired data. In order to set the reliable limits for this index when to
label data as motion corrupted it would be advantageous to consider more clinical data sets.
These data sets have to be reviewed by experts for motion related artifacts such that these
ratings can be correlated to the FID based index FIDI. We investigated the application of FIDI
only on MP-RAGE scans. A valuable expansion of this study would be to introduce the FID
acquisition to other sequences and perform similar evaluations with expert ratings of clinical
images.
In order to understand the real beneﬁt of the FID based prospective and retrospective
motion detection and correction as we proposed in Chapters 5 and 6 it is important to bring
the implementation to the clinical routine scans. The advantage of the retrospective technique
is that the original image is preserved such that the clinicians can choose which image is more
suitable for the diagnosis. Hence, introducing the retrospective method to the clinics can be
achieved by just providing an efﬁcient implementation of the this retrospective correction
technology, which could be the next logical step. Also, such an implementation would allow
to conduct a clinical study to assess its potential. The prospective correction technique on
the other hand is more challenging in terms of integrating and testing it in a clinical context.
With this method it is not possible to retrieve the image without correction. Therefore, the
reliability of this methodology has to be assured such that no artifacts are introduced by the
method to the ﬁnal image.
In this work we have gathered an understanding on how the FID signal can be used in two
3D sequences the gradient-echo and the MP-RAGE. To further facilitate the use of the FID
for motion detection in correction correction in MRI it is necessary to investigate also other
sequences especially the 2D ones. In brief the future research should focus on two orthogonal
topics. First the implementation of the proposed motion correction methodologies such that
they can be used in clinics to study the impact of motion correction in the daily routine as
well as to quantify the prevalence of motion in clinical examinations. Seconds, continue to
investigate how the FID signal can be introduced to other sequences as well as how it can
complement already existing motion correction methods by establishing a data base with
clinical images and corresponding motion trajectories as well as FID signals and radiologists’
image quality ratings.
76

8.2. Conclusion
8.2
Conclusion
Motion detection and motion tracking based on the FID signal from a multi-channel head
coil array could provide an elegant solution for the motion problem in MRI. It was shown
that multi-channel FID signal correlates with underlying motion with sufﬁcient accuracy and
several promising approaches on how this technique could be utilized for this purpose and
also provide a platform for further investigation was proposed. However, further research is
necessary to understand how the exact motion parameters can be extracted from the multi-
channel FID signal without relying on other motion tracking methodologies. Additionally,
the MR sequence where the acquisition of the FID signal is embedded, has to be taken into
consideration as it inﬂuences the FID signal. The take-home message of this work is that
accurate motion information is contained in the multi-channel FID signal and it can be
used in prospective and retrospective motion correction applications if combined with other
techniques but bears also the potential for more elaborate use.
77


Bibliography
Aksoy, M., Forman, C., Straka, M., Skare, S., Holdsworth, S., Hornegger, J., and Bammer, R.,
2011. Real-time optical motion correction for diffusion tensor imaging. Magnetic Resonance
in Medicine, 66(2):366–78.
Alhamud, A., Tisdall, D., Hess, A. T., Hasan, K. M., Meintjes, E. M., and van der Kouwe, A. J. W.,
2012. Volumetric navigators for real-time motion correction in diffusion tensor imaging.
Magnetic Resonance in Medicine, 68(4):1097–1108.
Andre, J. B., Bresnahan, B. W., Mossa-basha, M., Hoff, M. N., Smith, C. P., Anzai, Y., and Cohen,
W. A., 2015. Toward Quantifying the Prevalence, Severity, and Cost Associated With Patient
Motion During Clinical MR Examinations. J Am Coll Radiol, 12(7):689–95.
Atkinson, D., Hill, D. L. G., Stoyle, P. N., Summers, P. E., Clare, S., Bowtell, R., and Keevil, S. F.,
1999. Automatic compensation of motion artifacts in MRI. Magnetic Resonance in Medicine,
41(1):163–70.
Atkinson, D., Hill, D. L. G., Stoyle, P. N., Summers, P. E., and Keevil, S. F., 1997. Automatic cor-
rection of motion artifacts in magnetic resonance images using an entropy focus criterion.
IEEE transactions on medical imaging, 16(6):903–10.
Babayeva, M., Falkovskiy, P., Hilbert, T., Bonnier, G., Maréchal, B., Meuli, R., Thiran, J.-p., and
Gruetter, R., 2015a. Prospective motion correction with FID-triggered image navigators.
Proc. Intl. Soc. Mag. Reson. Med., 23:683.
Babayeva, M., Kober, T., Herbst, M., Hennig, J., Seeger, M., Gruetter, R., Zaitsev, M., and
Krueger, G., 2013. Can Multi-Channel FID Navigators Quantify Head Motion? Proc. Intl.
Soc. Mag. Reson. Med., 21:306.
Babayeva, M., Kober, T., Knowles, B., Herbst, M., Zaitsev, M., and Krueger, G., 2015b. Accuracy
and Precision of Head Motion Information in Multi-Channel Free Induction Decay Naviga-
tors for Magnetic Resonance Imaging. IEEE transactions on medical imaging, 34(9):1–11.
Babayeva, M., Loktyushin, A., Falkovskiy, P., Kober, T., Mueli, R., Gruetter, R., and Krueger, G.,
2014a. FID navigator triggered acquisition of imaging navigators for retrospective head
motion correction. ISMRM Workshop on Motion Correction, 3703.
79

Bibliography
Babayeva, M., Loktyushin, A., Kober, T., Granziera, C., Nickisch, H., Gruetter, R., and Krueger,
G., 2014b. FID-guided retrospective motion correction based on autofocusing. Proc. Intl.
Soc. Mag. Reson. Med., 22:2227.
Brau, A. C. S. and Brittain, J. H., 2006. Generalized self-navigated motion detection tech-
nique: Preliminary investigation in abdominal imaging. Magnetic Resonance in Medicine,
55(2):263–70.
Busse, R. F. and Riederer, S. J., 2001. Steady-state preparation for spoiled gradient echo imaging.
Magnetic Resonance in Medicine, 45(4):653–61.
Dantendorfer, K., Amering, M., Bankier, A., Helbich, T., Prayer, D., Youssefzadeh, S.,
Alexandrowicz, R., Imhof, H., and Katschnig, H., 1997. A study of the effects of patient
anxiety, perceptions and equipment on motion artifacts in magnetic resonance imaging.
Magnetic Resonance Imaging, 15(3):301–306.
Delattre, B. M., Heidemann, R. M., Crowe, L., Vallée, J.-P., and Hyacinthe, J.-N., 2010. Spiral
demystiﬁed. Magnetic resonance imaging, 28(6):862–81.
Ehman, R. L. and Felmlee, J. P., 1989. Adaptive technique for high-deﬁnition MR imaging of
moving structures. Radiology, 173(1):255–263.
Erasmus, L., Hurter, D., Naudé, M., Kritzinger, H., and Acho, S., 2004. A short overview of MRI
artefacts. South African Journal of Radiology, 8(2):13–17.
Falkovskiy, P., Brenner, D., Feiweier, T., Kannengiesser, S., Maréchal, B., Kober, T., Roche, A.,
Thostenson, K., Meuli, R., Reyes, D., et al., 2016. Comparison of accelerated T1-weighted
whole-brain structural-imaging protocols. NeuroImage, 124, Part A:157 – 167.
Falkovskiy, P., Kober, T., Reyes, D., Steinert, K., Seeger, M., Bernstein, M., and Krueger, G., 2013.
Segmented Multi-Echo MPRAGE Acquisition for Accelerated T1-Weighted Brain Imaging.
Proc. Intl. Soc. Mag. Reson. Med., 21:3703.
Fries, P., Runge, V. M., Kirchin, M. A., Stemmer, A., Naul, L. G., Wiliams, K. D., Reith, W.,
Bücker, A., and Schneider, G., 2009. Diffusion-weighted imaging in patients with acute
brain ischemia at 3 T: current possibilities and future perspectives comparing conventional
echoplanar diffusion-weighted imaging and fast spin echo diffusion-weighted imaging
sequences using BLADE (PROPELLER). Investigative radiology, 44(6):351–359.
Gedamu, E. and Gedamu, A., 2012. Subject movement during multislice interleaved MR ac-
quisitions: prevalence and potential effect on MRI-derived brain pathology measurements
and multicenter clinical trials of therapeutics for multiple sclerosis. Journal of magnetic
resonance imaging, 36(2):332–43.
Gumus, K., Keating, B., White, N., Andrews-Shigaki, B., Armstrong, B., Maclaren, J., Zaitsev,
M., Dale, A., and Ernst, T., 2015. Comparison of optical and mr-based tracking. Magnetic
Resonance in Medicine, 74(3):894–902.
80

Bibliography
Haacke, E. M., Brown, R. W., Thomson, M. R., Venkatesan, R., E, H., R, B., M, T., and R, V., 1999.
Magnetic resonance imaging: physical principles and sequence design. Wiley, New York, NY,
USA.
Haeberlin, M., Kasper, L., Barmet, C., Brunner, D. O., Dietrich, B. E., Gross, S., Wilm, B. J.,
Kozerke, S., and Pruessmann, K. P., 2014. Real-time motion correction using gradient tones
and head-mounted NMR ﬁeld probes. Magnetic Resonance in Medicine, 74(3):647–60.
Herbst, M., Maclaren, J., Lovell-Smith, C., Sostheim, R., Egger, K., Harloff, A., Korvink, J.,
Hennig, J., and Zaitsev, M., 2014. Reproduction of motion artifacts for performance analysis
of prospective motion correction in MRI. Magnetic Resonance in Medicine, 71(1):182–190.
Herbst, M., Maclaren, J., Weigel, M., Korvink, J., Hennig, J., and Zaitsev, M., 2012. Prospec-
tive motion correction with continuous gradient updates in diffusion weighted imaging.
Magnetic Resonance in Medicine, 67(2):326–38.
Hess, A. T., Tisdall, D., Andronesi, O. C., Meintjes, E. M., and van der Kouwe, A. J. W., 2011.
Real-time motion and B(0) corrected single voxel spectroscopy using volumetric navigators.
Magnetic Resonance in Medicine, 323(66):314–323.
Hu, X. P. and Kim, S.-G. S., 1994. Reduction of signal ﬂuctuation in functional MRI using
navigator echoes. Magnetic Resonance in Medicine, 31(5):495–503.
Jack, C. R., Bernstein, M. A., Fox, N. C., Thompson, P., Alexander, G., Harvey, D., Borowski, B.,
Britson, P. J., Whitwell, J. L., Ward, C., et al., 2008. The Alzheimer’s Disease Neuroimaging
Initiative (ADNI): MRI Methods. Journal of magnetic resonance imaging : JMRI, 27(4):685–
691.
Johnson, K. O., Robison, K. R., and Pipe, J. G., 2011. Rigid body motion compensation for spiral
projection imaging. IEEE transactions on medical imaging, 30(3):655–665.
Kaufman, L., Kramer, D. M., Crooks, L. E., and Ortendahl, D. A., 1989. Measuring signal-to-
noise ratios in MR imaging. Radiology, 173(1):265–267.
Kim, B., Boes, J. L., Bland, P. H., Chenevert, T. L., and Meyer, C. R., 1999. Motion correction in
fMRI via registration of individual slices into an anatomical volume. Magnetic Resonance in
Medicine, 41(5):964–72.
Kober, T., Gruetter, R., and Krueger, G., 2012. Prospective and retrospective motion correction
in diffusion magnetic resonance imaging of the human brain. NeuroImage, 59(1):389–98.
Kober, T., Marques, J., Gruetter, R., and Krueger, G., 2010. Motion Characterisation using FID
navigators and Spatial Pattern of MRI Coil Arrays. Proc. Intl. Soc. Mag. Reson. Med., 18:3047.
Kober, T., Marques, J., Gruetter, R., and Krueger, G., 2011. Head motion detection using FID
navigators. Magnetic resonance in medicine, 66(1):135–43.
81

Bibliography
Liao, J. R., Pauly, J. M., Brosnan, T. J., and Pelc, N. J., 1997. Reduction of motion artifacts
in cine MRI using variable-density spiral trajectories. Magnetic Resonance in Medicine,
37(4):569–75.
Lin, W., Ladinsky, G. a., Wehrli, F. W., and Song, H. K., 2007. Image metric-based correction
(autofocusing) of motion artifacts in high-resolution trabecular bone imaging. Journal of
magnetic resonance imaging :, 26(1):191–7.
Lin, W., Nielsen, T., Qin, Q., Mostofsky, S. H., Wei, J., Huang, F., and Duensing, G. R., 2014.
Real-time motion correction in two-dimensional multislice imaging with through-plane
navigator. Magnetic Resonance in Medicine, 71(6):1335–2005.
Loktyushin, A., Babayeva, M., Gallichan, D., Krueger, G., Schefﬂer, K., and Kober, T., 2015a.
Retrospective rigid motion correction of undersampled MRI data. Proc. Intl. Soc. Mag. Reson.
Med., :2334.
Loktyushin, A., Nickisch, H., Pohmann, R., and Schölkopf, B., 2013. Blind retrospective motion
correction of MR images. Magnetic Resonance in Medicine, 70(6):1608–1618.
Loktyushin, A., Nickisch, H., Pohmann, R., and Schölkopf, B., 2015b. Blind multirigid retro-
spective motion correction of MR images. Magnetic Resonance in Medicine, 73(4):1457–68.
Maclaren, J., Armstrong, B. S. R., Barrows, R. T., Danishad, K., Ernst, T., Foster, C. L., Gumus,
K., Herbst, M., Kadashevich, I., Kusik, T. P., et al., 2012. Measurement and Correction of
Microscopic Head Motion during Magnetic Resonance Imaging of the Brain. PLOS ONE,
7(11):e48088.
Maclaren, J., Bones, P., Millane, R., and Watts, R., 2008. MRI with TRELLIS: a novel approach to
motion correction. Magnetic Resonance Imaging, 26(4):474–483.
Maclaren, J., Herbst, M., Speck, O., and Zaitsev, M., 2013. Prospective motion correction in
brain imaging: A review. Magnetic Resonance in Medicine, 69(3):621–636.
Maclaren, J., Speck, O., Stucht, D., Schulze, P., Hennig, J., and Zaitsev, M., 2010. Navigator
accuracy requirements for prospective motion correction. Magnetic resonance in medicine,
63(1):162–70.
Malamateniou, C., Malik, S., Counsell, S., Allsop, J., McGuinness, A., Hayat, T., Broadhouse, K.,
Nunes, R., Ederies, A., Hajnal, J., et al., 2013. Motion-Compensation Techniques in Neonatal
and Fetal MR Imaging. American Journal of Neuroradiology, 34(6):1124–36.
Manduca, A., McGee, K. P., Welch, E. B., Felmlee, J. P., Grimm, R. C., and Ehman, R. L., 2000.
Autocorrection in MR imaging: adaptive motion correction without navigator echoes. Radi-
ology, 215(3):904–9.
Maréchal, B., Kannengiesser, S., Thostenson, K., Kollasch, P., Falkovskyi, P., Thiran, J.-p., Meuli,
R., and Bernstein, M. A., 2015. A generalized method for automated quality assessment in
brain MRI. In Proc. Intl. Soc. Mag. Reson. Med., volume 1335, page 23.
82

Bibliography
Maréchal, B., Kober, T., Hilbert, T., Ribes, D., Chevrey, N., Roche, A., Thiran, J.-P., Meuli, R., and
Krueger, G., 2012. Automated quality control in MR-based brain morphometry. In Proc. Intl.
Soc. Mag. Reson. Med., volume 20, page 757, Melbourne.
Maréchal, B. M., 2011. Toward Reliable MR-Based Brain Structure Morphometry: Importance
of Rigorous Quality Control. Phd, ÉCOLE POLYTECHNIQUE FÉDÉRALE DE LAUSANNE.
McGee, K. P., Manduca, a., Felmlee, J. P., Riederer, S. J., and Ehman, R. L., 2000. Image metric-
based correction (autocorrection) of motion effects: analysis of image metrics. Journal of
magnetic resonance imaging : JMRI, 11(2):174–81.
McRobbie, D. W., Moore, E. A., Graves, M. J., and Prince, M. R., 2006. MRI from Picture to
Proton. Cambridge University Press, second edition. Cambridge Books Online.
Mortamet, B., Bernstein, M. A., Jack, C. R., Gunter, J. L., Ward, C., Britson, P. J., Meuli, R., Thiran,
J.-P., and Krueger, G., 2009. Automatic quality assessment in structural brain magnetic
resonance imaging. Magnetic Resonance in Medicine, 62(2):365–72.
Munn, Z. and Jordan, Z., 2013. Interventions to reduce anxiety, distress and the need for
sedation in adult patients undergoing magnetic resonance imaging: A systematic review.
International Journal of Evidence-Based Healthcare, 11(4):265–274.
Oberstein, A., Meves, M., Bockenheimer, S., and Schlaps, D., 1990. Beeinträchtigende Fak-
toren in der MR-Routineanwendung-Ergebnisse der "Multicenterstudie zur Evaluierung
der Kernspintomographie". Digit. Bilddiagn., 10:10–16.
Ooi, M. B., Aksoy, M., Maclaren, J., Watkins, R. D., and Bammer, R., 2013. Prospective motion
correction using inductively coupled wireless RF coils. Magnetic Resonance in Medicine,
70(3):639–647.
Ooi, M. B., Krueger, S., Thomas, W. J., Swaminathan, S., and Brown, T. T., 2009. Prospective
real-time correction for arbitrary head motion using active markers. Magnetic Resonance in
Medicine, 62(4):943–954.
Ordidge, R., Helpern, J., Qing, Z., Knight, R., and Nagesh, V., 1994. Correction of motional
artifacts in diffusion-weighted MR images using navigator echoes. Magnetic Resonance
Imaging, 12(3):455–460.
Peshkovsky, A., Knuth, K. H., and Helpern, J., 2003. Motion correction in MRI using an
apparatus for dynamic angular position tracking (ADAPT). Magnetic resonance in medicine,
49(1):138–43.
Pfeuffer, J., Van de Moortele, P.-F., Ugurbil, K., Hu, X. P., and Glover, G., 2002. Correction of
physiologically induced global off-resonance effects in dynamic echo-planar and spiral
functional imaging. Magnetic resonance in medicine, 47(2):344–53.
Pipe, J. G., 1999. Motion correction with PROPELLER MRI: application to head motion and
free-breathing cardiac imaging. Magnetic resonance in medicine, 42(5):963–969.
83

Bibliography
Qin, L., Schmidt, E. J., Tse, Z. T. H., Santos, J. M., Hoge, W. S., Tempany-Afdhal, C., Butts-Pauly,
K., and Dumoulin, C. L., 2013. Prospective motion correction using tracking coils. Magnetic
resonance in medicine, 69:749–759.
Qin, L., van Gelderen, P., Derbyshire, J. A., Jin, F., Lee, J., de Zwart, J. a., Tao, Y., and Duyn, J. H.,
2009. Prospective head-movement correction for high-resolution MRI using an in-bore
optical tracking system. Magnetic Resonance in Medicine, 62(4):924–34.
Reuter, M., Tisdall, M. D., Qureshi, A., Buckner, R. L., van der Kouwe, A. J., and Fischl, B., 2015.
Head motion during MRI acquisition reduces gray matter volume and thickness estimates.
NeuroImage, 107:107–115.
Sachs, T., Meyer, C. R., Hu, B., Kohli, J., Nishimura, D., and Macovski, A., 1994. Real-time motion
detection in spiral MRI using navigators. Magnetic Resonance in Medicine, 32(5):639–645.
Schmitter, D., Roche, A., Maréchal, B., Ribes, D., Abdulkadir, A., Bach-Cuadra, M., Daducci, A.,
Granziera, C., Klöppel, S., Maeder, P., et al., 2014. An evaluation of volume-based morphom-
etry for prediction of mild cognitive impairment and Alzheimer’s disease. NeuroImage Clin,
7:7–17.
Smith, T. B. and Nayak, K. S., 2010. MRI artifacts and correction strategies. Imaging in Medicine,
2(4):445–457.
Splitthoff, D. N. and Zaitsev, M., 2009. SENSE shimming (SSH): A fast approach for determin-
ing B(0) ﬁeld inhomogeneities using sensitivity coding. Magnetic Resonance in Medicine,
62(5):1319–25.
Thesen, S., Heid, O., Mueller, E., and Schad, L. R., 2000. Prospective acquisition correction
for head motion with image-based tracking for real-time fMRI. Magnetic Resonance in
Medicine, 44(3):457–65.
Tisdall, D., Hess, A. T., Reuter, M., Meintjes, E. M., Fischl, B., and van der Kouwe, A. J. W.,
2012. Volumetric navigators for prospective motion correction and selective reacquisition
in neuroanatomical MRI. Magnetic Resonance in Medicine, 68(2):389–399.
van der Kouwe, A. J. W., Benner, T., and Dale, A. M., 2006. Real-time rigid body motion
correction and shimming using cloverleaf navigators. Magnetic Resonance in Medicine,
56(5):1019–32.
Welch, E. B., Manduca, A., and Grimm, R. C., 2002. Spherical navigator echoes for full 3D rigid
body motion measurement in MRI. Magnetic Resonance in Medicine, 47(1):32– 41.
White, N. S., Roddey, J. C., Shankaranarayanan, A., Han, E. T., Rettmann, D., Santos, J. M.,
Kuperman, J. M., Dale, A. M., Roddey, C., Shankaranarayanan, A., et al., 2010. PROMO:
Real-time prospective motion correction in MRI using image-based tracking. Magnetic
Resonance in Medicine, 63(1):91–105.
84

Bibliography
Wood, M. L. and Henkelman, M. R., 1985. MR image artifacts from periodic motion. Medical
Physics, 12(2):143–151.
Zaitsev, M., Dold, C., Sakas, G., Hennig, J., and Speck, O., 2006. Magnetic resonance imaging of
freely moving objects: prospective real-time motion correction using an external optical
motion tracking system. NeuroImage, 31(3):1038–50.
Zaitsev, M., Maclaren, J., and Herbst, M., 2015. Motion Artifacts in MRI: A Complex Problem
With Many Partial Solutions. J Magn Reson Imaging, 42(4):887–901.
85


Maryna Waszak
B maryna.waszak@gmail.com
Personal Information
Birth
30 July, 1984 in Charkiv, Ukraine
Formerly
Maryna Babayeva
Nationalities
German, Ukrainian
Languages
German, English, Russian
Education
04/2012-03/2016
Ph.D., Electrical Engineering,
Swiss Federal Institute of Technology Lausanne, Switzerland.
Thesis Title
Motion Correction in Magnetic Resonance Imaging Using the Signal of Free-Induction-
Decay
Thesis Advisors
Prof. Rolf Gruetter (EPFL), Dr. Gunnar Krueger (Siemens)
10/2009-09/2011
M.Sc., Computational Science and Engineering,
Technical University of Munich, Germany.
GPA
1.9 (on a scale from 1–5; 1 is best; 5 is failed)
Thesis Title
Eﬃcient Sampling for Accelerated Diﬀusion Magnetic Resonance Imaging
Thesis Advisors
Prof. Nassir Navab (TUM), Prof. Dimitri Van De Ville (EPFL)
10/2005-09/2009
Dipl.-Ing. (FH), Electrical Engineering and Information Technology,
University of Applied Sciences Munich, Germany.
GPA
1.9 (on a scale from 1–5; 1 is best; 5 is failed)
Thesis Title
Development and Implementation of an Automotive Diagnostic System on an Electronic
Control Unit Prototype According to ISO 14229
Thesis Advisor
Prof. Alfred Irber
Teaching Experience
2012-2015
Swiss Federal Institute of Technology Lausanne, Lausanne, Switzerland.
General Physics I, General Physics II, Physics Laboratory Experiments
Work Experience
10/2011-03/2016
Siemens, Lausanne, Switzerland.
Siemens Advanced Imaging Technology – Development of a motion correction strategy for
magnetic resonance imaging.
09/2010-01/2011
General Electric, Zeist, Netherlands.
Healthcare IT – Software development and unit testing of a medical data archiving system.
87

09/2009-07/2010
Brainlab, Munich, Germany.
Research & Development Surgery – Test and development of a surgical documentation and
visualization system.
03/2009-08/2009
Gigatronik, Munich, Germany.
Automotive Diagnostics – Project on an automatic diagnostic analysis and reporting hard- and
software system.
10/2008-02/2009
Inﬁneon Technologies, Munich, Germany.
Automotive System Applications Engineering – Development and veriﬁcation of embedded
software for microcontrollers.
03/2008-08/2008
Inﬁneon Technologies, Singapore.
Automotive System Applications Engineering – Development and veriﬁcation of software dri-
vers for microcontrollers.
01/2007-02/2008
Qimonda, Munich, Germany.
Quality Management – Documentations and quality reports for customers on production and
packaging speciﬁcations for wafer manufacturing.
05/2006-12/2006
Siemens, Munich, Germany.
Environmental Protection and Product Safety – Maintaining databases and assisting in admi-
nistrative data processing.
International Experience
03/2011-08/2011
Swiss Federal Institute of Technology Lausanne, Switzerland.
M.Sc. thesis project at the Electrical Engineering faculty.
09/2010-01/2011
Utrecht University, Netherlands.
Study semester within the Mathematics and Computer Science faculty.
03/2008-08/2008
Inﬁneon Technologies, Singapore.
Full-time industrial internship.
07/2004-07/2005
EurAuPair, USA.
Intercultural exchange program.
Fellowships
03/2010-09/2011
Siemens Masters Program, Germany.
03/2011-08/2011
DAAD PROMOS, Germany.
09/2010-01/2011
ERASMUS, Germany.
03/2008-08/2008
InWEnt – Capacity Building International, Germany.
Voluntary Work
09/2011-03/2016
Committee member of the EPFL alpine club Club Montagne being responsible for orga-
nizing weekly rock climbing outings as well as for private club sponsorships (Mammut,
Stöckli).
01/2006-11/2007
Mentor within the Cascading Mentoring Project of the University of Applied Sciences
Munich. Support of female students in their ﬁrst year of studies.
03/2007-06/2007
Teaching in a youth center Jugendprogrammierer - Centrum München e. V (www.jpcm.de)
graphical design and computer architecture for kids.
Interests
Climbing, road biking, winter sports, arts, and traveling.
88

Publications
Journals
Babayeva M, Kober T, Knowles B, Herbst M, Meuli R, Zaitsev M, Krueger G. (2015).
Accuracy and Precision of Head Motion Information in Multi-Channel Free Induction
Decay Navigators for Magnetic Resonance Imaging. In: IEEE Transactions on Medical
Imaging 34(9):1-11.
Conferences
Babayeva M, Falkovskiy P, Hilbert T, Bonnier G, Maréchal B, Meuli R, Thiran J-P, Gruetter
R, Krueger G, Kober T. (2015). Prospective motion correction with FID-triggered image
navigators. In: ISMRM, 23:583, Toronto, Canada.
Loktyushin A, Babayeva M, Gallichan D, Krueger G, Schefﬂer K, Kober T. (2015). Ret-
rospective rigid motion correction of undersampled MRI data. In: ISMRM, 23:2334,
Toronto, Canada.
Babayeva M, Loktyushin A, Falkovskiy P, Kober T, Mueli R, Gruetter R, Krueger G. (2014).
FID navigator triggered acquisition of imaging navigators for retrospective head motion
correction. In: ISMRM Workshop on Motion Correction, July 11-14, Tromso, Norway.
Babayeva M, Kober T, Granziera C, Nickisch H, Gruetter R, Krueger G. (2014). FID-
guided retrospective motion correction based on autofocusing. In: ISMRM, 22:2227,
Milan, Italy.
Babayeva M, Kober T, Herbst M, Hennig J, Seeger M, Gruetter R, Zaitsev M, Krueger G.
(2013). Can Multi-Channel FID Navigators Quantify Head Motion? In: ISMRM, 21:306,
Salt Lake City, USA.
In Preparation
Waszak M, Loktyushin A, Falkovskiy P, Kober T, Roche A, Marechal B, Granziera C, Mueli
R, Gruetter R, Krueger G. Blind and FID-guided Retrospective Motion Correction Based
on Autofocusing for Clinical Magnetic Resonance Images.
Waszak M, Kober T, Falkovskiy P, Roche A, Marechal B, Granziera C, Mueli R, Gruetter R,
Krueger G. FID-based Motion Sensitive MR Image Quality Metric.
Waszak M, Falkovskiy P, Kober T, Marechal B, Mueli R, Gruetter R, Krueger G. Prospective
Head Motion Correction with FID-Triggered Image Navigators.
89

