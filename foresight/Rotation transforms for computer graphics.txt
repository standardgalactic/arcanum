
Rotation Transforms for Computer Graphics

John Vince
Rotation
Transforms
for Computer
Graphics

Professor Emeritus, John Vince, MTech, PhD,
DSc, CEng, FBCS
Bournemouth University, Bournemouth, UK
url: www.johnvince.co.uk
ISBN 978-0-85729-153-0
e-ISBN 978-0-85729-154-7
DOI 10.1007/978-0-85729-154-7
Springer London Dordrecht Heidelberg New York
British Library Cataloguing in Publication Data
A catalogue record for this book is available from the British Library
¬© Springer-Verlag London Limited 2011
Apart from any fair dealing for the purposes of research or private study, or criticism or review, as per-
mitted under the Copyright, Designs and Patents Act 1988, this publication may only be reproduced,
stored or transmitted, in any form or by any means, with the prior permission in writing of the publish-
ers, or in the case of reprographic reproduction in accordance with the terms of licenses issued by the
Copyright Licensing Agency. Enquiries concerning reproduction outside those terms should be sent to
the publishers.
The use of registered names, trademarks, etc., in this publication does not imply, even in the absence of a
speciÔ¨Åc statement, that such names are exempt from the relevant laws and regulations and therefore free
for general use.
The publisher makes no representation, express or implied, with regard to the accuracy of the information
contained in this book and cannot accept any legal responsibility or liability for any errors or omissions
that may be made.
Cover design: deblik
Printed on acid-free paper
Springer is part of Springer Science+Business Media (www.springer.com)


This book is dedicated to my grandchildren,
Megan, Mia and Lucie


Preface
Every time I complete a manuscript my attention turns quickly to the title of my
next book. And after completing the latest version of Mathematics for Computer
Graphics, I began to think of what should follow. It didn‚Äôt take too long to iden-
tify the subject of this book: rotation transforms, which have always interested me
throughout my career in computer graphics.
I knew that I was not alone in Ô¨Ånding some of the ideas difÔ¨Åcult, as every time
I searched the Internet using search keys such as ‚Äòquaternions‚Äô, ‚ÄòEuler angles‚Äô, ‚Äòro-
tors‚Äô, etc., I would come across websites where groups were discussing the meaning
of gimbal lock, the matrix representation of a quaternion, eigenvectors, etc., and I
knew straight away that I had to do my bit to clarify the subject.
One of the main problems why there is so much confusion arises through the
different forms of vector and matrix notation. Some authors work with matrices that
involve row vectors, rather than column vectors, which leads to a transposed matrix.
In some cases, the direction of rotation is clockwise, rather than the normal posi-
tive, anti-clockwise direction. Quaternions are treated as a four-dimensional object
where one has to visualise a hyper-sphere before they can be mastered. Some of the
algorithms for extracting eigenvectors and their associated eigenvalue can be very
sensitive to the type of matrix in use. This is all rather disconcerting.
The experienced mathematician will take all of this in his or her stride, but to a cg
programmer trying to implement the best rotation algorithm and design some stable
code, this is not good news. So about a year ago, I started to collect my thoughts on
how to approach this subject. After a few false starts and chapter rewrites, I decided
to write an introductory book that would take the reader through the foundations of
rotation transforms from complex numbers to Clifford algebra rotors, touching on
vectors, matrices and quaternions on the journey.
Illustrations are vital to understanding rotation transforms, especially the differ-
ence between rotated points and rotated frames. I came across many websites, tech-
nical literature and books where the illustrations confused rather than clariÔ¨Åed what
was going on, and I explored various approaches before settling for a unit cube with
numbered vertices. This book contains over a hundred illustrations, which, I hope
will help the reader understand the underlying mathematics.
vii

viii
Preface
In order to create some sort of structure, I have separated transforms for rotating
points in a Ô¨Åxed frame, from transforms that rotate frames with Ô¨Åxed points. I have
also separated transforms in the plane from transforms in 3D space. In all, there are
thirteen chapters, including an introduction and summary chapters.
Chapter 2 provides a quick introduction to complex numbers and the rotational
qualities of imaginary i. The reader should be comfortable with these objects, as we
Ô¨Ånd imaginary quantities in quaternions and multivectors.
Chapter 3 covers vectors and their products, whilst Chap. 4 describes matrices
and their associated algebra. It also explores other relevant topics such as matrix
inversion, symmetric and antisymmetric matrices, eigenvectors and eigenvalues.
Chapter 5 covers quaternions and their various forms, but I leave their rotational
abilities for Chap. 11. I play down their four-dimensional attributes as I don‚Äôt believe
that this characteristic is too important within this introductory book.
Chapter 6 introduces multivector rotors that are part of Clifford‚Äôs geometric al-
gebra, and again, their rotational qualities are delayed until Chap. 12.
Chapter 7 covers rotation transforms in the plane and establishes strategies used
for transforming points in space, whilst Chap. 8 addresses rotating frames of refer-
ence in the plane.
Chapter 9 is an important chapter as it introduces the classic techniques for han-
dling 3D rotations, composite rotations, gimbal lock, and provides a stable technique
for extracting eigenvectors and eigenvalues from a matrix.
Chapter 10 develops the ideas of Chap. 9 to explain how coordinates are com-
puted in rotating frames of reference.
Chapter 11 takes quaternions from Chap. 5 and shows how they provide a pow-
erful tool for rotating points and frames about an arbitrary axis.
Chapter 12 takes the multivectors from Chap. 6 and shows how they provide a
uniÔ¨Åed system for handling rotors. Finally, Chap. 13 draws the book to a conclusion.
I would like to take this opportunity to acknowledge the authors of books, tech-
nical papers and websites who have inÔ¨Çuenced my writing over recent years. From
these dedicated people I have discovered new writing techniques, how to format
equations, and how to communicate complex ideas in an easy manner. Without
them this book would not have been possible. However, there is one author that
I must acknowledge: Michael J. Crowe. His book A History of Vector Analysis [1]
is an amazing description of how vectors and quaternions evolved, and is highly
recommended.
In particular, I would like to thank Dr Tony Crilly, Reader Emeritus at Middlesex
University, who read a draft manuscript and made many important recommenda-
tions. Tony read the book through the eyes of a novice and questioned my writing
style when clarity started to sink below the surface. Forty years ago, when I was
struggling with gimbal lock and Euler transforms, Tony brought to my attention the
rotation transform developed by Olinde Rodrigues, who had invented quaternions
before Hamilton, but that‚Äôs another story. I included this transform in my animation
software system PICASO, running on a mainframe computer with a 24 KB store!
I was very nervous about using it as sines and cosines were evaluated at a software
level and extremely slow.

Preface
ix
I would also like to thank Prof. Patrick Riley for providing me with a harmono-
gram that has formed the book‚Äôs cover design, and for his feedback on early drafts
of the manuscript when I needed to know whether I was managing to communicate
my ideas effectively.
Once again, I am indebted to Beverley Ford, General Manager, Springer UK,
and Helen Desmond, Assistant Editor for Computer Science, for their support and
reminding me of the importance of deadlines. I would also like to thank Springer‚Äôs
technical support team for their help with LATEX 2Œµ.
John Vince
Ringwood


Contents
1
Introduction . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .
1
1.1
Rotation Transforms . . . . . . . . . . . . . . . . . . . . . . . .
1
1.2
Mathematical Techniques
. . . . . . . . . . . . . . . . . . . . .
1
1.3
The Reader . . . . . . . . . . . . . . . . . . . . . . . . . . . . .
2
1.4
Aims and Objectives of This Book . . . . . . . . . . . . . . . . .
2
1.5
Assumptions Made in This Book
. . . . . . . . . . . . . . . . .
2
1.6
How to Use the Book . . . . . . . . . . . . . . . . . . . . . . . .
3
2
Complex Numbers . . . . . . . . . . . . . . . . . . . . . . . . . . . .
5
2.1
Introduction
. . . . . . . . . . . . . . . . . . . . . . . . . . . .
5
2.2
Complex Numbers . . . . . . . . . . . . . . . . . . . . . . . . .
5
2.2.1
Axioms . . . . . . . . . . . . . . . . . . . . . . . . . .
6
2.3
The Modulus . . . . . . . . . . . . . . . . . . . . . . . . . . . .
6
2.4
Addition and Subtraction . . . . . . . . . . . . . . . . . . . . . .
7
2.5
Multiplication by a Scalar . . . . . . . . . . . . . . . . . . . . .
7
2.6
Product of Two Complex Numbers
. . . . . . . . . . . . . . . .
7
2.7
The Complex Conjugate . . . . . . . . . . . . . . . . . . . . . .
8
2.8
Division of Two Complex Numbers . . . . . . . . . . . . . . . .
8
2.9
The Inverse . . . . . . . . . . . . . . . . . . . . . . . . . . . . .
9
2.10
The Complex Plane
. . . . . . . . . . . . . . . . . . . . . . . .
10
2.11
Polar Representation . . . . . . . . . . . . . . . . . . . . . . . .
11
2.12
Rotors
. . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .
13
2.13
Summary . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .
15
2.13.1
Summary of Complex Operations . . . . . . . . . . . .
16
3
Vectors . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .
17
3.1
Introduction
. . . . . . . . . . . . . . . . . . . . . . . . . . . .
17
3.2
Vector Notation . . . . . . . . . . . . . . . . . . . . . . . . . . .
17
3.3
Graphical Representation of Vectors . . . . . . . . . . . . . . . .
18
3.4
Magnitude of a Vector . . . . . . . . . . . . . . . . . . . . . . .
18
3.5
3D Vectors . . . . . . . . . . . . . . . . . . . . . . . . . . . . .
19
xi

xii
Contents
3.6
Vector Manipulation . . . . . . . . . . . . . . . . . . . . . . . .
19
3.6.1
Multiplying a Vector by a Scalar . . . . . . . . . . . . .
20
3.6.2
Vector Addition and Subtraction . . . . . . . . . . . . .
20
3.7
Position Vectors
. . . . . . . . . . . . . . . . . . . . . . . . . .
20
3.8
Unit Vectors
. . . . . . . . . . . . . . . . . . . . . . . . . . . .
21
3.9
Cartesian Vectors . . . . . . . . . . . . . . . . . . . . . . . . . .
21
3.10
Scalar Product . . . . . . . . . . . . . . . . . . . . . . . . . . .
22
3.11
The Vector Product . . . . . . . . . . . . . . . . . . . . . . . . .
24
3.12
The Right-Hand Rule
. . . . . . . . . . . . . . . . . . . . . . .
27
3.13
Deriving a Unit Normal Vector
. . . . . . . . . . . . . . . . . .
27
3.14
Interpolating Vectors . . . . . . . . . . . . . . . . . . . . . . . .
28
3.15
Summary . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .
31
3.15.1
Summary of Vector Operations . . . . . . . . . . . . . .
31
4
Matrices . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .
33
4.1
Introduction
. . . . . . . . . . . . . . . . . . . . . . . . . . . .
33
4.2
Matrices
. . . . . . . . . . . . . . . . . . . . . . . . . . . . . .
34
4.3
The Transpose of a Matrix . . . . . . . . . . . . . . . . . . . . .
35
4.4
The Identity Matrix . . . . . . . . . . . . . . . . . . . . . . . . .
35
4.5
Adding and Subtracting Matrices
. . . . . . . . . . . . . . . . .
35
4.6
Multiplying a Matrix by a Scalar . . . . . . . . . . . . . . . . . .
36
4.7
Product of Two Matrices . . . . . . . . . . . . . . . . . . . . . .
36
4.8
The Inverse Matrix . . . . . . . . . . . . . . . . . . . . . . . . .
37
4.8.1
Calculation of Inverse
. . . . . . . . . . . . . . . . . .
37
4.9
Determinant of a Matrix . . . . . . . . . . . . . . . . . . . . . .
39
4.9.1
Sarrus‚Äôs Rule . . . . . . . . . . . . . . . . . . . . . . .
39
4.9.2
The Laplace Expansion . . . . . . . . . . . . . . . . . .
41
4.10
Cofactors and Inverse of a Matrix . . . . . . . . . . . . . . . . .
42
4.11
Orthogonal Matrix . . . . . . . . . . . . . . . . . . . . . . . . .
45
4.12
Diagonal Matrix . . . . . . . . . . . . . . . . . . . . . . . . . .
45
4.13
Trace . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .
46
4.14
Symmetric Matrix . . . . . . . . . . . . . . . . . . . . . . . . .
47
4.15
Antisymmetric Matrix . . . . . . . . . . . . . . . . . . . . . . .
48
4.16
Inverting a Pair of Matrices
. . . . . . . . . . . . . . . . . . . .
50
4.17
Eigenvectors and Eigenvalues . . . . . . . . . . . . . . . . . . .
50
4.18
Vector Products . . . . . . . . . . . . . . . . . . . . . . . . . . .
55
4.19
Summary . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .
56
4.19.1
Summary of Matrix Operations
. . . . . . . . . . . . .
56
5
Quaternions . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .
59
5.1
Introduction
. . . . . . . . . . . . . . . . . . . . . . . . . . . .
59
5.2
DeÔ¨Ånition . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .
59
5.2.1
Axioms . . . . . . . . . . . . . . . . . . . . . . . . . .
60
5.3
Adding and Subtracting Quaternions
. . . . . . . . . . . . . . .
60
5.4
Multiplying Quaternions . . . . . . . . . . . . . . . . . . . . . .
61

Contents
xiii
5.5
Pure Quaternion
. . . . . . . . . . . . . . . . . . . . . . . . . .
62
5.6
Magnitude of a Quaternion . . . . . . . . . . . . . . . . . . . . .
62
5.7
Unit Quaternion
. . . . . . . . . . . . . . . . . . . . . . . . . .
62
5.8
The Quaternion Conjugate . . . . . . . . . . . . . . . . . . . . .
63
5.9
The Inverse Quaternion
. . . . . . . . . . . . . . . . . . . . . .
64
5.10
Summary . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .
65
5.10.1
Summary of Quaternion Operations . . . . . . . . . . .
65
6
Multivectors . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .
67
6.1
Introduction
. . . . . . . . . . . . . . . . . . . . . . . . . . . .
67
6.2
Symmetric and Antisymmetric Functions . . . . . . . . . . . . .
67
6.3
Trigonometric Foundations
. . . . . . . . . . . . . . . . . . . .
68
6.4
Vectorial Foundations
. . . . . . . . . . . . . . . . . . . . . . .
68
6.5
Inner and Outer Products . . . . . . . . . . . . . . . . . . . . . .
69
6.6
The Geometric Product in 2D . . . . . . . . . . . . . . . . . . .
69
6.7
The Geometric Product in 3D . . . . . . . . . . . . . . . . . . .
71
6.8
The Outer Product of Three 3D Vectors . . . . . . . . . . . . . .
73
6.9
Axioms . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .
74
6.10
Notation
. . . . . . . . . . . . . . . . . . . . . . . . . . . . . .
75
6.11
Grades, Pseudoscalars and Multivectors . . . . . . . . . . . . . .
75
6.12
RedeÔ¨Åning the Inner and Outer Products
. . . . . . . . . . . . .
76
6.13
The Inverse of a Vector . . . . . . . . . . . . . . . . . . . . . . .
77
6.14
The Imaginary Properties of the Outer Product . . . . . . . . . .
78
6.15
Duality . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .
80
6.16
The Relationship Between the Vector Product and the Outer
Product . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .
81
6.17
The Relationship Between Quaternions and Bivectors
. . . . . .
81
6.18
Reverse of a Multivector . . . . . . . . . . . . . . . . . . . . . .
82
6.19
Summary . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .
83
6.19.1
Summary of Multivector Operations . . . . . . . . . . .
83
7
Rotation Transforms in the Plane . . . . . . . . . . . . . . . . . . . .
85
7.1
Introduction
. . . . . . . . . . . . . . . . . . . . . . . . . . . .
85
7.2
2D Transforms . . . . . . . . . . . . . . . . . . . . . . . . . . .
85
7.2.1
Homogeneous Coordinates . . . . . . . . . . . . . . . .
85
7.3
Matrix Transforms . . . . . . . . . . . . . . . . . . . . . . . . .
86
7.3.1
Translate a Point
. . . . . . . . . . . . . . . . . . . . .
87
7.3.2
Rotate a Point About the Origin . . . . . . . . . . . . .
87
7.3.3
Rotate a Point About an Arbitrary Point . . . . . . . . .
89
7.3.4
Rotate and Translate a Point . . . . . . . . . . . . . . .
91
7.3.5
Composite Rotations . . . . . . . . . . . . . . . . . . .
91
7.4
Inverse Transforms . . . . . . . . . . . . . . . . . . . . . . . . .
92
7.5
Multivector Transforms
. . . . . . . . . . . . . . . . . . . . . .
93
7.5.1
Translate a Point
. . . . . . . . . . . . . . . . . . . . .
93
7.5.2
Rotational Qualities of the Unit Bivector . . . . . . . . .
94

xiv
Contents
7.5.3
Rotate a Point About the Origin . . . . . . . . . . . . .
97
7.5.4
Rotate a Point About an Arbitrary Point . . . . . . . . .
99
7.6
Summary . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 100
7.6.1
Summary of Matrix Transforms . . . . . . . . . . . . . 100
7.6.2
Summary of Multivector Transforms . . . . . . . . . . . 101
8
Frames of Reference in the Plane . . . . . . . . . . . . . . . . . . . . 103
8.1
Introduction
. . . . . . . . . . . . . . . . . . . . . . . . . . . . 103
8.2
Frames of Reference . . . . . . . . . . . . . . . . . . . . . . . . 103
8.3
Matrix Transforms . . . . . . . . . . . . . . . . . . . . . . . . . 104
8.3.1
Translated Frame of Reference . . . . . . . . . . . . . . 104
8.3.2
Rotated Frame of Reference . . . . . . . . . . . . . . . 106
8.3.3
Rotated and Translated Frame of Reference . . . . . . . 107
8.4
Direction Cosines
. . . . . . . . . . . . . . . . . . . . . . . . . 109
8.5
Multivector Transforms
. . . . . . . . . . . . . . . . . . . . . . 110
8.5.1
Translated Frame of Reference . . . . . . . . . . . . . . 110
8.5.2
Rotated Frame of Reference . . . . . . . . . . . . . . . 111
8.5.3
Rotated and Translated Frame of Reference . . . . . . . 112
8.6
Summary . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 113
8.6.1
Summary of Matrix Transforms . . . . . . . . . . . . . 113
8.6.2
Summary of Multivector Transforms . . . . . . . . . . . 114
9
Rotation Transforms in Space . . . . . . . . . . . . . . . . . . . . . . 115
9.1
Introduction
. . . . . . . . . . . . . . . . . . . . . . . . . . . . 115
9.2
3D Transforms . . . . . . . . . . . . . . . . . . . . . . . . . . . 115
9.2.1
Translate a Point
. . . . . . . . . . . . . . . . . . . . . 115
9.2.2
Rotate a Point About the Cartesian Axes . . . . . . . . . 116
9.2.3
Rotating About an Off-Set Axis . . . . . . . . . . . . . 117
9.3
Composite Rotations . . . . . . . . . . . . . . . . . . . . . . . . 118
9.3.1
3D Eigenvectors
. . . . . . . . . . . . . . . . . . . . . 123
9.4
Gimbal Lock . . . . . . . . . . . . . . . . . . . . . . . . . . . . 130
9.5
Yaw, Pitch and Roll
. . . . . . . . . . . . . . . . . . . . . . . . 132
9.6
Rotating a Point About an Arbitrary Axis . . . . . . . . . . . . . 134
9.6.1
Matrices . . . . . . . . . . . . . . . . . . . . . . . . . . 134
9.6.2
Vectors . . . . . . . . . . . . . . . . . . . . . . . . . . 137
9.7
Summary . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 140
9.7.1
Summary of Matrix Transforms . . . . . . . . . . . . . 141
10
Frames of Reference in Space . . . . . . . . . . . . . . . . . . . . . . 143
10.1
Introduction
. . . . . . . . . . . . . . . . . . . . . . . . . . . . 143
10.2
Frames of Reference . . . . . . . . . . . . . . . . . . . . . . . . 143
10.3
Matrix Transforms . . . . . . . . . . . . . . . . . . . . . . . . . 144
10.3.1
Translated Frames of Reference . . . . . . . . . . . . . 144
10.3.2
Rotated Frames of Reference About Cartesian Axes . . . 145
10.3.3
Rotated Frames About Off-Set Axes . . . . . . . . . . . 147
10.4
Composite Rotations . . . . . . . . . . . . . . . . . . . . . . . . 149

Contents
xv
10.5
Rotated and Translated Frames of Reference
. . . . . . . . . . . 150
10.6
Rotated Frames of Reference About Arbitrary Axes
. . . . . . . 152
10.7
Summary . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 153
10.7.1
Summary of Transforms . . . . . . . . . . . . . . . . . 153
11
Quaternion Transforms in Space . . . . . . . . . . . . . . . . . . . . 155
11.1
Introduction
. . . . . . . . . . . . . . . . . . . . . . . . . . . . 155
11.2
DeÔ¨Ånition . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 155
11.3
Quaternions in Matrix Form . . . . . . . . . . . . . . . . . . . . 162
11.3.1
Quaternion Products and Matrices . . . . . . . . . . . . 164
11.3.2
Geometric VeriÔ¨Åcation . . . . . . . . . . . . . . . . . . 166
11.4
Multiple Rotations . . . . . . . . . . . . . . . . . . . . . . . . . 168
11.5
Eigenvalue and Eigenvector . . . . . . . . . . . . . . . . . . . . 169
11.6
Rotating About an Off-Set Axis . . . . . . . . . . . . . . . . . . 170
11.7
Frames of Reference . . . . . . . . . . . . . . . . . . . . . . . . 171
11.8
Interpolating Quaternions
. . . . . . . . . . . . . . . . . . . . . 173
11.9
Converting a Rotation Matrix to a Quaternion . . . . . . . . . . . 177
11.10 Summary . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 178
11.10.1 Summary of Quaternion Transforms . . . . . . . . . . . 178
12
Bivector Rotors . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 181
12.1
Introduction
. . . . . . . . . . . . . . . . . . . . . . . . . . . . 181
12.2
The Three ReÔ¨Çections Theorem . . . . . . . . . . . . . . . . . . 181
12.3
ReÔ¨Çecting a Vector . . . . . . . . . . . . . . . . . . . . . . . . . 182
12.4
3D Rotations . . . . . . . . . . . . . . . . . . . . . . . . . . . . 184
12.5
Rotors as Matrices . . . . . . . . . . . . . . . . . . . . . . . . . 188
12.5.1
2D Rotor . . . . . . . . . . . . . . . . . . . . . . . . . 188
12.5.2
3D Rotor . . . . . . . . . . . . . . . . . . . . . . . . . 189
12.5.3
Extracting a Rotor
. . . . . . . . . . . . . . . . . . . . 191
12.6
Summary . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 195
12.6.1
Summary of Bivector Transforms
. . . . . . . . . . . . 195
13
Conclusion
. . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 197
Appendix A
Composite Point Rotation Sequences
. . . . . . . . . . . . 199
A.1
Euler Rotations . . . . . . . . . . . . . . . . . . . . . . . . . . . 199
A.2
RŒ≥,xRŒ≤,yRŒ±,x
. . . . . . . . . . . . . . . . . . . . . . . . . . . 200
A.3
RŒ≥,xRŒ≤,yRŒ±,z . . . . . . . . . . . . . . . . . . . . . . . . . . . . 201
A.4
RŒ≥,xRŒ≤,zRŒ±,x . . . . . . . . . . . . . . . . . . . . . . . . . . . . 202
A.5
RŒ≥,xRŒ≤,zRŒ±,y . . . . . . . . . . . . . . . . . . . . . . . . . . . . 203
A.6
RŒ≥,yRŒ≤,xRŒ±,y
. . . . . . . . . . . . . . . . . . . . . . . . . . . 204
A.7
RŒ≥,yRŒ≤,xRŒ±,z . . . . . . . . . . . . . . . . . . . . . . . . . . . . 205
A.8
RŒ≥,yRŒ≤,zRŒ±,x . . . . . . . . . . . . . . . . . . . . . . . . . . . . 206
A.9
RŒ≥,yRŒ≤,zRŒ±,y . . . . . . . . . . . . . . . . . . . . . . . . . . . . 207
A.10
RŒ≥,zRŒ≤,xRŒ±,y . . . . . . . . . . . . . . . . . . . . . . . . . . . . 208
A.11
RŒ≥,zRŒ≤,xRŒ±,z . . . . . . . . . . . . . . . . . . . . . . . . . . . . 209

xvi
Contents
A.12
RŒ≥,zRŒ≤,yRŒ±,x . . . . . . . . . . . . . . . . . . . . . . . . . . . . 210
A.13
RŒ≥,zRŒ≤,yRŒ±,z . . . . . . . . . . . . . . . . . . . . . . . . . . . . 211
Appendix B
Composite Frame Rotation Sequences . . . . . . . . . . . . 213
B.1
Euler Rotations . . . . . . . . . . . . . . . . . . . . . . . . . . . 213
B.2
R‚àí1
Œ≥,xR‚àí1
Œ≤,yR‚àí1
Œ±,x
. . . . . . . . . . . . . . . . . . . . . . . . . . . 214
B.3
R‚àí1
Œ≥,xR‚àí1
Œ≤,yR‚àí1
Œ±,z . . . . . . . . . . . . . . . . . . . . . . . . . . . . 214
B.4
R‚àí1
Œ≥,xR‚àí1
Œ≤,zR‚àí1
Œ±,x . . . . . . . . . . . . . . . . . . . . . . . . . . . . 215
B.5
R‚àí1
Œ≥,xR‚àí1
Œ≤,zR‚àí1
Œ±,y . . . . . . . . . . . . . . . . . . . . . . . . . . . . 216
B.6
R‚àí1
Œ≥,yR‚àí1
Œ≤,xR‚àí1
Œ±,y
. . . . . . . . . . . . . . . . . . . . . . . . . . . 217
B.7
R‚àí1
Œ≥,yR‚àí1
Œ≤,xR‚àí1
Œ±,z . . . . . . . . . . . . . . . . . . . . . . . . . . . . 218
B.8
R‚àí1
Œ≥,yR‚àí1
Œ≤,zR‚àí1
Œ±,x . . . . . . . . . . . . . . . . . . . . . . . . . . . . 219
B.9
R‚àí1
Œ≥,yR‚àí1
Œ≤,zR‚àí1
Œ±,y . . . . . . . . . . . . . . . . . . . . . . . . . . . . 220
B.10
R‚àí1
Œ≥,zR‚àí1
Œ≤,xR‚àí1
Œ±,y . . . . . . . . . . . . . . . . . . . . . . . . . . . . 221
B.11
R‚àí1
Œ≥,zR‚àí1
Œ≤,xR‚àí1
Œ±,z . . . . . . . . . . . . . . . . . . . . . . . . . . . . 222
B.12
R‚àí1
Œ≥,zR‚àí1
Œ≤,yR‚àí1
Œ±,x . . . . . . . . . . . . . . . . . . . . . . . . . . . . 223
B.13
R‚àí1
Œ≥,zR‚àí1
Œ≤,yR‚àí1
Œ±,z . . . . . . . . . . . . . . . . . . . . . . . . . . . . 224
Appendix C
The Four n-Square Algebras . . . . . . . . . . . . . . . . . 227
C.1
Introduction
. . . . . . . . . . . . . . . . . . . . . . . . . . . . 227
References
. . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 229
Index
. . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 231


Chapter 1
Introduction
1.1 Rotation Transforms
In computer graphics the position of an object is expressed by two transforms:
translation and rotation. It is relatively easy to visualise a translation and express
it mathematically, however rotations do present problems. Furthermore, it is not just
objects that require rotating and translating ‚Äì frames of reference have to be posi-
tioned within the world coordinate system in order to secure different views of the
virtual world. In order to do this, it is necessary to combine rotation and translation
transforms.
When rotating and translating objects, the angles and translation offsets are often
relative to a Ô¨Åxed frame of reference. However, when rotating and translating frames
of reference, the angles and offsets are relative to a changing frame of reference,
which requires careful handling. Primarily, this book is about rotation transforms,
and how they are used for moving objects and frames of reference in the plane and
in 3D space. But in order to do this within a real computer graphics context, it is
necessary to include the translation transform, which introduces some realism to the
Ô¨Ånal solution.
The world of mathematics offers a wide variety of rotation techniques to choose
from such as direction cosines, Euler angles, quaternions and multivectors. Each has
strengths and weaknesses, advocates and critics, therefore no attempt will be made
to identify a ‚Äòbest‚Äô technique. However, I will attempt to draw your attention to their
qualities in order that you can draw your own conclusions.
1.2 Mathematical Techniques
Six branches of mathematics play an important role in rotations: trigonometry, com-
plex numbers, vectors, matrices, quaternions and multivectors, which are described
in the following chapters and ensure that this book is self contained. We only require
to consider certain aspects of trigonometry which will become foundations for the
J. Vince, Rotation Transforms for Computer Graphics,
DOI 10.1007/978-0-85729-154-7_1, ¬© Springer-Verlag London Limited 2011
1

2
1
Introduction
other topics. Complex numbers are extremely useful from two perspectives: the Ô¨Årst
is that they pave the way to the idea of a rotational operator, and second, they play
an intrinsic part in quaternions and multivectors. Vectors provide a mechanism for
representing oriented lines, and together with complex numbers form the basis for
quaternions, which provide a mechanism for rotating points about an arbitrary axis.
Lastly, multivectors introduce the concept of oriented areas and volumes, and pro-
vide an algebra for undertaking a wide range of geometric operations, especially
rotations.
1.3 The Reader
This is an introductory book and is aimed at readers studying or working in com-
puter graphics who require an overview of the mathematics behind rotation trans-
forms. They are probably the same people I have encountered asking questions on
Internet forums about Euler angles, quaternions, gimbal lock and how to extract a
direction vector from a rotation matrix.
Many years ago, when writing a computer animation software, I encountered
gimbal lock and had to Ô¨Ånd a way around the problem. Today, students and pro-
grammers are still discovering gimbal lock for the Ô¨Årst time, and that certain mathe-
matical techniques are not completely stable, and that special cases require detection
if their software is to remain operational.
1.4 Aims and Objectives of This Book
The aim of this book is to take the reader through the important ideas and mathemat-
ical techniques associated with rotation transforms, without becoming too pedantic
about mathematical terminology. My objective is to make the reader conÔ¨Ådent and
comfortable with the algebra associated with complex numbers, vectors, matrices,
quaternions and rotors, which seems like a daunting task. However, I believe that
this is achievable, and is why I have included a large number of worked examples,
and shown what happens when we ignore important rules.
1.5 Assumptions Made in This Book
I only expect the reader to be competent in handling algebraic expansions, and to
have a reasonable understanding of trigonometry and geometry. They will probably
be familiar with vectors but not necessarily with matrices, which is why I have
included chapters on these topics.

1.6
How to Use the Book
3
1.6 How to Use the Book
The book has a linear narrative and readers with different backgrounds can jump in
at any convenient point. Apart from explaining the mathematical techniques, I have
tried to introduce the reader to the mathematicians behind the techniques. Math-
ematicians such as Hamilton, Cayley, Gibbs, Clifford, Euler, Laplace, Sarrus and
Grassmann have all played a part in rotation transforms and associated mathemat-
ics, and are responsible for the techniques we use today. Hopefully, you will Ô¨Ånd
this background material relevant and interesting.


Chapter 2
Complex Numbers
2.1 Introduction
Complex numbers have been described as the ‚Äòking‚Äô of numbers, probably because
they resolve all sorts of mathematical problems where ordinary real numbers fail.
For example, the rather innocent looking equation
1 + x2 = 0
has no real solution, which seems amazing when one considers the equation‚Äôs sim-
plicity. But one does not need a long equation to show that the algebra of real num-
bers is unable to cope with objects such as
x =
‚àö
‚àí1.
However, this did not prevent mathematicians from Ô¨Ånding a way around such an
inconvenience, and fortuitously the solution turned out to be an incredible idea that
is used everywhere from electrical engineering to cosmology. The simple idea of
declaring the existence of a quantity i, such that i2 = ‚àí1, permits us to express the
solution to the above equation as
x = ¬±i.
All very well, you might say, but what is i? What is mathematics? One could also
ask, and spend an eternity searching for an answer! i is simply a mathematical object
whose square is ‚àí1. Let us continue with this strange object and see how it leads us
into the world of rotations.
2.2 Complex Numbers
A complex number has two parts: a real part and an imaginary part. The real part
is just an ordinary number that may be zero, positive or negative, and the imaginary
part is another real number multiplied by i. For example, 2+3i is a complex number
J. Vince, Rotation Transforms for Computer Graphics,
DOI 10.1007/978-0-85729-154-7_2, ¬© Springer-Verlag London Limited 2011
5

6
2
Complex Numbers
where 2 is the real part and 3i is the imaginary part. The following are all complex
numbers:
2,
2 + 2i,
1 ‚àí3i,
‚àí4i,
17i.
Note the convention to place the real part Ô¨Årst, followed by i. However, if i is as-
sociated with a trigonometric function such as sin or cos, it is usual to place i in
front of the function: i sinŒ∏ or i cosŒ∏, to avoid any confusion that it is part of the
function‚Äôs angle.
All that we have to remember is that whenever we manipulate complex numbers,
the occurrence of i2 is replaced by ‚àí1.
2.2.1 Axioms
The axioms deÔ¨Åning the behaviour of complex numbers are identical to those asso-
ciated with real numbers. For example, given two complex numbers z1 and z2 they
obey the following rules:
Addition:
Commutative
z1 + z2 = z2 + z1
Associative
(z1 + z2) + z3 = z1 + (z2 + z3).
Multiplication:
Commutative
z1z2 = z2z1
Associative
(z1z2)z3 = z1 (z2z3)
Distributive
z1 (z2 + z3) = z1z2 + z1z3
(z1 + z2)z3 = z1z3 + z2z3.
2.3 The Modulus
The modulus of a complex number a + bi is deÔ¨Åned as
‚àö
a2 + b2. For example, the
modulus of 3+4i is 5. In general, the modulus of a complex number z is written |z|:
z = a + bi
|z| =

a2 + b2.
We‚Äôll see why this is so when we cover the polar representation of a complex num-
ber.

2.4
Addition and Subtraction
7
2.4 Addition and Subtraction
Given two complex numbers:
z1 = a + bi
z2 = c + di
z1 ¬± z2 = (a ¬± c) + (b ¬± d)i
where the real and imaginary parts are added or subtracted, respectively. For exam-
ple:
z1 = 5 + 3i
z2 = 3 + 2i
z1 + z2 = 8 + 5i
z1 ‚àíz2 = 2 + i.
2.5 Multiplication by a Scalar
A scalar is just an ordinary number, and may be used to multiply a complex number
using normal algebraic rules. For example, the complex number a +bi is multiplied
by the scalar Œª as follows:
Œª(a + bi) = Œªa + Œªbi
and a speciÔ¨Åc example:
2(3 + 5i) = 6 + 10i.
2.6 Product of Two Complex Numbers
The product of two complex numbers is evaluated by creating all the terms alge-
braically, and collecting up the real and imaginary terms:
z1 = a + bi
z2 = c + di
z1z2 = (a + bi)(c + di)
= ac + adi + bci + bdi2
= (ac ‚àíbd) + (ad + bc)i
which is another complex number. For example:

8
2
Complex Numbers
z1 = 3 + 4i
z2 = 5 ‚àí2i
z1z2 = (3 + 4i)(5 ‚àí2i)
= 15 ‚àí6i + 20i ‚àí8i2
= 15 + 14i + 8
= 23 + 14i.
Remember that the addition, subtraction and multiplication of complex numbers
obey the normal axioms of algebra. Also, the multiplication of two complex num-
bers, and their addition always results in a complex number, that is, the two opera-
tions are closed.
2.7 The Complex Conjugate
A special case exists when we multiply two complex numbers together where the
only difference between them is the sign of the imaginary part:
(a + bi)(a ‚àíbi) = a2 ‚àíabi + abi ‚àíb2i2
= a2 + b2.
As this real value is such an interesting result, a ‚àíbi is called the complex conjugate
of a + bi. In general, the complex conjugate of
z = a + bi
is written either with a bar ¬Øz symbol or an asterisk z‚àóas
z‚àó= a ‚àíbi
and implies that
zz‚àó= a2 + b2 = |z|2.
2.8 Division of Two Complex Numbers
The complex conjugate provides us with a mechanism to divide one complex num-
ber by another. For instance, consider the quotient
a + bi
c + di .
This can be resolved by multiplying the numerator and denominator by the complex
conjugate c ‚àídi to create a real denominator:

2.9
The Inverse
9
a + bi
c + di = (a + bi)(c ‚àídi)
(c + di)(c ‚àídi)
= ac ‚àíadi + bci ‚àíbdi2
c2 + d2
=
ac + bd
c2 + d2

+
bc ‚àíad
c2 + d2

i.
Another special case is when a = 1 and b = 0:
1
c + di = (c + di)‚àí1 =

c
c2 + d2

‚àí

d
c2 + d2

i
which is the inverse of a complex number.
Let‚Äôs evaluate the quotient:
4 + 3i
3 + 4i .
Multiplying top and bottom by the complex conjugate 3 ‚àí4i we have
4 + 3i
3 + 4i = (4 + 3i)(3 ‚àí4i)
(3 + 4i)(3 ‚àí4i)
= 12 ‚àí16i + 9i ‚àí12i2
25
= 24
25 ‚àí7
25i.
2.9 The Inverse
Although we have already discovered the inverse of a complex number, let‚Äôs employ
another strategy by declaring
z1 = 1
z
where z is a complex number.
Next, we divide both sides by the complex conjugate of z to create
z1
z‚àó= 1
zz‚àó.
But we have previously shown that zz‚àó= |z|2, therefore,
z1
z‚àó=
1
|z|2
and rearranging, we have
z1 = z‚àó
|z|2 .
In general
1
z = z‚àí1 = z‚àó
|z|2 .

10
2
Complex Numbers
As an illustration let‚Äôs Ô¨Ånd the inverse of 3 + 4i
1
3 + 4i = (3 + 4i)‚àí1
= 3 ‚àí4i
25
= 3
25 ‚àí4
25i.
Let‚Äôs test this result by multiplying z by its inverse:
(3 + 4i)
 3
25 ‚àí4
25i

= 9
25 ‚àí12
25i + 12
25i + 16
25 = 1
which conÔ¨Årms the correctness of the inverse.
2.10 The Complex Plane
Leonhard Euler (1707‚Äì1783) (whose name rhymes with boiler) played a signiÔ¨Åcant
role in putting complex numbers on the map. His ideas on rotations are also used
in computer graphics to locate objects and virtual cameras in space, as we shall see
later on.
Consider the scenario depicted in Fig. 2.1. Any number on the number line is
related to the same number with the opposite sign via a rotation of 180¬∞. For exam-
ple, when 2 is rotated 180¬∞ about zero, it becomes ‚àí2, and when ‚àí3 is rotated 180¬∞
about zero it becomes 3.
But as we know that i2 = ‚àí1 we can write
‚àín = i2n.
If we now regard i2 as a rotation through 180¬∞, then i could be a rotation through
90¬∞!
Figure 2.2 shows how complex numbers can be interpreted as 2D coordinates
using the complex plane where the real part is the horizontal coordinate and the
Fig. 2.1 Rotating numbers
through 180¬∞ reverses their
sign

2.11
Polar Representation
11
Fig. 2.2 The graphical representation of complex numbers
imaginary part is the vertical coordinate. The Ô¨Ågure also shows four complex num-
bers:
p = 1 + 2i,
q = ‚àí2 + i,
r = ‚àí1 ‚àí2i,
s = 2 ‚àíi
which happen to be 90¬∞ apart. For example, the complex number p in Fig. 2.2 is
rotated 90¬∞ to q by multiplying it by i:
i (1 + 2i) = i + 2i2
= ‚àí2 + i.
The point q is rotated another 90¬∞ to r by multiplying it by i:
i (‚àí2 + i) = ‚àí2i + i2
= ‚àí1 ‚àí2i.
The point r is rotated another 90¬∞ to s by multiplying it by i:
i (‚àí1 ‚àí2i) = ‚àíi ‚àí2i2
= 2 ‚àíi.
Finally, the point s is rotated 90¬∞ back to p by multiplying it by i:
i (2 ‚àíi) = 2i ‚àíi2
= 1 + 2i.
2.11 Polar Representation
The complex plane provides a simple mechanism to represent complex numbers
graphically. This in turn makes it possible to use a polar representation as shown

12
2
Complex Numbers
Fig. 2.3 Polar representation
of a complex number
in Fig. 2.3 where we see the complex number z = a + bi representing the oriented
line r. The length of r is obviously
‚àö
a2 + b2, which is why the modulus of a com-
plex number has the same deÔ¨Ånition. We can see from Fig. 2.3 that the horizontal
component of z is r cosŒ∏ and the vertical component is r sinŒ∏, which permits us to
write
z = a + bi
= r cosŒ∏ + ri sinŒ∏
= r (cosŒ∏ + i sinŒ∏).
Note that i has been placed in front of the sin function.
The angle Œ∏ between r and the real axis is called the argument and written arg(z),
and in this case
arg(z) = Œ∏.
One of Euler‚Äôs discoveries concerns the relationship between the series for expo-
nential e, sin and cos:
eiŒ∏ = cosŒ∏ + i sinŒ∏
which enables us to write
z = reiŒ∏.
We are now in a position to revisit the product and quotient of two complex
numbers using polar representation. For example:
z = r (cosŒ∏ + i sinŒ∏)
w = s (cosœÜ + i sinœÜ)
zw = rs (cosŒ∏ + i sinŒ∏)(cosœÜ + i sinœÜ)
= rs

cosŒ∏ cosœÜ + i cosŒ∏ sinœÜ + i sinŒ∏ cosœÜ + i2 sinŒ∏ sinœÜ

= rs

(cosŒ∏ cosœÜ ‚àísinŒ∏ sinœÜ) + i (sinŒ∏ cosœÜ + cosŒ∏ sinœÜ)

and as

2.12
Rotors
13
Fig. 2.4 The product of two complex numbers
cos(Œ∏ + œÜ) = cosŒ∏ cosœÜ ‚àísinŒ∏ sinœÜ
sin(Œ∏ + œÜ) = sinŒ∏ cosœÜ + cosŒ∏ sinœÜ
zw = rs

cos(Œ∏ + œÜ) + i sin(Œ∏ + œÜ)

.
So the product of two complex numbers creates a third one with modulus
|zw| = rs
and argument
arg(zw) = arg(z) + arg(w) = Œ∏ + œÜ.
Let‚Äôs illustrate this with an example. Figure 2.4 shows two complex numbers
z = 1 + i,
w = 2i
therefore,
|z| =
‚àö
2,
arg(z) = 45¬∞
|w| = 2,
arg(w) = 90¬∞
|zw| = 2
‚àö
2
arg(zw) = 135¬∞
which is another complex number ‚àí2 + 2i.
2.12 Rotors
The above observations imply that multiplying a complex number by another, whose
modulus is unity, causes no scaling. For example, multiplying 3 + 4i by 1 + 0i
creates the same complex number, unscaled and unrotated. However, multiplying
3 + 4i by 0 + i rotates it by 90¬∞ without any scaling.

14
2
Complex Numbers
Fig. 2.5 Rotating a complex
number about another
complex number
So to rotate 2 + 2i by 45¬∞ we must multiply it by
cos45¬∞ + i sin45¬∞ =
‚àö
2
2 +
‚àö
2
2 i
‚àö
2
2 +
‚àö
2
2 i

(2 + 2i) =
‚àö
2 +
‚àö
2i +
‚àö
2i +
‚àö
2i2
= 2
‚àö
2i.
So now we have a rotor to rotate a complex number through any angle. In general,
the rotor to rotate a complex number a + bi through an angle Œ∏ is
RŒ∏ = cosŒ∏ + i sinŒ∏.
Now let‚Äôs consider the problem of rotating 3 + 3i, 45¬∞ about 2 + 2i as shown
in Fig. 2.5. From the Ô¨Ågure, the result is z ‚âà2 + 3.414i, but let‚Äôs calculate it by
subtracting 2 + 2i from 3 + 3i to shift the operation to the origin, then multiply the
result by
‚àö
2/2 +
‚àö
2/2i, and then add back 2 + 2i:
z =
‚àö
2
2 +
‚àö
2
2 i

(3 + 3i) ‚àí(2 + 2i)

+ 2 + 2i
=
‚àö
2
2 +
‚àö
2
2 i

(1 + i) + 2 + 2i
=
‚àö
2
2 +
‚àö
2
2 i +
‚àö
2
2 i ‚àí
‚àö
2
2 + 2 + 2i
= 2 + (2 +
‚àö
2)i
‚âà2 + 3.414i
which is correct. Therefore, to rotate any point (x,y) through an angle Œ∏ we convert
it into a complex number x + yi and multiply by the rotor cosŒ∏ + i sinŒ∏:

2.13
Summary
15
x‚Ä≤ + y‚Ä≤i = (cosŒ∏ + i sinŒ∏)(x + yi)
= (x cosŒ∏ ‚àíy sinŒ∏) + (x sinŒ∏ + y cosŒ∏)i
where (x‚Ä≤,y‚Ä≤) is the rotated point.
But as we shall see in Chap. 4, this is the transform for rotating a point (x,y)
about the origin:
x‚Ä≤
y‚Ä≤

=
cosŒ∏
‚àísinŒ∏
sinŒ∏
cosŒ∏
x
y

.
Before moving on let‚Äôs consider the effect the complex conjugate of a rotor has
on rotational direction, and we can do this by multiplying x +yi by the rotor cosŒ∏ ‚àí
i sinŒ∏:
x‚Ä≤ + y‚Ä≤i = (cosŒ∏ ‚àíi sinŒ∏)(x + yi)
= x cosŒ∏ + y sinŒ∏ ‚àí(x sinŒ∏ + y cosŒ∏)i
which in matrix form is
x‚Ä≤
y‚Ä≤

=

cosŒ∏
sinŒ∏
‚àísinŒ∏
cosŒ∏
x
y

which is a rotation of ‚àíŒ∏.
Therefore, we deÔ¨Åne a rotor RŒ∏ and its conjugate R‚Ä†
Œ∏ as
RŒ∏ = cosŒ∏ + i sinŒ∏
R‚Ä†
Œ∏ = cosŒ∏ ‚àíi sinŒ∏
where RŒ∏ rotates +Œ∏, and R‚Ä†
Œ∏ rotates ‚àíŒ∏. The dagger symbol ‚Äò‚Ä†‚Äô is chosen as it is
used for rotors in multivectors, which are covered later.
2.13 Summary
There is no doubt that complex numbers are amazing objects and arise simply by
introducing the symbol i which squares to ‚àí1. It is unfortunate that the names
‚Äòcomplex‚Äô and ‚Äòimaginary‚Äô are used to describe them as they are neither complex
nor imaginary, but very simple. We will come across them again in later chapters
and see how they provide a way of rotating 3D points.
In this chapter we have seen that complex numbers can be added, subtracted,
multiplied and divided, and they can even be raised to a power. We have also come
across new terms such as: complex conjugate, modulus and argument. We have also
discovered the rotor which permits us to rotate 2D points.
In the mid-19th century, mathematicians started to look for the 3D equivalent
of complex numbers, and after many years of work, Sir William Rowan Hamilton
invented quaternions which are the subject of a later chapter.

16
2
Complex Numbers
2.13.1 Summary of Complex Operations
Complex number
z = a + bi
where i2 = ‚àí1.
Addition and subtraction
z1 = a + bi
z2 = c + di
z1 ¬± z2 = (a ¬± c) + (b ¬± d)i.
Scalar product
Œªz = Œªa + Œªbi.
Modulus
|z| =

a2 + b2.
Product
z1z2 = (ac ‚àíbd) + (ad + bc)i.
Complex conjugate
z‚àó= a ‚àíbi.
Division
z1
z2
=
ac + bd
c2 + d2

+
bc ‚àíad
c2 + d2

i.
Inverse
z‚àí1 = z‚àó
|z|2 .
Polar form
z = r (cosŒ∏ + i sinŒ∏)
r = |z|
Œ∏ = arg(z)
z = reiŒ∏.
Rotors
RŒ∏ = cosŒ∏ + i sinŒ∏
R‚Ä†
Œ∏ = cosŒ∏ ‚àíi sinŒ∏.

Chapter 3
Vectors
3.1 Introduction
Vectors can be used to represent all sorts of data from weather maps to magnetic
Ô¨Åelds, and in computer graphics they are used to represent oriented lines and lo-
cate points in space. In 1853 Sir William Rowan Hamilton (1805‚Äì1865) published
his book Lectures on Quaternions [2] in which he described terms such as vector,
transvector and provector. Hamilton had been looking for a 3D equivalent to com-
plex numbers and discovered quaternions. However his work was not widely ac-
cepted until 1884, when the American mathematician Josiah Willard Gibbs (1839‚Äì
1903) published his treatise Elements of Vector Analysis, [3] describing modern
vector analysis.
3.2 Vector Notation
As a vector contains two or more numbers, its symbolic name is generally printed
using a bold font to distinguish it from a scalar variable. Examples being n, i and q.
When a vector is assigned its numeric values, the following notation is used
n =
2
3

.
The numbers 2 and 3 are the components of n and their position within the brackets
is very important.
Two types of notation are in use today: column vectors and row vectors. In this
book we use column vectors, although they can be transposed into a row vector
using this notation: n = [2
3]T. The superscript T reminds us of the column to row
transposition.
J. Vince, Rotation Transforms for Computer Graphics,
DOI 10.1007/978-0-85729-154-7_3, ¬© Springer-Verlag London Limited 2011
17

18
3
Vectors
Fig. 3.1 A vector is
represented by an oriented
line segment
3.3 Graphical Representation of Vectors
Cartesian coordinates provide an excellent mechanism for representing vectors and
allows them to be incorporated within the classical framework of mathematics. Fig-
ure 3.1 shows an oriented line segment used to represent a vector. The length of the
line represents the vector‚Äôs magnitude, and the line‚Äôs orientation and arrow deÔ¨Åne
its direction.
The line‚Äôs direction is determined by the vector‚Äôs head (xh,yh) and tail (xt,yt)
from which we compute its x- and y-components x and y:
x = xh ‚àíxt
y = yh ‚àíyt.
For example, in Fig. 3.1 the vector‚Äôs head is (6,4) and its tail is (1,1), which
makes its components x = 5 and y = 3 or [5
3]T. If the vector is pointing in the
opposite direction, its components become x = ‚àí5 and y = ‚àí3 or [‚àí5
‚àí3]T.
One can readily see from this notation that a vector does not have a unique posi-
tion in space. It does not matter where we place a vector, so long as we preserve its
length and orientation its components will not alter.
3.4 Magnitude of a Vector
The length or magnitude of a vector r is written |r| and is computed by applying the
theorem of Pythagoras to its components x and y:
|r| =

2x + 2y.
For example, the magnitude of vector [3
4]T is
‚àö
32 + 42 = 5. Figure 3.2 shows
eight vectors, with their geometric properties listed in Table 3.1. The subscripts h
and t stand for head and tail respectively.

3.5
3D Vectors
19
Fig. 3.2 Eight vectors whose
coordinates are shown in
Table 3.1
Table 3.1 Values associated
with the eight vectors in
Fig. 3.2
xh
yh
xt
yt
x
y
|vector|
2
0
0
0
2
0
2
0
2
0
0
0
2
2
‚àí2
0
0
0
‚àí2
0
2
0
‚àí2
0
0
0
‚àí2
2
1
1
0
0
1
1
‚àö
2
‚àí1
1
0
0
‚àí1
1
‚àö
2
‚àí1
‚àí1
0
0
‚àí1
‚àí1
‚àö
2
1
‚àí1
0
0
1
‚àí1
‚àö
2
3.5 3D Vectors
A 3D vector simply requires an extra component to represent its z-component z:
r =

x
y
z
T
and its length is given by
|r| =

2x + 2y + 2z.
3.6 Vector Manipulation
Vectors are very different to scalars, and rules have been developed to control how
the two mathematical entities interact with one another. For instance, we need to
consider vector addition, subtraction and multiplication, and how a vector is modi-
Ô¨Åed by a scalar. Let‚Äôs begin with multiplying a vector by a scalar.

20
3
Vectors
3.6.1 Multiplying a Vector by a Scalar
Given a vector n, 2n means that the vectors components are doubled. For example,
given
n = [3
4
5]T
then
2n = [6
8
10]T.
Similarly, dividing n by 2, its components are halved. Note that the vector‚Äôs direction
remains unchanged ‚Äì only its magnitude changes. However, the vector‚Äôs direction is
reversed if the scalar is negative:
Œª = ‚àí2
then
Œªn = [‚àí6
‚àí8
‚àí10]T.
In general, given
n =
‚é°
‚é£
n1
n2
n3
‚é§
‚é¶
then
¬± Œªn =
‚é°
‚é£
¬±Œªn1
¬±Œªn2
¬±Œªn3
‚é§
‚é¶
where Œª is a scalar.
3.6.2 Vector Addition and Subtraction
Given vectors r and s, r ¬± s is deÔ¨Åned as
r =
‚é°
‚é£
xr
yr
zr
‚é§
‚é¶,
s =
‚é°
‚é£
xs
ys
zs
‚é§
‚é¶
then
r ¬± s =
‚é°
‚é£
xr ¬± xs
yr ¬± ys
zr ¬± zs
‚é§
‚é¶.
Vector addition is commutative:
a + b = b + a
e.g.
‚é°
‚é£
1
2
3
‚é§
‚é¶+
‚é°
‚é£
4
5
6
‚é§
‚é¶=
‚é°
‚é£
4
5
6
‚é§
‚é¶+
‚é°
‚é£
1
2
3
‚é§
‚é¶.
However, like scalar subtraction, vector subtraction is not commutative
a ‚àíb Ã∏= b ‚àía
e.g.
‚é°
‚é£
4
5
6
‚é§
‚é¶‚àí
‚é°
‚é£
1
2
3
‚é§
‚é¶Ã∏=
‚é°
‚é£
1
2
3
‚é§
‚é¶‚àí
‚é°
‚é£
4
5
6
‚é§
‚é¶.
3.7 Position Vectors
Given any point P(x,y,z), a position vector p is created by assuming that P is
the vector‚Äôs head and the origin is its tail. Because the tail coordinates are (0,0,0)
the vector‚Äôs components are x,y,z. Consequently, the vector‚Äôs length |p| equals

3.8
Unit Vectors
21

x2 + y2 + z2. For example, the point P(4,5,6) creates a position vector p relative
to the origin:
p = [4
5
6]T
and
|p| =

42 + 52 + 62 ‚âà20.88.
3.8 Unit Vectors
By deÔ¨Ånition, a unit vector has a length of 1. A simple example is i where
i = [1
0
0]T
and
|i| = 1.
Converting a vector into a unit form is called normalising and is achieved by di-
viding the vector‚Äôs components by its length. To formalise this process consider the
vector r = [x
y
z]T with length |r| =

x2 + y2 + z2. The unit form of r is given
by
ÀÜr = 1
|r|[x
y
z]T.
This process is conÔ¨Årmed by showing that the length of ÀÜr is 1:
|ÀÜr| =
 x
|ÀÜr|
2
+
 y
|ÀÜr|
2
+
 z
|ÀÜr|
2
= 1
|ÀÜr|

x2 + y2 + z2
|ÀÜr| = 1.
To put this into context, consider the conversion of r = [1
2
3]T into a unit form:
|r| =

12 + 22 + 32 =
‚àö
14
ÀÜr =
1
‚àö
14
‚é°
‚é£
1
2
3
‚é§
‚é¶‚âà
‚é°
‚é£
0.267
0.535
0.802
‚é§
‚é¶.
3.9 Cartesian Vectors
We begin by deÔ¨Åning three Cartesian unit vectors i, j, k aligned with the x-, y- and
z-axes respectively:
i =
‚é°
‚é£
1
0
0
‚é§
‚é¶,
j =
‚é°
‚é£
0
1
0
‚é§
‚é¶,
k =
‚é°
‚é£
0
0
1
‚é§
‚é¶.
Any vector aligned with the x-, y- or z-axes can be deÔ¨Åned by a scalar multiple of
the unit vectors i, j and k respectively. For example, a vector 10 units long aligned

22
3
Vectors
with the x-axis is 10i, and a vector 20 units long aligned with the z-axis is 20k. By
employing the rules of vector addition and subtraction we can compose a vector r
by summing three Cartesian unit vector as follows:
r = ai + bj + ck
which is equivalent to writing r as
r =
‚é°
‚é£
a
b
c
‚é§
‚é¶
and means that the length of r is computed as
|r| =

a2 + b2 + c2.
Any pair of Cartesian vectors such as r and s are combined as follows
r = ai + bj + ck
s = di + ej + f k
r ¬± s = (a ¬± d)i + (b ¬± e)j + (c ¬± f )k.
For example:
r = 2i + 3j + 4k
s = 5i + 6j + 7k
r + s = 7i + 9j + 11k.
3.10 Scalar Product
The mathematicians who deÔ¨Åned the structure of vector analysis provided two ways
to multiply vectors together: one gives rise to a scalar result and the other a vector
result. For example, we could multiply two vectors r and s by using the product of
their magnitudes: |r||s|. Although this is a valid operation it ignores the orientation
of the vectors, which is one of their important features. The idea, however, is readily
developed into a useful operation by including the angle between the vectors.
Figure 3.3 shows two vectors r and s that have been drawn, for convenience,
such that their tails touch. Taking s as the reference vector ‚Äì which is an arbitrary
choice ‚Äì we compute the projection of r on s, which takes into account their relative
orientation. The length of r on s is |r|cosŒ≤. We can now multiply the magnitude of
s by the projected length of r: |s||r|cosŒ≤.
This scalar product is written
r ¬∑ s = |r||s|cosŒ≤.
(3.1)
The dot symbol ‚Äò¬∑‚Äô is used to denote a scalar multiplication, which is why the product
is often referred to as the dot product. We now need to discover how to compute it.

3.10
Scalar Product
23
Fig. 3.3 Visualising the
scalar product
To begin, we deÔ¨Åne two Cartesian vectors r and s, and proceed to multiply them
together using the dot product deÔ¨Ånition:
r = ai + bj + ck
s = di + ej + f k
therefore,
r ¬∑ s = (ai + bj + ck) ¬∑ (di + ej + f k)
= ai ¬∑ (di + ej + f k) + bj ¬∑ (di + ej + f k) + ck ¬∑ (di + ej + f k)
= adi ¬∑ i + aei ¬∑ j + af i ¬∑ k + bdj ¬∑ i + bej ¬∑ j + bf j ¬∑ k
+ cdk ¬∑ i + cek ¬∑ j + cf k ¬∑ k.
Before we proceed any further, we can see that we have created various dot product
terms such as i ¬∑ i, i ¬∑ j, i ¬∑ k, etc. These terms can be divided into two groups: those
that reference the same unit vector, and those that reference different unit vectors.
Using the deÔ¨Ånition of the dot product (3.1), terms such as i ¬∑ i, j ¬∑ j and k ¬∑ k = 1,
because the angle between i and i, j and j, or k and k, is 0¬∞, and cos0¬∞ = 1. But
because the other vector combinations are separated by 90¬∞, and cos90¬∞ = 0, all
remaining terms collapse to zero. Bearing in mind that the magnitude of a unit vector
is 1, we can write
r ¬∑ s = |r||s|cosŒ≤ = ad + be + cf.
This result conÔ¨Årms that the dot product is indeed a scalar quantity.
Let‚Äôs use the scalar product to Ô¨Ånd the angle between two vectors r and s:
r = [2
0
4]T
s = [5
6
10]T
|r| =

22 + 02 + 42 ‚âà4.472
|s| =

52 + 62 + 102 ‚âà12.689
|r||s|cosŒ≤ = 2 √ó 5 + 0 √ó 6 + 4 √ó 10 = 50
12.689 √ó 4.472 √ó cosŒ≤ = 50

24
3
Vectors
cosŒ≤ =
50
12.689 √ó 4.472 ‚âà0.8811
Œ≤ = cos‚àí1 0.8811 ‚âà28.22¬∞.
The angle between the two vectors is approximately 28.22¬∞, and Œ≤ is always the
smallest angle associated with the geometry.
3.11 The Vector Product
The second way to multiply vectors is by using the vector product, which is also
called the cross product due to the ‚Äò√ó‚Äô symbol used in its notation. It is based on the
observation that two vectors r and s can be multiplied together to produce a third
vector t:
r √ó s = t
where
|t| = |r||s|sinŒ≤
(3.2)
and Œ≤ is the angle between r and s.
The vector t is normal (90¬∞) to the plane containing the vectors r and s, which
makes it an ideal way of computing surface normals in computer graphics applica-
tions. Once again, let‚Äôs deÔ¨Åne two vectors and proceed to multiply them together
using the ‚Äò√ó‚Äô operator:
r = ai + bj + ck
s = di + ej + f k
r √ó s = (ai + bj + ck) √ó (di + ej + f k)
= ai √ó (di + ej + f k) + bj √ó (di + ej + f k) + ck √ó (di + ej + f k)
= adi √ó i + aei √ó j + af i √ó k + bdj √ó i + bej √ó j + bf j √ó k
+ cdk √ó i + cek √ó j + cf k √ó k.
As we found with the dot product, there are two groups of vector terms: those that
reference the same unit vector, and those that reference different unit vectors.
Using the deÔ¨Ånition for the cross product (3.2), operations such as i √ó i, j √ó j and
k √ó k result in a vector whose magnitude is 0. This is because the angle between the
vectors is 0¬∞, and sin0¬∞ = 0. Consequently these terms vanish and we are left with
r √ó s = aei √ó j + af i √ó k + bdj √ó i + bf j √ó k + cdk √ó i + cek √ó j.
(3.3)
The mathematician Sir William Rowan Hamilton struggled for many years to gener-
alise complex numbers ‚Äì and in so doing created a means of describing 3D rotations.
At the time, he was not using vectors ‚Äì as they had yet to be deÔ¨Åned ‚Äì but the imag-
inary terms i, j and k. Hamilton‚Äôs problem was to resolve the products ij, jk, ki
and their opposites ji, kj and ik.

3.11
The Vector Product
25
One day in 1843, when he was out walking, thinking about this problem, he
thought the impossible: ij = k, but ji = ‚àík, jk = i, but kj = ‚àíi, and ki = j, but
ik = ‚àíj. To his surprise, this worked, but it contradicted the commutative multipli-
cation law of scalars. Although Hamilton had discovered ‚Äú3D complex numbers‚Äù,
to which he gave the name quaternion, they were not popular with everyone. And as
mentioned above, Josiah Gibbs saw that converting the imaginary i, j and k terms
into the unit vectors i, j and k created a non-complex algebra for manipulating vec-
tors, and for over a century we have been using Gibbs‚Äô vector notation.
Let‚Äôs continue with Hamilton‚Äôs rules and reduce the cross product terms of (3.3)
to
r √ó s = aek ‚àíaf j ‚àíbdk + bf i + cdj ‚àícei.
(3.4)
Equation (3.4) can be tidied up to bring like terms together:
r √ó s = (bf ‚àíce)i + (cd ‚àíaf )j + (ae ‚àíbd)k.
(3.5)
Now let‚Äôs repeat the original vector equations to see how (3.5) is computed:
r = ai + bj + ck
s = di + ej + f k
r √ó s = (bf ‚àíce)i + (cd ‚àíaf )j + (ae ‚àíbd)k.
(3.6)
To compute i‚Äôs scalar we consider the scalars associated with the other two unit
vectors, i.e. b, c, e, and f , and cross-multiply and subtract them to form (bf ‚àíce).
To compute j‚Äôs scalar we consider the scalars associated with the other two unit
vectors, i.e. a, c, d, and f , and cross-multiply and subtract them to form (cd ‚àíaf ).
To compute k‚Äôs scalar we consider the scalars associated with the other two unit
vectors, i.e. a, b, d, and e, and cross-multiply and subtract them to form (ae ‚àíbd).
The middle operation seems out of step with the other two, but in fact it pre-
serves a cyclic symmetry often found in mathematics. Nevertheless, some authors
reverse the sign of the j scalar term and cross-multiply and subtract the terms to
produce ‚àí(af ‚àícd) which maintains a visual pattern for remembering the cross-
multiplication. Equation (3.6) now becomes
r √ó s = (bf ‚àíce)i ‚àí(af ‚àícd)j + (ae ‚àíbd)k.
(3.7)
Although we have not yet covered determinants, their notation allows us to write
(3.7) as
r √ó s =

b
c
e
f
i ‚àí

a
c
d
f
j +

a
b
d
e
k.
A 2 √ó 2 determinant is the difference between the product of the diagonal terms.
Therefore, to derive the cross product of two vectors we Ô¨Årst write the vectors
in the correct sequence. Remembering that r √ó s does not equal s √ó r. Second, we
compute the three scalar terms and form the resultant vector, which is perpendicular
to the plane containing the original vectors.
Let‚Äôs illustrate the vector product with two examples. First, we will conÔ¨Årm that
the vector product works with the unit vectors i, j and k. We start with

26
3
Vectors
Fig. 3.4 The vector t is
normal to the vectors r and s
r = 1i + 0j + 0k
s = 0i + 1j + 0k
and then compute (3.7)
r √ó s = (0 √ó 0 ‚àí0 √ó 1)i ‚àí(1 √ó 0 ‚àí0 √ó 0)j + (1 √ó 1 ‚àí0 √ó 0)k.
The i scalar and j scalar terms are both zero, but the k scalar term is 1, which makes
i √ó j = k.
Now let‚Äôs show what happens when we reverse the vectors:
s √ó r = (1 √ó 0 ‚àí0 √ó 0)i ‚àí(1 √ó 0 ‚àí0 √ó 0)j + (0 √ó 0 ‚àí1 √ó 1)k.
The i scalar and j scalar terms are both zero, but the k scalar term is ‚àí1, which
makes j √ó i = ‚àík. So we see that the vector product is antisymmetric, i.e. there is a
sign reversal when the vectors are reversed. Similarly, it can be shown that
j √ó k = i
k √ó i = j
k √ó j = ‚àíi
i √ó k = ‚àíj.
Now let‚Äôs consider two vectors r and s and compute the normal vector t. The vec-
tors are chosen so that we can anticipate approximately the answer. For the sake of
clarity, the vector equations include the scalar multipliers 0 and 1. Normally, these
would be omitted. Figure 3.4 shows the vectors r and s and the normal vector t, and
Table 3.2 contains the coordinates of the vertices forming the two vectors.
r =
‚é°
‚é£
x3 ‚àíx2
y3 ‚àíy2
z3 ‚àíz2
‚é§
‚é¶,
s =
‚é°
‚é£
x1 ‚àíx2
y1 ‚àíy2
z1 ‚àíz2
‚é§
‚é¶
then
P1 = (0,0,1),
P2 = (1,0,0),
P3 = (0,1,0)
r = ‚àí1i + 1j + 0k

3.12
The Right-Hand Rule
27
Table 3.2 Coordinates of the
vertices used in Fig. 3.4
Vertex
x
y
z
P1
0
0
1
P2
1
0
0
P3
0
1
0
s = ‚àí1i + 0j + 1k
r √ó s = (1 √ó 1 ‚àí0 √ó 0)i ‚àí(‚àí1 √ó 1 ‚àí(‚àí1) √ó 0)j + (‚àí1 √ó 0 ‚àí(‚àí1) √ó 1)k
t = i + j + k.
This conÔ¨Årms what we expected from Fig. 3.4. Now let‚Äôs reverse the vectors to
illustrate the importance of vector sequence:
s √ó r = (0 √ó 0 ‚àí1 √ó 1)i ‚àí(‚àí1 √ó 0 ‚àí(‚àí1) √ó 1)j + (‚àí1 √ó 1 ‚àí(‚àí1) √ó 0)k
t = ‚àíi ‚àíj ‚àík
which is in the opposite direction to r √ó s and conÔ¨Årms that the vector product is
non-commutative.
3.12 The Right-Hand Rule
When we cover multivectors we will see that lines, planes and volumes are all ori-
ented and can be described mathematically. In particular, 3D space is described as
being left- or right-handed, and in this book we choose to work with a right-handed
space. Consequently, the right-hand rule is an aide m√©moire for working out the
orientation of the cross product vector. Given the operation r √ó s, if the right-hand
thumb is aligned with r, the Ô¨Årst Ô¨Ånger with s, and the middle Ô¨Ånger points in the
direction of t.
3.13 Deriving a Unit Normal Vector
Figure 3.5 shows a triangle with vertices deÔ¨Åned in an anti-clockwise sequence from
its visible side. This is the side from which we want the surface normal to point.
Using the following information we will compute the surface normal using the cross
product and then convert it to a unit normal vector.
Create vector r between P1 and P3, and vector s between P2 and P3:
r = ‚àí1i + 1j + 0k
s = ‚àí1i + 0j + 2k
r √ó s = (1 √ó 2 ‚àí0 √ó 0)i ‚àí(‚àí1 √ó 2 ‚àí0 √ó ‚àí1)j + (‚àí1 √ó 0 ‚àí1 √ó ‚àí1)k
t = 2i + 2j + k

28
3
Vectors
Fig. 3.5 The normal vector t
is derived from the cross
product r √ó s
|t| =

22 + 22 + 12 = 3
ÀÜtu = 2
3i + 2
3j + 1
3k.
3.14 Interpolating Vectors
In computer animation we need to vary quantities such as height, width, depth, light
intensity, radius, etc., such that they change over a sequence of animation frames.
The change may be linear or non-linear, and a variety of techniques exist for chang-
ing one numeric value into another. This process is called interpolating.
To interpolate between two values v1 and v2 we often use the linear interpolant:
v = (1 ‚àít)v1 + tv2
where the parameter t varies between 0 and 1. For example, given v1 = 2 and v2 =
10 we can compute a half-way point by making t = 0.5:
v = 0.5 √ó 2 + 0.5 √ó 10 = 6
where t is linked to the animation frame number.
However, this technique cannot be used for changing quantities such as a light
source direction, dust-cloud particle velocity, or the direction and intensity of a
Ô¨Çame. This is because these quantities possess both magnitude and direction ‚Äì they
are vector quantities.
For example, if we interpolated the x- and y-components of the vectors [2
3]T
and [4
7]T, the in-between vectors would carry the change of orientation but ignore
the change in magnitude. To preserve both, we must design a spherical interpolant
that is sensitive to a vector‚Äôs length and orientation.
Figure 3.6 shows two unit vectors v1 and v2 separated by an angle Œ∏. The inter-
polated vector v can be deÔ¨Åned as a portion of v1 and a portion of v2:
v = av1 + bv2.
Let‚Äôs deÔ¨Åne the values of a and b such that they are a function of the separating
angle Œ∏. Vector v is tŒ∏ from v1 and (1 ‚àít)Œ∏ from v2, and it is evident from Fig. 3.6
that using the sine rule
a
sin(1 ‚àít)Œ∏ =
b
sintŒ∏ .
(3.8)

3.14
Interpolating Vectors
29
Fig. 3.6 Vector v is derived
from a part of v1 and b part
of v2
Furthermore,
m = a costŒ∏
n = b cos(1 ‚àít)Œ∏
where
m + n = 1.
(3.9)
From (3.8)
b =
a sintŒ∏
sin(1 ‚àít)Œ∏
and from (3.9) we get
a costŒ∏ + a sintŒ∏ cos(1 ‚àít)Œ∏
sin(1 ‚àít)Œ∏
= 1.
Solving for a we Ô¨Ånd that
a = sin(1 ‚àít)Œ∏
sinŒ∏
b = sintŒ∏
sinŒ∏ .
Therefore, the Ô¨Ånal spherical interpolant is
v = sin(1 ‚àít)Œ∏
sinŒ∏
v1 + sintŒ∏
sinŒ∏ v2.
(3.10)
To see how this operates, let‚Äôs consider a simple exercise of interpolating be-
tween two unit vectors [1
0]T and [‚àí1/
‚àö
2
1/
‚àö
2]T. The angle Œ∏ between the
vectors is 135¬∞. Equation (3.10) is used to interpolate individually the x- and the
y-components individually:
vx = sin(1 ‚àít)135¬∞
sin135¬∞
√ó (1) + sint135¬∞
sin135¬∞ √ó

‚àí1
‚àö
2

vy = sin(1 ‚àít)135¬∞
sin135¬∞
√ó (0) + sint135¬∞
sin135¬∞ √ó
 1
‚àö
2

.

30
3
Vectors
Fig. 3.7 Curves of the interpolated angles
Fig. 3.8 A trace of the
interpolated vectors between
[1
0]T and [‚àí1
‚àö
2
1
‚àö
2]T
Figure 3.7 shows the interpolating curves and Fig. 3.8 shows the positions of the
interpolated vectors, and a trace of the interpolated vectors.
Two observations to note about (3.10):
‚Ä¢ First, the angle Œ∏ is the angle between the two vectors, which, if not known, can
be computed using the dot product.
‚Ä¢ Second, the range of Œ∏ is given by 0 < Œ∏ < 180¬∞, for when Œ∏ = 0¬∞,180¬∞ the
denominator collapses to zero. To illustrate this we will repeat (3.10) for Œ∏ =
179¬∞.
The result is shown in Fig. 3.9, which reveals clearly that the interpolant works
normally over this range. One more degree, however, and it fails! Nevertheless, one
could still leave the range equal to 180¬∞ and test for the conditions t = 0 then v = v1
and when t = 180¬∞ then v = v2.
So far, we have only considered unit vectors. Now let‚Äôs see how the interpolant
responds to vectors of different magnitudes. As a test, we can input the following
vectors to (3.10):
v1 =
2
0

and
v2 =
0
1

.
The separating angle Œ∏ = 90¬∞, and the result is shown in Fig. 3.10. Note how the
initial length of v1 reduces from 2 to 1 over 90¬∞. It is left to the reader to examine
other combinations of vectors.

3.15
Summary
31
Fig. 3.9 Interpolating between two unit vectors 179¬∞ apart
Fig. 3.10 Interpolating
between the vectors [2
0]T
and [0
1]T
3.15 Summary
This chapter has covered the important features of vectors relevant to rotations. Ba-
sically, we need to know how to create a position vector, normalise a vector, and
multiply two vectors using the scalar and vector product. In Chap. 6, we explore the
ideas of multivectors, which build upon the contents of this chapter.
3.15.1 Summary of Vector Operations
Vector
v = [x
y
z]T
v = xi + yj + zk.
Addition and subtraction
v1 = x1i + y1j + z1k
v2 = x2i + y2j + z2k
v1 ¬± v2 = (x1 ¬± x2)i + (y1 ¬± y2)j + (z1 ¬± z2)k.

32
3
Vectors
Scalar product
Œªv = Œªxi + Œªyj + Œªzk.
Magnitude
|v| =

x2 + y2 + z2.
Unit vector
|v| = 1.
Scalar product
v1 ¬∑ v2 = |v1||v2|cosŒ≤
v1 ¬∑ v2 = x1x2 + y1y2 + z1z2.
Vector product
v1 √ó v2 = t
|t| = |v1||v2|sinŒ≤
v1 √ó v2 = (y1z2 ‚àíz1y2)i + (z1x2 ‚àíx1z2)j + (x1y2 ‚àíy1x2)k.
Interpolating vectors
v = sin(1 ‚àít)Œ∏
sinŒ∏
v1 + sintŒ∏
sinŒ∏ v2
[0 < t < 1].

Chapter 4
Matrices
4.1 Introduction
Matrix notation was investigated by the British mathematician, Arthur Cayley
(1821‚Äì1895), in 1858, Ô¨Åfteen years after the invention of quaternions. Cayley and
others had realised that it was possible to express a collection of equations by sepa-
rating constants and variables. For example, the following simultaneous equations
2x + 3y = 18
(4.1)
4x ‚àíy = 8
(4.2)
have a solution x = 3 and y = 4, which can be discovered by eliminating one vari-
able, such as x, and computing y, which in turn can be substituted into one of the
equations to reveal the value of x. However, matrix notation allows us to express the
equations as follows
2
3
4
‚àí1
x
y

=
18
8

(4.3)
where the array of four numbers is a matrix and the other two columns are vectors.
When multiplying the matrix and the vector [x
y]T together we must multiply the
respective terms of the top row of the matrix with the column vector to equal 18 and
create (4.1). Similarly, we must multiply the respective terms of the bottom row of
the matrix with the column vector to equal 8 and create (4.2).
Matrix notation also allows us to express these equations as
Av = c
(4.4)
where
A =
2
3
4
‚àí1

,
v =
x
y

,
c =
18
8

.
There happens to be a special matrix such that when it multiplies a vector it
results in no change ‚Äì this matrix is called an identity matrix and has the form
I =
1
0
0
1

.
J. Vince, Rotation Transforms for Computer Graphics,
DOI 10.1007/978-0-85729-154-7_4, ¬© Springer-Verlag London Limited 2011
33

34
4
Matrices
It is also possible to compute another matrix A‚àí1, called the inverse of A, such that
A‚àí1A = I. Therefore, if we assume that A is still
A =
2
3
4
‚àí1

and is invertible, we can compute A‚àí1 and use it to multiply both sides of (4.4), we
have
A‚àí1Av = A‚àí1c
Iv = A‚àí1c
v = A‚àí1c
which reveals the components of the vector v, and the solution to the equations.
Without showing its derivation, the inverse of A is
A‚àí1 = 1
14
1
3
4
‚àí2

(4.5)
and when we multiply c by A‚àí1 we get
A‚àí1c = 1
14
1
3
4
‚àí2
18
8

=
3
4

which is the desired result.
Matrices can also be regarded as rectangular arrays of numbers, which may pos-
sess various properties. For instance, we can imagine a matrix where all the elements
have the same value. We could also create a matrix where all the elements are zero,
apart from the diagonal elements. There are many more such conÔ¨Ågurations, which
are explored in this chapter.
If this is the Ô¨Årst time you have met matrices, then the author‚Äôs book Mathematics
for Computer Graphics [4] will provide you with the necessary background. So for
the moment, let‚Äôs continue and discover more about matrices.
4.2 Matrices
Let‚Äôs begin by deÔ¨Åning a matrix as a rectangular array of numbers with row rows and
col columns, where any element in the matrix is addressed by arow,col. The matrix
of numbers can be represented in shorthand as
A = [arow,col]
where row and col are natural numbers. However, matrices representing 2D and 3D
rotations are all square, where the number of rows equals the number of columns.
The following are all examples of square matrices:
1
2
3
4

,
‚é°
‚é£
1
2
3
4
5
6
7
8
9
‚é§
‚é¶,
‚é°
‚é¢‚é¢‚é£
1
2
3
4
5
6
7
8
9
8
7
6
5
4
3
2
‚é§
‚é•‚é•‚é¶.

4.3
The Transpose of a Matrix
35
We will discover in later chapters that a 4 √ó 4 matrix is the largest matrix we will
require to represent a 3D rotation. Now let‚Äôs look at some of the ways we manipulate
matrices.
4.3 The Transpose of a Matrix
One useful matrix operation is the transpose where every element arow,col is ex-
changed with its transpose acol,row, and is written
AT = [arow,col]T = [acol,row].
For example, here is a matrix A and its transpose AT
A =
1
2
3
4

,
AT =
1
3
2
4

.
It is possible that the elements of A are such that A = AT. Such a matrix is called a
symmetric matrix, and we will examine this later.
4.4 The Identity Matrix
As mentioned above, the identity matrix I is a matrix such that
IA = AI = A.
The three identity matrices we will encounter in later chapters are
1
0
0
1

,
‚é°
‚é£
1
0
0
0
1
0
0
0
1
‚é§
‚é¶,
‚é°
‚é¢‚é¢‚é£
1
0
0
0
0
1
0
0
0
0
1
0
0
0
0
1
‚é§
‚é•‚é•‚é¶
and it should be obvious that IT = I.
4.5 Adding and Subtracting Matrices
It is possible to add and subtract matrices so long as they have the same number of
rows and columns. For example, in matrix notation
A ¬± B = [arow,col ¬± brow,col].
For example:
A =
5
6
7
8

,
B =
1
2
3
4

then
A + B =
 6
8
10
12

,
A ‚àíB =
4
4
4
4

.

36
4
Matrices
4.6 Multiplying a Matrix by a Scalar
Multiplying a matrix by a scalar Œª is the same as multiplying an equation by the
same scalar. Therefore,
¬±ŒªA = [¬±Œªarow,col].
For example, if Œª = 2
A =
1
2
3
4

,
ŒªA =
2
4
6
8

.
4.7 Product of Two Matrices
As already mentioned, every element in a matrix has a unique address speciÔ¨Åed
by its row and column: arow,col where a comma separates the values of row and
col. However, these commas can make the notation very fussy and are not always
employed. For example, a11 represents the element for row = 1 and col = 1, and
a23 represents the element for row = 2 and col = 3. In this book, we never need
to manipulate matrices with more that 4 rows or columns, therefore, there is no
confusion.
Matrices have their origins in algebra, therefore matrix algebra must agree with
its algebraic counterpart. Bearing this in mind, let‚Äôs investigate the product of two
matrices:
A =
a11
a12
a21
a22

,
B =
b11
b12
b21
b22

then their product is given by
AB =
a11b11 + a12b21
a11b12 + a12b22
a21b11 + a22b21
a21b12 + a22b22

.
For example, given
A =
5
6
7
8

,
B =
1
2
3
4

then
AB =
5 √ó 1 + 6 √ó 3
5 √ó 2 + 6 √ó 4
7 √ó 1 + 8 √ó 3
7 √ó 2 + 8 √ó 4

=
5 + 18
10 + 24
7 + 24
14 + 32

=
23
34
31
46

.

4.8
The Inverse Matrix
37
Now let‚Äôs compute BA
BA =
1 √ó 5 + 2 √ó 7
1 √ó 6 + 2 √ó 8
3 √ó 5 + 4 √ó 7
3 √ó 6 + 4 √ó 8

=
19
22
43
50

which conÔ¨Årms that, in general, matrix multiplication is non-commutative.
It can also be shown that
[AB]T = BTAT
and
[A + B]T = AT + BT.
4.8 The Inverse Matrix
Most mathematics software systems include a matrix inversion package, but for
completeness, let‚Äôs demonstrate how we arrived at the inverse matrix A‚àí1 (4.5):
A‚àí1 = 1
14
1
3
4
‚àí2

.
Initially, we started with the simultaneous equations
2x + 3y = 18
(4.6)
4x ‚àíy = 8.
(4.7)
Solving these algebraically we multiply (4.7) by 3 and add it to (4.6) to eliminate y:
2x + 3y = 18
12x ‚àí3y = 24
14x = 42
x = 3.
Substituting x = 3 in (4.6) gives
6 + 3y = 18
which makes y = 4.
4.8.1 Calculation of Inverse
Now let‚Äôs solve (4.6) and (4.7) using matrix notation. We begin with
Av = c

38
4
Matrices
where
A =
2
3
4
‚àí1

,
v =
x
y

,
c =
18
8

.
Next we introduce an identity matrix, which does not disturb anything:
Av = Ic
(4.8)
2
3
4
‚àí1
x
y

=
1
0
0
1
18
8

.
(4.9)
The objective is to multiply both sides of (4.8) by A‚àí1 and turn the LHS matrix A
into an identity matrix, and at the same time turn the RHS matrix I into A‚àí1. But
as we don‚Äôt know A‚àí1 we will have to do this in a number of steps. Like the above
simultaneous equations, we can scale, add, subtract or divide matrix rows, so long
as we manipulate the entire matrix equation.
We start by subtracting 2 √ó row(1) from row(2) in (4.9):
2
3
0
‚àí7
x
y

=

1
0
‚àí2
1
18
8

.
(4.10)
Next, multiply row(1) √ó 7
3 in (4.10):
 14
3
7
0
‚àí7
x
y

=

7
3
0
‚àí2
1
18
8

.
(4.11)
Next, add row(2) to row(1) in (4.11):
 14
3
0
0
‚àí7
x
y

=

1
3
1
‚àí2
1
18
8

.
(4.12)
Next, multiply row(1) √ó 3
14 in (4.12):
1
0
0
‚àí7
x
y

=

1
14
3
14
‚àí2
1
18
8

.
(4.13)
Finally, divide row(2) by ‚àí7 in (4.13):
1
0
0
1
x
y

=

 1
14
3
14
2
7
‚àí1
7
18
8

.
(4.14)
As the LHS matrix is an identity matrix, the RHS matrix in (4.14) must be A‚àí1 and
is tidied up to become
A‚àí1 = 1
14
1
3
4
‚àí2

.
Later on, we will explore another technique that does not involve any overt algebraic
skills.

4.9
Determinant of a Matrix
39
4.9 Determinant of a Matrix
When solving a pair of simultaneous equations such as
ax + by = r
cx + dy = s
the expression ad ‚àíbc arises in the solution. For example, in the simultaneous
equations (4.6) and (4.7) the corresponding expression has a value 2 √ó (‚àí1) ‚àí3 √ó
4 = ‚àí14 whose magnitude appears in the solution of A‚àí1. Because this expression
is so useful, it is identiÔ¨Åed by the name determinant and is written
detA = |A| = ad ‚àíbc
where
A =
a
b
c
d

.
Determinants are formed from square arrays, in that they have the same number
of rows and columns, which permits us to classify them in terms of their order.
Some texts classify a scalar quantity as a Ô¨Årst-order determinant ‚Äì for example a.
A second-order determinant has two rows and columns ‚Äì for example

a
b
c
d
.
When dealing with three simultaneous equations
ax + by + cz = r
dx + ey + f z = s
gx + hy + iz = t
the corresponding matrix is
A =
‚é°
‚é£
a
b
c
d
e
f
g
h
i
‚é§
‚é¶
and the equivalent determinant is
aei + bfg + cdh ‚àíceg ‚àíaf h ‚àíbdi.
4.9.1 Sarrus‚Äôs Rule
The French mathematician, J.P. Sarrus (1789‚Äì1861), noted that a third-order de-
terminant is easily computed by exploiting a pattern which is very obvious if the
determinant‚Äôs columns are extended as follows:

a
b
c
a
b
d
e
f
d
e
g
h
i
g
h

.

40
4
Matrices
aei, bfg and cdh are strings of elements sloping downwards to the right, whereas,
ceg, af h and bdi are strings of elements sloping downwards to the left. For exam-
ple, the determinant
detA =

2
0
4
3
1
0
4
2
2

has a value of
|A| = (2 √ó 1 √ó 2) + (0 √ó 0 √ó 4) + (4 √ó 3 √ó 2)
‚àí(4 √ó 1 √ó 4) ‚àí(2 √ó 0 √ó 2) ‚àí(0 √ó 3 √ó 2)
= 4 + 0 + 24 ‚àí16 ‚àí0 ‚àí0
|A| = 12.
In general
detA = |A| = aei + bfg + cdh ‚àíceg ‚àíaf h ‚àíbdi
(4.15)
and the expansion is known as Sarrus‚Äôs rule.
Equation (4.15) can be rearranged to reveal another pattern:
|A| = a(ei ‚àíf h) + b(fg ‚àídi) + c(dh ‚àíeg)
where the expressions
(ei ‚àíf h),
(fg ‚àídi),
(dh ‚àíeg)
are regarded as minor determinants. Let‚Äôs pause at this juncture and examine |A|‚Äôs
minor determinants:

a
b
c
d
e
f
g
h
i

=

a
e
f
h
i

‚àí

b
d
f
g
i

+

c
d
e
g
h

.
(4.16)
Equation (4.16) shows how a third-order determinant can be represented as the sum
of three minor determinants:

a
b
c
d
e
f
g
h
i

= a

e
f
h
i
 ‚àíb

d
f
g
i
 + c

d
e
g
h
.
Note that the middle minor determinant is preÔ¨Åxed with a negative sign. This ensures
that the equation‚Äôs value is the same as (4.15). The reason for this is that mathematics
is not interested in forming convenient visual patterns on the page ‚Äì its patterns are
created from cycles of elements or subscripts. Consequently, if we prefer a visual
pattern as an aide-m√©moire, we must make the necessary algebraic adjustments to
maintain the equation‚Äôs integrity. For example, by repeating the Ô¨Årst column of |A|
as follows

a
b
c
a
d
e
f
d
g
h
i
g


4.9
Determinant of a Matrix
41
the pattern (fg ‚àídi) is now very obvious. However, it is widely agreed that it is
best to ignore this and embrace a simple visual pattern. The price to be paid for this
is a negative sign as follows:
|A| = a(ei ‚àíf h) ‚àíb(di ‚àífg) + c(dh ‚àíeg).
4.9.2 The Laplace Expansion
The French mathematician, Pierre Simon de Laplace (1749‚Äì1827), developed a
method of expanding a determinant in terms of its minors, which, with the associ-
ated change of sign, is called a cofactor. The cofactor crow,col of an element arow,col
is the minor that remains after removing from the original determinant the row row
and the col column.
For example, in (4.17) the minor of a11 is identiÔ¨Åed by removing the Ô¨Årst row
and the Ô¨Årst column; the minor of a12 is identiÔ¨Åed by removing the Ô¨Årst row and the
second column; and the minor of a13 is identiÔ¨Åed by removing the Ô¨Årst row and the
third column:
detA =

a11
a12
a13
a21
a22
a23
a31
a32
a33

.
(4.17)
The three minor determinants for a11, a12 and a13 are respectively:
A11 =

a22
a23
a32
a33
,
A12 =

a21
a23
a31
a33
,
A13 =

a21
a22
a31
a32

whereas, the three cofactors are
c11 = +a11A11
c12 = ‚àía12A12
c13 = +a13A13.
In general, the minor of arow,col is denoted Arow,col.
Laplace proposed the following formulae for selecting the cofactor sign:
(‚àí1)row+col
which generates the pattern

+
‚àí
+
...
‚àí
+
‚àí
...
+
‚àí
+
...
...
...
...
...

.
Although we have chosen the Ô¨Årst row to expand the above determinants, any row,
or column may be used.

42
4
Matrices
The above Laplace expansion can be used for any order determinant, and for
the purposes of this book, the highest order we will encounter is a fourth-order
determinant. So let‚Äôs expand the following determinant
detA =

0
4
‚àí1
0
1
0
1
4
0
6
3
3
3
5
2
2

.
The Ô¨Årst column and the Ô¨Årst row both contain two zeros, which helps our expansion,
so let‚Äôs expand |A| using the Ô¨Årst row. The two relevant minor determinants are
A12 =

1
1
4
0
3
3
3
2
2

,
A13 =

1
0
4
0
6
3
3
5
2

.
Next, we expand A12 and A13 with their cofactors as follows
c12 = ‚àí4

1(‚àí1)1+1

3
3
2
2
 + 1(‚àí1)1+2

0
3
3
2
 + 4(‚àí1)1+3

0
3
3
2


= ‚àí4[0 + 9 ‚àí36]
= 108
c13 = ‚àí1

1(‚àí1)1+1

6
3
5
2
 + 4(‚àí1)1+3

0
6
3
5


= ‚àí1[‚àí3 ‚àí72]
= 75.
Therefore,
detA = c12 + c13 = 108 + 75 = 183.
4.10 Cofactors and Inverse of a Matrix
Although the idea of cofactors has been described in the context of determinants,
they can also be applied to matrices. For example, let‚Äôs start with the following
matrix and its cofactor matrix
A =
‚é°
‚é£
0
1
3
2
1
4
4
2
6
‚é§
‚é¶
cofactor matrix of A =
‚é°
‚é£
A11
A12
A13
A21
A22
A23
A31
A32
A33
‚é§
‚é¶

4.10
Cofactors and Inverse of a Matrix
43
where
A11 = +

a22
a23
a32
a33
 = +

1
4
2
6
 = ‚àí2
A12 = ‚àí

a21
a23
a31
a33
 = ‚àí

2
4
4
6
 = 4
A13 = +

a21
a23
a31
a33
 = +

2
1
4
2
 = 0
A21 = ‚àí

a22
a23
a32
a33
 = ‚àí

1
3
2
6
 = 0
A22 = +

a11
a13
a31
a33
 = +

0
3
4
6
 = ‚àí12
A23 = ‚àí

a11
a12
a31
a32
 = ‚àí

0
1
4
2
 = 4
A31 = +

a12
a13
a22
a23
 = +

1
3
1
4
 = 1
A32 = ‚àí

a11
a13
a21
a23
 = ‚àí

0
3
2
4
 = 6
A33 = +

a11
a12
a21
a22
 = +

0
1
2
1
 = ‚àí2
therefore, the cofactor matrix of A is
cofactor matrix of A =
‚é°
‚é£
‚àí2
4
0
0
‚àí12
4
1
6
‚àí2
‚é§
‚é¶.
It can be shown that the product of a matrix with the transpose of its cofactor matrix
has the following form:
A(cofactor matrix of A)T =
‚é°
‚é¢‚é¢‚é£
detA
0
...
0
0
detA
...
0
...
...
...
...
0
0
0
detA
‚é§
‚é•‚é•‚é¶
and multiplying throughout by 1/detA we have
(1/detA)A(cofactor matrix of A)T = I
which implies that
A‚àí1 = (cofactor matrix of A)T
detA
.
Naturally, this assumes that the inverse actually exists, and it will if detA Ã∏= 0.

44
4
Matrices
Let‚Äôs Ô¨Ånd the inverse of the above matrix
A =
‚é°
‚é£
0
1
3
2
1
4
4
2
6
‚é§
‚é¶
(cofactor matrix of A) =
‚é°
‚é£
‚àí2
4
0
0
‚àí12
4
1
6
‚àí2
‚é§
‚é¶
(cofactor matrix of A)T =
‚é°
‚é£
‚àí2
0
1
4
‚àí12
6
0
4
‚àí2
‚é§
‚é¶
detA = 1 √ó 4 √ó 4 + 3 √ó 2 √ó 2 ‚àí1 √ó 2 √ó 6 ‚àí3 √ó 1 √ó 4 = 4
A‚àí1 = 1
4
‚é°
‚é£
‚àí2
0
1
4
‚àí12
6
0
4
‚àí2
‚é§
‚é¶.
Let‚Äôs check this result by multiplying A by A‚àí1 which must equal I:
AA‚àí1 =
‚é°
‚é£
0
1
3
2
1
4
4
2
6
‚é§
‚é¶1
4
‚é°
‚é£
‚àí2
0
1
4
‚àí12
6
0
4
‚àí2
‚é§
‚é¶
= 1
4
‚é°
‚é£
4
0
0
0
4
0
0
0
4
‚é§
‚é¶
=
‚é°
‚é£
1
0
0
0
1
0
0
0
1
‚é§
‚é¶.
Finally, let‚Äôs compute the inverse matrix for (4.6) and (4.7) using cofactors:
A =
2
3
4
‚àí1

(cofactor matrix of A) =
‚àí1
‚àí4
‚àí3
2

(cofactor matrix of A)T =
‚àí1
‚àí3
‚àí4
2

detA = 2 √ó (‚àí1) ‚àí3 √ó 4 = ‚àí14
A‚àí1 = 1
14
1
3
4
‚àí2

which conÔ¨Årms the original result.
In general, the inverse of a 2 √ó 2 matrix is given by
A =
a11
a12
a21
a22


4.11
Orthogonal Matrix
45
A‚àí1 =
1
a11a22 ‚àía12a21

a22
‚àía12
‚àía21
a11

which, for the above matrix is
A‚àí1 = ‚àí1
14
‚àí1
‚àí3
‚àí4
2

= 1
14
1
3
4
‚àí2

.
4.11 Orthogonal Matrix
Although many matrices have to be inverted using the transpose of their cofactor
matrix, an orthogonal matrix implies that its transpose is also its inverse. For exam-
ple:
A =
cosŒ≤
‚àísinŒ≤
sinŒ≤
cosŒ≤

is orthogonal because
AT =

cosŒ≤
sinŒ≤
‚àísinŒ≤
cosŒ≤

and
AAT =
cosŒ≤
‚àísinŒ≤
sinŒ≤
cosŒ≤

cosŒ≤
sinŒ≤
‚àísinŒ≤
cosŒ≤

=
1
0
0
1

.
Orthogonal matrices play an important role in rotations because they leave the origin
Ô¨Åxed and preserve all angles and distances. Consequently, an object‚Äôs geometric
integrity is maintained after a rotation, which is why an orthogonal transform is
known as a rigid motion transform.
A rotation transform also preserves orientations, which means that left-handed
and right-handed axial systems (frames) remain unaltered after a rotation. Such
changes in orientation will occur with a reÔ¨Çection transform.
4.12 Diagonal Matrix
A diagonal matrix is a square matrix whose elements are zero, apart from its diag-
onal:
A =
‚é°
‚é¢‚é¢‚é¢‚é£
a11
0
...
0
0
a22
...
0
...
...
...
...
0
0
...
ann
‚é§
‚é•‚é•‚é•‚é¶.
The determinant of a diagonal matrix must be
detA = a11 √ó a22 √ó ¬∑¬∑¬∑ √ó ann.

46
4
Matrices
Here is a diagonal matrix with its determinant
A =
‚é°
‚é£
2
0
0
0
3
0
0
0
4
‚é§
‚é¶
|A| = 2 √ó 3 √ó 4 = 24.
The identity matrix I is a diagonal matrix with a determinant of 1.
4.13 Trace
The trace of a square matrix A is the sum of its diagonal elements and written as
Tr(A). For example:
A =
‚é°
‚é¢‚é¢‚é£
1
2
3
4
2
3
4
5
3
4
5
6
4
5
6
7
‚é§
‚é•‚é•‚é¶
Tr(A) = 1 + 3 + 5 + 7 = 16.
In Chap. 9 we use the trace of a square matrix to reveal the angle of rotation
associated with a rotation matrix. And as we will be using the product of two or
more rotation transforms we require to establish that
Tr(AB) = Tr(BA)
to reassure ourselves that the trace operation is not sensitive to transform order, and
is readily proved as follows.
Given two square matrices A and B:
A =
‚é°
‚é¢‚é¢‚é£
a11
¬∑¬∑¬∑
¬∑¬∑¬∑
a1n
¬∑¬∑¬∑
a22
¬∑¬∑¬∑
a2n
¬∑¬∑¬∑
¬∑¬∑¬∑
¬∑¬∑¬∑
¬∑¬∑¬∑
an1
¬∑¬∑¬∑
¬∑¬∑¬∑
ann
‚é§
‚é•‚é•‚é¶,
B =
‚é°
‚é¢‚é¢‚é£
b11
¬∑¬∑¬∑
¬∑¬∑¬∑
b1n
¬∑¬∑¬∑
b22
¬∑¬∑¬∑
b2n
¬∑¬∑¬∑
¬∑¬∑¬∑
¬∑¬∑¬∑
¬∑¬∑¬∑
bn1
¬∑¬∑¬∑
¬∑¬∑¬∑
bnn
‚é§
‚é•‚é•‚é¶
then,
AB =
‚é°
‚é¢‚é¢‚é£
a11
¬∑¬∑¬∑
¬∑¬∑¬∑
a1n
¬∑¬∑¬∑
a22
¬∑¬∑¬∑
a2n
¬∑¬∑¬∑
¬∑¬∑¬∑
¬∑¬∑¬∑
¬∑¬∑¬∑
an1
¬∑¬∑¬∑
¬∑¬∑¬∑
ann
‚é§
‚é•‚é•‚é¶
‚é°
‚é¢‚é¢‚é£
b11
¬∑¬∑¬∑
¬∑¬∑¬∑
b1n
¬∑¬∑¬∑
b22
¬∑¬∑¬∑
b2n
¬∑¬∑¬∑
¬∑¬∑¬∑
¬∑¬∑¬∑
¬∑¬∑¬∑
bn1
¬∑¬∑¬∑
¬∑¬∑¬∑
bnn
‚é§
‚é•‚é•‚é¶
AB =
‚é°
‚é¢‚é¢‚é£
a11b11
¬∑¬∑¬∑
¬∑¬∑¬∑
a1n
¬∑¬∑¬∑
a22b22
¬∑¬∑¬∑
a2n
¬∑¬∑¬∑
¬∑¬∑¬∑
¬∑¬∑¬∑
¬∑¬∑¬∑
an1
¬∑¬∑¬∑
¬∑¬∑¬∑
annbnn
‚é§
‚é•‚é•‚é¶
and Tr(AB) = a11b11 + a22b22 + ¬∑¬∑¬∑ + annbnn.

4.14
Symmetric Matrix
47
Hopefully, it is obvious that reversing the matrix sequence to BA only reverses
the a and b scalar elements on the diagonal, and therefore does not affect the trace
operation.
4.14 Symmetric Matrix
It is worth exploring two types of matrices called symmetric and antisymmetric ma-
trices, as we refer to them in later chapters. A symmetric matrix is a matrix which
equals its own transpose:
A = AT.
For example, the following matrix is symmetric:
A =
‚é°
‚é£
1
3
4
3
2
4
4
4
3
‚é§
‚é¶.
The symmetric part of any square matrix can be isolated as follows. Given a matrix
A and its transpose AT
A =
‚é°
‚é¢‚é¢‚é¢‚é£
a11
a12
...
a1n
a21
a22
...
a2n
...
...
...
...
an1
an2
...
ann
‚é§
‚é•‚é•‚é•‚é¶,
AT =
‚é°
‚é¢‚é¢‚é¢‚é£
a11
a21
...
an1
a12
a22
...
an2
...
...
...
...
a1n
a2n
...
ann
‚é§
‚é•‚é•‚é•‚é¶
their sum is
A + AT =
‚é°
‚é¢‚é¢‚é¢‚é£
2a11
a12 + a21
...
a1n + an1
a12 + a21
2a22
...
a2n + an2
...
...
...
...
a1n + an1
a2n + an2
...
2ann
‚é§
‚é•‚é•‚é•‚é¶.
By inspection, A + AT is symmetric, and if we divide throughout by 2 we have
S = 1
2

A + AT
which is deÔ¨Åned as the symmetric part of A. For example, given
A =
‚é°
‚é£
a11
a12
a13
a21
a22
a23
a31
a32
a33
‚é§
‚é¶,
AT =
‚é°
‚é£
a11
a21
a31
a12
a22
a32
a13
a23
a33
‚é§
‚é¶
then
S = 1
2

A + AT
=
‚é°
‚é£
a11
(a12 + a21)/2
(a13 + a31)/2
(a12 + a21)/2
a22
a23 + a32
(a13 + a31)/2
(a23 + a32)/2
a33
‚é§
‚é¶

48
4
Matrices
=
‚é°
‚é£
a11
s3/2
s2/2
s3/2
a22
s1/2
s2/2
s1/2
a33
‚é§
‚é¶
where
s1 = a23 + a32
s2 = a13 + a31
s3 = a12 + a21.
Using a real example:
A =
‚é°
‚é£
0
1
4
3
1
4
4
2
6
‚é§
‚é¶,
AT =
‚é°
‚é£
0
3
4
1
1
2
4
4
6
‚é§
‚é¶
S =
‚é°
‚é£
0
2
4
2
1
3
4
3
6
‚é§
‚é¶
which equals its own transpose.
4.15 Antisymmetric Matrix
An antisymmetric matrix is a matrix whose transpose is its own negative:
AT = ‚àíA
and is also known as a skew symmetric matrix.
As the elements of A and AT are related by
arow,col = ‚àíacol,row.
When k = row = col:
ak,k = ‚àíak,k
which implies that the diagonal elements must be zero. For example, this is an anti-
symmetric matrix
‚é°
‚é£
0
6
2
‚àí6
0
‚àí4
‚àí2
4
0
‚é§
‚é¶.
In general, we have
A =
‚é°
‚é¢‚é¢‚é¢‚é£
a11
a12
...
a1n
a21
a22
...
a2n
...
...
...
...
an1
an2
...
ann
‚é§
‚é•‚é•‚é•‚é¶,
AT =
‚é°
‚é¢‚é¢‚é¢‚é£
a11
a21
...
an1
a12
a22
...
an2
...
...
...
...
a1n
a2n
...
ann
‚é§
‚é•‚é•‚é•‚é¶

4.15
Antisymmetric Matrix
49
and their difference is
A ‚àíAT =
‚é°
‚é¢‚é¢‚é¢‚é£
0
a12 ‚àía21
...
a1n ‚àían1
‚àí(a12 ‚àía21)
0
...
a2n ‚àían2
...
...
...
...
‚àí(a1n ‚àían1)
‚àí(a2n ‚àían2)
...
0
‚é§
‚é•‚é•‚é•‚é¶.
It is clear that A ‚àíAT is antisymmetric, and if we divide throughout by 2 we have
Q = 1
2

A ‚àíAT
.
For example:
A =
‚é°
‚é£
a11
a12
a13
a21
a22
a23
a31
a32
a33
‚é§
‚é¶,
AT =
‚é°
‚é£
a11
a21
a31
a12
a22
a32
a13
a23
a33
‚é§
‚é¶
Q =
‚é°
‚é£
0
(a12 ‚àía21)/2
(a13 ‚àía31)/2
(a21 ‚àía12)/2
0
(a23 ‚àía32)/2
(a31 ‚àía13)/2
(a32 ‚àía23)/2
0
‚é§
‚é¶
and if we maintain some symmetry with the subscripts, we have
Q =
‚é°
‚é£
0
(a12 ‚àía21)/2
‚àí(a31 ‚àía13)/2
‚àí(a12 ‚àía21)/2
0
(a23 ‚àía32)/2
(a31 ‚àía13)/2
‚àí(a23 ‚àía32)/2
0
‚é§
‚é¶
=
‚é°
‚é£
0
q3/2
‚àíq2/2
‚àíq3/2
0
q1/2
q2/2
‚àíq1/2
0
‚é§
‚é¶
where
q1 = a23 ‚àía32
q2 = a31 ‚àía13
q3 = a12 ‚àía21.
Using a real example:
A =
‚é°
‚é£
0
1
4
3
1
4
4
2
6
‚é§
‚é¶,
AT =
‚é°
‚é£
0
3
4
1
1
2
4
4
6
‚é§
‚é¶
Q =
‚é°
‚é£
0
‚àí1
0
1
0
1
0
‚àí1
0
‚é§
‚é¶.
Furthermore, we have already computed
S =
‚é°
‚é£
0
2
4
2
1
3
4
3
6
‚é§
‚é¶

50
4
Matrices
and
S + Q =
‚é°
‚é£
0
1
4
3
1
4
4
2
6
‚é§
‚é¶= A.
4.16 Inverting a Pair of Matrices
In later chapters we form the products of two or more matrices, and in some cases
require to Ô¨Ånd their inverse. In anticipation of this requirement, let‚Äôs compute the
inverse of a pair of matrices.
Given two transforms T and R, the product TR and its inverse (TR)‚àí1 must
equal the identity matrix I:
(TR)(TR)‚àí1 = I
and multiplying throughout by T‚àí1 we have
T‚àí1TR(TR)‚àí1 = T‚àí1
R(TR)‚àí1 = T‚àí1.
Multiplying throughout by R‚àí1 we have
R‚àí1R(TR)‚àí1 = R‚àí1T‚àí1
(TR)‚àí1 = R‚àí1T‚àí1.
Therefore, if T and R are invertible, then
(TR)‚àí1 = R‚àí1T‚àí1.
Generalising this result to a triple product such as STR we can reason that
(STR)‚àí1 = R‚àí1T‚àí1S‚àí1.
4.17 Eigenvectors and Eigenvalues
Matrices represent linear transforms that scale, translate, shear, reÔ¨Çect or rotate
points, whilst leaving the origin untouched. For example, the following 2D trans-
form
4
1
1
4
x
y

=
x‚Ä≤
y‚Ä≤

transforms the points on four unit squares as shown in Fig. 4.1 where we see a
pronounced stretching in the Ô¨Årst and third quadrants, and reduced stretching in the
second and fourth quadrants.
It should be clear from Fig. 4.1 that any point (k,k) is transformed to another
point (5k,5k), and that its mirror point (‚àík,‚àík) is transformed to (‚àí5k,‚àí5k).

4.17
Eigenvectors and Eigenvalues
51
Fig. 4.1 Transforming points
on four unit squares
Fig. 4.2 How a transform
reacts to different points
Similarly, any point (‚àík,k) is transformed to another point (‚àí3k,3k), and its mirror
point (k,‚àík) is transformed to (3k,‚àí3k). Thus the transform shows a particular
bias towards points lying on vectors [k
k]T and [‚àík
k]T, where k Ã∏= 0.
These vectors are called eigenvectors and the scaling factor is its eigenvalue.
Figure 4.2 shows a scenario where a transform t moves point R to S, whilst the
same transform moves P ‚Äì which lies on one of t‚Äôs eigenvectors, to Q ‚Äì which also
lies on the same eigenvector.
We can deÔ¨Åne an eigenvector and its eigenvalue as follows. Given a square ma-
trix A, a non-zero vector v is an eigenvector, and Œª is the corresponding eigenvalue
if
Av = Œªv
where Œª is a scalar.
The German word eigen means characteristic, own, latent or special, and eigen-
vector means a special vector associated with a transform. The equation that deter-
mines the existence of any eigenvectors is called the characteristic equation of a
square matrix, and is given by
det(A ‚àíŒªI) = 0.
(4.18)

52
4
Matrices
Let‚Äôs derive the characteristic equation (4.18).
Consider the 2D transform t that maps the point (x,y) to another point (ax +
by,cx + dy):
t (x,y) ‚Üí(ax + by,cx + dy).
This is expressed in matrix form as
t : v ‚ÜíAv
or
x‚Ä≤
y‚Ä≤

=
a
b
c
d
x
y

where
A =
a
b
c
d

,
v =
x
y

.
Therefore, if v is an eigenvector of t, and Œª its associated eigenvalue, then
Av = Œªv
a
b
c
d
x
y

= Œª
x
y

or in equation terms:
ax + by = Œªx
cx + dy = Œªy.
Rearranging, we have
(a ‚àíŒª)x + by = 0
cx + (d ‚àíŒª)y = 0
or back in matrix form:
a ‚àíŒª
b
c
d ‚àíŒª
x
y

=
0
0

.
For a non-zero [x
y]T to exist, we must have
det
a ‚àíŒª
b
c
d ‚àíŒª

= 0
which is called the characteristic equation. Let‚Äôs use this on the transform
4
1
1
4
x
y

=
x‚Ä≤
y‚Ä≤

.

4.17
Eigenvectors and Eigenvalues
53
Then

4 ‚àíŒª
1
1
4 ‚àíŒª
 = 0
(4 ‚àíŒª)2 ‚àí1 = 0
Œª2 ‚àí8Œª + 16 ‚àí1 = 0
Œª2 ‚àí8Œª + 15 = 0
(Œª ‚àí5)(Œª ‚àí3) = 0.
Thus Œª = 5 and Œª = 3, are the two eigenvalues we observed in Fig. 4.1. Next, we
substitute the two values of Œª in
4 ‚àíŒª
1
1
4 ‚àíŒª
x
y

=
0
0

to extract the eigenvectors. Let‚Äôs start with Œª = 5:
‚àí1
1
1
‚àí1
x
y

=
0
0

which represents the equation y = x or the vector [k
k]T. Next, we substitute
Œª = 3:
1
1
1
1
x
y

=
0
0

which represents the equation y = ‚àíx or the vector [‚àík
k]T.
Thus we have discovered that the transform possesses two eigenvectors [k
k]T
and [‚àík
k]T and their respective eigenvalues Œª = 5 and Œª = 3, as predicted.
The characteristic equation may have real or complex solutions, and if they are
complex, there are no real eigenvectors. For example, we have already come across
the 2D transform for rotating points about the origin:
A =
cosŒ≤
‚àísinŒ≤
sinŒ≤
cosŒ≤

and we would not expect this to have any real eigenvectors, as this would imply that
it shows a rotational preference to certain points. Let‚Äôs explore this transform to see
how the characteristic equation behaves.
The characteristic equation is

cosŒ≤ ‚àíŒª
‚àísinŒ≤
sinŒ≤
cosŒ≤ ‚àíŒª
 = 0
where Œ≤ is the angle of rotation. Therefore,
(cosŒ≤ ‚àíŒª)2 + sin2 Œ≤ = 0
Œª2 ‚àí2ŒªcosŒ≤ + cos2 Œ≤ + sin2 Œ≤ = 0
Œª2 ‚àí2ŒªcosŒ≤ + 1 = 0.

54
4
Matrices
This quadratic in Œª is solved using
Œª = ‚àíb ¬±
‚àö
b2 ‚àí4ac
2a
where a = 1, b = ‚àí2cosŒ≤, c = 1:
Œª = 2cosŒ≤ ¬±

4cos2 Œ≤ ‚àí4
2
= cosŒ≤ ¬±

cos2 Œ≤ ‚àí1
= cosŒ≤ ¬±

‚àísin2 Œ≤
Œª1 = cosŒ≤ + i sinŒ≤
Œª2 = cosŒ≤ ‚àíi sinŒ≤
which are complex numbers.
The corresponding complex eigenvectors are
v1 =
1
i

v2 =
 1
‚àíi

.
Now let‚Äôs investigate the eigenvectors associated with a 3D transform. We start
with the arbitrary transform
A =
‚é°
‚é£
3
0
1
‚àí1
3
3
1
0
3
‚é§
‚é¶
and its characteristic equation is

3 ‚àíŒª
0
1
‚àí1
3 ‚àíŒª
3
1
0
3 ‚àíŒª

= 0.
Expanding the determinant using the top row we have
(3 ‚àíŒª)

3 ‚àíŒª
3
0
3 ‚àíŒª
 ‚àí0 +

‚àí1
3 ‚àíŒª
1
0
 = 0
(3 ‚àíŒª)(3 ‚àíŒª)2 ‚àí(3 ‚àíŒª) = 0
(3 ‚àíŒª)

(3 ‚àíŒª)2 ‚àí1

= 0
(3 ‚àíŒª)

Œª2 ‚àí6Œª + 8

= 0
(3 ‚àíŒª)(Œª ‚àí4)(Œª ‚àí2) = 0
which has solutions Œª = 2, 3, 4. Let‚Äôs substitute these values of Œª in the original
equations to reveal the eigenvectors:
‚éß
‚é®
‚é©
(3 ‚àíŒª)x
+
z = 0
‚àíx + (3 ‚àíŒª)y +
3z = 0
x
+ (3 ‚àíŒª)z = 0.

4.18
Vector Products
55
With Œª = 2 we have z = ‚àíx from the 1st equation. Substituting this in the 2nd
equation we have y = 4x, which permits us to state that the associated eigenvector
is of the form [k
4k
‚àík]T.
With Œª = 3 we have z = 0 from the 1st equation, and x = 0 from the 3rd equation,
which permits us to state that the associated eigenvector is of the form [0
k
0]T.
With Œª = 4 we have z = x from the 1st equation. Substituting this in the 2nd
equation we have y = 2x, which permits us to state that the associated eigenvector
is of the form [k
2k
k]T.
Therefore, the eigenvectors and eigenvalues are
[k
4k
‚àík]T
Œª = 2
[0
k
0]T
Œª = 3
[k
2k
k]T
Œª = 4
where k Ã∏= 0.
The major problem with the above technique is that it requires careful analysis to
untangle the eigenvector, and ideally, we require a deterministic algorithm to reveal
the result. We will discover that such a technique is available in Chap. 9.
4.18 Vector Products
Vectors are regarded as single column or single row matrices, which permits us to
express their products neatly. For example, given two vectors
v =
‚é°
‚é£
a
b
c
‚é§
‚é¶,
w =
‚é°
‚é£
x
y
z
‚é§
‚é¶
then
v ¬∑ w = vTw
=
a
b
c
‚é°
‚é£
x
y
z
‚é§
‚é¶= ax + by + cz.
Similarly, the vector cross product is written
v √ó w =
‚é°
‚é£
a
b
c
‚é§
‚é¶√ó
‚é°
‚é£
x
y
z
‚é§
‚é¶=
‚é°
‚é£
i
j
k
a
b
c
x
y
z
‚é§
‚é¶
= (bz ‚àícy)i ‚àí(az ‚àíxc)j + (ay ‚àíbx)k
=
‚é°
‚é£
bz ‚àícy
‚àíaz + xc
ay ‚àíbx
‚é§
‚é¶.

56
4
Matrices
4.19 Summary
Matrices play an important role in representing rotations, especially orthogonal ma-
trices, which is why they have been reviewed in this chapter. The inverse matrix is
also an important concept to grasp as this provides the mechanism for reversing a
rotation or change of frame. We will also come across eigenvectors in later chapters,
which is why they were explained in some detail.
4.19.1 Summary of Matrix Operations
Matrix (2 √ó 2)
A =
a
b
c
d

.
Matrix (3 √ó 3)
B =
‚é°
‚é£
a
b
c
d
e
f
g
h
i
‚é§
‚é¶.
Transpose
AT =
a
c
b
d

,
BT =
‚é°
‚é£
a
d
g
b
e
h
c
f
i
‚é§
‚é¶.
Identity
I =
1
0
0
1

,
I =
‚é°
‚é£
1
0
0
0
1
0
0
0
1
‚é§
‚é¶.
Adding and subtracting
M ¬± N = [mrow,col ¬± nrow,col].
Multiplying by a scalar
¬±ŒªM = [¬±Œªmrow,col].
Product transpose
[MN]T = NTMT.
Sum/difference transpose
[M ¬± N]T = MT ¬± NT.
Determinant
detA = |A| = ad ‚àíbc
detB = |B| = aei + bfg + cdh ‚àíceg ‚àíaf h ‚àíbdi.

4.19
Summary
57
Inverse
M‚àí1 = (cofactor matrix of M)T
detM
[MN]‚àí1 = N‚àí1M‚àí1.
Orthogonal
M is orthogonal if MT = M‚àí1.
Trace
Tr(A) = a + d
Tr(B) = a + e + i
Tr(MN) = Tr(NM).
Symmetric
M is symmetric if M = MT.
Symmetric part S
S = 1
2

M + MT
.
Antisymmetric
M is antisymmetric if M = ‚àíMT.
Antisymmetric part Q
Q = 1
2

M ‚àíMT
.
Eigenvector
v is the eigenvector of M if Mv = Œªv.
Eigenvalue
Œª is the eigenvalue of M if Mv = Œªv.


Chapter 5
Quaternions
5.1 Introduction
As mentioned earlier, quaternions were invented by Sir William Rowan Hamilton in
1843. Sir William was looking to generalise complex numbers in higher dimensions,
and it took 14 years of toil before he stumbled upon the idea of using a 4D notation
‚Äì hence the name ‚Äòquaternion‚Äô.
5.2 DeÔ¨Ånition
The deÔ¨Ånition and associated rules for a quaternion are:
q = a + bi + cj + dk
where a, b, c and d are scalars, and i, j and k are imaginary and obey the following
rules:
i2 = ‚àí1,
j2 = ‚àí1,
k2 = ‚àí1,
ijk = ‚àí1
ij = k,
jk = i,
ki = j
ji = ‚àík,
kj = ‚àíi,
ik = ‚àíj.
Although quaternions had some enthusiastic supporters, there were many mathe-
maticians and scientists who were suspicious of the need to involve so many imag-
inary terms. Towards the end of the nineteenth century Josiah Gibbs resolved the
problem by declaring that the three imaginary quantities could be viewed as a 3D
vector and changed the original bi + cj + dk into bi + cj + dk, where i, j and k
are unit Cartesian vectors. Today, it is convenient in computer graphics to write a
quaternion in two ways:
q = s,v
(5.1)
q = s + v
(5.2)
where s is a scalar, and v is a 3D vector.
J. Vince, Rotation Transforms for Computer Graphics,
DOI 10.1007/978-0-85729-154-7_5, ¬© Springer-Verlag London Limited 2011
59

60
5
Quaternions
The difference is rather subtle: in (5.1) the scalar and vector are separated by a
comma, whereas in (5.2) a ‚Äò+‚Äô sign is used as in complex numbers. Although the
idea of adding a scalar to a vector seems strange, this notation is used in this book
as it helps us understand the ideas behind multivectors, which are covered in the
next chapter. Since Hamilton‚Äôs invention, mathematicians have successfully applied
quaternions to rotate points about an arbitrary axis, which is why we are interested
in them.
A quaternion then, is the combination of a scalar and a vector:
q = s + v
where s is a scalar and v is a 3D vector. If we express the vector v in terms of its
components, we have
q = s + xi + yj + zk
where s,x,y,z are all scalars.
Later on we will discover that in the context of a rotation transform, v is used to
represent the axis of rotation, and the scalar s encodes the angle of rotation.
5.2.1 Axioms
Quaternions share the same axioms as complex numbers apart from multiplication,
where they do not commute.
Addition:
Commutative
q1 + q2 = q2 + q1
Associative
(q1 + q2) + q3 = q1 + (q2 + q3).
Multiplication:
Associative
(q1q2)q3 = q1(q2q3)
Non-commutative
q1q2 Ã∏= q2q1.
5.3 Adding and Subtracting Quaternions
Two quaternions q1 and q2
q1 = s1 + x1i + y1j + z1k
q2 = s2 + x2i + y2j + z2k
are equal if, and only if, their corresponding terms are equal. Furthermore, like vec-
tors, they can be added and subtracted as follows:
q1 ¬± q2 = (s1 ¬± s2) + (x1 ¬± x2)i + (y1 ¬± y2)j + (z1 ¬± z2)k.

5.4
Multiplying Quaternions
61
For example:
q1 = 0.6 + 2i + 4j ‚àí3k
q2 = 0.2 + 3i + 5j + 7k
q1 + q2 = 0.8 + 5i + 9j + 4k
q1 ‚àíq2 = 0.4 ‚àíi ‚àíj ‚àí10k.
5.4 Multiplying Quaternions
When multiplying quaternions we must employ the following rules:
i2 = ‚àí1,
j2 = ‚àí1,
k2 = ‚àí1,
ijk = ‚àí1
ij = k,
jk = i,
ki = j
ji = ‚àík,
kj = ‚àíi,
ik = ‚àíj.
Note that quaternion addition is commutative, however, the rules make quaternion
products non-commutative. For example:
q1 = s1 + v1 = s1 + x1i + y1j + z1k
q2 = s2 + v2 = s2 + x2i + y2j + z2k
q1q2 = (s1s2 ‚àíx1x2 ‚àíy1y2 ‚àíz1z2) + (s1x2 + s2x1 + y1z2 ‚àíy2z1)i
+ (s1y2 + s2y1 + z1x2 ‚àíz2x1)j + (s1z2 + s2z1 + x1y2 ‚àíx2y1)k
= s1s2 ‚àí(x1x2 + y1y2 + z1z2) + s1(x2i + y2j + z2k) + s2(x1i + y1j + z1k)
+ (y1z2 ‚àíy2z1)i + (z1x2 ‚àíz2x1)j + (x1y2 ‚àíx2y1)k
which can be rewritten using the dot and cross product notation as
q1q2 = s1s2 ‚àív1 ¬∑ v2 + s1v2 + s2v1 + v1 √ó v2
where
s1s2 ‚àív1 ¬∑ v2
is a scalar, and
s1v2 + s2v1 + v1 √ó v2
is a vector.
For example:
q1 = 1 + 2i + 3j + 4k
q2 = 2 ‚àíi + 5j ‚àí2k
q1q2 = (1 + 2i + 3j + 4k)(2 ‚àíi + 5j ‚àí2k)
q1q2 =

1 √ó 2 ‚àí2 √ó (‚àí1) + 3 √ó 5 + 4 √ó (‚àí2)

+ 1(‚àíi + 5j ‚àí2k) + 2(2i + 3j + 4k)
+

3 √ó (‚àí2) ‚àí4 √ó 5

i ‚àí

2 √ó (‚àí2) ‚àí4 √ó (‚àí1)

j +

2 √ó 5 ‚àí3 √ó (‚àí1)

k
= ‚àí3 + 3i + 11j + 6k ‚àí26i + 13k
= ‚àí3 ‚àí23i + 11j + 19k

62
5
Quaternions
which is another quaternion. You may wish to evaluate q2q1 and show that q1q2 Ã∏=
q2q1.
5.5 Pure Quaternion
A pure quaternion has a zero scalar term:
q = 0 + v
which is a vector. Therefore,
q1 = 0 + v1
q2 = 0 + v2
q1q2 = ‚àív1 ¬∑ v2 + v1 √ó v2
which leads to a rather strange result for the square of a pure quaternion:
qq = ‚àív ¬∑ v + v √ó v
= ‚àív ¬∑ v
= ‚àí|v|2
a negative real number! In Hamilton‚Äôs day, physicists found this result difÔ¨Åcult to
accept, and on top of all the imaginary terms refused to adopt quaternions and em-
braced the vector analysis proposed by Gibbs et al.
5.6 Magnitude of a Quaternion
The magnitude, norm or modulus of a quaternion is written |q| and equals
q = s + xi + yj + zk
|q| =

s2 + x2 + y2 + z2.
For example:
q = 1 + 2i + 4j ‚àí3k
|q| =

12 + 22 + 42 + (‚àí3)2 =
‚àö
30.
5.7 Unit Quaternion
A unit quaternion has a magnitude equal to 1:
|q| =

s2 + x2 + y2 + z2 = 1.

5.8
The Quaternion Conjugate
63
Any quaternion q can be normalised to a unit quaternion ÀÜq by dividing by its mag-
nitude:
ÀÜq = q
|q|.
5.8 The Quaternion Conjugate
We have already discovered that the complex conjugate of a complex number z =
a + bi is given by
z‚àó= a ‚àíbi
and is very useful in computing the inverse of z. The quaternion conjugate plays a
similar role in computing the inverse of a quaternion. Therefore, given
q = s + v
= s + xi + yj + zk
its conjugate is deÔ¨Åned as
q‚àó= s ‚àív
= s ‚àíxi ‚àíyj ‚àízk.
If we compute the product qq‚àówe obtain
qq‚àó= (s + v)(s ‚àív)
= s2 + v ¬∑ v + sv ‚àísv + v √ó (‚àív) = s2 + v ¬∑ v
= s2 + x2 + y2 + z2
which is a scalar and implies that
qq‚àó= |q|2
or
|q| =

qq‚àó.
Similarly, we can show that qq‚àó= q‚àóq.
Now let‚Äôs show that (q1q2)‚àó= q‚àó
2q‚àó
1. We start with quaternions q1 and q2:
q1 = s1 + v1
q2 = s2 + v2
q1q2 = (s1 + v1)(s2 + v2)
= s1s2 ‚àív1 ¬∑ v2 + s1v2 + s2v1 + v1 √ó v2
(q1q2)‚àó= s1s2 ‚àív1 ¬∑ v2 ‚àís1v2 ‚àís2v1 ‚àív1 √ó v2.
(5.3)

64
5
Quaternions
Next, we compute q‚àó
2q‚àó
1
q‚àó
1 = s1 ‚àív1
q‚àó
2 = s2 ‚àív2
q‚àó
2q‚àó
1 = (s2 ‚àív2)(s1 ‚àív1)
= s1s2 ‚àív1 ¬∑ v2 + s2(‚àív1) + s1(‚àív2) + (‚àív2) √ó (‚àív1)
= s1s2 ‚àív1 ¬∑ v2 ‚àís1v2 ‚àís2v1 ‚àív1 √ó v2
(5.4)
and as (5.3) equals (5.4), (q1q2)‚àó= q‚àó
2q‚àó
1.
5.9 The Inverse Quaternion
Given a quaternion q we can compute its inverse q‚àí1 as follows.
By deÔ¨Ånition, we require that
qq‚àí1 = q‚àí1q = 1.
(5.5)
First, we multiply (5.5) by q‚àó
q‚àóqq‚àí1 = q‚àóq‚àí1q = q‚àó
(5.6)
and from (5.6) we can write
q‚àí1 = q‚àó
q‚àóq = q‚àó
|q|2 .
If q is a unit quaternion, then q‚àí1 = q‚àó, which is useful when reversing a rotational
sequence. Therefore, as
(q1q2)‚àó= q‚àó
2q‚àó
1
then
(q1q2)‚àí1 = q‚àí1
2 q‚àí1
1 .
For completeness let‚Äôs evaluate the inverse of q where
q = 1 + 1
‚àö
3
i + 1
‚àö
3
j + 1
‚àö
3
k
q‚àó= 1 ‚àí1
‚àö
3
i ‚àí1
‚àö
3
j ‚àí1
‚àö
3
k
|q|2 = 1 + 1
3 + 1
3 + 1
3 = 2
q‚àí1 = 1
2

1 ‚àí1
‚àö
3
i ‚àí1
‚àö
3
j ‚àí1
‚àö
3
k

= 1
2 ‚àí
1
‚àö
12
i ‚àí
1
‚àö
12
j ‚àí
1
‚àö
12
k.

5.10
Summary
65
5.10 Summary
Quaternions offer a powerful algebra for rotating points about an arbitrary axis and
it is important that they are fully understood before proceeding. We have yet to see
how quaternions actually perform this rotational task, which is covered in Chap. 11.
5.10.1 Summary of Quaternion Operations
q = s + v
= s + xi + yj + zk
where s, x, y, z are scalars, and
i2 = ‚àí1,
j2 = ‚àí1,
k2 = ‚àí1,
ijk = ‚àí1
ij = k,
jk = i,
ki = j
ji = ‚àík,
kj = ‚àíi,
ik = ‚àíj.
Addition and subtraction
q1 ¬± q2 = (s1 ¬± s2) + (x1 ¬± x2)i + (y1 ¬± y2)j + (z1 ¬± z2)k.
Product
q1q2 = (s1s2 ‚àíx1x2 ‚àíy1y2 ‚àíz1z2) + (s1x2 + s2x1 + y1z2 ‚àíy2z1)i
+ (s1y2 + s2y1 + z1x2 ‚àíz2x1)j + (s1z2 + s2z1 + x1y2 ‚àíx2y1)k
q1q2 = (s1s2 ‚àív1 ¬∑ v2) + s1v2 + s2v1 + v1 √ó v2.
Pure
q = 0 + v.
Magnitude
|q| =

s2 + x2 + y2 + z2.
Unit
|q| =

s2 + x2 + y2 + z2 = 1.
Quaternion conjugate
q‚àó= s ‚àív = s ‚àíxi ‚àíyj ‚àízk
(q1q2)‚àó= q‚àó
2q‚àó
1.
Inverse
q‚àí1 = q‚àó
q‚àóq = q‚àó
|q|2
(q1q2)‚àí1 = q‚àí1
2 q‚àí1
1 .


Chapter 6
Multivectors
6.1 Introduction
This is a brief introduction to multivectors of geometric algebra and we only ex-
plore those elements associated with rotations. Those readers who wish to pursue
the subject further may wish to consult the author‚Äôs books: Geometric Algebra for
Computer Graphics [5] or Geometric Algebra: An Algebraic System for Computer
Games and Animation [6].
We regard vectors as directed lines or oriented lines, but if they exist, why
shouldn‚Äôt oriented planes and oriented volumes exist? Well they do, which is what
geometric algebra is about. Unfortunately when vectors were invented, the work of
the German mathematician, Hermann Grassmann (1809‚Äì1877), was not understood
and consequently ignored. In retrospect this was unfortunate, as Grassmann had
invented an exceedingly powerful algebra for geometry, and it has taken a further
century for it to emerge through the work of William Kingdon Clifford (1845‚Äì1879)
and David Hestenes. So let‚Äôs explore an exciting algebra that offers new ways of
handling rotations.
6.2 Symmetric and Antisymmetric Functions
Symmetric (even) and antisymmetric (odd) functions play an important role in un-
derstanding multivectors. For example, f (Œ≤) is a symmetric function if
f (‚àíŒ≤) = f (Œ≤)
an example being cosŒ≤ where cos(‚àíŒ≤) = cosŒ≤. Whereas, f (Œ≤) is an antisymmetric
function if
f (‚àíŒ≤) = ‚àíf (Œ≤)
an example being sinŒ≤ where sin(‚àíŒ≤) = ‚àísinŒ≤.
J. Vince, Rotation Transforms for Computer Graphics,
DOI 10.1007/978-0-85729-154-7_6, ¬© Springer-Verlag London Limited 2011
67

68
6
Multivectors
Fig. 6.1 Two line segments a
and b separated by +Œ≤
6.3 Trigonometric Foundations
Figure 6.1 shows two line segments a and b with coordinates (a1,a2) and (b1,b2)
respectively. The lines are separated by an angle Œ≤, and it is a trivial exercise to
show that
ab sinŒ≤ = a1b2 ‚àía2b1
which equals the area of the parallelogram formed by a and b. What is interesting is
that reversing the relative orientation of the lines such that b is rotated ‚àíŒ≤ relative
to a makes
ab sinŒ≤ = ‚àí(a1b2 ‚àía2b1)
which means that this is antisymmetric due to the sine function.
We know from the deÔ¨Ånition of the scalar product of vectors that
ab cosŒ≤ = a1b1 + a2b2
which remains unaltered if the relative orientation of the lines is reversed, which
means that this is symmetric due to the cosine function.
6.4 Vectorial Foundations
If we form the algebraic product of two 2D vectors a and b we have:
a = a1i + a2j
b = b1i + b2j
ab = a1b1i2 + a2b2j2 + a1b2ij + a2b1ji.
(6.1)
It is clear from (6.1) that a1b1i2 + a2b2j2 has something to do with ab cosŒ≤, and
a1b2ij + a2b1ji has something to do with ab sinŒ≤. The product ab creates the terms
i2, j2, ij and ji, which are resolved as follows.

6.5
Inner and Outer Products
69
6.5 Inner and Outer Products
Let‚Äôs assume that the products ij and ji in (6.1) anticommute: ji = ‚àíij. Therefore,
ab = a1b1i2 + a2b2j2 + (a1b2 ‚àía2b1)ij
(6.2)
and if we reverse the product to ba we obtain
ba = a1b1i2 + a2b2j2 ‚àí(a1b2 ‚àía2b1)ij.
(6.3)
From (6.2) and (6.3) we see that the product of two vectors contains a symmetric
component
a1b1i2 + a2b2j2
and an antisymmetric component
(a1b2 ‚àía2b1)ij.
Geometric algebra deÔ¨Ånes the product ab as the sum of two other products called
the inner and outer products. The inner product has the form
a ¬∑ b = |a||b|cosŒ≤
(6.4)
where
a ¬∑ b = (a1i + a2j) ¬∑ (b1i + b2j)
= a1b1i ¬∑ i + a1b2i ¬∑ j + a2b1j ¬∑ i + a2b2j ¬∑ j
= a1b1 + a2b2
which is the familiar scalar product. The outer product uses the wedge ‚Äò‚àß‚Äô symbol,
which is why it is also called the wedge product and has the form
a ‚àßb = |a||b|sinŒ≤i ‚àßj
(6.5)
where
a ‚àßb = (a1i + a2j) ‚àß(b1i + b2j)
= a1b1i ‚àßi + a1b2i ‚àßj + a2b1j ‚àßi + a2b2j ‚àßj
= (a1b2 ‚àía2b1)i ‚àßj
which enables us to write
ab = a ¬∑ b + a ‚àßb
(6.6)
ab = |a||b|cosŒ≤ + |a||b|sinŒ≤i ‚àßj.
(6.7)
6.6 The Geometric Product in 2D
Clifford named the sum of the two products the geometric product, which means
that (6.6) reads: The geometric product ab is the sum of the inner product ‚Äúa dot b‚Äù
and the outer product ‚Äúa wedge b‚Äù.

70
6
Multivectors
Given the deÔ¨Ånition of the geometric product, let‚Äôs evaluate i2:
ii = i ¬∑ i + i ‚àßi.
Using the deÔ¨Ånition for the inner product (6.4) we have
i ¬∑ i = 1 √ó 1 √ó cos0¬∞ = 1
whereas using the deÔ¨Ånition of the outer product (6.5) we have
i ‚àßi = 1 √ó 1 √ó sin0¬∞i ‚àßi = 0.
Thus i2 = 1 and j2 = 1, and aa = |a|2:
aa = a ¬∑ a + a ‚àßa
= |a||a|cos0¬∞ + |a||a|sin0¬∞i ‚àßj
aa = |a|2.
This result is much more satisfying than the square of a pure quaternion q:
qq = ‚àí|q|2.
Now let‚Äôs evaluate ij:
ij = i ¬∑ j + i ‚àßj.
Using the deÔ¨Ånition for the inner product (6.4) we have
i ¬∑ j = 1 √ó 1 √ó cos90¬∞ = 0
whereas using the deÔ¨Ånition of the outer product (6.5) we have
i ‚àßj = 1 √ó 1 √ó sin90¬∞i ‚àßj = i ‚àßj.
Thus ij = i‚àßj. But what is i‚àßj? Well, it is a new object called a bivector and deÔ¨Ånes
the orientation of the plane containing i and j. As the order of the vectors is from i
to j, the angle is +90¬∞ and sin(+90)¬∞ = 1. Whereas, if the order is from j to i the
angle is ‚àí90¬∞ and sin(‚àí90¬∞) = ‚àí1. Consequently,
ji = j ¬∑ i + j ‚àßi
= 0 + 1 √ó 1 √ó sin(‚àí90¬∞)i ‚àßj
= ‚àíi ‚àßj.
A useful way of visualising the bivector i ‚àßj is to imagine moving along the
vector i and then along the vector j, which creates an anticlockwise rotation. Con-
versely, for the bivector j‚àßi, imagine moving along the vector j followed by vector i,
which creates a clockwise rotation. Another useful picture is to sweep vector j along
vector i to create an anticlockwise rotation, and vice versa for j ‚àßi. These ideas are
shown in Fig. 6.2.
The following equation
ab = 9 + 12i ‚àßj

6.7
The Geometric Product in 3D
71
Fig. 6.2 An anticlockwise
and clockwise bivector
means that the geometric product of two vectors a and b creates a scalar, inner
product of 9, and an outer product of 12 on the i‚Äìj plane. For example, given
a = 3i
b = 3i + 4j
ab = (3i) ¬∑ (3i + 4j) + (3i) ‚àß(3i + 4j)
= 9 + 9i ‚àßi + 12i ‚àßj
= 9 + 12i ‚àßj.
The 9 represents |a||b|cosŒ≤, whereas the 12 represents an area |a||b|sinŒ≤ on the
i‚Äìj plane. The angle between the two vectors Œ≤ is given by
Œ≤ = cos‚àí1(3/5).
However, reversing the product, we obtain
ba = (3i + 4j) ¬∑ (3i) + (3i + 4j) ‚àß(3i)
= 9 + 9i ‚àßi + 12j ‚àßi
= 9 ‚àí12i ‚àßj
where the sign of the outer (wedge) product has Ô¨Çipped to reÔ¨Çect the new orientation
of the vectors relative to the accepted orientation of the basis bivector.
So the geometric product combines the scalar and wedge products into a single
product, where the scalar product is the symmetric component and the wedge prod-
uct is the antisymmetric component. Now let‚Äôs see how these products behave in
3D.
6.7 The Geometric Product in 3D
Before we begin let‚Äôs introduce some new notation to simplify future algebraic ex-
pressions. Rather than use i, j and k to represent the unit basis vectors let‚Äôs employ
e1, e2 and e3 respectively. This implies that (6.7) can be written
ab = |a||b|cosŒ≤ + |a||b|sinŒ≤e1 ‚àße2.
We also remind ourselves that we are working with a right-handed axial system,
where, using our right-hand, the thumb aligns with e1, the x-axis, the Ô¨Årst Ô¨Ånger

72
6
Multivectors
Fig. 6.3 The 3D bivectors
aligns with e2, the y-axis, and the middle Ô¨Ånger aligns with e3, the z-axis. We begin
with two 3D vectors:
a = a1e1 + a2e2 + a3e3
b = b1e1 + b2e2 + b3e3
and their inner product is
a ¬∑ b = (a1e1 + a2e2 + a3e3) ¬∑ (b1e1 + b2e2 + b3e3)
= a1b1 + a2b2 + a3b3
and their outer product is
a ‚àßb = (a1e1 + a2e2 + a3e3) ‚àß(b1e1 + b2e2 + b3e3)
= a1b2e1 ‚àße2 + a1b3e1 ‚àße3 + a2b1e2 ‚àße1
+ a2b3e2 ‚àße3 + a3b1e3 ‚àße1 + a3b2e3 ‚àße2
= (a1b2 ‚àía2b1)e1 ‚àße2 + (a2b3 ‚àía3b2)e2 ‚àße3 + (a3b1 ‚àía1b3)e3 ‚àße1.
(6.8)
This time we have three unit basis bivectors: e1 ‚àße2, e2 ‚àße3, e3 ‚àße1, and three asso-
ciated scalar multipliers: (a1b2 ‚àía2b1), (a2b3 ‚àía3b2), (a3b1 ‚àía1b3) respectively.
These bivectors are the basis for a right-handed oriented axial system.
Continuing with the idea described in the previous section, the three bivectors
represent the three planes containing the respective vectors as shown in Fig. 6.3, and
the scalar multipliers are projections of the area of the vector parallelogram onto the
three bivectors as shown in Fig. 6.4. Note that this is the accepted deÔ¨Ånition for a
right-handed space. The orientation of the vectors a and b determine whether the
projected areas are positive or negative.
Equation (6.8) should look familiar as it looks similar to the cross product a √ó b:
a √ó b = (a1b2 ‚àía2b1)e3 + (a2b3 ‚àía3b2)e1 + (a3b1 ‚àía1b3)e2.
(6.9)
This similarity is no accident, for when Hamilton invented quaternions he did not
recognise the possibility of bivectors, and invented some rules which eventually

6.8
The Outer Product of Three 3D Vectors
73
Fig. 6.4 The projections on
the three bivectors
became the vector product. In fact, we show later that quaternions are bivectors in
disguise. We can see that a simple relationship exists between (6.8) and (6.9):
e1 ‚àße2 and e3
e2 ‚àße3 and e1
e3 ‚àße1 and e2.
The wedge product bivectors are perpendicular to the vector components of the cross
product. So the wedge product is just another way of representing the cross product.
However, the wedge product introduces a very important bonus ‚Äì it works in space
of any dimension; whereas, the cross product is only comfortable in 3D. Not only
that, the wedge (outer) product is a product that creates volumes, hypervolumes, and
can also be applied to vectors, bivectors, trivectors, etc.
6.8 The Outer Product of Three 3D Vectors
Having seen that the outer product of two 3D vectors is represented by areal pro-
jections onto the three basis bivectors, let‚Äôs compute the outer product of three 3D
vectors:
a = a1e1 + a2e2 + a3e3
b = b1e1 + b2e2 + b3e3
c = c1e1 + c2e2 + c3e3
a ‚àßb ‚àßc = (a1e1 + a2e2 + a3e3) ‚àß(b1e1 + b2e2 + b3e3) ‚àß(c1e1 + c2e2 + c3e3)
= ((a1b2 ‚àía2b1)e1 ‚àße2 + (a2b3 ‚àía3b2)e2 ‚àße3 + (a3b1 ‚àía1b3)e3 ‚àße1)
‚àß(c1e1 + c2e2 + c3e3).
At this stage we introduce another axiom: the outer product is associative. This
means that a ‚àß(b ‚àßc) = (a ‚àßb) ‚àßc. Therefore, knowing that a ‚àßa = 0:

74
6
Multivectors
a ‚àßb ‚àßc = c3(a1b2 ‚àía2b1)e1 ‚àße2 ‚àße3 + c1(a2b3 ‚àía3b2)e2 ‚àße3 ‚àße1
+ c2(a3b1 ‚àía1b3)e3 ‚àße1 ‚àße2
= (c3(a1b2 ‚àía2b1) + c1(a2b3 ‚àía3b2) + c2(a3b1 ‚àía1b3))e1 ‚àße2 ‚àße3
or using a determinant:
a ‚àßb ‚àßc =

a1
b1
c1
a2
b2
c2
a3
b3
c3

e1 ‚àße2 ‚àße3
which is the well-known expression for the volume of a parallelpiped formed by
three vectors.
The term e1 ‚àße2 ‚àße3 is a trivector and implies that the volume is oriented. If
the sign of the determinant is positive, the original three vectors possess the same
orientation of the three basis vectors. If the sign of the determinant is negative, the
three vectors oppose the orientation of the basis trivector.
6.9 Axioms
One of the features of geometric algebra is that it behaves very similar to the every-
day algebra of reals:
Axiom 6.1 The associative rule:
a(bc) = (ab)c.
Axiom 6.2 The left and right distributive rules:
a(b + c) = ab + ac
(b + c)a = ba + ca.
The next four axioms describe how vectors interact with a scalar Œª:
Axiom 6.3
(Œªa)b = Œª(ab) = Œªab.
Axiom 6.4
Œª(œÜa) = (ŒªœÜ)a.
Axiom 6.5
Œª(a + b) = Œªa + Œªb.
Axiom 6.6
(Œª + œÜ)a = Œªa + œÜa.

6.10
Notation
75
Axiom 6.7
a2 = |a|2.
6.10 Notation
Having abandoned i, j, k for e1, e2, e3, it is convenient to convert geometric products
e1e2 ¬∑¬∑¬∑en to e12¬∑¬∑¬∑n. For example, e1e2e3 ‚â°e123. Furthermore, we must get used to
the following substitutions:
eieiej = ej
e21 = ‚àíe12
e312 = e123
e112 = e2
e121 = ‚àíe2.
6.11 Grades, Pseudoscalars and Multivectors
As geometric algebra embraces such a wide range of objects, it is convenient to
grade them as follows: scalars are grade 0, vectors are grade 1, bivectors are grade 2,
and trivectors are grade 3, and so on for higher dimensions. In such a graded algebra
it is traditional to call the highest grade element a pseudoscalar. Thus in 2D the
pseudoscalar is e12 and in 3D the pseudoscalar is e123.
One very powerful feature of geometric algebra is the idea of a multivector,
which is a linear combination of a scalar, vector, bivector, trivector, or any other
higher dimensional object. For example the following are multivectors:
A = 3 + (2e1 + 3e2 + 4e3) + (5e12 + 6e23 + 7e31) + 8e123
B = 2 + (2e1 + 2e2 + 3e3) + (4e12 + 5e23 + 6e31) + 7e123
and we can form their sum:
A + B = 5 + (4e1 + 5e2 + 7e3) + (9e12 + 11e23 + 13e31) + 15e123
or their difference:
A ‚àíB = 1 + (e2 + e3) + (e12 + e23 + e31) + e123.
We can even form their product AB.
We can isolate any grade of a multivector using the following notation:
‚ü®multivector‚ü©g
where g identiÔ¨Åes a particular grade. For example, say we have the following mul-
tivector:
2 + 3e1 + 2e2 ‚àí5e12 + 6e123

76
6
Multivectors
we extract the scalar term using:
‚ü®2 + 3e1 + 2e2 ‚àí5e12 + 6e123‚ü©0 = 2
the vector term using
‚ü®2 + 3e1 + 2e2 ‚àí5e12 + 6e123‚ü©1 = 3e1 + 2e2
the bivector term using:
‚ü®2 + 3e1 + 2e2 ‚àí5e12 + 6e123‚ü©2 = ‚àí5e12
and the trivector term using:
‚ü®2 + 3e1 + 2e2 ‚àí5e12 + 6e123‚ü©3 = 6e123.
It is also worth pointing out that the inner vector product converts two grade 1
elements, i.e. vectors, into a grade 0 element, i.e. a scalar, whereas the outer vector
product converts two grade 1 elements into a grade 2 element, i.e. a bivector. Thus
the inner product is a grade lowering operation, while the outer product is a grade
raising operation. These qualities of the inner and outer products are associated
with higher grade elements in the algebra. This is why the scalar product is renamed
as the inner product, because the scalar product is synonymous with transforming
vectors into scalars. Whereas, the inner product transforms two elements of grade n
into a grade n ‚àí1 element.
6.12 RedeÔ¨Åning the Inner and Outer Products
As the geometric product is deÔ¨Åned in terms of the inner and outer products, it
seems only natural to expect that similar functions exist relating the inner and outer
products in terms of the geometric product. Such functions do exist and emerge
when we combine the following two equations:
ab = a ¬∑ b + a ‚àßb
(6.10)
ba = a ¬∑ b ‚àía ‚àßb.
(6.11)
Adding and subtracting (6.10) and (6.11) we have
a ¬∑ b = 1
2(ab + ba)
(6.12)
a ‚àßb = 1
2(ab ‚àíba).
(6.13)
Equations (6.12) and (6.13) are used frequently to deÔ¨Åne the products between dif-
ferent grade elements.

6.13
The Inverse of a Vector
77
6.13 The Inverse of a Vector
In traditional vector analysis we accept that it is impossible to divide by a vector, but
that is not so in geometric algebra. In fact, we don‚Äôt actually divide a multivector by
another vector but Ô¨Ånd a way of representing the inverse of a vector. For example,
we know that a unit vector ÀÜa is deÔ¨Åned as
ÀÜa = a
|a|
and using the geometric product
ÀÜa2 = a2
|a|2 = 1
therefore,
b = a2b
|a|2
and exploiting the associative nature of the geometric product we have
b = a(ab)
|a|2 .
(6.14)
Equation (6.14) is effectively stating that, given the geometric product ab we can
recover the vector b by pre-multiplying by a‚àí1:
a‚àí1 =
a
|a|2 .
Similarly, we can recover the vector a as follows by post-multiplying by b‚àí1:
a = (ab)b
|b|2 .
For example:
a = e1 + 2e2
b = 3e1 + 2e2
their geometric product is
ab = 7 ‚àí4e12.
Therefore, given ab and a, we can recover b as follows:
b =
e1 + 2e2
5

(7 ‚àí4e12)
= 1
5(7e1 ‚àí4e112 + 14e2 ‚àí8e212)
= 1
5(7e1 ‚àí4e2 + 14e2 + 8e1)
= 3e1 + 2e2.

78
6
Multivectors
Similarly, given ab and b, a is recovered as follows:
a = (7 ‚àí4e12)
3e1 + 2e2
13

= 1
13(21e1 + 14e2 ‚àí12e121 ‚àí8e122)
= 1
13(21e1 + 14e2 + 12e2 ‚àí8e1)
= e1 + 2e2.
Note that the inverse of a unit vector is the original vector:
ÀÜa‚àí1 =
ÀÜa
|ÀÜa|2 = ÀÜa.
6.14 The Imaginary Properties of the Outer Product
So far we know that the outer product of two vectors is represented by one or more
unit basis vectors, such as
a ‚àßb = Œª1e12 + Œª2e23 + Œª3e31
where, in this case, the Œª terms represent areas projected onto their respective unit
basis bivectors. But what has not emerged is that the outer product is an imaginary
quantity, which is revealed by expanding e2
12:
e2
12 = e1212
but as
e21 = ‚àíe12
then
e1(21)2 = ‚àíe1(12)2
= ‚àíe2
1e2
2
e2
12 = ‚àí1.
Consequently, the geometric product effectively creates a complex number! Thus in
a 2D scenario, given:
a = a1e1 + a2e2
b = b1e1 + b2e2
their geometric product is
ab = (a1b1 + a2b2) + (a1b2 ‚àía2b1)e12
and knowing that e12 = i, then we can write ab as
ab = (a1b1 + a2b2) + (a1b2 ‚àía2b1)i.
(6.15)

6.14
The Imaginary Properties of the Outer Product
79
However, this notation is not generally adopted by the geometric algebra commu-
nity. The reason being that i is normally only associated with a scalar, with which it
commutes. Whereas in 2D, e12 is associated with scalars and vectors, and although
scalars present no problem, under some conditions, it anticommutes with vectors.
Consequently, an upper-case I is used so that there is no confusion between the two
elements. Thus (6.15) is written as
ab = (a1b1 + a2b2) + (a1b2 ‚àía2b1)I
where
I 2 = ‚àí1.
It goes without saying that the 3D unit basis bivectors are also imaginary quantities,
so too, is e123.
Multiplying a complex number by i rotates it 90¬∞ on the complex plane. There-
fore, it should be no surprise that multiplying a 2D vector by e12 rotates it by 90¬∞.
However, because vectors are sensitive to their product partners, we must remember
that pre-multiplying a vector by e12 rotates a vector clockwise and post-multiplying
rotates a vector anticlockwise. For instance, post-multiplying e1 by e12 creates e2,
which is an anticlockwise rotation, whereas, pre-multiplying e1 by e12 creates ‚àíe2,
which is a clockwise rotation.
Whilst on the subject of rotations, let‚Äôs consider what happens in 3D. We begin
with a 3D vector
a = a1e1 + a2e2 + a3e3
and the unit basis bivector e12 as shown in Fig. 6.5. Next we construct their geomet-
ric product
e12a = a1e12e1 + a2e12e2 + a3e12e3
= a1e121 + a2e122 + a3e123
= ‚àía1e2 + a2e1 + a3e123
= a2e1 ‚àía1e2 + a3e123
which contains two parts: a vector (a2e1 ‚àía1e2) and a volume a3e123.
Figure 6.5 shows how the projection of vector a is rotated anticlockwise on the
bivector e12. A volume is also created perpendicular to the bivector. This enables us
to predict that if the vector is coplanar with the bivector, the entire vector is rotated
90¬∞ and the volume component is zero.
Post-multiplying a by e12 creates
ae12 = ‚àía2e1 + a1e2 + a3e123
which shows that while the volumetric element has remained the same, the projected
vector is rotated anticlockwise. You may wish to show that the same happens with
the other two bivectors.

80
6
Multivectors
Fig. 6.5 The effect of
multiplying a vector by a
bivector
6.15 Duality
The ability to exchange pairs of geometric elements such as lines and planes in-
volves a dual operation, which in geometric algebra is relatively easy to deÔ¨Åne. For
example, given a multivector A its dual A‚àóis deÔ¨Åned as
A‚àó= IA
where I is the local pseudoscalar. For 2D this is e12 and for 3D it is e123. Therefore,
given:
a = a1e1 + a2e2
its dual is
a‚àó= e12(a1e1 + a2e2)
= a1e121 + a2e122
= a2e1 ‚àía1e2
which is another vector rotated 90¬∞ anticlockwise.
It is easy to show that (a‚àó)‚àó= ‚àía, and two further dual operations return the
vector back to a.
In 3D the dual of a vector e1 is
e123e1 = e1231 = e23
which is the perpendicular bivector. Similarly, the dual of e2 is e31 and the dual of
e3 is e12.
For a general vector a1e1 + a2e2 + a3e3 its dual is
e123(a1e1 + a2e2 + a3e3) = a1e1231 + a2e1232 + a3e1233
= a3e12 + a1e23 + a2e31.
The duals of the 3D basis bivectors are:
e123e12 = e12312 = ‚àíe3
e123e23 = e12323 = ‚àíe1
e123e31 = e12331 = ‚àíe2.

6.16
The Relationship Between the Vector Product and the Outer Product
81
Table 6.1 Hamilton‚Äôs
quaternion product rules
i
j
k
i
‚àí1
k
‚àíj
j
‚àík
‚àí1
i
k
j
‚àíi
‚àí1
6.16 The Relationship Between the Vector Product and the
Outer Product
We have already discovered that there is a very close relationship between the vector
product and the outer product, and we will see what happens when we form the cross
and wedge product of two 3D vectors:
a = a1e1 + a2e2 + a3e3
b = b1e1 + b2e2 + b3e3
a √ó b = (a2b3 ‚àía3b2)e1 + (a3b1 ‚àía1b3)e2 + (a1b2 ‚àía2b1)e3
(6.16)
a ‚àßb = (a2b3 ‚àía3b2)e2 ‚àße3 + (a3b1 ‚àía1b3)e3 ‚àße1 + (a1b2 ‚àía2b1)e1 ‚àße2
= (a2b3 ‚àía3b2)e23 + (a3b1 ‚àía1b3)e31 + (a1b2 ‚àía2b1)e12.
(6.17)
Multiplying (6.17) by I123 we obtain
I123(a ‚àßb) = (a2b3 ‚àía3b2)e123e23 + (a3b1 ‚àía1b3)e123e31
+ (a1b2 ‚àía2b1)e123e12
= ‚àí((a2b3 ‚àía3b2)e1 + (a3b1 ‚àía1b3)e2 + (a1b2 ‚àía2b1)e3)
which is identical to the cross product (6.9) apart from its sign. Therefore, we can
state:
a √ó b = ‚àíI123(a ‚àßb).
6.17 The Relationship Between Quaternions and Bivectors
Hamilton‚Äôs rules for the imaginaries i, j and k are shown in Table 6.1, whilst Ta-
ble 6.2 shows the rules for 3D bivector products. Although there is some agreement
between the table entries, there is a sign reversal in some of them. However, if we
switch to a left-handed axial system the bivectors become e32, e13, e21 and their
products are as shown in Table 6.3. If we now create a one-to-one correspondence
(isomorphism) between the two systems:
i ‚Üîe32,
j ‚Üîe13,
k ‚Üîe21
there is a true correspondence between quaternions and a left-handed set of bivec-
tors.

82
6
Multivectors
Table 6.2 3D bivector
product rules
e23
e31
e12
e23
‚àí1
‚àíe12
e31
e31
e12
‚àí1
‚àíe23
e12
‚àíe31
e23
‚àí1
Table 6.3 Left-handed 3D
bivector product rules
e32
e13
e21
e32
‚àí1
e21
‚àíe13
e13
‚àíe21
‚àí1
e32
e21
e13
‚àíe32
‚àí1
6.18 Reverse of a Multivector
You will have noticed how sensitive geometric algebra is to the sequence of vectors,
and it should not be too much of a surprise to learn that a special function exists to
reverse sequences of elements. For example, given
A = ab
the reverse of A is denoted using the dagger symbol A‚Ä†
A‚Ä† = ba
or the tilde symbol ÀúA
ÀúA = ba.
The dagger symbol is used in this book.
Obviously, scalars are unaffected by reversion, neither are vectors. However,
bivectors and trivectors Ô¨Çip their signs:
(e1e2)‚Ä† = e2e1 = ‚àíe1e2
and
(e1e2e3)‚Ä† = e3e2e1 = ‚àíe1e2e3.
When reversing a multivector containing terms up to a trivector, it‚Äôs only the bivector
and trivector terms that are reversed. For example, given a multivector A
A = Œª + v + B + T
where
Œª is a scalar
v is a vector
B is a bivector, and
T is a trivector

6.19
Summary
83
then
A‚Ä† = Œª + v ‚àíB ‚àíT.
Let‚Äôs illustrate this reversion process with an example.
Given three vectors
a = 2e1 + 3e2
b = 4e1 ‚àí2e2
c = e1 + e2
the products ab and ba are
ab = (2e1 + 3e2)(4e1 ‚àí2e2) = 2 ‚àí16e12
ba = (4e1 ‚àí2e2)(2e1 + 3e2) = 2 + 16e12.
Thus
(ab)‚Ä† = ba.
Furthermore, the products abc and cba are
abc = (2e1 + 3e2)(4e1 ‚àí2e2)(e1 + e2) = ‚àí14e1 + 18e2
cba = (e1 + e2)(4e1 ‚àí2e2)(2e1 + 3e2) = ‚àí14e1 + 18e2.
And as there are only vectors terms there are no sign changes.
Reversion plays an important role in rotors and we will meet them again in the
next chapter.
6.19 Summary
This chapter has covered the basic ideas behind geometric algebra which offers
an algebraic framework for oriented lines (vectors), oriented planes (bivectors) and
oriented volumes (trivectors), not to mention higher dimensional objects. We have
yet to discover how they offer an alternative way of rotating points in the plane and
in 3D space.
6.19.1 Summary of Multivector Operations
Inner product: 2D vectors
a = a1e1 + a2e2
b = b1e1 + b2e2
a ¬∑ b = |a||b|cosŒ≤ = a1b1 + a2b2.

84
6
Multivectors
Inner product: 3D vectors
a = a1e1 + a2e2 + a3e3
b = b1e1 + b2e2 + b3e3
a ¬∑ b = |a||b|cosŒ≤ = a1b1 + a2b2 + a3b3.
Outer product: 2D vectors
a = a1e1 + a2e2
b = b1e1 + b2e2
a ‚àßb =

a1
a2
b1
b2
e1 ‚àße2.
Outer product: 3D vectors
a = a1e1 + a2e2 + a3e3
b = b1e1 + b2e2 + b3e3
c = c1e1 + c2e2 + c3e3
a ‚àßb =

a1
a2
b1
b2
e1 ‚àße2 +

a2
a3
b2
b3
e2 ‚àße3 +

a3
a1
b3
b1
e3 ‚àße1
a ‚àßb ‚àßc =

a1
a2
a3
b1
b2
b3
c1
c2
c3

e1 ‚àße2 ‚àße3
|a ‚àßb| = |a||b|sinŒ≤.
Geometric product
ab = a ¬∑ b + a ‚àßb
ba = a ¬∑ b ‚àía ‚àßb
a ¬∑ b = 1
2(ab + ba)
a ‚àßb = 1
2(ab ‚àíba).
Inverse of a vector
a‚àí1 =
a
|a|2 .
Duality
A‚ãÜ= IA
I = the local pseudoscalar.
Reverse of a multivector
A = ab
A‚Ä† = ba.

Chapter 7
Rotation Transforms in the Plane
7.1 Introduction
In this chapter we investigate the techniques for rotating points in the plane using
geometry, matrices and multivectors. These ideas will be developed further in the
next chapter where we consider rotating frames of reference in the plane.
7.2 2D Transforms
2D transforms are used to scale, translate, rotate, reÔ¨Çect and shear shapes. For ex-
ample, a point P(x,y) is transformed into P ‚Ä≤(x‚Ä≤,y‚Ä≤) by modifying x and y using
x‚Ä≤ = ax + by
y‚Ä≤ = cx + dy.
By using different values for a,b,c and d we can scale, shear, reÔ¨Çect or rotate a
point about the origin. However, this transform cannot effect a translation as we
need to increment both x and y by values which are spatial offsets. To achieve this
we employ homogeneous coordinates.
7.2.1 Homogeneous Coordinates
Homogeneous coordinates are used to deÔ¨Åne a point in the plane using three coordi-
nates instead of two. This means that for a point (x,y) there exists a homogeneous
point (xt,yt,t) where t is an arbitrary number. The values of x and y are found by
dividing xt and yt by t. For example, the point (2,3) has homogeneous coordinates
(4,6,2), because (4/2,6/2,2/2) = (2,3,1). But the homogeneous point (4,6,2)
is not unique to (2,3) ‚Äì (8,12,4), (10,15,5) and (200,300,100) are all possible
homogeneous coordinates for (2,3).
J. Vince, Rotation Transforms for Computer Graphics,
DOI 10.1007/978-0-85729-154-7_7, ¬© Springer-Verlag London Limited 2011
85

86
7
Rotation Transforms in the Plane
Fig. 7.1 2D homogeneous
coordinates can be visualised
as a plane in 3D space where
t = 1, for convenience
For our purposes we can imagine that a collection of homogeneous points of
the form (xt,yt,t) exist on an xy-plane where t is the z-coordinate as illustrated
in Fig. 7.1. The Ô¨Ågure shows a triangle on the t = 1 plane, and a similar, larger
triangle on a more distant plane. Thus, instead of working in two dimensions, we
can work on an arbitrary xy-plane in three dimensions. The t-coordinate of the plane
is immaterial because the x- and y-coordinates are eventually scaled by t. To keep
things simple it is convenient to choose t = 1, which means that the point (x,y) has
homogeneous coordinates (x,y,1) making scaling unnecessary.
If we substitute 3D homogeneous coordinates for traditional 2D Cartesian coor-
dinates we must attach 1 to every (x,y) pair. When a point (x,y,1) is transformed,
it emerges as (x‚Ä≤,y‚Ä≤,1), and we discard the 1. This may seem a futile exercise, but
it resolves the problem of creating a translation transform.
Consider the following transform on the homogeneous point (x,y,1):
x‚Ä≤ = ax + by + e
y‚Ä≤ = cx + dy + f
this is represented in matrix form as
‚é°
‚é£
x‚Ä≤
y‚Ä≤
1
‚é§
‚é¶=
‚é°
‚é£
a
b
e
c
d
f
0
0
1
‚é§
‚é¶
‚é°
‚é£
x
y
1
‚é§
‚é¶
and resolves the problem of translation by adding e and f to x‚Ä≤ and y‚Ä≤ respectively.
However, this has to be paid for in terms of extra memory required to store the larger
matrix.
7.3 Matrix Transforms
In this section we investigate strategies for designing matrix transforms to translate
and rotate points about the origin and an arbitrary point. We will also see how the
inverse transform is used to establish new frames of reference.

7.3
Matrix Transforms
87
Fig. 7.2 The point P (x,y) is
rotated through an angle Œ≤ to
P ‚Ä≤(x‚Ä≤,y‚Ä≤)
7.3.1 Translate a Point
Perhaps the simplest transform is that of point translation. For example, to translate
a point P(x,y) by (tx,ty), we only require
x‚Ä≤ = x + tx
y‚Ä≤ = y + ty
which is represented by this homogeneous matrix
‚é°
‚é£
x‚Ä≤
y‚Ä≤
1
‚é§
‚é¶=
‚é°
‚é£
1
0
tx
0
1
ty
0
0
1
‚é§
‚é¶
‚é°
‚é£
x
y
1
‚é§
‚é¶.
We will refer to this translate matrix as Ttx,ty.
As an example, let‚Äôs translate the point P(2,3) by (4,5), which moves it to
P ‚Ä≤(6,8):
‚é°
‚é£
6
8
1
‚é§
‚é¶=
‚é°
‚é£
1
0
4
0
1
5
0
0
1
‚é§
‚é¶
‚é°
‚é£
2
3
1
‚é§
‚é¶.
7.3.2 Rotate a Point About the Origin
Figure 7.2 shows a point P(x,y) which is rotated an angle Œ≤ about the origin to
P ‚Ä≤(x‚Ä≤,y‚Ä≤), and as we are dealing with a pure rotation, both P ‚Ä≤ and P are distance R
from the origin.
From Fig. 7.2 it can be seen that
cosŒ∏ = x/R
sinŒ∏ = y/R
x‚Ä≤ = R cos(Œ∏ + Œ≤)
y‚Ä≤ = R sin(Œ∏ + Œ≤)

88
7
Rotation Transforms in the Plane
and substituting the identities for cos(Œ∏ + Œ≤) and sin(Œ∏ + Œ≤) we have
x‚Ä≤ = R (cosŒ∏ cosŒ≤ ‚àísinŒ∏ sinŒ≤)
= R
 x
R cosŒ≤ ‚àíy
R sinŒ≤

= x cosŒ≤ ‚àíy sinŒ≤
y‚Ä≤ = R (sinŒ∏ cosŒ≤ + cosŒ∏ sinŒ≤)
= R
 y
R cosŒ≤ + x
R sinŒ≤

= x sinŒ≤ + y cosŒ≤
or in matrix form
‚é°
‚é£
x‚Ä≤
y‚Ä≤
1
‚é§
‚é¶=
‚é°
‚é£
cosŒ≤
‚àísinŒ≤
0
sinŒ≤
cosŒ≤
0
0
0
1
‚é§
‚é¶
‚é°
‚é£
x
y
1
‚é§
‚é¶
and is the homogeneous transform for rotating points about the origin. For example,
to rotate a point 90¬∞ about the origin the transform becomes
‚é°
‚é£
0
1
1
‚é§
‚é¶=
‚é°
‚é£
0
‚àí1
0
1
0
0
0
0
1
‚é§
‚é¶
‚é°
‚é£
1
0
1
‚é§
‚é¶
where we see the point (1,0,1) becomes (0,1,1) and we ignore the homogeneous
scaling factor of 1.
Rotating a point 360¬∞ about the origin the transform becomes the identity matrix:
‚é°
‚é£
x‚Ä≤
y‚Ä≤
1
‚é§
‚é¶=
‚é°
‚é£
1
0
0
0
1
0
0
0
1
‚é§
‚é¶
‚é°
‚é£
x
y
1
‚é§
‚é¶.
The following observations can be made about the rotation matrix RŒ≤:
RŒ≤ =
‚é°
‚é£
cosŒ≤
‚àísinŒ≤
0
sinŒ≤
cosŒ≤
0
0
0
1
‚é§
‚é¶.
Its determinant equals 1:
detRŒ≤ = cos2 Œ≤ + sin2 Œ≤ = 1.
Its transpose is
RT
Œ≤ =
‚é°
‚é£
cosŒ≤
sinŒ≤
0
‚àísinŒ≤
cosŒ≤
0
0
0
1
‚é§
‚é¶.
The product RŒ≤RT
Œ≤ = I:
RŒ≤RT
Œ≤ =
‚é°
‚é£
cosŒ≤
‚àísinŒ≤
0
sinŒ≤
cosŒ≤
0
0
0
1
‚é§
‚é¶
‚é°
‚é£
cosŒ≤
sinŒ≤
0
‚àísinŒ≤
cosŒ≤
0
0
0
1
‚é§
‚é¶=
‚é°
‚é£
1
0
0
0
1
0
0
0
1
‚é§
‚é¶

7.3
Matrix Transforms
89
and because RŒ≤RT
Œ≤ equals the identity matrix, R‚àí1
Œ≤
= RT
Œ≤:
R‚àí1
Œ≤
=
‚é°
‚é£
cosŒ≤
sinŒ≤
0
‚àísinŒ≤
cosŒ≤
0
0
0
1
‚é§
‚é¶
conÔ¨Årms that RŒ≤ is orthogonal.
7.3.3 Rotate a Point About an Arbitrary Point
Now let‚Äôs see how to rotate a point (x,y) about an arbitrary point (tx,ty). The
strategy involves making the point of rotation a temporary origin, which is achieved
by subtracting (tx,ty) from the coordinates (x,y) respectively. Next, we perform a
rotation about the temporary origin, and Ô¨Ånally, we add (tx,ty) back to the rotated
point to compensate for the original subtraction. Here are the steps:
1. Subtract (tx,ty) to create a new temporary origin:
x1 = x ‚àítx
y1 = y ‚àíty.
2. Rotate (x1,y1) about the temporary origin by Œ≤:
x2 = (x ‚àítx)cosŒ≤ ‚àí(y ‚àíty)sinŒ≤
y2 = (x ‚àítx)sinŒ≤ + (y ‚àíty)cosŒ≤.
3. Add (tx,ty) to the rotated point (x2,y2) to return to the original origin:
x‚Ä≤ = x2 + tx
y‚Ä≤ = y2 + ty
x‚Ä≤ = (x ‚àítx)cosŒ≤ ‚àí(y ‚àíty)sinŒ≤ + tx
y‚Ä≤ = (x ‚àítx)sinŒ≤ + (y ‚àíty)cosŒ≤ + ty.
Simplifying, we obtain
x‚Ä≤ = x cosŒ≤ ‚àíy sinŒ≤ + tx(1 ‚àícosŒ≤) + ty sinŒ≤
y‚Ä≤ = x sinŒ≤ + y cosŒ≤ + ty(1 ‚àícosŒ≤) ‚àítx sinŒ≤
and in matrix form we have
‚é°
‚é£
x‚Ä≤
y‚Ä≤
1
‚é§
‚é¶=
‚é°
‚é£
cosŒ≤
‚àísinŒ≤
tx (1 ‚àícosŒ≤) + ty sinŒ≤
sinŒ≤
cosŒ≤
ty (1 ‚àícosŒ≤) ‚àítx sinŒ≤
0
0
1
‚é§
‚é¶
‚é°
‚é£
x
y
1
‚é§
‚é¶.
(7.1)
For example, if we rotate the point (2,1), 90¬∞ about the point (1,1) the transform
(7.1) becomes
‚é°
‚é£
1
2
1
‚é§
‚é¶=
‚é°
‚é£
0
‚àí1
2
1
0
0
0
0
1
‚é§
‚é¶
‚é°
‚é£
2
1
1
‚é§
‚é¶.

90
7
Rotation Transforms in the Plane
The above algebraic approach to derive the rotation transform is relatively easy.
However, it is also possible to use matrices to derive composite transforms, such as
a reÔ¨Çection relative to an arbitrary line or scaling and rotation relative to an arbitrary
point. All of these linear transforms are called afÔ¨Åne transforms, as parallel lines
remain parallel after being transformed. Furthermore, the word ‚ÄòafÔ¨Åne‚Äô is used to
imply that there is a strong geometric afÔ¨Ånity between the original and transformed
shape. One cannot always guarantee that angles and lengths are preserved, as these
can change when different scaling factors are used. For completeness, let‚Äôs derive
the above transform using matrices.
A transform for rotating a point Œ≤ about the origin is given by
RŒ≤ =
‚é°
‚é£
cosŒ≤
‚àísinŒ≤
0
sinŒ≤
cosŒ≤
0
0
0
1
‚é§
‚é¶
and a transform for translating a point (tx,ty) relative to the origin is given by
Ttx,ty =
‚é°
‚é£
1
0
tx
0
1
ty
0
0
1
‚é§
‚é¶.
We can use RŒ≤ and Ttx,ty to develop a composite transform for rotating a point about
an arbitrary point (tx,ty) as follows:
‚é°
‚é£
x‚Ä≤
y‚Ä≤
1
‚é§
‚é¶= Ttx,tyRŒ≤T‚àítx,‚àíty
‚é°
‚é£
x
y
1
‚é§
‚é¶
(7.2)
where
T‚àítx,‚àíty
creates a temporary origin
RŒ≤
rotates Œ≤ about the origin
Ttx,ty
returns to the original position.
Note that the transform sequence starts on the right next to the original coordinates,
working leftwards.
Equation (7.2) expands to
‚é°
‚é£
x‚Ä≤
y‚Ä≤
1
‚é§
‚é¶=
‚é°
‚é£
1
0
tx
0
1
ty
0
0
1
‚é§
‚é¶
‚é°
‚é£
cosŒ≤
‚àísinŒ≤
0
sinŒ≤
cosŒ≤
0
0
0
1
‚é§
‚é¶
‚é°
‚é£
1
0
‚àítx
0
1
‚àíty
0
0
1
‚é§
‚é¶
‚é°
‚é£
x
y
1
‚é§
‚é¶.
Next, we multiply these matrices together to form a single matrix. Let‚Äôs begin by
multiplying the RŒ≤ and T‚àítx,‚àíty matrices, which produces
‚é°
‚é£
x‚Ä≤
y‚Ä≤
1
‚é§
‚é¶=
‚é°
‚é£
1
0
tx
0
1
ty
0
0
1
‚é§
‚é¶
‚é°
‚é£
cosŒ≤
‚àísinŒ≤
‚àítx cosŒ≤ + ty sinŒ≤
sinŒ≤
cosŒ≤
‚àítx sinŒ≤ ‚àíty cosŒ≤
0
0
1
‚é§
‚é¶
‚é°
‚é£
x
y
1
‚é§
‚é¶
and Ô¨Ånally we obtain
‚é°
‚é£
x‚Ä≤
y‚Ä≤
1
‚é§
‚é¶=
‚é°
‚é£
cosŒ≤
‚àísinŒ≤
tx (1 ‚àícosŒ≤) + ty sinŒ≤
sinŒ≤
cosŒ≤
ty (1 ‚àícosŒ≤) ‚àítx sinŒ≤
0
0
1
‚é§
‚é¶
‚é°
‚é£
x
y
1
‚é§
‚é¶
which is the same as the previous transform (7.1).

7.3
Matrix Transforms
91
7.3.4 Rotate and Translate a Point
There are two ways we can combine the rotate and translate transforms into a single
transform. The Ô¨Årst method starts by translating a point P(x,y) using T(tx,ty) to an
intermediate point, which is then rotated using RŒ≤. The problem with this strategy
is that the radius of rotation becomes large and subjects the point to a large circular
motion. The normal way is to Ô¨Årst subject the point to a rotation about the origin
and then translate it:
P ‚Ä≤ = Ttx,tyRŒ≤P
‚é°
‚é£
x‚Ä≤
y‚Ä≤
1
‚é§
‚é¶=
‚é°
‚é£
1
0
tx
0
1
ty
0
0
1
‚é§
‚é¶
‚é°
‚é£
cosŒ≤
‚àísinŒ≤
0
sinŒ≤
cosŒ≤
0
0
0
1
‚é§
‚é¶
‚é°
‚é£
x
y
1
‚é§
‚é¶
‚é°
‚é£
x‚Ä≤
y‚Ä≤
1
‚é§
‚é¶=
‚é°
‚é£
cosŒ≤
‚àísinŒ≤
tx
sinŒ≤
cosŒ≤
ty
0
0
1
‚é§
‚é¶
‚é°
‚é£
x
y
1
‚é§
‚é¶.
For example, consider rotating the point P(1,0), 90¬∞ and then translating it by
(1,0). The rotation moves P to (0,1) and the translation moves it to (1,1). This is
conÔ¨Årmed by the above transform:
‚é°
‚é£
1
1
1
‚é§
‚é¶=
‚é°
‚é£
0
‚àí1
1
1
0
0
0
0
1
‚é§
‚é¶
‚é°
‚é£
1
0
1
‚é§
‚é¶.
7.3.5 Composite Rotations
It is worth conÔ¨Årming that if we rotate a point Œ≤ about the origin, and follow this
by a rotation of Œ∏, this is equivalent to a single rotation of Œ∏ + Œ≤, so RŒ∏RŒ≤ = RŒ∏+Œ≤.
Let‚Äôs start with the transforms RŒ≤ and RŒ∏:
RŒ≤ =
‚é°
‚é£
cosŒ≤
‚àísinŒ≤
0
sinŒ≤
cosŒ≤
0
0
0
1
‚é§
‚é¶
RŒ∏ =
‚é°
‚é£
cosŒ∏
‚àísinŒ∏
0
sinŒ∏
cosŒ∏
0
0
0
1
‚é§
‚é¶.
We can represent the double rotation by the product RŒ∏RŒ≤:
RŒ∏RŒ≤ =
‚é°
‚é£
cosŒ∏
‚àísinŒ∏
0
sinŒ∏
cosŒ∏
0
0
0
1
‚é§
‚é¶
‚é°
‚é£
cosŒ≤
‚àísinŒ≤
0
sinŒ≤
cosŒ≤
0
0
0
1
‚é§
‚é¶

92
7
Rotation Transforms in the Plane
=
‚é°
‚é£
cosŒ∏ cosŒ≤ ‚àísinŒ∏ sinŒ≤
‚àícosŒ∏ sinŒ≤ ‚àísinŒ∏ cosŒ≤
0
sinŒ∏ cosŒ≤ + cosŒ∏ sinŒ≤
‚àísinŒ∏ sinŒ≤ + cosŒ∏ cosŒ≤
0
0
0
1
‚é§
‚é¶
=
‚é°
‚é£
cos(Œ∏ + Œ≤)
‚àísin(Œ∏ + Œ≤)
0
sin(Œ∏ + Œ≤)
cos(Œ∏ + Œ≤)
0
0
0
1
‚é§
‚é¶
which conÔ¨Årms that the composite rotation is equivalent to a single rotation of Œ∏ +Œ≤.
7.4 Inverse Transforms
Given a transform A, its inverse A‚àí1 is deÔ¨Åned as such that
AA‚àí1 = A‚àí1A = I
where I is the identity matrix. So let‚Äôs identify the inverse translation and rotation
transforms.
We know that the translation matrix is given by
Ttx,ty =
‚é°
‚é£
1
0
tx
0
1
ty
0
0
1
‚é§
‚é¶
and we could reason that the inverse of Ttx,ty must be a translation in the opposite
direction:
T‚àí1
tx,ty =
‚é°
‚é£
1
0
‚àítx
0
1
‚àíty
0
0
1
‚é§
‚é¶.
We can conÔ¨Årm this by computing T‚àí1
tx,ty from the cofactor matrix of Ttx,ty, trans-
posing it and dividing by its determinant:
cofactor matrix of Ttx,ty =
‚é°
‚é£
1
0
0
0
1
0
‚àítx
‚àíty
1
‚é§
‚é¶
TT
tx,ty =
‚é°
‚é£
1
0
‚àítx
0
1
‚àíty
0
0
1
‚é§
‚é¶
and as detTtx,ty = 1, we can write
T‚àí1
tx,ty =
‚é°
‚é£
1
0
‚àítx
0
1
‚àíty
0
0
1
‚é§
‚é¶.
So our reasoning is correct. Furthermore, Ttx,tyT‚àí1
tx,ty = I:
Ttx,tyT‚àí1
tx,ty =
‚é°
‚é£
1
0
tx
0
1
ty
0
0
1
‚é§
‚é¶
‚é°
‚é£
1
0
‚àítx
0
1
‚àíty
0
0
1
‚é§
‚é¶=
‚é°
‚é£
1
0
0
0
1
0
0
0
1
‚é§
‚é¶.

7.5
Multivector Transforms
93
Similarly, we know that the rotation transform is given by
RŒ≤ =
‚é°
‚é£
cosŒ≤
‚àísinŒ≤
0
sinŒ≤
cosŒ≤
0
0
0
1
‚é§
‚é¶
and we can reason that the inverse of RŒ≤ must be a rotation in the opposite direction,
i.e. a rotation of ‚àíŒ≤:
R‚àí1
Œ≤ =
‚é°
‚é£
cosŒ≤
sinŒ≤
0
‚àísinŒ≤
cosŒ≤
0
0
0
1
‚é§
‚é¶.
We can also compute R‚àí1
Œ≤
by forming the cofactor matrix of RŒ≤, transposing it and
dividing by its determinant:
cofactor matrix of RŒ≤ =
‚é°
‚é£
cosŒ≤
‚àísinŒ≤
0
sinŒ≤
cosŒ≤
0
0
0
1
‚é§
‚é¶
RT
Œ≤ =
‚é°
‚é£
cosŒ≤
sinŒ≤
0
‚àísinŒ≤
cosŒ≤
0
0
0
1
‚é§
‚é¶
and as detRŒ≤ = 1, we can write
R‚àí1
Œ≤ =
‚é°
‚é£
cosŒ≤
sinŒ≤
0
‚àísinŒ≤
cosŒ≤
0
0
0
1
‚é§
‚é¶.
So our reasoning is correct. Furthermore, RŒ≤R‚àí1
Œ≤ = I:
RŒ≤R‚àí1
Œ≤
=
‚é°
‚é£
cosŒ≤
‚àísinŒ≤
0
sinŒ≤
cosŒ≤
0
0
0
1
‚é§
‚é¶
‚é°
‚é£
cosŒ≤
sinŒ≤
0
‚àísinŒ≤
cosŒ≤
0
0
0
1
‚é§
‚é¶=
‚é°
‚é£
1
0
0
0
1
0
0
0
1
‚é§
‚é¶.
7.5 Multivector Transforms
Multivectors are linear combinations of vectors, bivectors, trivectors, etc., plus a
scalar. They possess imaginary qualities and consequently have the ability to rotate
vectors. Although it is unusual to employ multivectors in 2D computer graphics,
they have been included to introduce their rotational qualities.
7.5.1 Translate a Point
Figure 7.3 shows a point P(x,y) with position vector p, and is translated by (tx,ty)
using
p‚Ä≤ = p + t

94
7
Rotation Transforms in the Plane
Fig. 7.3 Translate a point by
(tx,ty)
where t = [tx
ty]T. The position vector p‚Ä≤ points to the translated point P ‚Ä≤ with
components:
p‚Ä≤ = (x + tx)e1 +

y + ty
	
e2
and agrees with the translation matrix
‚é°
‚é£
x‚Ä≤
y‚Ä≤
1
‚é§
‚é¶=
‚é°
‚é£
1
0
tx
0
1
ty
0
0
1
‚é§
‚é¶
‚é°
‚é£
x
y
1
‚é§
‚é¶.
7.5.2 Rotational Qualities of the Unit Bivector
We know from Chap. 2 that multiplying a complex number by imaginary i rotates
that complex number by 90¬∞. In geometric algebra the 2D pseudoscalar e12 is also
imaginary in that e2
12 = ‚àí1, and has similar rotational properties, but has the extra
feature of controlling the direction of rotation. For example, Fig. 7.4 shows pe12
which rotates p, 90¬∞:
p = p1e1 + p2e2
pe12 = (p1e1 + p2e2)e12
= p1e2 ‚àíp2e1
= ‚àíp2e1 + p1e2.
Fig. 7.4 pe12 rotates p, 90¬∞

7.5
Multivector Transforms
95
Fig. 7.5 e12p rotates p, ‚àí90¬∞
However, the reverse product e12p rotates p, ‚àí90¬∞:
p = p1e1 + p2e2
pe12 = e12 (p1e1 + p2e2)
= ‚àíp1e2 + p2e1
= p2e1 ‚àíp1e2
as shown in Fig. 7.5.
We also discovered in Chap. 2 that a complex number z = a + bi can be repre-
sented in exponential form as
z = |z|eiŒ≤ = |z|(cosŒ≤ + i sinŒ≤)
which, if used to multiply another complex number, scales it by |z| and rotates it Œ≤.
Figure 7.6 shows a plane deÔ¨Åned by m ‚àßn and the vectors n and m such that n
is rotated Œ≤ further than m:
n = n1e1 + n2e2
m = m1e1 + m2e2
nm = n ¬∑ m ‚àím ‚àßn
= |n||m|cosŒ≤ ‚àí|m||n|sinŒ≤e12
= |n||m|(cosŒ≤ ‚àísinŒ≤e12).
Fig. 7.6 The bivector m ‚àßn

96
7
Rotation Transforms in the Plane
Pre-multiplying a vector p by the product nm creates p‚Ä≤ such that given:
p = p1e1 + p2e2
nmp = |n||m|(cosŒ≤ ‚àísinŒ≤e12)(p1e1 + p2e2)
= |n||m|(cosŒ≤p1e1 + cosŒ≤p2e2 + sinŒ≤p1e2 ‚àísinŒ≤p2e1)
p‚Ä≤ = |n||m|

(cosŒ≤p1 ‚àísinŒ≤p2)e1 + (sinŒ≤p1 + cosŒ≤p2)e2


p‚Ä≤
1
p‚Ä≤
2

= |n||m|
cosŒ≤
‚àísinŒ≤
sinŒ≤
cosŒ≤
p1
p2

and conÔ¨Årms that the vector p is rotated Œ≤ and scaled by |n||m|.
Post-multiplying a vector p by the product nm creates p‚Ä≤ such that given:
p = p1e1 + p2e2
pnm = (p1e1 + p2e2)|n||m|(cosŒ≤ ‚àísinŒ≤e12)
= |n||m|(p1e1 cosŒ≤ ‚àíp1e2 sinŒ≤ + p2e2 cosŒ≤ + p2e1 sinŒ≤)
p‚Ä≤ = |n||m|

(p1 cosŒ≤ + p2 sinŒ≤)e1 + (‚àíp1 sinŒ≤ + p2 cosŒ≤)e2
	

p‚Ä≤
1
p‚Ä≤
2

= |n||m|

cosŒ≤
sinŒ≤
‚àísinŒ≤
cosŒ≤
p1
p2

and conÔ¨Årms that the vector p is rotated ‚àíŒ≤ and scaled by |n||m|. By making n
and m unit vectors, the product nm rotates a vector without scaling, which is an
essential quality for a rotation transform.
Before proceeding, we should clarify the effect of reversing the product nm to
mn. Therefore, assuming that vectors n and m remain unchanged, the product mn
is given by:
n = n1e1 + n2e2
m = m1e1 + m2e2
mn = m ¬∑ n + m ‚àßn
= |n||m|cosŒ≤ + |m||n|sinŒ≤e12
= |n||m|(cosŒ≤ + sinŒ≤e12).
Pre-multiplying a vector p by the product mn creates p‚Ä≤ such that given:
p = p1e1 + p2e2
mnp = |n||m|(cosŒ≤ + sinŒ≤e12)(p1e1 + p2e2)
= |n||m|(cosŒ≤p1e1 + cosŒ≤p2e2 ‚àísinŒ≤p1e2 + sinŒ≤p2e1)
p‚Ä≤ = |n||m|

(cosŒ≤p1 + sinŒ≤p2)e1 + (‚àísinŒ≤p1 + cosŒ≤p2)e2
	

p‚Ä≤
1
p‚Ä≤
2

= |n||m|

cosŒ≤
sinŒ≤
‚àísinŒ≤
cosŒ≤
p1
p2

and conÔ¨Årms that the vector p is rotated ‚àíŒ≤ and scaled by |n||m|.

7.5
Multivector Transforms
97
It should be no surprise that post-multiplying a vector p by the product mn rotates
it Œ≤.
The above results are summarised as follows:
nmp = pmn
rotates p,
Œ≤
pnm = mnp
rotates p, ‚àíŒ≤.
7.5.3 Rotate a Point About the Origin
In Chap. 9 on 3D rotations we show the origins of rotors in geometric algebra using
double reÔ¨Çections. The plane containing the vectors n and m is deÔ¨Åned by the wedge
product m ‚àßn, which means we can write the product mn as
mn = m ¬∑ n + m ‚àßn
and the product nm in the same plane as
nm = m ¬∑ n ‚àím ‚àßn
which accounts for the negative sign in the following bivector term
nm = |n||m|(cosŒ≤ ‚àísinŒ≤e12).
Furthermore, if we make n and m unit vectors we can replace them by a rotor RŒ≤
whose magnitude is 1 because
|RŒ≤| =

cos2 Œ≤ + sin2 Œ≤ = 1
therefore no scaling occurs, which means that
RŒ≤p
rotates p,Œ≤
i.e. anticlockwise, and
pRŒ≤
rotates p,‚àíŒ≤
i.e. clockwise.
The effect of this rotor is illustrated as follows:
p = e1 + e2
R45¬∞ = cos45¬∞ ‚àísin45¬∞e12
=
‚àö
2
2 ‚àí
‚àö
2
2 e12
p‚Ä≤ = R45¬∞p =
‚àö
2
2 ‚àí
‚àö
2
2 e12

(e1 + e2)
=
‚àö
2
2 e1 +
‚àö
2
2 e2 +
‚àö
2
2 e2 ‚àí
‚àö
2
2 e1
=
‚àö
2e2
as shown in Fig. 7.7.

98
7
Rotation Transforms in the Plane
Fig. 7.7 The effect of rotor
R45¬∞ on vector p
Similarly, reversing the product to pR45¬∞ we obtain
p‚Ä≤ = pR45¬∞ = (e1 + e2)
‚àö
2
2 ‚àí
‚àö
2
2 e12

=
‚àö
2
2 e1 ‚àí
‚àö
2
2 e2 +
‚àö
2
2 e2 +
‚àö
2
2 e1
=
‚àö
2e1
as shown in Fig. 7.7.
Geometric algebra also employs a reversion function which reverses the sequence
of elements in a multivector by switching the signs of bivector and trivector ele-
ments. Instead of reversing the sequence of p and RŒ≤, we can reverse RŒ≤ using R‚Ä†
Œ≤:
RŒ≤ = cosŒ≤ ‚àísinŒ≤e12
R‚Ä†
Œ≤ = cosŒ≤ + sinŒ≤e12
therefore,
p‚Ä≤ = R‚Ä†
45¬∞p =
‚àö
2
2 +
‚àö
2
2 e12

(e1 + e2)
=
‚àö
2
2 e1 +
‚àö
2
2 e2 ‚àí
‚àö
2
2 e2 +
‚àö
2
2 e1
=
‚àö
2e1
and
p‚Ä≤ = pR‚Ä†
45¬∞ = (e1 + e2)
‚àö
2
2 +
‚àö
2
2 e12

=
‚àö
2
2 e1 +
‚àö
2
2 e2 +
‚àö
2
2 e2 ‚àí
‚àö
2
2 e1
=
‚àö
2e2
which means that

7.5
Multivector Transforms
99
R‚Ä†
Œ≤p
rotates p,‚àíŒ≤
i.e. clockwise
pR‚Ä†
Œ≤
rotates p,Œ≤
i.e. anticlockwise
and
RŒ≤p = pR‚Ä†
Œ≤
pRŒ≤ = R‚Ä†
Œ≤p.
Using the rotor RŒ≤ in a single-sided transformation only works for vectors in the
plane of rotation, which satisÔ¨Åes everything we do in 2D. However, in 3D we have
to employ a double-sided, half-angle formula of the form RŒ≤pR‚Ä†
Œ≤, which is covered
in Chap. 11.
7.5.4 Rotate a Point About an Arbitrary Point
Earlier in this chapter we developed a transform for rotating a point about an ar-
bitrary point. Let‚Äôs show how we can approach the same problem using geometric
algebra. Figure 7.8 shows the geometry describing how the point P is rotated Œ≤
about T to P ‚Ä≤, and by inspection we can write
p‚Ä≤ = t + RŒ≤ (p ‚àít).
Using the previous example, where T = (1,1),P = (2,1) and Œ≤ = 90¬∞ we have
R90¬∞ = cos90¬∞ ‚àísin90¬∞e12 = ‚àíe12
t = e1 + e2
p = 2e1 + e2
p‚Ä≤ = e1 + e2 ‚àíe12 (2e1 + e2 ‚àíe1 ‚àíe2)
= e1 + e2 ‚àíe12e1
= e1 + e2 + e2
= e1 + 2e2
which is correct.
Fig. 7.8 Using a rotor RŒ≤ to
rotate P about T

100
7
Rotation Transforms in the Plane
If we expand the deÔ¨Ånition of p‚Ä≤ we obtain:
p‚Ä≤ = t + RŒ≤ (p ‚àít)
= txe1 + tye2 + (cosŒ≤ ‚àísinŒ≤e12)

(x ‚àítx)e1 + (y ‚àíty)e2
	
= txe1 + tye2 +

x cosŒ≤ ‚àíy sinŒ≤ ‚àítx cosŒ≤ + ty sinŒ≤
	
e1
+ (x sinŒ≤ + y cosŒ≤ ‚àítx sinŒ≤ ‚àíty cosŒ≤)e2
=

x cosŒ≤ ‚àíy sinŒ≤ + tx (1 ‚àícosŒ≤) + ty sinŒ≤
	
e1
+

x sinŒ≤ + y cosŒ≤ + ty (1 ‚àícosŒ≤) ‚àítx sinŒ≤
	
e2
which in matrix form is
‚é°
‚é£
x‚Ä≤
y‚Ä≤
1
‚é§
‚é¶=
‚é°
‚é£
cosŒ≤
‚àísinŒ≤
tx (1 ‚àícosŒ≤) + ty sinŒ≤
sinŒ≤
cosŒ≤
ty (1 ‚àícosŒ≤) ‚àítx sinŒ≤
0
0
1
‚é§
‚é¶
‚é°
‚é£
x
y
1
‚é§
‚é¶
and agrees with the original transform (7.1).
7.6 Summary
In this chapter we have seen how the translation and rotation transforms are used
to rotate points about the origin and arbitrary points. We have also seen how the
inverse transforms translate and rotate in the opposite directions which will be used
in the next chapter to relate points in different frames of reference.
We have also seen how multivectors provide an alternative approach based upon
vectors, bivectors and rotors, and can undertake the same tasks. However, we have
discovered that fundamentally they are matrix transforms in disguise, albeit, an ef-
fective one.
In order to show the patterns that exist between these two mathematical ap-
proaches, all the commands are summarised.
7.6.1 Summary of Matrix Transforms
Translate a point
Ttx,ty =
‚é°
‚é£
1
0
tx
0
1
ty
0
0
1
‚é§
‚é¶.
Rotate a point
RŒ≤ =
‚é°
‚é£
cosŒ≤
‚àísinŒ≤
0
sinŒ≤
cosŒ≤
0
0
0
1
‚é§
‚é¶.

7.6
Summary
101
Rotate a point about (tx,ty)
Ttx,tyRŒ≤T‚àítx,‚àíty =
‚é°
‚é£
cosŒ≤
‚àísinŒ≤
tx (1 ‚àícosŒ≤) + ty sinŒ≤
sinŒ≤
cosŒ≤
ty (1 ‚àícosŒ≤) ‚àítx sinŒ≤
0
0
1
‚é§
‚é¶.
7.6.2 Summary of Multivector Transforms
Rotor deÔ¨Ånition
RŒ≤ = cosŒ≤ ‚àísinŒ≤e12
R‚Ä†
Œ≤ = cosŒ≤ + sinŒ≤e12.
Translate a point
p‚Ä≤ = p + t = (x + tx)e1 + (y + ty)e2.
Rotate a point
p‚Ä≤ = RŒ≤p = (cosŒ≤ ‚àísinŒ≤e12)(xe1 + ye2)
p‚Ä≤ = pR‚Ä†
Œ≤ = (xe1 + ye2)(cosŒ≤ + sinŒ≤e12).
Rotate a point about (tx,ty)
p‚Ä≤ = t + RŒ≤ (p ‚àít) = txe1 + tye2 + (cosŒ≤ ‚àísinŒ≤e12)

(x ‚àítx)e1 + (y ‚àíty)e2
	
p‚Ä≤ = t + (p ‚àít)R‚Ä†
Œ≤ = txe1 + tye2 +

(x ‚àítx)e1 + (y ‚àíty)e2
	
(cosŒ≤ + sinŒ≤e12).


Chapter 8
Frames of Reference in the Plane
8.1 Introduction
In the previous chapter we covered the transforms for rotating points in the plane
with respect to a Ô¨Åxed frame of reference. In this chapter we investigate the trans-
forms for computing the coordinates of points in rotated frames of reference using
geometry, matrices and multivectors. We will employ many of the concepts previ-
ously described in order to develop inverse transforms and rotors.
8.2 Frames of Reference
You have probably been on a train waiting to depart from a railway station, and
through the window see another stationary train. Then suddenly you notice move-
ment. To begin with, it is difÔ¨Åcult to decide which train is moving, and the problem
is often resolved when the entire scenario is seen with reference to some Ô¨Åxed object
such as a tree or a building. This phenomena reminds us that motion is relative, and
plays an important role in understanding transforms and frames of reference.
When a frame of reference moves ‚Äì such as a train ‚Äì the relationship between
the seated passengers and the train remains Ô¨Åxed. The only thing that does change
is the relationship between the train and other frames of references such as a tree or
a building.
One can describe the relative motion between the train and a tree by assuming
that the train remains stationary and the tree moves in an equal and opposite direc-
tion. So if the train‚Äôs translation is described by T, the tree‚Äôs translation relative to
the train is described by the inverse transform T‚àí1.
Similarly, the rotation of a swivel chair can be described in two ways. The usual
way is to assume that the swivel chair rotates relative to the desk where it‚Äôs lo-
cated. The relative motion interpretation proposes that the chair is stationary, whilst
the desk rotates in an equal and opposite direction. So if the chair‚Äôs rotation is de-
scribed by R, the desk‚Äôs rotation relative to the chair is described by the inverse
transform R‚àí1.
J. Vince, Rotation Transforms for Computer Graphics,
DOI 10.1007/978-0-85729-154-7_8, ¬© Springer-Verlag London Limited 2011
103

104
8
Frames of Reference in the Plane
Let‚Äôs assume that a tree is located in a 3D frame of reference labelled XYZ and
the train‚Äôs frame of reference is labelled X‚Ä≤Y ‚Ä≤Z‚Ä≤. When the two frames are coinci-
dent, the tree has identical coordinates in both frames. However, if the train‚Äôs frame
X‚Ä≤Y ‚Ä≤Z‚Ä≤ is translated by the transform T relative to XYZ, the tree‚Äôs coordinates rel-
ative to the train have effectively moved in the opposite direction given by T‚àí1.
Similarly, let‚Äôs assume that a desk is located in a frame of reference labelled
XYZ and a chair‚Äôs frame of reference is labelled X‚Ä≤Y ‚Ä≤Z‚Ä≤. When the two frames are
coincident, the desk has identical coordinates in both frames. However, if the chair‚Äôs
frame X‚Ä≤Y ‚Ä≤Z‚Ä≤ is rotated by the transform R relative to XYZ, the desk‚Äôs coordinates
relative to the chair have effectively rotated in the opposite direction given by R‚àí1.
8.3 Matrix Transforms
Having established the equivalence between transforms for moving points in a Ô¨Åxed
frame, and the inverse transforms for Ô¨Åxed points in a moving frame, let‚Äôs explore
how we construct the transforms for translated and rotated frames of reference in
the plane. As in the previous chapter, we will show how matrices and multivectors
offer two approaches to this problem.
In computer graphics most frame of reference transforms are expressed by a
translation or a rotation, or a combination of both. We will explore these different
scenarios and develop transforms for converting coordinates in the original frame of
reference to coordinates in the second frame.
8.3.1 Translated Frame of Reference
Figure 8.1 shows two coincident 2D frames of reference X‚Ä≤Y ‚Ä≤ and XY, where a
point in one frame has identical coordinates in the other. Therefore, the two frames
of reference are related as follows
‚é°
‚é£
x‚Ä≤
y‚Ä≤
1
‚é§
‚é¶= I
‚é°
‚é£
x
y
1
‚é§
‚é¶
where I is the identity transform
I =
‚é°
‚é£
1
0
0
0
1
0
0
0
1
‚é§
‚é¶
which ensures that P ‚Ä≤ = P .

8.3
Matrix Transforms
105
Fig. 8.1 The X‚Ä≤Y ‚Ä≤ axial
system is coincident with XY
Fig. 8.2 The X‚Ä≤Y ‚Ä≤ axial
system is translated (tx,ty)
Figure 8.2 shows the frame X‚Ä≤Y ‚Ä≤ translated by (tx,ty) which is equivalent to
translating P by T‚àítx,‚àíty which is also the inverse transform T‚àí1
tx,ty. Therefore,
a point P(x,y) in XY has coordinates P ‚Ä≤(x‚Ä≤,y‚Ä≤) in X‚Ä≤Y ‚Ä≤ given by
‚é°
‚é£
x‚Ä≤
y‚Ä≤
1
‚é§
‚é¶= T‚àí1
tx,ty
‚é°
‚é£
x
y
1
‚é§
‚é¶
where
T‚àí1
tx,ty =
‚é°
‚é£
1
0
‚àítx
0
1
‚àíty
0
0
1
‚é§
‚é¶.
For example, the point (tx,ty) in XY should have coordinates (0,0) in X‚Ä≤Y ‚Ä≤:
‚é°
‚é£
0
0
1
‚é§
‚é¶=
‚é°
‚é£
1
0
‚àítx
0
1
‚àíty
0
0
1
‚é§
‚é¶
‚é°
‚é£
tx
ty
1
‚é§
‚é¶
which is conÔ¨Årmed.

106
8
Frames of Reference in the Plane
Fig. 8.3 The X‚Ä≤Y ‚Ä≤ axial
system is rotated Œ≤
8.3.2 Rotated Frame of Reference
Figure 8.3 shows the frame X‚Ä≤Y ‚Ä≤ rotated Œ≤ which is equivalent to rotating P by
‚àíŒ≤ and is effected by the transform R‚àí1
Œ≤ . Therefore, a point P(x,y) in XY has
coordinates P ‚Ä≤(x‚Ä≤,y‚Ä≤) in X‚Ä≤Y ‚Ä≤ given by
‚é°
‚é£
x‚Ä≤
y‚Ä≤
1
‚é§
‚é¶= R‚àí1
Œ≤
‚é°
‚é£
x
y
1
‚é§
‚é¶
where
R‚àí1
Œ≤ =
‚é°
‚é£
cosŒ≤
sinŒ≤
0
‚àísinŒ≤
cosŒ≤
0
0
0
1
‚é§
‚é¶.
We can also conÔ¨Årm this using the geometry shown in Fig. 8.3,
x = R cosŒ∏
y = R sinŒ∏
x‚Ä≤ = R cos(Œ∏ ‚àíŒ≤)
y‚Ä≤ = R sin(Œ∏ ‚àíŒ≤)
x‚Ä≤ = R cosŒ∏ cosŒ≤ + R sinŒ∏ sinŒ≤
= x cosŒ≤ + y sinŒ≤
y‚Ä≤ = R sinŒ∏ cosŒ≤ ‚àíR cosŒ∏ sinŒ≤
= ‚àíx sinŒ≤ + y cosŒ≤
which as a homogeneous matrix is
‚é°
‚é£
x‚Ä≤
y‚Ä≤
1
‚é§
‚é¶=
‚é°
‚é£
cosŒ≤
sinŒ≤
0
‚àísinŒ≤
cosŒ≤
0
0
0
1
‚é§
‚é¶
‚é°
‚é£
x
y
1
‚é§
‚é¶

8.3
Matrix Transforms
107
which is the inverse rotation transform R‚àí1
Œ≤
or R‚àíŒ≤. For example, the point (1,1)
in XY, will have coordinates (
‚àö
2,0) in the frame of reference rotated 45¬∞:
‚é°
‚é£
‚àö
2
0
1
‚é§
‚é¶=
‚é°
‚é£
‚àö
2/2
‚àö
2/2
0
‚àí
‚àö
2/2
‚àö
2/2
0
0
0
1
‚é§
‚é¶
‚é°
‚é£
1
1
1
‚é§
‚é¶
which is conÔ¨Årmed.
We have previously shown that two separate rotations of a point is equivalent
to a single composite rotation of a point. Similarly, it is a trivial exercise to prove
that two separate rotations of a frame is equivalent to single composite rotation of a
frame.
8.3.3 Rotated and Translated Frame of Reference
Having looked at translated and rotated frames of reference, let‚Äôs combine the two
operations and develop a single transform. This is not too difÔ¨Åcult to follow, so long
as we are careful with our deÔ¨Ånitions and diagrams.
When a point is rotated and translated we use the operation
P ‚Ä≤ = Ttx,tyRŒ≤P.
We know that the transform for moving a frame of reference ‚Äì whilst keeping a point
Ô¨Åxed ‚Äì is the inverse of that used for moving points ‚Äì whilst keeping the frame Ô¨Åxed.
Which suggests that the transform for a rotated and translated frame of reference is
the inverse of Ttx,tyRŒ≤ which is
(Ttx,tyRŒ≤)‚àí1 = R‚àí1
Œ≤ T‚àí1
tx,ty
and makes
P ‚Ä≤ = R‚àí1
Œ≤ T‚àí1
tx,tyP
or
P ‚Ä≤ = R‚àíŒ≤T‚àítx,‚àítyP.
Substituting the matrices for R‚àíŒ≤ and T‚àítx,‚àíty we have
‚é°
‚é£
x‚Ä≤
y‚Ä≤
1
‚é§
‚é¶=
‚é°
‚é£
cosŒ≤
sinŒ≤
0
‚àísinŒ≤
cosŒ≤
0
0
0
1
‚é§
‚é¶
‚é°
‚é£
1
0
‚àítx
0
1
‚àíty
0
0
1
‚é§
‚é¶
‚é°
‚é£
x
y
1
‚é§
‚é¶
which simpliÔ¨Åes to
‚é°
‚é£
x‚Ä≤
y‚Ä≤
1
‚é§
‚é¶=
‚é°
‚é£
cosŒ≤
sinŒ≤
‚àítx cosŒ≤ ‚àíty sinŒ≤
‚àísinŒ≤
cosŒ≤
tx sinŒ≤ ‚àíty cosŒ≤
0
0
1
‚é§
‚é¶
‚é°
‚é£
x
y
1
‚é§
‚é¶.
(8.1)
Equation (8.1) is the homogeneous matrix for converting points in the XY coordi-
nate system to the translated and rotated X‚Ä≤Y ‚Ä≤ coordinate system.

108
8
Frames of Reference in the Plane
Fig. 8.4 The X‚Ä≤Y ‚Ä≤ axial
system translated (tx,ty) and
rotated Œ≤
A quick test conÔ¨Årms that Ttx,tyRŒ≤R‚àí1
Œ≤ T‚àí1
tx,ty = I, i.e.
Ttx,tyRŒ≤R‚àí1
Œ≤ T‚àí1
tx,ty = Ttx,tyT‚àí1
tx,ty = I
or‚é°
‚é£
cosŒ≤
‚àísinŒ≤
tx
sinŒ≤
cosŒ≤
ty
0
0
1
‚é§
‚é¶
‚é°
‚é£
cosŒ≤
sinŒ≤
‚àítx cosŒ≤ ‚àíty sinŒ≤
‚àísinŒ≤
cosŒ≤
tx sinŒ≤ ‚àíty cosŒ≤
0
0
1
‚é§
‚é¶=
‚é°
‚é£
1
0
0
0
1
0
0
0
1
‚é§
‚é¶.
Figure 8.4 shows how the frame of reference XT YT is created for the intermedi-
ate translated frame, followed by a rotation of Œ≤ about the new origin, ending with
the Ô¨Ånal frame of reference X‚Ä≤Y ‚Ä≤.
Let‚Äôs test (8.1) with the example shown in Fig. 8.5 where
Œ≤ = 90¬∞
(tx,ty) = (10,5)
(x,y) = (9,6)
‚é°
‚é£
1
1
1
‚é§
‚é¶=
‚é°
‚é£
0
1
‚àí5
‚àí1
0
10
0
0
1
‚é§
‚é¶
‚é°
‚é£
9
6
1
‚é§
‚é¶
(8.2)
and we see that (9,6) in XY becomes (1,1) in X‚Ä≤Y ‚Ä≤.
Fig. 8.5 The X‚Ä≤Y ‚Ä≤ axial
system is translated (10,5)
and rotated 90¬∞

8.4
Direction Cosines
109
Fig. 8.6 If the X‚Ä≤- and
Y ‚Ä≤-axes are assumed to be
unit vectors, their direction
cosines form the elements of
the rotation matrix
8.4 Direction Cosines
Direction cosines are the cosines of the angles between a vector and the Cartesian
axes, and for a unit vector they are its components.
Figure 8.6 shows the rotated frame X‚Ä≤Y ‚Ä≤, and by inspection the direction cosines
for a vector lying on X‚Ä≤ are cosŒ≤ and cos(90¬∞ ‚àíŒ≤), which can be rewritten as cosŒ≤
and sinŒ≤. The direction cosines for a vector lying on Y ‚Ä≤ are cos(90¬∞ + Œ≤) and cosŒ≤,
which can be rewritten as ‚àísinŒ≤ and cosŒ≤. But these direction cosines cosŒ≤, sinŒ≤,
‚àísinŒ≤ and cosŒ≤ are the four elements of the inverse rotation matrix R‚àí1
Œ≤ :
R‚àí1
Œ≤ =

cosŒ≤
sinŒ≤
‚àísinŒ≤
cosŒ≤

.
The top row contains the direction cosines for the X‚Ä≤-axis and the bottom row con-
tains the direction cosines for the Y ‚Ä≤-axis. This relationship also holds in 3D. Conse-
quently, if we have access to these cosines we can construct a transform that relates
rotated frames of reference.
Figure 8.7 shows an axial system X‚Ä≤Y ‚Ä≤ rotated 45¬∞, and the associated transform
is
‚é°
‚é£
x‚Ä≤
y‚Ä≤
1
‚é§
‚é¶‚âà
‚é°
‚é£
0.707
0.707
0
‚àí0.707
0.707
0
0
0
1
‚é§
‚é¶
‚é°
‚é£
x
y
1
‚é§
‚é¶.
Fig. 8.7 The four vertices of
the unit square shown in both
frames

110
8
Frames of Reference in the Plane
The four vertices on a unit square become
(0,0) ‚Üí(0,0)
(1,0) ‚Üí(0.707,‚àí0.707)
(1,1) ‚Üí(1.1414,0)
(0,1) ‚Üí(0.707,0.707)
which by inspection of Fig. 8.7 are correct.
8.5 Multivector Transforms
Geometric algebra is relatively new compared to other branches of mathematics and
has still not found its way into mainstream computer graphics software. Neverthe-
less, it has been included in this chapter to demonstrate that it can be used alongside
matrix transforms and quaternions.
8.5.1 Translated Frame of Reference
Figure 8.8 shows a frame of reference X‚Ä≤Y ‚Ä≤ translated (tx,ty) relative to the original
frame of reference XY. Therefore, if p points to a point P(x,y) in XY, and t points
to the origin of X‚Ä≤Y ‚Ä≤, then p‚Ä≤ = p ‚àít points to the point P ‚Ä≤(x‚Ä≤,y‚Ä≤) relative to the
X‚Ä≤Y ‚Ä≤ frame of reference, and means that p‚Ä≤ is given by
p‚Ä≤ = (x ‚àítx)e1 + (y ‚àíty)e2.
Fig. 8.8 The X‚Ä≤Y ‚Ä≤ axial
system translated (tx,ty)

8.5
Multivector Transforms
111
Fig. 8.9 Using a rotor R to
rotate XY to X‚Ä≤Y ‚Ä≤
8.5.2 Rotated Frame of Reference
We have already shown that in order to compute the coordinates of a point P in
a rotated frame of reference X‚Ä≤Y ‚Ä≤, we rotate the point by an angle in the opposite
direction as shown in Fig. 8.9 to P ‚Ä≤. Thus if the new frame of reference is rotated Œ≤,
and p is P ‚Äôs position vector, then p‚Ä≤ points to the new point P ‚Ä≤ and is computed as
follows:
p‚Ä≤ = R‚Ä†
Œ≤p
where
R‚Ä†
Œ≤ = cosŒ≤ + sinŒ≤e12.
Let‚Äôs test this with the same example used above by rotating the frame of reference
45¬∞ and computing the coordinates of the point (1,1)
p = e1 + e2
R‚Ä†
45¬∞ = cos45¬∞ + sin45¬∞e12
=
‚àö
2
2 +
‚àö
2
2 e12
p‚Ä≤ =
‚àö
2
2 +
‚àö
2
2 e12
	
(e1 + e2)
=
‚àö
2
2 e1 +
‚àö
2
2 e2 ‚àí
‚àö
2
2 e2 +
‚àö
2
2 e1
=
‚àö
2e1
and P ‚Ä≤ = (
‚àö
2,0), which is correct.

112
8
Frames of Reference in the Plane
Fig. 8.10 The X‚Ä≤Y ‚Ä≤ axial
system is rotated 90¬∞ and
translated (10,5)
8.5.3 Rotated and Translated Frame of Reference
Earlier, we saw how two inverse transforms are used to compute the coordinates of a
point in a rotated and translated frame of reference. We can achieve the same result
using multivectors as follows.
We begin with point P and its frame of reference XY. The Ô¨Årst step is to establish
a translated frame of reference XT YT with position vector t. Which means that
pT = p ‚àít.
(8.3)
Next, as shown in Fig. 8.10, we rotate pT by ‚àíŒ≤ to effectively rotate the frame of
reference XT YT to X‚Ä≤Y ‚Ä≤. Which means that
p‚Ä≤ = R‚Ä†
Œ≤pT .
(8.4)
Substituting (8.3) in (8.4) we have
p‚Ä≤ = R‚Ä†
Œ≤(p ‚àít)
or
p‚Ä≤ = (cosŒ≤ + sinŒ≤e12)

(x ‚àítx)e1 + (y ‚àíty)e2

.
(8.5)
Let‚Äôs test (8.5) using the same values in the previous example where
Œ≤ = 90¬∞
(tx,ty) = (10,5)
(x,y) = (9,6)
p‚Ä≤ =

cos90¬∞ + sin90¬∞e12

(9 ‚àí10)e1 + (6 ‚àí5)e2

= e12(‚àíe1 + e2)
= e1 + e2
which makes P ‚Ä≤ = (1,1) the same as (8.2).
Although multivectors provide an alternative way of solving vector-based prob-
lems, they still have a matrix background. For example, expanding (8.5) we have

8.6
Summary
113
p‚Ä≤ = (cosŒ≤ + sinŒ≤e12)

(x ‚àítx)e1 + (y ‚àíty)e2

= (x cosŒ≤‚àítx cosŒ≤)e1 + (y cosŒ≤‚àíty cosŒ≤)e2
‚àí(x sinŒ≤‚àítx sinŒ≤)e2 + (y sinŒ≤‚àíty sinŒ≤)e1
= (x cosŒ≤ + y sinŒ≤ ‚àítx cosŒ≤ ‚àíty sinŒ≤)e1
+ (‚àíx sinŒ≤ + y cosŒ≤ + tx sinŒ≤ ‚àíty cosŒ≤)e2
or in matrix form
‚é°
‚é£
x‚Ä≤
y‚Ä≤
1
‚é§
‚é¶=
‚é°
‚é£
cosŒ≤
sinŒ≤
‚àítx cosŒ≤ ‚àíty sinŒ≤
‚àísinŒ≤
cosŒ≤
tx sinŒ≤ ‚àíty cosŒ≤
0
0
1
‚é§
‚é¶
‚é°
‚é£
x
y
1
‚é§
‚é¶
which is identical to (8.1).
8.6 Summary
In this chapter we have discovered that if a transform such as Ttx,ty or RŒ≤ is used
for moving points, whilst keeping the frame Ô¨Åxed, their inverses T‚àí1
tx,ty and R‚àí1
Œ≤
can
be used for moving the frame, whilst keeping the point Ô¨Åxed. It goes without saying
that the converse also holds, in that we could have declared a transform for moving
a frame, and its inverse could be used for moving a point.
We have also seen how geometric algebra provides an alternative approach to
transforms based upon vectors, bivectors and rotors, and can undertake the same
tasks.
In order to show the patterns that exist between these two mathematical ap-
proaches, all the commands are summarised.
8.6.1 Summary of Matrix Transforms
Given
Ttx,ty =
‚é°
‚é£
1
0
tx
0
1
ty
0
0
1
‚é§
‚é¶
RŒ≤ =
‚é°
‚é£
cosŒ≤
‚àísinŒ≤
0
sinŒ≤
cosŒ≤
0
0
0
1
‚é§
‚é¶.
Translate frame
T‚àí1
tx,ty =
‚é°
‚é£
1
0
‚àítx
0
1
‚àíty
0
0
1
‚é§
‚é¶.

114
8
Frames of Reference in the Plane
Rotate frame
R‚àí1
Œ≤ =
‚é°
‚é£
cosŒ≤
sinŒ≤
0
‚àísinŒ≤
cosŒ≤
0
0
0
1
‚é§
‚é¶.
Translate and rotate frame
R‚àí1
Œ≤ T‚àí1
tx,ty =
‚é°
‚é£
cosŒ≤
sinŒ≤
‚àítx cosŒ≤ ‚àíty sinŒ≤
‚àísinŒ≤
cosŒ≤
tx sinŒ≤ ‚àíty cosŒ≤
0
0
1
‚é§
‚é¶.
8.6.2 Summary of Multivector Transforms
Frame rotor
R‚Ä†
Œ≤ = cosŒ≤ + sinŒ≤e12.
Translate frame
p‚Ä≤ = p ‚àít = (x ‚àítx)e1 + (y ‚àíty)e2.
Rotate frame
p‚Ä≤ = R‚Ä†
Œ≤p = (cosŒ≤ + sinŒ≤e12)(xe1 + ye2).
Translate and rotate frame
p‚Ä≤ = R‚Ä†
Œ≤(p ‚àít) = (cosŒ≤ + sinŒ≤e12)

(x ‚àítx)e1 + (y ‚àíty)e2

.

Chapter 9
Rotation Transforms in Space
9.1 Introduction
In this chapter we generalise the 2D transforms covered in Chap. 7 to three dimen-
sions. In particular, we examine rotating points about the Ô¨Åxed three Cartesian axes
and off-set, parallel axes, and about an arbitrary axis. We also explore Euler an-
gles, and their Achilles‚Äô heel ‚Äì gimbal lock. Matrices will be used to describe these
geometric scenarios.
9.2 3D Transforms
3D transforms include the scale, translate, reÔ¨Çect, shear and rotate transforms, and
in this chapter we need only consider the translate and rotate operations, which we
will explore individually and in combination. Let‚Äôs start with the translate transform.
9.2.1 Translate a Point
The matrix for a 3D point translation is basically the same as previously described
but with one extra dimension Ttx,ty,tz. It requires the homogeneous form and is
written
Ttx,ty,tz =
‚é°
‚é¢‚é¢‚é£
1
0
0
tx
0
1
0
ty
0
0
1
tz
0
0
0
1
‚é§
‚é•‚é•‚é¶
J. Vince, Rotation Transforms for Computer Graphics,
DOI 10.1007/978-0-85729-154-7_9, ¬© Springer-Verlag London Limited 2011
115

116
9
Rotation Transforms in Space
where tx, ty, tz are the x-, y-, z-offsets respectively. It goes without further explana-
tion that the inverse transform T‚àí1
tx,ty,tz is
T‚àí1
tx,ty,tz =
‚é°
‚é¢‚é¢‚é£
1
0
0
‚àítx
0
1
0
‚àíty
0
0
1
‚àítz
0
0
0
1
‚é§
‚é•‚é•‚é¶.
9.2.2 Rotate a Point About the Cartesian Axes
Although we talk about rotating points about another point in space, we require
more precise information to describe this mathematically. We could, for example,
associate a plane with the point of rotation and conÔ¨Åne the rotated point to this plane,
but it‚Äôs much easier to visualise an axis perpendicular to this plane, about which the
rotation occurs. Unfortunately, the matrix algebra for such an operation starts to be-
come fussy, and ultimately we have seek the help of quaternions or multivectors.
So let us begin this investigation by rotating a point about the three Ô¨Åxed Carte-
sian axes. Such rotations are called Euler rotations after the Swiss mathematician
Leonhard Euler.
Recall that the transform for rotating a point about the origin in the plane is given
by
RŒ≤ =
‚é°
‚é£
cosŒ≤
‚àísinŒ≤
0
sinŒ≤
cosŒ≤
0
0
0
1
‚é§
‚é¶.
This can be generalised into a 3D rotation RŒ≤,z about the z-axis by adding a z-
coordinate as follows
RŒ≤,z =
‚é°
‚é¢‚é¢‚é£
cosŒ≤
‚àísinŒ≤
0
0
sinŒ≤
cosŒ≤
0
0
0
0
1
0
0
0
0
1
‚é§
‚é•‚é•‚é¶
which is illustrated in Fig. 9.1
To rotate a point about the x-axis, the x-coordinate remains constant whilst the
y- and z-coordinates are changed according to the 2D rotation transform. This is
expressed algebraically as
x‚Ä≤ = x
y‚Ä≤ = y cosŒ≤ ‚àízsinŒ≤
z‚Ä≤ = y sinŒ≤ + zcosŒ≤

9.2
3D Transforms
117
Fig. 9.1 Rotating the point
P about the z-axis
or in matrix form as RŒ≤,x
RŒ≤,x =
‚é°
‚é¢‚é¢‚é£
1
0
0
0
0
cosŒ≤
‚àísinŒ≤
0
0
sinŒ≤
cosŒ≤
0
0
0
0
1
‚é§
‚é•‚é•‚é¶.
To rotate about the y-axis, the y-coordinate remains constant whilst the x- and z-
coordinates are changed. This is expressed algebraically as
x‚Ä≤ = zsinŒ≤ + x cosŒ≤
y‚Ä≤ = y
z‚Ä≤ = zcosŒ≤ ‚àíx sinŒ≤
or in matrix form as RŒ≤,y
RŒ≤,y =
‚é°
‚é¢‚é¢‚é£
cosŒ≤
0
sinŒ≤
0
0
1
0
0
‚àísinŒ≤
0
cosŒ≤
0
0
0
0
1
‚é§
‚é•‚é•‚é¶.
Note that the matrix terms don‚Äôt appear to share the symmetry enjoyed by the pre-
vious two matrices. Nothing really has gone wrong, it‚Äôs just the way the axes are
paired together to rotate the coordinates. Now let‚Äôs consider similar rotations about
off-set axes parallel to the Cartesian axes.
9.2.3 Rotating About an Off-Set Axis
To begin, let‚Äôs develop a transform to rotate a point about a Ô¨Åxed axis parallel with
the z-axis, as shown in Fig. 9.2. The scenario is very reminiscent of the 2D case for
rotating a point about an arbitrary point, and the general transform is given by
‚é°
‚é¢‚é¢‚é£
x‚Ä≤
y‚Ä≤
z‚Ä≤
1
‚é§
‚é•‚é•‚é¶= Ttx,ty,0RŒ≤,zT‚àítx,‚àíty,0
‚é°
‚é¢‚é¢‚é£
x
y
z
1
‚é§
‚é•‚é•‚é¶

118
9
Rotation Transforms in Space
Fig. 9.2 Rotating a point
about an axis parallel with the
z-axis
where
T‚àítx,‚àíty,0
creates a temporary origin
RŒ≤,z
rotates Œ≤ about the temporary z-axis
Ttx,ty,0
returns to the original position
and the matrix transform is
Ttx,ty,0RŒ≤,zT‚àítx,‚àíty,0 =
‚é°
‚é¢‚é¢‚é£
cosŒ≤
‚àísinŒ≤
0
tx(1 ‚àícosŒ≤) + ty sinŒ≤
sinŒ≤
cosŒ≤
0
ty(1 ‚àícosŒ≤) ‚àítx sinŒ≤
0
0
1
0
0
0
0
1
‚é§
‚é•‚é•‚é¶.
I hope you can see the similarity between rotating in 3D and 2D ‚Äì the x- and
y-coordinates are updated while the z-coordinate is held constant. We can now state
the other two matrices for rotating about an off-set axis parallel with the x-axis and
parallel with the y-axis:
T0,ty,tzRŒ≤,xT0,‚àíty,‚àítz =
‚é°
‚é¢‚é¢‚é£
1
0
0
0
0
cosŒ≤
‚àísinŒ≤
ty(1 ‚àícosŒ≤) + tz sinŒ≤
0
sinŒ≤
cosŒ≤
tz(1 ‚àícosŒ≤) ‚àíty sinŒ≤
0
0
0
1
‚é§
‚é•‚é•‚é¶
Ttx,0,tzRŒ≤,yT‚àítx,0,‚àítz =
‚é°
‚é¢‚é¢‚é£
cosŒ≤
0
sinŒ≤
tx(1 ‚àícosŒ≤) ‚àítz sinŒ≤
0
1
0
0
‚àísinŒ≤
0
cosŒ≤
tz(1 ‚àícosŒ≤) + tx sinŒ≤
0
0
0
1
‚é§
‚é•‚é•‚é¶.
9.3 Composite Rotations
So far we have only considered single rotations about a Cartesian axis or a parallel
off-set axis, but there is nothing to stop us constructing a sequence of rotations
to create a composite rotation. For example, we could begin by rotating a point Œ±
about the x-axis followed by a rotation Œ≤ about the y-axis, which in turn could be

9.3
Composite Rotations
119
Fig. 9.3 A unit cube with
vertices coded as shown in
Table 9.1
Table 9.1 Vertex coordinates
for the cube in Fig. 9.3
vertex
0
1
2
3
4
5
6
7
x
0
0
0
0
1
1
1
1
y
0
0
1
1
0
0
1
1
z
0
1
0
1
0
1
0
1
followed by a rotation Œ≥ about the z-axis. As mentioned above, these rotations are
called Euler rotations.
One of the problems with Euler rotations is visualising exactly what is happening
at each step, and predicting the orientation of an object after a composite rotation. To
simplify the problem we will employ a unit cube whose vertices are numbered 0 to
7 as shown in Fig. 9.3. We will also employ the following binary coded expression
that uses the Cartesian coordinates of the vertex in the vertex number:
vertex = 4x + 2y + z.
For example, vertex 0 has coordinates (0,0,0), and vertex 7 has coordinates
(1,1,1). All the codes are shown in Table 9.1.
Let‚Äôs repeat the three rotation transforms for rotating points about the x-, y- and
z-axes respectively, in their non-homogeneous form and substitute c for cos and s
for sin to save space:
rotate Œ± about the x-axis
RŒ±,x =
‚é°
‚é£
1
0
0
0
cŒ±
‚àísŒ±
0
sŒ±
cŒ±
‚é§
‚é¶
rotate Œ≤ about the y-axis
RŒ≤,y =
‚é°
‚é£
cŒ≤
0
sŒ≤
0
1
0
‚àísŒ≤
0
cŒ≤
‚é§
‚é¶
rotate Œ≥ about the z-axis
RŒ≥,z =
‚é°
‚é£
cŒ≥
‚àísŒ≥
0
sŒ≥
cŒ≥
0
0
0
1
‚é§
‚é¶.

120
9
Rotation Transforms in Space
We can create a composite, moving-point, Ô¨Åxed-frame rotation by placing
RŒ±,x, RŒ≤,y and RŒ≥,z in any sequence. As an example, let‚Äôs choose the sequence
RŒ≥,zRŒ≤,yRŒ±,x
RŒ≥,zRŒ≤,yRŒ±,x =
‚é°
‚é£
cŒ≥
‚àísŒ≥
0
sŒ≥
cŒ≥
0
0
0
1
‚é§
‚é¶
‚é°
‚é£
cŒ≤
0
sŒ≤
0
1
0
‚àísŒ≤
0
cŒ≤
‚é§
‚é¶
‚é°
‚é£
1
0
0
0
cŒ±
‚àísŒ±
0
sŒ±
cŒ±
‚é§
‚é¶. (9.1)
Multiplying the three matrices in (9.1) together we obtain
‚é°
‚é£
cŒ≥ cŒ≤
cŒ≥ sŒ≤sŒ± ‚àísŒ≥ cŒ±
cŒ≥ sŒ≤cŒ± + sŒ≥ sŒ±
sŒ≥ cŒ≤
sŒ≥ sŒ≤sŒ± + cŒ≥ cŒ±
sŒ≥ sŒ≤cŒ± ‚àícŒ≥ sŒ±
‚àísŒ≤
cŒ≤sŒ±
cŒ≤cŒ±
‚é§
‚é¶
(9.2)
or using the more familiar notation:
‚é°
‚é£
cosŒ≥ cosŒ≤
cosŒ≥ sinŒ≤ sinŒ± ‚àísinŒ≥ cosŒ±
cosŒ≥ sinŒ≤ cosŒ± + sinŒ≥ sinŒ±
sinŒ≥ cosŒ≤
sinŒ≥ sinŒ≤ sinŒ± + cosŒ≥ cosŒ±
sinŒ≥ sinŒ≤ cosŒ± ‚àícosŒ≥ sinŒ±
‚àísinŒ≤
cosŒ≤ sinŒ±
cosŒ≤ cosŒ±
‚é§
‚é¶.
Let‚Äôs evaluate (9.2) by making Œ± = Œ≤ = Œ≥ = 90¬∞:
‚é°
‚é£
0
0
1
0
1
0
‚àí1
0
0
‚é§
‚é¶.
(9.3)
The matrix (9.3) is equivalent to rotating a point 90¬∞ about the Ô¨Åxed x-axis, followed
by a rotation of 90¬∞ about the Ô¨Åxed y-axis, followed by a rotation of 90¬∞ about the
Ô¨Åxed z-axis. This rotation sequence is illustrated in Fig. 9.4 (a)‚Äì(d).
Figure 9.4 (a) shows the starting position of the cube; (b) shows its orientation
after a 90¬∞ rotation about the x-axis; (c) shows its orientation after a further rotation
of 90¬∞ about the y-axis; and (d) the cube‚Äôs resting position after a rotation of 90¬∞
about the z-axis.
From Fig. 9.4 (d) we see that the cube‚Äôs coordinates are as shown in Table 9.2. We
can conÔ¨Årm that these coordinates are correct by multiplying the cube‚Äôs original co-
ordinates shown in Table 9.1 by the matrix (9.3). Although it is not mathematically
correct, we will show the matrix multiplying an array of coordinates as follows
‚é°
‚é£
0
0
1
0
1
0
‚àí1
0
0
‚é§
‚é¶
‚é°
‚é£
0
0
0
0
1
1
1
1
0
0
1
1
0
0
1
1
0
1
0
1
0
1
0
1
‚é§
‚é¶
=
‚é°
‚é£
0
1
0
1
0
1
0
1
0
0
1
1
0
0
1
1
0
0
0
0
‚àí1
‚àí1
‚àí1
‚àí1
‚é§
‚é¶
which agree with the coordinates in Table 9.2.
Naturally, any three angles can be chosen to rotate a point about the Ô¨Åxed axes,
but it does become difÔ¨Åcult to visualise without an interactive cgi system.
Note that the determinant of (9.3) is 1, which is as expected.

9.3
Composite Rotations
121
Fig. 9.4 Four views of the unit cube before and during the three rotations
Table 9.2 Vertex coordinates
for the cube in Fig. 9.4 (d)
vertex
0
1
2
3
4
5
6
7
x
0
1
0
1
0
1
0
1
y
0
0
1
1
0
0
1
1
z
0
0
0
0
‚àí1
‚àí1
‚àí1
‚àí1
An observation we made with 2D rotations is that they are additive: i.e. RŒ± fol-
lowed by RŒ≤ is equivalent to RŒ±+Œ≤. But something equally important is that rota-
tions in 2D commute:
RŒ±RŒ≤ = RŒ≤RŒ± = RŒ±+Œ≤ = RŒ≤+Œ±
whereas, in general, 3D rotations are non-commutative. This is seen by considering
a composite rotation formed by a rotation Œ± about the x-axis RŒ±,x, followed by a
rotation Œ≤ about the z-axis RŒ≤,z, and
RŒ±,xRŒ≤,z Ã∏= RŒ≤,zRŒ±,x.
As an illustration, let‚Äôs reverse the composite rotation computed above to
RŒ±,xRŒ≤,yRŒ≥,z:
RŒ±,xRŒ≤,yRŒ≥,z =
‚é°
‚é£
1
0
0
0
cŒ±
‚àísŒ±
0
sŒ±
cŒ±
‚é§
‚é¶
‚é°
‚é£
cŒ≤
0
sŒ≤
0
1
0
‚àísŒ≤
0
cŒ≤
‚é§
‚é¶
‚é°
‚é£
cŒ≥
‚àísŒ≥
0
sŒ≥
cŒ≥
0
0
0
1
‚é§
‚é¶. (9.4)

122
9
Rotation Transforms in Space
Fig. 9.5 Four views of the unit cube using the rotation sequence RŒ±,xRŒ≤,yRŒ≥,z
Multiplying the three matrices in (9.4) together we obtain
‚é°
‚é£
cŒ≤cŒ≥
‚àícŒ≤sŒ≥
sŒ≤
sŒ±sŒ≤cŒ≥ + cŒ±sŒ≥
‚àísŒ±sŒ≤sŒ≥ + cŒ±cŒ≥
‚àísŒ±cŒ≤
‚àícŒ±sŒ≤cŒ≥ + sŒ±sŒ≥
cŒ±sŒ≤sŒ≥ + sŒ±cŒ≥
cŒ±cŒ≤
‚é§
‚é¶
(9.5)
or using the more familiar notation:
‚é°
‚é£
cosŒ≤ cosŒ≥
‚àícosŒ≤ sinŒ≥
sinŒ≤
sinŒ± sinŒ≤ cosŒ≥ + cosŒ± sinŒ≥ ‚àísinŒ± sinŒ≤ sinŒ≥ + cosŒ± cosŒ≥ ‚àísinŒ± cosŒ≤
‚àícosŒ± sinŒ≤ cosŒ≥ + sinŒ± sinŒ≥
cosŒ± sinŒ≤ sinŒ≥ + sinŒ± cosŒ≥
cosŒ± cosŒ≤
‚é§
‚é¶.
Comparing (9.3) and (9.5) it can be seen that they are completely different.
Let‚Äôs evaluate (9.5) by making Œ± = Œ≤ = Œ≥ = 90¬∞:
‚é°
‚é£
0
0
1
0
‚àí1
0
1
0
0
‚é§
‚é¶.
(9.6)
The matrix (9.6) is equivalent to rotating a point 90¬∞ about the Ô¨Åxed z-axis, fol-
lowed by a rotation of 90¬∞ about the Ô¨Åxed y-axis, followed by a rotation of 90¬∞ about
the Ô¨Åxed x-axis. This rotation sequence is illustrated in Fig. 9.5 (a)‚Äì(d).
From Fig. 9.5 (d) we see that the cube‚Äôs coordinates are as shown in Table 9.3.
We can conÔ¨Årm that these coordinates are correct by multiplying the cube‚Äôs original

9.3
Composite Rotations
123
Table 9.3 Vertex coordinates
for the cube in Fig. 9.5 (d)
vertex
0
1
2
3
4
5
6
7
x
0
1
0
1
0
1
0
1
y
0
0
‚àí1
‚àí1
0
0
‚àí1
‚àí1
z
0
0
0
0
1
1
1
1
coordinates shown in Table 9.1 by the matrix (9.6). We show the matrix multiplying
an array of coordinates as before:
‚é°
‚é£
0
0
1
0
‚àí1
0
1
0
0
‚é§
‚é¶
‚é°
‚é£
0
0
0
0
1
1
1
1
0
0
1
1
0
0
1
1
0
1
0
1
0
1
0
1
‚é§
‚é¶
=
‚é°
‚é£
0
1
0
1
0
1
0
1
0
0
‚àí1
‚àí1
0
0
‚àí1
‚àí1
0
0
0
0
1
1
1
1
‚é§
‚é¶
which agree with the coordinates in Table 9.3, and we can safely conclude that, in
general, 3D rotation transforms do not commute. Inspection of Fig. 9.5 (d) shows
that the unit cube has been rotated 180¬∞ about a vector [1
0
1]T.
Now let‚Äôs explore the role eigenvectors and eigenvalues play in 3D rotations.
9.3.1 3D Eigenvectors
In Chap. 4 we examined the characteristic equation used to identify any eigenvectors
associated with a matrix. The eigenvector v satisÔ¨Åes the relationship
Av = Œªv
where Œª is a scaling factor.
In the context of a 3D rotation matrix, an eigenvector is a vector scaled by Œª
but not rotated, which implies that it is the axis of rotation. To illustrate this, let‚Äôs
identify the eigenvector for the composite rotation (9.3) above:
R90¬∞,zR90¬∞,yR90¬∞,x =
‚é°
‚é£
0
0
1
0
1
0
‚àí1
0
0
‚é§
‚é¶.
Figure 9.4 (a)‚Äì(d) shows the effect of this composite rotation, which is nothing
more than a rotation of 90¬∞ about the y-axis. Therefore, we should be able to extract
this information from the above matrix.
We begin by writing the characteristic equation for the matrix:

0 ‚àíŒª
0
1
0
1 ‚àíŒª
0
‚àí1
0
0 ‚àíŒª

= 0.
(9.7)

124
9
Rotation Transforms in Space
Expanding (9.7) using the top row we have
‚àíŒª

1 ‚àíŒª 0
0
‚àíŒª
 + 1

0 1 ‚àíŒª
‚àí1
0
 = 0
‚àíŒª
	
‚àíŒª + Œª2
+ 1 ‚àíŒª = 0
Œª2 ‚àíŒª3 + 1 ‚àíŒª = 0
‚àíŒª3 + Œª2 ‚àíŒª + 1 = 0
Œª3 ‚àíŒª2 + Œª = 1.
When working with 3 √ó 3 matrices we always end up with a cubic in Œª, for which
there can be three types of solution:
1. One real and two complex conjugate solutions.
2. Three real solutions including the possibility of a double solution.
3. Three distinct real solutions.
It is clear that Œª = 1 is one such real root, which satisÔ¨Åes our requirement for an
eigenvalue. We could also show that the other two roots are complex conjugates.
Substituting Œª = 1 in the original equations associated with (9.7) to reveal the
eigenvector, we have
‚éß
‚é®
‚é©
‚àíx + 0y + z = 0
0x + 0y + 0z = 0
‚àíx + 0y ‚àíz = 0.
It is obvious from the 1st and 3rd equations that x = z = 0. However, all three
equations multiply the y term by zero, which implies that the associated eigenvector
is of the form [0
k
0]T, which is the y-axis, as anticipated. Now let‚Äôs Ô¨Ånd the
angle of rotation.
Using one of the above rotation matrices RŒ≤,y and the trace operation:
RŒ≤,y =
‚é°
‚é£
cosŒ≤
0
sinŒ≤
0
1
0
‚àísinŒ≤
0
cosŒ≤
‚é§
‚é¶
Tr(RŒ≤,y) = 1 + 2cosŒ≤
therefore,
Œ≤ = arccos((Tr(RŒ≤,y) ‚àí1)/2).
To illustrate this, let Œ≤ = 90¬∞:
R90¬∞,y =
‚é°
‚é£
0
0
1
0
1
0
‚àí1
0
0
‚é§
‚é¶
Tr(R90¬∞,y) = 1
therefore,
Œ≤ = arccos((1 ‚àí1)/2) = 90¬∞.

9.3
Composite Rotations
125
Let‚Äôs choose another matrix and repeat the above:
RŒ±,x =
‚é°
‚é£
1
0
0
0
cosŒ±
‚àísinŒ±
0
sinŒ±
cosŒ±
‚é§
‚é¶.
This time, let Œ± = 45¬∞:
R45¬∞,x =
‚é°
‚é£
1
0
0
0
‚àö
2/2
‚àí
‚àö
2/2
0
‚àö
2/2
‚àö
2/2
‚é§
‚é¶
Tr(R45¬∞,x) = 1 +
‚àö
2
therefore,
Œ± = arccos((1 +
‚àö
2 ‚àí1)/2) = 45¬∞.
So we now have a mechanism to extract the axis and angle of rotation from a
rotation matrix. However, the algorithm for identifying the axis is far from satisfac-
tory, and later on we will discover that there is a similar technique which is readily
programable.
For completeness, let‚Äôs identify the axis and angle of rotation for the matrix (9.6):
R90¬∞,xR90¬∞,yR90¬∞,z =
‚é°
‚é£
0
0
1
0
‚àí1
0
1
0
0
‚é§
‚é¶.
Once more, we begin by writing the characteristic equation for the matrix:

0 ‚àíŒª
0
1
0
‚àí1 ‚àíŒª
0
1
0
0 ‚àíŒª

= 0.
(9.8)
Expanding (9.8) using the top row we have
‚àíŒª

‚àí1 ‚àíŒª
0
0
‚àíŒª
 + 1

0
‚àí1 ‚àíŒª
1
0
 = 0
‚àíŒª
	
‚àíŒª + Œª2
+ 1 ‚àíŒª = 0
Œª2 ‚àíŒª3 + 1 ‚àíŒª = 0
‚àíŒª3 + Œª2 ‚àíŒª + 1 = 0
Œª3 ‚àíŒª2 + Œª = 1.
Again, there is a single real root: Œª = 1, and substituting this in the original equations
associated with (9.8) to reveal the eigenvector, we have
‚éß
‚é®
‚é©
‚àíx + 0y + z = 0
0x ‚àí2y + 0z = 0
x + 0y ‚àíz = 0.
It is obvious from the 1st and 3rd equations that x = z, and from the 2nd equation
that y = 0, which implies that the associated eigenvector is of the form [k
0
k],
which is correct.

126
9
Rotation Transforms in Space
Using the trace operation, we can write
Tr(R90¬∞,xR90¬∞,yR90¬∞,z) = ‚àí1
therefore,
Œ≤ = arccos((‚àí1 ‚àí1)/2) = 180¬∞.
As promised, let‚Äôs explore another way of identifying the Ô¨Åxed axis of rotation,
which is an eigenvector. Consider the following argument where A is a simple rota-
tion transform:
If v is a Ô¨Åxed axis of rotation and A a rotation transform, then v suffers no rota-
tion:
Av = v
(9.9)
similarly,
ATv = v.
(9.10)
Subtracting (9.10) from (9.9), we have
Av ‚àíATv = 0
(9.11)
	
A ‚àíAT
v = 0
(9.12)
where 0 is a null vector.
In Chap. 4 we deÔ¨Åned an antisymmetric matrix Q as
Q = 1
2
	
A ‚àíAT
(9.13)
therefore,
	
A ‚àíAT
= 2Q.
(9.14)
Substituting (9.14) in (9.12) we have
2Qv = 0
Qv = 0
which permits us to write
‚é°
‚é£
0
q3
‚àíq2
‚àíq3
0
q1
q2
‚àíq1
0
‚é§
‚é¶
‚é°
‚é£
v1
v2
v3
‚é§
‚é¶=
‚é°
‚é£
0
0
0
‚é§
‚é¶
(9.15)
where
q1 = a23 ‚àía32
q2 = a31 ‚àía13
q3 = a12 ‚àía21.
Expanding (9.15) we have

9.3
Composite Rotations
127
0v1 + q3v2 ‚àíq2v3 = 0
‚àíq3v1 + 0v2 + q1v3 = 0
q2v1 ‚àíq1v2 + 0v3 = 0.
Obviously, one possible solution is v1 = v2 = v3 = 0, but we seek a solution for v
in terms of q1,q2 and q3. A standard technique is to relax one of the v terms, such
as making v1 = 1. Then
q3v2 ‚àíq2v3 = 0
(9.16)
‚àíq3 + q1v3 = 0
(9.17)
q2 ‚àíq1v2 = 0.
(9.18)
From (9.18) we have
v2 = q2
q1
.
From (9.17) we have
v3 = q3
q1
therefore, a solution is
v =
q1
q1
q2
q1
q3
q1
T
which in a non-homogeneous form is
v =

q1
q2
q3
T
or in terms of the original matrix:
v =

(a23 ‚àía32)
(a31 ‚àía13)
(a12 ‚àía21)
T
(9.19)
which appears to be a rather elegant solution for Ô¨Ånding the Ô¨Åxed axis of revolution.
Now let‚Äôs put (9.19) to the test by recomputing the axis of rotation for the pure
rotations RŒ±,x,RŒ≤,y and RŒ≥,z where Œ± = Œ≤ = Œ≥ = 90¬∞:
R90¬∞,x =
‚é°
‚é£
1
0
0
0
0
‚àí1
0
1
0
‚é§
‚é¶
using (9.19) we have
v =

(‚àí1 ‚àí1)
(0 ‚àí0)
(0 ‚àí0)

= [‚àí2
0
0]T
which is the x-axis.
R90¬∞,y =
‚é°
‚é£
0
0
1
0
1
0
‚àí1
0
0
‚é§
‚é¶

128
9
Rotation Transforms in Space
using (9.19) we have
v =

(0 ‚àí0)
(‚àí1 ‚àí1)
(0 ‚àí0)

= [0
‚àí2
0]T
which is the y-axis.
R90¬∞,z =
‚é°
‚é£
0
‚àí1
0
1
0
0
0
0
1
‚é§
‚é¶
using (9.19) we have
v =

(0 ‚àí0)
(0 ‚àí0)
(‚àí1 ‚àí1)

= [0
0
‚àí2]T
which is the z-axis.
However, if we attempt to extract the axis of rotation from
R90¬∞,xR90¬∞,yR90¬∞,z =
‚é°
‚é£
0
0
1
0
‚àí1
0
1
0
0
‚é§
‚é¶
we have a problem, because q1 = q2 = q3 = 0. This is because A = AT and the
technique relies upon A Ã∏= AT.
So let‚Äôs consider another approach based upon the fact that a rotation matrix
always has a real eigenvalue Œª = 1, which permits us to write
Av = Œªv
Av = ŒªIv = Iv
(A ‚àíI)v = 0
therefore,
‚é°
‚é£
(a11 ‚àí1)
a12
a13
a21
(a22 ‚àí1)
a23
a31
a32
(a33 ‚àí1)
‚é§
‚é¶
‚é°
‚é£
v1
v2
v3
‚é§
‚é¶=
‚é°
‚é£
0
0
0
‚é§
‚é¶.
(9.20)
Expanding (9.20) we have
(a11 ‚àí1)v1 + a12v2 + a13v3 = 0
a21v1 + (a22 ‚àí1)v2 + a23v3 = 0
a31v1 + a32v2 + (a33 ‚àí1)v3 = 0.
Once more, there exists a trivial solution where v1 = v2 = v3 = 0, but to discover
something more useful we can relax any one of the v terms which gives us three
equations in two unknowns. Let‚Äôs make v1 = 0:
a12v2 + a13v3 = ‚àí(a11 ‚àí1)
(9.21)
(a22 ‚àí1)v2 + a23v3 = ‚àía21
(9.22)
a32v2 + (a33 ‚àí1)v3 = ‚àía31.
(9.23)
We are now faced with choosing a pair of equations to isolate v2 and v3. In fact, we
have to consider all three pairings because it is possible that a future rotation matrix

9.3
Composite Rotations
129
will contain a column with two zero elements, which could conÔ¨Çict with any pairing
we make at this stage.
Let‚Äôs begin by choosing (9.21) and (9.22). The solution employs the following
strategy: Given the following matrix equation
a1
b1
a2
b2
x
y

=
c1
c2

then
x

c1
b1
c2
b2

=
y

a1
c1
a2
c2

=
1

a1
b1
a2
b2
.
Therefore, using the 1st and 2nd (9.21) and (9.22) we have
v2

‚àí(a11 ‚àí1)
a13
‚àía21
a23

=
v3

a12
‚àí(a11 ‚àí1)
(a22 ‚àí1)
‚àía21

=
1

a12
a13
(a22 ‚àí1)
a23

v1 = a12a23 ‚àía13(a22 ‚àí1)
v2 = a13a21 ‚àía23(a11 ‚àí1)
v3 = (a11 ‚àí1)(a22 ‚àí1) ‚àía12a21.
Similarly, using the 1st and 3rd (9.21) and (9.23) we have
v1 = a12(a33 ‚àí1) ‚àía13a32
v2 = a13a31 ‚àí(a11 ‚àí1)(a33 ‚àí1)
v3 = a32(a11 ‚àí1) ‚àía12a31
and using the 2nd and 3rd (9.22) and (9.23) we have
v1 = (a22 ‚àí1)(a33 ‚àí1) ‚àía23a32
v2 = a23a31 ‚àía21(a33 ‚àí1)
v3 = a21a32 ‚àía31(a22 ‚àí1).
Now we have nine equations to cope with any eventuality. In fact, there is nothing
to stop us from choosing any three that take our fancy, for example these three
equations look interesting and sound:
v1 = (a22 ‚àí1)(a33 ‚àí1) ‚àía23a32
(9.24)
v2 = (a33 ‚àí1)(a11 ‚àí1) ‚àía31a13
(9.25)
v3 = (a11 ‚àí1)(a22 ‚àí1) ‚àía12a21.
(9.26)
Therefore, the solution for the eigenvector is [v1
v2
v3]T. Note that the sign of
v2 has been reversed to maintain symmetry.
Let‚Äôs test (9.24), (9.25) and (9.26) with the transforms used above:

130
9
Rotation Transforms in Space
R90¬∞,x =
‚é°
‚é£
1
0
0
0
0
‚àí1
0
1
0
‚é§
‚é¶
‚éß
‚é®
‚é©
v1 = (‚àí1)(‚àí1) ‚àí(‚àí1) √ó 1 = 2
v2 = (‚àí1)(0) ‚àí
0 √ó 0
= 0
v3 = (0)(‚àí1) ‚àí
0 √ó 0
= 0
R90¬∞,y =
‚é°
‚é£
0
0
1
0
1
0
‚àí1
0
0
‚é§
‚é¶
‚éß
‚é®
‚é©
v1 = (0)(‚àí1) ‚àí
0 √ó 0
= 0
v2 = (‚àí1)(‚àí1) ‚àí(‚àí1) √ó 1 = 2
v3 = (‚àí1)(0) ‚àí
0 √ó 0
= 0
R90¬∞,z =
‚é°
‚é£
0
‚àí1
0
1
0
0
0
0
1
‚é§
‚é¶
‚éß
‚é®
‚é©
v1 = (‚àí1)(0) ‚àí
0 √ó 0
= 0
v2 = (0)(‚àí1) ‚àí
0 √ó 0
= 0
v3 = (‚àí1)(‚àí1) ‚àí(‚àí1) √ó 1 = 2
R90¬∞,xR90¬∞,yR90¬∞,z =
‚é°
‚é£
0
0
1
0
‚àí1
0
1
0
0
‚é§
‚é¶
‚éß
‚é®
‚é©
v1 = (‚àí2)(‚àí1) ‚àí
0 √ó 0
= 2
v2 = (‚àí1)(‚àí1) ‚àí
1 √ó 1
= 0
v3 = (‚àí1)(‚àí2) ‚àí0 √ó (‚àí1) = 2
R90¬∞,zR90¬∞,yR90¬∞,x =
‚é°
‚é£
0
0
1
0
1
0
‚àí1
0
0
‚é§
‚é¶
‚éß
‚é®
‚é©
v1 = (0)(‚àí1) ‚àí
0 √ó 0
= 0
v2 = (‚àí1)(‚àí1) ‚àí(‚àí1) √ó 1 = 2
v3 = (‚àí1)(0) ‚àí
0 √ó 0
= 0.
We can see why the resulting vectors have components of 2 by evaluating a normal
rotation transform:
RŒ±,x =
‚é°
‚é£
1
0
0
0
cŒ±
‚àísŒ±
0
sŒ±
cŒ±
‚é§
‚é¶
‚éß
‚é®
‚é©
v1 = (cŒ± ‚àí1)(cŒ± ‚àí1) ‚àí(‚àísŒ±) √ó (sŒ±) = 2(1 ‚àícŒ±)
v2 =
(cŒ± ‚àí1)(0)
‚àí
0 √ó 0
=
0
v3 =
(0)(cŒ± ‚àí1)
‚àí
0 √ó 0
=
0.
We can see that when Œ± = 90¬∞, v1 = 2.
So far we have created three composite rotations comprising individual rota-
tions about the x-, y- and z-axes: RŒ±,xRŒ≤,yRŒ≥,z and RŒ≥,zRŒ≤,yRŒ±,x. But there is
nothing stopping us from creating other combinations such as RŒ±,xRŒ≤,yRŒ≥,x or
RŒ±,zRŒ≤,yRŒ≥,z that include two rotations about the same axis. In fact, there are twelve
possible combinations:
RŒ±,xRŒ≤,yRŒ≥,x,
RŒ±,xRŒ≤,yRŒ≥,z,
RŒ±,xRŒ≤,zRŒ≥,x,
RŒ±,xRŒ≤,zRŒ≥,y
RŒ±,yRŒ≤,xRŒ≥,y,
RŒ±,yRŒ≤,xRŒ≥,z,
RŒ±,yRŒ≤,zRŒ≥,x,
RŒ±,yRŒ≤,zRŒ≥,y
RŒ±,zRŒ≤,xRŒ≥,y,
RŒ±,zRŒ≤,xRŒ≥,z,
RŒ±,zRŒ≤,yRŒ≥,x,
RŒ±,zRŒ≤,yRŒ≥,z
which are covered in detail in Appendix A.
9.4 Gimbal Lock
There are two potential problems with all of the above composite transforms. The
Ô¨Årst is the difÔ¨Åculty visualising the orientation of an object subjected to several
rotations; the second is that they all suffer from what is called gimbal lock. From
a visualisation point of view, if we use the transform RŒ≥,zRŒ≤,yRŒ±,x to animate an
object and change Œ≥ , Œ≤ and Œ± over a period of frames, it can be very difÔ¨Åcult to
predict the Ô¨Ånal movement and adjust the angles to achieve a desired effect. Gimbal

9.4
Gimbal Lock
131
Fig. 9.6 Three types of gimbal joints
lock, on the other hand, is a weakness associated with Euler rotations when certain
combinations of angles are used.
To understand this phenomenon, consider a simple gimbal which is a pivoted
support that permits rotation about an axis, as shown in Fig. 9.6 (a). If two gimbals
are combined, as shown in Fig. 9.6 (b), the inner cradle remains level with some ref-
erence plane as the assembly rolls and pitches. Such a combination has two degrees
of rotational freedom. By adding a third gimbal so that the entire structure is free to
rotate about a vertical axis, an extra degree of rotational freedom is introduced and
is often used for mounting a camera on a tripod, as shown in Fig. 9.6 (c).
A mechanical gimbal joint with three degrees of freedom is represented math-
ematically by a composite Euler rotation transform. For example, say we choose
R90¬∞,yR90¬∞,xR90¬∞,z to rotate our unit cube as shown in Fig. 9.7 (a). The cube‚Äôs
faces containing vertices 1, 5, 7, 3 and 0, 2, 6, 4 are Ô¨Årst rotated about the perpen-
dicular z-axis, as shown in Fig. 9.7 (b). The second transform rotates the cube‚Äôs
faces containing vertices 0, 4, 5, 1 and 2, 3, 7, 6 about the perpendicular x-axis,
as shown in Fig. 9.7 (c). If we now attempt to rotate the cube about the y-axis,
as shown in Fig. 9.7 (d), the cube‚Äôs faces containing 0, 2, 6, 4 and 1, 5, 7, 3 are
rotated again. Effectively we have lost the ability to rotate a cube about one of its
axes, and such a condition is called gimbal lock. There is little we can do about this,
apart from use another composite transform, but it, too, will have a similar restric-
tion. For example, Appendix A shows that R90¬∞,xR90¬∞,zR90¬∞,y, R90¬∞,yR90¬∞,zR90¬∞,x,
R90¬∞,zR90¬∞,xR90¬∞,y and R90¬∞,zR90¬∞,yR90¬∞,x all possess a similar afÔ¨Çiction. Fortu-
nately, there are other ways of rotating an object, which we will explore later.

132
9
Rotation Transforms in Space
Fig. 9.7 An example of gimbal lock
9.5 Yaw, Pitch and Roll
The above Euler rotations are also known as yaw, pitch and roll, and great care
should be taken with these angles when referring to other books and technical pa-
pers. Sometimes a left-handed system of axes is used rather than a right-handed set,
and the vertical axis may be the y-axis or the z-axis, and might even point down-
wards. Consequently, the matrices representing the rotations can vary greatly. In
this text all Cartesian coordinate systems are right-handed, and the vertical axis is
always the y-axis.
The terms yaw, pitch and roll are often used in aviation and to describe the mo-
tion of ships. For example, if a ship or aeroplane is heading in a particular direction,
the axis aligned with the heading is the roll axis, as shown in Fig. 9.8 (a). A perpen-
dicular axis in the horizontal plane containing the heading axis is the pitch axis, as
shown in Fig. 9.8 (b). The axis perpendicular to both these axes is the yaw axis, as
shown in Fig. 9.8 (c).
Clearly, there are many ways of aligning a set of Cartesian axes with the yaw,
pitch and roll axes, and consequently, it is impossible to deÔ¨Åne an absolute set of
yaw, pitch and roll transforms. However, if we choose the following alignment:
‚Ä¢ the roll axis is the z-axis
‚Ä¢ the pitch axis is the x-axis
‚Ä¢ the yaw axis is the y-axis
we have the situation as shown in Fig. 9.9, and the transforms representing these
rotations are as follows:

9.5
Yaw, Pitch and Roll
133
Fig. 9.8 DeÔ¨Ånitions of yaw, pitch and roll
Fig. 9.9 A convention for
roll, pitch and yaw angles
Rroll,z =
‚é°
‚é£
cosroll
‚àísinroll
0
sinroll
cosroll
0
0
0
1
‚é§
‚é¶
Rpitch,x =
‚é°
‚é£
1
0
0
0
cospitch
‚àísinpitch
0
sinpitch
cospitch
‚é§
‚é¶
Ryaw,y =
‚é°
‚é£
cosyaw
0
sinyaw
0
1
0
‚àísinyaw
0
cosyaw
‚é§
‚é¶.

134
9
Rotation Transforms in Space
A common sequence for applying these rotations is roll, pitch, yaw, as seen in the
following transform:
‚é°
‚é£
x‚Ä≤
y‚Ä≤
z‚Ä≤
‚é§
‚é¶= Ryaw,yRpitch,xRroll,z
‚é°
‚é£
x
y
z
‚é§
‚é¶
and if a translation is involved,
‚é°
‚é¢‚é¢‚é£
x‚Ä≤
y‚Ä≤
z‚Ä≤
1
‚é§
‚é•‚é•‚é¶= Ttx,ty,tzRyaw,yRpitch,xRroll,z
‚é°
‚é¢‚é¢‚é£
x
y
z
1
‚é§
‚é•‚é•‚é¶.
9.6 Rotating a Point About an Arbitrary Axis
Now let‚Äôs examine two ways of rotating a point about an arbitrary axis. The Ô¨Årst
technique uses matrices and trigonometry and is rather laborious. The second ap-
proach employs vector analysis and is quite succinct. Fortunately, they both arrive
at the same result!
9.6.1 Matrices
We begin by deÔ¨Åning an axis using a unit vector ÀÜn about which a point P is rotated
Œ± to P ‚Ä≤ as shown in Fig. 9.10. And as we only have access to matrices that rotate
points about the Cartesian axes, this unit vector has to be temporarily aligned with a
Cartesian axis. In the following example we choose the x-axis. During the alignment
process, the point P is subjected to the transforms necessary to align the unit vector
with the x-axis. We then rotate P , Œ± about the x-axis. To complete the operation, the
rotated point is subjected to the transforms that return the unit vector to its original
position. Although matrices provide a powerful tool for undertaking this sort of
Fig. 9.10 The geometry
associated with rotating a
point about an arbitrary axis

9.6
Rotating a Point About an Arbitrary Axis
135
work, it is nevertheless extremely tedious, but is a good exercise for improving one‚Äôs
algebraic skills!
Figure 9.10 shows a point P(x,y,z) to be rotated through an angle Œ± to
P ‚Ä≤(x‚Ä≤,y‚Ä≤,z‚Ä≤) about an axis deÔ¨Åned by
ÀÜn = ai + bj + ck.
The transforms to achieve this operation can be expressed as follows:
‚é°
‚é£
x‚Ä≤
y‚Ä≤
z‚Ä≤
‚é§
‚é¶= R‚àíœÜ,yRŒ∏,zRŒ±,xR‚àíŒ∏,zRœÜ,y
‚é°
‚é£
x
y
z
‚é§
‚é¶
which aligns the axis of rotation with the x-axis, performs the rotation of P through
an angle Œ± about the x-axis, and returns the axis of rotation back to its original
position. Therefore,
RœÜ,y =
‚é°
‚é£
cosœÜ
0
sinœÜ
0
1
0
‚àísinœÜ
0
cosœÜ
‚é§
‚é¶,
R‚àíŒ∏,z =
‚é°
‚é£
cosŒ∏
sinŒ∏
0
‚àísinŒ∏
cosŒ∏
0
0
0
1
‚é§
‚é¶
RŒ±,x =
‚é°
‚é£
1
0
0
0
cosŒ±
‚àísinŒ±
0
sinŒ±
cosŒ±
‚é§
‚é¶,
RŒ∏,z =
‚é°
‚é£
cosŒ∏
‚àísinŒ∏
0
sinŒ∏
cosŒ∏
0
0
0
1
‚é§
‚é¶
R‚àíœÜ,y =
‚é°
‚é£
cosœÜ
0
‚àísinœÜ
0
1
0
sinœÜ
0
cosœÜ
‚é§
‚é¶.
Let
R‚àíœÜ,yRŒ∏,zRŒ±,xR‚àíŒ∏,zRœÜ,y =
‚é°
‚é£
a11
a12
a13
a21
a22
a23
a31
a32
a33
‚é§
‚é¶
where by multiplying the matrices together we Ô¨Ånd that:
a11 = cos2 œÜ cos2 Œ∏ + cos2 œÜ sin2 Œ∏ cosŒ± + sin2 œÜ cosŒ±
a12 = cosœÜ cosŒ∏ sinŒ∏ ‚àícosœÜ sinŒ∏ cosŒ∏ cosŒ± ‚àísinœÜ cosŒ∏ sinŒ±
a13 = cosœÜ sinœÜ cos2 Œ∏ + cosœÜ sinœÜ sin2 Œ∏ cosŒ± + sin2 œÜ sinŒ∏ sinŒ±
+ cos2 œÜ sinŒ∏ sinŒ± ‚àícosœÜ sinœÜ cosŒ±
a21 = sinŒ∏ cosŒ∏ cosœÜ ‚àícosŒ∏ sinŒ∏ cosœÜ cosŒ± + cosŒ∏ sinœÜ sinŒ±
a22 = sin2 Œ∏ + cos2 Œ∏ cosŒ±
a23 = sinŒ∏ cosŒ∏ sinœÜ ‚àícosŒ∏ sinŒ∏ sinœÜ cosŒ± ‚àícosŒ∏ cosœÜ sinŒ±
a31 = cosœÜ sinœÜ cos2 Œ∏ + cosœÜ sinœÜ sin2 Œ∏ cosŒ± ‚àícos2 œÜ sinŒ∏ sinŒ±
‚àícosœÜ sinœÜ cosŒ±
a32 = sinœÜ cosŒ∏ sinŒ∏ ‚àísinœÜ sinŒ∏ cosŒ∏ cosŒ± + cosœÜ cosŒ∏ sinŒ±
a33 = sin2 œÜ cos2 Œ∏ + sin2 œÜ sin2 Œ∏ cosŒ± ‚àícosœÜ sinœÜ sinŒ∏ sinŒ±
+ cosœÜ sinœÜ sinŒ∏ sinŒ± + cos2 œÜ cosŒ±.

136
9
Rotation Transforms in Space
From Fig. 9.10 we compute the sin and cos of Œ∏ and œÜ in terms of a, b and c, and
then compute their equivalent sin2 and cos2 values:
cosŒ∏ =

1 ‚àíb2
‚áí
cos2 Œ∏ = 1 ‚àíb2
sinŒ∏ = b
‚áí
sin2 Œ∏ = b2
cosœÜ = a/

1 ‚àíb2
‚áí
cos2 œÜ = a2/
	
1 ‚àíb2
sinœÜ = c/

1 ‚àíb2
‚áí
sin2 œÜ = c2/
	
1 ‚àíb2
.
To Ô¨Ånd a11:
a11 = cos2 œÜ cos2 Œ∏ + cos2 œÜ sin2 Œ∏ cosŒ± + sin2 œÜ cosŒ±
= a2 + a2b2
1 ‚àíb2 cosŒ± +
c2
1 ‚àíb2 cosŒ±
= a2 +
c2 + a2b2
1 ‚àíb2

cosŒ±
but
a2 + b2 + c2 = 1
‚áí
c2 = 1 ‚àía2 ‚àíb2
a11 = a2 +
1 ‚àía2 ‚àíb2 + a2b2
1 ‚àíb2

cosŒ±
= a2 +
(1 ‚àía2)(1 ‚àíb2)
1 ‚àíb2

cosŒ±
= a2(1 ‚àícosŒ±) + cosŒ±.
Let
K = 1 ‚àícosŒ±
then
a11 = a2K + cosŒ±.
To Ô¨Ånd a12:
a12 = cosœÜ cosŒ∏ sinŒ∏ ‚àícosœÜ sinŒ∏ cosŒ∏ cosŒ± ‚àísinœÜ cosŒ∏ sinŒ±
=
a
‚àö
1 ‚àíb2

1 ‚àíb2b ‚àí
a
‚àö
1 ‚àíb2 b

1 ‚àíb2 cosŒ± ‚àí
c
‚àö
1 ‚àíb2

1 ‚àíb2 sinŒ±
= ab ‚àíab cosŒ± ‚àíc sinŒ±
= ab(1 ‚àícosŒ±) ‚àíc sinŒ±
a12 = abK ‚àíc sinŒ±.

9.6
Rotating a Point About an Arbitrary Axis
137
To Ô¨Ånd a13:
a13 = cosœÜ sinœÜ cos2 Œ∏ + cosœÜ sinœÜ sin2 Œ∏ cosŒ± + sin2 œÜ sinŒ∏ sinŒ±
+ cos2 œÜ sinŒ∏ sinŒ± ‚àícosœÜ sinœÜ cosŒ±
= cosœÜ sinœÜ cos2 Œ∏ + cosœÜ sinœÜ sin2 Œ∏ cosŒ± + sinŒ∏ sinŒ± ‚àícosœÜ sinœÜ cosŒ±
=
a
‚àö
1 ‚àíb2
c
‚àö
1 ‚àíb2
	
1 ‚àíb2
+
a
‚àö
1 ‚àíb2
c
‚àö
1 ‚àíb2 b2 cosŒ± + b sinŒ±
‚àí
a
‚àö
1 ‚àíb2
c
‚àö
1 ‚àíb2 cosŒ±
= ac + ac
b2
(1 ‚àíb2) cosŒ± + b sinŒ± ‚àí
ac
(1 ‚àíb2) cosŒ±
= ac + ac(b2 ‚àí1)
(1 ‚àíb2) cosŒ± + b sinŒ±
= ac(1 ‚àícosŒ±) + b sinŒ±
a13 = acK + b sinŒ±.
Using similar algebraic methods, we discover that:
a21 = abK + c sinŒ±
a22 = b2K + cosŒ±
a23 = bcK ‚àía sinŒ±
a31 = acK ‚àíb sinŒ±
a32 = bcK + a sinŒ±
a33 = c2K + cosŒ±
and our original matrix transform becomes:
‚é°
‚é¢‚é£
x‚Ä≤
p
y‚Ä≤
p
z‚Ä≤
p
‚é§
‚é•‚é¶=
‚é°
‚é£
a2K + cosŒ±
abK ‚àíc sinŒ±
acK + b sinŒ±
abK + c sinŒ±
b2K + cosŒ±
bcK ‚àía sinŒ±
acK ‚àíb sinŒ±
bcK + a sinŒ±
c2K + cosŒ±
‚é§
‚é¶
‚é°
‚é£
xp
yp
zp
‚é§
‚é¶
where
K = 1 ‚àícosŒ±.
9.6.2 Vectors
Now let‚Äôs solve the same problem using vectors. Figure 9.11 shows a view of the
geometry associated with the task at hand. For clariÔ¨Åcation, Fig. 9.12 shows a cross-
section and a plan view of the geometry.
The axis of rotation is given by the unit vector:
ÀÜn = ai + bj + ck.

138
9
Rotation Transforms in Space
Fig. 9.11 A view of the
geometry associated with
rotating a point about an
arbitrary axis
Fig. 9.12 A cross-section
and plan view of the
geometry associated with
rotating a point about an
arbitrary axis
‚Ä¢ P(xp,ypzp) is the point to be rotated by angle Œ± to P ‚Ä≤(x‚Ä≤
p,y‚Ä≤
p, z‚Ä≤
p).
‚Ä¢ O is the origin, whilst p and p‚Ä≤ are position vectors for P and P ‚Ä≤ respectively.
From Fig. 9.11 and Fig. 9.12:
p‚Ä≤ = ‚àí‚àí‚Üí
ON + ‚àí‚àí‚Üí
NQ + ‚àí‚àí‚Üí
QP ‚Ä≤.
To Ô¨Ånd ‚àí‚àí‚Üí
ON:
|n| = |p|cosŒ∏ = ÀÜn ¬∑ p
therefore,
‚àí‚àí‚Üí
ON = n = ÀÜn(ÀÜn ¬∑ p).
To Ô¨Ånd ‚àí‚àí‚Üí
NQ:
‚àí‚àí‚Üí
NQ = NQ
NP r = NQ
NP ‚Ä≤ r = cosŒ± r
but
p = n + r = ÀÜn(ÀÜn ¬∑ p) + r
therefore,
r = p ‚àíÀÜn(ÀÜn ¬∑ p)

9.6
Rotating a Point About an Arbitrary Axis
139
and
‚àí‚àí‚Üí
NQ =
	
p ‚àíÀÜn(ÀÜn ¬∑ p)

cosŒ±.
To Ô¨Ånd ‚àí‚àí‚Üí
QP ‚Ä≤:
Let
ÀÜn √ó p = w
where
|w| = |ÀÜn| ¬∑ |p|sinŒ∏ = |p|sinŒ∏
but
|r| = |p|sinŒ∏
therefore,
|w| = |r|.
Now
QP ‚Ä≤
NP ‚Ä≤ = QP ‚Ä≤
|r| = QP ‚Ä≤
|w| = sinŒ±
therefore,
‚àí‚àí‚Üí
QP ‚Ä≤ = wsinŒ± = ÀÜn √ó psinŒ±
then
p‚Ä≤ = ÀÜn(ÀÜn ¬∑ p) +
	
p ‚àíÀÜn(ÀÜn ¬∑ p)

cosŒ± + ÀÜn √ó psinŒ±
and
p‚Ä≤ = pcosŒ± + ÀÜn(ÀÜn ¬∑ p)(1 ‚àícosŒ±) + ÀÜn √ó psinŒ±.
This is known as the Rodrigues rotation formula, as it was developed by the French
mathematician, Olinde Rodrigues (1795‚Äì1851), who had also invented the ideas be-
hind quaternions before Hamilton. This has been documented by Simon Altmann in
the Mathematics Magazine under the title ‚ÄúHamilton, Rodrigues and the quaternion
scandal‚Äù [7].
If we let
K = 1 ‚àícosŒ±
then
p‚Ä≤ = pcosŒ± + ÀÜn(ÀÜn ¬∑ p)K + ÀÜn √ó psinŒ±
= (xpi + ypj + zpk)cosŒ± + (ai + bj + ck)(axp + byp + czp)K
+
	
(bzp ‚àícyp)i + (cxp ‚àíazp)j + (ayp ‚àíbxp)k

sinŒ±
=
	
xp cosŒ± + a(axp + byp + czp)K + (bzp ‚àícyp)sinŒ±

i
+
	
yp cosŒ± + b(axp + byp + czp)K + (cxp ‚àíazp)sinŒ±

j

140
9
Rotation Transforms in Space
+
	
zp cosŒ± + c(axp + byp + czp)K + (ayp ‚àíbxp)sinŒ±

k
=
	
xp(a2K + cosŒ±) + yp(abK ‚àíc sinŒ±) + zp(acK + b sinŒ±)

i
+
	
xp(abK + c sinŒ±) + yp
	
b2K + cosŒ±

+ zp(bcK ‚àía sinŒ±)

j
+
	
xp(acK ‚àíb sinŒ±) + yp(bcK + a sinŒ±) + zp
	
c2K + cosŒ±


k
and the transform is:
‚é°
‚é£
x‚Ä≤
p
y‚Ä≤
p
z‚Ä≤
p
‚é§
‚é¶=
‚é°
‚é£
a2K + cosŒ±
abK ‚àíc sinŒ±
acK + b sinŒ±
abK + c sinŒ±
b2K + cosŒ±
bcK ‚àía sinŒ±
acK ‚àíb sinŒ±
bcK + a sinŒ±
c2K + cosŒ±
‚é§
‚é¶
‚é°
‚é£
xp
yp
zp
‚é§
‚é¶
which is identical to the transform derived using matrices.
Now let‚Äôs test the transform with a simple example that can be easily veriÔ¨Åed. If
we rotate the point P(10,0,0), 180¬∞ about an axis deÔ¨Åned by n = i + j, it should
end up at P ‚Ä≤(0,10,0).
Therefore
Œ± = 180¬∞,
cosŒ± = ‚àí1,
sinŒ± = 0,
K = 2
a =
‚àö
2
2 ,
b =
‚àö
2
2 ,
c = 0
and
‚é°
‚é£
0
10
0
‚é§
‚é¶=
‚é°
‚é£
0
1
0
1
0
0
0
0
0
‚é§
‚é¶
‚é°
‚é£
10
0
0
‚é§
‚é¶
which is correct.
9.7 Summary
In this chapter we have seen how the 2 √ó 2 matrix for rotating a point in the plane
is developed for rotating points in space. In its simplest form, the rotations are re-
stricted to one of the three Cartesian axes, but by employing homogeneous coor-
dinates, the translation transform can be used to rotate points about an off-set axis
parallel with one of the Cartesian axes.
Composite Euler rotations are created by combining the matrices representing the
individual rotations about three successive axes, for which there are twelve combi-
nations. Unfortunately, one of the problems with such transforms is that they suffer
from gimbal lock, where one degree of freedom is lost under certain angle com-
binations. Another problem, is that it is difÔ¨Åcult to predict how a point moves in
space when animated by a composite transform, although they are widely used for
positioning objects in world space.
We have also seen how to compute the eigenvector associated with a rotation
transform, and how it represents the axis about which rotation occurs, and the eigen-
value represents the angle of rotation.
Finally, matrices and vectors were used to develop a transform for rotating a point
about an arbitrary axis.

9.7
Summary
141
9.7.1 Summary of Matrix Transforms
Translate a point
Ttx,ty,tz =
‚é°
‚é¢‚é¢‚é£
1
0
0
tx
0
1
0
ty
0
0
1
tz
0
0
0
1
‚é§
‚é•‚é•‚é¶.
Rotate a point about the x-, y-, z-axes
RŒ≤,x =
‚é°
‚é¢‚é¢‚é£
1
0
0
0
0
cosŒ≤
‚àísinŒ≤
0
0
sinŒ≤
cosŒ≤
0
0
0
0
1
‚é§
‚é•‚é•‚é¶
RŒ≤,y =
‚é°
‚é¢‚é¢‚é£
cosŒ≤
0
sinŒ≤
0
0
1
0
0
‚àísinŒ≤
0
cosŒ≤
0
0
0
0
1
‚é§
‚é•‚é•‚é¶
RŒ≤,z =
‚é°
‚é¢‚é¢‚é£
cosŒ≤
‚àísinŒ≤
0
0
sinŒ≤
cosŒ≤
0
0
0
0
1
0
0
0
0
1
‚é§
‚é•‚é•‚é¶.
Rotate a point about off-set x-, y-, z-axes
T0,ty,tzRŒ≤,xT0,‚àíty,‚àítz =
‚é°
‚é¢‚é¢‚é£
1
0
0
0
0
cosŒ≤
‚àísinŒ≤
ty(1 ‚àícosŒ≤) + tz sinŒ≤
0
sinŒ≤
cosŒ≤
tz(1 ‚àícosŒ≤) ‚àíty sinŒ≤
0
0
0
1
‚é§
‚é•‚é•‚é¶
Ttx,0,tzRŒ≤,yT‚àítx,0,‚àítz =
‚é°
‚é¢‚é¢‚é£
cosŒ≤
0
sinŒ≤
tx(1 ‚àícosŒ≤) ‚àítz sinŒ≤
0
1
0
0
‚àísinŒ≤
0
cosŒ≤
tz(1 ‚àícosŒ≤) + tx sinŒ≤
0
0
0
1
‚é§
‚é•‚é•‚é¶
Ttx,ty,0RŒ≤,zT‚àítx,‚àíty,0 =
‚é°
‚é¢‚é¢‚é£
cosŒ≤
‚àísinŒ≤
0
tx(1 ‚àícosŒ≤) + ty sinŒ≤
sinŒ≤
cosŒ≤
0
ty(1 ‚àícosŒ≤) ‚àítx sinŒ≤
0
0
1
0
0
0
0
1
‚é§
‚é•‚é•‚é¶.
Rotate a point about an arbitrary axis
p‚Ä≤ = pcosŒ± + ÀÜn(ÀÜn ¬∑ p)(1 ‚àícosŒ±) + ÀÜn √ó psinŒ±
RŒ±,ÀÜn =
‚é°
‚é£
a2K + cosŒ±
abK ‚àíc sinŒ±
acK + b sinŒ±
abK + c sinŒ±
b2K + cosŒ±
bcK ‚àía sinŒ±
acK ‚àíb sinŒ±
bcK + a sinŒ±
c2K + cosŒ±
‚é§
‚é¶
K = 1 ‚àícosŒ±
ÀÜn = ai + bj + ck.

142
9
Rotation Transforms in Space
Extracting the angle and axis of rotation from a transform
RŒ±,v =
‚é°
‚é£
a11
a12
a13
a21
a22
a23
a31
a32
a33
‚é§
‚é¶
Œ± = arccos((Tr(RŒ±,v) ‚àí1)/2)
v = v1i + v2j + v3k
v1 = (a22 ‚àí1)(a33 ‚àí1) ‚àía23a32
v2 = (a33 ‚àí1)(a11 ‚àí1) ‚àía31a13
v3 = (a11 ‚àí1)(a22 ‚àí1) ‚àía12a21.

Chapter 10
Frames of Reference in Space
10.1 Introduction
In Chap. 8 we discovered how to compute the coordinates of a point in a frame of
reference in the plane. In this chapter we study the same problem but in 3D space.
Again, we employ many of the concepts previously described in order to develop
the transforms for translating and rotating frames in space.
The relativity of motion, previously discussed, implies that we cannot absolutely
claim that one frame of reference is stationary whilst another is in motion ‚Äì it is sim-
ply a question of interpretation and convenience. Fortunately, a matrix transform can
be used to support moving points and moving frames, which means that the trans-
form used for rotating a point in a Ô¨Åxed frame of reference, can be used for rotating
the frame of reference in the opposite direction, whilst keeping the point Ô¨Åxed.
In a 3D space context, this implies that the rotation transform RŒ±,x, which rotates
a point Œ± about the Ô¨Åxed x-axis, can be used to rotate the frame of reference ‚àíŒ±
about the x-axis, whilst the point remains Ô¨Åxed. Similarly, the rotation transform
R‚àíŒ±,x, which rotates a point ‚àíŒ± about the Ô¨Åxed x-axis, can also be used to rotate
the frame of reference Œ± about the x-axis, whilst the point remains Ô¨Åxed.
We employ a simple notation to distinguish transforms that rotate points from
those that rotate frames. For example, RŒ±,x rotates a point Œ± about the x-axis,
whilst R‚àí1
Œ±,x rotates a frame Œ± about the x-axis. Similarly, R‚àíŒ±,x rotates a point ‚àíŒ±
about the x-axis, whilst R‚àí1
‚àíŒ±,x rotates a frame ‚àíŒ± about the x-axis. Also, Ttx,ty,tz
translates a point (tx,ty,tz), whilst T‚àí1
tx,ty,tz translates a frame (tx,ty,tz). Similarly,
T‚àítx,‚àíty,‚àítz translates a point (‚àítx,‚àíty,‚àítz), whilst T‚àí1
‚àítx,‚àíty,‚àítz translates a frame
(‚àítx,‚àíty,‚àítz).
10.2 Frames of Reference
We have already discussed frames of reference in Chap. 8, and even though the
frames were 2D, the same ideas can be generalised to 3D space without having to
introduce any new concepts ‚Äì we simply add an extra z-coordinate.
J. Vince, Rotation Transforms for Computer Graphics,
DOI 10.1007/978-0-85729-154-7_10, ¬© Springer-Verlag London Limited 2011
143

144
10
Frames of Reference in Space
Fig. 10.1 The point P is
translated by (tx,ty,tz) with a
Ô¨Åxed frame
10.3 Matrix Transforms
In general, if points in the frame X‚Ä≤Y ‚Ä≤Z‚Ä≤ are related to points in the frame XYZ by
the transform A using
P = AP ‚Ä≤,
then a point P in XYZ has coordinates in X‚Ä≤Y ‚Ä≤Z‚Ä≤ using
P ‚Ä≤ = A‚àí1P.
In computer graphics most frame of reference transforms involve a translation or
a rotation, or a combination of both. We now explore these different scenarios and
develop transforms for converting coordinates in the original frame of reference to
another frame.
10.3.1 Translated Frames of Reference
Figure 10.1 shows a point P translated by (tx,ty,tz) to P ‚Ä≤ using the transform
Ttx,ty,tz
Ttx,ty,tz =
‚é°
‚é¢‚é¢‚é£
1
0
0
tx
0
1
0
ty
0
0
1
tz
0
0
0
1
‚é§
‚é•‚é•‚é¶
where the translated point P ‚Ä≤ is given by
P ‚Ä≤ = Ttx,ty,tzP.
Thus the coordinates of P are updated relative to the Ô¨Åxed frame of reference XYZ.
However, there is a second interpretation for Ttx,ty,tz, where P remains Ô¨Åxed and
the frame of reference XYZ is translated by (‚àítx,‚àíty,‚àítz), as shown in Fig. 10.2.
Consequently, the point P(x,y,z) in XYZ has coordinates P ‚Ä≤(x‚Ä≤,y‚Ä≤,z‚Ä≤) in X‚Ä≤Y ‚Ä≤Z‚Ä≤
given by
P ‚Ä≤ = T‚àí1
‚àítx,‚àíty,‚àítzP.

10.3
Matrix Transforms
145
Fig. 10.2 The point P
remains Ô¨Åxed whilst the
frame XYZ is translated
(‚àítx,‚àíty,‚àítz)
For example, the origin of XYZ becomes (tx,ty,tz) in X‚Ä≤Y ‚Ä≤Z‚Ä≤:
‚é°
‚é¢‚é¢‚é£
tx
ty
tz
1
‚é§
‚é•‚é•‚é¶=
‚é°
‚é¢‚é¢‚é£
1
0
0
tx
0
1
0
ty
0
0
1
tz
0
0
0
1
‚é§
‚é•‚é•‚é¶
‚é°
‚é¢‚é¢‚é£
0
0
0
1
‚é§
‚é•‚é•‚é¶.
Therefore, the transform for translating a frame by (tx,ty,tz) is
T‚àí1
tx,ty,tz =
‚é°
‚é¢‚é¢‚é£
1
0
0
‚àítx
0
1
0
‚àíty
0
0
1
‚àítz
0
0
0
1
‚é§
‚é•‚é•‚é¶.
Now we consider rotated frames of reference in space.
10.3.2 Rotated Frames of Reference About Cartesian Axes
A 2D frame of reference can only be rotated within its plane, whereas a 3D frame
can be rotated about any axis, whether it be a Cartesian axis or some arbitrary axis.
Let‚Äôs look at how RŒ±,x behaves when rotating frames about the x-axis, and apply
the results to the other axes.
We know that we can rotate a point, Œ± about the x-axis using
RŒ±,x =
‚é°
‚é£
1
0
0
0
cosŒ±
‚àísinŒ±
0
sinŒ±
cosŒ±
‚é§
‚é¶.
However, RŒ±,x can also be used to rotate a frame ‚àíŒ± about the x-axis. Similarly,
R‚àí1
Œ±,x rotates a frame Œ± about the same axis. Therefore, in general, we can use the
same technique for all three Cartesian axes.
Figure 10.3 (a) and (b) show our unit cube rotated by ‚àí90¬∞ about the x-axis,
whilst (c) and (d) show the frame rotated 90¬∞ about the same axis, with the cube
Ô¨Åxed.

146
10
Frames of Reference in Space
Fig. 10.3 (a) and (b) The cube is rotated ‚àí90¬∞. (c) and (d) The XYZ frame is rotated 90¬∞
The transform for R‚àí1
90¬∞,x is
R‚àí1
90¬∞,x = R‚àí90¬∞,x =
‚é°
‚é£
1
0
0
0
0
1
0
‚àí1
0
‚é§
‚é¶
which when used on the cube‚Äôs coordinates create
‚é°
‚é£
1
0
0
0
0
1
0
‚àí1
0
‚é§
‚é¶
‚é°
‚é£
0
0
0
0
1
1
1
1
0
0
1
1
0
0
1
1
0
1
0
1
0
1
0
1
‚é§
‚é¶
=
‚é°
‚é£
0
0
0
0
1
1
1
1
0
1
0
1
0
1
0
1
0
0
‚àí1
‚àí1
0
0
‚àí1
‚àí1
‚é§
‚é¶
which are conÔ¨Årmed by Fig. 10.3 (d).
In summary, the transforms for rotating frames Œ± about the x-, y- and z-axes are:
R‚àí1
Œ±,x =
‚é°
‚é£
1
0
0
0
cosŒ±
sinŒ±
0
‚àísinŒ±
cosŒ±
‚é§
‚é¶
R‚àí1
Œ±,y =
‚é°
‚é£
cosŒ±
0
‚àísinŒ±
0
1
0
sinŒ±
0
cosŒ±
‚é§
‚é¶

10.3
Matrix Transforms
147
Fig. 10.4 (a) and (b) The off-set axis and rotated frame. (c) and (d) The unit cube and rotated
frame
R‚àí1
Œ±,z =
‚é°
‚é£
cosŒ±
sinŒ±
0
‚àísinŒ±
cosŒ±
0
0
0
1
‚é§
‚é¶.
10.3.3 Rotated Frames About Off-Set Axes
In Chap. 9 we developed three transforms for rotating a point about an off-set axis
parallel with one of the three Cartesian axes. Let‚Äôs develop three complementary
transforms for rotating a frame about the same off-set axes.
To ensure that we compute the correct transform, we must be very clear in our
own minds what we are attempting to do. The objective is to identify an off-set axis
parallel with the z-axis, for example, in the current XYZ frame of reference, about
which a frame is rotated. The Ô¨Årst step, then, is to translate the frame, and then
rotate it.
Let‚Äôs assume that the axis passes through the point (tx,ty,0), as shown in
Fig. 10.4 (a). Therefore, given the following deÔ¨Ånitions for T‚àí1
tx,ty,0 and R‚àí1
Œ±,z
T‚àí1
tx,ty,0 =
‚é°
‚é¢‚é¢‚é£
1
0
0
‚àítx
0
1
0
‚àíty
0
0
1
0
0
0
0
1
‚é§
‚é•‚é•‚é¶

148
10
Frames of Reference in Space
R‚àí1
Œ±,z =
‚é°
‚é¢‚é¢‚é£
cosŒ±
sinŒ±
0
0
‚àísinŒ±
cosŒ±
0
0
0
0
1
0
0
0
0
1
‚é§
‚é•‚é•‚é¶
R‚àí1
Œ±,zT‚àí1
tx,ty,0 =
‚é°
‚é¢‚é¢‚é£
cosŒ±
sinŒ±
0
‚àítx cosŒ± ‚àíty sinŒ±
‚àísinŒ±
cosŒ±
0
‚àíty cosŒ± + tx sinŒ±
0
0
1
0
0
0
0
1
‚é§
‚é•‚é•‚é¶.
Let‚Äôs test this transform by making Œ± = 90¬∞, and tx = ty = 1, as shown in
Fig. 10.4 (b):
R‚àí1
90¬∞,zT‚àí1
1,1,0 =
‚é°
‚é¢‚é¢‚é£
0
1
0
‚àí1
‚àí1
0
0
1
0
0
1
0
0
0
0
1
‚é§
‚é•‚é•‚é¶
which, if used on the unit cube shown in Fig. 10.4 (c), produces
‚é°
‚é¢‚é¢‚é£
0
1
0
‚àí1
‚àí1
0
0
1
0
0
1
0
0
0
0
1
‚é§
‚é•‚é•‚é¶
‚é°
‚é¢‚é¢‚é£
0
0
0
0
1
1
1
1
0
0
1
1
0
0
1
1
0
1
0
1
0
1
0
1
1
1
1
1
1
1
1
1
‚é§
‚é•‚é•‚é¶
=
‚é°
‚é¢‚é¢‚é£
‚àí1
‚àí1
0
0
‚àí1
‚àí1
0
0
1
1
1
1
0
0
0
0
0
1
0
1
0
1
0
1
1
1
1
1
1
1
1
1
‚é§
‚é•‚é•‚é¶
as conÔ¨Årmed by Fig. 10.4 (d).
Let‚Äôs explore what happens if we swap the rotation and translation transforms to
T‚àí1
tx,ty,0R‚àí1
Œ±,z. This now implies that the frame of reference is rotated Œ± about the z-
axis, and then translated (tx,ty,0) in the rotated frame‚Äôs space, which is not what we
had planned. Here are the three transforms for rotating a frame of reference about
an off-set axis:
R‚àí1
Œ±,xT‚àí1
0,ty,tz =
‚é°
‚é¢‚é¢‚é£
1
0
0
0
0
cosŒ±
sinŒ±
‚àíty cosŒ± ‚àítz sinŒ±
0
‚àísinŒ±
cosŒ±
‚àítz cosŒ± + ty sinŒ±
0
0
0
1
‚é§
‚é•‚é•‚é¶
R‚àí1
Œ±,yT‚àí1
tx,0,tz =
‚é°
‚é¢‚é¢‚é£
cosŒ±
0
‚àísinŒ±
‚àítx cosŒ± + tz sinŒ±
0
1
0
0
sinŒ±
0
cosŒ±
‚àítz cosŒ± ‚àítx sinŒ±
0
0
0
1
‚é§
‚é•‚é•‚é¶
R‚àí1
Œ±,zT‚àí1
tx,ty,0 =
‚é°
‚é¢‚é¢‚é£
cosŒ±
sinŒ±
0
‚àítx cosŒ± ‚àíty sinŒ±
‚àísinŒ±
cosŒ±
0
‚àíty cosŒ± + tx sinŒ±
0
0
1
0
0
0
0
1
‚é§
‚é•‚é•‚é¶.

10.4
Composite Rotations
149
10.4 Composite Rotations
In Chap. 9 we went into some detail describing how point rotation transforms can be
combined into composite rotations about the three Cartesian axes. There are twelve
possible combinations that are listed in Appendix A. As any rotation transform can
be used to rotate a point in one direction, or a frame of reference in the opposite
direction, the previously computed composite transforms for rotating points, can be
used for rotating frames in the opposite direction.
For example, we previously computed RŒ≥,zRŒ≤,yRŒ±,x:
RŒ≥,zRŒ≤,yRŒ±,x =
‚é°
‚é£
cŒ≥ cŒ≤
cŒ≥ sŒ≤sŒ± ‚àísŒ≥ cŒ±
cŒ≥ sŒ≤cŒ± + sŒ≥ sŒ±
sŒ≥ cŒ≤
sŒ≥ sŒ≤sŒ± + cŒ≥ cŒ±
sŒ≥ sŒ≤cŒ± ‚àícŒ≥ sŒ±
‚àísŒ≤
cŒ≤sŒ±
cŒ≤cŒ±
‚é§
‚é¶
which rotates a point about a Ô¨Åxed frame of reference. But it can also be used to
rotate a frame of reference in the opposite directions:
R‚àí1
‚àíŒ≥,zR‚àí1
‚àíŒ≤,yR‚àí1
‚àíŒ±,x =
‚é°
‚é£
cŒ≥ cŒ≤
cŒ≥ sŒ≤sŒ± ‚àísŒ≥ cŒ±
cŒ≥ sŒ≤cŒ± + sŒ≥ sŒ±
sŒ≥ cŒ≤
sŒ≥ sŒ≤sŒ± + cŒ≥ cŒ±
sŒ≥ sŒ≤cŒ± ‚àícŒ≥ sŒ±
‚àísŒ≤
cŒ≤sŒ±
cŒ≤cŒ±
‚é§
‚é¶.
In order to compute R‚àí1
Œ≥,zR‚àí1
Œ≤,yR‚àí1
Œ±,x we only have to reverse the sign of the sine terms
in the transform for RŒ≥,zRŒ≤,yRŒ±,x:
R‚àí1
Œ≥,zR‚àí1
Œ≤,yR‚àí1
Œ±,x =
‚é°
‚é£
cŒ≥ cŒ≤
cŒ≥ sŒ≤sŒ± + sŒ≥ cŒ±
‚àícŒ≥ sŒ≤cŒ± + sŒ≥ sŒ±
‚àísŒ≥ cŒ≤
‚àísŒ≥ sŒ≤sŒ± + cŒ≥ cŒ±
sŒ≥ sŒ≤cŒ± + cŒ≥ sŒ±
sŒ≤
‚àícŒ≤sŒ±
cŒ≤cŒ±
‚é§
‚é¶. (10.1)
Let‚Äôs test (10.1) by making Œ± = Œ≤ = Œ≥ = 90¬∞:
R‚àí1
90¬∞,zR‚àí1
90¬∞,yR‚àí1
90¬∞,x =
‚é°
‚é£
0
0
1
0
‚àí1
0
1
0
0
‚é§
‚é¶.
Figure 10.5 (a) shows the initial scenario, Fig. 10.5 (b) shows the frame rotated 90¬∞
about the local x-axis, Fig. 10.5 (c) shows the frame rotated 90¬∞ about the local
y-axis, and Fig. 10.5 (d) shows the frame rotated 90¬∞ about the local z-axis. If we
subject the coordinates of the unit cube to this composite transform we have
‚é°
‚é£
0
0
1
0
‚àí1
0
1
0
0
‚é§
‚é¶
‚é°
‚é£
0
0
0
0
1
1
1
1
0
0
1
1
0
0
1
1
0
1
0
1
0
1
0
1
‚é§
‚é¶
=
‚é°
‚é£
0
1
0
1
0
1
0
1
0
0
‚àí1
‚àí1
0
0
‚àí1
‚àí1
0
0
0
0
1
1
1
1
‚é§
‚é¶
which are conÔ¨Årmed by Fig. 10.5 (d).

150
10
Frames of Reference in Space
Fig. 10.5 (a) The original frame. (b) Rotated frame about the x-axis. (c) Rotated frame about the
y-axis. (d) Rotated frame about the z-axis
Note that this speciÔ¨Åc transform also suffers from gimbal lock, where it is impos-
sible to rotate the cube through an axis passing through vertices 0 and 2. Whereas,
the cube is rotated twice about the axis passing through vertices 0 and 4. Effec-
tively, the axial system has been rotated 180¬∞ about the vector [1 0 1]T, which could
be conÔ¨Årmed by calculating the eigenvalue and eigenvector.
10.5 Rotated and Translated Frames of Reference
One of the most important frame changing transforms in cgi enables us to view an
object from any location in space. The transform uses a rotation, which is often a
composite transform, for example R‚àí1
Œ≥,zR‚àí1
Œ≤,yR‚àí1
Œ±,x, and a translation T‚àí1
tx,ty,tz. And as
the position of the translated frame is normally speciÔ¨Åed in the original frame, we
begin by translating the frame followed by the rotation:
‚é°
‚é¢‚é¢‚é£
cŒ≥ cŒ≤
cŒ≥ sŒ≤sŒ± + sŒ≥ cŒ±
‚àícŒ≥ sŒ≤cŒ± + sŒ≥ sŒ±
0
‚àísŒ≥ cŒ≤
‚àísŒ≥ sŒ≤sŒ± + cŒ≥ cŒ±
sŒ≥ sŒ≤cŒ± + cŒ≥ sŒ±
0
sŒ≤
‚àícŒ≤sŒ±
cŒ≤cŒ±
0
0
0
0
1
‚é§
‚é•‚é•‚é¶
‚é°
‚é¢‚é¢‚é£
1
0
0
‚àítx
0
1
0
‚àíty
0
0
1
‚àítz
0
0
0
1
‚é§
‚é•‚é•‚é¶. (10.2)
It is not worth multiplying these matrices together as it creates too many terms.
However, we can test it with a simple example.

10.5
Rotated and Translated Frames of Reference
151
Fig. 10.6 (a) The translated frame. (b) The rotated frame about the y-axis
Using the unit cube, let‚Äôs position the new frame 2 units along the initial x-axis,
and then rotate the frame 270¬∞ about its local y-axis so that its z-axis is looking
back towards the original origin. Figure 10.6 (a) shows the translated frame, and
Fig. 10.6 (b) shows the rotated frame. Thus tx = 2, ty = tz = 0, Œ± = 0¬∞, Œ≤ = 270¬∞
and Œ≥ = 0¬∞. Substituting these values in (10.2) we have
R‚àí1
0¬∞,zR‚àí1
270¬∞,yR‚àí1
0¬∞,xT‚àí1
2,0,0 =
‚é°
‚é¢‚é¢‚é£
0
0
1
0
0
1
0
0
‚àí1
0
0
0
0
0
0
1
‚é§
‚é•‚é•‚é¶
‚é°
‚é¢‚é¢‚é£
1
0
0
‚àí2
0
1
0
0
0
0
1
0
0
0
0
1
‚é§
‚é•‚é•‚é¶
(10.3)
=
‚é°
‚é¢‚é¢‚é£
0
0
1
0
0
1
0
0
‚àí1
0
0
2
0
0
0
1
‚é§
‚é•‚é•‚é¶.
(10.4)
Using (10.4) to process the coordinates of the unit cube we have
‚é°
‚é¢‚é¢‚é£
0
0
1
0
0
1
0
0
‚àí1
0
0
2
0
0
0
1
‚é§
‚é•‚é•‚é¶
‚é°
‚é¢‚é¢‚é£
0
0
0
0
1
1
1
1
0
0
1
1
0
0
1
1
0
1
0
1
0
1
0
1
1
1
1
1
1
1
1
1
‚é§
‚é•‚é•‚é¶
=
‚é°
‚é¢‚é¢‚é£
0
1
0
1
0
1
0
1
0
0
1
1
0
0
1
1
2
2
2
2
1
1
1
1
1
1
1
1
1
1
1
1
‚é§
‚é•‚é•‚é¶
which are conÔ¨Årmed by Fig. 10.6 (b).
To obtain a perspective view of the cube we simply divide its transformed x- and
y-coordinates by the associated z-coordinate:
‚é°
‚é¢‚é¢‚é£
0
0.5
0
0.5
0
1
0
1
0
0
0.5
0.5
0
0
1
1
2
2
2
2
1
1
1
1
1
1
1
1
1
1
1
1
‚é§
‚é•‚é•‚é¶

152
10
Frames of Reference in Space
Fig. 10.7 Perspective view
of the unit cube
and as the x-axis of the display screen is in the opposite direction to that of the
frame, we have to switch the sign of the x-coordinates:
‚é°
‚é¢‚é¢‚é£
0
‚àí0.5
0
‚àí0.5
0
‚àí1
0
‚àí1
0
0
0.5
0.5
0
0
1
1
2
2
2
2
1
1
1
1
1
1
1
1
1
1
1
1
‚é§
‚é•‚é•‚é¶.
The x- and y-coordinates are used in Fig. 10.7 to show the perspective view seen
from this translated, rotated frame.
10.6 Rotated Frames of Reference About Arbitrary Axes
In Chap. 9 we developed the following transform to rotate a point Œ± about an arbi-
trary axis ÀÜn:
RŒ±,ÀÜn =
‚é°
‚é£
a2K + cosŒ±
abK ‚àíc sinŒ±
acK + b sinŒ±
abK + c sinŒ±
b2K + cosŒ±
bcK ‚àía sinŒ±
acK ‚àíb sinŒ±
bcK + a sinŒ±
c2K + cosŒ±
‚é§
‚é¶
K = 1 ‚àícosŒ±
ÀÜn = ai + bj + ck.
Therefore, there is nothing to stop us using the same transform to rotate a frame ‚àíŒ±
about ÀÜn, or its inverse R‚àí1
Œ±,ÀÜn to rotate a frame Œ± about ÀÜn. To compute the latter, we
simply transpose the matrix, or change the sign of Œ± which implies reversing the
sign of the sine terms:
R‚àí1
Œ±,ÀÜn =
‚é°
‚é£
a2K + cosŒ±
abK + c sinŒ±
acK ‚àíb sinŒ±
abK ‚àíc sinŒ±
b2K + cosŒ±
bcK + a sinŒ±
acK + b sinŒ±
bcK ‚àía sinŒ±
c2K + cosŒ±
‚é§
‚é¶.
(10.5)
Let‚Äôs test (10.5) using the previous example where we rotated a frame 270¬∞ about
the y-axis, which makes Œ± = 270¬∞, ÀÜn = j and K = 1:
R‚àí1
270¬∞,j =
‚é°
‚é£
0
0
1
0
1
0
‚àí1
0
0
‚é§
‚é¶

10.7
Summary
153
which agrees perfectly. Naturally, this can be combined with a translation transform
using
R‚àí1
Œ±,ÀÜnT‚àí1
tx,ty,tz =
‚é°
‚é¢‚é¢‚é£
a2K + cosŒ±
abK + c sinŒ±
acK ‚àíb sinŒ±
0
abK ‚àíc sinŒ±
b2K + cosŒ±
bcK + a sinŒ±
0
acK + b sinŒ±
bcK ‚àía sinŒ±
c2K + cosŒ±
0
0
0
0
1
‚é§
‚é•‚é•‚é¶
√ó
‚é°
‚é¢‚é¢‚é£
1
0
0
‚àítx
0
1
0
‚àíty
0
0
1
‚àítz
0
0
0
1
‚é§
‚é•‚é•‚é¶.
10.7 Summary
Hopefully, this chapter has covered most of the scenarios involving rotated and
translated frames of reference in 3D space. Although composite rotation transforms
offer a powerful mechanism for creating complex rotations, they are difÔ¨Åcult to
visualise and suffer from gimbal lock. Perhaps, the most useful transform is for ro-
tating a frame about an arbitrary axis. For completeness, the important transforms
are summarised below.
10.7.1 Summary of Transforms
Translating a frame
T‚àí1
tx,ty,tz =
‚é°
‚é¢‚é¢‚é£
1
0
0
‚àítx
0
1
0
‚àíty
0
0
1
‚àítz
0
0
0
1
‚é§
‚é•‚é•‚é¶.
Rotating a frame about a Cartesian axis
R‚àí1
Œ±,x =
‚é°
‚é£
1
0
0
0
cosŒ±
sinŒ±
0
‚àísinŒ±
cosŒ±
‚é§
‚é¶
R‚àí1
Œ±,y =
‚é°
‚é£
cosŒ±
0
‚àísinŒ±
0
1
0
sinŒ±
0
cosŒ±
‚é§
‚é¶
R‚àí1
Œ±,z =
‚é°
‚é£
cosŒ±
sinŒ±
0
‚àísinŒ±
cosŒ±
0
0
0
1
‚é§
‚é¶.

154
10
Frames of Reference in Space
Rotating a frame about an off-set axis
R‚àí1
Œ±,xT‚àí1
0,ty,tz =
‚é°
‚é¢‚é¢‚é£
1
0
0
0
0
cosŒ±
sinŒ±
‚àíty cosŒ± ‚àítz sinŒ±
0
‚àísinŒ±
cosŒ±
‚àítz cosŒ± + ty sinŒ±
0
0
0
1
‚é§
‚é•‚é•‚é¶
R‚àí1
Œ±,yT‚àí1
tx,0,tz =
‚é°
‚é¢‚é¢‚é£
cosŒ±
0
‚àísinŒ±
‚àítx cosŒ± + tz sinŒ±
0
1
0
0
sinŒ±
0
cosŒ±
‚àítz cosŒ± ‚àítx sinŒ±
0
0
0
1
‚é§
‚é•‚é•‚é¶
R‚àí1
Œ±,zT‚àí1
tx,ty,0 =
‚é°
‚é¢‚é¢‚é£
cosŒ±
sinŒ±
0
‚àítx cosŒ± ‚àíty sinŒ±
‚àísinŒ±
cosŒ±
0
‚àíty cosŒ± + tx sinŒ±
0
0
1
0
0
0
0
1
‚é§
‚é•‚é•‚é¶.
Rotating a frame using a composite transform
R‚àí1
Œ≥,zR‚àí1
Œ≤,yR‚àí1
Œ±,x =
‚é°
‚é£
cŒ≥ cŒ≤
cŒ≥ sŒ≤sŒ± + sŒ≥ cŒ±
‚àícŒ≥ sŒ≤cŒ± + sŒ≥ sŒ±
‚àísŒ≥ cŒ≤
‚àísŒ≥ sŒ≤sŒ± + cŒ≥ cŒ±
sŒ≥ sŒ≤cŒ± + cŒ≥ sŒ±
sŒ≤
‚àícŒ≤sŒ±
cŒ≤cŒ±
‚é§
‚é¶.
Rotating and translating a frame
R‚àí1
Œ≥,zR‚àí1
Œ≤,yR‚àí1
Œ±,xT‚àí1
tx,ty,tz =
‚é°
‚é¢‚é¢‚é£
cŒ≥ cŒ≤
cŒ≥ sŒ≤sŒ± + sŒ≥ cŒ±
‚àícŒ≥ sŒ≤cŒ± + sŒ≥ sŒ±
0
‚àísŒ≥ cŒ≤
‚àísŒ≥ sŒ≤sŒ± + cŒ≥ cŒ±
sŒ≥ sŒ≤cŒ± + cŒ≥ sŒ±
0
sŒ≤
‚àícŒ≤sŒ±
cŒ≤cŒ±
0
0
0
0
1
‚é§
‚é•‚é•‚é¶
√ó
‚é°
‚é¢‚é¢‚é£
1
0
0
‚àítx
0
1
0
‚àíty
0
0
1
‚àítz
0
0
0
1
‚é§
‚é•‚é•‚é¶.
Rotating a frame about an arbitrary axis
R‚àí1
Œ±,ÀÜn =
‚é°
‚é£
a2K + cosŒ±
abK + c sinŒ±
acK ‚àíb sinŒ±
abK ‚àíc sinŒ±
b2K + cosŒ±
bcK + a sinŒ±
acK + b sinŒ±
bcK ‚àía sinŒ±
c2K + cosŒ±
‚é§
‚é¶
K = 1 ‚àícosŒ±
ÀÜn = ai + bj + ck.

Chapter 11
Quaternion Transforms in Space
11.1 Introduction
Quaternions were introduced in Chap. 5 as a mathematical object that combines a
scalar with a vector, in the same way a complex number combines a scalar with an
imaginary quantity. Quaternions, like complex numbers, possess rotational qualities,
but work in four dimensions rather than on the complex plane.
Hamilton invented quaternions in October 1843, and by December of the same
year his friend, John T. Graves, had invented octonions. Arthur Cayley had also
been intrigued by Hamilton‚Äôs quaternions, and independently discovered octonions
in 1845.
There are four such composition algebras: real R, complex C, quaternion H,
and octonion O that obey an n-square identity used to compute their magnitudes.
Adolf Hurwitz (1859‚Äì1919) proved that the product of the sum of n squares by
the sum of n squares is the sum of n squares only when n is equal to 1, 2, 4 and
8, which are represented by reals, complex, quaternions and octonions. No other
system is possible, which shows how important quaternions are within the realm of
mathematics. Appendix C provides further information on this topic.
In this chapter we investigate how quaternions are used to rotate 3D vectors about
an arbitrary axis.
11.2 DeÔ¨Ånition
A quaternion q is the union of a scalar and a vector:
q = s + v
where s is a scalar and v is a 3D vector. If we express the vector v in terms of its
components, we have
q = s + xi + yj + zk
where s,x,y and z are all real numbers.
J. Vince, Rotation Transforms for Computer Graphics,
DOI 10.1007/978-0-85729-154-7_11, ¬© Springer-Verlag London Limited 2011
155

156
11
Quaternion Transforms in Space
Fig. 11.1 Three orthogonal
vectors u, ÀÜv and ÀÜv √ó u
Hamilton had hoped that a quaternion could be used like a complex rotor, where
we saw in Chap. 2 that
RŒ∏ = cosŒ∏ + i sinŒ∏
rotates a complex number by Œ∏. Could the product of a quaternion q and a vector u
rotate u about the quaternion‚Äôs vector? Well yes, but only in a restricted sense. To
understand this, consider the scenario where we form the product of a unit quater-
nion q and a pure quaternion p. The unit quaternion q is deÔ¨Åned as
q = s + ŒªÀÜv
where
s2 + Œª2 = 1
and the pure quaternion p encodes the vector u with a zero scalar term
p = 0 + u.
In Chap. 5 we computed product qp, which in this context is
qp = (s + ŒªÀÜv)(0 + u)
= ‚àíŒªÀÜv ¬∑ u + su + ŒªÀÜv √ó u.
However, if ÀÜv is orthogonal to u, the dot product term ‚àíŒªÀÜv ¬∑ u vanishes, and we are
left with
qp = su + ŒªÀÜv √ó u.
Figure 11.1 illustrates this scenario, where u is perpendicular to ÀÜv, and ÀÜv √ó u is
perpendicular to the plane containing u and ÀÜv.
Now because ÀÜv is a unit vector, the length of ÀÜv √ó u is |u|, which means that we
have two orthogonal vectors, i.e. u and ÀÜv √ó u, with the same length. Therefore, to
rotate u about ÀÜv, all that we have to do is to substitute cosŒ∏ for s and sinŒ∏ for Œª:
qp = cosŒ∏u + sinŒ∏ ÀÜv √ó u.
For example, if we create a quaternion whose vector is aligned with the z-axis as
shown in Fig. 11.2 with
q = cosŒ∏ + sinŒ∏k

11.2
DeÔ¨Ånition
157
Fig. 11.2 The vector 2i is
rotated 45¬∞ by the quaternion
q = cosŒ∏ + sinŒ∏k
and a pure quaternion to represent the vector 2i
p = 0 + 2i
then
qp = 2cosŒ∏i + sinŒ∏k √ó 2i.
With Œ∏ = 45¬∞ then
qp = 2
‚àö
2
2 i +
‚àö
2
2 k √ó 2i
=
‚àö
2i +
‚àö
2j
which is a pure quaternion, i.e. a vector, and p has been rotated 45¬∞.
Let‚Äôs see what happens when Œ∏ = 180¬∞:
qp = 2cos180¬∞i + sin180¬∞k √ó 2i = ‚àí2i
which is also a pure quaternion, and p has been rotated 180¬∞. Note that the vector has
not been scaled during the rotation. This is because we are using a unit quaternion.
Now let‚Äôs see what happens when we reduce the angle between ÀÜv and p. Let‚Äôs
reduce the angle to 45¬∞ and retain the quaternion‚Äôs magnitude at unity, as shown in
Fig. 11.3. Therefore,
ÀÜv = 1
‚àö
2
i + 1
‚àö
2
k
q = cosŒ∏ + sinŒ∏
 1
‚àö
2
i + 1
‚àö
2
k

p = 0 + 2i.
This time we must include the dot product term:
qp = ‚àísinŒ∏ ÀÜv ¬∑ u + cosŒ∏u + sinŒ∏ ÀÜv √ó u.
We let Œ∏ = 45¬∞
qp = ‚àí
‚àö
2
2
 1
‚àö
2
i + 1
‚àö
2
k

¬∑ (2i) +
‚àö
2
2 2i +
‚àö
2
2
 1
‚àö
2
i + 1
‚àö
2
k

√ó 2i
= ‚àí1 +
‚àö
2i + j

158
11
Quaternion Transforms in Space
Fig. 11.3 Rotating the vector
2i by the quaternion
q = cosŒ∏ + sinŒ∏( 1
‚àö
2i +
1
‚àö
2k)
which, unfortunately, is not a pure quaternion. It has not been rotated 45¬∞ and the
vector‚Äôs magnitude is reduced to
‚àö
3! Multiplying the vector by a non-orthogonal
quaternion seems to have converted some of the vector information into the quater-
nion‚Äôs scalar component.
Not to worry. Could it be that an inverse quaternion reverses the operation? Let‚Äôs
see what happens if we multiply this result, i.e. qp, by q‚àí1.
Given
q = cosŒ∏ + sinŒ∏
 1
‚àö
2
i + 1
‚àö
2
k

then
q‚àí1 = cosŒ∏ ‚àísinŒ∏
 1
‚àö
2
i + 1
‚àö
2
k

=
‚àö
2
2 ‚àí
‚àö
2
2
 1
‚àö
2
i + 1
‚àö
2
k

= 1
2(
‚àö
2 ‚àíi ‚àík).
Therefore,
qpq‚àí1 = 1
2(‚àí1 +
‚àö
2i + j)(
‚àö
2 ‚àíi ‚àík)
= 1
2

‚àí
‚àö
2 ‚àí(
‚àö
2i + j) ¬∑ (‚àíi ‚àík) + (i + k) +
‚àö
2(
‚àö
2i + j) ‚àíi +
‚àö
2j + k

= 1
2(‚àí
‚àö
2 +
‚àö
2 + i + k + 2i +
‚àö
2j ‚àíi +
‚àö
2j + k)
= i +
‚àö
2j + k
which is a pure quaternion. Furthermore, its magnitude is 2, but what is strange, the
vector has been rotated 90¬∞ rather than 45¬∞ as shown in Fig. 11.4.
If this ‚Äòsandwiching‚Äô of the vector by q and q‚àí1 is correct, it implies that increas-
ing Œ∏ to 90¬∞ should rotate p = 2i by 180¬∞ to 2k. Let‚Äôs try this.

11.2
DeÔ¨Ånition
159
Fig. 11.4 The vector 2i is
rotated 90¬∞ to i +
‚àö
2j + k
Let Œ∏ = 90¬∞, therefore,
qp =

0 + 1
 1
‚àö
2
i + 1
‚àö
2
k

(0 + 2i)
= 2
‚àö
2
(‚àí1 + j).
Next, we post-multiply by q‚àí1
qpq‚àí1 = 2
‚àö
2
(‚àí1 + j)

0 ‚àí1
‚àö
2
i ‚àí1
‚àö
2
k

= 2
‚àö
2
 1
‚àö
2
i + 1
‚àö
2
k ‚àí1
‚àö
2
i + 1
‚àö
2
k

= i + k ‚àíi + k
= 2k
which conÔ¨Årms our prediction. Now let‚Äôs show how this double angle arises.
We begin by deÔ¨Åning a unit quaternion q:
q = s + ŒªÀÜv
and we will eventually assign values to s and Œª. The vector u to be rotated is a pure
quaternion:
p = 0 + u.
The inverse quaternion q‚àí1 is
q‚àí1 = s ‚àíŒªÀÜv
therefore, the triple qpq‚àí1 is
qpq‚àí1 = (s + ŒªÀÜv)(0 + u)(s ‚àíŒªÀÜv)
= (‚àíŒªÀÜv ¬∑ u + su + ŒªÀÜv √ó u)(s ‚àíŒªÀÜv)
= ‚àíŒªsÀÜv ¬∑ u + Œªsu ¬∑ ÀÜv + Œª2(ÀÜv √ó u) ¬∑ ÀÜv
+ Œª2(ÀÜv ¬∑ u)ÀÜv + s2u + ŒªsÀÜv √ó u
‚àíŒªsu √ó ÀÜv ‚àíŒª2(ÀÜv √ó u) √ó ÀÜv
= Œª2(ÀÜv √ó u) ¬∑ ÀÜv + Œª2(ÀÜv ¬∑ u)ÀÜv + s2u + 2ŒªsÀÜv √ó u ‚àíŒª2(ÀÜv √ó u) √ó ÀÜv.

160
11
Quaternion Transforms in Space
Note that
(ÀÜv √ó u) ¬∑ ÀÜv = 0
and
(ÀÜv √ó u) √ó ÀÜv = (ÀÜv ¬∑ ÀÜv)u ‚àí(u ¬∑ ÀÜv)ÀÜv = u ‚àí(u ¬∑ ÀÜv)ÀÜv.
Therefore,
qpq‚àí1 = Œª2(ÀÜv ¬∑ u)ÀÜv + s2u + 2ŒªsÀÜv √ó u ‚àíŒª2u + Œª2(u ¬∑ ÀÜv)ÀÜv
= 2Œª2(ÀÜv ¬∑ u)ÀÜv +

s2 ‚àíŒª2
u + 2ŒªsÀÜv √ó u.
Obviously, this is a pure quaternion as there is no scalar component. However, it is
not obvious where the angle doubling comes from. But, look what happens when
we make s = cosŒ∏ and Œª = sinŒ∏:
qpq‚àí1 = 2sin2 Œ∏(ÀÜv ¬∑ u)ÀÜv +

cos2 Œ∏ ‚àísin2 Œ∏

u + 2sinŒ∏ cosŒ∏ ÀÜv √ó u
= (1 ‚àícos2Œ∏)(ÀÜv ¬∑ u)ÀÜv + cos2Œ∏u + sin2Œ∏ ÀÜv √ó u.
The double angle trigonometric terms emerge! Now, if we want this triple to actually
rotate the vector by Œ∏, then we must build this in from the outset by halving Œ∏ in q:
q = cos(Œ∏/2) + sin(Œ∏/2)ÀÜv
which makes
qpq‚àí1 = (1 ‚àícosŒ∏)(ÀÜv ¬∑ u)ÀÜv + cosŒ∏u + sinŒ∏ ÀÜv √ó u.
(11.1)
Equation (11.1) is the same equation we came across in Chap. 9 discovered by
Rodrigues a few years before Hamilton, hence the scandal!
Let‚Äôs test (11.1) using the previous example where we rotated a vector u = 2i,
90¬∞ about the quaternion‚Äôs vector ÀÜv =
1
‚àö
2i +
1
‚àö
2k:
qpq‚àí1 = 2
‚àö
2
 1
‚àö
2
i + 1
‚àö
2
k

+
‚àö
2j
= i +
‚àö
2j + k
which agrees with the previous result.
Thus, when a quaternion takes on the form
q = cos(Œ∏/2) + sin(Œ∏/2)ÀÜv
it rotates a vector p, anticlockwise Œ∏ using the triple
qpq‚àí1.
It can be shown that this triple always preserves the magnitude of the rotated vector.
You may be wondering what happens if the triple is reversed to q‚àí1pq? A guess
would suggest that the rotation sequence is reversed, but let‚Äôs see what an algebraic
solution predicts:

11.2
DeÔ¨Ånition
161
q‚àí1pq = (s ‚àíŒªÀÜv)(0 + u)(s + ŒªÀÜv)
= (ŒªÀÜv ¬∑ u + su ‚àíŒªÀÜv √ó u)(s + ŒªÀÜv)
= ŒªsÀÜv ¬∑ u ‚àíŒªsu ¬∑ ÀÜv + Œª2ÀÜv √ó u ¬∑ ÀÜv + Œª2ÀÜv ¬∑ uÀÜv
+ s2u ‚àíŒªsÀÜv √ó u + Œªsu √ó ÀÜv ‚àíŒª2ÀÜv √ó u √ó ÀÜv
= Œª2(ÀÜv √ó u) ¬∑ ÀÜv + Œª2(ÀÜv ¬∑ u)ÀÜv + s2u ‚àí2ŒªsÀÜv √ó u ‚àíŒª2(ÀÜv √ó u) √ó ÀÜv.
Once again
(ÀÜv √ó u) ¬∑ ÀÜv = 0
and
(ÀÜv √ó u) √ó ÀÜv = u ‚àí(u ¬∑ ÀÜv)ÀÜv.
Therefore,
q‚àí1pq = Œª2(ÀÜv ¬∑ u)ÀÜv + s2u ‚àí2ŒªsÀÜv √ó u ‚àíŒª2u + Œª2(u ¬∑ ÀÜv)ÀÜv
= 2Œª2(ÀÜv ¬∑ u)ÀÜv +

s2 ‚àíŒª2
u ‚àí2ŒªsÀÜv √ó u.
Again, let‚Äôs make s = cosŒ∏ and Œª = sinŒ∏:
q‚àí1pq = (1 ‚àí2cosŒ∏)(ÀÜv ¬∑ u)ÀÜv + cos2Œ∏u ‚àísin2Œ∏ ÀÜv √ó u
and the only thing that has changed is the sign of the cross-product term, which
reverses the direction of its vector. However, we must remember to compensate for
the angle-doubling by halving Œ∏:
q‚àí1pq = (1 ‚àícosŒ∏)(ÀÜv ¬∑ u)ÀÜv + cosŒ∏u ‚àísinŒ∏ ÀÜv √ó u.
(11.2)
Let‚Äôs see what happens when we employ (11.2) to rotate u = 2i, 90¬∞ about the
quaternion‚Äôs vector ÀÜv =
1
‚àö
2i +
1
‚àö
2k:
q‚àí1pq = 2
‚àö
2
 1
‚àö
2
i + 1
‚àö
2
k

‚àí
‚àö
2j
= i ‚àí
‚àö
2j + k
which has rotated u clockwise 90¬∞ about the quaternion‚Äôs vector. Therefore, the
rotor qpq‚àí1 rotates a vector anticlockwise, and q‚àí1pq rotates a vector clockwise:
qpq‚àí1 = (1 ‚àícosŒ∏)(ÀÜv ¬∑ u)ÀÜv + cosŒ∏u + sinŒ∏ ÀÜv √ó u
q‚àí1pq = (1 ‚àícosŒ∏)(ÀÜv ¬∑ u)ÀÜv + cosŒ∏u ‚àísinŒ∏ ÀÜv √ó u.
However, we must remember that the rotor interprets Œ∏ as 2Œ∏.
Let‚Äôs compute another example. Consider the point P(0,1,1) in Fig. 11.5 which
is to be rotated 90¬∞ about the y-axis. We can see that the rotated point P ‚Ä≤ has the
coordinates (1,1,0) which we will conÔ¨Årm algebraically. The point P is represented
by the pure quaternion
p = 0 + u.
The axis of rotation is ÀÜv = j, and the vector to be rotated is u = j + k. Therefore,

162
11
Quaternion Transforms in Space
Fig. 11.5 The point
P (0,1,1) is rotated 90¬∞ to
P ‚Ä≤(1,1,0) about the y-axis
qpq‚àí1 = (1 ‚àícosŒ∏)(ÀÜv ¬∑ u)ÀÜv + cosŒ∏u + sinŒ∏ ÀÜv √ó u
= j ¬∑ (j + k)j + j √ó (j + k)
= i + j
and conÔ¨Årms that P is indeed rotated to (1,1,0).
Before moving onto the next section it is worth clarifying the interpretation of the
two triples described above. As with the rotation transforms previously covered, we
have used RŒ∏,v to describe a point rotation, Œ∏ about the vector v, and R‚àí1
Œ∏,v to describe
a frame rotation Œ∏ about the vector v. Therefore, in keeping with this convention, we
will use qpq‚àí1 to describe a point rotation of the point represented by p about the
quaternion‚Äôs vector. And q‚àí1pq to describe a frame rotation about the same vector.
11.3 Quaternions in Matrix Form
Having discovered a vector equation to represent the triple qpq‚àí1, let‚Äôs continue
and convert it into a matrix. We will explore two methods: the Ô¨Årst is a simple vec-
torial method which translates the vector equation representing qpq‚àí1 directly into
a matrix form; the second method uses matrix algebra to develop a rather cunning
solution. Let‚Äôs start with the vectorial approach, for which it is convenient to de-
scribe the unit quaternion as
q = s + v
= s + xi + yj + zk
and the pure quaternion as
p = 0 + u
which means that the triple becomes
qpq‚àí1 = 2(v ¬∑ u)v +

s2 ‚àí|v|2
u + 2sv √ó u.
And as we are working with unit quaternions to prevent scaling
s2 + |v|2 = 1

11.3
Quaternions in Matrix Form
163
therefore,
s2 ‚àí|v|2 = 2s2 ‚àí1
and
qpq‚àí1 = 2(v ¬∑ u)v +

2s2 ‚àí1

u + 2sv √ó u.
We can now represent the three terms 2(v ¬∑ u)v, (2s2 ‚àí1)u and 2sv √ó u as three
individual matrices, which can be summed together:
2(v ¬∑ u)v = 2(xxu + yyu + zzu)(xi + yj + zk)
=
‚é°
‚é£
2x2
2xy
2xz
2xy
2y2
2yz
2xz
2yz
2z2
‚é§
‚é¶
‚é°
‚é£
xu
yu
zu
‚é§
‚é¶

2s2 ‚àí1

u =

2s2 ‚àí1

xui +

2s2 ‚àí1

yuj +

2s2 ‚àí1

zuk
=
‚é°
‚é£
2s2 ‚àí1
0
0
0
2s2 ‚àí1
0
0
0
2s2 ‚àí1
‚é§
‚é¶
‚é°
‚é£
xu
yu
zu
‚é§
‚é¶
2sv √ó u = 2s

(yzu ‚àízyu)i + (zxu ‚àíxzu)j + (xyu ‚àíyxu)k

=
‚é°
‚é£
0
‚àí2sz
2sy
2sz
0
‚àí2sx
‚àí2sy
2sx
0
‚é§
‚é¶
‚é°
‚é£
xu
yu
zu
‚é§
‚é¶.
Adding these matrices together produces
qpq‚àí1 =
‚é°
‚é£
2(s2 + x2) ‚àí1
2(xy ‚àísz)
2(xz + sy)
2(xy + sz)
2(s2 + y2) ‚àí1
2(yz ‚àísx)
2(xz ‚àísy)
2(yz + sx)
2(s2 + z2) ‚àí1
‚é§
‚é¶
‚é°
‚é£
xu
yu
zu
‚é§
‚é¶
(11.3)
or
qpq‚àí1 =
‚é°
‚é£
1 ‚àí2(y2 + z2)
2(xy ‚àísz)
2(xz + sy)
2(xy + sz)
1 ‚àí2(x2 + z2)
2(yz ‚àísx)
2(xz ‚àísy)
2(yz + sx)
1 ‚àí2(x2 + y2)
‚é§
‚é¶
‚é°
‚é£
xu
yu
zu
‚é§
‚é¶.
(11.4)
To compute the equivalent matrix for q‚àí1pq all that we have to do is reverse the
sign of 2sv √ó u:
q‚àí1pq =
‚é°
‚é£
2(s2 + x2) ‚àí1
2(xy + sz)
2(xz ‚àísy)
2(xy ‚àísz)
2(s2 + y2) ‚àí1
2(yz + sx)
2(xz + sy)
2(yz ‚àísx)
2(s2 + z2) ‚àí1
‚é§
‚é¶
‚é°
‚é£
xu
yu
zu
‚é§
‚é¶
(11.5)
or

164
11
Quaternion Transforms in Space
q‚àí1pq =
‚é°
‚é£
1 ‚àí2(y2 + z2)
2(xy + sz)
2(xz ‚àísy)
2(xy ‚àísz)
1 ‚àí2(x2 + z2)
2(yz + sx)
2(xz + sy)
2(yz ‚àísx)
1 ‚àí2(x2 + y2)
‚é§
‚é¶
‚é°
‚é£
xu
yu
zu
‚é§
‚é¶
(11.6)
which is the transpose of (11.3) for qpq‚àí1.
11.3.1 Quaternion Products and Matrices
The second way to derive (11.3) depends upon representing a quaternion product in
matrix form. For example, given
q1 = s1 + x1i + y1j + z1k
q2 = s2 + x2i + y2j + z2k
their product is
q1q2 = (s1 + x1i + y1j + z1k)(s2 + x2i + y2j + z2k)
= s1s2 ‚àíx1x2 ‚àíy1y2 ‚àíz1z2
+ s1(x2i + y2j + z2k)
+ s2(x1i + y1j + z1k)
+ (y1z2 ‚àíy2z1)i + (x2z1 ‚àíx1z2)j + (x1y2 ‚àíx2y1)k
= s1s2 ‚àíx1x2 ‚àíy1y2 ‚àíz1z2
+ (s1x2 + s2x1 + y1z2 ‚àíy2z1)i
+ (s1y2 + s2y1 + x2z1 ‚àíx1z2)j
+ (s1z2 + s2z1 + x1y2 ‚àíx2y1)k
q1q2 =
‚é°
‚é¢‚é¢‚é£
s1
‚àíx1
‚àíy1
‚àíz1
x1
s1
‚àíz1
y1
y1
z1
s1
‚àíx1
z1
‚àíy1
x1
s1
‚é§
‚é•‚é•‚é¶
‚é°
‚é¢‚é¢‚é£
s2
x2
y2
z2
‚é§
‚é•‚é•‚é¶.
At this stage we have quaternion q1 represented by a matrix, and q2 represented by a
column vector. Now let‚Äôs reverse the scenario without altering the result by making
q2 the matrix and q1 the column vector:
q1q2 =
‚é°
‚é¢‚é¢‚é£
s2
‚àíx2
‚àíy2
‚àíz2
x2
s2
z2
‚àíy2
y2
‚àíz2
s2
x2
z2
y2
‚àíx2
s2
‚é§
‚é•‚é•‚é¶
‚é°
‚é¢‚é¢‚é£
s1
x1
y1
z1
‚é§
‚é•‚é•‚é¶.
So now we have two ways of computing q1q2 and we need a way of distinguish-
ing between the two matrices. Let‚Äôs call the matrix that preserves the left-to-right
quaternion sequence L and the matrix that reverses the sequence to right-to-left, R:

11.3
Quaternions in Matrix Form
165
q1q2 = L(q1)q2 =
‚é°
‚é¢‚é¢‚é£
s1
‚àíx1
‚àíy1
‚àíz1
x1
s1
‚àíz1
y1
y1
z1
s1
‚àíx1
z1
‚àíy1
x1
s1
‚é§
‚é•‚é•‚é¶
‚é°
‚é¢‚é¢‚é£
s2
x2
y2
z2
‚é§
‚é•‚é•‚é¶
q1q2 = R(q2)q1 =
‚é°
‚é¢‚é¢‚é£
s2
‚àíx2
‚àíy2
‚àíz2
x2
s2
z2
‚àíy2
y2
‚àíz2
s2
x2
z2
y2
‚àíx2
s2
‚é§
‚é•‚é•‚é¶
‚é°
‚é¢‚é¢‚é£
s1
x1
y1
z1
‚é§
‚é•‚é•‚é¶.
Remember that L(q1)q2 = R(q2)q1, as this is central to understanding the next
stage. Furthermore, don‚Äôt be surprised if you don‚Äôt understand the logic of the argu-
ment in the Ô¨Årst reading. It took the author many hours of anguish trying to decipher
the original algorithm, and the explanation has been expanded to ensure that you do
not suffer the same experience!
First, let‚Äôs employ the matrices L and R to rearrange the quaternion triple product
acb to abc: i.e. move c from the middle to the right-hand side.
We start with the quaternion triple product acb and divide it into two parts, ac
and b. We can do this because quaternion algebra is associative:
acb = (ac)b.
We have already demonstrated above that the product ac can be replaced by L(a)c:
acb = L(a)cb.
We now have another two parts: L(a)c and b which can be reversed using R without
disturbing the result:
acb = L(a)cb = R(b)L(a)c
which has achieved our objective to move c to the right-hand side.
Now let‚Äôs repeat the same process to rearrange the triple product qpq‚àí1. The
objective is to remove p from the middle of q and q‚àí1 and move it to the right-hand
side. The reason for doing this is to bring together q and q‚àí1 in the form of two
matrices, which can be multiplied together into a single matrix.
We start with the quaternion triple product qpq‚àí1 and divide it into two parts,
qp and q‚àí1:
qpq‚àí1 = (qp)q‚àí1.
The product qp can be replaced by L(q)p:
qpq‚àí1 = L(q)pq‚àí1.
We now have another two parts: L(q)p and q‚àí1 which can be reversed using R
without disturbing the result:
qpq‚àí1 = L(q)pq‚àí1 = R

q‚àí1
L(q)p
which has achieved our objective to move p to the right-hand side.
The next step is to compute L(q) and R(q‚àí1) using q = s + xi + yj + zk. L(q)
is easy as it is the same as L(q1) without any subscripts:

166
11
Quaternion Transforms in Space
L(q) =
‚é°
‚é¢‚é¢‚é£
s
‚àíx
‚àíy
‚àíz
x
s
‚àíz
y
y
z
s
‚àíx
z
‚àíy
x
s
‚é§
‚é•‚é•‚é¶.
R(q‚àí1) is also easy, but requires converting q2 in the original deÔ¨Ånition into q‚àí1
2
which is effected by reversing the signs of the vector components:
R

q‚àí1
=
‚é°
‚é¢‚é¢‚é£
s
x
y
z
‚àíx
s
‚àíz
y
‚àíy
z
s
‚àíx
‚àíz
‚àíy
x
s
‚é§
‚é•‚é•‚é¶.
So now we can write
qpq‚àí1 = R

q‚àí1
L(q)p
=
‚é°
‚é¢‚é¢‚é£
s
x
y
z
‚àíx
s
‚àíz
y
‚àíy
z
s
‚àíx
‚àíz
‚àíy
x
s
‚é§
‚é•‚é•‚é¶
‚é°
‚é¢‚é¢‚é£
s
‚àíx
‚àíy
‚àíz
x
s
‚àíz
y
y
z
s
‚àíx
z
‚àíy
x
s
‚é§
‚é•‚é•‚é¶
‚é°
‚é¢‚é¢‚é£
0
xu
yu
zu
‚é§
‚é•‚é•‚é¶
=
‚é°
‚é¢‚é¢‚é£
1
0
0
0
0 1 ‚àí2(y2 + z2)
2(xy ‚àísz)
2(xz + sy)
0
2(xy + sz)
1 ‚àí2(x2 + z2)
2(yz ‚àísx)
0
2(xz ‚àísy)
2(yz + sx)
1 ‚àí2(x2 + y2)
‚é§
‚é•‚é•‚é¶
‚é°
‚é¢‚é¢‚é£
0
xu
yu
zu
‚é§
‚é•‚é•‚é¶.
If we remove the Ô¨Årst row and column and treat p as a vector, rather than a quater-
nion, we have
=
‚é°
‚é£
1 ‚àí2(y2 + z2)
2(xy ‚àísz)
2(xz + sy)
2(xy + sz)
1 ‚àí2(x2 + z2)
2(yz ‚àísx)
2(xz ‚àísy)
2(yz + sx)
1 ‚àí2(x2 + y2)
‚é§
‚é¶
‚é°
‚é£
xu
yu
zu
‚é§
‚é¶
which is identical to (11.4)!
11.3.2 Geometric VeriÔ¨Åcation
Let‚Äôs illustrate the action of (11.3) by rotating the point (0,1,1), 90¬∞ about the y-
axis, as shown in Fig. 11.6. The quaternion must take the form
q = cos(Œ∏/2) + sin(Œ∏/2)ÀÜv
which means that Œ∏ = 90¬∞ and ÀÜv = j, therefore,
q = cos45¬∞ + sin45¬∞ÀÜj.
Consequently,
s =
‚àö
2
2 ,
x = 0,
y =
‚àö
2
2 ,
z = 0.

11.3
Quaternions in Matrix Form
167
Fig. 11.6 The point
P (0,1,1) is rotated 90¬∞ to
P ‚Ä≤(1,1,0) about the y-axis
Substituting these values in (11.3) gives
‚é°
‚é£
1
1
0
‚é§
‚é¶=
‚é°
‚é£
0
0
1
0
1
0
‚àí1
0
0
‚é§
‚é¶
‚é°
‚é£
0
1
1
‚é§
‚é¶
where (0,1,1) is rotated to (1,1,0), which is correct.
So now we have a transform that rotates a point about an arbitrary axis intersect-
ing the origin without the problems of gimbal lock associated with Euler transforms.
Before moving on, let‚Äôs evaluate one more example. Let‚Äôs perform a 180¬∞ ro-
tation about a vector v = i + k passing through the origin. To begin with, we will
deliberately forget to convert the vector into a unit vector, just to see what happens
to the Ô¨Ånal matrix. The quaternion should take the form
q = cos(Œ∏/2) + sin(Œ∏/2)ÀÜv
but we will use v as speciÔ¨Åed. Therefore, with Œ∏ = 180¬∞
s = 0,
x = 1,
y = 0,
z = 1.
Substituting these values in (11.3) gives
‚é°
‚é£
1
0
2
0
‚àí1
0
2
0
1
‚é§
‚é¶
which looks nothing like a rotation matrix, and reminds us how important it is to
have a unit vector to represent the axis. Let‚Äôs repeat these calculations normalising
the vector to ÀÜv = i/
‚àö
2 + k/
‚àö
2:
s = 0,
x = 1
‚àö
2
,
y = 0,
z = 1
‚àö
2
.
Substituting these values in (11.3) gives
‚é°
‚é£
0
0
1
0
‚àí1
0
1
0
0
‚é§
‚é¶

168
11
Quaternion Transforms in Space
Fig. 11.7 The point (1,0,0)
is rotated 180¬∞ about the
vector v to (0,0,1)
which not only looks like a rotation matrix, but has a determinant of 1 and rotates
the point (1,0,0) to (0,0,1) as shown in Fig. 11.7,
‚é°
‚é£
0
0
1
‚é§
‚é¶=
‚é°
‚é£
0
0
1
0
‚àí1
0
1
0
0
‚é§
‚é¶
‚é°
‚é£
1
0
0
‚é§
‚é¶.
11.4 Multiple Rotations
Say a vector or frame of reference is subjected to two rotations speciÔ¨Åed by q1
followed by q2. There is a temptation to convert both quaternions to their respective
matrix and multiply the matrices together. However, this not the most efÔ¨Åcient way
of combining the rotations. It is best to accumulate the rotations as quaternions and
then convert to matrix notation, if required.
To illustrate this, consider the vector p subjected to the Ô¨Årst quaternion q1:
q1pq‚àí1
1
followed by a second quaternion q2
q2

q1pq‚àí1
1

q‚àí1
2
which can be expressed as
(q2q1)p(q2q1)‚àí1.
Extra quaternions can be added accordingly. Let‚Äôs illustrate this with an example.
To keep things simple, the Ô¨Årst quaternion q1 rotates 30¬∞ about the y-axis:
q1 = cos15¬∞ + sin15¬∞j.
The second quaternion q2 rotates 60¬∞ also about the y-axis:
q1 = cos30¬∞ + sin30¬∞j.
Together, the two quaternions rotate 90¬∞ about the y-axis. To accumulate these ro-
tations, we must multiply them together:

11.5
Eigenvalue and Eigenvector
169
q1q2 =

cos15¬∞ + sin15¬∞j

cos30¬∞ + sin30¬∞j

= cos15¬∞cos30¬∞ ‚àísin15¬∞sin30¬∞ + cos15¬∞sin30¬∞j + cos30¬∞sin15¬∞j
=
‚àö
2
2 +
‚àö
2
2 j
which is a quaternion that rotates 90¬∞ about the y-axis. Using the matrix (11.4) we
have
‚é°
‚é£
0
0
1
0
1
0
‚àí1
0
0
‚é§
‚é¶
which rotates points about the y-axis by 90¬∞.
11.5 Eigenvalue and Eigenvector
Although there is no doubt that (11.3) is a rotation matrix, we can secure further
evidence by calculating its eigenvalue and eigenvector. The eigenvalue should be Œ∏,
where
Tr

qpq‚àí1
= 1 + 2cosŒ∏.
The trace of (11.3) is
Tr

qpq‚àí1
= 2

s2 + x2
‚àí1 + 2

s2 + y2
‚àí1 + 2

s2 + z2
‚àí1
= 4s2 + 2

s2 + x2 + y2 + z2
‚àí3
= 4s2 ‚àí1
= 4cos2(Œ∏/2) ‚àí1
= 4cosŒ∏ + 4sin2(Œ∏/2) ‚àí1
= 4cosŒ∏ + 2 ‚àí2cosŒ∏ ‚àí1
= 1 + 2cosŒ∏
and
cosŒ∏ = 1
2

Tr

qpq‚àí1
‚àí1

.
To compute the eigenvector of (11.3) we use the three equations derived in Chap. 9:
v1 = (a22 ‚àí1)(a33 ‚àí1) ‚àía23a32
v2 = (a33 ‚àí1)(a11 ‚àí1) ‚àía31a13
v3 = (a11 ‚àí1)(a22 ‚àí1) ‚àía12a21.

170
11
Quaternion Transforms in Space
Therefore,
v1 =

2

s2 + y2
‚àí2

2

s2 + z2
‚àí2

‚àí2(yz ‚àísx)2(yz + sx)
= 4

s2 + y2 ‚àí1

s2 + z2 ‚àí1

‚àí4

y2z2 ‚àís2x2
= 4

x2 + z2
x2 + y2
‚àíy2z2 + s2x2
= 4

x4 + x2y2 + x2z2 + z2y2 ‚àíy2z2 + s2x2
= 4x2
s2 + x2 + y2 + z2
= 4x2.
Similarly, v2 = 4y2 and v3 = 4z2, which conÔ¨Årms that the eigenvector has compo-
nents associated with the quaternion‚Äôs vector. The square terms should be no sur-
prise, as the triple qpq‚àí1 includes the product of two quaternions.
11.6 Rotating About an Off-Set Axis
Now that we have a matrix to represent a quaternion rotor, we can employ it to
resolve problems such as rotating a point about an off-set axis using the same tech-
niques associated with normal rotation transforms. For example, in Chap. 9 we used
the following notation
‚é°
‚é¢‚é¢‚é£
x‚Ä≤
y‚Ä≤
z‚Ä≤
1
‚é§
‚é•‚é•‚é¶= Ttx,0,tzRŒ≤,yT‚àítx,0,‚àítz
‚é°
‚é¢‚é¢‚é£
x
y
z
1
‚é§
‚é•‚é•‚é¶
to rotate a point about a Ô¨Åxed axis parallel with the y-axis. Therefore, by substituting
qpq‚àí1 for RŒ≤,y we have
‚é°
‚é¢‚é¢‚é£
x‚Ä≤
y‚Ä≤
z‚Ä≤
1
‚é§
‚é•‚é•‚é¶= Ttx,0,tzqpq‚àí1T‚àítx,0,‚àítz
‚é°
‚é¢‚é¢‚é£
x
y
z
1
‚é§
‚é•‚é•‚é¶.
Let‚Äôs test this by rotating our unit cube 90¬∞ about the vertical axis intersecting ver-
tices 4 and 6 as shown in Fig. 11.8 (a) and (b).
The quaternion to achieve this is
q = cos45¬∞ + sin45¬∞j
with the pure quaternion
p = 0 + u
and using (11.3) this creates the homogeneous matrix
qpq‚àí1 =
‚é°
‚é¢‚é¢‚é£
0
0
1
0
0
1
0
0
‚àí1
0
0
0
0
0
0
1
‚é§
‚é•‚é•‚é¶
‚é°
‚é¢‚é¢‚é£
xu
yu
zu
1
‚é§
‚é•‚é•‚é¶.

11.7
Frames of Reference
171
Fig. 11.8 The cube is rotated 90¬∞ about the axis intersecting vertices 4 and 6
The other two matrices are
T‚àítx,0,0 =
‚é°
‚é¢‚é¢‚é£
1
0
0
‚àí1
0
1
0
0
0
0
1
0
0
0
0
1
‚é§
‚é•‚é•‚é¶
Ttx,0,0 =
‚é°
‚é¢‚é¢‚é£
1
0
0
1
0
1
0
0
0
0
1
0
0
0
0
1
‚é§
‚é•‚é•‚é¶.
Multiplying these matrices together creates
‚é°
‚é¢‚é¢‚é£
0
0
1
1
0
1
0
0
‚àí1
0
0
1
0
0
0
1
‚é§
‚é•‚é•‚é¶
which when applied to the cube‚Äôs coordinates produces
‚é°
‚é¢‚é¢‚é£
0
0
1
1
0
1
0
0
‚àí1
0
0
1
0
0
0
1
‚é§
‚é•‚é•‚é¶
‚é°
‚é¢‚é¢‚é£
0
0
0
0
1
1
1
1
0
0
1
1
0
0
1
1
0
1
0
1
0
1
0
1
1
1
1
1
1
1
1
1
‚é§
‚é•‚é•‚é¶
=
‚é°
‚é¢‚é¢‚é£
1
2
1
2
1
2
1
2
0
0
1
1
0
0
1
1
1
1
1
1
0
0
0
0
1
1
1
1
1
1
1
1
‚é§
‚é•‚é•‚é¶.
These coordinates are conÔ¨Årmed by Fig. 11.8 (a) and (b).
11.7 Frames of Reference
Chapter 10 explored various techniques for changing the coordinates of objects in
different frames of reference. Now that we have covered quaternions, and especially

172
11
Quaternion Transforms in Space
Fig. 11.9 The frame is rotated 180¬∞ about the vector [i + k]
the matrix representing the triple q‚àí1pq, (11.5) we can show how quaternions can
be added to these techniques.
The triple qpq‚àí1 is used for rotating points about the vector associated with
the quaternion q, whereas the triple q‚àí1pq is used for rotating points about the
same vector, but in the opposite direction. But we have already reasoned that this
reverse rotation is equivalent to a change of frame of reference. To demonstrate this,
consider the problem of rotating the frame of reference 180¬∞ about i + k as shown
in Fig. 11.9 (a) and (b). The unit quaternion for such a rotation is
q = cos90¬∞ + sin90¬∞
 1
‚àö
2
i + 1
‚àö
2
k

= 0 +
‚àö
2
2 i +
‚àö
2
2 k.
Consequently,
s = 0,
x =
‚àö
2
2 ,
y = 0,
z =
‚àö
2
2 .
Substituting these values in (11.5) we obtain
q‚àí1pq =
‚é°
‚é£
0
0
1
0
‚àí1
0
1
0
0
‚é§
‚é¶
‚é°
‚é£
xu
yu
zu
‚é§
‚é¶
which if used to process the coordinates of our unit cube produces
‚é°
‚é£
0
0
1
0
‚àí1
0
1
0
0
‚é§
‚é¶
‚é°
‚é£
0
0
0
0
1
1
1
1
0
0
1
1
0
0
1
1
0
1
0
1
0
1
0
1
‚é§
‚é¶
=
‚é°
‚é£
0
1
0
1
0
1
0
1
0
0
‚àí1
‚àí1
0
0
‚àí1
‚àí1
0
0
0
0
1
1
1
1
‚é§
‚é¶.
This scenario is shown in Fig. 11.9 (a) and (b).

11.8
Interpolating Quaternions
173
Fig. 11.10 The point
(0,1,1) is rotated 90¬∞ about
the vector v to (1,1,0)
11.8 Interpolating Quaternions
Like vectors, quaternions can also be interpolated to compute an in-between quater-
nion. However, whereas two interpolated vectors results in a third vector that is
readily visualised, two interpolated quaternions results in a third quaternion that
acts as a rotor, and is not immediately visualised.
We have already seen that the spherical interpolant for vectors is
v = sin(1 ‚àít)Œ∏
sinŒ∏
v1 + sintŒ∏
sinŒ∏ v2
and requires no modiÔ¨Åcation for quaternions:
q = sin(1 ‚àít)Œ∏
sinŒ∏
q1 + sintŒ∏
sinŒ∏ q2.
(11.7)
So, given
q1 = s1 + x1i + y1j + z1k
q2 = s2 + x2i + y2j + z2k
Œ∏ is obtained by taking the 4D dot product of q1 and q2:
cosŒ∏ = q1 ¬∑ q2
|q1||q2|
cosŒ∏ = s1s2 + x1x2 + y1y2 + z1z2
|q1||q2|
and if we are working with unit quaternions, then
cosŒ∏ = s1s2 + x1x2 + y1y2 + z1z2.
(11.8)
Let‚Äôs use (11.7) in a scenario with two simple quaternions.
Figure 11.10 shows one such scenario where the point (0,1,1) is rotated 90¬∞
about v, the axis of q1. Figure 11.11 shows another scenario where the same point
(0,1,1) is rotated 90¬∞ about v, the axis of q2. The quaternions are
q1 = cos45¬∞ + sin45¬∞j =
‚àö
2
2 +
‚àö
2
2 j
q2 = cos45¬∞ + sin45¬∞i =
‚àö
2
2 +
‚àö
2
2 i.

174
11
Quaternion Transforms in Space
Fig. 11.11 The point
(0,1,1) is rotated 90¬∞ about
the vector v to (0,‚àí1,1)
Therefore, using (11.8)
cosŒ∏ =
‚àö
2
2
‚àö
2
2 = 0.5
Œ∏ = 60¬∞.
Before proceeding, let‚Äôs compute the two matrices for the two quaternion triples.
For q1
s =
‚àö
2
2 ,
x = 0,
y =
‚àö
2
2 ,
z = 0
which when substituted in (11.3) gives
q1pq‚àí1
1
=
‚é°
‚é£
0
0
1
0
1
0
‚àí1
0
0
‚é§
‚é¶
‚é°
‚é£
xu
yu
zu
‚é§
‚é¶.
Substituting the coordinates (0,1,1) gives
‚é°
‚é£
1
1
0
‚é§
‚é¶=
‚é°
‚é£
0
0
1
0
1
0
‚àí1
0
0
‚é§
‚é¶
‚é°
‚é£
0
1
1
‚é§
‚é¶
which is correct.
For q2
s =
‚àö
2
2 ,
x =
‚àö
2
2 ,
y = 0,
z = 0
which when substituted in (11.3) gives
q2pq‚àí1
2
=
‚é°
‚é£
1
0
0
0
0
‚àí1
0
1
0
‚é§
‚é¶
‚é°
‚é£
xu
yu
zu
‚é§
‚é¶.
Substituting the coordinates (0,1,1) gives
‚é°
‚é£
0
‚àí1
1
‚é§
‚é¶=
‚é°
‚é£
1
0
0
0
0
‚àí1
0
1
0
‚é§
‚é¶
‚é°
‚é£
0
1
1
‚é§
‚é¶
which is also correct.

11.8
Interpolating Quaternions
175
Fig. 11.12 The point
(0,1,1) is rotated 90¬∞ about
the vector v to (1,0,1)
Using (11.7) with t = 0.5 should compute a mid-way position for an interpolated
quaternion, with its vector at 45¬∞ between the x- and y-axes, as shown in Fig. 11.12.
We already know that Œ∏ = 60¬∞, therefore sinŒ∏ =
‚àö
3/2, and using (11.7)
q = sin 1
260¬∞
sin60¬∞
‚àö
2
2 +
‚àö
2
2 j

+ sin 1
260¬∞
sin60¬∞
‚àö
2
2 +
‚àö
2
2 i

= 1
‚àö
3
‚àö
2
2 +
‚àö
2
2 j

+ 1
‚àö
3
‚àö
2
2 +
‚àö
2
2 i

=
‚àö
2
2
‚àö
3
+
‚àö
2
2
‚àö
3
j +
‚àö
2
2
‚àö
3
+
‚àö
2
2
‚àö
3
i
=
‚àö
2
‚àö
3
+ 1
‚àö
6
i + 1
‚àö
6
j
therefore,
s =
‚àö
2
‚àö
3
,
x = 1
‚àö
6
,
y = 1
‚àö
6
,
z = 0
which when substituted in (11.3) gives
qpq‚àí1 =
‚é°
‚é¢‚é£
1 ‚àí( 2
6)
2( 1
6)
2( 1
3)
2( 1
6)
1 ‚àí2( 1
6)
2(‚àí1
3)
2(‚àí1
3)
2( 1
3)
1 ‚àí2( 1
6 + 1
6)
‚é§
‚é•‚é¶
‚é°
‚é£
xu
yu
zu
‚é§
‚é¶
and
qpq‚àí1 =
‚é°
‚é¢‚é£
2
3
1
3
2
3
1
3
2
3
‚àí2
3
‚àí2
3
2
3
1
3
‚é§
‚é•‚é¶
‚é°
‚é£
xu
yu
zu
‚é§
‚é¶.
Substituting the coordinates (0,1,1) gives
‚é°
‚é£
1
0
1
‚é§
‚é¶=
‚é°
‚é¢‚é£
2
3
1
3
2
3
1
3
2
3
‚àí2
3
‚àí2
3
2
3
1
3
‚é§
‚é•‚é¶
‚é°
‚é£
0
1
1
‚é§
‚é¶
(11.9)
which gives the point (1,0,1).

176
11
Quaternion Transforms in Space
Fig. 11.13 Spherical
interpolation between q1
and q2
One of the reasons for using this spherical interpolant is that it linearly inter-
polates the angle between the two quaternions, which creates a constant-angular
velocity between the quaternions. However, one of the problems with visualising
quaternions is that they reside in a four-dimensional space and create a hyper-sphere
with a radius equal to the quaternion‚Äôs magnitude. With our 3D brains, this is difÔ¨Å-
cult to visualise. Nevertheless, we can convince ourselves into thinking we see what
is going on with a simple sketch, as shown in Fig. 11.13, where we see part of the
hyper-sphere and two quaternions q1 and q2. In this example, the angle œÜ is a con-
stant angle between two values of the interpolant t. The spherical interpolant also
ensures that the magnitude of the interpolated quaternion remains constant at unity
and prevents any unwanted scaling.
Figure 11.14 provides another sketch to help visualise what is going on. For ex-
ample, when t = 0, the interpolated quaternion is q1 which rotates the point (0,1,1)
to (1,1,0), and when t = 1, the interpolated quaternion is q2 which rotates the point
(0,1,1) to (0,‚àí1,1). When t = 0.5, the interpolated quaternion rotates the point
(0,1,1) to (1,0,1) as computed above. Two other curves show what happens for
t = 0.25 and t = 0.75.
A natural consequence of the interpolant is that the angle of rotation is 90¬∞ for
t = 0 and t = 1, but for t = 0.5 the angle of rotation (eigenvalue) is approximately
70.5¬∞. Corresponding angles arise for other values of t.
Fig. 11.14 Sketch showing
the actions of the interpolated
quaternions

11.9
Converting a Rotation Matrix to a Quaternion
177
11.9 Converting a Rotation Matrix to a Quaternion
The matrix transform equivalent to qpq‚àí1 is
qpq‚àí1 =
‚é°
‚é£
2(s2 + x2) ‚àí1
2(xy ‚àísz)
2(xz + sy)
2(xy + sz)
2(s2 + y2) ‚àí1
2(yz ‚àísx)
2(xz ‚àísy)
2(yz + sx)
2(s2 + z2) ‚àí1
‚é§
‚é¶
‚é°
‚é£
xu
yu
zu
‚é§
‚é¶
=
‚é°
‚é£
a11
a12
a13
a21
a22
a23
a31
a32
a33
‚é§
‚é¶
‚é°
‚é£
xu
yu
zu
‚é§
‚é¶.
Inspection of the matrix shows that by combining various elements we can isolate
the terms of a quaternion s,x,y,z. For example, by adding the terms a11 +a22 +a33
we obtain:
a11 + a22 + a33 =

2

s2 + x2
‚àí1

+

2

s2 + y2
‚àí1

+

2

s2 + z2
‚àí1

= 6s2 + 2

x2 + y2 + z2
‚àí3
= 4s2 ‚àí1
therefore,
s = ¬±1
2

1 + a11 + a22 + a33.
To isolate x, y and z we use
x = 1
4s (a32 ‚àía23)
y = 1
4s (a13 ‚àía31)
z = 1
4s (a21 ‚àía12).
We can conÔ¨Årm their accuracy using the matrix (11.9):
s = ¬±1
2

1 + 2
3 + 2
3 + 1
3 =
‚àö
2
‚àö
3
x =
‚àö
3
4
‚àö
2
2
3 + 2
3

= 1
‚àö
6
y =
‚àö
3
4
‚àö
2
2
3 + 2
3

= 1
‚àö
6
z =
‚àö
3
4
‚àö
2
1
3 ‚àí1
3

= 0
which agree with the original values.
Say, for example, the value of s had been close to zero, this could have made the
values of x, y, z unreliable. Consequently, other combinations are available:

178
11
Quaternion Transforms in Space
x = ¬±1
2

1 + a11 ‚àía22 ‚àía33
y = 1
4x (a12 + a21)
z = 1
4x (a13 + a31)
s = 1
4x (a32 ‚àía23)
y = ¬±1
2

1 ‚àía11 + a22 ‚àía33
x = 1
4y (a12 + a21)
z = 1
4y (a23 + a32)
s = 1
4y (a13 ‚àía31)
z = ¬±1
2

1 ‚àía11 ‚àía22 + a33
x = 1
4z(a13 + a31)
y = 1
4z(a23 + a32)
s = 1
4z(a21 ‚àía12).
11.10 Summary
Quaternion algebra offers a simple and efÔ¨Åcient way for computing rotations, but
can also be evaluated in matrix form. We have also shown that it is possible to move
between both forms of notation. It is left to the reader to code up some of these ideas
and explore issues of accuracy and efÔ¨Åciency.
11.10.1 Summary of Quaternion Transforms
Given
q = s + ÀÜv = cos(Œ∏/2) + sin(Œ∏/2)(xi + yj + zk)
p = 0 + u.

11.10
Summary
179
Rotating a point about a vector
qpq‚àí1 = (1 ‚àícosŒ∏)(ÀÜv ¬∑ u)ÀÜv + cosŒ∏u + sinŒ∏ ÀÜv √ó u.
Rotating a frame about a vector
q‚àí1pq = (1 ‚àícosŒ∏)(ÀÜv ¬∑ u)ÀÜv + cosŒ∏u ‚àísinŒ∏ ÀÜv √ó u.
Matrix for rotating a point about a vector
qpq‚àí1 =
‚é°
‚é£
1 ‚àí2(y2 + z2)
2(xy ‚àísz)
2(xz + sy)
2(xy + sz)
1 ‚àí2(x2 + z2)
2(yz ‚àísx)
2(xz ‚àísy)
2(yz + sx)
1 ‚àí2(x2 + y2)
‚é§
‚é¶
‚é°
‚é£
xu
yu
zu
‚é§
‚é¶.
Matrix for rotating a frame about a vector
q‚àí1pq =
‚é°
‚é£
1 ‚àí2(y2 + z2)
2(xy + sz)
2(xz ‚àísy)
2(xy ‚àísz)
1 ‚àí2(x2 + z2)
2(yz + sx)
2(xz + sy)
2(yz ‚àísx)
1 ‚àí2(x2 + y2)
‚é§
‚é¶
‚é°
‚é£
xu
yu
zu
‚é§
‚é¶.
Matrix for a quaternion product
q1q2 = L(q1)q2 =
‚é°
‚é¢‚é¢‚é£
s1
‚àíx1
‚àíy1
‚àíz1
x1
s1
‚àíz1
y1
y1
z1
s1
‚àíx1
z1
‚àíy1
x1
s1
‚é§
‚é•‚é•‚é¶
‚é°
‚é¢‚é¢‚é£
s2
x2
y2
z2
‚é§
‚é•‚é•‚é¶
q1q2 = R(q2)q1 =
‚é°
‚é¢‚é¢‚é£
s2
‚àíx2
‚àíy2
‚àíz2
x2
s2
z2
‚àíy2
y2
‚àíz2
s2
x2
z2
y2
‚àíx2
s2
‚é§
‚é•‚é•‚é¶
‚é°
‚é¢‚é¢‚é£
s1
x1
y1
z1
‚é§
‚é•‚é•‚é¶.
Interpolating two quaternions
q = sin(1 ‚àít)Œ∏
sinŒ∏
q1 + sintŒ∏
sinŒ∏ q2
where
cosŒ∏ = q1 ¬∑ q2
|q1||q2|
cosŒ∏ = s1s2 + x1x2 + y1y2 + z1z2
|q1||q2|
.
Quaternion from a rotation matrix
s = ¬±1
2

1 + a11 + a22 + a33
x = 1
4s (a32 ‚àía23)
y = 1
4s (a13 ‚àía31)
z = 1
4s (a21 ‚àía12)

180
11
Quaternion Transforms in Space
x = ¬±1
2

1 + a11 ‚àía22 ‚àía33
y = 1
4x (a12 + a21)
z = 1
4x (a13 + a31)
s = 1
4x (a32 ‚àía23)
y = ¬±1
2

1 ‚àía11 + a22 ‚àía33
x = 1
4y (a12 + a21)
z = 1
4y (a23 + a32)
s = 1
4y (a13 ‚àía31)
z = ¬±1
2

1 ‚àía11 ‚àía22 + a33
x = 1
4z(a13 + a31)
y = 1
4z(a23 + a32)
s = 1
4z(a21 ‚àía12).

Chapter 12
Bivector Rotors
12.1 Introduction
In Chap. 6 we explored multivectors, and in Chap. 11 we saw how quaternions are
used to rotate points and frames of reference about an arbitrary vector. In this chapter
we will see how these two ideas merge into one to form bivector rotors. In order to
show how such rotors operate, we begin with reÔ¨Çections and show how these can
effect a rotation.
12.2 The Three ReÔ¨Çections Theorem
The three reÔ¨Çections theorem states that ‚Äòeach isometry of the Euclidean plane is
the composite of one, two, or three reÔ¨Çections.‚Äô To begin with, an isometry of the
Euclidean plane is a way of transforming the plane that preserves length. Such
isometries include rotation, translation, reÔ¨Çection and glide reÔ¨Çections. The latter is
a combination of a reÔ¨Çection in a line and a translation along that line. John Stillwell
provides an elegant proof for this theorem in his book Numbers and Geometry [8].
The isometry we are particularly interested in is reÔ¨Çection, where the distance
between two points is preserved in their reÔ¨Çection. Consider, for example, the 2D
scenario shown in Fig. 12.1 where two lines M and N are imaginary mirrors sepa-
rated by an angle Œ∏. The real point P subtends an angle Œ± to mirror M and creates
a virtual image PR which subtends an equal but opposite angle.
Although it is not physically possible, we can imagine that the virtual image PR
is reÔ¨Çected in the second mirror N. To begin with, PR subtends an angle Œ∏ ‚àíŒ± to
mirror N and creates another virtual image P ‚Ä≤ which subtends an equal and opposite
angle. What is interesting about this conÔ¨Åguration is that although the mirrors are
separated by Œ∏, the angle between P and P ‚Ä≤ is 2Œ∏. In order to take advantage of this
effect we need to know how vectors are reÔ¨Çected using multivectors, which is the
subject of the next section.
J. Vince, Rotation Transforms for Computer Graphics,
DOI 10.1007/978-0-85729-154-7_12, ¬© Springer-Verlag London Limited 2011
181

182
12
Bivector Rotors
Fig. 12.1 Rotating a point by
a double reÔ¨Çection
12.3 ReÔ¨Çecting a Vector
Figure 12.2 shows a mirror with a unit normal vector ÀÜn and a vector a with its
reÔ¨Çection a‚Ä≤. Vector a has a perpendicular component a‚ä•and a parallel component
a‚à•with ÀÜn, and our objective is to derive a deÔ¨Ånition of the reÔ¨Çection a‚Ä≤ in terms of
vector a and any other essential vectors.
From our knowledge of multivectors, we know that ÀÜn2 = 1 which permits us to
write
a = ÀÜn2a = ÀÜn(ÀÜna).
This has created the geometric product ÀÜna which equals
ÀÜna = ÀÜn ¬∑ a + ÀÜn ‚àßa
(12.1)
therefore,
a = ÀÜn(ÀÜn ¬∑ a + ÀÜn ‚àßa).
(12.2)
We can see that (12.2) has two parts: ÀÜn(ÀÜn ¬∑ a) and ÀÜn(ÀÜn ‚àßa). The Ô¨Årst part is another
way of expressing a‚à•:
a‚à•= (ÀÜn ¬∑ a)ÀÜn
and as
a = a‚ä•+ a‚à•
Fig. 12.2 ReÔ¨Çecting a vector
in a mirror

12.3
ReÔ¨Çecting a Vector
183
the second part must be
a‚ä•= ÀÜn(ÀÜn ‚àßa).
From Fig. 12.2 we see that
a‚Ä≤ = a‚ä•‚àía‚à•
(12.3)
= ÀÜn(ÀÜn ‚àßa) ‚àí(ÀÜn ¬∑ a)ÀÜn.
(12.4)
Equation (12.4) contains the product of a vector ÀÜn and a bivector ÀÜn ‚àßÀÜa which anti-
commute:
ÀÜn(ÀÜn ‚àßa) = ÀÜn
2(ÀÜna ‚àíaÀÜn)
= 1
2(a ‚àíÀÜnaÀÜn)
whereas,
(ÀÜn ‚àßa)ÀÜn = 1
2(ÀÜna ‚àíaÀÜn)ÀÜn
= 1
2(ÀÜnaÀÜn ‚àía)
therefore, we can write (12.4) as
a‚Ä≤ = ‚àí(ÀÜn ¬∑ a)ÀÜn ‚àí(ÀÜn ‚àßa)ÀÜn
which simpliÔ¨Åes to
a‚Ä≤ = ‚àí(ÀÜn ¬∑ a + ÀÜn ‚àßa)ÀÜn.
(12.5)
By substituting (12.1) in (12.5) we have
a‚Ä≤ = ‚àíÀÜnaÀÜn
(12.6)
which is rather elegant!
To illustrate (12.6), consider the scenario shown in Fig. 12.3 where we see a
mirror placed on the zx-plane with normal vector j or e2. The vector to be reÔ¨Çected
is
a = i + j ‚àík
which can also be expressed as
a = e1 + e2 ‚àíe3.
Using (12.6) we have
a‚Ä≤ = ‚àíe2(e1 + e2 ‚àíe3)e2
which, using the rules of multivectors simpliÔ¨Åes to
a‚Ä≤ = ‚àíe2e1e2 ‚àíe2e2e2 + e2e3e2
= e1 ‚àíe2 ‚àíe3
= i ‚àíj ‚àík
and is conÔ¨Årmed by Fig. 12.3. Now let‚Äôs see how these ideas can be generalised into
3D rotations.

184
12
Bivector Rotors
Fig. 12.3 ReÔ¨Çecting a vector
in a mirror
12.4 3D Rotations
Figure 12.4 shows a plan view of two mirrors M and N with their respective unit
normal vectors ÀÜm and ÀÜn separated by an angle Œ∏. The plane containing ÀÜm and ÀÜn is
readily deÔ¨Åned by their wedge product ÀÜm ‚àßÀÜn. Using (12.6) we can compute vector
a‚Äôs reÔ¨Çection by
b = ‚àíÀÜma ÀÜm
(12.7)
and b‚Äôs reÔ¨Çection by
a‚Ä≤ = ‚àíÀÜnbÀÜn.
(12.8)
Substituting (12.7) in (12.8) we obtain
a‚Ä≤ = ÀÜn ÀÜma ÀÜmÀÜn,
(12.9)
which is extremely compact. However, we must remember that a is rotated twice
the angle separating the mirrors, i.e. 2Œ∏. Within geometric algebra ÀÜn ÀÜm is called a
rotor, and is represented by R, which means that using the reverse operation ‚Ä† we
can write (12.9) as
a‚Ä≤ = RaR‚Ä†
(12.10)
which reminds us of the way quaternions work.
To illustrate the action of (12.10) consider the 2D scenario shown in Fig. 12.5
with two mirrors M and N and their unit normal vectors ÀÜm, ÀÜn and position vector p:
Fig. 12.4 Rotating a point by
a double reÔ¨Çection

12.4
3D Rotations
185
Fig. 12.5 Rotating a point by
180¬∞
ÀÜm = e2
ÀÜn = ‚àíe1
p = e1 ‚àíe2.
As the mirrors are separated by 90¬∞ the point P is rotated 180¬∞:
p‚Ä≤ = ÀÜn ÀÜmp ÀÜmÀÜn
= ‚àíe1e2(e1 ‚àíe2)e2(‚àíe1)
= e12121 ‚àíe12221
p‚Ä≤ = ‚àíe1 + e2.
Let‚Äôs now deÔ¨Åne a rotor in terms of its bivector and the actual angle a vector is
rotated as follows. The bivector deÔ¨Åning the plane is ÀÜm ‚àßÀÜn and Œ∏ is the rotor angle,
which means that the bivector angle is Œ∏/2. Let
RŒ∏ = ÀÜn ÀÜm
R‚Ä†
Œ∏ = ÀÜmÀÜn
where
ÀÜn ÀÜm = ÀÜn ¬∑ ÀÜm ‚àíÀÜm ‚àßÀÜn
ÀÜmÀÜn = ÀÜn ¬∑ ÀÜm + ÀÜm ‚àßÀÜn
ÀÜn ¬∑ ÀÜm = cos(Œ∏/2)
ÀÜm ‚àßÀÜn = sin(Œ∏/2) ÀÜB.
Therefore,
RŒ∏ = cos(Œ∏/2) ‚àísin(Œ∏/2) ÀÜB
R‚Ä†
Œ∏ = cos(Œ∏/2) + sin(Œ∏/2) ÀÜB.
We now have an equation that rotates a vector p through an angle Œ∏ about an axis
deÔ¨Åned by ÀÜB:
p‚Ä≤ = RŒ∏pR‚Ä†
Œ∏

186
12
Bivector Rotors
or
p‚Ä≤ =

cos(Œ∏/2) ‚àísin(Œ∏/2) ÀÜB

p

cos(Œ∏/2) + sin(Œ∏/2) ÀÜB

.
(12.11)
Let‚Äôs demonstrate how (12.11) works with two examples.
Example 1 Figure 12.6 shows a scenario where vector p is to be rotated 90¬∞ about
e2 which is perpendicular to ÀÜB, where
Œ∏ = 90¬∞,
a = e2,
p = e1 + e2,
ÀÜB = e31.
Therefore,
p‚Ä≤ =

cos45¬∞ ‚àísin45¬∞e31

(e1 + e2)

cos45¬∞ + sin45¬∞e31

=
‚àö
2
2 ‚àí
‚àö
2
2 e31

(e1 + e2)
‚àö
2
2 +
‚àö
2
2 e31

=
‚àö
2
2 e1 +
‚àö
2
2 e2 ‚àí
‚àö
2
2 e3 ‚àí
‚àö
2
2 e312
‚àö
2
2 +
‚àö
2
2 e31

= 1
2(e1 ‚àíe3 + e2 + e231 ‚àíe3 ‚àíe1 ‚àíe312 ‚àíe31231)
= e2 ‚àíe3
which is correct.
Observe what happens when the bivector‚Äôs sign is reversed to ‚àíe31:
p‚Ä≤ =

cos45¬∞ + sin45¬∞e31

(e1 + e2)

cos45¬∞ ‚àísin45¬∞e31

= 1
2(1 + e31)(e1 + e2)(1 ‚àíe31)
= 1
2(e1 + e2 + e3 + e312)(1 ‚àíe31)
Fig. 12.6 Rotating a vector
by 90¬∞

12.4
3D Rotations
187
Fig. 12.7 Rotating a vector
by 120¬∞
= 1
2(e1 + e3 + e2 + e231 + e3 ‚àíe1 + e312 ‚àíe31231)
p‚Ä≤ = e2 + e3
the rotation is clockwise about e2.
Example 2 Figure 12.7 shows a scenario where vector p is to be rotated 120¬∞ about
the bivector B, where
m = e1 ‚àíe3,
n = e2 ‚àíe3,
Œ∏ = 120¬∞,
p = e2 + e3.
First, we compute the bivector:
B = m ‚àßn
= (e1 ‚àíe3) ‚àß(e2 ‚àíe3)
= e12 + e23 + e31.
Next, we normalise B to ÀÜB:
ÀÜB = 1
‚àö
3
(e12 + e23 + e31)
and
p‚Ä≤ =

cos60¬∞ ‚àísin60¬∞ ÀÜB

p

cos60¬∞ + sin60¬∞ ÀÜB

=
1
2 ‚àí
‚àö
3
2
1
‚àö
3

e12 + e23 + e31

(e2 + e3)
1
2 +
‚àö
3
2
1
‚àö
3
(e12 + e23 + e31)

=
1
2 ‚àíe12
2 ‚àíe23
2 ‚àíe31
2

(e2 + e3)
1
2 + e12
2 + e23
2 + e31
2

= 1
4(e2 + e3 ‚àíe1 ‚àíe123 + e3 ‚àíe2 ‚àíe312 + e1)(1 + e12 + e23 + e31)
= 1
2(e3 ‚àíe123)(1 + e12 + e23 + e31)
= 1
2(e3 ‚àíe2 + e1 + e3 + e1 + e2)
= e1 + e3.

188
12
Bivector Rotors
These examples show that rotors behave just like quaternions. Rotors not only
rotate vectors, but they can be used to rotate any multivector, irrespective of their
dimension.
12.5 Rotors as Matrices
Although rotors can be computed using geometric algebra, there is a one-to-one
correspondence with matrix algebra, which we will now demonstrate.
12.5.1 2D Rotor
To begin with we will show that a 2D rotor is nothing more that a 2 √ó 2 matrix in
disguise for rotating a point 2Œ∏ about the origin.
Given
ÀÜm = m1e1 + m2e2
ÀÜn = n1e1 + n2e2
p = p1e1 + p2e2
and Œ∏ is the angle between ÀÜm and ÀÜn. Therefore, we can write
ÀÜn ÀÜm = ÀÜn ¬∑ ÀÜm ‚àíÀÜm ‚àßÀÜn
ÀÜmÀÜn = ÀÜn ¬∑ ÀÜm + ÀÜm ‚àßÀÜn
where
ÀÜn ¬∑ ÀÜm = cosŒ∏
ÀÜm ‚àßÀÜn = sinŒ∏e12.
Therefore, using the deÔ¨Ånition of a rotor
p‚Ä≤ = ÀÜn ÀÜmp ÀÜmÀÜn
= (cosŒ∏ ‚àísinŒ∏e12)(p1e1 + p2e2)(cosŒ∏ + sinŒ∏e12)
= (p1 cosŒ∏e1 + p2 cosŒ∏e2 + p1 sinŒ∏e2 ‚àíp2 sinŒ∏e1)(cosŒ∏ + sinŒ∏e12)
=

(p1 cosŒ∏ ‚àíp2 sinŒ∏)e1 + (p1 sinŒ∏ + p2 cosŒ∏)e2

(cosŒ∏ + sinŒ∏e12)
=

cos2 Œ∏ ‚àísin2 Œ∏

p1 ‚àí2cosŒ∏ sinŒ∏p2

e1
+

2cosŒ∏ sinŒ∏p1 +

cos2 Œ∏ ‚àísin2 Œ∏

p2

e2
= (p1 cos2Œ∏ ‚àíp2 sin2Œ∏)e1 + (p1 sin2Œ∏ + p2 cos2Œ∏)e2
or in matrix form

p‚Ä≤
1
p‚Ä≤
2

=
cos2Œ∏
‚àísin2Œ∏
sin2Œ∏
cos2Œ∏
	p1
p2
	

12.5
Rotors as Matrices
189
which is the matrix for rotating a point 2Œ∏ about the origin. Now let‚Äôs do the same
for a 3D rotor.
12.5.2 3D Rotor
We begin with a unit bivector deÔ¨Åning the plane ÀÜm ‚àßÀÜn, about which the rotation is
effected, where
ÀÜm = m1e1 + m2e2 + m3e3
ÀÜn = n1e1 + n2e2 + n3e3
and we deliberately deÔ¨Åne
RŒ∏ = ÀÜn ÀÜm
where Œ∏ is half the angle between ÀÜm and ÀÜn.
The rotor will take the form
RŒ∏ = s ‚àíxe23 ‚àíye31 ‚àíze12
which permits us to deÔ¨Åne
R‚Ä†
Œ∏ = ÀÜmÀÜn
which is
R‚Ä†
Œ∏ = s + xe23 + ye31 + ze12.
Therefore, given an arbitrary vector
v = v1e1 + v2e2 + v3e3
the rotated vector is given by
v‚Ä≤ = RŒ∏vR‚Ä†
Œ∏.
To keep the algebra simple it is best to compute the individual components of v‚Ä≤
using RŒ∏v1e1R‚Ä†
Œ∏, RŒ∏v2e2R‚Ä†
Œ∏ and RŒ∏v3e3R‚Ä†
Œ∏:
RŒ∏v1e1R‚Ä†
Œ∏ = (s ‚àíxe23 ‚àíye31 ‚àíze12)v1e1(s + xe23 + ye31 + ze12)
= v1(se1 ‚àíxe123 ‚àíye3 + ze2)(s + xe23 + ye31 + ze12)
= v1

s2 + x2 ‚àíy2 ‚àíz2
e1 + 2(xy + sz)e2 + 2(xz ‚àísy)e3

but
s2 + x2 = 1 ‚àíy2 ‚àíz2
therefore,
RŒ∏v1e1R‚Ä†
Œ∏ = v1

1 ‚àí2

y2 + z2
e1 + 2(xy + sz)e2 + 2(xz ‚àísy)e3

.

190
12
Bivector Rotors
Next,
RŒ∏v2e2R‚Ä†
Œ∏ = (s ‚àíxe23 ‚àíye31 ‚àíze12)v2e2(s + xe23 + ye31 + ze12)
= v2(se2 + xe3 ‚àíye123 + ze1)(s + xe23 + ye31 + ze12)
= v2

2(xy ‚àísz)e1 +

s2 ‚àíx2 + y2 ‚àíz2
e2 + 2(yz + sx)e3

.
Substituting
s2 + y2 = 1 ‚àíx2 ‚àíz2
we have
RŒ∏v2e2R‚Ä†
Œ∏ = v2

2(xy ‚àísz)e1 +

1 ‚àí2

x2 + z2
e2 + 2(yz + sx)e3

.
Next,
RŒ∏v3e3R‚Ä†
Œ∏ = (s ‚àíxe23 ‚àíye31 ‚àíze12)v3e3(s + xe23 + ye31 + ze12)
= v3(se3 ‚àíxe2 + ye1 ‚àíze123)(s + xe23 + ye31 + ze12)
= v3

2(xz + sy)e1 + 2(yz ‚àísx)e2 +

s2 ‚àíx2 ‚àíy2 + z2
e3

.
Substituting
s2 + z2 = 1 ‚àíx2 ‚àíy2
we have
RŒ∏v3e3R‚Ä†
Œ∏ = v3

2(xz ‚àísy)e1 + 2(yz ‚àísx)e2 +

1 ‚àí2

x2 + y2
e3

.
Therefore,
RŒ∏vR‚Ä†
Œ∏ = Rv1e1R‚Ä† + Rv2e2R‚Ä† + Rv3e3R‚Ä†
or as a matrix
‚é°
‚é¢‚é£
v‚Ä≤
1
v‚Ä≤
2
v‚Ä≤
3
‚é§
‚é•‚é¶=
‚é°
‚é£
1 ‚àí2(y2 + z2)
2(xy ‚àísz)
2(xz + sy)
2(xy + sz)
1 ‚àí2(x2 + z2)
2(yz ‚àísx)
2(xz ‚àísy)
2(yz + sx)
1 ‚àí2(x2 + y2)
‚é§
‚é¶
‚é°
‚é£
v1
v2
v3
‚é§
‚é¶
which is the same matrix representing the quaternion triple qpq‚àí1.
The reader should not be put off by the above algebraic proof. It has been in-
cluded to demonstrate that bivector rotors behave just like quaternions and are rep-
resented by identical matrices.
You may wish to investigate the matrix for the reverse rotor triple R‚Ä†
Œ∏pRŒ∏, which
you will discover is
‚é°
‚é¢‚é£
v‚Ä≤
1
v‚Ä≤
2
v‚Ä≤
3
‚é§
‚é•‚é¶=
‚é°
‚é£
1 ‚àí2(y2 + z2)
2(xy + sz)
2(xz ‚àísy)
2(xy ‚àísz)
1 ‚àí2(x2 + z2)
2(yz + sx)
2(xz + sy)
2(yz ‚àísx)
1 ‚àí2(x2 + y2)
‚é§
‚é¶
‚é°
‚é£
v1
v2
v3
‚é§
‚é¶
and is the transpose of the above matrix for RŒ∏vR‚Ä†
Œ∏. Thus the matrices conÔ¨Årm that

12.5
Rotors as Matrices
191
RŒ∏vR‚Ä†
Œ∏
rotates a vector anticlockwise by Œ∏
R‚Ä†
Œ∏vRŒ∏
rotates a vector clockwise by Œ∏.
Furthermore, maintaining our convention about rotating points and frames:
RŒ∏vR‚Ä†
Œ∏
rotates a frame clockwise by Œ∏
R‚Ä†
Œ∏vRŒ∏
rotates a frame anticlockwise by Œ∏.
12.5.3 Extracting a Rotor
Say we are presented with
ÀÜb = RŒ∏ ÀÜaR‚Ä†
Œ∏
where we know ÀÜa and ÀÜb and have to discover RŒ∏. Here is one way we can undertake
the task, which is cunning, rather than obvious!
Figure 12.8 shows vectors ÀÜa and ÀÜb and a third vector ÀÜn, mid-way between the
two vectors. Vector ÀÜn bisects the angle Œ∏ separating ÀÜa and ÀÜb, therefore, the product
ÀÜbÀÜn must be a rotor capable of rotating any vector in the plane ÀÜn ‚àßÀÜb by Œ∏, which
permits us to write
ÀÜb = ÀÜbÀÜnÀÜaÀÜnÀÜb
or
ÀÜb = RŒ∏ ÀÜaR‚Ä†
Œ∏
where
RŒ∏ = ÀÜbÀÜn
(12.12)
R‚Ä†
Œ∏ = ÀÜnÀÜb.
(12.13)
Next, to eliminate ÀÜn we compute
ÀÜn = ÀÜa + ÀÜb
|ÀÜa + ÀÜb|
Fig. 12.8 Vector ÀÜn bisects Œ∏

192
12
Bivector Rotors
and substitute it in (12.12):
RŒ∏ = ÀÜbÀÜn
= ÀÜb
 ÀÜa + ÀÜb
|ÀÜa + ÀÜb|

= 1 + ÀÜbÀÜa
|ÀÜa + ÀÜb|
.
Similarly,
R‚Ä†
Œ∏ = ÀÜnÀÜb
=
 ÀÜa + ÀÜb
|ÀÜa + ÀÜb|

ÀÜb
= 1 + ÀÜaÀÜb
|ÀÜa + ÀÜb|
.
It is possible to show that
|ÀÜa + ÀÜb| =

2(1 + ÀÜa ¬∑ ÀÜb)
which permits us to propose an alternative solution
RŒ∏ =
1 + ÀÜbÀÜa

2(1 + ÀÜa ¬∑ ÀÜb)
(12.14)
R‚Ä†
Œ∏ =
1 + ÀÜaÀÜb

2(1 + ÀÜa ¬∑ ÀÜb)
.
(12.15)
Now let‚Äôs put these deÔ¨Ånitions to the test.
Figure 12.9 shows vector ÀÜa aligned with the e1 axis and ÀÜb aligned with the e2
axis. Therefore, the rotor is acting in the e12 plane with an angle of 45¬∞ to effect a
rotation of 90¬∞. Using our knowledge of rotors, it is obvious that
Fig. 12.9 Vector ÀÜa rotates
to ÀÜb

12.5
Rotors as Matrices
193
R90¬∞ = cos45¬∞ ‚àísin45¬∞e12
= 1 ‚àíe12
‚àö
2
R‚Ä†
90¬∞ = cos45¬∞ + sin45¬∞e12
= 1 + e12
‚àö
2
.
So let‚Äôs conÔ¨Årm these using (12.14) and (12.15):
R90¬∞ =
1 + e2e1
‚àö2(1 + e1 ¬∑ e2)
= 1 ‚àíe12
‚àö
2
R‚Ä†
90¬∞ =
1 + e1e2
‚àö2(1 + e1 ¬∑ e2)
= 1 + e12
‚àö
2
which conÔ¨Årm our predictions.
In a previous example above, we used
R120¬∞ = cos60¬∞ ‚àísin60¬∞ ÀÜB
R‚Ä†
120¬∞ = cos60¬∞ + sin60¬∞ ÀÜB
ÀÜB = 1
‚àö
3
(e12 + e23 + e31)
to rotate e2 + e3 to e1 + e3.
Let‚Äôs use (12.14) and (12.15) to invert the process, but remember that we are
dealing with unit vectors, which means that we have to normalise a and b:
ÀÜa = 1
‚àö
2
(e2 + e3)
ÀÜb = 1
‚àö
2
(e1 + e3).
Furthermore, although the bivector ÀÜB formed the plane of rotation in the previous
example, this time, the plane of rotation is ÀÜa ‚àßÀÜb. Therefore,
R120¬∞ =
1 + ÀÜbÀÜa

2(1 + ÀÜa ¬∑ ÀÜb)
=
1 +
1
‚àö
2(e1 + e3) 1
‚àö
2(e2 + e3)

2(1 +
1
‚àö
2(e2 + e3) ¬∑
1
‚àö
2(e1 + e3))

194
12
Bivector Rotors
= 1 + 1
2(e12 ‚àíe31 ‚àíe23 + 1)

2(1 + 1
2)
= 1 + 1
2e12 ‚àí1
2e23 ‚àí1
2e31 + 1
2
‚àö
3
=
‚àö
3
2 +
‚àö
3
6 e12 ‚àí
‚àö
3
6 e23 ‚àí
‚àö
3
6 e31
which makes
R‚Ä†
120¬∞ =
‚àö
3
2 ‚àí
‚àö
3
6 e12 +
‚àö
3
6 e23 +
‚àö
3
6 e31.
But does it work? Well, let‚Äôs Ô¨Ånd out by forming the product
R120¬∞
1
‚àö
2
(e2 + e3)R‚Ä†
120¬∞ =
1
12
‚àö
2
(3 + e12 + e32 + e13)
√ó (e2 + e3)(3 ‚àíe12 ‚àíe32 ‚àíe13)
=
1
6
‚àö
2
(e1 + e2 + 2e3)(3 ‚àíe12 ‚àíe32 ‚àíe13)
=
1
6
‚àö
2
(6e1 + 6e3)
= 1
‚àö
2
(e1 + e3)
which is correct.
Finally, let‚Äôs employ the rotor matrix. But remember that its deÔ¨Ånition of RŒ∏ has
a negative bivector term, which means that we have to switch the bivector terms in
R120¬∞ or use the bivector terms from R‚Ä†
120¬∞:
R‚Ä†
120¬∞ =
‚àö
3
2 ‚àí
‚àö
3
6 e12 +
‚àö
3
6 e23 +
‚àö
3
6 e31
where
s =
‚àö
3
2 ,
x =
‚àö
3
6 ,
y =
‚àö
3
6 ,
z = ‚àí
‚àö
3
6
R120¬∞vR‚Ä†
120¬∞ =
‚é°
‚é£
1 ‚àí2(y2 + z2)
2(xy ‚àísz)
2(xz + sy)
2(xy + sz)
1 ‚àí2(x2 + z2)
2(yz ‚àísx)
2(xz ‚àísy)
2(yz + sx)
1 ‚àí2(x2 + y2)
‚é§
‚é¶
‚é°
‚é£
v1
v2
v3
‚é§
‚é¶
=
‚é°
‚é¢‚é£
1 ‚àí2( 1
12 + 1
12)
2( 1
12 + 3
12)
2(‚àí1
12 + 3
12)
2( 1
12 ‚àí3
12)
1 ‚àí2( 1
12 + 1
12)
2(‚àí1
12 ‚àí3
12)
2(‚àí1
12 ‚àí3
12)
2(‚àí1
12 + 3
12)
1 ‚àí2( 1
12 + 1
12)
‚é§
‚é•‚é¶
‚é°
‚é£
v1
v2
v3
‚é§
‚é¶
=
‚é°
‚é¢‚é£
2
3
2
3
1
3
‚àí1
3
2
3
‚àí2
3
‚àí2
3
1
3
2
3
‚é§
‚é•‚é¶
‚é°
‚é£
v1
v2
v3
‚é§
‚é¶.

12.6
Summary
195
Substituting a = [e2 + e3] we obtain
‚é°
‚é£
1
0
1
‚é§
‚é¶=
‚é°
‚é¢‚é£
2
3
2
3
1
3
‚àí1
3
2
3
‚àí2
3
‚àí2
3
1
3
2
3
‚é§
‚é•‚é¶
‚é°
‚é£
0
1
1
‚é§
‚é¶
which is correct.
You may also like to verify that the determinant of the matrix is 1.
12.6 Summary
It is very interesting to see the close relationship between quaternions and geomet-
ric algebra. It demonstrates that although it is possible to describe the low-level
arithmetic that actually does the work behind the scenes, such as a matrix, it is also
possible to invent objects such as quaternions or bivectors, trivectors, etc., that pro-
vide a conceptual high-level framework that allow mathematicians to work more
productively and creatively. In the end, Hamilton, Grassman and Clifford have pro-
vided us with some extraordinary mathematical inventions that have found their way
into computer graphics, and I hope that this chapter has shown you another way of
handling rotations.
12.6.1 Summary of Bivector Transforms
ReÔ¨Çecting a vector in a plane
v‚Ä≤ = ‚àíÀÜnvÀÜn.
Rotating a vector using rotors
v‚Ä≤ = RŒ∏vR‚Ä†
Œ∏
where
RŒ∏ = cos(Œ∏/2) ‚àísin(Œ∏/2) ÀÜB
R‚Ä†
Œ∏ = cos(Œ∏/2) + sin(Œ∏/2) ÀÜB.
Rotor as a matrix
RŒ∏vR‚Ä†
Œ∏ =
‚é°
‚é£
1 ‚àí2(y2 + z2)
2(xy ‚àísz)
2(xz + sy)
2(xy + sz)
1 ‚àí2(x2 + z2)
2(yz ‚àísx)
2(xz ‚àísy)
2(yz + sx)
1 ‚àí2(x2 + y2)
‚é§
‚é¶
‚é°
‚é£
v1
v2
v3
‚é§
‚é¶
R‚Ä†
Œ∏vRŒ∏ =
‚é°
‚é£
1 ‚àí2(y2 + z2)
2(xy + sz)
2(xz ‚àísy)
2(xy ‚àísz)
1 ‚àí2(x2 + z2)
2(yz + sx)
2(xz + sy)
2(yz ‚àísx)
1 ‚àí2(x2 + y2)
‚é§
‚é¶
‚é°
‚é£
v1
v2
v3
‚é§
‚é¶

196
12
Bivector Rotors
where
RŒ∏ = s ‚àíxe23 ‚àíye31 ‚àíze12
R‚Ä†
Œ∏ = s + xe23 + ye31 + ze12.
Extracting a rotor
If
ÀÜb = RŒ∏ ÀÜaR‚Ä†
Œ∏
then
RŒ∏ = 1 + ÀÜbÀÜa
|ÀÜa + ÀÜb|
=
1 + ÀÜbÀÜa

2(1 + ÀÜa ¬∑ ÀÜb)
R‚Ä†
Œ∏ = 1 + ÀÜaÀÜb
|ÀÜa + ÀÜb|
=
1 + ÀÜaÀÜb

2(1 + ÀÜa ¬∑ ÀÜb)
.

Chapter 13
Conclusion
The aim of this book was to take the reader through the important ideas and mathe-
matical techniques associated with rotation transforms. I mentioned that I would not
be too pedantic about mathematical terminology and would not swamp the reader
with high-level concepts and axioms that pervade the real world of mathematics.
My prime objective was to make the reader conÔ¨Ådent and comfortable with com-
plex numbers, vectors, matrices, quaternions and bivector rotors. I knew that this
was a challenge, but as they all share rotation as a common thread, hopefully, this
has not been too onerous for the reader.
The worked examples will provide the reader with real problems to explore. As
far as I know, they all produce correct results. But that was not always the case, as it
is so easy to switch a sign during an algebraic expansion that creates a false result.
However, repeated examination eventually leads one to the mistake, and the correct
answer emerges so naturally.
The real challenge for the reader is the next level. There are some excellent books,
technical papers and websites that introduce more advanced topics such as the B-
spline interpolation of quaternions, the kinematics of moving frames, exponential
rotors and conformal geometry. Hopefully, the contents of this book has prepared
the reader for such journeys.
What I have tried to show throughout the previous dozen chapters is that rotations
are about sines and cosines, which are ratios associated with a line sweeping the unit
circle. These, in turn, can be expressed in various identities, especially half-angle
identities.
Imaginary quantities also seem to play an important role in rotations, and it is just
as well that they exist otherwise life would be extremely difÔ¨Åcult! We have seen that
complex numbers, quaternions and bivector rotors all include imaginary quantities,
and at the end of the day, they just seem to be different ways of controlling sines and
cosines. I am certain that you now appreciate that quaternions are just one of four
possible algebras that require an n-square identity, and that they are closely related
to Clifford algebra. Which one is best for computer graphics? I don‚Äôt know. But I am
certain that if you attempt to implement these ideas, you will discover the answer.
J. Vince, Rotation Transforms for Computer Graphics,
DOI 10.1007/978-0-85729-154-7_13, ¬© Springer-Verlag London Limited 2011
197


Appendix A
Composite Point Rotation Sequences
A.1 Euler Rotations
In Chap. 9 we considered composite Euler rotations comprising individual rotations
about the x, y and z-axes such as RŒ≥,xRŒ≤,yRŒ±,z and RŒ≥,zRŒ≤,yRŒ±,x. However, there
is nothing preventing us from creating other combinations such as RŒ≥,xRŒ≤,yRŒ±,x or
RŒ≥,zRŒ≤,yRŒ±,z that do not include two consecutive rotations about the same axis. In
all, there are twelve possible combinations:
RŒ≥,xRŒ≤,yRŒ±,x,
RŒ≥,xRŒ≤,yRŒ±,z,
RŒ≥,xRŒ≤,zRŒ±,x,
RŒ≥,xRŒ≤,zRŒ±,y
RŒ≥,yRŒ≤,xRŒ±,y,
RŒ≥,yRŒ≤,xRŒ±,z,
RŒ≥,yRŒ≤,zRŒ±,x,
RŒ≥,yRŒ≤,zRŒ±,y
RŒ≥,zRŒ≤,xRŒ±,y,
RŒ≥,zRŒ≤,xRŒ±,z,
RŒ≥,zRŒ≤,yRŒ±,x,
RŒ≥,zRŒ≤,yRŒ±,z
which we now cover in detail.
For each combination there are three Euler rotation matrices, the resulting com-
posite matrix, a matrix where the three angles equal 90¬∞, the coordinates of the
rotated unit cube, the axis and angle of rotation and a Ô¨Ågure illustrating the stages
of rotation. To compute the axis of rotation [v1
v2
v3]T we use
v1 = (a22 ‚àí1)(a33 ‚àí1) ‚àía23a32
v2 = (a33 ‚àí1)(a11 ‚àí1) ‚àía31a13
v3 = (a11 ‚àí1)(a22 ‚àí1) ‚àía12a21
where
R =
‚é°
‚é£
a11
a12
a13
a21
a22
a23
a31
a32
a33
‚é§
‚é¶
and for the angle of rotation Œ¥ we use
cosŒ¥ = 1
2

Tr(R) ‚àí1

.
We begin by deÔ¨Åning the three principal Euler rotations:
J. Vince, Rotation Transforms for Computer Graphics,
DOI 10.1007/978-0-85729-154-7, ¬© Springer-Verlag London Limited 2011
199

200
A
Composite Point Rotation Sequences
rotate Œ± about the x-axis
RŒ±,x =
‚é°
‚é£
1
0
0
0
cŒ±
‚àísŒ±
0
sŒ±
cŒ±
‚é§
‚é¶
rotate Œ≤ about the y-axis
RŒ≤,y =
‚é°
‚é£
cŒ≤
0
sŒ≤
0
1
0
‚àísŒ≤
0
cŒ≤
‚é§
‚é¶
rotate Œ≥ about the z-axis
RŒ≥,z =
‚é°
‚é£
cŒ≥
‚àísŒ≥
0
sŒ≥
cŒ≥
0
0
0
1
‚é§
‚é¶
where cŒ± = cosŒ± and sŒ± = sinŒ±, etc.
Remember that the right-most transform is applied Ô¨Årst and the left-most trans-
form last. In terms of angles, the sequence is always Œ±, Œ≤, Œ≥ .
For each composite transform you can verify that when Œ± = Œ≤ = Œ≥ = 0 the result
is the identity transform I.
We now examine the twelve combinations in turn.

A.2
RŒ≥,xRŒ≤,yRŒ±,x
201
A.2 RŒ≥,xRŒ≤,yRŒ±,x
RŒ≥,xRŒ≤,yRŒ±,x =
‚é°
‚é£
1
0
0
0
cŒ≥
‚àísŒ≥
0
sŒ≥
cŒ≥
‚é§
‚é¶
‚é°
‚é£
cŒ≤
0
sŒ≤
0
1
0
‚àísŒ≤
0
cŒ≤
‚é§
‚é¶
‚é°
‚é£
1
0
0
0
cŒ±
‚àísŒ±
0
sŒ±
cŒ±
‚é§
‚é¶
=
‚é°
‚é£
cŒ≤
sŒ≤sŒ±
sŒ≤cŒ±
sŒ≥ sŒ≤
(cŒ≥ cŒ± ‚àísŒ≥ cŒ≤sŒ±)
(‚àícŒ≥ sŒ± ‚àísŒ≥ cŒ≤cŒ±)
‚àícŒ≥ sŒ≤
(sŒ≥ cŒ± + cŒ≥ cŒ≤sŒ±)
(‚àísŒ≥ sŒ± + cŒ≥ cŒ≤cŒ±)
‚é§
‚é¶
R90¬∞,xR90¬∞,yR90¬∞,x =
‚é°
‚é£
0
1
0
1
0
0
0
0
‚àí1
‚é§
‚é¶
‚é°
‚é£
0
1
0
1
0
0
0
0
‚àí1
‚é§
‚é¶
‚é°
‚é£
0
0
0
0
1
1
1
1
0
0
1
1
0
0
1
1
0
1
0
1
0
1
0
1
‚é§
‚é¶
=
‚é°
‚é£
0
0
1
1
0
0
1
1
0
0
0
0
1
1
1
1
0
‚àí1
0
‚àí1
0
‚àí1
0
‚àí1
‚é§
‚é¶.
This rotation sequence is illustrated in Fig. A.1 (a)‚Äì(d), where the axis of rotation
is [2
2
0]T and the angle of rotation 180¬∞.
Fig. A.1 Four views of the unit cube before and during the three rotations R90¬∞,xR90¬∞,yR90¬∞,x

202
A
Composite Point Rotation Sequences
A.3 RŒ≥,xRŒ≤,yRŒ±,z
RŒ≥,xRŒ≤,yRŒ±,z =
‚é°
‚é£
1
0
0
0
cŒ≥
‚àísŒ≥
0
sŒ≥
cŒ≥
‚é§
‚é¶
‚é°
‚é£
cŒ≤
0
sŒ≤
0
1
0
‚àísŒ≤
0
cŒ≤
‚é§
‚é¶
‚é°
‚é£
cŒ±
‚àísŒ±
0
sŒ±
cŒ±
0
0
0
1
‚é§
‚é¶
=
‚é°
‚é£
cŒ≤cŒ±
‚àícŒ≤sŒ±
sŒ≤
(cŒ≥ sŒ± + sŒ≥ sŒ≤cŒ±)
(cŒ≥ cŒ± ‚àísŒ≥ sŒ≤sŒ±)
‚àísŒ≥ cŒ≤
(sŒ≥ sŒ± ‚àícŒ≥ sŒ≤cŒ±)
(sŒ≥ cŒ± + cŒ≥ sŒ≤sŒ±)
cŒ≥ cŒ≤
‚é§
‚é¶
R90¬∞,xR90¬∞,yR90¬∞,z =
‚é°
‚é£
0
0
1
0
‚àí1
0
1
0
0
‚é§
‚é¶
‚é°
‚é£
0
0
1
0
‚àí1
0
1
0
0
‚é§
‚é¶
‚é°
‚é£
0
0
0
0
1
1
1
1
0
0
1
1
0
0
1
1
0
1
0
1
0
1
0
1
‚é§
‚é¶
=
‚é°
‚é£
0
1
0
1
0
1
0
1
0
0
‚àí1
‚àí1
0
0
‚àí1
‚àí1
0
0
0
0
1
1
1
1
‚é§
‚é¶.
This rotation sequence is illustrated in Fig. A.2 (a)‚Äì(d), where the axis of rotation
is [2
0
2]T and the angle of rotation 180¬∞.
Fig. A.2 Four views of the unit cube before and during the three rotations R90¬∞,xR90¬∞,yR90¬∞,z

A.4
RŒ≥,xRŒ≤,zRŒ±,x
203
A.4 RŒ≥,xRŒ≤,zRŒ±,x
RŒ≥,xRŒ≤,zRŒ±,x =
‚é°
‚é£
1
0
0
0
cŒ≥
‚àísŒ≥
0
sŒ≥
cŒ≥
‚é§
‚é¶
‚é°
‚é£
cŒ≤
‚àísŒ≤
0
sŒ≤
cŒ≤
0
0
0
1
‚é§
‚é¶
‚é°
‚é£
1
0
0
0
cŒ±
‚àísŒ±
0
sŒ±
cŒ±
‚é§
‚é¶
=
‚é°
‚é£
cŒ≤
‚àísŒ≤cŒ±
sŒ≤sŒ±
cŒ≥ sŒ≤
(‚àísŒ≥ sŒ± + cŒ≥ cŒ≤cŒ±)
(‚àísŒ≥ cŒ± ‚àícŒ≥ cŒ≤sŒ±)
sŒ≥ sŒ≤
(cŒ≥ sŒ± + sŒ≥ cŒ≤cŒ±)
(cŒ≥ cŒ± ‚àísŒ≥ cŒ≤sŒ±)
‚é§
‚é¶
R90¬∞,xR90¬∞,zR90¬∞,x =
‚é°
‚é£
0
0
1
0
‚àí1
0
1
0
0
‚é§
‚é¶
‚é°
‚é£
0
0
1
0
‚àí1
0
1
0
0
‚é§
‚é¶
‚é°
‚é£
0
0
0
0
1
1
1
1
0
0
1
1
0
0
1
1
0
1
0
1
0
1
0
1
‚é§
‚é¶
=
‚é°
‚é£
0
1
0
1
0
1
0
1
0
0
‚àí1
‚àí1
0
0
‚àí1
‚àí1
0
0
0
0
1
1
1
1
‚é§
‚é¶.
This rotation sequence is illustrated in Fig. A.3 (a)‚Äì(d), where the axis of rotation
is [2
0
2]T and the angle of rotation 180¬∞.
Fig. A.3 Four views of the unit cube before and during the three rotations R90¬∞,xR90¬∞,zR90¬∞,x

204
A
Composite Point Rotation Sequences
A.5 RŒ≥,xRŒ≤,zRŒ±,y
RŒ≥,xRŒ≤,zRŒ±,y =
‚é°
‚é£
1
0
0
0
cŒ≥
‚àísŒ≥
0
sŒ≥
cŒ≥
‚é§
‚é¶
‚é°
‚é£
cŒ≤
‚àísŒ≤
0
sŒ≤
cŒ≤
0
0
0
1
‚é§
‚é¶
‚é°
‚é£
cŒ±
0
sŒ±
0
1
0
‚àísŒ±
0
cŒ±
‚é§
‚é¶
=
‚é°
‚é£
cŒ≤cŒ±
‚àísŒ≤
cŒ≤sŒ±
(sŒ≥ sŒ± + cŒ≥ sŒ≤cŒ±)
cŒ≥ cŒ≤
(‚àísŒ≥ cŒ± + cŒ≥ sŒ≤sŒ±)
(‚àícŒ≥ sŒ± + sŒ≥ sŒ≤cŒ±)
sŒ≥ cŒ≤
(cŒ≥ cŒ± + sŒ≥ sŒ≤sŒ±)
‚é§
‚é¶
R90¬∞,xR90¬∞,zR90¬∞,y =
‚é°
‚é£
0
‚àí1
0
1
0
0
0
0
1
‚é§
‚é¶
‚é°
‚é£
0
‚àí1
0
1
0
0
0
0
1
‚é§
‚é¶
‚é°
‚é£
0
0
0
0
1
1
1
1
0
0
1
1
0
0
1
1
0
1
0
1
0
1
0
1
‚é§
‚é¶
=
‚é°
‚é£
0
0
‚àí1
‚àí1
0
0
‚àí1
‚àí1
0
0
0
0
1
1
1
1
0
1
0
1
0
1
0
1
‚é§
‚é¶.
This rotation sequence is illustrated in Fig. A.4 (a)‚Äì(d), where the axis of rotation
is [0
0
2]T and the angle of rotation 90¬∞.
Fig. A.4 Four views of the unit cube before and during the three rotations R90¬∞,xR90¬∞,zR90¬∞,y

A.6
RŒ≥,yRŒ≤,xRŒ±,y
205
A.6 RŒ≥,yRŒ≤,xRŒ±,y
RŒ≥,yRŒ≤,xRŒ±,y =
‚é°
‚é£
cŒ≥
0
sŒ≥
0
1
0
‚àísŒ≥
0
cŒ≥
‚é§
‚é¶
‚é°
‚é£
1
0
0
0
cŒ≤
‚àísŒ≤
0
sŒ≤
cŒ≤
‚é§
‚é¶
‚é°
‚é£
cŒ±
0
sŒ±
0
1
0
‚àísŒ±
0
cŒ±
‚é§
‚é¶
=
‚é°
‚é£
(cŒ≥ cŒ± ‚àísŒ≥ cŒ≤sŒ±)
sŒ≥ sŒ≤
(cŒ≥ sŒ± + sŒ≥ cŒ≤cŒ±)
sŒ≤sŒ±
cŒ≤
‚àísŒ≤cŒ±
(‚àísŒ≥ cŒ± ‚àícŒ≥ cŒ≤sŒ±)
cŒ≥ sŒ≤
(‚àísŒ≥ sŒ± + cŒ≥ cŒ≤cŒ±)
‚é§
‚é¶
R90¬∞,yR90¬∞,xR90¬∞,y =
‚é°
‚é£
0
1
0
1
0
0
0
0
‚àí1
‚é§
‚é¶
‚é°
‚é£
0
1
0
1
0
0
0
0
‚àí1
‚é§
‚é¶
‚é°
‚é£
0
0
0
0
1
1
1
1
0
0
1
1
0
0
1
1
0
1
0
1
0
1
0
1
‚é§
‚é¶
=
‚é°
‚é£
0
0
1
1
0
0
1
1
0
0
0
0
1
1
1
1
0
‚àí1
0
‚àí1
0
‚àí1
0
‚àí1
‚é§
‚é¶.
This rotation sequence is illustrated in Fig. A.5 (a)‚Äì(d), where the axis of rotation
is [2
2
0]T and the angle of rotation 180¬∞.
Fig. A.5 Four views of the unit cube before and during the three rotations R90¬∞,yR90¬∞,xR90¬∞,y

206
A
Composite Point Rotation Sequences
A.7 RŒ≥,yRŒ≤,xRŒ±,z
RŒ≥,yRŒ≤,xRŒ±,z =
‚é°
‚é£
cŒ≥
0
sŒ≥
0
1
0
‚àísŒ≥
0
cŒ≥
‚é§
‚é¶
‚é°
‚é£
1
0
0
0
cŒ≤
‚àísŒ≤
0
sŒ≤
cŒ≤
‚é§
‚é¶
‚é°
‚é£
cŒ±
‚àísŒ±
0
sŒ±
cŒ±
0
0
0
1
‚é§
‚é¶
=
‚é°
‚é£
(cŒ≥ cŒ± + sŒ≥ sŒ≤sŒ±)
(‚àícŒ≥ sŒ± + sŒ≥ sŒ≤cŒ±)
sŒ≥ cŒ≤
cŒ≤sŒ±
cŒ≤cŒ±
‚àísŒ≤
(‚àísŒ≥ cŒ± + cŒ≥ sŒ≤sŒ±)
(sŒ≥ sŒ± + cŒ≥ sŒ≤cŒ±)
cŒ≥ cŒ≤
‚é§
‚é¶
R90¬∞,yR90¬∞,xR90¬∞,z =
‚é°
‚é£
1
0
0
0
0
‚àí1
0
1
0
‚é§
‚é¶
‚é°
‚é£
1
0
0
0
0
‚àí1
0
1
0
‚é§
‚é¶
‚é°
‚é£
0
0
0
0
1
1
1
1
0
0
1
1
0
0
1
1
0
1
0
1
0
1
0
1
‚é§
‚é¶
=
‚é°
‚é£
0
0
0
0
1
1
1
1
0
‚àí1
0
‚àí1
0
‚àí1
0
‚àí1
0
0
1
1
0
0
1
1
‚é§
‚é¶.
This rotation sequence is illustrated in Fig. A.6 (a)‚Äì(d), where the axis of rotation
is [2
0
0]T and the angle of rotation 90¬∞.
Fig. A.6 Four views of the unit cube before and during the three rotations R90¬∞,yR90¬∞,xR90¬∞,z

A.8
RŒ≥,yRŒ≤,zRŒ±,x
207
A.8 RŒ≥,yRŒ≤,zRŒ±,x
RŒ≥,yRŒ≤,zRŒ±,x =
‚é°
‚é£
cŒ≥
0
sŒ≥
0
1
0
‚àísŒ≥
0
cŒ≥
‚é§
‚é¶
‚é°
‚é£
cŒ≤
‚àísŒ≤
0
sŒ≤
cŒ≤
0
0
0
1
‚é§
‚é¶
‚é°
‚é£
1
0
0
0
cŒ±
‚àísŒ±
0
sŒ±
cŒ±
‚é§
‚é¶
=
‚é°
‚é£
cŒ≥ cŒ≤
(sŒ≥ sŒ± ‚àícŒ≥ sŒ≤cŒ±)
(sŒ≥ cŒ± + cŒ≥ sŒ≤sŒ±)
sŒ≤
cŒ≤cŒ±
‚àícŒ≤sŒ±
‚àísŒ≥ cŒ≤
(cŒ≥ sŒ± + sŒ≥ sŒ≤cŒ±)
(cŒ≥ cŒ± ‚àísŒ≥ sŒ≤sŒ±)
‚é§
‚é¶
R90¬∞,yR90¬∞,zR90¬∞,x =
‚é°
‚é£
0
1
0
1
0
0
0
0
‚àí1
‚é§
‚é¶
‚é°
‚é£
0
1
0
1
0
0
0
0
‚àí1
‚é§
‚é¶
‚é°
‚é£
0
0
0
0
1
1
1
1
0
0
1
1
0
0
1
1
0
1
0
1
0
1
0
1
‚é§
‚é¶
=
‚é°
‚é£
0
0
1
1
0
0
1
1
0
0
0
0
1
1
1
1
0
‚àí1
0
‚àí1
0
‚àí1
0
‚àí1
‚é§
‚é¶.
This rotation sequence is illustrated in Fig. A.7 (a)‚Äì(d), where the axis of rotation
is [2
2
0]T and the angle of rotation 180¬∞.
Fig. A.7 Four views of the unit cube before and during the three rotations R90¬∞,yR90¬∞,zR90¬∞,x

208
A
Composite Point Rotation Sequences
A.9 RŒ≥,yRŒ≤,zRŒ±,y
RŒ≥,yRŒ≤,zRŒ±,y =
‚é°
‚é£
cŒ≥
0
sŒ≥
0
1
0
‚àísŒ≥
0
cŒ≥
‚é§
‚é¶
‚é°
‚é£
cŒ≤
‚àísŒ≤
0
sŒ≤
cŒ≤
0
0
0
1
‚é§
‚é¶
‚é°
‚é£
cŒ±
0
sŒ±
0
1
0
‚àísŒ±
0
cŒ±
‚é§
‚é¶
=
‚é°
‚é£
(‚àísŒ≥ sŒ± + cŒ≥ cŒ≤cŒ±)
‚àícŒ≥ sŒ≤
(sŒ≥ cŒ± + cŒ≥ cŒ≤sŒ±)
sŒ≤cŒ±
cŒ≤
sŒ≤sŒ±
(‚àícŒ≥ sŒ± ‚àísŒ≥ cŒ≤cŒ±)
sŒ≥ sŒ≤
(cŒ≥ cŒ± ‚àísŒ≥ cŒ≤sŒ±)
‚é§
‚é¶
R90¬∞,yR90¬∞,zR90¬∞,y =
‚é°
‚é£
‚àí1
0
0
0
0
1
0
1
0
‚é§
‚é¶
‚é°
‚é£
‚àí1
0
0
0
0
1
0
1
0
‚é§
‚é¶
‚é°
‚é£
0
0
0
0
1
1
1
1
0
0
1
1
0
0
1
1
0
1
0
1
0
1
0
1
‚é§
‚é¶
=
‚é°
‚é£
0
0
0
0
‚àí1
‚àí1
‚àí1
‚àí1
0
1
0
1
0
1
0
1
0
0
1
1
0
0
1
1
‚é§
‚é¶.
This rotation sequence is illustrated in Fig. A.8 (a)‚Äì(d), where the axis of rotation
is [0
2
2]T and the angle of rotation 180¬∞.
Fig. A.8 Four views of the unit cube before and during the three rotations R90¬∞,yR90¬∞,zR90¬∞,y

A.10
RŒ≥,zRŒ≤,xRŒ±,y
209
A.10 RŒ≥,zRŒ≤,xRŒ±,y
RŒ≥,zRŒ≤,xRŒ±,y =
‚é°
‚é£
cŒ≥
‚àísŒ≥
0
sŒ≥
cŒ≥
0
0
0
1
‚é§
‚é¶
‚é°
‚é£
1
0
0
0
cŒ≤
‚àísŒ≤
0
sŒ≤
cŒ≤
‚é§
‚é¶
‚é°
‚é£
cŒ±
0
sŒ±
0
1
0
‚àísŒ±
0
cŒ±
‚é§
‚é¶
=
‚é°
‚é£
(cŒ≥ cŒ± ‚àísŒ≥ sŒ≤sŒ±)
‚àísŒ≥ cŒ≤
(cŒ≥ sŒ± + sŒ≥ sŒ≤cŒ±)
(sŒ≥ cŒ± + cŒ≥ sŒ≤sŒ±)
cŒ≥ cŒ≤
(sŒ≥ sŒ± ‚àícŒ≥ sŒ≤cŒ±)
‚àícŒ≤sŒ±
sŒ≤
cŒ≤cŒ±
‚é§
‚é¶
R90¬∞,zR90¬∞,xR90¬∞,y =
‚é°
‚é£
‚àí1
0
0
0
0
1
0
1
0
‚é§
‚é¶
‚é°
‚é£
‚àí1
0
0
0
0
1
0
1
0
‚é§
‚é¶
‚é°
‚é£
0
0
0
0
1
1
1
1
0
0
1
1
0
0
1
1
0
1
0
1
0
1
0
1
‚é§
‚é¶
=
‚é°
‚é£
0
0
0
0
‚àí1
‚àí1
‚àí1
‚àí1
0
1
0
1
0
1
0
1
0
0
1
1
0
0
1
1
‚é§
‚é¶.
This rotation sequence is illustrated in Fig. A.9 (a)‚Äì(d), where the axis of rotation
is [0
2
2]T and the angle of rotation 180¬∞.
Fig. A.9 Four views of the unit cube before and during the three rotations R90¬∞,zR90¬∞,xR90¬∞,y

210
A
Composite Point Rotation Sequences
A.11 RŒ≥,zRŒ≤,xRŒ±,z
RŒ≥,zRŒ≤,xRŒ±,z =
‚é°
‚é£
cŒ≥
‚àísŒ≥
0
sŒ≥
cŒ≥
0
0
0
1
‚é§
‚é¶
‚é°
‚é£
1
0
0
0
cŒ≤
‚àísŒ≤
0
sŒ≤
cŒ≤
‚é§
‚é¶
‚é°
‚é£
cŒ±
‚àísŒ±
0
sŒ±
cŒ±
0
0
0
1
‚é§
‚é¶
=
‚é°
‚é£
(cŒ≥ cŒ± ‚àísŒ≥ cŒ≤sŒ±)
(‚àícŒ≥ sŒ± ‚àísŒ≥ cŒ≤cŒ±)
sŒ≥ sŒ≤
(sŒ≥ cŒ± + cŒ≥ cŒ≤sŒ±)
(‚àísŒ≥ sŒ± + cŒ≥ cŒ≤cŒ±)
‚àícŒ≥ sŒ≤
sŒ≤sŒ±
sŒ≤cŒ±
cŒ≤
‚é§
‚é¶
R90¬∞,zR90¬∞,xR90¬∞,z =
‚é°
‚é£
0
0
1
0
‚àí1
0
1
0
0
‚é§
‚é¶
‚é°
‚é£
0
0
1
0
‚àí1
0
1
0
0
‚é§
‚é¶
‚é°
‚é£
0
0
0
0
1
1
1
1
0
0
1
1
0
0
1
1
0
1
0
1
0
1
0
1
‚é§
‚é¶
=
‚é°
‚é£
0
1
0
1
0
1
0
1
0
0
‚àí1
‚àí1
0
0
‚àí1
‚àí1
0
0
0
0
1
1
1
1
‚é§
‚é¶.
This rotation sequence is illustrated in Fig. A.10 (a)‚Äì(d), where the axis of rota-
tion is [2
0
2]T and the angle of rotation 180¬∞.
Fig. A.10 Four views of the unit cube before and during the three rotations R90¬∞,zR90¬∞,xR90¬∞,z

A.12
RŒ≥,zRŒ≤,yRŒ±,x
211
A.12 RŒ≥,zRŒ≤,yRŒ±,x
RŒ≥,zRŒ≤,yRŒ±,x =
‚é°
‚é£
cŒ≥
‚àísŒ≥
0
sŒ≥
cŒ≥
0
0
0
1
‚é§
‚é¶
‚é°
‚é£
cŒ≤
0
sŒ≤
0
1
0
‚àísŒ≤
0
cŒ≤
‚é§
‚é¶
‚é°
‚é£
1
0
0
0
cŒ±
‚àísŒ±
0
sŒ±
cŒ±
‚é§
‚é¶
=
‚é°
‚é£
cŒ≥ cŒ≤
(‚àísŒ≥ cŒ± + cŒ≥ sŒ≤sŒ±)
(sŒ≥ sŒ± + cŒ≥ sŒ≤cŒ±)
sŒ≥ cŒ≤
(cŒ≥ cŒ± + sŒ≥ sŒ≤sŒ±)
(‚àícŒ≥ sŒ± + sŒ≥ sŒ≤cŒ±)
‚àísŒ≤
cŒ≤sŒ±
cŒ≤cŒ±
‚é§
‚é¶
R90¬∞,zR90¬∞,yR90¬∞,x =
‚é°
‚é£
0
0
1
0
1
0
‚àí1
0
0
‚é§
‚é¶
‚é°
‚é£
0
0
1
0
1
0
‚àí1
0
0
‚é§
‚é¶
‚é°
‚é£
0
0
0
0
1
1
1
1
0
0
1
1
0
0
1
1
0
1
0
1
0
1
0
1
‚é§
‚é¶
=
‚é°
‚é£
0
1
0
1
0
1
0
1
0
0
1
1
0
0
1
1
0
0
0
0
‚àí1
‚àí1
‚àí1
‚àí1
‚é§
‚é¶.
This rotation sequence is illustrated in Fig. A.11 (a)‚Äì(d), where the axis of rota-
tion is [0
2
0]T and the angle of rotation 90¬∞.
Fig. A.11 Four views of the unit cube before and during the three rotations R90¬∞,zR90¬∞,yR90¬∞,x

212
A
Composite Point Rotation Sequences
A.13 RŒ≥,zRŒ≤,yRŒ±,z
RŒ≥,zRŒ≤,yRŒ±,z =
‚é°
‚é£
cŒ≥
‚àísŒ≥
0
sŒ≥
cŒ≥
0
0
0
1
‚é§
‚é¶
‚é°
‚é£
cŒ≤
0
sŒ≤
0
1
0
‚àísŒ≤
0
cŒ≤
‚é§
‚é¶
‚é°
‚é£
cŒ±
‚àísŒ±
0
sŒ±
cŒ±
0
0
0
1
‚é§
‚é¶
=
‚é°
‚é£
(‚àísŒ≥ sŒ± + cŒ≥ cŒ≤cŒ±)
(‚àísŒ≥ cŒ± ‚àícŒ≥ cŒ≤sŒ±)
cŒ≥ sŒ≤
(cŒ≥ sŒ± + sŒ≥ cŒ≤cŒ±)
(cŒ≥ cŒ± ‚àísŒ≥ cŒ≤sŒ±)
sŒ≥ sŒ≤
‚àísŒ≤cŒ±
sŒ≤sŒ±
cŒ≤
‚é§
‚é¶
R90¬∞,zR90¬∞,yR90¬∞,z =
‚é°
‚é£
‚àí1
0
0
0
0
1
0
1
0
‚é§
‚é¶
‚é°
‚é£
‚àí1
0
0
0
0
1
0
1
0
‚é§
‚é¶
‚é°
‚é£
0
0
0
0
1
1
1
1
0
0
1
1
0
0
1
1
0
1
0
1
0
1
0
1
‚é§
‚é¶
=
‚é°
‚é£
0
0
0
0
‚àí1
‚àí1
‚àí1
‚àí1
0
1
0
1
0
1
0
1
0
0
1
1
0
0
1
1
‚é§
‚é¶.
This rotation sequence is illustrated in Fig. A.12 (a)‚Äì(d), where the axis of rota-
tion is [0
2
2]T and the angle of rotation 180¬∞.
Fig. A.12 Four views of the unit cube before and during the three rotations R90¬∞,zR90¬∞,yR90¬∞,z

Appendix B
Composite Frame Rotation Sequences
B.1 Euler Rotations
This appendix lists the twelve combinations of creating a composite frame rotation
sequence from R‚àí1
Œ±,x,R‚àí1
Œ≤,y and R‚àí1
Œ≥,z, which are
R‚àí1
Œ≥,xR‚àí1
Œ≤,yR‚àí1
Œ±,x,
R‚àí1
Œ≥,xR‚àí1
Œ≤,yR‚àí1
Œ±,z,
R‚àí1
Œ≥,xR‚àí1
Œ≤,zR‚àí1
Œ±,x,
R‚àí1
Œ≥,xR‚àí1
Œ≤,zR‚àí1
Œ±,y
R‚àí1
Œ≥,yR‚àí1
Œ≤,xR‚àí1
Œ±,y,
R‚àí1
Œ≥,yR‚àí1
Œ≤,xR‚àí1
Œ±,z,
R‚àí1
Œ≥,yR‚àí1
Œ≤,zR‚àí1
Œ±,x,
R‚àí1
Œ≥,yR‚àí1
Œ≤,zR‚àí1
Œ±,y
R‚àí1
Œ≥,zR‚àí1
Œ≤,xR‚àí1
Œ±,y,
R‚àí1
Œ≥,zR‚àí1
Œ≤,xR‚àí1
Œ±,z,
R‚àí1
Œ≥,zR‚àí1
Œ≤,yR‚àí1
Œ±,x,
R‚àí1
Œ≥,zR‚àí1
Œ≤,yR‚àí1
Œ±,z.
For each combination there are three Euler frame rotation matrices, the resulting
composite matrix, a matrix where the three angles equal 90¬∞, the coordinates of the
unit cube in the rotated frame, the axis and angle of rotation and a Ô¨Ågure illustrating
the stages of rotation. To compute the axis of rotation [v1
v2
v3]T we use
v1 = (a22 ‚àí1)(a33 ‚àí1) ‚àía23a32
v2 = (a33 ‚àí1)(a11 ‚àí1) ‚àía31a13
v3 = (a11 ‚àí1)(a22 ‚àí1) ‚àía12a21
where
R =
‚é°
‚é£
a11
a12
a13
a21
a22
a23
a31
a32
a33
‚é§
‚é¶
and for the angle of rotation Œ¥ we use
cosŒ¥ = 1
2

Tr(R) ‚àí1

.
We begin by deÔ¨Åning the three principal inverse Euler frame rotations:
rotate the frame Œ± about the x-axis
R‚àí1
Œ±,x =
‚é°
‚é£
1
0
0
0
cŒ±
sŒ±
0
‚àísŒ±
cŒ±
‚é§
‚é¶
J. Vince, Rotation Transforms for Computer Graphics,
DOI 10.1007/978-0-85729-154-7, ¬© Springer-Verlag London Limited 2011
213

214
B
Composite Frame Rotation Sequences
rotate the frame Œ≤ about the y-axis
R‚àí1
Œ≤,y =
‚é°
‚é£
cŒ≤
0
‚àísŒ≤
0
1
0
sŒ≤
0
cŒ≤
‚é§
‚é¶
rotate the frame Œ≥ about the z-axis
R‚àí1
Œ≥,z =
‚é°
‚é£
cŒ≥
sŒ≥
0
‚àísŒ≥
cŒ≥
0
0
0
1
‚é§
‚é¶
where cŒ± = cosŒ± and sŒ± = sinŒ±, etc.
Remember that the right-most transform is applied Ô¨Årst and the left-most trans-
form last. In terms of angles, the sequence is always Œ±, Œ≤, Œ≥ .
For each composite transform you can verify that when Œ± = Œ≤ = Œ≥ = 0 the result
is the identity transform I.
We now examine the twelve combinations in turn.

B.2
R‚àí1
Œ≥,xR‚àí1
Œ≤,yR‚àí1
Œ±,x
215
B.2 R‚àí1
Œ≥,xR‚àí1
Œ≤,yR‚àí1
Œ±,x
R‚àí1
Œ≥,xR‚àí1
Œ≤,yR‚àí1
Œ±,x =
‚é°
‚é£
1
0
0
0
cŒ≥
sŒ≥
0
‚àísŒ≥
cŒ≥
‚é§
‚é¶
‚é°
‚é£
cŒ≤
0
‚àísŒ≤
0
1
0
sŒ≤
0
cŒ≤
‚é§
‚é¶
‚é°
‚é£
1
0
0
0
cŒ±
sŒ±
0
‚àísŒ±
cŒ±
‚é§
‚é¶
=
‚é°
‚é£
cŒ≤
sŒ≤sŒ±
‚àísŒ≤cŒ±
sŒ≥ sŒ≤
(cŒ≥ cŒ± ‚àísŒ≥ cŒ≤sŒ±)
(cŒ≥ sŒ± + sŒ≥ cŒ≤cŒ±)
cŒ≥ sŒ≤
(‚àísŒ≥ cŒ± ‚àícŒ≥ cŒ≤sŒ±)
(‚àísŒ≥ sŒ± + cŒ≥ cŒ≤cŒ±)
‚é§
‚é¶
R‚àí1
90¬∞,xR‚àí1
90¬∞,yR‚àí1
90¬∞,x =
‚é°
‚é£
0
1
0
1
0
0
0
0
‚àí1
‚é§
‚é¶
‚é°
‚é£
0
1
0
1
0
0
0
0
‚àí1
‚é§
‚é¶
‚é°
‚é£
0
0
0
0
1
1
1
1
0
0
1
1
0
0
1
1
0
1
0
1
0
1
0
1
‚é§
‚é¶
=
‚é°
‚é£
0
0
1
1
0
0
1
1
0
0
0
0
1
1
1
1
0
‚àí1
0
‚àí1
0
‚àí1
0
‚àí1
‚é§
‚é¶.
This rotation sequence is illustrated in Fig. B.1 (a)‚Äì(d), where the axis of rotation
is [2
2
0]T and the angle of rotation 180¬∞.
Fig. B.1 Four views of the frame before and during the three rotations R‚àí1
90¬∞,xR‚àí1
90¬∞,yR‚àí1
90¬∞,x

216
B
Composite Frame Rotation Sequences
B.3 R‚àí1
Œ≥,xR‚àí1
Œ≤,yR‚àí1
Œ±,z
R‚àí1
Œ≥,xR‚àí1
Œ≤,yR‚àí1
Œ±,z =
‚é°
‚é£
1
0
0
0
cŒ≥
sŒ≥
0
‚àísŒ≥
cŒ≥
‚é§
‚é¶
‚é°
‚é£
cŒ≤
0
‚àísŒ≤
0
1
0
sŒ≤
0
cŒ≤
‚é§
‚é¶
‚é°
‚é£
cŒ±
sŒ±
0
‚àísŒ±
cŒ±
0
0
0
1
‚é§
‚é¶
=
‚é°
‚é£
cŒ≤cŒ±
cŒ≤sŒ±
‚àísŒ≤
(‚àícŒ≥ sŒ± + sŒ≥ sŒ≤cŒ±)
(cŒ≥ cŒ± + sŒ≥ sŒ≤sŒ±)
+sŒ≥ cŒ≤
(sŒ≥ sŒ± + cŒ≥ sŒ≤cŒ±)
(‚àísŒ≥ cŒ± + cŒ≥ sŒ≤sŒ±)
cŒ≥ cŒ≤
‚é§
‚é¶
R‚àí1
90¬∞,xR‚àí1
90¬∞,yR‚àí1
90¬∞,z =
‚é°
‚é£
0
0
‚àí1
0
1
0
1
0
0
‚é§
‚é¶
‚é°
‚é£
0
0
‚àí1
0
1
0
1
0
0
‚é§
‚é¶
‚é°
‚é£
0
0
0
0
1
1
1
1
0
0
1
1
0
0
1
1
0
1
0
1
0
1
0
1
‚é§
‚é¶
=
‚é°
‚é£
0
‚àí1
0
‚àí1
0
‚àí1
0
‚àí1
0
0
1
1
0
0
1
1
0
0
0
0
1
1
1
1
‚é§
‚é¶.
This rotation sequence is illustrated in Fig. B.2 (a)‚Äì(d), where the axis of rotation
is [0
2
0]T and the angle of rotation 90¬∞.
Fig. B.2 Four views of the frame before and during the three rotations R‚àí1
90¬∞,xR‚àí1
90¬∞,yR‚àí1
90¬∞,z

B.4
R‚àí1
Œ≥,xR‚àí1
Œ≤,zR‚àí1
Œ±,x
217
B.4 R‚àí1
Œ≥,xR‚àí1
Œ≤,zR‚àí1
Œ±,x
R‚àí1
Œ≥,xR‚àí1
Œ≤,zR‚àí1
Œ±,x =
‚é°
‚é£
1
0
0
0
cŒ≥
sŒ≥
0
‚àísŒ≥
cŒ≥
‚é§
‚é¶
‚é°
‚é£
cŒ≤
sŒ≤
0
‚àísŒ≤
cŒ≤
0
0
0
1
‚é§
‚é¶
‚é°
‚é£
1
0
0
0
cŒ±
sŒ±
0
‚àísŒ±
cŒ±
‚é§
‚é¶
=
‚é°
‚é£
cŒ≤
sŒ≤cŒ±
sŒ≤sŒ±
‚àícŒ≥ sŒ≤
(‚àísŒ≥ sŒ± + cŒ≥ cŒ≤cŒ±)
(‚àísŒ≥ cŒ± + cŒ≥ cŒ≤sŒ±)
sŒ≥ sŒ≤
(‚àícŒ≥ sŒ± ‚àísŒ≥ cŒ≤cŒ±)
(cŒ≥ cŒ± ‚àísŒ≥ cŒ≤sŒ±)
‚é§
‚é¶
R‚àí1
90¬∞,xR‚àí1
90¬∞,zR‚àí1
90¬∞,x =
‚é°
‚é£
0
0
1
0
‚àí1
0
1
0
0
‚é§
‚é¶
‚é°
‚é£
0
0
1
0
‚àí1
0
1
0
0
‚é§
‚é¶
‚é°
‚é£
0
0
0
0
1
1
1
1
0
0
1
1
0
0
1
1
0
1
0
1
0
1
0
1
‚é§
‚é¶
=
‚é°
‚é£
0
1
0
1
0
1
0
1
0
0
‚àí1
‚àí1
0
0
‚àí1
‚àí1
0
0
0
0
1
1
1
1
‚é§
‚é¶.
This rotation sequence is illustrated in Fig. B.3 (a)‚Äì(d), where the axis of rotation
is [2
0
2]T and the angle of rotation 180¬∞.
Fig. B.3 Four views of the frame before and during the three rotations R‚àí1
90¬∞,xR‚àí1
90¬∞,zR‚àí1
90¬∞,x

218
B
Composite Frame Rotation Sequences
B.5 R‚àí1
Œ≥,xR‚àí1
Œ≤,zR‚àí1
Œ±,y
R‚àí1
Œ≥,xR‚àí1
Œ≤,zR‚àí1
Œ±,y =
‚é°
‚é£
1
0
0
0
cŒ≥
sŒ≥
0
‚àísŒ≥
cŒ≥
‚é§
‚é¶
‚é°
‚é£
cŒ≤
sŒ≤
0
‚àísŒ≤
cŒ≤
0
0
0
1
‚é§
‚é¶
‚é°
‚é£
cŒ±
0
‚àísŒ±
0
1
0
sŒ±
0
cŒ±
‚é§
‚é¶
=
‚é°
‚é£
cŒ≤cŒ±
sŒ≤
‚àícŒ≤sŒ±
(sŒ≥ sŒ± ‚àícŒ≥ sŒ≤cŒ±)
cŒ≥ cŒ≤
(sŒ≥ cŒ± + cŒ≥ sŒ≤sŒ±)
(cŒ≥ sŒ± + sŒ≥ sŒ≤cŒ±)
‚àísŒ≥ cŒ≤
(cŒ≥ cŒ± ‚àísŒ≥ sŒ≤sŒ±)
‚é§
‚é¶
R‚àí1
90¬∞,xR‚àí1
90¬∞,zR‚àí1
90¬∞,y =
‚é°
‚é£
0
1
0
1
0
0
0
0
‚àí1
‚é§
‚é¶
‚é°
‚é£
0
1
0
1
0
0
0
0
‚àí1
‚é§
‚é¶
‚é°
‚é£
0
0
0
0
1
1
1
1
0
0
1
1
0
0
1
1
0
1
0
1
0
1
0
1
‚é§
‚é¶
=
‚é°
‚é£
0
0
1
1
0
0
1
1
0
0
0
0
1
1
1
1
0
‚àí1
0
‚àí1
0
‚àí1
0
‚àí1
‚é§
‚é¶.
This rotation sequence is illustrated in Fig. B.4 (a)‚Äì(d), where the axis of rotation
is [2
2
0]T and the angle of rotation 180¬∞.
Fig. B.4 Four views of the frame before and during the three rotations R‚àí1
90¬∞,xR‚àí1
90¬∞,zR‚àí1
90¬∞,y

B.6
R‚àí1
Œ≥,yR‚àí1
Œ≤,xR‚àí1
Œ±,y
219
B.6 R‚àí1
Œ≥,yR‚àí1
Œ≤,xR‚àí1
Œ±,y
R‚àí1
Œ≥,yR‚àí1
Œ≤,xR‚àí1
Œ±,y =
‚é°
‚é£
cŒ≥
0
‚àísŒ≥
0
1
0
sŒ≥
0
cŒ≥
‚é§
‚é¶
‚é°
‚é£
1
0
0
0
cŒ≤
sŒ≤
0
‚àísŒ≤
cŒ≤
‚é§
‚é¶
‚é°
‚é£
cŒ±
0
‚àísŒ±
0
1
0
sŒ±
0
cŒ±
‚é§
‚é¶
=
‚é°
‚é£
(cŒ≥ cŒ± ‚àísŒ≥ cŒ≤sŒ±)
sŒ≥ sŒ≤
(‚àícŒ≥ sŒ± ‚àísŒ≥ cŒ≤cŒ±)
sŒ≤sŒ±
cŒ≤
sŒ≤cŒ±
(sŒ≥ cŒ± + cŒ≥ cŒ≤sŒ±)
‚àícŒ≥ sŒ≤
(‚àísŒ≥ sŒ± + cŒ≥ cŒ≤cŒ±)
‚é§
‚é¶
R‚àí1
90¬∞,yR‚àí1
90¬∞,xR‚àí1
90¬∞,y =
‚é°
‚é£
0
1
0
1
0
0
0
0
‚àí1
‚é§
‚é¶
‚é°
‚é£
0
1
0
1
0
0
0
0
‚àí1
‚é§
‚é¶
‚é°
‚é£
0
0
0
0
1
1
1
1
0
0
1
1
0
0
1
1
0
1
0
1
0
1
0
1
‚é§
‚é¶
=
‚é°
‚é£
0
0
1
1
0
0
1
1
0
0
0
0
1
1
1
1
0
‚àí1
0
‚àí1
0
‚àí1
0
‚àí1
‚é§
‚é¶.
This rotation sequence is illustrated in Fig. B.5 (a)‚Äì(d), where the axis of rotation
is [2
2
0]T and the angle of rotation 180¬∞.
Fig. B.5 Four views of the frame before and during the three rotations R‚àí1
90¬∞,yR‚àí1
90¬∞,xR‚àí1
90¬∞,y

220
B
Composite Frame Rotation Sequences
B.7 R‚àí1
Œ≥,yR‚àí1
Œ≤,xR‚àí1
Œ±,z
R‚àí1
Œ≥,yR‚àí1
Œ≤,xR‚àí1
Œ±,z =
‚é°
‚é£
cŒ≥
0
‚àísŒ≥
0
1
0
sŒ≥
0
cŒ≥
‚é§
‚é¶
‚é°
‚é£
1
0
0
0
cŒ≤
sŒ≤
0
‚àísŒ≤
cŒ≤
‚é§
‚é¶
‚é°
‚é£
cŒ±
sŒ±
0
‚àísŒ±
cŒ±
0
0
0
1
‚é§
‚é¶
=
‚é°
‚é£
(cŒ≥ cŒ± ‚àísŒ≥ sŒ≤sŒ±)
(cŒ≥ sŒ± + sŒ≥ sŒ≤cŒ±)
‚àísŒ≥ cŒ≤
‚àícŒ≤sŒ±
cŒ≤cŒ±
sŒ≤
(sŒ≥ cŒ± + cŒ≥ sŒ≤sŒ±)
(sŒ≥ sŒ± ‚àícŒ≥ sŒ≤cŒ±)
cŒ≥ cŒ≤
‚é§
‚é¶
R‚àí1
90¬∞,yR‚àí1
90¬∞,xR‚àí1
90¬∞,z =
‚é°
‚é£
‚àí1
0
0
0
0
1
0
1
0
‚é§
‚é¶
‚é°
‚é£
‚àí1
0
0
0
0
1
0
1
0
‚é§
‚é¶
‚é°
‚é£
0
0
0
0
1
1
1
1
0
0
1
1
0
0
1
1
0
1
0
1
0
1
0
1
‚é§
‚é¶
=
‚é°
‚é£
0
0
0
0
‚àí1
‚àí1
‚àí1
‚àí1
0
1
0
1
0
1
0
1
0
0
1
1
0
0
1
1
‚é§
‚é¶.
This rotation sequence is illustrated in Fig. B.6 (a)‚Äì(d), where the axis of rotation
is [0
2
2]T and the angle of rotation 180¬∞.
Fig. B.6 Four views of the frame before and during the three rotations R‚àí1
90¬∞,yR‚àí1
90¬∞,xR‚àí1
90¬∞,z

B.8
R‚àí1
Œ≥,yR‚àí1
Œ≤,zR‚àí1
Œ±,x
221
B.8 R‚àí1
Œ≥,yR‚àí1
Œ≤,zR‚àí1
Œ±,x
R‚àí1
Œ≥,yR‚àí1
Œ≤,zR‚àí1
Œ±,x =
‚é°
‚é£
cŒ≥
0
‚àísŒ≥
0
1
0
sŒ≥
0
cŒ≥
‚é§
‚é¶
‚é°
‚é£
cŒ≤
sŒ≤
0
‚àísŒ≤
cŒ≤
0
0
0
1
‚é§
‚é¶
‚é°
‚é£
1
0
0
0
cŒ±
sŒ±
0
‚àísŒ±
cŒ±
‚é§
‚é¶
=
‚é°
‚é£
cŒ≥ cŒ≤
(sŒ≥ sŒ± + cŒ≥ sŒ≤cŒ±)
(‚àísŒ≥ cŒ± + cŒ≥ sŒ≤sŒ±)
‚àísŒ≤
cŒ≤cŒ±
cŒ≤sŒ±
sŒ≥ cŒ≤
(‚àícŒ≥ sŒ± + sŒ≥ sŒ≤cŒ±)
(cŒ≥ cŒ± + sŒ≥ sŒ≤sŒ±)
‚é§
‚é¶
R‚àí1
90¬∞,yR‚àí1
90¬∞,zR‚àí1
90¬∞,x =
‚é°
‚é£
0
1
0
‚àí1
0
0
0
0
1
‚é§
‚é¶
‚é°
‚é£
0
1
0
‚àí1
0
0
0
0
1
‚é§
‚é¶
‚é°
‚é£
0
0
0
0
1
1
1
1
0
0
1
1
0
0
1
1
0
1
0
1
0
1
0
1
‚é§
‚é¶
=
‚é°
‚é£
0
0
1
1
0
0
1
1
0
0
0
0
‚àí1
‚àí1
‚àí1
‚àí1
0
1
0
1
0
1
0
1
‚é§
‚é¶.
This rotation sequence is illustrated in Fig. B.7 (a)‚Äì(d), where the axis of rotation
is [2
2
0]T and the angle of rotation 180¬∞.
Fig. B.7 Four views of the frame before and during the three rotations R‚àí1
90¬∞,yR‚àí1
90¬∞,zR‚àí1
90¬∞,x

222
B
Composite Frame Rotation Sequences
B.9 R‚àí1
Œ≥,yR‚àí1
Œ≤,zR‚àí1
Œ±,y
R‚àí1
Œ≥,yR‚àí1
Œ≤,zR‚àí1
Œ±,y =
‚é°
‚é£
cŒ≥
0
‚àísŒ≥
0
1
0
sŒ≥
0
cŒ≥
‚é§
‚é¶
‚é°
‚é£
cŒ≤
sŒ≤
0
‚àísŒ≤
cŒ≤
0
0
0
1
‚é§
‚é¶
‚é°
‚é£
cŒ±
0
‚àísŒ±
0
1
0
sŒ±
0
cŒ±
‚é§
‚é¶
=
‚é°
‚é£
(‚àísŒ≥ sŒ± + cŒ≥ cŒ≤cŒ±)
cŒ≥ sŒ≤
(‚àísŒ≥ cŒ± ‚àícŒ≥ cŒ≤sŒ±)
‚àísŒ≤cŒ±
cŒ≤
sŒ≤sŒ±
(cŒ≥ sŒ± + sŒ≥ cŒ≤cŒ±)
sŒ≥ sŒ≤
(cŒ≥ cŒ± ‚àísŒ≥ cŒ≤sŒ±)
‚é§
‚é¶
R‚àí1
90¬∞,yR‚àí1
90¬∞,zR‚àí1
90¬∞,y =
‚é°
‚é£
‚àí1
0
0
0
0
1
0
1
0
‚é§
‚é¶
‚é°
‚é£
‚àí1
0
0
0
0
1
0
1
0
‚é§
‚é¶
‚é°
‚é£
0
0
0
0
1
1
1
1
0
0
1
1
0
0
1
1
0
1
0
1
0
1
0
1
‚é§
‚é¶
=
‚é°
‚é£
0
0
0
0
‚àí1
‚àí1
‚àí1
‚àí1
0
1
0
1
0
1
0
1
0
0
1
1
0
0
1
1
‚é§
‚é¶.
This rotation sequence is illustrated in Fig. B.8 (a)‚Äì(d), where the axis of rotation
is [0
2
2]T and the angle of rotation 180¬∞.
Fig. B.8 Four views of the frame before and during the three rotations R‚àí1
90¬∞,yR‚àí1
90¬∞,zR‚àí1
90¬∞,y

B.10
R‚àí1
Œ≥,zR‚àí1
Œ≤,xR‚àí1
Œ±,y
223
B.10 R‚àí1
Œ≥,zR‚àí1
Œ≤,xR‚àí1
Œ±,y
R‚àí1
Œ≥,zR‚àí1
Œ≤,xR‚àí1
Œ±,y =
‚é°
‚é£
cŒ≥
sŒ≥
0
‚àísŒ≥
cŒ≥
0
0
0
1
‚é§
‚é¶
‚é°
‚é£
1
0
0
0
cŒ≤
sŒ≤
0
‚àísŒ≤
cŒ≤
‚é§
‚é¶
‚é°
‚é£
cŒ±
0
‚àísŒ±
0
1
0
sŒ±
0
cŒ±
‚é§
‚é¶
=
‚é°
‚é£
(cŒ≥ cŒ± + sŒ≥ sŒ≤sŒ±)
sŒ≥ cŒ≤
(‚àícŒ≥ sŒ± + sŒ≥ sŒ≤cŒ±)
(‚àísŒ≥ cŒ± + cŒ≥ sŒ≤sŒ±)
cŒ≥ cŒ≤
(sŒ≥ sŒ± + cŒ≥ sŒ≤cŒ±)
cŒ≤sŒ±
‚àísŒ≤
cŒ≤cŒ±
‚é§
‚é¶
R‚àí1
90¬∞,zR‚àí1
90¬∞,xR‚àí1
90¬∞,y =
‚é°
‚é£
1
0
0
0
0
1
0
‚àí1
0
‚é§
‚é¶
‚é°
‚é£
1
0
0
0
0
1
0
‚àí1
0
‚é§
‚é¶
‚é°
‚é£
0
0
0
0
1
1
1
1
0
0
1
1
0
0
1
1
0
1
0
1
0
1
0
1
‚é§
‚é¶
=
‚é°
‚é£
0
0
0
0
1
1
1
1
0
1
0
1
0
1
0
1
0
0
‚àí1
‚àí1
0
0
‚àí1
‚àí1
‚é§
‚é¶.
This rotation sequence is illustrated in Fig. B.9 (a)‚Äì(d), where the axis of rotation
is [2
0
0]T and the angle of rotation 90¬∞.
Fig. B.9 Four views of the frame before and during the three rotations R‚àí1
90¬∞,zR‚àí1
90¬∞,xR‚àí1
90¬∞,y

224
B
Composite Frame Rotation Sequences
B.11 R‚àí1
Œ≥,zR‚àí1
Œ≤,xR‚àí1
Œ±,z
R‚àí1
Œ≥,zR‚àí1
Œ≤,xR‚àí1
Œ±,z =
‚é°
‚é£
cŒ≥
sŒ≥
0
‚àísŒ≥
cŒ≥
0
0
0
1
‚é§
‚é¶
‚é°
‚é£
1
0
0
0
cŒ≤
sŒ≤
0
‚àísŒ≤
cŒ≤
‚é§
‚é¶
‚é°
‚é£
cŒ±
sŒ±
0
‚àísŒ±
cŒ±
0
0
0
1
‚é§
‚é¶
=
‚é°
‚é£
(cŒ≥ cŒ± ‚àísŒ≥ cŒ≤sŒ±)
(cŒ≥ sŒ± + sŒ≥ cŒ≤cŒ±)
sŒ≥ sŒ≤
(‚àísŒ≥ cŒ± ‚àícŒ≥ cŒ≤sŒ±)
(‚àísŒ≥ sŒ± + cŒ≥ cŒ≤cŒ±)
+cŒ≥ sŒ≤
sŒ≤sŒ±
‚àísŒ≤cŒ±
cŒ≤
‚é§
‚é¶
R‚àí1
90¬∞,zR‚àí1
90¬∞,xR‚àí1
90¬∞,z =
‚é°
‚é£
0
0
1
0
‚àí1
0
1
0
0
‚é§
‚é¶
‚é°
‚é£
0
0
1
0
‚àí1
0
1
0
0
‚é§
‚é¶
‚é°
‚é£
0
0
0
0
1
1
1
1
0
0
1
1
0
0
1
1
0
1
0
1
0
1
0
1
‚é§
‚é¶
=
‚é°
‚é£
0
1
0
1
0
1
0
1
0
0
‚àí1
‚àí1
0
0
‚àí1
‚àí1
0
0
0
0
1
1
1
1
‚é§
‚é¶.
This rotation sequence is illustrated in Fig. B.10 (a)‚Äì(d), where the axis of rota-
tion is [2
0
2]T and the angle of rotation 180¬∞.
Fig. B.10 Four views of the frame before and during the three rotations R‚àí1
90¬∞,zR‚àí1
90¬∞,xR‚àí1
90¬∞,z

B.12
R‚àí1
Œ≥,zR‚àí1
Œ≤,yR‚àí1
Œ±,x
225
B.12 R‚àí1
Œ≥,zR‚àí1
Œ≤,yR‚àí1
Œ±,x
R‚àí1
Œ≥,zR‚àí1
Œ≤,yR‚àí1
Œ±,x =
‚é°
‚é£
cŒ≥
sŒ≥
0
‚àísŒ≥
cŒ≥
0
0
0
1
‚é§
‚é¶
‚é°
‚é£
cŒ≤
0
‚àísŒ≤
0
1
0
sŒ≤
0
cŒ≤
‚é§
‚é¶
‚é°
‚é£
1
0
0
0
cŒ±
sŒ±
0
‚àísŒ±
cŒ±
‚é§
‚é¶
=
‚é°
‚é£
cŒ≥ cŒ≤
(sŒ≥ cŒ± + cŒ≥ sŒ≤sŒ±)
(sŒ≥ sŒ± ‚àícŒ≥ sŒ≤cŒ±)
‚àísŒ≥ cŒ≤
(cŒ≥ cŒ± ‚àísŒ≥ sŒ≤sŒ±)
(cŒ≥ sŒ± + sŒ≥ sŒ≤cŒ±)
sŒ≤
‚àícŒ≤sŒ±
cŒ≤cŒ±
‚é§
‚é¶
R‚àí1
90¬∞,zR‚àí1
90¬∞,yR‚àí1
90¬∞,x =
‚é°
‚é£
0
0
1
0
‚àí1
0
1
0
0
‚é§
‚é¶
‚é°
‚é£
0
0
1
0
‚àí1
0
1
0
0
‚é§
‚é¶
‚é°
‚é£
0
0
0
0
1
1
1
1
0
0
1
1
0
0
1
1
0
1
0
1
0
1
0
1
‚é§
‚é¶
=
‚é°
‚é£
0
1
0
1
0
1
0
1
0
0
‚àí1
‚àí1
0
0
‚àí1
‚àí1
0
0
0
0
1
1
1
1
‚é§
‚é¶.
This rotation sequence is illustrated in Fig. B.11 (a)‚Äì(d), where the axis of rota-
tion is [2
0
2]T and the angle of rotation 180¬∞.
Fig. B.11 Four views of the frame before and during the three rotations R‚àí1
90¬∞,zR‚àí1
90¬∞,yR‚àí1
90¬∞,x

226
B
Composite Frame Rotation Sequences
B.13 R‚àí1
Œ≥,zR‚àí1
Œ≤,yR‚àí1
Œ±,z
R‚àí1
Œ≥,zR‚àí1
Œ≤,yR‚àí1
Œ±,z =
‚é°
‚é£
cŒ≥
sŒ≥
0
‚àísŒ≥
cŒ≥
0
0
0
1
‚é§
‚é¶
‚é°
‚é£
cŒ≤
0
‚àísŒ≤
0
1
0
sŒ≤
0
cŒ≤
‚é§
‚é¶
‚é°
‚é£
cŒ±
sŒ±
0
‚àísŒ±
cŒ±
0
0
0
1
‚é§
‚é¶
=
‚é°
‚é£
(‚àísŒ≥ sŒ± + cŒ≥ cŒ≤cŒ±)
(sŒ≥ cŒ± + cŒ≥ cŒ≤sŒ±)
‚àícŒ≥ sŒ≤
(‚àícŒ≥ sŒ± ‚àísŒ≥ cŒ≤cŒ±)
(cŒ≥ cŒ± ‚àísŒ≥ cŒ≤sŒ±)
sŒ≥ sŒ≤
sŒ≤cŒ±
sŒ≤sŒ±
cŒ≤
‚é§
‚é¶
R‚àí1
90¬∞,zR‚àí1
90¬∞,yR‚àí1
90¬∞,z =
‚é°
‚é£
‚àí1
0
0
0
0
1
0
1
0
‚é§
‚é¶
‚é°
‚é£
‚àí1
0
0
0
0
1
0
1
0
‚é§
‚é¶
‚é°
‚é£
0
0
0
0
1
1
1
1
0
0
1
1
0
0
1
1
0
1
0
1
0
1
0
1
‚é§
‚é¶
=
‚é°
‚é£
0
0
0
0
‚àí1
‚àí1
‚àí1
‚àí1
0
1
0
1
0
1
0
1
0
0
1
1
0
0
1
1
‚é§
‚é¶.
This rotation sequence is illustrated in Fig. B.12 (a)‚Äì(d), where the axis of rota-
tion is [0
2
2]T and the angle of rotation 180¬∞.
Fig. B.12 Four views of the frame before and during the three rotations R‚àí1
90¬∞,zR‚àí1
90¬∞,yR‚àí1
90¬∞,z

Appendix C
The Four n-Square Algebras
C.1 Introduction
The magnitude of a real quantity is its positive value. However, when dealing with
objects such as complex numbers, quaternions and octonions, their magnitude is
expressed using the Pythagorean formula which takes the square root of the sums of
the terms squared.
For example, the magnitude of a complex number z1 = a + bi is
|z1| =

a2 + b2
and the magnitude of a quaternion q = s + xi + yj + zk is
|q| =
	
s2 + x2 + y2 + z2
and something similar for an octonion, which has 8 terms.
In their book On Quaternions and Octonions [9], John Conway and Derek Smith
use the Euclidean norm N to represent the sums of the squares, although other au-
thors deÔ¨Åne the Euclidean norm as
‚àö
N. However, for the purpose of this description
I will employ Conway and Smith‚Äôs deÔ¨Ånition. Thus
N(a + bi) = a2 + b2
and
N(q) = s2 + x2 + y2 + z2.
We know from the algebra of complex numbers that
|z1||z2| = |z1z2|
or
N(z1)N(z2) = N(z1z2)
and from the algebra of quaternions that
|q1||q2| = |q1q2|
J. Vince, Rotation Transforms for Computer Graphics,
DOI 10.1007/978-0-85729-154-7, ¬© Springer-Verlag London Limited 2011
227

228
C
The Four n-Square Algebras
or
N(q1)N(q2) = N(q1q2).
The algebra of octonions also includes this composition law.
In the algebra of reals R, we have
x2
1y2
1 = (x1y1)2.
In the algebra of complex numbers C, we have
z1 = x1 + x2i
z2 = y1 + y2i

x2
1 + x2
2

y2
1 + y2
2

= (x1y1 ‚àíx2y2)2 + (x1y2 + x2y1)2.
In the algebra of quaternions H, we have
q1 = x1 + x2i + x3j + x4k
q2 = y1 + y2i + y3j + y4k

x2
1 + x2
2 + x2
3 + x2
4

y2
1 + y2
2 + y2
3 + y2
4

= (x1y1 ‚àíx2y2 ‚àíx3y3 ‚àíx4y4)2
+ (x1y2 + x2y1 + x3y4 ‚àíx4y3)2
+ (x1y3 ‚àíx2y4 + x3y1 + x4y2)2
+ (x1y4 + x2y3 ‚àíx3y2 + x4y1)2.
And in the algebra of octonions O, we have something similar, but with many more
terms.
The above algebras are called composition algebras because of their inherent
composition law, and Adolf Hurwitz proved that such algebras can only exist in 1,
2, 4 and 8 dimensions.

References
1. Crowe, M.J.: A History of Vector Analysis. Dover, New York (1994)
2. Hamilton, W.R.: Lectures on Quaternions. Hodges and Smith, Dublin (1853)
3. Gibbs, J.W.: Elements of Vector Analysis. Tuttle, Moorehouse & Taylor, New Haven (1884)
4. Vince, J.A.: Mathematics for Computer Graphics. Springer, London (2010)
5. Vince, J.A.: Geometric Algebra for Computer Graphics. Springer, London (2008)
6. Vince, J.A.: Geometric Algebra: An Algebraic System for Computer Games and Animation.
Springer, London (2009)
7. Altmann, S.: Hamilton, Rodrigues and the quaternion scandal. Math. Mag. 62(5), 291‚Äì308
(1989)
8. Stillwell, J.: Numbers and Geometry. Springer, New York (1998)
9. Conway, J., Smith, D.: On Quaternions and Octonions. AK Peters, Natick (2003)
J. Vince, Rotation Transforms for Computer Graphics,
DOI 10.1007/978-0-85729-154-7, ¬© Springer-Verlag London Limited 2011
229


Index
2D frames of reference, 103
2D rotation transform, 87
2D rotor, 188
2D transforms, 85
3D frames of reference, 143
3D rotations, 184
3D rotor, 189
3D transforms, 115
3D vectors, 19
A
Adding quaternions, 60
AfÔ¨Åne transform, 90
Antisymmetric functions, 67
Antisymmetric matrix, 48
B
Bivector, 70, 93
Bivector rotors, 181
C
Cartesian vector, 21
Cayley, Arthur, 33, 155
Characteristic equation, 52, 123
Clifford, William Kingdon, 67
Cofactors of a matrix, 41
Column vector, 17
Commutative, 20
Complex addition, 7
Complex argument, 12
Complex conjugate, 8
Complex division, 8
Complex inverse, 9
Complex number axioms, 6
Complex numbers, 5
Complex plane, 10
Complex product, 7
Complex rotor, 13
Composite rotations, 91, 118, 149
Composition algebras, 155
Cross product, 24
D
Determinant of a matrix, 39
Diagonal matrix, 45
Direction cosines, 2D, 109
Dot product, 22
Duality, 80
E
Eigenvalue, 50, 169
Eigenvector, 50, 123, 169
Euler, Leonhard, 10
Euler rotations, 116
Extracting a rotor, 191
F
Frames of reference, 103, 143, 171
G
Geometric product, 69, 71
Gibbs, Josiah, 25, 59
Gimbal lock, 130
Grades, 75
H
Hamilton, William Rowan, 17, 24, 59, 155
Hamilton‚Äôs rules, 25, 59, 81
Hestenes, David, 67
Homogeneous coordinates, 85
Hurwitz, Adolph, 155
I
Identity matrix, 35
Imaginary, 5
J. Vince, Rotation Transforms for Computer Graphics,
DOI 10.1007/978-0-85729-154-7, ¬© Springer-Verlag London Limited 2011
231

232
Index
Inner product, 69
Interpolating quaternions, 173
Interpolating vectors, 28
Inverse matrix, 37
Inverse of a vector, 77
Inverse quaternion, 64
Inverse transforms, 92
L
Laplace, Pierre Simon, 41
Laplace expansion, 42
M
Magnitude of a quaternion, 62
Magnitude of a vector, 18
Matrices, 33
Matrix addition, 35
Matrix inverse, 42
Matrix notation, 33
Matrix product, 36
Matrix transforms, 86
Matrix transpose, 35
Minor determinant, 40
Modulus of a complex number, 6
Multiplying quaternions, 61
Multivector axioms, 74
Multivector rotor, 97
Multivector transforms, 93
Multivectors, 67, 75
N
Non-commutative, 37, 60
O
Octonions, 155
Orthogonal matrix, 45
Outer product, 69
Outer product of three vectors, 73
P
Pitch, 132
Polar representation, 11
Position vector, 20
Pseudoscalars, 75
Pure quaternion, 62
Q
Quaternion addition, 60
Quaternion axioms, 60
Quaternion conjugate, 63
Quaternion matrix, 162
Quaternion multiplication, 61
Quaternions, 59, 81, 155
R
ReÔ¨Çecting a vector, 182
Reverse of a multivector, 82
Right-hand rule, 27
Rodrigues, Olinde, 139
Roll, 132
Rotate a point, 116
Rotated frames, 106
Rotating about an axis, 117, 134
Rotation in the plane, 85
Rotation transform, 45
Rotation transforms in space, 115
Rotor matrices, 188
Row vector, 17
S
Sarrus, J.P., 39
Scalar product, 22
Skew symmetric matrix, 48
Spherical interpolant, 176
Square matrix, 39, 46
Subtracting quaternions, 60
Symmetric functions, 67
Symmetric matrix, 47
T
Three reÔ¨Çections theorem, 181
Trace of a matrix, 46
Translate a point, 115
Translated frames, 104
Translation transform, 87
Trivector, 74, 75, 93
U
Unit bivector, 94
Unit normal vector, 27
Unit quaternion, 62
Unit vector, 21
V
Vector addition, 20
Vector interpolation, 28
Vector inverse, 77
Vector magnitude, 18
Vector notation, 17
Vector product, 24, 55
Vector subtraction, 20
W
Wedge product, 73
Y
Yaw, 132

