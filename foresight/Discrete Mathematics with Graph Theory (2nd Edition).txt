Discrete Mathematices
witLh Graph Thoery
Second Edition
Edgar G. Goodoire
* Michael M. Pormenlte r

Notation
Here, and on the last two end papers, is a list of the symbols and other notation used in this book grouped, as
best as possible, by subject. Page numbers give the location of first appearance.
Page 
Symbol
Meaning
Miscellaneous
5 /
12
76
90
121
152
162
Logical
3
4
5
7
7
17
17
22
22
22
Common
37
38
38
38
39
81
I
jx
t1%
>1
11
V
3
A
V
1
Sets
N or N
Q or Q
R or JR
Z or Z
C or C
R+
used to express the negation of any symbol over which it is written;
for example, , means "does not belong to"
used to denote the end of a proof
the absolute value of x
pronounced "aleph naught," this is the cardinality of the natural
numbers
approximately
sum
product
implies
if and only if
negation
for all
there exists
and
or
denotes logical equivalence
contradiction
tautology
the natural numbers
the rational numbers
the real numbers
the integers
the complex numbers
the positive real numbers
-1
= 
r
= 
r

Discrete
Mathematics
with Graph Theory

Discrete
Mathematics
with Graph Theory
Second Edition
Edgar G. Goodaire
Memorial University of Newfoundland
Michael M. Parmenter
Memorial University of Newfoundland
PRENTICE HALL
Upper Saddle River, NJ 07458

Library of Congress Cataloging-in-Publication Data
Goodaire, Edgar G.
Discrete mathematics with graph theory / Edgar G. Goodaire, Michael M. Parmenter.-
2nd ed.
p. cm.
Includes bibliographical references and index.
ISBN 0-13-092000-2
1. Mathematics. 2. Computer science-Mathematics. 3. Graph theory. I. Parmenter,
Michael M. II. Title.
QA39.3.G66 2002
511 -dc2l 
2001037448
Acquisitions Editor: George Lobell
Production Editor/Assistant Managing Editor: Bayani Mendoza de Leon
Vice-President/Director of Production and Manufacturing: David W. Riccardi
Executive Managing Editor: Kathleen Schiaparelli
Senior Managing Editor: Linda Mihatov Behrens
Manufacturing Buyer: Alan Fischer
Manufacturing Manager: Trudy Pisciotti
Marketing Manager: Angela Battle
Assistant Editor of Media: Vince Jansen
Managing Editor, Audio/Video Assets: Grace Hazeldine
Creative Director: Carole Anson
Paul Belfanti: Director of Creative Services
Interior/Cover Designer: John Christiana
Art Director: Maureen Eide
Editorial Assistant: Melanie Van Benthuysen
Cover Image: Wassily Kandinsky, "Entwurf zu Kreise im Kreis" 1923, Philadelphia Museum of Art/
Corbis/Artists Right Society, NY
Â©) 2002, 1998 by Prentice-Hall, Inc.
Upper Saddle River, NJ 07458
All rights reserved. No part of this book may be
reproduced, in any form or by any means,
without permission in writing from the publisher.
Printed in the United States of America
10 
9 
8 
7 
6 
5 
4 
3 
2 
1
ISBN 0-13-092000-2
Pearson Education Ltd., London
Pearson Education Australia Pty. Limited, Sydney
Pearson Education Singapore, Pte. Ltd.
Pearson Education North Asia Ltd., Hong Kong
Pearson Education Canada, Ltd., Toronto
Pearson EducaciUn de Mexico, S.A. de C.V.
Pearson Education - Japan, Tokyo
Pearson Education Malaysia, Pte. Ltd.

To Linda 
E. G. G.
To Brenda 
M. M. P.
Only those who live with an author can appreciate the work that goes
into writing. We are sincerely grateful for the loving encouragement
and patience of our wives over a period of years while we have worked
on two editions of this book.

Contents
Preface 
xi
Suggested Lecture Schedule xvii
Yes, There are Proofs! 1
1.1 
Compound Statements 2
1.2 Proofs in Mathematics 9
1.3 Truth Tables 17
1.4 The Algebra of Propositions 21
1.5 Logical Arguments 28
Review Exercises 34
2 
Sets and Relations 37
2.1 Sets 37
2.2 Operations on Sets 43
2.3 Binary Relations 51
2.4 Equivalence Relations 56
2.5 Partial Orders 63
Review Exercises 68
3 
Functions 71
3.1 Domain, Range, One-to-One, Onto 71
3.2 Inverses and Composition 79
3.3 One-to-One Correspondence and the Cardinality of a Set 87
Review Exercises 95
4 The Integers 97
4.1 
The Division Algorithm 97
4.2 Divisibility and the Euclidean Algorithm 104
4.3 Prime Numbers 114
4.4 Congruence 126
4.5 Applications of Congruence 136
Review Exercises 147
vii

Viii Contents
5 Induction and Recursion 149
5.1 
Mathematical Induction 149
5.2 Recursively Defined Sequences 163
5.3 Solving Recurrence Relations; The Characteristic Polynomial 173
5.4 Solving Recurrence Relations; Generating Functions 178
Review Exercises 185
6 
Principles of Counting 187
6.1 
The Principle of Inclusion-Exclusion 187
6.2 The Addition and Multiplication Rules 196
6.3 The Pigeon-Hole Principle 204
Review Exercises 209
7 Permutations and Combinations 211
7.1 
Permutations 211
7.2 Combinations 216
7.3 Repetitions 223
7.4 Derangements 228
7.5 The Binomial Theorem 231
Review Exercises 237
8 Algorithms 239
8.1 
What Is an Algorithm? 239
8.2 Complexity 246
8.3 Searching and Sorting 259
8.4 Enumeration of Permutations and Combinations 271
Review Exercises 275
9 Graphs 277
9.1 A Gentle Introduction 277
9.2 Definitions and Basic Properties 286
9.3 Isomorphism 294
Review Exercises 299
1 Q Paths and Circuits 303
10.1 Eulerian Circuits 303
10.2 Hamiltonian Cycles 310
10.3 The Adjacency Matrix 318
10.4 Shortest Path Algorithms 325
Review Exercises 333

Contents 
iX
I I Applications of Paths and Circuits 337
11.1 The Chinese Postman Problem 337
11.2 Digraphs 342
11.3 RNA Chains 350
11.4 Tournaments 355
11.5 Scheduling Problems 360
Review Exercises 365
1 2 Trees 367
12.1 What Is a Tree? 367
12.2 Properties of Trees 372
12.3 Spanning Trees 377
12.4 Minimum Spanning Tree Algorithms 382
12.5 Acyclic Digraphs and Bellman's Algorithm 392
Review Exercises 397
13 Depth-First Search and Applications 399
13.1 Depth-First Search 399
13.2 The One-Way Street Problem 405
Review Exercises 411
14 Planar Graphs and Colorings 413
14.1 Planar Graphs 413
14.2 Coloring Graphs 421
14.3 Circuit Testing and Facilities Design 430
Review Exercises 438
1 5 The Max Flow-Min Cut Theorem 441
15.1 Flows and Cuts 441
15.2 Constructing Maximal Flows 448
15.3 Applications 454
15.4 Matchings 459
Review Exercises 464
Solutions to Selected Exercises S-i
Glossary G-1
Index I-l

Preface
To the Student from the Authors
Few people ever read a preface, and those who do often just glance at the first few lines. So we
begin by answering the question most frequently asked by the readers of our manuscript: "What
does [BB] mean?" Like most undergraduate texts in mathematics these days, answers to some
of our exercises appear at the back of the book. Those which do are marked [BB] for "Back of
Book." In this book, complete solutions, not simply answers, are given to almost all the exercises
marked [BB]. So, in a sense, there is a free Student Solutions Manual at the end of this text.
We are active mathematicians who have always enjoyed solving problems. It is our hope that
our enthusiasm for mathematics and, in particular, for discrete mathematics is transmitted to our
readers through our writing.
The word "discrete" means separate or distinct. Mathematicians view it as the opposite of
"continuous." Whereas, in calculus, it is continuous functions of a real variable that are important,
such functions are of relatively little interest in discrete mathematics. Instead of the real numbers,
it is the natural numbers 1, 2, 3, .. . that play a fundamental role, and it is functions with domain
the natural numbers that are often studied. Perhaps the best way to summarize the subject matter
of this book is to say that discrete mathematics is the study of problems associated with the
natural numbers.
You should never read a mathematics book or notes taken in a mathematics course the way
you read a novel, in an easy chair by the fire. You should read at a desk, with paper and pencil
at hand, verifying statements which are less than clear and inserting question marks in margins
so that you are ready to ask questions at the next available opportunity.
Definitions and terminology are terribly important in mathematics, much more so than many
students think. In our experience, the number one reason why students have difficulty with
"proofs" in mathematics is their failure to understand what the question is asking. This book
contains a glossary of definitions (often including examples) at the end as well as a summary of
notation inside the front and back covers. We urge you to consult these areas of the book regularly.
As an aid to interaction between author and student, we occasionally ask you to "pause a
moment" and think about a specific point we have just raised. Our Pauses are little questions
intended to be solved on the spot, right where they occur, like this.
Where will you find [BB] in this book and what does it mean'?
The answers to Pauses are given at the end of every section just before the exercises. So when
a Pause appears, it is easy to cheat by turning over the page and looking at the answer, but that,
of course, is not the way to learn mathematics!
XD 
We believe that writing skills are terribly important, so, in this edition, we have highlighted
some exercises where we expect answers to be written in complete sentences and good English.
xi

Xii 
Preface
Discrete mathematics is quite different from other areas in mathematics which you may have
already studied, such as algebra, geometry, or calculus. It is much less structured; there are far
fewer standard techniques to learn. It is, however, a rich subject full of ideas at least some of
which we hope will intrigue you to the extent that you will want to learn more about them. Related
sources of material for further reading are given in numerous footnotes throughout the text.
To the Student from a Student
I am a student at Memorial University of Newfoundland and have taken a course based on a
preliminary version of this book. I spent one summer working for the authors, helping them to
try to improve the book. As part of my work, they asked me to write an introduction for the
student. They felt a fellow student would be the ideal person to prepare (warn?) other students
before they got too deeply engrossed in the book.
There are many things which can be said about this textbook. The authors have a unique sense
of humor, which often, subtly or overtly, plays a part in their presentation of material. It is an
effective tool in keeping the information interesting and, in the more subtle cases, in keeping
you alert. They try to make discrete mathematics as much fun as possible, at the same time
maximizing the information presented.
While the authors do push a lot of new ideas at you, they also try hard to minimize potential
difficulties. This is not an easy task considering that there are many levels of students who will
use this book, so the material and exercises must be challenging enough to engage all of them.
To balance this, numerous examples in each section are given as a guide to the exercises. Also,
the exercises at the end of every section are laid out with easier ones at the beginning and the
harder ones near the end.
Concerning the exercises, the authors' primary objective is not to stump you or to test more
than you should know. The purpose of the exercises is to help clarify the material and to make
sure you understand what has been covered. The authors intend that you stop and think before
you start writing.
Inevitably, not everything in this book is exciting. Some material may not even seem par-
ticularly useful. As a textbook used for discrete mathematics and graph theory, there are many
topics which must be covered. Generally, less exciting material is in the first few chapters and
more interesting topics are introduced later. For example, the chapter on sets and relations may
not captivate your attention, but it is essential for the understanding of almost all later topics.
The chapter on principles of counting is both interesting and useful, and it is fundamental to a
subsequent chapter on permutations and combinations.
This textbook is written to engage your mind and to offer a fun way to learn some mathematics.
The authors do hope that you will not view this as a painful experience, but as an opportunity to
begin to think seriously about various areas of modern mathematics. The best way to approach
this book is with pencil, paper, and an open mind.
To the Instructor
Since the first printing of this book, we have received a number of queries about the existence of
a solutions manual. Let us begin then with the assurance that a complete solutions manual does
exist and is available from the publisher, for the benefit of instructors.

Preface xiii
The material in this text has been taught and tested for many years in two one-semester
courses, one in discrete mathematics at the sophomore level (with no graph theory) and the other
in applied graph theory (at the junior level). We believe this book is more elementary and written
with a far more leisurely style than comparable books on the market. For example, since students
can enter our courses without calculus or without linear algebra, this book does not presume that
students have backgrounds in either subject. The few places where some knowledge of a first
calculus or linear algebra course would be useful are clearly marked. With one exception, this
book requires virtually no background. The exception is Section 10.3, on the adjacency matrix
of a graph, where we assume a little linear algebra. If desired, this section can easily be omitted
without consequences.
The material for our first course can be found in Chapters 1 through 7, although we find it
impossible to cover all the topics presented here in the thirty-three 50-minute lectures available
to us. There are various ways to shorten the course. One possibility is to omit Chapter 4 (The
Integers), although it is one of our favorites, especially if students will subsequently take a
number theory course. Another solution is to omit all but the material on mathematical induction
in Chapter 5, as well as certain other individual topics, such as partial orders (Section 2.5) and
derangements (Section 7.4).
Graph theory is the subject of Chapters 9 through 15, and again we find that there is more
material here than can be successfully treated in thirty-three lectures. Usually, we include only a
selection of the various applications and algorithms presented in this part of the text. We do not
always discuss the puzzles in Section 9. 1, scheduling problems (Section 11.5), applications of the
Max Flow-Min Cut Theorem, or matchings (Sections 15.3 and 15.4). Chapter 13 (Depth-First
Search and Applications) can also be omitted without difficulty. In fact, most of the last half of
this book is self-contained and can be treated to whatever extent the instructor may desire.
Chapter 8, which introduces the concepts of algorithm and complexity, seems to work best as
the introduction to the graph theory course.
Wherever possible, we have tried to keep the material in various chapters independent of mate-
rial in earlier chapters. There are, of course, obvious situations where this is simply not possible.
It is necessary to understand equivalence relations (Section 2.4), for example, before reading
about congruence in Section 4.4, and one must study Hamiltonian graphs (Section 10.2) before
learning about facilities design in Section 14.3. For the most part, however, the graph theory
material can be read independently of earlier chapters. Some knowledge of such basic notions as
function (Chapter 3) and equivalence relation is needed in several places and, of course, many
proofs in graph theory require mathematical induction (Section 5.1).
On the other hand, we have deliberately included in most exercise sets some problems which
relate to material in earlier sections, as well as some which are based solely on the material in the
given section. This opens a wide variety of possibilities to instructors as to the kind of syllabus
they wish to follow and to the level of exercise that is most appropriate to their students. We
hope students of our book will appreciate the complete solutions, not simply answers, provided
for many of the exercises at the back. By popular demand, we have increased the number of
[BB]s in this second edition by over 60%.
One of the main goals of this book is to introduce students in a rigorous, yet friendly, way to
the "mysteries" of theorem proving. Sections 1.1 and 1.2 are intended as background preparation
for this often difficult journey. Because many instructors wish to include more formal topics
in logic, this edition includes sections on truth tables, the algebra of propositions, and logical
arguments (Sections 1.3, 1.4, 1.5, respectively).

XiV 
Preface
Supplements
There is a full Instructor's Solutions Manual (0130920126) free to faculty, available only through
Prentice Hall's sales reps and home offices. In addition, there is a student website of activities
available by November 1, 2001 at the following address: www.prenhall.com/goodaire. This site
is free to all users/purchasers of this text.
New in the Second Edition
The most common (negative) criticism of our first edition was the short treatment of logic and the
absence of truth tables. This problem has been remedied with Chapter 1 (previously Chapter 0)
completely rewritten and expanded significantly to include new sections on truth tables, the
algebra of propositions, and logical arguments. The text now includes more than enough material
for instructors who wish to include a substantial unit on formal logic, while continuing to permit
a shorter treatment dealing exclusively with the major points and jargon of proofs in mathematics.
The second most common complaint-and every student's favorite-was the shortage of
answers in the back of the book. In fact, the first edition contained over 500 solved problems.
For the second edition, however, this number has been increased to over 800.
Other features of the second edition include the following:
.
A new section (12.5) on acyclic graphs and an algorithm of Bellman
.
A shortest path algorithm due to Bellman and Ford which permits negative weight arcs, in
the section (11.2) on digraphs
â¢ Algorithms rewritten in a less casual way so as to more closely resemble computer code
.
Review exercises at the end of every chapter
.
Nonmathematical exercises, often requiring some research on behalf of the reader, asking that
answers be written in good clear English, in order to encourage the development of sound
writing and expository skills
.
A new numbering scheme which will make searching much easier for our readers
Acknowledgments
This book represents the culmination of many years of work and reflects the comments and sugges-
tions of numerous individuals. We acknowledge with gratitude the assistance and patience of our
acquisitions editor, George Lobell, and his assistant, Melanie Van Benthuysen; our production edi-
tor, Bayani Mendoza de Leon; and all the staff at Prentice Hall who have helped with this project.
We thank sincerely the literally hundreds of students at Memorial University of Newfound-
land and elsewhere who have used and helped us to improve this text. Matthew Case spent an
entire summer carefully scrutinizing our work. Professors from far and wide have made helpful
suggestions. For the current edition, we are especially indebted to Peter Booth, Clayton Halfyard,
David Pike, and Nabil Shalaby at Memorial University of Newfoundland. David, in particular,
gave us a lot of help for which we are most grateful.
Without exception, each of the reviewers Prentice Hall employed on this project gave us helpful
and extensive criticism with just enough praise to keep us working. We thank, in particular, the
reviewers of our first edition:
Amitabha Ghosh (Rochester Institute of Technology)
Akihiro Kanamori (Boston University)

Preface 
XV
Nicholas Krier (Colorado State University)
Suraj C. Kothari (Iowa State University)
Joseph Kung (University of North Texas)
Nachimuthu Manickam (Depauw University)
those of the second edition:
David M. Arnold (Baylor University)
Kiran R. Bhutani (The Catholic University of America)
Krzysztof Galicki (University of New Mexico)
Heather Gavias (Grand Valley State University)
Gabor J. Szekely (Bowling Green State University)
and those who prefer to remain anonymous.
While this book was eventually typeset by Prentice Hall, it was prepared on the first author's
computer using the MathTime and MathTime Plus fonts of Y&Y, Inc. We wish to thank Mr. Louis
Vosloo of Y&Y Support for his unusual patience and help.
Most users of this book have had, and will continue to have, queries, concerns, and com-
ments to express. We are always delighted to engage in correspondence with our readers and
encourage students and course instructors alike to send us e-mail anytime. Our addresses are
edgar@math.mun. ca and michaeli@math. mun.ca.
Answers to Pauses
1. [BB] is found throughout the exercises in this book. It means that the answer to the exercise
which it labels can be found in the Back of the Book.
EXERCISES
There are no exercises in this Preface, but there are over two thousand exercises in the rest of
the book!
E. G. Goodaire
M. M. Parmenter
edgar@math.mun.ca
michaell@math.mun.ca

Suggested Lecture Schedule
Yes, There are Proofs! 
8 lectures
1.1 
Compound Statements 
1
1.2 
Proofs in Mathematics 
2
1.3 Truth Tables 
2
1.4 The Algebra of Propositions 
2
1.5 
Logical Arguments 
1
2 Sets and Relations 
6 lectures
2.1 
Sets 
l
2.2 Operations on Sets 
1
2.3 
Binary Relations 
1
2.4 
Equivalence Relations 
2
2.5 
Partial Orders 
l
3 Functions 
6 lectures
3.1 
Domain, Range, One-to-One, Onto 
2
3.2 
Inverses and Composition 
2
3.3 
One-to-One Correspondence and the Cardinality of a Set 
2
4 The Integers 
11 lectures
4.1 
The Division Algorithm 
22
4.2 
Divisibility and the Euclidean Algorithm 
22
4.3 
Prime Numbers 
2
4.4 Congruence 
2
4.5 
Applications of Congruence 
2
5 Induction and Recursion 
7 lectures
5.1 
Mathematical Induction 
3
5.2 
Recursively Defined Sequences 
2
5.3 
Solving Recurrence Relations; The Characteristic Polynomial 
1
5.4 
Solving Recurrence Relations; Generating Functions 
1
xvii

XViii 
Lecture Schedule
4 lectures
2
1
6 Principles of Counting
6.1 
The Principle of Inclusion-Exclusion
6.2 
The Addition and Multiplication Rules
6.3 
The Pigeon-Hole Principle
7 Permutations and Combinations
7.1 
Permutations
7.2 
Combinations
7.3 
Repetitions
7.4 
Derangements
7.5 
The Binomial Theorem
8 Algorithms
8.1 
What Is an Algorithm?
8.2 
Complexity
8.3 
Searching and Sorting
8.4 
Enumeration of Permutations and Combinations
9 Graphs
9.1 
A Gentle Introduction
9.2 
Definitions and Basic Properties
9.3 
Isomorphism
10 Paths and Circuits
10.1 Eulerian Circuits
10.2 Hamiltonian Cycles
10.3 The Adjacency Matrix
10.4 Shortest Path Algorithms
6 lectures
I
1
2
1
1
7 lectures
1
2
3
1
4 lectures
1
2
1
7 lectures
2
2
1
2
7 lectures
1
2
1 1
2
1
9 lectures
1
2
11 Applications of Paths and Circuits
11.1 The Chinese Postman Problem
11.2 Digraphs
11.3 RNA Chains
11.4 Tournaments
11.5 Scheduling Problems
12 Trees
12.1 What Is a Tree?
12.2 Properties of Trees

Lecture Schedule 
XiX
12.3 Spanning Trees
12.4 Minimum Spanning Tree Algorithms
12.5 Acyclic Digraphs and Bellman's Algorithm
13 Depth-First Search and Applications
13.1 Depth-First Search
13.2 The One-Way Street Problem
14 Planar Graphs and Colorings
14.1 Planar Graphs
14.2 Coloring Graphs
14.3 Circuit Testing and Facilities Design
15 The Max Flow-Min Cut Theorem
15.1 Flows and Cuts
15.2 Constructing Maximal Flows
15.3 Applications
15.4 Matchings
1
3
2
4 lectures
1
3
6 lectures
2
2
2
6 lectures
1
2
1
2

Discrete
Mathematics
with Graph Theory

ma,~ 
*-r*
* 
o 
.
a 
g 
o 
.
-
9.~ 
* Z
.. .
.. 
.. 
An.to.tin t 
o i
"How many dots are there on a pair of dice?" The question once popped out of
the box in a gam 
te 
of t 
a inlwhic 
one of us was a player. A long pause and
much consternation followed the question. After the correct answer was finally
given, the author (a bit smugly) pointed out that the answer "of course" was 6 x 7,
twice the sum of the integers from 1 to 6. "This is because," he declared, "the
sum of the integers from 1Ito n is 2n(n + 1), so twice this sum is n(n + 1) and,
in this case, n =6."
"What?" asked one of the players.
At this point, the game was delayed for a considerable period while the author
found pencil anid paper and made a picture like that in Fig 1.1. If we imagine the
dots on one die to be solid and on the other hollow, then the sum of the dots
on two dice is just the number of dots in this picture. There are seven rows of
six dots each-42 dots in all. What is more, a similar picture could be drawn for
seven-sided dice showing that
2(1 +2+3+4+5+6+7) =7 x 8 =56
and generally,
(*) 
2(l+2+3+3 
-I + n)=nx(n+1).
@00 00 
00
* *Oo 
o 00
.* 
. * 0 
0
* 
*5.50@
Figure 1.1 
.
.*a 
.
Sadly, that last paragraph is fictitious. Everybody was interested in, and most
experimented with, the general observation in equation (*), but nobody (except
an author) cared why. Everybody wanted to resume the game!
1

2 
Chapter 1 Yes, There Are Proofs!
1.1 
COMPOUND STATE
M
What is the sum 1 + 2 + 3 + .. + 100 of the integers from I to 100?
"Are there proofs?" This is one of the first questions students ask when they
enter a course in analysis or algebra. Young children continually ask "why" but,
for whatever reason, as they grow older, most people only want the facts. We
take the view that intellectual curiosity is a hallmark of advanced learning and
that the ability to reason logically is an increasingly sought-after commodity in
the world today. Since sound logical arguments are the essence of mathematics,
the subject provides a marvellous training ground for the mind. The expectation
that a math course will sharpen the powers of reason and provide instruction
in clear thinking surely accounts for the prominence of mathematics in so many
university programs today. So yes, proofs-reasons or convincing arguments prob-
ably sound less intimidating-will form an integral part of the discussions in this
book.
In a scientific context, the term "statement" means an ordinary English state-
ment of fact (subject, verb, and predicate in that order) which can be assigned
a "truth value," that is, which can be classified as being either true or false. We
occasionally say "mathematical" statement to emphasize that a statement must
have this characteristic property of being true or false. The following are all
mathematical statements:
"There are 168 primes less than 1000."
"Seventeen is an even number."
"X ~, 
is a rational number."
"Zero is not negative."
Each statement is certainly either true or false. (It is not necessary to know which!)
On the other hand, the following are not mathematical statements:
"What are irrational numbers?"
"Suppose every positive integer is the sum of three squares."
The first is a question and the second a conditional; it would not make sense to
classify either as true or false.
MENTS
"And" and "Or"
A compound statement is a statement formed from two other statements in one
of several ways, for example, by linking them with "and" or "or." Consider
"9 = 32 and 3.14 < r."
This is a compound statement formed from the simpler statements "9 = 32 
and
"3.14 < 7r." How does the truth of an "and" compound statement depend upon
the truth of its parts? The rule is
"p and q" is true if both p and q are true; it is false
"if either p is false or q is false.

1.1 Compound Statements 
3
Thus, "-22 = -4 and 5 < 100" is true while "22 + 32 = 42 and 3.14 < w"
is false.
In the context of mathematics, just as in everyday English, one can build a
compound statement by inserting the word "or" between two other statements. In
everyday English, "or" can be a bit problematic because sometimes it is used in
an inclusive sense, sometimes in an exclusive sense, and sometimes ambiguously,
leaving the listener unsure about just what was intended. We illustrate with three
sentences.
"To get into that college, you have to have a high school diploma or be over
25." (Both options are allowed.)
"That man is wanted dead or alive." (Here both options are quite impossible.)
"I am positive that either blue or white is in that team's logo." (Might there
be both?)
Since mathematics does not tolerate ambiguities, we must decide precisely what
"or" should mean. The decision is to make "or" inclusive: "or" always includes
the possibility of both.
"p or q" is true if p is true or q is true or both p
and q are true; it is false only when both p and q
are false.
Thus,
"7 + 5 = 12 or 571 is the 125th prime" and "25 is less than or equal to 25"
are both true sentences, while
"5 is an even number or V > 3"
is false.
Implication
Many mathematical statements are implications; that is, statements of the form
"p implies q," where p and q are statements called, respectively, the hypothesis
and conclusion. The symbol -* 
is read "implies," so
Statement 1: "2 is an even number -* 
4 is an even number"
is read "2 is an even number implies 4 is an even number."
In Statement 1, "2 is an even number" is the hypothesis and "4 is an even
number" is the conclusion.
Implications often appear without the explicit use of the word "implies." To
some ears, Statement I might sound better as
"If 2 is an even number, then 4 is an even number"
or
"2 is an even number only if 4 is an even number."
Whatever wording is used, common sense tells us that this implication is true.
Under what conditions will an implication be false? Suppose your parents tell
you

4 
Chapter 1 Yes, There Are Proofs!
Statement 2: "If it is sunny tomorrow, you may go swimming."
If it is sunny, but you are not allowed to go swimming, then clearly your parents
have said something which is false. However, if it rains tomorrow and you are not
allowed to go swimming, it would be unreasonable to accuse them of breaking
their word. This example illustrates an important principle.
The implication "p 
-4 
q" if s fae only when the hypothesis p is
tru ad thes 
conl0sion q 
ise. 
Inall otier situ~aions, it is true.
In particular, Statement 1 is true since both the hypothesis, "2 is an even num-
ber," and the conclusion, "4 is an even number," are true. Note, however, that an
implication is true whenever the hypothesis is false (no matter whether the con-
clusion is true or false). For example, if it were to rain tomorrow, the implication
contained in Statement 2 is true because the hypothesis is false. For the same
reason, each of the following implications is true.
"If 
1 is a positive number, then 2 + 2 = 5."
"If -I is a positive number, then 2 + 2 = 4."
Think about the implication, "If 42 = 16, then -12 = 1." Is it true or false?
The Converse of an Implication
The converse of the implication p -* 
q is the implication q -Ã· p. For example,
the converse of Statement 1 is
"If 4 is an even number, then 2 is an even number."
Write down the converse of the implication given in Pause 2. Is this true or false?
Double Implication
Another compound statement which we will use is the double implication, p -q,
read "p if and only if q." As the notation suggests, the statement "p < q" is
simply a convenient way to express
"p -
q and p -q."
(We would be more likely to write "q 
p" than "p 
-q.")
Putting together earlier observations, we conclude that
The double implication "p 
-* lq" is true if p and q have the same
truth values; it is false if panqhve different truth values.
For example, the statement
"2 is an even number <-> 4 is an even number"
is true since both "2 is an even number" and "4 is an even number" are true.
However,
"2 is an even number if and only if 5 is an even number"
is false because one side is true while the other is false.

1.1 Compound Statements 
5
Determine whether each of the following double implications is true or false.
(a) 
42 = 16 -
12 = 
_1."
(b) "42 = 16 if and only if (-1)2 =-1."
(c) "42 = 15 if and only if -12 
= -1."
(d) "42 = 15 *. 
(-1)2 = -1."
Negation
The negation of the statement p is the statement which asserts that p is not true.
We denote the negation of p by "-p" and say "not p." The negation of "x equals
4" is the statement "x does not equal 4." In mathematical writing, a slash (/)
through a symbol is used to express the negation of that symbol. So, for instance,
,4 means "not equal." Thus, the negation of "x = 4" is "x 0 4." In succeeding
chapters, we shall meet other symbols like E, C, and I, each of which is negated
with a slash, A, g, 
'.
Some rules for forming negations are a bit complicated because it is not
enough just to say "not p": We must also understand what is being said! To
begin, we suggest that the negation of p be expressed as
"It is not the case that p."
Then we should think for a minute or so about precisely what this means. For
example, the negation of "25 is a perfect square" is the statement "It is not the
case that 25 is a perfect square," which surely means "25 is not a perfect square."
To obtain the negation of
'n < 10 or n is odd,"
we begin
"It is not the case that n < 10 or n is odd."
A little reflection suggests that this is the same as the more revealing "n > 10
and n is even."
The negation of an "or" statement is always an "and" statement and the
negation of an "and" is always an "or." The precise rules for expressing the
negation of compound statements formed with "and" and "or" are due to Augustus
De Morgan (whom we shall meet again in Chapter 2).
The negation of "p and q" is the assertion "-p or -q."
The negation of "p or q" is the assertion "-p and -q."
For example, the negation of "a2 +b2 = c2 and a > 0" is "Either a2 +b2 :7 C2
or a < 0." The negation of "x + y = 6 or 2x + 3y < 7" is "x + y =A 6 and
2x + 3y > 7."
The Contrapositive
The contrapositive of the implication "p -# 
q" is the implication "(-q) 
(-p)."
For example, the contrapositive of
"If 2 is an even number, then 4 is an even number"

6 
Chapter 1 Yes, There Are Proofs!
is
"If 4 is an odd number, then 2 is an odd number."
Write down the contrapositive of the implications in Pauses 2 and 3. In each
case, state whether the contrapositive is true or false. How do these truth values
compare, respectively, with those of the implications in these Pauses?
Quantifiers
The expressions "there exists" and "for all," which quantify statements, figure
prominently in mathematics. The universal quantifier for all (and equivalent
expressions such as for every, for any, and for each) says, for example, that a
statement is true for all integers or for all polynomials or for all elements of a
certain type. The following statements illustrate its use. (Notice how it can be
disguised; in particular, note that "for any" and "all" are synonymous with "for
all.")
"x2 + x + 1 > 0 for all real numbers x."
"All polynomials are continuous functions."
"For any positive integer n, 2(1 + 2 + 3 + 
+.. 
Â± n) = n x (n + 1)."
"(AB)C = A(BC) for all square matrices A, B, and C."
Rewrite "All positive real numbers have real square roots," making explicit use
of a universal quantifier.
The existential quantifier there exists stipulates the existence of a single ele-
ment for which a statement is true. Here are some assertions in which it is
employed.
"There exists a smallest positive integer."
"Two sets may have no element in common."
"Some polynomials have no real zeros."
Again, we draw attention to the fact that the ideas discussed in this chapter can
arise in subtle ways. Did you notice the implicit use of the existential quantifier
in the second of the preceding statements?
"There exists a set A and a set B such that A and B have no element in
common."
Rewrite "Some polynomials have no real zeros" making use of the existential
quantifier.
Here are some statements which employ both types of quantifiers.
"There exists a matrix 0 with the property that A + 0 = 0 + A for all matri-
ces A."
"For any real number x, there exists an integer n such that n < x < n + 1."
"Every positive integer is the product of primes."
"Every nonempty set of positive integers has a smallest element."
Sometimes it requires real thought to express in a useful way the negation of
a statement which involves one or more quantifiers. It's usually helpful to begin

1.1 Compound Statements 
7
with "It is not the case." Consider, for instance, the assertion
"For every real number x, x has a real square root."
A first stab at its negation gives
"It is not the case that every real number x has a real square root."
Now we must think about what this really means. Surely,
"There exists a real number which does not have a real square root."
It is helpful to observe that the negation of a statement involving one type of
quantifier is a statement which uses the other. Specifically,
The negation of "For all something, p" is the statement "There exists
something such that -p."
The negation of "There exists something such that p" is the state-
ment "For all something, -p."
For example, the negation of
"There exist a and b for which ab : ba"
is the statement
"For all a and b, ab = ba."
The symbols V and 3 are commonly used for the quantifiers "for all" and "there
exists", respectively. For example, we might encounter the statement
Vlx, 3n such that n > x
in a book in real analysis. We won't use this notation in this book, but it is so
common that you should know about it.
What may I assume?
In our experience, when asked to prove something, students often wonder just
what they are allowed to assume. For the rest of this book, the answer is any fact,
including the result of any exercise, stated earlier in the book. This chapter is
somewhat special because we are talking "about" mathematics and endeavoring to
use only "familiar" ideas to motivate our discussion. In addition to basic college
algebra, here is a list of mathematical definitions and facts which we assume and
which the student is free also to assume in this chapter's exercises.
.
The product of nonzero real numbers is nonzero.
.
The square of a nonzero real number is a positive real number.
.
An even integer is one which is of the form 2k for some integer k; an odd
integer is one which is of the form 2k + 1 for some integer k.
.
The product of two even integers is even; the product of two odd integers is
odd; the product of an odd integer and an even integer is even.
.
A real number is rational if it is a common fraction, that is, the quotient 'n
of integers mn and n with n 4 0.
EMEMMEMM

8 
Chapter 1 Yes, There Are Proofs!
.
A real number is irrational if it is not rational. For example, 7r and V5 are
irrational numbers.
.
An irrational number has a decimal expansion which neither repeats nor ter-
minates.
â¢ A prime is a positive integer p > I which is divisible evenly only by A 1 and
Â±p, for example, 2, 3 and 5.
1. By equation (*), twice the sum of the integers from 1 to 100 is 100 x 101.
So the sum itself is 50 x 101 = 5050.
2. This is false. The hypothesis is true but the conclusion is false: -12 
=-1,
not 1.
3. The converse is "If _12 = 1, then 42 = 16." This is true, because the
hypothesis, "-12 = 1", is false.
4. (a) This is true because both statements are true.
(b) This is false because the two statements have different truth values.
(c) This is false because the two statements have different truth values.
(d) This is true because both statements are false.
5. The contrapositive of the implication in Pause 2 is "If -12 
# 1, then 42 7
16." This is false because the hypothesis is true, but the conclusion is false.
The contrapositive of the implication in Pause 3 is "If 42 5 16, then -12 #4
1." This is true because the hypothesis is false.
These answers are the same as in Pauses 2 and 3. This is always the case, as
we shall see in Section 1.2.
6. "For all real numbers x > 0, x has a real square root."
7. "There exists a polynomial with no real zeros."
The symbol [BB] means that an answer can be found in the Back of the Book.
You are urged to read the final paragraph of this section-What may I assume?-before attempting these exercises.
1. Classify each of the following statements as true or false
and explain your answers.
(a) [BB] "4 = 2 + 2 and 7 < 1."
(b) "4 : 2+2 and 7 < 
50."
(c) [BB] "4 = 2 2 -+2 7 < 15/0."
(d) "4 = +2 -7 < 
5O."
(e) [BB] "4 $ 2+2-* 7 < 
5."
(f) "4 
2+2 -*7 < 
50."
(g) [BB] "4=2+2 
7 > 
50."
(h) "The area of a circle of radius r is 27rr or its cir-
cumference is 7rr2."
(i) "2 + 3 = 5 -5 
+ 6 = 10."
2. Classify each of the following statements as true or false
and explain your answers.
(a) [BB] If a and b are integers with a -b 
> 0 and
b - a > 0 then a = b.
(b) If a and b are integers with a-b > O and b-a > 0,
then a = b.
3. Write down the negation of each of the following state-
ments in clear and concise English. Do not use the
expression "It is not the case that" in your answers.
(a) [BB] Either a2 > 0 or a is not a real number.
(b) x is a real number and x2 + I = 0.
(c) [BB] x = Â±.
(d) Every integer is divisible by a prime.
(e) [BB] For every real number x, there is an integer n
such that n > x.
(f) There exist a, b, and c such that (ab)c : a(bc).
(g) [BB] There exists a planar graph which cannot be
colored with at most four colors.
-m 
0 
*. 
-

1.2 Proofs in Mathematics 
9
(h) For every x > 0, x2 + y2 > 0 for all y.
(i) [BB] For all integers a and b, there exist integers q
and r such that b = qa + r.
(j) There exists an infinite set whose proper subsets are
all finite.
4. Write down the converse and the contrapositive of each
of the following implications.
(a) [BB] If E and b are integers, then a is an integer.
(b) x2 = 1 
X = +1.
(c) [BB] Every Eulerian graph is connected.
(d) ab = O- a = 0 or b = 0.
(e) [BB] A square is a four-sided figure.
(f) If ABAC is a right triangle, then a2 = b2 + c2.
5. Rewrite each of the following statements using the quan-
tifiers "for all" and "there exists" as appropriate.
(a) [BB] Not all continuous functions are differentiable.
(b) For real x, 2x is never negative.
(c) [BB] There is no largest real number.
(d) There are infinitely many primes.
(e) [BB] Every positive integer is the product of primes.
(f) All positive real numbers have real square roots.
6. Is it possible for both an implication and its converse to
be false? Explain your answer.
1.2 
PROOFS IN MATHEMATICS
Many mathematical theorems are statements that a certain implication is true. A
simple result about real numbers says that if x is between 0 and 1, then x2 < 1.
In other words, for any choice of a real number between 0 and 1, it is a fact that
the square of the number will be less than 1. We are asserting that the implication
Statement 3: "0 < x < 1 -x2 
< 1"
is true. In Section 1.1, the hypothesis and conclusion of an implication could be
any two statements, even statements completely unrelated to each other. In the
statement of a theorem or a step of a mathematical proof, however, the hypothesis
and conclusion will be statements about the same class of objects and the statement
(or step) is the assertion that an implication is always true. The only way for an
implication to be false is for the hypothesis to be true and the conclusion false.
So the statement of a mathematical theorem or a step in a proof only requires
proving that whenever the hypothesis is true, the conclusion must also be true.
When the implication "A -
3B" is the statement of a theorem, or one step
in a proof, A is said to be a sufficient condition for 53 and 93 is said to be a
necessary condition for A. For instance, the implication in Statement 3 can be
restated "O < x < 1 is sufficient for x2 < 1" or "x2 < 1 is necessary for
0 < x < 1."
Rewrite the statement "A matrix with determinant 1 is invertible" so that it
becomes apparent that this is an implication. What is the hypothesis? What is the
conclusion? This sentence asks which is a necessary condition for what? What is
a sufficient condition for what?
To prove that Statement 3 is true, it is not enough to take a single example,
x = 
for instance, and claim that the implication is true because (2) 
< 1.
It is not better to take ten, or even ten thousand, such examples and verify the
implication in each special case. Instead, a general argument must be given
which works for all x between 0 and 1. Here is such an argument.
Assume that the hypothesis is true; that is, x is a real number with
0 < x < 1. Since x > 0, it must be that x 
x < 1 x because

10 
Chapter 1 Yes, There Are Proofs!
multiplying both sides of an inequality such as x < 1 by a positive
number such as x preserves the inequality. Hence x2 < x and, since
x < 1, x2 < 1 as desired.
Now let us consider the converse of the implication in Statement 3:
Statement 4: "x2 < I -* 
0< x < l."
This is false. For example, when x =-2, 
the left-hand side is true, since (- 
=)2
< 1, while the right-hand side is false. So the implication fails when x =-
It follows that this implication cannot be used as part of a mathematical proof.
The number x 
is called a counterexample to Statement 4; that is, a specific
example which proves that an implication is false.
There is a very important point to note here. To show that a theorem, or a
step in a proof, is false, it is enough to find a single case where the implication
does not hold. However, as we saw with Statement 3, to show that a theorem is
true, we must give a proof which covers all possible cases.
State the contrapositive of "O < x < 1 -
x2 < 1." Is this true or false?
Theorems in mathematics don't have to be about numbers. For example, a
very famous theorem proved in 1976 asserts that if G is a planar graph, then
g can be colored with at most four colors. (The definitions and details are in
Chapter 14.) This is an implication of the form "A -X 3," where the hypothesis
A is the statement that g is a planar graph and the conclusion 'B is the statement
that g can be colored with at most four colors. The Four-Color Theorem states
that this implication is true.
(For students who have studied linear algebra.) The statement given in Pause 8 is
a theorem in linear algebra; that is, the implication is true. State the converse of
this theorem. Is this also true?
A common expression in scientific writing is the phrase if and only if denoting
both an implication and its converse. For example,
Statement 5: "x2 + y2 = 0 
(x = 0 and y = 0)."
As we saw in Section 1.1, the statement "A <-* B" is a convenient way to express
the compound statement
"A 
-* 
3 and 3 -* 
A."
The sentence "A is a necessary and sufficient condition for 3" is another
way of saying "A <-* 3." The sentence "A and 3 are necessary and sufficient
conditions for C" is another way of saying
"(A and 3) +- 
C."
For example, "a triangle has three equal angles" is a necessary and sufficient
condition for "a triangle has three equal sides." We would be more likely to hear
"In order for a triangle to have three equal angles, it is necessary and sufficient
that it have three equal sides."
To prove that "A 1 3" is true, we must prove separately that " 
-* 
B"
and "3 -* A" are both true, using the ideas discussed earlier. In Statement 5, the
implication "(x = 0 and y = 0) -
x2 + y2 = 0" is easy.
M
M

1.2 Proofs in Mathematics 
11
MM
MMM
Prove that "x92 + y2 = 0 -* 
(x = 0 and y = 0)."
As another example, consider
Statement 6: "0 < x < 1 
x2 < 1."
Is this true? Well, we saw earlier that "0 < x < 1 -
x2 < 1" is true, but we
also noted that its converse, "x2 < 1 -* 
0 < x < 1," is false. It follows that
Statement 6 is false.
Determine whether "-I 
< x < 1 x-2 c 
1" is true or false.
Sometimes, a theorem in mathematics asserts that three or more statements
are equivalent, meaning that all possible implications between pairs of statements
are true. Thus
"The following are equivalent:
1. A
2. B
3. C"
means that each of the double implications A +4 3, 23 (-* C, A <-* C is true.
Instead of proving the truth of the six implications here, it is more efficient just
to establish the truth, say, of the sequence
A-*3--* C --+A
of three implications. It should be clear that if these implications are all true, then
any implication involving two of A, 3, C is also true; for example, the truth of
3 -Ã· A would follow from the truth of 3 -( C and C -( A.
Alternatively, to establish that A, 13, and C are equivalent, we could establish
the truth of the sequence
of implications. Which of the two sequences a person chooses is a matter of
preference but is usually determined by what appears to be the easiest way to
argue. Here is an example.
PROBLEM 1. 
Let x be a real number. Show that the following are equivalent.
(1) x = 1 1.
(2) x2 = 1.
(3) If a is any real number, then ax = Â±a.
Solution. 
To show that these statements are equivalent, it is sufficient to establish
the truth of the sequence
(2) -(1) 
-(3) 
-(2).
(2) 
(1): The notation means "assume (2) and prove (1)." Since x2 = 1,
0 = x2 - I 
(x + 1)(x -1). 
Since the product of real numbers is zero if and
only if one of the numbers is zero, either x + 1 = 0 or x -I 
= 0; hence x =-1
or x = +1, as required.

12 
Chapter 1 Yes, There Are Proofs!
(1) 
-* 
(3): The notation means "assume (1) and prove (3)." Thus either
x = +1 or x = -1. Let a be a real number. If x = +1, then a* x = a 1 = a
while if x =-1, then ax = -a. In every case, ax = Â±a as required.
(3) -Ã· (2): We assume (3) and prove (2). We are given that ax = Â±a for
any real number a. With a = 1, we obtain x = Â±1 and squaring gives x2 = 1, as
desired. 
1
The symbol I marks the end of a proof. Some authors write "Q.E.D." from the
Latin quod erat demonstrandum (which was to be proved) for the same purpose.
In the index (see equivalent), you are directed to other places in this book
where we establish the equivalence of a series of statements.
Direct Proof
Most theorems in mathematics are stated as implications: "A -* 
3." Sometimes,
it is possible to prove such a statement directly; that is, by establishing the validity
of a sequence of implications:
A -* AI -+ A 2  
B.
PROBLEM 2. 
Prove that for all real numbers x, x2 - 4x + 17 #& 0.
Solution. 
We observe that x2 - 4x + 17 = (x - 2)2 + 13 is the sum of 13 and
a number, (x -
2)2, which is never negative. So x2 - 4x + 17 > 13 for any x; in
particular, x2 -4x + 17 = 0. 
I
........ ...- 
--. 
.
.
.......- 
.... 
.. ... --.- ........ 
. . ... ................. 
.............
PROBLEM 3. 
Suppose that x and y are real numbers such that 2x + y = 1 and
x -y =-4. Prove that x =-I 
and y = 3.
Solution. 
(2x + y = 1 and x 
-y 
- 4 ) 
(2x + y) + (x -y) 
= 1-4
3x =- 3 
x =-1.
Also,
(x=-1 andx -y=-4) -
(-1 -y=-4)-) (y=-I+4 = 3 ). 
I
-- ... ---- .-..-. 
.---.. 
........ 
- - . .... .....- 
.- .-....- 
.- .... .-
Many of the proofs in this book are direct. In the index (under direct), we
guide you to several of these.
Proof by Cases
Sometimes a direct argument is made simpler by breaking it into a number of
cases, one of which must hold and each of which leads to the desired conclusion.
PROBLEM 4. 
Let n be an integer. Prove that 9n2 + 3n - 2 is even.
Solution. 
Case 1: n is even.
The product of an even integer and any integer is even. Since n is even, 9n2
and 3n are even too. Thus 9n2 + 3n -2 is even because it is the sum of three
even integers.

1.2 Proofs in Mathematics 
13
HMu-
Proof
Case 2: n is odd.
The product of odd integers is odd. In this case, since n is odd, 9n2 and 3n
are also odd. The sum of two odd integers is even. Thus 9n2 + 3n is even.
The sum of even integers is even, so 9n2 + 3n -2 = (9n2 + 3n) + (-2) is
even. 
I
In the index, we guide you to other places in this book where we give proofs
by cases. (See cases.)
Prove the Contrapositive
A very important principle of logic, foreshadowed by Pause 5, is summarized in
the next theorem.
"A 13" is true if and only if its contrapositive "-'3 -* 
-A" is true.
"A 
93" is false if and only if A is true and 93 is false; that is, if and only if
-A is false and -3 is true; that is, if and only if "-B3 
-- A" is false. Thus the
two statements "A -
23" and "-'3 -* -A" are false together (and hence true
together); that is, they have the same truth values. The result is proved. 
I
PROBLEM 5. 
If the average of four different integers is 10, prove that one of
the integers is greater than 11.
Solution. 
Let A and 3 be the statements
A: "The average of four integers, all different, is 10."
3: "One of the four integers is greater than 11."
We are asked to prove the truth of "A -* 
3." Instead, we prove the truth of
the contrapositive, "-93 -- -A", from which the result follows by Theorem 1.2.1.
Call the given integers a, b, c, d. If 13 is false, then each of these numbers is
at most 11 and, since they are all different, the biggest value for a + b + c + d is
11 + 10 + 9 + 8 = 38. So the biggest possible average would be 38, which is less
than 10, so A is false. 
I
Proof by Contradiction
Sometimes a direct proof of a statement A seems hopeless: We simply do not
know how to begin. In this case, we can sometimes make progress by assuming
that the negation of A is true. If this assumption leads to a statement which is
obviously false (an "absurdity") or to a statement which contradicts something
else, then we will have shown that -A is false. So, A must be true.
PROBLEM 6. 
Show that there is no largest integer.
Solution. 
Let A be the statement "There is no largest integer." If A is false,
then there is a largest integer N. This is absurd, however, because N + I is an
integer larger than N. Thus -A is false, so A is true. 
I

14 Chapter 1 Yes, There Are Proofs!
A 
* 
* **
Remember that rational number just means common fraction, the quotient
_n of integers m and n with n :A 0. A number which is not rational is called
irrational.
PROBLEM 7. 
Suppose that a is a nonzero rational number and that b is an
irrational number. Prove that ab is irrational.
Solution. 
We are asked to prove the truth of the implication "A -
23," where
A and 3 are the statements
A: "a is a nonzero rational and b is irrational."
3: "ab is irrational."
Suppose that this implication is false and remember that this occurs only when A
is true and 3 is false; that is, a is rational, b is irrational, and ab is rational. So
we know that ab = 
m for integers m and n, n =# 0 and a = k for integers k and
ne
X, f # 0 and k =A 0 (because a # 0). Thus,
m 
m
b=-= 
-
na 
nk
with nk :A 0, so b is rational. This contradicts the fact that b is irrational. So
"A -).3" 
is true. 
I
Here is a well-known but nonetheless beautiful example of a proof by con-
tradiction.
PROBLEM 8. 
Prove that X2 is an irrational number.
Solution. 
If the statement is false, then there exist integers m and n such that
X = Â¶. If both m and n are even, we can cancel 2's in numerator and denomi-
nator until at least one of them is odd. Thus, without loss of generality, we may
assume that not both m and n are even.
Square both sides of X/ = 
2 
. We get m2 = 2n2, so M2 is even. Since the
square of an odd integer is odd, m must be even. Since not both m and n are
even, it follows that n must be odd. Write m = 2k and n = 2f + 1. Then from
m2 = 2n2 we get
4k2 = 2(4e2 + 41 + 1) = 8f2 + 8f + 2
and, dividing by 2,
2k2 = 4t2 + 4U + 1.
This is an absurdity because the left side is even and the right is odd. 
1
......................... 
........ 
------... 
. .. 
- -
-
-
-
-
H.. ................................ 
................... 
............
8. "A matrix A has determinant 1 -+ 
A is invertible."
Hypothesis: 
A matrix A has determinant 1.
Conclusion: 
A is invertible.
The invertibility of a matrix is a necessary condition for its determinant being
equal to 1; determinant 1 is a sufficient condition for the invertibility of a
matrix.

1.2 Proofs in Mathematics 
15
9. The contrapositive is "x2 > 1 -) (x <0 or x > 1)." This is true, and here is
a proof.
Assume x2 > 1. If x < 0, we have the desired result, so assume x > 0. In
that case, if x < 1, we have seen that x2 < 1, which is not true, so we must
have x > 1, again as desired.
10. The converse is "An invertible matrix has determinant 1." This is false: for
example, the matrix A = [0 1] is invertible (the inverse of A is A itself), but
detA = -1.
11. Assume that x2 + y2 = 0. Since the square of a real number cannot be
negative and the square of a nonzero real number is positive, if either x2 : 0
or y2 :7 0, the sum x2 + y2 would be positive, which is not true. This means
x2 = 0 and y2 = 0, so x = 0 and y = 0, as desired.
12. This statement is true. To prove it, we must show that two implications are
true.
(-a) First assume that -1 
< x < 1. If 0 < x < 1, then we saw in the text
that x2 < 1 while, if x = 0, clearly x2 = 0 < 1. If -1 
< x < 0, then
0 < -x < 1 (multiplying an inequality by a negative number reverses it) so,
by the argument in the text (-x)2 < 1, that is, x2 < 1. In all cases, we have
x2 < 1. Thus -1 
< x < 1 -# x2 < 1 is true.
(Ã·-) Next we prove that x2 < 1 -1 -I < x < 1 is true. Assume x2 < 1. If
x > 1, then we would also have x2 = x *x > x * I = x > 1, so x2 > 1, which
is not true. If we had x < -1, then-x > I and so x2 = (-x)2 > 1, which,
again, is not true. We conclude that -1 < x < 1, as desired.
- .L 
---
: 
___ 
.;_
The symbol [BB] means that an answer can be found in the Back of the Book.
You are urged to read the final paragraph of Section 1.]-What may I assume ?-before attempting these exercises.
1. What is the hypothesis and what is the conclusion in
each of the following implications?
(a) [BB] The sum of two positive numbers is positive.
(b) The square of the length of the hypotenuse of a
right-angled triangle is the sum of the squares of
the lengths of the other two sides.
(c) All primes are even.
2. [BB] Determine whether or not the following implica-
tion is true.
"x is an even integer -# x + 2 is an even integer."
3. State the converse of the implication in Exercise 2 and
determine whether or not it is true.
4. Answer Exercise 2 with -* replaced by A+. [Hint: Exer-
cises 2 and 3.]
5. Let n be an integer greater than 1 and consider the state-
ment "A: 2' - 1 prime is necessary for n to be prime."
(a) Write A as an implication.
(b) Write A in the form "p is sufficient for q."
(c) Write the converse of A as an implication.
(d) Determine whether the converse of A is true or
false.
6. [BB] A theorem in calculus states that every differen-
tiable function is continuous. State the converse of this
theorem.
(For students who have taken calculus) Is the converse
true or false? Explain.
7. Let n be an integer, n > 3. A certain mathematical
theorem asserts that n statements AI, A 2 . 
A , 
are
equivalent.
(a) A student proves this by showing that Al e* A 2,
A 2 .- * A 3 .  
, An- l 
An, are all true. How many
implication proofs did the student write down?

16 
Chapter 1 Yes, There Are Proofs!
(b) Another student proves the truth of Al 
A 2,
A2 
-
3 .
A, All -
An, and A, 
Al.
How many implication proofs did this student write
down?
(c) A third student wishes to find a proof which is dif-
ferent from that in 7(b) but uses the same number
of implication proofs as in 7(b). Outline a possible
proof for this student.
The next three exercises illustrate that the position of a
quantifier is very important.
8. [BB] Consider the assertions
A: "For every real number x, there exists an integer n
such that n < x < n + L"
'3: "There exists an integer n such that n < x < n + I
for every real number x."
One of these assertions is true. The other is false. Which
is which? Explain.
9. Answer Exercise 8 with A and 3 as follows.
A: "There exists a real number y such that y > x for
every real number x."
3: "For every real number x, there exists a real number
y such that y > x."
10. Answer true or false and supply a direct proof or a coun-
terexample to each of the following assertions.
(a) There exists an integer n such that nq is an integer
for every rational number q.
(b) For every rational number q, there exists an integer
n such that nq is an integer.
11. (a) [BB] Let a be an integer. Show that either a or a + I
is even.
(b) [BB] Show that n2 + n is even for any integer n.
12. Provide a direct proof that n2 - n + 5 is odd, for all
integers n.
13. [BB] Prove that 2x 2 -4x+3 > 0 for any real number x.
14. Let a and b be integers. By examining the four cases
i. a, b both even,
ii. a, b both odd,
iii. a even, b odd,
iv. a odd, b even,
find a necessary and sufficient condition for a2 - b2 to
be odd.
15. [BB] Let n be an integer. Prove that n2 is even if and
only if n is even.
16. Let x be a real number. Find a necessary and sufficient
condition for x + - > 2. Prove your answer.
x
17. [BB] Prove that if n is an odd integer then there is an
integer m such that n = 4m + I or n = 4m + 3. [Hint:
Consider a proof by cases.]
18. Prove that if n is an odd integer, there is an integer m
suchthatn =8m+ orn=8m+3orn =8m+5or
n = 8m + 7. (You may use the result of Exercise 17.)
19. Prove that there exists no smallest positive real number.
[Hint: Find a proof by contradiction.]
20. [BB] (For students who have studied linear algebra)
Suppose 0 is an eigenvalue of a matrix A. Prove that
A is not invertible. [Hint: There is a short proof by
contradiction.]
21. Let n = ab be the product of positive integers a and b.
Prove that either a < i 
or b < I.
22. [BB] Suppose a and b are integers such that a+b+ab 
-
0. Prove that a = b = 0 or a = b =-2. Give a direct
proof.
23. Suppose that a is a rational number and that b is an
irrational number. Prove that a + b is irrational.
24. [BB] Prove that the equations
2x+3y- 
z=5
x -2y+3z= 7
x+5v -4z =O
have no solution. (Give a proof by contradiction.)
25. Find a proof or exhibit a counterexample to each of the
following statements.
(a) [BB] 2x 2 + 3.2 > 0 for all real numbers x and y.
(b) a an even integer -
2a an even integer.
(c) [BB] For each real number x, there exists a real
number y such that xy = 1.
(d) If a and b are real numbers with a + b rational, then
a and b are rational.
(e) [BB] a and b real numbers with ab rational 
-> a
and b rational.
26. Suppose ABC and A'B'C' are triangles with pairwise
equal angles; that is, LA = LA', LB = LB', and
LC = LC'. Then it is a well-known result in Euclidean
geometry that the triangles have pairwise proportional
sides (the triangles are similar). Does the same property
hold for polygons with more than three sides? Give a
proof or provide a counterexample.
27. (a) [BB] Suppose m and n are integers such that n2 +
I = 2m. Prove that m is the sum of squares of two
integers.
(b) [BB] Given that (4373)2 + I = 2(9,561,565), write
9,561,565 as the sum of two squares.

1.3 Truth Tables 
17
28. Observe that for any real number x,
4x 4 + I = (2x 2 +2x+ 1)(2x 2 -2x+ l).
(a) Use this identity to express 24,,+2 + I (n a positive
integer) and 218 + I as the product of two integers
each greater than ].
(b) Express 236 - I as the product of four integers each
of which is larger than 1.
29. Prove that one of the digits 1, 2, ... , 9 occurs infinitely
often in the decimal expansion of 7r.
30. Prove that there exist irrational numbers a and b such
that ab is rational.
1.3 
TRUTH TABLES
In previous sections, we presented a rather informal introduction to some of the
basic concepts of mathematical logic. There are times, however, when a more
formal approach can be useful. We begin to look at such an approach now.
Let p and q be statements. For us, remember that statement means a statement
of fact which is either true or false. The compound statements "p or q" and "p
and q," which were introduced in Section 1. 1, will henceforth be written "p V q
and "p A q," respectively.
pVq: porq
pAq: 
pandq.
The way in which the truth values of these compound statements depend upon
those of p and q can be neatly summarized by tables called truth tables. Truth
tables for p V q and p A q are shown in Fig 1.2.
p 
q 
pVq
T 
T 
T
T 
F 
T
F 
T 
T
FF 
I 
F
p 
q 
pAq
TT 
T
T F 
F
F T 
F
Figure 1.2 
Truth tables for p v q (p or q) and p A q (p and q).
In each case, the first two columns show all possible truth values for p and q-
each is either true (T) or false (F)-and the third column shows the corresponding
truth value for the compound statement.
The truth table for the implication p -* q, introduced in Section 1. 1, is shown
on the left in Fig 1.3. On the right, we show the particularly simple truth table
for "-p," the negation of p.
p 
q 
p-+q
T 
T 
T
T 
F 
F
F 
T 
T
F 
F 
T
F:T
Figure 1.3 
Truth tables for p -
q (p implies q) and -p (not p).

18 
Chapter 1 Yes, There Are Proofs!
Truth tables for more complicated compound statements can be constructed
using the truth tables we have seen so far. For example, the statement "p -q,"
defined in Section 1.1 as "(p -+ q) and (q -- p)," is "(p -* 
q) A (q -p)."
The truth values for p -+ q and q 
-* 
p are shown in Fig 1.4. Focusing on
columns 3 and 4 and remembering that r A s is true if and only if both r and s
are true-see the truth table for "A" shown in Fig 1.2-we obtain the truth table
for (p 
-
q) A (q -* 
p), that is, for p ++ q.
Figure 1.4 
The truth table for p (- q, p if and only if q.
It is the first two columns and the last column which are the most important,
of course, so in future applications, we remember p 
+- 
q with the simple truth
table shown in Fig 1.5.
p 
q 
pÃ·*q
T 
T 
T
T 
F 
F
F T 
F
F F 
T
Figure 1.5 
The truth table for p ( 
q.
Here is another demonstration of how to analyze complex compound state-
ments with truth tables.
EXAMPLE 9 
Suppose we want the truth table for p 
-* -(q 
v p).
p 
q 
qVp 
-(qvp) 
p--(qvp)
T 
T 
T 
F 
F
T 
F 
T 
F 
F
F 
T 
T 
F 
T
F 
F 
F 
T 
T
Although the answer is presented as a single truth table, the procedure is to con-
struct appropriate columns one by one until the answer is reached. Here, columns
I and 2 are used to form column 3-q 
V p. Then column 4 follows from column
3 and, finally, columns 1 and 4 are used to construct column 5, using the truth
table for an implication in Fig 1.3. 
A
When three statements p, q, and r are involved, eight rows are required in a
truth table since it is necessary to consider the two possible truth values for r for
each of the four possible truth values of p and q.
p 
q 
P-*qq- 
p 
(p -q)A(q- 
p)
T 
T 
T 
T 
T
T 
F 
F 
T 
F
F 
T 
T 
F 
F
FF 
I 
T 
T 
T

1.3 Truth Tables 
19
PROBLEM 10.
Solution.
Construct a truth table for (p V q) 
--* [((-'p) A r) -* 
(q A r)].
p 
q 
r 
-p 
(-p)Ar q A r 
((-p) Ar) 
(qAr) pvq
T 
T 
T 
F 
F 
T 
T 
T
T 
T 
F 
F 
F 
F 
T 
T
T 
F 
T 
F 
F 
F 
T 
T
T 
F 
F 
F 
F 
F 
T 
T
F 
T 
T 
T 
T 
T 
T 
T
F 
T 
F 
T 
F 
F 
T 
T
F F T 
T 
T 
F 
F 
F
F 
F 
F 
T 
F 
F 
T 
F
(p V q) I 
((-p) A r) 
(q A r)]
T
T
T
F
F
F
T
F
I
Of course, it is only necessary to construct an entire truth table if a complete
analysis of a certain compound statement is desired. We do not need to construct
all 32 rows of a truth table to do the next problem.
PROBLEM 11. 
Find the truth value of
[p -
((q A (-r)) V s)] A 
[(-t) 
-* 
(s A r)],
where p, q, r, and s are all true while t is false.
Solution. 
We evaluate the expression step by step, showing just the relevant row
of the truth table.
Ip 
q I r I s I t I-r 
qA(-r) (qA(-r))V s
|TFFT|F 
T|F 
|F 
|F 
F
p-* 
[(q A (-r)) V s]-t 
s A r (-t) 
-
(s A r
T 
T 
T 
T
[p -
[((q A (-r)) 
V s)] A [(-t) 
t 
-* (s A r)]
L 
-
T
The truth value is true.
I

20 
Chapter 1 Yes, There Are Proofs!
A notion that will be important in later sections is that of logical equivalence.
Formally, statements A and 3 are logically equivalent if they have identical truth
tables.
PROBLEM 12. 
Show that "A: p -- (-q)" and "23: -(p A q)" are logically
equivalent.
Solution. 
We simply observe that the final columns of the two truth tables are
identical.
I
EXAMPLE 13 
In Section 1.1, we defined the contrapositive of the statement "p 
-* 
q" as the
statement "(-q) -* 
(-p)." In Theorem 1.2.1, we proved that these implications
are logically equivalent without actually introducing the terminology. Here is how
to establish the same result using truth tables.
-
q 
p-*q
T 
T 
T
T 
F 
F
F 
T 
T
F 
F 
T
-30
-
S 
*. 
-
A
A compound statement that is always true, regardless of the truth values assigned
to its variables, is a tautology. A compound statement that is always false is a
contradiction.
Show that "(p A q) -* 
(p V q)" is a tautology, while "((-p) A q) A (p V (-q))"
is a contradiction.
The truth table for p (--* q appears in Fig 1.5. From this, we see immediately
that two statements A and 3 are logically equivalent precisely when the statement
A +*3 is a tautology.
13.
p 
qpAq 
pV 
q 
pq)-(pVq)
T 
T 
T 
T 
T
T 
F 
F 
T 
T
F 
T 
F 
T 
T
F F 
F 
F 
T
The final column shows that (p A q) -+ (p V q) is true for all values of p
and q, so this statement is a tautology.
p 
q 
-q 
p- 
(-q)
TT 
F 
F
T F 
T 
T
F 
T 
F 
T
F 
F 
T 
T
p 
q - pAq 
-(pAq)
T 
T 
T 
F
T 
F 
F 
T
F 
T 
F 
T
FF 
F 
T
p 
q 
-q 
-p 
(-q) -(-p)
T 
T 
F 
F 
T
T 
F 
T 
F 
F
F 
T 
F 
T 
T
F 
F 
T 
T 
T

1.4 The Algebra of Propositions 
21
P 
_q[-p (- p) A q -q 
p V (-q) ((- p) A q) A (p V (-q))
TTF 
F 
F 
T 
F
TF F 
F 
T 
T 
F
FT T 
T 
F 
F 
F
FF T 
F 
T 
T 
F
The final column shows that ((-p) A q) A (p V (-q)) is false for all values
of p and q, so this statement is a contradiction.
The symbol [BB] means that an answer can be fbund in the Back of the Book.
1. Construct a truth table for each of the following com-
pound statements.
(a) [BB] p A ((-q) V p)
(b) (p A q) v ((-p) 
q)
(C) -
(p A (q V p)) 
p
(d) [BB] (- (p V (-q))) A ((-p) V r)
(e) (p -(q 
-
r)) -
((p A q) V r)
2. (a) If p 
q is false, determine the truth value of
(p A (-q)) V ((-p) -
q).
(b) Is it possible to answer 2(a) if p -- q is true instead
of false? Why or why not?
3. [BB] Determine the truth value for
[p -
(q A (-r))] V [r - ((-s) V q)]
when p, q, r and s are all true.
4. Repeat Exercise 3 in the case where p, q, r, and s are
all false.
5. (a) Show that q -* (p -- q) is a tautology.
(b) Show that [pAq] A [(-p) v (-q)] is a contradiction.
6. (a) [BB] Show that [(p -
q) A (q -* 
r)] -* 
(p -* r)
is a tautology.
(b) [BB] Explain in plain English why the answer to
6(a) makes sense.
7. Show that the statement
[p v ((-r) -
(-s))] v [(s -
((-t) v p))
v ((-q) 
r)]
is neither a tautology nor a contradiction.
8. Given that the compound statement A is a contradiction,
establish each of the following.
(a) [BB] If 3 is any statement, A -- 3 is a tautology.
(b) If 3 is a tautology, 3 -* 
A is a contradiction.
9. (a) Show that the statement p -* 
(q -* r) is not logi-
cally equivalent to the statement (p -* 
q) -
r.
(b) What can you conclude from 9(a) about the
compound statement [p -* 
(q -) r)] ( 
[(p
q) -*r]?
10. If p and q are statements, then the compound statement
p V q (often called the exclusive or) is defined to be
true if and only if exactly one of p, q is true; that is,
either p is true or q is true, but not both p and q are
true.
(a) [BB] Construct a truth table for p V q.
(b) Construct a truth table for (p V ((-p) A q)) V q.
(c) [BB] Show that (p V q) --. (p v q) is a tautology.
(d) Show that p 
V q is logically equivalent to
-'(p * q).
1.4 
THE ALGEBRA OF PROPOSITIONS
In Section 1.3, we discussed the notion of logical equivalence and noted that two
statements A and C3 are logically equivalent precisely when the statement A ++ '3
is a tautology.
More informally, when statements A and 3 are logically equivalent, we often
think of statement '3 as just a rewording of statement A. Clearly then, it is of

22 
Chapter 1 Yes, There Are Proofs!
interest to be able to determine in an efficient manner when two statements are
logically equivalent and when they are not. Truth tables will do this job for us,
but, as you may already have noticed, they can become cumbersome rather easily.
Another approach is first to gather together some of the fundamental examples of
logically equivalent statements and then to analyze more complicated situations
by showing how they reduce to these basic examples. Henceforth, we shall write
A 
93 to denote the fact that A and 23 are logically equivalent.
The word "proposition" is a synonym for "(mathematical) statement." Just
as there are rules for addition and multiplication of real numbers-commutativity
and associativity, for instance-there are properties of A and v which are helpful
in recognizing that a given compound statement is logically equivalent to another,
often more simple, one.
Some Basic Logical Equivalences
1. Idempotence:
(i) (pVp) 
p
(ii) (p A p) 
p
2. Commutativity:
(i) (p v q) 
(q v p)
(ii) (p A q) 
(q A p)
3. Associativity:
(i) ((p V q) V r) .'(p 
v (q V r))
(ii) ((pAq)A r) 
(pA(q Ar))
4. Distributivity:
(i) (p V (q A r)) .
((p v q) A (p V r))
(ii) (p A (q v r)) is((p 
A q) v (p A r))
5. Double Negation: - (-p) ~-- p
6. De Morgan's Laws:
(i) - (p v q) 
((-p) A (-q))
(ii) 
(p A q) .'((-p) 
V (-q)
Property 6 was discussed in a less formal manner in Section 1.1.
It is clear that any two tautologies are logically equivalent and that any two
contradictions are logically equivalent. Letting 1 denote a tautology and 0 a con-
tradiction, we can add the following properties to our list.
7. (i) (pvl) 
I 1
(ii) (p A 1) 
.
p
8. (i) (p vO) .
. p
(ii) (p AO) 
0
9. (i) (p v (-p)) 
1 0
(ii) 
(p A (-p)) 
.-- 
0

1.4 The Algebra of Propositions 
23
10. (i) -1 
.
(ii) -0 
1
We can also add three more properties to our list.
11. (p 
q) 4=~ [(-q) -
(-p)]
12. (p 
q) 
= 
[(p -->q) A (q -p)]
13. (p 
q) 4 
[ (- p) VqI
Property 11 simply restates the fact, proven in Theorem 1.2.1, that a statement
and its contrapositive are logically equivalent. The definition of "-*" 
gives Prop-
erty 12 immediately. Property 13 shows that any implication is logically equiva-
lent to a statement which does not use the symbol -*.
Given the statement p -* q, show that its converse, q -# 
p, and its inverse,
[(-p) -. (-q)], are logically equivalent.
Show that [-(p <-* q)] -== 
[(p A (-q)) V (q A (-p))].
PROBLEM 14. 
Show that (-p) -* 
(p 
q) is a tautology.
Solution. 
Using Property 13, we have
[(-p) -* (p -
q)] 
= 
[(-p) 
((-p) V q)]
[(-(-p)) v ((-p) v q)]
4-~p V [(-p) V q]
I
In the exercises, we ask you to verify all the properties of logical equivalence
which we have stated. Some are absurdly simple. For example, to see that (p v
p) 
p, we need only observe that p and p V p have the same truth tables:
P 
Pvp
T 
T
F 
F
Others require more work. To verify the second distributive property, for example,
we would construct two truth tables.
P 
q 
r qvr pA(qvr)j
T 
T 
T 
T 
T
T TF 
T 
T
T FT 
T 
T
T 
F 
F 
F 
F
F 
T 
T 
T 
F
F 
T 
F 
T 
F
F 
F 
T 
T 
F
F FF 
F 
F
M
M
_= [p V (-p)] V q -<_= 1 V q 
1.

24 
Chapter 1 Yes, There Are Proofs!
p 
q 
r 
pAq 
pAr 
(pAq)V(pAr)
T 
T 
T 
T 
T 
T
T 
F 
T 
F 
T 
T
T 
F 
F 
F 
F 
F
F 
T 
T 
F 
F 
F
F 
T 
F 
F 
F 
F
F 
F 
T 
F 
F 
F
F 
F 
F 
F 
F 
F
PROBLEM 15. 
Express the statement (- (p V q)) V ((-p) A q) in simplest
possible form.
Solution. 
De Morgan's first law says that -(p 
V q) 
(-p) 
A (-q). Thus
(*) 
[(- (p V q)) V ((-p) 
A q)] .â¢=> [((-p) A (-q)) V ((-p) A q)],
since adjoining the same term to statements which have the same truth tables will
produce statements with the same truth values. Using distributivity, the right side
of (*) is
[((-p) A (-q)) V ((-p) A q)] 
[(-p) A ((-q) V q)]
4~ 
[(-p)A 
1] 
..-
p,
so the given statement is logically equivalent simply to -p.
I
In the solution to Problem 15, we said "adjoining the same term to statements
which have the same truth tables will produce statements with the same truth
values." Make this claim into a formal assertion and verify it.
In Problems 14 and 15 we used, in a sneaky way, a very important principle
of logic, which we now state as a theorem. The fact that we didn't really think
about this at the time tells us that the theorem is easily understandable and quite
painless to apply in practice.
Suppose A and 
3 are logically equivalent statements involving variables
PI, P2, .
P. Suppose that C 1, C2
. 
C 
, ( 
are statements. If, in A and 3, we
replace pi by Cl, P2 by (C2 and so on until we replace Pn by C,, then the resulting
statements will still be logically equivalent.
Explain how Theorem 1.4.1 was used in Problem 15.
PROBLEM 16. 
Show that
[(p V q) V ((q V (-r)) A (p V r))] 
t 
-[(-p) 
A (-q)].
Solution. 
The left hand side is logically equivalent to
[(p V q) V (q V (-r))] A [(p V q) V (p V r)]
S.R

1.4 The Algebra of Propositions 
25
by distributivity. Associativity and idempotence, however, say that
[(p Vq) V(q V(-r))] <, '> [p V(q V(q V(-r)))]
*, > [p V ((q V q) V (-r))]
4, 
[p V (q V (-r))] -
[(p V q) V (-r)],
while we also have
[(p V q) V (p V r)] 
[(q V p) V (p V r)]
[qV(pV(pVr))]
[q V ((p V p) V r)]
[q V (p V r)]
[(q V p) V r] 
< 
^<[(p Vq) V r].
Hence our expression is logically equivalent to
[((p V q) V (-r)) A ((p V q) V r)] 
[(p V q) V ((-r) A r)]
[(pVq)V0] # 
pVq.
Finally, with the help of double negation and one of the laws of De Morgan, we
obtain
p V q 
< 
--
((p 
V q)) 
V-[(-p) A (-q)]. 
U
The next problem illustrates clearly why employing the basic logical equiva-
lences discussed in this section is often more efficient than working simply with
truth tables.
PROBLEM 17. 
Show that [s -* 
(((-p)Aq)Ar)] < == 
-[(pv(- 
(qAr)))As].
Solution.
[s -Ã· (((-p) A q) A r)] 
[(-s) V (((-p) A q) A r)]
[(-s) V ((-p) A (q A r))]
[(-s) V (-(p V (-(q A r))))]
=t-[(s A (p V (- (q A r))))]
4::>~ -'[((p V (- (q A r))) A s)]. 
I
.
\ \ 
\, 
; G ,,, 
., 
\, 
.
\ .... 
, .
.. 
, .. 
, 
,.... 
.. .. ..... ,\\\O\.
A primary application of the work in this section is reducing statements to
logically equivalent simpler forms. There are times, however, when a different
type of logically equivalent statement is required.

26 Chapter 1 Yes, There Are Proofs!
W 14I 
S
EXAMPLE 18
EXAMPLE 19
Let n > 1 be an integer. A compound statement based on variables xI, X2, .
,
is said to be in disjunctive normal form if it looks like
(al I A al2 A ...
A aln) v 
(a2l A a22 A ... 
A a2n) V ... V 
(aml 
A am2 A ... A 
amn)
where, for each i and j, I < i < m, 1 < j < n, either a!j = xj or aij = -xj and
all minterms ai A ai2 A ... 
A ai, are distinct.
The statement (xI A x2 A X3 ) V (xI A (-x2) A (-X3)) is in disjunctive normal form
(on the variables xI, X2, X3). 
A
The statement ((p A q) V r) A ((p A q) V (-q)) is not in disjunctive normal form.
One reason is that the minterms, (p A q) V r and (p A q) V (-q), involve the
symbol V. This statement is logically equivalent to (p A q) V (r A (-q)), which
is still not in disjunctive normal form because the minterms, p A q and r A (-q),
don't contain all the variables. Continuing, however, our statement is logically
equivalent to
(p A q A r) V (p A q A (-r)) 
V (p A r A (-q)) 
V ((-p) A r A (-q)),
which is in disjunctive normal form (on the variables p, q, r).
A
As shown in Example 19, when writing a statement in disjunctive normal
form, it is very useful to note that
(1)
for any statements x and y. This follows from
xPROLE 
20. 
Er 
p 
Ay ( 
A 
-y))] d 
[(X A y) V (X A (-y))].
PROBLEM 20. Express p 
(q A r) in disjunctive normal form.
Solution. 
Method 1: We construct a truth table.
p 
(qAr
r
T
F
T
T
F
F
T
F
q Ar
T
F
F
T
F
F
F
F
p -*(q 
A r)
T
F
F
T
F
T
T
T
Now focus attention on the rows for which the statement is true-each of
these will contribute a minterm to our answer. For example, in row 1, p, q, and
r are all T, so p A q A r agrees with the T in the last column. In row 4, p is F,
while q and r are both T. This gives the minterm (-p) A q A r. In this way, we
P
T
T
T
F
T
F
F
F
q
T
T
F
T
F
T
F
F
X 
[(X A y) 
V (X A (-y))]
-

1.4 The Algebra of Propositions 
27
A 
* 
**
obtain
(p A q A r) V ((-p) 
A q A r) V ((-p) A q A (-r))
V ((-p) A (-q) 
A r) V ((-p) A (-q) 
A (-r)).
Method 2: We have
[p- 
(q A r)]
[(-p) V (q A r)]
[((- p) A q) V ((- p) A (-q)) V (q A r)]
[((-p) A q A r) 
V ((-p) 
A q A (-r)) 
V ((-p) 
A (-q) 
A r)
V ((-p) 
A (-q) 
A (-r)) 
V (p A q A r) V ((-p) 
A q A r)]
[((-p) A q A r) 
V ((-p) 
A q A (-r)) 
V ((-p) 
A (-q) 
A r)
V ((-p) A (-q) 
A (-r)) 
V (p A q A r)],
omitting the second occurrence of (-p) A q A r at the last step. We leave it to
you to decide for yourself which method you prefer.
Disjunctive normal form is useful in applications of logic to computer science,
particularly in the construction of designs for logic circuits.
14. This is just a restatement of Property 11, writing p instead of q and q instead
of p.
15. This could be done with truth tables. Alternatively, we note that
-
(p 
Ã· 
q) 
> 
[-((p -4 q) A (q -
p))]
-((- p) V q) A ((-q) v p)]
-[((-p) 
V q) V (-((-q) 
V p))]
~ 
[(p A (-q)) V (q A (-p))].
16. The claim is that if A 
9 3, then (A v C) 
(J3 V C) for any
other statement C. Since A 
.- # 
3, A and 3 have the same truth tables.
Establishing (A V C) *, 
(13 v C) requires four rows of a truth table.
A 
13 
C AvC 3vC
T 
T 
T 
T 
T
T 
T 
T F 
T
F FF 
F 
F
The last two columns establish our claim. A similar argument shows that if
A 
4z. 3, then (A A 3) 
- (3 A C) for any statement C.
17. In applying the distributive property, we are using -p, -q and q in place of
p, q and r. Also, when applying Property 7, we use -p instead of p.

28 
Chapter 1 Yes, There Are Proofs!
The symbol [BB] means that an answer can be found in the Back of the Book.
1. Verify each of the 13 properties of logical equiva-
lence which appear in this section [BB; 1,3,5,7,9,
11,13].
2. Simplify each of the following statements.
(a) [BB] (p A q) V (-((-p) 
V q))
(b) (p V r) -
[(q V (-r)) -
((-p) -
r)]
(c) [(p -
q) V (q -
r)] A (r -* s)
3. Using truth tables, verify the following absorption prop-
erties.
(a) [BB] (p V (p Aq)) 
< 
p
(b) (pA(pVq)) 
p
4. Using the properties in the text together with the absorp-
tion properties given in Exercise 3, establish each of the
following logical equivalences.
(a) [BB] [(p V q) A (-p)] .- 
[(-p) A q]
(b) [p -
(q -
r)] ' 
[(p A (-r)) -
(-q)]
(c) [-(p -q)] 
<-~[p -(-q)]
(d) [BB] -[(p 
-
q) V (p A (-q))] ~== 
[(p
(-q)) A ((-p) V q)]
(e) [(p A (-q)) A ((p A (-q)) V (q A (-r)))]
[p A (-q)]
5. Prove that the statements (p A (-q)) -* 
q and (p A
(-q)) -* 
-p are logically equivalent. What simpler
statement is logically equivalent to both of them?
6. In Exercise 10 of Section 1.3 we defined the exclusive
or "p v q" to be true whenever either p or q is true,
but not both. For each of the properties discussed in
this section (including those of absorption given in
Exercise 3) determine whether or not the property holds
with V replacing v wherever it occurs [BB; 1,3,7,9,13].
7. Which of the following are in disjunctive normal form
(on the appropriate set of variables)?
(a) (p V q) A ((-p) V (-q))
(b) [BB] (p A q) V ((-p) A (-q))
(c) [BB] p v ((-p) 
A q)
(d) (p A q) V ((-p) A (-q) A r)
(e) (p A q A r) V ((-p) A (-q) A (-r))
8. Express each of the following statements in disjunctive
normal form.
(a) [BB] p A q
(b) [BB] (p A q) V (-((-p) V q))
(c) p 
q
(d) (p 
q) A (q A r)
9. Find out what you can about Augustus De Morgan and
write a paragraph or two about him, in good English, of
course!
1.5 
LOGICAL ARGUMENTS
Proving a theorem in mathematics involves drawing a conclusion from some given
information. The steps required in the proof generally consist of showing that if
certain statements are true, then the truth of other statements must follow. Taken
in its entirety, the proof of a theorem demonstrates that if an initial collection of
statements-called premises or hypotheses-are all true, then the conclusion of
the theorem is also true.
Different methods of proof were discussed informally in Section 1.2. Now
we relate these ideas to some of the more formal concepts introduced in Sections
1.3 and 1.4. First, we define what is meant by a valid argument.
I 
S
An argument is a finite collection of statements Al, A2, .
, An called premises
(or hypotheses) followed by a statement 13 called the conclusion. Such an argument
is valid if, whenever A1 , A2
.
, An are all true, then 3 is also true.

1.5 Logical Arguments 
29
It is often convenient to write an elementary argument in column form, like
this.
A1
A2
A,
13
PROBLEM 21. 
Show that the argument
p 
-q
r 
q
r
-p
is valid.
Solution. 
We construct a truth table.
p 
q 
r 
-q 
p-+-q r-q 
-p
T 
T 
T 
F 
F 
T 
F
T 
T 
F 
F 
F 
T 
F
T 
F 
T 
T 
T 
F 
F
F 
T 
T 
F 
T 
T 
T
T 
F 
F 
T 
T 
T 
F
F 
T 
F 
F 
T 
T 
T
F 
F 
T 
T 
T 
F 
T
F 
F 
F 
T 
T 
T 
T
*
Observe that row 4-marked with the star (*)-is the only row where the premises
p -* 
-q, r -* q, r are all marked T. In this row, the conclusion -p is also T.
Thus the argument is valid. 
I
In Problem 21, we were a bit fortunate because there was only one row where
all the premises were marked T. In general, in order to assert that an argument is
valid when there are several rows with all premises marked T, it is necessary to
check that the conclusion is also T in every such row.
Arguments can be shown to be valid without the construction of a truth table.
For example, here is an alternative way to solve Problem 21.
Assume that all premises are true. In particular, this means that r is
true. Since r -* 
q is also true, q must also be true. Thus -q is false
and, because p -* 
(-q) is true, p is false. Thus -p is true as desired.
PROBLEM 22. 
Determine whether or not the following argument is valid.
If I like biology, then I will study it.
Either I study biology or I fail the course.
If I fail the course, then I do not like biology.

30 
Chapter 1 Yes, There Are Proofs!
Solution. 
Let p be "I like biology," q be "I study biology," and r be "I fail the
course." In symbols, the argument we are to check becomes
q Vr
r -
(-p).
This can be analyzed by a truth table.
*
*
*
*
*
The rows marked * are those in which the premises are true. In row 1, the premises
are true, but the conclusion is F. The argument is not valid. 
I
The theorem which follows relates the idea of a valid argument to the notions
introduced in Sections 1.3 and 1.4.
An argument with premises Al, A2, 
A,,A and conclusion 3 is valid precisely
when the compound statement AI A A 2 A 
A A, -. B is a tautology.
Surely, this is not hard to understand. In order for the implication Al A 42 A
*. AA,k -n 3 to be a tautology, it must be the case that whenever AI AA2A. 
AA
is true, then J3 is also true. But Al A A2 A ... 
A A, is true precisely when each
of A1 , A 2
.
A, is true, so the result follows from our definition of a valid
argument.
In the same spirit as Theorem 1.4.1, we have the following important substi-
tution theorem.
[Substitution] Assume that an argument with premises A1 , A2 . 
A, and con-
clusion 3 is valid, and that all these statements involve variables PI, P2, ... 
, Pm.
If pI, P2, . . ., Pm are replaced by statements C I, C2, 
Cm, the resulting argu-
ment is still valid.
Rules of Inference
Because of Theorem 1.5.3, some very simple valid arguments which regularly
arise in practice are given special names. Here is a list of some of the most
common rules of inference.
p 
q 
r Ip-q 
qVr -'p r-- (-P)
T 
T 
T 
T 
T 
F 
F
T 
T 
F 
T 
T 
F 
T
TFT 
F 
T 
F 
F
F 
T 
T 
T 
T 
T 
T
T 
F 
F 
F 
F 
F 
T
F 
T 
F 
T 
T 
T 
T
F 
F 
T 
T 
T 
T 
T
F 
F 
F 
T 
F 
T 
T
---
* 
| 
maxj*1

1.5 Logical Arguments 
31
1. Modus ponens: 
p
p --) q
q
2. Modus tollens: 
p -* q
-q 
c
-p
3. Disjunctive syllogism:
4. Chain rule: 
p -
q
q -+ r
p -* r
5. Resolution: 
p V r
q V (-r)
p V q
p V q
Upq
-P
q
Verify modus tollens.
We illustrate how the rules of inference can be applied.
PROBLEM 23. 
Show that the following argument is valid.
(p V q) -+ (s A t)
[- ((-s) V (-t))] -* [(-r) V q]
(p V q) -* 
(r -* 
q)
Solution. 
One of the laws of De Morgan and the principle of double negation-
see Section 1.4-tell us that
[- ((-S) V (-t))] 4=[(- 
(S)) 
A (-(-t))] 4=>(S A t).
Property 13 of logical equivalence as given in Section 1.4 says that (-r)Vq
(r -* 
q). Thus the given argument can be rewritten as
(p V q) 
-* 
(s A t)
(s A t) -* 
(r -* 
q)
(p V q) -+ (r -* 
q).
The chain rule now tells us that our argument is valid.
If a truth table were used to answer Problem 23, how many rows would be
required?
Sometimes, rules of inference need to be combined.

32 
Chapter 1 Yes, There Are Proofs!
A 
* 
g 
*. 
-
PROBLEM 24. 
Determine the validity of the following argument.
If I study, then I will pass.
If I do not go to a movie, then I will study.
I failed.
Therefore, I went to a movie.
Solution. 
Let p, q and r be the statements
p: "I study."
q: "I pass."
r: "I go to a movie."
The given argument is
P- q
(-r) -* 
p
-q
r
The first two premises imply the truth of (-r) -* 
q by the chain rule. Since
(-r) -Ã· q and -q imply -(-r) 
by modus tollens, the validity of the argument
follows by the principle of double negation: - (-r) 
r. 
I
18. While this can be shown with a truth table, we prefer an argument by words.
Since -q is true, q is false. Since p --* q is true, p must also be false. Hence
-p is true and we are done.
19. There are five variables, each of which could be T or F, so we would need
25 = 32 rows.
The symbol [BB] means that an answer can be found in the Back of the Book.
You are encouraged to use the result of any exercise in this set to assist with the solution of any other.
1. Determine whether or not each of the following argu-
ments is valid.
(a) [BB] p -
(q -
r)
q
p 
r
(b) [BB] 
p- q
q Vr
r -
(-q)
(c) p- 
q
r -q
r --. p
(d) 
p 
q
(q V (-r)) -
(p A S)
s -* 
(r V q)
2. Verify that each of the five rules of inference given in
this section is a valid argument.
3. Verify that each of the following arguments is valid.
(a) [BB] 
p- 
r
q -*r
(p V q) -
r

1.5 Logical Arguments 
33
(b) 
p 
r
q 
s
(p A q)- 
(r As)
(c) 
pVq
(-p) V r
(-r) V s
q V s
(d) 
pV((-q)Ar)
-(pAS)
(s A (q v (-r)))
4. Test the validity of each of the following arguments.
(a) [BB] 
p- 
q
(-r) V (-q)
r
-p
(b) [BB] 
p V (-q)
(t v s) -. 
(p v r)
(-r)V(tVs)
p + (t V s)
(p v r) -- (q V r)
(c) 
p V (-q)
(t V s) --+ (p V r)
(-r) 
V (t V s)
p (-* (t V s)
(q V r) -
(p V r)
(d) [(pAq)vr]- (qArAs)
[(-p) A (-q)] 
(r V p)
[p V (-q) V r] 
(q A s)
(p A q) +- [(q A r) V s]
5. Determine the validity of each of the following argu-
ments. If the argument is one of those listed in the text,
name it.
(a) [BB] 
If I stay up late at night, then I will be
tired in the morning.
I stayed up late last night.
I am tired this morning.
(b) [BB] 
If I stay up late at night, then I will be
tired in the morning.
I am tired this morning.
I stayed up late last night.
(c) 
If I stay up late at night, then I will be
tired in the morning.
I am not tired this morning.
I did not stay up late last night.
(d) 
If I stay up late at night, then I will be
tired in the morning.
I did not stay up late last night.
I am not tired this morning.
(e) [BB) 
Either I wear a red tie or I wear blue socks.
I am wearing pink socks.
I am wearing a red tie.
(f) 
Either I wear a red tie or I wear blue socks.
I am wearing blue socks.
I am not wearing a red tie.
(g) [BB] 
If I work hard, then I earn lots of money.
If I earn lots of money, then I pay high
taxes.
If I pay high taxes, then I have worked
hard.
(h) 
If I work hard, then I earn lots of money.
If I earn lots of money, then I pay high
taxes.
If I work hard, then I pay high taxes.
(i) 
If I work hard, then I earn lots of money.
If I earn lots of money, then I pay high
taxes.
If I do not work hard, then I do not pay
high taxes.
(j) 
If I like mathematics, then I will study.
I will not study.
Either I like mathematics or I like football.
I like football.
(k) 
Either I study or I like football.
If I like football, then I like mathematics.
If I don't study, then I like mathematics.
(I) 
[BB] 
If I like mathematics, then I will study.
Either I don't study or I pass mathematics.
If I don't graduate, then I didn't pass
mathematics.
If I graduate, then I studied.
(m) If I like mathematics, then I will study.
Either I don't study or I pass mathematics.
If I don't graduate, then I didn't pass
mathematics.
If I like mathematics, then I will graduate.
6. [BB] Given the premises p -* 
(-r) and r v q, either
write down a valid conclusion which involves p and
q only and is not a tautology or show that no such
conclusion is possible.
7. [BB] Repeat Exercise 6 with the premises (-p) -* 
r
and r V q.

34 
Chapter 1 Yes, There Are Proofs!
8. (a) [BB] Explain why two premises p and q can always
be replaced by the single premise p A q and vice
versa.
(b) Using 8(a), verify that the following argument is
valid.
p Aq
p -r
s -q -
(-s) 
A r
9. Let n be an integer greater than 1. Show that the fol-
lowing argument is valid.
OD 10.
pi -
(qi -
ri)
P2 -
(q2 -
r2)
Pn 
(qn n
ql Aq2 A * Aqn
(pi 
ri) A (P2 -r2) 
A ..
A (Pn --) n)
[Hint: Exercise 8(a).]
[BB] What language is being used when we say "modus
ponens" or "modus tollens"? Translate these expressions
into English and explain.
' 
a 
ga 
"TOl 
5
1. State, with a reason, whether each of the following state-
ments is true or false.
(a) If a and b are integers with a -b > 0 and b-a > 0,
then a + b.
(b) If a and b are integers with a-b > 0 and b -a > 0,
then a : b.
2. Write down the negation of each of the following state-
ments in clear and concise English.
(a) Either x is not a real number or x > 5.
(b) There exists a real number x such that n > x for
every integer n.
(c) If x, y, z are positive integers, then x3 + y3 # z 3.
(d) If a graph has n vertices and n + I edges, then its
chromatic number is at most 3.
3. Write down the converse and contrapositive of each of
the following implications.
(a)
(b)
(c)
If a and b are integers, then ab is an integer.
If x is an even integer, then x2 is an even integer.
Every planar graph can be colored with at most four
colors.
4. Rewrite each of the following statements using the quan-
tifiers "for all" and "there exists" as appropriate.
(a) Not all countable sets are finite.
(b) I is the smallest positive integer.
5. (a) Determine whether or not the following implication
is true.
"x is a positive odd integer
-- x + 2 is a positive odd integer."
(b) Repeat (a) with -* 
replaced by (-*.
6. Let n be an integer. Prove that n3 is odd if and only if
n is odd.
7. With a proof by contradiction, show that there exists no
largest negative rational number.
8. Construct a truth table for the compound statement [p A
(q -(-r))] 
-[ 
(-q) 
V r]-
9. Determine the truth value of [p V (q -
((-r) A S))]
(r A t), where p, q, r, s and t are all true.
10. Two compound statements A and Â¶3 have the property
that A -* 'B is logically equivalent to 'B -* 
A. What
can you conclude about A and l3?
11. (a) Suppose A, 23, and C are compound statements
such that A 
-r3t 
D and 
3B < 
C. Explain
why A 
C.
(b) Give a proof of Property I I which uses the result
of Property 13.
12. Establish the logical equivalence [(p -* 
q) -* r]
[(p V r) A (-(q 
A (-r)))].
13. Express ((p V q) A r) V ((p V q) A (-p)) 
in disjunctive
normal form.

Review Exercises 
35
14. Determine whether or not each of the following argu
ments is valid.
(a) -((-p) A q)
-(p A r)
r V s
q -s
(b) 
p V (-q)
(t vs) -+(p Vr)
(-r) 
V (t V s)
p (4 (t Vs)
(PA 
r) 
-
(q Ar)
15. Discuss the validity of the argument
p A q
(-'p) A r
Purple toads live on Mars.
16. Determine the validity of each of the following argu-
ments. If the argument is one of those listed in the text,
name it.
(a) 
Either I wear a red tie or I wear blue socks.
Either I wear a green hat or I do not wear
blue socks.
Either I wear a red tie or I wear a green
hat.
(b) 
If I like mathematics, then I will study.
Either I don't study or I pass mathematics.
If I don't pass mathematics, then I don't
graduate.
If I graduate, then I like mathematics.

~ 
'*a~ 
Sets and Relations
2 1 
SETS
Any branch of science, like a foreign language, has its own terminology. "Iso-
morphism," "cyclotomic," and "coset" are words one is unlikely to hear except in
a mathematical context. On the other hand, quite a number of common English
words-field, complex, function-have precise mathematical meanings quite dif-
ferent from their usual ones. Students of French or Spanish know that mem-
ory work is a fundamental part of their studies; it is perfectly obvious to them
that without a firm grasp of the meaning of words, their ability to learn gram-
mar and to communicate will be severely hindered. It is, however, not always
understood by science students that they must memorize the terminology of their
discipline with the same diligence that students of Russian memorize vocabu-
lary. Without constant review of the meanings of words, one's understanding of
a paragraph of text or the words of a teacher is very limited. We advise read-
ers of this book to maintain and constantly review a mathematical vocabulary
list.
What would it be like to delve into a dictionary if you didn't already know
the meanings of some of the words in it? Most people, at one time or another,
have gone to a dictionary in search of a word only to discover that the definition
uses another unfamiliar word. Some reflection indicates that a dictionary can be
of no use unless there are some words which are so basic that we can understand
them without definitions. Mathematics is the same way. There are a few basic
terms which we accept without definitions.
Most of mathematics is based upon the single undefined concept of set, which
we think of as just a collection of things called elements or members. Primitive
humans discovered the set of natural numbers with which they learned to count.
The set of natural numbers, which is denoted with a capital boldface N or, in hand-
writing, with this symbol, N, consists of the numbers 1, 2, 3,... 
(the three dots
37

38 
Chapter 2 Sets and Relations
meaning "and so on").' The elements of N are, of course, just the positive inte-
gers. The full set of integers, denoted Z or A, consists of the natural numbers, their
negatives, and 0. We might describe this set by ... , -3, -2, -1, 0, 1, 2, 3 ....
Our convention, which is not universal, is that 0 is an integer, but not a natural
number.
There are various ways to describe sets. Sometimes it is possible to list the
elements of a set within braces.
.
{eggl, egg2} is a set containing two elements, eggI and egg2.
.
{x} is a set containing one element, x.
* N -
{1, 2, 3, ... J is the set of natural numbers.
.
Z = {. . . , -3, -2, -1, 0, 1, 2, 3, .. .. is the set of integers.
On other occasions, it is convenient to describe a set with so-called set builder
notation. This has the format
{x I x has certain properties),
which is read "the set of x such that x has certain properties." We read "such
that" at the vertical line, "J."
More generally, we see
Some expression I the expression has certain properties).
Thus, the set of odd natural numbers could be described as
in I n is an odd integer, n > O}
or as
{2k- I k = 1,2,3, ... }
or as
{2k - 1 k c NJ.
The expression "k E N" is read "k belongs to N," the symbol E denoting set
membership. Thus, "m c Z" simply records the fact that m is an integer. Recall
that a slash (/) written over any mathematical symbol negates the meaning of that
symbol. So, in the same way that or =A 3.14, we have 0 0 N.
The set of common fractions-numbers like 3, -2, 
and 5 (= 5j), which are
ratios of integers with nonzero denominators-is more properly called the set of
rational numbers and is denoted Q or (Q. Formally,
Q -
I " I m, n E Z, n =A 0).
The set of all real numbers is denoted R or IR. To define the real numbers
properly requires considerable mathematical maturity. For our purposes, we think
l Since the manufacture of boldface symbols such as N is a luxury not afforded users of chalk or pencil,
it has long been traditional to use N on blackboards or in handwritten work as the symbol for the natural
numbers and to call N a blackboard bold symbol.

2.1 Sets 39
a 
0
EXAMPLES 1
of real numbers as numbers which have decimal expansions of the form a .a I a2 ...
where a is an integer and al, a2, ... 
are integers between 0 and 9 inclusive. In
addition to the rational numbers, whose decimal expansions terminate or repeat,
the real numbers include numbers like IÂ¶, 
VI7, e, Ar, In 5, and cos 7 whose dec-
imal expansions neither terminate nor repeat. Such numbers are called irrational.
An irrational number is a number which cannot be written in the form n with m
n
and n both integers. Incidentally, it can be very difficult to decide whether or not
a given real number is irrational. For example, it is unknown whether or not such
numbers as e +- 7 or e are irrational.
7r
The complex numbers, denoted C or C, have the form a + bi where a and b
are real numbers and i2 = -1; 
that is,
C = {a + bi I a, b E R, i2 = -11.
Sometimes people are surprised to discover that a set can be an element of
another set. For example, {{a, bJ, cl is a set with two elements, one of which is
{a, b} and the other c.
Let S denote the set {{a}, b, c). True or false?
(a) a Â¢ S.
(b) (a) E S.
Equality of Sets
Sets A and B are equal, and we write A = B, if and only if A and B contain the
same elements or neither set contains any element.
.
{1, 2, 11 = {1, 21 = {2, 1};
* 2 4 
-6 2'r } 
2}
It t t = r -s, 
r, s E {0, 1, 2}} = {-2,-1, 0, 1, 2}. 
A
The Empty Set
One set which arises in a variety of different guises is the set which contains no
elements. Consider, for example, the set SMALL of people less than 1 millimeter in
height, the set LARGE of people taller than the Eiffel Tower, the set
<T3(EUP3Qa9i = {n E N I 5n = 2},
and the set
S = In E N I n2 + 1 = 01.
These sets are all equal since none of them contains any elements. The unique set
which contains no elements is called the empty set. Set theorists originally used
0 (zero) to denote this set, but now it is customary to use a 0 with a slash through
it, 0, to avoid confusion between zero and a capital "Oh."
True or false? {0} = 0.
M

40 
Chapter 2 Sets and Relations
Subsets
I 
S
EXAMPLES 2
0
0
A set A is a subset of a set B, and we write A C B, if and only if every element
of A is an element of B. If A C B but A + B, then A is called a proper subset
of B and we write A C B.
When A C B, it is common to say "A is contained in B" as well as "A
is a subset of B." The notation A c B, which is common, unfortunately means
A C B to some people and A C B to others. For this reason, we avoid it, while
reiterating that it is present in a lot of mathematical writing. Upon encountering
it, the reader should make an effort to discover what the intended meaning is.
We occasionally see "B D A," read "B is a superset of A." This is an
alternative way to express "A C B," A is a subset of B, just as "y > x" is an
alternative way to express "x < y." We generally prefer the subset notation.
{a, b) C (a, b, c}
{a, b} 
l {a, b, c}
{a, b} C (a, b, {a, bll
{a, bl e la, b, {a, bll
NCZCQCRCC
A
..
g., 
S
Proof
A 
*S*S 
0
Note the distinction between A C B and A g B, the latter expressing the
negation of A C B; for example,
{a,b} C la,b,c} g {a,b,x}.
For any set A, A C A and 0 C A.
If a E A, then a E A, so A C A. The proof that 0 C A is a classic model of
proof by contradiction. If 0 C A is false, then there must exist some x E 0 such
that x V A. This is an absurdity since there is no x E 0. 
I
True or false?
(a) {01 E {{01}
(b) 0 C 11011
(c) {01 C {{0}}
(As Shakespeare once wrote, "Much ado about nothing.")
The following proposition is an immediate consequence of the definitions of
"subset" and "equal sets," and it illustrates the way we prove two sets are equal
in practice.
If A and B are sets, then A = B if and only if A C B and B C A.
There are two assertions being made here.
(-a) If A = B, then A is a subset of B and B is a subset of A.
(.a-) If A is a subset of B and B is a subset of A, then A = B.
1=M

2.1 Sets 
41
Remember that another way to state Proposition 2.1.4 is to say that, for two
sets to be equal, it is necessary and sufficient that each be a subset of the other.
Note the distinction between membership, a E b, and subset, a C b. By the
former statement, we understand that a is an element of the set b; by the latter,
that a is a set each of whose elements is also in the set b2
Each of the following assertions is true.
0
0
0
I 
0
EXAMPLES 4
{a} e {x, y, {a}}
{a} C {x,y,a)
{a} i {x, y, {a}}
{a, b} C (a, bJ
0 E lx, y, 01
0 C {x, y, 01
t0} V {x, y, 0}
A
The Power Set
An important example of a set, all of whose elements are themselves sets, is the
power set of a set.
The power set of a set A, denoted P(A), is the set of all subsets of A:
I P(A) = {B I B C Al. 
I
0
0
A
A 
-
I 
* 
a 
I
1. Both statements are true. The set S contains the set {a) as one of its elements,
but not the element a.
2. This statement is false: {01 is not the empty set for it contains one element,
namely, the set 0.
3. (a) True: {{0}} is a set which contains the single element 101.
(b) True: The empty set is a subset of any set.
(c) False: There is just one element in the set 101 (namely, 0) and this is not
an element of the set 11011, whose only element is {0}.
The symbol [BB] means that an answer can be found in the Back of the Book.
1. List the (distinct) elements in each of the following sets:
(a) [BB] {x E R I x2 = 51
(b) {x e Z I Xy = 15 for some y e Z)
(c) [BB] (x E Q I x(x2 -2)(2x + 3) = 0)
(d) 
Xa 
| 
Y a 
{ -1,40, a 
,n 
a 
{ 0,1,2}}
(e) [a cs N I a < -4 and a > 4}
2Note the use of lowercase letters for sets, which is not common but certainly permissible.
EXAMPLES 3
If A = (a), then P(A) = {0, {a}}
If A = {a, b}, then 'P(A) = t0, {a), {b}, {a, b}}
P({a, b, cl) = 10, {a), {b}, {c}, la, b}, {a, c}, lb, c}, {a, b. cl)

42 Chapter 2 Sets and Relations
2. List five elements in each of the following sets:
(a) [BB] (a+biIa,bEZi
2 = -1 }
(b) {a+b2IaE N, -bE(2,5,7})
(c) (x Ix,yeR,x 2 +y 2  
251
(d) (n 
E N I n2 + n is a multiple of 31
3. Let A = (1,2,3,41.
(a) 
[BB] List all the subsets B of A such that
{1,2} C B.
(b) List all the subsets B of A such that B C (1, 
21.
(c) List all the subsets B of A such that {I, 21 g B.
(d) List all the subsets B of A such that B i 
{1, 2}.
(e) List all the subsets B of A such that {l, 21 C B.
(f) List all the subsets B of A such that B C (1, 2}.
4. [BB] Let A = (la, b}}. Are the following statements
true or false? Explain your answer.
(a) a c A.
(b) A e A.
(c) {a,b} A.
(d) There are two elements in A.
5. Determine which of the following are true and which
are false. Justify your answers.
(a)
(b)
(c)
(d)
(e)
(M
(g)
[BB] 3 e (1,3,5)
(31E [1,3, 51
(31 C (1,3,51
[BB] (3,5} Z (1,3,51
1, 
3, 
5}C f1, 
3, 
5
I E (a + 2b a, b even integers}
0 E la + bx 
I a, b E Q, b 7 0}
6. Find the power sets of each of the following sets:
(a) [BB] 0
(b) (01
(c) (0, (011
7. Determine whether each of the following statements is
true or false. Justify your answers.
(a)
(b)
(c)
(d)
(e)
(f)
(g)
(h)
(i)
[BB] 0 C 0
0 C to)
0 C 0
0 E (0}
[BB] (1,21 
} (1,2,3,(I,2,31}
(1,21 E (1,2, 3, 
(1,2, 31)
{1, 2 C I, 
2, {1, 2) ))
[BB] 1l,2)} 
1,2,({{,2)11
It1, 
2) C (1,2, (1,2))
8. [BB] Let A be a set and suppose x c A. Is x C A also
possible? Explain.
9. (a) List all the subsets of the set la, b, c, 
d} which
contain:
i. four elements
ii. [BB] three elements
iii. two elements
iv. one element
v. no elements
(b) How many subsets of la, b, c, 
d} are there alto-
gether?
10. (a) How many elements are in the power set of the
power set of the empty set?
(b) Suppose A is a set containing one element. How
many elements are in P(P(A))?
1. (a) [BB] If A contains two elements, how many ele-
ments are there in the power set of A?
(b) [BB] If A contains three elements, how many ele-
ments are there in the power set of A?
(c) [BB] If a set A contains n > 0 elements, guess how
many elements are in the power set of A.
12. Suppose A, B, and C are sets. For each of the following
statements either prove it is true or give a counterexam-
ple to show that it is false.
(a) [BB] A E B, B E C -* 
A e C.
(b) A C BB 
C C-* A C C.
(c) AC B,B C C-* A CC.
(d) [BB] A E B, B C C 
A E C.
(e) A c B, B C C -* 
A C C.
(0 A C B,B E C -A 
E C.
(g) A C B, B c C -* 
A C C.
13. Suppose A and B are sets.
(a) Answer true or false and explain: A 
i 
B
B C A.
(b) Is 
the converse of the implication in (a) true or false?
Explain.
14. Suppose A, B, and C are sets. Prove or give a counter-
example which disproves each of the following asser-
tions.
(a) [BB] C e P(A) ++ C C A.
(b) A C B 
'P(A) C P(B).
(c) A = 0 
'P(A) = 0.

2.2 Operations on Sets 43
2.2 
OPERATIONS ON SETS
In this section, we discuss ways in which two or more sets can be combined in
order to form a new set.
Union and Intersection
S
EXAMPLES 5
The union of sets A and B, written A U B, is the set of elements in A or in B
(or in both). The intersection of A and B, written A n B, is the set of elements
which belong to both A and B.
.
If A = {a, b, c} and B = {a, x, y, b}, then
AUB ={a,b,c,x,y}, 
AOB = {a,b},
AU{0}=la,b,c,0} and B{t0)=0.
. ForanysetA,AU0=AandA n I= 0.o.
As with addition and multiplication of real numbers, the union and intersection
of sets are associative operations. To say that set union is associative is to say
that
(Al U A2 ) U A3 = Al U (A2 U A3)
for any three sets Al, A2, A3. It follows that the expression
Al U A2 U A3
is unambiguous. The two different interpretations (corresponding to different inser-
tions of parentheses) agree. The union of n sets Al, A2  
A, is written
n
() 
AU A 2 U A3 U ... U An 
or 
U Ai
i=t
and represents the set of elements which belong to one or more of the sets Ai.
The intersection of AI, A2
, 
An is written
n
(2) 
Al nA 2 fA 3 n..A, 
or 
nA
i=t
and denotes the set of elements which belong to all of the sets.
Do not assume from the expression AI U A2 U A3 U ... U An that n is actually
greater than 3 since the first part of this expression-AI U A2 U A3-is 
present
only to make the general pattern clear; a union of sets is being formed. The
last term-An-indicates that the last set in the union is An. If n = 2, then
A1 U A2 U A3 U ... U An means AI U A2. Similarly, if n = 1, the expression
Al A2 n ... n A, simply means Al.
While parentheses are not required in expressions like (1) or (2), they are
mandatory when both union and intersection are involved. For example, An(BUC)
and (A n B) U C are, in general, different sets. This is probably most easily seen
by the use of the Venn diagram shown in Fig 2.1.

44 
Chapter 2 Sets and Relations
X
B
Figure 2.1 
A Venn diagram.
The diagram indicates that A consists of the points in the regions labeled 1,
2, 3, and 4; B consists of those points in regions 3, 4, 5, and 6 and C of those
in 2, 3, 5, and 7. The set B U C consists of points in the regions labeled 3, 4, 5,
6, 2, and 7. Notice that A n (B U C) consists of the points in regions 2, 3, and 4.
The region A n B consists of the points in regions 3 and 4; thus, (A n B) U C is
the set of points in the regions labeled 3, 4, 2, 5, and 7. The diagram enables us
to see that, in general, A n (B U C) # (A n B) U C and it shows how we could
construct a specific counterexample. Namely, we could let A, B, and C be the
sets
A = {1, 2, 3, 4}, B = {3, 4, 5, 6), C = {2, 3, 5, 7}
as suggested by the diagram and then calculate
A n (B U C) = {2, 3, 4} = {2, 3, 4, 5, 7} = (A n B) U C.
There is a way to rewrite A n (B U C). In Fig 2.1, we see that AnB consists
of the points in the regions labeled 3 and 4 and that A n C consists of the points
in 2 and 3. Thus, the points of (A n B) U (A n C) are those of 2, 3, and 4. These
are just the points of A n (B U C) (as observed previously), so the Venn diagram
makes it easy to believe that, in general,
(3) 
An(B U C) = (AnB) U (An c).
While pictures can be helpful in making certain statements seem plausible, they
should not be relied upon because they can also mislead. For this reason, and
because there are situations in which Venn diagrams are difficult or impossible
to create, it is important to be able to establish relationships among sets without
resorting to a picture.
PROBLEM 6. 
Let A, B and C be sets. Verify equation (3) without the aid of a
Venn diagram.
Solution. 
As observed in Proposition 2.1.4, showing that two sets are equal is
equivalent to showing that each is a subset of the other. Here this just amounts
to expressing the meaning of U and n in words.
To show A n (B U C) C (A n B) U (A n c), let x c A n (B U C). Then x is
in A and also in B U C. Since x e B U C, either x E B or x E C. This suggests
cases.
Case 1: x C B.
In this case, x is in A as well as in B, so it's in A n B.

2.2 Operations on Sets 45
Case 2: x e C.
Here x is in A as well as in C, so it's in A n C.
We have shown that either x c A n B or x E A n C. By definition of union,
x E (A n B) U (A n C), completing this half of our proof.
Conversely, we must show (A n B) U (A n C) C A n (B U C). For this, let
x E (A n B) U (A n C). Then either x E A n B or x E A n C. Thus, x is in both
A and B or in both A and C. In either case, x E A. Also, x is in either B or C;
thus, x c B U C. So x is both in A and in B U C; that is, x G A 0 (B U C). This
completes the proof. 
I
PROBLEM 7. 
For sets A and B, prove that A n B = A if and only if A C B.
Solution. 
Remember that there are two implications to establish and that we use
the symbolism (-*) and (.a-) to mark the start of the proof of each implication.
(-a.) Here we assume A n B = A and must prove A C B. For this, suppose
x E A. Then, x E A n B (because we are assuming A = A n B). Therefore, x is
in A and in B, in particular, x is in B. This proves A C B.
(a<-) Now we assume A C B and prove A n B = A. To prove the equality of
A n B and A, we must prove that each set is a subset of the other. By definition
of intersection, A n B is a subset of A, so A n B C A. On the other hand, suppose
x E A. Since A C B, x is in B too; thus, x is in both A and B. Therefore,
A CA n B. Therefore, A = A n B. 
I
For sets A and B, prove that A U B = B if and only if A C B.
Set Difference
The set difference of sets A and B, written A \ B, is the set of those elements of
A which are not in B. The complement of a set A is the set Ac = U \ A, where
U is some universal set made clear by the context.
EXAMPLES 8
0
{a,b,c}\{a,b} ={c}
{a, b, c} \ {a, x} = {b, c)
{a, b, 0} \ 0 = {a, b, 0}
{a, b, 0} \ {0} = {a, b}
If A is the set {Monday, Tuesday, Wednesday, Thursday, Friday), the context
suggests that the universal set is the days of the week, so Ac = {Saturday,
Sunday). 
A
Notice that A \ B = A n Bc and also that (AC)C = A. For example, if
A = (x E Z I x2 
> 0}, then Ac = {0} (it being understood that U = Z)
and so
(AC)c = {0}C = {x E Z I x > 0) U {x C Z I x < 0} = A.
You may have previously encountered standard notation to describe various
types of intervals of real numbers.
I 
8

46 Chapter 2 Sets and Relations
i. Â±i
If a and b are real numbers with a < b, then
[a, b] = {x E R I a < x < b}
(a, b) = {x E R I a <x < b}
(a, b] = {x E R I a < x < b}
[a, b) = {x c R I a < x < b}
open
half open
half open.
As indicated, a closed interval is one which includes both end points, an open
interval includes neither, and a half open interval includes just one end point. A
square bracket indicates that the adjacent end point is in the interval. To describe
infinite intervals, we use the symbol oc (which is just a symbol) and make obvious
adjustments to our notation. For example,
(-oc, b] = {x E R I x < b),
(a, oc) = {x E R I x > a).
The first interval here is half open; the second is open.
If A = [-4,4] and B = [0, 5], then A \ B = [-4, 0). What is B \ A? What is AC?
The following two laws, of wide applicability, are attributed to Augustus De
Morgan (1806-1871), who, together with George Boole (1815-1864), helped to
make England a leading center of logic in the nineteenth century.3
(A U B)c = Ac n BC; 
(A n B)c = Ac U Be.
Readers should be struck by the obvious connection between these laws and
the rules for negating and and or compound sentences described in Section 1.1.
We illustrate by showing the equivalence of the first law of De Morgan and the
rule for negating "A or 3."
PROBLEM 9. 
Prove that (A U B)c = A, n Bc for any sets A, B, and C.
Solution. 
Let A be the statement "x c A" and 93 be the statement "x C B."
Then
x E (A U B)C < -'(x C A U B)
<-* -(A or 93)
<-+ -A 
and -B
a--> x E AC and x E Bc
< x E AC n BC
definition of union
rule for negating "or"
definition of intersection.
3As pointed out by Rudolf and Gerda Fritsch (Der Vierfarhensatz, B. 1. Wissenschaftsverlag, Mannheim,
1994 and English translation, The Four-Color Theorem, by J. Peschke, Springer-Verlag, 1998), it was in a
letter from De Morgan to Sir William Rowan Hamilton that the question giving birth to the famous "Four-
Color Theorem" was first posed. See Section 14.2 for a detailed account of this theorem whose proof was
found only quite recently, after over 100 years of effort!
closed

2.2 Operations on Sets 47
NEEMEMES
EXAMPLES 10
The sets (A U B)C and AC n BC contain the same elements, so they are the
same. 
I
Symmetric Difference
The symmetric difference of two sets A and B is the set A e B of elements which
are in A or in B, but not in both.
The notation A A B is used by some authors to denote symmetric difference
although, as suggested, this is not our preference.
Notice that the symmetric difference of sets can be expressed in terms of
previously defined operations. For example,
A G B = (A U B) \ (A n B)
and
A e B = (A \ B) U (B \ A).
. {a, b, c) E {x, y, a) = {b, c, x, y)
* {a,b,c}Â® 0 = la,b,c}
* {a,b,c} {0} = {a,b,c,0 
A
PROBLEM 11. 
Use a Venn diagram to illustrate the plausibility of the fact that
G is an associative operation; that is, use a Venn diagram to illustrate that for any
three sets A, B, and C,
(4) 
(A G B) (D C = A (D (B (D C).
Solution. 
With reference to Fig 2.1 again, A (D B consists of the points in the
regions labeled 1, 2, 5, and 6 while C consists of the points in the regions 2,
3, 5, and 7. Thus, (A Â®3 B) @ C is the set of points in the regions 1, 3, 6, and
7. On the other hand, B Â® C consists of the regions 2, 7, 4, and 6 and A, of
regions 1, 2, 3, 4. Thus, A eD (B A C) also consists of the points in regions 1, 3,
6, and 7. 
I
As a consequence of (4), the expression A Â® B D C, which conceivably could
be interpreted in two ways, is in fact unambiguous. Notice that A Â® B E C is
the set of points in an odd number of the sets A, B, C: Regions 1, 6, and 7
contain the points of just one of the sets while region 3 consists of points in all
three. More generally, the symmetric difference Al D A2 D A3 D 
ED 
A, of n
sets AI, A2, A3 ,..., A, is well defined and, as it turns out, is the set of those
elements which are members of an odd number of the sets Ai. (See Exercise 21
of Section 5.1.)
The Cartesian Product of Sets
There is yet another way in which two sets can be combined to obtain another.

48 Chapter 2 Sets and Relations
-= 
I
EXAMPLE 12
EXAMPLE 13
If A and B are sets, the Cartesian product (or the direct product) of A and B is
the set
A x, B; 
{(a, b) I a E A, b E;. BI
(We say "A cross B" for "A x B.") The Cartesian product A x A is denoted A2.
More generally,
A"= A x A x ... x A = {(al, a2 .  
a,,) I ai C A for i = 1, 2,... , n).
n times
The elements of A x B are called ordered pairs because their order is impor-
tant: (a, b) # (b, a) (unless a = b). The elements a and b are the coordinates of
the ordered pair (a, b); the first coordinate is a and the second is b. The elements
of A' are called n-tuples.
Elements of A x B are equal if and only if they have the same first coordinates
and the same second coordinates:
I( 
I, b1) 
b 
(a2, b2)S if andonlyifnaj 
= b1 and a2V= Li2.
Let A = {a, b} and B = {x, y, zi. Then
A x B = {(a, x), (a, y), (a, z), (b, x), (b, y), (b, z)}
and
B x A = {(x, a), (x, b), (y, a), (y, b), (z, a), (z, b)}.
This example illustrates that, in general, the sets A x B and B x A are
different. 
A
The Cartesian plane, in which calculus students sketch curves, is a picture of
R x R = R2 = {(x, y) I x, y c R}. The adjective "Cartesian" is derived from
Descartes,4 as Cartesius was Descartes's name in Latin. 
A
PROBLEM 14. 
Let A, B, and C be sets. Prove that A x (B U C) C (A x B) U
(A x C).
Solution. 
We must prove that any element in Ax (BUC) is in (Ax B)U(A x C).
Since the elements in A x (B U C) are ordered pairs, we begin by letting (x, y) s
A x (BUC) (this is more helpful than starting with "x c A x B") and ask ourselves
what this means. It means that x, the first coordinate, is in A and y, the second
coordinate, is in B U C. Therefore, y is in either B or C. If y is in B, then, since
x is in A, (x, y) e A x B. If y is in C, then, since x is in A, (x, y) E A x C.
Thus, (x, y) is either in A x B or in A x C; thus, (x, y) is in (A x B) U (A x C),
which is what we wanted to show. 
I
4Rene Descartes (1596-1650), together with Pierre de Fermat, the inventor of analytic geometry, intro-
duced the method of plotting points and graphing functions in R2 with which we are so familiar today.

2.2 operations on Sets 49
M-*
-i
Let A, B, and C be three sets. Prove that (A x B) U (A x C) C A x (B U C).
What can you conclude about the sets A x (B U C) and (A x B) U (A x C)? Why?
Let A and B be nonempty sets. Prove that A x B = B x A if and only if A = B.
Is this true if A = 0?
4. (a) Suppose the first statement, A U B = B, is true. We show A C B. So let
x C A. Then x is certainly in A U B, by the definition of U. But A U B = B,
so x E B. Thus, A C B.
(a) 
Conversely, suppose the second statement, A C B, is true. We have to
show A U B = B. To prove the sets A U B and B are equal, we have to show
each is a subset of the other. First, let x c A U B. Then x is either in A or in
B. If the latter, x E B, and if the former, x E B because A is a subset of B.
In either case, x c B. Thus, A U B C B. Second, assume x E B. Then x is in
A U B by definition of U. So B C A U B and we have equality, as required.
5. B \ A = (4, 5]; AC = (-o, 
-4) U (4, oc).
6. An element of (A x B) U (A x C) is either in A x B or in A x C; in either
case, it's an ordered pair. So we begin by letting (x, y) c (A x B) U (A x C)
and noting that either (x, y) c A x B or (x, y) E A x C. In the first case, x is
in A and y is in B; in the second case, x is in A and y is in C. In either case,
x is in A and y is either in B or in C; so x e A and y E B U C. Therefore,
(x, y) E A x (B U C), establishing the required subset relation. The reverse
subset relation was established in Problem 14. We conclude that the two sets
in question are equal; that is, A x (B U C) = (A x B) U (A x C).
7. (-a) Suppose that the statement A x B = B x A is true. We prove A = B. So
suppose x c A. Since B :A 0, we can find some y c B. Thus, (x, y) E A x B.
SinceAxB =BxA, (x,y) E BxA.Sox e B,givingusA C B.Similarly,
we show that B C A and conclude A -
B.
(a-) 
On the other hand, if A = B is a true statement, then A x B = A x A =
B x A.
Finally, if A = 0 and B is any nonempty set, then A x B = 0 = B x A, but
A # B. So A x B = B x A does not mean A = B in the case A = 0.
The symbol [BB] means that an answer can be found in the Back of the Book.
1. Let A = {x X N I- 
< 71, B = {x E Z I Ix-21 < 41
and C = {x c R I x3-4x = 0).
(a) [BB] List the elements in each of these sets.
(b) Find A U C, B n C, B \ C, A D B, C x (B n C),
(A \ B) \ C, A \ (B \ C), and (B U 0) 0n 11.
(c) List the elements in S = {(a, b) E A x B I a 
b+2}
and in T = {(a, c) E A x C I a < c}.
2. Let S = {2, 5, 
2,25, r, 5} and T = {4,25, 
2,6 , 2}
(a) [BB] Find SnT, SUT,andT x (SnT).
(b) [BB] Find ZU S, Z n, 
Z U T, and Zn T.
(c) List the elements in each of the sets Z n (S U T) and
(Z n S) U (Z n T). What do you notice?
(d) List the elements of Zu (Sn T) and list the elements
of (Z U S) n (Z U T). What do you observe?
3. Let A = {(-l, 2), (4, 5), (0,0 ), (6, -5), (5, 1), (4, 3)}.
List the elements in each of the following sets.
(a) [BB] {a + b I (a, b) c Al
(b) (a I a > 0 and (a, b) e A for some b}
(c) {b 
b 
k2 for some k E Z and (a, b) E A for
some a}
ff 31TTI-IM

50 
Chapter 2 Sets and Relations
4. List the elements in the sets A 
((a, b) e N x N I a <
b,b < 3) and B = I 
| Ia,b E {1,1,2}}.
5. For A = [a, b, c, [a, b}}, find
(a) [BB] A \ (a, b}
(b) {01\P(A)
(c) A\ 0
(d) 0\ A
(e) [BB] {a, b, c} \ A
(f) ({a,b,c}U{A})\A
6. Find Ac (with respect to U = R) in each of the following
cases.
(a)
(b)
(c)
[BB] A = (1, oc) U (-oc, -2]
A = (-3,oo)0(-oo,4]
A = {x E R I x2 < -1}
7. Let n > 3 and A = {1, 2, 3, . . , n .
(a) [BB] How many subsets of A contain [1, 2}?
(b) How many subsets B of A have the property that
Bnl, 
2} =0?
(c) How many subsets B of A have the property that
B U [1, 21 = A?
Explain your answers.
8. [BB] Let a and b be real numbers with a < b. Find
(a, b), [a, b)c, (a, oc), and (-oc, b]c.
9. The universal set for this problem is the set of students
attending Miskatonic University. Let
. M denote the set of math majors
. CS denote the set of computer science majors
. T denote the set of students who had a test on Friday
. P denote those students who ate pizza last Thursday.
Using only the set theoretical notation we have intro-
duced in this chapter, rewrite each of the following
assertions.
(a) [BB] Computer science majors had a test on Friday.
(b) [BB] No math major ate pizza last Thursday.
(c) One or more math majors did not eat pizza last
Thursday.
(d) Those computer science majors who did not have a
test on Friday ate pizza on Thursday.
(e) Math or computer science majors who ate pizza on
Thursday did not have a test on Friday.
10. Using only the set theoretical notation introduced in this
chapter, express the negation and converse of statements
(a), (c), and (d) in the previous question.
11. Let P denote the set of primes and E the set of even inte-
gers. As always, Z and N denote the integers and natural
numbers, respectively. Find equivalent formulations of
each of the following statements using the notation of
set theory that has been introduced in this section.
(a) [BB] There exists an even prime.
(b) 0 is an integer but not a natural number.
(c) Every prime is both a natural number and an integer.
(d) Every prime except 2 is odd.
12. For n E Z, let A, = (a E Z I a < n}. Find each of the
following sets.
(a) [BB] A3 U A-3
(b) A3 n A-3
(c) A3 n (A 3)C
(d) nfl
0 Ai
13. [BB] In Fig 2.1, the region labeled 7 represents the set
C\(AUB). What set is represented by the region labeled
2? By that labeled 3? By that labeled 4?
14. (a) 
[BB] Suppose A and B are sets such that AnB = A.
What can you conclude? Why?
(b) Repeat (a) assuming A U B = A.
15. [BB] Let n > I be a natural number. How many ele-
ments are in the set {(a,b) e N x N I a < b < n)?
Explain.
16. Suppose A is a subset of N x N with the properties
* (1, 1) E A and
* (ab) 
A --
(a + 1, b) and (a + 1, b + 1) are both
in A.
Do you think that {(m, n) E N x N I m > n} is a subset
of A? Explain. [Hint: A picture of A in the xy-plane
might help.]
17. Let A, B, and C be subsets of some universal set U.
(a) Prove that A n B C C and Ac n B C C -* 
B C C.
(b) [BB] Given that AnB 
AnC and ACnB = ACnC,
does it follow that B = C? Justify your answer.
18. Let A, B, and C be sets.
(a) Find a counterexample to the statement A U (B n
C) = (A U B) n C.
(b) Without using Venn diagrams, prove that A U (B n
C) = (AUB)(A U C).
19. Use the first law of De Morgan to prove the second:
(AnB)'= A"UBC.
20. [BB] Use the laws of De Morgan and any other set
theoretic identities discussed in the text to prove that
(A \ B) \ C = A \ (B U C) for any sets A, B, and C.

2.3 Binary Relations 
51
21. Let A, B, C, and D be subsets of a universal set U. Use
set theoretic identities discussed in the text to simplify
the expression [(A U B)C n (AC U C)C]C \ Dc.
22. Let A, B, and C be subsets of some universal set U.
Use set theoretic identities discussed in the text to prove
that A \ (B \ C) = (A \ B) U (A \ CC).
23. Suppose A, B, and C are subsets of some universal
set U.
(a) [BB] Generalize the laws of De Morgan by finding
equivalent ways to describe the sets (A U B U C)C
and (A n B n C)C.
(b) Find a way to describe the set (A n (B \ C))C n A
without using the symbol c for set complement.
24. Let A and B be sets.
(a) [BB] Find a necessary and sufficient condition for
A D B = A.
(b) Find a necessary and sufficient condition for A n
B = A U B.
Explain your answers (with Venn diagrams if you wish).
25. Which of the following conditions imply that B = C?
In each case, either prove or give a counterexample. 
OD
(a) [BB] AUB=AUC
(b) AnB=AnC
(c) ATB=AeC
(d) A x B = A x C
26. True or false? In each case, provide a proof or a counter-
example.
(a) A C C, B C D -A 
x B C C x D.
(b) A x B C C x D -A 
C C and B C D.
(c) A C C and B C D if and only if A x B C C x D.
(d) [BB]AUBCAnB- 
A =B.
27. Show that (A n B) x C = (A x C) n (B x C) for any
sets A, B, and C.
28. Let A, B, and C be arbitrary sets. For each of the follow-
ing, either prove the given statement is true or exhibit a
counterexample to prove it is false.
(a) A\(BUC)=(A\B)U(A\C)
(b) (A \ B) x C = (A x C) \ (B x C)
(c) [BB] (A E) B) x C = (A x C) E (B x C)
(d) (A U B) x (C U D) = (A x C) U (B x D)
(e) (A \ B) x (C \ D) =(A x C) \ (B x D)
29. Find out what you can about George Boole and write a
paragraph or two about him (in good English, of course).
2.3 
BINARY RELATIONS
If A and B are sets, remember that the Cartesian product of A and B is the set
A x B = {(a, b) I a e A, b E B}. There are occasions when we are interested in
a certain subset of A x B. For example, if A is the set of former major league
baseball players and B = N U {0} is the set of nonnegative integers, then we might
naturally be interested in
R = {(a, b) I a e A, b e B, player a had b career home runs}.
For example, (Hank Aaron, 755) and (Mickey Mantle, 536) are elements of 1Z.
I 
S
EXAMPLES 15
Let A and B denote sets. A binary relation from A to B is a subset of A x B. A
binary relation on A is a subset of A x A.
The empty set and the entire Cartesian product A x B are always binary
relations from A to B, although these are generally not as interesting as certain
nonempty proper subsets of A x B.
.
If A is the set of students who were registered at the University of Toronto
during the Fall 2001 semester and B is the set [History, Mathematics, English,
Biology), then R = {(a, b) I a E A is enrolled in a course in subject b} is a
binary relation from A to B.

52 
Chapter 2 Sets and Relations
EE
EXAMPLES 16
Let A be the set of surnames of people listed in the Seattle telephone directory.
Then 7R = {(a, n) I a appears on page n} is a binary relation from A to the
set N of natural numbers.
.
{(a, b) I a, b E N, L' is an integer} and {(a, b) I a, b E N, a -b = 2} are
binary relations on N.
I{(x, y) I y = x2} is a binary relation on R whose graph the reader may
recognize. 
A
Our primary intent in this section is to identify special properties of binary
relations on a set, so, henceforth, all binary relations will be subsets of A x A for
some set A.
A binary relation 7? on a set A is reflexive if and only if (a, a) E 7? for all a E A.
.
{(x, y) E R2 
x ' y} is a reflexive relation on R since x < x for any x E R.
{(a, b) E N2  
c E N} is a reflexive relation on N since a is an integer, namely
I, for any a e N.
R = {(x, y) E R2 I X2 + y2 > O} is not a reflexive relation on R since
(0, 0) V 7?. (This example reminds us that a reflexive relation must contain
all pairs of the form (a, a): Most is not enough.) 
A
PROBLEM 17. 
Suppose 7? = {(a, b) E Z x Z I a2
correct the following "proof' that 7R is reflexive:
b2 }. Criticize and then
(a, a) E R ifa 2 =a 2.
Solution. 
The statement "(a, a) E 7? if a2 = a2 is the implication "ia 
a 
= a
2 -
(a, a) E R?," which has almost nothing to do with what is required. To prove that
7? is reflexive, we must establish an implication of the form "something -- 7R is
reflexive." Here is a good argument, in this case.
For any integer a, we have a2 = a2 and, hence, (a, a) E 7. Therefore,
7? is reflexive.
A binary relation 7? on a set A is symmetric if and only if
if a, b c A and (a, b) E )Z, then (b, a) E 7.
I
EXAMPLES 18
.
7R = {(x, y) E R2 | x2 + y2 = I} is a symmetric relation on R since if
x2 +y 2  = 1, then y2 +x 2 = 1 too: If (xy) 7., then (y,x) E R.
.
{(x, y) E Z x Z x -
y is even) is a symmetric relation on Z since if x -y 
is
even, so is y -x.
.7 
-{(x, y) E R2 I x2 > y} is not a symmetric relation on R. For example,
(2, 1) X 7R because 22 > 1, but (1, 2) 
' 7? because 12 a 2. 
A
Suppose R is a binary relation on A -
R2. In this case, the elements of R,
being ordered pairs of elements of A, are ordered pairs of elements each of which
I 
6=lW

2.3 Binary Relations 
53
is an ordered pair of real numbers. Consider, for example,
7? = {( (x, y), (u, v) ) E R' x R' I X2 + y = u2 + v2}.
This is a symmetric relation on R2 since if ( (x, y), (u, v) ) E 1R, then x2 + y2 =
2 
2 
2 
2 =2 
2
u + v ,so u + V 
x2 +y2, 
so ( (u, v), (x, y) ) E 7 
.
Is this relation reflexive?
A binary relation on the real numbers (or on
any subset of R) is symmetric if, when its points are
plotted as usual in the Cartesian plane, the figure
is symmetric about the line with equation y = x.
The set {(x, y) E R2 1 X2 + Y2 = 1 is a symmetric
relation because its points are those on the graph of
the unit circle centered at the origin and this circle
is certainly symmetric about the line with equation
y = x.
EXAMPLE 19
Figure 2.2
I 
S
EXAMPLE 20
EXAMPLE 21
If a set A has n elements and n is reasonably small, a binary relation on A
can be conveniently described by labeling with the elements of A the rows and
the columns of an n x n grid and then inserting some symbol in row a and column
b to indicate that (a, b) is in the relation.
The picture in Fig 2.2 describes the relation
7? = {(1, 1), (1, 2), (1, 4), (2, 1), (2, 2), (3, 2), (3, 3), (4, 4)1
on the set A = {1, 2, 3, 4}. This relation is reflexive (all points on the main
diagonal-top left corner to lower right-are present), but not symmetric (the x's
are not symmetrically located with respect to the main diagonal). For example,
there is a x in row 1, column 4, but not in row 4, column 1. 
A
1 
2 
3 
4
1 x 
x 
x
2xx
3 
x x
4 
x
A binary relation 7R on a set A is antisymmetric if and only if
if a, b E A and both (a, b) E 7? and (b, a) are in 7, 
then a = b.
7? = {(x, y) E R2 I x < y} is an antisymmetric relation on R since x < y and
y < x implies x = y; thus, (x, y) c 7 
and (y, x) c 7 implies x = y. 
A
If S is a set and A = 7P(S) is the power set of S, then {(X, Y) I X, Y E P(S), X C
Y} is antisymmetric since X C Y and Y C X implies X = Y. 
A
M
I

54 
Chapter 2 Sets and Relations
EXAMPLE 22
-aS
-=EX
EXAMPLE 23
EXAMPLE 24
EXAMPLES 25
A 
-
g *. 
-
R = {(1, 2), (2, 3), (3, 3), (2, 1)} is not antisymmetric on A = {1, 2, 3} because
(1, 2) e 7? and (2, 1) c R but I : 2. 
A
Note that "antisymmetric" is not the same as "not symmetric." The relation
in Example 22 is not symmetric but neither is it antisymmetric.
Why is this relation not symmetric?
Is the relation ? = { ( (x, y), (u, v) ) E R' x R2 | X2+y2 = u2 +v2 } antisymmetric?
A binary relation 7? on a set A is transitive if and only if
if a, b, c E A, and both (a, b) and (b, c) are in 7?, then (a, c) E 7?.
7? 
{(x, y) E R2 | x < y} is a transitive relation on R since if x < y and y < z,
then x < z: if (x, y) and (y, z) are in 7?, then (x, z) E 7?. 
A
{(a, b) E Z X Z a a is an integer} is a transitive relation on Z since if a and b are
integers, then so is a because a 
a 
A
* 7 
= {(x, y), (x, z), (y, u), (x, u)} is a transitive binary relation on the set
{x, y, z, u} because there is only one pair of the form (a, b), (b, c) belonging
to R (namely (x, y) and (y, u)) and, for this pair, it is true that (a, c) =
(x, u) C R.
.
7? = {(a, b), (b, a), (a, a)} is not transitive on la, b} since it contains the
pairs (b, a) and (a, b), but not the pair (b, b).
* {(a, b) I a and b are people and a is an ancestor of b} is a transitive relation
since if a is an ancestor of b and b is an ancestor of c, then a is an ancestor
of c.
17 = {(x, y) c R2 I X2 > y} is not transitive on R because (3, 4) E R (32 > 4)
and (4,10) e 1 (42 > 10) but (3, 10) 
R (32 E 10). 
A
8. The answer is yes. For any (x, y) c R2, we have x2 + y2 = x2 + y2 ; in other
words, ( (x, y), (x, y)) E 
for any (x, y) c R2.
9. (2, 3) E 7? but (3, 2) 
' R.
10. No. For example, ( (1, 2), (2, 1) ) E 7R because 12 + 22 = 22 + 12 and,
similarly, ( (2, 1), (1, 2) ) E 7?; however, (1, 2) :0 (2, 1).
The symbol [BB] means that an answer can be found in the Back oJ the Book.
1. [BB] Let B denote the set of books in a college library
and S denote the set of students attending that college.
Interpret the Cartesian product S x B. Give a sensible
example of a binary relation from S to B.
2. Let A denote the set of names of streets in St. John's,
Newfoundland and B denote the names of all the
residents of St. John's. Interpret the Cartesian product
A x B. Give a sensible example of a binary relation
from A to B.
3. Determine which of the properties reflexive, symmetric,
transitive apply to the following relations on the set of
people.
ff 711TI-Im

2.3 Binary Relations 55
(a) [BB] is a father of
(b) is a friend of
(c) [BB] is a descendant of
(d) have the same parents
(e) is an uncle of
4. With a table like that in Fig 2.2, illustrate a relation on
the set la, b, c, d} which is
(a) [BB] reflexive and symmetric
(b) not symmetric and not antisymmetric
(c) not symmetric but antisymmetric
(d) transitive
Include at least six elements in each relation.
5. Let A = {1, 2, 31. List the ordered pairs in a relation on
A which is
(a)
(b)
(c)
(d)
(e)
(f)
(g)
(h)
EBB] not reflexive, not symmetric, and not transitive
reflexive, but neither symmetric nor transitive
symmetric, but neither reflexive nor transitive
transitive, but neither reflexive nor symmetric
reflexive and symmetric, but not transitive
reflexive and transitive, but not symmetric
[BB] symmetric and transitive, but not reflexive
reflexive, symmetric, and transitive
6. Is it possible for a binary relation to be both symmetric
and antisymmetric? If the answer is no, why not? If it
is yes, find all such binary relations.
7. [BB] What is wrong with the following argument which
purports to prove that a binary relation which is sym-
metric and transitive must necessarily be reflexive as
well?
Suppose K is a symmetric and transitive
relation on a set A and let a E A. Then
for any b with (a, b) e KZ, we have also
(b, a) c 1Z by symmetry. Since now we
have both (a, b) and (b, a) in K, we have
(a, a) E K as well, by transitivity. Thus,
(a, a) E KZ, so KR is reflexive.
8. Determine whether or not each of the binary relations
K defined on the given sets A are reflexive, symmetric,
antisymmetric, or transitive. If a relation has a certain
property, prove this is so; otherwise, provide a coun-
terexample to show that it does not.
(a) [BB] A is the set of all English words; (a, b) c Kt
if and only if a and b have at least one letter in
common.
(b) A is the set of all people. (a, b) E K if and only if
neither a nor b is currently enrolled at the Miska-
tonic University or else both are enrolled at MU and
are taking at least one course together.
9. Answer Exercise 8 for each of the following relations:
(a)
(b)
(c)
(d)
(e)
(D.
(g)
(h)
(i)
()
(k)
A = 1, 2}; K = {(I, 2)}.
[BB] A 
1, 2, 3, 4}; K = {(l, 1), (1, 2), (2, 1),
(3, 4)}.
[BB] A = Z; (a, b) c K if and only if ab > 0.
A = R; (a, b) e K if and only if a2 = b2.
A = R; (a, b) E 7Z if and only if a-b < 3.
A = ZxZ; ((a, b), (c, d)) E KR if and only if a-c =
b -
d.
A = N; K is 7.
A = Z; K 
{(x, y) x + y = 101.
[BB] A = R2 ; K 
{((x, y), (u, v)) I x+y < u+v}.
A = N; (a, b) E K if and only if a is an integer.
A = Z; (a, b) e KR if and only if a is an integer.
10. Let S be a set which contains at least two elements a
and b. Let A be the power set of S. Determine which
of the properties-reflexivity, symmetry, antisymmetry,
transitivity-each of the following binary relations K
on A possesses. Give a proof or counterexample as
appropriate.
(a) [BB] (X, Y) E 7Z if and only if X C Y.
(b) (X, Y) E K if and only if X C Y.
(c) (X, Y) e R if and only if X n Y = 0.
11. Let A be the set of books for sale in a certain university
bookstore and assume that among these are books with
the following properties.
Book I Price 
Length
U 
$10 
100 pages
W 
$25 
125 pages
X 
$20 
150 pages
Y 
$10 
200 pages
Z 
$ 5 
100 pages
(a) [BB] Suppose (a, b) E R if and only if the price of
book a is greater than or equal to the price of book
b and the length of a is greater than or equal to the
length of b. Is KZ reflexive? Symmetric? Antisym-
metric? Transitive?
(b) Suppose (a, b) E R if and only if the price of a is
greater than or equal to the price of b or the length
of a is greater than or equal to the length of b. Is K
reflexive? Symmetric? Antisymmetric? Transitive?

56 
Chapter 2 sets and Relations
2.4 
EQUIVALENCE RELATIONS
It is useful to think of a binary relation on a set A as establishing relationships
between elements of A, the assertion "(a, b) C 7R" relating the elements a and b.
Such relationships occur everywhere. Two people may be of the same sex, have
the same color eyes, live on the same street. These three particular relationships
are reflexive, symmetric, and transitive and hence equivalence relations.
S 
S
EXAMPLE 26
EXAMPLE 27
EXAMPLE 28
An equivalence relation on a set A is a binary relation 7? on A which is reflexive,
symmetric, and transitive.
Suppose A is the set of all people in the world and
7R = {(a, b) c A x A I a and b have the same parents}.
This relation is reflexive (every person has the same set of parents as him-
self/herself), symmetric (if a and b have the same parents, then so do b and
a), and transitive (if a and b have the same parents, and b and c have the same
parents, then a and c have the same parents) and so 7? is an equivalence relation.
It may be because of examples like this that it is common to say "a is related to
b," rather than "(a, b) E 1R," even for an abstract binary relation 7?.
If R is a binary relation on a set A and a, b E A, some authors use the
notation a7Rb to indicate that (a, b) e 7?. In this section, we will usually write
a - b and, in the case of an equivalence relation, say "a is equivalent to b." Thus,
to prove that 7? is an equivalence relation, we must prove that R is
reflexive: 
a - a for all a c A,
symmetric: 
if a E A and b E A and a - b, then b - a, and
transitive: 
if a, b, c E A and both a -
b and b - c, then a -
c.
Let A be the set of students currently registered at the University of Southern
California. For a, b E A, call a and b equivalent if their student numbers have the
same first two digits. Certainly a -
a for every student a because any number
has the same first two digits as itself. If a -
b, the student numbers of a and b
have the same first two digits, so the student numbers of b and a have the same
first two digits; therefore, b -
a. Finally, if a - b and b -
c, then the student
numbers of a and b have the same first two digits, and the student numbers of
b and c have the same first two digits, so the student numbers of a and c have
the same first two digits. Since 7? is reflexive, symmetric, and transitive, 7 is an
equivalence relation on A. 
A
Let A be the set of all residents of the continental United States. Call a and b
equivalent if a and b are residents of the same state (or district). The student
should mentally confirm that - defines an equivalence relation. 
A
(Congruence mod 3)5 Define - on the set Z of integers by a -
b if a -b 
is
divisible (evenly) by 3.6 For any a E Z, a -a = 0 is divisible by 3 and so a - a.
5This is an example of an important equivalence relation called congruence to which we later devote
an entire section, Section 4.4.
6Within the context of integers, divisible always means divisible evenly, that is, with remainder 0.

2.4 Equivalence Relations 
57
EXAMPLE 29
If a, b E Z and a - b, then a -b 
is divisible by 3, so b - a (the negative of
a - b) is also divisible by 3. Hence, b - a. Finally, if a, b, c E Z with a - b and
b - c, then both a -b 
and b -c 
are divisible by 3, so a -
c, being the sum of
a - b and b -
c, is also divisible by 3. Thus, -
is an equivalence relation. 
A
The relation < on the real numbers-a -
b if and only if a < b-is not an
equivalence relation on R. While it is reflexive and transitive, it is not symmetric:
4<5 but 5 
4. 
A
Let A be the set of all people. For a, b E A, define a -
b if either (i) both a and
b are residents of the same state of the United States or (ii) neither a nor b is a
resident of any state of the United States. Does - define an equivalence relation?
Surely the three most fundamental properties of equality are
reflexivity:
symmetry:
transitivity:
I 
S
a = a for all a;
if a = b, then b = a; and
if a = b and b =c, then a = c.
Thus, equality is an equivalence relation on any set. For this reason, we think
of equivalence as a weakening of equality. We have in mind a certain characteristic
or property of elements and wish only to consider as different, elements which
differ with respect to this characteristic. Little children may think of their brothers
and sisters as the same and other children as "different." A statistician trying
to estimate the percentages of people in the world with different eye colors is
only interested in eye color; for her, two people are only "different" if they
have different colored eyes. All drop-off points in a given neighborhood of town
may be the "same" to the driver of a newspaper truck. An equivalence relation
changes our view of the universe (the underlying set A); instead of viewing it
as individual elements, attention is directed to certain groups or subsets. The
equivalence relation "same parents" groups people into families; "same color
eyes" groups people by eye color; "same neighborhood" groups newspaper drop-
off points by neighborhood.
The groups into which an equivalence relation divides the underlying set are
called equivalence classes. The equivalence class of an element is the collection
of all things related to it.
If -
denotes an equivalence relation on a set A, the equivalence class of an
element a E A is the set d = {x E A I x - a}. The set of all equivalence classes
is called the quotient set of A mod - and denoted A/-.
Since an equivalence relation is symmetric, it does not matter whether we
write x -
a or a - x in the definition of ai. The set of things related to a is the
same as the set of things to which a is related.
For the equivalence relation in Example 26, the students who are related to a
particular student x are those whose student numbers have the same first two digits
as x's student number. For this equivalence relation, a typical equivalence class (a
typical member of the quotient set) is the set of all students whose student numbers
begin with the same first two digits. The set of all students has been grouped into

58 
Chapter 2 Sets and Relations
smaller sets-the class of 87, for instance (all students whose numbers begin 87),
the class of 90 (all students whose numbers begin 90), and so forth.
In Example 27, if x is a resident of the continental United States, then the
people to whom x is related are those people who reside in the same state or
district as x. The residents of Colorado, for example, form one equivalence class,
as do the residents of Rhode Island, the residents of Florida, and so on. The
quotient set is the set of (forty-nine) American states on the North American
continent, together with the District of Columbia.
What are the equivalence classes for the equivalence relation which is con-
gruence mod 3? What is 0, the equivalence class of 0, for instance? If a - 0,
then a - 0 is divisible by 3; in other words, a is divisible by 3. Thus, 0 is the set
of all integers which are divisible by 3. We shall denote this set 3Z. So 0 = 3Z.
What is 1? If a - 1, then a - 1 = 3k for some integer k, so a = 3k + 1. Thus,
1 = {3k+1 I k E Z}, a set we denote 3Z+1. Similarly, 2 = {3k+2 I k E Z1 = 3Z+2
and we have found all the equivalence classes for congruence mod 3.
Why?
In general, for given natural numbers n and r, nZ + r is the set of integers of
the form na + r for some a c Z:
(5) 
nZ + r = {na + r I a E Z.
Also, we write nZ instead of nZ + 0:
(6) 
nZ = {na aEZ}.
The even integers, for instance, can be denoted 2Z.
What are the equivalence classes for the equivalence relation described in
Pause 11 ? How many elements does the quotient set contain?
PROBLEM 30. 
For (x, y) and (a, v) in R2, define (x, y) - (a, v) if x2 + y2
u2 + v2. Prove that - defines an equivalence relation on R2 and interpret the
equivalence classes geometrically.
Solution. 
If (x, y) C R2, then X2 + y2 = X2 + y 2, So (X, y) - (x, y): The relation
is reflexive. If (x, y) 
- (u, v), then x2 + Y2 = U2 + V2, SO U2 + V2 = X2 + Y2
and (a, v) 
- (x, y): The relation is symmetric. Finally, if (x, y) -
(a, v) and
(u. v) -
(w z). then x 2 +y
2 =u
2 +v 2 and u 2 +
2 = W2+Z2. Thus,X +y2  
=
a2 + v2  
W2 + 2. Since x2 + y2 = W2 + Z2, (x, y) - (w, z), so the relation is
transitive.
The equivalence class of (a, b) is
(a,b) =I(x,y) I (x,y) -(a,b)} 
{(x,y) Ix 2 +y 2 =a 2 +b 2 }.
For example, (1, 0) = {(x, y) I x2 + y2  
12 + 02 = I }, which we recognize as
the graph of a circle in the Cartesian plane with center (0, 0) and radius 1. For
general (a, b), letting c = a2 + b2 , the equivalence class (a, b) is the set of points
(x, y) satisfying x2 + Y2 = c. So this equivalence class is the circle with center
1=
1=

2.4 Equivalence Relations 
59
.. g.6 
S
(0, 0) and radius /. 
With one exception, the equivalence classes are circles with
center (0, 0). 
I
What is the exception?
Let -
denote an equivalence relation on a set A. Let a c A. Then for any x E A,
x - a if and only if x = J.
Proof 
(-) 
Suppose x = a. We know x E x because x - x, so x E a; thus, x - a. It is
the implication 
which is the substance of this proposition.
(-*) Suppose that x - a. We must prove that the two sets x and a- are equal.
As always, we do this by proving that each set is a subset of the other. First
suppose y c Y. Then y - x and x - a, so y - a by transitivity. Therefore, y E ii,
so x C ai. On the other hand, suppose y E a. Then y - a. Since we also have
a -
x, we have both y - a and a - x; therefore, by transitivity, y -
x. Thus,
y E x and ai C T. Therefore, ai = x. 
I
In each of the examples of equivalence relations which we have discussed
in this section, different equivalence classes never overlapped. If a person is a
resident of one state, he or she is not a resident of another. A student number
cannot begin with 79 and also with 84. An integer which is a multiple of 3 is not of
the form 3k + 1. These examples are suggestive of a result which is true in general.
.. g.. 
a
Suppose - denotes an equivalence relation on a set A and a, b c A. Then a- 0 b
if and only if anTb = 0.
Proof 
() 
Suppose a 0 b. We must prove a n b = 0 and offer a proof by contradiction.
Suppose a- n b :A 0. Then there is an element x E a- n b. Since x C a-, x = i
by Proposition 2.4.3. Similarly, since x C b, we also have x = b. Thus, ai =
which is a contradiction.
(Ã·-)Ontheotherhand,if a n b=0, then a E Jbut absoa-7b. 
I
If - denotes an equivalence relation on A, reflexivity says that every ele-
ment a in A belongs to some equivalence class, namely, to Ji. In conjunction with
Proposition 2.4.4, this observation says that the equivalence classes of any equiv-
alence relation divide A into disjoint (that is, nonoverlapping) subsets which cover
the entire set, just like the pieces of a jigsaw puzzle. We say that the equivalence
classes "partition" A or "form a partition of" A. (The word partition is used as
both verb and noun.)
1 
1
EXAMPLES 31
A partition of a set A is a collection of disjoint nonempty subsets of A whose
union is A. These disjoint sets are called cells (or blocks). The cells are said to
partition A.
.
Canada is partitioned into ten provinces and three territories.7
7Nunavut, created from the eastern half of the former Northwest Territories, joined Canada on April 1,
1999.

60 Chapter 2 Sets and Relations
.
Students are partitioned into groups according to the first two digits of their
student numbers.
.
The human race is partitioned into groups by eye color.
.
A deck of playing cards is partitioned into four suits.
.
If A = la, b, c, d, e, f, xl, then {{a, b}, {c, d, e}, {f }, {x}} is a partition of A.
So is {(a, x}, {b, d, e, f }, {c}}. 
A
We have seen that the equivalence classes of an equivalence relation on a set
A are disjoint sets whose union is A; each element a E A is in precisely one
equivalence class, namely, ai. Thus, we have the following basic theorem about
equivalence relations.
The equivalence classes associated with an equivalence
a partition of A.
relation on a set A form
Not only does an equivalence relation
determine a partition, but, conversely, any
partition of a set A determines an equivalence
relation, specifically, that equivalence relation
whose equivalence classes are the cells of the
partition. The partition of the integers into
"evens" and "odds" corresponds to the equiv-
alence relation which says two integers are
equivalent if and only if they are both even
or both odd. The partition
{[a, g}, Ib, d, e, f}, {c}}
a
g
b
d
e
f
C
a 
g 
b 
d 
e 
f 
c
x
x
x
x
x
x
x
x
x
x
x
x
x
x
x
x
x
xx
x
x
of the set {a, b, c, d, e, f, g} corresponds to the equivalence relation whose equiv-
alence classes are {a, g}, {b, d, e, f } and {c}, that is, to the equivalence relation
described in the figure, where a cross in row x and column y is used to indicate
x - y.
The suits "heart," "diamond," "club," "spade" partition a standard deck of playing
cards. Describe the corresponding equivalence relation on a deck of cards.
The correspondence between equivalence relations and partitions provides a
simple way to exhibit equivalence relations on small sets. For example, the equiv-
alence relation defined in Fig 2.3 can also be described by listing its equivalence
classes: {a, b} and {c}.
a 
b 
c
a 
x 
x
b 
x 
x
C 
X
Figure 2.3 
An equivalence relation with two equivalence classes, (a, b) and [c}.
A 
* 
* ** 
-
11. It sure does. First, every person is either a resident of the same state in the
United States as himself/herself or not a resident of any U.S. state, so a - a
S.

2.4 Equivalence Relations 
61
for all a E A: - is reflexive. Second, if a, b E A and a - b, then either a
and b are residents of the same U.S. state (in which case, so are b and a) or
else neither a nor b is a resident of any state in the United States (in which
case, neither is b or a). Thus, b -
a: - is symmetric. Finally, suppose a -
b
and b -
c. Then either a and b are residents of the same U.S. state or neither
is a resident of any U.S. state, and the same holds true for b and c. It follows
that either all three of a, b, and c live in the same U.S. state, or none is a
resident of a U.S. state. Thus, a -
c: - is transitive as well.
12. The equivalence class of 3 is {3k + 3 I k c ZI, but this is just the set 37 of
multiples of 3. Thus 3 = 0. The equivalence class of 4 is (3k + 4 1 k E Z),
but 3k + 4 = 3(k + 1) + 1, so this set is just 3Z + 1, the equivalence class
of 1: 4 = 1. In general, the equivalence class of an integer r is 3Z if r is a
multiple of 3, 3Z + I if r is of the form 3a + 1, and 3Z + 2 if r is of the form
3a + 2. Since every integer r is either a multiple of 3, or 3a + 1 or 3a + 2
for some a, the only equivalence classes are 3Z, 37 + 1 and 3Z + 2.
13. The equivalence class of a consists of those people equivalent to a in the sense
of -. If a does not live in any state of the United States, the equivalence class
of a consists of all those people who also live outside any U.S. state. If a
does live in a U.S. state, the equivalence class of a consists of those people
who live in the same state. The quotient set has 51 elements, consisting of
the residents of the 50 American states and the set of people who do not live
in any U.S. state.
14. The equivalence class of (0, 0) is the set {(0, 0)I whose only element is the
single point (0, 0).
15. Two cards are equivalent if and only if they have the same suit.
The symbol [BB] means that an answer can be found in the Back of the Book.
1. Let A be the set of all citizens of New York City. For
a, b e A, define a - b if and only if
(a) neither a nor b have a cell phone, or
(b) both a and b have cell phones in the same exchange
(that is, the first three digits of each phone number
are the same).
Show that -
defines an equivalence relation on A and
find the corresponding equivalence classes.
2. Explain why each of the following binary relations on
S = {1, 2, 31 is not an equivalence relation on S.
(a) [BB] ? = {(1, 1), (1, 2), (3, 2), (3, 
3), (2, 3), (2, 1))
(b) 
3R 
= {(I,1), (2, 2), (3, 3), (2, l), (1, 2), (2, 3), (3, l),
(1, 3)}
(c) 
1 2 
3
l 
x 
x 
x
2 
x 
x
3 
x
3. [BB] The sets {11, 121, {31, {4}, (5) are the equivalence
classes for a well-known equivalence relation on the
set S = 11, 2, 3, 4, 51. What is the usual name for this
equivalence relation?
4. [BB] For a, b E R \ (01, define a -
b if and only if
ae Q.
(a) Prove that - is an equivalence relation.
(b) Find the equivalence class of 1.
(c) Show that X3 = 
12.

62 
Chapter 2 Sets and Relations
5. For natural numbers a and b, define a - b if and only
if a2 + b is even. Prove that - defines an equivalence
relation on N and find the quotient set determined by -.
6. [BB] For a, b E R, define a - b if and only if a-b E Z.
(a) Prove that - defines an equivalence relation on Z.
(b) What is the equivalence class of 5? What is the
equivalence class of 5 2 9
(c) What is the quotient set determined by this equiva-
lence relation?
7. [BB] For integers a, b, define a - b if and only if
2a + 3b = 5n for some integer n. Show that - defines
an equivalence relation on Z.
8. Define - on Z by a -
b if and only if 3a + b is a
multiple of 4.
(a) Prove that - defines an equivalence relation.
(b) Find the equivalence class of 0.
(c) Find the equivalence class of 2.
(d) Make a guess about the quotient set.
9. For integers a and b, define a - b if 3a + 4b = 7n for
some integer n.
(a) Prove that - defines an equivalence relation.
(b) Find the equivalence class of 0.
10. [BB] For a, b E Z \ (0), define a - b if and only if
ab > 0.
(a) Prove that - defines an equivalence relation on Z.
(b) What is the equivalence class of 5? What's the
equivalence class of -5?
(c) What is the partition of Z \ {0} determined by this
equivalence relation?
11. For a, b E Z, define a - b if and only if a2 - b2 is
divisible by 3.
(a) [BB] Prove that - defines an equivalence relation
on Z.
(b) What is 0? What is 1?
(c) What is the partition of Z determined by this equiv-
alence relation?
12. Determine, with reasons, whether or not each of the
following defines an equivalence relation on the set A.
(a) [BB] A is the set of all triangles in the plane; a - b
if and only if a and b are congruent.
(b) A is the set of all circles in the plane; a -b 
if and
only if a and b have the same center.
(c) A is the set of all straight lines in the plane; a - b
if and only if a is parallel to b.
(d) A is the set of all lines in the plane; a - b if and
only if a is perpendicular to b.
13. List the pairs in the equivalence relation associated with
each of the following partitions of A = {l, 2, 3, 4, 5}.
(a) [BB] {{l, 2], {3, 4, 5})
(b) {{l}, {2}, {3, 4}, {5})
(c) ({1,2,3,4,5}1
14. (a) List all the equivalence relations on the set {a}. How
many are there altogether?
(b) Repeat (a) for the set {a, b}.
(c) [BB] Repeat (a) for the set la, b, cl.
(d) Repeat (a) for the set la, b, c, d}.
(Remark: The number of partitions of a set of n elements
grows rather rapidly. There are 52 partitions of a set of
five elements, 203 partitions of a set of six elements,
and 877 partitions of a set of seven elements.)
15. Define - on R2 by (x, y) - (u, v) if and only if x-y =
U -V.
(a) [BB] Criticize and then correct the following
"proof' that - is reflexive.
"If (x, y) - (x, y), then x -y = x -y,
which is true."
(b) What is wrong with the following interpretation of
symmetry in this situation?
"If (x, y) e IZ, then (y, x) E IZ."
Write a correct statement of the symmetric property
(as it applies to the relation - in this exercise).
(c) Criticize and then correct the following "proof' that
- is symmetric.
"(x, y) 
(u, v) if x-y 
= u-v.
Thenu -v= x -y.So(u,v) 
(x,y)."
(d) Criticize and correct the following "proof' of tran-
sitivity.
"(x, y) - (u, v) and (u, v) - (w, z).
Then u-v=w-z, 
soifx-y=u-v,
thenx -y=w -z. 
So (x,y) 
(w,z)."
(e)
(f)
Why does - define an equivalence relation on R2?
Determine the equivalence classes of (0, 0) and
(2, 3) and describe these geometrically.
16. [BB] For (x, y) and (u, v) E R2 define (x, y) - (u, v)
if and only if x2 -
Y2 = U2 -
V2. Prove that - defines
an equivalence relation on R2. Describe geometrically
the equivalence class of (0, 0). Describe geometrically
the equivalence class of (1, 0).

2.5 Partial Orders 
63
17. Determine which of the following define equivalence
relations in R2. For those which do, give a geometrical
interpretation of the elements of the quotient set.
(a) (a, b) - (c, d) if and only if a + 2b = c + 2d.
(b) (a, b) - (c, d) if and only if ab = cd.
(c) (a, b) - (c, d) if and only if a 2 + b = c + d2 .
(d) (a, b) - (c, d) if and only if a = c.
(e) (a, b) - (c, d) if and only if ab = c2.
18. Let - denote an equivalence relation on a set A. Assume
a, b, c, d e A are such that a E b, c e d, and d E b.
Prove that a = c.
19. [BB] Let A = (1,2,3,4,5,6,7,8,9}. For a,b c A,
define a - b if and only if ab is a perfect square (that
is, the square of an integer).
(a) What are the ordered pairs in this relation?
(b) For each a e A, find a- = (x E A I x - a].
(c) Explain why -
defines an equivalence relation
on A.
20. [BB] In Exercise 19, let A be the set of all natural num-
bers and - be as given. Show that - defines an equiv-
alence relation on A.
21. Repeat Exercise 19 for A = l, 2, 3, 4, 5, 6, 7} and the
a
relation on A defined by a 
- b if and only if -
is a
b
power of 2, that is, a = 2' for some integer t, positive,
b
negative or zero.
22. In Exercise 21, let A be the set of all natural numbers
and - be as given. Show that - defines an equivalence
relation on A.
23. Let R be an equivalence relation on a set S and let
{SI, S2, . . ., S.I be a collection of subsets of S with the
property that (a, b) E R. if and only if a and b are
elements of the same set Si, for some i. Suppose that
for each i, Si i Uj5,i Sj. Prove that [SI, S2 .
St} is
a partition of S.
2.5 
PARTIAL ORDERS
In the previous section, we defined an equivalence relation as a binary relation
which possesses the three fundamental properties of equality-reflexivity, sym-
metry, transitivity. We mentioned that we view equivalence as a weak form of
equality and employed a symbol, -, suggesting "equals." In an analogous manner,
in this section, we focus on three fundamental properties of the order relation <
on the real numbers-reflexivity, antisymmetry, transitivity-and define a binary
relation called partial order, which can be viewed as a weak form of <. We
shall use the symbol < for a partial order to remind us of its connection with
< and, for the same reason, say that "a is less than or equal to b" whenever
a -< b.
A partial order on a set A is a reflexive, antisymmetric, transitive relation on
A. A partially ordered set, poset for short, is a pair (A, -<), where -< is a partial
order on a set A.
Writing a -< b to mean that (a, b) is in the relation, a partial order on A is a
binary relation which is
reflexive:
antisymmetric:
transitive:
a -< a for all a c A,
If a, b E A, a -< b and b -< a, then a = b, and
If a, b, c E A, a -< b and b < c, then a -< c.
It is convenient to use the notation a -< b (and to say "a is less than b") to
signify a -< b, a :A b, just as we use a < b to mean a < b, a :A b. Similarly, the
meanings of a >- b and a >- b should be apparent.

64 
Chapter 2 Sets and Relations
EXAMPLES 32
EXAMPLE 33
I 
S
I 
S
There is little purpose in making a definition unless there is at hand a variety
of examples which fit the definition. Here then are a few examples of partial
orders.
.
The binary relation < on the real numbers (or on any subset of the real
numbers) is a partial order because a < a for all a E R (reflexivity), a < b
and b < a implies a = b (antisymmetry) and a < b, b < c implies a < c
(transitivity).
.
For any set S, the binary relation C on the power set P(S) of S is a partial
order because X C X for any X E P(S) (reflexivity), X C Y, Y C X
for X, Y E P(S) implies X = Y (antisymmetry) and X C Y, Y C Z for
X, Y, Z e P(S) implies X C Z (transitivity). 
A
(Lexicographic Ordering) 
Suppose we have some alphabet of symbols (perhaps
the English alphabet) which is partially ordered by some relation <. By "word,"
we mean any string of letters from this alphabet. For words a = ala2 ... a, and
b =bb2 ..
bm define a -< b if
.
a and b are identical, or
ai -< bi in the alphabet at the first position i where the words differ, or
.
n < m and ai = bi for i = 1, ... , n. (This is the situation where word a,
which is shorter than b, forms the initial sequence of letters in b.)
This ordering of words is called lexicographic because when the basic alphabet
is the English alphabet, it is precisely how words are ordered in a dictionary; car
-< cat < catalog. 
A
The adjective "partial", as in "partial order" draws our attention to the fact
that the definition does not require that every pair of elements be comparable, in
the following sense.
If (A, -<) is a partially ordered set, elements a and b of A are said to be comparable
if and only if either a -< b or b -< a.
If X and Y are subsets of a set 5, it need not be the case that X C Y or
Y C X; for example, {a} and {b, c} are not comparable.
If -< is a partial order on a set A and every two elements of A are comparable,
then -< is called a total order and the pair (A, -<) is called a totally ordered
set.
The real numbers are totally ordered by < because for every pair a, b of
real numbers either a < b or b < a. On the other hand, the set of sets,
I {a}, {b}, {c}, {a, c} I is not totally ordered by C since neither {a} C {b} nor
{b} C {a}.

2.5 Partial Orders 
65
M
an 
1I
3
2'
I'
0O
{a, b}
{a)
{b, c}
{c}
Figure 2.4 
The Hasse diagrams for (JO, 1, 2, 31, <) and (P(la, b, c)), C).
unnecessarily complicated were we to draw all lines from a to b whenever a -< b
instead of just those lines where b covers a. No knowledge of the partial order is
lost by this convention: After all, if a -< b and b -< c, then (by transitivity), a -< c,
so if there is a line from a to b and a line from b to c, then we can correctly infer
that a -< c, from the diagram. For example, in the diagram on the left, we can
infer that 1 -< 3 since I -< 2 and 2 -< 3. In the diagram on the right, we similarly
infer that {b} -< la, b, c}.
Suppose that in some Hasse diagram, a vertex c is "above" another vertex a, but
there is no line from a to c. Is it the case that a < c? Explain.
An element a of a poset (A, -<) is maximum if and only if b -< a for every b E A
and minimum if and only if a -< b for every b E A.
In the poset (P({a, b, cl), C), 0 is a minimum element and the set la, b, c}
a maximum element. In the poset I {a}, {b}, {c), {a, c} I (with respect to C), there
is neither a maximum nor a minimum because, for each of the elements (a}, {b},
{c}, and {a, c}, there is another of these with which it is not comparable.
8There is a fascinating account by S. L. Segal of the ambiguous position in which Hasse found himself
during the Nazi period. The article, entitled "Helmut Hasse in 1934," appears in Historia Mathematica 7
(1980), 45-56.
I 
S
I
Is lexicographic order on a set of words (in the usual sense) a total order?
Partial orders are often pictured by means of a diagram named after Helmut
Hasse (1898-1979), for many years professor of mathematics at Gbttingen.8 In
the Hasse diagram of a partially ordered set (A, <),
.
there is a dot (or vertex) associated with each element of A;
.
if a < b, then the dot for b is positioned higher than the dot for a; and
.
if a < b and there is no intermediate c with a -< c -< b, then a line is drawn
from a to b. (In this case, we say that the element b covers a.)
The effect of the last property here is to remove redundant lines. Two Hasse
diagrams are shown in Fig 2.4. The reader should appreciate that these would be

66 
Chapter 2 Sets and Relations
If a poset has a maximum element, then this element is unique; similarly, a
poset can have at most one minimum. (See Exercise 11.)
One must be careful to distinguish between maximum and maximal elements
and between minimum and minimal elements.
An element a of a poset A is maximal if and only if,
if b c A and a <b, then b = a
and minimal if and only if,
if beAandb 
a, thenb=a.
Thus, a maximum element is "bigger" (in the sense of -<) than every other
element in the set while a maximal element is one which is not less than any
other. Considering again the poset { {a), {b), {c}, {a, c} }, while there is neither a
maximum nor a minimum, each of {a}, {b), and {c} is minimal while both {b}
and {a, c} are maximal.
What, if any, are the maximum, minimum, maximal, and minimal elements in the
poset whose Hasse diagram appears in Fig 2.5?
Figure 2.5
d
.
I 
S
EXAMPLES 34
Let (A, -<) be a poset. An element g is a greatest lower bound (abbreviated glb)
of elements a, b E A if and only if
1. g -< a, g -< b, and
2. if c -< a and c -< b for some c E A, then c -< g.
Elements a and b can have at most one glb (see Exercise 14). When this element
exists, it is denoted a A b, pronounced "a meet b."
An element f is a least upper bound (abbreviated lub) of a and b if
1. a -< l, b -< e, and
2. if a -< c, b -< c for some c E A, then f -< c.
As with greatest lower bounds, a least upper bound is unique if it exists. The lub
of a and b is denoted a V b, "a join b," if there is such an element.
.
In the poset (R, '), the glb of two real numbers is the smaller of the two and
the lub the larger.
â¢ In the poset (P(S), C) of subsets of a set S, AAB = AnB and AvB = AUB.
(See Exercise 12.) Remembering that v means U and A means n in a poset
of sets provides a good way to avoid confusing the symbols v and A in a
general poset. 
A
I 
6
1=

2.5 Partial Orders 
67
EXAMPLE 35
A 
* 
* *
With reference to Fig 2.5, find a v b, a A b, b v d and b A d, if these exist.
A poset (A, -<) in which every two elements have a greatest lower bound in A
and a least upper bound in A is called a lattice.
The posets described in Examples 34 are both lattices.
A
16. Sure it is; otherwise, it would be awfully hard to use a dictionary.
17. We can conclude a -< c only if there is a sequence of intermediate vertices
between a and c with lines between each adjacent pair. Look at the Hasse
diagram (P((a, b, cl), c) in Fig 2.4. Here we have (b, c} above {a), but
{a} I {b, cl because these elements are incomparable. On the other hand,
{a, b, c} is above {a) and we can infer that (al -< {a, b, c} because, for the
intermediate vertex {a, c}, we have upward directed lines from {a} to {a, c}
and from {a, c} to {a, b, c}.
18. There is no maximum but a and b are maximal; d is both minimal and a
minimum.
19. avbdoesnotexist;aAb 
c;bvd=b;bAd=d.
The symbol [BB] means that an answer can be found in the Back of the Book.
1. Determine whether or not each of the following relations
is a partial order and state whether or not each partial
order is a total order.
(a) [BB] For a, b e R, a -< b means a > b.
(b) [BB] For a, b E R, a -< b means a < b.
(c) (R, -<), where a -< b means a2 < b2 .
(d) (N x N, -), where (a, b) -< (c, d) if and only if
a < c.
(e) (N x N, -), where (a, b) -< (c, d) if and only if
a < c and b > d.
(f) (W, <) where W is the set of all strings of letters
from the alphabet ("words" real or imaginary) and
W 
-< W2 if and only if w1 has length not exceeding
the length of w2. (Length means number of letters.)
2. (a) [BB] List the elements of the set {l 1, 1010, 100, 1,
I01, 111, 110, 1001, 10, 1000) 
in 
lexicographic
order, given 0 -< 1.
(b) Repeat part (a) assuming I -< 0.
3. List all pairs (x, y) with x -< y in the partial orders
described by each of the following Hasse diagrams.
(a) [BB] 
d
C (
b o
a 6
(c) 
b 
d
a 
c
(e)
Of
c
e
b 
d
a
(b) [BB] b 
d
ad 
c
(d) b 
c 
d
a
(D c
b
a
h
g

68 
Chapter 2 Sets and Relations
4. [BB; (a), (b)] List all minimal, maximal, minimum,
and maximum elements for each of the partial orders
described in Exercise 3.
5. Draw the Hasse diagrams for each of the following par-
tial orders.
(a) ((1,2, 3, 4, 5, 6}, <)
(b) ({(al,) a,b}, la,b,c}, la,b,c,d}, (a,cl, {c,dll,
C)
6. List all minimal, minimum, maximal, and maximum ele-
ments for each of the partial orders in Exercise 5.
7. [BB] In the poset (P(S), C) of subsets of a set S, under
what conditions does one set B cover another set A?
8. Learn what you can about Helmut Hasse and write a
short biographical note about this person, in good clear
English of course!
9. (a) [BB] Prove that any finite (nonempty) poset must
contain maximal and minimal elements.
(b) Is the result of (a) true in general for posets of arbi-
trary size? Explain.
10. (a) Let A = Z2 and, for a = (al, a2) and b = (by b2)
in A, define a -< b if and only if al < b1 and
al + a2 ' b1 + b2. Prove that < is a partial order
on A. Is this partial order a total order? Justify your
answer with a proof or a counterexample.
(b) Generalize the result of part (a) by defining a partial
order on the set Z" of n-tuples of integers. (No proof
is required.)
11. (a) [BB] Prove that a poset has at most one maximum
element.
(b) Prove that a poset has at most one minimum ele-
ment.
12. Let S be a nonempty set and let A and B be elements of
the power set of S. In the partially ordered set (P(S), C),
(a) [BB] prove that A A B = A n B;
(b) prove that A v B -
A U B.
13. Let a and b be two elements of a poset (A, -<) with
a -< b.
(a) [BB] Show that a v b exists, find this element, and
explain your answer.
(b) Show that a Ab exists, find this element, and explain
your answer.
14. (a) [BB] Prove that a glb of two elements in a poset
(A, <) is unique whenever it exists.
(b) Prove that a lub of two elements in a poset (A, <)
is unique whenever it exists.
15. (a) If a and b are two elements of a partially ordered
set (A, <), the concepts
max(a. b) I 
a ifb -'<a
I b if a < b
and
I a if a -<b
min(ab) = 
b if b -< a
do not make sense unless the poset is totally ordered.
Explain.
(b) Show that any totally ordered set is a lattice.
16. (a) [BB] Give an example of a partially ordered set
which has a maximum and a minimum element but
is not totally ordered.
(b) Give an example of a totally ordered set which has
no maximum or minimum elements.
17. Prove that in a totally ordered set, any maximal element
is a maximum.
18. Suppose (A. -<) is a poset containing a minimum ele-
ment a.
(a) [BB] Prove that a is minimal.
(b) Prove that a is the only minimal element.
M-MoMMIMT-37 a;
1. If A = (x E N I x < 7}, B = {x E Z I Ix-51 < 3} and
C = (2, 3}, find (A (d B) \ C.
2. Let A = (x E Z I 
< x < 2}, B = (2x -3 
x E A)
and C = {x c R I x = aTa E A,b X B}.
(a) List the elements of A, B, and C.
(b) List the elements of (A C B) x B.
(c) List the elements of B \ C.
(d) List the elements of A (d C.
3. Let A, B, and C be sets. Are the following statements
true or false? In each case, provide a proof or exhibit a
counterexample.
(a) A n B = A if and only if A C B.
(b) (AnB)UC=An(BUC).
4. Let A = I I }. Find 'P(P(A)).

Review Exercises 
69
5. Let A, B, C, and D be sets.
(a) Give an example showing that the statement "A e
(B \ C) = (A d B) \ C" is false in general.
(b) Prove that the statement "A C C, B C D -
A x
B C C x D" is true.
6. Give an example showing that the statement "(A x B) C
(C x D) -- A C C and B C D" is false is general.
7. Let A be a set.
(a) What is meant by the term binary relation on A?
(b) Suppose A has ten elements. How many binary rela-
tions are there on A?
8. For a, b E N, define a - b if a < 2b. Determine whether
or not - is reflexive, symmetric, antisymmetric, transi-
tive, an equivalence relation or a partial order on N.
9. Define a relation RZ on Z by a7Rb if 4a + b is a multiple
of 5. Show that K defines an equivalence relation on Z.
10. Define a relation R on Z by aRb if 2a + 5b is a multiple
of 7.
(a) Prove that R defines an equivalence relation.
(b) Is K a partial order? Explain your answer briefly.
11. Let - denote an equivalence relation on a set A. Prove
that x 
a O* x = a for any x, a E A.
12. Let - denote an equivalence relation on a set A. Assume
a, b, c, d E A are such that a E b, d Â¢ c and d E b.
Prove that a- n c = 0.
13. Let A be the set of points different from the origin in the
Euclidean plane. For p, q E A, define p - q if p = q
or the line through the distinct points p and q passes
through the origin.
(a) Prove that - defines an equivalence relation on A.
(b) Find the equivalence classes of -.
14. Show that (P(Z), C) is a partially ordered set.
15. Let A = {1, 2, 4, 6, 8} and, for a, b e A, define a -< b
if and only if b is an integer.
(a) Prove that -< defines a partial order on A.
(b) Draw the Hasse diagram for <.
(c) List all minimum, minimal, maximum and maximal
elements.
(d) Is (A, -<) totally ordered? Explain.
16. Let (A, -<) be a poset and a, b E A. Can a and b have
two least upper bounds? Explain.

~~~~~as 
ol!:
61 
3e 
*
Â¢ 
Â¢ 
* 
S
094 4F nctio sW
3.1 
DOMAIN, RANGE, ONE-TO-ONE, ONTO
Next in importance to the primitive notion of "set" is the idea of "function." This
is a term which nowadays is introduced informally quite early in the mathematics
curriculum. It's often defined as a rule which associates to each element of a
set A (usually a set of real numbers) an element of another set B (often R as
well). The function keys on a calculator are so named because when a number
x is entered into a calculator and a "function key" f is pressed, another number
f(x) appears.' The essential characteristic of a function is that the value which
it associates with a given element is uniquely determined by that element. If we
enter 4 into a calculator and then press some function key, we are presented with
exactly one number, not a choice of several numbers: 4 PI 
= 2, for instance,
not +2.
Here is the formal definition of "function."
A function from a set A to a set B is a binary relation f from A to B with the
property that, for every a c A, there is exactly one b E B such that (a, b) E f. (In
some areas of mathematics, map is a commonly employed synonym forfunction.)
In this definition, the idea that a function should associate with each element
a c A a unique element b c B is captured by viewing a function f as a subset of
A x B with the special property that for each a E A, there is just one pair (a, b)
in f having first coordinate a. If A = 11, 2, 31, B = {x, y} and f is
f = {(1, x), (2, y), (3, x)},
then f is just the rule which associates x with 1, y with 2, and x with 3.
'Here we assume that we haven't entered a number like -I and then pressed the square root key!
71
SIMEMMEM

72 
Chapter 3 Functions
There are two key points about the definition of "function." First, every a
in A must be the first coordinate of an ordered pair in the function. Again with
A -
{1, 2, 3} and B = {x, y}, the set
g = {((, x), (3, y)}
is not a function from A to B because g contains no ordered pair with first
coordinate 2. Second, each element of A must be the first coordinate of exactly
one ordered pair. With the same A and B,
h = {(I, x), (2, x), (3, y), (2, y))
is not a function because 2 is the first coordinate of two ordered pairs.
PROBLEM 1. Suppose A is the set of surnames of people listed in the Salt
Lake City telephone directory. Is it likely that
f = {(a, n) I a is on page n}
is a function from A to the set of natural numbers? Comment.
Solution. 
By definition of f, each element of A is the first coordinate of a pair
in f, so the key question here is whether or not each a E A determines a unique
n E N. Is each surname on a unique page in the telephone directory? This is not
very likely since some surnames (Smith?) are undoubtedly listed on a number of
different pages. It is unlikely that f is a function. 
I
When f is a function from A to B, the element b E B, which is uniquely
determined by the element a E A, is denoted f(a) and called the image of a.
Thus,
(1) 
I 
(a, b) e f if and only if b = f(a).
It is customary to write f: A -* 
B to mean that f is a function from A to B
and to write f: a F-* b to mean that f (a) = b. (Note the differences between the
symbols -* 
between sets, as in A -* 
B, and -* 
between elements, as in a -* 
b.)
Thus, the function f = {(l, x), (2, y), (3, x)} could also be described by
f: 
2 
y
3 
x
although the description as ordered pairs seems simpler.
Sometimes (often in calculus), a function is sufficiently nice that it is possible
to write down a precise formula showing how f(x) is determined by x; for
example, f (x) = x3, f (x) = 3x -7, 
f (x) = ln(x). When we talk about "the
function f(x) = x," we are really talking about that function f: R 
R which
associates with any x E R, its square x2; that is to say, x 
-
x2. As a binary
relation, f = {(x, x2) I x e R}. When this function is graphed as usual in the
xy-plane, we are, in actual fact, making a picture of the ordered pairs which
comprise it.
-
3S

3.1 Domain, Range, One-to-One, Onto 
73
I 
I
EXAMPLE 2
EXAMPLE 3
EXAMPLE 4
Let f: A -* B be a function from A to B.
* The domain of f, written dom f, is the set A.
.
The target of f is the set B.
* The range or image of f, written mg f, is
mg f = {b E B I (a, b) E f for some a E A)
= {b E B I b = f (a) for some a e Al.
* The function is onto or surjective if its range is the target, rmg f = B; that
is, every b E B is of the form b = f(a) for some a E A; equivalently,
|For any b 
B, the equation b = f (x) has a solution x e A.
.
It is one-to-one (1-1) or infective if and only if different elements of A have
different images: in symbols, al = a2 -
f (a ) # f (a2); equivalently (taking
the contrapositive),
If f(al) = f(a2 ), then al = a27.
.
It is a bijection or bijective function if it is both one-to-one and onto.
Some Discrete Examples
Suppose A = (1, 2, 3, 41, B = {x, y, zl and
f = {(1, x), (2, y), (3, z), (4, y)}.
Then f is a function A 
B with domain A and target B. Since rmg f
{x, y, z} = B, f is onto. Since f(2) = f(4) (= y) but 2 =A 4, f is not one-
to-one. [In fact, there can exist no one-to-one function A 
-* B. Why not? See
Exercise 25(a).] 
A
Suppose A 
(1, 2, 31, B = {x, y, z, w} and
f = {(1, w), (2, y), (3, x)}.
Then f: A 
B is a function with domain A and range {w, y, x}. Since mg f #
B, f is not onto. [No function A -* 
B can be onto. Why not? See Exercise 25(b).]
This function is one-to-one because f(1), f(2), and f(3) are all different: If
f(aI) = f(a 2 ), then al = a2. 
A
Suppose A = 11, 2, 31, B = {x, y, z),
f = {(1, z), (2, y), (3, y)I 
and 
g = I(1, z), (2, y), (3, x)}.
Then f and g are functions from A to B. The domain of f is A and dom g = A
too. The range of f is {z, y), which is a proper subset of B, so f is not onto.
On the other hand, g is onto because mg g = {z, y, xl = B. This function is also
one-to-one because g(1), g(2), and g(3) are all different: If g(al) = g(a2), then
al = a2. Notice that f is not one-to-one: f (2) = f (3) (= y), yet 2 $A 3. 
A

74 
Chapter 3 Functions
EXAMPLE 5 
Let f: Z -* 
Z be defined by f(x) = 2x -3. 
Then dom f = Z. To find rng f,
note that
b C rngf 
b = 2a-3 
for some integer a
.(-* b = 2(a -2) + 1 
for some integer a
and this occurs if and only if b is odd. Thus, the range of f is the set of odd
integers. Since mg f :A Z, f is not onto. It is one-to-one, however: If f(xI) =
f (x2 ), then 2x -3 = 2X2 -3 
and x = x2. 
A
EXAMPLE 6 
Let f: N -* N be defined by f(x) = 2x - 3. This might look like a perfectly
good function, as in the last example, but actually there is a difficulty. If we try to
calculate f(1), we obtain f(1) = 2(1) -3 =-I 
and -I Â¢ N. Hence, no function
has been defined. 
A
PROBLEM 7. 
Define f: Z -* 
Z by f (x) = x2 - 5x + 5. Determine whether or
not f is one-to-one and/or onto.
Solution. 
To determine whether or not f is one-to-one, we consider the pos-
sibility that f(xi) = f(x2). In this case, x42- 
5xj + 5 = x2 -
5x2 + 5, so
x2 _ x22 
5X2 and (xI - x2)(xl + x2) = 5(xl -x2). This equation indeed
has solutions with xl 0 x2: Any xI, x2 satisfying xl +x2 = 5 will do, for instance,
x = 2, X2 = 3. Since f(2) = f(3) =- 
1, we conclude that f is not one-to-one.
Is f onto? Recalling that the graph of f(x) = x2-5x + 5, x (E R, is a
parabola with vertex (5, _), 
clearly any integer less than -1 is not in the range
of f. Alternatively, it is easy to see that 0 is not in the range of f because
x2 - 5x + 5 = 0 has no integer solutions (by the quadratic formula). Either
argumentishowsthatfisnotonto.
PROBLEM 8. 
Define f: Z -* 
Z by f (x) = 3x3 -x. Determine whether or not
f is one-to-one and/or onto.
Solution. 
Suppose f(xi) = f(x2) for xi,x2 (E Z. Then 34 -xl = 3x2-x2, so
3(1 
2) = xl-x2 and
2 
2)=X
3(xi -X2)(XI 
+ XIX2+x
2 )= 
x x2.
If x1  
x2, we must have x4I + XIX2 + x2 = 3, which is impossible since xI and
X2 are integers. Thus, xI = x2 and f is one-to-one.
Is f onto? If yes, then the equation b = f(x) = 3x3 -
x has a solution
in Z for every integer b. This seems unlikely and, after a moment's thought, it
occurs to us that the integer b = 1, for example, cannot be written this way:
I = 3x3- x for some integer x implies x(3x 2 -1) 
= 1. But the only pairs of
integers whose product is I are the pairs 1, 1 and -1, -1. So here, we would
require x = 3X2- 
1 = I or x = 3X2 
_ I =-1, neither of which is possible.
The integer b = 1 is a counterexample to the assertion that f is onto, so f is
not onto. 
I
Define g: Z -+ 
Z by g(x) = 2x + 7x. Is g onto? Is g one-to-one'?

3.1 Domain, Range, One-to-One, Onto 
75
Functions of a Real Variable
EXAMPLE 9
Let f: R -Ã· R be defined by f (x) = 2x -3. The domain of f is R and mg f = R
since any real number y can be expressed y = 2x -
3 (for x = '(y + 3)).
Graphically, this means that any horizontal line intersects the graph of y = 2x -3.
(See Fig 3.1.) Since mg f = R, f is onto. It is also one-to-one (the argument in
Example 5 can be used again), so being onto and one-to-one, it is a bijection from
R to R. 
A
Y
I X (x, y)
Figure 3.1 
The graph of y = 2x - 3.
EXAMPLE 10
EXAMPLE 11
EXAMPLE 12
Let g: R -* 
R be defined by g(x) = x2. The domain of g is R; the range of g is
the set of nonnegative real numbers. Since this is a proper subset of R, g is not
onto. Neither is g one-to-one since g(3) = g(-3), but 3 
-3. 
A
Define h: [0, 0o) -* 
R by h(x) = x2. This function is identical to the function g
of the preceding example except for its domain. By restricting the domain of g to
the nonnegative reals we have produced a function h which is one-to-one since
h(xl) = h(x 2) implies x2 = x22 and hence xl = Â±x2. Since xl > 0 and x2 > 0,
we must have xl = X2. 
A
Let f: R -* R be defined by f (x) = 3x
3  
x. Students of calculus should be able
to plot the graph of f and see immediately that f is onto, but not one-to-one.
(See Fig 3.2.) 
A
(1 
2
V
1 _2
(3, -9)
Figure 3.2 
The graph of y = 3x3 -x.
/

76 
Chapter 3 Functions
-
A 
* -
wui :1~~ii:Â±~Im
--
S
Contrast this last example with Problem 8 on page 74. There we saw that the
function with the same rule as the one here but with Z as domain was one-to-one
but not onto. A function is more than a rule; domain and range are critical too.
The absolute value of a number x, denoted IxI, is defined by
Xl = I
x if x > 0
-x if x <0.
The absolute value function is a function with domain R and range [0, 0o) =
{y E R I y > 01. It is not one-to-one because, for example, 121 = I -21.
For any real number x, the floor of x, written LxJ, 
is the greatest integer less
than or equal to x, that is, the unique integer [xJ satisfying
x-1 < Lxj <x.
The ceiling of x, written [x], is the least integer greater than or equal to x, that
is, the unique integer [xl satisfying
x K [xl <x + I.
For instance, L2.01J = 2, L1.99j = 1, L15j = 15, L-2.01 
= -3, and [2.011
[l.991 = 2, [151 = 15, F-2.01] = -2.
-2 
-1
3
2 
0-0
1 
2 
3
-2
-3
Figure 3.3 
The graph of the floor function y = [xj.
By the floor function, we mean the function f: R -# 
R defined by f (x) =
Lxj. (At one time, the floor function was commonly called the greatest integer
function.) Similarly, the ceiling function is the function g: R 
R defined by
g(x) = [xl. The domain of these functions is R and both have range Z. The graph
of the floor function is shown in Fig 3.3.
Functions whose graphs resemble the floor function are encountered fre-
quently. In January 2001, the Canadian post office set rates for mail within Canada
as shown in Table 3.1. The graph of this postal function would certainly resemble
the floor function, with jumps at 30, 50, 100, and 200 gms.
The Identity Function
The special function we now define looks innocuous and it is, but it arises in so
many situations that it is helpful to give it a name.
3,

3.1 Domain, Range, One-to-One, Onto 
77
Table 3.1 
2001 Canadian postal rates.
Weight w (gms) 
Cost
w < 30 
$0.47
30 < lv < 50 
$0.75
50 < w < 100 
$0.94
100 < w < 200 
$1.55
200 < w < 500 
$2.05
M 
0
MMM
For any set A, the identity function on A is the function tA: A -* 
A defined by
tA(a) = a for all a E A. In terms of ordered pairs,
1A = {(a, a) I a E Al.
When there is no possibility of confusion about A, we will often write A. rather
than tA. (The Greek symbol t is pronounced "yjta", so that "1A" 
is read "yota
sub A."
The graph of the identity function on R is the familiar line with equation
y = x. The identity function on a set A is indeed a function A -* 
A since, for
any a c A, there is precisely one pair of the form (a, y) E t, namely, the pair
(a, a).
Prove that the identity function on a set A is one-to-one and onto.
1. Since the graph of g(x) = 2x2 + 7x, x E R, is a parabola, g is not onto.
To determine whether or not g is one-to-one, we must see if g(xl) = 9(X2)
implies that xI must equal x2. Suppose g(xl) = g(x2). Then 2x 2 + 7xi =
2x22+7X2 and so 2(xl 
x2)(xI +x2) = 7(x 2 -xI). If 
xI =A x2 , then xl +x2 =
-7 
which is impossible for xI, X2 E Z. Thus, xl = x2; g is one-to-one.
2. If t(al) = t(a2), then a] = a2 (since Â£(al) = a, and t(a2) = a2), so I is
one-to-one. To show it is onto, we have to show that the equation a = t(x)
has a solution for any a. It is evident that x = a works.
The symbol [BB] means that an answer can be found in the Back of the Book.
1. Determine whether or not each of the following relations
is a function with domain ( l, 2, 3, 43. For any relation
that is not a function, explain why it isn't.
(a) [ B B 
2 
f = (2(, 3), (2,1), (3,1), (4,1), (3, 3)1
(b) f = ((I, 2), (2, 3), (4, 2))
(c) [BB] f = ((1, 1), (2, 1), (3, l), (4, l)}
(d) f = ((1, 1), (1, 2), (l, 3), (1, 4)}
(e) f = ((l, 4), (2, 3), (3, 2), (4, 1))
2. Suppose A is the set of students currently registered at
the University of Calgary, B is the set of professors at the
University of Calgary, and C is the set of courses currently
being offered at the University of Calgary. Under what
conditions is each of the following a function?
0 *V14 
:R, Is] 611

78 
Chapter 3 Functions
(a) [BB] {(a, b) i a is taking a course from b}
(b) {(a, c) I a's first class each week is in c}
(c) {(a, c) I a has a class in c on Friday afternoon}
Explain your answers.
3. [BB] Suppose A and B are nonempty sets. Can A x B
ever be a function A -* 
B? Explain.
4. Give an example of a function N -- N which is
(a) [BB] one-to-one but not onto;
(b) onto but not one-to-one;
(c) neither one-to-one nor onto;
(d) both one-to-one and onto.
5. Let X be the set of all countries in the British Common-
wealth and Y be the set of all people who live in these
countries.
(a) [BB] Show that Prime Minister: X 
--. 
Y and
Domicile: Y -* 
X are functions.
(b) Show that Prime Minister is one-to-one but not onto.
(c) Show that Domicile is onto but not one-to-one.
6. [BB] Give examples of some common functions whose
graphs resemble the graph of the floor function.
7. Let S = {1, 2, 3, 4, 5} and define f: S- 
Z by
(x) -
X2 + 
if x is even
l 2x -5 
if x is odd.
Express f as a subset of S x Z. Is f one-to-one?
8. The addition and multiplication of real numbers are
functions add, mult: R x R -* 
R, where
add(x, y) = x + y; 
mult(x, y) = xy.
(a) [BB] Is add one-to-one? Is it onto?
(b) Is mult one-to-one? Is it onto?
Explain your answers.
9. [BB] Define g: Z 
-* 
B by g(x) = Jxl + 1. Deter-
mine (with reasons) whether or not g is one-to-one and
whether or not it is onto in each of the following cases.
(a) B 
Z 7
(b) B 
N
10. Define f: A -- A by f(x) = 3x + 5. Determine (with
reasons) whether or not f is one-to-one and whether or
not f is onto in each of the following cases.
(a) EBB] A 
Q
(b) A = N
11. Define h: A 
-* 
A by h(x) = x2 + 2. Determine (with
reasons) whether or not h is one-to-one and whether or
not h is onto in each of the following cases.
(a)A = Z
(b) A = N
12. Define g: A -* 
A by g(x) = 3x 2 + 14x -51. 
Deter-
mine (with reasons) whether or not g is one-to-one and
whether or not g is onto in each of the following cases.
(a) A 
Z
(b) A 
R
13. Define f: A 
B by f (x) = x2 + 14x- 
51. Deter-
mine (with reasons) whether or not f is one-to-one
and whether or not it is onto in each of the following
cases.
(a) [BB] A = N, B = lb E Z I b >-O00)
(b) A = Z, B as in (a)
(c) A = R, B = {b E R I b > -00}
14. Find the domain and range of each of the given functions
of a real variable. In each case, determine whether or
not the function is one-to-one and whether or not it is
onto.
(a)
(b)
(c)
(d)
[BB] f: R -- R defined by f (x) = x3.
g: R 
R defined by g(x) = xlxl.
/3: (4, oc) 
R defined by ,8(x) = log2 (3x
f: R -R defined by f(x) = 2X-1 + 3.
4).
15. (a) [BB] Define f: R -- R by f(x) = 3x 3 +x. Graph f
in order to determine whether or not f is one-to-one
and/or onto.
(b) [BB] Define f: Z -+ 
Z by f (x) = 3x 3 + x. Deter-
mine (with reasons) whether or not f is one-to-one
and/or onto.
16. (a) Define g: R- 
R by g(x) = x 3 -x + l. Graph g in
order to determine whether or not g is one-to-one
and/or onto.
(b) Define g: Z -* 
Z by g(x) = x 3 -
x + 1. Determine
(with reasons) whether or not g is one-to-one and/or
onto.
(c) Repeat (b) for the function g: N -* 
N defined by
g(x) =x3- x+ 1.
17. Determine whether or not each of the following defines
a one-to-one and/or an onto function. Either give a proof
or exhibit a counterexample to justify every answer.
(a) [BB] f (n, m) = 2n + 3m; f : N x N -* 
N
(b) [BB] J(n, m) = 2n + 3m; f: Z x Z 
Z
(c) f (n, m) 
14n + 22m; f: N x N -N
(d) f (n, m) 
89n + 246m; f: Z x Z -* 
Z [Hint:
I = (- 17)(246) + 47(89).]
(e) f(it,m)=n 2 +in
2 +1;f:ZxZ- 
N
(f) f(n,m) = L,'j + 1; f: N x N-* N

3.2 Inverses and Composition 
79
18. For each of the following, find the largest subset A of
R such that the given formula for f (x) defines a func-
tion f with domain A. Give the range of f in each
case.
(a) [BB] f (x) = x-3
(b) f (x) -
1a
19. In each of the following cases, explain why the given
function is not one-to-one. Then restrict the domain of
the function to as large a set as possible so as to make
a one-to-one function.
(a) f = {(a, o), (b, 8), (c, y), (d, a))
(b) [BB] f: R -+ 
R defined by Jf(x)
12x - 9
(c) f: R -* R defined by f (x) = sinx
-4x2 +
20. Let S be a set containing the number 5. Let A = {f:
S -* 
S} be the set of all functions S -* 
S. For f, g X A,
define f - g if f (5) = g(5).
(a) Prove that - defines an equivalence relation on
A.
(b) Find the equivalence class of f = {(5, a), (a, b),
(b, b)} in the case S = (5, a, b).
21. Let A be a set and let f: A -* 
A be a function. For
x, y E A, define x 
y if f(x) = f(y).
(a) Prove that - is an equivalence relation on A.
(b) For A = R and f (x) = Lxj, find the equivalence
classes of 0, 5, and -4
(c) Suppose A = (1, 
2, 3, 4, 5, 6 and
f = ((1, 2), (2, 1), (3, 1), (4, 5), (5, 6), (6, l)}.
Find all equivalence classes.
22. [BB] Let X = (a, b} and Y = (l, 2, 3.
(a) List all the functions from X to Y and Y to X.
(b) List all the one-to-one functions from X to Y and
Y to X.
(c) List all the onto functions from X to Y and Y
to X.
23. Let X = {a, b, c} and Y = (I, 2,3, 4}.
(a) How many one-to-one functions are there from X
Y and Y -e X? In each case, list all the func-
tions.
(b) How many onto functions are there X 
-* 
Y and
Y -* 
X? In each case, list all the functions.
24. [BB] Given sets X and Y with JXJ = m and JYI = n,
guess a general formula for the number of functions
X -. Y. (A table showing the possible values for each
possible pair m, n E {1, 2, 3, 4} may be helpful.)
25. Suppose A and B are sets, A containing n elements and
B containing m elements.
(a) If n > m, prove that no function A 
B can be
one-to-one.
(b) If m > n, prove that no function A 
B can be
onto.
26. (a) [BB (-a)] Suppose that A and B are sets each con-
taining the same (finite) number of elements and that
f: A -* 
B is a function. Prove that f is one-to-one
if and only if f is onto.
(b) Give an example of a one-to-one function N -* N
which is not onto. Does this contradict (a)? Explain.
(c) Give an example of an onto function N -* 
N which
is not one-to-one. Does this contradict (a)? Explain.
27. [BB] Let f: R -Ã· R be defined by f (x) = x + [xj.
(a) Graph this function.
(b) Find the domain and range of I.
28. Define s: R -* 
R by s(x) = x -
Lxi. Is s one-to-one?
Is it onto? Explain.
3.2 
INVERSES AND COMPOSITION
The Inverse of a Function
Suppose that f is a one-to-one onto function from A to B. Given any b E B,
there exists a C A such that f (a) = b (because f is onto) and only one such
a (because f is one-to-one). Thus, for each b E B, there is precisely one pair
of the form (a, b) E f. It follows that the set {(b, a) I (a, b) E f}, obtained by
reversing the ordered pairs of f, is a function from B to A (since each element
of B occurs precisely once as the first coordinate of an ordered pair).

80 
Chapter 3 Functions
EXAMPLE 13 
If A = {1, 2, 3, 4} and B = {x, y, z, t}, then
f = {(I,x), (2, y), (3, z), (4, t)I
is a one-to-one onto function from A to B and, reversing its pairs, we obtain a
function B -* A: {(x, I), (y, 2), (z, 3), (t, 4)}. 
A
I 
S
EXAMPLE 14
..-eg 
M
A function f: A -- B has an inverse if and only if the set obtained by reversing
the ordered pairs of f is a function B -* A. If f: A 
B has an inverse, the
function
::0:ff 
'-{:: 4(b,at4)lda, b)E(If }
is called the inverse of f.
We pronounce f - , "f inverse," terminology which should not be confused
with ': f 
is simply the name of a certain function, the inverse of f 2
If f: A -Ã· B has an inverse f 
1 B -
A, then f 
also has an inverse
because reversing the pairs of f - I gives a function, namely f: thus, (f 
)- 
= f
If A = {1, 2,3, 4} and B = {x, y, z, t}, and
f = {(1, x), (2, y), (3, z), (4, t)}
then
f- 
(x, 1), (y, 2), (z, 3), (t, 4)}
and (f 
') 
' = {(I, x), (2, y), (3, z), (4, t)} = f. 
A
At the beginning of this discussion, we saw that any one-to-one onto function
has an inverse. On the other hand, suppose that a function f: A 
-* 
B has an
inverse f -l: B -- A. Then f must be onto for, given b E B, there is some pair
(b, a) E f 
I (since dom f 
-
B), and so the pair (a, b) is in f. Moreover, f
must be one-to-one.
Why?
So we have the following proposition.
A function f: A -- B has an inverse B -* 
A if and only if f is one-to-one and
onto.
For any function g, remember that (x, y) E g if and only if g(x) = y; in
particular, (b, a) E f -
if and only if a = f 
1(b). Thus,
a = f- 
(b) -+(b, a) E f 
-* 
(a, b) E f f 
(a) = b.
2Readers may wonder whether or not it is ever possible for ] 
and 
to coincide. Indeed it is, and this
observation led to an article by R. Cheng, A. Dasgupta, B. R. Ebanks, L. F. Larson, and R. B. McFadden,
"When Does f } 
?," American Mathematical Monthhl 
105 (1998), no. 8, 704-717.

3.2 Inverses and Composition 
81
The equivalence of the first and last equations here is very important:
a = f -(b) 
if and only if f(a) l 
b. 
I
EXAMPLE 15
EXAMPLE 16
EXAMPLE 17
For example, if for some function f, 7r = f 
(-7), then we can conclude
that f (r) = -7. If f (4) = 2, then 4 = f- 1(2).
The solution to the equation 2x = 5 is x = 
= 2-1 5. Generally, to solve
the equation ax = b, we ask if a :7 0, and if this is the case, we multiply each
side of the equation by a- , obtaining x = a- 
b 
Since all real numbers
except 0 have a multiplicative inverse, checking that a 4 0 is just checking that
a has an inverse.
Look again at statement (2). We solve the equation f(x) = y for x in the
same way we solve ax = b for x. We first ask if f has an inverse, and if it does,
apply f - to each side of the equation, obtaining x = f -(y).
The "application" of f- 1 to each side of the equation y = f (x) is very much
like multiplying each side by f- . "Multiplying by f- 1 may sound foolish, but
there is a context (called group theory) in which it makes good sense. Our intent
here is just to provide a good way to remember the fundamental relationship
expressed in (2).
If f: R 
R is defined by f(x) = 2x -3, then f is one-to-one and onto, so an
inverse function exists. According to (2), if y = f -(x), 
then x = f (y) = 2y -3.
Thus, v = 
(x + 3) = f- 
(x).
Let A ={x R I x < 0}, B = (x c R I x > 01 and define f: A 
B by
f(x) = x2. This is just the squaring function with domain restricted so that it
is one-to-one as well as onto. Since f is one-to-one and onto, it has an inverse.
To obtain f -(x), 
let y = 
- 1(x), deduce [by the relationship expressed in (2)]
that f(y) = x and so y2 = x. Solving for y, we get y = Â±H17. Since x = f(y),
y E A, so y < 0. Thus, y = -A/; f -(x) =--I.
Denoting the positive real numbers by RÂ±, let f: R -* 
R+ be defined by f(x)
3X Since f is one-to-one and onto, it has an inverse. To find f- 
1(x), let y
f - 1(x) and write down its equivalent form, x = f(y) 
3'. Solving for y, we
get y = log3 x. Sof (x) = log3x. 
A
4x
PROBLEM 18. 
Let A = {x I x $ 
1} and define f: A 
R by f(x)=
2 1
Is f one-to-one? Find rng f. Explain why f: A 
rng f has an inverse. Find
domf -, rngf -, 
and a formula for f -(x).
Solution. 
Suppose f(al) = f(a 2 ). Then 
ai 
4a2 
so 0ala2 -4al
2alh-T1 
2a2T-hi 
t
8a Ia2 -4a2, hence alI = a2. Thus f is one-to-one.
(2)

82 
Chapter 3 Functions
Next,
y E rng f < y = f (x) 
for some x c A
4x
there is an x E A such that y = 2x - I
there is an x E A such that 2xy - y = 4x
there is an x E A such that x(2y -4) = y.
If y = 2, the equation x (2y -4) = y becomes 0 = 2 and no x exists. On the other
hand, if y # 2, then 2y -4 0 0 and so, dividing by 2y -4, we obtain x = 2y -4
(It is easy to see that such x is never 2; that is, x c A.) Thus y c mg f if and
only if y 
2. So rng f = B ={y E R y 
2}.
Since f: A -* 
B is one-to-one and onto, it has an inverse f 
:B -Ã· A.
Also, domf- 
= rngf = B and rng f 
1- 
domf = A. To find f 
(x), set
y = f - 1(x). Then
4v
x = (y) = 2y -
1
and, solving for y, we get Y = 2 
4 = - (x).
The following important property of f -1 will be used in Section 3.3.
I
"SS 
S
I 
S
EXAMPLE 19
If f: A -* 
B is one-to-one and onto, then f 
: B -* A is also one-to-one and
onto.
Prove Proposition 3.2.3.
Composition of Functions
If f: A -* B and g: B -* 
C are functions, then the composition of g and f is
the function go a : A -* 
C defined by (g o f)(a) = g(f(a)) for all a E A.
If A = {a,b,c, B = {x,y), and C = {u, v, w}, andiff : A -
B andg: B -* 
C
are the functions
f = {(a, x), (b, y), (c, x)}, 
g = {(x, u), (y, w)},
then
(g o f)(a) = g(f(a)) = g(x) = 
-,
(g o f)(b) = g(f(b)) = g(y) = w,
(g a f)(c) = g(f(c)) = g(x) = u
and so g of = {(a, u), (b, w), (c, u)).
A
It is seldom the case that g o f = f o g. In this last example, for instance,
f o g is not even defined. We must be careful then to distinguish between "the
composition of g and f" and "the composition of f and g."

3.2 Inverses and Composition 
83
EXAMPLE 20
If f and g are the functions R -* 
R defined by
f(x) = 2x-3, 
g(x) = x2 + 1,
then both g o f and f o g are defined and we have
(g o f)(x) = g(f(x)) = g(2x-3) = (2x - 3)2 + 1
and
(f o g)(x) = f(g(x)) = f (X2 + 1) = 2(x2 + 1) -3.
EXAMPLE 21
A
In the definition of g o f, it is required that mg f C B = domig. If f: R -+ 
R
and g: R \ (1} -* 
R are the functions defined by
f(x) =2x-3 
and 
g(x) = x-1
then g o f is not defined because mg f = R g dom g. On the other hand, f o g
is defined and
(f o g)(x) = 2( X 
) - 3.
EXAMPLE 22
-Z11MITR
S1gI
A
If f: A -+ 
A is any function and c denotes the identity function on A, then f o I is
a function A -* A. Also, for any a E A, (f o 0)(a) = f(t(a)) = f(a). Similarly,
(to f)(a) = f (a) for any a E A. Thus, f ot = f 
to f. It is for just this reason
that t is called the identity function on A; it behaves with respect to o the way
the number I behaves with respect to multiplication. 
A
Under what conditions are two functions f and g equal? Since a function is
a set and two sets are equal if and only if they contain the same elements, it must
be that f = g if and only if it is the case that
(a, b) c f if and only if (a, b) c g.
Suppose f = g and a c domf. Then (a,b) E f for some b 
f (a), so
(a,b) c g. Thus, a C domig and b = g(a). This shows that domf C doing
and, for every a E dom f, f(a) = g(a). Reversing the roles of f and g, we
see similarly that domig C domf and g(a) = f(a) for every a E doing. We
are led to the following necessary and sufficient condition for the equality of
functions.
Functions f and g are equal if and only if they have the same domain, same
target, and f(a) = g(a) for every a in the common domain.
Notice how we proved that ft Of = 
in Example 22. We noted that each of the
functions f o t and f has domain A and target A and proved that (f 
) (a) = f(a)
for all a E A.
Suppose f: A -* 
B is a function. Explain why tB o f = f
One of the fundamental properties of composition of functions is the content
of the next proposition.

84 
Chapter 3 Functions
....
g
Proof
..... 
0
Composition of functions is an associative operation.
We must prove that (f o g) o h = f o (g o h) whenever each of the two functions-
(f o g) o h and f o (g o h)-is defined. Thus, we assume that for certain sets A,
B, C, and D, h is a function A -* B, g is a function B -* 
C, and f is a function
C -+ D. A direct proof is suggested.
Since the domain of (f o g) o h is the domain of f o (g o h) (namely, the set
A), we have only to prove that ((f o g) o h)(a) = (f o (g o h))(a) for any a E A.
For this, we have
((f o g) o h) (a) = (f o g)(h (a)) 
f (g(h(a)))
and
(f o (g o h))(a) = f ((g o h)(a)) 
f (g(h(a)))
as desired. 
I
If f: A -* 
B has an inverse f 
B -- A, then, recalling (2),
f 
'(b) = a if and only if b = f (a).
So for any a e A,
a = f 
(b) = f 
(f (a)) = f 
o f (a).
In other words, the composition f 
o f = tA, the identity function on A. Simi-
larly, for any element b E B,
b= f(a)= f(f 
(b)) = 
f 
'o 
f-(b).
Thus, the composition f of- 
= tB is the identity function on B. We summarize.
Functions f: A -* 
B and g: B -* 
A are inverses if and only if g 
f = 1A and
f o g = tB; that is, if and only if
g(f (a)) = a and f (g(b)) = b 
for all a E A and all b c B.
PROBLEM 23. 
Show that the functions f: R -* 
(1, oc) and g: (1, oc) 
-* 
R
defined by
f (x) = 32x + 1, 
g(x) = 2-log3 (x -
1)
are inverses.
Solution. 
For any x E R.
(go f)(x) = g(f(x)) =g(3
2 x + 1)
= 1(l0g3 [(32 x + I) -1])
= 2(1og3 32 )
12x = x

3.2 Inverses and Composition 
85
and for any x E (1, oc),
(ft 0 g)( 
= P9(0~) = PI2 10g3(X -0))
= 32( 10og 3(X -)) 
+ I
= 3 1og 3(X -) 
+ I = (x - 1) + 1 = x.
By Proposition 3.2.7, f and g are inverses.
I
We have noted the similarity in the solutions to the equations ax = b and
f (x) = y. If a (or f) has an inverse, we multiply by this inverse and obtain x =
a - i b (or x = f - l(y)). It is interesting also to observe that the connection between
a and its inverse a 
(their product is 1) is strikingly similar to the connection
between f and its inverse f -
(their composition is the identity function).
3. Suppose f(aI) = f(a2) for some al, a2 E A. Let b = f(a1) (= f(a2 )).
Then (al, b) and (a2, b) are both in f, so (b, al) and (b, a2) are both in f- 
.
But f -1 is a function and so each element of B occurs just once as the first
coordinate of an ordered pair in f - . It follows that al = a2; f is one-to-one.
4. To show that f 
is one-to-one, assume f -(bI) 
= f 
1(b2). Setting al 
-
f -(bl) 
and a2 = f- 
(b2), we have al = a2. Therefore, bl = f(al) =
f(a 2 ) = b2. To show that f 
is onto, let a E A. Then f(a) = b c B, so
a = f -(b) 
as desired.
5. Since f: A 
-+ 
B and lB: B -* B, the composition tB of is a function
A -) B. Thus, domtB of = A = domf and target f = target LB of = B.
Also, for any a E A, lB o f(a) = IB(f(a)) = f(a), because f (a) E B and
lB(b) = b for all b E B. Thus, the functions 1B o f and f are equal.
The symbol [BB] means that an answer can be fund in the Back of the Book.
1. [BB] Let A = (l, 2, 3, 4, 5}. Find the inverse of each of
the following functions f: A -# 
A.
(a) f = {(1, 2), (2, 3), (3, 4), (4, 5), (5, 1)}
(b) f 
{(1, 2), (2, 4), (3, 3), (4, 1), (5, 5)1
2. Graph each of the following functions and find each
inverse. Specify the domain and range of each inverse.
(a) [BB] f: R -
R given by f (x) = 3x + 5
(b) f: R -R 
given by f (x) = x 3 -2
(c) /: (4, oC) -* 
R given by /3(x) = log2 (3x -4)
(d) g: R -* 
R given by g(x) = xlxJ
3. Show that each of the following functions f: A 
R
is one-to-one. Find the range of each function and a
suitable inverse.
(a) [BB]A ={xER|x4},,f(x)=l+
(b) A= {x ER I x :-l)}, 
f(x) = 
Â±- 
l
(c) A= {x ER I x :#2-' 
f(x) = 2x
x -3
(d) A = {x e R I x t-3}, f(x) = 
3
4. Define f: Z-- N by f (x)= 
2xÂ± 1 if x < 0
(a) Show that f has an inverse.
(b) Find f-1(2586).
-
. ..
aBiwD1RS
x-4
ff MMMMM

86 
Chapter 3 Functions
5. Suppose A is the set of all married people, mother: A -*
A is the function which assigns to each married per-
son his/her mother, and father and spouse have similar
meanings. Give sensible interpretations of each of the
following:
(a) [BB] mother o mother
(b) mother o father
(c) father o mother
(d) mother o spouse
(e) spouse o mother
(f) father D spouse
(g) spouse o spouse
(h) (spouse o father) o mother
(i) spouse o (father o mother)
6. Let S= {1,2,3,4,5} and T ={ 
I,2,3,8,9} and define
functions f: S -* 
T and g: S -* 
S by
f {(,8), (3, 9), (4, 3), (2, 1), (5, 2)} and
g 
{(1, 2), (3, 1), (2, 2), (4, 3), (5, 2)1.
(a) [BB] Find fog or explain why fo g is not defined.
Repeat for g o f, f o f, and g og.
(b) Which of f, g are one-to-one? Which are onto?
Explain.
(c) Find f 
'if it exists. If it doesn't, explain why not.
(d) Find g-1 if it exists. If it doesn't, explain why not.
7. Let S = {I, 2, 3, 4} and define functions f, g: S 
S
by
f = {(, 3), (2, 2), (3, 4), (4, 1)} and
g = {(l, 4), (2, 3), (3, 1), (4, 2)}.
Find
(a) [BB] g-1 o f og
(b) f og 
o 
og
(c) go fog-
(d) gog-' o f
(e) f-I og- 'Of og
8. [BB] Let f, g and h: R -Ã· R be defined by
f(x) =x +2, 
g(x) = 
2 
, 
h(x) = 3.
Compute g o f (x), f o g(x), h o g o f (x), g o h o f (x),
go f 
l of(x), and f- 
ogof(x).
9. Let A be the set A = {x e R I x > O} 
and define
f; g, h: A -- R by
f(x) 
, 
g(x) 
- , 
h(x) = x + 1.
x + 
Ix
Find g o f(x), f o g(x), h o g o f(x), and f o g o h(x).
10. [BB] Let f: R -- R be a function, let c be a real number,
and define g: R 
R by g(x) = x -c. 
Explain how the
graphs of f and g o f are related.
11. Let f: R -* 
R be a function, let c be a real number,
and define g: R 
R by g(x) = x -c. 
Explain how the
graphs of f and f o g are related.
12. Let f: R -* 
R be a function and let g: R -* 
R be
defined by g(x) =-Jxl.
(a) [BB] How are the graphs of f and f o g related?
(b) How are the graphs of f and g o f related?
13. Let A denote the set R \ {O, 1}. Let l denote the
identity 
function on A 
and define the functions
f, g, h, s, r: A -- A by
f(x)= 1 -, 
g(x)=
X 
I -X
h (x) = -x
x
r(x) = 
, 
s(x) = I -x.
xlI
(a) Show that f o g = l and g o r = s. Complete the
table, thereby showing that the composition of any
two of the given functions is one of the given five,
or the identity. 3
11 l 
f 
g 
h 
r 
s |
(b) Which of the given six functions have inverses?
Find (and identify) any inverses which exist.
14. Let A = {1, 2, 3} and define fl, f2, f3, f4, 15: A -
A
as follows:
fi -
{((, 1), (2, 3), (3, 2)}
= {(L, 3), (2, 2), (3, 1)}
13 
{(1, 2), (2, 1), (3, 3)1
T4 = {(1, 2), (2, 3), (3, 1)}
5 ={(l, 3), (2, 1), (3, 2)}.
3The table you will construct in this exercise is the multiplication table for an important mathematical object known as a group. This particular
group is the smallest one which is not commutative.

(a) Show that each composite function fi o fj is one of
the given functions, or the identity, by completing a
table like the following one.4 For example, if 12 o
f3 = f4, the entry in row f2, column f3, should
be f4.
a Fn t fl 
1 
o2 
f3 
14 
15
12
1'3
(b) Find the inverses of those of the six functions in (a)
which have inverses.
15. Let S = 11,2, 3,4, 51 and let f,g,h: S -* 
S be the
functions defined by
f = {(1, 2), (2, 1), (3, 4), (4, 5), (5, 3))
g {(I, 3), (2, 5), (3, 1), (4,2), (5, 4)}
h = {(1, 2), (2, 2), (3, 4), (4, 3), (5, 1)).
(a) [BB] Find fog and gof. Are these functions equal?
(b) Explain why f and g have inverses but h does not.
Findf - 'and g 1.
(c) Show that (f o g)- 
=g-1 o 
' 
o g-
to
16. [BB] Let A = {x e R I x + 2} and B = {x E R I x = 11.
Define f: A -> B and g: B -* 
A by
x
fW =x -2'
2x
g(x) =X- 
Ix
(a) Find (f o g) (x).
(b) Are f and g inverses? Explain.
17. Let A be a subset of R and suppose f: A -* 
A is a
function with the property that f -(x) 
= -
for all
f (x)
(a)
(b)
A.
Show that 0 Â¢ A.
Show that f 4 = t A, the identity function on A. (By
f4, we mean f o f o f a f.)
3.3 One-to-One Correspondence; Cardinality 87
18. Suppose f: A -* 
B and g: B -* 
C are functions.
(a) [BB] If g o f is one-to-one and f is onto, show that
g is one-to-one.
(b) If g o f is onto and g is one-to-one, show that f is
onto.
19. (a) [BB] Prove that the composition of one-to-one func-
tions is a one-to-one function.
(b) Show, by an example, that the converse of (a) is not
true.
(c) Show that if g o f is one-to-one, then f must be
one-to-one.
20. (a) Prove that the composition of onto functions is onto.
(b) [BB] Show, by an example, that the converse of (a)
is not true.
(c) Show that if g o f is onto, then g must be onto.
21. [BB] Is the composition of two bijective functions bijec-
tive? Explain.
22. Define f: Z -* Z by
J 
f(n) 
n-2 
n > 1000
f f f(f(n+4)) n < 1000.
(a) Find the values of f(I000), f(999), f(998),
f(997), and f(996).
(b) Guess a formula for f (n).
(c) Guess the range of f.
23. Show that the function f: R -. R defined by f(x) -
x
is one-to-one.
X 2 + 2
Find rng f and a suitable inverse.
24. Let t: R -* R be the function defined by t(x) =
2Lxj -x.
(a) Graph t and use this to decide whether or not t has
an inverse.
(b) [BB] Prove that t is one-to-one without using the
graph of t.
(c) Prove that t is onto without using the graph of t.
(d) Find a formula for t- (x).
3.3 
ONE-TO-ONE CORRESPONDENCE AND THE CARDINALITY OF A SET
In this section we think about the size of a set, or, more correctly, its "cardinality."
We show that our natural instincts about the relative sizes of finite sets can be
4As with Exercise 13, this table also describes the multiplication for the smallest group which is not commutative.

88 
Chapter 3 Functions
I 
S
EXAMPLES 24
extended to allow the comparison of infinite sets too, though sometimes with
surprising results. It turns out, for example, that the natural numbers and the set
of all rational numbers have the same "size," whereas both these sets are "smaller"
than the set of real numbers.
In discussions about cardinality, it is common to employ the term one-to-one
correspondence rather than its synonym, one-to-one onto function. Either of the
statements
"A and B are in one-to-one correspondence" or
"There is a one-to-one correspondence between A and B"
means that there is a one-to-one onto function f from A to B. Recall from
Section 3.2 that this implies there is also a one-to-one onto function from B to
A, namely, f 1.
A finite set is a set which is either empty or in one-to-one correspondence with
the set {1, 2, 3, . . , n} of the first n natural numbers, for some n E N. A set which
is not finite is called infinite.
If A is a finite set and A 4 0, then, for some natural number n, there exists a
one-to-one onto function f: {1, 2, 3, .
n. -n} A. Letting f(i) = ai, this means
that A = {al, a2, .a}.
If A is a finite set, the cardinality of A is the number of elements in A; this
is denoted IAl. Thus, 01 = 0 and, if A 
a 
{al, a2, 
an), then IA= n.
* I{a,b,x}I = 3,
.
the letters of the English alphabet comprise a set of cardinality 26,
.
[{x E R [x2+ I =U}l =Â° 
A
How might we determine if two finite sets contain the same number of ele-
ments? We could count the elements in each set, but if the sets were large, this
method would be slow and highly unreliable. Confronted with two enormous pails
of jelly beans and asked to determine if the number of jelly beans in each pail is
the same, the best strategy would be to pair the beans in the two pails. Remove
one jelly bean from each pail and lay the two aside; remove another jelly bean
from each pail, lay these aside, and so on. If the last jelly beans in each pail are
removed together, then certainly we would know that the numbers in each pail
were the same.
If the numbers are the same, the set of pairs of beans removed from the pails
defines a one-to-one onto function from the jelly beans in one pail to those in
the other. Different beans in the first pail are paired with different beans in the
second (one-to-one) and every bean in the second pail is paired with some bean
in the first (onto).
If two finite sets A and B have the same cardinality-we write IA I B I-
then there is a one-to-one onto function from A to B. Conversely, if there is a
one-to-one onto function from A to B, then JAI = IBI. This idea allows us to
extend the notion of "same size".

3.3 One-to-One Correspondence; Cardinality 
89
I 
S
EXAMPLES 25
Sets A and B have the same cardinality and we write Al = IBI, if and only if
there is a one-to-one correspondence between them; that is, if and only if there
exists a one-to-one onto function from A to B (or from B to A).
.
a -+ x, b -+ y is a one-to-one correspondence between {a, b} and {x, y];
hence, l{a, b}l = I{x, YHI (= 2).
.
The function f: N 
) N U {O} defined by f(n) = n - 1 is a one-to-one
correspondence between N and N U {O}; so INI = IN U {O}1.
* The function f: Z 
> 2Z defined by f (n) = 2n is a one-to-one correspon-
dence between the set Z of integers and the set 2Z of even integers; thus, Z
and 2Z have the same cardinality. 
A
Many people find the second and third examples here surprising and perhaps
mildly disconcerting; nevertheless, they must be accepted. Remember that our
definition of "same cardinality" coincides with what we know to be the case with
finite sets.
We can prove that {a, b} and {x, y} have the same cardinality (without using
the word "two") by pairing the elements in the two sets
a -*x, 
ba-*y
and this is exactly how we argue, for instance, that Z and 2Z have the same
cardinality. We pair 0 with 0, 1 with 2, -1 with -2, 2 with 4, -2 with -4, n
with 2n.
Many readers of this book will be familiar with the graph of the function
R -* 
R defined by f(x) = 2X. This is a one-to-one function and its range is
the set R+ of positive reals. We conclude that the real numbers and the positive
real numbers have the same cardinality. In fact, the real numbers have the same
cardinality as any interval, for example, the interval (0, 1). (Exercise 12(c) shows
that any open interval has the same cardinality as (0,1).)
PROBLEM 26. 
Show that the set R+ of positive real numbers has the same
cardinality as the open interval (0, 1) = {x c R I 0 < x < 1}.
Solution. 
Let f: (0, 1) -* 
R+ be defined by
f(x) 
-1.-
We claim that f establishes a one-to-one correspondence between (0, 1) and R+.
To show that f is onto, we have to show that any y E R+ is f(x) for some
x E (0,1). But
1 
1
y = -- 
implies x
x 
1 Â±+y
which is in (0,1) since y > 0. Therefore,
y e R+ implies y = f (
1
)

90 
Chapter 3 Functions
so f is indeed onto. Also, f is one-to-one because
f(xl) = 
(x2)-- 
I 
-1
Xl 
X2
1 
1
Xl 
X2
XI 
X2.
Just as the notion of cardinality partitions finite sets into classes (each class
consisting of sets with the same number of elements), so cardinality also partitions
infinite sets. In this book, we consider just two classes of infinite sets.
A set A is countably infinite if and only if {AI = IN I and countable if and only if
it is either finite or countably infinite. A set which is not countable is uncountable.
The symbol No (pronounced "aleph naught") has traditionally been used to
denote the cardinality of the natural numbers. Thus, a countably infinite set has
cardinality to. As the name suggests, countably infinite sets are those whose
elements can be listed in a systematic and definite way, because to list them is
to rank them as first, second, third, and so on, and this ranking establishes the
required one-to-one correspondence with N.
PROBLEM 27. 
Show that IZI = to
Solution. 
The set of integers is infinite. To show they are countably infinite, we
list them: 0, 1, -1, 2, -2, 3, -3, .
This list is just f (l), f (2), f (3), ... where
f: N -* 
Z is defined by
n 
if n is even
f (n) { 2(n-1) if n is odd,
which is certainly both one-to-one and onto. 
I
Can you express this function f with a single equation?
When we say list "in a systematic and definite way" we mean that when
one person terminates the list (with three dots), another should be able to con-
tinue. In a good list, it should be possible to determine the position of any ele-
ment. It is not acceptable to "list" the integers as 0, 1, 2, 3, .
-. 
,-I,-2, -3,...
because -1 does not have a position: 0 is the first number, 1 is the second, but
in what position is -1? 
Similarly, it is not acceptable to "list" the integers as
. ..,-3, -2,- 1, 0,1 , 2, 3, . . . because no integer has a position. What's the first
element in the list? In fact, this is not a list at all. On the other hand, listing the
integers this way-0, 1, -1, 2, -2, 3, -3, . .. -assigns 
every integer a definite
position.
S 
SD-
-MMM

3.3 One-to-One Correspondence; Cardinality 
91
Figure 3.4
In the list 0, 1, -1, 2, -2, 3, -3, . . ., -
is the third number and 3 is the sixth.
In what position is 1003? What number is in position 1003?
The following argument establishes the remarkable fact that the set N x N =
{(m, n) I m, n E N) is countable; it has the same cardinality as N.
PROBLEM 28. 
Show that IN x N = JNj.
Solution. 
The elements of N x N can be listed by the scheme illustrated in
Fig 3.4. The arrows indicate the order in which the elements of N x N should
be listed-(I, 1), (2, 1), (1, 2), (1, 3), (2, 2), .... Wherever the arrows terminate,
there is no difficulty in continuing, so each ordered pair acquires a definite
position. 
I
(1,4) (2,4) 
(3,4) 
(4,4)
(1,3) 
(2,3) 
(3,3) 
(4,3) 
...
T \X 
\
(1,2) 
(2,2) 
(3,2) 
(4,2) 
...
(11(,)(3,1)+(4,1) 
(5,1) 
...
The elements of N x N can be systematically listed by starting at (1, 1) and following the
arrows.
In Fig 3.4 suppose we write the positive rational n at the point (m, n). Then
n
every rational number appears in the picture, actually many times over, since, for
instance, 2 appears beside the points (2, 3), (4, 6), (6, 9), (40, 60), and so on. By
ignoring the repetitions of a given fraction, the set of positive rationals can be
enumerated. We conclude that the set of positive rationals is a countable set.
The scheme which we have just described for listing the positive rationals begins
1, 2, 1, 1 (ignore the number 2, which has already been listed), 3, 4, 3 2 I
Continue the list in order to determine the position of 34'
Not so long ago, there came to light another way to establish a one-to-one
correspondence between the positive rationals and N. For a very neat and direct
approach to an interesting problem, see Exercise 35 of Section 4.3.
This result is astonishing when you consider how much "bigger" than the
natural numbers the set of positive rationals "seems." It is nonetheless true that
these infinite sets have exactly the same cardinality. Actually, more is true. Since
we are able to list the positive rational numbers-al, a2, a3, . .. -it becomes easy
to list all the rational, simply by intertwining the positive and negative rational,
like this-0, al, -al, a2, -a2, a3, .
What do we conclude? The entire set Q of
rational numbers is countable!
In the enumeration of the rationals just described, in what position is 3 ?
4.'

92 
Chapter 3 Functions
At this point, we might be tempted to conjecture that every set is countable,
but such is indeed not the case! We present another old and well-known argument
which shows that the set of real numbers is not countable. Actually it shows that
the set (0,1) = {x E R I 0 < x < 1) of real numbers between 0 and 1 is not
countable. It then follows that R cannot be countable because if it were, so also
would the subset (0, 1) because a subset of a countable set is countable. (See the
remarks at the end of this section.)
PROBLEM 29. 
Show that (0, 1) is uncountable.
Solution. 
The argument we present is a splendid example of a proof by contra-
diction.
Suppose that there does exist a list al, a2, a3, . . . of all the real numbers
between 0 and 1. Write each of these numbers in decimal form, agreeing to write
0.200... rather than 0.199..., for example, so that the same number does not
appear twice. Our list would look like this:
al = 0.allal2al3al4
a2 = 0.a21a22a23a24...
a3 = 0.a3Ja32a33a34 ..
and remember, every real number between 0 and 1 is supposed to be here. We
can, however, write down a number which is guaranteed not to be in the list.
Look at aIi. If all = 1, let bI = 2; otherwise, let b1 = I. Next look at a22. If
a22 = 1, let b2 = 2; otherwise, let b2 = 1. Then look at a33, in general continuing
down the diagonal of the following square array
al I a12 a13
a21 a22 a23
a31 a32 a33 ...
and defining
bI 2 if aii = I
I 
if aii 7& 1.
Thus, bi is always different from aii. Consider the number b = O.bIb 2b3 ...
Since each bi is 1 or 2, b = 0.000... = 0 and b 0 0.999... = 1. Thus, b is in
the interval (0, 1), so it must be ai, for some i. But b : al since b differs from
al in the first decimal place, b 0 a2 since b differs from a2 in the second decimal
place and, generally, b 0 ai since b differs from ai in the ith decimal place. The
hypothesis that the reals in (0, 1) are countable has led us to a contradiction, so
the hypothesis is false. The real numbers are not countable. 
I
The "diagonal" argument just sketched, due to the great German mathemati-
cian Georg Cantor (1845-1918), should be read several times. It is ingenious and

3.3 One-to-One Correspondence; Cardinality 
93
*1I
A 
* 
* * 
-
certainly not the sort of thing most of us would think up by ourselves. Here's the
important thing to remember, though. Many infinite sets are countable-the natu-
ral numbers, the integers, the rationals-but there are some sets which are much
bigger (the real numbers for instance). Infinite sets come in different "sizes," just
as do finite sets.
At this point, some readers may wonder if there are any subsets of the real
numbers whose cardinality lies between that of N and R. This is a very good
question! In work for which he was awarded a Fields Medal5 in 1966, Paul Cohen
showed that the usual axioms of set theory do not give enough information to settle
it. As a consequence, mathematicians sometimes add the Continuum Hypothesis,
first formulated by Cantor, to these basic axioms.
There is no set A with No < JAl < IR1.
This is the first time we have used the inequality symbol < with infinite sets.
While we have defined the notion of "same cardinality", we have not discussed
the possibility of one infinite set being "smaller" than another. For any two sets A
and B, we define [AI < IBI if and only if there is a one-to-one function A -* B,
and IAI < IBI if IA! < IBI but IAJI = IjB. It is not hard to see that this agrees with
intuition on finite sets, so it is a reasonable definition. The problem, however, is
to prove that if IAI < IBI and IBI < IAl, then IAI = IBI. This is easy if A and B
are finite, but the deep "SchrOder-Bernstein" theorem for infinite sets.
We conclude with two remarks which you are encouraged to remember and
use freely in the exercises which follow.
1. A subset of a countable set is countable.
Why? In this section, we showed that the set of positive rationals is countable
by taking the listing of all fractions suggested by Fig 3.4 and omitting repe-
titions. In a similar way, if B is a subset of a countable set A, the elements
of B can be enumerated by taking a listing of A and omitting those elements
which are not in B.
2. The concept of "same cardinality" is an equivalence relation on sets, in
particular, it is transitive. (See Exercise 10.)
It follows that if we want to prove that a certain set A is countable, for
instance, it is sufficient to show that A has the same cardinality as some other
set which is known to be countable. Similarly, if we want to prove that a set
is uncountable, it is enough to show that it has the same cardinality as a set
which we know is uncountable.
6. f (n) = 
+ (-1)'(2n -
1)]
7. In the listing of the integers, natural number k comes in position 2k and
integer -k in position 2k + 1. Thus, 1003 comes in position 2006 and the
number in position 1003 is -501.
5A Fields Medal is the highest honor which can be bestowed upon a mathematician. There is no Nobel
Prize in mathematics.

94 
Chapter 3 Functions
8. The listing 1, 2, 1, 1 3 43 .
.
.1, 5, 6, 2 3- 
.
Th2u is2i 
3p4ito 
1
Thus, 3 is in position 15.
9. The rational are listed 0, 1, -1, 2,
the list.
-2, 
2 
.- 
*-- . The number 3 is 30th in
The symbol [BB] means that an answer can be found in the Back of the Book.
1. [BB] An enormous crowd covers the field of a base-
ball stadium for a rock concert. Suggest an easy way to
determine whether or not the size of the crowd exceeds
the number of available seats in the stadium.
2. [BB] At first glance, the perfect squares- 
, 4, 9, 16
25, ... -seem 
to be a very sparse subset of the natu-
ral numbers. Galileo, however, argued that there were
as many perfect squares as there are natural numbers.
What was his reasoning likely to have been?
3. Find a one-to-one correspondence between each of the
following pairs of sets:
(a) (x, y, {a, b, c)} and {14, -3, t}
(b) 2 Z and 17Z
(c) [BB] N x N and la + bi X C I a, b E NJ
(d) N and {I 2' m E N, n = 1, 21
4. Find the inverse of the function f: N -* 
Z defined in
Problem 27.
5. (a) Suppose f: N -* 
Z is a one-to-one onto function.
Prove that the function g: N x N -* 
N x Z defined
by g(m, n) = (m, f (n)) is one-to-one and onto.
(b) Find a one-to-one correspondence between N x N
and N x Z.
6. [BB] True or false and explain: If A C B, then JAI and
JB! do not have the same cardinality.
7. Suppose S is a set and for A, B E P(S), we define
A -< B to mean JAI < Bl. Is this relation a partial
order on P(S)? Explain.
8. Show that for any sets A and B, lA x B! = IB x Al.
9. [BB] Let X, Y and Z be sets.
(a) True or false: (X x Y) x Z = X x (Y x Z). Provide
a proof or give a counterexample.
(b) Find a one-to-one correspondence (X x Y) x Z
X x (Y x Z).
10. Prove that the notion of same cardinality is an equiv-
alence relation on the family of all sets. Explain, with
reference to Definition 3.3.2.
11. (a) [BB] Find a one-to-one correspondence between the
intervals (1, so) and (3, oo). What do you con-
clude about the cardinalities of (1, oc) and (3, oo)?
[Recall that (a, oc) = {x I x > a). See Defini-
tion 2.2.3.]
(b) Let a and b be real numbers. Find a one-to-one
correspondence between (a, oc) and (b, cc).
12. (a) [BB] Prove that the intervals (0,1) and (1, 2) have
the same cardinality.
(b) Prove that (0, 1) and (4, 6) have the same cardinal-
ity.
(c) Prove that any two open intervals (a, b) and (c, d)
have the same cardinality.
13. (a) [BB] Prove that the intervals (0, 1) and (10, oc)
have the same cardinality.
(b) Prove that the intervals (2, 5) and (10, so) have the
same cardinality.
(c) Prove that the intervals (a, b) and (c, oc) have the
same cardinality. Assume a < b.
14. Let a and b be real numbers with a < b. Show that the
set R+ of positive real numbers has the same cardinality
as the open interval (a, b) = {x E R I a < x < bl.
15. [BB] Prove that the function defined by f (x) = 3
establishes a one-to-one correspondence between the
real numbers R and the positive real numbers R+. What
can you conclude about cardinality?
16. [BB] Prove that R and the interval (a, b) have the same
cardinality. Assume a < b.
17. Prove that each of the following sets is countable by
listing its elements in a systematic and definite way.
(Show at least the first dozen terms of your lists.)
ff WITTIM 
__

Review Exercises 
95
(a) all positive and negative integer powers of 2
(b) those natural numbers which leave a remainder of
I when divided by 3
(c) N x (1,2,3}
(d) [BB] those positive rational numbers n-with n odd
(e) N x Z
(f) Z X Z
18. Determine, with justification, whether each of the fol-
lowing sets is finite, countably infinite, or uncountable:
(a) [BB] {x E R I I < x < 2)
(b) {x E Q I < x < 2}
(c) {' I 
m, n E N, 
m < 100, 5 < n < 105)
(d) {I 
m, n E Z, m < l00, 5 < n < 105}
(e) [BB] {a + bi e C l a, b E N}
(f) {(a, b) E Q x Q I a + b = I}
(g) {(a, b) E R x R I b = 
a2
19. Which of the following sets is finite, which is countably
infinite, which is uncountable? Explain your answers.
(a) the set of grains of sand on a beach
(b) {3f l 
n c Z}
(c) the set of words in the English language
(d) the set of sentences in the English language
20. Give an example of each of the following or explain
why no example exists.
(a) [BB] an infinite collection of finite sets (no two the
same) whose union is finite
(b) a finite collection of finite sets whose union is infi-
nite
(c) [BB] an infinite collection of infinite sets whose
union is finite
21. [BB] Let SI and S2 denote spheres of radii I and 100,
respectively. Prove that the points on the surface of SI
and those on the surface of S2 are sets with the same
cardinality.
22. [BB] Let S be an infinite set and let x be an element not
in S. Prove that S and S U {x} are sets of the same car-
dinality. (You may assume that S contains a countably
infinite subset.)
23. Prove that the points of a plane and the points of a
sphere are sets of the same cardinality.
24. [BB] Suppose A is a finite set and B is a countably
infinite set and that A n B = 0. Show that A U B is
countably infinite.
25. (a) Show that if A and B are countable sets, then so is
A x B.
(b) Show that the set of all polynomials of degree at
most one with integer coefficients is countable.
x -
I
26. Prove that the function defined by f'(x) = 
2
x(x -
1)
defines a one-to-one correspondence from (0, 1) to R.
27. Prove that for any set X, the cardinalities of X and P(X)
are different.
28. Let S be the set of all real numbers in the interval (0, 1)
whose decimal expansions are infinite and contain only
3 and 4-for example, 0.343434... and 0.333... , but
not 0.34 = 0.34000... . Prove that S is uncountable.
29. Let S be the set of all real numbers in the interval (0, 1)
whose decimal expansions involve only 0 and 1. Prove
that S is uncountable.
30. What is the Fields Medal and after whom was it named?
Write a short note about this prize and its founder.
.* , 
j* 
j 
,I 
ai. 
* I
1. Let f = {(l, 2), (2, 3), (3, 4), (4, 1)} and g = {(I, 3),
(2, 1), (3, 4), (4, 2), (5, 1)1. Find j-1 and g o f. Is g
one-to-one? Explain.
2. Let f: Z -- Z be defined by f(m) = 31mI + 1. Is f
one-to-one? 
Is f 
onto? Give 
reasons 
for 
your
answers.
3. Define f': Z -*Z by f(x) = 2x 3 + x. Show that f is
one-to-one but not onto.
4. Can a function be a reflexive relation? Explain.
5. Is it possible for a function f: R -* 
R to be symmet-
ric as a relation? Give an example or explain why the
answer is no.
6. Is it possible for a function f: R -* R to be transitive as
a relation? Give an example or explain why the answer
is no.
7. Answer true or false and justify your answers.
(a) For real numbers x and y, lxI = y2 
x = YW-
(h) For real numbers x and y, x = sisi -
xl = y2
(c) For real numbers x and y, xl = y 
.yJ x = ylYl

96 
Chapter 3 Functions
8. Find subsets A and B of R, with A as large as possible,
such that f: A -
B defined by f (x) = x 2 + 4x -7 is
one-to-one and onto.
9. Suppose f: 
A -- 
B and g: B 
-* 
C are functions.
If g o f is one-to-one and f is onto, show that g is
one-to-one.
10. Let IAl = n and IBI = m for n,rm e N. Use the
definition of cardinality of a finite set to show that if
A n B = 0, then lA U BI = n + m.
11. Show that the open intervals (1, 3) and (0, oc) have the
same cardinality.
12. (a) Let S be the set of all real numbers in the interval
(0, l) whose decimal expansions contain only O's,
2's and 7's. Prove that S is uncountable.
(b) Let S' be the elements of S (defined in (a)) whose
decimal expansions contain only finitely many 2's
and 7's. What is the cardinality of S'?

A 
B 
U- 
"Ds
0~"
.
.
o 
.
\ 
I
* 
.
*1
0
0 
*. 
*WUFlj
4
The Integers
a 
* 
-
4.1 
THE DIVISION ALGORITHM
What are some of the important properties of the real numbers? Most of us learned
early in life that they have a definite order. Later, we met the symbol <, whose
properties are best summarized by saying that it is a partial order; that is, the
binary relation < is
reflexive:
antisymmetric:
transitive:
a <a for all a E R.
if a <b and b <a for a, b c R, then a = b, and
if a < b and b < c, for a, b, c E R, then a < c.
(See Section 2.5.)
Readers should ensure that they agree with the following inequalities:
-15 < -8 < -- 
<
3 
-3
rim U 
J .l 1  :i I*te] -
 
3
1 
22
-0.3 < -
< -0.
2 5 <0< I< 3.14 < ff<- <4.
Which of the < signs in the preceding list could be changed to the strict
inequality <? The answer is all of them, except for -
< -0.25. Since -
=
44
-0.25, the strict inequality-- < -0.25 
is not true. Is it clear why each of the
remaining < signs could be replaced by < signs?
Why is- 
< -0.3? Why is 3.14 < 7r < 22?
We can add two real numbers a and b and obtain their sum a + b, or we can
multiply two real numbers a and b and obtain their product a . b (usually written
ab, without the centered dot). These operations of addition and multiplication
satisfy a number of important properties, the last three of which relate to order.
Let a, b, and c be real numbers. Then
1. (closure) a + b and ab are both real numbers.
2. (commutativity) a + b = b + a and ab = ba.
97
.0:'
.
I 
.

98 
Chapter 4 The Integers
3. (associativity) (a + b) + c = a + (b + c) and (ab)c = a(bc).
4. (identities) a + 0 = a and a 1 = a.
5. (distributivity) a(b + c) = ab + ac and (a + b)c = ac + bc.
6. (additive inverse) a + (-a) = 0.
7. (multiplicative inverse) a(a) -1 if a 0 0.
8. a < b implies a + c < b + c.
9. a < b and c > 0 implies ac < bc.
10. a < b and c < 0 implies ac > bc.
A third well-known operation, subtraction, is defined in terms of addition by
the rule
a-b=a+(-b).
It is not unusual for a set of real numbers to have no smallest element; for
example, there is no smallest element in the set {2' 
, , 5, ... }. Similarly, there
is no smallest positive number. On the other hand, this sort of thing does not
occur with sets of natural numbers, according to the Well-Ordering Principle.
Any nonempty set of natural numbers has a smallest element.
In the rest of this section, we concentrate on the integers. All the properties
of paragraph 4.1.1 hold for the integers, in most instances because they hold for
all real numbers. One exception is the closure property, which simply says that
the sum and product of integers are integers. We also say that the integers are
closed under addition and under multiplication. Not all sets of real numbers are
closed under these operations; for instance, the set of odd integers is not closed
under addition since, for example, 1 + 3 = 4, which is not odd.
Is the set of negative integers closed under multiplication? Is the set of natural
numbers closed under multiplication? Is the set of natural numbers closed under
subtraction?
When some of us were school children, division of 58 by 17 was performed
with a configuration like this,
3
17 58
51
7
which served to illustrate that the answer is "3 remainder 7." When 58 is divided
by 17, the quotient is 3 and the remainder is 7; equivalently,
58 = 3(17) + 7.
It is also true that 58 = 2(17) + 24, but we were taught that the remainder must
be less than the divisor. We now prove that this sort of division is always possible
and, moreover, the quotient and the remainder are unique.
M419
Uzilill"IIUR
MM

Proof
Figure 4.1
ENUMMMEME
S 
0
4.1 The Division Algorithm 99
Given natural numbers a and b, there are unique nonnegative integers q and r,
with 0 < r < b, such that a = qb + r.
Consider the sequence of nonnegative multiples of b; that is, 0 . b = 0, I . b = b,
2. b = 2b, 3 b = 3b, .... The first term in this increasing sequence of numbers is
0, which is less than a since a is a natural number. On the other hand, some term is
bigger than a [for example, (2a)b > a because 2b > 1], so, by the Well-Ordering
Principle, the set of multiples of b which exceed a has a smallest element, say
(q + l)b. So we have qb < a < (q + 1)b. (See Fig 4.1.) Set r = a -qb. 
Since
qb < a, we have r > 0. Since (q + I)b > a, we have r < b. Hence, 0 < r < b,
and we have found q and r as required.
I 
I 
I[)
0 
b 
2b 
qb 
(q + 1)b
a
To see that q and r are unique, assume that a can be expressed in the given
form in two ways; that is, suppose that a = q1b + rl and a = q2b + r2 with
0 < rl < b and 0 < r2 < b. Then (qi -q2)b = r2 -rl. 
Now (qj -q 2 )b is an
integral multiple of b, while -b < r2 - ri < b. The only possibility is that this
multiple is 0, and so qj = q2, rl = r2 as desired. 
I
If a and b are natural numbers and a = qb + r for nonnegative integers q and r
with 0 < r < b, the integer q is called the quotient and the integer r is called the
remainder when a is divided by b.
When a and b are both positive and a is divided by b, it is useful to note
that the quotient is the integer part of the number displayed by a calculator used
to divide a by b. (The remainder is a - qb.)
PROBLEM 1. Find the quotient q and the remainder r and write a = qb + r
when a = 19 is divided by b = 7. Find the quotient and remainder when 589,621
is divided by 7893 and when 11,109,999,999 is divided by 1111.
Solution. 
When 19 is divided by 7, the quotient is 2 and the remainder is 5. We
have 19 = 2(7) + 5.
Dividing 589,621 by 7893, one author's calculator displayed 74.701761. Thus,
q = 74 and r = 589,621 - 74(7893) = 5539.
For the last part of the question, we have to be a little resourceful since one of
the numbers here is too large for the author's unsophisticated calculator! Instead,
we note that
1 1, 1 09,999,999 = I 1, 1 10,000,000 -
1
= 1 11 1 (10,000,000) - I

100 
Chapter 4 The Integers
= 1111(9,999,999+ 1) - I
= 1111(9,999,999) +-I 1110.
So the quotient is 9,999,999 and the remainder is 1110.
I
With only slight modifications, Theorem 4.1.3 can be generalized to situations
where a and b are integers, not just natural numbers. Note, however, that in order
to preserve the uniqueness of q, the possibility b = 0 must be excluded.' (Also,
in this case, the condition 0 < r < b would be impossible to meet.)
Let a, b c Z, b =# 0. Then there exist unique integers q and r, with 0 < r < Ibl,
such that a = qb + r.
Proof 
In Theorem 4.1.3, we proved this in the case where a and b are both positive.
If a = 0, then q = 0, r = 0 gives a solution. We will consider the other cases
individually.
Case 1: b > 0 and a < 0.
Since -a > 0, we can apply Theorem 4.1.3 to -a 
and b obtaining q and r,
with 0 < r < b, such that -a = qb + r. Therefore, a = (-q)b -r. If r = 0,
a = (-q)b, while if r > 0, a = (-q-l)b+(b -r) with 0 < b -r < b = Ibl.
In either case, we have expressed a in the desired form.
Case 2: b < 0 and either a > 0 or a < 0.
Here -b > 0, so Theorem 4.1.3 and Case I tell us that there exist integers q
and r, 0 < r < -b = MI, such that a = q(-b) + r = (-q)b + r. Again we
have expressed a in the desired form.
The proof of uniqueness follows as in Theorem 4.1.3.
EXAMPLE 2
I
Chapter 8 of this book is devoted to the subject of algorithms. Here, we
simply remark that algorithm means "definite procedure" and that the theorem
known as the Division Algorithm takes its name from the fact that there is a
definite procedure for determining q and r, given a and b. For a, b > 0, q -
Lab
is the integer part of a and r = a -qb, 
as illustrated in Problem 1. For possibly
negative a and/or b, the procedure is given in Proposition 4.1.6.
Verify that a = qb + r in each of the following cases and, in the process, notice
that q is not always what we might expect.
a 
b 
q 
r
58 
17 
3 
7
58 
-17 
-3 
7
-58 
17 
-4 
10
-58 
-17 
4 
10
A
When a is written in the form a = qb + r, with 0 < r < 
Ibl, we shall show
that q is the floor or ceiling of " according as b is positive or negative. (The floor
'Division by 0 always causes problems!
.
S.

4.1 The Division Algorithm 
101
*e 
S
Proof
EXAMPLE 3
and ceiling functions were defined in paragraph 3.1.6.) In the preceding table, for
instance, when a = -58, b = 17, L-58/17i = L-3.41 ... J = -4, 
the value
recorded for q. When a =-58, b = -17, F-58/ -
171 = F3.411 = 4, again the
recorded value of q.
If a = qb + r, with 0 < r < Ibl, then
q L[J if b > 0
i F' I if b < 0.
We consider the case b > 0 and leave the other possibility to the exercises. By
definition, x -1 < Lx] < x for any x. Let x = a and k = Lxj. Then
a 
a
-- 1 < k < -
b 
-b
Multiplying by the positive number b (and using Property 9 of paragraph 4.1.1),
we obtain a -b 
< kb < a and then, multiplying by -1,
-a < -kb <-a + b
(by Property 10). Adding a gives 0 < a - kb < b so, letting r = a - kb, we have
a = kb + r with 0 < r < Ibi. By uniqueness of q, q 
k = LaJ, as asserted. 
I
With a = -1027 and b = 38, we have
a 1 
1027
LJL 
38 
1 
= L-27.026 ... =-
28 = q.
It is straightforward now to determine r: r = a -qb 
=-1027 + 1064 = 37.
Thus, -1027 
= -28(38) + 37. With a = 1,234,567 and b = -103, we have
Fa1 = 
-11,986.087 ... =-11,986 = q. As before, we note that r = a -qb =
1,234,567- (-11,986)(-103) = 9. Thus, 1,234,567 = -103(-11,986) 
+ 9. A
Representing Natural Numbers in Various Bases
As an application of some of the ideas we have presented so far, we discuss briefly
the representation of natural numbers in bases other than the familiar one.
Unless they have reason to suspect otherwise, most people expect that the
numbers they encounter in their day-to-day lives are presented in base 10. The
integer 2159, for example, is assumed to mean
2 10 3 +1 
. 102 + 5. 10 + 9.
The digits 9, 5, 1, and 2 are called, respectively, the units, tens, hundreds, and
thousands digits of this integer. If we lived in a base 12 world, however, we
would interpret 2159 as
2 t123 + 1 
122 + 5 
12 + 9.

102 
Chapter 4 
The Integers
I 
S 
l
When we represent a number in a base other than 10, we shall employ notation
such as (2159)12. Thus,
(2159)12 = 2. 123 + I 122 + 5 
12 + 9.
Given a fixed natural number b > 1, the base b representation of a natural number
N is the expression (a, Ian-2 ... ao)b, where ao, al, . . ., an,- are those integers
0 < al < b which satisfy N = an-Ib 1
b 
+ an -2bn
2 + . .. + alb + ao. Thus,
(na 2...ao)b0=a 
lb- Â±IaZ- 2b`-2Â±+-+ab+0ao.
The base 5 representation of 117 is 432, written 117 = (432)5, because 117 =
4(5 2)+3(5)+2.Inbase3, 117= (11,100)3because 117= 1(34)+1(33) + 1(32).
While 10 is the most familiar base, nowadays bases 2, 8, and 16 are also common.
Base 2 is also known as binary, base 8 as octal, and base 16 as hexadecimal. The
basic hexadecimal digits are 0-9, A, B, C, D, E, and F. For example, 10 = A16,
11 =Bi6 and (4C)16 =4 16+12=76.
To convert from base b to base 10 is easy: Use the definition of ( 
)b in
Definition 4.1.7. What about converting from base 10 to base b?
Suppose that N = (a, lan-2 ... ao)b is a number given in base b. Then
N = an- lbn-l + a'- 2b n-2 + --
+ alb + ao
= (an -lb'-2 + an- 2b-3 + --- + a)b + ao = qob + a(
where qo = an lbn 2 + an 2bn 3 +.. 
+ al. Since 0 < ao < b, when N is
divided by b, the remainder is ao and the quotient is qo. Similarly,
qo = (an -I V -3 + an-2b' -4 + -+ a2)b +al = ql b+al
with ql = an- bn 3 +a,-
2 bn-4 + ...
+ a2, so that when qo is divided by b, the
remainder is al and the quotient is qj. In a similar way, we see that a2 is the
remainder when ql is divided by b. Thus, the digits in the representation of N in
base b are, from right to left, the remainders when first N, and then successive
quotients, are divided by b.
PROBLEM4. 
Find the binary, octal, and hexadecimal representations of the
number 2159.
Solution. 
We have 2159 = 1079(2) + 1, 1079 = 539(2) + 1, 539 = 269(2) + 1,
269 = 134(2)+1, 134 = 67(2)+0, 67 = 33(2)+1, 33 = 16(2)+1, 16 = 8(2)+0,
8 = 4(2) + 0, 4 = 2(2) + 0, 2 = 2(1) + 0 and I = 0(2) + 1. The sequence of
remainders is 1, 1, 1, 1, 0, 1, 1, 0, 0, 0, 0, 1, so, writing these in reverse order,
2159 = (100,001,101,111)2.
The base 8 and base 16 representations can be obtained by similar means, or
from the base 2 representation. Having determined that 2159 = 2'' + 26 + 25 +
23 + 22 + 2 + 1, we have
2159 = 22(23)3 + (23)2 + (22)23 + 23 + 7
= 4(83) + 1(82) + 5(8) + 7 = (4157)8

4.1 The Division Algorithm 
103
and
2159= 2" +26 +2 5+Â±2+ 
22+2+1
= 23(2) 
Â±+ 2(2 ) + 2(2 ) +15
= 8(16)2 + 6(16) + 15 = (86F)16.
-
-
**
I
PROBLEM 5. 
Convert 21,469 to octal and to hexadecimal notation.
Solution. 
Wehave 21,469 = 2683(8)+5, 2683 = 335(8)+3, 335 =41(8)+7,
41 = 5(8) + 1 and 5 = 0(8) + 5. Thus, 21,469 = (51,735)8. Similarly, 21,469 =
1341(16) + 13, 1341 = 83(16) + 13, 83 = 5(16) + 3 and 5 = 0(16) + 5, so
21,469 = (53DD)16.
1. 1 is the same as the decimal .333.... The three dots "..." 
mean that the 3's
continue indefinitely. We often write 
= 0.3 and say that 1 equals "point 3
repeated." Since 0.3 is larger than 0.3, its negative,-0.3, is less than -0.3.
The number 2r is perhaps the most fascinating number of all. Its decimal
expansion begins 3.14159, so it is definitely bigger than 3.14. As a deci-
mal, 22 = 3.142857, where the line indicates that the sequence of numbers
7
underneath is repeated indefinitely; thus,
22
-= 
3. 142857 142857 142857 142857...
7 
I--
Thus, we see that or < 22. Unlike 1 and 22, the decimal expansion of or
continues indefinitely, without any kind of pattern.
2. The set of negative integers is not closed under multiplication since, for
example, (-2)(-3) = 6 is not a negative integer. The set of natural numbers
is closed under multiplication since the product of natural numbers is a nat-
ural number. The natural numbers are not closed under subtraction since, for
example, 4 -10 
= -6 is not a natural number.
The symbol [BB] means that an answer can be found in the Back of the Book.
1. [BB] Use the properties given in paragraph 4. 1.1 to
derive a second distributive law: (a + b)c = ac + be
for any real numbers a, b, c.
2. True or false? If false, give a counterexample.
(a) [BB] Subtraction is a closed operation on the real
numbers.
(b) Subtraction of real numbers is commutative.
(c) Subtraction of real numbers is associative.
3. Show (by means of a counterexample) that Property 9
of paragraph 4.1.1 does not hold if c < 0.
4. [BB] Find the quotient q and the remainder r as defined
by the division algorithm, 4.1.5, in each of the following
cases.
(a) a = 500; b = 17
(b) a =-500; b = 17
(c) a = 500; b =-17
(d) a =-500; b = -17
5. Find q and r as defined by the division algorithm, 4.1.5,
in each of the following cases.
(a) a = 5286; b = 19
(b) a = -5286; b = 19
rMMIMM:

104 
Chapter 4 The Integers
a = 5286; b =-19
a =-5286; b =-19
a = 19; b = 5286
a( =-19; b = 5286
6. Find integers q and r, with 0 < r < Ibl, such that
a = bq + r in each of the following cases.
(a)
(b)
(c)
(d)
(e)
(D
(g)
a = 12,345; b =-39
a = -27,361; b = -977
a =-102,497; b =- 1473
a = 98,764; b = 4789
a =-41,391; b =-755
a =555,555,123;b= ll,lIl1,II
a = 81,538,416,000; b = 38,754
7. [BB] Fix a natural number n > I and define f: Z -- Z
by setting f (a) equal to the quotient when a is divided by
n;thatis, f(a)= qwherea =qn+rwithO<r <n.
(a) Find the domain and range of f.
(b) Is f one-to-one?
(c) Is f onto?
Explain your answers.
(c)
(d)
(e)
(D
4.2 
DIVISIBILITY AND THE EUCLIDEAN ALGORITHM
When we say that one integer divides another, we mean "divides exactly," that
is, with a remainder of 0.
Given integers a and b with b 0 0, we say that b is a divisor or a factor of a
and that a is divisible by b if and only if a = qb for some integer q. We write
b I a to signify that a is divisible by b and say "b divides a."
For example, 3 is a divisor of 18, -7 is a divisor of 35, 16 |-64, -4 
' 38.
(As always, a slash through a symbol negates the meaning of that symbol. Just
as 0 means "not equal" and 0 means "does not belong to," so ,' means "does not
divide.")
Note that I I n for any integer n because n = n 1.
Show that n 0 Â° for any integer n 0 0.
PROBLEM 6. 
Given three consecutive integers a, a + 1, a + 2, prove that one
of them is divisible by 3.
Solution. 
By the division algorithm, we can write a = 3q + r with 0 < r < 3.
Since r is an integer, we must have r = 0, r -
I or r -
2. If r = 0, then a = 3q
is divisible by 3. If r = 1, then a = 3q + 1, so a + 2 
3q + 3 is divisible by 3.
If r = 2, then a = 3q + 2, so a + I = 3q + 3 is divisible by 3. 
f
8. Suppose n > I is a natural number and f: Z -
N U 101
is that function which associates with each a E Z its
remainder upon division by n; thus, if a = qn + r with
0 < r < n, then f (a) = r.
(a) Find the domain and range of f.
(b) Is f one-to-one?
(c) Is f onto?
Explain your answers.
9. [BB] Complete the proof of Proposition 4.1.6 by show-
ing that if a = qb + r with 0 < r < bi and b < 0, then
q = Fa/bl.
10. Find the binary, octal, and hexadecimal representations
for each of the following integers (given in base 10).
(a) [BB] 4034
(b) 57,483
(c) 185,178
11. (a) Suppose the natural number N is (a,I 
... ao)b (in
base b). Prove that n -I 
= [logb Nj (and, hence,
that N has I + Llogb Nj digits in base b).
(b) How many digits does 7254 have in its base 10 rep-
resentation?
(c) How many digits does the number 319566 have in
its base 10 representation?
I
M

4.2 Divisibility and the Euclidean Algorithm 
105
..... 
0
The following proposition is elementary but very important; it is used (often
implicitly) all the time.
Suppose a, b, and c are integers such that c I a and c I b. Then c I (xa + yb) for
any integers x and y.
Proof 
Since c | a, we know that a = q Ic for some integer qi . Since c I b, we also have
b = q2c for some integer q2. Thus, xa + yb = xqlc + yq2c = (qlx + q2y)c.
Since qlx + q2y is an integer, c I (xa + yb) as required. 
I
The most important properties of "divides" are summarized in the next propo-
sition.
s,.... 
*
Proof
EXAMPLE 7
1 
:
The binary relation 7? on N defined by (a, b) E 7? if and only if a I b is a partial
order.
We have to show that the relation is reflexive, antisymmetric, and transitive.
Reflexive: For any a E N, a I a because a = 1 . a.
Antisymmetric: Suppose a, b c N are such that a I b and b I a. Then b = qi a for
some natural number q] and a = q2b for some natural number q2. Thus,
a = q2(qla) = (qlq2)a. Since a 7 0, qlq2 = 1, and, since qi and q2 are
natural numbers, we must have q =q2 = 1; thus, a = b.
Transitive: If a, b, c c N are such that a I b and b I c, then b = qi a and c = q2b
for some natural numbers qj and q2. Thus, c = q2b = q2(qla) = (qlq2)a,
with qI q2 an integer. So a I c. 
I
The proposition says that (N,) is a partially ordered set. In fact, (A,|) is a
poset for any set A of natural numbers. At this point, we encourage you to review
Section 2.5 and, in particular, the terminology associated with posets.
Let A = {1, 2, 3, 4, 5, 6}. In the poset (A, |), the element 4 is maximal because
there is no a E A satisfying 4 1 a except a = 4. This element is not a maximum
however, since, and for example, 5 ,| 4. Similarly, 5 and 6 are maximal elements
which are not maximum. 
A
Draw the Hasse diagram for this poset and find all minimal, minimum, maximal,
and maximum elements.
The Greatest Common Divisor
Let a and b be integers not both of which are 0. An integer g is the greatest
common divisor (gcd) of a and b if and only if g is the largest common divisor
of a and b; that is, if and only if
1. g~ag band,
2. if c is any integer such that c I a and c I b, then c < g.
We write g = gcd(a, b) to signify that g is the greatest common divisor of a
and b.

106 
Chapter 4 The Integers
EXAMPLES 8
0
A 
A
the greatest common divisor of 15 and 6 is 3,
gcd(-24, 18) = 6,
gcd(756, 210) = 42,
gcd(-756, 210) = 42,
gcd(-756, -210) = 42.
A
If a and b are integers such that a I b, what is the greatest common divisor of a
and b?
Suppose a is a nonzero integer. What is gcd(a, 0)?
It follows almost immediately from the definition that two integers, not both
0, have exactly one greatest common divisor. (See Exercise 14.) Note also that
since I is a common divisor of any two integers, the greatest common divisor of
two integers is always positive.
The seventh book of Euclid's Elements (300 B.C.) describes a procedure now
known as the Euclidean algorithm for finding the gcd of two integers a and b.
It is based on the fact that when a = qb + r, then gcd(a, b) = gcd(b, r). For
instance, since 58 = 3(17) + 7, it must be that gcd(58, 17) = gcd(17, 7). Also,
since 75 = 3(21) + 12, it must be that gcd(75, 21) = gcd(21, 12).
If a = qb + r for integers a, b, q, and r, then gcd(a, b) = gcd(b, r).
Proof 
If a = b = 0, then a = qb+r says r = 0. Similarly, if b = r = 0, then a = 0.
In either case, the result is true since neither gcd(a, b) nor gcd(b, r) is defined.
Thus, it remains to consider the case that gi = gcd(a, b) and g2 = gcd(b, r) are
both well defined integers. First, g21 b and g21 r, so g21 (qb + r); that is, g21 a.
Thus, g2 is a common divisor of a and b and, since g, is the greatest common
divisor of a and b, we have g2 < gjI
On the other hand, since gj | a and gj I b, we know that g, I (a- qb); that is,
gl I r. As a common divisor of b and r, it cannot exceed the gcd of these numbers.
Thus, gi < g2, so g1 = g2 as desired. 
I
The Euclidean algorithm involves nothing more than a repeated application
of this lemma.
Let a and b be natural numbers with b < a. To find the greatest common divisor
of a and b, write
a = qtb + rl, 
with 0 < rl < b.
If rl # 0, write b = q2rl + r2, with 0 < r2 < ri.
If r2 # 0, write rl = q3r2 + r3, with 0 < r3 < r2.
If r3 7 0, write r2 = q4r3 + r4, with 0 < r4 < r3.
Continue this process until some remainder rk+1 = 0. Then the greatest
common divisor of a and b is rk, the last nonzero remainder.
Why does this process work, and why must some remainder be 0? The answer
to the second question is that either rl = 0 or the set of nonzero remainders is

4.2 Divisibility and the Euclidean Algorithm 
107
a nonempty set of natural numbers and hence has a smallest element, rk, by the
Well-Ordering Principle. So the next remainder, being smaller than rk, must be 0.
It follows by Lemma 4.2.5 that rk is the gcd of a and b because
gcd(a, b) = gcd(b, rl) 
gcd(rl, r2)
= gcd(r2 , r3) = 
= gcd(rk, rk+1) = gcd(rk, 0) = rk.
PROBLEM 9. 
Find the greatest common divisor of 630 and 196.
Solution. 
We have 630 = 3(196) + 42
196 = 4(42) + 28
42 = 1(28) + 14
28 = 2(14) + 0.
The last nonzero remainder is 14, so this is gcd(630, 196).
Let us write down these same equations in a different way, expressing each
of the remainders-ri = 42, r2 = 28, r3 = 14-in terms of a = 630 and b = 196.
We have
42 = 630-3(196) 
= 
a- 
3b
28 = 196 - 4(42)
(1) 
=b-4rl =b-4(a-3b) 
=-4a + 13b
14 = 42 - 28
= rl -r
2 = (a-3b)-(-4a 
+ 13b) = 
5a-16b.
Recording only the remainders and the coefficients a and b, these equations
can be neatly coded by the array
42 
1 
-3
28 
-4 
13
14 
5 
-16.
Adding to the top of this array the rows
630 
1 0
196 
0 
1,
which correspond to the equations 630 = 1 a+ Ob and 196 -
Oa+ I b, respectively,
we obtain the array
630 
1 
0
196 
0 
1
42 
1 
-3
28 
-4 
13
14 
5 
-16,
which is easy to remember. Each row after the first two is of the form x - qy,
where x and y are the two rows preceding it and q is the quotient when the first
number in x is divided by the first number in y. When 630 is divided by 196, the
quotient is 3, so the third row is
(630 1 0) - 3(196 0 1) = 42 1 - 3.

108 
Chapter4 The Integers
When 196 is divided by 42, the quotient is 4, so the fourth row is
(196 0 1) - 4(42 1 - 3) = 28 - 4 13.
When 42 is divided by 28, the quotient is 1; so the last row is
(42 1 - 3) - (28 - 4 13) = 14 5 -
16.
Since the last remainder, 14, divides the previous remainder, 28, the next remain-
der is 0. So gcd(630, 196) = 14, the last nonzero remainder.
Here is another example of this procedure.
PROBLEM 10. 
Find gcd(1800, 756).
Solution.
1800
756
288
180
108
72
36
I
0
1
-2
3
-5
8
0
1
-2
5
-7
12
-19
Since the last nonzero remainder is 36, gcd(1800, 756) = 36.
I
Nonzero integers are relatively prime if and only if their greatest common divisor
is 1; in other words, if and only if 1 is the only positive integer which divides
both the given integers.
Show that 17,369 and 5472 are relatively prime.
There is a very important property of the greatest common divisor which
we have so far overlooked. As seen most clearly in equations (1), each remain-
der which arises in the course of applying the algorithm is an integral linear
combination of the given two numbers a and b; that is, each remainder can be
written in the form ma + nb for integers m and n. In particular, the greatest com-
mon divisor of a and b, being the last nonzero remainder, is an integral linear
combination of a and b. For example, as we saw in (1), gcd(630, 196) = 14 =
5a -16b = 5(630) -16(196). 
Similarly, the calculations of Problem 10 show
that gcd(1800, 756) = 36 = 8(1800) - 19(756).
In Pause 7 we asked you to show that the integers 17,369 and 5472 are relatively
prime. Find integers m and n so that 17,369m + 5472n = 1.
Since, by definition, the greatest common divisor of two integers a and b, which
are not both 0, is a positive number, it is clear that gcd(a, b) = gcd(jal, Ibl). For
example, gcd(15, -36) = gcd(15, 36) = 3 and gcd(-18, -99) 
= gcd(18, 99) =
9. Since lal and IbI are natural numbers, the Euclidean algorithm in fact can be
used to find the greatest common divisor of any pair of nonzero integers a and b.
We have been illustrating through examples a general fact: The greatest com-
mon divisor of two natural numbers a and b is a linear combination of a and b. If
M 
S

ro
Proof
---------
Proof
4.2 Divisibility and the Euclidean Algorithm 
109
a = 0 and b > 1, then gcd(a, b) = b = 0(a) + I (b) is also a linear combination
of a and b. Using our remark, it is clear that if gcd(lal, JbJ) is a linear combi-
nation of lal and Ibl, then so is gcd(a, b). For example, since gcd(1800, 756) =
36 = 8(1800) -19(756), 
gcd(1800, -756) = 36 = 8(1800) + 19(-756). The
following theorem, the proof of which follows by noting that each remainder in
the Euclidean algorithm is a linear combination of the previous two, describes the
most important property of the greatest common divisor. (See also Exercise 24.)
The greatest common divisor of integers a and b is an integral linear combination
of them; that is, if g = gcd(a, b), then there are integers m and n such that
g = ma + nb.
The corollaries which follow illustrate ways in which this theorem is used.
Suppose a, b and x are integers such that a I bx. If a and b are relatively prime,
then a I x.
We know that there are integers m and n so that ma+nb = 1 [because gcd(a, b) =
1]. Multiplying by x, we obtain max + nbx = x. But a I max and a | nbx
because nbx = n(bx) and we are given that a I bx. Thus, a divides the sum
max + nbx = x. 
I
The greatest common divisor of nonzero integers a and b is divisible by every
common divisor of a and b.
Let g = gcd(a, b). By Theorem 4.2.9, g = ma + nb for integers m and n. Thus,
by Proposition 4.2.2, if c is a common divisor of a and b, then c I g. 
I
PROBLEM 11. 
Suppose a, b and c are three nonzero integers with a and c
relatively prime. Show that gcd(a, bc) = gcd(a, b).
Solution. 
Let gi = gcd(a, bc) and g2 = gcd(a, b). Since g2 1 b, we know that
92 1 bc. Since also g2 1 a, we have g2 < gi. On the other hand (and just as
in Corollary 4.2.10), since gcd(a, c) = 1, there are integers m and n such that
ma + nc = 1. Multiplying by b, we obtain mab + nbc = b. Since gl I a and
gj | bc, it must also be the case that gi | b. Then, since gl | a, gl < g2. Therefore,
g1 = g2. 
I
......... 
... 
.. 
\ 
, 
\ 
\ 
\ 
\ ~~~....... ... .... -. - -
.................. 
................. ...
The Least Common Multiple
In paragraph 2.5.6, the greatest lower bound of two elements a and b in a partially
ordered set (A, -<) was defined to be an element g = a Ab c A with the properties
1. g -< a, g -< b, and
2. if c -< a and c -< b for some c E A, then c -< g.
Corollary 4.2.11 therefore shows that every pair of natural numbers has a glb in
the poset (N, |), namely, their greatest common divisor: For a, b E N,
a A b = gcd(a, b).

110 
Chapter 4 The Integers
1 
0MMM
EXAMPLES 12
It is also true that every pair of natural numbers has a least upper bound.
If a and b are nonzero integers, we say that e is the least common multiple (1cm)
of a and b and write e = lcm(a, b) if and only if e is a positive integer satisfying
1. a I e, b I e and,
2. if m is any positive integer such that a I m and b I m, then e < m.
.
The least common multiple of 4 and 14 is 28.
. lcm(-6, 21) = 42.
. lcm(-5, -25) = 25.
Since labl is a common multiple of a and b, the least common multiple always
exists and does not exceed labl. Remember also that a least common multiple is
always positive (by definition).
In the exercises (see also Exercise 29 of Section 4.3), we ask you to derive
the formula
(2)
I 
gcd(a, b) lcm(a, b) = lab, 
I
A
EXAMPLES 13
0339:m~S
which holds for any nonzero integers a and b and gives a quick way to compute
least common multiples.
.
Since gcd(6, 21) = 3, it follows that lcm(6, 21) = 6(21) = 126 = 42.
3 
3
.
Since gcd(630, -196) 
= 14 (Problem 9), it follows that lcm(630, -196) =
630(196) = 8820. 
A
1 4
Just as the greatest common divisor of a and b is divisible by all common
divisors of a and b, we can show that the least common multiple of a and b is
a divisor of all common multiples of a and b (see Exercise 27). Thus, the least
common multiple of natural numbers a and b is their least upper bound in the
poset (N, |) (see again paragraph 2.5.6). For a, b e N,
a V b = lcm(a, b).
Remembering that a lattice is a partially ordered set in which every two elements
have a greatest lower bound and a least upper bound, the following proposition
is immediate.
The poset (N, |) is a lattice.
The Lattice of Divisors of a Natural Number
Implicit in the definition of lattice is the fact that the greatest lower bound and least
upper bound of every pair of elements should lie in the set. The poset ({2, 3, 4}, ),
for instance, is not a lattice because while, for example, 2 and 3 have a glb in N,
this element is not in {2, 3, 4}.
We have seen that (N, |) is a lattice. Also, for many subsets A of N, (A, |) is
a lattice. For example, if n is any natural number and A = {d X N I d I n} is the
set of positive divisors of n, then (A, |) is a lattice. (See Exercise 33.)

4.2 Divisibility and the Euclidean Algorithm 
111
EXAMPLE 14
With A = f1, 2, 3, 5, 6, 10, 15, 30}, the set of positive divisors of n = 30, (A, |)
is a lattice whose Hasse diagram is shown in Fig 4.2. Notice that every pair of
elements of A has a glb and a lub. For every pair of elements a, b C A, a A b is
the unique element below (and connected with lines to) both a and b and a v b
is the unique element above (and connected with lines to) both a and b. 
A
30
6
2
15
5
Figure 4.2 
The Hasse diagram for (A, |), where A is the set of divisors of 30. Compare with Fig 2.4, p. 65.
3. For any integer n, we have 0 = qn for the integer q = 0.
4. Since I Ia for all a E A, no a :7 I can be min-
imal. The only minimal element is 1, and it is
a minimum. The elements 4, 5, and 6 are maxi-
mal. For instance, 4 is maximal because there is
no a X A such that 4 | a, except a = 4. There
are no maximum elements; for example, 4 is not
maximum because a 14 for all a E A is not true.
4 
6 
5
2
5. The largest divisor of a is la. Since lal is a common divisor of a and b, this
must be their gcd.
6. Since a is a common divisor of a and 0, the greatest common divisor of these
numbers is lal.
7. 17,369 
1 
0
5472 
0 
1
953 
1 
-3
707 
-5 
16
246 
6 
-19
215 
-17 
54
31 
23 
-73
29 
-155 
492
2 
178 
-565
1 
-2647 
8402
The last nonzero remainder-I in this case-is the gcd. So 17,369 and 5472
are relatively prime.
8. 1 = -2647(17,369) + 8402(5472).
*02*-

112 
Chapter 4 The Integers
The symbol [BB] means that an answer can be found in the Back of the Book.
1. [BB] We have seen in this section that (N,) 
is a partially
ordered set.
(a) Is it totally ordered?
(b) Does it have a maximum? A minimum?
Explain your answers.
2. Consider the partially ordered set ({2, 4, 6, 81. ).
(a) Explain why every pair of elements in this poset has
a greatest lower bound.
(b) Does every pair of elements have a least upper
bound?
(c) Is the poset a lattice?
Explain your answers.
3. Draw the Hasse diagrams for each of the following par-
tially ordered sets.
(a) [BB] ({2, 3, 4, 5, 6, 7})
(b) ({ 1,2, 3,4, 5,6, 7, 8,9, 10},|1)
4. List all minimal, minimum, maximal, and maximum ele-
ments for each of the posets in Exercise 3.
5. [BB] Let n be a natural number. Given n consecutive
integers, a, a + la Â±2. 
a + n -I, 
show that one
of them is divisible by n.
6. [BB] Prove that n2 - 2 (n an integer) is never divisible
by 4.
7. Given that a and x are integers, a > 1, a I (I lx + 3),
and a I (55x + 52), find a.
8. [BB] Suppose a and b are integers with the same remain-
der upon division by some natural number n. Prove that
n I (a -b).
9. True or false? In each case, justify your answer with a
proof or a counterexample (all variables represent inte-
gers).
(a) [BB] if a I b and b |-c, then a I c.
(b) if a b and cjb, then acIb.
(c) if a b and a c, then a Ibc.
(d) if a band cd, 
then acIbd.
b 
b
(e) if a bandc I ,then c Ibanda I
a 
c
10. Suppose a and b are relatively prime integers and c is
an integer such that a I c and b I c. Prove that ab I c.
11. In each of the following cases, find the greatest common
divisor of a and b and express it in the form ma + nb
for suitable integers in and n.
(a) [BB] a = 93, b = 119
(b) [BB] a =-93, b = 119
(c) [BB] a =-93, b =-119
(d) a = 1575. b = 231
(e) a = 1575, h =-231
(fM a =-1575, b =-231
(g) a =-3719, b = 8416
(h) a = 100,996, b = 20,048
(i) a = 28,844, b =-15,712
(j) a = 12,345, b = 54,321
12. Which of the pairs of integers in Exercise II are rela-
tively prime?
13. [BB] If a and b are relatively prime integers, prove that
gcd(a + b, a - b) = I or 2.
14. [BB] Prove that integers a and b can have at most one
greatest common divisor.
15. Prove that for integers a and b, gcd(a, a + b) 
=
gcd(a, b). [Hint: Mimic the proof of Lemma 4.2.5.]
16. (a) [BB] Find a pair of integers x and y such that
17,369x + 5472v = 4. (See Pause 8.)
(b) Find integers x and v such that 154x + 260y = 4.
(c) [BB] Show that no integers x, v satisfy 154x +
260y ) 
3.
(d) Show that no integers x, y satisfy 196x+260y = 14.
17. (a) [BB] Given integers d, x and y, suppose there exist
integers m and n such that d = mx + ny. Prove that
gcd(x, y) I d.
(b) Is the converse of (a) true? If gcd(x, y) I d, need
there exist integers m and n such that d = mx+ny?
18. If k EN, prove that gcd(3k + 2, 5k + 3) = 1.
19. [BB] Let a, b, c 
e N. Prove that gcd(ac, bc) =
c(gcd(a, b)).
20. If a c N, prove that gcd(a, a + 2) 
I if 
is odd
2 if 
is even.
21. [BB] Prove that gcd(n, n + I) = I for any n E N. Find
integers x and y such that nox + (n + I)y = 1.
ff Ur: M E. 
I 
-

22. Prove that if a, b, and c are natural numbers, gcd(a, c)
I and b I c, then gcd(a, b) = 1.
23. Let n and s be positive integers and suppose k is the
least positive integer such that n I ks. Prove that k =
n
gcd(n, s)
24. [BB] Use the Well-Ordering Principle to prove The-
orem 4.2.9. [Hint: Consider the set of positive linear
combinations of a and b.]
25. [BB] Find lcm(63, 273) and lcm(56, 200). [Hint: An
easy method takes advantage of formula (2) of this
section.]
26. [BB; (a)] Find the 1cm of each of the pairs of integers
given in Exercise 11.
27. Let a and b be nonzero integers with Icm(a, b) = e. Let
m be any common multiple of a and b. Prove that e |m .
28. [BB] Prove that gcd(a, b) I lcm(a, b) for any nonzero
integers a and b.
29. Establish formula (2) of this section by proving that the
least common multiple of nonzero integers a and b is
lab I/ gcd(a, b).
30. (a) [BB] Let x be an integer expressed in base 10. Sup-
pose the sum of the digits of x is divisible by 3.
Prove that x is divisible by 3.
(b) [BB] Prove that if an integer x is divisible by 3,
then, when written in base 10, the sum of the digits
of x is divisible by 3.
(c) Repeat (a) and (b) for the integer 9.
The greatest common divisor of n integers al, a2, 
a,
not all zero, is a number g which is a common divisor
of these integers (that is, g I al, g I a2, . . ., g I a,,) and
which is the largest of all such common divisors (that is,
if c I ai, c 
a2, . .. ,c 
a,, then c < g). It is denoted
gcd(al, ... 
a,).
31. (a) Suppose a, b, c are nonzero integers. Show that
gcd(a, b, c) = gcd(gcd(a, b), c).
(b) Show that the gcd of nonzero integers a, b, c is an
integral linear combination of them.
(c) Find gcd(105, 231, 165) and express this as an
integral linear combination of the given three
integers.
4.2 Divisibility and the Euclidean Algorithm 
113
(d) Answer (c) for the integers 6279, 8580, and 2873.
(e) Answer (c) for the integers 5577, 18,837, and
25,740.
32. Suppose that (Al, -<I) and (A2, -<2) are partial orders.
(a) Show that the definition
(xI, x2) < (YI, Y 2) 
* 
XI -<yj and x2 -<2 Y2
for (xI, x2), (yI, Y2) E AI x A2 makes AI x A2 a
partially ordered set.
(b) Let AI = A2 = {2, 3, 41. Assign to AI the partial
order < and to A2 the partial order |. Partially order
AI x A2 as in part (a). Show all relationships of the
form (xI, x2) > (yI, Y2)
(c) Draw the Hasse diagram for the partial order
in (b).
(d) Find any maximal, minimal, maximum, and mini-
mum elements which may exist in the partial order
of (b).
(e) With AI and A2 as in part (b), find those glbs and
lubs which exist for each of the following pairs of
elements.
i. (2, 2), (3, 3)
Hi. (4, 2), (3, 4)
iM. (3, 2), (2, 4)
iv. (3, 2), (3, 4)
(f) Show, by example, that if (Al, -<I) and (A2 , -<2)
are total orders, then (A1 x A2, -<) need not be a
total order.
33. (a) Let n be a natural number, n > 1. Let A = {a E N l
a I n}. Prove that (A, |) is a lattice.
(b) [BB] Draw the Hasse diagram associated with the
poset given in (a) for n = 12.
(c) Draw the Hasse diagram associated with the poset
given in (a) for n = 36.
(d) Draw the Hasse diagram associated with the poset
given in (a) for n = 90.
34. (a) [BB] Let g be the greatest common divisor of
integers m and n, not both 0. Show that there
are infinitely many pairs a, b of integers such that
g = am +bn.
(b) Suppose m and n are relatively prime integers each
greater than 1.
i. Show that there exist unique integers a, b with
0 < b < m such that am +bn = 1.
ii. Show that there exist unique integers a, b with
0 < a < n and 0 < b < m such that am
bn + 1.

114 
Chapter 4 The Integers
4.3 
PRIME NUMBERS
In Section 4.2, we saw what it means to say that one integer "divides" another.
The basic building blocks of divisibility are the famous "prime numbers". We
examine some of the properties of prime numbers in this section.
----------------
A natural number p > 2 is called prime if and only if the only natural numbers
which divide p are 1 and p. A natural number n > I which is not prime is called
composite. Thus, n > I is composite if n = ab where a and b are natural numbers
with I < a, b < n.
Thus, 2, 3, and 5 are primes while 4, 6, and 10 are composite. Note that
the natural number 1 is neither prime nor composite. It is interesting to note that
exactly one quarter of the numbers between 1 and 100 (inclusive) are prime. These
primes are shown in Table 4.1.
Table 4.1 
The primes
less than 100.
2 
3 
5 
7 
11
13 
17 
19 
23 
29
31 
37 
41 
43 
47
53 
59 
61 
67 
71
73 
79 
83 
89 
97
You may have needed more than a few seconds to verify that some of the
entries in Table 4.1 are, in fact, prime. Such verification gets increasingly more
difficult as the numbers get bigger. One of the great challenges of mathematics
and an active area of research today is that of finding efficient algorithms for
checking whether or not large integers are primes. By the end of 1988, the largest
known prime number was 2216,09 
- 1. This was discovered in 1985 by computer
scientists working at Geosciences Corporation, Houston, who required just three
hours on a Cray X-MP computer to verify that this number was, indeed, prime.
Not everyone was impressed. A vice president of Chevron Oil was apparently
quoted as saying, "The results are interesting, if true, but they are certainly not
going to help me find oil."
The discovery of new primes is viewed as both a test of humankind's ingenuity
and the reliability of new computers, so, when a new prime is discovered, it
is widely publicized. Early in 1992, David Slowinski and Paul Gage of Cray
Research Inc. announced that 2756,839 -I 
is prime. Then in 1994 the same people
announced the primality of 2859.433 -
1, a number with a mere 258,716 digits.
On November 13, 1996 Joel Armengaud, a 29-year-old computer programmer
working in France, discovered that 21 398,269 -
I is prime. A year later, Gordon
Spence of Hampshire, England, with a Pentium PC running a program downloaded

4.3 Prime Numbers 
115
MOMMIDEM
Proof
Proof
over the World Wide Web,2 found that 22 976,221 
1 is prime. This number, with
895,932 digits, would fill a 450-page book all by itself! New primes are currently
being discovered at such a rate that it is difficult for the authors of textbooks
to keep pace. In June 1999, using the "Lucas-Lehmer Test," Nayan Hajratwala
discovered that 26,972,593 
1, a number with 2,098,960 digits, was prime, and a
year later this number had not been beaten. The search for the next largest prime
presents a challenge that will never end because it has been known since the time
of Euclid that the number of primes is infinite. To prove this fact, we first need a
short lemma.
Given any natural number n > 1, there exists a prime p such that p I n.
We give a proof by contradiction. Thus, we suppose the lemma is false. In this
case, the set of natural numbers greater than 1 which are not divisible by any
prime is not empty. By the Well-Ordering Principle, the set contains a smallest
element m. Since m I m, but m is not divisible by any prime, m itself cannot
be prime, so m is divisible by some natural number a, with 1 < a < m. By
minimality of m, a must be divisible by a prime p. Since p I a and a I m, we have
p I m, a contradiction. 
I
Now we can easily show that there are an infinite number of primes. The
wonderfully simple argument we present has been known since 300 B.C. and is
commonly attributed to Euclid since it appears in Euclid's Elements. It is a model
of a proof by contradiction.
There are infinitely many primes.
If the theorem is not true, there are just a finite number of primes Pl, P2, 
,
Pt. Let n = (PIP2 -
Pt) + 1. By Lemma 4.3.2, n is divisible by some prime
and hence by some pi. Since PI P2 ... Pt is also divisible by pi, the number
n - (PlP2 Pt) must also be divisible by p,. Thus, 1 is divisible by pi, a
contradiction. 
I
Although the number of primes is infinite, the number of natural numbers which
are not prime is infinite too. Find an easy way to see this.
We now return to the question of determining whether or not a given integer
is prime. Several elementary observations can be made at the outset. Any even
integer is divisible by 2 and so is not prime (unless it equals 2). Similarly, any
integer larger than 5 whose units digit is 0 or 5 is divisible by 5 and hence not
prime. If n is not prime, Lemma 4.3.2 tells us that n is divisible by some prime.
So, to verify that n is not prime, it is enough just to test the prime numbers less
than n (rather than all numbers less than n) when searching for a divisor of n.
Here is another fact which decreases considerably the amount of testing that
must be done when checking for divisors of an integer.
2The World Wide Web is full of information about large primes. For instance, there is lots of up-to-the-
minute news in "The Prime Pages:" http: //www. utm. edu/research/primes/.

116 Chapter 4 The Integers
-=A
If a natural number n > I is not prime, then n is divisible by some prime number
p < I/ji,
Proof 
Since n is not prime, n can be factored n = ab with 1 < a < b < n. Then
a < f; since otherwise, ab > In>> 
= n, a contradiction. As a natural number
greater than 1, it follows that a is divisible by some prime p. Since p I a and a I n,
p I n by transitivity. Also, since a < Hi and p I a, we must have p < VA. Thus,
p is the desired prime factor of n. 
I
As a consequence of Lemma 4.3.4, when testing a natural number n for
primality, we need only consider the possibility of a prime divisor less than
or equal to the square root of n. For example, to verify that 97 is prime, we
need only check the prime numbers less than or equal to 
97. Since none of
2, 3, 5, 7 is a divisor of 97, we are assured that 97 is a prime number. It is
apparent that Lemma 4.3.4 reduces dramatically the work involved in a primality
check.
One simple procedure which goes back over 2000 years for finding all the
primes less than or equal to some given integer is named after the Greek Eratos-
thenes (ca. 200 B.C.), chief librarian of the great library at Alexandria and a
contemporary of Archimedes. Reportedly, Eratosthenes was the first person to
estimate the circumference of the earth.
63E&
-3wlllill
EXAMPLE 15
Who was Archimedes?
To find all the prime numbers less than or equal to a given natural number n,
.
list all the integers from 2 to n,
.
circle 2 and then cross out all multiples of 2 in the list,
.
circle 3, the first number not yet crossed out or circled, and then cross out all
multiples of 3,
.
circle 5, the first number not yet crossed out or circled, and cross out all
multiples of 5,
.
at the general stage, circle the first number which is neither crossed out nor
circled and cross out all its multiples,
.
continue until all numbers less than or equal to 
a 
have been circled or
crossed out.
When the procedure is finished, those integers which are not crossed out are the
primes not exceeding n.
As an example of this procedure, we verify that the list of primes p < 100 given
in Table 4.1 is correct. All the integers from 2 to 100 are listed in Figure 4.3.
Initially, 2 was circled and then all even integers were crossed out with a single
stroke. At the second stage, 3 was circled and all multiples of 3 not yet crossed
out were crossed out with two strokes. Then 5 was circled and all multiples of 5
not yet crossed out were crossed out with three strokes. Finally, 7 was circled and
all multiples of 7 not previously crossed out were crossed Out with four strokes.
The primes less than 100 are those which are not crossed out. 
A

4.3 Prime Numbers 
117
41
71d
$9e
13
23
43
53
73
83
42/4
54
4
,7/4
$4
94
/M
/V/
/0/
/45/
15W
116X
//W
/W
/6
,6
16
~6
7,6
06
.94
17
37
47
67
97
/8'
~9
19
29
59
79
89
~6
11
31
41
61
71
Figure 4.3 
The Sieve of Eratosthenes used to determine the primes p < 100.
The prime numbers are considered "building blocks" because of the following
important theorem, which generalizes observations such as 8 = 2 .2 2, 15 = 3 5
and 60=2 2 .3 5.
Every natural number n > 2 can be written n = PI P2 ... Pr as the product of
prime numbers PI, P2, .
Pr or, by grouping equal primes, in the form n =
q1 q2
... qÂ° as the product of powers of distinct primes qI, q2, . .., q,
Proof 
If the result is false, then the set of integers n > 2 which cannot be written as the
product of primes is not empty and so, by the Well-Ordering Principle, contains a
smallest element m. This number cannot be prime, so m = ab with 1 < a, b < m.
By minimality of m, each of a and b is the product of primes, hence so is m, a
contradiction. 
I
EXAMPLE 16
100 = 2 . 2 5 5 = 2252
1176= 2 .2-23 
.7 .7 = 23 3 .72
21340 = 2 2 .5 
11 97 = 22. 5 11 97.
A
Theorem 4.3.6 can be strengthened. There is, in fact, just one way to express
a natural number as the product of primes, but in order to prove this, we need a
preliminary result which is actually a special case of something we proved earlier
(see Corollary 4.2.10). Notice that 3 12 and regardless of how 12 is factored-
12 = 2(6) = 3(4)-3 always divides one of the factors. The next proposition
describes the most important property of a prime number.
Suppose a and b are integers and p is a prime such that p I ab. Then p I a or p I b.
This indeed follows from Corollary 4.2.10 because, if p , a, then p and a
are relatively prime.
Now suppose a prime p divides the product ala2 . ak of k integers. By
Proposition 4.3.7, p I al or p I a2 
ak. In the latter case, applying the proposition
again, we see that p I a2 or p I a3 
ak. In this way, we obtain the following
corollary.
- -
- - - -- - -- -
-- --

118 
Chapter 4 The Integers
If a prime p divides the product a1a2 ... ak of integers, then p divides one of
the ai.
Now to prove that a natural number n > I can be factored in just one way
as the product of primes, assume that n can be factored in two different ways:
(3)
n = p p2 .Pk 
= ql q2 .qe
with all the pi and qi primes. After canceling equal factors on each side of
this equation, we either have an equation which says that the product of certain
primes is I (an absurdity) or another equation like (3), where none of the primes
pi is among the primes qj. Then, since pi I PIP2 ... Pk, it would follow that
Pi Iqlq2 ... qe. By Corollary 4.3.8, pi I qj for one of the primes qj. Since both
pi and qj are primes, this forces P1 = qj, a contradiction.
The fact that every integer n > 1 can be written uniquely as the product of
prime numbers is called the "Fundamental Theorem of Arithmetic." Because of
its importance, we state it again.
Every integer n > 2 can be written in the form
(4)
n = PIP2 ..
Pr
for unique primes PI, P2, .
Pr; equivalently, every integer n > 2 can be written
0I = 2 
a,
~ 1 q2
s
(the prime decomposition of n)
4 
I 
0
as the product of powers of distinct prime numbers q1, q2, ..
q. These primes
and the exponents ai I 
2, . . ., cis are unique.
As noted, the decomposition in (5) is called the prime decomposition of n.
For example, the prime decomposition of 120 is 23 .3 .5.
The prime factors or prime divisors of an integer n > 2 are the prime numbers
which divide n. The multiplicity of a prime divisor p of n is the largest number
x such that pL I n.
Thus, the prime factors of an integer n are the primes Pi or qi given in (4) and
(5) and the multiplicities of q, .
, q, are the exponents a1, ... , ae, respectively.
The prime factors of 14 are 2 and 7 and each has multiplicity 1. The prime factors
of 120 are 2, 3, and 5; 2 has multiplicity 3, while 3 and 5 each have multiplicity 1.
PROBLEM 17. 
Find the prime decomposition of the greatest common divisor
of nonzero integers a and b.
Solution. 
By the Fundamental Theorem of Arithmetic, a and b can be expressed
in the form
a 
palP2 
r 
b =2 
piP2 .p.
for certain primes P1, P2,.s 
Pr and integers al, c2,..., O(r, 
f1 , *... , /r (By
allowing the possibility that some of the ai or Pi are 0, we can assume that the
4 
6
(5)

4.3 Prime Numbers 
119
same r primes occur in the decompositions of both a and b.) We claim that the
greatest common divisor of a and b is
rnin(a I, A,) 
mrin(U2 . 82 ) 
mrin (a,,tor)
g = Pt 
p2  
Pr
where min(ai, p
3i) denotes the smaller of the two nonnegative integers (li and /ij.
Note that g I a since the exponent min(ai, ,i) does not exceed a', the exponent
of the prime pi in a. Similarly, g I b. Next, assume that c I a and c I b. Since any
prime which divides c also divides a and b, the only primes dividing c must
be among PI, P2, 
Pr. Thus, c = p 
p 2  
pr 
for some integers y,. Since
c I a, however, we must have yi < ai for each i and, similarly, yi < fi for
each i because c b. Hence, Yi < min(ai, hi) for each i, so c I g and the result
follows.
Prime numbers have held a special fascination for humankind ever since the
Greeks realized there were infinitely many of them. They are so familiar, yet there
are many questions concerning them which are easy to state but hard to answer.
Many remain unsolved today. In the rest of this section, we briefly survey some
of what is known and some of what is unknown about primes, but few details
and no proofs will be given. For more information, the interested reader might
consult Silverman's book,3 for example.
Mersenne Primes
While it is very difficult to determine whether or not a given large integer is prime,
the problem may be easier for special classes of integers. For example, integers of
the form 7n, n c N, are never prime if n > 1 since they are obviously divisible by
7. What about integers of the form n2 -1? Well, since n2 - 1 = (n-1)(n+ 1), these
cannot be prime either as long as n > 2. Father Marin Mersenne (1588-1648) was
interested in integers of the form 2" - 1. He showed that these could only be prime
if n itself was prime. (See Exercise 17.) Then he noted that it wasn't sufficient just
for n to be prime since 211 -I = 2047 = 23 .89 is not prime. He conjectured that
2P-l is prime ifp is any of the primes 2,3,5,7, 13, 17, 19,31,67, 127,257 and
composite for the other primes p < 257. Unfortunately, he was wrong on several
counts. For example, 261 - 1 is prime while 2257 
1 is not. (Resist the urge to
factor!) By the end of 1997, just 35 primes of the form 2P - 1 had been found.
Interestingly, all the large primes which have been discovered in recent years are
in this list. In Mersenne's honor, primes of the form 2P - 1 are called Mersenne
primes. While Mersenne primes continue to be discovered, the following problem
is still unresolved.
Are there infinitely many Mersenne primes?
Fermat Primes
Another interesting class of prime numbers is the set of so-called Fermatprimes,
these being prime numbers of the form 22" + 1. For n = 0, 1, 2, 3, 4, indeed 22" + 1
3Joseph H. Silverman, A Friendly Introduction to Number Theory, second edition (Prentice Hall, 2001).

120 
Chapter 4 The Integers
*c 
ppm.]  E
is prime and it was a guess of the seventeenth-century lawyer Pierre de Fermat
(1601-1665), perhaps the most famous amateur mathematician of all time, that
22' + 1 is prime for all n > 0. In 1732, however, the great Swiss mathematician
LUonhard Euler (1707-1783) showed that 225 + I is not prime-it is divisible by
641-and, to this day, no further Fermat primes have been discovered.
When a Cray supercomputer tires of hunting for Mersenne primes, it turns
to a search for Fermat primes! In a number of cases, complete factorizations of
22' + I are known; in other cases, one or two prime factors are known. There are
Fermat numbers-numbers of the form 22n + I-known to be composite, though
no one knows a single factor! As of 1995, the smallest Fermat number whose
primality was unsettled was 2224 + 1. More details, together with an indication as
to how testing huge numbers for primality is used to check the reliability of some
of the world's largest computers, can be found in an article by Jeff Young and
Duncan A. Buell.4
What are the first five Fermat primes?
Are there more than five Fermat primes?
How Many Primes Are There?
We have discussed Euclid's observation that there are infinitely many primes
(Theorem 4.3.3), so what does the question just posed really mean?
There is great interest in the proportion of natural numbers which are prime.
Students who have enjoyed advanced calculus will know that the series
1 
2 
31 4
diverges (the partial sums increase without bound as more and more terms are
added), while the series
1 
1 
1 
1
j2 + 22 + 32 
42
converges (to 7r 2/6 in fact). 5 Notice that the second sum here is part of the first.
So the fact that the second sum is finite while the first is infinite shows that the
sequence of perfect squares 12, 22, 32... 
forms only a tiny part of the sequence
of all natural numbers 1, 2, 3, ....
Which of these sequences does the set of primes most resemble? Does the
sum of reciprocals of the primes
1 
1 
1 
1
converge or diverge? As a matter of fact, it diverges, so, in some sense, there
really are a "lot" of prime numbers, many more than there are perfect squares,
for example.
4"The Twentieth Fermat Number is Composite," Mathematics of Computation 50 (1988), 261-263.
5The reader who has not studied advanced calculus can relax! The ideas to which we make reference
here are not critical to an overall appreciation of the mysteries of the primes.

4.3 Prime Numbers 
121
I-
A sophisticated result concerning the number of primes is the important
"Prime Number Theorem," which was proven independently by Jacques Hadamard
and Charles-Jean de la Vallee-Pousin in 1896. It gives an approximation to the
function Jr(x), which is the number of primes p < x. For example, 7r(5) = 3
since there are three primes p < 5. We have earlier noted that there are 25 primes
p < 100; thus, 7r(100) = 25.
Let 7r(x) denote the number of primes p < x. Then
wr (X) 
x
lim 
1; 
equivalently, 
mr(x) -
x--* ocx/In x 
Inx
Students uncertain about limits might wish a translation! First of all, we say
"is asymptotic to" for -. So the second statement of the theorem reads "7r(x) is
asymptotic to x/lnx," from which we infer that 7r(x) is approximately equal to
x/ In x for large x, the approximation getting better and better as x grows. Setting
x = 100, Theorem 4.3.13 asserts that the number of primes p < 100 is roughly
100/ In 100 ; 21.715. Note that
r(100) 
25
100/ In 100 
21.715
[The symbol t means "approximately."] Setting x = 1,000,000, the theorem says
that the number of primes under I million is roughly 1,000,000/ In 1,000,000 t
72,382. In fact, there are 78,498 such primes. Note that
7r (1,000,000) 
78,498
__ 
_ 
_ 
_ 
_ 
_ 
_ 
_ 
'_____ 
t 
1.084.
1,000,000/ In 1,000,000 
72,382
As x gets larger, the fraction 
2T(x) gets closer and closer to 1.
xlInx
On June 23, 1993, at a meeting at the Isaac Newton Institute in Cambridge,
England, Andrew Wiles of Princeton University announced a proof of "Fermat's
Last Theorem," arguably the most famous open mathematics problem of all time.
For any integer n > 2, the equation a' + bV = c" has no nonzero integer solutions
a, b, c.
Notice that it is sufficient to prove this theorem just for the case that n is a
prime. For example, if we knew that a3 + b3 = c3 had no integral solutions, then
neither would A3n + B3n = C3n. If the latter had a solution, so would the former,
with a = An, b = B', c =C.
When we first learned the Theorem of Pythagoras for right-angled triangles,
we discovered that there are many triples a, b, c of integers which satisfy a2 +b2 =
c2; for example, 3, 4, 5 and 5, 12, 13, but are there triples of integers a, b, c
satisfying a3 + b3 = C3 or a7 + b7 = c 7 or an + b = cn for any values ofn
except n = 2?
Pierre de Fermat was notorious for scribbling ideas in the margins of whatever
he was reading. In 1637, he wrote in the margin of Diophantus's book Arithmetic
that he had found a "truly wonderful" proof that a' + bn = c' had no solu-
tions in the positive integers for n > 2, but that there was insufficient space to

122 Chapter 4 The Integers
write it down. Truly wonderful it must have been because for over 350 years,
mathematicians were unable to find a proof, though countless many tried!
Amateur and professional mathematicians alike devoted years and even life-
times to working on Fermat's Last Theorem. The theorem owes its name, by the
way, to the fact that it is the last of the many conjectures made by Fermat dur-
ing his lifetime to have resisted resolution. By now, most of Fermat's unproven
suggested theorems have been settled (and found to be true).
In 1983, Gerd Faltings proved that, for each n > 2, the equation a' + bV = c
could have at most a finite number of solutions. While this was a remarkable
achievement, it was a long way from showing that this finite number was zero.
Then, in 1985, Kenneth Ribet of Berkeley showed that Fermat's Last Theorem
was a consequence of a conjecture first proposed by Yutaka Taniyama in 1955 and
clarified by Goro Shimura in the 1960s. It was a proof of the Shimura-Taniyama
conjecture which Andrew Wiles announced on June 23, 1993, a truly historic
day in the world of mathematics. The months following this announcement were
extremely exciting as mathematicians all over the world attempted to understand
Wiles's proof. Not unexpectedly in such a complex and lengthy argument, a few
flaws were found. By the end of 1994, however, Wiles and one of his former grad-
uate students, Richard Taylor, had resolved the remaining issues to the satisfaction
of all.
Among the many exciting accounts of the history of Fermat's Last Theorem
and of Wiles's work, we draw special attention to an article by Barry Cipra, "Fer-
mat's Theorem-at Last!", which was the leading article in What's Happening
in the Mathematical Sciences, Vol. 3 (1995-1996), published by the American
Mathematical Society. Faltings himself wrote "The Proof of Fermat's Last The-
orem by R. Taylor and A. Wiles" for the Notices of the American Mathematical
Society, Vol. 42 (1995), No. 7. In fact, many excellent accounts have been written.
We cite just a few. There is one entitled "The Marvelous Proof' by Fernando Q.
Gouvea, which appeared in the American Mathematical Monthly, Vol. 101 (1994),
and others by Ram Murty, Notes of the Canadian Mathematical Society, Vol. 25
(September 1993) and by Keith Devlin, Fernando Gouvea, and Andrew Granville,
Focus, Vol. 13, Mathematical Association of America (August 1993).
More open Problems
So far, we have only peeked into the Pandora's box of fascinating but unanswered
problems concerning prime numbers. Here are a few more.
There are intriguing questions concerning prime "gaps," the distances between
consecutive primes. On the one hand, there are arbitrarily long gaps in the list of
primes. One way to see this is to observe that if the first n + I primes are PI, P2,
* * , Pn+ 1 then all the numbers between PIP2 .. pn+2 and PIP2 
Pn+Pn +-I
are composite. (See Exercise 26.) On the other hand, there are also very small
gaps in the primes, for example, gaps of length two such as between 3 and 5 or
11 and 13.
Integers p and p + 2 which are both prime are called twin primes. For
example, 3 and 5, 5 and 7, 11 and 13, 41 and 43 are twin primes. So are
4,648,619,711,505 x 260000 + 1, a 1999 discovery of Heinz-Georg Wassing,
Antal Jarai, and Karl-Heinz Indlekofer. As of mid-2000, these numbers, each

4.3 Prime Numbers 
123
Et=-
E " r g 1
l i | 
| 
s
-
0*.-
with 18,075 digits, remained the largest known pair of twin primes. It is possible,
though not likely, that there are no more. Unlike prime numbers, it is not known
whether or there are infinitely many twin primes. One tantalizing result, proved
by Viggo Brun in 1921 using a variation of the Sieve of Eratosthenes, is that the
sum of the reciprocals of just the twin primes converges. Having noted that the
sum of the reciprocals of all the primes diverges, Brun's result is evidence that
the number of twin primes is "small." On the other hand, there are 224,376,048
twin prime pairs less than 100 billion and this seems like a pretty big number. Is
the total number finite? No one knows.
There are infinitely many twin primes.
Observethat4=2+2,6=3+3,8=5+3,28= 17+11,and96=43+53.
Every even integer appears to be the sum of two primes. Is this really right? The
conjecture that it is, first made by Christian Goldbach in 1742 in a letter to Euler,
has proven remarkably resistant to solution. In 1937, I. M. Vinogradov showed
that every sufficiently large integer can be written as the sum of at most four
primes. Sufficiently large means that there is a positive integer no such that every
integer larger than no satisfies the condition. In 1966, J. Chen showed that every
sufficiently large even integer can be written as x + y where x is prime and y is
either prime or the product of two primes. So we seem to be close to a solution
of Goldbach's conjecture, though the last step is often the hardest.
Every even integer greater than 2 is the sum of two primes.
9. For instance, numbers of the form 7n are not prime, and there are infinitely
many of these.
10. Archimedes was a Greek scientist of the third century B.C. perhaps best
known for the "Principle of Archimedes." This states that the weight of the
fluid displaced by a floating object is equal to the weight of the object itself.
11. The first five Fermat primes are 2(20) + 1= 2'+ 1 = 3, 2(21) 
+ 1= 22+ 1 = 5,
2(22) +1 =24+ 1 = 17, 2(23) Â± 1= 28 + 1 = 257, and 2(24) +1 
= 216 
= 
I
65537.
The symbol [BB] means that an answer can be found in the Back of the Book.
1. Determine whether or not each of the following integers
is a prime.
(a) [BB] 157
(b) [BB] 9831
(c) 9833
(d) 55,55 1,1 Il
(e) 2216,090-l
2. Can Lemma 4.3.4 be strengthened? In other words, does
there exist a number r < +/E such that if n is not prime,
then n has a prime factor p < r?
3. (a) [BB] Suppose p is the smallest prime factor of an
integer n and p > 
n/p. Prove that n/p is prime.

124 Chapter 4 The Integers
(b) [BB] Express 16,773,121 as the product of primes
given that 433 is this number's smallest prime
factor.
4. Find the prime decomposition of each of the following
natural numbers.
(a)
(b)
(c)
(d)
(e)
(D
[BB] 856
2323
6647
9970
[BB] (28- 1)20
55,551,111
5. [BB] Use the Fundamental Theorem of Arithmetic to
prove that for no natural number n does the integer 14"
terminate in 0.
6. Let A = (' n 
Q 1 3 ,n).
(a) List five different elements of A at most one of
which is an integer.
(b) [BB] Prove that A is closed under addition.
(c) Prove that A is closed under multiplication.
7. Let A be any subset of Z \ {0) and, for a, b E A, define
a - b if ab is a perfect square (that is, the square of
an integer). Show that - defines an equivalence relation
on A.
8. True or false? Explain your answers.
(a) For all n E N, n > 1, there exists a prime p such
that p n.
(b) [BB] There exists a prime p such that p I n for all
n e N, n > I.
(The position of the universal quantifier makes a world
of difference!)
9. Define f: N \ {l} -* 
N by setting f(n) equal to the
largest prime divisor of n.
(a) Find the range of f.
(b) Is f one-to-one?
(c) Is f onto?
(d) Why did we not express f as a function N 
N?
Explain your answers.
10. Determine whether or not each of the following func-
tions N x N -* 
N is one-to-one. Explain your answers.
(a) [BB] f(n, m) = 2'6"
(b) f(n, mi) = 36m6"
11. (a) [BB] Find 
r(10) 
and approximate 
values of
10/ In 10 and 7(l() (three decimal place accuracy).
IO/ In 10
(b) Find r(50) and approximate values of 50/ In 50 and
7r(50)
50/ In 50
(c) Find nr(95) and approximate values of 95/ In 95 and
7r(95)
95/ In 95
12. (a) Use the Sieve of Eratosthenes to list all the primes
less than 200. Find r(200) and the values of
200/ In 200 and 2070T'00) (to three decimal places).
(b) Use the Sieve of Eratosthenes to list all the primes
less than 500. Find 7r(500) and the values of
500/ In 500 and 
(500) 
(to three decimal places).
13. Estimate the number of primes less than 5000, less than
50,000, less than 500,000, and less than 5,000,000.
14. [BB] Let p and q be distinct primes and n a natural
number. If p I n and q I n, why must pq divide n?
15. [BB] Given distinct positive integers a and b, show that
there exists an integer n > 0 such that a + n and b + n
are relatively prime.
16. For any natural number n, let d(n) denote the number of
positive divisors of n. For example, d(4) = 3 because
4 has three positive divisors; namely, 1, 2, and 4.
(a) Describe 
those natural numbers 
n for which
d(n) = 2.
(b) [BB] Describe those natural numbers n for which
d(n) = 3.
(c) Describe 
those natural numbers n for which
d(n) = 5.
17. (a) [BB] Is 215 -
I prime? Explain your answer.
(b) Is 291-I prime? Explain your answer.
(c) Show that if 2' - I is prime, then necessarily n is
prime.
(d) Is the converse of (c) true? (If n is prime, need 2' - I
be prime?)
18. (a)
(b)
(c)
[BB] Show that 26 + I is not prime.
Show that 220 + I is not prime.
Show that if 2" + I is prime, then necessarily n is
a power of 2.
19. (a) Show that the sum of two odd prime numbers is
never prime.
(b) Is (a) true if the word odd is deleted?
20. [BB] Show that the sum of two consecutive primes is
never twice a prime.
21. If n is an odd integer, show that x 2 -y
2 = 2n has no
integer solutions.
22. [BB] True or false: In E N I n > 2 and a' + b" =
cn for some a, b, c E N) = 0?

4.3 Prime Numbers 
125
23. [BB] Suppose that a, b, and c are integers each
two of which 
are relatively 
prime. 
Prove 
that
gcd(ab, bc, ac) = 1.
24. Let a, b, and c be integers each relatively prime to
another integer n. Prove that the product abc is rela-
tively prime to n.
25. Given that p is prime, gcd(a, p2 ) = p and gcd(b, p3) =
p2 , find
(a) [BB] gcd(ab, p4 )
(b) gcd(a + b, p4 )
26. Let Pi, P2, .. 
C Pn+J denote the first n + I primes (in
order). Prove that every number between P1 P2 
Pn +2
and PI P2... Pi +pnl+ X-I (inclusive) is composite. How
does this show that there are gaps of arbitrary length in
the sequence of primes?
27. If the greatest common divisor of integers a and b is the
prime p, what are the possible values of
(a) [BB] gcd(a 2, b)?
(b) gcd(a3 , b)?
(c) gcd(a 2 , b3)?
28. [BB] Let a and b be natural numbers with gcd(a, b) = I
and ab a perfect square; that is, ab = x2 for some
natural number x. Prove that a and b are also perfect
squares.
29. Let a and b be natural numbers.
(a) Find the prime decomposition of lcm(a, b) in terms
of the prime decompositions of a and b and prove
your answer. (See Problem 17, p. 118.)
(b) Use (a) to prove formula (2) of Section 4.2 in the
case a, b > 0: gcd(a, b) lcm(a, b) = ab.
30. [BB] Prove that an integer which is both a square (a2
for some a) and a cube (b3 for some b) is also a sixth
power.
31. Let a and b be integers. Let p be a prime. Answer true
or false and explain:
(a) [BB] If pla'1, then pIa.
(b) If p Ia and p I (a2 + b2 ), then p I b.
(c) If p I (a9 + a"7 ), then p I a.
32. [BB] Show that there are infinitely many triples of inte-
gers a, b, c which satisfy a2 + b2 = c2.
33. (a) [BB] Prove that every odd positive integer of the
form 3n + 2, n E N, has a prime factor of the
same form. What happens if the word odd is
omitted?
(b) Repeat (a) for positive integers of the form 4n + 3.
(c) Repeat (a) for positive integers of the form 6n + 5.
(d) Prove that there are infinitely many primes of the
form 6n + 5.
34. Suppose p and p + 2 are twin primes and p > 3. Prove
that 6 1 (p + I).
35. Let Q+ denote the set of positive rational numbers. If
" is in Q+, then
eitherm =Ior 
m =pp
2 * 
' 
pk 
is the product of
powers of distinct primes PI, P2. 
. Pk;
. either n = I or n = qf" f2 
. qfe 
is the product of
I1 q2  
q
powers of distinct primes qI, q2. 
. qe
and, in the case m # 1 and n :A 1, we may assume that
no pi equals any qj. Now define f: Q+ -+ 
N by
f(l) 
I 1
r2el 2e2 
2eki
PI P2  
... Pk 
if n-l,m 
1
2f, 
212 
i 
2fj-
f (n)= qf -Iq 
...- 2f- 
if m =1, n 7&1
i 
q2  
* 
f 
~ 
im-~~
p2el 
2ek 2f -I 
2fe - I
PIi 
... Pk qi 
.*q~ 
if m 
1, n
(a) Find f(8) [BB], f(1), f(100) and f(4Â°).
(b) Find x such that f(x) = 1,000,000 [BB], t such
that f(t) = 10,000,000 and s such that such that
f(s) = 365,040.
(c) Show that f is a bijection.
(This exercise, which gives a direct proof that the posi-
tive rationals are countable, is due to Yoram Sagher. See
the American Mathematical Monthly, Vol. 96 (1989),
no. 9, p. 823.)
36. For positive integers a and b, define a - b if there exist
integers n > I and m > I such that am = bV.
(a) Prove that - defines an equivalence relation on N.
(b) Find 3, 4, and 144.
(c) Find the equivalence class of a e N. [Hint: Write
a = p l 'pc2 ..
k. 
pk
~ 1 p2  
Pk J
37. (a) Write a computer program which implements the
Sieve of Eratosthenes as described in the text.
(b) Use your program to enumerate all primes less than
1 000.
(c) What is 7r(1000)? Compare this with approximate
values 
(three 
decimal 
place 
accuracy) 
of
1000/In 1000 and 
o0/ In1Â°nÂ°O

126 
Chapter 4 The Integers
4.4 
CONGRUENCE
111111=
If it is 11 p.m. in Los Angeles, what time is it in Toronto? If he or she were
aware that Los Angeles is three time zones west of Toronto, a person might
well respond (correctly) "2 a.m." The process by which the time in Toronto was
obtained is sometimes called clock arithmetic; more properly, it is addition module
12: 11 + 3 = 14 = 2 moduleo 12). It is based upon the idea of congruence, the
subject of this section.
Let n > I be a fixed natural number. Given integers a and b, we say that a is
congruent to b module n (or a is congruent to b mod n for short) and we write
a - b (mod n), if and only if n I (a -b). 
The number n is called the modulus of
the congruence.
EXAMPLES 18 
3 -
17 (mod 7) because 3 -
17 = -14 
is divisible by 7; -2 -
13 (mod 3)
because -2 
-
13 = -15 
is divisible by 3; 60 = 10 (mod 25); -4 
-
-49
(mod 9). 
A
As a binary relation on Z, congruence is
reflexive: 
a - a (mod n) for any integer a,
symmetric: 
if a 
b (mod n), then b - a (mod n) and
transitive: 
if a -
b (mod n) and b = c (mod n), then a = c
(mod n).
Congruence is reflexive because a -a = 0 is divisible by n. It is symmetric
because if n I (a -b), 
then n I (b -a) because b - a =-(a - b). It is transitive
because if both a - b and b -c are divisible by n, then so is their sum, which is
a -
c. Thus, for any n > 1, congruence mod n is an equivalence relation on Z.
We urge you to review the basic features of equivalence relations which were
discussed in Section 2.4. Recall, for instance, that an equivalence relation parti-
tions the underlying set into subsets called equivalence classes, the equivalence
class of an element being the set of those elements to which it is equivalent. The
equivalence classes of congruence mod n are called congruence classes.
MEMM 
S
The congruence class mod n of an integer a is the set of all integers to which a
is congruent mod n. It is denoted ai. Thus,
aI =[bEZla-b (modn)}.
[Since congruence mod n is symmetric, we do not have to remember whether to
write a -
b (mod n) or b -
a (mod n) in this definition. You can't have one
without the other!]
EXAMPLE 19 
Let n = 5. Since -8 -17 
= -25 is divisible by 5, we have -8 -
17 (mod 5).
Thus, -8 belongs to the congruence class of 17; in symbols, -8 E 17. Notice also
that 17 c-8. In fact, you should check that -8 = 17. (See Proposition 4.4.3.)
A
Let us find all congruence classes of integers mod 5. To begin,
0 
{b c Z I b = 0 
(mod 5)}

4.4 congruence 127
= {b E Z 1 51 (b-O)}
= lb E Z I b = 5k for some integer k)
and
1={b E Z I b-I 
(mod 5)}
{b e Z 1 5 |(b- 1))
= {b E Z I b -1 
= 5k for some integer k}
= {b C Z I b = 5k + 1 for some integer k).
In Section 2.4, we introduced the notation 5Z and 5Z + 1 for these sets 0 and 1,
respectively. Continuing, we find that
2 
l lb c Z I b = 5k + 2 for some k E ZJ = 5Z + 2
3={b E 7 I b = 5k + 3 for some k E ZI = SZ + 3
and
4 = {b E Z I b = 5k + 4 for some k E Z} = 5Z + 4.
It is useful to observe that the five congruence classes determined so far par-
tition the integers in the sense that they are pairwise disjoint and their union
is Z.
Why are they pairwise disjoint? If a E (5Z + r) n (5Z + s) for 0 < r, s < 4,
then a = 5k + r = t + s for some integers k and f and so r-s 
= 5(f -k)
would be a multiple of 5. For r, s between 0 and 4 this can only happen if
r = s.
Why is their union Z? For any a E Z, by the Division Algorithm (Theo-
rem 4.1.5), we can write a = Sq + r with q, r integers and 0 < r < 5. Since
r E {O, 1, 2, 3, 4}, the integer a is in 5Z, 5Z + 1, 5Z + 2, 5Z + 3, or 5Z + 4.
Since congruence classes are equivalence classes and, in general, any two
equivalence classes are disjoint or equal (Proposition 2.4.4), it follows that for
any integer n, it must be one of 0, 1, 2, 3, or 4. With which of these classes, for
example, does 5 coincide? Observe that 5 E 5, since 5 -
5 (mod 5). Also, as
noted previously, 5 c 0. Since the classes 0 and 5 are not disjoint, they are equal:
5 =0.- 
-- 
-
Similarly, since 6 belongs to both 6 and 1, we have 6 = 1. You should also
see that 7 = 2, 8 = 3, -14= , and so on.
Our next few results are almost immediate consequences of the theory of
equivalence relations.
Let a, b, and n be integers with n > 1. Then the following statements are
equivalent.
(1) n(a 
-b).
(2) a -
b (mod n).
(3) a E b.
KMMM

128 
Chapter 4 The Integers
(4) b E a.
(5) a = b.
Proof 
Each of the implications (1) -* 
(2) -* 
(3) is a direct consequence of definitions
and (3) 
(4) follows from the symmetry of congruence. We may therefore
complete the proof by establishing (4) -* 
(5) and (5) -* 
(1). To see that (4) -*
(5), let b E a. Then b - a (mod n) so a 
b by Proposition 2.4.3. To see that
(5) -* 
(1), suppose that a = b. Then a E b because a c a, so a =- b (mod n)
and n I (a -b). 
I
Of all the equivalences established in Proposition 4.4.3, we emphasize perhaps
the most important one.
ES, 
I
For integers a, b, and n with n > 1,
I 
a =- b 
(mod n) if and only if =b.
The next proposition generalizes the special case n = 5, which we have
already investigated.
Any integer is congruent mod n to its remainder upon division by n. Thus, there
are n congruence classes of integers mod n corresponding to each of the n possible
remainders
0 
=nZ
1 =nZ-+ 1
2 
=nZ-+ 2
n -I 
nZ +(n-1).
These congruence classes partition Z; that is, they are disjoint sets whose union
is the set of all integers.
Proof 
Suppose a is an integer. The remainder when a is divided by n is the number
r, 0 < r < n, obtained when we write a = qn + r according to the Division
Algorithm (Theorem 4.1.5). Since a -r 
= qn is divisible by n, we obtain a -
r
(mod n), as claimed.
Since 0 < r < n, the integer r is one of 0, 1, 2, . .
- 1. Thus, a belongs
to one of the specified classes. It remains only to show that these classes are
disjoint. For this, note that if rl, r2 c tO. , . .., n-1}, 
then r, V r2 (mod n).
Thus, rl c rj, but r, 
Â¢ r2, so the congruence classes FT and r2 are not equal. Since
congruence classes are equivalence classes, Fr nr2 = 0, by Proposition 2.4.4. Thus,
the classes 0. 
. , n-I 
are indeed disjoint. 
1
EXAMPLE 20 
Suppose n = 32. There are 32 congruence classes of integers mod 32; namely,
0 = 32Z, 
I = 32Z + 1, ... 
31 = 32Z + 31.

4.4 congruence 
129
-
36
EXAMPLES 21
To determine the class to which a specific integer belongs, say 3958, we use the
Division Algorithm to write 3958 = 123(32) + 22.6 Thus, 22 is the remainder, so
3958 = 22 (mod 32) by Proposition 4.4.5 and 3958 E 22. 
A
Find an integer r, 0 < r < 18, such that 3958 -
r (mod 18). Do the same for
-3958.
Proposition 4.4.5 says that every integer is congruent modulo n to one of the
n integers 0, 1, 2, ... , n - 1. Therefore, when working mod n, it is customary to
assume that all integers are between 0 and n - I (inclusive) and to replace any
integer a outside this range by its remainder upon division by n. This remainder
is called "a (mod n)" and the process of replacing a by a (mod n) is called
reduction module n.
If n > 1 is a natural number and a is any integer, a (mod n) is the remainder r,
o < r < n, obtained when a is divided by n.
-17 (mod 5) = 3, 28 (mod 6) = 4 and -30 (mod 9) = 6.
The integer 29 reduced modulo 6 is 5. 
A
Just as for equations, to "solve" a congruence or a system of congruences
involving one or more unknowns means to find all possible values of the unknowns
which make the congruences true, always respecting the convention given in
Definition 4.4.6. Without this convention, any even number is a solution to the
congruence 2x - 0 (mod 4). With the convention, however, we give only x = 0
and x = 2 as solutions.
PROBLEM 22. 
Solve each of the following congruences if possible. If no solu-
tion exists, explain why not.
(a) 3x 
1 (mod 5)
(b) 3x 
1 (mod 6)
(c) 3x 
3 (mod 6)
Solution. 
Simple congruences like these with small moduli are probably best
solved by trying all possible values of x mod n.
(a) 
If x = 0, 3x = 0-0 
(mod 5).
If x = 1, 3x = 3-3 
(mod 5).
If x = 2, 3x = 6 
1 
(mod 5).
lfx =3, 3x =9-4 
(mod5).
If x = 4, 3x = 12 = 2 
(mod 5).
Since the modulus is 5, we want x in the range 0 < x < 5. Thus, the only
solution to the congruence is x = 2.
6Remember the easy way to see this. Use a calculator to compute 3 
123.68 .... The integer part of
32 
i
this number (the floor of 398)is the quotient given by the Division Algorithm. Refer to Proposition 4.1.6.

130 
Chapter 4 The Integers
(b) There is no solution to this congruence because the values of 3x (mod 6)
are just 0 and 3:
3(0) = 0, 
3(1) =3, 
3(2) = 6 -0,
3(3) = 9 = 3, 
3(4) =12 - 0, 
3(5) =15 = 3.
(c) The calculations in part (b) show that 3x 
3 (mod 6) has solutions x = 1,
x =3, and x =5. 
1
Suppose we want to find the sum 1017 + 2876 (mod 7). This can be accom-
plished in two ways. We could evaluate 1017 + 2876 = 3893 =1 (mod 7),
but equally, we could reduce the integers 1017 and 2876 modulo 7 first like
this:
1017-2 
(mod 7)
2876 
6 
(mod 7)
1017+2876-2+6=8=- 1 
(mod 7).
The second approach is particularly useful when forming products since it
keeps the numbers involved small. Observe:
(1017)(2876) 
(2)(6) = 12 -
5 
(mod 7).
Computing powers of an integer modulo a natural number n is often just
a mental (rather than calculator) exercise if we continually work mod n. For
example,
(1017)2 22 = 4 
(mod 7)
(1017)3 
(1017)2(1017) 
4(2) = 8 -
1 (mod 7)
(1017)4 = (1017)3(1017) 
1(2) = 2 
(mod 7)
(1017)5 = (1017)4(1017) 
2(2) = 4 
(mod 7)
and so on. Here is an easy way to compute (1017)12:
(1017)12 = ((1017)4)3 -
23 = 8 = I 
(mod 7).
The following proposition describes the general principles which guarantee
that the sorts of calculations we have been performing are valid.
If a - x (mod n) and b -y 
(mod n), then
(a) a + b 
x + y (mod n) and
(b) ab - xy (mod n).
Direct proofs of each part are suggested, and these we provide.
(a) We have to check that (a + b) -(x + y) is divisible by n. This difference
is (a - x) + (b - y), which is the sum of two numbers each divisible by
n, so the difference is itself divisible by n.
-
- -
6
Proof

4.4 congruence 
131
(b) We have to check that ab - xy is divisible by n. Subtracting and adding
ay, we notice that
ab -xy = ab -ay + ay -xy = a(b-y) + (a-x)y,
each t rm on the right again being divisible by n. Thus, ab -xy 
is
divisible by n. 
I
PROBLEM 23. 
Suppose a and b are integers and 3 (a2 + b2). Show that 31 a
-]r 'I I 1
...- 
I I 1.
Solution. 
We
false, then a =-
or 4 (mod 3).
b= 1 (mod 3
a contradiction
While addi
we must be exc
each side of tl
false statement
by an integer N
proposition. (M
JJL0 
~ 
If ac E= bc (m
For examp
(mod 3) becau
6x -- 3 (mod
second congrui
multiplying a co
the congruence
(mod 9) are dii
Solve 2x E= I (
PROBLEM 24
If no solution c
(a)x + 3y .
x + 3y
(b) 2x +3y .
x +3y
wish to prove that a =E 0 (mod 3) and b =E 0 (mod 3). If this is
1 or 2 (mod 3) and so, by part (b) of Proposition 4.4.7, a2 = 1
Since 4 = 1 (mod 3), we must have a2 -
I (mod 3). Similarly,
and so, by (a) of the proposition, a2 + b2 - I + I = 2 (mod 3),
I
tion and multiplication of congruences behave as we would hope,
.edingly careful when dividing each side of a congruence. Dividing
e congruence 30 =E 12 (mod 9) by 3, for example, produces the
10 EE 4 (mod 9). In general, we can only divide a congruence
/hich is relatively prime to the modulus, as asserted by the next
'e leave its proof to the exercises.)
d n) and gcd(c, n) = 1, then a =E b (mod n).
e, given 28 =E 10 (mod 3), we can divide by 2 and obtain 14 = 5
se gcd(2, 3) = 1. The linear congruences 2x 
1 I (mod 7) and
7) have the same solutions since we can divide each side of the
nce by 3, this being relatively prime to 7. On the other hand,
lngruence by a number not relatively prime to the modulus changes
. For example, the solutions to 2x 
E- 
I (mod 9) and 6x =E 3
ferent!
mod 9) and 6x =E 3 (mod 9).
Solve each of the following pairs of congruences, if possible.
xists, explain why not.
=- 1 (mod 6)
=- 4 (mod 6)
E- I (mod 6)
=- 5 (mod 6)
Solution. 
Welsolve simple systems of linear congruences by the ad hoc methods
with which we first solved systems of linear equations, by adding and subtracting
and occasionally multiplying, though only by numbers relatively prime to the
modulus (for a reason illustrated by Pause 13).
(a) Adding the two congruences gives 3x + 6y =- 5 (mod 6). Since 6y =- 0
(mod 6), we have 3x EE 5 (mod 6). This congruence has no solution because
-
-
MM

132 
Chapter 4 The Integers
the values of 3x (mod 6) are 0 and 3. Thus, no x, y satisfy the given pair
of congruences.
(b) This time, adding the two congruences gives 3x -0 
(mod 6) and hence
x -
0, x -2 
or x -
4 (mod 6). If x -
0, then the second congruence
says 3y = 5 (mod 6) to which there is no solution. If x -
2, the second
congruence says 2 + 3y -
5, hence 3y 
3 (mod 6), so y 
I (mod 6),
y -
3 (mod 6) or y 
5 (mod 6). If x 
4, the second congruence reads
4 + 3y -
5, so 3y 
1 (mod 6) and there is no solution. The pair of
congruences has three solutions: x = 2 (mod 6) and Y - I (mod 6), y - 3
(mod 6) or y -. 5 (mod 6). 
I
. ... .. .. \ . A@ 
\ .............................
\ \ ; .. A.......... 
........... 
...... ............. -.. -.
Every integer a has an additive inverse modulo n, that is, there exists an
integer x satisfying a + x - 0 (mod n); for example, take x =-a 
or x = n - a
to respect the convention in 4.4.6 above. The existence of additive inverses means
that congruences of the form a +x - b (mod n) always have a solution obtained
by adding the additive inverse of a to each side: x = b + (-a) = b - a. On the
other hand, not every congruence of the form ax - b (mod n) has a solution.
The congruence 3x -b 
(mod 6) may not have a solution (for example, when
b = 1). Contrast this with the congruence 3x - b (mod 7), which has a solution
for any b since each of the integers 0, 1, 2, 3, 4, 5, 6 is 3x (mod 7) for some x:
3(0) =0, 
3(1) =3, 
3(2) = 6, 
3(3) 
9 - 2,
3(4) = 12 
5, 
3(5) 
15 - 1, 
3(6) =18 
4 
(mod 7).
A solution to 3x = I (mod 7), for instance, is x = 5. The difference between
3x -
b (mod 6) and 3x - b (mod 7) is the modulus. In the second case, 3 is
relatively prime to the modulus, 7, whereas in the first case, it is not.
Let n > I be a natural number and let a be an integer with gcd(a, n) = 1.
(a) There exists an integer s such that sa -
I (mod n). [We call s a multi-
plicative inverse of a (mod n).]
(b) For any integer b, the congruence ax 
b (mod n) has a solution.
(c) The solution to ax -b 
(mod n) is unique mod n in the sense that if
axj - b (mod n) and ax2 = b (mod n), then xl -
x2 (mod n).
(a) By Theorem 4.2.9, the greatest common divisor of two integers is a linear
combination of them. Here, since gcd(a, n) = 1, we know there are
integers s and t such that sa + tn = 1 . Since sa -
I is divisible by n,
sa - I (mod n).
(b) By part (a), we know that a has an inverse s (mod n). Multiplying the
congruence ax - b by s, we have sax - sb (mod n) and so x = sb. It
is straightforward to verify that x = sb is indeed a solution to ax -
b
(mod n) since a(sb) = (as)b -I 
(b) = b (mod n).
(c) Uniqueness follows directly from Proposition 4.4.8. Since gcd(a, n) 
1,
if ax, = ax2 (mod n), then xj - x2 (mod n). 
U
It is useful to observe that our proof [in part (b)] that ax -
b (mod n) has
a solution which essentially repeats the steps by which we solve the equation
e.g 
S
Proof

4.4 congruence 133
ax = b in real numbers. To solve ax = b, with a, b real numbers and a 6 0, we
multiply both sides by the (multiplicative) inverse of a to obtain x = a-lb. We
solve the congruence ax - b (mod n) exactly the same way. The only problem
is to find the inverse of a (mod n), if this exists.
PROBLEM 25. 
Solve the congruence 20x = 101 (mod 637).
Solution. 
We use the method described in the proof of Proposition 4.4.9. Write
-7(637) + 223(20) = 1 and obtain 223(20) -
I (mod 637). Thus, 223 is the
inverse of 20 (mod 637). Multiplying each side of the given congruence by 223
gives x - 223(101) = 22,523 - 228 (mod 637). Thus, x = 228 provides a solu-
tion and one which is unique mod 637: Any other solution is congruent mod 637
to 228. 
I
PROBLEM 26. 
Part (a) of Proposition 4.4.9 says that if gcd(a, n) = 1, then a
has an inverse mod n. Show that the converse is also true: If a has an inverse
mod n, then gcd(a, n) = 1.
Solution. 
If a has an inverse mod n, there is an integer s such that sa =1
(mod n), so sa - I = qn for some integer q. Writing this as I = sa - qn, it
follows that any natural number which divides both n and a must divide I and
hence be 1. So gcd(a, n) =1. 
I
As another application of Proposition 4.4.8, we derive Fermat's Little Theorem.
What was Fermat's "big" theorem?
If p is a prime and p ,lc, then cP-I 1 
I (mod p).
We have gcd(c, p) = 1. Thus, by Proposition 4.4.8, no two of the integers c, 2c,
... , (p - I)c are congruent mod p. The same proposition also shows that none
of the elements c, 2c, ... , (p -I)c is 0 (mod p). Thus, modulo p, the p - I
integers c, 2c, . . .(p- 
1)c are precisely 1, 2, . . ., p-1, 
in some order. Thus,
c 2c 3c .. (p- 
1)c = 1 2 3 .. (p -1) 
(mod p).
Letting x = 1 2 . 3... (p -1),7 
this equation reads
xcP-I 
- x 
(mod p)
and, since gcd(p, x) = 1, we can cancel x and obtain cP- 
=1, 
as required. 
I
Because of Fermat's Little Theorem, none of the congruences 22 =1 (mod 3),
46 =1 (mod 7), 910 -
1 (mod 11) are surprises. Similarly, since 13,331 is
prime, Fermat's Little Theorem shows 413,330 -
I (mod 13,331), 413,331 = 4
(mod 13,331), and 413,332 -
16 (mod 13,331).
7The product of all the integers from I to n inclusive is commonly denoted n!-read "n factorial"-so
we could also write (p -)! 
instead of x. See Definition 5.1.2.
Proof

134 
Chapter 4 The Integers
A 
*
Explain the last two congruences here.
12. An integer a is congruent (mod 18) to its remainder when it is divided by
18. Since 3958 = 219.8, [3958 
= 219 and we find 3958 = 219(18) + 16.
18 
-8
The remainder is 16, so 3958 -
16 (mod 18). Similarly, L-3958j = -220,
so -3958 =-220(18) + 2 and -3958 - 2 (mod 18).
13. 2x -1 
(mod 9) implies x = 5, but 6x -
3 (mod 9) implies x = 2, x = 5
or x = 8.
14. Theorem 4.3.14.
15. 413,331 = 4(413.330) - 4(1) = 4 (mod 13,331);
413,332 
-
4(4)(413X330) -
16(1) = 16 (mod 13,331), using Fermat's Little
Theorem in each case to deduce that 413,330 = I (mod 13,331).
The symbol [BB] means that an answer can be found in the Back of the Book.
1. [BB] This question concerns congruence mod 7.
(a) List three positive and three negative integers in 5
and in 
3.
(b) What is the general form of an integer in 5 and of
an integer in -3?
2. This question concerns congruence mod 13.
(a) List four positive and five negative integers in 3 and
in -2.
(b) What is the general form of an integer in 3 and of
an integer in 
2?
3. Find a (mod n) in each of the following cases.
(a) [BB] a = 1286, n = 39
(b) a = 43,197, n = 333
(c) [BB] a =-545,608, n = 51
(d) a --
125,617, n 
315
(e) a 
T 
1reo 
f 
1, 
GIv1,e 
1, n = 
eac 
ans
4. True or false? Give a reason for each answer.
(a)
(b)
(c)
(d)
(e)
[BB] 2 = 18 (mod 10)
7 c-13 (mod 5)
[BB] -8 - 44 (mod 13)
With respect to congruence mod 29, 17 nf 423
-1 8 V 400 (mod 19)
0
5. List all congruence classes giving the most usual and
one other name for each.
(a) [BB] congruence mod 3
(b) congruence mod 5
(c) congruence mod 8
6. Carry out each of the indicated calculations, giving the
answer mod n.
(a) [BB] 21,758,623 + 17,123,055, n = 6
(b) (21,758,623)(17,123,055), n = 6
(c) (17,123)50, n = 6
(d) 104, 108, 1012, 1020, 1024, n 
7
(e) [BB] 2, 22, 23, ... , 210, n = 11
(f) 4, 42, 43, 44, 45, 46 47 48, 49 410 n = I1
7. Find a + b (mod n), ab (mod n) and (a + b)2 (mod n)
in each of the following situations:
(a)
(b)
(c)
a = 4003, b = -127, 
n = 85
a = 17,891, b = 14,485, n = 143
a = -389,221, 
b = 123,450, n = 10,000
8. [BB] If a E Z and a E 0 (mod 7), show that a -
54
(mod 7) for some integer k.
9. Find all integers x, 0 < x < n, satisfying each of the fol-
lowing congruences mod n. If no such x exists, explain
why not.
(a) [BB] 3x - 4 (mod n), n = 6
(b) 4x -2 
(mod n), n = 6
(c) 4x -3 
(mod n), n = 7
(d) 4x-3 (mod n), n = 6
(e) [BB] 2x -
18 (mod n), n 
50
(f) [BB] 5x-I 
(mod n), n =11
(g) Sx -S 
(mod n), n = 25
(h) 4x -301 
(mod n), n = 592
(i) 65x -
27 (mod n), n = 169
() 
4x - 320 (mod n), n = 592
ffVT1_1MMM__

4.4 congruence 
135
(k) [BB] 16x -
301 (mod n), n = 595
(1) 79x = 15 (mod n), n = 722
(m) 155x -
1185 (mod n), n = 1404
10. (a) Given integers a, b, c, d, x, and a prime p, suppose
(ax+b) (cx+d) )0 
(mod p). Prove that ax+b - 0
(mod p) or cx + d -
0 (mod p).
(b) Find all integers x, 0 < x < n, which satisfy each
of the following congruences. If no x exists, explain
why not.
i. [BB] x2 - 4 (mod n), n = 13
ii. (2x + 1)(3x + 4) - 0 (mod n), n = 17
iii. 3x2 + 14x-5 - 0 (mod n), n = 97
iv. [BB] x2 = 2 (mod n), n = 6
v.x 2 -- 2 (mod n),n =6
vi. 4x 2 +3x+7=-0 (modn),n=5
11. Find all integers x and y, 0 < x, y < n, which satisfy
each of the following pairs of congruences. If no x, y
exist, explain why not.
(a) [BB] 2x + y 
I (mod n)
x + 3y 
3 (mod n)
(b) [BB] 
x + 5y 
3 (mod n)
4x + 5y 
I (mod n)
(c) 
x +5y-3 (mod n) 
n
4x + 5y-I (mod n)
(d) 7x + 2y=3 (mod n) 
n
9x + 4y -6 
(mod n)
(e) 3x + 5y 
14 (mod n)
5x + 9y - 6 (mod n)
n = 6
n = 
8
-= 15
n = 28
12. [BB] Prove Proposition 4.4.8.
13. [BB] If a 
-
b (mod n), show that gcd(a, n) 
=
gcd(b, n).
14. Let a and n be natural numbers with n > 1. Let r and s
be integers and suppose r - s (mod n). True or false?
Explain.
(a) [BB] ar = as (mod n)
(b) ra - Sa (mod n)
15. Suppose a and b are integers, n > 1 is a natural number,
and a - b (mod n). True or false? In each case, prove
or give a counterexample.
(a) [BB] 3a = b2 (mod n)
(b) a 2 -b
2 (mod n)
(c) a2  
b3 (mod n)
(d) a2
b2 (mod n2 )
16. (a) [BB] Use the result of Problem 23 to prove that X2
is irrational; that is, show that it is impossible to
write X2 = ' for integers a, b. [Hint: Without loss
of generality, assume that a and b have no com-
mon factors, other than Â±l. Why is there no loss of
generality?]
(b) Let n be a natural number, n -
2 (mod 3). Use
Problem 23 to prove that >/E is irrational.
17. (a) Find all integers x, 0 < x < n, which satisfy each
of the following congruences.
i. x2- I (mod n),
i. x2 -
I (mod n),
M. x 2 = I (mod n),
n = 5
n =7
n = 13
(b) [BB] Suppose p :# 2 is a prime. Find all integers x,
0 < x < p, such that x2 = 1 (mod p).
18. (a) Find all integers x, 0 < x < n, which satisfy each
of the following congruences.
i. [BB] x 2 =1 (mod n), n = 52
ii. x 2  
I (mod n), n = 53
iii. x2 = 1 (mod n), n = 72
(b) Suppose p : 2 is a prime and k is any natural
number. Find all integers x, 0 < x < pk. which
satisfy x2 -
I (mod Pk).
19. (a) Find all integers x, 0 < x < n, which satisfy each
of the following congruences.
i. x 2 
1 (mod n), n = 2
H. x 2 -
1 (mod n), n = 22
iii. x 2 
=1 (mod n), n = 23
iv. x29- 
I (mod n), n = 24
(b) Let k be a natural number. Find all integers x, 0 <
x < 2 k, which satisfy X2 = I (mod 2k).
20. In each of the following, the given integer p is a prime.
(a) [BB] Find 188970, 188971 and 188972, each mod p,
p = 8971.
(b) Find 5320,592 
5320,593 
5320,594 each mod p, p =
20,593.
(c) Find 3508, 3509, 3512, each mod p, p = 509.
(d) Find 610588, 610589, 610,594, each mod p, p =
10,589.
(e) Find 84056, 84058, 84060, each mod p, p = 4057.
(f) Find 23948 and 23941 (mod p), p = 3943.
21. [BB] Show that x 97- x + I - 0 (mod 97) has no solu-
tions.
22. Let A be the set of congruence classes of integers mod-
ulo some natural number n. For a, b E A, define a -< b if

136 
Chapter 4 The Integers
ab - a2 (mod n). Prove or disprove that < is a partial 
(b) n = pq is the product of two distinct primes.
order in each of the following cases. 
(c) n is divisible by the square of a prime. [Flint: It
(a) n = p is a prime. 
might be helpful first to consider the case n = 12.1
4.5 
APPLICATIONS OF CONGRUENCE
International Standard Book Numbers
Since 1968, most published books have been assigned a ten-digit number called
the International Standard Book Number-abbreviated ISBN- which identifies
the country of publication, the publisher, and the book itself. In fact, all relevant
information is stored in the first nine digits; the tenth digit is a check digit whose
sole purpose is to give us confidence that the first nine digits are correct.
When a university department wishes to place an order for textbooks for a
forthcoming semester, it is common for each faculty member to send to some
administrative person the ISBNs of the books he or she will use and then for a
single list of all desired ISBNs to be produced and sent to the bookstore. There
lists from many departments are collected, grouped in various ways, and sent to
publishers. It is not hard to see that there are many opportunities for numbers to
be copied incorrectly. Thus, some easy way to encourage accuracy is essential. If
the digits of an ISBN are denoted al, a2, . . , alo, with the first nine in the range
0-9, then amo is chosen in the range 0-10 so that
(6) 
al + 2a2 + 3a3 + .+ 
9ag + l0alo - 0 
(mod 11).
If alo happens to be 10, it is recorded as an X.
For example, if the first nine digits are 0-936031-03, the tenth digit is chosen
so that
1(0) + 2(9) + 3(3) + 4(6) + 5(0)
+ 6(3) + 7(1) + 8(0) + 9(3) + 10alo - 0 
(mod 11);
thus, 103 + M0ato 
0 (mod 11), so ale = 4. The ISBN would be recorded as
0-936031-03-4. If this number were copied to another list with an error in the fourth
digit, say as 0-935031-03-4, a computer could easily check that
1(0) + 2(9) + 3(3) + 4(5) + 5(0) + 6(3) + 7(1) + 8(0) + 9(3) + 10(4)
=139-7 
0 
(modll)
and hence the existence of a mistake would come to light. Note that it would
be necessary to check previous lists to determine the precise error. Obtaining 7
instead of 0 as the result of our calculation provides no clue as to which digit
was in error. For instance, the number 0-936031-53-4 also differs from the correct
ISBN in one digit and for it we again have
I(0) + 2(9) + 3(3) + 4(6) + 5(0) + 6(3)
+ 7(l) + 8(5) + 9(3) + 10(4) = 183 - 7 (mod 11).

4.5 Applications of Congruence 
137
MM
We can show that the test given in (6) always detects errors in single digits
(see Exercise 5), although it is quite possible for errors in two digits to cancel
each other and so to go undetected.
Change two digits in 0-936031-03-4 so that al + 2a2 + 3a3 + 
+ 9a9 + l0ato= 0
(mod 1) (and hence the changes would not be detected by our test).
On the other hand, when a number is copied, a common error is for consecu-
tive digits to be transposed: We might dial the phone number 754-3628 instead of
754-3268, for instance.
PROBLEM 27. 
Show that the test in (6) detects transpositions of consecutive
digits.
Solution. 
If ala2 ... alo is a correct ISBN number, then
a = al + 2a2 + 
+ iai + (i + I)ai+l + 
O+ 0alo=0 (mod lI).
Suppose that the digits ai and aj+j are transposed. We claim that the miscopied
number a0a2 .. ai+ai... alo does not satisfy (6). To see this, let
b = al + 2a2 + 
+ iai+l + (i + 1)a + 
-+ l0ato
and note that a -
b = i(ai 
ai+Â±) + (i + l)(ai+l - aj) = aj+l -aj. 
Since
0 < a0, aj+1 < 9, the difference ai+l-ai cannot be 0 (mod 11) (unless ai = ai+j,
in which case there was no transposition error) and so a f b (mod 
1) and b # 0
(mod 
1). The miscopied number does not pass the test. 
I
We conclude this section by observing that the test given in (6) can be abbre-
viated by writing it in the form w 
a -
0 (mod l1), where a is the vector
(al, a2, .
0 
. , aIo), w the weight vector (1, 2, . . .1, 0) and 
. denotes dot product.
For readers unfamiliar with the concepts of vector and dot product, a vector is an
n-tuple of numbers, (al, a2, ... , an) (n can be any natural number), and the dot
product of a = (a1, a2, . . ., an) and b = (bI, b2, . .., bn) is the number
a b = a1bI + a2b2 + * * + an bn 
|
These notions are not critical to an understanding of this section but useful, per-
haps, to students with some linear algebra background.
Universal Product Codes
Check digits permeate today's society. Besides forming part of an ISBN, they are
attached to identification numbers of airline tickets, money orders, credit cards,
bank accounts, drivers' licenses, and most items found in stores.
Figure 4.4 shows the kind of universal product code (UPC) with which North
American consumers are familiar. Most goods for sale today can be identified
uniquely by a special number called a universal product number. A universal
product code is a way to represent a universal product number as a pattern of
black and white stripes of various thicknesses. For obvious reasons, a universal
product code is also called a bar code. (Later we shall see how this code works.)

138 
Chapter 4 
The Integers
0 
64200 1 1589 
6
Figure 4.4 
A universal product code.
The universal product numbers we want to discuss are 12-digit numbers of
the form x-xxxxx-xxxxx-x, where each x stands for a single digit between 0 and
9; for example, 0-12345-67890-1. The last digit is a check digit which serves to
affirm (with some degree of confidence) the accuracy of the preceding eleven. For
example, the universal product number shown in Fig 4.4 is 0-64200-11589-6 and 6
is the check digit. It is not unusual for a scanning device to misread a bar code.
The use of a check digit, therefore, provides a way to alert the cashier that the
number must be read again.
The check digit is determined by the rule
(7) 
3(sum of digits in odd positions)
+ (sum of digits in even positions) - 0 
(mod 10).
For the number encoded by the bar code in Fig 4.4, for instance, we have
sum of digits in odd positions = 0 + 4 + 0 + I + 5 + 9 = 19
sum of digits in even positions = 6 + 2 + 0 + I + 8 + 6 = 23
and 3(19) + 23 = 80 -. 0 (mod 10).
As with ISBNs, the rule for determining the check digit of a universal product
number can be phrased in the language of vectors. If al-a2 ... a6-a 7 ... aj I-a12
is a universal product number and a denotes the vector (al, a2, 
1 
.
2), then (7)
just says w a -= 0 (mod 10) for a certain weight vector w.
What is w?
Finally, we consider the nature of a bar code itself. Notice that the bar code
in Fig 4.4 begins and ends with a black-white-black sequence of thin stripes and
is separated into distinct halves by a white-black-white-black-white sequence of
thin stripes. In each half of the code, each of the digits 0-9 corresponds to a
sequence of four stripes of varying thicknesses. In the left half, the pattern is
white-black-white-black; in the right half, it is black-white-black-white.
Using 0 to denote a thin white stripe and 00, 000, 0000 to denote increasingly
thicker white stripes and, similarly, using I to denote a thin black stripe and 11,
1 1 1, 1 1 1 1 to denote increasingly thicker black stripes, Table 4.2 shows the right
and left stripe sequences to which each digit in the range 0-9 corresponds. For
example, on the left, 6 is encoded 0 1 11, 
that is, by
thin white (0) -
-
-
thin black (1) ---
thin white
(0)--- 
thickest black (1 1 11).

4.5 Applications of Congruence 
139
Table 4.2 
The pattern of stripes
used to encode each of the digits
0-9 on the left and right sides of a
bar code.
Encoding
Digit On left side 
On right side
0 
0001101 
1110010
1 
0011001 
1100110
2 
0010011 
1101100
3 
0111101 
1000010
4 
0100011 
1011100
5 
0110001 
1001110
6 
0101111 
1010000
7 
0111011 
1000100
8 
0110111 
1001000
9 
0001011 
1110100
Note that the stripe sequence which encodes a digit on the right can be
obtained from the stripe sequence on the left by interchanging black and white.
(Also note that there is no connection between the sequences used to encode a
digit and the base 2 representation of that digit.)
Only for convenience of the consumer is the universal product number some-
times written beneath the sequence of stripes which encodes it. The scanning
device used by the cashier to read the code is, of course, only able to detect light
and dark stripes.
How does such a device know whether a bar code has been passed over it
from left to right or from right to left? Suppose the first four stripes read by the
scanner are 0011101. At first thought, we might assume that this was the code
for a digit on the left (after all, it begins with a white stripe), but it could also
be the code for a digit on the right read backward (since it ends with a black
stripe). Notice, however, that there is no digit whose left code is 0011101; thus,
the scanner has read from right to left and the last digit in the product number
has been coded 1011100 (the digits of 0011101 in reverse); the last digit in the
product number must be 4. Since the sequence of stripes used to encode a digit,
when taken in reverse order, is not the sequence of any other encoding, the scanner
always knows the direction in which it is reading the code.
There is a simpler way to tell whether the code is being read left to right or
right to left. Can you find it? (Study the sum of the digits in the codes given in
Table 4.2.)

140 Chapter 4 The Integers
We refer readers who wish to learn more about check digits to a very inter-
esting article by Joseph A. Gallian which appeared in 1991 in an issue of The
College Mathematics Journal.8
The Chinese Remainder Theorem
The notion of congruence is so basic and useful that some people just have to
spread the word. In the lunch room the other day, a discrete math student (DMS)
boasted to his friend as follows:
DMS: Calculators are neat, but there are lots of ways to work with
numbers without having to use one. The trick is to keep the numbers
small by working with remainders.
Friend: What do you mean?
DMS: I'm thinking of a three digit number. When I divide it by 12, I
get a remainder of 4.
Friend: So what?
DMS: When I divide the same number by 25, I get a remainder of 15.
Friend: So what?
DMS: What was my number? I'll give you a hint. It's bigger than 200
but smaller than 500.
Friend (10 minutes later): I give up.
DMS: It's easy. I'll show you how to do it. (See Exercise 19.)
We conclude this section by considering certain systems of simultaneous con-
gruences. The system
x 
1 (mod 4)
x 
0 
(mod 30),
for example, has no solution because the first congruence says x is odd while the
second says x is even. This situation occurs precisely because the moduli, 4 and
30, are not relatively prime.
Suppose m and n are relatively prime natural numbers. Then, for any integers
a and b, the pair of congruences
8 
x-a 
(modm)
(8) 
x-=b (mod n)
has a solution. One way to see this is to note that there are integers s and t such
that sm +-tn 
= 1, by Theorem 4.2.9. Thus, x = a(tn) +b(sm) is a solution to (8)
since tn = I (mod m) and sm =1 (mod n). Moreover, x is unique mod mn in
the sense that, if x' is another solution, then x = x' (mod in). For this, observe
that if x and x' both satisfy (8), then x - x' is divisible by both m and n and
hence by in. (See Exercise 10 of Section 4.2.)
PROBLEM 28. 
Solve the system 
x 
2 (mod 4)
x -6 
(mod 7).
8Joe Gallian, "The Mathematics of Identification Numbers," The College Mathematics Journal 22, No.
3 (May 1991).

4.5 Applications of Congruence 
141
Ur h'I I]  a
6*
Solution. 
We write I = (-1)(7)+2(4) and obtain x = 2(-1)(7)+6(2)(4) = 34.
Thus, mod 28, 34 -
6 is the unique solution to the given pair of congruences.
We have been investigating a special case of the Chinese Remainder Theorem,
named after the country where it was first discovered (circa A.D. 350).
Suppose m 1, m2, . .., ml are pairwise relatively prime integers, that is, any two
of them are relatively prime. Then, for any integers al, a2, .
at, the system of
congruences
x 
al 
(mod ml)
x-a2 
(mod m2)
x - at 
(mod mt)
has a solution which is unique modulo the product mlm2 
mt.
The proof, which is just an extension of the t = 2 case already discussed and
a straightforward exercise in mathematical induction, is left to the exercises of
Section 5.1.
The Chinese Remainder Theorem has many practical consequences, two of
which we now describe. Each provides a convincing example of how "pure"
mathematics can have very relevant applications.
Determining Numbers by Their Remainders
Let n be a natural number. By the Fundamental Theorem of Arithmetic (Theo-
rem 4.3.9), n can be written n = p"Yl p"2 
. po', where pi, P2, 
pt are unique
distinct primes and the exponents ai > 0. Let a > 1 be some integer and let al be
the remainder when a is divided by p7'. By Proposition 4.4.5, a - ai (mod p7');
in other words,
a-al 
(mod p7')
a - a2 
(mod pa2)
at (mod p7').
Since the numbers p7', 
p7' are relatively prime, the Chinese Remainder
Theorem says that a is unique mod n. Thus, if 0 < a < n, then the integer a
itself is uniquely determined. This idea is crucial for the manipulation of "large"
numbers in computers since it implies that in order to store a number a larger
than a given computer's capacity, it is sufficient to store the set of remainders
which a leaves upon division by a set of prime powers. We illustrate.
PROBLEM 29. 
Let n = 90 = 2 5
which has remainders 1, 3, and 4 upon
respectively. We claim that a has been
9. Suppose a is an integer, 0 < a < 90,
division by the prime powers 2, 5, and 9,
identified uniquely. Why?

142 
Chapter 4 The Integers
Solution. 
We are given that a is a solution to the system
x 
1 
(mod 2)
x=3 
(mod 5)
x 
4 
(mod 9).
The Chinese Remainder Theorem says that x is unique mod 90. Thus, x is con-
gruent to exactly one a in the range 0 < a < 90.
To find a, we solve the first two congruences by the method proposed earlier.
We write 1(5) -2(2) 
= 1 and obtain x -
1(5) -
3(2)(2) = -7 
-
3 (mod 10).
Solving this congruence and the third one, we write 1(10)-] (9) = I and determine
a - 4(10) - 3(9) = 13 (mod 90). Thus, a = 13 + 90t for some t. Since 0 < a <
90, we must have a = 13. 
I
Suppose that a and b are integers and that ml, . . .
m, are pairwise relatively
prime. (Typically, the mi are powers of distinct prime numbers.) Let ai and be
be the remainders when a and b are divided by mi, respectively. Since a-as
(mod mi) and b - bi (mod mi), we know that ab - aibi (mod ml) by Proposi-
tion 4.4.7. The Chinese Remainder Theorem says that ab is determined uniquely,
mod in, by the remainders albl, ... , atbt. This idea can be exploited when a
and b are (very) large to find the product ab in shorter time than is possible by
conventional methods. Again, we illustrate with an example.
EXAMPLE 30 
Let a = 64 and b = 79. We have
a 
0 
(mod 4) 
b - 3 
(mod 4)
a- 
1 
(mod 9) 
and 
b 
7 
(mod 9)
a 
14 
(mod 25) 
b - 4 
(mod 25).
Thus, ab is a solution to the set of congruences
x-0(3)-0 
(mod 4)
x 
1(7) 
7 
(mod 9)
x 
14(4) = 56--6 
(mod 25).
We solve the first two congruences by writing I = 9 -2(4) 
and obtaining x
0(9) -
7(2)(4) = -56 
16 (mod 36). Then -9(36) 
+ 13(25) = I gives x
6(-9)(36)+16(13)(25) = 3256 = 556 (mod 900) as a solution to all three. Thus,
ab = 556+900t for some integer t. Since crude estimates give 4200 < ab < 5600,
we could determine ab = 556 + 900(5) = 5056, this being the only value of
556 + 900t in this range. 
A
Cryptography
Cryptography (also known as "cryptology") is the study of ways in which mes-
sages can be coded so that a third party, intercepting the code, will have great
difficulty recovering the original text. Such coding is of importance not just to the
military. Today, when so much information is transmitted electronically, secrecy

4.5 Applications of Congruence 
143
is of paramount concern to us all. As a second application of the Chinese Remain-
der Theorem (and of other ideas introduced in this section), we discuss the RSA
Algorithm, a method of encoding a message discovered in 1977 by Ronald Rivest,
Adi Shamir, and Leonard Adleman.
By assigning to the letters of the alphabet the numbers 01, 02, .
26, to
a space the number 27 and to various punctuation marks numbers beyond 27,
it is apparent that any message determines a number M. "HELLO," for instance,
would determine the number M = 0805121215. Here is how the RSA Algorithm
converts M to another number E.
Choose two different primes p and q and a natural number s relatively prime
to both p - I and q - 1. Let r = pq. Let E be the remainder when Ms is divided
by r and use E to encode M; that is, transmit E instead of M. Since E 
Ms
(mod r), we have E = M' (mod p) and E 
Ms (mod q).
Using the RSA Algorithm, and publicizing the values of r and s, anybody can
send you an encoded message which you can decode by the following scheme.
Since gcd(s, p -
1) = 1, there exist integers a and x such that as + x(p - 1) =
I, so M = Mas+x(p-0) = (Ms)a(MP-1)x -
E' (mod p) (by Fermat's Little
Theorem). Similarly, M - Eb (mod q) for an integer b which you can determine
because you know s and q. Since M 
E' (mod p) and M = Eb (mod q),
by the Chinese Remainder Theorem, M is uniquely determined modulo r and, if
M < r, then M is a uniquely determined integer. The success of this decoding
procedure lies in knowing the factorization r = pq. Finding the prime factors of
a large integer is practically impossible if r is, say, a 100-digit number. Thus, we
have described a procedure which can be public knowledge but which ensures
that messages transmitted to you are secure.
PROBLEM 31. 
Suppose r = 17 .59 = 1003 and s = 3. A secret agent wishes
to send you the message "GO." In this case, M = 715. The agent calculates
Ms = (715)3 and, since (715)3 = 579 (mod 1003), she transmits the number
E = 579. You receive this number and must decode it. How is this done?
Solution. 
First, note that gcd(3, 16) = 1 and 11(3) + (-2)(16) = 1, so a = 11.
Also, 39(3) + (-2)(58) = 1, so b = 39. (It is always possible to choose a and
b positive. See Exercise 21.) Then E' = (579)" =- 11 
= 1 (mod 17), while
Eb = (579)39 
(48)39 -
48(3)19 = 48(27)224 
7 (mod 59). The problem is
then reduced to solving the pair of congruences
x 
I 
(mod 17)
x 
7 
(mod 59).
Using the methods described earlier, we obtain x 
715 (mod 1003), which was
the word transmitted. 
I
What "methods described earlier"? Show how to get 715 as the solution.
As a final remark, we note that, in practice, we do not convert a message to
a single enormous number M and then encode M. Instead we divide the message
into blocks of characters of a fixed length, convert each block to a number, and

144 
Chapter 4 The Integers
then encode these numbers. For example, the message
THE PROJECT IS DELAYED TWO MONTHS
might be divided into blocks of length four,
THEP ROJE CTIS DELA YEDT WOMO NTHS
and then into numbers
20080516 18151005 03200919 04051201 25050420 23151315 14200819
each of which could be coded as described previously.
Readers interested in learning more about cryptography might consult the
excellent little book Cryptology, by Albrecht Beutelspacher, published by the
Mathematical Association of America in 1994.
16. We have seen that changing the fourth digit from 6 to 5 gives a number with
al + 2a2 + 
-+ 9ag + lOao -7 
(mod 
1), so if we also change the first
digit from 0 to 4, we should get al + 2a2 + 
+. - 9ag + lOa o- 0 (mod 11),
as desired. It is easy to check that the incorrect ISBN 4-935031-03-4, which
has errors in two digits, would pass our test.
17. w= (3, 1,3, 1,3, 1,3, 1,3, 1,3, 1).
18. The sum of the digits which code a number on the left is odd, whereas the
sum of the digits which code a number on the right is even. If the scanner
at first reads 0011101, for example, the sum of digits being even implies that
the number is on the right.
19. 59 
1 
0
17 
0 
1
8 
1 
-3
1 
-2 
7
So I = -2(59) + 7(17) and 1(-2)(59) + 7(7)(17) = 715 is a solution.
The symbol [BB] means that an answer can be found in the Back of the Book.
1. Which of the following are valid ISBNs and which are
not? Explain.
(a) [BB] 0-123456-78-9
(b) [BB] 0-432091-05-5
(c) 1-667132-42-6
(d) 9-412883-19-6
(e) 3-492166-27-X
2. Find the digit A so that each of the following numbers
is a valid ISBN number.
(a) [BB] 3-416109-27-A
(b) A-461228-37-4
(c) 9-123A45-51-X
(d) [BB] 2-729188-A6-2
(e) 8-9A5398-28-4
3. Is there an ISBN number of the form A-315266-78-2'?
Explain.
4. [BB] Show that the test given in (6) to detect an error in
an ISBN is equivalent to the test al + 2a2 + 
+ 9a9-
alo (mod II).

4.5 Applications of Congruence 
145
5. Show that an error in any single digit of an ISBN will
always be detected by the test in (6).
6. (a) [BB] Change the third and sixth digits of the ISBN
2-429783-29-0 so that the resulting number is not a
valid ISBN.
(b) Change the third and sixth digits of the ISBN in (a)
so that the resulting number is still valid.
(c) Show that any two digits of an ISBN can always be
changed so that the errors would not be detected by
the test in (6).
(a)[BB1]
(c) 
1111
(e) fl|| 
|
7. Consider the following alternative check for correctness
of an ISBN number. Instead of (6), the check digit ato
is determined by the rule aI + a2 + 
+ a + aIo+ 0
(mod I1).
(a) [BB] Express this rule in the form w 
a 
-
0
(mod I l) for some vectors w and a.
(b) Show that this rule detects an error in a single digit.
(c) Show that this rule does not detect a transposition
of two (different) digits.
8. Try to identify the universal product numbers defined
by each of the bar codes in Fig 4.5.
(b) 
I
(d)[BB]
(I)
Figure 4.5 
Bar codes for Exercise 8.
9. Which of the following are valid universal product num-
bers and which are not? Explain.
(a) [BB] 0-12345-67890-1
(b) 1-66326-73551-5
(c) [BB] 2-52998-17394-9
(d) 9-53889-22687-3
(e) 8-41285- 19384-2
10. In each of the following cases, find the digit x so that
the given number is a valid universal product number.
(a) [BB] 0-12x89-29109-4
(b)
(c)
(d)
(e)
1 -29347-49x26-8
4-29217-10258-x
5-91057-x9332-2
x-79154-91937-6
11. [BB] This exercise concerns the test labeled (7) on
page 138.
(a) Show that the test will detect a single error in an
even position digit of a universal product number.
(b) Show by example that the test will not necessarily
detect two errors in even positions.
1 1 11 1 1111 
11

146 
Chapter 4 The Integers
12. Repeat both parts of Exercise 11 for odd positions.
13. (a) [BB] Give an example of a valid universal prod-
uct number which differs from the valid number
1-23456-98732-6 in the fourth and fifth positions.
(b) [BB] Give an example of an invalid product number
which differs from the valid number 1-23456-98732-6
in the fourth and fifth positions.
14. Will the test in (7) detect the transposition of two (dif-
ferent) adjacent digits? Explain.
15. A certain state proposes to determine the check digit a]2
of a 12-digit driver's license number ala2 . .. a12 by the
rule
12al + Il a2 + lOa3 + .*. + 2a, 
I + al2. 0 
(mod 10).
(a) Express this test in the form w a -
0 (mod 10) for
vectors w and a.
(b) [BB] Does this test detect an error in a single digit?
(c) Does this test detect the error resulting from the
transposition of consecutive digits?
(d) Does it detect transposition errors in general?
Explain your answers.
16. Consider the general test
w a-0 
(mod n)
for correctness of a k-digit number al a2 ... ak, 0 < as <
9, where a = (a,, a2, . . ., ak), w = (wI, w2, 
Wk)
is a weight vector and n > 1.
(a) [BB] If this is to be a sensible test, we should have
n > 9. Why?
(b) Assume n > 9. If we is relatively prime to n for all
i, show that the test will detect single-digit errors.
(c) Assume n > 9. Show that the test will detect the
error resulting from transposition of a, and aj pro-
vided wi- w is relatively prime to n.
17. In each case, find the smallest nonnegative integer x
which satisfies the given system of congruences.
(a) [BB] x 
3 (mod 5)
x 
4 (mod 7)
(b) x 
I (mod 4)
x-8 
(mod 9)
(c) x 
3 (mod 5)
x-7 
(mod 8)
(d) [BB] x -
6 (mod 8)
x-17 (mod 25)
(e) x 
3 (mod 1917)
x -
75 (mod 385)
(f) x- 
1003 (mod 17,369)
x 
2974 (mod 5472)
(g) x- 
I (mod 4)
x- 
8 (mod 9)
x 
10 (mod 25)
18. For each of the following, find the smallest positive
integer which has the given sequence of remainders
when divided by the prime powers 4, 3, and 25, respec-
tively.
(a) [BB] 1, 2, 3
(b) 2, 0, 6
(c) 3, 1, 17
(d) [BB] 0, 2, 10
(e) 3, 2, 24
19. [BB] Reflect on the conversation between discrete math
student and friend on page 140. What was the num-
ber?
20. In each of the following cases, find a positive integer x
such that ab -x modulo a suitable integer. Assuming
that ab < 50,000, find ab itself, if possible, and explain
your reasoning.
(a) [BB] a- 
3, b -
3 (mod 4)
a-0, 
b 
8 (mod 9)
a- 4, b 
18 (mod 25)
(b) a- 7, b -7 
(mod 8)
a -9, b -
8 (mod 27)
a 
29,b 
18 (mod 125)
(c) a-l, 
b 
2 (mod 8)
a 
8, b 
I (mod 27)
a 
55, b -
82 (mod 125)
(d) a l, b-6 
(mod 8)
a- 
2, b 
6 (mod 27)
a 
12,b 
97 (mod 125)
(e) [BB] a l, b-3 
(mod 4)
a- 
3, b -4 
(mod 25)
a 
10, b -
79 (mod 343)
(f) a 
3, b-I 
(mod 4)
a 
17, b 
6 (mod 25)
a 
78, b -122 
(mod 343)
(g) a- 
3, b-4 
(mod 5)
a- 
36, b - 42 (mod 49)
a 
7, b 8 (mod 11)
a-1, b 
3 (mod 13)
(h) a 
2, b 
4 (mod 5)
a 
14, b 
36 (mod 49)
a- I,b- 
10 (mod II)
a ll, b 
7 (mod 13)

Review Exercises 
147
21. [BB] Suppose m and n are relatively prime positive inte-
gers. Show that there exist integers s and t with s > 0
such that sm + tn = 1. [Hint: It might be helpful first to
consider some specific examples. For instance, can you
find s and t, s > 0, such that 7s + 22t = I ?]
The remaining exercises are based upon the method for
encoding messages described at the end of this section.
22. Suppose p = 17, q = 23, and s = 5. How would you
encode each of the following "messages"?
(a) [BB] X
(b) HELP
(c) [BB] AIR
(d) BYE
(e) NOW
23. Suppose p = 5, q = 7, and s = 5. Decode each of the
following encoded "messages."
(a) [BB] 31
(b) 24
(c) [BB] 7
(d) 11
(e) 23
24. Suppose p = 17, q = 59, and s = 3.
(a) [BB] If you receive E = 456, what is the message?
(b) If you receive E = 926, what is the message?
SIN 
.SUi 
M 
* 
*
1. Find 
the 
quotient 
and 
remainder
11 ,109,999,999,997 is divided by 1111.
when
2. (a) Convert (1100101)2 to base 10.
(b) Convert 32,145 to octal.
3. (a) The sum of the digits of the number 8215 is 8 +
2 + I + 5 = 16 -
7 (mod 9). Observe also that
8215 = 9(912) + 7 = 7 (mod 9). Does this hold
for any number? Explain.
(b) Suppose we want to compute the product 8215 x
3567 modulo 9. Replacing these numbers by those
obtained by adding their digits and reducing modulo
9 gives 16 x 21 = 7 x 3 = 21 -
3 (mod 9). Is it
true that 8215 x 3567 - 3 (mod 9)? Explain.
4. Find gcd(2700, -504) and express it as an integral linear
combination of the given integers.
5. Suppose x, a and b are integers such that x I ab. If x
and a are relatively prime, prove that x l b.
6. For any k e N, prove that gcd(4k + 3, 7k + 5) = 1.
7. (a) Give Euclid's proof that there are infinitely many
primes.
(b) State the Fundamental Theorem of Arithmetic.
8. Is 2119 -
I prime? What about 3109 - 1? What about
4109 - 1? Explain your answers.
9. True or false (and justify):
(a) If b a and - Ic, then bcIa.
(b) If b a and b- Ic, then a Ibc.
10. (a) Compute 380 (mod 7).
(b) Find all integers x such that 5x -
I (mod 100).
Briefly explain your answer.
11. Find all integers x and y, 0 < x, y < 10, which satisfy
x+5y 
5 
(modlO)
5x + 3y 
I 
(mod 10).
12. (a) Find the digit A so that A-253228-46-7 is a valid ISBN
number.
(b) Find the digit x so that 3-25814-39x75-6 is a valid
universal product code.
13. Find the smallest nonnegative integer which satisfies
x - 5 
(mod 341)
x - I I 
(mod 189).

>* 
*> induction and Recursion
5.1 
MATHEMATICAL INDUCTION
One of the most basic methods of proof is mathematical induction, which is a way
to establish the truth of a statement about all the natural numbers or, sometimes,
all sufficiently large integers. Mathematical induction is important in every area
of mathematics. In addition to the examples presented in this section, other proofs
by mathematical induction appear elsewhere in this book in a variety of different
contexts. In the index (see "induction"), we draw attention to some theorems
whose proofs serve as especially good models of the technique.
PROBLEM 1. 
A certain store sells envelopes in packages of five and packages
of twelve and you want to buy n envelopes. Prove that for every n > 44, this
store can fill an order for exactly n envelopes (assuming an unlimited supply of
each type of envelope package).
Solution. 
If you want to purchase 44 envelopes, you can buy two packages of
twelve and four packages of five. If you want to purchase 45 envelopes, you can
buy nine packages of five. If you want to purchase 46 envelopes, pick up three
packages of twelve and two packages of five. If you want to buy 47 envelopes, get
one package of twelve and seven packages of five and, if you want 48 envelopes,
purchase four packages of twelve.
The obvious difficulty with this way of attacking the problem is that it never
ends. Even supposing that we continued laboriously to answer the question for n
as big as 153, say, could we be sure of a solution for n = 154? What is needed is a
general, not an ad hoc, way to continue; that is, if it is possible to fill an order for
exactly k envelopes at this store, we would like to he able to deduce that the store
can also fill an order for k + 1 envelopes. Then, knowing that we can purchase
exactly 44 envelopes and knowing that we can always continue, we could deduce
that we can purchase exactly 45 envelopes. Knowing this, and knowing that we
can always continue, we would know that we can purchase exactly 46 envelopes.
And so on.
149

150 
Chapter 5 Induction and Recursion
Suppose-just suppose-that it is possible to buy exactly k envelopes at
this store, where k > 44. If this purchase requires seven packages of five, then
exchanging these for three packages of twelve fills an order of exactly k + I
envelopes. On the other hand, if k envelopes are purchased without including seven
packages of five, then the order for k envelopes included at most 30 envelopes
in packages of five and so, since k > 44, at least two packages of twelve must
have been required. Exchanging these for five packages of five then fills exactly
an order for k + I envelopes. We conclude that any order for n > 44 envelopes
can be filled exactly. 
I
This example demonstrates the key ingredients of a proof by mathematical
induction. Asked to prove something about all the integers greater than or equal
to a particular given integer-for instance, that any order of n > 44 envelopes can
be filled with packages of five and twelve-we first establish truth for the first
integer-for example, n = 44-and then show how the truth of the statement for
n = k enables us to deduce truth for n = k + 1.
Figure 5.1 
An 8 x 8 board.
PROBLEM 2. 
Chess is a game played on an 8 x 8 grid, that is, a board consisting
of eight rows of eight small squares. (See Fig 5. 1.) Suppose our board is defective
in the sense that one of its squares is missing. Given a box of L-shaped trominos
like this, 
A7 , each of which covers exactly three squares of a chess board, is it
possible to tile the board without overlapping or going off the board? Show, in
fact, that it is possible to tile any 2n x 2n defective board.
K-
Figure 5.2 
Three defective boards.
Solution. 
We begin our solution by thinking of some easier situations. Figure 5.2
shows defective 2 x 2, 4 x 4, and 8 x 8 boards (with the missing square highlighted
in each case). Certainly the 2 x 2 board can be tiled because its shape is exactly
that of a single tromino. A little experimentation would show how to tile the
6J
Cl
- -
| 
-
-
-
-
2

5.1 Mathematical Induction 
151
4 x 4 board. Rather than proceeding case by case, however, we use the idea
suggested by our first example and attempt to understand how a solution for
one particular board can be used to obtain a solution for the next bigger board.
Suppose then that we know how to tile any 2k x 2k defective board. How might
we tile a defective board of the next size, 2k+1 x 2k+1 ? The idea is to realize that a
2k+1 x 2k+1 board can be divided into four boards, each of size 2k x2k, as shown in
Fig 5.3.
2k 
2k
Figure 5.3
-I
One of these smaller boards contains the missing square and so is defective.
Now place a tromino at the center so as to cover squares in each of the three
remaining smaller boards. Each of the boards is now "defective" and so, by
assumption, can be tiled with trominos. So we have tiled the larger board! 
I
The two examples discussed so far made assertions about infinitely many
consecutive integers. In each case, we adopted the following strategy.
.
Verify that there is a solution for the smallest integer.
.
Show how a solution for one integer leads to a solution for the next.
We now give a formal statement of the principle which has been at work, the
Principle of Mathematical Induction.
Given a statement P concerning the integer n, suppose
1. T is true for some particular integer no;
2. if T is true for some particular integer k > no, then it is true for the next
integer k + 1.
Then T is true for all integers n > no.
In Step 2, the assumption that T is true for some particular integer is known
as the induction hypothesis.
In our first example, we had to prove that any order of n envelopes, n > 44,
could be filled with packages of five and of twelve: no was 44 and the induction
hypothesis was the assumption that there was a way to purchase k envelopes with
packages of five and twelve. In the second example, we had to demonstrate that
any defective board of size 2" x 2n, n > 1, could be covered in a certain way; no
was 1 and the induction hypothesis was the assumption that we could properly
cover a 2k x 2k board.
F-
9E
2k
2k

152 
Chapter 5 Induction and Recursion
Our next example is suggested by the following pattern. Notice that
1 
=I 1 2
1+3= 4=22
1+3+5= 9 =32
1 + 3 + 5 + 7 = 16=42
1 +3+5+7+9 =25 =2
The first odd integer is 12; the sum of the first two odd integers is 22; the sum
of the first three odd integers is 32 and so on. It appears as if the sum of the
first n odd integers might always be n2. The picture in Fig 5.4 adds force to this
possibility.
Figure 5.4 
The sum of the first n odd integers is n2 .
PROBLEM 3. 
Prove that for any integer n > 1, the sum of the odd integers
from 1 to 2n -I 
is n2.
Before solving this problem, we remark that the sum in question is often
written
(1) 
I +3 + 5+ ..
+ (2n -1),
where the first three terms here-i + 3 + 5-are present just to indicate that odd
numbers are being added, beginning with 1, and the last term, 2n- 
1, describes
the last term and gives a formula for the general term: The second odd number is
2(2)- 
1; the third odd number is 2(3)- 
1, the kth odd number is 2k - 1. Do not
infer from this expression that each of the three numbers 1, 3, 5 is always present.
For example, when n = 2, 2n -
= 3 and so the sum in (1) is, by definition, 1+3.
We can also describe the sum (1) with sigma notation,
n
(2) 
1 +3 +5 + ... + (2n-I)=E(2i-l),
i=I
so named because the capital Greek letter, A, used to denote summation, is
pronounced "sigma." The letter i is called the index of summation; the i = 1 at
the bottom and the n at the top mean that the summation starts with i = 1 and
continues with i = 2, 3 and so on, until i = n. Thus, the first term in the sum
is 2i- 
I with i 
-
1; that is, 2(1) - 1 = 1. The second term is 2i- 
I with
i = 2; that is, 2(2) -
I = 3. Summing continues until i = n: The last term is
2n- 
1.

5.1 Mathematical Induction 
153
1=
4
Write L(2i 
-
1) without using sigma notation and evaluate this sum.
i=1
Problem 3 asks us to prove that, for all integers n > 1,
(3) 
1+3+5+.. +(2n-1)=n2
or, equivalently, that
n
(2i -1) 
= n2.
i=-
Solution. 
In this problem, no = 1. When n = 1, 1 + 3 + 5 + .+ (2n- 1)
means "the sum of the odd integers from 1 to 2(1) - 1 = 1." Thus, the sum is
just 1. Since 12 is also 1, the statement is true for n = 1. Now suppose that k is
an integer, k > 1, and the statement is true for n = k; in other words, suppose
1 + 3 + 5 + ... + (2k -1) = k2  
induction hypothesis.
We must show that the statement is true for the next integer, n = k + 1; namely,
we must show that
1+3+5+... +(2(k+1)-1)=(k+1)2.
Since 2(k + 1)-1 = 2k + 1, we have to show
1+ 3 + 5+ .
+ (2k +1) =(k +1)2.
!!!_! 
WAIT A SECOND 
-!!!!
The sum on the left is the sum of the odd integers from 1 to 2k + 1; this is the
sum of the odd integers from I to 2k -
1, plus the next odd integer, 2k + 1:
1+3+5+.. +(2k+ 
)-[1+3+5Â±+ 
+(2k-1)]+(2k+1).
By the induction hypothesis, we know that
1+3 +5+ Â± 
+ (2k + 1)
=1+3+5++ 
+(2k-1)+(2k+1)=k2 + (2k+1).
Since k2 + (2k + 1) = (k + 1)2, this is the result we wanted. By the Principle of
Mathematical Induction, statement (3) is true for all integers n > 1. 
I
Why did we "wait a second" in the preceding argument? It has been the
authors' experience that students sometimes confuse their statement of what is to
be proven when n = k + 1 with the start of their actual proof. Consequently, we
strongly recommend the following approach to a proof by mathematical induction:
.
verify the statement for n = no;
.
write down the induction hypothesis (the statement for n = k) in the form
"Now suppose that ... 
" and be explicit about what is being assumed;
.
write down what is to be proven (the statement for n = k + 1) in the form
"We must show that ... 
" again being very explicit about what is to be
shown; and finally (after waiting a second);

154 Chapter 5 Induction and Recursion
give a convincing argument as to why the statement for n = k + I is true
(and make sure this argument uses the induction hypothesis).
We continue with several examples which you should take as models for
proofs by mathematical induction.
PROBLEM 4. 
Prove that for any natural number n > 1,
12 + 22 +32 + 
+ n2  
n(n + l)(2n + 1)
6
Solution. 
When n = 1, the sum of the integers from 12 to 12 is 1. Also
1(1 + 1)(2. 1 + 1) = 1,
6
so the statement is true for n = 1. Now suppose that k > I and the statement is
true for n = k; that is, suppose that
Â± 22 + 32+ 
+ 
= 
Â± 
k(k + 1)(2k + 1)
6
We have to show that the statement is true for n = k + I; that is, we have to show
that
1+ 2+2 
Â±3 2 + 
+ (k + 1)2
(k + 1)[(k + 1) + 1][2(k + 1) + 1] (k + 1)(k + 2)(2k + 3)
6 
6
! 
_ 
! 
WAIT A SECOND
Observe that
t2 + 22+ 32 + 
+ (k + 1)2 = (12 + 22+ 32 + .+ k2) + (k 
+ 1)2
k(k + 1)(2k + 1) + (k + 1)2
6
k(k + 1)(2k + 1) + 6(k + 1)2
6
(k + 1)[k(2k + 1) + 6(k + 1)]
6
(k + 1)[2k2 + 7k + 6]
6
(k + l)(k + 2)(2k + 3)
6
which is just what we wanted. By the Principle of Mathematical Induction, the
statement is true for all integers n > 1.

5.1 Mathematical Induction 
155
1=is
I 
Sm
l 
Ripu
PROBLEM 5. 
Prove that for any integer n > 1, 22n - 1 is divisible by 3.
Solution. 
When n = 1, 22(l) -
1 = 22 -
1 = 4 -
1 = 3 is divisible by 3.
Now suppose that k > 1 and the statement is true for n = k; that is, suppose that
22k -
1 is divisible by 3. We must prove that the statement is true for n = k + 1;
that is, we must prove that 2 2(k+1) - 1 is divisible by 3. The key to what follows
is the fact that we must somehow involve the induction hypothesis. Observe that
2 2(k+1) -I 
= 22k+2 -
1 = 4 (2 2k) -
1. This is helpful since it introduces 2 2k. By
the induction hypothesis, 22k _ 1 = 3t for some integer t, so 22k = 3t + 1. Now
it's smooth sailing. We have
22(k+I) _1 = 4 (2 2k) -_1 = 4(3t + 1) -
1 = 12t + 4 -
1 = 12t + 3 = 3(4t + 1).
Thus, 22(k+1) -1 
is divisible by 3, as required. By the Principle of Mathematical
Induction, 22n -
1 is divisible by 3 for all integers n > 1. 
I
Prove that 32n -
1 is divisible by 8 for every n > 1.
Let n be a given positive integer. It is convenient to have some notation for
the product of all the integers between 1 and n since this sort of product occurs
frequently in statistical and in counting problems. (See Chapter 7.)
Define 0! = 1 and, for any integer n > 1, define
n! = n(n - l)(n - 2)... (3)(2)(1).
The symbol n! is read "n factorial." The first few factorials are 0! = 1, 1! = 1,
2! = 2. 1 = 2, 3! = 3(2)(1) = 6, 4! = 4(3)(2)(1) = 24. It is useful to notice that
4! = 4(3!), 5! = 5(4!), and so on. Thus, if we know that 8! = 40,320, then it
is easy to deduce that 9! = 9(40,320) = 362,880. Factorials grow very quickly.
James Stirling (1730) provided an important estimate for the size of n! when n is
large.
lim 
=1; 
equivalently, 
n! -
2-)rn).
neon 1-7 n( 
" 
e) n 
e
In this formula, e = 2.71828... denotes the base of the natural logarithms.
Remember from our discussion of the Prime Number Theorem (Theorem 4.3.13)
that we read "is asymptotic to" at the symbol -. Thus, Stirling's formula says
that n! is asymptotic to 12rn(n/e)n, meaning that n! is approximately equal
to 
2wn(n/e)', for large n. For example, 15! 
/ 3Oir(15/e)'5 
t 
1.3 x 1012,
which, by most people's standards, is indeed a large number.
Our next problem provides another indication of the size of n!, albeit a rather
crude one. For example, it says that 15! > 215 = 32,768 and 30! > 230 
109.
PROBLEM 6. 
Prove that n! > 2n for all n > 4.
Solution. 
In this problem, no = 4 and certainly 4! = 24 > 16 = 24. Thus, the
statement is true for no. Now suppose that k > 4 and the statement is true for

156 Chapter 5 Induction and Recursion
n = k. Thus, we suppose that k! > 2k. We must prove that the statement is true
for n = k + 1; that is, we must prove that (k + 1)! > 2 k+1. Now
(k + 1)! = (k + I)k! > (k + 1)2k
using the induction hypothesis. Since k > 4, certainly k + 1 > 2, so (k + ] ) 2 k >
2 * 2k = 2k+1. We conclude that (k + 1)! > 2 k+I as desired. By the Principle of
Mathematical Induction, we conclude that n! > 2n for all integers n > 4. 
I
What was the induction hypothesis in this problem?
Why did the induction in this example start at n = 4 instead of some smaller
integer?
The Principle of Mathematical Induction is one of the most powerful tools
of mathematics. With it, we can prove many interesting things, but if it is not
applied correctly, we can also prove some interesting things which are not true!
PROBLEM 7. 
What is the flaw in the following argument, which purports to
show that
2+4+6+ 
+2n = (n-1)(n+2)
for all positive integers n?
"Assume that 2 + 4 + 6 + 
+ 2k = (k -
1)(k + 2) for some integer
k. Then
2+4+6 + .
+2(k + 1) = (2+4+6+... +2k) +2(k+ 1)
= (k -
1)(k + 2) + 2(k + 1)
(by the induction hypothesis)
=k 2 +k -2+2k+2
= k2+ 3k
= k(k + 3)
= [(k1) 
1)](k + 1) + 21,
which is the given statement for n = k + 1. It follows, by the Principle
of Mathematical Induction, that the statement is true for all positive
integers n."
Solution. 
The inductive step, as given, is correct, but we neglected to check the
case n = 1, for which the statement is most definitely false. 
I
There is another form of the Principle of Mathematical Induction, called the
strong form, because, at first glance, it appears to be more powerful than the
principle stated previously. The two forms are completely equivalent, however:
The collection of statements which can be proven true using one form is exactly

5.1 Mathematical Induction 
157
0
6*
the collection which can be proven true using the other. It just so happens that in
certain problems, the strong form is more convenient than the other.
Given a statement P concerning the integer n, suppose
1. P is true for some integer no;
2. if k > no is any integer and TP is true for all integers f in the range no < f < k,
then it is true also for k.
Then P is true for all integers n > no.
The two forms of the Principle of Mathematical Induction differ only in
the statement of the induction hypothesis (the assumption in the second step).
Previously, we assumed the truth of the statement for just one particular integer
and we had to prove it true for the next largest integer. In the strong form of
mathematical induction, we assume the truth of the statement for all integers less
than some integer and prove that the statement is true for that integer. When we
first encounter mathematical induction, it seems to be the weak form which is
always used; problems requiring the strong form are seldom encountered. In the
analysis of finite structures, however, the strong form is employed extensively. We
want to acquire knowledge about structures of a certain size from knowledge about
similar structures of smaller size. Recall that part of the Fundamental Theorem
of Arithmetic states that every natural number greater than I is the product of
primes. The strong form of mathematical induction affords a very straightforward
proof of this result.
PROBLEM 8. 
Use the strong form of mathematical induction to prove that every
natural number n > 2 is either prime or the product of prime numbers. (See 4.3.9,
the Fundamental Theorem of Arithmetic.)
Solution. 
The theorem is a statement about all integers n > 2. The first such
integer, no = 2, is prime, so the assertion of the theorem is true. Now let k > 2
and suppose that the assertion is true for all positive integers Â£, 2 < e < k; in
other words, suppose that every integer e in the interval 2 < f < k is either prime
or the product of primes. We must prove that k has this same property. If k is
prime, there is nothing more to do. On the other hand, if k is not prime, then k
can be factored k = ab, where a and b are integers satisfying 2 < a, b < k. By
the induction hypothesis, each of a and b is either prime or the product of primes.
Thus, k is the product of primes, as required. By the Principle of Mathematical
Induction, we conclude that every n > 2 is prime or the product of primes. 
I
Our next problem demonstrates another common error in "proofs" by math-
ematical induction.
PROBLEM 9. 
Canada has a two-dollar coin known colloquially as the "toonie."
What is wrong with the following argument, which purports to prove that any debt
of n > 1 Canadian dollars can be repaid (exactly) with only toonies?
Here no = 2. We begin by noting that any two-dollar debt can be
repaid with a single toonie. Thus, the assertion is true for n = 2.

158 
Chapter 5 Induction and Recursion
Now let k > 2 and suppose that the assertion is true for all e, 2 < e < k.
We must prove that the assertion is true for n = k. For this, we apply
the induction hypothesis to k - 2 and see that a (k - 2)-dollar debt can
be repaid with toonies. Adding one more toonie allows us to repay k
dollars with only toonies, as required. By the Principle of Mathematical
Induction, any debt of n > 1 dollars can be repaid with toonies.
Solution. 
The problem here is that the latter part of the argument does not work
if k = 3.
The induction hypothesis-that the assertion is true for all e, 2 < e < k-
was applied to e = k -
2. If k = 3, however, then k -2 
= 1 and the induction
hypothesis cannot be applied. 
I
We conclude with a brief discussion about the equivalence of the two Princi-
ples of Mathematical Induction and the Well-Ordering Principle.
Mathematical Induction and Well Ordering
Recall that the Well-Ordering Principle (4.1.2) says that any nonempty set of
natural numbers has a smallest element. This can be proved using the weak form
of the Principle of Mathematical Induction. Here is the argument.
A set containing just one element has a smallest member, the element itself,
so the Well-Ordering Principle is true for sets of size no = 1. Now suppose it
is true for sets of size k; that is, assume that any set of k natural numbers has a
smallest member. Given a set S of k + I numbers, remove one element a. The
remaining k numbers have a smallest element, say b, and the smaller of a and b
is the smallest element of S. This proves that any finite set of natural numbers
has a smallest element. We leave to the reader (Exercise 17) the extension of this
result to arbitrary subsets of N.
Conversely, we may use the Well-Ordering Principle to prove the Principle of
Mathematical Induction (weak form). For suppose that P is a statement involving
the integer n which we wish to establish for all integers greater than or equal to
some given integer no. Assume
1. P is true for n = no, and
2. if P is true for an integer k > no, then it is also true for k + 1.
How does the Principle of Well-Ordering show that P is true for all n > no? For
convenience we assume that no > 1. (The case no < 0 can be handled with a
slight variation of the argument we present.)
If P is not true for all n > no, then the set S of natural numbers n > no for
which P is false is not empty. By the Well-Ordering Principle, S has a smallest
element a. Now a 7& no because we have established that P is true for n = no.
Thus, a > no, so a - 1 > no. Also, a -I 
< a. By minimality of a, P is true for
k = a -1. By assumption 2, P is true for k+ 1 = a, a contradiction. We are forced
to conclude that our starting assumption is false: P must be true for all n > no.
The preceding paragraphs show that the Principles of Well-Ordering and
Mathematical Induction (weak form) are equivalent. With minor variations in the
reasoning, we can prove that the Principles of Well Ordering and Mathematical

5.1 Mathematical Induction 
159
-
-
gI
Induction (strong form) are equivalent. It follows, therefore, that the three princi-
ples are logically equivalent.
1. 4=
1(2i - 1) = [2(l) - 1] + [2(2) -
1] + [2(3) - 1] + [2(4) - 1] = 1 + 3 +
5 + 7 = 16.
2. When n = 1, 32(1) -
1 = 32 -
I = 9-1 = 8 is divisible by 8. Now suppose
that k > I and the statement is true for n = k; that is, suppose that 32k -
1
is divisible by 8. Thus, 32k -
1 = 8t for some integer t and so 32k = 8t + 1.
We have
3 2(k+1) -1 
= 32k+2 _1 = 9 (3 2k) _1
3.
4.
= 9(8t + 1) -
1 = 72t + 9 -
1 = 72t + 8 = 8(9t + 1).
Thus, 32(k+1) -
1 is divisible by 8, as required. By the Principle of Mathe-
matical Induction, 32n - 1 is divisible by 8 for all integers n > 1.
The induction hypothesis was that k! > 2 k for some particular integer k > 4.
The statement n! > 2' is not true for n < 4; for example, 3! = 6, whereas
23 = 8.
The symbol [BB] means that an answer can be found in the Back of the Book.
1. Write each of the following sums without using E and
evaluate.
(a) [BB] Z5 
i2
(b) [BB] >4 1 2'
(c) [BB] z:-1 sin 7rt
(d) , 
= 3j+2
(e) Yk=- (k- 
k + 1)
(f) 
yn=o (- 
) k
2. List the elements of each of the following sets:
(a) {i7= (-1) I n = 0,1, 2, 3}
(b) {[n' 
2i I n c N, 1 < n < 5}
3. Prove that it is possible to fill an order for n > 32 pounds
of fish given bottomless wheelbarrows full of 5-pound
and 9-pound fish.
4. Use mathematical induction to prove the truth of each
of the following assertions for all n > 1.
(a) [BB] n2 + n is divisible by 2.
(b) n3 + 2n is divisible by 3.
(c) [BB] n3 + (n + 1)3 + (n + 2)3 is divisible by 9.
(d) 5n -
I is divisible by 4.
(e) 8' - 3" is divisible by 5.
(D
(g)
(h)
52n - 25n is divisible by 7.
lOn+1 + IOn + 1 is divisible by 3.
a' - bn is divisible by a -b 
for any integers a, b
with a - b # 0.
5. (a) [BB] Prove by mathematical induction that
1+2+3 + 
+n 
n(n + 1)
2
for any natural number n.
(b) Prove by mathematical induction that
13+23 
+ 
n 3 
-
n2 (n + 1)2
4
for any natural number n.
(c) Use the results of (a) and (b) to establish that
(I +2+3+ 
+n)2= 13 +2 3 + 
.+n3
for all n > 1.
6. Use mathematical induction to establish the truth of each
of the following statements for all n > 1.
(a) [BB] I + 2 + 22 + 23 + 
+ 2n = 2n+1
(b) [BB] 12 -22 + 32 - 42 + 
+ (-)n-ln2
( 1)n- 1n(n + 1)
2
0 *'V14 
zlog 6114ol

160 
Chapter 5 Induction and Recursion
(C) 
12 +3 2 Â±+5
2'+ 
.+(2n- 
1)2 = n(2n -1)(2n 
+ 1)
3
(d) I 2 3+2 3 4 +3 4 5Â±+ 
+n(n+ 1)(n+2) =
n(n + l)(n + 2)(n + 3)
4
I 
I 
I 
I 
n
(e) 
+ 
+ 
+ 
+ 
=
1 2 
2 3 
3 4 
n(n+l) 
n+l
7. [BB; (a)] Rewrite each of the sums in Exercise 6 using
E notation.
8. Use mathematical induction to establish each of the fol-
lowing formulas.
n
(a) [BB] L(i + 1)2' = n211+1
(b 
i2  
n(n +)
il(2i -1)(2i + 1) 
2(2n + 1)
n
(c) E(2i
i-l
1)(2i) 
n(n + 1)(4n -1)
3
9. Use mathematical induction to establish each of the fol-
lowing inequalities.
(a) [BB] 2n > n2 , for n > 5.
(b) (I + 1)' > I + ', for n E N.
(c) For any p E R, p > - 1, (1 + p)n > I + np for all
n c N.
(d) For any integer n > 2, n j + ,+2+ 
3 
+ 
+ 
Â±2, 
>
13
24'
(e) 
, 
> 
> 
n for n > 2.
10. Suppose c, XI,X2,. 
,x,,, 
yY2, 
.
y,, 
are 2n + I
given numbers. Prove each of the following assertions
by mathematical induction.
nI 
n 
ni
(a) 
[BB] 
(xi 
+ yi) 
ZXi 
+Zy 
for n > I.
(b) 
cxi =c Xi 
forn > I.
(c) 
,(xi- 
x- 
) = x, - xi for n > 2.
i=2
11. [BB] Find the fault in the following "proof' that in any
group of n people, everybody is the same age.
Suppose n = 1. If a group consists of just
one person, everybody is the same age. Sup-
pose that in any group of k people, every-
one is the same age. Let G = {a,, a2, . . .
ak+1] be a group of k + I people. Since
each of the groups (a I, a2.... ak } and (a2,
a3, ... ak+1I consists of k people, every-
body in each group has the same age, by
the induction hypothesis. Since a2 is in each
group, it follows that all k + I people ai,
a2, .. 
, ak+1 have the same age.
12. [BB] Find the fault in the following "proof' by mathe-
matical induction that
+2+3+ 
+ 
(2n + 1)2
for all natural numbers n.
If l +2+3+ 
+k
(2k + 1)2
8 
,then
I +2+3+ +(k+1)
= 
(I +2+3+ 
-- 
+k)+ (k+ 1)
(2k + 
+ (k + 
1))
4k 2 + 4k+ 1 + 8k + 8
8
4k 2 + 12k + 9
8
(2k + 3)2  
[2(k + 1) + 1]2
8 
8
and so truth for k implies truth for k + 1.
13. What is wrong with the following "proof' that any order
for n > 10 pounds of fish can be filled with only 5-pound
fish?
We use the strong form of mathematical
induction. Here no = 10. Since an order
for 10 pounds of fish can be filled with
two 5-pound fish, the assertion is true for
n = 10. Now let k > 10 be an integer
and suppose that any order for f pounds of
fish, 10 < f < k, can be filled with only 5-
pound fish. We must prove that an order for
k pounds can be similarly filled. But by the
induction hypothesis, we can fill an order
for k -5 
pounds of fish, so, adding one
more 5-pounder, we can fill the order for k
pounds. By the Principle of Mathematical
Induction, we conclude that the assertion is
true for all n > 10.

5.1 Mathematical induction 
161
14. One of several differences between the Canadian and
American games of football is that in Canada, a team
can score a single point without first having scored a
touchdown. So it is clear that any score is possible in
the Canadian game. Is this so in the American game?
Indeed this seems to be the case, even assuming (this is
not true!) that in the United States, points can be scored
only three at a time (with a field goal) or seven at a time
(with a converted touchdown). Here is an argument.
Assume that k points can be achieved with
multiples of 3 or 7. Here's how to reach
k+ 1 points. If k points are achieved with at
least two field goals, subtracting these and
adding a touchdown gives k + I points. On
the other hand, if the k points are achieved
with at least two touchdowns, subtracting
these and adding five field goals also gives
k + I points.
Does this argument show that any score is possible in
American football? Can it be used to show something
about the nature of possible scores?
15. [BB] It is tempting to think that if a statement involving
the natural number n is true for many consecutive values
of n, it must be true for all n. In this connection, the
following example due to Euler is illustrative.
Let f(n) =n 2 +n+41.
(a) Convince yourself (perhaps with a computer algebra
package like Maple or Mathematica) that f(n) is
prime for n = 1, 2, 3, ... 39 but that f(40) is not
prime.
(b) Show that for any n of the form n = k2 + 40, Jf(n)
is not prime.
16. [BB] Prove that a set with n elements, n > 0, contains
2" subsets.
17. [BB] Suppose that any nonempty finite set of natu-
ral numbers has a smallest element. Prove that any
nonempty set of natural numbers has a smallest ele-
ment.
18. (a) Prove that for any integer n > 1, any set of n pos-
itive real numbers has a smallest element.
(b) Prove that the result of (a) is not true for infinite
sets of positive real numbers in general but that it
is true for some infinite sets.
(c) What is the name of the principle which asserts that
any nonempty set of natural numbers has a smallest
element?
19. [BB] Let n > I and let A, Bt, B2 , . . ., B, be sets. Gen-
eralize the result of Exercise 18, Section 2.2 by prov-
ing that A U (ni=l Bi) = N 
(A U B.) for all
n > I .
20. Prove that A n (U7n= 
B1 ) = U7n=1 (A n B1 ) for any sets
A, B1, B 2 , .  
B,.
21. In Section 2.2, we defined the symmetric difference of
two sets. More generally, the symmetric difference of
n > 3 sets Al, 
.
An can be defined inductively as
follows:
AI eED ..
b)An 
= (AI (D ...
EAn-I) 
&An.
Prove that for any n > 2, A 1 E A2 ( ... 
An consists of
those elements in an odd number of the sets AI, . .., A,
22. Prove the Chinese Remainder Theorem, 4.5.1, by math-
ematical induction.
23. [BB] For n > 3, the greatest common divisor of
n nonzero integers al, a2, 
an can be defined
inductively by
gcd(aj, . . ., an) = gcd(at, 
gcd(a 2
, 
an)).
Prove that gcd(al, a2, 
an) is an integral linear
combination of al, a. 
a,, for all n > 2; that is,
prove that there exist integers s, 
s,, s 
such that
gcd(al, ... 
, a,) = sia, + s2a2 + 
+ san.
24. The definition of the greatest common divisor of n > 3
integers given in Exercise 23 differs from that given
in the exercises to Section 4.2. Suppose al, . . .a, 
are
nonzero integers. Show that gcd(al, . . ., an), as defined
in Exercise 23, satisfies the properties given in Defini-
tion 4.2.14.
25. Suppose n and ml, m2,. 
m, are natural numbers,
and that the mi are pairwise relatively prime. Suppose
each me divides n. Prove that the product mlm2 
mt
divides n. [Hint: Induction on t and Exercise 10 of
Section 4.2.]
26. Define f: Z -* Z by
n) - 2 
n > 1000
J I( f(f(n + 4)) 
n < 1000.
(a) Find the values of Jf(1000 -
n) for n = 0, 1, 2,
3,4,5.
(b) Guess a formula for f(l000 -
n) valid for n > 0
and prove your answer.
(c) Find f(5) and f(20).
(d) What is the range of f?

162 
Chapter 5 Induction and Recursion
A set A of integers is called an ideal if and only if
(i) 0 
A,
(ii) if a c A, then also -a 
r A, and
(iii) if a, b E A, then a + b e A.
27. For any integer n > 0, recall that nZ = {kn I k E Z)
denotes the set of multiples of n.
(a) Prove that nZ is an ideal of the integers.
(b) Let A be any ideal of Z. Prove that A = nZ for
some n > 0 by establishing each of the following
statements.
i. If A contains only one element, then A is of the
desired form.
Now assume that A contains more than one ele-
ment.
ii. Show that A contains a positive number.
iii. Show that A contains a smallest positive num-
ber n.
iv. nZ C A, where n is the integer found in iii.
v. A C nZ. [Hint: The division algorithm, 4.1.5.]
28. [BB] Prove that for every integer n > 2, the num-
ber of lines obtained by joining n distinct points in
the plane, 
no three of which 
are 
collinear, 
is
2n(n 
I).
29. An n-sided polygon (commonly shortened to n-gon) is a
closed planar figure bounded by n straight sides no two
of which intersect unless they are adjacent, in which
case they intersect just at a vertex. Thus, a 3-gon is
just a triangle, a 4-gon is a quadrilateral, a 5-gon is a
pentagon, and so on. An n-gon is convex if the line join-
ing any pair of nonadjacent vertices lies entirely within
the figure. A rectangle, for example, is convex. Prove
that the sum of the interior angles of a convex n-gon is
(n -2)180' 
for all n > 3.
30. Suppose a rectangle is subdivided into regions by means
of straight lines each extending from one border of the
rectangle to another. Prove that the regions of the "map"
so obtained can be colored with just two colors in such
a way that bordering "countries" have different colors.
31. (a) [BB] Given an equal arm balance capable of deter-
mining only the relative weights of two quantities
and eight coins, all of equal weight except possibly
one which is lighter, explain how to determine if
there is a light coin and how to identify it in just
two weighings.
(b) Given an equal arm balance as in (a) and 3' - 1
coins, n > 1, all of equal weight except possibly
one which is lighter, show how to determine if there
is a light coin and how to identify it in at most n
weighings.
32. True or false? In each case, give a proof or provide a
counterexample which disproves the given statement.
(a) [BB] 5f + n + 1 is divisible by 7 for all n > I
(b) 
Â±`=o(k 
+ 1) = n(n + 3)/2 for all n > I
(c) If n > 2, gcd( 
3 
' 
2 
) 
6
(d) (For students of calculus) n 15 > 2n for all n > 1
33. Let n be any integer greater than 1. Show that the fol-
lowing argument is valid. (See Section 1.5.)
P1 I 
P2
P2 
P3
Pn-l 
Pn
P I 
Pn
34. (For students who have completed a course in differen-
tial calculus) State and prove (by mathematical induc-
tion) a formula for rdx' which holds for all n > I.
n
The product of n elements al, a2 .
an is denoted f ar.
r=1
35. Let x be a real number, x : Â±1. Prove that
11 
2  
- x 2'
for any integer n > 1.
36. [BB] (For students of calculus) The condition x2 o I
is necessary in Exercise 35 since otherwise we would
have a denominator of 0 on the right. However,
I -
X2`
Jim
x-'1 1 
x-2
I -
X2+
and 
lim
X -1I 1-X2
both exist. Use the result of Exercise 35 to find these
limits.
" 
2r -I
37. Find an expression for j 2r -3 
valid for n > 2 and
prove by mathematical induction that your answer is
correct.

5.2 Recursively Defined Sequences 
163
38. For any n > 0, let F, = 22' + 1. (Those numbers
Fn which are prime are called Fermat primes. See
Section 4.3.)
nl
(a) Prove that H| F, = F,-2 
for all n > 1.
r=O
(b) Prove that gcd(Fm, Fn) = I for any positive
integers m and n with m :& n.
(c) Use the result of (b) to give another proof (different
from Euclid's) 
that there are infinitely many
primes.
39. For a given natural number n, prove that the set of all
polynomials of degree at most n with integer coefficients
is countable. [Hint: Let P, denote the set of all polyno-
mials of degree at most n with integer coefficients. The
result for Pi was Exercise 25(b) in Section 3.3.]
40. (a) Prove that the strong form of the Principle of Math-
ematical Induction implies the Well-Ordering Prin-
ciple.
(b) Prove that the Well-Ordering Principle implies the
strong form of the Principle of Mathematical Induc-
tion. (Assume no > I.)
41. In this section, we have studied two formulations of the
Principle of Mathematical Induction.
(a) Use either of these to establish the following (pecu-
liar?) third formulation.
Suppose UP(n) is a statement about the
natural number n such that
1. 
((l) is true;
2. For any k > 1, Y(k) true implies
1P(2k) true; and,
3. For any k > 2, P(k) true implies
P(k -) 
true.
(b) Prove that for any two nonnegative numbers x and
YX + y>
2 
-
(c) Use the Principle of Mathematical Induction in the
form given in part (a) to generalize the result of part
(b), thus establishing the arithmetic mean-geometric
mean inequality: For any n > I and any n nonneg-
ative real numbers al, a2 ., 
an,
al +a2+*+a,,
a] 
a2+ 
+a,,> 
;/a I ~a2 an -n
n
42. Let m and n be relatively prime integers each greater
than 1. Assume you have an unlimited supply of m- and
n-cent stamps. Using only these stamps, show that
(a) it is not possible to purchase a selection of stamps
worth precisely mn - m - n cents;
(b) for any r > mn- m -n, 
it is possible to purchase
a selection of stamps worth exactly r cents. [Hint:
There exist integers a and b, with 0 < a < n and
0 < b < m such that bn = am- 
I and hence such
that (n -a)m = (m - b)n -1. See Exercise 34 of
Section 4.2. Now try downward induction!]
5.2 
RECURSIVELY DEFINED SEQUENCES
Suppose n is a natural number. How should we define 2'? We could write
2n = 2 -
2 2.*.*2
n 2's
or
(4)
21 = 2 
and, for k > 1, 
2 k+ = 2
2k.
The latter statement is an example of a recursive definition. It explicitly defines
2n when n = 1 and then, assuming 2n has been defined for n = k, defines it for
n = k + 1. By the Principle of Mathematical Induction, we know that 2" has been
defined for all integers n > 1.
Another expression that is most naturally defined recursively is n!, which was
introduced in Section 5.1. If we write
0! = 1 
and, for k > 0, 
(k + 1)! = (k + l)k!,
then it follows by the Principle of Mathematical Induction that n! has been defined
for every n > 0.
Sequences of numbers are often defined recursively. A sequence is a func-
tion whose domain is some infinite set of integers (often N) and whose range

164 
Chapter 5 Induction and Recursion
is a set of real numbers. Since its domain is countable, we can and usually do
describe a sequence by simply listing its range. The sequence which is the func-
tion f: N -* 
R defined by f (n) = n2, for instance, is generally described by the
list 1, 4, 9, 16, . . ., the idea being to write down enough numbers from the start
of the list that the rest can be inferred. The numbers in the list (the range of the
function) are called the terms of the sequence. Sometimes we start counting at 0
(if the function has domain N U {0)) so that the terms are denoted ao, al, a2,.
The sequence 2, 4, 8, 16, . . . can be defined recursively like this:
(5) 
ai = 2 
and, for k > 1, 
ak+1 = 2 ak.
By this, we understand that al = 2 and then, setting k = I in the second part of
the definition, that a2 = 2al = 2(2) = 4. With k = 2, a3 = 2a2 = 2(4) = 8; with
k = 3, a4 = 2a3 = 2(8) = 16 and so on. Evidently, (5) defines the sequence we
had in mind. Again, the definition is recursive because each term in the sequence
beyond the first is defined in terms of the previous term.
The equation ak+1 = 2ak in (5), which defines one member of the sequence
in terms of a previous one, is called a recurrence relation. The equation al = 2
is called an initial condition.
There are other possible recursive definitions which describe the same
sequence as (5). For example, we could write
ao = 2 
and, for k > 0, 
ak+1 = 2ak,
or we could say
al = 2 
and, for k > 2, 
ak = 2ak-I
[Verify that these definitions give the same sequence, 2, 4, 8, 16, .
Sometimes, after computing a few terms of a sequence which has been defined
recursively, we can guess an explicit formula for an. In (5), for instance, a, = 2'.
We say that a, = 21 is the solution to the recurrence relation. Our goal in this
section and the next is to gain some skill at solving recurrence relations.
PROBLEM 10. 
Write down the first six terms of the sequence defined by al = 1,
ak+1 = 3ak + I for k > 1. Guess a formula for a,1 and prove that your formula is
correct.
Solution. 
The first six terms are
al = I
a2 = 3al + I = 3(l) + I = 4
a3 = 3a2 + 1 = 3(4) + I = 13
a4 = 40
a5 = 121
a6 = 364.
Since there is multiplication by 3 at each step, we might suspect that 3" is involved
in the answer. After trial and error, we guess that a, = 1(3" -1) and verify this
by mathematical induction.
When n = 1, the formula gives 
(31 -1) 
= 1, which is indeed al, the first
term in the sequence.

5.2 Recursively Defined Sequences 
165
Now assume that k > 1 and that ak = 2(3 k-1). We wish to prove that
ak+l = 1( 3 k+1 -
1). We have
ak+1 = 3ak + I = 3 1(3 k - 1) + 1
using the induction hypothesis. Hence,
ak+l = 13k+1- 3 + 
= I (3k+l - 1)
as required. By the Principle of Mathematical Induction, our guess is correct. 
I
PROBLEM 11. 
A sequence is defined recursively by ao = 1, al = 4 and
a, = 4a_ 
- 4a,-2 for n > 2. Find the first six terms of this sequence. Guess a
formula for an and establish the validity of your guess.
Solution. 
Here there are two initial conditions-ao = 1,al = 4. Also, the
recurrence relation, a, = 4a, -
4a,-2, defines the general term as a function
of two previous terms. The first six terms of the sequence are
ao = I
al = 4
a2 = 4al -
4ao = 4(4) -
4(1) = 12
a3 = 4a2 - 4al = 4(12) - 4(4) = 32
a4 = 4a3 -
4a2 = 4(32) - 4(12) = 80
a5 = 4a4 -4a3 
= 4(80) - 4(32) = 192.
Finding a general formula for a, requires some ingenuity. Let us carefully examine
some of the first six terms. We note that a3 = 32 = 24 + 8 = 3(8) + 8 = 4(8) and
a4 = 80 = 64 + 16 = 4(16) + 16 = 5(16) and a5 = 192 = 6(32). We guess that
a, = (n + 1) 2f. 
To prove this, we use the strong form of mathematical induction
(with no = 0).
When n = 0, we have (0 + 1)20 = 1(1) = 1, in agreement with the given
value for ao. When n = 1, (I + 1)21 = 4 = a,. Now that the formula has been
verified for k = 0 and k = 1, we may assume that k > 1 and that an = (n + 1)2 n
for all n in the interval 0 < n < k. We wish to prove the formula is valid for
n = k; that is, we wish to prove that ak = (k + 1 )2k. Since k > 2, we know
that ak = 4 ak-1 - 4ak-2. Applying the induction hypothesis to k - 1 and to
k -
2 (each of which is in the range 0 < n < k), we have ak-I = k2k-I and
ak-2 
(k -
1)2k-2. Thus,
ak =4(k2 k) 
- 4(k -
1)2k 2 = 2k2k - k2kÂ±+ 
2k = k 2k + 2k = (k + 1)2k
as required. By the Principle of Mathematical Induction, the formula is valid for
all n > 0. 
I
In effect, our method of verifying the formula a, = (n + l )2f in Problem 11
amounts simply to checking that it satisfies both initial conditions and also the
given recurrence relation. We prefer the more formal approach of mathematical

166 
Chapter 5 Induction and Recursion
induction since it emphasizes this important concept and avoids pitfalls associated
with working on both sides of an equation at once.
As previously mentioned, there is nothing unique about a recursive definition.
The sequence in the last example can also be defined by
ao = 1, al = 4 
and, for n > 1, 
an+1 = 4an-4an-
In this case, we again obtain an = (n + 1)2'. We could also say
al = 1, a2 = 4 
and, for n > 1, 
an+2 = 4al+1 -4a
but then, labeling the first term al instead of ao would give an = n2n-1. Other
variants are also possible.
Some Special Sequences
Suppose you have $50 in an old shoe box and acquire a paper route which nets
you $14 a week. Assuming all this money goes into your shoe box on a weekly
basis (and you never borrow from it), after your first week delivering papers,
your shoe box will contain $64; after two weeks, $78; after three weeks, $92
and so on. A sequence of numbers like 50, 64, 78, 92, ... , where each term is
determined by adding the same fixed number to the previous one, is called an
arithmetic sequence. The fixed number is called the common difference of the
sequence (because the difference of successive terms is constant throughout the
sequence).
EXAMPLES 12 
.
50, 64, 78, 92, ... is an arithmetic sequence with common difference 14;
* -17, -12, -7, -2, 3, 8, ... 
is an arithmetic sequence with common differ-
ence 5;
* 103, 99, 95, 91, ... is an arithmetic sequence with common difference-4.
I 
S
The arithmetic sequence with first term a and common difference d is the sequence
defined by
al =a 
and, for k > 1, 
ak+1 = ak +d.
The general arithmetic sequence thus takes the form
a, a + d, a + 2d, a + 3d, ...
and it is easy to see that, for n > 1, the nth term of the sequence is
(6) 
| 
~ 
Ads = afi:(- 
I:000
We leave a formal proof to the exercises and also a proof of the fact that the sum
of n terms of the arithmetic sequence with first term a and common difference
d is
(7) 
S-= -
12a + (

5.2 Recursively Defined Sequences 
167
EXAMPLE 13
EXAMPLES 14
I
EXAMPLE 15
The first 100 terms of the arithmetic sequence -17, 
-12, 
-7, -2, 3, ... 
have the
sum
S = 100 [2(-17) + 99(5)] = 50(-34 + 495) = 23,050.
The 100th term of this sequence is afoo = -17+99(5) 
= 478 by (6). The number
2038 occurs as the 412th term, as we see by solving -17 + (n - 1)5 = 2038. -
Many people with paper routes deposit their earnings in a bank account which
pays interest instead of into a shoe box, which does not. Fifty dollars in a bank
account which pays 1% interest per month accumulates to 50 + (.01 x 50) =
50(1 +.01) = 50(1.01) dollars after one month. After another month, the original
investment will have accumulated to what it was at the start of the month plus
1% of this amount; that is,
50(1.01) + .01(50)(1.01) = 50(1.01)(1 + .01) = 50(1.01)2.
After three months, the accumulation is 50(1.01)3 dollars; after twelve months, it
is 50(1.01)12 dollars (a- $56.34). A sequence of numbers such as
50, 50(1.01), 50(1.01)2, ....
in which each term is determined by multiplying the previous term by a fixed
number is called a geometric sequence. The fixed number is called the common
ratio.
.
50, 50(1.01), 50(1.01)2, ... is a geometric sequence with common ratio 1.01;
.
3, -6, 12, -24, ... is a geometric sequence with common ratio -2;
* 9, 3, 1, 1, . . . is a geometric sequence with common ratio 
.
A
The geometric sequence with first term a and common ratio r is the sequence
defined by
al =a 
and, for k > 1, 
ak+I = rak.
The general geometric sequence thus has the form
2 
3 
4
a, ar, ar , ar , ar ...
the nth term being a, = ar" 
. This is straightforward to prove, as is the following
formula for the sum S of n terms, provided r =A 1.
S(= a(1 - r')
I -r
The sum of 29 terms of the geometric sequence with a = 812 and r = -2 
is
S = 812 1 
-
236 1r(2)2 
- 236+2 7 ='(237 + 28).
' ( D) 
2 
2
A
(8)

168 
Chapter 5 Induction and Recursion
M=D
33 
s]L -II4
-=LI
(1 
+ V)
at 
2 
}
(9)
The first few values of -( 
+2) 
are approximately 0.72361, 1.17082, 1.89443,
3.06525, 4.95967, 8.02492, 12.98460, and 21.00952; the integers closest to these
numbers are the first eight terms of the Fibonacci sequence.
Finally, note that we must be careful with sequences apparently defined recur-
sively, since some recursive definitions do not define actual sequences! Consider,
for example,
and fork> 
a 
I + ak/2 if k is even
alI=l 
+ a3k 
if k is odd.
'Fibonacci was born around the year 1180 and died in 1228. "Fibonacci" is a contraction of "Filius
Bonaccii," Latin for "son of Bonaccio."
What is the 30th term of the geometric sequence just described?
Leonardo Fibonacci,' also known as Leonardo of Pisa, was one of the bright-
est mathematicians of the Middle Ages. His writings in arithmetic and algebra
were standard authorities for centuries and are largely responsible for the intro-
duction into Europe of the Arabic numerals 0, 1, . . , 9 we use today. Fibonacci
was fond of problems, his most famous of which is concerned with rabbits!
Suppose that newborn rabbits start producing offspring by the end of their sec-
ond month of life and that after this point, they produce a pair a month (one male,
one female). Assuming just one pair of rabbits initially, how many pairs of rab-
bits, Fibonacci asked, will be alive after one year? The sequence which gives the
number of pairs at the end of successive months is the famous Fibonacci sequence.
After one month, there is still only one pair of rabbits in existence, but after a
further month, this pair is joined by its offspring; thus, after two months, there are
two pairs of rabbits. At the end of any month, the number of pairs of rabbits is the
number alive at the end of the previous month plus the number of pairs alive two
months ago, since each pair alive two months ago produced one pair of offspring. We
obtain the sequence 1, 1, 2, 3, 5, 8, 13, . . ., which is defined recursively as follows.
fI = 1, f2 = I 
and, for k > 2, 
fk += 
fk + fk l
Think of the Fibonacci sequence as a function fib: N 
N. List eight elements
of this function as ordered pairs. Is fib a one-to-one function? Is it onto?
What is the answer to Fibonacci's question?
Although we have found an explicit formula for the nth term of most of the
sequences discussed so far, there are many sequences for which such a formula is
difficult or impossible to obtain. (This is one reason why recursive definitions are
important.) Is there a specific formula for the nth term of the Fibonacci sequence?
As a matter of fact, there is, though it is certainly not one which many people
would discover by themselves. We show in the next section (see Problem 20) that
the nth term of the Fibonacci sequence is the closest integer to the number

5.2 Recursively Defined Sequences 
169
A 
-
* ** 
-
What happens if we try to write down the first few terms of this sequence?
ai = 1
a2 = 1 +at = 1 + 1 = 2
a3= 
+a8 = 1 +(I +a4) = 2+a4 =2+(1 
+a2) = 3+a2 =5
a4 = 1 + a2 
1 + 2 = 3,
but then
a5 
1 +a14 = 1 + (1 +a7) 2+a7
=2+ 
(1 +a2o) = 3+a2o = 3+(I+ 
alo)
=4+alo=4+(1+a5) 
=5+a5
and, to our dismay, we have reached the absurdity 5 = 0. Obviously, no sequence
has been defined.
Compute the first six terms of the sequence "defined" as follows:
ai-1~~ 
an+ok1 
akkl2 
if kis even
al = I 
and, for k > 1, 
ak 
I= 
k2 
i 
see
1 + a3k+1 if k is odd.
5. Here n = 30, a = 812 = (23)12 = 236 and r = -(2-1), 
so
a3o= 26[_-(2- )]29 =-2362-29 =-27 =-128.
6. The most obvious eight pairs are (1, 1), (2, 1), (3, 2), (4, 3), (5, 5), (6, 8),
(7, 13), and (8, 21). The Fibonacci function is not one-to-one because (1, 1) C
fib and (2, 1) c fib but 1 :A 2. It's not onto since, for example, 4 is not in
the range.
7. The number of rabbits in existence after twelve months is the thirteenth term
of the Fibonacci sequence, 233.
8. al = 1; a2 = 1 +a, 
1 + 1 = 2; a3 
1 +alo = 1 + 1 +a5 = 2+1 +a16 =
3 + a16. Now a16 = 1 +a 
= 1 + 1 + a4 = 1 + 1 + I + a2 = 3 + 2 = 5, so
that a3 = 3 + 5 = 8. Continuing, a4 = I + a2 = 3; a5 
1 + a]6 = 1+ 5 = 6;
a6= 
+ a3 = I + 
8 = 9. The first six terms are 1,2,8,3,6,9.
The symbol [BB] means that an answer can be found in the Back of the Book.
1. Give recursive definitions of each of the following
sequences:
(a) [BB] 1,5, 52 53 54
(b) 5, 3, I, -1, -3, .. .
(c) 4, 1,3, -2,5, -7, 12, -19,31, ...
(d) 1,2,0,3, -1,4,-2,...
2. (a) [BB] Find the first seven terms of the sequence [an)
defined by
al = 16, and for k > 1,
ak+1 = 
|2ak
= (ak-
(b) Repeat part (a) with a1
(c) Repeat part (a) with a,
(d) Repeat part (a) with a,
if ak = I
if ak is even
-1) if ak j 
1 is odd.
= 17.
= 18.
1= 
100.
ff 01-ITC-MM 
-

170 
Chapter 5 Induction and Recursion
3. Let al, a2, a3, ... be the sequence defined by a, = 1,
ak+1 = 3ak for k > 1. Prove that an = 3'-1 for all
n> 1.
4. [BB] Suppose al, a2, a3, ... 
is a sequence of integers
such that al = 0 and, for n > 1, a,, = n3 +an- . Prove
that an 
(n- 1)(n+2)(n2 +n+2) for every integer n > I.
4
5. Define the sequence al, a2, a3, .... by al = 0, a= 
2
and ak+2 = 2(ak + ak+l) for k > 1. Find the first seven
terms of this sequence. Prove that an = 3 (I I(-2- 
)
for every n > 1.
6. [BB] Let al, a2, a3, .... be the sequence defined by al =
I and, for n > 1, a, = 2a, 
I + 1. Write down the first
six terms of this sequence. Guess a formula for an and
prove that your guess is correct.
7. Let al, a2, a3, ... be the sequence defined by al = 3
and an = 5a,_, -
I for n > 2. Write down the first
six terms of this sequence. Guess a formula for a, and
prove that your guess is correct.
8. Suppose ao, al, a2, ... 
is a sequence such that ao 
-
al = I and for n > 1, a,+l = n(a,, + an-,).
(a)
(b)
Find a2, a3, a4 and a5.
Guess a formula for a, valid for n > 0, and use
mathematical induction to prove that your guess is
correct.
9. [BB] Consider the sequence defined by al = 1, a,,+l =
(n + 1)2 - an for n > 1. Find the first six terms. Guess
a general formula for an and prove that your answer is
correct.
10. Let al, a2, a3, ... be the sequence defined by a, = 1,
ak+1 = (k + I)ak for k > 1. Find a formula for a, and
prove that your formula is correct.
11. [BB] Suppose a,, a2, a3, . . .
is a sequence of integers
such that al = 0, a2 = I and for n > 2, a, = 4an 2-
Guess a formula for a,, and prove that your guess is
correct.
12. A sequence is defined recursively by ao = 2, al = 3
and a, = 3a, I- 2a,-2 for n > 2.
(a)
(b)
(c)
(d)
Find the first five terms of this sequence.
Guess a formula for a,,.
Verify that your guess in (b) is correct.
Find a formula for a, which involves only one pre-
ceding term.
13. Let al, a2, a3, .... be the sequence defined by a, = 1,
a2 = 0 and for n > 2, a,, = 4a,1 - 4a,- 2. Prove that
a, = 2'(1- ') 
for all n > 1.
14. Let al, a2, a3, ... 
be the sequence defined by
al 
, 
and for k > 1, 
ak+1 = k2ak.
Find the first six terms of this sequence. Guess a general
formula for an and prove your answer by mathematical
induction.
15. Consider the arithmetic sequence with first term 2 and
common difference 3.
(a) [BB] Find the first ten terms and the 123rd term of
this sequence.
(b) [BB] Does 752 belong to this sequence? If so, what
is the number of the term where it appears?
(c) Repeat (b) for 1023 and 4127.
(d) [BB] Find the sum of the first 75 terms of this
sequence.
16. [BB] Consider the arithmetic sequence with first term 7
and common difference- 
2.
(a) Find the 17th and 92nd terms.
(b) Find the sum of the first 38 terms.
17. An arithmetic sequence begins 116, 109, 102.
(a) Find the 300th term of this sequence.
(b) Determine whether or not -480 
belongs to this
sequence. If it does, what is its term number?
(c) Find the sum of the first 300 terms of the sequence.
18. The arithmetic sequence 4, 15, 26, 37, ... begins with a
perfect square, that is, an integer of the form k2, where
k is also an integer. Find the next three perfect squares
in this sequence.
19. Establish formulas (6) [BB] and (7) for the nth term and
the sum of the first n terms of the arithmetic sequence
with first term a and common difference d.
20. [BB] Consider the geometric sequence with first term
59,049 and common ratio -
.
(a) Find the first ten terms and the 33rd term of this
sequence.
(b) Find the sum of the first 12 terms.
21. Consider 
the 
geometric 
sequence 
which 
begins
-3072, 1536, -768.
(a) Find the 13th and 20th terms of this sequence.
(b) Find the sum of the first nine terms.
22. If the first term of a geometric sequence is 48 and the
sixth term is -3, find the sum of the first ten terms.
23. (a) [BB] Find, to four decimal places, the 129th
term of the geometric sequence which begins
-0.0000 1240, 0.00001364.
(b) [BB] Find the approximate sum of the first 129
terms of the sequence in (a).

5.2 Recursively Defined Sequences 
171
24. [BB] Verify formula (8) for the sum of n terms of a
geometric sequence with first term a and common ratio
r 7 1.
25. Consider the sequence defined recursively by al =
and for n > 1, an= 
ai. Write down the first six
terms of this sequence, guess a formula for an valid for
n > 2, and prove your answer.
26. (a) Find the sum of 18 terms of the geometric sequence
with first term 7/1024 and common ratio 8.
(b) [BB] Suppose JrI < 1. Explain why the sum of the
first n terms of the geometric sequence with first
term a and common ratio r is approximately 
1ar
1003
(c) [BB] Approximate E Yk'
k=O
(d) Find the approximate sum of the first I million terms
of the geometric sequence which begins 144, 48, 16.
27. (a) Find the l9th and 100th terms of the geometric
sequence which has first term 98,415 and common
ratio 3'
(b) Find the sum of the first 15 terms of the sequence
in (a).
(c) Find the approximate sum of the first 10,000 terms
of the sequence in (a).
28. Given that each sum below is the sum of part of an
arithmetic or geometric sequence, find each sum.
(a) [BB] 75 + 71 + 67 + 63 + 
+ (-61)
(b) 75+15+3+ 5 
+ 
5+
(c) -52 - 41 - 30 -
19 + 
+ 949
(d) I -2 + 1 -
+ '+26
(e) 2+6+ 18 + 54 + 
+ 354,294
29. [BB] Is it possible for an arithmetic sequence to be also
a geometric sequence? Explain your answer.
30. A bank account pays interest at the rate of I00i% a year.
Assume an initial balance of P, which accumulates to
s, after n years.
(a) Find a recursive definition for sn.
(b) Find a formula for sn
31. [BB] Maurice borrows $1000 at an interest rate of 15%,
compounded annually.
(a) How much does Maurice owe after two years?
(b) In how many years will the debt grow to $2000?
32. On January 1, 2001, you have $50 in a savings account,
which pays interest at the rate of 1% per month. At the
end of January and at the end of each month there-
after, you deposit $56 to this account. Assuming no
withdrawals, what will be your balance on January 1,
2002?
33. On June 1, you win $1 million in a lottery and imme-
diately acquire numerous "friends," one of whom offers
you the deal of a lifetime. In return for the million, she'll
pay you a cent today, two cents tomorrow, four cents
the next day, eight cents the next, and so on, stopping
with the last payment on June 21.
(a) Assuming you take this deal, how much money will
you receive on June 21?
(b) Should you take the deal? Explain.
(c) Would you take the deal if payments continued for
the entire month of June?
34. Define a sequence (a, I recursively as follows:
ao = 0, 
and for n > 0, 
a, = aLn/5j + aL3n/51 + n.
Prove that a, 
< 20n for all n > 0. (Recall that
Lx] denotes the floor of the real number x. See para-
graph 3.1.6.)
35. The number '' 
-
2 
1.618 is known as the
golden mean. It has many remarkable properties. For
instance, the geometric sequence 1, q,, p2... satisfies
the Fibonacci recurrence relation a,+l = an + an- .
Establish this fact.
36. [BB] Suppose we think of the Fibonacci sequence as
going backward as well as forward. What seven terms
precede 
1, 1, 2, 3, 5, 8, ... ? 
How 
is f-, 
related
to fn?
37. [BB] Let If,) denote the Fibonacci sequence. Prove that
fn +I fn = yn 
J,2 for all n > 1.
38. Represent the Fibonacci sequence by f 
= J2 = 1,
Af = A-I + Af- 
2 for n > 2.
(a) Verify the formula f+f 2+f3+.. Â±fn = JÂ±+2 -
for n = 4, 5, 6.
(b) Prove that the formula in (a) is valid for all n > 1.
39. Show that, for n > 2, the nth term of the Fibonacci
sequence is less than (7/4)n-1. [Use the definition of
the Fibonacci sequence, not the approximation to fn
given in equation (9).]
40. [BB] What is wrong with the following argument, which
purports to prove that all the Fibonacci numbers after the
first two are even?
Let f,, denote the nth term of the Fibonacci
sequence. We prove that fn is even for all
n > 3 using the strong form of the Principle

172 
Chapter 5 Induction and Recursion
of Mathematical Induction. The Fibonacci
sequence begins 1, 1, 2. Certainly f3 = 2 is
even and so the assertion is true for no = 3.
Now let k > 3 be an integer and assume that
the assertion is true for all n, 3 < n < k;
that is, assume that fn is even for all n <
k. We wish to show that the assertion is
true for n = k; we wish to show that fk is
even. But fk =k 
I + fk 2 Applying the
induction hypothesis to k -
and to k - 2,
we conclude that each of fk- I and fk-2 is
even, hence, so is the sum. By the Principle
of Mathematical Induction, fn is even for
all n > 3.
41. Let fj = f2 = 1, fk = fk-I + fk-2 for k > 2 be the
Fibonacci sequence. Which terms of this sequence are
even? Prove your answer.
42. For n > I, let a,, denote the number of ways to express n
as the sum of natural numbers, taking order into account.
For example, 3 = 3 = I + I + I = 2 + I = I + 2, so
a3 =4.
(a) [BB] Find the first five terms of the sequence (an}.
(b) Guess and then establish a formula for an.
43. For n > 1, let b, denote the number of ways to express
n as the sum of l's and 2's, taking order into account.
Thus, b4 = 5 because 4 = 1 + I + 1 + I = 2+2
2+Â±11 = 
+1+2=1+2+1.
(a) Find the first five terms of the sequence {bn}.
(b) Find a recursive definition for bn and identify this
sequence.
44. (a) [BB] Let a,, be the number of ways of form-
ing a line of n people distinguished only by sex.
For example, there are four possible lines of two
people-MM, MF, FM, FF-so a2 = 4. Find a
recurrence relation satisfied by an and identify the
sequence al, a2, a3, ....
(b) Let an be the number of ways in which a line of n
people can be formed such that no two males are
standing beside each other. For example, a3 = 5
because there are five ways to form lines of three
people with no two males beside each other; namely,
FFF, MFF, FMF, FFM, MFM. Find a recurrence
relation satisfied by a,, and identify the sequence
al, a2, a3, . .. .
2jt is unknown whether or not the terms of this sequence ever repeat.
45. Define the Fibonacci sequence by fl = f2 = 1, fn+- =
fn + fi
1 for n > 2.
(a) Prove that gcd(f,+,, fn) = 1 for all n > 1.
(b) Prove that f, = f,,-m+tfm + fn mfmn1 for any
positive integers n and m with n > m > 1.
(c) Prove that for any positive integers n and m, the
greatest common divisor of fn and fm is fgcd(n,m)
46. Suppose Un and v, are sequences defined recursively by
u I 
O ,vI = 1, and, for n > 1,
Un+1 = 1(Un + Vn), Vn+i = 1(un + 3Vn).
(a) Prove that Vn, u, = 4n l for n > 1.
(b) Prove that Un is an increasing sequence; that is,
Un+1 > Un for all n > 1.
(c) Prove that Vn is a decreasing sequence; that is,
Vn+1 < Vn for all n > 1.
(d) Prove that Un = 
-
* 9 2for all n > 1.
(This problem is taken from a Portuguese examination
designed to test the level of mathematical knowledge
of graduating high school students. It was reprinted in
Focus, the newsletter of the Mathematical Association
of America 13, no. 3, June 1993, p. 13.)
The powers of a function f: A -- A are defined recur-
sively by
fl=f 
and,for n >1, 
fn= fofn-
47. Suppose f: N -- N is defined by
2m 
if m -0 
(mod3)
f(m) = 
4m3- 
ifm -I 
(mod 3)
4m3+ Iif 
m -2 
(mod 3).
(a)
(b)
(c)
(d)
(e)
Prove that f is one-to-one and onto.
[BB] Find the first ten terms of the sequence f " (l).
Find the sequence f/ (2), n > 1.
Find the sequence f" (4), n > 1.
Find the first ten terms of the sequence fn (8),
n > 1.2

5.3 The Characteristic Polynomial 
173
48. Define g: N -p N by 
g(m), g 2(m), g 3(m), ... eventually terminates with 1.
m 
if 
.isVerify 
this assertion for each of the five integers m -
(m)f 
mIs even 
341, 96, 104, 336, and 133.3
g 
-) 
___ 
if m is odd.
2 
i. 
49. (For students who have had a course in linear algebra)
This function is known as the "3m + I" function. It is 
Give a recursive definition of the determinant of an n x n
suspected that for any starting number m, the sequence 
matrix, for n > 1.
5.3 
SOLVING RECURRENCE RELATIONS; THE CHARACTERISTIC POLYNOMIAL
Recursively defined sequences were introduced in the previous section. Given a
particular recurrence relation and certain initial conditions, you were encouraged
to guess a formula for the nth term and prove that a guess was correct. Guessing
is an important tool in mathematics and a skill which can be sharpened through
practice, but we now confess that there is a definite procedure for solving most
of the recurrence relations we have encountered so far.
In this section, we describe a procedure for solving recurrence relations of
the form
(10) 
an = ran-] +isan-2 
+ f(n)
where r and s are constants and f (n) is some function of n. Such a recurrence
relation is called a second order linear recurrence relation with constant coeffi-
cients. If f (n) = 0, the relation is called homogeneous. Second order refers to the
fact that the recurrence relation (10) defines a, as a function of the two terms pre-
ceding it, linear to the fact that the terms of the sequence appear by themselves,
to the first power, and with just constant coefficients. You should consult more
specialized books in combinatorics for a general treatment of constant coefficient
recurrence relations where an is a function of any number of terms of the form
can-i, c E R.
EXAMPLES 16 
Here are some second order linear recurrence relations with constant coefficients.
* an = an- 1 +an -2, the recurrence relation which appears in the definition of the
Fibonacci sequence. This is homogeneous with r = s = 1. Notice that we have
modified slightly the definition an +I = an +an- given in paragraph 5.2.3 so
that it is readily seen to be of the type we are considering here.
a an = 5an-1-6an-2 + n. Here r = 5, s =-6, f (n) = n.
.
an = 3a, 
I. This is homogeneous with r = 3, s = 0. 
A
EXAMPLES 17 
Consider the following two recurrence relations.
* an = 5an-
0 
-3an-3
* an = an- I an-2 + 1)2
3While this conjecture has been established for all integers m < 240 t 
1012, it is unknown whether it
holds for all integers! This problem has attracted the interest of many people, some of whom have offered a
sizeable monetary reward for its solution! We refer the interested reader to the excellent article, "The 3x + I
Problem and Its Generalizations," by Jeffrey C. Lagarias, American Mathematical Monthly 92 (1985) no. I,
1-23.
4See, for example, Alan Tucker, Applied Combinatorics Wiley, New York: (1980).

174 Chapter 5 Induction and Recursion
Neither is of interest to us in this section. The first is not second order while the
second is not linear. 
A
With the homogeneous recurrence relation a, = ra,_ + sa,-2, which can
be rewritten in the form
an- ran-1 -san-2 
= 0,
we associate the quadratic polynomial
x2 _ rx-s,
which is called the characteristic polynomial of the recurrence relation. Its roots
are called the characteristic roots of the recurrence relation. For example, the
recurrence relation an = 5an- - 6a,-2 has characteristic polynomial x2 -5x + 6
and characteristic roots 2 and 3.
The following theorem, whose proof is left to the exercises, shows how to
solve any second order linear homogeneous recurrence relation with constant
coefficients.
Let xl and x2 be the roots of the polynomial x2 -rx -s. 
Then the solution of
the recurrence relation a, = ran- + san-2, n > 2, is
cxl + c2x2 
if xI 
x 2
a c1xn + c 2nxn 
if xl= x2 = x.
In each case, cl and c2 are constants determined by initial conditions.
PROBLEM 18. 
Solve the recurrence relation an = 5an - -6a -2, n > 2, given
ao = 1, al = 4.
Solution. 
The characteristic polynomial, x2 -5x 
+ 6, has distinct roots xl =
2,X2 = 3. Theorem 5.3.1 tells us that the solution is an = ci(2') + c2(3Y).
Since ao = 1, we must have cl (20) + c2(30 ) = I and, since a1 = 4, we have
ci(2') + c2(3') 
4. Therefore,
C1 +C2 
=1
2cl + 3c2 = 4.
Solving, we have cl = -1, c2 = 2, so the solution is an =-2n 
+ 2 (3 n). (You
are encouraged to verify that this formula is correct.) 
I
PROBLEM 19. 
Solve the recurrence an = 4a,_1 
4a,-2, n > 2, with initial
conditions ao = 1, a, = 4. (We solved this by guesswork and ingenuity in
Problem 11.)
Solution. 
The characteristic polynomial, x2 -4x+4, has the repeated root x = 2.
Hence, the solution is an = cl (2 n) + c2 n(2n). The initial conditions yield cl = 1,
2cI + 2C2 = 4, so c2 = 1. Thus, a, =2' + n(2n) = (n + 1)2n. 
I
PROBLEM 20. 
Find a formula for the nth term of the Fibonacci sequence.
Solution. 
To simplify the algebra which follows, we take for initial conditions
ao = a = 1 rather than al = a2 = 1. Hence, the recurrence relation to be solved
is an = an-I + a,-2, n > 2, and we must remember that the nth term will be
S.

5.3 The Characteristic Polynomial 
175
an-I. The characteristic polynomial, x 2 - x -1, has distinct roots lÂ±b. Hence,
the solution to our recurrence relation is
( I+,15 n 
(I 
-
f5 
n
a. 
=cl(12 
+ C2( 
2)f
The initial conditions give
Cl + C2 
1
cl ( Â±+j) + c2 (i-15) = 1
yielding cl = 3 (I+7/) 
and c2 
I ( I-3). Thus, the solution is
a, = o (,+1+2) 
(,+,-)n -
1 (I5-) (l 
5 
3)n
I 
(I+.,fn-~A 
-I 
(l 
15)n+l
The nth term of the Fibonacci sequence is
I (iÂ±+ 5 
I)n 
I(i1-3)n
In Exercise 18, we ask you to use this result to obtain the simpler formula (9) on
p. 168.
Why is the real number v 
-1 ;, (I /-) 
an integer for any n > 1?
We now turn our attention to the general second order recurrence relation
an = ran- I + san-2 + f (n) and show that the solution is closely related to the
corresponding homogeneous recurrence relation.
Suppose we could find one specific solution Pn to the given recurrence rela-
tion. (Such a function Pn is called a particular solution.) Thus, Pn = rpn 1 +
SPn-2 + f (n). Suppose tn were another solution. Then we would also have
tn = rtn 
+ s tns + f (n) and, subtracting,
tn - Pn = r(tn-I -p N) 
+ S(tn-2 -
Pn-2).
This equation shows that tn - Pn satisfies the homogeneous recurrence relation
an = ran- + san-2. Setting tn- Pn = q,, we have t, = pn + qn where Pn is a
particular solution to the given recurrence relation and qn satisfies the associated
homogeneous recurrence relation. This is the content of our next theorem.
Let Pn be any particular solution to the recurrence relation an = ran- + san-2 +
f (n) ignoring initial conditions. Let q, be the solution to the homogeneous
recurrence an = ran-I + san-2 given by Theorem 5.3.1, again ignoring ini-
tial conditions. Then pn + qn is the solution to the recurrence relation an
ran 1 + san 2 + f (n). The initial conditions determine the constants in q,.
As we have seen, the result of this theorem seems plausible. In the exercises,
you will be invited to supply a proof. The main point of the theorem is that once
some particular solution to the recurrence has been found, the problem is reduced
to the homogeneous case, which we have already considered. Finding a particular
solution can be difficult. As we shall see, a useful trick is to try a formula for pn
M

176 Chapter 5 Induction and Recursion
which is of the same type as f (n). For example, if f (n) is a linear function, try
a linear function for p,
PROBLEM 21. 
Solve the recurrence relation a, 
-
-3a,,-I + n, n > 1, where
ao= 1.
Solution. 
Since f(n) = n is linear, we try a linear function for p,; that is, we
set p,, = a + bn and attempt to determine a and b. Putting this expression for pn
in the given recurrence relation, we obtain
a+bn =-3[a+b(n- 1)]+n = -3a+3b+(1 -3b)n.
This equation will hold if a = -3a + 3b and b = I-3b, which is the same as
a = 3, b=. We conclude that p, = 3Â± + 1n is a particular solution to the
recurrence, ignoring initial conditions.
The corresponding homogeneous recurrence relation in this case is a, 
=
-3a,-j, whose characteristic polynomial is x2 + 3x. The characteristic roots are
-3 
and 0, so the solution to the homogeneous recurrence relation is
qn = cl (-3)n + C2(0') = cl (-3)n
Thus,
Pn + qn = 3 + 'n + cl (-3)n.
Since ao = 1, j3 + 1(0) + cl (-3)0  
1; that is, 3 + cl = 1. Thus, cl = 13 and
the solution is an = 
+ 1 n 
3+ 
L 
n
1 6 -4 
-1 6
PROBLEM 22. 
Solve a, = 2a,_1 +3a, 2+5", n > 2, given ao = -2, al = 1.
Solution. 
In looking for a particular solution, it seems reasonable to try p, 
-
a(5n). Substituting into the recurrence relation, we get
a(5n) = 2a(5n 1) + 3a(5s-2) + 5n
25a = la + 3a + 25
12a = 25,
so a = 25 and p, = 25 (5 n) is a particular solution.
Next we solve the homogeneous recurrence relation a, = 2an - + 3an 2. The
characteristic polynomial, x2 - 2x - 3, has distinct roots -1 and 3, so the solution
is qn = cl (- I)n + c2(3n). By Theorem 5.3.2, the given recurrence relation has
the solution
Pi + q_7 = 
25 (51) 
+ c I (-1Y) + 
Â±C2(3").
The initial conditions give
a( =-2 
= 25 + cl + c2
al = I = 25 (5) - cl + 3c2,
hence, cl 
17, 
C2 = 
2. 
Our solution is a,, 
= 
25 (5") -
(- 1)" -
8 (3 ) 
I
9. All the terms of the Fibonacci sequence are integers!

5.3 The Characteristic Polynomial 
177
The symbol [BB] means that an answer can be found in the Back of the Book.
1. [BB] Solve the recurrence relation an = an I + 6an-2,
n > 2, given ao = 1, aI = 3.
2. Solve the recurrence relation an = -6an-1 + 7a,-2,
n > 2, given ao-32, aI =-17.
3. [BB] Solve the recurrence relation an -
6an 1-9a,-2,
n > 2, given ao = -5, a = 3.
4. Solve the recurrence relation a,+, 
7a,, -
10a,,
n > 2, given al = 10, a2 = 29.
5. EBB] Solve the recurrence relation a, 
-8a,,-1 -an-2,
n > 2, given ao = 0, al = 1.
6. Solve the recurrence relation a,, = -5an-1 + 6an-2,
n > 2, given ao - 5, al = 19.
7. [BB] Solve the recurrence relation an+ 1  
2an, +3an-1,
n > 1, given ao = 0, al = 8.
8. Solve the recurrence relation an = 2an - Ia,-2, 
n > 2,
given ao = 40, al = 37.
9. Solve the recurrence relation 9a, = 6an- 
an-2, n >
2, given ao = 3, a =-1.
10. (a) [BB] Solve the recurrence relation an 
-2a, 
j +
15a,-2, n > 2, given ao = 1, al =-1.
(b) [BB] Solve the recurrence relation an =
15a,-2 + 24, n > 2, given ao = 1, al =
-2a,,1 +
-I.
11. (a) Solve the recurrence relation a,+1 
= 
-8a, -
16a, 
1, n > 1, given ao = 5, al = 17.
(b) Solve the recurrence relation an+] 
= 
-8a, 
-
16a, -I + 5, n > 1, given a( = 2, al 
-1.
12. Solve the recurrence relation a,, = 4a,- I 
4a, 
2 + n,
n > 2, given a( = 5, al = 9.
13. (a) [BB] Solve the recurrence relation a,, 
4a,, 1, n >
1, given a( = 1.
(b) [BB] Solve the recurrence relation a,, - 4a,-, +8n,
n > 1, given ao = 1.
(c) [BB] Verify that your answer to (b) is correct.
14. (a) Solve the recurrence relation a,, = 5an-, -6a,,-2,
n > 2, given ao = 2, al = 11.
(b) Solve the recurrence relation a, = -5a- 
- 6a,-2 +
3n, n > 2, given ao = 2, al = 14.
(c) Verify that your answer to (b) is correct.
15. (a) Solve the recurrence relation a,, = -6a,,- 
-9a, 
2,
n > 2, given a( = 1, al =-4.
(b) Solve the recurrence relation an = 
-6an
9an-2+n2+3n, n > 2, given ao = 179 at = -
(c) Verify that your answer to (b) is correct.
21
12X8'
16. (a) [BB] Solve the recurrence relation a, = 4an- -9,
n > 1, given ao = 4.
(b) [BB] Solve the recurrence relation a, = 4a,_1 +
3n2', n > 1, given ao = 4.
17. Solve the recurrence relation an = 5a,_ -2an-2+3n 2 ,
n > 2, given ao = 0, al = 3.
18. [BB] Using the result of Problem 20, show that the nth
term of the Fibonacci sequence is the integer closest to
I( 1+1f)n. This result was stated without proof in the
text. [Hint: Show that 1 
2 )| <.
19. Let an denote the number of n-digit numbers, each of
whose digits is 1, 2, 3, or 4 and in which the number of
l's is even.
(a) Find a recurrence relation for a,.
(b) Find an explicit formula for an.
20. The Towers of Hanoi is a popular puzzle. It consists of
three pegs and a number of discs of differing diameters,
each with a hole in the center. The discs initially sit on
one of the pegs in order of decreasing diameter (smallest
at top, largest at bottom, as in Fig 5.5), thus forming a
triangular tower. The object is to move the tower to one
of the other pegs by transferring the discs to any peg
one at a time in such a way that no disc is ever placed
upon a smaller one.
Figure 5.5 
The Towers of Hanoi.
(a) Solve the puzzle when there are n = 2 discs and
show your moves by completing a little table like
that below. [The pegs are labeled A, B, C, and we
have used an asterisk (*) to denote an empty peg.
The disks are numbered in order of increasing size,
thus disk I is the smallest.]

178 
Chapter 5 Induction and Recursion
Initial position
Move I
Move 2
etc.
A 
B
1,2 
*
?? 
??
?? 
??
C
*
??
??
Also solve the puzzle, with a similar table, when
n = 3. How many moves are required in each case?
(b) Give a recurrence relation for an, the number of
moves required to transfer n discs from one peg to
another.
(c) Find an explicit formula for an.
(d) Suppose we can move a disc a second. Estimate the
time required to transfer the discs if n = 8, n = 16,
n = 32, and n = 64.
21. Suppose we modify the traditional rules for the Tow-
ers of Hanoi as described in the preceding question by
requiring that one move discs only to an adjacent peg.
Answer all four parts of the previous question for this
new version of the puzzle.
22. [BB] Let an = ran-l +sa,-2, n > 2, be a second order
homogeneous recurrence relation with constant coeffi-
cients.
(a) If x is a root of the characteristic polynomial and
c is any constant, show that a, = cXn satisfies the
given recurrence relation for n > 2.
(b) If p, and qn both satisfy the given recurrence for
n > 2, show that a, = pi,, + qn also satisfies the
recurrence for n > 2.
(c) Using (a) and (b), prove Theorem 5.3.1 for the
case where the characteristic polynomial has distinct
roots.
23. Let a, = ran-, + sa,-2, n > 2, be a second order
homogeneous recurrence relation with constant coeffi-
cients and assume that its characteristic polynomial has
just one (repeated) nonzero root.
(a) [BB] If x is the characteristic root, show that r = 2x
and s = -x2.
(b) Conclude from (a) that if c is any constant, then
a, = cnx" is a solution of the recurrence relation.
(c) Use (b) and the previous exercise to prove Theo-
rem 5.3.1 for this case.
24. Let a, = ran-1 + san-2 + f(n), n > 2, be a second
order recurrence relation with constant coefficients.
(a) Show that if Pn satisfies this recurrence relation
for n > 2 and qn satisfies the associated homo-
geneous recurrence relation an = ran-Â± +san-2 for
n > 2, then p, + qn satisfies the given relation for
n > 2.
(b) Complete the proof of Theorem 5.3.2.
5.4 
SOLVING RECURRENCE RELATIONS; GENERATING FUNCTIONS
The brief introduction to generating functions which we give in this section belies
the importance of this concept in combinatorial mathematics. Our purpose is just
to give some indication as to how generating functions can be used to solve
recurrence relations.
Roughly speaking, a generating function is a polynomial that "goes on for-
ever," that is, an expression of the form
f(x) = ao + alx + a2x2+ a3x3 + 
-
anXn +Â± 
.
Unlike the usual polynomial, in which the coefficients ai are all zero after a
certain point, a generating function usually has infinitely many nonzero terms.
There is an obvious correspondence between generating functions and sequences
ao, al, a2... ; namely,
ao + aix + a2x2 + a3x3 + *- 
< 
ao, al, a2, a3,.
N 
I 
L
The generating function of a sequence ao, al, a2, . . .
is the expression f(x)
ao+atx+a2x 2+- 
.

5.4 Generating Functions 179
EXAMPLES 23 
The generating function of the sequence 1, 2, 3,... of natural numbers is f (x) =
1 + 2x + 3X2 + ... , while the generating function of the arithmetic sequence
1, 4,7, 10,... is f (x) = 1 + 4x + 7x2 + 10x3 + ... 
A
Two generating functions can be added and multiplied term by term just like
polynomials. If f (x) = ao + al x + a2x 2 + 
and g(x) = bo + b1x + b2x2 +Â± ,
then
f (x) + g(x) = (ao + bo) + (al + bl)x + (a2 + b2)x2+ -
f (x)g(x) = (aobo) + (albo + aobl)x + (aob2 + albi + a2bo)x2 2+Â±
Note that while generating functions have infinitely many terms, the definitions of
addition and multiplication involve no infinite sums; for example, the coefficient
of x' in the product f (x)g(x) is the finite sum
aobn + albn-l + a 2 bn-2 + 
+ anbo.
PROBLEM 24. 
If
f(X) =l+ x2+ 
.+Xn +
and
g(x) = 
x + xx 2 -x 3 + 
+ (-l)nxn +
find f (x) + g(x) and f (x)g(x).
Solution. 
f (x) + g(x) = (I + X + x2 + 
+ Xn
+(l -x + x 2 -x 3 + ... + (-l)nxn +
= (1 + 1) + (1 - I)x + (1 + l)x
2
+.. 
+ 
(I 
+ 
(-l)n)xn 
+,,
= 2 + 2x2 + 2X4 + 
...
f (x)g(x) = (1+ X + x2 + 
+ 
+n 
+
(I -x 
+ x 2 
x3 + ... + (- I)nxn +9
=I + [1(-1) + 1(1)]X + [1(1) + 1(-1) + ](l)]x 2 +
= 1 2 +x4 +x6 +
Students who have studied calculus for more than one year should notice
the obvious similarity between generating functions and power series and will be
comfortable with the fact that generating functions often can be expressed as the
quotient of polynomials. An important example is
(11) 
1 
=2 
+ X 3 
x3+
1-x
which shows that I 
is the generating function of the sequence 1, 1,1, .

180 Chapter 5 Induction and Recursion
Suppose a is a real number. Show that 
-
is the generating function for a
1 -
ax
certain geometric sequence.
In combinatorics, the fundamental distinction between power series and gen-
erating functions is that, whereas power series in calculus are functions R -* 
R
with radii of convergence, generating functions are purely formal objects which
will never be "evaluated" at a specific real number x. Thus, we do not worry
about what the infinite sum ao + aIx + a~x2 + 
means. Whereas it is a topic of
interest in calculus to prove formula (11), for instance, and to discover for which
real numbers this formula is valid, for us the proof is a routine application of the
definition of multiplication of generating functions.
(I 
-
x)(l 
+ 
x + X 2 + 
. --
+ xn + 
.
)
= 
I + 
[1(1) -
l(l)]x 
+ 
[1(1) 
-
l(l)]x 
2 + 
+ 
[1(1)- 
l10)x 
, +
= 
I +Ox 
+ Ox2 + 
+ oxn +
=1I
Another very useful formula for us is
I1
which says that 
xl ) 
is the generating function of the sequence of natural
numbers.
Prove formula (12).
Suppose f (x) is the generating function of the sequence 0, 1, 2, 3, ... 
; that
is, f(x) =0+ lx +2x 2 +3x3 +4x 4 + 
. Then
f(x) = x +2X2 + 3x3 + 4x 4+
= x(1 + 2X + 3x 2 + 4X3 + .. ) =X (1 ~_x)2~
by (12), so f(x) takes the simpler form f(x) =
(1 x)2'
We now present a few examples which show how generating functions can
be used to solve recurrence relations.
PROBLEM 25. 
Solve the recurrence relation a, = 3a, I, n > 1, given an -
1.
Solution. 
Consider the generating function f(x) = ao + aIx + a2x2 + 
+
a~xo 
+ .
of the sequence ao, al, a2, .... 
Multiplying by 3x and writing the
product 3xf (x) below f (x) so that terms involving x" match, we obtain
f(x) = ao + alx + 
a2x2 + 
+ 
an Xn +
3xf(x) = 
3aox + 3alx2 + 
+ 3an lxn +

5.4 Generating Functions 
181
Subtracting gives
f(x) -3xf(x)
= ao + (al -
3ao)x + (a2 -
3al)x 2 + * 
+ (a, 
-
3a 
)x` +
Since ao = 1, al = 3ao and, in general, a, = 3a, -, this says that (I-3x)f (x)
1. Thus, f (x) 
-
and, using (11),
f (x) = I + 3x + (3x)2 + ... + (3x)` +
= 1 + 3x + 9x 2 + .
+ 3nxn +
We conclude that an, which is the coefficient of x' in f (x), must equal 3'. So
we have an = 3' as the solution to our recurrence relation.
PROBLEM 26. 
Solve the recurrence relation an = 2a 
-I a, -2 n > 2, given
ao = 3, al =-2.
Solution. 
Letting f (x) be the generating function of the sequence in question,
we have
f (x) = a( + 
aIx + 
a2x2 + 
+ 
an xn +
2xf (x) = 
2aox + 2aix2 + 
+ 2a,-Ixn +
x 2 f (x) = 
aox2 + 
+ 
an- 2xn +
Therefore,
f(x) -2xf(x)+x2 f(x) =ao-+1(a I2ao)x+(a2 -2a 
+a( )x2 +
+ 
(a, 
-2a,_1 
+ an-2 
)xn 
+
= 3 -
8x
sinceao=3,a 
-
2anda, -2a -I+an 
2 =Oforn>2.
So (1 -2x 
+ x 2 )f(x) = 3 -
8x, (1- 
x)
2 f(x) = 3 -8x 
and
f(x) = (1 -x)
2 (3 
8x)
= (1I + 2x + 3x2 + .+ 
(n + I)xn + -)(3-8x) 
by (12)
=3-2x-7x
2  
12x 3 +* 
+[3(n+1)-8n]x 
+
= 3-2x-7x
2 
_ 12x 3 + 
+ (-5n + 3)xÂ± +
and an = 3 - 5n is the desired solution. [Verify that this recurrence can also be
solved by Theorem 5.3.1 of Section 5.3.]
PROBLEM 27. 
Solve the recurrence an = -3an-I + 1Oan 2, n 
> 2, given
ao = 1, aI =4.

182 
Chapter 5 Induction and Recursion
Solution. 
Letting f(x) be the generating function of the sequence in question,
we have
f(x) = ao + 
a Ix+ 
a2x2 +. 
+ 
anxn +
3xf(x) = 
3aox + 
3ajx 2 + 
-
+ 
3a, jxn +
lOx2f(X) = 
lOaox2 + 
+ lOan-2Xn +
Therefore,
f(x) + 3xf(x) -lOx 2f(x) = ao + (al + 3ao)x + (a2 + 3a- 
1Oao)x 2
+ -+ 
(a, + 3a-, -
o1a,-2)XÂ± 
+
= 1+7x
since ao = 1, a= 4 and a, + 3an-1 -lan 
2 = 0 for n > 2. So
(1 + 3x-lOx2)f(x) = I +7x
and
1 +7x 
I1Â±7x
f(x) 
1+ 3x -10x
2 = (I + 5x)(1 - 2x)
At this point, it is useful to recall the method of partial fractions. We set
1 
A 
B 
A(l - 2x) + B(1 + 5x)
= 
+=
(1 + 5x)(1 - 2x) 
1 + 5x 
I - 2x 
(1 + 5x)(1 - 2x)
Equating numerators, 1 = (A+B)+(-2A+5B)x, so A+B = 1, -2A+5B 
- 0.
Solving for A and B, we get A = 
, B = 2. Therefore,
7'
1 
5 
I 
2 
I
(I 
+ 5x)(1 - 2x) 
7 (I + 5X) 
7 ( 
- 2X)
and so f (x) 
I 
( 
+5x( 
2x) 
(2XÂ±(J
(1 + 5x)(1 
2x)
= -( I 
) (I + 7x) + 
(X2)(I 
+ 7x)
- 7(1+( -5x) + (-5x)2 + 
)(1 + 7x)
+ Â±(1 + 2x + (2x) 2 + --)(1 + 7x)
=5 (1 - 5x + 25X2 + *- + (-5)nx + 
.)(1 + 7x)
+ 2 (I + 2x + 4X2 +.+2x + -)(1 + 7x)
= 7(1 + 2x - lOx2 + 
+[(-5) 
+ 7( -5) 
]x' + 
)
+ 2(1 + 9x + 18X2 + 
+ [2n + 7(2n n)]xn +
= -(I + 2x -
1Ox 2 + *+ 
2(-5)n- xn + 
)
+ 2 (1 + 9x + 18X2 + 
+ 9(2"-')x 
Â± 
+
= I + 4x - 2x 2 + 
* * + ( - 2 ( -5)" + 79(2 n))xn +

5.4 Generating Functions 
183
and hence a, = -
(-5)n + 7 (2n) is the desired solution. (Again, we suggest that
you verify that this recurrence can also be solved by the methods of Section 5.3.)
PROBLEM 28. 
Solve the recurrence relation an =-an-l 
+ 2n -3, 
n > 1,
given ao = 1.
Solution. 
Let f(x) be the generating function of the sequence ao, al, a2
Then
f(x) = ao + alx + a2x2 + 
+ 
anxn +.
xf(x) = 
aox + aIx + 
+ an- x 
+ 
.
Therefore,
f(x) + xf(x) = ao+(al +ao)x+(a2+al)x2+ 
+(an+an- 
)xn+
We are given that ao = 1 and an +a,_1 = 2n -3. Thus al +ao = 2(1)-3 =-1,
a2 + al = 2(2) -
3 = 1, and so on. We obtain (1 + x)f(x)=1 
x + x2 + 
+
(2n -
3)xn + .
and so
f 
X 
(I -x+X 
x2 + ... +(2n 
-3)x 
+ 
.)
1 
2
= 1+ 
(-x) 
+ (_X)2 
+ 
.. + 
(-X)n 
+,
(I - x + x2+ .-- + (2n - 3)x + 
)
-x + x2 _ x3 + 
+ (-X)n + 
)
(1 - x + x2+ 
+ (2n - 3)x +
I 2x+3x 2Â±+
+ [(2n - 3) - (2n - 5) + ..
+ (-)n1(_1) + (-I)n]xn +.
Now an is the coefficient of xn, the term in the square brackets:
n-I
an= 
E(-1) [2n -
(2k + 3)] 
+ (-1)n
k=O
n-I 
n-I
= (2n - 3) 1(_-I)k -2 E 
(_- )k k + ( -
)n.
k=O 
k=O
We leave it to you to verify that
n- 1 
| 
-- 
if n is even
k== 
l 
-
if n is odd.
So, if n is even, an = 0 - 2( -n) 
+ 1 = n + 1, while if n is odd,an = 
(2n - 3) -
2(-1) 
1 = 2n - 3 - n + 
1 
-
I = n - 3. The solution is
n + 1 
if n is 
even
n - 3 
if n is odd.

184 
Chapter 5 Induction and Recursion
A 
-
g 
*.
Note that this solution could also be written as a, = 2(-I)' + n -
1, which is
the answer one would obtain by the methods of Section 5.3.
10. Replacing x by ax in (11), we see that
1 
+ (ax) + (ax)2 + (ax)3 + 
+ ax + a2X2 + a3x3 +
1-ax
From this, we see that 
is the generating function for the sequence
I -ax
1, a, a2, a3 . 
which is the geometric sequence with first term I and com-
mon ratio a.
11. (I - x)2(1 + 2x + 3X2 + **+ (n + I)x' + * -
= (- 2x + x 2)(1 + 2x + 3X2 + * + (n + I)x' +***)
= 1 +[1(2) 
-2(l)]x + [1(3) -2(2) 
-l(l)]x2 +
+[-l(n + 1) -2(n) + l(n -
I)Ix' +*
sincen+l-2n+ n -1=0.
The symbol [BB] means that an answer can be fund in the Back of the Book.
1. What sequence is associated with each of the following
generating functions?
(a) [BB] (2- 
3x)2
x4
(b) I-x
(c) [BB] (I + 3x) 2
(d) (1 x 3)2
X21
(e) ( 
X)2 + Ilx) 
l+5x
2. Express the generating function of each of the following
sequences as a polynomial or as the quotient of polyno-
mials.
(a) [BB] 1,2,5,0,0,...
(b) 0, 1,4, 1,0,0,...
(c) 1,2,4,8, 16,...
(d) 1, -1,1, -1,...
(e) 3, 3, 3,...
(f) [BB] 1, 0, 1, 0, . . .
(g) 1, -2, 3, -4, ...
3. [BB] Using the method of generating functions, solve
the recurrence relation a,, = 2a,, -, n > 1, given ao = 1.
Compare this solution to the sequence defined by (5),
p. 164.
4. Use the method of generating functions to solve the
recurrence relation a,, = 3a, I 1, n > 1, given ao = 1.
Compare your solution with the sequence given in Prob-
lem 10, p. 164.
5. [BB] Use the method of generating functions to solve the
recurrence relation an = 5a-j -6a,,-2, 
given ao = 1,
al = 4. Verify your answer by comparing with Prob-
lem 18.
6. Use the method of generating functions to solve the
recurrence relation a, = 4an 
-4a,-2, 
n > 2, given
a( = 1, aX 
= 4. Compare your solution with the
sequence given in Problem 19, p. 174.
7. [BB] Use generating functions to find a formula for a,
given ao = 5 and an = a,-, + 2" for n > 1.
8. (a) Use the method of the characteristic polynomial (as
in Section 5.3) to solve the recurrence relation a,, =
4a,, 
-4a,-2+4 n, n > 2, with the initial conditions
ao = 2, aI = 8.
MWIM11 611

Review Exercises 
185
(b) Solve the recurrence in (a) by means of generating
functions.
(c) Which of the preceding methods do you prefer in
this case?
9. Solve each of the following using generating functions.
In each case, use the methods of Section 5.3 to verify
your answer.
(a) [BB] an =-5an- , n > 1, given ao = 2.
(b) an = -5a,- 
+3, n > 1, given ao = 2.
10. Solve each of the following using generating functions.
Verify your answer by the method of Section 5.3.
(a) an =4an-1- 3an-2 n > 2, given ao = 2, a, = 5.
(b) an = -10an-1 -
25a-2, n > 2, given ao = 1,
al 
25.
11. [BB] Using generating functions, solve the recurrence
relation an = 2a_1 + an- 2-2a,-3, n > 3, given
ao = 1, al = 3, a2 = 6. (Note that this recurrence is not
second order and so cannot be solved by the methods
of Section 5.3.)
12. [BB] Use the method of generating functions to solve
the recurrence relation a, = an- +an-2 -an-3, n > 3,
given ao = 2, al -I, 
a2 = 3.
I 
Ax+B 
C
[ 
(ax + b)2 (cx + d) = (ax + b)2 
cx + d
13. The Pell sequence is defined by po = 1, pl = 2 and
Pn = 2Pn-1 + PT-2 for n > 2.
(a) Use the characteristic polynomial to solve this recur-
rence relation.
(b) Show that p, is the integer closest to (2+4)(1 +
,/ 2) n.
(c) Find the generating function of the Pell sequence,
finding explicitly its first four terms.
Remarkably, there exist closed form solutions for p,
For example,
(i + j + k) !
Pn 
i; 
i! j!k!
i,j,k>O 
iJk
i+j+2k=n
See the American Mathematical Monthly 107 (2000),
no. 4, p. 370 for three verifications of this formula.
14. This question concerns the Fibonacci sequence defined
by the recurrence relation a, = an-] + a,-2, where
ao = a1 = 1.
(a) Suppose f (x) is the generating function of the
(b)
(c)
Fibonacci sequence. Show that f (x) =
1 -x-x
Find a and 3 such that 1-x -x 2 = (I-ax)(lI 
x).
Find A and B, in terms of a and A, such that
1 
A 
B
I-x 
-X
2  
1- 
ax 
I-Px
(d) Use the results of the previous parts to obtain a
formula for a, and compare your answer with that
found in Problem 20, p. 174. Which method for
finding a, do you prefer?
S 
S .. S 
S3
n
1. Using mathematical induction, show that 
3-11 =
i=i
3 
-
for all n > 1.
2
2. Using mathematical induction, show that (I
n
I -2 
for all n >l.
2! 
>
3. Use mathematical induction to prove that l of+ 2+10n+t1
is divisible by 3 for all n > 1.
4. Give a recursive definition of each of the following
sequences:
(a) 1, 5, 29, 173, 1037, ...
(b) 3, 5, 13, 85, 3613, .. .
(c) 1, 9, 36, 100, 225, ...
5. Let a, be defined recursively by al = 0, a2 = 3 and,
for k > 1, ak+2 = 21(ak +ak+l). Prove that a, = (1
(-2)f-l ) for all integers n > 1.
6. Consider the arithmetic sequence which begins 5, 9, 13.
(a) Find the 32nd and 100th terms of this sequence.
(b) Does 125 belong to the sequence? If so, where does
it occur?
(c) Repeat (b) for the numbers 429 and 1000.
(d) Find the sum of the first 18 terms.
7. The first two terms of a sequence are 6 and 2.
(a) If the sequence is arithmetic, find the 27th term and
the sum of the first 30 terms.

186 
Chapter 5 Induction and Recursion
(b) If the sequence is geometric, find an expression for
the 27th term and the sum of the first 30 terms.
8. (a) Define the Fibonacci sequence.
(b) Is it possible for three successive terms of the
Fibonacci sequence to be odd?
(c) Is it possible for two successive terms in the
Fibonacci sequence to be even?
Justify your answers.
9. Solve the recurrence relation an = 5an I-4a,-2, n >
2, given that ao = -3 and aI = 6. Use the characteristic
polynomial as described in Section 5.3.
10. Solve Exercise 9 using the method of generating func-
tions described in Section 5.4.
11. Solve a,, = 4a,-I + 5a,, -2 
+ 3", n > 2, given a0 = 4,
al =-1.
12. (For students of calculus) Let fl, f2, f3, ... 
denote
the Fibonacci sequence as defined in 5.2.3. Evaluate
00 
A.
look exactly. Then approximate this sum to 19 dec-
imal places and admire its beauty. What do you notice?

9A
". 
Iai 
* 
-* 
i r 
i 
\
6
.; Principles of Counting
, : 
.1
6.1 
THE PRINCIPLE OF INCLUSION-EXCLUSION
Glenys is thinking about registering for a word processing course. Of the 100
people who have registered so far, she discovers that three quarters are men and
80% own personal digital assistants (PDAs).
(a) Find a formula for the number of women in the course who do not have
PDAs. How large might this number be? How small?
(b) How many of the men registered in this course could conceivably own
PDAs?
The object of this chapter is to illustrate some basic principles of counting. We
consider first the number of elements in various combinations of finite sets such
as union, intersection, and difference. As in Section 3.3, the number of elements
in a finite set S will be denoted IS1.
To analyze Glenys's questions, we introduce the sets U of all registrants, M
of male registrants, and P of those registrants who own a PDA. We are given
that IUI = 100, IMI = 75, and IPI = 80. The set of women who do not have a
PDA is MC n P' and it is the size of this set with which part (a) is concerned.
By one of the laws of De Morgan,
M' n pc = (M U p)c
and so
IMe n PCI = [(M U P)jI = 100 -IM u Pi.
How big is M U P? Adding the number of men and the number of registrants
who have PDAs counts twice the men with PDAs (see Fig 6.1), so
IM u PI = IMI + IPI -IM n PI = 75 + 80-IM n PI = 155 -M 
n PI.
Therefore,
M' n PCI = 100 - (155 - IM n PI) = IM n PI - 55,
187
0
0 
'o.,
1

188 
Chapter 6 Principles of Counting
Figure 6.1 
IM u PI = IMI + IPI- IM n PI because Region x gets counted twice in the sum IMI + JP1.
which is a formula for the number of women without PDAs. Since M n P is
a subset of M, a set of 75 people, IM n PI < IMI = 75 and so MC n p, <
75 - 55 = 20. Conceivably, IMC n PCI could be 0 (if IM n PI = 55). So the
number of women without PDAs is between 0 and 20 (inclusive).
Part (b) asks about M n P. Observing that IM n PI -
55 > 0 (because it is
the number of women without PDAs), we see that IM n PI > 55; that is, at least
55 men must own PDAs. As noted previously, the upper bound for IM n PI is
75 and it is possible for this number to be realized.
Suppose, in fact, that IM n Pl = 72. Then
IMUPI IMIl+IPI -IMnPI=75+80 -72=83.
There are 83 people in the class who are either men or own a PDA.
How many men registered in the class would not have PDAs? Surely, 75 -
72 = 3:
IM \ PI = MI - IM n PI = 75-72 = 3.
How many of the owners of PDAs would be women? Surely, 80 - 72 = 8:
IP \ MI = IPI-IP n MI = 80-72 = 8.
How many of those registered are either men without PDAs or women with
PDAs? This question, which asks for IM (D PI, can be answered in several ways.
It is the number of men without PDAs plus the number of women with a PDA;
that is,
IM E3 PI = IM \ PI + IP \ MI = 3 + 8 = 11.
It is also the number of people who are men or owners of a PDA but not both:
IM 33 PI = IM u P -IM n PI = 83-72 = 11.
We could also legitimately argue that this number is
IM (3 PI = IMI + IPI -2IM n P = 75 + 80- 2(72) = 155- 144 = 11
because adding the number of men and the number of people with PDAs counts
twice the "unwanted" individuals, the men with PDAs.
We summarize the basic principles of counting, most of which we have just
illustrated.

6.1 The Principle of Inclusion-Exclusion 
189
Proof
Let A and B be subsets of a finite universal set U. Then
(a) {A U BI = JAI + IBI -A 
n lBI
(b) IA n BI < min{lAl, RBI), the minimum of JAI and IBI
(c) IA \ BI = IAI -IA n BI > IAI-IBI
(d) [AcI = JU-{ AI
(e) IA DBI = IAUBI-IAnBI 
J IAI+ BI-21AnBI = IA\BI+IB\Al
(fD 
A x BI = IAI x IBI
(a) If A = 0, then A n B = 0, and A 
I A n B I 0 so the result holds because
each side of (a) equals IB I. Similarly, the result holds if B 
0, so we assume
henceforth that neither A nor B is empty.
Suppose A n B = 0. Let A = (ai, a2 .
a, 
and B = {b, b2 .  
b,.
Then
A U B = {al,a2 , .  
ar,bl,b2, ... ,bj
and, since there is no repetition among the elements listed here,
IA U BI = r + s = JAI + IBI = JAI + IBI - IA n I
and the desired formula is true.
On the other hand, if A n B :A 0 and we let
A \ B = {al, a2  
, 
ar}
B \ A ={bI,b2,.. ,bs
A n B = {xl, x 2 , 
X }
then
A = {al,a2,. 
ar,xI,x2 .
xt} 
and
B = {bi,b 2, .  
b.,Xi,x 2,.  
x},
so
A U B = al, .
ar,bi, .
bn,, xi. 
xt,
with no repetition among the elements listed in any of these sets. Thus,
JAI + JBI -A n BI = (r + t) + (s + t) - t = r + s + t = IA U BI
and the formula holds in this case as well.
We omit the proofs of (b)-(e) since, as with the proof of part (a), these follow
in a straightforward way from the definitions of U, n, \, A, and set complement.
The proof of (f) is left to the exercises. 
I
The formula for the number of elements in the union of two sets-part (a)
of Proposition 6.1. I-is the simplest case of the Principle of Inclusion-Exclusion,
which gives the general formula for the number of elements in the union of any
finite collection of finite sets.

190 Chapter 6 Principles of Counting
Suppose, for instance, we have three finite sets A, B, and C. Then
IA U B U Cl = IA U (B U C)
=IAI+IBUCI 
- JA 
I (B UC)Q
= JAI + IB U C - I(A n B) U (A n c)l
= IAI + [IBI + ICl -IB n cl]
-[IA n BI + IA n cl -I(A n B) n (A n coj]
= JA + IBI Â±+ C - IB n Cl - IA n BI - IA n Cl + IA n B n Cl,
where, at the spots marked with single arrows, we used the fact that IX U YI =
IXi+IYI -Ix nY and, atthe last step, that (AnB)n(AnC) =A nBnC.
What happened at the double arrow?
Here is the formula for the cardinality of the union of four finite sets:
IA U B U C U DI
= AI + BI + ICI + IDl
-JA nBI - JA 
cl- 
JA nDI -
B nCI 
-IB 
nDI 
-IC 
nDI
+IA n B n cl + IA n B n DI + IA In C n DI + IB n c n D
-IA n B n C n DI.
The general pattern should be evident. Add the cardinalities of each of the
sets, subtract the cardinalities of the intersections of all pairs of sets, add the
cardinalities of all intersections of the sets taken three at a time, subtract the
cardinalities of all intersections of the sets taken four at a time, and so on.
Given a finite number of finite sets, AI, A2 . 
A, the number of elements in
the union Al U A2 U ... U A, is
AI UA 2 U 
UAn I= 1lAi 
IAAj nAjI + 
JAz nAj nAkI
i 
i<j 
i<j<k
- .. + (-l)n+l JAI n A2n .. n Al,
where the first sum is over all i, the second sum is over all pairs i, j with i < j,
the third sum is over all triples i, j, k with i < j < k, and so forth.
PROBLEM 1. Of 30 personal computers (PCs) owned by faculty members in a
certain university department, 20 run Windows, eight have 21 inch monitors, 25
have CD-ROM drives, 20 have at least two of these features, and six have all three.
(a) How many PCs have at least one of these features?
(b) How many have none of these features?
(c) How many have exactly one feature?
11=
11FINET"kEffe"

6.1 The Principle of Inclusion-Exclusion 
191
Solution. 
Let W be the set of PCs running under Windows, M the set of PCs
with 21 inch monitors, and C the set with CD-ROM drives. We are given that
WI = 20, IMI = 8, ICI = 25,
I(W nM) U (W n C) U (M nC) = 20,
and lW n M n cl = 6. By the Principle of Inclusion-Exclusion,
20= (WrM) U (W n C) U (MO C)I
IWn MI+IWnCI+IMnCI -I(WnM)fn(WnC)l
-
(W nM) n (Mn c)) -
I(W n C) n (Mn C)I
+ I(W n M) n (w n C) n (Mfn C)I.
Since each of the last four terms here is I W n M n Cl, we obtain
20= IWnMÂ±+lWnCl+Â±MnCj -2IWnMnCI;
therefore,
IWnCl+1wnMI+ MnC = 20 + 2(6) = 32.
(a) The number of PCs with at least one feature is
IW U M U CI = IWI + IMI + ICI
- jWnM -IWnCl -jMnCl 
+IWnMOC)
= 20 + 8 + 25 -(Iwn mj + iw n cl + Mln Cl) + 6
= 59 - 32 = 27.
(b) It follows that 30 -27 
= 3 PCs have none of the specified features.
(c) Since the number of computers with exactly one feature is the number with
at least one feature less the number with at least two, the number with
exactly one is 27-20 =7.
Continuing the preceding problem, how many faculty have computers with exactly
two of the three features described?
Some readers may notice that the problems discussed so far could also have
been solved by Venn diagrams, which are an acceptable approach wherever pos-
sible. When more than three sets are involved, however, Venn diagrams can no
longer be used. Thus, our solutions, which avoid Venn diagrams, illustrate tech-
niques which can be applied in general.
PROBLEM 2. 
Suppose 18 of the 30 personal computers in Problem 1 have
Pentium III processors, including ten of those running Windows, all of those with
21 inch monitors, and 15 of those with CD-ROM drives. Suppose also that every
computer has at least one of the four features now specified. How many have at
least three features?
M

192 
Chapter 6 Principles of Counting
Solution. 
Let P be the set of PCs with Pentium III processors. Then, with W,
M, and C as before, the question asks for the number
I=(W nm 
n C) u (W n MnP) u (W n C n P) 
u (Mn C n P)I
I Lw 0 Mo n C- 
W 
I 0 MO nP + I1W n C n PI + IM n C n PI
-6IwnMCn 
PI+41wnmnCnPl 
-lWMnCnPI
IW n M n CI + Iw n MOn PI + I W n Con PI Â± IM n Co 
n P
-
31 W n M n C n PI.
We are given that
30 = IW U MU CU PI
= IWI + IMI + ICI + IPI
- IWnMl - Iwnci 
IWnPI - IM 
Cl - IMnPI - ICnPI
+ IW nmncl 
+ Iw n Mn PI + IW n Cn PlI+ Imn 
C n PI
-
lWnMnCnPI
= IWI + IMI + ICI + IPI
-IWnMl-lWnCI-IWnPI 
-MnCI-IMnPI-ICnPI
+-n +2IWnmncnO l
because
1W n MO Cl + 1W n MO PI + 1W n C n 
l + IM 
C n PI
= n + 31W n M nC n PI.
In Problem 1, we learned that IW n CI + Â±W n MI + IM n CI = 32 and were told
that IWnMnCI = 6. Here, since M C P. we have WnMnCnP -
WnMnC
and so IWn Mn C nPl = 6. Therefore,
30= 20+8+25+18 -32-10-8 -15+n+2(6),
so n = 30 -71 
+ 65-12 = ]2.
PROBLEM 3. 
How many integers between I and 300 (inclusive) are
(a) divisible by at least one of 3, 5, 7?
(b) divisible by 3 and by 5 but not by 7?
(c) divisible by 5 but by neither 3 nor 7?
Solution. 
Let A, B, and C be the sets of those integers between I and 300
which are divisible by 3, by 5, and by 7, respectively; thus,

6.1 The Principle of Inclusion-Exclusion 
193
A = {n 
1 < n < 300,31 n
B = in I 1 < n < 300,51n)
C =In II < n < 300,71n).
(a) To be divisible by either 3 or 5 or 7 is to be in at least one of the sets A, B,
or C. Thus, part (a) asks us to find IA U B U Cl. To determine this number, we
need JAl, JBI, ICl, IA n BI, IA n Cl, IB n Cl and IA n B n Cl. The elements of
A are 3, 6, 9, 12, ... , 300, so IAI = 100. Note that this number is Lj33Â°, where,
as in paragraph 3.1.6, LxJ denotes the floor of the real number x.
In general, for natural numbers a and b, the number of positive integers less
than or equal to a and divisible by b is Labj. (See Exercise 18.) Thus, we also
have
IBI=L 3 j=60 
and 
ICI =L 3 j= 42.
Next we have to find A n B. the set of integers between I and 300 which are
divisible by both 3 and 5. Since 3 and 5 are relatively prime numbers, any number
divisible by each of them must be divisible by their product. (See Exercise 10 of
Section 4.2.) Therefore, A n B is just the set of integers between 1 and 300 which
are divisible by 15 and, similarly, A n C, B n C, and A n B n C are the sets of
integers between I and 300 which are divisible by 21, 35, and 105, respectively.
So we have
IA nB= L-300 
20, 
{AnCl 
L-0 = 14,
15 
2
3 
B n C 
30= 
L 
300 
=8, 
|AnBnCl L 
300 
=2
IfC 
[351 
8, 
ABC 
-s1  =2
and hence, IA U B U Cl = 100 + 60 + 42 -20 -14-8 + 2 = 162.
(b) The numbers divisible by 3 and by 5, but not by 7, are precisely those numbers
in (A n B) \ C, a set of cardinality IA n BI -
IA n B nCl 
= 20- 2 = 18.
(c) The numbers divisible by 5 but by neither 3 nor 7 are those in B \ (A U C), a
set of cardinality I B 
l- B n (A U C) !. Since
B n (A U C) = (B n A) U (B n C),
the Principle of Inclusion-Exclusion gives
IB n (A U C)l = IB n Al + IB n Cl- I (B n A) n (B n C)I
= lB n Al + B n Cl - lB n A n Cl
because (BnA)n(Bnc) = BnAnC. Therefore, lBn(AUC)l = 20+8-2 = 26
and the number we seek is IBI -26 = 60-26 = 34. 
I
In Problem 3, we characterized the set of integers divisible by both 3 and 5 as
those divisible by 15. In general, for any natural numbers a and b, how can we
characterize the set of natural numbers divisible by both a and b?

194 
Chapter 6 Principles of Counting
1423;* 
**
Suppose the Sieve of Eratosthenes (4.3.5) is used to enumerate all primes between
1 and 100. How many integers will remain after the first five steps of the proce-
dure?
1. See equation (3) on p. 44.
2. The number of computers with exactly two of the features is the number with
at least two less the number with exactly three; that is, 20 -
6 = 14.
3. This set is just the set of integers divisible by the least common multiple of
a and b since a I n, b I n if and only if lcm(a, b) I n. (See Section 4.2.)
4. The integers which have been crossed out after five steps are those which are
divisible by, but not equal to, at least one of 2, 3, 5, 7, 11. Letting A, B, C,
D, and E be the sets of integers between 2 and 100 which are divisible by
2, by 3, by 5, by 7, and by 11, respectively, the set of numbers divisible by
at least one of these has cardinality
IA U B U CU D U El = (50 + 33 + 20 + 14 + 9)
- (16+ 10+7+4+6+4+3+2+ 1 + 1)
+ (3 + 2 + 1 + 1) = 79.
(There are no terms arising from intersections of four or five sets, since
these intersections are empty.) These 79 numbers, with the exception of 2,
3, 5, 7, 11, are those which have been crossed out after five steps. So 25
numbers remain. (Remember that the list of numbers used with the Sieve of
Eratosthenes starts with 2.)
The symbol [BB] means that an answer can be found in the Back of the Book.
1. [BB] In a group of 15 pizza experts, ten like Canadian
bacon, seven like anchovies, and six like both.
(a) How many people like at least one of these top-
pings?
(b) How many like Canadian bacon but not anchovies?
(c) How many like exactly one of the two toppings?
(d) How many like neither?
2. Multiple personality disorder (MPD) is a condition in
which different personalities exist within one person
and at various times control that person's behavior. In
a recent survey of people with MPD, it was reported
that "98% had been emotionally abused, 89% had been
physically abused, and most had experienced both types
of abuse." Make this statement more precise.
3. Among the 30 students registered for a course in discrete
mathematics, 15 people know the JAVA programming
language, 12 know HTML, and five know both of these
languages.
(a) How many students know at least one of JAVA or
HTML?
(b) How many students know only JAVA?
(c) How many know only HTML?
(d) How many know exactly one of the languages,
JAVA and HTML?
(e) How many students know neither JAVA nor HTML?
4. [BB] In a recent survey of college graduates, it was
found that 200 had undergraduate degrees in arts, 95
had undergraduate degrees in science, and 120 had grad-
uate degrees. Fifty-five of those with undergraduate arts
degrees had also a graduate degree, 40 of those with
science degrees had a graduate degree, 25 people had
undergraduate degrees in both arts and science, and five
people had undergraduate degrees in arts and science
and also a graduate degree.
(a) How many people had at least one of the types of
degrees mentioned?
ff 31TIM

(b) How many people had an undergraduate degree in
science but no other degree?
5. The owner of a corner store stocks popsicles, gum, and
candy bars. After school one day, he is swamped by an
influx of 15 school children. They are in and out of his
store in minutes. Later, the clerk reports that ten children
purchased popsicles, seven purchased gum, twelve pur-
chased candy bars, five purchased popsicles and gum,
six purchased popsicles and candy bars, and two pur-
chased gum and candy bars. The owner is very upset.
Why?
6. (a) In a group of 82 students, 59 are taking English, 46
are taking mathematics, and 12 are taking neither of
these subjects. How many are taking both English
and math?
(b) In a group of 97 students, the number taking English
is twice the number taking math. Fifty-three students
take exactly one of these subjects and 15 are taking
neither course. How many students are taking math?
How many are taking English?
7. [BB] Of the 2300 delegates at a political convention,
1542 voted in favor of a motion to decrease the deficit,
569 voted in favor of a motion dealing with environ-
mental issues, and 1197 voted in favor of a motion
not to increase taxes. Of those voting in favor of the
motion concerning environmental issues, 327 also voted
to decrease the deficit, and 92 voted not to increase
taxes. Eight hundred and thirty-nine people voted to
decrease the deficit while also voting against increas-
ing taxes, but of these 839, only 50 voted also in favor
of the motion dealing with the environment.
(a) How many delegates did not vote in favor of any of
the three motions?
(b) How many of those who voted against increasing
taxes voted in favor of neither of the other two
motions?
8. Seven members of a group of nineteen people dislike
the New Democratic Party (NDP), ten dislike the Lib-
erals, eleven dislike the Conservatives, and six dislike
the Canadian Alliance. Five of the group dislike both the
Liberals and the New Democratic Party, five dislike both
the NDP and the Conservatives, six dislike the Liberals
and Conservatives, three dislike the New Democratic
and Canadian Alliance parties, four dislike the Liber-
als and the Alliance, and five dislike the Conservatives
and the Alliance. Three people dislike the Conservatives,
Liberals, and the NDP, while two dislike the Liberals,
NDP, and Alliance; three dislike the Conservatives, New
6.1 The Principle of Inclusion-Exclusion 
195
Democrats, and Alliance; and four dislike the Conser-
vatives, Liberals, and Alliance. Two people dislike all
four parties. How many members of the group like all
four parties?
9. The owner of a convenience store reports that of 890
people who bought bottled fruit juice in a recent
week,
* 750 bought orange juice
* 400 bought apple juice
* 100 bought grapefruit juice
* 50 bought citrus punch
* 328 bought orange juice and apple juice
* 25 bought orange juice and grapefruit juice
* 12 bought orange juice and citrus punch
* 35 bought apple juice and grapefruit juice
* 8 bought apple juice and citrus punch
* 33 bought grapefruit juice and citrus punch
* 4 bought orange juice, apple juice, and citrus punch
* 17 bought orange juice, apple juice, and grapefruit
juice
* 2 bought citrus punch, apple juice, and grapefruit juice
* 9 bought orange juice, grapefruit juice and citrus
punch.
Determine the numbers of people who bought
(a) [BB] all four kinds of juice
(b) grapefruit juice, but nothing else
(c) exactly two kinds of juice
(d) more than two kinds of juice
10. Suppose U is a set containing 75 elements and Al, A2 ,
A3, A4 are subsets of U with the following properties:
. each subset contains 28 elements;
. the intersection of any two of the subsets contains 12
elements;
. the intersection of any three of the subsets contains 5
elements;
. the intersection of all four subsets contains I element.
(a) [BB] How many elements belong to none of the
four subsets?
(b) How many elements belong to exactly two of the
four subsets?
11. [BB] How many integers between I and 500 are
(a) divisible by 3 or 5?
(b) divisible by 3 but not by 5 or 6?
12. (a) How many integers less than 500 are relatively
prime to 500?
(b) How many integers less than 9975 are relatively
prime to 9975?

196 
Chapter 6 Principles of Counting
13. [BB] How many integers between 1 and 250 are divisi-
ble by at least one of the three integers 4, 6,
and 15?
14. (a) [BB] How many integers between 1 and 1000 (inclu-
sive) are not divisible by 2, 3, 5, or 7?
(b) How many integers between 1 and 1000 (exclusive)
are not divisible by 2, 3, 5, or 7?
15. Find the number of integers between 1 and 10,000 inclu-
sive which are
(a) divisible by at least one of 3, 5, 7, 1 1;
(b) divisible by 3 and 5, but not by either 7 or I 1;
(c) divisible by exactly three of 3, 5, 7, 1 1;
(d) divisible by at most three of 3, 5, 7, l l.
16. How many integers between I and 106 (inclusive) are
neither perfect squares nor perfect cubes? (See Exer-
cise 30, Section 4.3.)
17. [BB] How many primes are less than 200? Explain your
answer.
18. [BB] Let a and b be natural numbers. Show that the
number of positive integers less than or equal to a and
divisible by b is Lbj.
19. Suppose A and B are finite sets with IAUBI < IAI+IBL
Show that A and B have an element in common.
20. Suppose A and B are finite sets. Prove that IA x BI =
JAI x IBI.
21. Suppose A and B are subsets of a universal set U. Find
a formula for IA U BCJ and prove that it is correct.
22. Let A, B and C be sets. Prove that
(a) [BB] I(A E B) n cl= IA nc +lBJnc
-21A 
n B nc
(b) IA E B E CI = JAI + BI + ICI-21A n BI
Cl -21BnCl+41AnBnCI
2lA n
23. Prove the Principle of Inclusion-Exclusion by mathe-
matical induction. (For this, the result of Exercise 20,
Section 5.1 will be helpful.)
6.2 
THE ADDITION AND MULTIPLICATION RULES
The Principle of Inclusion-Exclusion gives a formula for the number of elements
in the union of a finite number of finite sets. If the sets are pairwise disjoint
(that is, if the intersection of any pair of sets is empty), then the formula takes a
S1 
particularly simple form.
* 
* 
Given n pairwise disjoint finite sets, Al, A2., 
A, then
n
1AI UA 2 U .
u An, 
E 
lA II.
i 
I
In this section, we use the general term event to mean the outcome of any
process or experiment, for example, the course a student selects to complete his
or her degree. Events are mutually exclusive if no two of them can occur together;
for example, if a student selects one course to complete his or her degree, then
Mathematics 2320 and Statistics 2500 are mutually exclusive.
Notice that if n sets AI, A2, . . , A, correspond to events with the elements
of Ai representing the ways in which the corresponding event can occur, then the
events are mutually exclusive if and only if the Ai are pairwise disjoint. Thus,
the Principle of Inclusion-Exclusion for disjoint sets translates into the following
_ 
_ 
__ 
basic principle of counting.
The number of ways in which precisely one of a collection of mutually exclusive
events can occur is the sum of the numbers of ways in which each event can
occur.

6.2 The Addition and Multiplication Rules 
197
Ie = II]
For example, a student who needs one course to complete her degree decides
to take either computer science or statistics and makes lists of the courses for
which she is eligible. The computer science courses might comprise the set
Al ={CS2602, CS2700, CS2721, CS2800, CS2500} and the statistics courses
the set A2 ={S2510, S2511, S35001. There are 5 + 3 = 8 ways in which this
student can register for a course because the two sets here are disjoint: The events
"register for CS" and "register for Statistics" are mutually exclusive.
It is Friday night and Ursula has been invited to two parties but feels more
inclined to go to a movie; there are six new movies in town. Assuming she is not
permitted two engagements in the same evening (that is, assuming that the events
"party" and "movie" are mutually exclusive), there are 2 + 6 = 8 possible ways
to spend her evening.
In the two examples just given, the individual events Ai were clearly specified.
By contrast, the addition rule is probably most often applied in situations where
this is not the case. A problem asking for the number of ways in which a certain
event can occur can sometimes be analyzed by partitioning the event into mutually
exclusive subevents (cases), precisely one of which must occur, and then applying
the addition rule. It is for the problem solver to find a convenient set of subevents.
PROBLEM 4. 
In how many ways can you get a total of six when rolling two
dice?
Solution. 
The event "get a six" is the union of the mutually exclusive subevents.
.
AI: "two 3's"
.
A2: "a 2 and a 4"
.
A3: "a I and a 5"
Event AI can occur in one way, A2 can occur in two ways (depending on which
die lands 4), and A3 can occur in two ways, so the number of ways to get a six
is I + 2 + 2 =5. 
I
In Section 6.1, we observed that if A and B are finite sets, then the Cartesian
product A x B contains IAl x IBI elements. More generally, if A 1, A2 , . 
,
are finite sets,
n
JAI x A2 X ...
X AnI = 
AiL
i=I
As before, thinking of Ai as the set of ways a certain event can occur, we are led
to another basic principle of counting.
The number of ways in which a sequence of events can occur is the product of
the numbers of ways in which each individual event can occur.
If Ursula's parents had a change of mind and permitted her to go to a party
after the show, there would be 6 x 2 = 12 ways in which she could spend her Friday
night, as shown in Fig 6.2. The figure also illustrates why this number is the car-
dinality of the Cartestian product Movie x Party, where Movie = {I, 2,3,4,5, 61
and Party = 1, 2}.

198 
Chapter 6 Principles of Counting
Movie 
Party
I < 
2
2 < 
2
6 < 
2
Figure 6.2 
There are 6 x 2 = 12 ways to choose one of six movies and then one of two parties.
Suppose that there are five computer science courses and three statistics
courses in which a student is eligible to enrol and that this student wishes to
take a course in each subject. There are 5 x 3 = 15 ways in which the choice can
be made.
If Jack, Maurice, and Tom each roll two dice, then the number of ways in
which Jack can get a total of six, Maurice a total of four, and Tom a total of three
is 5 x 3 x 2 = 30 since there are five ways to get a total of six, as shown before,
three ways to get a total of four (two 2's, a I and a 3, or a 3 and a 1), and two
ways to get a total of three.
PROBLEM 5. 
How many numbers in the range 1000-9999 do not have any
repeated digits?
Solution. 
Imagine enumerating all numbers of the desired type in the spirit of
Fig 6.2. There are nine choices for the first digit (any of 1-9). Once this has been
chosen, there remain still nine choices for the second (the chosen first digit cannot
be repeated but 0 can now be used). There are now eight choices for the third
digit and seven for the fourth. Altogether, there are 9 x 9 x 8 x 7 = 4536 possible
numbers. 
I
.. .. .. 
- .. . .. .
PROBLEM 6. 
License plates in the Canadian province of Ontario consist of
four letters followed by three of the digits 0-9 (not necessarily distinct). How
many different license plates can be made in Ontario?
Solution. 
There are 26 ways in which the first letter can be chosen, 26 ways in
which the second can be chosen, and similarly for the third and fourth. By the
multiplication rule, the number of ways in which the three letters can be chosen
is 26 x 26 x 26 x 26 = 264. By the same reasoning there are 103 ways in which
the final three digits of an Ontario license plate can be selected and, all in all,
264 x 103 = 456,976,000 different license plates which can be manufactured by
the government of Ontario under its current system. 
I
~~~~~~~~~~~~~~- 
- ... 
...--
F. 
...... 
----- .. ....- 
..... F... 
.. 
.
a...... 
....................
How many different license plates can be made by a government which permits
four letters followed by three digits or three digits followed by four letters?
M

6.2 The Addition and Multiplication Rules 
199
PROBLEM 7. 
Darlene wishes to fly from Portland, Maine, to Portland, Oregon.
There are two possible routes she can take, namely, Portland-Detroit-Portland and
Portland-Chicago-Portland. 
Two flights from Portland to Detroit each connect
with three flights from Detroit to Portland, while two flights from Portland to
Chicago each connect with four flights from Chicago to Portland.
(a) Find the total number of different flight sequences from Portland, Maine, to
Portland, Oregon, via Detroit.
(b) Repeat (a) if "via Detroit" is omitted.
Solution.
(a) The multiplication rule applies. There are 2 x 3 = 6 possibilities.
(b) By (a), there are six routes via Detroit. Also, there are 2 x 4 = 8 routes
via Chicago. Using the addition rule, the number of routes via Detroit or
Chicago is 6 + 8 = 14. 
1
To determine the number of ways in which some event can occur, it is often
helpful to break the event into mutually exclusive subevents or cases, one of which
must occur. By counting the number of ways in which each case can occur and
adding these numbers, the addition rule gives the total number of ways in which
the entire event can occur. Such a subtle use of the addition rule is probably its
most important virtue.
PROBLEM 8. 
How many even numbers in the range 100-999 have no repeated
digits?
Solution. 
The question is equivalent to asking for the number of ways in which
one can write down an even number in the range 100-999 without repeating digits.
This event can be partitioned into two mutually exclusive cases.
Case 1: The number ends in 0.
In this case, there are nine choices for the first digit (1-9) and then eight
for the second (since 0 and the first digit must be excluded). So there are
9 x 8 = 72 numbers of this type.
Case 2: The number does not end in 0.
Now there are four choices for the final digit (2, 4, 6, and 8), then eight choices
for the first digit (0 and the last digit are excluded), and eight choices for the
second digit (the first and last digits are excluded). There are 4 x 8 x 8 = 256
numbers of this type.
By the addition rule, there are 72 + 256 = 328 even numbers in the range
100-999 with no repeated digits. 
I
In Case 2 of Problem 8, suppose we choose the last digit, then the middle, and
finally the first digit. By considering two subcases,
2a: the middle digit is 0
2b: the middle digit is not 0
1=M

200 Chapter 6 Principles of Counting
MMM
show again that there are 256 even numbers in the range 100-999 with no repeated
digits and last digit different from 0.
Answer Problem 8 again by considering the four cases:
1. first two digits are even,
2. first two digits are odd,
3. first digit even, second digit odd,
4. first digit odd, second digit even.
These last two Pauses illustrate an important point. There are usually several
ways to approach a combinatorial problem!
PROBLEM 9. 
A typesetter (long ago) has before him 26 trays, one for each
letter of the alphabet. Each tray contains ten copies of the same letter. In how
many ways can he form a three letter "word" which requires at most two different
letters? By "word," we mean any sequence of three letters-xpt, for example-not
necessarily a real word from the dictionary. Two "ways" are different unless they
use the identical pieces of type.
Solution. 
The event "at most two different letters" is comprised of two mutually
exclusive cases:
Case 1: The first two letters are the same.
Here, the third letter can be arbitrary; that is, any of the 258 letters which
remain after the first two are set can be used. So the number of ways in which
this case can occur is 260 x 9 x (260 -
2) = 603,720.
Case 2: The first two letters are different.
In this case, the third letter must match one of the first two, so it must be one
of the 18 letters remaining in the two trays used for the first two letters. The
number of ways in which this case occurs is 260 x 250 x 18 = 1,170,000.
By the addition rule, the number of ways to form a word using at most two
different letters is 603,720 + 1,170,000 = 1,773,720. 
I
With many counting problems, there are several different ways of arriving at
the same answer. Another approach to the previous problem is to count the total
number of ways of forming words and to subtract from this the number of cases in
which all three letters are different. (Recall that I AC I = I U I-I A |.) There are 260 x
259 x 258 = 17,373,720 possible words of which 260 x 250 x 240 = 15,600,000
consist of three different letters. So the number of ways of forming words in which
at most two different letters are used is 17,373,720 -
15,600,000 = 1,773,720
as before.
PROBLEM 10. 
Continuing Problem 9, determine the number of ways of form-
ing words which use exactly two different letters.
Solution. 
We subtract from the 1,773,720 cases requiring at most two different
letters the number of ways of forming words which use just one letter. So the
answer is 1,773,720- (260 x 9 x 8) = 1,755,000. 
I
.... .. .............. ...................................... 
I.. 
.
.
.
I--- -- 
- - - --------- - -
....................... .... 
...........
M

6.2 The Addition and Multiplication Rules 
201
vv 
.,,g 
S
It is instructive to observe that this number could also be obtained by con-
sideration of three mutually exclusive cases:
Case 1: The first two letters are the same but the third is different.
Case 2: The first and third letters are the same but the second is different.
Case 3: The second and third letters are the same but different from the first.
By this method, we obtain (260 x 9 x 250) + (260 x 250 x 9) + (250 x 260 x 9)
3(260 x 250 x 9) = 1,755,000, as before.
In Problems 9 and 10, we counted the number of ways of forming certain three
letter words, not the number of different words which can be formed. How many
different "words" can be formed in each of these problems?
A set of cardinality n contains 2n subsets (including the empty set and the entire
set itself).
Proof 
There are several ways to prove this fundamental result. We present one here
which uses the ideas of this section.
Given n objects a,, a2, . . , an, each subset corresponds to a sequence of
choices. Is al in the subset? Is a2 in the subset? Finally, is a, in the subset?
There are two answers to the first question, two for the second, and so on. In all,
there are
2 x 2 x ...
x 2 = 2n
n factors
ways in which all n choices can be made. Thus, there are 2' subsets.
A 
* 
* **
I
5. As in Problem 6, the number of different plates with the letters first is 264 x
103 = 456,976,000. Similarly, the number of different plates with the digits
first is also 103 x 264 = 456,976,000. By the addition rule, the number of
plates altogether is 456,976,000 + 456,976,000 = 913,952,000.
6. Case 2a: The middle digit is 0.
Here, there are four choices for the last digit, one choice for the middle digit,
and eight choices for the first (which can be any of 1-9 except that chosen
for the last digit). There are 32 such numbers.
Case 2b: The middle digit is not 0.
In this case, there are again four choices for the last digit, there are eight
choices for the middle (which is not 0 and not the last digit), and just seven
choices for the first digit since neither of the digits used for the last or middle
position is eligible. There are 4 x 8 x 7 = 224 such numbers.
As before, there are 32 + 224 = 256 even numbers in Case 2.
7. Case 1: The first digit can be chosen in four ways (2, 4, 6, or 8), then the
second digit in four ways (avoid repeating the first), and the third in three.
There are 4 x 4 x 3 = 48 ways for Case 1 to occur.
Case 2: The first digit can be chosen in five ways, the second in four, and
the last in five. There are 5 x 4 x 5 = 100 ways for Case 2 to occur.

202 
Chapter 6 Principles of Counting
Case 3: There are four choices for the first digit, five for the second, and four
for the third (just avoid repeating the first). There are 4 x 5 x 4 = 80 ways
for Case 3 to occur.
Case 4: There are five choices for the first digit, five choices for the second,
and four for the third (avoid repeating the second). There are 5 x 5 x 4 = 100
ways for Case 4 to occur.
By the addition rule, the number we seek is 48 + 100 + 80 + 100 = 328, as
before.
8. In Problem 9, there are 262 different words which have the same first two
letters and (26)(25)(2) which have the first two letters different. So the answer
is 262 + (26)(25)(2) = 1976.
In Problem 10, there are 1976 -26 = 1950 words which use exactly two
different letters.
iSfi 
VT.-i
The symbol [BB] means that an answer can be found in the Back of the Book.
1. (a) [BB] Roberta needs two courses to complete her
university degree. There are three sections of the
first course which meet in the morning and four
afternoon sections. In how many different ways can
she select the two courses she needs?
(b) [BB] Suppose Roberta needs just one course to com-
plete her degree. In how many ways can she select
this course?
2. A building supplies store carries metal, wood, and plas-
tic moldings. Metal and wood molding comes in two
different colors. Plastic molding comes in six different
colors.
(a) How many choices of molding does this store
offer?
(b) If each kind and each color of molding comes in four
different lengths, how many choices does the con-
sumer have in the purchase of one piece of
molding?
3. [BB] In how many of the three-digit numbers 000-999
are all the digits different?
4. (a) How many numbers in the range 100-999 have no
repeated digits?
(b) Without using the result of Problem 8, determine
how many odd numbers in the range 100-999 have
no repeated digits.
(c) Answer (b) again, this time making use of (a) and
Problem 8.
5. (a) [BB] Some license plates in California consist
of one of the digits 1-9, followed by three (not
necessarily distinct) letters and then three of the dig-
its 0-9 (not necessarily distinct). How many possi-
ble license plates can be produced by this method?
(b) [BB] Other California license plates consist of one
of the digits 1-9 followed by three letters and then
three of the digits 0-9. (The same digit or letter can
be used more than once.) How many license plates
of this type can be made?
(c) [BB] What is the maximum number of license plates
in California that can be made assuming plates have
one of the two types described in (a) and (b)?
6. In Mark Salas, the 1991 Detroit Tigers had probably
the only palindromic player in major league baseball
(certainly, the only palindromic catcher). A palindrome
is a word that reads the same forward and backward,
like SALAS.
(a) How many five-letter palindromes (not necessarily
real words) can be made from the letters of the
English alphabet?
(b) How many eight-letter palindromes are possible?
(c) How many "words" not exceeding eight letters in
length are palindromes?
(d) One of the most famous palindromes of all time is
one which might have been uttered by Napoleon
(had his native tongue been English): ABLE WAS
I ERE I SAW ELBA. How many palindromes (not
necessarily of real words) are this of this length?

7. [BB] From a group of 13 men, 6 women, 2 boys, and 4
girls,
(a) In how many ways can a man, a woman, a boy, and
a girl be selected?
(b) In how many ways can a man or a girl be selected?
(c) In how many ways can one person be selected?
8. In how many ways can one draw from a standard deck
of 52 playing cards
(a) a heart or a spade?
(b) an ace or a king?
(c) a card numbered 2 through 10?
(d) a card numbered 2 through 10 or a king?
9. [BB] Using only the digits 1, 3, 4, and 7,
(a) how many two-digit numbers can be formed?
(b) how many three-digit numbers can be formed?
(c) how many two- or three-digit numbers can be
formed?
10. How many possible telephone numbers consist of seven
digits, the first two in the range 2-9 (inclusive), the third
in the range 1-9 (inclusive), and each of the last four in
the range 0-9 (inclusive)?
11. [BB] A company produces combination locks, the com-
binations consisting of three different numbers in the
range 
0-59 
(inclusive) 
which 
must 
be 
dialed
in order. How many different combinations are possi-
ble?
12. In how many ways can two adjacent squares be selected
from an 8 x 8 chess board?
13. [BB] New parents wish to give their baby one, two,
or three different names. In how many ways can the
baby be named if the parents will choose from a book
containing 500 names?
14. There are three different roads from Cupids to Harbour
Grace and five different roads from Harbour Grace to
Heart's Desire.
(a) How many different routes are there from Cupids to
Heart's Desire via Harbour Grace?
(b) How many different round trips are there from Cu-
pids to Heart's Desire and back, passing through
Harbour Grace each way?
(c) Repeat (b) if you don't want to drive on any road
more than once.
15. How many three-digit numbers contain the digits 2 and
5 but none of the digits 0, 3, 7?
6.2 The Addition and Multiplication Rules 203
16. You are dealt four cards from a standard deck of 52
playing cards. In how many ways can you get
(a) [BB] four of a kind (four 2's, or four kings, etc.)?
(b) two (different) pairs?
(c) four of a kind or two (different) pairs?
(d) three, but not four, of a kind?
(e) at least one pair?
17. Two dice are rolled.
(a) In how many ways can a total of eight arise?
(b) In how many ways can a total of seven arise?
(c) In how many ways can a total of eight or seven
arise?
(d) In how many ways can one get "doubles" (the dice
land with the same side up)?
18. [BB] Make a table which shows all the totals which are
possible when two dice are rolled and the number of
ways in which each total can occur.
19. (a) In how many ways can two dice land?
(b) In how many ways can five dice?
(c) In how many ways can n dice land?
(d) If n dice are rolled, in how many ways can they
land not all showing the same number?
20. A coin is tossed four times.
(a) [BB] Make a list of all the possible outcomes. For
example, the sequence HHTH, representing head,
head, tail, head, is one possibility. How many pos-
sibilities are there altogether?
(b) In how many ways can you get exactly one head?
(c) In how many ways can you get exactly two heads?
(d) In how many ways can you get exactly three heads?
(e) In how many ways can you get at least one head?
21. (a) How many five-digit numbers can be formed using
the digits 0-9 inclusive if repetitions are allowed?
(Leading O's are not allowed: 07392, for example,
should not be considered a five-digit number.)
(b) How many five-digit numbers can be formed if rep-
etition is not allowed?
(c) How many five-digit numbers have one or more
repeated digits?
22. How many possible license plates can be manufactured
if a license plate consists of three letters followed by
three digits and
(a) [BB] the digits must be distinct; the letters can be
arbitrary?
(b) the letters must be distinct; the digits can be arbi-
trary?
(c) the digits and the letters must be distinct?

204 
Chapter 6 Principles of Counting
23. The complete menu from a local gourmet restaurant is
shown in Table 6.1.
Table 6.1
Appetizers 
Beverages
cod au gratin 
house wine
squid ribs 
imported wine
snail's tails 
soft drink
smoked seaweed 
coffee
tea
milk
Entree 
Vegetables
flipper pie 
spinach
cod tongues 
fiddleheads
caplin fillets 
cabbage
turnip
potatoes
(a) In how many ways can John plan a four-course
meal, one course from each group?
(b) Suppose Mary wants two appetizers and one course
from each other group. How many meals are possi-
ble?
(c) Mike wants a two-course meal. How many choices
does he have?
(d) Suppose Rod wants at most one course from each
group and at least one course from some group. How
many meals are possible?
24. Suppose n = PI' I p12  
Pra is the decomposition of n
into the product of distinct primes Pi, P2, 
Pr How
many (unordered) pairs {s, t} of positive integers satisfy
both st = n and gcd(s, t) 
I?
25. [BB] Let A = [al, a2 .
a, } be a set of n elements
and B = {0, 11.
(a) Show that there are 2' functions from A to B.
(b) Show that there are 2n - 2 onto functions from A
to B.
26. Let A 
l{al, a2, .
an} be a set of n elements, n > 1,
and B -
{1,2, 31.
(a) Prove that there are 3' functions A -+ B.
(b) How many functions A -+ B are not onto?
(c) How many onto functions are there A -- B? Justify
your answer.
6.3 
THE PIGEON-HOLE PRINCIPLE
i :1   
e] u: (a] ma
This section deals with a deceptively simple restatement of a certain fact about
functions between finite sets, namely, that if A and B are finite sets with I A I > I B
no function f: A -Ã· B can be one-to-one. For example, no function (1, 2, 31
{x, y} can be one-to-one.
Suppose that B is a set of bird houses, A is a set of pigeons, and f is a
function which assigns a bird house to each pigeon. The statement that f is not
one-to-one is just the observation that at least two pigeons are confined to the
same house. Thus, we obtain the so-called Pigeon-Hole Principle.
If n objects are put into m boxes and n > m, then at least one box contains two
or more of the objects.
We said that this principle is "deceptively" simple. The deception often lies
in recognizing that the principle can be applied. For example, within any group of
13 people, there must be two who have their birthdays in the same month. (The
people are the objects and the months of the year are the boxes.)

6.3 The Pigeon-Hole Principle 
205
PROBLEM 11. 
Given five points inside a square whose sides have length 2,
prove that two are within Nf2 of each other.
Solution. 
Subdivide the square into four squares with
sides of length 1, as shown. By the Pigeon-Hole Princi- 
l
pie, at least two of the five chosen points must lie in, or on 
1
the boundary of, the same smaller square. But these points
are at most X2 apart (the length of the diagonal of a smaller
square). 
I 
I 
I
We continue with some subtler applications of the Pigeon-Hole Principle.
PROBLEM 12. 
Show that among n + I arbitrarily chosen integers, there must
exist two whose difference is divisible by n.
Solution. 
Denote the integers al, a2, . . , an+I. As we know, the n congruence
classes 0, 1 . . , n-I 
of integers mod n partition the integers into disjoint sets
whose union is Z. (See Proposition 4.4.5.) Put each integer ai into its own con-
gruence class. By the Pigeon-Hole Principle, two integers, a! and aj will go to
the same class k. Since ai E k, a, = k (Proposition 4.4.3) and, similarly, aZ= k.
Thus, a'7 = a, so ai 
aj (mod n); that is, n | (a!- 
a), as desired. 
I
The solution to this problem involves a property of the integers which is often
used in Pigeon-Hole problems: If two numbers lie in the same congruence class
of integers mod n, then their difference is divisible by n.
PROBLEM 13. 
Prove that in any list of ten natural numbers, al, a2 .
alo,
there is a string of consecutive items of the list, af, ae+1, ae+2 . . ., whose sum is
divisible by 10. (We include the possibility that the "string" consists of just one
number.)
Solution. 
Consider the ten numbers
al,al + a2,.- 
,al +a2+ - +alo.
If any of these is divisible by 10, we have the desired conclusion; otherwise,
each number lies in one of the nine congruence classes 1, 2, . . .9, 
of integers
mod 10. By the Pigeon-Hole Principle, two of them must lie in the same class and
hence have a difference divisible by 10. Again we reach the desired conclusion
because, if s > t, (a + a2 + 
+ as)-(al + a2 + 
+ at) = at+1 + ar+2
+- 
+as. 
I
u 
.
\ 
\ 
\ 
A..... 
\ 
~~~~~~~~~~....... .... ............ 
o
PROBLEM 14. 
Martina has three weeks to prepare for a tennis tournament. She
decides to play at least one set every day but not more than 36 sets in all. Show that
there is a period of consecutive days during which she will play exactly 21 sets.
Solution. 
Suppose Martina plays al sets on day 1, a2 sets on day 2, and so
on, a21 sets on the last day of her preparation period. Consider the 21 natural
numbers al, al + a2, ... , al + a2 +... + a21. Since each ai > I and since the

206 
Chapter 6 Principles of Counting
sum al + a2 + .
+ a2l is the total number of sets Martina will play, we have
1 < as < al +-a2 < 
< al +a2 + 
+a2l < 36.
Now the only natural number between I and 36 which is divisible by 21 is 21
itself. Therefore, each of these sums is either 21 or it belongs to one of the
20 nonzero congruence classes of integers mod 21. In the first case, we have
al + a2 + 
+ ai = 21 for some i; so Martina would play precisely 21 sets on
days I through i giving the desired result. In the second case, by the Pigeon-Hole
Principle, two sums lie in the same congruence class and hence have difference
divisible by 21. As in Problem 13, we obtain a,+] + a+2 + 
+ a, divisible by
21 for some s and t. Since this is a number between I and 36, it must equal 21
and we conclude that Martina plays 21 games on days t + 1 through s. 
U
PROBLEM 15. 
Suppose Martina has 11 weeks to prepare for her tournament
and that she intends to play at least one set a day and at most 132 practice sets
in all. Draw again the conclusion that during some period of consecutive days,
Martina will play precisely 21 sets.
Solution. 
The approach used before doesn't work this time (see Exercise 9), so
we find a slightly different solution. We let bi be the number of sets Martina
plays on days I through i inclusive (b, = al + a2 + 
+ ai in the notation of
Problem 14) and consider the 154 numbers
bib2,.. , b7 7,bil +-21,b
2 +21, .
b77+21.
The largest number here, b77+21, is at most 132+21 = 153. By the Pigeon-Hole
Principle, we conclude that two are the same. Since bi > bj if i > j, the only way
for two to be equal is for bi = by + 21 for some i and j with i > j. Therefore,
bi- bj = 21 and Martina plays 21 sets on days j + I through i. 
I
We noted earlier that in any group of 13 people, at least two must have
birthdays in the same month. The same must hold in any larger group, but surely
something stronger is also true. If at most two people in a group of 30 had
birthdays in the same month, we would account for at most 24 people. Thus, in
any group of 30, there must be at least three with birthdays in the same month.
Recall the definition of the ceiling function given in 3.1.6. For any real number
x, [xl means the least integer which is greater than or equal to x. For example,
[3.51 = 4, F0.241 = 1, [-2.91 = -2 and [3Â°1 = 3.
If n objects are put into m boxes and n > m, then some box must contain at least
[ 1 objects.
EXAMPLE 16 
If there are 44 chairs positioned around five tables in a room, some table must
have at least F441 = 9 chairs around it. 
A
To prove the strong form of the Pigeon-Hole Principle, we establish the truth
of its contrapositive. Note that
I-n ] <-n + I 
and hence 
n- 
_1 <-
m 
m 
m 
m
6 
0

6.3 The Pigeon-Hole Principle 
207
because, for any real number x,
x < [x] <x + 1.
Thus, if a box contains fewer than [-] objects, then it contains at most 
1 
1
and so fewer than -
objects. If all m boxes are like this, we account for fewer
than m x-= 
n objects.
PROBLEM 17. 
In any group of six people, at least three must be mutual friends
or at least three must be mutual strangers.
Solution. 
Pretend you are one of the six people and put the other n = 5 people
into m = 2 "boxes" labeled "my friends" and "strangers to me." Since [n/mi -
[5/21 
3, by the strong form of the Pigeon-Hole Principle, at least one of these
boxes must contain three people. Suppose three people are your friends. If any two
of these three are friends, then together with you, we have a set of three mutual
friends. If no two of these three are friends, then these three people are mutual
strangers. In either case, we have one of the desired conclusions. The remaining
possibility, that three of the five people are strangers to you, leads again to the
desired conclusion with an argument, which we omit, similar to the one already
presented. 
I
Provide the details of this omitted argument.
9. Either the three people in this group are mutual friends or there are two who
are strangers. Since each of these two is a stranger to you, we have a set of
three mutual strangers.
The symbol [BB] means that an answer can be found in the Back of the Book.
1. [BB] Show that in any group of eight people, at least
two have birthdays which fall on the same day of the
week in any given year.
2. Write down any six natural numbers. Verify that there
is a string of consecutive numbers in your list (possibly
a "string" of just one number) whose sum is divisible
by 6. Prove that this must always be the case.
3. In any list of n natural numbers, prove that there must
always exist a string of consecutive numbers (possibly
just one number in the string) whose sum is divisible
by n.
4. [BB] In a group of 100 people, several will have their
birthdays in the same month. At least how many must
have birthdays in the same month? Why?
5. A standard deck of playing cards contains 52 cards
divided into four suits (club, diamond, heart, spade)
of 13 denominations (Ace, 2, 3, ... , 10, Jack, Queen,
King). How many cards of a single suit must be present
in any set of n cards? How many cards of the same
denomination? Explain.
6. (a) [BB] If 20 processors are interconnected and every
processor is connected to at least one other, show
that at least two processors are directly connected
to the same number of processors.
(b) [BB] Is the result of (a) still true without the assump-
tion that every processor is connected to at least one
other? Explain.
7. Thirty buses are to be used to transport 2000 refugees
from Gander to St. John's, Newfoundland. Each bus has
80 seats. Assume one seat per passenger.
(a) Prove that one of the buses will carry at least 67
passengers.
-
S 
*.

208 
Chapter 6 Principles of Counting
(b) Prove that one of the buses will have at least 14
empty seats.
8. In a gathering of 30 people, there are 104 different pairs
of people who know each other.
(a) Show that some person must have at least seven
acquaintances.
(b) Show that some person must have fewer than seven
acquaintances.
9. [BB] Try to solve Problem 15 with the method used to
solve Problem 14. What goes wrong?
10. [BB] Brad has five weeks to prepare for his driver's test.
His mother volunteers to drive with him for either 15
minutes or a half hour every day until the test, but not
for more than 15 hours in all. Show that during some
period of consecutive days, Brad and his mother will
drive for exactly eight and three quarter hours.
11. Linda has six weeks to prepare for an examination and
at most 50 hours available to study. She plans to study
at least an hour a day and a whole number of hours each
day. Show that no matter how she schedules her study
time, there is a period of consecutive days during which
she will have studied exactly 33 hours.
12. George has promised to increase his vocabulary by
learning the meanings of 90 new words during his
summer holidays. Suppose he has 53 days in which
to accomplish this task and will learn at least one
new word a day. Show that during some span of
consecutive days, George will learn precisely 15 new
words.
13. [BB] In a 12-day period, a small business mailed 195
bills to customers. Show that during some period of
three consecutive days, at least 49 bills were mailed.
14. The circumference of a roulette wheel is divided into 36
sectors to which the numbers 1, 2, 3, ... , 36 are assig-
ned in some arbitrary manner. Show that there must be
three consecutive sectors whose assigned numbers add
to at least 56.
15. How many seats in a large auditorium have to be occu-
pied to be certain that at least three people seated have
the same first and last initials?
16. [BB] Of any 26 points within a rectangle measuring
20 cm by 15 cm, show that at least two are within 5 cm
of each other.
17. Of any five points chosen within an equilateral triangle
whose sides have length 1, show that two are within a
distance of 2 of each other.
2
18. A cake is in the shape of a regular hexagon with each
of its sides exactly 30 cm long. Seven flowers of icing
adorn the top. Show that at least two flowers are not
more than 30 cm apart.
19. Let S = {2, 3,5,7, 11, 13, 17, 19) be the set of prime
numbers less than 20. If A is a subset of S, we can form
the sum and product of the elements of A. For example,
if A = {7, 11, 131, then the associated sum is 7 + 11 +
13 = 31 and the associated product is 7(11)(13) =
1001.
(a) Use the Pigeon-Hole Principle to show that there
are four nonempty subsets of S with the same sum.
(b) Are there two nonempty subsets of S with the same
product? Explain.
20. [BB] Given any positive integer n, show that some mul-
tiple of n is an integer whose representation in base 10
requires just 3's and 0's.
[Hint: Let Ml = 3, M2 = 33, M3 = 333,. 
Then
think about the remainders when each of these numbers
is divided by n.]
21. Show that some multiple of 2002 consists of a string of
l's followed by a string of 0's.
22. [BB] Show that the decimal expansion of a rational num-
ber must, after some point, become periodic or stop.
[Hint: Think about the remainders in the process of long
division.]
23. One hundred and one numbers are chosen from the set of
natural numbers {I, 2,3, ... ,2001. 
Show that one must
be a multiple of another. [Hint: Any natural number can
be written in the form 2ka with k > 0 and a odd.]
24. In a room where there are more than 50 people with
ages between I and 100, show that
(a) [BB] Either two people have the same age or there
are two people whose ages are consecutive integers.
(b) Either two people have the same age or one person's
age is a multiple of another's.
(c) Some of the people shake hands. Show that at least
two shook the same number of hands. ("No hands"
is a possibility.)
(d) Some people shake hands. Show that among those
who shook at least one hand, two people shook the
same number of hands.
25. (a) Let A be a set of seven (distinct) natural numbers
none of which exceeds 21. Prove that the sums of
the elements in all the nonempty subsets of A are
not distinct.

Review Exercises 209
(b) Improve the result of (a) by showing that the result
holds under the assumption that the integers of A
do not exceed 23.
(c) Assume none of the elements of A exceeds 12. At
least how many subsets of A must have the same
sum?
26. (a) [BB] Show that in any group of ten people, there
is either a set of three mutual strangers or a set of
four mutual friends.
(b) Show that in any group of 20 people, there is either
a set of four mutual strangers or a set of four mutual
friends.
27. Suppose al, a2, .
alo are ten integers between I and
100 (inclusive).
(a) Prove that there exist two subsets {ai1, ai2 .  
ai,
and {aj,, ai 2 , . .., aj I with equal sums.
(b) Prove that there exist two disjoint subsets {ai1,
a.2 I . ., air ) and {aj, , aj2, .
aj., } with equal
sums.
28. Prove the (first form of the) Pigeon-Hole Principle
by mathematical 
induction on m, the number of
boxes.
29. Given any 52 integers, show that there exist two whose
sum or difference is divisible by 100. [Hint: xi i xi.]
M = * S
1. Suppose A and B are nonempty finite sets and IAUBI <
JAI + 1B1. Show that A n B # 0.
2. Using the Principle of Inclusion-Exclusion, find the
number of integers between I and 2000 (inclusive)
which are divisible by at least one of 2, 3, 5, 7.
3. John Sununu was once the governor of New Hamp-
shire, and his name reminds one of the authors of a
palindrome.
(a) What is a palindrome and what made the author
think of this?
(b) How many seven-letter palindromes (not necessarily
real words) begin with the letter "S" and contain at
most three different letters?
(c) How many seven-letter palindromes (not necessarily
real words) are there in all?
(d) Name a palindromic rock band of the late 1970s
which is still popular today.
4. Two Math 2320 students are arguing about the number
of palindromes with nine and ten letters. One claims
there are more with ten letters than with nine; the other
says there are the same number in each case. Who is
right? Explain.
5. Four sets Al, A2 , A3 , A4 have the property that Ai n
Aj A Ak 
0 whenever i, j, k are distinct. In addition,
IAi n Aj = 1 whenever i :A j and IAi = 5 for all i.
Find the number of elements that belong to at least one
of the sets.
6. Seventy cars sit on a parking lot. Thirty have stereo
systems, 30 have air conditioners and 40 have sun roofs.
Thirty of the cars have at least two of these three options
and 10 have all three. How many cars on the lot have at
least one of these three options? How many have exactly
one?
7.
8.
State the strong form of the Pigeon-Hole Principle.
Show that among 18 arbitrarily chosen integers, there
must exist two whose difference is divisible by 17.
9. Use the Pigeon-Hole Principle and the definition of infi-
nite set to prove that Z is infinite.
10. Show that, of any ten points chosen within an equilateral
triangle whose sides have length 1, there are two whose
distance apart is at most 1

i 
IN 
7
Permutations and
Combinations
7.1 
PERMUTATIONS
The registrar of a school must schedule six examinations in an eight-day period
and has promised the students not to schedule more than one examination per
day. How many different schedules can be made? The answer to this question
involves a straightforward application of the multiplication rule. The first exam
can be given on any of the eight days, but once this day has been settled, the
second exam can be given on only one of the remaining seven days. There are
8 x 7 = 56 pairs of days on which the first two examinations can be scheduled.
Once the first two exams have been scheduled, there remain six days on which
to schedule the third exam. Continuing to reason this way, we see that there are
8 x 7 x 6 x 5 x 4 x 3 = 20,160 possible schedules.
In how many ways can a blue, a white, and a red marble be put into 10
numbered boxes? If there is no limit on the number of marbles which can be
put into a box, there are 10 possible boxes into which the blue marble can be
placed and then 10 choices for the white one and 10 choices for the red one,
giving 103 =1000 possibilities altogether. Suppose, on the other hand, we are
not allowed to put more than one marble into a box. As before, there are 10
possible boxes for the blue marble, but now there are just 9 possible boxes for
the white one and 8 for the red. Altogether, there are 10 x 9 x 8 =720 possi-
bilities.
The solution to a counting problem often involves the product of consecutive
integers. Remember that n! denotes the product of all the natural numbers from
1 to n (inclusive):
I 
= n(n -
1)(n -
2)... (3)(2)(1)
(see Definition 5.1.2). The notation P(n, r) denotes the product of the first r
factors of n!.
211

212 
Chapter 7 Permutations and Combinations
I 
A
"eg
For integers n and r, n > 1, 0 < r < n, the symbol P(n, r) is defined by
P(n, 0) = 1 and, for r > 0,
P(n, r) = n(n -1)(n -2) 
...(n 
1 .
r factors
For example, P(6, 2) = 6 . 5 = 30 (the first two factors of 6!), P(7, 3) =
7 6 5 = 210 (the first three factors of 7!), P(8, 5) = 8 7 6 5 4 = 6720,
P(12, 0) = 1, and so on.
Find P(5,3), P(4,4), and P(7,2).
Among the combinatorial problems to which P(n, r) is the answer is the
following one, which we have already illustrated.
Given natural numbers r and n with r < n, the number of ways to place r marbles
of different colors into n numbered boxes, at most one marble to a box, is P(n, r).
Notice that
n(n 
1)(n 
2)... (ni - r Â± 1) ( 
- r)(n 
r 
1)... (3)(2)() = n!.
P(n,r) 
(n r)!
Thus,
a formula which holds also for r = 0 and r = n because P(n, 0) = I and
0! = 1.
Some people have been known to protest that this formula is difficult to use
because, for example, they are unable to evaluate numbers like P(25, 1) = 25!
with their calculator, 25! being too large to compute. It is good for us all to notice
that
25! 
25 )4 
.,2 
= 25.
24! 
.
.,2
Find 20! 
10! and P(7,10)
17!' 
98!,
For us, the symbol P(n, r) is primarily a notational device which makes it easy
to write down the answers to certain combinatorial problems. We caution against
trying to fit a problem involving a straightforward application of the multiplication
rule into the context of marbles and boxes.
PROBLEM 1. How many pairs of dance partners can be selected from a group
of 12 women and 20 men?
Solution. 
The first woman can be paired with any of 20 men, the second woman
with any of the remaining 19 men, the third with any of the remaining 18, and so
on. There are 20. 19. 18.. 9 = P(20, 12) possible couples. 
I

7.1 Permutations 
213
*30
EXAMPLES 2
8
e.g 
,e
There is a second question, having to do with permutations, to which P(n, r)
is the answer and which explains the "P" in "P(n, r)."
A permutation of a set of distinct symbols is an arrangement of them in a line in
some order.
ab and ba are permutations of the symbols a and b; 1642, 4126, and 6241 are
permutations of the symbols 1, 2, 4, and 6. 
A
The permutations 1642, 4126, and 6241 are also examples of 4-permutations
of the symbols 1, 2, 3, 4, 5, 6, that is, permutations of the symbols 1, 2, 3, 4,
5, 6 taken four at a time. Here are some 3-permutations of the 26 letters of the
alphabet: zxy, aqr, cat, how.
For natural numbers r and n, r < n, an r-permutation of n symbols is a permu-
tation of r of them, that is, an arrangement of r of the symbols in a line in some
order.
As a direct consequence of the multiplication rule, we have the following.
The number of permutations of n symbols is n!. The number of r-permutations
of n symbols is P(n, r).
For example, there are 3! = 6 permutations of a, b, c, namely, abc, acb, bac,
bca, cab, and cba. (There are three choices for the first symbol and then two for
the second and one for the third.) There are 6. 5 . 4. 3 = 360 = P(6, 4) ways in
which four of the six creatures-man, woman, boy, girl, dog, cat-can walk in a
line down a road, one after the other.
PROBLEM 3. 
There are 7! = 5040 ways in which seven people can form a
line. In how many ways can seven people form a circle?
Solution. 
A circle is determined by the order of the people to the right of any
one of the individuals, say Eric. There are six possibilities for the person on Eric's
right, then five possibilities for the next person, four for the next, and so on. The
number of possible circles is 6! =720. 
I
Another way to obtain 6! is to relate the two problems, line and circle. Each
circle determines seven lines, determined by asking the people to join hands and
then breaking the circle at one of the seven people.
No. of circles x 7 = no. of lines = 7!
7!
Therefore, no. of circles 
-
= 6!
7
PROBLEM 4. 
A man, a woman, a boy, a girl, a dog, and a cat are walking
down a long and winding road one after the other.
(a) In how many ways can this happen?
(b) In how many ways can this happen if the dog comes first?

214 
Chapter 7 Permutations and Combinations
A 
-
* *.
(c) In how many ways can this happen if the dog immediately follows the
boy?
(d) In how many ways can this happen if the dog (and only the dog) is between
the man and the boy?
Solution.
(a) There are 6! = 720 ways for six creatures to form a line.
(b) If the dog comes first, the others can form 5! lines behind.
(c) If the dog immediately follows the boy, then the dog-boy pair should be
thought of as a single object to be put into a line with four others. There
are 5! = 120 such lines.
(d) If the man, dog, and boy appear in this order, then thinking of man-dog-
boy as a single object to be put into a line with three others, we see that
there are 4! possible lines. Similarly, there are 4! lines in which the
boy, dog, and man appear in this order. So, by the addition rule, there
are 4! + 4! = 48 lines in which the dog (and only the dog) is between the
man and the boy. 
U
PROBLEM 5. 
In how many ways can ten adults and five children stand in a
line so that no two children are next to each other?
Solution. 
Imagine a line of ten adults named A, B. .
,
xD x J x H xC x I x E x B x A x G x Fx,
the x's representing the 11 possible locations for the children. For each such
line, the first child can be positioned in any of the 11 spots, the second child
in any of the remaining 10, and so on. Hence, the children can be positioned in
11. 10 9.8 .7 = P(1 1, 5) ways. For each such positioning, there are 10! ways of
ordering the adults A, ... , J, so, by the multiplication rule, the number of lines
of adults and children is 10!P(1I, 5). 
I
In how many ways can ten adults and five children stand in a circle so that no
two children are next to each other?
PROBLEM 6. 
In how many ways can the letters of the English alphabet be
arranged so that there are exactly ten letters between a and z?
Solution. 
There are P(24, 10) arrangements of the letters of the alphabet (exclu-
ding a and z) taken ten at a time, and hence 2. P (24, 10) strings of 12 letters, each
beginning and ending with an a and a z (either letter coming first in a string). For
each of these strings, there are 15! ways to arrange the 14 remaining letters and
the string. So there are altogether 2 . P(24, 10) . 15! arrangements of the desired
type.
The answer to Problem 6 is also 30(24!). Why?
1. P(5,3) -5 
4 3 =60; P(4,4) =44 32 1 
2 
=24; P(7,2) =7 6=42.
2. 20! = 20 19. 18 =6840; 100! = 100l99 = 9900; P(7, 0) 
7 
1.
2 7 = 
098!-

7.1 Permutations 
215
3. Arrange the adults into a circle in one of 9! ways. There are then 10 locations
for the first child, 9 for the second, 8 for the third, 7 for the fourth, and 6 for
the fifth. The answer is 9!(10 . 9. 8 . 7 -6) = 9! . P(I0, 5).
4. First we count the number of arrangements of the prescribed type in which
a precedes z. For each of the 24! permutations of the letters b through y,
there are 15 locations for a after which the position of z is fixed. Thus, there
are 15(24!) arrangements with a preceding z. Similarly, there are 15(24!)
arrangements with z preceding a giving, altogether, 2(15)(24!) arrangements.
The symbol [BB] means that an answer can be found in the Back of the Book.
1. [BB] How many ways are there to distribute eight dif-
ferent books among thirteen people if no person is to
receive more than one book?
2. Eight horses are entered in a race in which a first, sec-
ond, and third prize will be awarded. Assuming no ties,
how many different outcomes are possible?
3. [BB] A club has ten members. In how many ways can
they choose a slate of four officers consisting of a pres-
ident, vice president, secretary, and treasurer?
4. There are 30 people in a class learning about permu-
tations. One after another, eight people gradually slip
out the back door. In how many ways can this exodus
occur?
5. [BB] Find the number of ways in which six children can
ride a toboggan if one of the three girls must steer (and
therefore sit at the back).
6. Four cats and five mice enter a race. In how many ways
can they finish with a mouse placing first, second, and
third?
7. (a) In how many ways can ten boys and four girls sit
in a row?
(b) [BB] In how many ways can they sit in a row if
the boys are to sit together and the girls are to sit
together?
(c) In how many ways can they sit in a row if the girls
are to sit together?
(d) In how many ways can they sit in a row if just the
girls are to sit together?
8. Answer all parts of Exercise 7 with "circle" instead of
"row." (In every circle, people sit facing inward.)
9. [BB] In how many ways is it possible to sit seven
knights at a round table if
(a) Friday, Saturday, and Sunday insist on sitting
together?
(b) Wednesday refuses to sit next to Saturday or Sun-
day?
10. [BB] Let X and Y be sets with [XI = m and IYI = n.
(a) How many bijective functions are there X 
X?
(b) How many invective functions are there X 
Y?
11. How many permutations of the letters a, b, c, d, e, f, g
contain neither the pattern bge nor the pattern eaf?
12. [BB] In how many ways can two couples, the Nosewor-
thys and the Abbotts, form a line so that
(a) the Noseworthys are beside each other?
(b) the Noseworthys are not beside each other?
(c) each couple is together?
(d) the Noseworthys are beside each other but the
Abbotts are not?
(e) at least one couple is together?
(f) exactly one couple is together?
13. Repeat Exercise 12, assuming, in each part, that a dog
also forms part of the line.
14. Three couples, the Smiths, Joneses, and Murphys, are
going to form a line.
(a) [BB] 
In how many such lines will Mr. and
Mrs. Jones be next to each other?
(b) In how many such lines will Mr. and Mrs. Jones
be next to each other and Mr. and Mrs. Murphy be
next to each other?
(c) In how many such lines will at least one couple be
next to each other?
15. How many permutations of the letters a, b, c, d, e, f, g
have either two or three letters between a and b?
16. (a) [BB] How many seven-digit numbers have no
repeated digits?

216 
Chapter 7 Permutations and Combinations
(b) How many seven-digit numbers with no repeated
digits contain a 3 but not a 6?
(Leading zeros are not permitted in either part of this
question.)
17. (a) In how many numbers with seven distinct digits do
only the digits 1-9 appear?
(b) [BB] How many of the numbers in (a) contain a 3
and a 6?
(c) In how many of the numbers in (a) do 3 and 6 occur
consecutively (in either order)?
(d) [BB] How many of the numbers in (a) contain nei-
ther a 3 nor a 6?
(e) How many of the numbers in (a) contain a 3 but not
a 6?
(f) In how many of the numbers in (a) do exactly one
of the numbers 3, 6 appear?
(g) In how many of the numbers in (a) do neither of the
consecutive pairs 36 and 63 appear?
18. Let X and Y be finite nonempty sets, JXJ = m, lY 
-
n < m. Let f(n, m) denote the number of partitions of
X into n subsets. Prove that the number of surjective
functions X -- Y is n!f (n, m).
7.2 
COMBINATIONS
There are 12 different kinds of drinks for sale in a store and a customer wants
to buy two different kinds. How many choices does this person have? There are
12 women and 20 men in a club, five of whom will be chosen to organize a
Christmas party. In how many ways can these five people be chosen? If a coin is
tossed eight times, in how many ways can exactly five heads turn up? These are
the sorts of questions which we answer in this section.
In the last section, we found that the number of ways to place three different
colored marbles into ten numbered boxes, at most one to a box, is P (10, 3) = 720.
Suppose the marbles have the same color. Are there still 720 possibilities? In fact,
the number is much smaller. When there are red, blue, and green marbles, for
each choice of boxes, there are 3! = 6 different ways of assigning the marbles to
them corresponding to the six permutations of "red," "blue,". "green." Figure 7.1
illustrates the six ways the marbles can be assigned to boxes 3, 4, and 8, for
instance. When the marbles have the same color, these six assignments are all the
same.
BOX I 
BOX 2 
BOX 3 
BOX 4 
.. 
BOX 8
rbg
rgb
brg
bgr
grb
gbr
red
red
blue
blue
green
green
blue
green
red
green
red
blue
green
blue
green
red
blue
red
Figure 7.1 
There are 3! = 6 ways to assign three different colored marbles to three boxes.
It is useful to notice that when the marbles have the same color, each config-
uration of marbles in boxes simply amounts to a choice of three boxes. Thus, the
number of ways to put three identical marbles into ten boxes is just the number
of ways to select three boxes out of ten. Furthermore, for a given three boxes,
there are 3 x 2 x 1 = 3! = 6 ways in which three marbles of different colors
can be assigned to these boxes. By the multiplication rule, the number of ways

7.2 Combinations 
217
of putting three marbles of different colors into ten boxes (at most one to a box)
is the product of the number of ways of selecting three boxes and the number of
ways then to assign the marbles to these boxes.
P(10, 3) = (number of ways to select 3 boxes from 10) x 3!
To summarize,
Number of ways to select three boxes from ten
= number of ways to put three identical marbles into ten boxes
P(10, 3) 
10! = 120.
3! 
7! 3!
For integers r and n, n > 0 and 0 < r < n, the binomial coefficient (') (read "n
choose r") is defined by
| n) 
n! 
7
| r 
r!(n -r)! 
|
The reason for the name "binomial coefficient" will become clear in Section 7.5.
The reason for saying "n choose r" is given in the following proposition.
Let n and r be integers with n > 0 and 0 < r < n. The number of ways to choose
r objects from n is (n).
If r = 0, the result is true because there is just one way to choose 0 objects (do
nothing!), while (n) = 
n!(n = 1 because 0! = 1. Thus, we may assume that
r > 1 and hence n > 1. Let N be the number we are seeking; that is, there are N
ways to choose r objects from the n given objects. Notice that for each way of
choosing r objects, there are r! ways to order them. By the multiplication rule, the
number of r-permutations of n objects [which we know is P(n, r)] is the number
of ways to choose r objects multiplied by r!, the number of ways to order the r
objects.
P(n, r) = N x r!
Therefore,
N 
P(n,r) -
n! 
- (n)
r! 
r!(n -r)! 
kr'
which is what we wanted to show. 
I
Explain why (n) 
( ( 
).
PROBLEM 7. 
Wanda is going to toss a coin eight times. In how many ways
can she get five heads and three tails?
Proof
MUMMER
EJMCMl

218 
Chapter 7 Permutations and Combinations
* 
6
 
S.,
EXAMPLES 8
Solution. 
Wanda might get a string of five heads followed by three tails
(denote this possibility HHHHHTTT); or a string of three tails followed by five
heads, TTTHHHHH; or the sequence HTHHTHTH; and so on. The number of
such sequences is the number of ways of selecting five occasions (from the
eight) on which the heads should arise or, equivalently, the number of ways
of selecting the three occasions on which tails should come up. The answer is
(') = (') = 56.
............. 
.
.
. ............. 
................ 
..... 
... .X.. 
.............. 
........... 
......... ..
As is so often the case in mathematics, in Proposition 7.2.2, we solved one
problem (in how many ways r objects can be selected from n?) by relating it to
another problem for which we knew the answer (how many r-permutations of n
objects are there?). This is an extremely useful and important idea.
A combination of a set of objects is a subset of them. A subset of r objects is
called an recombination or a combination of the objects taken r at a time.
Thus,
The number of r-combinations of n objects is (n).r
.
The number of 2-combinations of the digits 0, 1, .
9 is
10) 
2810! = 10 9 = 45
( 2 
2! 8! -
2
.
The number of combinations of letters of the alphabet taken six at a time is
(26"\ 
26! 
26 25 24 23 22 21
6 J 
6!20! 
6.5.4.32.1
.
The number of ways to put three identical marbles into ten boxes is the
number of ways of selecting three of ten boxes:
t10 
10! 
10 9 .8
(10)i- 
3.2 
= 120.
3 
3!7! 
3 2 
=12
.
The number of ways to choose two kinds of drinks from a dozen different
kinds is
(12) 
12! 
12 11
2 J 
2!10! 
2
.
The number of ways to choose five people from a group of 32 is
t32) 
32! 
32 .31 .30 
29 28
(32 
5=... 
=201,376.
5 
5!27! 
5 4 3 2 I
The distinction between permutation and combination is the distinction
between order and selection. Box 1, box 2, box 4 is one combination of boxes;
box 2, box 1, box 4 is the same combination, but a different permutation. A
permutation takes order into account; a combination involves only selection.

7.2 Combinations 
219
There are (352) 
= 201,376 ways to choose five people from 32, but 5! x
201,376 = P(32, 5) lines of five people which can be formed from a group of
32, a much larger number, because order is important in a line. The line Ruby,
Mary, Colin, Tom, Eileen is different from the line Mary, Tom, Eileen, Ruby,
Colin, although these two selections of people are the same.
Mr. Hiscock has ten children but his car holds only five people (including driver).
When he goes to the circus, in how many ways can he select four children to
accompany him?
PROBLEM 9. 
In how many ways can 20 students out of a class of 32 be
chosen to attend class on a late Thursday afternoon (and take notes for the
others) if
(a) Paul refuses to go to class?
(b) Michelle insists on going?
(c) Jim and Michelle insist on going?
(d) either Jim or Michelle (or both) go to class?
(e) just one of Jim and Michelle attend?
(f) Paul and Michelle refuse to attend class together?
Solution.
(a) The answer is (0) = 84,672,315 since, in effect, it is necessary to select
20 students from the 31 students excluding Paul.
(b) Now the number of possibilities is (") = 141,120,525 since 19 students
must be chosen from 31.
(c) The answer is ( 31) = 86,493,225, it being necessary to choose the remaining
18 students from a group of 30.
(d) Let J be the set of classes of 20 which contain Jim and M the set of classes
of 20 which contain Michelle. The question asks for IJ U MI. Using the
Principle of Inclusion-Exclusion, we obtain I J U MI = IlI + I M -I 
n 
q M =
(31) + (31) 
_ (13) 
= 195,747,825.
An alternative method of obtaining this answer would be to count separately
the cases-Jim (but not Michelle) goes to class, Michelle (but not Jim) goes
to class, both Jim and Michelle go to class-and add the results. (This
follows because IJ U MI = lJ \ MI + IM \ J1 + II n MI.) We obtain
(3) 
30 
(1) + (30) = 2(54,627,300) + 86,493,225 = 195,747,825, as before.
Yet another method would be to subtract from the total number of possible
classes of 20 the number containing neither Jim nor Michelle. This gives
(3) _ (30) = 225,792,840 - 30,045,015 = 195,747,825.
(e) Using the formula IJ (D MI = IJI + IMI 
21 n Ml, we obtain (1) + (1)9-
2(3) = 109,254,600.
(f) The number of classes containing Paul and Michelle is (30) by part (c), so
the number which do not contain both is (20) 
( 
= 139,299,615.

220 
Chapter 7 Permutations and Combinations
A 
-
g 
*. 
-
Alternatively, observe that this part asks for l(P n M)ri = [PC U MCI (by
one of the laws of De Morgan). So the answer is I|PI I 
MC I 
m 
pc nM 
=
(32) + (3) - (3) 
139,299,615. 
I
. ... ... .. ... ... -. -.....-... 
........... 
.- 
..- 
-. 
..... 
--. 
...... 
.............................. 
--- -- - ---- 7A. 
.
PROBLEM 10. 
How many committees of five people can be chosen from 20
men and 12 women
(a) if exactly three men must be on each committee?
(b) if at least four women must be on each committee?
Solution.
(a) We must choose three men from 20 and then two women from 12. The
answer is (320)(12) 
= 1140(66) = 75,240.
(b) We calculate the cases of four women and five women separately and add
the results (using the addition rule). The answer is (142) (21) + (5)(2) 
=
495(20) + 792 = 10,692. 
I
The combinatorial symbols we have presented in Sections 7.1 and 7.2 are
summarized, together with their interpretations, in Table 7.1.
Table 7.1 
Some combinatorial symbols and their uses.
n ! 
. number of permutations of n distinct
symbols
n!
P(n, r) = 
. number of ways to put r different colored
(n - r)! 
marbles into n numbered boxes, at most
one to a box
. number of permutations of n distinct
symbols used r at a time
(n) 
n!
e number of ways to put r identical marbles
r 
r!(n- r)! 
into n boxes, at most one to a box
. number of combinations of n distinct
symbols used r at a time
. number of ways to choose r objects
from n
5. Suppose we have n white marbles and we wish to paint r of them black.
Choosing the r marbles is equivalent to choosing the n -r marbles which
are to remain white. Thus, each choice of r marbles from n corresponds to a
choice of the remaining n -r, 
so the numbers of choices are the same. By
Proposition 7.2.2, these are (n) and (n r), respectively.

7.2 Combinations 
221
6. The question involves choosing, not order. There are (4) 
4! 
210
different ways.
The symbol [BBI means that an answer can be found in the Back of the Book.
1. [BB] A group of people is comprised of six from
Nebraska, seven from Idaho, and eight from Louisiana.
(a) In how many ways can a committee of six be formed
with two people from each state?
(b) In how many ways can a committee of seven be
formed with at least two people from each state?
2. In how many ways can 12 players be divided into two
teams of six for a game of street hockey?
3. [BB] How many 12-digit 0-1 strings contain precisely
five l's?
4. How many different signals, each consisting of seven
flags arranged in a column, can be formed from three
identical red flags and four identical blue flags?
5. [BB] In how many ways can Tom, Billie, and Peter share
15 salmon of different sizes
(a) if each takes five?
(b) if the youngest boy takes seven salmon and the oth-
ers each take four?
(c) if one boy takes seven salmon and the others each
take four?
6. [BB] How many subsets of a set of ten apples contain
at most three apples?
7. In a popular lottery known as "Lotto 6/49," a player
marks a card with six different numbers from the inte-
gers 1-49 and wins if his or her numbers match six
randomly selected such numbers.
(a) In how many ways can a player complete a game
card?
(b) How many cards should you complete in order to
have at least one chance in a million of winning?
(c) In how many ways can a player complete a game
card so that no number matches any of the six
selected?
(d) In how many ways can a player complete a game
card so that at least one number matches one of the
six selected?
8. (a) [BB] How many five-card hands dealt from a stan-
dard deck of 52 playing cards are all of the same suit?
(b) How many five-card hands contain exactly two
aces?
9. A newcomers' club of 30 people wants to choose an
executive board consisting of president, secretary, trea-
surer, and two other officers. In how many ways can
this be accomplished?
10. [BB] A coin is tossed ten times and the sequence of
heads and tails observed.
(a) How many different sequences are possible?
(b) In how many of these sequences are there exactly
four heads?
11. [BB] An urn contains 15 red numbered balls and ten
white numbered balls. A sample of five balls is selected.
(a) How many different samples are possible?
(b) How many samples contain all red balls?
(c) How many samples contain three red balls and two
white balls?
12. A group of eight scientists is composed of five mathe-
maticians and three geologists.
(a) In how many ways can five people be chosen to
visit an oil rig?
(b) Suppose the five people chosen to visit the rig must
be comprised of three mathematicians and two geol-
ogists. Now in how many ways can the group be
chosen?
13. [BB] From a hundred used cars sitting on a lot, 20 are
to be selected for a test designed to check certain safety
requirements. These cars will then be put back onto the
lot and, again, 20 will be selected for a test designed to
check antipollution standards.
(a) In how many ways can the first selection be made?
(b) In how many ways can the second selection be
made?
(c) In how many ways can both selections be made?
(d) In how many ways can both selections be made if
exactly five cars are to undergo both tests?
14. In how many ways can a team of six be chosen from
20 players so as to
VNIM

222 
Chapter 7 Permutations and Combinations
(a) include both the strongest and the weakest player?
(b) include the strongest but exclude the weakest
player?
(c) exclude both the strongest and weakest player?
15. A woman has nine close friends.
(a) In how many ways can she invite six of these to
dinner?
(b) Repeat (a) if two of her friends are divorced (from
each other) and will not attend together.
(c) Repeat (a) if the friends consist of three single peo-
ple and three married couples and, if a husband or
wife is invited, the spouse must be invited too.
16. The Head of the Department of Mathematical Sciences
at a certain university has 12 mathematicians, seven
computer scientists, and three statisticians in his employ.
He wishes to appoint some committees from among
these 22 people.
(a) How many five-member committees can he appoint?
(b) How many five-member committees, each contain-
ing at least one statistician, can he appoint?
(c) A certain professor of mathematics, Dr. G, and a
certain colleague, Dr. P, refuse to serve together on
the same committee. How many five-member com-
mittees can be formed so as not to contain both
Dr. G and Dr. P?
(d) How many five-member committees can be formed
so that the number of mathematicians is greater than
the number of computer scientists and the number
of computer scientists is greater than the number of
statisticians?
17. A student must answer exactly eight questions out of
ten on a final examination.
(a) [BB] In how many ways can she choose the ques-
tions to answer?
(b) Repeat (a) if she must answer the first three ques-
tions.
(c) [BB] Repeat (a) if she must answer at least three of
the last five questions and at most four of the first
five.
(d) Repeat (a) if she must answer at least three of the
last five questions.
18. Suppose U is a set of 52 elements which contains five
subsets Al, A2, A3, A4, A5 with the following proper-
ties:
. each set contains 23 elements;
* the intersection of any two of the sets contains ten
elements;
. the intersection of any three of the sets contains four
elements;
* the intersection of any four of the sets contains one
element;
. the intersection of all the sets is empty.
How many elements belong to none of the five sub-
sets?
19. Ten points in the plane, no three collinear, are given.
(a) [BB] How many different line segments are formed
by joining pairs of these points?
(b) How many different triangles are formed by the line
segments in (a)?
(c) If A is one of the ten points, how many of the tri-
angles in (b) have A as a vertex?
20. (a) [BB] How many triangles are determined by the
vertices of a regular 12-sided polygon?
(b) Repeat (a) if the sides of the polygon are not to be
the sides of any triangle.
21. A diagonal of a polygon is a line joining two nonadja-
cent vertices.
(a) [BB] How many diagonals does an octagon have?
(b) Loonie is the colloquial name for the Canadian
one dollar coin. It has the shape of a regular 11-
sided polygon. How many diagonals does a loonie
have?
22. (a) How many diagonals does a regular n-sided polygon
have?
(b) Which regular n-sided polygon has three times as
many diagonals as sides?
23. [BB] Prove that the product of any n consecutive natural
numbers is divisible by n!.
24. (a) Use Definition 7.2.1 to prove that (k)(nek) 
=
(e) (e), 
where n, k, and e are natural numbers with
k + f <n.
(b) Establish the identity in part (a) without appealing
to Definition 7.2.1. [Hint: In how many ways can
one choose two teams, one of size k and the other
of size f, from a group of n people?]
25. (a) Let k and n be natural numbers with k < n. Use
the definition of Q) given in 7.2.1 to prove that
(n) 
-
(n-1) + (n-
(b) Establish the identity in (a) without appealing to
any definition.
26. (a) Use Definition 7.2.1 to prove that (2,) = 2(") + n2
for any natural number n.
(b) Establish the identity in (a) without using the defi-
nition.

7.3 Repetitions 
223
7.3 
REPETITIONS
In the previous two sections we counted the number of ways of putting r marbles
into n boxes with at most one marble to a box in two cases: The marbles have
different colors and the marbles are all the same color. Suppose we allow any
number of marbles in a box. If the marbles are all colored differently, then there
are n choices for the first marble, n for the second, and so forth. There are,
altogether, n x n x... 
x n = nr possibilities. When the marbles are all the same
color, however, we expect far fewer possibilities.
Suppose we want to place three white marbles into ten boxes and we are
allowed to put as many marbles into a box as we like. There are three mutually
exclusive ways in which this can be accomplished: Each marble goes into a
different box [in one of (10) = 120 ways], two marbles go into the same box but
the third goes into its own box (in one of 10 x 9 = 90 ways), or all the marbles
go into the same box (in one of 10 ways). By the addition rule, the number of
ways in all is 120 + 90 + 10 = 220. We note in passing that 220 = (1Â°33)
In how many ways can ten marbles, all of the same color, be put into three
boxes? While this problem is obviously similar to the previous, it becomes quickly
apparent that a case-by-case examination of the possibilities is very difficult this
time. There are three ways in which the marbles all go into the same box, but
in how many ways can they be placed into exactly two boxes, or into exactly
three? The question seems quite complicated, so we consider it from a new per-
spective.
One way to put the marbles into the boxes is to put three marbles into box 1,
five into box 2, and two into box 3. This situation can be represented by the 12-
digit string 000100000100, which has strings of three, five, and two 0's separated
by two Fs. There is a one-to-one correspondence between ways of putting the
marbles into the boxes and 12-digit strings consisting of two l's and ten 0's. The
string 001000000100 would represent the situation of two marbles in box 1, six
in box 2, and two in box 3. The string 100000010000 would indicate that there
are no marbles in box 1, six in box 2, and four in box 3. To count the number of
ways of putting ten marbles in three boxes is, therefore, just to count the number
of 12-digit 0-1 strings which contain precisely two I's. This latter number is
easy to find! There are ( ) such numbers corresponding to the number of ways
of selecting two positions for the l's from 12 positions. Therefore, the number
of ways to put ten identical marbles into three boxes, any number to a box, is
12) = 66 = (3Â±lI0-). We have seen two instances of the next proposition.
The number of ways to put r identical marbles into n boxes is (fl 
r-1)
PROBLEM 11. 
Doughnuts come in 30 different varieties and Catherine wants
to buy a dozen. How many choices does she have?
Solution. 
Imagine that the 30 varieties are in n == 30 boxes labeled "choco-
late white," "Boston creme," "peanut crunch," and so on. Catherine can indicate
her choice by dropping r = 12 (identical) marbles into the boxes. So there are
(30+112 -1) = 7,898,654,920 possibilities. 
I

224 
Chapter 7 Permutations and Combinations
M
David wants to buy 30 doughnuts and finds just 12 varieties available. In how
many ways can he make his selection?
The basic facts about marbles and boxes which we have discussed so far are
summarized in Table 7.2.
Table 7.2 
The number of ways to put r marbles into n
numbered boxes.
Same Color 
All Different Colors
At most one to a box 
(n) 
P(n, r)
Any number in a box 
( 
r 
) 
nr
r
In Section 7.1, we counted the number of ways to put three marbles of dif-
ferent colors into ten boxes, at most one marble to a box; and, in Section 7.2, we
considered the same problem for identical marbles. What about the intermediate
possibility that two marbles have the same color, say red, and the third is a dif-
ferent color, perhaps blue? In how many ways can these three marbles be put into
ten boxes, at most one to a box? There are (120) ways in which to pick boxes for
the red marbles and then (8) ways to choose the box for the blue marble. By the
multiplication rule, the number of ways to put two reds and one blue marble into
ten boxes, at most one to a box, is
'100 
t80 
0 
8! 
10!
x () =10! x 
= 
=360.
2 
I 
2! 8! 
7!1I! 
2! 1!7!
The number of ways to put two red, four blue, and three green marbles into
ten boxes, at most one to a box, is (1 Â°) (choose boxes for the reds) x (8) (choose
boxes for the blues) x (4) (choose boxes for the greens); that is,
10! 
8! 
4! 
10!
_ x 
x
2!8! 
4!4! 
3!1! 
2!4!3!1!
PROBLEM 12. 
Suppose there are ten players to be assigned to three teams, the
Xtreme, the Maniax, and the Enforcers. The Xtreme and the Maniax are to receive
four players each and the Enforcers are to receive two. In how many ways can
this be done?
Solution. 
The assignment of players is accomplished by choosing four players
from ten for the Xtreme, then choosing four players from the remaining six for the
Maniax, and assigning the remaining two players to the Enforcers. The number
of possible teams is
(4 x (4) = 210(15) = 3150. 
I

Figure 7.2
7.3 Repetitions 
225
In how many ways can 14 men be divided into six named teams, two with three
players and four with two? In how many ways can 14 men be divided into two
unnamed teams of three and four teams of two?
In how many ways can the letters of the word easy be rearranged? The
question just asks for the number of permutations of four different letters: The
answer is 4! = 24. In how many ways can the letters of the word ease be
rearranged? This is a slightly different problem because of the repeated e: When
the first and last letters of easy are interchanged, we get two different arrangements
of the four letters, but when the first and last letters of ease are interchanged we
get the same word. To see how to count the ways in which the four letters of ease
can be arranged, we imagine the list of all these arrangements.
s e a e
a e e s
eesa
Pretending for a moment that the two e's are different (say one is a capital E),
then each "word" in this list will produce two different arrangements of the letters
e a s E. (See Fig 7.2.)
seaE
seae <
sEae
aeEs
aees <<aaEes
eEsa
eesa <
Eesa
The list on the right contains the 4! = 24 arrangements of the four letters
e a s E, so the list on the left contains half as many. There are 
-! = 12 ways in
2!- 
wasi
which the letters of ease can be arranged.
PROBLEM 13. 
In how many ways can the letters of the word attention be
rearranged?
Solution. 
The word attention has nine letters, three of one kind, two of another,
and four other different letters. The number of rearrangements of this word is
3!2! = 30,240.
This answer is obtained, as before, by imagining the list of arrangements
and imagining how many arrangements could be formed if the letters were all
different. If the two n's were different, each rearrangement would produce two
more, giving a second list twice as long. If the three t's were different, each
"word" in this second list would yield 3! = 6 more. For instance, replacing the

226 Chapter 7 Permutations and Combinations
A 
-
* *
three t's by t, T, and T, then tanetoeti yields
taneToeTi, taneToeTi, TanetoeTi, Taneroeti, ranetoiTi, raneToiti
corresponding to the 3! permutations of t, T, T.
We would obtain a third list 3! times as long as the second and 3! x 2 times
as long as the first. Since this third list consists of all the permutations of the nine
symbols a, t, T, e, n, T, i, o, N, it contains 9! "words," so the original list contained
9! "words."
In how many ways can the letters of the word REARRANGE be rearranged?
7. As in Problem 11, we imagine the 12 varieties in boxes. Each of David's
possible decisions can be indicated by dropping 30 identical marbles into
these boxes. There are (12+30-1) = 3,159,461,968 possibilities (r = 30,
thes 
boxs. 
Tere 
re (30
n = 12).
8. If the teams are named, the answer is
(14) x (13') x (2) x (6) x (6 ) = 364(165)(28)(15)(6) = 151,351,200.
This number is 2!4! = 48 times the number of divisions into unnamed teams
of sizes 3, 3, 2, 2, 2, and 2 because, for each division into unnamed teams,
there are two ways to name the teams of three and 4! ways to name the teams
of two. The answer in the case of unnamed teams is 151,3581,200 = 3,153,150.
9. There are 32!2 = 15,120 rearrangements of the letters of the word REAR-
RANGE.
The symbol [BB] means that an answer can be found in the Back of the Book.
1. [BB] In how many ways can 30 identical dolls be placed
on seven different shelves?
2. There are 15 questions on a multiple-choice exam and
five possible answers to each question.
(a) In how many ways can the exam be answered?
(b) In how many ways can the exam be answered with
exactly eight answers correct?
3. [BB] How many different outcomes are possible when
five dice are rolled? (Two 6's, two 5's, and a I is one
outcome.)
4. [BB] How many different collections of ten coins can
be made from pennies, nickels, dimes, and quarters?
5. A florist sells roses in five different colors.
(a) How many bunches of a half dozen roses can be
formed?
(b) How many bunches of a half dozen can be formed
if each bunch must contain at least one rose of each
color?
6. There are 20 varieties of chocolates available and Linda
wants to buy eight chocolates.
(a) [BB] How many choices does she have?
(b) How many choices does she have if her boyfriend
insists that at least one chocolate should have a
cherry center?
(c) How many choices does she have if there remain
only two chocolates with caramel centers? (At
least 20 chocolates of all other varieties are avail-
able.)
7. (a) In how many ways can five different mathemat-
ics books, three different physics books, and four
different chemistry books be arranged on a shelf?
Lim= 
-0

7.3 Repetitions 
227
(b) Repeat (a) if all books of the same subject are to be
together.
(c) [BB] Repeat (a) if three of the five mathematics
books are the same.
(d) Repeat (c) if, in addition, all the physics books are
the same.
8. [BB] In how many ways can 12 people form four groups
of three if
(a) the groups have names?
(b) the groups are unnamed?
9. In how many ways can 18 different books be given to
Tara, Danny, Shannon, and Mike so that one person has
six books, one has two books, and the other two people
have five books each?
10. (a) Twenty basketball players are going to be drafted by
the professional basketball teams in Philadelphia,
Boston, Miami, and Toronto such that each team
drafts five players. In how many ways can this be
accomplished?
(b) In how many ways can 20 players be divided into
four unnamed teams of five players each?
11. Suppose there are 12 baseball players to be drafted by
San Diego, Houston, and Toronto. If San Diego is to get
six players, Houston four players, and Toronto two, in
how many ways can this be accomplished?
12. (a) [BB] In how many ways can ten red balls, ten white
balls, and ten blue balls be placed in 60 different
boxes, at most one ball to a box?
(b) In how many ways can ten red balls, ten white
balls, and ten blue balls be placed in 60 different
boxes?
13. In how many ways can two white rooks, two black bish-
ops, eight black pawns, and eight white pawns be placed
on a prescribed 20 squares of a chess board?
14. [BB] A committee wishes to award one scholarship of
$10,000, two scholarships of $5000, and five scholar-
ships of $1000. The list of potential award winners has
been narrowed to 13 possibilities. In how many ways
can the scholarships be awarded?
15. Find the number of arrangements of the letters of each
of the following words:
(a) [BB] SCIENTIFIC
(b) SASKATOON
(c) PICCININI
(d) CINCINNATI
16. [BB] A department store in downtown Victoria, British
Columbia, has 30 flags to hang along its roof line to
celebrate Queen Victoria's birthday. If there are ten red
flags, five white flags, seven yellow flags, and eight blue
flags, how many ways can the flags be displayed in a
row?
17. In a university residence there are five single rooms, five
doubles, and five rooms which hold three students each.
In how many ways can 30 students be assigned to the
15 rooms? (All rooms are numbered.)
18. (a) Show that there is a one-to-one correspondence
between the number of ways to put ten identical
marbles into three boxes and the number of ordered
triples (x, y, z) of nonnegative integers which sat-
isfyx+y+z= 10.
(b) How many triples (x, y, z) of nonnegative integers
satisfy x + y + z = 10?
(c) How many 5-tuples (x, y, z, u, v) of nonnegative
integers satisfy x + y + z + u + v = 19?
19. (a) [BB] Show that there is a one-to-one correspon-
dence between the solutions to
(*)
XI + X2 + X3 + X4 = 21
with xi, X2, X3, X4 nonnegative integers, xl > 8, and
solutions to
( **)
Xi + X2 + X3 + X4 = 13
with xI, X2, X3, X4 nonnegative integers. How many
solutions are there?
(b) Show that there is a one-to-one correspondence bet-
ween the solutions to (*) with xi > 8, x2 > 8, and
solutions to
( ***)
xI + X2 + X3 + X4 = 5
with XI, X2, X3, X4 nonnegative integers. How many
solutions are there?
(c) How many solutions are there to (*) with all vari-
ables nonnegative integers not exceeding 7? [Hint:
Let Ai be the set of solutions to 
(*) with
xi > 8.]
(d) How many solutions (xI, x2, X3, X4) are there to the
equation
XI + X2 + X3 + X4 = 35
with all xi integers, 0 < xi < 10?
20. How many integer solutions are there to the equation
x + y + z + w = 20 subject to x > l, y > 2, z > 3, and
w > 4?

228 
Chapter 7 Permutations and Combinations
7.4 
DERANGEMENTS
There are four houses on a street. A mischievous postman arrives with one letter
addressed to each house. In how many ways can he deliver the letters, one to
each house, so that no letter arrives at the correct house? The person in charge of
coats at the arts center loses all claim checks and returns coats randomly to the
patrons. What are the chances that nobody gets their own coat?
3 
6
EXAMPLES 14
A derangement of n distinct symbols which have some natural order is a permu-
tation in which no symbol is in its correct position. The number of derangements
of n symbols is denoted D,.
.
There is just one derangement of the symbols 1, 2 (namely, 21), so D2 = 1.
.
There are two derangements of 1, 2, 3 (312 and 231), so D3 = 2.
.
There are nine derangements of 1, 2, 3, 4,
2341 
2413 
2143
3142 
3412 
3421
4123 
4312 
4321
so D4 = 9. There are nine ways our mischievous postman can deliver four
letters, each to the wrong address. 
A
Finding a general formula for D, involves a nice application of the Principle
of Inclusion-Exclusion, binomial coefficients, and a famous irrational number. We
consider again D4, the number of derangements of 1, 2, 3, 4.
Let AI be the set of permutations of 1, 2, 3, 4 in which the number I is in the
first position. Let A2 be the set of permutations of 1, 2, 3, 4 in which the number
2 is in the second position. Define A3 and A4 similarly. The set of permutations
in which at least one of the four numbers is left in its natural position is then
Al U A2 U A3 U A4 and the complement of this set consists precisely of the
derangements of 1, 2, 3, 4. Since there are 4! = 24 permutations altogether, the
number of derangements of four symbols is
D4 =4! -AI 
UA 2 UA3UA4 1.
How many elements are in the union AI U A2 U A3 U A4? By the Inclusion-
Exclusion Principle,
(I) 
IAI U A2 U A3 U A4 1 =EIA
i l -
IAi n AjI + E 
Ai n Aj nA
i 
i<j 
i<j<k
- IAI n A2 n A3 n A41.
Now IAII = 3! (1 is in the first position, numbers 2, 3, and 4 go to any of the
next three positions). Similarly, lAil = 3! for any i.
The set AI n A2 contains those permutations of 1, 2, 3, 4 in which I and 2
are in the correct positions. There are just two such permutations, 1234 and 1243.
Thus, IAi nAi I = 2! for each of the 6 = (4) terms in the second sum on the right
of equation 1.

7.4 Derangements 
229
Similar reasoning shows that each of the 4 = (4) terms IAi n Aj n Ak equals
1, as does the last term. Therefore,
[AI U A2 U A3 U A41 = 4(3!) -
(4)(2!) + (3)(1!)-1
and hence,
D4 =4! -
(4(3!) - (4)2!+ (4) !-1)
4! 
4!
-4! -4!Â± 
-2 
- -+1
2!2! 
3!
4! 
4! 
4!
44! 
4 
-+-- 
+-
2! 
3! 
4!
4!I I+ 
-I+
= 
24 ! -
+ 
-3! 
4
/24(1 -
+ 
1- I+I)
2 6 
24/
=24 -24+ 
12-4+ 1 =9.
To find a general formula for D, for general n, we mimic this calculation
of D4.
The number of derangements of n > I ordered symbols is
I 
Dn=n(- 1! + I!-3! + .
+ (-)n 
) 
l
For example,
D5 
1 1 
1 
1 
1+
D =5!(1-i!+2!-3!+ 4! 5
= 5 -5! + 5 4 3-5 4 + 5-1 = 60 -20 + 5-1 -
44.
Some readers may have encountered the number e, the base of the natural
logarithm, in a calculus course. The Taylor expansion for ex is the formula
x 
x2  
x3
(2) 
ex =1I+ - +- 
+ ---
+.
1! 2! 
3!
which, among its uses, allows us to approximate various powers of e. To approxi-
mate e itself, for instance, we evaluate the first several terms of the Taylor expan-
sion for ex with x = 1:
I 
1 
12 
2 ! 
I 
I 
I

230 
Chapter 7 Permutations and Combinations
A 
* 
g *.
Better approximations can be obtained by including more terms of the Taylor
expansion. To approximate fe, we have
ae- = e1/2 = e 5 
1 + 5 + (.5)2+ 
(.5)3
~e2
e~ 
1Â± 
21+Y 
3!
=I + .5 + .125 + .02083i 
1.646.
With x 
1, we have
l = e ] 
-
!+ 2- -
+ 
+ (_-1) 
n!
e 
1I 
2! 
3! 
n
for any n > 1.
Comparison with the formula for D, given in Proposition 7.4.2 shows that
D, 
t n!el = 'I.' 
Equivalently, DI'e 
0.368, an observation which shows
that the derangements of n symbols comprise about 36.8% of all the permuta-
tions of n symbols. This percentage can also be viewed as the probability that a
randomly selected permutation of n symbols will be a derangement. It is curious
that for any n > 5, this probability is 36.8% to one decimal place. The chance
that a postman, delivering letters randomly, will deliver six letters to six incorrect
addresses is just about the same as the chance that he will deliver 50 letters to
incorrect addresses.
Express DI as a decimal and compare with e. Do the same for D5.
10. D4 
0.375. Even for n = 4, Dn is remarkably close to
4! 
24 
n! 
makbyco 
et
5! = 
44 = .36. In fact, for n > 5, DI' = .368... agrees with l to three
5cm120 
plc 
-
decimal places.
The symbol [BB] means that an answer can be found in the Back of the Book.
1. [BB] Find D6, D7, and D8.
2. A simple code is made by permuting the letters of the
alphabet such that every letter is replaced by a different
letter. How many different codes can be made in this way?
3. [BB] Eleven books are arranged on a shelf in alphabet-
ical order by author name. In how many ways can your
little sister rearrange these books so that no book is in
its original position?
4. Fifty students take an exam. For the purposes of grading,
the teacher asks the students to exchange papers so that
no one marks his or her own paper. In how many ways
can this be accomplished?
] Students who have studied Taylor polynomials should quickly observe that the error in approximating
D, by !e is less than n+l
STIA ME= -
-
__ -
-
-
-
-

7.5 The Binomial Theorem 
231
5. Your letter carrier has a drinking problem. When she
delivers letters to the seven houses in your block, she
delivers completely at random. Suppose she has seven
letters, one addressed to each house, and she delivers
one letter to each house. In how many ways can this be
accomplished if
(a)
(b)
(c)
no letter arrives at the right house?
[BB] at least one letter arrives at the right house?
all letters arrive at the right house?
6. Twenty people check their hats at a theater. In how many
ways can their hats be returned so that
(a) no one receives his or her own hat?
(b) at least one person receives his or her own hat?
(c) [BB] exactly one person receives his or her own
hat?
(d) at least two people receive their own hats?
(e) at most two people receive their own hats?
7. (a) [BB] In how many ways can the integers 1 through
9 be permuted such that no odd integer will be in
its natural position?
(b) In how many ways can the integers I through 9 be
permuted such that no even integer is in its natural
position?
(c) In how many ways can the integers I through 9 be
permuted such that exactly four of the nine integers
are in their natural positions?
8. Without any calculation, prove that
n! = D, + (n)Dn l+ (;)D,,-2
( 
1.
9. Prove Proposition 7.4.2.
10. (a) [BB] Prove that D, 
(-I)n (mod n).
(b) [BB] Prove that Dn is even if and only if n is odd.
11. (a) [BB] Prove that Dn = (n -)(D,_1 
+ D,-2) for
all n > 3.
(b) Prove that Dn = nDn-, I 
(-l)n for all n > 2.
(c) Use (b) to find Dn and DI' to six decimal places for
n = 1, 2, 3, .
10. What is the approximation to
l to six decimal places?
12. While the concept of a derangement of zero objects is
rather dubious, the formula for Dn given by Proposi-
tion 7.4.2 does make sense for n = 0 and gives Do = 1.
Taking Do = 1, show that the generating function for
the sequence DI, DI , D, 
. . is l-x
0!i- 
1i 2 
T _
7.5 
THE BINOMIAL THEOREM
The arrangement of integers in Fig 7.3 is named after Blaise Pascal (1623-1662)
because of the many applications in combinatorics and probability which Pascal
found for it.2 Each row begins and ends with a 1; each other number in a row
sits between two consecutive numbers in the row above it and is the sum of these
two. For example, 10 = 4 + 6, 6 = 1 + 5 and 21 = 15 + 6, as shown in the
figure.
This famous triangle has many fascinating properties. For example, if we
number the rows starting at zero and interpret each row as the "digits" of a single
number written in base 10,3 then row k of the triangle is I Ik. For example, row
zero is 1 = 110, row one is 11 = 111, row two is 121 = 112, row three is
1331 = 113 , and row five is
1(105) + 5(104) + 10(103) + 10(102) + 5(10') + 1(10Â°) = 115,
and so on.
2The triangle itself was known in India as early as the third century B.C.
31n this context, by the "digits" of a number, we mean the coefficients required to write the number as
a linear combination of powers of 10.

232 
Chapter 7 Permutations and Combinations
I
1 
I
1 
2 
1
1 
3 
3 
1
1 
4X 
4 
l
1 
5 
10 
10 
5
l 
6 
15 
20 
15 
6
1 
7 
21 
35 
35 
i
Figure 7.3 
Pascal's triangle.
If, beginning at each initial 1, we follow
the diagonal pattern suggested by the figure
to the right, adding alternate numbers along
the way (at the positions denoted .), we dis-
cover the terms of the Fibonacci sequence.
For example, after two l's, we obtain the
sums I + 1 = 2, 1 + 2 = 3, 1 + 3 + 1 =
I + 5 + 6 + 1 = 13, and so on.
21
1+1=2
1 
1
2 
3 3 1
1+2=3
1.
5 (see Fig 7.4), 1 + 4 + 3 = 8,
1 
1
I120d
1 
0 
3l
d14 6341
1+3+1=5
Figure 7.4 
The Fibonacci sequence, hidden within Pascal's triangle.
Our major interest in Pascal's triangle concerns its connection with the expan-
sion of (x + y)f, for the numbers in row n of the triangle give the requisite coef-
ficients. As shown in the following equations, which we number starting with 0,
the coefficients needed to expand (x + y)0 are in row 0. In row 1, we see the
coefficients needed to expand (x + y) 1; in row 2, the coefficients needed to expand
(x + y)2; and so forth.
(x + y)0 = 1
(x+y)1 =X+y= x+ ly
(x + y) 2 = X2+ 2xy +Y2 = 
x 2 + 2xy+ +2
1
7

7.5 The Binomial Theorem 
233
(x + y)3  
x3 + 3x 2y + 3xy2 + y3 = 1x3 + 3x 2y + 3xy2 + 1y3
4 
4 
3 
22 
3 
4
(x + y) =x + 4xy+6xy2 +4xy 3 +y 4
=1x + 4x3y + 6x2y2 + 4xy3 + 1y4
How might we obtain the expansion of (x + y) 1 ? We could continue to build
Pascal's triangle as far as row 11, but it would be better to observe that the numbers
in Pascal's triangle are just the values of the binomial coefficients (k). Figure 7.5
shows Pascal's triangle again, but in terms of these combinatorial symbols.
(o)
(o) 
(I)
(2) 
(C) 
(2)
(3) 
(3s) 
(1) 
(3)
(4) 
(4) 
(4) 
(4) 
(4)
(o0) 
(1) 
(12) 
(13) 
(14) 
(5s)
(6) 
7(6) 
(6) 
(6) 
(6) 
(6) 
(6)
(7) 
(7) 
(G) 
(7) 
(7) 
(7) 
(7) 
(7)
Figure 7.5 
A useful presentation of Pascal's triangle.
Note that (') = (') = n, = 1 because 0! = 1, so each row begins and ends
with a 1 as it should. The reader is encouraged to evaluate all the symbols in
this second presentation of Pascal's triangle in order to verify that they do indeed
agree with the numbers in Fig 7.3. A proof that this correspondence extends to
further rows of the triangle depends upon the identity
(3) 
(n) 
(n-1) 
(n-
(the proof of which was Exercise 25, Section 7.2) and is left to the exercises.
The advantage in identifying the entries of the triangle as the symbols (') should
be apparent: Any particular row can be obtained without first constructing all the
rows above it. Row 11, for instance, which gives the coefficients needed to expand
(x + y) 1, is
d 
( 1n 
a 
), 
(r2s)e (v3e), 
c 
ns 
(of)h 
(11t )
and these numbers are, respectively, the coefficients of the terms
X I, 
X '0)y 
,x
9y2, 
XY..... 
Xy
Y.

234 
Chapter 7 Permutations and Combinations
1:1  :11 rs L'AI TÂ±IU
B-
Notice that each of these terms is of the form xiy1 , that the sum i + j of the
exponents is always II, and that the exponent of x decreases one at a time from
11 to 0 as the exponent of y increases from 0 to 11.
For any x and y and any natural number n,
(x + y)n 
(k)xn kYk
xn + ()Xnly 
+ ()Xn2y2 
+ .. 
+ (n 
)XYn1 
+ Yn.
It is, of course, from this theorem that binomial coefficients take their name.
While the Binomial Theorem can be proven by mathematical induction, there
is a different argument which explains why the binomial coefficients ('n) are
involved. Computing (x + y)2 from first principles, we obtain
(x + y)2 = (x + y)(x + y)
= x(x + y) + y(x + y)
2 
2
=xx+xy+yx+yy=x +2xy+y
Computing (x + y)3 the same way, we have
(x+y)3 = (x+y)(x+y)(x+y)
= (x + y)(xx + xy + yx + yy)
= xxx + xxy + xyx + xyy + yxx + yxy + yyx + yyy
=x
3 +3x
2 y+3xy 2 + y 3 .
In the third line of this expansion, each of the 8 = 23 terms xxx, xxy, and so
on, corresponds to the selection of an x or a y from each of the original three
factors x + y. Since xxx arises only when an x is selected from each factor,
there is just one x3 term in the final expansion. The coefficient of x2 y in the
final expansion is 3 because there are three terms involving two x's and one
y; namely, xxy, xyx, and yxx. The reason why there are three terms is that
there are three ways to select one y (and hence two x's) from the three factors
x + y.
In the full expansion of (x + y)n, before any simplification and before like
terms are collected, there are 2n terms. Each such term is a string of x's and
y's, n symbols in all, and corresponds to a selection of x or y from each of the
n factors x + y. Any term containing k y's (and hence n -k 
x's) simplifies to
xn-kY k The eventual coefficient of Xn-kyk is the number of terms which simplify
to x -kYk, 
this number being (n) because there are (n) ways to select k factors
for the y's.
We conclude this section with a sampling of problems which can be solved
using the Binomial Theorem.

7.5 The Binomial Theorem 
235
PROBLEM 15. 
Using the Binomial Theorem, expand (3x2+2y)5 and simplify.
Solution.
(3X2 + 2y)5 = (3X 2)5 + (5)(3X2)4(2y) + (;)(3X2)3(2y)2
+ (5)(3X2)2(2y)3 + (5)(3X2)(2y)4 + (2y) 5
63244
= 243x 0Â± + 5(81x 8 )(2y) + 10(27x6)(4y') + 10(9x4)(8y )
+ 5(3x2)(16y4 ) + 32y5
= 243xlo + 810x8y + 1080x6y2 + 720x4y3 + 240x2y4 + 32y' I
PROBLEM 16. 
Using the Binomial Theorem, expand (x -)6 
and simplify.
Solution.
(x -
)6 
x6 + (6)Xs (_ 4) + (6)X4 (-4 ) + (6)x3 (-4)
+ (4)X2 ( 4)4 + (6)x (_ 4) 
+ (_ 4)6
x6 + 6x 5(_4) + 15x4(12) + 20x3 (6) 
+ 15X2(256)
( 1024 
4096
( 6 
-X5 ) 
x6
24 
2 
3840 
6144 
4096
x6 -24x 
+240x -1280+ x 
+ 
x6
2 x 
12.
PROBLEM 17. 
Find the coefficient of x16 in the expansion of (2x2 -
2
Solution. 
The general term in the expansion of this expression by the Binomial
Theorem is
(12)(2X2)12k k(_X)k -
12 )212k (_ 
k '
2 4 -
(k )(2 
) 
(k ) 
(2)
We want 24 -k 
= 16; thus, k = 8. The coefficient is (18)24(- )8 = 
6c 2) =
495 
I
.. .. . .. .. .. ..
.... ... ... .... 
... ..
PROBLEM 18. 
Prove that (n) + (n) + (2) +. 
+ (n) = 2' for all natural
numbers n.

236 
Chapter 7 Permutations and Combinations
Solution. 
Consider (x + y)f = E('1 
xnk k k Setting x =
n 
+
(11 
_~ (n) Ink 
ik ; that is, 2n 
as desired.
The symbol [BB] means that an answer can be found in the Back of the Book.
1. [BB] For each of the following, expand using the Bino-
mial Theorem and simplify.
(a) (x + y)6
(b) (2x + 3y)6
2. Use the Binomial Theorem to expand (a+4b)5 . Simplify
your answer.
3. For each of the following, expand using the Binomial
Theorem and simplify.
(a) (2x3 - y2)8
(b) [BB] (2x3 - x2)8
(c) (2x 
X2)
4. [BB] Find the fourth term in the binomial expansion of
(x3- 2y2)12.
5. Consider the binomial expansion of (x + y)2 0 .
(a)
(b)
(c)
(d)
What are the first three terms?
What are the last three terms?
[BB] What is the seventh term? The fifteenth term?
What is the coefficient of x1 3y7 ?
6. [BB] Consider the binomial expansion of (2x - y) 6
(a)
(b)
How many terms are there altogether?
Is there a middle term or are there two middle terms?
Find and explain.
7. Consider the binomial expansion of (x + 3y) 7.
(a)
(b)
How many terms are there altogether?
Is there a middle term or are there two middle terms?
Find and explain.
8. [BB] Find the coefficient of x3 y7 in the binomial expan-
sion of (4x + 5y) l 0 .
9. [BB] Find the coefficient of the term containing y' in
the binomial expansion of (x + 3y2 )17.
10. What is the coefficient of x5 in the binomial expansion
of (x -2x-2)20?
11. [BB] What is the coefficient of x 27 in the binomial
expansion of (- + x2) ?
12. Find the coefficient of X25 in the binomial expansion of
(2x 
3 )58
x-2
13. Prove that 4n > n4 for all integers n > 5.
14. Sequences of integers, {xj, {y,,}, n > 0, are defined by
(1 + 
)n = x,, + Y 
2
(a) [BB] Find the first three terms and the fifth term of
each sequence.
(b) Find formulas for x, and y,
(c) Without using the result of (b), establish the recur-
sion formulas
Xn+1 = x,/ + 2y
Yn +I = Xn + Yn
for n > 0.
15. (For students who have studied calculus) In Problem 8
on p. 14, we proved that X2 is irrational, that is, not
the quotient of integers. In this exercise, we give an
alternative proof using the binomial theorem.
(a) If n is an integer, show that there exist integers Xn
and Yn, depending on n, such that (v/ 
- I)n =
Xn + ynN'2.
(b) Explain why limn~o(/2 -I)n = 0.
(c) Suppose that X2 is rational and show that (a) and
(b) lead to a contradiction.
= 1, we obtain
I

Review Exercises 
237
16. [BB] At the beginning of this section, we said that the
numbers in row n of Pascal's triangle, interpreted as the
"digits' of a single number in base 10, give the integer
I l". Prove this.
17. Suppose that we construct Pascal's triangle as described
at the beginning of this section. Prove that the entries of
row n are (t), (,), (n), .
(). 
[Hint: Identity (3).]
18. Prove the Binomial Theorem by mathematical induction.
[Hint: Identity (3) will be useful.]
19. (a) Show that ,k'=2 (2) = (') and interpret this result
with reference to Pascal's triangle.
(b) Show that ,n7 
r (k) = (",1) for any r and n, I <
r < n, and interpret with reference to Pascal's tri-
angle.
20. [BB] Show that (n) -(n) 
+ (n) 
+ (- )n (n) -
0
for all natural numbers n.
21. (a) By direct calculation, show that 34 -
1 + 2(t) +
4(4) + 8(4) + 16.
(b) Find a simple expression for (`)+2(`)+4(`)+.+
2" (') valid for all natural numbers n and prove your
answer.
22. (a) [BB] Find a simple expression for T'.1 k(7) and
prove your answer.
(b) Find a simple expression for Y"., k2(n ) and prove
your answer.
[Hint: In both of these questions, to begin, it may prove
helpful to evaluate the sum for small values of n.]
23. Consider the Fibonacci sequence ao, al, a2, .. , where
a( = al = I and, for n > 1, an+1 = a. + a,, 1. Express
a,, for n > I as the sum of certain binomial coeffi-
cients and prove your answer. [Hint: See remarks at the
beginning of this section.]
S 
5 
A
1. In how many ways can seven boys and six girls stand
in a row if the girls are to stand together but the boys
must not stand together?
2. Do Exercise I again with "circle" instead of "row."
3. How many permutations of the letters a, b, c, d, e, f
contain at least one of the patterns aeb and bcf?
4. Find an expression for the number of five-card poker
hands which contain exactly three kings.
5. A committee of seven is to be chosen from eight men
and nine women.
(a) How many such committees contain at least six
women?
(b) How many such committees contain either Bob or
Alice but not both?
6. A Middle East peace conference will be attended by
five Arab countries, four Western countries, and Israel.
Each delegation will sit together at a round table sub-
ject only to the requirement that no Arab delegation be
seated next to the Israeli delegation. How many seating
arrangements are possible?
7. Frank wants to buy 12 muffins and finds seven different
types available. In how many ways can he make his
selection?
8. In how many ways can the letters of the word
NUNAVUT be rearranged?
9. Find the coefficient of x5 in the binomial expansion of
(x -2x-2)20. 
Do not simplify.
10. Find the coefficient of x-6 in (16x2-2- 
2 Simplify
your answer.
11. (a) Give a verbal argument for the truth of the identity
(/Z) (/21) 
(/-1)
CD-( = DÂ±(" k).
(b) If n > k +2 and k > 2, show that (n) - (n- 2)- (2-)
is even.
12. Find a simple expression for 3' - (/)3/l+ ... +
( lk (7n)3"-k + 
+ ( 1)".

* 
' *SE
D. 0. .Â¢ 
-
* 
f:, 
pJ
,, ,Algorithms
1 
.
.WHAT 
IS AN ALGORITHM?
Computers! Computers! Computers! Are they the bane of our existence or the
most important invention since the discovery of the wheel? Certainly there is no
denying that computers have changed almost every aspect of our lives. They are
used by stockbrokers to track the performance of stocks and to provide guidance
as to which should be bought and sold. Much of the blame for the October 1987
North American stock market crash was attributed to computers all giving the
same "sell" advice at the same time. Nowadays, virtually every company puts
personal computers on the desks of their employees, in the belief that computers
both increase productivity and cut revenue losses. Upon discovery of a potential
flaw in some part, a car manufacturer is able almost instantly to produce a list
of the names and addresses of all the people across North America who have
purchased a car containing that particular part. The list of computer applications
is literally endless. But what is a computer?
A computer is fundamentally just a box containing wires and chips (these
being tiny circuits built onto small boards) all cleverly put together so that the
machine can follow instructions given to it. The box of wires and chips, and
peripheral items such as monitor and keyboard, are called hardware; the instruc-
tions fed to the machine are called software. Computer programming involves writ-
ing software that allows a machine to perform various tasks which, by hand, would
be tedious or so time consuming as to be essentially impossible to do. Machines
work incredibly quickly, never get tired, and are excellent at following orders;
however, they will only perform as well as the instructions presented to them.
One of the oldest adages in the computer business is "Garbage in 
garbage out!".
There are two parts to a computer program. There is the process or sequence
of steps which is necessary to complete the given task and the translation of this
process into a language which the computer can understand. In this chapter, we
explore the first of these ideas, asking the reader to think about the process or
algorithm by which familiar tasks are accomplished.
239

240 Chapter 8 Algorithms
The word "algorithm" evolved from the older word "algorism" which is a
corruption of the surname of a ninth-century Persian, Abu Ja'far Muhammad
ibn Misa al-Khwarizmi, who wrote an important book setting forth rules for
performing arithmetic with the arabic numerals 1, 2, 3 ... we use today.' While
the older term "algorism" referred primarily to arithmetical rules, "algorithm"
today is used in a more general sense as a virtual synonym for "procedure." Its
ingredients are an input, an output, and a sequence of precise steps for converting
the input to the output. In Chapter 4, we studied the Euclidean algorithm which,
upon input of positive integers a and b, outputs the greatest common divisor of
a and b through a precise series of steps.
As children, after learning the addition rules for single-digit numbers, we were
taught a procedure for adding numbers with any number of digits; upon input of
two arbitrary integers, the procedure outputs their sum.
1 2 
3 
4
5 
61 
71 
8
6 
9 
1 
2
We memorized multiplication tables for single-digit numbers and then were taught
a procedure which, upon input of two arbitrary numbers, outputs their product.
Folklore has it that Russian peasants have an instinctive and flawless ability
to multiply and divide by the number 2 and are able to use this successfully
to multiply any two numbers. For example, they would compute 211 x 453 by
the scheme shown in Fig 8.1. Each number on the left is the quotient when the
number above it is divided by 2;2 the numbers on the right are the product of 2
and the number above. After reaching I in the left column, the rows containing
even numbers on the left are crossed out. The desired product is then the sum of
the numbers which remain uncrossed on the right!
211 
x 
453
105 
906
52 
1812
- 26 
3624
13 
7248
6 
14496
3 
28992
1 
57984
95583
Figure 8.1 
The Russian peasant method of multiplication.
Before the days of pocket calculators, school children were taught a procedure
for finding the square root of a number. To find the square root of 2, for instance,
a student was taught to produce the pattern shown in Fig 8.2. First, we find the
Interestingly, the word "algebra" derives from the Latin title of this hook, Ludus algebrae et anMuc-
grabalueque.
2Remember that when a natural number a is divided by another natural number h, the quotient is the
integer part of the fraction " . See Section 4.1.

8.1 What Is an Algorithm? 
241
largest integer whose square is less than 2 and write this number, 1, in the two
places shown. The product of I and 1 is 1 and 2- 1 = 1. Write down 1 followed
by two O's. Next, we double the number on top, giving 2, and search for the largest
integer x such that x x 2x does not exceed 100. We have x = 4, 4 x 24 = 96, and
100 - 96 = 4, as shown. Follow this 4 by another two O's, double the number on
top, giving 28, and search for the largest single digit x such that x x 28x does not
exceed 400. We have x = 1, I x 281 = 281, and 400-281 = 119, and so forth.
Whether or not you understand this scheme is much less important today than it
was formerly. We mention it here not just as a historical curiosity, but as another
example of an arithmetic algorithm, one which allows the computation of square
roots to any degree of accuracy.
l. 
4 
1 
4 
2
1
24
281
2824
28282
2. 
0 010 0 
0 
0 
0 
0
1
1 0 0
9 
6
4 0 
0
2 
8 
1
1 1 9 
0 0
1 1 2 
9 
6
6 0 
4 0 0
5 
6 
5 
6 4
3 
8 3 
6
Figure 8.2 
Part of an algorithm for determining VA.
In a course on Euclidean geometry, we learn a vast number of geometric
algorithms usually called constructions. To bisect an angle with vertex A, for
instance, we draw an arc with center A. If B and C are the points where this arc
meets the arms of the angle, we then draw arcs with centers B and C and some
suitably large radius (for example, the length of AB). If these arcs meet at the
point P, then AP is the bisector of the angle at A. (See Fig 8.3.)
A 
C
Figure 8.3 
Bisection of the angle at A.
In high school and college, students learn algorithms for multiplying poly-
nomials, for multiplying matrices, for solving systems of linear equations, for
differentiating polynomials; the list goes on. In the rest of this chapter, we dis-
cuss important algorithms the reader may not have seen before and their relative
strengths and weaknesses. Since this is not a text in computer programming, our

242 
Chapter 8 Algorithms
description of algorithms is mostly in ordinary English, subject only to the require-
ments of clarity and precision: It should always be clear to a programmer how to
implement any of our algorithms in his or her favorite language.
PROBLEM 1. Describe an algorithm whose input is a list al, a2, ... 
, a, of
integers and whose output is their sum.
Solution. 
This question requires us to confront what an expression like 5 + 17 +
3 + 6 + 4 really means. How do the basic rules for addition of two numbers
extend to permit the addition of several numbers? Most people would calculate
5 + 17 + 3 + 6 + 4 by adding from the left, like this:
{[(5+17)+31]+6}+4=[(22+3)+6]+4= (25+6)+4=31 +4=35.
This approach is the idea behind our algorithm.
To find the sum of n integers al, a2, 
an,
Step 1. set S = 0;
Step 2. for i = I to n, replace S by S + ai;
Step 3. output S.
The value of S output at Step 3 is the desired sum. 
I
Step 2 calls for a loop, a feature of every programming language. Whenever
we write "for i = I to n" as part of an algorithm, we mean
.
set i = I and execute the indicated statement (or statements);
.
increase the value of i by 1 and, if i < n, execute the indicated statementss;
.
continue to increase the value of i by I and, as long as i < n, execute the
indicated statementss;
.
if the stage i > n is reached, skip to the next step.
The variable i which is used in this process is called a counter. For example,
with al, a2, a3, a4, a5, respectively, equal to 5, 17, 3, 6, 4, the preceding algorithm
begins by setting S = 0. At Step 2, the counter i is set equal to I and S is
replaced by S + al = 0 + 5 = 5. Then i is set equal to 2 and S is replaced by
S + a2 = 5 + 17 = 22. Continuing, S is replaced by S + a3 = 22 + 3 = 25, then
by S + a4 = 25 + 6 = 31 and, finally, by S + a5 = 31 + 4 = 35. Then i is set
equal to 6, at which point the algorithm skips to Step 3 and outputs S = 35, the
sum of al, ... , a5s
PROBLEM 2. 
(Polynomial evaluation) Describe an algorithm which, upon input
of n + I integers ao, a I, a2, . . . , an and an integer x, outputs the integer ao + a I x +
a2x2 + 
+ anxn.
Solution. 
Perhaps the most obvious approach to this problem is first to compute
the powers of x from x to xn and then to evaluate the expression ao + aIxA +
a2x2 + ... + a,1xn term by term.

8.1 What Is an Algorithm? 
243
Given integers ao, a . , 
a, and an integer x, to compute the number ao +
ajx + a2x2 + 
+ anxn,
Step 1. set P 
1;
Step 2. for i = 1 to n, replace P by Px, call this element xi and store (note that
Xi = x' );
Step 3. set S =ao;
Step 4. for i = 1to n, replace S by S + aixi;
Step 5. output S.
The value of S output at Step 5 is the desired integer ao+alx+a2x2  
+anxn.
EXAMPLE 3 
To evaluate the polynomial f (x) =-1 
+ 2x + 4X2 - 3x 3 at x = 5, the algorithm
takes as input ao = -1, a, = 2, a2 = 4, a3 = -3 and x = 5 and proceeds as
follows.
Step 1. P = 1;
Step 2. i = 1: replace P by Px = 1(5) = 5 (P is now 5) and let xl = 5;
i = 2: replace P by Px = 5(5) = 25 (now P = 25) and let x2 = 25;
i = 3: replace P by Px = 25(5) = 125 (now P = 125) and let X3 = 125.
Since i = n = 3, Step 2 is complete.
Step3.S=ao=- 1;
Step 4. i 
1: replace S by S + aIxI =-I 
+ 2(5) 
9 (now S = 9);
i =2: replace S by S + a2x2 = 9 + 4(25)= 109 (now S = 109);
i 
3: replace S by S + a3x3 = 109-3(125) = -266 (now S = -266).
Since i = n = 3, Step 4 is complete.
Step 5. Output S =-266. 
A
There is a much more efficient way to evaluate a polynomial, more effi-
cient in the sense that it requires fewer arithmetical operations and fewer stor-
age requirements. It is based upon the observation, due to William Horner, an
eighteenth-century English school headmaster, that
ao + alx + a2x 2+ 
+ a-x" = ao + (al + a2x + a3x2 + 
+ anx -I)x
= ao + (al + (a2 + a3x + 
+ anxn 2)X)X
-
I 
TIl 
1 
I 
tl 
T' 
I 
T 
n-i I -n- 
/ 
.
Given integers ao, al, . . ., an and an integer x, to evaluate the expression ao +
_ - , ___2 , .
-
.
_,,n
U1A t U2A 
t- ' ' ' t 
nA,

244 
Chapter 8 Algorithms
EXAMPLE 4
Step 1. set S = a,;
Step 2. for i = I to n, replace S by an-i + Sx;
Step 3. output S.
The final value of S is the desired number ao + aIx + a2x2 + 
.
Â±+ a,,xn.
We apply Horner's method to the same polynomial considered in Example 3,
f (x) =-1 + 2x + 4x 2 - 3x3, and again with x = 5.
Step 1. set S = a3 = -3.
Step 2. i = 1: replace S by a2 + Sx = 4-3(5) = -1I (now S = -I1);
i = 2: replace S by al + Sx = 2 -11(5) 
= -53 (now S = -53);
i = 3: replace S by ao + Sx = 
1 - 53(5) =-266 (now S =-266).
Since i = n = 3, Step 2 is complete.
Step 3. output S = -266.
A
A 
* 
* *. 
-
Show the successive values of S when Homer's method is used to evaluate the
polynomial f (x) = 4x 3 - 2x + 1 at x = -2.
Many of the uses to which modern-day computers are put do not involve
arithmetical calculations but take advantage of a machine's ability to perform
certain logical operations. Of these, the most fundamental is its ability to compare,
that is, to decide if two elements are equal. The next two sections are devoted to
such important nonarithmetical procedures as searching, sorting, and enumerating
permutations. We conclude this section with one example of an algorithm in which
comparison is the basic operation.
PROBLEM 5. 
Given a "small" list, it is easy for a person to note the distinct
items it contains. The distinct items in abc, dbc, abc, xbc, dbc are, of course, abc,
dbc, and xbc. To record the distinct items in a list of a thousand or more items
would be an almost intolerable task for most people, but it is a simple matter
for a computer. Describe an algorithm which, upon input of a list al, a2, .
,
outputs the distinct items in this list.
Solution. 
The idea is straightforward. We compare each element in the list with
those preceding it and, if it is different from all its predecessors, output it.
Step 1. output al;
Step 2. 
if n = 1, stop;
else for i = 2 to n,
if at does not equal any of al, a2, 
a. - I , output al.
The algorithm outputs the distinct items among al, a2, 
an.
1. We have n = 3, ao = 1, a, =-2, 
a2 = 0 and a3 = 4. The first value of S
is S = 4. Then S = 0 + 4(-2) =-8, 
S = -2- 
8(-2) = 14 and, finally,
S = I + 14(-2) = -27.
M

8.1 What Is an Algorithm? 
245
The symbol [BB] means that an answer can be fund in the Back of the Book.
In the first three exercises, ruler means an unmarked straight edge and compass means an instrument which allows the
describing of circles or arcs thereof:
1. [BB] Describe a procedure for finding the mid-point of a
line segment, with only ruler and compass, and explain
why your procedure works.
2. Given a line e in the plane and a point P not on e,
describe a ruler and compass procedure for constructing
the line through P parallel to f, and explain why your
procedure works.
3. Given a point P and a line e, describe a ruler and com-
pass procedure for constructing the line through P per-
pendicular to f in each of the following cases. In each
case, explain why your procedure works.
(a) [BB] P is not on e.
(b) P is on f.
4. Find each of the following products by the Russian peas-
ant method.
(a) 168 x 413
(b) 461 x 973
(c) 141 x 141
5. [BB] Explain why the Russian peasant method works.
6. Find the square roots of 3, 12, and 153, to four decimal
places of accuracy, by the method used to compute 
X
in the text and illustrated in Fig 8.2.
7. [BB] Describe an algorithm which, upon input of n real
numbers, outputs their average.
8. [BB] Describe an algorithm which, upon input of n real
numbers, outputs the maximum of these numbers.
9. Describe an algorithm which, upon input of n real
numbers, ai, a2, .. ., a,, and another 
number, 
x,
determines how many items in the list are equal
to x.
10. Describe an algorithm which, given n real numbers,
al2,a 
.. , an, outputs the number of as which lie in
the range 85-90, inclusive.
11. [BB] Given an ordered list al < a2 < ... < a, of real
numbers and a real number x, describe an algorithm
which inserts x into its correct position in the list and
outputs the ordered list of n + I numbers.
12. Describe an algorithm which, upon input of integers a
and b and a natural number n, outputs all solutions of
ax -- b (mod n) in the range 0 < x < a, if there
are 
solutions, 
and 
otherwise 
outputs 
the 
words
no solution.
13. [BB] Let n be a given natural number. Find an algorithm
for writing an integer a in the form
a =an! + a,_1 (n -)! 
+ 
+ a22! + al
with 0 - as < i for i = 1, 2, . .. n-1. 
[Hint: Mod-
ify the procedure for converting from base 10 to base b
described in Section 4.1.]
14. Describe an algorithm which, upon input of a number n
given in base 10, outputs the digits of n (from right to
left).
15. [BB] Describe an algorithm which, upon input of n dis-
tinct symbols al, a2, . .
a,, outputs all the subsets of
{al, a2, . .. 
an }. [Hint: One way to do this is to recog-
nize that the subsets of (al, a2, . . ., a,,} are in one-to-
one correspondence with the binary representations of
the numbers between 0 and 2Y 
I .]
16. For each polynomial f(x) and each value of x, list in
order the successive values S which occur in the calcu-
lation of f(x) by
i. the algorithm described in Problem 2;
ii. Horner's algorithm.
Show your calculations.
(a) [BB]
(b) f (x)
(c) f (x)
(d) f (x)
f(x) = 2x2 -
3x + 1; x = 2
= 3x 2 + 1; x = 5
=-4x
3 + 6x2 + 5x -4; x =-1
= 17x - 40x 3 + 16x -7; x = 3
17. [BB] Explain why Horner's algorithm works.
18. Describe an algorithm which upon input of a natural
number n outputs the set of primes in the range I-n.
[Hint: Use the Sieve of Eratosthenes and take advantage
of Lemma 4.3.4.]
19. Cite examples of five algorithms not mentioned in this
text which you learned after leaving high school.

246 
Chapter 8 Algorithms
8.2 
COMPLEXITY
Suppose that two mathematicians working in the research department of a large
corporation are given a problem to solve. Each of these people has a solid back-
ground in discrete mathematics and so has no difficulty in finding a suitable
algorithm, but the two algorithms obtained are very different. When implemented
on a computer, one of the algorithms took far less time to produce an answer
than the other. The head of the research department is pleased that an efficient
algorithm was discovered, but also concerned because of the huge amount of
computer time wasted running the inefficient algorithm. Is it possible to estimate
the amount of time an algorithm will require before actually implementing it? The
answer is yes, and we shall begin to see why in this section.
Just like a person, a computer requires a certain amount of time to carry
out an arithmetical operation, a multiplication or an addition, for instance. So
we can estimate the time an algorithm requires by calculating the number of
arithmetical operations it involves. This is at best only approximate, of course,
because different operations may well require different amounts of time.
EXAMPLE 6 
In order to determine the distance between two points (Xl, X2, . . ., xn) and
(Yl, Y2, .
y,) in n-dimensional Euclidean space, we must calculate the number
WX -yl) 2 Â±+(X2 -Y2)
2 + 
+ (Xn -yn)
2 -
If n = 2, this requires two subtractions, two squarings, one addition, and one
square root, six operations in all. (While we might expect multiplication and
especially the square root operation to be more time consuming than addition
and subtraction, we ignore this potential complication for now.) If n = 3, nine
operations are required; if n = 4, 12 operations are required, and so on. In
general, the number of operations in the n-dimensional case is 3n. As is typical,
the number of operations depends on the size of the input, in this case, the 2n
numbers xl, . ..X, n, YI, .* *, nA
There are other measures of the efficiency of algorithms in addition to time.
For instance, different algorithms require different amounts of space to hold num-
bers in memory for later use; the less space required the better. We shall, however,
concentrate entirely upon time estimates of efficiency, as measured by operation
counts.
Often, and particularly in the graph theoretical algorithms which we will study
in later chapters, it is uncertain exactly how many operations will be needed. Our
approach will be to seek upper bound, also called worst-case, estimates of the
number of operations which we know will never be exceeded.
In general, for a given algorithm, we try to find the complexity func-
tion f: N -Ã· N, where, for some measure n of the size of the input, f(n) is
an upper bound for the number of operations required to carry out the algorithm.
In the distance algorithm described in Example 6, it is logical to let n be the
dimension of the Euclidean space; then f (n) = 3n. As we shall see, it is unusual
to have such an exact count for the number of operations.
We have noted that estimating the running time of an algorithm by estimating
the number of operations required is an inherently inexact process because it

8.2 Complexity 
247
cannot be expected that all operations-addition, multiplication, square root-
require equal amounts of time. There is yet another difficulty. The time required
to perform the basic operations of arithmetic depends on the size of the integers
involved. Clearly it takes more time to add or multiply two 50-digit numbers
than it does to add or multiply two three-digit numbers. The following problem
indicates that it is possible to account for this additional complication.
PROBLEM 7. 
Find the complexity function for adding two i-digit integers if
the basic operation is addition of single-digit integers.
Solution. 
Suppose the integers to be added are a = (a,-Ia,-2 ... alao)lo and
b = (bn I b0-2 . . .bI bo) Io, expressed in base 10 using the notation of Section 4.1.
The units digit of a is ao and the units digit of b is bo; the tens digit of a is al
and the tens digit of b is bl, and so forth. The units digit of a + b is obtained
by adding ao and bo, a single operation. To obtain the tens digit, we add a and
bl; then, perhaps, we add 1, depending on whether or not there is a carry from
the previous step. Hence, at most two single-digit additions (two operations) are
required for the tens digit of a + b. Similarly, at most two operations are required
for each digit of a + b after the units digit. An upper bound for the number of
operations is f (n) 
1 + 2(n -
1) 
2n - 1. 
I
In this problem, and typical of most complexity problems, we were unable to
obtain an exact count for the number of single-digit additions required. Remember
that for us, complexity is measured in worst-case terms. The addition of two n-digit
numbers requires at most 2n -
1 single-digit additions.
Because of the approximate nature of operation counts, it is useful to have
some notation by which we can easily suggest the size of a function.
Let f and g be functions N -* 
R. We say that f is Big Oh of g and write f = ((g)
if there is an integer no and a positive real number c such that If(n)I < clg(n)I
for all n >no.3
1. Instead of saying "There exists an integer no such that If(n)l I 
c lg(n)I for
all n > no, we often say simply "If(n)I < clg(n)I for sufficiently large nl."
2. If f, g: N 
R are functions which count operations or, more generally, as
long as f (n) and g(n) are positive for sufficiently large n, then the abso-
lute value symbols around f (n) and g(n) in Definition 8.2.1 are not neces-
sary. Whenever we apply this definition without absolute value symbols, it
will be because the functions in question are either positive or positive for
large n.
Let f (n) = 15n3 and g(n) = n3. With no = 1 and c = 15, we see that f
0(g). 
A
It is also true that g = 0(f). Why?
3There is also a Little Oh notation, which we do not introduce since f(n) = o(g(n)) is the same as
f(n) -< g(n), notation which we prefer. See Definition 8.2.4.
EXAMPLE 8
NM
1=

248 
Chapter 8 Algorithms
EXAMPLE 9
uD30
Let f(n) = n + I and g(n) = n2. If n > 1, f(n) < n + n = 2n < 2n2. Taking
no = 1 and c = 2, we see that f = 0(g). On the other hand, g ? 0(f), for
suppose that n2 < c(n + 1) eventually, that is, for all n greater than or equal to
some number no. Dividing by n, we have n < c(l + 1 ) < 2c for all n > no. This,
however, is impossible because 2c is a constant. 
A
Two fundamental properties of Big Oh are summarized in the next proposition.
Let f, g, fi, gI be functions N -- * R.
(a) If f = C(g), then f + g = 0(g).
(b) If f = 0(fl) 
and g = 0(gl), then fg = 0(flgl).
Proof 
We prove each part directly from the definition and, in part (a), use the triangle
inequality which states that la + bl < lal + JbI for any real numbers a and b.
(a) There exists a positive constant c and an integer no such that If(n)l < clg(n)I
for all n > no. So, for all n > no, If(n) + g(n)l < If(n)l + g(n)l <
clg(n)l + lg(n)l = (c + l)lg(n)l. With no and c + I in Definition 8.2.1, we
see that f + g = O(g).
(b) There exists a constant c and positive integer no such that If(n)I < clfl(n)l
for all n > no. There exists a constant d and positive integer n 
such that
Ig(n)l < dlgl(n)l for all n > ni. Let n* = max{no,nl}. Then, if n > n*,
lf(n)g(n)l = lf(n)llg(n)l < clfl(n)l djgl(n)l = cdlfl(n)gl(n)l. Replacing
the constants no and c in Definition 8.2.1 with n* and cd, respectively, we
see that fg = 0(fjgi). 
I
EXAMPLE 10
I 
S
EXAMPLES 11
We showed in Example 9 that n + 1 = 0(n 2). Thus, by part (a) of Proposi-
tion 8.2.3, we know also that n2 + n + I = 0(n 2). Since n + I = 0(n), part (b)
tells us that (n + 1)(n2 + n + 1) = 0(n 3 ). 
A
Big Oh gives us a way to compare the relative sizes of functions.
If f and g are functions N 
R, we say that f has smaller order than g and
write f 
-< g if and only if f 
0(g) but g #A 0(f). If f = O(g) and g = 0(f),
then we say that f and g have the same order and write f ~- g.
.
Example 9 shows that n + I -< n2; thus, n + 1 has smaller order than n2.
.
Example 8 and the Pause which follows show that 15n 3 
,. n3: 15n 3 and n3
have the same order. 
A
PROBLEM 12. 
Show that n! has smaller order than n', that is, n! -< n'.
Solution. 
First note that n! = n(n -1)(n -2) ... (3)(2) < nn 
n 
.n n = n"
so, with no = c = I in Definition 8.2.1, it follows that n! 
0(nn). On the other
hand, nn 0 0(n!), which we establish by contradiction. If n" = 0(n!), then,
for some constant c, nn < cn!, so n < c for all sufficiently large n. This is
impossible because

nn 
n 
n 
n
n! 
nn-I 
1
for n > 2.
8.2 Complexity 
249
I
Suppose that limn,, f(n) and lim,, 
g(n) both exist, are positive, and
limc g(n) :A 0. Students of calculus may notice that if f = ((g), 
then
f(n) < c for all sufficiently large n, and thus, limn,( 
f (n) < c. In particular, if
gn)g 
(n)-
lim, 0 f (n) = x, 
then f 74 O(g).
Students familiar with limits should appreciate the next proposition. We leave
its proof to the exercises.
I"eZM0
EXAMPLES 13
Let f and g be functions N -* 
R.
(a) If lim f () =O, then f <g.
ne-o g(n)
(b) If lim 
() 
,then g <f.
n-eo g(n)
f1(n)
(c) If lim 
= L for some number L 7& 
0, then f 
g.
neon g(n)
.
Since lim 
= 
0 n + 1 -< n2, as earlier noted.
neon 
n2 
'
2n 2 - 3n + 6
* Since lin 
-
= 2, 22 - 3n + 6 >n
2.
n-o 
f n2
A
We have seen that 15n 3  
n3 and 2n 2 -3n+6 
n2 . These examples illustrate
a general principle whose proof we first describe in a specific case.
PROBLEM 14. 
Let f (n) = 5n2 - 6n + 3 and g(n) = n2 . Show that f and g
have the same order.
Solution. 
For n > 1, we have 5n 2 - 6n + 3 < 5n2 +6n+3 < 5n 2 +6n 2 +3n 2
14n2 so, with c = 14 and no = 1 in Definition 8.2.1, we see that f = 0(g). On
the other hand,
f(n) =5n2 -6n+3 
=n2(5 -6+ 
3 ) >n2(5 -
6 
3
Since
6 
3
lim -
= 
lim -
= 0,
n-oo n 
n-oo n2
there exists an integer no such that both
6 
5 
3 
5
-
< -
and 
-< 
-
n 
4 
n2 
4
NNMN

250 
Chapter 8 Algorithms
for all n > no. (Evidently, no = 5 will suffice.) It follows that
6 
5 
3 
5
-- 
>-- 
and 
--
>-
n 
4 
n2 > 
4
so that
f(n) = 5n 2 - 6n + 3 > n2 (5 
---
) = n2 (5 
-)= 
-
n
4 4 
2 
2
Thus g(n) = n2 < 2 f(n) so, with c = 2 in Definition 8.2.1, we see that g
0(f). Thus, f 
g.
Here is the general result.
6 
A polynomial has the same order as its highest power; that is, if f(n) = atnt +
at -Int- 
+ 
+ ao is a polynomial of degree t, then f(n) 
nt.
Proof This follows immediately from part (c) of Proposition 8.2.6, but we provide here a
direct proof which does not require any knowledge of calculus. Our proof mimics
the solution to Problem 14.
For any natural number n, the triangle inequality gives
If(n)I < latntI + lat-n 
I I + 
+ 
Â±aiwntI + laol
= latent + lata Int'- I + 
+ jain + laoI
< latInt + la-l 
Int + - . .+ 
jai Int + laoInt
= (latI + lat- 
+ 
i+ 
jaiIt 
+ aoI)n t .
Thus, If (n)I < cnt for any n > no = I with c = latI + lat I I + 
+ Jai I + laol. By
Definition 8.2.1, we see that f(n) = 0(nt). Now we prove that nt = O(f(n)).
Since f 
-f 
for any f: N -* R (see Exercise 15 at the end of this section),
we may assume that at > 0. We have
f~n 
= 
nt (at 
+ at-l + at-2 + 
+ a
lat-I I 
lat 21 
laol
> 
n2 
(a-t
As n gets large, the numbers
at- 
I 
lata21 
aol
n 
n 2  
nt
at
approach 0, so all of them are eventually smaller than the positive number 
2'
Thus, there is an no such that for any n > no,
at- I 
at 
lat-21 
at 
laol 
at
n 
2t 
n2 
Th2t 
re
Therefore,
-
la- II 
at
n 
2t
la, 21 
at
n2 
2t
Iaot 
at
nt 
2t

8.2 Complexity 
251
and
f (n) > nt (at -a, 
-
at
at i 
at 
at 
( 
2at
2 
2
Thus, n' < -f 
(n) for all n > no and, with c = -
in Definition 8.2.1, we obtain
at 
at
n' = 
(f (n)), as required. 
I
In the exercises, you are asked to verify that the relation same order defines
an equivalence relation on the class of functions N -* 
R; that is, the relation is
reflexive:
symmetric:
transitive:
f 
f for all f;
if f 
g, then g 
f; and
if f 
g and g 
h, then f 
h.
(See Section 2.4.)
EXAMPLE 15
Since 5n2 - 6n + 3 
n2 and 2n2 - 3n + 6 
n2 , it follows that 5n2 
6n + 3 and
2n2 
- 3n + 6 have the same order, something which is, perhaps, not so easy to see
directly from the definition of Big Oh. In fact, transitivity and Proposition 8.2.7
imply that any two polynomials of the same degree have the same order. 
A
There are also some natural connections between the binary relations 
and
-<. For example, if f -< g and g 
h, then f -< h. We have seen that n + 1 < n2
and n 2 >-' 5n 2 + 6n + 3, so we may conclude that n + 1 -< 5n2 + 6n + 3.
Proposition 8.2.7 says that any polynomial has the same order as its highest
power. The next proposition shows that different powers of n never have the same
order.
Suppose a and b are real numbers and I < a < b. Then na -< nb.
Proof 
Take no = I and c = I in Definition 8.2.1 to obtain n' = Q(n b). To see that
the reverse is not true, suppose nb < cn' for some constant c and all sufficiently
large n. Dividing by na, we have nb-a < c. The left-hand side is a positive power
of n and, hence, for large n, it is bigger than c. Thus, nb is not 0(na). 
I
Students of calculus should note that Proposition 8.2.8 follows directly from
part (b) of Proposition 8.2.6 because
flb
lim -= 
oo.
ncoc na
As a particular case of Proposition 8.2.8, we see that I -< na for any positive
power na of n. Thus, we begin to see that the idea of order permits the definition
of a hierarchy among functions. For instance, we now know that
I -< In -< n -< n 
n <. n2-< n2.01 < ..
A straightforward induction argument shows that n2 < 2n for n > 5 (see
Exercise 9 of Section 5.1). It follows that 2' 
4 0(n); otherwise, we would have
2' < cn and, hence, n2
< 2' < cn for some constant c and sufficiently large n.

252 
Chapter 8 Algorithms
* 
**g.. 
S
Proof
This implies n < c which, for large n, is not true. Thus, 2' 
:A 0(n). Since
n = Q(2n), we conclude that n -< 2
In a similar fashion, we can prove that n3 < 2 n for n > 10 and, hence, that
n2 -< 2n. (See Exercise 14 at the end of this section.) In fact,
n 
-< V
for any real numbers a and b with b > 1. This follows directly from Proposi-
tion 8.2.6 since
bn
lim -= 
0o
nzoo na
for any real constants a, b with b > 1. (For students familiar with l'HMpital's
Rule, this result will be elementary.)
Our examination of the relative orders of common functions continues.
logb n -< n for any real number b, b > 1.
We apply logb to the inequality n < bh, which is true for sufficiently large n,
obtaining logbn < n. With c = I in Definition 8.2.1, we see that logbn = 0 (n).
Now n 0 O(logn) since n < clogbn implies b" < nc (applying the function
x -* 
bx) which, for large n, is not true. Thus, lg9b n -< n. 
I
In the Exercises, you are asked to show that any two logarithm functions
(with bases larger than 1) have the same order; that is,
log, n 
o1gb n
for any a, b > 1. For this reason, we now frequently omit mention of the base
of a logarithm because most assertions about order which involve logarithms are
true for any base b > 1.
Propositions 8.2.8 and 8.2.9, together with the facts that
n! 
n n
(Problem 12) and
bIt -n!
(Exercise 13 at the end of this section), allow our hierarchy of functions to be
extended considerably. For a, b > 1, we have
1 -< logn -< ns < na -< b 
-< n! -< nn.
Figure 8.4 shows the graphs of the natural logarithm and of the functions
defined by f (x) = x, f (x) = x2, and f (x) =3x and provides dramatic evidence
of the relative orders and rates of growth of these functions. In particular, note the
very slow growth of the logarithm and the very rapid growth of the exponential.
How does all of this relate to efficiency of algorithms? Suppose A and 3
are algorithms which accomplish the same task. If the problem to which these
algorithms is applied is "small," they may work so quickly on even a microcom-
puter that differences in performance are not noticeable. Few of us can detect the

8.2 Complexity 
253
20
15
5-
-10
y =3 / 
X2,"
X 
,,"f
-t 
'" 
yx
y 
ln(x)
2 
3 
4 
5 
x
Figure 8.4 
Some common complexity functions.
difference in a running time of 10 6 seconds and one that is 100 times as fast!
As the problem grows in size, however, differences in running time become very
significant. Suppose A has complexity ((n) 
while 23 is 0(n 3). With n = 5000
and a computer which performs a million operations per second, algorithm A
requires on the order of 5000 x 10-6 = 0.005 seconds while 3 requires about
50003 x 10-6 = 125,000 seconds, or about a day and a half! Some algorithms
may involve so many operations that they are simply impractical to implement. We
become very concerned, therefore, with the relative sizes of complexity functions
when n is large. This is precisely what the concept of order is designed to measure.
If complexity functions f and g, which correspond respectively to algorithms
A and 3, have the same order (f 
g), then A and 23 are considered to be
very similar with respect to efficiency, whereas, if f has smaller order than g,
then A is more efficient than 3. An algorithm whose complexity function has
the same order as n is said to be linear or to run in linear time. An algorithm
with complexity function the order of n2 is called quadratic. More generally,
algorithms with complexity functions of order na for some positive real number
a are polynomial or said to run in polynomial time. Algorithms with complexity
functions of order logn are logarithmic and algorithms with complexity of order
an for some a > 0 are exponential.
We have seen that an algorithm which runs in logarithmic time is more effi-
cient than a linear algorithm, which, in turn, is more efficient than a quadratic
algorithm. Any polynomial algorithm is more efficient than one which is expo-
nential.
Here a word of caution is in order. Saying that an exponential algorithm A
is less efficient than a polynomial algorithm 3 which runs in polynomial time
means only that when n is sufficiently large, algorithm A takes more time. For
small values of n, the differences may be inconsequential; indeed, A may even be
faster! For example, if f(n) = lOOn3 and g(n) = 2n, then f -< g, but we must
have n > 20 for the polynomial algorithm to be faster. Similarly, f(n) = n2 is
"better" than g(n) = In_ because, once n becomes sufficiently large, an algorithm
V

254 
Chapter 8 Algorithms
Table 8.1 
Approximate time required to run an algorithm requiring f (n)
operations assuming a machine speed of 1 million operations per second.
ftn) 
' 
10 
100 
5000
25 
25 x106 
6 S 
25 x106 
6S 
25 x106 
6
10g 2 n 
3.3 x 106 6S 
6.6 x 106 
6S 
1.2 x 10- s
n 
10 5 s 
10
4 S 
5 x103 
3 s
nl10g2 n 
3.3 x 10- 
s 
6.6 x 10-6 s 
6.1 X 102 
2
n2104 
4 s 
.01 s 
25 s
2n 2 Â±+5nÂ±+100 
3.5 x104 
4 s 
.021 s 
50 s
n 
3/100 
l0-s 
Ol01s 
21min
2n103 
s 
4.0 x 1016 yr 
4.5 x 101491 yr
with the complexity function f 
will take less time. This is 
clearly not the case
for small values of n, however.
These remarks are illustrated in Table 8. 1, which compares a number of com-
plexity functions f (n). The entries, which are only approximate, show the time
required to run an algorithm with f (n) operations on a machine performing one
million operations each second (like a snail). The functions are ordered in decreas-
ing order of efficiency for sufficiently large n (except for n 2 and 2n 2 + Sn + 100,
which have the same order). From this table, we see that an algorithm with
f (n) =25 operations runs much more quickly than an algorithm with f (n) = n
or f (n) = n3, once n is big enough. While for n as large as 100, an algorithm
n32
with f (n) = TOOruns more quickly than one with f (n) = 2n2 Â± Sn + 100, it
is apparent that once n =5000, the situation is reversed. Note how quickly an
algorithm with log 2 n operations runs and, conversely, how slowly one with 2'
operations runs (for large n). (When viewing the numbers in the last line of the
table, it is interesting to bear in mind that the universe has been around for about
7 x i0' years!) Algorithms with complexity functions which are 000og 2 n) are
highly efficient whereas exponential algorithms are so slow as to be useless from
a practical point of view, once n is any reasonable size at all.
In recent years, following the initiative of Stephen Cook of the University of
Toronto, computer scientists have identified a collection of problems for which
no polynomial time algorithm is currently known. These problems, which are
equivalent in the sense that the existence of a polynomial time algorithm for
one of them would imply polynomial time algorithms for them all, are called
NP-complete. The NP stands for nondeterministic polynomial time. Some of the

8.2 Complexity 255
most interesting NP-complete problems are related to graphs and will be identi-
fied in later chapters. (See, for instance, the "Traveling Salesman's Problem" in
Chapter 10 or the problem of coloring the vertices of a graph, which is discussed
in Chapter 14.)
We conclude this section with a discussion of the complexity of some algo-
rithms which will already be familiar to the reader.
PROBLEM 16. 
Show that the number of single-digit additions required in the
addition of m n-digit numbers does not exceed m(2n + m). Conclude that the
complexity of such addition is 0(n 2) if m < n and O(m2) otherwise.
Solution. 
This addition problem has the following form.
r = (rn-
0
r,-2.. .rlro)lo
c = (cn- l 
.
clco) lo 
.
numbers
b = (b 
1b0-2 
... blb o)lo
a = (an-jan -2... alao)lo
We use repeatedly the result of Problem 7 that the addition of two n-digit numbers
requires at most 2n -1 single-digit additions. Thus, the addition of a and b requires
at most 2n - 1 additions. The sum is a number with at most n + 1 digits. The
addition of this number and c (which we think of as an n + 1-digit number
beginning with 0) requires another 2(n + 1) -1 
= 2n + 1 operations, at most,
and gives a number with at most n + 2 digits. Adding the next number requires
at most 2(n + 2) -
= 2n + 3 operations. Continuing this way, the final addition
with r requires at most 2[n + (m - 2)] - 1 = 2n + 2m - 5 operations. Altogether,
the addition requires at most
(2n 
1)+(2n+ 1)+(2n+3)+ .. +(2n+2m-5)
operations. This is the sum of an arithmetic sequence with m -1 terms, first term
a = 2n - 1 and common difference d = 2, so it equals
m l [2(2n- t) + (m-2)2] = (m -1)(2n 
-1) + (m-2)(m-1)
=(m- 1)(2n+m-3)
< m(2n + mi).
[See formula (7) on p. 166.] If m < n, the number of operations is at most
n(2n + n) = n(3n) = 3n2, so the addition has complexity 0(n 2). If n < m,
m(2n + m) < m(2m + m) = 3m2, so the complexity is 0(m2). 
I
PROBLEM 17. 
Show that the usual method of multiplying two n-digit numbers
has complexity 0(n 2 ). Count as equivalent operations the addition and multipli-
cation of two single-digit numbers.4
4There are faster methods of multiplying. In 1962, Anatolii Karatsuba found a method which is 9(, 1.58).
By December 1988, the fastest known method was 0(n(logn)(loglog n)). No algorithm better than 19(n)

256 Chapter 8 Algorithms
Solution. 
In the multiplication of two n-digit numbers by the usual method,
there are n multiplications of an n-digit number by single-digit numbers. Each
such multiplication requires at most 2n - 1 operations. (See Exercise 2.) Then it
is necessary to add n numbers, each of length at most 2n. Using the result of
Problem 16, this requires at most an additional n[2(2n) + n] = n(5n) operations
for a total not exceeding
2
n(2n -1) 
+ n(5n) 
n2n
by Proposition 8.2.7. 
I
........
PROBLEM 18. 
One straightforward way to compute a positive integral power
of a real number x is to compute x(x) = x2, then x(x2) = x3, then x(x 3) = x4,
and so forth.
(a) Find the complexity of this algorithm in terms of the number of multiplica-
tions.
(b) Find an algorithm which is more efficient than the one described and indicate
why your algorithm is more efficient.
Solution.
(a) This algorithm requires n -I 
multiplications.
(b) A seemingly more efficient way to compute xn is to compute the powers
x, x2, (x2) 2 = x4, (X4) 2 = x8, and so on, stopping upon calculation of x2,
where 2 k-1 < n < 2k. This requires k multiplications. Now consider how the
Russian peasant method computes the product n = n x 1.5 On the left, n is
divided by 2 a total of k times, while on the right, I is multiplied by 2 a total
of k times. The product n is determined as the sum of certain numbers on the
right, that is, as the sum of at most k powers of 2. Then x' is the product of
the corresponding powers of x. For example,
37 
1 + 22 + 25, So 
37 = 
l 22 25
and generally,
n- 
2k, 
soX" =-x 
2k 
=x 2kjx2k9
for which at most a further k multiplications are required. Thus, after at
most 2k multiplications, we can compute x'. Applying log2 to the inequality
2k-l < n, we have k -1 < log2 n and so k < 1 +log2 n. Thus, the number of
multiplications required this time is O(logn). Since log n -< n, the proposed
algorithm is more efficient than the one described in (a). 
I
............................ 
W. 
....... 
.
........... 
--.....
is possible. We refer the interested reader to "Ramanujan, Modular Equations, and Approximations to Pi or
How to Compute One Billion Digits of Pi," by J. M. Borwein, P. B. Borwein, and D. H. Bailey, American
Mathematical Monthly 96 (1989), 201-219, and to the bibliography of this article.
5The Russian peasant method can be very useful!

8.2 Complexity 257
PROBLEM 19. 
Find a Big Oh estimate of the complexity of the Euclidean
algorithm in terms of the number of divisions. (Given integers a and b, a "division"
of a by b means the determination of q and r, 0 < r < b, such that a = bq + r.)
Solution. 
Given positive integers a and b with b < a, recall that the Euclidean
algorithm finds the greatest common divisor of a and b by the following sequence
of divisions,
a 
= qib+rl 
rl <b,
b 
= 
q2rl + r2, 
r2 < ri,
ri 
= 
q3r2 + r3, 
r3 < r2,
rk-2 
= 
qkrk-1 + rk, 
rk < rk- ,
rk-l 
= 
qk+Irk,
the process terminating with the first zero remainder rk+Â±. The gcd is then rk, the
last nonzero remainder. (See Section 4.2.) The number of divisions and, hence,
the number of basic operations is k + 1. How big is k? Note that qk+I > 1 because
rk < rk-1 and, since the other quotients qj are positive integers, we have qj > 1
for 1 < i < k. Therefore,
rk> I
rk 1 > 2rk > 2
rk-2 > rk-I + rk > 3
rk-3> rk-2 +rk- I > 3+2 
5
rl >r2 + r3
b > rl + r2.
Consider the two sequences
1, rk, 
rk-1, 
rk-2, 
rk-3, ...
,.rl, 
b
1, 
1, 
2, 
3, 
5,
Each term in the first sequence is at least as big as the corresponding term in the
second sequence. In particular, b is at least as large as the (k + 2)th term in the
second sequence. The second sequence, however, is the Fibonacci sequence (see
5.2.3), whose kth term is the nearest integer to 1 ( 1+_) 
. Thus,
b> ( 
-1 
= 
( i3)
2 ( 1 Â± )k-
from which it follows that (,+2,5) 
< Ab + B, where A and B are positive
constants independent of b. Since I +3 = C is also a constant and Ck < Ab + B,
2
an application of the logarithm (to any base) gives k log C < log(Ab + B). Since

258 
Chapter 8 Algorithms
log(An + B) ~-' log n for A, B > 0 (see Exercise 22), it follows that the number
of operations required is 0 (log b). The Euclidean algorithm is very efficient. 
I
S~~~~~~~~~~~. 
- . . . .
......rrrrrrrrrrrrrrrrrrr- 
- -rrrrrrrr-rrrr_ 
_ _ _ _ -rrrrrrrrrrrrr....rrrrrrrrrr-rrrr-rrrrrrr...............rrrrrrrrrrrrrrrrrrrrrrrrrrrr- 
-rrrrrrr.............rrrrrrrrrrrrrrrrrrrrrrrrr-y-. 
-h .....-.... 
@C. 
..............S ........ 
.............
A 
-
* ** 
-
2. Take no = 1 and c = 1.
The symbol [BB] means that an answer can be found in the Back of the Book.
1. [BB] Consider the distance algorithm described in
Example 6. Assume that addition and subtraction require
the same amount of time, that addition is twice as fast
as multiplication, and that multiplication is ten times as
fast as the square root operation. Find the complexity
function.
2. Show that the number of operations required to mul-
tiply an n-digit number by a single-digit number does
not exceed 2n- 
1. Count the addition and the mul-
tiplication of two single-digit numbers as equivalent
operations.
3. [BB] Show that the number of operations required to
divide an n-digit number by a single-digit number does
not exceed 3n. Count as equivalent the following oper-
ations:
. the multiplication of two single-digit numbers,
. the division of a single-digit number or a two-digit
number by a single-digit number, provided the quo-
tient has only a single digit (e.g., 37Â± 9 but not 37 . 3),
and
. the subtraction of two two-digit numbers provided the
difference has only a single digit (e.g., 37 -32, 
but
not 37 -22).
4. Consider the problem of finding the minimum number
in a set of n real numbers. Find an algorithm for this
and find its complexity function. Take comparison in
the form "x < y?" as the basic operation.
5. Let x be a real number and n a positive integer. Consider
the following two algorithms for calculating x2 '.
ALGORITHM A:
Step 1. Set a = 1.
Step 2. For i = I to 2", replace a by xa.
Step 3. Output a.
ALGORITHM B:
Step 1. Set a = x.
Step 2. For i = I to n, replace a by a2.
Step 3. Output a.
Find complexity functions for each of these algorithms
and explain why '3 is more efficient. Assume that mul-
tiplication is the basic operation.
6. (a) [BB] Justify the statement made in Section 8.1 that
Horner's method of polynomial evaluation requires
fewer arithmetic operations than the more obvious
method described in Problem 2. Assume that pow-
ers of x cannot be stored.
(b) Repeat part (a) assuming it is possible to store pow-
ers of x.
7. Use Definition 8.2.1 to show that f = 0(g) in each of
the following cases of functions f, g: N -* R.
(a) [BB] f(n) = 5n, g(n) = n3
(b) f (n) = 17n4 + 8n3 + 5n 2 + 6n + I, g(n) = n4
(c) [BB] f(n) = 8n3 + 4n2 + 5n + l, g(n) = 3n4 +
6n2 + 8n + 2
(d) f(n) = 2", g(n) = 3fn
(e) f(n) 
2n2 + 3n + l, g(n) = n2 +
(f) f (n) 
2n2 - 3n + 5, g(n) = n2 - 7n
(g) f(n) 
0log2 n5 , g(n) = n
8. [BB; (a), (c)] For each part of Exercise 7 decide whether
f -< g or f 
g. Use Propositions 8.2.7 and 8.2.8, if
appropriate.
9. If f, g, h : N -R. R, 
= 0(h) and g = 0(h), show that
f +g 
0 0(h).
10. (a) Show that 0 defines a transitive operation on the
class of functions N -* R.
(b) [BB] Prove that -< defines a transitive relation on
the class of functions N -Ã· R.
ff ENT= 
-

8.3 Searching and Sorting 259
11. [BB] Let f, g and h be functions N -* 
R and suppose
that f t- g and g -< h. Prove that f -< h.
12. [BB] Show that a' -< b0 if 0 < a < b.
13. (a) [BB] Show that 2" -< n!.
(b) Show that b 
-< n! for any b > 1.
14. (a) Prove that n3 < 2" for all n > 10.
(b) Use the result of part (a) to show that n2 -< 2n
15. [BB] Let f: N -- R be a function and 0 :A k E R. Show
that kf '- f.
16. Let A be the set of all functions N --- R and, for
f, g e A, define f -< g as in Definition 8.2.4.
(a) Does -< define a partial order on A?
(b) For f, g E A, define f 
-< g if f 
-< g or f 
-
g. Is
(A, f) a partially ordered set?
17. Show that A, as defined in Definitions 8.2.4, defines an
equivalence relation on the class of functions N -* R.
18. [BB] Use any of the results of this section to show that
nlog2 n -< n2 .
19. Find a function in the list
n2, 1, n3 , n logn, logn, n4, 2', nn!, n, 
fn
5
which has the same order as
(a)
(b)
(c)
(d)
(e)
(D
f(n)=3n4 +6n 2 -8n- 
5
[BB] f(n) = n logn + n2
f(n) = 5
f(n) = 2' + 4nn
f(n) = 3n! -17n 4
f(n) = n + logn
Justify your answers appealing to any of the results in
this section that prove helpful.
20. Repeat Exercise 19 for each of the following functions:
(a) [BB] f(n) = 48n' - 7n4 + 6n3 + 5n2 - 2n- 7
(b) f(n) = 2' + 375n 1990
(c) f (n) -
7rn + n'
(d) f(n) = 3n + Sn logn + 7n2
(e) f(n)=2+4+6+**+2n
(D) f(n) 
2+4Â±8+ 
.. 
+2n
(g) f (n) 
(5n +7)(n2 log2 n)
(g) ~n) 
2 Â± 4n
21. [BB] Show that log, n 
logb n for any real numbers
a, b > 1.
22. Suppose A and B are positive real numbers. Show that
log(An + B) and logn have the same order. (Use log2 ,
for instance.)
23. [BB] Show that logn! = 0(nlogn).
24. (a) Find a Big Oh estimate of the complexity of the
algorithm for writing an integer a in base 2 in terms
of the number of divisions. (See Section 4.1.) As in
Problem 19, by a "division", we mean the determi-
nation of q and r such that a given integer b =
2q + r.
(b) Suppose a division counts as three basic operations.
How does this affect your answer to (a)?
25. The Russian peasant method is used to multiply two
n-digit numbers.
(a) Find a reasonable upper bound for the number of
rows required by this process, that is, for the number
of multiplications and divisions by 2.
(b) Find a reasonable upper bound for the number of
basic operations required in the multiplying and divi-
ding by 2.
(c) Find a reasonable upper bound for the number of
basic operations required by the final addition.
(d) Show that the number of basic operations in all is
0(n2).
Count as basic operations
. the addition of two single-digit numbers,
. the multiplication of two single-digit numbers, and
. the division of a 2-digit number by a single digit
number.
26. (For students of calculus) Prove Proposition 8.2.6.
8.3 
SEARCHING AND SORTING
Perhaps the two most important tasks required of modern computers are the search-
ing and sorting of lists. Since they are required by so many other processes and
often must be repeated many times, efficient algorithms to search and sort lists
are of supreme importance.

260 
Chapter 8 Algorithms
:WÂ±uN I LI 1
0
EXAMPLE 20
* 
-
A car manufacturer, realizing that a certain part is a potential safety hazard,
needs to search the records of all cars sold in recent years for those which contain
this part. A university wishes to implement a system whereby, each semester,
students will register in order of decreasing grade point average (those with the
highest grade point average register first). In order to determine the numbers of
students with grade point averages in various ranges, student records will have to
be searched.
How often is it required to sort a list alphabetically? Surely this is a key step
in many tasks, from the creation of telephone directories to dictionaries. Although
computers can work very quickly, given a large input and an inefficient algorithm,
they can be slowed to a crawl easily.
In this section, we discuss several algorithms for searching and sorting and
discuss the complexity of each. Our approach to complexity will again always be
worst case. While we would hope that a sorting algorithm would not take long to
alphabetize a list of names input already in alphabetical order, our concern is the
length of time such an algorithm could take when the input is as disorganized as
possible.
We begin with an algorithm which searches a list for one particular entry.
To search a list al, a2, ..
a, for the element x,
for i = 1 to n
if x = ai, output "true" and set i = 2n;
if i =A 2n, output "false".
The algorithm proceeds in an obvious way. Setting i = 2n is a little trick
which stops the loop as soon as x has been found and, if x is not in the list,
ensures that "false" is output at the end.
For x = -2 
and an input list
6 
0 
-2 
1
al 
a2 
a3 
a4
the algorithm sets i = 1, determines that x 
a 
al = 6, and sets i = 2. Since
x 
a2 = 0, it sets i = 3. Since x = a3 
-2, 
it outputs "true" and sets
i 
2n = 8. Since i is no longer in the range from 1 to n, the loop stops. Since
i= 2n, the algorithm knows that x was found and does not output "false".
On the other hand, for x = 2 and the same input the algorithm determines
that x 
al = 6, x 7& a2 = O, x 4 a3 =-2, and x :A a4 = 1. At the final step,
i = 4 7 2n, so the algorithm outputs "false." 
A
In the worst of circumstances, when the element x is not in the list a1,
a2, . .
, a, the loop is executed n times and the algorithm requires n + I compar-
isons. In most searching and sorting algorithms, there are few arithmetic calcula-
tions. The best basic operation with which to measure efficiency is a comparison,
that is, a statement of the form x = a, x < a, x < a, x > a, or x > a. This linear
search algorithm requires at most n + I comparisons, so it is 0(n).
Big Oh notation is sufficiently imprecise that we can be relatively careless when
determining the complexity of an algorithm. A more thoughtful approach to the

8.3 Searching and sorting 261
-U
EXAMPLE 21
linear search algorithm might have led us to count two comparisons for each value
of i, for after checking if x = aj, the algorithm must also check to see if the end
of the list has been reached, that is, if i = n. Such analysis would lead us to
complexity 2n rather than n, but, as we know, n 
2n, so the Big Oh estimate of
complexity remains 0(n).
It is often the case that a list to be searched is in some natural order. When
searching a dictionary for the meaning of obfuscate, for instance, it is helpful to
know which way to turn if the dictionary is open at trisect. When a list is already
in order, it stands to reason that there should be a procedure for searching which is
more efficient than a linear search. One commonly used such procedure is called
binary search. The Binary Search Algorithm determines which half of an ordered
list would have to contain the sought-after element, then which half of that half,
and so on. At each stage, the list to be searched is one half the length of the
previous list.
To search for an element x in an ordered list al < a2 < ... 
< an, proceed as
follows.
while n > 0
if n = I then
if x = a0 output "true" and set n = 0;
else output "false" and set n = 0;
else
set m= L[2;
if x = am, output "true" and set n = 0;
else if x < am
set n = m and replace the current list with a .
am;
else replace n with n -
m and the current list with am,+, 
. . .
a,
end while
This is the first time we have encountered the "while/end while" construct,
which works pretty much as we would imagine. In this particular case, as long
as there is a list to examine ("while n > 0"), the algorithm decides in which half
of the list the sought-for element may reside and replaces the current list with
this half.
With x = 12 and the input
5 
6 
7 
10 
11 
12 
15 
17 
19 
20
al 
a2 
a3 
a4 
a5 
a6 
a7 
a8 
a0 
alo
of length n = 10 > 0, the algorithm sets m= L 1[0 
= 5. Since x = am = 11 and
x < am are both false, the algorithm replaces n by n -m 
= 5 and replaces the
original list with
12 
15 
17 
19 
20
aI 
a2 
a3 
a4 
a5.
The integer n is still positive, so the algorithm executes the statements inside the
"while ... 
end while" again. Since n 4 1, it sets m = L[2j = 2 and, because

262 
Chapter 8 Algorithms
EXAMPLE 22
x < a2 = 15, it sets n = 2 and replaces the current list with
12 
15
al 
a2 .
Now n is still positive, so the algorithm executes the statements between "while"
and "end while" again. Since n =A 1, the algorithm sets m = [2] = 1. Since
x = al = 12, the algorithm outputs "true" and sets n = 0. The "while" statement
is no longer true, so the algorithm terminates. 
A
To determine the complexity of binary search, first suppose that n = 2k is
a power of 2. The algorithm proceeds by progressively halving the length of the
list; hence, it terminates after executing the statements between "while" and "end
while", in the worst case, a total of k times. This involves 2k + 2 comparisons,
including the two required when n = 1. If n is not a power of 2, find k such that
2k-I < n < 2k and increase the length of the input list by adding terms all equal
to an until the extended list has length 2k. This list, and hence the original, is
searched after 2k + 2 comparisons. Since 2 k I < n, we have k -1 < log2 n, so
k < 1 + log 2 n and 2k + 2 < 4 + 21g
2 n 
log2 n. The binary search algorithm
is O (log2 n).
We now turn our attention to sorting algorithms. A sorting algorithm will put
a list of numbers into increasing order or a list of words into alphabetical order.
We begin with perhaps the simplest of all sorting algorithms, the bubble sort.
The Bubble Sort Algorithm makes a number of passes through a list, each time
interchanging any consecutive pair of elements which are not in proper order. On
the first pass, the largest element is shuffled to the end. On the next pass, the next
largest element is shuffled to second from the end. In general, after the kth pass
the list looks like this:
al, a2, 
an k < an-k+I < ...
< an- 
< an
unsorted 
sorted
Gradually, the largest elements "bubble" to the end in order.
Suppose the input list is 6, 3, 1, 4, 9, 2. Initially, the first two numbers are com-
pared and (in this case) interchanged, giving the list 3, 6, 1, 4, 9, 2. Then the
second and third elements are compared and, in this case, interchanged, giving
3, 1, 6, 4, 9, 2. Next, the third and fourth elements are compared and switched,
giving 3, 1, 4, 6, 9, 2. No interchange of the fourth and fifth numbers is required.
The first pass is completed with an interchange of the fifth and last numbers,
giving 3, 1, 4, 6, 2, 9. Notice that the largest number, 9, has bubbled to the end.
The second pass through the list is like the first, but with one exception. Since
the largest element is now at the end, it is not necessary to compare the second last
element with the last. Here are the four steps of the second pass in our example.
The numbers being compared at each stage are underlined.
3,1,4,6,2,9 -- 1,3,4,6,2,9 -* 
1,3,4,6,2,9
-* 
l,3,4,6,2,9-* 1,3,4,62, 6,9

8.3 Searching and sorting 263
Notice that the two largest numbers, 6 and 9, are now at the end of the list
in correct order. The third pass is like the second, but one step shorter since it is
not necessary to compare the fourth and fifth elements. Here are the three steps
of the third pass.
1, 3, 4, 2, 6, 9 --- 
1 
1, 3,4,2,6,9- 
,3, 4, 2, 6, 9 -
1, 3, 2, 4, 6, 9.
The fourth pass requires two comparisons,
1, 3, 2, 4, 6, 9 --e 1, 3, 2, 4, 6, 9 --
* 1, 2, 3, 4, 6, 9
and the fifth pass just one,
1, 2, 3, 4, 6, 9 -# 1, 2, 3, 4, 6, 9. 
A
In the general description of the Bubble Sort Algorithm which follows, we use
the term swap to denote the exchange of values of two variables. For instance,
if a = 4 and b = 2 and we swap a and b, we mean that henceforth, a = 2
and b = 4. In the description of any sorting algorithm, we always assume that
the elements to be sorted come from a totally ordered set, for example, the real
numbers or the words of a language (with lexicographic ordering).
To sort n elements al, a2, ..
, a, from least to greatest,
for i = n -
1 down to 1,
for j = 1 to i
if aj > aj+1, swap aj and aj+l.
The algorithm consists of a loop inside a loop. In the "outer" loop, we set
i = n -1 
and then execute the "inner" loop from j = I to j = n -1. Then
we drop i to n-2 
and execute the inner loop from j = I to j = n -2,
and so on until i = 1, at which point the inner loop is executed just once,
with j = 1. The Bubble Sort Algorithm is popular with beginning programmers
because it is short and simple to implement in any language. Let us make sure
we understand it.
EXAMPLE 23 
For the input list
4 0 
3 
2
al 
a2 
a3 
a4
we have n = 4. The algorithm sets i = n - 1 = 3 and runs the inner loop from
j = 1 to 3. With j = 1, we have al > a2, so al and a2 are swapped, giving the
list
0 
4 
3 
2
al 
a2 a3 
a4.
With j = 2, we have a2 > a3, so a2 and a3 are swapped, giving
0 
3 4 
2
al 
a2 a3 
a4.
With j = 3, we have a3 > a4, so a3 and a4 are swapped, giving
0 
3 
2 
4
al 
a2 
a3 
a4.

264 
Chapter 8 Algorithms
Having completed the inner loop, the algorithm returns to the outer, drops i to
i = 2, and executes the inner loop from j = I to j = 2. With j = 1, the
inequality al > a2 is not true, so there is no swap. With j = 2, we have a2 > a3,
so a2 and a3 are swapped, giving
0 
2 
3 
4
al 
a2 
a3 a4.
Again, the algorithm returns to the outer loop, drops i to i = 1 and executes the
inner loop just for j = 1. Since al > a2 is false, there is no swap. The algorithm
now terminates. 
A
What is the complexity of a bubble sort? With i = n- 
1, the inner loop is
executed n -
1 times and there are n -
I comparisons. With i = n -2, 
there are
n -2 comparisons, and so on. With i = 1, just one comparison is required. In all,
the number of comparisons is
n-I 
n 
n n(n -1)
,(n 
-i) 
=
so that this algorithm is 0(n 2). Note that this estimate of the complexity of the
bubble sort is best possible: In any bubble sort, all tn(n -
I) comparisons must
be made before it is completed.
Many sorting algorithms do better than the bubble sort. On the other hand, it is
known that no sorting algorithm has worst case complexity better than 0 (n log n).
With a view toward an eventual discussion of one n log n algorithm, we first
introduce an algorithm for merging two sorted lists, an important task in its own
right. Instructors with numerous examination booklets to put into alphabetical
order have long since learned that speed can be improved by first dividing the
booklets into smaller alphabetized groups and then merging the groups.
Our merging algorithm takes two ordered lists and produces a third ordered
list comprised of the elements in the two given lists, in order.
EXAMPLE 24 
Here is how our Merging Algorithm would sort the ordered lists
1,3,5,7,10,11 
and 
2,5,6,9.
We compare the first elements of each list. Since 1 < 2, we start our third list
with 1, removing 1 from the first list. This leaves us with
3,5,7,10,11 
2,5,6,9 
and 
1.
We compare the first elements of the first two lists. Since 2 < 3, we place 2 after
I in the third list and remove 2 from the second list. At this stage, we have the
three lists
3,5,7,10,11 
5,6,9 
and 
1,2.
We continue to compare the first elements in the first two lists, appending the
smaller to the third list while removing it from the list from which it came. If the
first element in the first list equals the first element in the second, we append that

8.3 Searching and Sorting 265
EXAMPLE 25
element from the first list to the third (and remove it from the first). Here are the
next six steps in our merge.
5, 7, 10, 11 
5, 6, 9 
1, 2, 3
7, 10, 11 
5, 6, 9 
1, 2, 3, 5
7, 10, 11 
6, 9 
1, 2, 3, 5, 5
7, 10, 11 
9 
1, 2, 3, 5, 5, 6
10, 11 
9 
1, 2, 3, 5, 5, 6, 7
10, 11 
1, 2, 3, 5, 5, 6, 7, 9
At this stage the second list is empty, so we simply append the remaining elements
10,11 of the first list to the third, giving the final list 1, 2, 3, 5, 5, 6, 7, 9,
10, 11. 
A
To merge two given sorted lists
Â£I: al < a2 < ...
< as 
and 
Â£ 2 : b, < b2 < 
< bt,
of lengths s and t, into a single sorted list
JC3: cl <- C2 
Cs+t
of length s + t, proceed as follows.
Step 1. Set Â£3 equal to the empty list.
Step 2. If t, is empty, set Â£3 = Â£2 and stop. If Â£2 is empty, set Â£3 = to and
stop.
Step 3. Suppose al < bl. Then append al to Â£3 and, if this empties Cj, append
the remaining elements of Â£2 to Â£3 and stop. If r > 0 elements remain in Â£V,
label them al, a2, . .. , ar in increasing order and repeat Step 3.
Suppose a, > bl. Then append bj to Â£3 and, if this empties Â£2, append
the remaining elements of Â£I to Â£3 and stop. If r > 0 elements remain in T2,
label them bl, b2, ... , br in increasing order and repeat Step 3.
We apply the merging algorithm to the lists
3 
5 
8 
and 
Â£2: 
1 
7 
8
aX 
a2 
a3 
b I b2  b3.
Since neither list is empty, we proceed directly to Step 3. Since 3 = al > b- = 1,
we append b1 to the list Â£3, which was initially empty. Then we relabel the
remaining elements 7 and 8 of Â£2 as bl, b2 respectively so that our lists are
3 
5 
8 
7 
8 
1
Â£o 
A2: 
and 
Â£;:
al 
a2 a3 
bI 
b2  
cl.
We then repeat Step 3. Since al < bl, we append al = 3 to Â£3 and relabel the
remaining elements 5 and 8 of Â£ I as al and a2, respectively. Our lists are now
1; 
5 8 
1; 
7 8 
and 
33: 
c 
3
al 
(12 
Â£:b
1
b2
ad 
Â£:C1 
C~2-

266 
Chapter 8 Algorithms
We repeat Step 3. Since ai I 
we append a I = 5 to Â£ 3 and relabel the elements
of Z i, obtaining
Z 8 
*:7 
8 
ad 
3 
1 
3 
5
Â£2. 
I
1 
b2  
an 
Â£3 
C1 
C2 
C3.
After the next repetition of Step 3 we have
ZI 8 
2 
8 
ad 
3 
1 
3 
5 
7
Â£2:b 
anC3 
Ij 
C2 
C3 
C4.
Now, since 8 =ai 
< b1 = 8, we append ai to Â£3, giving
C 
2 
8 
ad 
31 
3 
57 
8
Â£2: 
anCÂ£: 
C2 
C3 
C4 
C5.
Since Â£ I is now empty, we append 8, the remaining element Of Â£2, to Â£C3,
producing the final merged list:
1 
3 
578 
8
Â£3: C1 
C2 
C3 
C4 
C5 
C6. 
A
How many comparisons does the Merging Algorithm require to merge ordered
lists Â£ I and Â£2 of lengths s and t into a single ordered list Â£3 of length s Â± t?
Notice that while elements remain in Â£ I and Â£2, each element goes into Â£3 after
one comparison. Eventually one list is empty and at least one element remains in
the other; such remaining elements go to the end Of Â£3 with no comparisons. It
follows that, in all, at most s + t -
1 comparisons are needed.
PROBLEM 26. 
Find ordered lists of total length s +t 
=7which require exactly
7 -1 = 6 comparisons to merge.
Solution. 
The maximum number of comparisons, s + t- 
1, occurs when just
one number remains in one of the lists when the other is emptied. Here is such a
situation.
Â£]I2 
Â£3 
Comparisons Needed
1,3,5,7 
2,4,6
3,5,7 
2,4,6 
1
3,5,7 
4,6 
1,2 
1
5,7 
4,6 
1,2,3 
1
5,7 
6 
1,2,3,4
7 
6 
1,2,3,4,5 
1
7 
1,2,3,4,5,6 
1
1,2,3,4,5,6,7 
0
Total 
6
Find ordered lists of total length 7 which require just three comparisons to merge.
We are now able to describe an algorithm for sorting a list which is not
only more efficient than the bubble sort, but, in fact, achieves the theoretical best
possible worst case complexity. Here is the idea.
MM

8.3 Searching and Sorting 
267
EXAMPLE 27 
Suppose we are given the list
7, 11,5,9, 11,4, 10, 15, 17,3,9,6,21, 1
of length 14. We group the elements into seven pairs and order each pair. This
gives us seven pairs of ordered lists.
7, 11; 
5,9; 
4, 11; 
10, 15; 
3, 17; 6,9; 
1,21.
Next, we merge the first two ordered lists, merge the third and fourth ordered
lists, and merge the fifth and sixth. The last ordered list-1, 21-is unchanged.
5, 7, 9, 11; 
4, 10, 11, 15; 
3, 6, 9, 17; 
1, 21.
At this point, we have four ordered lists. We merge the first two and the last two,
giving
4,5,7,9, 10, 11, 11, 15; 
1,3,6,9, 17,21.
Finally, we merge the two lists that remain, obtaining the final ordered list
1,3,4,5,6,7,9,9, 10, lI, 11, 15, 17,21. 
A
In this example, it is useful to think of the given list as 14 ordered lists, each
of length 1. After the first step, we were left with seven ordered lists of length 2;
after the second, with four ordered lists; after the third, with two ordered lists, and
after the fourth, with the desired single ordered list. Since the number of ordered
lists is essentially halved at each stage, in general k steps will be needed to sort
a list of n elements, where 2 k- I < n < 2k. For example, 23 < 14 < 24, so four
steps are required to sort a list of length 14.
Here is a general description of our Merge Sort Algorithm.
To sort a list al , a 
.
a, into increasing order, proceed as follows.
Step 1. set F = 0.
Step 2. for i 
1 to n, let the list Zi be the single element ai.
Step 3. 
while F = 0
if n = 1, set F = 1 and output TCI;
if n = 2m is even
for i = I to m
. merge the sorted lists C2i-1 and Z2i
and label the resulting sorted list Zi;
. setn =m.
if n = 2m + 1 > 1 is odd
for i = 1 to m
. merge the sorted lists Â£2i-, and Â£2i
and label the resulting sorted list Â£,;
. change the label of the former list Â£n to Cm+1;
. set n = m + 1.
end while

268 
Chapter 8 Algorithms
The variable F in our algorithm is called aflag, a useful parameter to introduce
in an algorithm to enable fast termination of a loop. Here, it enables us to get out
of the "while" loop as soon as the merging is complete.
PROBLEM 28. 
What would the merge sort algorithm do with the list
2 
9 
1 
4 
6 
5 
3 ,
al 
a2 
a3 
a4 
a5 
a6 
a7
Solution. 
Initially F = 0 and lists LI, Â£2 .
Â£.. 
C7 are defined, each of length 1.
Â£I: 2 
Â£2:9 
Â£3: 1 
Â£4: 4 
Â£5:6 
Â£6:5 
Z7:3.
At Step 3, since F = 0 and n = 2(3) + 1 is odd (m = 3), we form four new lists
tl, Â£2, Â£3, Â£4 by merging the first six former lists in pairs into three and adding
the seventh. We now have
Â£I: 2,9 
Â£2: 1,4 
Â£3: 5,6 
Â£4: 3.
At this point, n is replaced by m + 1 = 3 + 1 = 4 and we repeat Step 3. Since
n = 2(2) is even (m = 2), we form two lists Â£I and Â£2 by merging the former
lists Â£I, Â£2 and Â£3, Â£4, respectively. At this point we have
Â£IC: 1,2,4,9 
Â£2: 3,5,6.
Now n is replaced by m = 2 and we repeat Step 3. Since n = 2(1) is even
(m = 1), the list Â£ 
is formed by merging the former Â£ 
and Â£2.
Lj: 1,2,3,4,5,6,9
At this point, n is replaced by m = 1 and we repeat Step 3. Since n = 1, we set
F = 1, output LI, the desired sorted list, and stop. 
I
What is the complexity of the Merge Sort Algorithm in terms of the number
of comparisons which are required? As with binary search, it is helpful first to
consider the case that the given list has length n = 2k because then Step 3 is
executed exactly k times. Also, we enter Step 3 each time with an even number
of lists and exit with an even number, until the last step.
Let us first ignore the at most three comparisons required to decide if n = 1,
n = 2m, or n = 2m + 1 > I each time Step 3 is executed and just count
comparisons required by the merging. Initially, we enter Step 3 with 2k lists, each
of length 1, which are merged in pairs. Each merge requires one comparison for
a total of 2k-1 = 2k -
2k-1 comparisons altogether. We pass through Step 3
a second time, entering with 2k-1 lists of length 2 which are merged in pairs.
Each pair is merged with at most 2 + 2 -
I = 4 - 1 comparisons, for a total of
2k-2 (4 -1) 
= 2k- 
2 k-2. The third time we execute Step 3, we enter with 2k 2
lists of length 4 which are merged in pairs. Each pair is merged with at most
4+4 - I = 8-I comparisons, for a total of 2 k-3 (8- I) = 2k- 
2 k-3 . Continuing

8.3 Searching and sorting 269
this line of reasoning, we see that pass i through Step 3 requires at most 2k - 2k-i
comparisons for the merging. The kth and final pass requires 2k - 1 comparisons,
the result of merging two lists of length 2k
In total, the merging in the algorithm requires at most
(1) 
(2 k -
2 k-1) + (2k -
2 k-2) + .
+ (2 k -
4 ) + ( 2 k-
2 ) + ( 2 
-1)
comparisons. There are k terms here. Since 1 + 2 + 4 + ... + 2k-1 = 2 k -
1 (see
Pause 4), the sum in equation (1) equals k2k -
(2 k -
1) = k2k -
2 k + 1. In all,
including the possible three checks to determine whether k = 1, k = 2m or k =
2n + I > 1, the algorithm requires at most 3k+(k2k -2k + 1) = k2k -2k +3k+ I
comparisons.
In general, for a list of n elements, find k such that 2 k-1 < n < 2 k. By
extending the list to one of length 2k (for example, by appending additional
elements larger than any number in the list), we see that the given list can be
sorted by sorting the larger list and then removing the additional large elements
from the end of the list. By the preceding analysis, it follows that the given list
can be sorted with at most k2k -
2k + 3k + I comparisons. Since 2 k-1 < n,
k < 1 + log2 n and 2k < 2n. So the number of comparisons is at most
k2k - 2k 
+ 3k + I <( + 1og 2 n)2k - 2 k+ 3k + I
==2klog
2 n +3k+ I
< 2nlog2n + 310g2 n +4.
Since 2n log2 n +3 log 2 n +4 - n log2 n, the number of comparisons is O(n log n).
Referring to Table 8.1 of Section 8.2, we note that this is a substantial improve-
ment on 0(n 2), the complexity of the bubble sort.
Explain why 1 + 2 + 4 + ...
+ 2k 1 = 2 k- 
1.
3. We want ordered lists with the property that after three comparisons one is
empty. Here is an example:
Ci 
Â£2 
Â£3 
Comparisons Needed
1,3 
2,4,6,8,9
3 
2,4,6,8,9 
1 
1
3 
4,6,8,9 
1,2 
1
4,6,8,9 
1,2,3 
1
1,2,3,4,6,8,9 
0
Total 
3
4. The terms in this sum are those of a geometric sequence with a = 1, r = 2,
n = k. The sum is a'-r" ) [See formula (8) on p. 167.]
-
S 
*.

270 
Chapter 8 Algorithms
The symbol [BB] means that an answer can be found in the Back of the Book.
1. (a) [BB] Show the sequence of steps in using a binary
search to find the number 2 in the list 1, 2, 3, 4, 5,
6, 7, 8, 9. How many times is 2 compared with an
element in the list? How many times would it be
compared with an element in the list if we employed
a linear search?
(b) Repeat (a) if we are searching for the number 7.
2. (a) Describe a ternary search algorithm, which searches
an ordered list for a given element by successively
dividing the list into thirds and determining in which
third the element must lie.
(b) Show that the complexity of the algorithm found in
(a) (in terms of comparisons) is 0(log 3 n).
3. (a) [BB] Describe an algorithm which, upon input of
k numbers, each in the range 1-100 (inclusive),
outputs the complement of this set with respect to
U = {1, 2, ... , 100}.
(b) Repeat (a) if 100 is replaced by n. Find a Big Oh
estimate for the complexity of your algorithm, in
terms of comparisons.
4. [BB] Show the sequence of steps involved in merging
the sorted lists 1, 2, 3, 4, 5 and 2, 4, 6, 8, 10. How many
comparisons are required?
5. Rewrite the Merging Algorithm using a flag to prevent
the program from exiting during Step 1.
6. [BB] Sort the list 3, 1, 7, 2, 5, 4 into increasing order
(a) with a bubble sort;
(b) with a merge sort.
In each case, how many comparisons are needed? (For
the merge sort, ignore comparisons required to check
the size and parity of n at each iteration of Step 3.)
7. Repeat Exercise 6 for the list 10, 11, 15, 3, 18, 14, 7, 1.
8. [BB] The median of a list of numbers is the middle
number or the average of the middle two numbers, after
the numbers have been listed from smallest to largest.
Describe an algorithm for finding the median of an input
list of n numbers. Find a Big Oh estimate of the com-
plexity of your algorithm.
9. Suppose that the eight elements a, b, c, d, u, v, w, x are
ordered
d <a <u <c <x <b <v <w.
(a) [BB] Show the steps in a bubble sort applied to the
list a, b, c, d, u, v, w, x. How many comparisons
are required?
(b) Repeat (a) using a merge sort.
10. [BB] Find an example of two ordered lists of lengths s
and t > 3 which can be merged with
(a) one comparison
(b) t comparisons
(c) exactly s + t - I comparisons. (For this part, assume
also that s > 3.)
11. (a) [BB] Show the steps involved in the application of
a bubble sort to the list c, a, e, b, d, where these
letters have their natural alphabetical order.
(b) Apply the same sequence of interchanges 
as
required in part (a) to the list 1, 2, 3, 4, 5; that is,
if it is necessary to interchange the second and third
elements at a certain stage in the bubble sort of (a),
then interchange the second and third elements at
the same stage in the "sort" of 1, 2, 3, 4, 5. The final
sequence is 2, 4, 1, 5, 3, which describes the order
in which the elements of c, a, e, b, d must be taken
to list them in order.
(c) Describe an algorithm whose input is a list al,
a2, 
.
., a, whose natural order is a,,, aj2 . .
, ajn
and whose output is the sequence of indices il,
i2, 
.
., in (in this order).
12. We explained in the text why the Merging Algorithm
requires at most s + t -1 comparisons to merge ordered
lists of lengths s and t. For arbitrary s and t, do there
exist ordered lists of these lengths for which precisely
s + t - I comparisons are needed to merge? Explain.
13. The Binary Search Algorithm we have presented appears
to be more efficient than a linear search, 0(logn) ver-
sus 0(n), but the binary search assumes the input list
is ordered. Suppose we modify the Binary Search Algo-
rithm so that it accepts an unordered list as input by first
using an efficient sorting algorithm and then the binary
search as described in this section. Is this new algorithm
still more efficient than a linear search? Explain.
14. [BB] What is the fewest number of comparisons
required to merge ordered lists of lengths s and t?
Explain your answer.

15. Ignoring repeated checks as to whether n = 1, n = 2f,
or n = 2e + 1 > I, we showed in the text that the number
of comparisons in any merge sort of 2k elements is at
most k2k -
2k + 1. Give a specific example of a list of
length 2k, where precisely k2k -
2k + I comparisons are
required.
16. [BB] In order to output the distinct items of a given list
al , a2, ... 
, a., the following method is proposed. For
each k, search the elements preceding ak and, if ak is
not found, output ak. Show that this algorithm can be
accomplished with 0(logn!) comparisons.
17. Modify the Bubble Sort Algorithm to find an algo-
rithm which reverses a sequence; that is, upon input
8.4 
ENUMERATION OF
8.4 Enumeration of Permutations and Combinations 
271
of al, a2 .
an, the algorithm outputs the sequence
an, an -
, ..
a2, al. How many swaps are required?
Give a Big Oh estimate of complexity.
18. [BB] It is suggested that one way of searching for a
number x in a given unordered list is first to sort the
list using a merge sort and then to use a binary search
algorithm. Is this more or less efficient than a linear
search?
19. Given a list al, a2,..., an, each item of which is
0 or 1, it is desired to put the list into increasing
order. Would you use one of the sorting methods dis-
cussed in this section, or is there a better method?
Explain.
PERMUTATIONS AND COMBINATIONS
A truck driver for Deluxe Bakery has to deliver bread to many supermarkets scat-
tered throughout a large metropolitan area. She has a map showing the precise
locations of her delivery points. She knows how long it takes to drive from the bak-
ery to each point and how long it takes to drive between any two delivery points.
In what order should she deliver bread in order to minimize total traveling time?
This problem, known as the Traveling Salesman's Problem, will be encountered
again. Here, it serves to illustrate a situation where we would like to enumer-
ate permutations. Assigning the supermarkets the numbers 1, 2, . . ., n, the truck
driver ideally would like to list all the permutations of 1, 2, ... , n and, for each
permutation, determine the time required for the route which visits supermarkets
in the specified order.
To list all the permutations of a set of two or three or even four elements is not
difficult. To enumerate all the permutations of larger sets becomes first tedious,
and then ridiculous, at least by hand, because n! grows so very rapidly with n:
For instance, 15! is roughly 1012.
To list all permutations of ten elements, say, it would seem sensible to enlist
the support of a computer. For this, of course, a suitable algorithm is required, an
algorithm which, upon input of a positive integer n, outputs a complete list of all
the permutations of 1, 2, .. ., n without omission or repetition. We are confronted
with two problems.
* How should the permutations be ordered?
* Given a permutation, how is the next one determined?
Lexicographic order-the way words are ordered in a dictionary-is one way
to order permutations. In a dictionary, terrible precedes terrific because, reading
from left to right, the first place where the words differ is at the sixth letter, and
there b precedes f in the natural ordering of the letters of the alphabet. So we
list the permutation beadc before bedca, but after bcaed. In a similar way, if the

272 
Chapter 8 Algorithms
: 
*e*e 
S
EXAMPLE 29
EXAMPLE 30
symbols are numbers instead of letters, 1357264 precedes 1357624 but follows
1347256.
With respect to lexicographic ordering, there is a procedure for finding the
permutation which follows any given permutation.
When the permutations of 1, 2, ... , n are ordered lexicographically, the permu-
tation which follows a particular permutation Jr is obtained by
.
reading the digits in -r from right to left,
.
noting the first consecutive pair xy where x < y,
.
replacing x by the smallest of those digits to its right which are larger than
x, and then
.
writing down in increasing order the digits not yet used.
The permutation following 1374652 is 1375246 because, reading from right to
left, the first consecutive pair xy with x < y is 46, so we replace 4 by 5, the
smallest digit to its right which is larger than 4, giving an initial string 1375,
which is completed by writing down the unused digits, 2, 4, and 6, in increasing
order. 
A
The permutations of 1, 2, 3, 4 in lexicographic order are
1234 
1243
2314 
2341
3412 
3421
.4 
*WA-1 S.lINI
-
~ Lii I 4 NA I IM~
Ia I- 
S6
1324
2413
4123
1342
2431
4132
1423 
1432 
2134 2143
3124 
3142 
3214 
3241
4213 
4231 
4312 
4321.
A
To enumerate all permutations of 1, 2, ... , n, the following algorithm can
be used.
Given a natural number n, to enumerate the n! permutations of 1, 2, . . , n, pro-
ceed as follows.
Step 1. Set t = 1. Output Perm(l) = 123... .n. If n = 1, stop.
Step 2. For t = 1 to n! - I, given permutation Perm(t) = W1j 2 ... 7rn, determine
the next permutation Perm(t + 1) as follows:
. find the largest j such that 7rj < rj+l;
. let m = min{rT I i > j, Ar > 7Tj);
. let S be the complement of the set {c1r .... 
7j-
to U = {1, 2,... ,n;
* sort the elements of S in increasing order, bl <
. output Perm(t + 1) = 7rl ... 7rj_ 1mbj ... b 
j.
, m } with respect
b2 < ..
' 
b,-j;
With n = 3, for example, the permutations of 1, 2, 3 are generated as shown
in Table 8.2.
Any algorithm which involves n! steps will take a long time to run, even
for relatively small n. For example, at a million operations per second, 12! oper-
ations require almost eight minutes. In the Exercises, we ask you to show that
the algorithm just described can be implemented with complexity 0(n!n). (See
Exercise 3 at the end of this section.)

8.4 Enumeration of Permutations and Combinations 
273
Table 8.2 
The permutations of 1, 2, 3 as generated by Algorithm 8.4.2.
t 
Perm(t) 
j 
m 
S
1 
1 2 3 
2 
3 
{7rl, mlc = {1, 31c = 12}
7 I J727 3
2 
1 3 2 
1 
2 
{ml' = {2lc = {1, 3}
3 
2 1 3 
2 
3 
7r1,m}c = {2, 31c = {I}
7rI 7T27r3
4 
2 3 1 
1 
3 
{m}c = {31c = {1, 21
7rl r27r3
5 
3 1 2 
2 
2 
{wr7,mlc = {3,21c = {11
71I 72 73
6 
3 2 1
Deluxe Bakery is considering the introduction of bagels to its traditional
product lines of bread and pastries and decides to select 6 of the supermarkets
which carry its products for a trial. Towards this effort, it would be helpful for the
marketing manager to review a list of all possible choices in order to choose the
most useful 6. What is required then is a listing of all combinations of supermarkets
taken 6 at a time.
As with permutations, combinations will be listed lexicographically; how-
ever, this time we must be careful to avoid listing both 142897 and 218479,
for instance, since these represent the same combination. Suppose we agree to
list elements in their natural (increasing) order, so that rather than 142897 or
218479, we will write 124789. Imagine that the combination uvwxyz appears
in our list. Then u < v < w < x < y < z and so, if these symbols come
from { 1, 2,...,72}, it is apparent, for instance, that y cannot be 72 and x
can be neither 71 nor 72. The largest possible value for z is 72, the largest
for y is 71, the largest for x is 70, the largest for w is 69, the largest for
v is 68, and the largest value for u is 67. Also, the smallest combination is
123456.
When the combinations of 1, 2, .
n taken r at a time are ordered lexicograph-
ically, the first combination is 123. . .r and the combination which immediately
follows a given one is obtained by
.
reading the combination from right to left until the first digit which can be
increased is found,
.
adding 1 to this digit (suppose this number is now k),
.
leaving the digits before k as they were, but following k by k + 1, k + 2, ....
and so on until r digits in all have been written down.
0:9 
S

274 
Chapter 8 Algorithms
In the lexicographic ordering of the combinations 1, 2, ... ,9 taken six at
a time, what combination follows 134589? Reading from right to left, the first
digit which can be increased is 5. Increase this to 6 (so that the combination
begins 1346) and complete the combination with 78, giving 134678. What follows
236789? The first digit which can be increased is 3. Increase this to 4 (the next
combination begins 24) and complete with 5678, giving 245678.
In the lexicographic ordering of the combinations of 1, 2, 3, 4, 5, 6 taken four
at a time, after 1346 come 1356, 1456, 2345, 2346, 2356, and so on. The combi-
nations of 1, 2, 3,4, 5 taken three at a time are
123,124,125,134,135,145,234,235,245,345.
The symbol [BB] means that an answer can be found in the Back of the Book.
1. (a) [BB] With a table like Table 8.2, show the steps
involved in the enumeration of the first eight per-
mutations of 1, 2, 3, 4.
(b) Repeat (a) for the second eight permutations of
1,2,3,4.
(c) Repeat (a) for the last eight permutations of
1,2,3,4.
2. (a) Use the procedure outlined in this section to list the
first 20 permutations of 1, 2, 3, 4, 5.
(b) [BB] In the lexicographic ordering of the permuta-
tions of 1, 2, 3, 4, 5, what five permutations come
after 42513?
(c) In the lexicographic ordering of the permutations of
1, 2, 3, 4, 5, what five permutations precede 42513?
3. (a) [BB] Show that the complexity of Algorithm 8.4.2
for enumerating permutations is O(n!n log n), in
terms of comparisons.
(b) Improve the estimate in (a) by showing how to
achieve 0(n!n).
4. Let 7r' = Perm(t + 1) be the permutation derived from
Perm(t) = 7r as in Proposition 8.4.1.
(a) Prove that 7r 
< 7r', where -< means precedes in
lexicographic order.
(b) Prove that if a is a permutation satisfying 7r -< a -<
7r', then a = ir. Thus, or' is the immediate successor
of 7w relative to lexicographic ordering of permuta-
tions. (Here r -< a means or -< (a or or = (Y.)
5. List, in lexicographic 
order, all combinations 
of
1,2,3,4,5,6
(a) [BB] taken four elements at a time;
(b) taken three elements at a time.
6. In the lexicographic ordering of all combinations of
1, 2, ... , 9 taken five at a time, list, if possible, the three
combinations which immediately precede and the three
which immediately follow
(a) [BB] 23469,
(b) 13567,
(c) 45789.
7. (a) List, in lexicographic order, the combinations of
1, 2, 3, 4, 5, 6, 7 taken two at a time.
(b) [BB] Use Proposition 8.4.3 and Algorithm 8.4.2 to
describe an algorithm for enumerating the permuta-
tions of 1, 2, . . ., n taken r at a time, not necessarily
in lexicographic order.
(c) Use parts (a) and (b) to list all permutations of
1, 2, 3,4, 5, 6,7 taken two at a time.
8. (a) [BB] List, in lexicographic order, all combinations
of 1, 2, ... , 8 taken six elements at a time.
(b) List, in lexicographic order, the first ten and the
last ten combinations of 1, 2, .
8 taken three at a
time.
(c) Use the list in (b) and the method proposed in
Exercise 7(b) to enumerate the first ten and the last
ten permutations of 1, 2, . . , 8 taken three at a time.
ff 9, TIMM M - 


Review Exercises 
275
9. [BB] Prove Proposition 8.4.3.
10. [BB] Suppose ala2a3 . . . a, appears in the lexico-
graphic ordering of the combinations of the integers
1, 2, 3, . . , n taken r at a time, where al < a2 < a3 <
* 
< ar .
(a) What is the biggest possible value for ar? For a 1?
For aj ?
(b) Under what conditions is this the first combination
in the list?
(c) When is it the last?
11. [BB] Describe an algorithm which enumerates all com-
binations of 1, 2, . . ., n taken r at a time.
12. Suppose a set S has kn elements for natural numbers
k and n. Describe an algorithm which will output all k
element subsets of S.
, i ii 
S
1. Describe how Horner's algorithm evaluates f (x) when
(a) f (x) = 2x3 -4x + I and x =-3
(b) f(x) =x
4 -2x
3 +x 2 -5x+6 andx= 2
2. Use the Russian peasant method to find
(a) 149 x 712
(b) 1018 x 72
3. Let n > I be an integer, let S = {12, 
2 
nI and
let RZ = ((al, bl), (a2, b2 ), . . , (at, bt)1 be a subset of
S x S. Describe algorithms which determine whether or
not the relation 7? is
(a) reflexive;
(b) symmetric;
(c) antisymmetric;
(d) transitive;
(e) a function.
In each case, find a reasonable estimate of the complex-
ity of your algorithm.
4. Suppose we want an algorithm which, for an input of
integers a, a2,... ,an, outputs the largest and second
largest integers. It is proposed to sort the list in decreas-
ing order and to output the first two integers of the sorted
list.
(a) In terms of comparisons, what is the best complexity
function for this algorithm?
(b) Is there a better way to proceed? Explain and, if the
answer is yes, describe a better algorithm.
5. Describe an algorithm which upon input of a list
al, a2 .. 
,a,, of integers, outputs the largest and the
smallest numbers of the list.
6. Describe an algorithm which implements the floor func-
tion; that is, upon input of a real number x, the output
is Lxi.
7. (a) Show that Ik + 2k Â± 
+ nk = O(nk+1) for any
k> 1.
(b) Show that 12 
+ 
22 + 
+ n2 - n3.
8. Show that
(a) 3n 3 -5n
2 + 2n + I 
n 3 ,
(b) n4 -2n 3 +3n
2 -5n+7 
n4.
Do not merely quote Proposition 8.2.7, but you may use
ideas from its proof.
9. (a) (Requires a little knowledge of calculus) Show that
3 
n
1Â±+2Â±+3Â±. 
+ 
+n-=O(7(ogn).
(b) Show that the Sieve of Eratosthenes, used to find all
primes less than or equal to a given integer n, can be
implemented with an algorithm which is O(n log n).
Count comparisons and "crossing out" an integer
as basic operations. (See Section 4.3 and especially
paragraph 4.3.5.)
10. Show the sequence of steps 
in using a binary
search 
to 
find 
the 
number 
5 
in 
the 
list
-8, -5, -1, 0, 1, 2, 4, 5, 8, 9, 12. 
How 
many 
times
is 5 compared with an element in the list? How many
times would it be compared with an element in the list
if we employed a linear search?
11. Show the sequence of steps involved in merging the
sorted lists-1, 3, 7, 10, 12, 5 and -4, -3,-1, 2. How
many comparisons are required?
12. Sort the list 9, -3, 1, 0, -4, 5, 3 into increasing order
(a) with a bubble sort;
(b) with a merge sort.

276 
Chapter 8 Algorithms
In each case, how many comparisons are needed? (For
the merge sort, ignore comparisons required to check
the size 
and parity 
of n at each 
iteration 
of
Step 3.)
13. In the lexicographic ordering of the permutations of
1, 2, 3, 4, 5, 6, list the 20 permutations which follow
463152.
14. In the lexicographic ordering of all combinations of
1, 2, ... , 7 taken four at a time, list, if possible, the
three combinations which immediately precede and the
three which immediately follow
(a) 3467,
(b) 1236,
(c) 2347.

* 
9.
Graphs
9.1 
A GENTLE INTRODUCTION
There are many concrete, practical problems that can be simplified and solved by
looking at them from a different point of view. The Konigsberg Bridge Problem,
which we will soon describe, was a long-standing problem until it was imagina-
tively solved in 1736 by the great Swiss mathematician LUonhard Euler (1707-
1783). Beginning his scientific career shortly after the death of Sir Isaac Newton,
Euler spent the last 17 years of his life blind, but still very active. Some of his
mathematical contributions were to the theory of convergent sequences and to the
calculus of variations. Much of what is taught today about quadratic equations,
conic sections, and quadrics in Euclidean space is just as Euler himself laid out.
Perhaps less known is that Euler was a superb designer of algorithms; he had the
uncanny ability of making order out of chaos, of seeing simple routes through
the most complicated situations. It is because of his imaginative solution to the
Konigsberg Bridge Problem that Euler is generally considered to be the father of
modern-day graph theory.
In the eighteenth century, Kinigsberg was the capital of East Prussia.' The
Pregel River flowed through town and split into two branches around Kneiphof
island, which is labeled A in Fig 9.1. Seven bridges crossed the river, provid-
ing links among the four land masses labeled A, B, C, D in the figure. Peo-
ple wondered if it were possible to start on one of the land masses, walk over
each of the seven bridges exactly once, and return to the starting point (without
getting wet).
To find an abstract mathematical model of a concrete problem can be a difficult
task requiring both ingenuity and experience. The primary aim of this chapter is to
provide the reader with some of this experience by presenting several real-world
'An ice-free port on the southern coast of the Baltic Sea, K~nigsherg was completely destroyed during
World War IL. It was renamed Kaliningrad and transferred to the Soviet Union in 1945. Today, it is the
westernmost city in Russia.
277

278 
Chapter 9 Graphs
Figure 9.1 
The bridges of Konigsberg.
problems and showing how they can be formulated in mathematical terms. This
process of translation into mathematics forces us to sift through all the details
of the problem, deciding which ones are important and which are extraneous.
(Those aspects of a "real" problem which make it interesting are sometimes quite
irrelevant and serve primarily to create confusion!) Because the language of math-
ematics is precise and without ambiguity, problems which seem complicated when
expressed in ordinary language often have surprisingly straightforward mathemat-
ical translations.
C
A
B
D
Figure 9.2 
A graphical representation of the Kdnigsberg Bridge Problem.
For the Konigsberg Bridge Problem, Euler's idea was to realize that the phys-
ical layout of land, water, and bridges could be modeled by the graph shown in
Fig 9.2. The land masses are represented by small circles (or vertices) and the
bridges by lines (or edges) which can be straight or curved. By means of this
graph, the physical problem is transformed into this mathematical one: Given the
graph in Fig 9.2, is it possible to choose a vertex, then to proceed along the edges
one after the other and return to the chosen vertex covering every edge exactly
once? Euler was able to show that this was not possible. Can you? (We shall
return to this problem and discuss its solution in Section 10.1, in the context of
Eulerian circuits.)
The Three Houses-Three Utilities Problem is another physical situation
which can be modeled by means of a graph. There are three houses, each of which
is to be connected to each of three utilities-water, electricity, and telephone-by
means of underground pipes. Is it possible to make these connections without any
crossovers? 
Figure 9.3 
shows 
how 
to 
describe 
this 
problem 
with 
a
graph.
The houses and the utilities are represented by vertices and the pipes are the
lines drawn between the vertices. When we discuss planar graphs in Chapter 14,
we shall see that the answer to our question is no. Can you convince yourself of
this now?

9.1 A Gentle Introduction 
279
Figure 9.3 
The Three Houses-Three Utilities Problem.
For a long time, there has been on the market a popular game called "Instant
Insanity," which consists of four cubes, each of whose six faces is colored with
one of four colors: red, blue, green, white. The object is to stack the cubes in
such a way that each of the four colors appears on each side of the resulting
column. Since there are over 40,000 possible ways to stack such cubes,2 it is easy
to understand how this game got its name! Certainly there ought to be a better
way to solve this puzzle than trial and error. To illustrate the method we have in
mind, we first need a way to picture a three-dimensional cube on paper. We do
so as indicated in Fig 9.4, where we imagine that the cube has been opened and
flattened, as if it were a small cardboard box.
Figure 9.4 
A way to picture a cube.
In Fig 9.5, we depict the four cubes of one version of "Instant Insanity" in
this way and show a graph which records the pertinent information about them.
The graph has four vertices, labeled R, B, G, and W, corresponding, respec-
tively, to the four colors red, blue, green, and white. There is an edge labeled
3 joining vertices W and G because cube 3 has a white face and a green face
on opposite sides of the cube. Cube 3 also has a white and red pair of oppo-
site faces, so vertices W and R are joined with an edge labeled 3. For a similar
reason, there is an edge labeled 3 joining vertices B and R. The circle labeled
1 at vertex R corresponds to the fact that cube 1 has a pair of opposite red
faces.
Once again, a concrete physical problem has been represented by a graph.
You do not have to visit Konigsberg to simulate the Kbnigsberg Bridge Problem;
you do not need to build any houses to simulate the Three Houses-Three Utilities
2The exact number is 
(64 x 43) = 41,472.
I

280 
Chapter 9 Graphs
Figure 9.5 
Four colored cubes and a graphical representation.
Problem; you do not even have to possess the actual cubes of "Instant Insanity"
in order to play.
The graph in Fig 9.5 describes the four cubes of "Instant Insanity." Could it
also be used to describe a stacking?
FRONT 
BACK
W 
Cube 4 
i
R 
Cube 3 
W
G 
Cube 2 
W
n 
-. -
-
1 
W1
Figure 9.6 
LD1 
uUDe I 
ISI
Cube I in Fig 9.6 has its blue face at the front and white face at the back.
This orientation can be shown in the graph by emphasizing the edge labeled I
joining vertices B and W. Similarly, the green-white, red-white, and white-blue
front-back faces can be shown by emphasizing three other edges in the graph.
The stacking shown on the left of Fig 9.6 determines the subgraph on the right.
This stacking does not solve the puzzle, however, because there are too many
white faces at the back; moreover, any rotation of any of the cubes through 180Â°
always results in more than one white face at the front or the back. This is more
easily seen by observing that in the subgraph, there are too many edges joined to
vertex W. On the other hand, there are exactly two edges in the subgraph (I and
4) joined to vertex B, corresponding to the fact that there is just one blue face on
the front (part of the B-W pair of faces of cube 1) and just one blue face at the
back (part of the W-B pair of faces of cube 4).
When the cubes are stacked with their fronts and backs correct (that is,
with four different colors on the front and four different colors on the back), the
corresponding subgraph will
.
contain all four vertices R, B, W, G;
.
consist of four edges, one from each cube;
.
have exactly two edges or one circle meeting at each vertex.

9.1 A Gentle Introduction 
281
Figure 9.7 shows two subgraphs, each of which corresponds to a stacking of
cubes in which the fronts and backs are correct.
A 
-
Figure 9.7 
Two acceptable subgraphs which are not edge disjoint.
Draw an arrangement of fronts and backs (like that on the left in Fig 9.6), which
is represented by the subgraph on the left in Fig 9.7. All four colors should appear
on the front and on the back.
As anyone who has tried this puzzle knows, getting the front and back of the
column correct is easy. It is next to get the sides correct that provides the fun(?).
Graphically, we require a second subgraph of the type described previously to
represent a correct stacking of the sides. Moreover, since a given edge cannot
represent both front-back and side-side at the same time, the second subgraph
must be edge disjoint from the first: No edge can appear in both subgraphs. The
subgraphs shown in Fig 9.7, for instance, are not edge disjoint; they have edges 3
and 4 in common. On the other hand, the subgraphs shown in Fig 9.8 are indeed
edge disjoint and so provide us with a solution to "Instant Insanity," as shown in
Fig 9.9.
Figure 9.8 
Two acceptable edge disjoint subgraphs.
Cube 4
Cube 3
Cube 2
Cube 1
FRONT 
BACK 
RIGHT 
LEFT
B 
R 
W 
B
G 
W 
B 
R
R 
G 
G 
W
W 
B 
R 
G
Figure 9.9 
A solution to the game of "Instant Insanity."
I
I
M

282 Chapter 9 Graphs
77= 
-
While our game of "Instant Insanity" had a unique solution, if we try to make
other games by assigning colors to the faces of four cubes in other ways, it is not
hard to find games where there are several winning configurations or where there
is no solution at all. Also, whereas the subgraphs for our game had certain special
properties, such as connectedness3 and a lack of edge crossovers, in general,
be on the lookout for other types of subgraphs, three of which are depicted in
Fig 9.10.
B 
R
W 
G
0 
R
W 
G
B 
SsR
W 
G
Figure 9.10 
Possible subgraphs for other cube games.
Newspapers and magazines often contain mathematical teasers whose solu-
tions can be helped by drawing simple graphs. We close this section with an
example of one such puzzle and include another in the exercises for this
section.
PROBLEM 1. 
You and your buddy return home after a semester at college and
are greeted at the airport by your mothers and your buddy's two sisters. Not
uncharacteristically, there is a certain amount of hugging! Later, the other five
people tell you the number of hugs they got and, curiously, these numbers are all
different. Assume that you and your buddy did not hug each other, your mothers
did not hug each other, and your buddy's sisters did not hug each other. Assume
also that the same two people hugged at most once. How many people did you
hug? How many people hugged your buddy?
Solution. 
The conditions on who did not hug whom dictate that no person
hugged more than four people. Since the other five hugged different numbers
of people, this set of numbers must be {0, 1, 2, 3, 4}.
Next, it is important to realize that the
person who hugged four others could not be
your buddy. Why? The graph to the right
should help. The four people other than you
and your buddy are labeled Al, A2, BI, B2,
and an edge indicates a hug. Think of A 1 and
A2 as sisters (or mothers), and B1 and B2 as
You 
Al 
BI
0 
:
Buddy 
A2
B2
mothers (or sisters).
Remembering that you and your buddy did not hug, the graph shows that if
your buddy had four hugs, it would be impossible for one of the group Buddy,
Al, A2, Bl, B2 to have reported no hugs. Thus, your buddy could not have had
four hugs.
3A graph is connected if any two vertices are joined by a sequence of edges. We shall introduce the
notion of connectedness formally in Section 10.1.

9.1 A Gentle Introduction 
283
So the person who got four hugs is among the group Al, A2, B 1, B2 . Suppose
AI got four hugs. (The argument which follows works in precisely the same way
if we assume A2 or B. or B2 was the one with four hugs.) Since AI did not hug
A2, the hugging involving Al is as depicted in Fig 9.11(a).
Figure 9.11
You 
Al 
B1
Buddy 
A2  
B2
(a)
You 
Al 
B.
0
Buddy 
A2  
B2
(b)
Since one of the group Al, A2, BI, B2 received no hugs, it is apparent that
this person was A2. Consider again Fig 9.11(a). Since you didn't hug your buddy
and B1 didn't hug B2 , the only possible hugs not pictured there are between you
or your buddy and B1 or B2.
Somebody received three hugs. Who could that be? If it were your buddy,
he would have had to hug both B1 and B2, leaving nobody with only one hug.
We conclude that either B1 or B2 received exactly three hugs. There is no loss
of generality in assuming it was B2. Thus, B2 hugged Al, you and your buddy.
Your buddy now hugged at least two people (AI and B2), so it follows that B1
must be the person who had one hug. The final situation is shown in Fig 9.1 1(b).
You and your buddy each hugged two people. 
I
* 
=-*.
1. There are several possibilities for the
fronts and backs of cubes which
correspond to the subgraph shown in
Fig 9.7. Here is one.
FRONT
X
X
BACK
X
X
A
X
Cube 4
Cube 3
Cube 2
Cube 1
The symbol [BB] means that an answer can be found in the Back of the Book.
1. [BB] (Fictitious) A recently discovered map of the town
of Konigsberg shows that there was a ferry operating
between the banks labeled C and D in Fig 9.1. Draw
a graph in which the vertices are land masses and an
edge between two vertices corresponds to a way to move
between corresponding land masses.
2. [BB] Draw a configuration of two houses and two util-
ities, each house connected to each utility, but with
no crossovers.
3. One of the owners of the houses in the Three Houses-
Three Utilities Problem does not want a telephone. Is
it now possible for the houses to be connected to util-
ities without crossovers? Draw a graph depicting the
situation.
4. Find solutions, where possible, for the cube games pic-
tured in Fig 9.12.

284 
Chapter 9 Graphs
J1 L-
I 
I 
I
R 
ube 2
G 
W BG 
Cube 4
W 
X BBRL
W
(el 
(d)
R 
Cube 1
RBW 
R 
R 
G 
Cue
R EG 
Cub,
B i G W 
R 
Cube4
]G 
R GGG
B
(Pe [RB1 
(f
k&J 
L-
B 
Cube 1
I R 
G GI R|
LG
F.1 
-llhn
w 
R 
B 
W 
G 
Cube4
-~ 
W 
ER -W -F
WB
w~~
Figure 9.12 
Cubes for Exercise 4.
] R 
Cube 3
B G 
R I G |
(al [RR] 
(h)
k-l

9.1 A Gentle Introduction 
285
(h)
Figure 9.12 
Continued
5. Suppose the vertices of a graph represent cities in a cer-
tain region and an edge joining two vertices indicates
that there is a direct (nonstop) flight between those two
cities. Geographers define the beta index of a graph as
the ratio of the number of edges to the number of ver-
tices, and view this number as a measure of connectiv-
ity of the region. Highly developed countries have high
beta indices; poorly developed countries have low beta
indices. Find the beta index of each of the following
graphs.
V2 
V6 
V4
(a) [BB]
VI 
V3 
V5
(b) 
v 
V 
V4 
V6
V3 
V5 
V7
6. [BB] In the graph shown, the vertices represent the
rooms of a one-story house and an edge between ver-
tices means that the corresponding rooms have a wall
in common. Draw a possible floor plan for this
house.
6
7. You and a friend meet three other couples at a party
and several handshakes take place. Nobody shakes hands
with himself or herself, there are no handshakes within
couples, and no one shakes hands with the same per-
son more than once. The numbers of hands shaken by
the other seven people (excluding you) are all different.
How many hands did you shake? How many hands did
your partner shake? Use a graph to aid your solution.
8. (a) A graph has six vertices every two of which are
joined by an edge. Each edge is colored red or white.
Show that the graph contains a monochromatic tri-
angle.
(b) Is the result of (a) true for a graph with five vertices?
Explain.
9. [BB] A graph has six vertices every two of which are
joined by an edge. Each vertex is colored red or white.
Show that the graph contains at least two monochro-
matic triangles.
10. A graph has six vertices, every two of which are joined
by an edge. Each edge is colored red or white. Show
that the graph contains at least two monochromatic tri-
angles.
("I11 
F, 11

286 
Chapter 9 Graphs
9.2 
DEFINITIONS AND BASIC PROPERTIES
ILl 
I g [eI iÂ± I
S 
S
Having used the term "graph" quite a bit already, it is time now to define
the word properly and to introduce some of the basic terminology of graph
theory.
A graph is a pair (V, Â£) of sets, V nonempty and each element of Â£ a set of
two distinct elements of V. The elements of V are called vertices; the elements
of Â£ are called edges. Thus, if e is an edge, then e = { v, w }, where v and w
are different elements of V called the end vertices or ends of e. (Colloquially, we
often say that the edge e = { v, w } joins vertices v and w.) We usually abandon
set notation and refer to the edge vw; this is, of course, the same as the edge
wv. The vertices v and w are said to be incident with the edge vw; the edge
vw is incident with each vertex. Two vertices are adjacent if they are the end
vertices of an edge; two edges are adjacent if they have a vertex in common.
The number of edges incident with a vertex v is called the degree of that vertex
and is denoted deg v. If deg v is an even number, then v is said to be an even
vertex; if deg v is an odd number, vertex v is odd. A vertex of degree 0 is said
to be isolated. In this text, graphs will always be finite, meaning that the set of
vertices and, hence, also the set of edges, are finite sets. Finally, when we say
that g(V, Â£) is a graph, we mean that g is a graph with vertex set V and edge
set Â£.
Usually we draw a picture of a graph rather than presenting it formally as
sets of vertices and edges. For instance, the graph g with vertices
V = {vl, V2, V3, V4, vs5, 
V6
and edges
{V 
= 
IV4, VIV6, V2V5, V4V5, V5V6)
can be described as shown in Fig 9.13.
vI 
V2 
V3
V4 
V5 
V6
Figure9.13 
A picture of g(V,E), where V = {vlv2,v3,v4,v5,v6} and Â£ = {Vlv 4,vlv 6 ,v2vS,
v4 v5, vsV6 )-
Many of the graphs presented in Section 9.1 are not graphs at all according to
our definition! Many of them have multiple edges, that is, several edges incident
with the same two vertices. Some of them have a loop at a vertex, that is, an
edge which is incident with only one vertex. Since most of the graphs of interest
to us will have neither multiple edges nor loops, we have opted for the definition
of "graph" presented here. Nevertheless, it is convenient to have a term for more

9.2 Definitions and Basic Properties 
287
general types of graphs which do arise from time to time. A pseudograph is like
a graph, but it may contain loops and/or multiple edges.
VI 
V4
e2 
el 
e4
lV2 
e3 
V3 
Ce
Figure 9.14
Figure 9.14 illustrates a pseudograph with four vertices and five edges. Ver-
tices VI and v2 are incident with edges el and e2; thus, el and e2 are multiple
edges. Edge e4 is incident with vertices V3 and v4. Edge es is a loop because it is
incident only with vertex V3. Vertices v2 and V3 are adjacent while vl and V3 are
not. Edges el and e3 are adjacent while el and e4 are not. Vertex VI has degree
2, so vi is an even vertex. Counting the loop incident with V3 twice (as it enters
and leaves), V3 is also an even vertex, with degree 4. Vertices v2 and V4 are odd:
deg v2 = 3 and deg N4 = 1.
It is unfortunate that there is some lack of standardization of terminology
in graph theory, especially in a subject which has more than its share of tech-
nical terms. Many words have almost "obvious" meanings, which are the same
from book to book, but other terms are used differently by different authors. It
is consequently vital when perusing books or articles on graph theory never to
assume that you know the meanings of the graph theoretical terms employed.
Always check the author's definitions carefully. For convenience, the definitions
which we employ in this book are summarized in a glossary at the end. Read-
ers may have also noticed on the inside covers a description of symbols and
notation.
A graph 51 is a subgraph of another graph g if and only if the vertex and edge
sets of g1 are, respectively, subsets of the vertex and edge sets of g.
EXAMPLE 2 
Each of the three graphs 51, 52, and 53 shown on the right of Fig 9.15 is a
subgraph of the graph 5 on the left in this figure. (The subgraphs do not have to
be drawn the same way they appear in the presentation of 
A.) 
A
vI
VI Vl 7 
VI 
V2
v2027 
V2 
V3
V3 
V5V
5
V7
V5  
V6 
V4 
v6
g1 
52 
53
Figure 9.15 
A graph and three subgraphs.
vI

Figure 9.16 depicts a graph g and two subgraphs g1 and 52 . The last graph in
this figure, g3, is not a subgraph of g because the two vertices of degree 3 in g
are not adjacent. 
A
e
V
5 
51 =g\{e) 
g2 =\{VI
Figure 9.16 
A graph g, two subgraphs, 51 and 52, and a graph g3 which is not a subgraph of g.
A useful tool in graph theory is the deletion of an edge or a vertex from a
graph. If e is an edge in a graph g, we shall abuse notation and write g \ {e}
to denote that subgraph of g = g(V, Â£) which has the same vertex set as g but
whose edge set is S \ {e}. For example, in Fig 9.16, the subgraph g1 is g \ {e}.
Similarly, g \ {v} denotes the graph g with the vertex v removed. The deletion
of a vertex requires some care, since when a vertex is removed from a graph, all
edges incident with that vertex must also be removed. Again with reference to
Fig 9.16, subgraph 5 \ {v} is 52 , not 93.
Each of the graphs pictured in Fig 9.17 has as many edges as possible
(multiple edges and loops are not permitted in a "graph"). Such graphs have
a name.
0
C I
,2
AC
3
1(4
AC
5
Figure 9.17 
The first five complete graphs.
For any positive integer n, the complete graph on n vertices, denoted CK,, is that
graph with n vertices every two of which are adjacent.
The graphs in Fig 9.18 are not complete, though they have other interesting
properties. In each of them, no two top vertices are adjacent and no two bottom
vertices are adjacent (they are examples of bipartite graphs), and in the two
rightmost graphs every top vertex is adjacent to every bottom vertex (these two
are complete bipartite graphs).
A bipartite graph is one whose vertices can be partitioned into two (disjoint) sets
VI and V2, called bipartition sets, in such a way that every edge joins a vertex
in VI and a vertex in V2. (In particular, there are no edges within VI nor within
V2.) A complete bipartite graph is a bipartite graph in which every vertex in VI
is joined to every vertex in V2. The complete bipartite graph on bipartition sets
of m vertices and n vertices, respectively, is denoted limn.
Graphs
EXAMPLE 3
~AOWS
I 
S
93

9.2 Definitions and Basic Properties 
289
IC2,3
K3,3
Figure 9.18 
Three bipartite graphs, two of which are complete bipartite.
Figure 9.18 shows typical pictures of K 2,3 and Q3,3. The one vertex graph
ICI shown in Fig 9.17 is also bipartite since bipartition sets are not required to
be nonempty. It is helpful to note that a graph is bipartite if and only if its
vertices can be colored with two colors such that every edge has ends of different
colors.
EXAMPLE 4
Consider the graph on the left of Fig 9.19. Coloring vertex I red, vertex 2 white,
and continuing to alternate these two colors through the vertices 3, ... , 8 gives
every edge different colored ends. So the graph is bipartite, the bipartition sets
being the red vertices and the white vertices. By grouping these bipartition sets,
the graph can be redrawn so that it more obviously appears bipartite, as shown
on the right of Fig 9.19. 
A
8
7 
6
1 
3 
5 
7
2 
4 
6 
8
Figure 9.19 
A graph and a way to show it is bipartite.
In the graph shown in Fig 9.19, what are the vertex sets 11, 3, 5, 71 and {2, 4, 6, 81
called? Is the graph complete? Is it complete bipartite?
It is not hard to show that a bipartite graph can contain no triangles.4 (See
Exercise 21.) For instance, graph g3 in Fig 9.16 is not bipartite because it contains
a triangle (in fact, two triangles).
Look at the graphs accompanying Exercise 5 in Section 9.1. Are either of these
bipartite? Explain.
Two very useful properties of graphs are described in the proposition and
corollary which follow. With one proviso, the proofs we present are valid gen-
erally, so we state the propositions for pseudographs. The proviso is that a loop
at a vertex shall add two to the degree of that vertex. [With reference to the
pseudograph in Fig 9.14, recall that deg V3 = 4.]
4A triangle in a graph is a set of three vertices with an edge joining each pair.
MM

290 
Chapter 9 Graphs
*.gWg-9
(Euler) The sum of the degrees of the vertices of a pseudograph is an even num-
ber equal to twice the number of edges. In symbols, if g(V, Â£) is a pseudograph,
then
E deg v = 215j.
I)V
Proof 
Adding the degrees of all the vertices involves counting one for each edge incident
with each vertex. How many times does an edge get counted? If it is not a loop,
it is incident with two different vertices and so gets counted twice, once at each
vertex. On the other hand, a loop at a vertex is also counted twice, by convention,
in the degree of that vertex. 
I
EXAMPLE 5
EXAMPLE 6
I
EXAMPLES 7
-
aM
The graph in Fig 9.19 has eight vertices each of degree 3. Since
E deg v = 8(3) = 24 = 21SI,
VEV
it must have 12 edges, and it does. 
A
The pseudograph in Fig 9.14 has vertices of degrees 4, 3, 2, 1. Since 4+3+2+1 =
10, the pseudograph must have five edges, and it does. (Note that a loop is one
edge, but it adds two to the degree.) 
A
How many edges does 1C3,6 contain? This complete bipartite graph has six
vertices of degree 3 and three of degree 6. Since
E deg v = 6(3) + 3(6) = 36 = 21S ,
vGV
/C3,6 has 18 edges.
Suppose that dl, d2, . .. , d, are the degrees of the vertices of a graph (or pseudo-
graph) g, ordered so that d1 > d2 > ... > d,. Then di, d2 . 
d, is called the
degree sequence of g.
.
The degree sequence of the pseudograph in Fig 9.14 is 4, 3, 2, 1.
* 
C2,3 has degree sequence 3, 3, 2, 2, 2. (See Fig 9.18.) 
A
Why can there not exist a graph whose degree sequence is 5, 4, 4, 3, 2, 1 ?
The number of odd vertices in a pseudograph is even.
Proof 
By Proposition 9.2.5, ZvsV deg v = 21SI 
is an even number. Since
3degv= 
E degv+ Edegv
veV 
VCV 
VCV
v even 
v odd
and the first sum on the right, being a sum of even numbers, is even, so also the
second sum
L deg v
VCF
v odd

9.2 Definitions and Basic Properties 
291
must be even. Since the sum of an odd number of odd numbers is odd, the number
of terms in the sum here, that is, the number of odd vertices, must be even. 
I
The pseudograph in Fig 9.14, for instance, has two odd vertices, V2 and V4.
The complete bipartite graph IC3,6 has six odd vertices (each of degree 3).
Find the degree of each vertex of the pseudograph g shown in Fig 9.20. What is
the degree sequence for Q? Verify that the sum of the degrees of the vertices is an
even number. Which vertices are even? Which are odd? Verify that the number
of odd vertices is even.
VI 
V4 
V6
0
vel 
e4
e 1  v2 
e6 V5
Figure 9.20 
V'25 6v
A 
- * ~*
2. The given vertex sets are the bipartition sets of the graph. The graph is
not complete since, for example, vertices I and 3 are not incident with an
edge; it isn't a complete bipartite graph either because, for example, ver-
tices I and 6, which lie in different bipartition sets, are not incident with an
edge.
3. Neither graph is bipartite. The graph in (a) contains the triangle V3V4V6.
While the graph in (b) does not contain a triangle, it contains the 5-cycle
V2V4V6V7V5V 2, which, like a triangle, causes problems. Try coloring the ver-
tices of the graph in (b) with two colors-say red and white-so that the ends
of every edge have different colors. If v2 were colored white, then V4 and V5
would have to be red, so v6 and V7 would have to be white. Thus, the edge
V6V7 would have ends of the same color.
4. The sum of the degrees is 19, which is not an even number.
5. Vertices vl, V2, v3, V4, V5, V6 have degrees 2, 4, 3, 2, 1, and 0, respectively.
The degree sequence of g is 4, 3, 2, 2, 1, 0. The sum of the degrees is
4 + 3 + 2 + 2 + I + 0 = 12. The even vertices are vI, v2, V4, and v6; the odd
vertices are V3 and v5. There are two odd vertices.
The symbol [BB] means that an answer can be found in the Back of the Book.
1. [BB] Draw a graph with five vertices VI, v2, V3, V4, V5
such that deg vi = 3, v2 is an odd vertex, deg V3 = 2.
and V4 and V5 are adjacent.
2. Draw all possible graphs with three vertices VI, v2, V3.
How many edges are there in each graph? What is the
degree sequence of each graph? Does this question make
sense for pseudographs? Explain.
3. [BB] Give an example of a graph such that every vertex
is adjacent to two vertices and every edge is adjacent to
two edges.

292 
Chapter 9 Graphs
4. (a) How many vertices and how many edges does the
pseudograph contain? What is the degree sequence
of this pseudograph?
(b) Verify Proposition 9.2.5 and Corollary 9.2.7 for this
pseudograph.
5. [BB] Draw a graph with five vertices and as many edges
as possible. How many edges does your graph contain?
What is the name of this graph and how is it denoted?
6. (a) What is the maximum degree of a vertex in a graph
with n vertices?
(b) What is the maximum number of edges in a graph
with n vertices?
(c) Given a natural number n, does there exist a graph
with n vertices and the maximum possible number
of edges?
7. Draw 1C7, 13,4, and 1C2,6.
8. Draw a graph with 64 vertices representing the squares
of a chessboard. Connect two vertices with an edge if
you can move legally between the corresponding squares
with a single move of a knight. [The moves of a knight
are L-shaped, two squares vertically (or horizontally)
followed by one square horizontally (respectively, ver-
tically).]
(a) Explain why this graph is bipartite.
(b) What are the degrees of the vertices?
9. Consider again the graphs accompanying Exercise 5 of
Section 9.1, which we reproduce here.
V2 
V6
V4
VI 
14 
V6
V3
V5 
V7
(a) [BB] For the graph on the left,
i. Make a table which shows the least number of
edges joining each pair of vertices in this graph.
(Such a table displays the least number of stops
required on air trips between cities in the region
depicted by the graph.)
ii. Add up the numbers in each column of the table.
Divide each column total by the degree of the
corresponding vertex. These ratios are called
accessibility indices since they measure the rel-
ative accessibility of the cities (by air). Which
city is the most accessible? Which is the least
accessible?
iii. Suppose a direct flight joining cities vl and V3
is introduced. What is the new beta index of the
graph? What are the new accessibility indices?
Which city is most accessible now? Which city
is now least accessible?
iv. Repeat part (iii), assuming a flight is introduced
between cities V2 and v6 instead of between vj
and V3.
(b) Repeat the preceding questions for the graph on the
right.
10. [BB] Verify Proposition 9.2.5 and Corollary 9.2.7 for
the complete graph CK. What is the beta index of /C,?
(See Exercise 5, Section 9.1.)
11. Verify Proposition 9.2.5 and Corollary 9.2.7 for the
complete bipartite graph Kmn. What is the beta index
of Cmn?
12. [BB] At most social functions, there is a lot of hand-
shaking. Prove that the number of people who shake the
hands of an odd number of people is always even.
13. Which of the graphs is a subgraph of the graph in
Fig 9.19?
(i) 
(ii) (iii) 
(iv) (v)
14. For each pair of graphs shown, discover whether or not
the graph on the left is a subgraph of the one on the right.
If it is not, explain why not. If it is, label the vertices
of the subgraph, then use the same symbols to label the
corresponding vertices of the graph on the right.
(a) [BB]
(b)

9.2 Definitions and Basic P
(c) A
tu
15. For each of the graphs shown, draw pictures of the sub-
graphs 5 \ (e), 5 \ {v}, and 5 \ (u).
(a) [BB]
(g) 6, 6, 4, 2, 2, 2, 1, 1
18. Does there exist a graph with five vc
tex incident with at least one edge l
adjacent? Explain.
19. (a) [BB] A graph has five vertices of
vertices of degree 2. How many eo
(b) A graph has degree sequence 5, 5
How many edges does it have?
20. Determine whether or not each of the E
In each case, give the bipartition sets o
graph is not bipartite.
(a) [BB]
(b)
(b)
(c) [BB]
(d)
(CI)
(c) 
;(d)
16. (a) [BB] What are the degrees
pseudograph?
f
of the vertices in the
J) 
] 
V2 
V 
V4
(b) [BB] Can there exist a graph with four vertices of
degrees 1, 2, 3, and 4?
17. For each of the following sequences, determine if there
exists a graph whose degree sequence is the one speci-
fied. In each case, either draw a graph, or explain why
no graph exists.
(a) [BB] 4, 4, 4, 3, 2
(b) 100, 99, 98,...,3, 2, 2, 2
(c) [BB] 5, 5, 4, 3, 2, 1
(d) 1, l, 1, 1, 1, I
(e) 5, 4, 3, 2, 1
(f) 5,4, 3,2, 1, 1
(e) 
( 
2) 
<â¢
21. [BB] Prove that a graph which contains .
be bipartite.
22. (a) Must a subgraph of a bipartite grap 
:
(b) Would your answer to (a) change if, i
of a bipartite graph, bipartition sets ma
be nonempty?
Explain your answers.
23. [BB] (Requires calculus) Prove that the nu
in a bipartite graph with n vertices is at n
24. How many complete bipartite graphs have
25. Let V = (I, 2, 3, ... , n}.
(a) [BB] How many graphs are there with v
(b) How many of the graphs in (a) contain
123?
(c) [BB] What is the total number of triangle~
graphs with vertex set V?
(d) On average, how many triangles does a gra,
labeled vertices contain?
I I

294 Chapter 9 Graphs
26. Suppose a graph has nine vertices each of degree 5 or
6. Prove that at least five vertices have degree 6 or at
least six vertices have degree 5.
27. [BB] What is the largest possible number of vertices
in a graph with 35 edges, all vertices having degree at
least 3?
28. Let m and M denote the minimum and the maximum
degrees of the vertices of a graph g with vertex set V
and edge set E. Show that
m< 1 I < M.
29. [BB] Suppose all vertices in a graph have odd degree k.
Show that the total number of edges in g is a multiple
of k.
30. [BB] Prove that in any graph with more than one vertex,
there must exist two vertices of the same degree. [Hint:
Pigeon-Hole Principle.]
31. Show that a set of nonnegative integers {d, d2, 
, d, I
is the set of degrees of some pseudograph if and only if
di is even.
32. Suppose that dj, d2, ..
d are the degrees of the ver-
tices in some graph. Show that for any t < n,
t 
n
Edi < t(t -1) + 
Emin 
ft, di).
i=l 
i=t+l
Remark: The given condition (holding for all t < n)
and the requirement that yn I di is even are sufficient
as well as necessary for the existence of a graph with a
prescribed set dj, . . ., dn of degrees.5
33. Can there exist a graph with 13 vertices, 31 edges, three
vertices of degree 1, and seven vertices of degree 4?
Explain.
9.3 
ISOMORPHISM
It is important to know when two graphs are essentially the same and when
they are essentially different. When we say graphs are "essentially the same," we
mean that they differ only in the way they are labeled or drawn. There should
be a one-to-one correspondence between the vertices of the graphs and a one-
to-one correspondence between their edges such that corresponding vertices are
incident with corresponding edges. The proper word for "essentially the same" is
isomorphic.
There is a distinction between a graph and its picture. A graph is a set V and a
set E of unordered pairs of elements of V. A picture of it consists of dots and lines
which can be drawn and arranged in many different ways. The bipartite graphs
pictured in Fig 9.19, for instance, are isomorphic: The two pictures represent the
same graph g(V, E), where
V= 1, 2, 3,4, 5, 6,7, 8}
and
E = {12, 14, 18, 23, 27, 34, 36, 45, 56, 58, 67, 781.
EXAMPLE 8
Graphs g2 and g3 in Fig 9.21 each consist of two edges incident with a common
vertex. They are drawn differently, but the graphs are the same: g2 and 53 are
isomorphic. The picture of g1 indicates that this graph has only one edge: g1 is
different from g2 in an essential way; it is isomorphic to neither 52 nor g3.
A
5P. Erdds and T. Gallai, "Graphs with Prescribed Degrees of Vertices," Matematikai Lapok 11 (1960),
264-274.

9.3 Isomorphism 
295
0
g1  
g2 
53
Figure 9.21 
g2 and 53 are isomorphic, but neither is isomorphic to â¢1.
Figure 9.22 illustrates two graphs which are not isomorphic: Each graph consists
of four vertices and four edges, but g2 contains a vertex of degree 1, while 5,
has no such vertex. 
A
51 
592
Figure 9.22 
Two nonisomorphic graphs.
EXAMPLE 10
The graphs in Fig 9.23 are isomorphic and they have been labeled so as to show
corresponding vertices. Either picture represents a graph with four vertices A, B,
C, D, and four edges AB, BC, CD, and DA. 
A
A 
D
B 
C
A 
D
C 
B
Figure 9.23 
Two graphs labeled so as to show that they are isomorphic.
Show that the two graphs to the right are
isomorphic by assigning the labels A, B,
C, and D to appropriate vertices of the
graph on the right. (It might help to think
of the edges of 92 as pieces of string knot-
ted at the vertices. How could 92 be rear-
ranged to look like g9 ? Once you see this,
it will be easy to do the required labeling.)
A 
B
D 
C
Here is the precise definition of the term "isomorphic."
Given graphs g, = 91 (VI, El) and g2 = g2(V2, Â£2), we say that 9; is isomorphic
to 52 and write 
, 
5- 
g2 if there is a one-to-one function qÂ° from VI onto V2 such
that
* if vw is an edge in El, then sp(v)po(w) is an edge is Â£2, and
* every edge in Â£2 has the form qo(v)o(w) for some edge vw E El.
We call So an isomorphism from 5I to 52 and, abusing notation, say that up: 9 1 -*
52 is an isomorphism.
EXAMPLE 9
M

296 
Chapter 9 Graphs
The definition of isomorphism is symmetric: If gl is isomorphic to g2, then g2
is isomorphic to g1. In fact, if qi: g1 -5 g2 is an isomorphism, then (p 1: g2 -
1
is an isomorphism. Thus, there is no ambiguity if we simply say that two graphs
"are isomorphic."
We often say that graphs are isomorphic if and only if there is a bijection
between their vertex sets which "preserves incidence relations." By this, we mean
that a vertex v is incident with an edge e in g1 if and only if q(v) is incident with
(p(e) in 52. An isomorphism Sp simply relabels vertices without changing any of
the incidence relations. If So(v) = x, think of x as the new label for v.
Consider the two graphs shown at the
right. We encountered these earlier in
Fig 9.23. Remembering our previous dis-
cussion, we see that if vertex u of g2 is
relabeled A, if vertex v is relabeled C, if
w is relabeled D, and if x is relabeled B,
then the pictures represent precisely the
same graph. Having seen how to relabel
the vertices of 52 with the labels of g1, it
is easy to write down the isomorphism 52
A 
D
B 
C
g1
-) gl explicitly:
9o(u) = A, 
o (v) = C, 
99(w) = D, 
y (x) = B.
Use your solution to Pause 6 to find an isomorphism so: 52 -5 g1 for the graphs
g1, 
52 shown in Fig 9.24.
A 
B
Figure 9.24 
D 
C
U 
W
v
The notion of isomorphism is exceedingly important in mathematics. If the
definition looks complicated, the idea is very simple. Isomorphic objects, from
a mathematical standpoint, are the same; they differ only in appearance. This
idea is not new: 2 and 0.5 look different, but they represent the same real
number.
We have remarked that the definition of isomorphism is
symmetric: g, -2 
if and only if g2 - g1
It is also
reflexive: g - g for any graph g
(because the identity map 5 -- g is an isomorphism) and
transitive: If g1 - 52 and g2 -
3, then 51 -Å½3
EXAMPLE 11
u 
w
v 
x
A
M

9.3 Isomorphism 297
(because, if sol: g1 -5 g2 and (02: 52 -
3 are isomorphisms, then so is the
composition P2 Â° (PI: g1 -+ 
3). Thus, isomorphism is an equivalence relation on
the set of all graphs.
The set of all graphs is therefore partitioned into disjoint equivalence classes
called isomorphism classes. Any two graphs in the same equivalence class are
isomorphic; two graphs in different equivalence classes are not isomorphic. The
graphs pictured in Pause 6 belong to the same equivalence class; the graphs pic-
tured in Fig 9.22 belong to different equivalence classes. When we casually remark
that two graphs are "different," we really mean "in different isomorphism classes."
Usually, it is very difficult to prove that two graphs are isomorphic. In princi-
ple, we have to list all the one-to-one onto functions between vertex sets and, in
each case, check whether or not the function preserves incidence relations. On the
other hand, it is often easy to prove that graphs are not isomorphic. For instance,
the graphs g1 and g2 in Fig 9.21 cannot possibly be isomorphic because g2 is
connected in the sense that there is a sequence of adjacent edges between any
two vertices, while g1 is not connected.
Since an isomorphism is a one-to-one onto function between vertex sets,
isomorphic graphs have the same numbers of vertices. Many other properties are
shared by isomorphic graphs.
Suppose Sp: 51 
52 is an isomorphism from a graph g1 to another graph
52. If v is a vertex of degree k in g1 and if vl, v2, .V .
, Vk are the vertices adjacent
to v, then, in g2, (v) is adjacent to the k vertices (P(vI), p(v2), . . ., 'p(Vk), but
to no other vertex. Thus, the degree of (p(v) is also k. It follows that isomorphic
graphs have the same degree sequences and hence also the same numbers of
edges, since the number of edges in a graph is one half the sum of the vertex
degrees (Proposition 9.2.5).
If g1 and 52 are isomorphic graphs, then g, and g2 have the
.
same number of vertices,
.
same number of edges, and
.
same degree sequences.
The graphs g1 and g3 shown in Fig 9.15 are not isomorphic because they have
different numbers of vertices. The graphs shown in Fig 9.22 are not isomorphic
because g2 contains a vertex of degree 1 while gI does not.
Take care not to misinterpret Proposition 9.3.2. The proposition asserts three
implications of the form
`g1 = 2 
"
which must not be confused with double implications of the form
`91 = 52 '+ --
Proposition 9.3.2 says that if two graphs are isomorphic, then they must have
certain properties. It does not say that two graphs with the properties listed are
isomorphic. In fact, it is quite possible for two graphs which are not isomorphic
E 
"VNM 
0

298 
Chapter 9 Graphs
to have the same numbers of vertices and edges and the same degree sequences.
See Exercises 7 and 8.
A 
* 
* **
6. To the right, we show one of several
ways in which the vertices of G2 can be
labeled so that it becomes clear that the
graph represented by each picture is the
same.
A 
B
D 
C
g1
B 
A
D
C
92
7. yo(u) = B, ((v) = C, sp(w) = A, q(px) = D. The isomorphism qp just relabels
vertices of 92.
The symbol [BB] means that an answer can be found in the Back of the Book.
1. [BB] For each of the ten pairs of graphs which can be
obtained from those shown, either label the graphs so
as to exhibit an isomorphism or explain why the graphs
are not isomorphic.
(i)
(ii)
. if the graphs are isomorphic, exhibit an isomorphism
from one to the other and relabel the graph on the
right so as to show this isomorphism.
(a)
p
q
r 
5
u 
V
(iii)
(b) [BB]
(iv)
(v)
2. (a) Draw a graph isomorphic to the one shown on the
left, but with no crossover of edges.
C 
D 
F 
G
(c) 
F
A 
B 
C 
D 
E
u
p 
q 
r 
s 
t
(b) Same as (a) for the graph on the right.
3. (a) [BB] Draw all nonisomorphic graphs on n -
3 ver-
tices. Give the degree sequence of each.
(b) Repeat part (a) for n = 4.
4. For each pair of graphs shown,
* if the graphs are not isomorphic, explain why not;
(d) 
A
D
C
IMMM __ 
0
B

Review Exercises 299
5. (a) [BB] Is the graph on the left isomorphic to AC
3,4?
Explain.
8. Consider the following three graphs.
C
E
(b) Is the graph on the right isomorphic to AC4,4?
Explain.
6. [BB] Explain why any graph is isomorphic to a subgraph
of some complete graph.
Suppose Vl, . . ., vn is a set of n vertices in a graph such
that vi and vi+1 are adjacent for I < i < n -I 
and Vn
and v1 are also adjacent. Then the set of these n vertices
and the n edges VIV2, V2V3, .. . Vn 
I n, vV I is called an n-
cycle. A 3-cycle is often called a triangle and a 4-cycle a
quadrilateral.
7. (a) [BB] Prove that two graphs which are isomorphic
must contain the same number of triangles.
(b) Prove that, for any n > 4, two isomorphic graphs
must contain the same number of n-cycles.
(c) How many edges are there in the graphs g1 and 92 ?
How many vertices? What is the degree sequence
of each graph? Are the graphs isomorphic? Explain.
A
1 
2
D
2 
6
3 
4 
5
g3
(a) How many vertices and how many edges are there
in each graph? What is the degree sequence of each
graph? How many triangles are in each graph?
(b) For each pair of graphs, either exhibit an isomor-
phism between vertex sets or explain why the graphs
are not isomorphic.
9. Show that the following graphs are not isomorphic.
A 
B
C 
D
C 
H
1 
2
7 
8
10. (a) [BB] Suppose that graphs 5 and 7- have the same
numbers of vertices and the same numbers of edges,
and suppose that the degree of every vertex in 5 and
in NH is 2. Are g and 7- necessarily isomorphic?
Explain.
(b) Suppose that graphs g and H have the same number
of vertices and the same number of edges. Suppose
that the degree sequences of 5 and NH are the same
and that neither graph contains a triangle. Are 5 and
NH necessarily isomorphic? Explain.
3 
A 
* 
S
1. In the Konigsberg Bridge Problem, a tragic fire destroys
the bridge from B to C and also one of the bridges from
A to D. (See Fig 9.1.) Draw a graph representing the
new situation. Show that it is now possible for someone
to start on land mass B and walk over each of the bridges
exactly once, returning to land mass B again.
2. (a) Draw a configuration of four houses and two utili-
ties, each house connected to each utility, but with
no crossovers.
(b) Let n be any positive integer. Motivated by 2(a),
suggest a general result concerning n houses and 2
utilities. Draw a graph supporting your answer.
(

300 
Chapter 9 Graphs
(a)
(c)
(b)
(d)
Figure 9.25 
Cubes for Exercise 3.
3. Find solutions, where possible, for the cube games pic-
tured in Fig 9.25.
4. (a) Draw a graph with six vertices at least three of
which are odd and at least two of which are even.
(b) Draw a graph with six vertices at most three of
which are odd and at least two of which are even.
(c) Is it possible to find a graph which satisfies the
conditions in both 4(a) and 4(b) simultaneously?
Explain your answer.
5. (a) Why is it not possible for a graph to have degree
sequence 6, 6, 5, 5,4,4, 4,4, 3?
(b) Why is it not possible for a graph to have degree
sequence 8,8,7,6,5,4,3,2, 1?
6. Let g be a graph and let N be a subgraph of 5. Assume
H contains at least three vertices.
(a) Is it possible for g to be bipartite and for Nt to be a
complete graph?
(b) Is it possible for 5 to be a complete graph and for
Nd to be bipartite?
Explain your answers.
7. Suppose a graph has 49 vertices, each of degree 4 or 5.
Prove that at least 25 vertices have degree 4 or at least
26 vertices have degree 5.
8. Suppose 5 is a graph with n vertices, n edges and no
vertices of degree 0 or 1. Prove that every vertex of 5
has degree 2.
9. For each pair of graphs shown,
. if the graphs are not isomorphic, explain why not;
. if the graphs are isomorphic, exhibit an isomorphism
from one to the other.
G 
Cube 1
I 
RR 
R 
Cube 3
B 
GW B I R
R
R 
Cube2 
-
G B 
G 
W 
Cube 4
wRG

Review Exercises 
301
A 
E
(a)
BD
C
A
B 
E
C 
D
(C) 
A 
F
B 
E
CD
P
r 
s
P 
U
q 
s
r 
S
10. Determine whether or not the two graphs are isomorphic.
(The one on the left is the "Petersen" graph, which we
will encounter again in Chapter 10.)
11. For each of the following cases, either explain why
the two graphs are isomorphic or explain why they are
not.
(a) IZ4 and AC3,8
(b) K1 1 and K3,8
(c) K4 6 and /C2, 12
(d) kA4.6 and As55
(e) kA4,6 and AC6,4
12. George is examining three graphs 51, Q2, and G3. He
gives correct arguments showing that g1 is not isomor-
phic to g2 and that g2 is not isomorphic to 93. Can he
conclude that g1 is not isomorphic to 93? Explain.
13. Answer Exercise 12 again, assuming that George's cor-
rect arguments show that g1 is not isomorphic to g2
while g2 is isomorphic to g3.
14. Prove that IChb -
AZ,, 
if and only if {a, b} = fc, d}.
P
q
(b)

A 
U
0
a 
; 
E
10
Paths and Circuits
10.1 
EULERIAN CIRCUITS
Many real problems, when translated to questions about graphs, inquire about
the possibility of walking through a graph in a particular way. Although our
primary interest is in graphs, the definitions and results of this section are stated
for pseudographs, since they apply equally, and with few additional complications,
in the more general setting.
A walk in a pseudograph is an alternating sequence of vertices and edges, begin-
ning and ending with a vertex, in which each vertex (except the last) is incident
with the edge which follows and the last edge is incident with the edge which
precedes it. The length of a walk is the number of edges in it. A walk is closed
if the first vertex is the same as the last and otherwise open. A trail is a walk in
which all edges are distinct; a path is a walk in which all vertices are distinct. A
closed trail is called a circuit. A circuit in which the first vertex appears exactly
twice (at the beginning and the end) and in which no other vertex appears more
than once is a cycle. An n-cycle is a cycle with n vertices. It is even if n is even
and odd if n is odd.
There are a lot of words here and, as always, we cannot emphasize too strongly
the importance of coming to grips with their meanings. When thinking about the
concepts of path and trail, it is perhaps helpful to note that a path is necessarily a trail:
If all the vertices of a walk are different, then all the edges must be different too. As
we show in the next example, the converse is not true: A trail need not be a path.
In the graph shown in Fig 10.1, ABCEFCBD is a walk of length 7 which is
neither a trail nor a path; ABCEFCD is a trail, but not a path; ABCEFCDBA is
a closed walk which is not a circuit; BCEFCDB is a circuit which is not a cycle;
and BCDB is a 3-cycle and hence an odd cycle. The closed walk CEFCBDC
is not a cycle because the first and last vertex appears a third time. 
A
303
04II
EXAMPLE 1

304 
Chapter 10 
Paths and Circuits
B
D
Figure 10.1 
E 
-4 DF
S 
I 
6
EXAMPLE 2
EXAMPLE 3
1=
H 
A 
B
C
G 
E 
D
Figure 10.2 
An Eulerian graph.
Eulerian circuits are named, of course, after LUonhard Euler, the solver of
the Konigsberg Bridge Problem, and their study is motivated by that problem.
In Section 9.1, we saw that to follow the desired route over the bridges of
Konigsberg, you have to choose a vertex in the pseudograph of Fig 9.2 and find
a walk which includes all the edges exactly once and leads back to the chosen
vertex. With our present terminology, the Konigsberg Bridge Problem asks if the
pseudograph is Eulerian.
l In a graph, there is never a problem specifying just vertices or just edges.
D
Verify each of the assertions just made.
While, strictly speaking, a walk should be specified by an alternating sequence
of vertices and edges, it is often enough to specify only the vertices, as long as
consecutive vertices are adjacent, as we have just done, or only the edges, as long
as consecutive edges are adjacent.' An important type of circuit, known as an
Eulerian circuit, is one which passes through every edge of a pseudograph.
An Eulerian circuit in a pseudograph is a circuit which contains every vertex
and every edge. An Eulerian pseudograph is a pseudograph which contains an
Eulerian circuit.
Note the reference to vertices in the definition of Eulerian circuit, which is
crucial to the theory. See Exercise 5.
In the graph of Fig 10.1, the circuit ABCEFCDA is not Eulerian because it does
not contain the edge BD. As we shall soon see, this graph possesses no Eulerian
circuit; it is not an Eulerian graph. 
A
Figure 10.2 further illustrates the difference between a circuit and an Eule-
rian circuit. The circuit ABCDEFGHFA is not Eulerian since, while it
encompasses all vertices, it omits four edges. The graph is Eulerian, however:
ABCDEFGHFADBEA is an Eulerian circuit. 
A

10.1 Eulerian Circuits 
305
A
B
C 
E
D
Figure 10.3 
A graph which is not Eulerian.
In Theorem 10.1.4, we present the remarkably simple test which Euler found
for the presence of an Eulerian circuit. First, since an Eulerian circuit provides a
walk between every pair of vertices, any Eulerian pseudograph must be connected,
in the following sense.
MPOM
A pseudograph is connected if and only if there exists a walk between any two
vertices.
As we ask you to show in Exercise 16, if a graph is connected, then there is
actually a path between any two vertices, not just a walk.
An Eulerian graph must be more than just connected, however, as the graph
in Fig 10.3 illustrates. The basic difficulty with this graph is that there is only
one edge incident with A. Any circuit that begins at A cannot return to A without
using this edge again, and any circuit which begins at a vertex other than A and
attempts to include all edges, after using the edge BA, has to repeat it en route
back to the starting vertex. The degrees of the vertices play a role in determining
whether or not a graph is Eulerian. It is not hard to see that the degrees of the
vertices of an Eulerian graph must be even.
In essence, we have already given the argument. In walking along an Eulerian
circuit, every time we meet a vertex (other than the one where we started), either
we leave on a loop and return immediately, never traversing that loop again, or
we leave on an edge different from that by which we entered and traverse neither
edge again. So the edges (other than loops) incident with any vertex in the middle
of the circuit can be paired. So also can the edges incident with the first (and last)
vertex since the edge by which we left it at the beginning can be paired with the
edge by which we returned at the end. Thus, an Eulerian graph must not only be
connected, but also have vertices of even degree. Conversely, a connected graph
all of whose vertices are even must be Eulerian. To see why, it will be helpful
to examine again the graph of Fig 10.2 (which is connected and has only even
vertices) and to try to construct an Eulerian circuit with a strategy that might
apply more generally.
We attempt to find an Eulerian circuit starting at A. To begin, we find some
circuit which starts and ends at A, for instance, the circuit Cl: ABCDEFA.
This circuit obviously is not Eulerian because it misses lots of edges. If we delete
the edges of C1 from the graph as well as vertex C, which is isolated after the
edges of Cl have been removed, we are left with the graph g, on the left of
Fig 10.4.
This graph gi has a circuit C, FGH, which is connected to C1 at vertex
F. Thus, it can be used to enlarge Cl as follows: Start at A, follow C1 as far

306 
Chapter 10 
Paths and Circuits
H 
A 
B 
A 
B
Figure 10.4 
G 
E 
D 
E 
D
as F, then pass around C and complete Cl to A. We obtain a second circuit
C2, ABCDEFGHFA, in the original graph, which is larger than Cl, but still
not Eulerian because not all edges are yet included. As before, if the edges of
C2 are deleted (from the original graph), together with vertices F, G, and H
which have become isolated, we are left with the graph on the right of Fig 10.4.
This graph contains a circuit ADBEA, which makes contact with C2 at A. Piec-
ing together these circuits (follow C2 to A, then ADBEA), we obtain a cir-
cuit C3 which contains all the edges of the original graph, so C3 is Eulerian.
With the hindsight of this example, we are in a position to prove an important
theorem.
I 
* 
aI1 
r-
A pseudograph (with at least two vertices) is Eulerian if and only if it is connected
and every vertex is even.
Proof 
(-) 
We have already shown that an Eulerian pseudograph must be connected
with each vertex even.
(-) 
For the converse, suppose that G is a connected pseudograph with all
vertices of even degree. We must prove that G has an Eulerian circuit. Let v
be any vertex of G. If there are any loops incident with v, follow these first,
one after the other without repetition. Then, since we are assuming that 5 has
at least two vertices and since g is connected, there must be an edge vvl (with
vl 7& v) incident with v. If there are loops incident with vI, follow these one
after the other without repetition. Then, since deg vl is even and bigger than 0,
there must be an edge VI v2 different from vvi . Thus we have a trail from v to v2
which we continue if possible. Each time we arrive at a vertex not encountered
before, follow all the loops without repetition. Since the degree of each vertex
is even, we can leave any vertex different from v on an edge not yet covered.
Remembering that pseudographs in this book are always finite, we see that the
process just described cannot continue indefinitely; eventually, we must return to
v, having traced a circuit Cl. Notice that every vertex in Cl is even since we
entered and left on different edges each time it was encountered. At this point,
it may happen that every edge has been covered; in other words, that Cl is an
Eulerian circuit, in which case we are done. If Cl is not Eulerian, as in the
preceding example, we delete from G all the edges of Cl and all the vertices of G
which are left isolated (that is, acquire degree 0) by this procedure. All vertices
of the remaining graph GI are even (since both g and Cl have only even vertices)
and of positive degree. Also, G1 and C1 have a vertex u in common, because G
is connected. (See Exercise 18.) Starting at u, and proceeding in G1 as we did
in G, we construct a circuit C in G1 which returns to u. Now combine C and Cl
by starting at v, moving along Cl to u, then through C back to u, and then back
to v on the remaining edges of Cl. We obtain a circuit C2 in G which contains

10.1 Eulerian Circuits 307
more edges than Cl. If it contains all the edges of G, it is Eulerian; otherwise, we
repeat the process, obtaining a sequence of larger and larger circuits. Since our
pseudograph is finite, the process must eventually stop, and it stops only with a
circuit through all edges and vertices, that is, with an Eulerian circuit. 
I
Why is the graph shown in Fig 10.1 not Eulerian?
Not only does Theorem 10.1.4 give criteria for a pseudograph to be Eulerian,
but its proof gives an algorithm for finding an Eulerian circuit when one exists.
We have given one example. Here is another.
A power company's wires in a certain region follow the routes indicated in
Fig 10.5. The vertices represent poles and the edges wires. After a severe storm,
all the wires and poles must be inspected. Show that there is a round trip beginning
at A, which allows a person to inspect each wire exactly once. Find such a trip.
F
L
I 
l
EXAMPLE 4
Sometimes, instead of finding an Eulerian circuit in a pseudograph, we want
to find an Eulerian trail between two vertices, a trail which passes through every
vertex and includes every edge. It is not hard to classify the pseudographs in
which such a trail is possible, for adding one additional edge between the two
vertices, the enlarged pseudograph is Eulerian. To see this, note that if the two
vertices are u and v, then following an Eulerian trail from u to v and going back
to U along the extra edge defines an Eulerian circuit. By Theorem 10.1.4, the
enlarged pseudograph must be connected with all vertices even. So the original
pseudograph must have been connected with all vertices even except u and v
which are necessarily odd. (With the extra edge, they were even.) On the other
hand, given a connected pseudograph with all vertices except u and v even, then
certainly there is an Eulerian trail from u to v, for adding an extra edge between
u and v produces an Eulerian pseudograph. Since an Eulerian circuit can begin at
any vertex, imagine the one which begins by going from v to u along the added
edge. Removing this added edge from the circuit then gives an Eulerian trail from
u to v. We have established the following theorem.
A pseudograph 5 possesses an Eulerian trail between two (different) vertices u
and v if and only if g is connected and all vertices except u and v are even.
Consider the graph in Fig 10.6. Vertices A and B have degree 3, J and K have
degree 2, and all the others have degree 4. Since the graph is connected and A
and B are its only odd vertices, there exists an Eulerian trail from A to B. One
Eulerian trail is AGHFDGJH1FELIKLBCADCEB. 
A
A 
B 
C 
D 
E
Figure 10.5 
G 
H 
I 
J 
K
MM

308 
Chapter 10 
Paths and Circuits
Figure 10.6
A 
-
* **
1. ABCEFCBD is not a trail (and hence not a path) because BC is a repeated
edge; ABCEFCD is a trail because all edges are distinct, but not a path
because C is a repeated vertex; ABCEFCDBA is a closed walk because
its first and last vertices are the same, but not a circuit because edge A B is
repeated; BCEFCDB is a circuit because its edges are distinct and it begins
and ends at vertex B, but it is not a cycle because its second and fifth vertices
are the same. BCDB is an odd cycle because it contains three edges. (Note
that the circuit CBDCEFC is not a cycle: Its first and fourth vertices are
the same, but the fourth vertex is not last.)
2. The graph in Fig 10.1 is not Eulerian because not all vertices are even; for
example, deg B = 3.
3. The desired round trip is just an Eulerian circuit in the graph of Fig 10.5.
Such a circuit exists because the graph is connected and each vertex has
even degree; vertices A, F, G, L, N, and 0 have degree 2; the rest have
degree 4. In the search for an Eulerian circuit, an obvious circuit with which
to begin is ABCDEFLKJIHGA. Joining this to the circuit BMCIMHB
at B gives A-BMCIMHB-CDEFLKJJHGA. Joining this to the circuit
DJOKEND at D gives the following routing for the desired inspection:
A-BMCIMHB-C-DJOKEND-EFLKJIHGA.
The symbol [BB] means that an answer can be found in the Back of the Book.
1. (a) [BB] Find a connected graph with as few vertices
as possible which has precisely two vertices of odd
degree.
(b) Find a connected graph with as few vertices as
possible which has precisely two vertices of even
degree.
2. [BB] Answer the Konigsberg Bridge Problem and
explain.
3. In each case, explain why the graph is Eulerian and find
an Eulerian circuit.
J 
K
A 
C 
B
(a) [BB]
A
C
F
B
C
(b)
ff IMM,

10.1 Eulerian Circuits 309
4. In each of the pseudographs shown, either describe an
Eulerian circuit by numbering the edges or explain why
no Eulerian circuit exists.
(a) [BB]
(b)
(d)
(c)
(e)
(f)
5. Suppose we modify the definition of Eulerian circuit by
omitting the reference to vertices. Thus we propose that
an Eulerian circuit be a circuit which contains every
edge of a graph. Does Theorem 10.1.4 remain true?
Explain.
6. (a) [BB] Is there an Eulerian trail from A to B? If yes,
find one; if not, explain why not.
(b) Same question for A to C.
7. [BB] (Fictitious) A recently discovered map of the old
town of Konigsberg shows that there was a ferry
operating between the areas labeled C and D in
Fig 9.1.
(a) Is it possible to start on some land area, cross over
each bridge exactly once, take the ferry exactly
once, and return to the starting point? Explain your
answer.
(b) Is it possible to start on some land mass, walk over
each bridge exactly once, take the ferry exactly
once, and finish on some land mass (possibly dif-
ferent from the starting point)? Explain.
8. Euler's original article about the Konigsberg Bridge
Problem, which is dated 1736, presents a second simi-
lar problem with two islands, four rivers flowing around
them, and 15 bridges connecting various land masses,
as shown below.
(a) Is it possible to tour the region starting and finishing
in the same area having walked over every bridge
exactly once? Either describe such a tour or explain
why none is possible.
(b) Is it possible to tour the region (with perhaps dif-
ferent starting and stopping points) having walked
over every bridge exactly once? Either describe such
a tour or explain why none is possible.
9. [BB] In Exercise 10 of Section 9.3, you were asked
whether graphs 5 and X- with the same numbers of ver-
tices and edges and with every vertex in each graph
of degree 2 need be isomorphic. Answer this question
again, assuming in addition that the graphs are con-
nected.
10. Suppose g, and g2 are Eulerian graphs with no vertices
in common. Let vl be a vertex in g1 and let V2 be a
vertex in 9 2. Join vl and v2 with a single edge. What
can be said about the resulting graph and why?
11. (a) [BB] For which values of n > 1, if any, is IC,,
Eulerian?
(b) [BB] For which values of n > 1, if any, does /Cn
possess an Eulerian trail? Explain.
12. (a) Find a necessary and sufficient condition on natural
numbers m and n in order for 
,m.n to be Eulerian.
Prove your answer.
,

310 
Chapter 10 
Paths and Circuits
(b) Find a necessary and sufficient condition on natu-
ral numbers m and n in order for ICmn to have an
Eulerian trail. Assume m < n. Prove your answer.
13. Does there exist any sort of route in and around the figure
which crosses every edge exactly once? Explain your
answer.
14. [BB] Prove that any circuit in a graph must contain a
cycle and that any circuit which is not a cycle contains
at least two cycles.
15. [BB] Answer true or false and explain: Any closed walk
in a graph contains a cycle.
16. Let u and v be distinct vertices in a graph g. Prove that
there is a walk from u to v if and only if there is a path
from u to v.
17. [BB] For vertices u and v in a graph 5, define u - v if
u = v or there exists a walk from u to v. Prove that -
defines an equivalence relation on the vertices of g.
18. Complete some details in the proof of Theorem 10.1.4
by establishing the following. Suppose C1 (VI, l') is a
circuit in a connected graph 5 which does not contain
all the edges of 5. Let g, be that subgraph of g whose
edge set is Â£ \ Ej and whose vertex set is V less those
vertices of V, which become isolated after the removal
of the edges in El. Prove that 51 and Cl have a vertex
in common.
19. Suppose 51 and g2 are isomorphic graphs. Prove that
either both g1 and g2 are connected or else neither is
connected.
20. [BB] A graph 5 has 20 vertices. Any two distinct ver-
tices x and y have the property that deg x + deg y > 19.
Prove that g is connected.
21. (a) [BB] Let 5 be a connected graph with n > I ver-
tices none of which has degree 1. Prove that 5 has
at least n edges.
(b) Let g be a connected graph with n vertices. Prove
that g has at least n- 
I edges.
22. Let g be a graph with n vertices and m edges, where
m > 2(n- 
) (n -2).
(a) Show that 5 does not have a vertex of degree 0.
(b) Show that g is connected.
A component of a graph is a maximal connected subgraph,
that is, a connected subgraph which is properly contained
in no other connected subgraph which has more vertices or
more edges.
A graph with just one component is connected. Fig 10.7
shows graphs with two and with three components.
Figure 10.7 
g1 has two components; 52 has three com-
ponents.
23. Let 5 be a graph all of whose vertices have even degree.
How can the Eulerian circuit algorithm described in The-
orem 10.1.4 be modified to determine the number of
components in 5?
24. [BB] Prove that isomorphic graphs have the same num-
ber of components.
25. Prove that a graph is bipartite if and only if it contains
no odd cycles.
10.2 
HAMILTONIAN CYCLES
An Eulerian circuit contains every edge of a graph exactly once. In this section,
we discuss circuits which contain each vertex of a graph exactly once. Unlike in
Section 10.1, the definitions and results of this section apply only to graphs, not
to pseudographs.
-11=0 
sm
A Hamiltonian cycle in a graph is a cycle which contains every vertex of the
graph. A Hamiltonian graph is one with a Hramiltonian cycle.
PWI
92
X

10.2 Hamiltonian Cycles 
311
Some authors define a Hamiltonian circuit as a circuit in which every ver-
tex except the first and last appears exactly once. A circuit with no repeated
vertices (except the first and the last) is a cycle, so a Hamiltonian circuit is
a cycle. Thus the terms Hamiltonian circuit and Hamiltonian cycle are
synonymous.
Graph 51 in Fig 10.8 is Hamiltonian: The cycle ABCDEA, for instance, is Hamil-
tonian. On the other hand, graph g2 is not Hamiltonian, but how can we convince
ourselves of this fact?
Suppose that g2 has a cycle NH which contains every vertex. Then Nd will
contain A, which we note is a vertex of degree 2. Since we cannot enter and
leave A on the same edge (edges of a cycle are distinct), it follows that both
edges incident with A have to be part of NH. In particular, edge CA is in 'H. The
same argument applied to B shows that CB is part of N and, similarly, CD and
CE are in H: All four edges incident with C are part of N. This situation is
impossible, however: Since N is a cycle, vertex C can appear only once unless
the cycle begins and ends at C. In either case, since 'H cannot use the same edge
twice, exactly two edges incident with C can be part of 'H. 
A
E
D
D 
E
Figure 10.8 
51 is Hamiltonian; g2 is not.
While it is possible to decide precisely which graphs possess Eulerian circuits
(Theorem 10.1.4), it is noteworthy that there has not yet been found a way to
classify Hamiltonian graphs; in other words, there is no known theorem of the
sort, "g is Hamiltonian if and only if . . . ". There are, however, some properties of
cycles which are helpful in trying to find Hamiltonian cycles and which sometimes
allow us to conclude that a particular graph is not Hamiltonian.
Suppose NH is a cycle in a graph g.
1. For each vertex v of Nt, precisely two edges incident with v are in NH; hence,
if H is a Hamiltonian cycle of g and a vertex v in g has degree 2, then both
edges incident with v must be part of NH.
2. The only cycle contained in H is NH itself. (We say that N contains no proper
cycles.)
We have, in essence, already explained why each vertex of a cycle is incident
with exactly two edges: Any vertex (except the first and last) appears exactly once
in a cycle. If the cycle NH is Hamiltonian, then every vertex is in N so both edges
incident with any vertex of degree 2 must be in NH. This establishes Property 1.
EXAMPLE 5
I
l

312 
Chapter 10 Paths and Circuits
Property 2 asserts that if C is a cycle contained in another cycle A, then C = N.
We prove this by contradiction.
Suppose C is a cycle contained in N and C :# 'H. Then there is a vertex y in
NH which is not in C. Let x be any vertex in C. Since 'H contains both x and y,
there is a path using edges of 'H from x to y. Thus, 'H contains some edge vw
where vertex v is in C but w is not. (See Fig 10.9.) So 'H contains the two edges
of C which are incident with v together with the edge vw. Altogether, there are
three edges incident with v which must be part of 'H. This contradicts Property 1.
Thus 'H is not a cycle.
xY
Figure 10.9
A
Answer true or false and explain: The graph
shown at the right is not Hamiltonian because it
contains the cycle GHIG.
C
E
D
As a deeper application of the properties of Hamiltonian graphs described in
10.2.2, we introduce a famous graph named after the Danish mathematician Julius
Petersen (1839-1910).2 We show that this graph, the one in Fig 10.10, is not
Hamiltonian.
The Petersen graph is not Hamiltonian.
Suppose NH is a Hamiltonian cycle. Then NH must contain at least one of
the five edges connecting the outer to the inner vertices. Since the graph is
symmetric, there is no loss of generality in assuming that AF is part of NH. (Refer
to Fig 10.11.) By Property 1, precisely one of the two edges FH and Fl is in N.
Again, by symmetry, we may assume FH is part of the cycle while Fl is not.
Since FI is not in N, but two edges incident with I must be in N (Property 1),
IG and ID are in NH. Now precisely one of the edges GB, GJ is in H.
Suppose first that GB is in and GJ is out. Because precisely two edges
incident with J are in NH and JG is not, both JH and JE are part of NH. Thus,
2J. Petersen, "Die Theorie der regularen Graphen," Acta Mathematica 15 (1891), 193-220.
-
[SW 
1:1 J  I  41 U
Figure 10.10
I

10.2 Hamiltonian Cycles 
313
A
B
E
Figure 10.11 
C 
D
CH is out and both BC and CD are in K. At this point, however, X contains
the proper cycle BCDIGB, a contradiction. We conclude that GB cannot be part
of X and hence that GJ is. An argument similar to the one just given now leads
again to the false conclusion that K contains a proper cycle.
Give the details of this argument.
No Hamiltonian cycle contains 1234.
Look at the graph pictured in Fig 10.12. Show that no Hamiltonian cycle can
contain edges 1, 2, 3, 4.
Hamiltonian graphs take their name from Sir William Rowan Hamilton (1805-
1865), a contemporary and personal friend of William Wordsworth and Samuel
Taylor Coleridge and indeed a man of many talents. By the age of 13, he had
mastered one language for each year of his life, including Latin, Greek, Hebrew,
Chinese, and Sanskrit! At 17, he had a firm grasp of calculus. He studied astron-
omy at Trinity College, Dublin, and later made important contributions to the
study of optics. He is perhaps best known within the sphere of mathematics as
the inventor of the quaternions, the first noncommutative field to be discovered.
Hamilton's quaternions is an algebraic structure like the real numbers in which one
can add, subtract, multiply, and divide (by any nonzero number), but in which mul-
tiplication is not commutative: There are quaternions a and b for which ab :A ba.
The reader may have encountered noncommutative systems before; for example,
the set of all n x n matrices over the real numbers is not commutative. A basic
difference between matrices and quaternions, however, and the thing that made
Hamilton's discovery so remarkable, is the lack of divisibility in matrices. There
are many nonzero matrices which are not invertible; on the other hand, every
nonzero quaternion has an inverse.
Figure 10.12

314 
Chapter 10 Paths and Circuits
Hamilton also invented a game which made use of a wooden regular dodec-
ahedron, that is, a solid with 12 congruent faces, each of which is a regular
pentagon. The vertices of the dodecahedron were labeled with the names of 20
cities of the world, and the object of the game was to find a route "around the
world," along the edges of the solid, which passed through each city exactly once
and led back to the city where the tour started.
Imagine that the pentagon on which the dodecahedron sits is stretched so that
the solid collapses until it is flat. The result is a graph in the plane. (See Fig 10.13.)
Hamilton's world tour is possible if and only if the graph contains what we now
call a Hamiltonian cycle. The graph in fact is Hamiltonian; a Hamiltonian cycle
is marked with the heavy lines in Fig 10.13.
Figure 10.13 
A dodecahedron and its associated Hamiltonian graph.
There are some graphs in which a Hamiltonian cycle always exists (the com-
plete graph on n vertices, for instance). Assigning the vertices of IC, the labels
VI, V2, .
v 
., v., then vIv2 
vVi 
is a cycle because we are assured of an edge
between each pair of vertices. The cycle clearly passes through each vertex (except
the first and the last) exactly once, so it is Hamiltonian. It would seem that a graph
with "lots" of edges should have a good chance of being Hamiltonian. The fol-
lowing theorem, published by G. A. Dirac in 1952, provides further evidence in
support of this idea.
Proof
(Dirac3) If a graph g has n > 3 vertices and every vertex has degree at least n
then g is Hamiltonian.4
Among all the possible paths in 5, suppose that P: VI V2 ... 
Vt is longest in the
sense that it uses the most vertices. Thus, there is no walk in g which uses more
than t vertices without repeating some vertex. If some vertex w adjacent to Vl is
not in P, then the walk wVI v2 ... Vt does not have repeated vertices and is longer
than P. Since this is contrary to the way P was chosen, every vertex adjacent
to vI is in P. (Similarly, every vertex adjacent to vt is in P.) Since deg vl > n
t > n + 1, the "+1" counting vi itself. Since n > 3 and t is an integer, we
conclude that t > 3 also.
3G. A. Dirac, "Some Theorems on Abstract Graphs," Proceedings London Matheinatical Society 2
(1952), 69-81.
4There is a stronger version of this theorem, due to Oystein Ore, which says that a graph with n > 3
vertices is Hamiltonian as long as the sum of the degrees of any two nonadjacent vertices is at least n. See
Exercise 14.

10.2 Hamiltonian Cycles 315
Claim: There is a pair of vertices Vk, Vk+1 in P (1 < k < t) such that vI is
adjacent to Vk+I and vt is adjacent to Vk, as suggested in Fig 10.14.
Vt
V? 
\ 
Vk+I
V2e 
vk
Figure 10.14 
t+ 
-
If this were not the case, then each of the vertices of P adjacent to vl would
determine a vertex not adjacent to vt (namely, its predecessor in P). Since the
vertices V2, .
v are all different, there would be in g at least n vertices not
adjacent to vt. These vertices, together with the vertices adjacent to vt, account for
at least n vertices in g. Including vt itself, we have found more than n vertices,
which cannot be. This establishes the validity of our claim, from which it follows
that g contains the cycle
C: VlVk+lVk+2 .
VtVkVk-I ... V.
We show that C contains all vertices of g and hence is the desired Hamiltonian
cycle. Remember that C contains at least n + 1 vertices, so there are less than
fl-A vertices not in C. Hence, any vertex w which is not in C must be adjacent to
some vertex v, of C. Then w, vi, and the remaining vertices of C in sequence
would define a path longer than P, contradicting the definition of P. 
I
-
0 
.
Show that Dirac's Theorem is false if 
is replaced by '2 1 in its statement. [Hint:
Examine those graphs presented in this section which are not Hamiltonian.]
4. False! The graph is Hamiltonian: AFEDIHGCBA is a Hamiltonian cycle.
It is not the entire graph which must not contain a proper cycle, but any
Hamiltonian cycle.
5. We are assuming that both AF and FH are in a Hamiltonian path K. As
before, Fl is not in X; therefore, both IG and ID are. Since edge GJ is also
in X while GB is out, both BA and BC are in because two edges adjacent to
B are part of X and BG is not in X, as shown on the left. Using Property 2,
we see that CH cannot be part of X; otherwise X contains the proper cycle
ABCHFA. So both CD and HJ are in. Now X contains the proper cycle
ABCDIGJHFA, a contradiction.
A
E

316 
Chapter 10 
Paths and Circuits
6. If a Hamiltonian cycle NH were to contain edges 2 and 3 (see the graph on the
right), then the third edge at the center could not be part of N (Property 1),
so the edges labeled 5 and 6 would have to belong to At (Property I again).
Now edges 1, 2, 3, 4, 5 and 6 form a proper cycle within 'H. This contradicts
Property 2.
7. The graph g2 in Fig 10.8, which is not Hamiltonian, has n = 5 vertices each
of degree at least 2 = "
The symbol [BB] means that an answer can be found in the Back of the Book.
1. [BB] Is the graph Hamiltonian? Is it Eulerian?
Explain your answers.
2. [BB; (b),(d)] Determine whether or not each of the
graphs of Exercise 4 of Section 10.1 is Hamiltonian. In
each case, either label the edges with numbers so as to
indicate a Hamiltonian cycle or explain why no such
cycle exists.
A Hamiltonian path in a graph is a path which passes
through every vertex exactly once.
3. Determine whether or not each of the graphs shown is
Hamiltonian. Determine also whether or not each graph
has a Hamiltonian path. In each case, either number the
vertices so as to indicate a Hamiltonian cycle or path or
explain why no such cycle or path exists.
(a)
(b)
(c) I 
(d)
4. (a) [BB] Is the graph Hamiltonian?
(b) Is there a Hamiltonian path?
(c) [BB] Is it Eulerian?
(d) Is there an Eulerian trail?
Explain your answers.
E
B
C
D
5. (a) (The Knight's Tour) Is it possible for a knight to
tour a chessboard visiting every square exactly once
and returning to its initial square? (See Exercise 8
of Section 9.2.)
(b) Is the sort of tour described in 5(a) possible on a
7 x 7 "chessboard"?
(For a complete classification of those in x n boards on
which knight's tours are possible, the reader is directed
to the interesting article by Allen J. Schwenk which
appeared in the December 1991 issue of Mathematics
Magazine.)
0 W144:19VII

10.2 Hamiltonian Cycles 
317
6. Is the graph of Fig 10.12 Hamiltonian? Display a Hamil-
tonian cycle or explain clearly why no such cycle exists.
7. The figure shows the floor plan of a single-story house
with various doorways between rooms and other door-
ways leading outside.
0
A 
B 
C D
EF
G
(a) [BB] Is it possible to start outside, then to enter the
house and walk through every room exactly once
(without leaving the house), and finally to return
outside? If yes, exhibit the route on a copy of the
floor plan.
(b) Is there a route which starts outside and leads
through every doorway in the house exactly once?
(You are allowed to return outside or to reenter
rooms as often as you want.)
8. [BB] In a group of 2n people, each person has at least
n friends. Prove that the group can be seated in a circle,
each person next to a friend.
9. (a) [BB] How many edges must a Hamiltonian cycle in
ICn contain?
(b) How many Hamiltonian cycles does K),, 
have?
(Begin all cycles at the same vertex.)
(c) [BB] What is the maximum number of edge dis-
joint Hamiltonian cycles in IC,,? 5 (Cycles are edge
disjoint if no two of them have an edge in common.)
(d) Find all the Hamiltonian cycles in ICn for n =
1, 2, 3, 4, 5. In each case, exhibit a maximum num-
ber which are edge disjoint.
10. [BB] Draw a picture of a cube. By imagining that the
bottom square is stretched until it is flat, draw a graph
of the flattened cube. Is this graph Hamiltonian? If so,
draw a Hamiltonian cycle. If not, explain why not.
11. The picture on the left is that of an icosahedron, a solid
object whose faces consist of 20 congruent equilateral
triangles. By stretching the base triangle and flatten-
ing, the icosahedron determines a graph in the plane
(as shown on the right side of the figure). Find a Hamil-
tonian cycle in this graph.
12. Make a model of a dodecahedron (Fig 10.13) and trace
a Hamiltonian path along its edges. Do the same for
the icosahedron. (Suggestion: Look for ideas in geom-
etry texts, in their discussions of the Platonic solids.
One such book is the wonderful work of H. S. M. Cox-
eter, Introduction to Geometry, Wiley, New York,
1961.)
13. (a) [BB] Suppose g is a graph with n vertices, each of
which has degree d > -2 i Prove that g contains
a Hamiltonian path. [Hint: Add an extra vertex to
9 which is adjacent to every vertex and use Dirac's
Theorem.]
(b) Does the graph shown on the left have a Hamil-
tonian path? If so, find it. If it doesn't have one,
explain why not.
(c) Repeat the previous question for the graph on the
right.
(d) Does the converse of (a) hold; that is, if a graph has
a Hamiltonian path, must the degree of every vertex
be at least '2'? Explain your answer. What about
the converse of Dirac's Theorem?
(e) [BB] Give an example of a graph which has a Hamil-
tonian path but no Hamiltonian cycle.
14. (Ore's Theorem) Suppose 9 is a graph with n > 3 ver-
tices and that the sum of the degrees of any two nonad-
jacent vertices is at least n. Prove that 5 is Hamiltonian
by starting with a path P: vI V2 . Vt of greatest length,
as in the proof of Dirac's Theorem, and then considering
separately the cases where
51n fact, any complete graph actually has this maximum number of edge disjoint cycles.

318 
Chapter 10 
Paths and Circuits
(a) [BB] vi and v, are adjacent, and
(b) vl and v, are not adjacent.
15. [BB] Suppose 5 is a graph with n > 2 vertices such that
the sum of the degrees of any two nonadjacent vertices
is at least n -1. 
Prove that 5 has a Hamiltonian path.
16. Answer true or false and in each case either give a proof
or provide a counterexample.
(a) A Hamiltonian graph contains no proper cycles.
(b) Every vertex in a Hamiltonian graph has degree 2.
(c) [BB] Every Eulerian graph is Hamiltonian.
(d) Every Hamiltonian graph is Eulerian.
17. Let g be a graph with at least three vertices.
(a) [BB] If there is a Hamiltonian path between any two
vertices of g, need 5 contain a Hamiltonian cycle?
Explain.
(b) If, at every vertex v in g, there is a Hamiltonian
path which starts at v, need 5 contain a Hamiltonian
cycle? Explain.
(c) Is it possible for there to exist an Eulerian trail
between any two vertices of 5? If so, need 5 contain
an Eulerian circuit? Explain.
18. A connected graph 5 has 11 vertices and 53 edges. Show
that 5 is Hamiltonian but not Eulerian.
19. Find a necessary and sufficient condition on m and n in
order for KCmn to be Hamiltonian. Prove your answer.
10.3 
THE ADJACENCY MATRIX
Graphs occur with increasing frequency in modern-day problems. While theo-
retically, any problem associated with a finite graph is solvable, in practice, the
number of cases to consider is often so large and the time needed to deal with
each case so great that an exhaustive search of all possibilities is impossible.
Accordingly, the discovery of new graph-based algorithms and ways to improve
efficiency are flourishing areas of mathematical research today. In order to write
an algorithm which requires the input of a graph, we first must decide how to code
the pertinent information which describes a graph. For this purpose, the adjacency
matrix is commonly used.
S 
I 
a
EXAMPLE 6
Let g be a graph with n vertices labeled Vt, v2, ..
v, 
v. For each i and j with
1 < i, j <n, define
ai= 
|I if vivj is an edge
a 0 
if vivj is not an edge.
The adjacency matrix of g is the n x n matrix A = [aij] whose (i, j) entry is aij.
Figure 10.15 shows a graph g and its adjacency matrix A.
A
V1 
V2 
13
0
V4 
195
- 0 
0
0 
0
A= 
0 0
1 1
-0 
1
A graph and its adjacency matrix.
0
0
0
0
0
0
1
0
1
0
0
0 I
Figure 10.15

10.3 The Adjacency Matrix 
319
EXAMPLE 7 
The adjacency matrix of the complete bipartite graph on the sets V1 = {vI, v21
and V2 = {V3, V4, V5} is
0 
0 
1 
1 
1
O 0 
1 
1 
1
1 
1 
0 
0 
0 
A
I 
1 0 0 0
I 
I 
0 
0 
0-
Since the adjacency matrix records all the incidence relations in a graph, it is
not surprising that it can be used to give a lot of information about the graph. We
list here some of the basic properties of an adjacency matrix. Some are obvious,
mthler 
-nt 
-4lt. 
nlip- 
J-f 
tl. .
maft -llruo Ut11 a 
-l 
.s 
to 
l-v 
LX.Sl-MilhWfl
--
lil; 
--
~ yul... -, 
-- l 
"l--dpb 
`-1 
--
U~ 
bU--U 
-1 
-, 
-
-
_-" 
...
~ 
a 
V..IUI,
we leave to Chapter 12.
Let g be a graph with vertices VI, v2, ... 
, v, and let A = [aij] be the adjacency
-ftriY 
of a'
1. The diagonal entries of A are all 0; that is, aii = 0 for i = 1, .
n. This fol-
lows because an edge from vertex vi to vi is a loop and loops are not allowed
in graphs. (Actually, we can define the adjacency matrix of a pseudograph
and show that it has most of the properties given here, but we shall restrict
our attention to graphs.)
2. The adjacency matrix is symmetric, that is, aij = aji for all i, j.
Conversely, given any symmetric matrix A which contains only O's and l's
and only O's on its diagonal, there exists a graph g; whose adjacency matrix is
A. Thus, there is a one-to-one correspondence between graphs and symmetric
0, 1 matrices with only O's on the diagonal.
The next three properties are less obvious than the first two. We will discuss
them in some detail after a couple of Pauses.
3. deg vi is the number of l's in row i; this is also the number of l's in column i
since row i and column i are the same, by symmetry.
4. The (i, j) entry of A2 is the number of different walks from vi to vj which
include two edges; thus, the degree of vi is the ith entry on the main diagonal
of A2.
5. In general, for any n > 1, the (i, j) entry of A' is the number of walks from
vi to vj which include n edges.
1 0 0 0
Can the 4 x 4 identity matrix I = 
0 0 
1 0 I be the adjacency matrix of
L 00101
0 
0 
0 
1
a graph?
[ 
0 
0 
1
Find a graph whose adjacency matrix is A = 
0 0 
1 0
L 0 
0 0
M

320 
Chapter 10 
Paths and Circuits
EXAMPLE 8
As mentioned, the powers of an adjacency matrix A evidently have special
significance. In order to understand why the (i, j) entry of A2 is the number of
walks of length 2 between vi and vj in the graph corresponding to A, remember
that this entry is the dot product of row i and column j of A. Since A contains
only O's and l's, this dot product is just the number of coordinates in which
row i and column j each have a 1. For example, if row i of A were the vector
[0, 0, 1, 0, 1, 1, 0] and column j the vector [1, 1, 1, 0, 0, 1, 0], then the dot product
(row i) 
(column j) = 2, corresponding to the two coordinates (third and sixth)
where each vector has a 1. How does it happen that a row and a column have a
I in the same coordinate? In our example, row i and column j each have third
coordinate 1; this corresponds to the fact that there is an edge in the graph between
vi and V3 and an edge between vj and V3. There is a walk in the graph from vi to
vj which uses two edges, namely, Vi 3 vjv. The dot product of row i and column j
is therefore the number of walks of length 2 from vi to vj.
In general, there is one walk of length 2 from a vertex to itself for each
edge incident with that vertex. Thus, the degree of vertex vi is the diagonal entry
aii of the square of the adjacency matrix, as asserted in Property 4. The rest of
Property 4 and Property 5 can be justified with similar arguments.
r 1 
2 
0 
1
1 2 0 
1 1
Referring to Fig 10.15, A2  
0 0 
2 0
0 
1 0 3 1
I I 0 
1 2-
The (4, 2) entry of A2 is 1 corresponding to the fact that there is precisely one
walk of length 2 between V4 and V2 in the associated graph: v4v5 v2. The (4, 4)
entry of A2 is 3; there are three walks of length 2 from V4 back to V4, one for
each edge incident with V4. 
A
- 0 
1
1 2
The third power of the matrix A in Fig 10.15 is A3 = 
0 
0
3 4
- 1 3
0
EXAMPLE 9
0
0
0
0
0
3
4
0
2
4
3
0
4
2I
The (4, 5) entry of A3 is 4. Thus, there are four walks of length 3 from V4 to V5
in the graph. What are they?
Since the adjacency matrix of a graph records the number of vertices and the
adjacencies between them, the following theorem is straightforward.
Two graphs are isomorphic if and only if their vertices can be labeled in such a
way that the corresponding adjacency matrices are equal.
The graphs in Fig 10.16 have been labeled so that each has the adjacency matrix
K 
10 
1
I 0 1 0
10 
1 
.
I 
0 
1 0-

10.3 The Adjacency Matrix 321
(These are the graphs which appeared in Fig 9.23, with the labels A, B, C, D
replaced by vl, V2, V3, V4, respectively.) As we earlier noted, these graphs are
isomorphic. 
A
VI 
V4 
VI 
V4
V2 
V3 
V3 
V2
!;I 
g2
Figure 10.16 
Two graphs labeled so as to show that they are isomorphic.
Suppose we are presented with two graphs which are already labeled. Can
we tell from the adjacency matrices whether or not the graphs are isomorphic?
Consider again the graphs of Fig 10.16, but labeled as in Fig 10.17.
V1  
V4 
al 
u3
'2 
v3 
U2 
U4
5i I 
2
Figure 10.17 
Two isomorphic graphs.
The adjacency matrices Al and A2 of 
9 I and 92, respectively, are
~0 
1 
0 
1 -
-O 
1 
1
Al = 
0 1 0 
and 
A2= 
0 0 1 1
-I 
0 
I 
0- 
1 
1 
0 
Â°-
Although these graphs are isomorphic, their matrices are not equal simply because
of the way the graphs were presented to us, their labels already in place. Observe,
however, that the following reassignment of labels to 9; 
defines an isomorphism
I- 
92.
VI 
UI
V2 
u 4
V3 
u 2
V4 
U3
We use this isomorphism to obtain a permutation matrix P. that is, a matrix
whose rows are the rows of the identity matrix, but not necessarily in their natural
order. Precisely, let P be that 4 x 4 matrix with row 1 of the 4 x 4 identity
matrix as its first row, row 2 of the identity as its fourth row, row 3 of the
identity as its second row, and row 4 of the identity as its third row. In other
words,

322 
Chapter 10 Paths and Circuits
A 
* 
g 
*. 
-
I 
0 
0 
0
00 0
0 
1 
0 
0-
Notice how the isomorphism in (1) determines P. If the isomorphism maps vi to
uj, we put row i of the identity matrix into row j of P. Just as the relabeling of
the vertices of g1 given by (1) transforms g1 into g2, the matrix P transforms
the adjacency matrix of g1 into the adjacency matrix of g2 in the sense that
PAI pT = A2. The notation pT means the transpose of the matrix P, that is, the
matrix obtained from P by interchanging rows and columns.
0 
0 
0 
0 
0 
1 0 1 
1 0 0 0
PA PT 
1 0 
0 0 0 
1 
1
P0s 
= 0 
1 
0 
1 
0 
1 0 0
1 0 0 
-
1 
0 
1 
0 
0 
1 0 ]
O 
1 0 1 
1 
0 
0 
0
o 
1 0 1 
1 
0 0 
I
I 
010 
I 
01 
0 1
Li 0 1 0] L 0010]
0 
0 
1 
1
2 0 
1 
1
= I 
I 
Â° 
Â° 
A2
I 
10 0 
0
Graph g1 shown at the right is the same as g in 
Ul 
u 4  
u3
Fig 10.15, except that the labels VI, V2, V3, V4, v 5  
0
have been replaced by uI, U4, U3, u2, U5, respec-
tively. Find the adjacency matrix AI of g1. Then
find a permutation matrix such that PAPT = Al.
U2 
U5
The proof of the following theorem, which we have been illustrating, is not
especially interesting and will not be included. The key idea is that if g is a
graph with adjacency matrix A, then an isomorphism from g to another graph
just amounts to renumbering the vertices of 5. Renumbering vertices corresponds
to permuting the rows (equivalently, computing PA) and permuting the columns
of A (equivalently, computing APT), hence, changing A to the matrix PA PT.
See the Exercises for more details.
Labeled graphs g1 and 52, with adjacency matrices Al and A2, respectively, are
isomorphic if and only if A2 = PAI pT for some permutation matrix P.
8. No, by Property 1.
FÂ°OÂ°O 11 
Vl 
V2
090 0H 
I- 
a g w
9. Here is a graph with adjacency matrix A -
o 0 
1 0
L 100 ol 
V3 
V4

10.3 The Adjacency Matrix 323
10. There are four walks of length 3 from V4 to V5: V4V5V2 V5, V4V IV4V5, V4V5V4V5,
and v4v2v4v5.
0 
1000 
0 
0 
0 0
I 
0 0 
1 
1 1 
0 0 1 0
11. Al 
= 
0 0 
00 
P0 
1 0 0
11IAI=[0 
1 0 
1 
0 
0 
0 
1
0 
1 0 
1 
0 
0 
0 
0 
0 
1
The equation PAPT = Al corresponds to the reassignment of labels to the
graph g, whose adjacency matrix is A. The matrix P is therefore the 5 x 5
matrix where row I of the identity is in row 1, where row 2 of the identity is
in row 4, where row 3 of the identity is in row 3, where row 4 of the identity
is in row 2, and row 5 of the identity is in row 5.
The symbol /BB] means that an answer can be found in the Back of the Book.
1. Find the adjacency matrices of the graphs in Figs 10.1
[BB] and 10.3.
2. What is the adjacency matrix of Ca,? Label the vertices
of KIC,, so that the adjacency matrix has an especially
nice form.
3. (a) [BB] Let A be the adjacency matrix of the graph g2
shown in Fig 10.8. Determine the (3, 5) entry of A3
by inspection of the graph, that is, without writing
down A explicitly. Determine the (2, 2) entry of A3
by similar means.
(b) Repeat part (a) for the graph g1 of Fig 10.8.
4. [BB] What is the significance of the total number of l's
in the adjacency matrix of a graph?
5. Let A be the adjacency matrix of a graph g whose vertex
set is fv1, . . ., vJ Prove that the ith entry on the diago-
nal of A3 equals twice the number of different triangles
which contain vertex vi.
6. Suppose that g is a graph with adjacency matrix A.
(a) [BB] Show that the number of walks of length 2 in
g is the sum of the entries of the matrix A2.
(b) Let di denote the degree of the vertex vi in 5. Show
that the sum of the entries of A2 is also Edi .
7. Find the adjacency matrices AI and A2 of the graphs
g1 and Q2 shown. Find a permutation matrix P such
that A2 = PAIP7 
thus proving that (1 and g2 are
isomorphic. [Hint: See Pause 6 of Section 9.3.]
VI 
V2
V4 
U3
51
0 
U2
u3
52
8. (a) [BB] Find the adjacency matrices AI and A2 of the
graphs g1 and 52 shown.
Vl 
V4
X5
V2 
V3
U01 
03
02 
04 
05
(b) [BB] Explain why the function q: g1 -
2 defined
by
(V() 
= U4, (P(U2) = U5, 
0()3) =U,
P(V4) = U3, 9(V5) 
U2
is an isomorphism.
(c) [BB] Find a permutation matrix P which corre-
sponds to the isomorphism in (b) such that
PA]PT = A2.
9. Repeat Exercise 8 for the graphs !1 and g2 shown. For
p, take the function 51 -+ 
2 defined by
(P(VI) = U4, (P(V2) = UI, 
(PV3)
q(V4) = U6, ((V5) = U3, k(v6)
U5,
012.

324 
Chapter 10 
Paths and Circuits
VI 
V2 
V3
/ V6
V5 
V4
GI
Ut 
U2
U4 
U3
52
10. Repeat Exercise 8 for the graphs Q1 and Q2 shown. For
p, take the function g1 --+ 
2 defined by
qo(vI) = uI, 
9(v2) = u2, (, (v3) = U6, p(v4 ) = U8,
p(v5) = U4, O(v6) = U3, (Pv7) = u7, O(vO) = U5.
V1
V2
U2 
U3
52
a 
b 
c 
0 
1 O
11. Let A 
P 
q 
r 
and let P = 
O 
0
x 
y 
z 
I 
O O
Thus P is a permutation matrix whose rows are those
of the 3 x 3 identity matrix in the order 2, 3, 1.
(a) [BB] Compute PA and compare with A.
(b) Compute APT and compare with A.
(c) Compute PAPT and compare with A.
a 
b 
c 
d
12. Let A = 
p q 
r 
s 
and let P be the permu-
tation matrix 
I O O 1
Find PA, AP 1 and PAPT without calculation but with
explanations.
13. For each pair of matrices Al, A2 shown, decide whether
or not there is a permutation matrix P with A2 =
PAIPT
2 Either find P or explain why no such P exists.
(a) [BB] A 
I O I 
,
0 
1 
0 
1
-
1 
0 
0-
1 
o 0 
I
A 2 = 
0100Â°
L0 1 00]
0 o 
o 
1 
1
1 0 1 01,
(b) Al 
0 
I O I 
O
(hA~ 0 
0 1 0
g 
11 011
I 
1 0 0 ]
-2 I 
O 
O 
I 
O
A2= 
1 
0 
1
0 1 
0 10
I 
O 1 
0 
1 1
I 
0 
1 0 ]
(c A0 = 
O 
0 
1 
,
O 
I 
O 
I 
0 
1
1 
0 
1 
0 
1 
0-
I 
O I 
O O 
I
A2 = 
I 
O 
I 
O 
I
1 
0 
0 
1 
0 
1
O 
I 
I 
0 
1 
0
14. [BB] Let A be the adjacency matrix of a bipartite graph.
Prove that the diagonal entries of A37 are all equal to 0.
15. Let A be the adjacency matrix of a graph 5.
(a) [BB] Find a necessary and sufficient condition for
the matrix A2 to be the adjacency matrix of some
graph.
(b) Find a necessary and sufficient condition for A3 to
be an adjacency matrix.
16. Let A be the adjacency matrix of a graph g with at least
two vertices. Prove that g is connected if and only if, for
some natural number n, the matrix B = A+A 2 + 
+A"
has no zero entries.
17. Suppose Al and A2 are the adjacency matrices of iso-
morphic graphs 51 and 0 2, respectively. Show that AI
and A2 have the same characteristic polynomial. [Hint:
First show that if P is a permutation matrix, then pT
P '1.
18. [BB] Discuss other ways, besides the adjacency matrix,
that a graph could be stored in a computer.
,1

10.4 Shortest Path Algorithms 
325
10.4 
SHORTEST PATH ALGORITHMS
In this section, we consider graphs whose edges have numbers attached to them.
Typically, the number associated with an edge is a unit of time, distance, cost, or
"capacity" in some sense.
A weighted graph is a graph g in which each edge, e, is assigned a nonnegative
real number, w(e), called the weight of e. The weight of a subgraph of g (often
a path or a trail) is the sum of the weights of the edges of the subgraph.
One famous problem concerning weighted graphs is known as the Traveling
Salesman's Problem.
The Traveling Salesman's Problem
On a typical business trip, a traveling salesman visits various towns and cities. If
he wants to avoid having to pass through the same community twice, he needs
a Hamiltonian cycle through the map of towns and air routes. This map can be
thought of as a graph in an obvious way. Assigning to each edge a weight equal to
the distance between the cities at the ends, the traveling salesman's graph becomes a
weighted graph. Among all Hamiltonian cycles (assuming there are any), what our
salesman would like to find is one whose weight is a minimum, in order to economize
on flying time and expenses. The problem of finding a minimum Hamiltonian cycle
in a weighted (Hamiltonian) graph is called the Traveling Salesman's Problem. It
can be solved by laboriously calculating all Hamiltonian cycles and then selecting
the most economical. At the time of writing, it is unknown whether or not a more
efficient algorithm is possible. In fact, the Traveling Salesman's Problem is many
people's favorite example of an NP-complete problem: It is an open question as to
whether or not there exists an efficient (polynomial time) algorithm for its solution.
Our aim in the rest of this section is to discuss a certain problem concerning
weighted graphs for which, unlike the Traveling Salesman's Problem, complete
and efficient solutions exist. A shortest path between two vertices in a weighted
graph is a path of least weight. (In an unweighted graph, a shortest path means
one with the fewest number of edges.) Numerous algorithms for finding shortest
paths have been discovered. We will present two of them here and show how
they apply to the graph of Fig 10. 18, which we might view as a map, the vertices
representing towns, the edges, roads, and the weights of the edges, distances.
C
E
A
Figure 10.18

326 
Chapter 10 
Paths and Circuits
The first algorithm we present is due to Holland's Edsger Dijkstra (1930-),
one of today's leading computer scientists and discoverer of a number of important
graph algorithms. Dijkstra's algorithm6 finds the shortest path from a specified
vertex A to another specified vertex E. If continued indefinitely, it gives shortest
paths from A to all other vertices in the graph. If no path exists, then this is
identified by the algorithm. It proceeds by progressively assigning to each vertex
v in the graph an ordered pair (x, d), where d is the shortest distance from A to v
and xv is the last edge on the shortest path. Thus, if E is eventually labeled (w, t),
the shortest path from A to E is t units long and the last edge of the shortest path
is wE. The first coordinate of the label for w determines the second last edge
of the shortest path, and by continuing to work backward, the entire path can be
found. If vertex E never gets labeled, there is no path from A to E; the graph is
not connected.
To find a shortest path from vertex A to vertex E in a weighted graph, carry out
the following procedure.
Step 1. Assign to A the label (-, 0).
Step 2. Until E is labeled or no further labels can be assigned, do the following.
(a) For each labeled vertex u(x, d) and for each unlabeled vertex v adjacent
to u, compute d + w(e), where e = uv.
(b) For each labeled vertex u and adjacent unlabeled vertex v giving min-
imum d' = d + w(e), assign to v the label (u, d'). If a vertex can be
labeled (x, d') for various vertices x, make any choice.
C (B, 15)
, 20)
4
) 
E
X(F, 
21)
6
A
F(G, 15)
Dijkstra's shortest path algorithm applied to a weighted graph.
Here is how Dijkstra's algorithm works for the graph in Fig 10.18. (Refer
to Fig 10.19.) First, give A the label (-, 0). There are three edges incident with
A with weights 7, 5, and 8. Since d = 0, vertex H gives the smallest value of
d + w(e), so H acquires the label (A, 5). Now we repeat Step 2 for the two
vertices labeled so far.
There are two unlabeled vertices adjacent to the already labeled vertex A. The
numbers d+w(e) are 0+7 = 7 and 0+8 = 8. There are also two unlabeled vertices
adjacent to the other labeled vertex, H, and for these, the numbers d + w(e) are
6E. W. Dijkstra, "A Note on Two Problems in Connection with Graphs," Numerische Mathematik 1
(1959), 269-271.
IiiII[
Figure 10.19

10.4 Shortest Path Algorithms 
327
5 + 4 = 9 and 5 + 5 = 10. The smallest d + w(e) is 7, corresponding to the
labeled vertex u = A and the unlabeled v = B. Thus, B is labeled (A, 7). Again
we repeat Step 2.
Now there are three labeled vertices. There is one unlabeled vertex adjacent
to the labeled vertex A, and for this, d + w(e) = 0 + 8 = 8. There is also just
one unlabeled vertex adjacent to the labeled H, and here, d + w(e) = 5 + 5 = 10.
There are two unlabeled vertices adjacent to the third labeled vertex B; for C,
d + w(e) = 7 + 8 = 15 and for I, d + w(e) = 10. The smallest d + w(e) is 8,
corresponding to edge AG. So G acquires the label (A, 8).
We repeat Step 2. There are four labeled vertices, A, B, H, and G, and the
algorithm requires that we look at all unlabeled vertices adjacent to each of these.
Since all vertices adjacent to A and to H have already been labeled, we have,
in fact, only to look at B and G. There are two unlabeled vertices adjacent to
B. For C, d + w(e) = 7 + 8 = 15; for I, d + w(e) = 7 + 3 = 10. There are
two unlabeled vertices adjacent to G. For I, d + w(e) = 8 + 2 = 10; for F,
d + w (e) = 8 + 7 = 15. The minimum d + w (e) occurs with I and either edge B I
or GI. We can therefore assign to I either the label (B, 10) or the label (G, 10);
we opt for (B, 10).
Repeating Step 2, we have only to look at vertices B, G and L. The only
unlabeled vertex adjacent to B is C, for which d + w(e) = 7 + 8 = 15. The only
unlabeled vertex adjacent to G is F, for which d + w(e) = 8 + 7 = 15. There are
two unlabeled vertices adjacent to I. For C, d + w(e) = 10 + 5 = 15 and for J,
d + w(e) = 10 + 7 = 17. Vertices C and F which tie for the minimum d + w(e)
are each labeled. Vertex F is labeled (G, 15) and C can be labeled either (B, 15)
or (1, 15); we choose (B, 15).
Continuing in this way, the vertices of the graph acquire the labels shown
in Fig 10.19. The shortest route from A to E has weight 21. A shortest path is
AGFE, as we see by working backward from E. Since E was labeled last, the
algorithm has actually found the length of a shortest route from A to any vertex.
For instance, ABIJ is a shortest path to J, of weight 17.
What is the complexity of Dijkstra' s algorithm? We take as our basic operation
an addition or comparison (which we weight equally). Each time we iterate Step 2,
one or more new vertices acquire labels; the worst case occurs if only one new
vertex is labeled each time. Assume, therefore, that at the kth iteration, k vertices
have been labeled. Each of these vertices is conceivably adjacent to n-k unlabeled
vertices. For each such vertex there is one addition. After at most k(n -k) additions
in all, we must find the minimum of at most k(n - k) numbers, a process requiring
k(n -k) -1 
comparisons.7 At worst, therefore, Dijkstra's algorithm requires
nl I 
n3 
4
f(n) = 
-[ 
2k(nk) 1- 
-
- -nÂ± 
4
operations, a function which is 0(n 3). Note that f (n) is also an upper bound for
the total number of operations required if the algorithm runs until all vertices are
labeled. [This was our assumption in computing f (n).]
7Finding the minimum of t numbers requires t -I comparisons. (See Exercise 4 of Section 8.2.)

328 
Chapter 10 Paths and Circuits
With a few minor modifications, the efficiency of Dijkstra's algorithm can be
substantially increased. We present an improved version here and apply it, as with
the former, to determine the weight of a shortest path from A to E in the graph
of Fig 10.18.
In the new version, the starting point A is assigned a permanent label of
0, while all other vertices initially are assigned temporary labels of so. At each
iteration, the temporary labels are decreased or left unchanged, and one additional
vertex is assigned a permanent label, namely, the shortest distance from A to that
particular vertex. This procedure continues until the required terminal point E
acquires a permanent label, or until some iteration results in no temporary labels
(including that of E) being changed. In the latter case, we can conclude that there
is no path from A to E.
To find the length of a shortest path from vertex A to vertex E in a weighted
graph, proceed as follows.
Step 1. Set v1 = A and assign to this vertex the permanent label 0. Assign every
other vertex a temporary label of so, where so is a symbol which, by definition,
is deemed to be larger than any real number.
Step 2. Until E has been assigned a permanent label or no temporary labels are
changed in (a) or (b), do the following.
(a) Take the vertex vi which most recently acquired a permanent label, say
d. For each vertex v which is adjacent to vi and has not yet received
a permanent label, if d + w(viv) < t, the current temporary label of v,
change the temporary label of v to d + w(viv).
(b) Take a vertex v which has a temporary label smallest among all temporary
labels in the graph. Set vi +I = v and make its temporary label permanent.
If there are several vertices v which tie for smallest temporary label, make
any choice.
Here is how the algorithm works for the graph of Fig 10. 18. We will describe
the first few iterations in words, draw a figure summarizing the state we have
reached, and then describe the remaining iterations. Readers might well wish to
follow our description with their own diagrams.
At the start, A = vl is given the permanent label 0; all others are given
temporary labels so. Next, H, B, and G have their temporary labels decreased to
5, 7, and 8, respectively, while all other temporary labels stay at so. Since 5 is
the minimum of 5, 7, 8, we set v2 = H and make 5 its permanent label.
Now examine those vertices with temporary labels adjacent to V2. For B,
5-+-w(e) = 5+4 = 9, but this is larger than its temporary label of 7, so no change
occurs. For G, 5 + w(e) = 5 + 5 = 10, again larger than the older temporary
label of 8. Hence, no temporary labels are changed. The smallest temporary label
in the graph at this point is 7, so this becomes the next permanent label and
V3 = B.
Next, we examine temporary vertices adjacent to V3. This will assign to C a
new temporary label of 7+8 = 15 and, to I, a new temporary label of 7+3 = 10.
,~ 
I 
i
-"

10.4 Shortest Path Algorithms 
329
The smallest temporary label is 8, on G; so V4 = G and this vertex acquires the
permanent label 8. Figure 10.20 shows the present state of affairs. Permanent
labels are circled; temporary labels are in parentheses.
C(15) 
D(0
1)3 =B 
3 
3 
g
/s 
A 
'( 
E(o)
Figure 10.20 
Dijkstra's algorithm, improved version.
Next, we focus on V4. For I, we obtain 8+2 = 10, the current label, so there
is no change. For F, we get 8 + 7 = 15, so F gets a temporary label of 15 and
V5 = I is assigned the permanent label of 10. At the next iteration, we have a
choice of C or F for v6 and J gets a temporary label of 17. Assuming V6 = C,
then F will be v7 and D will obtain a temporary label of 23.
At the next step, E gets a temporary label of 21 and v8 = J. Then D gets its
temporary label lowered to 20 and becomes v9. Finally, vlo = E with a permanent
label of 21. Note that the permanent labels are exactly the second coordinates of
the labels assigned to the vertices in Fig 10.19.
As stated, this algorithm gives the length of the shortest path but not the path
itself. If at each choice of a permanently labeled vertex vi, however, we also make
note of the vertex ve from which its permanent label arose, using
(permanent label of ve) + (weight of edge yev,) = permanent label of vi,
then we can easily trace back the shortest path. Also-and the original algo-
rithm has the same property-if allowed to continue until all vertices are labeled,
the improved version will give the shortest distances from A to all other ver-
tices.
Before introducing another shortest path algorithm, we justify the adjective
improved, which we applied to the second version of Dijkstra's algorithm by
showing that the complexity function for the second version indeed has smaller
order than that for the original.
In the second version, exactly one vertex is given a permanent label at each
iteration of Step 2. Assume Vk has just received a permanent label. There are, at
worst, n - k vertices adjacent to Vk. For each such vertex, one addition is required
and then one comparison to determine whether or not to change a temporary label.
This process requires 2(n - k) operations. Finally, to choose the smallest among
n -k 
temporary labels requires an additional n - k -I 
comparisons. In all, at
most
n-l
I(n) =[2(n 
-k)+(n -k-1)]
k=l

330 
Chapter 10 Paths and Circuits
n-I
=[33(n-k)- 
1]
= 3n2 _ 5-n + 1 = 
7(n 2)
2 
2
operations are required. Recalling that the original version of Dijsktra's algorithm
was O(n3), we see that the second is indeed more efficient than the original.
Again, we also observe that the complexity function is still O(n2) even if it runs
until all vertices get labeled.
If our goal is to find the shortest path between every pair of vertices in
a weighted graph with n vertices, we can employ either version of Dijkstra's
algorithm, letting it run until all vertices have acquired their final labels and
repeating this procedure for each of the n possible starting points. The complexity
functions increase by a factor of n to 0(n 4) in the original version and to 0(n 3)
in the improved case. There is also an algorithm, due to R. W. Floyd8 and S. War-
shall,9 which determines the shortest distances between all pairs of vertices in a
graph. This algorithm is popular because it is so easy to describe.
To find the shortest distances between all pairs of vertices in a weighted graph
where the vertices are VI, V2, ...
, n, carry out the following procedure.
Step 1. For i = 1 to n, set d(i, i) = 0. For i 7& j, if vivj is an edge, let d(i, j)
be the weight of this edge; otherwise, set d(i, j) = oo.
Step 2. Fork= 1 to n,
for i, j = 1 to n, let d(i, j) = min d(i, j), d(i, k) + d(k, j)}
The final value of d(i, j) is the shortest distance from vi to vj.
Initially, the algorithm sets the shortest distance from vi to vj to be the length
of edge vivj, if this is an edge. After the first iteration of Step 2 (k = 1), this
shortest distance has been replaced by the length of the path vivl v, if this is a
path. In general, after stage k, the algorithm has determined the shortest distance
from vi to vj via the vertices Vl, V2, .....
, Vk. This distance is the true shortest
distance after k = n. In Fig 10.21, we show a graph, the initial values of d(i, j),
and the values of d(i, j) after each change in k.
The Floyd-Warshall algorithm is very efficient from the point of view of
storage since it can be implemented by just updating the matrix of distances with
each change in k; there is no need to store different matrices. In many specific
applications, it is faster than either version of Dijkstra's algorithm although, like
the improved version, it too is 0(n 3).
8R. W. Floyd, "Algorithm 97: Shortest Path," Communications of the Association for Computing Machin-
erv 5 (1962), 345.
9S. Warshall, "A Theorem on Boolean Matrices," Journal of the Association for Computing Machinery
9 (1962), 11-12.
-jlK 
W-C'] I kgNI T'

10.4 Shortest Path Algorithms 
331
Initial values of d(i, j)
Vl 
V2 
V3 
V4 
V5
v6
1 
3 
o0 
I 
4
o 
I 
o 
2 
o
I 
0 
3 
oo 
0 
o
00 3 
0 
1 
2
2 
o 
I 
0 
2
00 O0 2 
2 
0
After k = I
0 
1 
3 0o 
I
I 
0 1 0o 
2
3 
1 
0 
3 
4
oo 0 
c 
3 
0 
1
1 
2 
4 
1 
0
4 
5 
7 
2 
2
After k = 4
0 1 
2 
5
1 0 
1 
4
-- 
2 
1 0 
3
5 
4 
3 
0
1 2 
3 1
4 
5 
5 
2
4
5
7
2
2
0
2
3
0
2
After k = 2
0 
1 
2 0o
I 
0 1 
o0
-- 
2 
1 
0 
3
o00oo 
3 
0
1 
2 
3 1
4 
5 
6 
2
4
5
5
2
2
0
After k = 5
0 1 
2 
2
1 0 1 
3
-
2 
1 0 
3
2 
3 
3 
0
1 2 
3 
1
3 
4 
5 
2
14
2 
5
36
12
02
20
13
24
35
12
02
20
After k = 3
0 
1 
2 
5 1
1 0 1 
4 
2
-
2 
1 0 
3 
3
5 
4 
3 
0 1
1 2 
3 1 
0
4 
5 
6 
2 
2
After k = 6
0 
1 
2 
2 1
1 0 1 
3 
2
-
2 
1 0 
3 
3
2 
3 
3 
0 1
1 2 
3 1 
0
3 
4 
5 
2 
2
Figure 10.21 
An application of the Floyd-Warshall algorithm.
The symbol [BB] means that an answer can be found in the Back of the Book.
1. The Traveling Salesman's Problem is that of finding
the Hamiltonian cycle of least weight in a Hamilto-
nian graph. Is this what a traveling salesman necessarily
wants to do? Discuss.
2. (a) [BB] Apply the original version of Dijkstra's algo-
rithm to find the length of the shortest path from A
to every other vertex in the figure. Show the final 
3. [BB; A
labels on all vertices. Also, find the shortest path 
algorithm
from A to E. 
from H
(b) Apply the original version of Dijkstra's algorithm 
In each c
to find the length of the shortest path from H to 
might b
every other vertex in the graph. Show the final 
4. Use the
labels on all vertices. Find the shortest path from 
shortest
H to D. 
shown.
A 
E
H 9 
G 
| 
F
only] Apply the improved version of Dijkstra's
n to find the length of a shortest path from A and
to every other vertex in the graph of Exercise 2.
case, exhibit an order in which permanent labels
assigned.
first form of Dijkstra's algorithm to find the
path from A to R (and its length) in the graph
Show the final labels on all vertices.
V2 
I 
V3
VI
V4
VI
V2
V3
V4
V5
V6
0
1
3
00
4
4
5
6
2
2
0
3
4
5
2
2
0
rv rim 3 - -

332 
Chapter 10 
Paths and Circuits
A
E
5. [BB] Use the improved version of Dijkstra's algorithm
to find the length of a shortest path from A to R in
the graph of Exercise 4. Also, exhibit an order in which
permanent labels might be assigned.
6. Use the original form of Dijkstra's algorithm to find the
shortest path from A to T in the graph shown. Label all
vertices.
c 
4 
]
A 
I 
T
E 
2
F 
7 
M
7. [BB] Use the improved version of Dijkstra's algorithm
to find the shortest path from A to E (and its length).
Label all vertices.
A
E
8. Use the improved version of Dijkstra's algorithm to find
the shortest path from A to E in the graph shown. Show
the final labels on all vertices.
A I 
X3 
X I 
I 
3 
H 
O
3 
3 
5 
1 
2
9. [BB] Could Dijkstra's algorithm (original version),
employed to determine a shortest path from A to E in
a weighted graph, terminate before E is labeled? Could
the improved algorithm terminate before E acquires a
permanent label? Explain.
10. (a) If weights were assigned to the edges of the graph
shown in Exercise I of Section 10.2, the Travel-
ing Salesman's Problem would not have a solution.
Why not?
(b) Despite this observation, our salesman still has to
complete the trip. Assigning weights as shown in
the figure, and assuming the salesman starts at A
and does not wish to travel along the same edge
more than once, find a most efficient route for the
trip.
E 
G
2 
2
F 
IH
4 
D 
4
B 
2 
C
(c) Suppose the salesman is willing to cover the same
edge more than once. Is the route found in (b) still
the most efficient?
(d) Use the original form of Dijkstra's algorithm to find
the shortest paths from E to each of the other ver-
tices in the above graph. Label all vertices.
11. (a) [BB] How could any of the algorithms presented
in this section be used to find the path requiring
the fewest number of edges between two specified
vertices in an unweighted graph?
(b) Use one of Dijkstra's algorithms to find the shortest
path from A to B in the graph.

Review Exercises 333
A
12. [BB] Suppose the improved version of Dijskstra's algo-
rithm is used to find the shortest distances between all
pairs of vertices in a graph on n vertices by being per-
mitted to run until all vertices acquire their final labels.
Why is this procedure 0(n 3 ) (in terms of comparisons)?
13. Suppose the Floyd-Warshall algorithm is applied to the
graph in Fig 10.18 (with vertices A,... , J relabeled
VI, . .. , vI(, respectively).
(a) What are the final values of d(l, l),d(l,2),.
d(l, 10)?
(b) [BB] Find the values of d( l, 5), d(l, 6), d(3, 4), and
d(8, 5) after k = 4.
(c) What is the initial value of d(2, 5)? How does this
value change as k increases from I to 10?
14. The Floyd-Warshall algorithm is applied to the graph
shown.
V2 
2 
V3
VI 
V4
24
V6 
V5
(a) Find the final values of d(7, 1), d(7, 2),.
d (7, 8).
(b) Find the values of d(l, 2), d(3, 4), d(2, 5), and
d(8, 6) after k = 4.
(c) Find the values of d(6, 8) at the start and as k varies
from I to 8.
15. Inadvertently, David reverses the order of the k and the
i, j loops in Step 2 of the Floyd-Warshall algorithm,
implementing Step 2 in the form
Fori,j= I ton,
for k = I to n, let d(i, j) = minid(i, j), d(i, k)+
d(k, j)1
Does this affect the algorithm? Explain.
16. [BB] Suppose the values of the d(i, j) for two consec-
utive values of k are the same in an implementation of
the Floyd-Warshall algorithm. Is it necessary to con-
tinue, that is, can it be assumed that the values will now
remain constant?
17. Prove that the Floyd-Warshall algorithm works. Specif-
ically, assume that g is a weighted graph with vertices
VI, V2 . . ., vn and assume that there is a path from vi
to v1. Prove that when the algorithm terminates, d(i, j)
is the length of a shortest path from vi to vj.
18. Show that the Floyd-Warshall algorithm requires 0(n 3)
additions and comparisons.
/ 19. Discover what you can about Edsger Dijkstra and write
a short note about him.
46 20. Discover what you can about R. W. Floyd and write a
short note about him.
i.13: .79! 
d 
9M. 
1X
1. In the Kiinigsberg Bridge Problem (see Fig 9.1), two
new bridges are constructed, one joining A to C and
the other B to D. Use Theorem 10.1.4 to show that the
answer to the question is now yes.
2. One of the mayoralty candidates in Kbnigsberg says that
he can obtain a positive solution to the bridge prob-
lem by building only one new bridge. Is he telling the
truth?
3. Suppose Q1 and Q2 are graphs with no vertices in com-
mon and assume that each graph possesses an Eulerian
trail. Show that it is possible to select vertices v and
It of g1 and g2, respectively, such that if v and It are
joined by a new edge, the resulting graph will possess
an Eulerian trail.
4. True or false? Explain your answers in each case.
(a) Every trail is a path.
(b) Every open trail is a path.
(c) If there is an open trail from vertex v to vertex w,
then there is a path from v to w.
(d) Every path is an open trail.

334 
Chapter 10 Paths and Circuits
(e) If there is a path from vertex v to vertex w, then
there is an open trail from v to w.
5. Let G7 be a connected graph with at least two vertices.
Assume that every edge of 5 belongs to a unique cycle.
Prove that g is Eulerian.
6. Is the graph Hanmiltonian? Is it Eulerian? Explain your
answers.
C
E
7. (a) How many edges must a Hamiltonian cycle in K,,,
contain?
(b) How many Hamiltonian cycles does K,,,,, have?
Assume n > 2.
(c) What is the maximum number of edge disjoint
Hamiltonian cycles in KC,,,?
(d) When n = 4, show that the maximum number of
edge disjoint Hamiltonian cycles predicted in 7(c)
is realized.
8. True or false? Explain your answers in each case.
(a) In a Hamiltonian graph, every edge belongs to some
Hamiltonian cycle.
(b) In a Hamiltonian graph, every edge belongs to a
cycle.
(c) Every Eulerian graph contains a subgraph which is
Hamiltonian.
(d) Every Hamiltonian graph contains a subgraph which
is Eulerian.
9. A connected graph g has 14 vertices and 88 edges. Show
that 5 is Hamiltonian but not Eulerian.
10. The following questions refer to the graph 5 drawn on
the left.
(b) Without any calculation, determine the (1, 5) entries
of A2 , Al, A4, and A5.
(c) Find an isomorphism (s: 5 -
N, where H is the
graph on the right.
(d) If B is the adjacency matrix of A, find a permuta-
tion matrix P such that PAPT = B. Check your
answer by writing down B and computing the prod-
uct PAPT.
11. Let VI, V2, . -
.
vs and WI, W2. 
WI2 be the biparti-
tion sets of the complete bipartite graph K8. 12. Let A be
the adjacency matrix of this graph, where the vertices
are listed in the order V, ...
V8, wI 
!, 
W2.
(a) What is the (1, 5) entry of A?
(b) What is the (8, 9) entry of A?
(c) What is the (10, 12) entry of A2?
(d) What is the (5, 5) entry of A2?
(e) What is the (20, 6) entry of A2?
(f) What is the (5, 7) entry of A 4?
(g) What is the (5, 7) entry of A' 5?
12. Suppose 5 is a connected graph. Is it possible to deter-
mine from the adjacency matrix of 5 whether or not 5
is Eulerian? Explain.
13. Martha claims that a graph with adjacency matrix
- 01
1 0
l l
A= 
I 0
0 
1
I 
0
- I
0
0
U1o
1o
0
0
0
1
0
0
U0o
1o
0
0
0
I-
0
must be Hamiltonian. How can she be so sure?
14. If A is the adjacency matrix of a graph 5 and A2 = [bi],
find 
i 
>3 bi.
15. Apply the first form of Dijkstra's algorithm to the fol-
lowing graph, showing the shortest distances from A to
every other vertex. Exhibit an order in which a shortest
path from A to E might be realized.
V I 
V2 
V3
V4 
V5 
V6
5
(a) Find the adjacency matrix A of 5.
B
WI 
W2 
W3
W4 
W5 
W6
C
A
(3
11

Review Exercises 
335
16. Apply the improved version of Dijkstra's algorithm to
the graph of Exercise 15 to find the length of a shortest
path from A to every other vertex.
17. Apply the original form of Dijkstra's algorithm to find
the length of the shortest path from A to every other
vertex. Show the final labels on all vertices. Also find
the shortest path from A to H.
B 
8 
D 
2 
C
5 
4 
62 
3
A 
E 
3
2 
7 
32 
5
C 
5 
F 
4 
I
18. Apply the improved version of Dijkstra's algorithm to
answer Exercise 17.
19. Apply the Floyd-Warshall algorithm, showing the initial
values of d(i, j) and the values of d(i, j) at the end of
every step.
VI
V4
20. Apply the Floyd-Warshall algorithm to the graph in
Exercise 17. Show the initial values of the d(i, j), i, j =
1, 2, ... , 9; the values after k = 1, k = 3, and k = 5;
and the final values. Explain how the algorithm can be
used to find the shortest path from A to H.
21. An encyclopedia salesman, traveling by car, wishes to
visit ten towns and return home without passing through
the same town twice. He knows that one, but only one,
of the towns has a direct connection to each of the
other towns (that is, connections passing through no
other towns). He also knows that there are a total of
39 such direct road connections between pairs of towns.
Why is he confident that he will be able to find such a
route?
U6
US

* 
A 
locations of Paths
S ii--.S.{ 
.. A 
and Circuits
11.1 
THE CHINESE POSTMAN PROBLEM
In this chapter, we present various applications of the ideas developed in
Chapter 10. We use what we know about Eulerian graphs to solve the so-called
Chinese Postman Problem and to reconstruct RNA chains. The latter subject
requires the concept of a digraph, a graph in which the edges have directions.
We show how Hamiltonian paths can be used in the study of tournaments and,
finally, we will see how shortest path algorithms can be applied to scheduling
problems.
A mail carrier who begins his route at the post office must deliver letters to
each block in a certain part of town and then return to the post office. What is
the least amount of walking the mail carrier must do? This problem, a version of
which was first solved by H. E. Dudeney in 1917,1 is today known as the Chinese
Postman Problem because it was studied in most general form by the Chinese
mathematician, Mei-ko Kwan (also known as Meigo Guan).2 It is clear that the
same problem is faced by delivery people of various kinds, by paper boys, by
street repair crews, by snow plow operators, and so on.
We represent the mail carrier's problem by a weighted graph g with each
vertex denoting a street corner and each edge a street of length the weight of that
edge. If we assume that the post office is on a corner, then any route the postman
follows corresponds to a closed walk in the graph which uses each edge at least
once. If the graph g has an Eulerian circuit, then we have an optimal solution
since every block will be walked exactly once. If not, then the postman will have
to walk certain blocks more than once, but his aim is to plan these extra trips so
that the total distance walked is as small as possible.
'See Angela Newing, "The Life and Work of H. E. Dudeney," Mathematical Spectrum 21 (1988/89),
37-44.
2M. K. Kwan, "Graphic Programming Using Odd or Even Points," Chinese Math 1 (1962), 273-277.
337

338 
Chapter 11 
Applications of Paths and Circuits
finffi=
WiNJIN
A
Figure 11.1
EXAMPLE 1
A
F
P 
B 
G
5'
P 
B
g
Since the postman's route covers all streets, it doesn't matter where the post
office is, so assume it is at vertex P. Since 5 has vertices of odd degree (namely,
A and B), g is not Eulerian, so the postman cannot service this area by walking
each block exactly once. Our problem is to determine the least number of edges
which should be duplicated in order to obtain an Eulerian pseudograph. Since all
vertices of an Eulerian pseudograph must have even degree, we will have to add
an extra copy (or extra copies) of certain of the edges incident with A and with B.
If A and B were joined by an edge, then a single extra copy of that edge would
certainly suffice. Since, however, A and B are not joined by an edge, we need
at least two additional edges. The pseudograph g' shown on the right in Fig 11.1
(extra edges shown as dashed lines) is Eulerian and a solution to the Chinese
Postman Problem. One Eulerian circuit is PACDEAEBGFEBP.
Unlike many graph theoretical problems, the Chinese Postman Problem has
been solved: Procedures have been found for determining which edges of a graph
must be duplicated in order to obtain the Eulerian pseudograph of least weight.3
We illustrate with reference to the graph 5 in Fig 11.2, where we again assume
that all streets have the same length. There are four odd vertices in g, labeled
A, B, C, D in the figure. Consider all the partitions of these vertices into pairs and,
for each partition, calculate the sum of the lengths of shortest paths between pairs.
As the calculations in Table 11.1 show, the minimum sum of lengths is 5, and this
is achieved with two partitions either of which yields a solution to the problem. If
we choose, for instance, (A, B}, IC, DI, then a pseudograph of minimum weight
is obtained by duplicating the edges along the shortest path from A to B and
3See J. Edmonds, "The Chinese Postman Problem." Operations Research 13 Suppl. X (1965), 353:
J. Edmonds and E. L. Johnson. Matching, Euler Tours and the Chinese Postman. Mathematical Progrorn-
ruing 5 (1973), 88-124; E. L. Lawler, Combmnatorial Optimization Networks and Matroids, Holt, Rinehart
and Winston, New York, 1975; and E. Minieka, Optinization Algorithomsfor Networks and Graphs, Marcel
Dekker, New York. 1978.
Given a connected possibly weighted graph, find the shortest closed walk that
covers every edge at least once.
The first step in the solution to this problem is the realization that the post-
man's walk will follow an Eulerian circuit in a pseudograph obtained from the
given graph by the duplication of certain edges.
Suppose that the graph g shown in Fig 11.1 represents the streets which a
postman must cover and suppose that all streets have the same length.
C 
D

11.1 The Chinese Postman Problem 
339
A
B
G
A
B 
D
C
C
Table 11.1
Partition into pairs 
Sum of lengths of shortest paths
{A,B),{C, D} 
2 + 3 = 5
{A,C},{B, D} 
4+2=6
{A, D},{B,C} 
2 + 3 = 5
along the shortest path from C to D, as shown on the right of Fig 11.2. As
before, many people could have obtained our solution by inspection. Computers
cannot see, however. Our intent has been to illustrate a concrete procedure which
works in all cases and does not depend on a picture. 
A
To find an Eulerian pseudograph of minimum weight by duplicating edges of a
weighted connected graph 5,
Step 1. Find all the odd vertices in G.
Step 2. For each partition of the odd vertices into pairs of vertices,
(VI, 
WLI 1, {V2, W2), ...
, {Vin, Wt.,},
find the length of a shortest path between each vi and wi and add these
lengths.
Step 3. Take the partition for which the sum of lengths in Step 2 is minimum
and, for each pair {vi, wi) of vertices in this partition, duplicate the edges along
a shortest path from vi to wi.
The second step of this algorithm assumes that the odd vertices of a graph can
always be partitioned into pairs. Why should this be the case?
In the implementation of the algorithm, will it ever be necessary to duplicate
an edge more than once? In other words, if an edge e has been duplicated for
inclusion in the shortest path from vi to wi, will it perhaps be necessary later to
duplicate it for inclusion in the shortest path from vj to wj?
In the Exercises, we ask you to show that the pseudograph produced by
this algorithm is Eulerian and, furthermore, that given any Eulerian pseudograph
obtained from 5 by duplicating certain edges, the odd vertices can be paired such
Figure 11.2

340 
Chapter 11 
Applications of Paths and Circuits
that there are edge disjoint paths of new edges between them. From this, it follows
that our algorithm indeed produces an Eulerian pseudograph of minimum weight.
Suppose we attach some weights to the edges of the graph we considered
before, as shown in Fig 11.3. There are still four odd vertices and three partitions
of these into pairs, but the lengths of shortest paths between pairs of odd vertices
have changed.
A
B
2
g
Figure 11.3
C
D
A
9
C
n 
-
* ** 
-
As the calculations in Table 11.2 show, the minimum sum of lengths is now 9,
corresponding to the partition {A, D}, {B, C). Duplicating the edges on a shortest
path from A to D and from B to C, as shown on the right of Fig 11.3, we
obtain an Eulerian pseudograph of minimum weight and a solution to the Chinese
Postman Problem for the graph g.
Table 11.2
Partition into pairs 
Sum of lengths of shortest paths
{A, B}, {C, D} 
5+5 = 10
{A, C}, {B, D} 
6+4= 10
{A, D}, {B, C) 
5 + 4 = 9
1. The number of odd vertices in a graph is even (Corollary 9.2.7).
2. No, it won't. To see why not, think about how the partition
P 
= { ({V, WI}, {V2, W2}, .
V 
, {m, 
Wm} }
was determined. Denoting by fi the length of the shortest path between vi
and wi, the sum, L = Ei ei, is least among all similar sums arising from all
partitions of the odd vertices into pairs.
It an edge e is duplicated because it is part ot the
shortest path between vi and wi, and it is later
required again because it is part of the shortest
path between vj and wj, then the partition
obtained from P by replacing the pairs
Ia 
s 
Ie 
Il -. 
I o 
e 
s 
r ~ Ir In 
.1 [eu 
I
tVi, Wi , 1Vj, Wj 
Dy tne pairs jVi, V jJ, tWi, WjI
L
l

11.1 The Chinese Postman Problem 
341
has sum of shortest path lengths less than or equal to L -2w(e), contradicting
the minimality of L.
The symbol [BB] means that an answer can be fund in the Back of the Book.
1. Solve the Chinese Postman Problem for each of the
graphs shown.
5. Solve the Chinese Postman Problem for each graoh.
(a) [BB] 1 
-
(b)
(c)+
-
-
4 
1 
6
2
(d)
(e)
6. [BB] Suppose X and Y are any two vertices of a
weighted connected graph G. Explain why the shortest
mail carrier's route from X to X has the same length as
the shortest route from Y to Y.
7. Solve the Chinese Postman Problem for the unweighted
graph shown.
(D)
2. [BB; K5] Solve the Chinese Postman Problem for 
s5,
/C6, and lC3,
3. [BB] Solve the Chinese Postman Problem.
2
14
8. Solve the Chinese Postman Problem for the weighted
graph.
4. [BB] Solve the Chinese Postman
graph.
Problem for each
5 
3>2
I 
I
I 
I
132
4 
6
2 
5
The remaining exercises concern the algorithm presented
in this section for obtaining an Eulerian pseudograph of
minimum weight from a given non-Eulerian connected
graph g by duplicating certain edges.

342 
Chapter 11 
Applications of Paths and Circuits
9. EBB] Prove that the pseudograph g' which the algorithm
finds is Eulerian.
10. Suppose g has n odd vertices. In how many ways can
these be partitioned into n pairs?
11. Suppose that 5" is any Eulerian pseudograph obtained
from 5 by duplicating certain edges.
(a) Prove that each odd vertex of g is the initial vertex
of a path consisting entirely of new edges (in 5")
and leading to another odd vertex.
I 
S
(b) Improve 
the result of (a) by showing 
that
the odd vertices of g can, in fact, be parti-
tioned into two equal sets- {vI, v2 .
V 
. , vml and
{WI, W2, . . ., W. -with 
edge disjoint paths con-
sisting entirely of new edges between each vi
and wi.
(c) Conclude that of all the pseudographs obtain-
able from g by duplicating edges, the algorithm
yields an Eulerian 
pseudograph of minimum
weight.
Often, when graphs are used to model real-life situations, the edges represent lines
of communication such as roads or pipes. In such situations, it is not unusual for
the flow through an edge to have an associated direction.
A digraph is a pair (V, E) of sets, V nonempty and each element of & an ordered
pair of distinct elements of V. The elements of V are called vertices and the
elements of Â£ are called arcs.
Loosely speaking, a digraph is just a graph in which each edge has an orien-
tation or direction assigned to it. (We use the words "orientation" and "direction"
synonymously.) It can be pictured like a graph, with the orientation of an arc
indicated by an arrow: We draw an arrow u 
> v if (u, v) E E. Some digraphs
are pictured in Fig 11.4.
U 
V
W
Figure 11.4 
g1
U 
V
W
U 
V
w 
X
93
V 
F
W 
X
!4
As with most aspects of graph theory, there is a rather extensive terminology
used for digraphs and, as we have noted before, different textbooks employ the
same words with slight variations in meaning. The policy in this text is to use
the same terms for graphs and digraphs whenever possible, with one exception:
In a digraph, we use the term "arc" instead of "edge." An edge is just a set, an
unordered pair of vertices {u, v}; an arc is an ordered pair (u, v) or (v, u) (as
ordered pairs, these are different). Just as it has been our custom when naming
edges of a graph not to use set notation, we omit parentheses when naming arcs
of a digraph, thus referring to "the arc uv" rather than "the arc (a, v)."
As with the term "graph", our definition of "digraph" precludes the existence
of loops and multiple arcs. Note the subtle distinction between multiple edges and
multiple arcs, however. Since the arcs uv and vu are different, they may both
appear in a digraph. All the pictures in Fig 11.4 represent digraphs, in particular
11.2 
DIGRAPHS

11.2 Digraphs 
343
g4, which, without the arrows, would not be a graph. There are multiple edges
but not multiple arcs between u and v.
In the same way that the vertices of a graph have degrees, a vertex of a
digraph has an indegree and an outdegree, these being, respectively, the number
of arcs directed into and away from that vertex. Considering the graph 53 in
Fig 11.4, vertices u and x have indegree 2 and outdegree 1, vertex v has indegree
0 and outdegree 2, and vertex u has indegree I and outdegree 1. The indegree
sequence of g3 is 2, 2, 1, 0 and the outdegree sequence of 53 is 2, 1, 1, 1. The
following result can be proved with a routine modification of the argument used
to prove Proposition 9.2.5.
(cf. Proposition 9.2.5) The sum of the indegrees of the vertices of a digraph equals
the sum of the outdegrees of the vertices, this common number being the number
of arcs.
As might be expected, when considering the possible isomorphism of
digraphs, the direction of arcs must be taken into account. In Fig 11.4, g1 and g2
are not isomorphic because every vertex in gl has outdegree I whereas in 52,
outdeg u = 2. The indegree sequences of isomorphic digraphs must be equal as
must be their outdegree sequences. With this small change in property 2, Propo-
sition 9.3.2 is equally valid for digraphs.
By convention, any walk in a digraph respects orientation of arcs; that is, each
arc is followed in the direction of its arrow. For example, digraph g1 in Fig 11.4
is Eulerian because uvwu is an Eulerian circuit. This is also a Hamiltonian cycle.
Digraph C2 has neither an Eulerian circuit nor a Hamiltonian cycle (the arc is uw,
not wu), although it does have a Hamiltonian path uvw.
Explain why neither digraph g3 nor 4, of Fig 11.4, is Hamiltonian.
In Theorem 10.1.4, we established necessary and sufficient conditions for a
graph to be Eulerian. This theorem can be adapted to the situation of digraphs
with a suitable strengthening of the concept of connectedness.
A digraph is called strongly connected if and only if there is a walk from any
vertex to any other vertex which respects the orientation of each arc.
Imagine a city where every street is one-way. The digraph of streets and
intersections of this city is connected if it is possible to drive from any intersection
to any other intersection, perhaps by moving the wrong way down a one-way
street, and strongly connected if such travel is always possible without breaking
the law!
The proof of the following theorem is left to the Exercises.
(cf. Theorem 10.1.4) A digraph is Eulerian if and only if it is strongly connected
and, for every vertex, the indegree equals the outdegree.
Is digraph g3 in Fig 11.4 Eulerian? What about the digraph in Fig 11.5?
The adjacency matrix A of a digraph 9 with vertices V], 
V2, . .. , v, is defined
by setting aii = 1 if there is an arc from vertex vi to vertex vj and 0 otherwise.
Mzzmz
MMU
DMIMMMEN

344 
Chapter 11 
Applications of Paths and Circuits
V
Figure 11.5 
A digraph associated with kC3.
Unlike the adjacency matrix of a graph (see Section 10.3), the adjacency matrix of a
digraph is generally not symmetric, since an arc from vi to vj does not imply an arc
from vj to vi. Most assertions made in Section 10.3 apply, with appropriate changes.
For example, the (i, j) entry of A2 is the number of different walks of length 2 from
vi to vj (respecting the orientation of arcs). This number need not be the same as the
number of walks of length 2 from vj to vi, obviously. The ith entry of the diagonal
of A2, being the number of walks of length 2 from vi to vi, is the number of vertices
vj such that there exists a circuit of the form vivjv. (See Fig 11.6.)
Vj<>Vj
Figure 11.6
Theorems 10.3.3 and 10.3.4 hold for digraphs. Digraphs are isomorphic if and
only if their vertices can be labeled in such a way that their adjacency matrices are
equal. Labeled digraphs 51 and 52 with adjacency matrices A I and A2, respectively,
are isomorphic if and only if A2 = PA I pT for some permutation matrix P.
i ,.
01 
,J2
Figure 11.7 
Two isomorphic digraphs.
EXAMPLE 2 
Consider the digraphs of Fig 11.7. The adjacency matrices of g5 and Q2 are
-
1 
0 
1 
0 
0 
1 
0
Al = 
0 10 
and 
A2 = 
0 
0 
0
-0 
0 
1 
0 
-1 
0 
1 
0-
The map So: g1 -* g2 defined by
O~V) = U4, 
S(Pv2) = uI, 
(P (v3) 
U 2, 
(P(V4) 
U3
is an isomorphism, and the permutation matrix
01 
0 
0
P- 
00 
10
00 
0 
1
10, 
0 
I
determined by (p (as in Section 10.3) has the property that PAI PT = A2.
I
11,
.

11.2 Digraphs 345
The shortest path algorithms described in Section 10.4 can be applied to
digraphs, with obvious modifications which take into account the orientation of
arcs. Examples appear in our discussion of scheduling problems in Section 11.5.
Here is another algorithm, due to Richard Bellman (1920-1984) and Lester R.
Ford Jr. (1927-) which, for a directed graph with vertices VI, v2, . . ., v,, computes
successively the length di(j) of a shortest path from vI to vj using at most i arcs.
Since no path in such a digraph can have more than n -1 arcs, the final values of
dn i (j), j = 2, . .. , n are the lengths of shortest paths from v I to all other vertices.
Given a weighted digraph with vertices labeled 
vI, V2 .. , v,, to find the shortest
distances from vl to all other vertices, proceed as follows.
Step 1. for i, j = 1, 2, ... , n,
. if i = j, set w(i, i) = 0; if i :A j and vi v is an arc, set w(i, j) to
the weight of vivj; otherwise, set w(i, j) = oc.
. set do(1) = 0 and, for j = 2, 3, . . ., n, set do(j) = oo.
. for i = 2 to n, set p(i) = 1.
Step 2. for i = 1 to n
for j = 1 to n
. find the k for which min = di i(k) + w(vk, Vj) is least;
.if min < di l(j), set di(j) = min and p(j) = Vk
else set di (j) = di-I (j).
Step 3. 
if dn (j) = dn -I (j) for j = 1, 2, . . ., n,
for j = I to n output dn(j);
else output "No shortest paths. There is a negative weight cycle."
If there are no negative weight cycles, the value of dn (j) = di- (j) which is
output in Step 3 is the length of a shortest path from Vl to vj, this path consisting
of vertices p(2), p(3), . . ., p(j).
V2
5
VI,
V5
V4
We apply this algorithm to the graph shown in Fig 11.8. After initialization
in Step 1, the process begins with Step 2. Setting i = 1, the algorithm computes
the weight of a shortest one arc path to vertices v2, V3, V4, V5. The shortest path to
v2 has weight 1, and the last vertex on this path is vi. The shortest path to Vs has
weight 4, and the last vertex on this path is vl. Shortest paths to V3 and V4, using
at most one arc, have infinite length. The first column of the table in Table 11.3
records this data.
Now i = 2 and the algorithm computes the length of a shortest path to
V2, V3, V4, vs using at most two arcs. For each j = 2, 3, 4, 5, the algorithm first
Figure 11.8
*MWIF,
Will

346 
Chapter 11 
Applications of Paths and Circuits
Table 11.3 
Results of applying the Bellman-Ford
algorithm to the digraph shown in Fig 11.8. The (i, j)
entry is x0 or, when di(j) is finite, the pair di(j), p(j).
Max. no. of arcs
1 
2 
3 
4 
5
V2 
l,vI 
1,vI 
1,VI 
lvI 
lvI
Vertices 
V3 
oc 
2, V2 
2, v2 
2, V2 
2, V2
V4 
00 
5, V5 
5, V5 
4, V5 
4, V5
V5 
4 ,vi 
4 ,vI 
3,V3 
3,V3 
3,v3
computes the minimum d,(k) + w(vk, Vi); that is, the length of a shortest path
to Vk using one arc plus the weight of arc Vkvj. This number (min) is compared
with d, (k), the length of the shortest one arc path to Vk. The smaller of these two
numbers becomes d2(j). If the shortest path had length min. the algorithm also
sets the predecessor vertex p(2) = 
Vk, thus remembering that Vk is the vertex
preceding vj on a shortest at most two arc path to vj. The shortest at most two
arc path to V2 is still a one arc path, and the same is true for V5. The shortest at
most two arc path to V3 has length 2, and the last vertex on such a path is v2.
The shortest at most two arc path to V4 has length 5, and the last vertex on such
a path is V5. We leave it to you to check the remaining columns of the table.
In this example, all vertices eventually have finite labels. Will this always be the
case?
, 3)
5
Figure 11.9
Vj(VI, 4) 
-I 
V4(V5, 3)
An application of Dijkstra's algorithm (first form) to a weighted digraph with some negative
weights. The final labeling at 03 is wrong.
In contrast to the algorithms of Dijkstra, the Bellman-Ford algorithm works
perfectly well on weighted digraphs where some arcs have negative weight. In
Fig 11.9, we show the result of applying the original form of Dijkstra's algorithm
to the digraph of Fig 11.8, with different (and some negative) arc weights. Since
neither version of Dijkstra's algorithm examines a vertex again after it has acquired
its permanent label, vertex v3 is incorrectly determined to be at distance 3 from vI.
The correct length of a shortest path from vl to V3 is, of course, 2, along VI V5V4V3,
and this is found by the Bellman-Ford algorithm, as shown in Table 11.4.
Any path in a digraph with n vertices cannot contain more than n -I 
arcs.
So in Step 2 of the Bellman-Ford algorithm, why does the outer for loop run
M

11.2 Digraphs 347
Table 11.4 
Results of applying the Bellman-Ford
algorithm to the digraph shown in Fig 11.9.
Max. no. of arcs
1 
2 
3 
4 
5
V2 
1,vI 
1,vI 
1,vI 
1,vI 
1,VI
Vertices 
V3 
co 
3, V2 
2, V4 
2, V4 
2, )4
V4 
00 
3, V5 
3, V5 
3, V5 
3, V5
V5 
4,vI 
4,vI 
4,vI 
4,vI 
4,vI
A 
* 
* ** 
-
from i = 1 to n and not to i = n -
? (Remember that i is the number
of arcs in a path.) The answer is in order to detect negative weight cycles
(which can be reached from VI). This is also the reason for the inclusion of
Step 3. If a weighted digraph has a cycle of negative total weight, there is
no shortest path to any vertex on this cycle which is reachable from vI, since
by going around the cycle, lengths can be decreased as much as desired. Sup-
pose the value of dn(j) is different (and hence less) than the value of d,-I(j)
for some vertex vj. Thus there is a walk of n edges from VI to V, of total
weight less than any walk which uses fewer than n edges. Such a walk must
contain a repeated vertex, and hence a cycle C: u u2 
u l, so the walk is
W: vI ... C 
vn. Notice that the cycle must have negative total weight since
otherwise vi 
u 
... V, (omitting C) would have weight less than or equal to
W. It can be shown that any negative weight cycle will be detected by Bellman-
Ford since in this case, for some vertex v., the value of dc(j) must be less than
d,_I(j). [See Exercise 23(b).]
In Fig 11.9, change the weight of V3V 5 from 4 to 1. Make a table like that in
Table 11.3. Examine the values of d4 (j) and d5 (j) and comment.
Weighted digraphs are helpful in settings where graphs are not appropriate;
specifically, in any situation where travel between two vertices can proceed in
only one direction. We provide examples in the next three sections.
3. In g3, vertex v has indegree 0. Since there is no way of reaching v on a walk
respecting orientation of edges, no Hamiltonian cycle can exist. In g4, vertex
x has outdegree 0 so no walk respecting orientations can leave x.
4. The digraph g3 is not Eulerian. It is not strongly connected (there is no way
to reach v). Also, the indegrees and outdegrees of three vertices (u, v, and x)
are not the same. The digraph in Fig 11.5 is Eulerian, however. It is strongly
connected (there is a circuit uvwu which permits travel in the direction of
arrows between any two vertices), and the indegree and outdegree of every
vertex is 2. (An Eulerian circuit is uwvuvwu.)
5. If there is no directed path from vI to some vertex vi, the label for vi will
always be oo.

348 
Chapter 11 
Applications of Paths and Circuits
Max. no. of arcs
2 
3 
4
5 
Since d4(v4) = 3 and
vl 
a( V4) = i, me
V4 
algorithm has detected
! V5 
the negative cycle
1 
V3V5V4V3.
The symbol [BB] means that an answer can be found in the Back of the Book.
1. Which of the following pairs of digraphs are isomor-
phic? Explain your answers.
(a) [BB]
(b)
(d)
2. Must the indegree and the outdegree sequences of a
digraph be the same? Explain.
3. [BB] Prove Proposition 11.2.2.
4. Exhibit a digraph which is strongly connected but not
Eulerian.
5. [BB] Let g be a connected graph with all vertices of
even degree. Can the edges of 5 be oriented so that the
resulting digraph is Eulerian? Explain.
6. Let A be the adjacency matrix of a digraph 5. What
does the sum of the entries in row i of A represent?
What about the sum of the entries in column i?
7. [BB] Let A be the adjacency matrix of the digraph pic-
tured at the left.
(a) Find A.
(b) Determine the (3, 3) and (1, 4) entries of A2 with-
out calculating the matrix A2 and explain your rea-
soning.
(c) Determine the (4, 2) entry of A3 and the (I, 3) entry
of A4 without calculating A3 or A4 and explain your
reasoning.
(d) Is the digraph strongly connected? Explain.
(e) Is the digraph Eulerian? Explain.
8. Repeat Exercise 7 for the digraph at the right in that
Exercise.
9. Let A be the adjacency matrix of a digraph 5. Explain
why AT is also the adjacency matrix of a digraph gT
Is it possible for 5 and gT to be isomorphic? Explain.
10. [BB; (a)] Label the vertices of each pair of digraphs in
Exercise I and then give the adjacency matrices corre-
sponding to your labeling. (For any pair of graphs which
are isomorphic, label in such a way that the two graphs
have the same adjacency matrix.)
11. [BB] Consider the digraphs g1 , g2 shown.
(a) Find the adjacency matrix Al of Q1 and the adja-
cency matrix A2 of G2 .
(b) Explain why the map qp: 51 -- >2 
defined by
qOvI) = U2, k(v2) = uI, q9(u3) = U4, ((V4) = U3
is an isomorphism.
(c) Find the permutation matrix P which corresponds
to S9 and satisfies PAI p T = A2.
(d) Are these digraphs strongly connected?
6.
V2
Vertices 
V3
V4
V5
1, VI
00
DC
4, vI
1, VI
3, V2
3, Vs
4, Vl
1, VI
2, V4
3, Vs
4, Vl
1, VI
2, V4
3, Vs
3, V3
2
2
3
I1
.
, 
\ 
.
.
FrIff-Mm-
I -

11.2 Digraphs 
349
(e) Are these digraphs Eulerian?
V1
u 
0 
I 
3 
U4
12. Repeat Exercise I I for the digraphs shown and the map
9: 51 -5 g2 defined by
f (o1)) = u3, f0(o2) = U4, OV3) = U2, V(V4)
V(V5) = U I .
V1
V2t4 
V5
V3 
V4
g1
u5,
U2 
U5
03 
04
13. In each of the following cases, find a permutation matrix
P such that A2 = PAIPT.
16. [BB] If a graph g is connected and some orientation
is put on the edges of 5, must the resulting digraph be
strongly connected? Explain.
17. Prove Theorem 11.2.4.
18. [BB] Answer true or false and explain: If a digraph 5
with at least two vertices is strongly connected, then
every vertex of 5 is part of a circuit (consisting of more
than a single vertex).
19. Apply the Bellman-Ford algorithm to the digraphs
shown, answering by means of a table like Table 11.3.
(a) [BB] 
02 
l 
V3
VI
(b)
V3
V4
(a) AI = 
Â°
(b) AI = 0
- A,
0
(c) AIl = 
0
0
-
0o
0
0
0
0
0
0
0o
1o
0
0
0
0
0
0
0
0
0
0
0
0
0
I
01
0 j
0 
,
0o
L 
001 1]
A 2 = 
0 0 1 0
0 
100 
j
0
0
0
0
0
0
I-01
1 ,
I
0 -
0
0
0
A2 = 
0
- 0o
0
A2= 
I
I
- 0o
0
0
0
0
0
0
0
0
I]
01
01
I 0
0 j
1 0 O
V5
20. [BB] Would it be sensible to use the Bellman-Ford
algorithm on undirected graphs? Comment.
21. (a) [BB] Apply the original form of Dijkstra's algo-
rithm. Does it give correct lengths of shortest paths?
Explain.
(b) [BB] Would Bellman-Ford work? Explain.
2
VI
V3
14. [BB; (a)] Which of the digraphs in Exercise I are
strongly connected? Explain your answers.
15. An orientation of a graph can be achieved by replacing
each edge {x, y), an unordered pair of vertices, by one
of the ordered pairs (x, y) or (y, x); that is, you put an
arrow on each edge of the graph.
(a) [BB] Find all nonisomorphic orientations of Ks.
(b) Find all nonisomorphic orientations of K4.
(c) Find all nonisomorphic orientations of C2,3.
V4
22. When the Bellman-Ford algorithm detects the presence
of a negative weight cycle, can it be adapted to exhibit
such a cycle? Explain.
23. (a) [BB] The Bellman-Ford algorithm can be terminated
as soon as two successive columns are the same; that
is, if for two successive values of i, the numbers
di(2), ... 
di (n) are identical. Explain.

350 
Chapter 11 
Applications of Paths and Circuits
(b) Show that the Bellman-Ford algorithm will detect 
following idea is proposed. Determine the highest neg-
the presence of any negative weight cycle in a 
ative weight k of an arc, add IkI to the weight of every
weighted digraph (assuming there is at least one 
arc (now all arcs have nonnegative weights), use Dijk-
directed path from vt to every other vertex). 
stra to find shortest paths, and finally subtract from each
24. Find a reasonable estimate of the complexity of the 
final weight, kl times the number of arcs required on a
Bellman-Ford algorithm, in terms of comparisons. 
shortest path. Comment.
25. In an attempt to get the algorithms of Dijkstra to work 4 
26. Discover what you can about Bellman and Ford and
correctly on digraphs with negative weight edges, the 
write a short note about these men.
11.3 
RNA CHAINS
In October 1989, it was announced that Sidney Altman, a Canadian-born pro-
fessor at Yale University, and Thomas Cech of the University of Colorado had
won jointly the Nobel Prize in chemistry for research on ribonucleic acid that
"could help explain the origins of life" and "probably provide a new tool for gene
technology."
Ribonucleic (pronounced '"r-bo-noo-cla-ic") acid (RNA for short) and de-
oxyribonucleic acid (DNA) are genetic materials carried in the cells of the human
body. In fact, RNA is a chain each link of which is one of four chemicals: uracil,
cytosine ("s!-t6-zen"), adenine, and guanine. Throughout this section, we will use
the letters U, C, A, and G, respectively, to represent these chemicals. Here, for
example, is one RNA chain:
(1) 
UCGAGCUAGCGAAG.
There are two kinds of enzymes which break the links in an RNA chain.
The first, called a G-enzyme, breaks a chain after each G-link. For example, this
enzyme would break the preceding chain into the following fragments:
G-fragments: UCG, AG, CUAG, CG, AAG.
The second enzyme, called a U,C-enzyme, breaks the chain after each U- and after
each C-link. Thus, it would break the chain in (1) into the fragments
U,C-fragments: U, C, GAGC, U, AGC, GAAG.
It is apparently not possible to discover directly the sequence of U's, C's, A's,
and G's which comprise a particular chain, but using the enzymes just described,
the collection of fragments of the chain, the so-called complete enzyme digest,
can be determined. The problem is then how to recover an RNA chain from its
complete enzyme digest. In this section, we show how to solve this problem with
a method which makes use of graph theory.
There are 5! possible RNA chains with the G-fragments just listed. (In real
situations, the number is much larger.4) Our aim is to find which of these 120
4The first chain successfully recovered contained 77 chemicals. See Robert W. Holley, Jean Apgar,
George A. Everett, James T. Madison, Mark Marquisse, Susan H. Merrill, John Robert Penswick, and Ada
Zamir, "Structure of a Ribonuclei Acid," Science 147 (1965), 1462-1465.

11.3 RNAChains 
351
chains also gives rise to the given set of U,C-fragments. Our method involves
associating with any complete listing of G- and U,C-fragments a directed pseu-
dograph (it is seldom a graph) and hunting for Eulerian circuits, each of which
corresponds to an RNA chain with the specified fragments. If the pseudograph is
not Eulerian, then no such chain exists. (Perhaps an error was made in listing the
fragments.)
In any recovery problem, we may assume that there are at least two G-
fragments and two U,C-fragments; otherwise there is no difficulty in obtaining
a solution. Also, it is straightforward to determine the fragment with which
the chain ends. In the preceding listing of fragments, for example, the U,C-
fragment GAAG is abnormal: U,C-fragments should end in U or C but GAAG
does not. The only way this could happen is for GAAG to be at the end of the
chain.
Using the fact that GAAG must come last in the sought after RNA chain, lower
the previous estimate of 120 possible chains with the given fragment lists by
determining how many RNA chains have the set of U,C-fragments listed pre-
viously.
The initial lists of fragments will always contain at least one abnormal frag-
ment (at the end). If this is a G-fragment ending in U or C, or a U,C-fragment
ending in G, then there will be only one abnormal fragment and, in that case, the
final fragment is uniquely determined. The only way in which there can be two
abnormal fragments is if they both end in A. In this case, however, one will be
identifiable as contained within the other; it is the longer of the two with which
the chain ends. Again, the final fragment is uniquely determined.
There can never be more than two abnormal fragments. Why?
To illustrate the general procedure, we consider the example described previ-
ously. We assume that we know only the fragments and, to make things amusing,
change the order of the fragments and start with these lists:
G-fragments: 
CUAG, AAG, AG, UCG, CG
U,C-fragments: 
U, U, AGC, C, GAAG, GAGC.
Imagine splitting the G-fragments further using the U,C-enzyme and splitting
the U,C-fragments further with the G-enzyme. For example, UCG in the first list
would become U, C, G, while AGC in the second list would become AG, C. A
fragment like AAG wouldn't split further. The resulting bits are called extended
bases; those extended bases which are neither first nor last in a fragment are
called interior. Thus, a fragment which splits into n > 3 extended bases will
yield n -2 interior extended bases. In the splitting of the fragment UCG with the
U,C-enzyme, U, C and G are extended bases; C is interior. Similarly, the extended
base AG from the U,C-fragment GAGC is interior. A fragment must split into at
least three extended bases before it gives rise to an interior extended base; there
are no interior extended bases from the fragment AGC, for instance.
We now list all the interior extended bases obtained by the above splitting.
In our example, we obtain
interior extended bases: U, C, AG,
MM

352 
Chapter 11 
Applications of Paths and Circuits
which arise from the G-fragments CUAG, UCG and the U,C-fragment GAGC, respec-
tively. Next, we list all fragments (G- or U,C-) which are unsplittable, that is,
fragments which are already extended bases. In our example, we obtain
unsplittable fragments: AAG, AG, U, U, C,
these being the G-fragments which the U,C-enzyme does not split and the UC-
fragments which the G-enzyme does not split.
There are exactly two unsplittable fragments which are not interior extended
bases, namely, the fragments AAG and U. These are the fragments with which the
original chain begins and ends. Since we have already determined that the chain
ends with GAAG, we know that U must be the first fragment in the chain.
Finally, we will see how graph theory comes into play. Consider again the
complete enzyme digest:
G-fragments: 
CUAG, AAG, AG, UCG, CG
U,C-fragments: 
U, U, AGC, C, GAAG, GAGC.
Having determined the fragments with which the chain begins and ends, we pro-
ceed to construct a directed pseudograph. Consider any fragment in one of the
preceding lists which is not an extended base (in other words, which splits under
the action of the other enzyme), UCG for example. Draw two vertices labeled U
and G for the first and last extended bases in this G-fragment and join them by
an arc labeled UCG going from the first extended base to the last, as shown in
Fig 11.10.
UCG
Figure 11.10 
U Â°-- 
o G
Similarly, the G-fragment CG determines an arc labeled CG from a vertex
labeled C to one labeled G. Repeating for all normal fragments which split (not
just those giving rise to an interior extended base), we obtain all parts of the
directed pseudograph shown in Fig 11.11 except for the arc labeled GAAG*U. By
what reasoning have we included this additional arc?
AGC
C 
CU 
AG
GAGC
CG 
\
U 
UC 
C
GAAG*U
Figure 11.11 
A directed pseudograph determining an RNA chain.
The longest abnormal fragment is GAAG and, as we have seen, this is the
last fragment in the chain. Draw an arc from G, its first extended base, to U, the

11.3 RNAChains 353
first extended base in the chain (determined earlier) and label this arc GAAG*U.
To find the RNA chain, we look for Eulerian circuits in the pseudograph which
begin with U and end with the arc GAAG*U. We then obtain the original chain
by writing down the labels of the arcs on the Eulerian circuit in order, noting
that each vertex encountered is listed twice on the arc labels, so one of these
occurrences should be discarded. If there is more than one Eulerian circuit, then
there is more than one chain with the given fragments. If, by some chance, no
Eulerian circuit exists, then the original fragments contradicted each other; there
is no RNA chain with these fragments.
In the directed pseudograph of Fig 11.11, there is just one Eulerian circuit:
UCG, GAGC, CUAG, AGC, CG, GAAG*U. Eliminating overlap at each vertex, we
obtain the RNA chain UCGAGCUAGCGAAG.
Here is a summary of the method we have outlined.
1. Determine the fragment with which the chain ends. It's the abnormal frag-
ment if there is only one and otherwise, the longer of the two abnormal
fragments.
2. List the interior extended bases and the unsplittable fragments. The chain
begins and ends with the two unsplittable fragments which are not interior
extended bases. Thus, the first and last fragments of the chain are known.
3. Form a directed pseudograph as follows:
(a) For each normal fragment which splits under the action of the other
enzyme, draw an arc from a vertex labeled with its first extended base to
a vertex labeled with its last extended base. Label the arc with the name
of the fragment.
(b) Draw a final arc from the first extended base of the largest abnormal
fragment X to the first extended base Y of the chain. Label this arc
X*Y.
4. Determine all Eulerian circuits in the pseudograph which end with X*Y and
write down in order the labels of the arcs without repeating the label of each
vertex on the circuit.
PROBLEM 3. 
Determine the RNA chain or chains (if any) which give rise to
the following complete enzyme digest.
G-fragments:
U,C-fragments:
AACUG, UAG, A, AG, AG, AG, G
U, AGAAC, AGAGA, GGAGU.
Solution. 
There are two abnormal fragments, A and AGAGA. The longer is
AGAGA, so this is the fragment with which the chain ends.
The interior extended bases and unsplittable fragments are these:
interior extended bases:
unsplittable fragments:
U, AG, G, AG
A, AG, AG, AG, G, U.
* 
* 
S
S

354 
Chapter 11 
Applications of Paths and Circuits
(Notice that the U,C-fragment GGAGU yields two interior extended bases.) The
two unsplittable fragments which are not extended bases are AG and A. Since the
chain ends AGAGA, it begins AG.
AAC 
AACUG 
G
GGAGU 
AGAAC
Figure 11.12 
UG 
AGAGA*AG
In Fig 11.12, we show the directed pseudograph 
which depicts this
situation. The extended base with which the longer of the abnormal frag-
ments begins is AG, which is also the initial fragment. Thus, the final arc, labeled
AGAGA*AG, 
is 
a 
loop 
from 
AG 
to 
itself. 
The 
unique 
answer 
is
AGAACUGGAGUAGAGA. 
I
The connection between graph theory and the problem of recovering RNA
chains from their enzyme digests does not seem to be well known. It came first to
our attention in a book on combinatorics by Fred Roberts,5 although the ideas seem
to have originated in work of James E. Mosimann. 6 We are indebted to George
Hutchinson7 for making available some additional material to complement his and
Mosimann's journal articles.
We would also like to thank Daniel Kobler for making us aware of the fact
that graph theory techniques similar to those described in this section have been
used recently to study problems of recovering DNA chains from other types of
information about fragments. 8
-
S *. 
-
7. Since GAAG comes last, we seek the number of arrangements of the frag-
ments U,C,GAGC,U,AGC. Since U appears twice, the answer is 15! = 60. (See
Section 7.3.)
8. There can be at most one abnormal G-fragment and at most one abnormal
U,C-fragment.
5Fred S. Roberts, Applied Combinatorics, Prentice Hall, New Jersey, 1984.
6James E. Mosimann, Elementary Probabilitybfor the Biological Sciences, Appleton-Century-Crofts, New
York, 1968.
7George Hutchinson, "Evaluation of Polymer Sequence Fragment Data Using Graph Theory," Bulletin
of Mathematical Biophysics 31 (1969), 541 562.
, Evaluation of Polymer Sequence Data from Two Complete Digests, Internal Report, Lab-
oratory of Applied Studies, Division of Computer Research and Technology, National Institute of Health,
Maryland (1968).
8For example, see J. Blazewicz, A. Hertz, D. Kobler, D. de Werra, "On Some Properties of DNA
Graphs," Discrete Applied Mathematics 98 (1999), 1-19.

11.4 Tournaments 
355
The symbol [BB] means that an answer can be found in the Back of the Book.
1. Answer the following questions for each pair of frag-
ment lists given.
i. From how many RNA chains could the given list of
G-fragments arise? From how many chains could the
given list of U,C-fragments arise? Which of these
numbers provides a "better" estimate of the num-
ber of RNA chains whose G-fragments and U,C-
fragments are as described?
ii. Find all RNA chains with the given complete en-
zyme digests.
(a) [BB] G-fragments: 
CUG, CAAG, G, UC
UC-fragments: 
C, C, U, AAGC, GGU
(b) G-fragments: 
G, UCG, G, G, UU
UC-fragments: 
GGGU, U, GU, C
(c) G-fragments: 
UCACG, AA, CCG, AAAG, G
U,C-fragments: 
C, GGU, GAAAGAA, C, AC, C
(d) G-fragments: 
UUCG, G, ACG, CUAG
U,C-fragments: 
G, C, GGAC, U, AGU, C, U
(e) [BB] G-fragments: 
UG, CC, ACCAG, G, AUG
U,C-fragments: 
C, GAU, C, AGC, GAC,
GU
(f) G-fragments:
U,C-fragments:
(g) G-fragments:
UC-fragments:
CACG, AUG, UCAG, AG, UG
AC, C, GU, G, AGAU, GAGC, U
UCG, AUAG, AG, UCAAUAG, G
C, AGU, AG, GGAU, C, AGU,
AAU
(h) G-fragments:
U,C-fragments:
UAG, CUAAG, UA, G, UCAG,
UAG
C, U, U, AGGC, AAGU, AGU,
AGU, A
2. (a) [BB] Why must there always exist an abnormal frag-
ment?
(b) [BB] Give a necessary and sufficient condition for
there to exist two abnormal fragments.
3. [BB] Find the length of the smallest RNA chain with the
property that its G- and UC-fragments are the same as
those of another RNA chain. (Assume that these chains
contain no A's and are of length greater than 1.)
4. Consider the two lists:
. the interior extended bases,
. the unsplittable fragments.
Show that
(a) [BB] every entry on the first list is on the second
list;
(b) [BB] the first and last extended bases in the entire
RNA chain are on the second list but not on the first;
(c) any item on the second list which is not on the first
list must be a fragment with which the chain begins
or ends.
5. Explain why every RNA chain determines an Eulerian
circuit in the corresponding directed pseudograph.
11.4 
TOURNAMENTS
I 
S
In this section, we consider another kind of digraph called a tournament, which
is just a complete graph with an orientation.
A tournament is a digraph with the property that for every two distinct vertices
u and v, exactly one of uv, vu is an arc. The score of a vertex in a tournament,
denoted s(v), is the outdegree of that vertex. The score sequence of a tournament
is the list of outdegrees, in nonincreasing order.
Suppose that a tournament T has n vertices, each of which has a different score.
What is the score sequence of T?
Tournaments arise in many different situations, the most obvious giving rise to
their name. A round-robin competition in sport is one in which every competitor
ff 3TITI-IM

356 
Chapter 11 
Applications of Paths and Circuits
plays every other competitor once. Such a competition can be represented by a
tournament in which the players are vertices and an arc directed from vertex v to
vertex u indicates that player v defeats player u. In this context, the score of a
vertex is the number of wins achieved by that player in the tournament and the
score sequence is the sequence of wins by all the players, arranged in decreasing
order. An example of a tournament involving five players and with score sequence
3, 3, 2, 2, 0 appears in Fig 11.13.
A
E
B
D 
C
Figure 11.13 
A tournament of size five.
There are other less obvious applications of tournaments. In psychology, sub-
jects are sometimes presented with alternatives two at a time and asked to express
a preference for one of them. Representing the various alternatives as the vertices
of a digraph and assuming all possible pairs of alternatives are presented to the
subject, then that person's preferences can be represented as a tournament in a
natural way.
Tournaments arise in biology as well. It is sometimes the case that for every
pair of animals of a certain species, one is dominant over the other. This relation
defines a pecking order in the species, and this can be analyzed by means of
tournaments.
It is usually desired to rank the members of a tournament. In the round-robin
competition pictured in Fig 11.13, the numbers of wins recorded by A, B, C, D,
and E are 3, 2, 2, 0, and 3 respectively. Since A and E have the best records, these
players should finish ahead of the rest. Since E defeated A, perhaps E should
be ranked first, although A might resent this since A defeated B, who in turn
defeated E. A Hamiltonian path provides one way of settling rankings, namely,
rank v ahead of u if vertex v occurs before vertex u in the Hamiltonian path. Such
a ranking may seem reasonable since a player will always have beaten the person
ranked immediately below him or her. In Fig 11.13, for example, EACBD is a
Hamiltonian path and E, A, C, B, and D is the corresponding ranking of players.
The following theorem, due to the Hungarian mathematician L. RWdei, tells us
that this procedure is available in any tournament.
(RedeP) Every tournament has a Hamiltonian path.
Proof 
Suppose T is a tournament with n vertices. We proceed by induction on n. The
result is trivial for n = I and for n = 2 the only tournament is o->--, 
which
clearly has a Hamiltonian path. So assume that k > 2 and that the result is true
9 L. RWdei, "Ein kombinatorischer Satz," Acta Litterarum ac Scientiarum Szeged 7 (1934), 39-43.
-
;.

11.4 Tournaments 
357
for n = k. Let T be a tournament with k + I vertices, let u be any vertex of T,
and let T \ {u} be that subgraph of T obtained by deleting u (and all arcs incident
with u). This subgraph has k vertices and it is a tournament since each pair of
vertices is still joined by an arc. By the induction hypothesis, we conclude that
T \ {u} has a Hamiltonian path VI V2 
Vk. Now there is an arc between u and vI
(see Fig 11.14). If this arc is uvI (that is, directed from u to vI), then uVIv2 
Vk
is a Hamiltonian path in T.
V1 
V2 
V3 
VkI Vk 
V1  
V2 
V3 Vi-l 
Vi Vk-I 
Vk
-, 
-
-
------------- 
o-- 
(3 
o e 
P 
--- 
----- 
*0
U 
U
Figure 11.14 
(a) 
(b)
Suppose, on the other hand, that the arc is v Iu and consider the arc between
u and V2. If this arc is U V2, then VIuV2V3 .
k is a Hamiltonian path in T and
again we have the desired result. In general, if there is a minimal integer i > I
such that the arc between u and vi is uvi, then vi-1u is an arc (by minimality of
i), and VIV2 
. Vi 
IUVi 
Vk is a Hamiltonian path (see Fig 11.14(b)). If there is
no such minimal i, all arcs between u and vi are of the type viu and VI V2 ... 
VkU
is a Hamiltonian path. In any case, there is a Hamiltonian path. 
I
Unfortunately, there is no reason why a Hamiltonian path in a tournament
should be unique, so disputes over ranking can still exist. In our earlier example
concerning the tournament in Fig 11.13, for instance, ABECD is another Hamil-
tonian path.
Find a third Hamiltonian path.
The point is that with more than one Hamiltonian path, there is no unique
ranking of the players. Certain tournaments, however, do have unique Hamiltonian
paths.
A tournament is transitive if and only if whenever uv and vw are arcs, then uw
is also an arc.
No 3-cycle can appear in a transitive tournament.
Transitive tournaments are precisely those which have no subtournaments of
the form illustrated in Fig 11.15. For instance, the tournament in Fig 11.13 is not
transitive because ABEA is a 3-cycle like that in Fig 11.15.
It turns out that we can characterize those tournaments with unique Hamilto-
nian paths in terms of the concepts of transitivity and scores.
5 
I6
MOMMARMi
Figure 11.15

358 
Chapter 11 
Applications of Paths and Circuits
4 
4 
6
We show (1) 
(2), that a tournament with a unique Hamiltonian path must be
transitive, and leave the rest of the proof to the Exercises (Exercise 9). So assume
that XT has a unique Hamiltonian path and order the vertices so that this path
is Vn- Ie 
2 
vo. It is sufficient to show that vjvi is an arc whenever j > i.
Suppose, by way of contradiction, that this is not the case. Then there must be
some arc vl vj with j > i. (See Fig 11.16.)
Proof
Figure 11.16
vo
4 
-
S *. 
-
Choose i as small as possible such that an arc of this type exists (for some j)
and, with that i fixed, choose j as large as possible such that the arc vl vj exists.
If j 0 n -1 and i :A 0 (as depicted in the figure), then
Vn 
I 
V 
Ivivivi -I 
Vi+1Vi- I 
.VO
is a second Hamiltonian path. If i = 0 and j 0 n -1, then
Vn-I 
Vj+Â±VOVjVj-j ... 
VI
is a second Hamiltonian path. If j = n -I 
and i 0 0,
Virn- IVn-2 ..
Vi+1 Vi- I .
o
is a second Hamiltonian path and, if i = 0 and j = n -1, 
then
VOVn- IVn 
2 
.V
is a second Hamiltonian path. In all cases, we contradict the uniqueness of the
Hamiltonian path. 
I
Since we don't need graph theory to rank n players all of whose scores are
different, the import of Theorem 11.4.4, sadly, is that Hamiltonian paths are not
very helpful in ranking tournaments.
In a tournament of n players voI,v 
Vnl, suppose the score of player vi is i.
Find a Hamiltonian path.
9. Since each player in a tournament of n players can achieve at most n - 1
victories, the score of each vertex is at most n -1. The score of each vertex
is nonnegative, so any score s satisfies 0 < s < n -
1. The only set of n
distinct scores in this range is {0, 12, . . ., n-1}, so the score sequence is
n -1,n -2,... ,2,1,0.
10. ACBED is a third Hamiltonian path in Fig 11.13.
The following properties of a tournament T are equivalent.
(1) T has a unique Hamiltonian path.
(2) T is transitive.
(3) Every player in T has a different score.
Vn-1 
Vn-22 
Vi + I 
; v 
jp 
-1 
vi+ 
vi-I
0-o 
----c -
-
-
i 
X 
X 
-

11.4 Tournaments 
359
11. Player v,-l wins all n- 
I games; so there is an arc from v,_- to each other
vi, in particular to Vn-2. Player Vn-2 wins n -2 games (losing only to v,- 
i)
so there is an arc from V,-2 to each of vo, vI, .. ., Vn-3- Continuing in this
way, we see that there is an arc from vi to vi 
for each i, 1 < i < n -1.
Thus, Vn- Iv ,-2 
Vo is a path and, since it contains all vertices, Hamiltonian.
The symbol [BB] means that an answer can be found in the Back of the Book.
1. (a) [BB] Draw all nonisomorphic tournaments with
three vertices and give the score sequence of each.
Which of these are transitive?
(b) Repeat part (a) for tournaments with four vertices.
2. [BB] Let A be the adjacency matrix of a tournament.
Describe A + AT and explain.
3. (For students of linear algebra)
(a) Prove that A is the adjacency matrix of a tournament
with n players if and only A + AT = J -I, 
where
I is the n x n identity matrix and J is the n x n
matrix consisting entirely of l's.
(b) If A is the adjacency matrix of a tournament, so is
its transpose. Why?
(c) Let P be an n x n permutation matrix, that is, a
matrix obtained from the n x n identity matrix by
rearranging its rows. If A is the adjacency matrix of
a tournament, so is PAPT. Why?
4. (a) Find all Hamiltonian paths in the tournament of
Fig 11.13.
(b) Suppose the arc in Fig 11.13 is DB, not BD. Find
all Hamiltonian paths in this tournament.
5. Suppose sI, S2, . . ., sn, are the scores in a tournament.
(a) [BB] Prove that yn I si = Zi.l (n -
s1 ) and
interpret this result in the context of a round-robin
tournament.
(b) Prove that A, 
I s72 = yn I(n -I 
s) 2 and inter-
pret this result in the context of a round-robin tour-
nament.
6. [BB] Let T be a tournament and let v be any vertex of
T having maximum score. Show that the length of the
shortest path from v to any other vertex of T is I or 2.
7. (a) [BB] Could 3, 2, 1, I be the score sequence of a
tournament?
(b) Could 6, 6, 6, 6, 1, 1, 1, I be the score sequence of
a tournament?
8. Let S be the set of scores in a tournament T with n
vertices.
(a) Prove that Es 
= n(n -I).
set
(b) Let t be a natural number less than n and let
S, S2, 
,St e S.
Prove that 
Si > !It(t 
).
[Remark: H. G. Landau has proved that the two condi-
tions in (a) and (b) are sufficient as well as necessary
for the existence of a tournament with a prescribed set
of scores.10]
9. Complete the proof of Theorem 11.4.4 as follows.
(a) Prove that the scores in a transitive tournament of
n vertices are all different. Thus, (2) -* 
(3).
(b) Suppose every player in a tournament T has a dif-
ferent score. Show that I has a unique Hamiltonian
path. Thus, (3) -- (1). [Hint: Pauses 9 and II]
10. Find all Hamiltonian paths.
11. [BB; A-+] Prove that a tournament is transitive if and
only if it contains no cycles.
10H. G. Landau, "On Dominance Relations and the Structure of Animal Societies, 111; The Condition for a Score Structure," Bulletin of Mathematical
Biophysics 15 (1955), 143-148.

360 
Chapter 11 
Applications of Paths and Circuits
11.5 
SCHEDULING PROBLEMS
The shortest path algorithms for weighted graphs discussed in Section 10.4 have
many obvious applications. Often, the weight on an edge represents distance (or
cost) and the shortest path is just the shortest (or cheapest) route between the
distinguished points. There is also a large area of application to weighted digraphs,
where the arcs represent tasks which must be performed in a certain order and the
weight of an arc represents the time required to carry out the task. The problem
in which we are interested is to determine the order in which the tasks should be
undertaken in order that they all be completed in the shortest possible time. We
present two types of such "scheduling problems" in this section.
We assume throughout that the weights of arcs in digraphs are integers. Such
digraphs are also called directed networks.
A directed network is a digraph with an integer weight attached to each arc.
The construction of a fence involves four tasks: setting posts (Po), cutting wood
(C), painting (Pa), and nailing (N). Setting posts must precede painting and
nailing, and cutting must precede nailing. Suppose that setting posts takes three
units of time, cutting wood takes two units of time, painting takes five units of time
for uncut wood and four units of time otherwise, and nailing takes two units of time
for unpainted wood and three units of time otherwise. In what order should these
tasks be carried out in order to complete the project in the shortest possible time?
C
S 
T
F
Figure 11.17 
A directed network for a scheduling problem.
This is a problem which can be easily analyzed. There are five ways in which
the fence can be completed:
Po-C-N-Pa
Po-Pa-C-N
Po-C-Pa-N
C-Po-N-Pa
C-Po-Pa-N
and it is a simple matter to compute the time for each. We can also illustrate the
situation with the directed network shown in Fig 11.17. The arcs in the digraph
represent tasks and the vertices represent stages in the process. The direction of an
S 
S

11.5 Scheduling Problems 
361
arc indicates passage from one stage to another. For instance, the arc with weight
2 from D to F represents nailing, while the two arcs leaving vertex A represent
cutting and painting. Vertex E represents the stage where all tasks except nailing
have been completed.
A path corresponds to a certain order of tasks; thus, the three different paths
from S to E represent three different ways to cut, paint, and set posts. Note that
the weight given to an arc may depend on which tasks precede it; for example,
arcs DF and ET each represent nailing, but they have different weights.
The shortest path from S to T shows us how to complete the project in the
least amount of time. Applying Dijkstra's algorithm (first version) to the digraph,
we obtain the labels shown in Fig 11.18.
S(-, 0)
Figure 11.18
T(F, II)
One shortest path is SA D F T, completing the job in I I units of time. This path
corresponds to first setting posts, then cutting, then nailing, and finally painting.
Notice that there was a choice in the labeling of vertex D; it could equally
well have been labeled (B, 5). There is, therefore, a second shortest path which
completes the job in 11 units of time, namely, SBDFT. So we could equally
well cut, then set posts, then nail, and finally paint.
The procedure just described is important in the management sciences and has
been thoroughly studied. Methods for solving such networks are often called crit-
ical path methods (CPMs) or project evaluation and review techniques (PERTs),
and a great deal of specialized terminology has been developed. For example, a
shortest path such as SADFT (or SBDFT) is called a critical path.
In the scheduling problem discussed previously, one task had to be completed
before another could start. Such would be the case in a one-person project, for
example. Also, the time required for a task depended upon what tasks had already
been completed. There are other situations, however, where several different tasks
can be pursued simultaneously and where the time of a given task is independent
of the other tasks. Think of the construction of a house or office building. Such a
project often requires the services of a large number of people. While the order
of tasks is sometimes important (plumbing before carpets!), sometimes it isn't
(plumbing and electrical work). Also, and unlike building a fence, in a large
construction project the times of the tasks are often determined only by the nature
of the task.
As before, our aim is to plan the project so as to minimize the time required.
While strictly speaking, the procedure we outline is not a shortest path method,
it does fit naturally into this section.

362 
Chapter 11 
Applications of Paths and Circuits
Â¶: I miii It [CU
In order to finish a basement, a contractor must arrange for certain tasks to be
completed. These are shown in Table 11.5 together with brief codes for referring
to them and the times required for each.
Table 11.5
Task 
Code 
Time
Floor installation 
F 
4
Plumbing 
Pi 
3
Electrical work 
E 
5
Wallboard 
W 
3
Varnish doors and moldings 
V 
I
Paint 
Pa 
2
Install doors and moldings 
D 
1
Lay carpet 
C 
2
Figure 11.19
4 
F 3 PI 3 
W 2 Pa I D 
0
S 
T
E 
I 
V 
C
We represent this problem by the digraph in Fig 11.19. This time the vertices
represent tasks and an arc from u to v means that task u precedes task v. It is
necessary to install the floor (F) before any other tasks can commence. The elec-
trical work (E) and plumbing (P1) must both be completed before the wallboard
can go in, but neither the plumbing nor the electrical work is a prerequisite for the
other; these two tasks can occur simultaneously. The order in which other tasks
are carried out is shown in the digraph. Note that while the electrical work must
precede the painting, we do not show an arc from E to Pa since this precedence
can be inferred from the arcs EW and WPa.
The weight assigned to an arc is the time it takes to complete the task repre-
sented by the terminal vertex of the arc. Both E W and PI W are assigned a weight
of 3 since both E and PI must be completed before W can commence and W
requires three units of time. The last two arcs, leading to the finish of the project,
are assigned a weight of 0 because the job is completed once D and C are finished.
When the job is completed, all paths from start to finish will have been fol-
lowed. Thus, in this situation, it is the time required for the longest path which is
the shortest time for the entire project. To find this path, we modify in two ways
the first version of Dijkstra's algorithm. No vertex is labeled until all prerequisite

11.5 Scheduling Problems 363
vertices have been labeled and each vertex is always labeled with the largest
value of d + w(e). The final labels in our example are shown in Fig 11.20.
Figure 11.20
(S, 4) 
(F, 7) (E, 12) (W, 14) (Pa, 15)
4 
F 3 P1 3 
W 2 Pa 1 D 
0
SE-, 
() F,) 
I 
V 
1 
C 
T(1, 
6)
E(F, 9) 
I 
V(E, 10) 
C(Pa, 16)
The job can be completed in 16 units of time, and FEWPaC is the critical
path. Note that the tasks not on the critical path (PI, V, and D) can be delayed
somewhat without delaying the project. For example, plumbing could take five
time units instead of three and the label (E, 12) for W would still be correct: The
critical path would not be affected. Varnishing could take as much as six units of
time without delaying the project because, if this were to occur, only the label for
D would change, to (V, 16): The project could still be completed in 16 units of
time. On the other hand, if more than six units of time were spent on varnishing,
the project would be delayed. This extra 6-I 
= 5 units of time which could be
spent on V is called the slack of the task V. As we have seen, the slack of PI
is 2 and the slack of D is 1. Knowledge of these values allows the contractor to
complete the project more quickly by transferring workers to other tasks on the
critical path.
The symbol [BB] means that an answer can be found in the Back of the Book.
1. [BB] Solve the fence problem described in paragraph
11.5.2, assuming that the setting of posts takes three
units of time if the wood has not yet been cut and four
units of time otherwise. (All other aspects of the project
are unchanged.)
2. The construction of a certain part in an automobile
engine involves four activities: pouring the mold, cal-
ibration, polishing, and inspection. The mold is poured
first; calibration must occur before inspection. Pouring
the mold takes eight units of time, calibration takes three
units, polishing takes six units of time for an uncali-
brated product and eight units of time for a calibrated
one, and inspection takes two units of time for a pol-
ished product and three units of time for an unpolished
one.
(a) What type of scheduling problem is this (type I or
11)? Represent the paths to completion of this job
by drawing the appropriate directed network.
(b) What is the shortest time required for this job?
Describe the critical path.
3. In Exercise 2, suppose polishing takes nine units of time
for an uncalibrated product. (All other conditions remain
the same.) Find the new critical path and the length of
the revised project.
4. Repeat Exercise 2, assuming that, in addition to the tasks
stated, the workers will take a coffee break. The cof-
fee break must take place after calibration and before
inspection. If it occurs before polishing, it requires two
time units; after polishing, it requires six time units.
5. [BB] Change the basement project described in para-
graph 11.5.3 by supposing that
. plumbing requires four units of time;
. the doors and moldings will be installed before they
are varnished;
. the carpets cannot be installed until the doors and
moldings have been varnished; and

364 
Chapter 11 
Applications of Paths and Circuits
. there are kitchen cabinets to be installed in one unit
of time after painting.
Draw the appropriate directed network which depicts the
paths to completion of this revised project. Describe all
critical paths and the slack in each task.
6. [BB] Suppose we want to build a Klein bottle. The tasks
involved in this project and the time required for each
are recorded in the following table.
Code 
Tasks 
Time (in months)
G 
blow glass 
7
Po 
polish 
5
Sh 
shape 
9
A 
add hole 
4
H 
affix handles 
5
Tw 
twist 
2
R 
remove hole 
4
Pa 
paint 
6
The glass must be blown before anything else. Polishing
precedes all but G and Sh; shaping precedes all but G
and Po. The hole must be added before it is removed
(!) and before the bottle is twisted. The handles go on
before Tw and Pa. Once Tw, R, and Pa are completed,
the project is finished.
(a) What type of scheduling problem is this (type I or
II)? Draw the appropriate directed network.
(b) Find all critical paths for this project.
(c) Find the slack of Po, Sh, A, Tw, and R for each
of the critical paths found in (b).
(d) Suppose that tasks Po and A are each delayed
three months. Will the completion of the project be
delayed? Explain.
7. Repeat Exercise 6 if, in addition to all the conditions
stated there, A must also precede H.
8. Repeat Exercise 6 if A takes six months to complete
instead of four and R takes seven months to complete
instead of four.
9. What's a Klein bottle? Find out what you can about this
thing and write a short note.
10. [BB] To complete her Master's thesis, a geology stu-
dent must perform field work (F) and laboratory anal-
ysis (L), conduct a library search (S) of the literature,
create a database of relevant articles (D), and write the
thesis (W). The write-up cannot begin until all tasks
except for the laboratory analysis are complete. It takes
three units of time if it is the last task and otherwise five
units of time. The field work, which takes four units of
time, must precede both the laboratory analysis and the
database creation. The library search takes two units of
time. The laboratory analysis takes two units of time if
it is undertaken after the library search and otherwise
three units of time. Creation of the database takes one
unit of time if it is delayed until the library search is
complete and otherwise four units of time.
(a) What type of scheduling problem is this (I or II)?
Draw the appropriate directed network.
(b) What is the shortest possible time in which this stu-
dent can complete her thesis?
(c) In what order should she perform her thesis-related
tasks in order to achieve this minimum time?
11. Fred and Wilma Noseworthy are planning a dinner party.
The things they must do before their guests arrive and
the time required for each are shown in the following
table. The fish must be caught and the wine purchased
before the table is set. The Noseworthys are not fond
of raw fish or raw vegetables and do not use wine in
their cooking. The table must be dusted before it can be
set. Vacuuming is never done until the table is set. For-
tunately, Fred and Wilma have the full support of their
student daughter and son, who are always very willing
to help their parents with whatever jobs have to be done
(so up to four jobs can be done simultaneously). The
entire family greets their guests together after all tasks
have been completed.
Dust house 
D 
3
Vacuum house 
V 
2
Set table 
T 
I
Buy wine 
W 
4
Catch fish 
F 
6
Pick vegetables 
P 
2
Cook food 
C 
4
Greet guests 
G 
2
(a) What type of scheduling problem is this (I or II)?
Draw the appropriate directed network.
(b) What is the shortest possible time in which din-
ner preparations can be accomplished? Describe the
critical path and illustrate with a directed network,
showing all labels.
(c) Find the slack in W, C, and D.
12. Repeat the previous problem under the additional assum-
ption that wine is used in the cooking.
13. Before going to school, John must take a shower, get
dressed, eat breakfast, and finish his math assignment.
John will take his shower before getting dressed or eating

Review Exercises 
365
breakfast and he'll get dressed before finishing his assi-
gnment, but there are no other restrictions. Taking a
shower requires 9 minutes; getting dressed takes 9 min-
utes if John has first eaten breakfast but otherwise 12
minutes. Finishing his assignment takes 12 minutes if
John has eaten breakfast, but 18 minutes otherwise. Eat-
ing breakfast takes 9 minutes if John has finished his
assignment and 18 minutes otherwise.
(a) What type of scheduling problem is this (I or II)?
Draw the appropriate directed network.
(b) Find all possible ways in which John can carry out
his tasks before school so that he can leave in the
shortest possible time.
14. Repeat Exercise 13, removing the restriction that John
must dress before finishing his assignment.
S 
s 
* 
*S 
S
1. Solve the Chinese Postman Problem for the weighted
graph given in Exercise 17 of the Chapter 10 Review
Problems.
2. Solve the Chinese Postman Problem for the unweighted
graph C3,6.
3. Explain how to solve the Chinese Postman Problem for
a graph 5 which has an Eulerian trail.
4. Let g be a strongly connected digraph with the property
that no vertex has indegree equal to its outdegree. Prove
that at least two vertices have indegrees greater than
their outdegrees.
5. (a) Find two different orientations on the edges of I(4
which lead to nonisomorphic digraphs.
(b) Find two different orientations on the edges of IC4
which lead to isomorphic digraphs.
6. If A is the adjacency matrix of a digraph and A2 = [bij
find 
Y LbiX and explain.
7. (a) Show that Dijkstra's algorithm fails and explain
why. Start at vertex A.
B 
2 
C
A
D
E
(b) Apply the Bellman-Ford algorithm to the digraph.
Your answer should make clear that you understand
this algorithm by showing how the labels on vertices
change as the algorithm proceeds.
8. Find all RNA chains with the given complete enzyme
digests.
(a) 
G-fragments: 
G, AUG, UCAG, CCUG
UC-fragments: 
G, GGAU, C, C, U, AGC, U
(b) 
G-fragments: 
G, G, AUU, UCG, G, UG, G
U,C-fragments: 
GGGGU, C, U, GAU, GU
(c) 
G-fragments: 
UG, CUAAG, AG, CG, UCG
U.C-fragments: 
GU, AAG, GAGC, GC, U, U, C
9. Let n > 3 and assume that the complete graph ICn has
vertices labeled IVJI, 11)2, ...
, W, and arc wi wj directed
w, to ivj if and only if i < j. Show that the tournament
on this digraph is transitive.
10. (a) Could 5, 5, 4, 3, 2, 2, 2 be the score sequence of a
tournament?
(b) Could 8, 8, 8, 6, 6, 3, 3, 1,1, I be the score sequence
of a tournament?
11. Let T be a tournament and let v be any vertex of T hav-
ing minimum score. Show that the length of the shortest
path from any other vertex to v is I or 2.
12. In a round-robin tennis tournament, we know that Alice
is the clear winner, George is the clear loser, and all
other players are tied for second. Show that the number
of players competing must have been odd.
13. George has to do four things before his mathematics
exam tomorrow morning: study, sleep, eat pizza, and
check his e-mail. He intends to spend two different
periods of time studying, three hours on each occa-
sion. While the sessions could be back to back, at least
one session must occur before he sleeps. Eating pizza
requires one hour, but it also takes an hour for the order
to arrive (and something else could be done during this
interval). Eating pizza must precede sleeping and also
at least one of the study sessions. George will get six
hours of sleep if he sleeps after all study has been com-
pleted, but he's willing to settle for five hours otherwise.
If George checks his e-mail between study sessions, he

366 
Chapter 11 
Applications of Paths and Circuits
will do so quickly and take only one hour; otherwise,
he will spend two hours at this activity.
(a) Find the shortest possible time in which George can
complete his activities, and a way in which he can
order them and complete them in this time.
(b) Assume that George decides to read his e-mail
before eating his pizza. Does this change the answer
to (a)? If so, how?
(c) Assume that George decides to read his e-mail
before ordering his pizza. Does this change the
answer to (a)? If so, how?
14. The following chart lists a number of tasks that must be
completed in order for a crew of workers to construct a
glynskz.
Task 
A B C D E F G H I J
Time 
2 2 3 l l 2 3 4 3 3
(in days) 
23133
Task A must be carried out before any other tasks can
commence. Task B must precede tasks E and F, and
both E and F must be completed before H can begin.
Tasks C and D must precede task G, which in turn must
precede I. Task J must be carried out last. It is assumed
that there are enough workers to carry out any number
of tasks simultaneously.
(a) What is the fewest number of days needed to con-
struct this glynskz? Find all critical paths.
(b) Find the slack in C, D, and E.

0 
I
-N~
12
.1
\ 
4
* 
''a 
.
\.
6
* 
'. 
...-
,
S
Trees
12.1 
WHAT IS A TREE?
One of the most commonly occurring kinds of graph is called a tree, perhaps
because it can be drawn so that it looks a bit like an ordinary tree. In this section,
we introduce this concept with a variety of examples.
Root
Chapters
to
12
Figure 12.1 
A partial computer directory structure.
The operating system on a computer organizes files into directories and subdi-
rectories in the same way that people gather together pieces of paper into folders
and put them into the drawers of a filing cabinet. The computer on which this
text was first prepared had a directory called "Book" partitioned into two sub-
directories called "Discrete" and "Graph," each in turn containing a number of
subdirectories, one for each chapter. Each chapter subdirectory had one file for
367
,.

368 Chapter 12 Trees
each section in that chapter. Part of the organization of these computer files is
depicted in Fig 12.1.
Suppose you wanted to write down all the increasing subsequences which can
be formed from the sequence 4, 8, 5, 0, 6, 2: 
4, 5, 6 is one such subsequence, as
is 0, 2, but not 2, 4 because it is not a subsequence of the given sequence. The
order of the elements in a subsequence must be the same as in the sequence
itself. To ensure that no subsequences are inadvertently omitted, some systematic
method of enumeration is required. The graph drawn in Fig 12.2 indicates such a
method. In the figure, the desired subsequences correspond to paths from "start"
to each vertex.
Start
4 
5
86 
2
8F5 
6 66 
2
Figure 12.2 
6
Figure 12.3
List all the monotonically increasing subsequences of the sequence 4, 8, 5, 0, 6, 2.
A
10 > 
\30)
B 
20 
4 
F
40 
5 
65 (
C 
15 
D 
10 
E
Suppose the vertices of the graph shown in Fig 12.3 represent towns, the
edges roads, and the label on a road gives the time it takes to travel the road. Is it
possible for a salesperson to drive to all the towns and return to his or her starting
point having visited each town exactly once? If it is, what is the shortest distance
required for such a trip? In Section 10.4, we introduced this "Traveling Salesman's
Problem" and mentioned that there is no efficient algorithm known for solving
it. In reasonably small graphs, of course, we can exhaustively enumerate all the
possibilities. Figure 12.4 indicates how we can use a graph to search systematically
for Hamiltonian cycles, if they exist. We assume that the salesperson starts at A.
The graph makes it apparent that there are in fact 12 Hamiltonian cycles in the
graph of Fig 12.3.
Answer the Traveling Salesman's Problem for the graph of Fig 12.3. Find a short-
est Hamiltonian cycle and its length.
John and David are going to play a few games of chess. They agree that the
first person to win two games in a row or to win a total of three games will be

12.1 What Is a Tree? 
369
A
B
C
D
A 
A 
A 
A 
A 
A 
A 
A 
A 
A A 
A
Figure 12.4 
A hunt for Hamiltonian cycles in the graph of Fig 12.3.
declared the winner. The possible outcomes can be conveniently pictured with the
graph shown in Fig 12.5.
J 
J 
J
I
D
DD
Figure 12.5 
D 
D 
D
How many outcomes are possible? What is the maximum number of games John
and David will play?
With the exception of that in Fig 12.3, all the graphs which have appeared in
this section are trees.
O= 
A tree is a connected graph which contains no circuits.
There are several alternative definitions.
Let G be a graph. Then the following statements are equivalent.
(1) 5 is a tree.
(2) g is connected and acyclic; that is, without cycles.
(3) Between any two vertices of g there is precisely one path.
Proof 
(1) -* 
(2): Since a cycle is a circuit, statement (1) immediately implies state-
ment (2).
IMM
RMUM

370 
Chapter 12 Trees
(2) 
-* 
(3): If there are two different paths 'P, P2 from some vertex v to
another, w, then the closed walk from v to v obtained by following the vertices of
PI and then those of P2 in reverse order would contain a cycle, contradicting (2).
(See Exercise 12.)
(3) -* (1): Since there is a path between any two vertices of g, certainly g
is connected. Moreover, it can contain no circuits. Otherwise, it would contain a
cycle (Exercise 14, Section 10.1) and a cycle determines two paths between any
two vertices of it.
The sequence of implications (1) -* 
(2) -- (3) -Ã· (1) just established proves
the equivalence of (1), (2), and (3).
A tree is rooted if it comes with a specified vertex, called the root.
This may not seem like much of a definition, but the concept is useful. Also,
there is a convention for picturing rooted trees. Suppose v is a root in a tree T.
By Proposition 12.1.2, there is a unique path from v to any other vertex. Thus,
the concept of level, meaning distance (number of edges on a path) from v, is
well defined. When drawing a rooted tree then, we agree to put the root v at the
top (in contrast to the way we draw trees that grow out of doors), we put all
level one vertices (those of distance I from v) on a horizontal line just below v,
those of level two (distance 2 from v) on a horizontal line below the previous,
and so on. The tree in Fig 12.2 is drawn so as to show the vertex "start" as
root. Vertex A in Fig 12.4 is a root. Vertices B, D, and F have level one; the
vertices labeled C, E, F, C, E, B, C, E in the next row have level two; and
so on.
The way in which a rooted tree is drawn clearly depends upon which vertex
is the root. In Fig 12.6, we show two pictures of the same tree, rooted at A on
the left and at B on the right.
A
C
AD 
E
C 
F
Figure 12.6
-
S 
*. 
-
The same tree rooted at A on the left and B on the right.
1. There are 13 in all.
4; 
4, 8; 
4, 5; 
4. 
5, 6; 
4, 6; 
8; 
5; 
5, 6; 
0; 
0, 6; 
0, 2; 
6; 
2
2. A shortest Hamiltonian cycle is ABCDEFA, of length 155.
S 
0

12.1 What Is a Tree? 
371
3. There are ten possible outcomes, corresponding to the ten vertices of degree 1
in Fig 12.5. As many as five games could be required to decide a winner.
The symbol [BB] means that an answer can be found in the Back of the Book.
1. [BB] Suppose eight teams qualify for the playoffs in
a local softball league. In the first round of playoffs,
Series A pits the best team against the team that fin-
ished eighth, Series B has the second best team playing
the team that finished seventh, Series C has the third
placed team playing the sixth. In Series D, the teams
that finished fourth and fifth play. In the second round,
the winners of Series A and C compete, as do the win-
ners of Series B and D, in Series E and F. Finally,
the winners of these series play to determine the league
champion. Draw a tree which summarizes the playoff
structure in this league.
2. Edward VII, eldest son among Queen Victoria's nine
children, finally ascended to the throne of England in
1901 (after 60 years as Prince of Wales). Upon his
death in 1910, he was succeeded by King George V.
George V had six children, perhaps the most infa-
mous of whom was Edward VIII, who abdicated to
marry a twice divorced American. Upon this abdi-
cation, George VI, father of the present Queen of
England, became king. Queen Elizabeth has four chil-
dren, Charles, Anne, Andrew, and Edward. Her sister,
Princess Margaret, has two, Sarah and David. Prince
Charles has two boys, William and Harry, marking the
first time since the death of Edward VII that there have
been two males in direct succession to the English
throne. Draw that portion of Prince William's family
tree which shows the people discussed in this short
narrative.
3. Make a tree (like that in Fig 12.2) which displays all
monotonically increasing subsequences of 3, 2, 8, 0, 9,
1, 5. How many are there altogether? Taking "start" to be
the root, how many vertices are at each possible level?
4. John does not play chess very well, so the next time he
plays David he says he will quit after winning a game, or
after five games in all have been played. Make a graph
showing all possible outcomes. How many possible out-
comes are there? In how many of these does John win
a game'?
5. [BB] It's the weekend and Harry has several ways to
spend his Friday and Saturday evenings. He can study,
read, watch television, or go out with the boys. Draw a
tree which shows all possible ways Harry can spend his
Friday and Saturday evenings.
6. Mary can travel from St. John's to Corner Brook by car,
bus, or plane and from Corner Brook to Goose Bay by
plane or boat. Draw a tree showing all the possible ways
Mary can go from St. John's to Goose Bay via Corner
Brook. In how many of these ways does she avoid the
bus?
7. [BB] In how many ways can a committee of three people
be chosen from the following group of people: Bruce,
Philomena, Irene, Tom, and Dave? Draw a tree which
shows all possible committees and the way each was
chosen.
8. Draw the tree with root A and with root B.
XA
B
9. The vertices in the graph represent towns, the edges
roads, and the labels on the roads costs of paving the
roads.
(a) Make a tree which shows all paths beginning at
vertex A. List those paths which terminate at C.
Indicate which ones, if any, are Hamiltonian.
(b) Is the graph Hamiltonian? Explain.
(c) Which roads should be paved in order that one may
drive from A along paved roads to as many towns
as possible at minimal cost? Justify your answer.
What is this minimal cost?
10. Solve the Traveling Salesman's Problem for each of
the following graphs by making trees which display all
Hamiltonian cycles. (Start at A in each case.)
13771-ITM -

372 
Chapter 12 Trees
I .
A 
11. A forest is a graph with no cycles. Explain why a forest
is the disjoint union of trees.
12. [BB] Suppose 'P and P2 are two paths from a vertex
v to another vertex w in a graph. Prove that the closed
walk obtained by following PI from v to w and then
P2 in reverse from w to v contains a cycle.
.2 PROPERTIES OF TREES
In this section, we derive a number of properties of trees and discuss a connection
with the isomers of a certain kind of hydrocarbon.
Suppose g is a graph each of whose vertices has degree at least 2. Then g contains
a circuit.
Let VI be any vertex of g. Since deg vI 7 0, we may proceed to an adjacent
vertex V2. Since deg V2 > 2, we may proceed to an adjacent vertex v3 along a
new edge. Note that v1V2V3 is a path. In general, suppose k > 3 and that we
have found a path through distinct vertices VI, V2, . . ., Vk. Since deg Vk > 2, Vk is
adjacent to a vertex Vk+I # Vk I. If Vk+I E {vI, V2, ... , Vk-21, we have a circuit;
otherwise, vI V2... Vk+ is a path. Since there are only finitely many vertices in
A, we cannot continue to find paths of increasing length, so eventually we find a
circuit. 
I
In a trivial way, a graph with a single vertex (of degree 0) is a tree. A tree with
more than one vertex can have no vertices of degree 0 (because it is connected)
so all its vertices have degree at least 1. If they all had degree at least 2, there
would be a circuit. Thus, we obtain a basic property of trees.
A tree with more than one vertex must contain a vertex of degree 1. (Such a
vertex is called a leaf.)
What is a leaf?
Modify the argument used to prove Proposition 12.2.1 in order to prove that a
tree with more than one vertex must contain at least two leaves.
In Exercise 21(b) of Section 10.1, you were asked to prove that a connected
graph with n vertices has at least n - 1 edges. It turns out that a connected graph
with n vertices and exactly n -1 edges is a tree; moreover, this property charac-
terizes trees.
A connected graph with n vertices is a tree if and only if it has n- 
I edges.
Proof 
(-a) First we prove, by mathematical induction, that a tree with n vertices has
n -I 
edges. This is clear for n = 1, so assume that k > I and that any tree with
k vertices has k -
I edges. Let T be a tree with k + I vertices. We must prove
ka)
nD)
12
admit-
Proof
M~g
1-w 
A 
n. 
-nI

12.2 Properties of Trees 373
that T has k edges. For this, let v be a vertex in T of degree 1. Remove v and
the single edge e with which it is incident. The point to appreciate is that the
pruned tree To = T \ {v} which remains is itself a tree. It has no circuits since
the original tree had no circuits. Why is it connected? If w and u are vertices in
To, they are joined by a path P in T7. Since you enter and leave each vertex of P
along different edges, each vertex of P between w and u has degree at least 2.
Thus, v and the lone edge e with which it is adjacent are not part of the path P.
So P must lie entirely in To. Therefore, To is connected and hence a tree. Since
'T has k vertices, it has k - I edges, by the induction hypothesis. Since T has
one more edge than T(, T has k edges, which is what we wanted to show.
V3
L' 2
V
Figure 12.7 
U
(a-) 
For the converse, we suppose that 5 is a connected graph with n vertices
and n - I edges and prove that g is a tree. We have only to establish the absence
of circuits. Suppose that g contains a circuit VIV2... 
vkvl. (Since graphs have no
loops and no multiple edges, k > 3.) Remove the edge e = vlIv2. The remaining
graph g \ te} has all n vertices of g but n -2 
edges; moreover, g \ {e) is
connected because any two vertices u, v of 5 which were connected via a path
which included e are still connected via a walk in which vlvkVk- 
... 
V3V2 is
substituted for e. (See Fig 12.7.)
If 5 \ {e} contains a circuit we delete an edge from this and obtain a connected
graph which still contains n vertices but has just n -3 
edges. Since g is finite,
eventually all circuits will be deleted and we shall be left with a connected graph
with n vertices, fewer than n -1 
edges, and no circuits. Such a graph is a tree.
We showed earlier that a tree with n vertices must have n -I 
edges. Thus, there
can be no circuit in g; g is indeed a tree. 
I
The tree in Fig 12.1 has 26 vertices and 25 = 26- I edges, as predicted by
Theorem 12.2.3. Verify this theorem for the trees in Figs 12.2 and 12.5.
There are two other properties of trees which follow quickly from Theo-
rem 12.2.3. The first has already been noted.
A tree with more than one vertex has at least two leaves, that is, at least two
vertices of degree 1.
Proof 
Suppose 'T is a tree with n vertices VI, v2, .
v 
,n 
and n - 1 edges. By Proposi-
tion 9.2.5, Izn , deg vs = 2(n - 1) = 2n -2. 
We already know that some vertex,
say VI, has degree 1. If the remaining n - 1 vertices each have degree 2 or more,
then the sum of all the degrees would be at least 1 + 2(n -1) = 2n -
1, a con-
tradiction. So there has to be another vertex, in addition to VI, which has degree
I too. 
I

374 
Chapter 12 Trees
Proof
Figure 12.8
In fact, there is a precise formula for the number of leaves, a formula which
shows that this number is at least 2. See Exercise 9.
Any edge added to a tree must produce a circuit.
The new graph remains connected and it is not a tree because it has an equal
number of edges and vertices. So it must contain a circuit. 
I
Is it possible for two circuits to be formed when a single edge is added to a tree?
The identification of a tree as an important type of graph is credited to the
English mathematician Arthur Cayley (1821-1895), a lawyer, a contemporary of
Sir William Rowan Hamilton, and arguably the leading English mathematician of
the nineteenth century. Cayley did fundamental work in the theory of matrices and
is considered by many to be the founder of abstract group theory. In chemistry,
chemical compounds with the formula CkH2k+2 are known as paraffins. The
molecule CkH2k+2 contains k carbon atoms and 2k + 2 hydrogen atoms. Each
hydrogen atom is bonded to exactly one atom, a carbon atom; each carbon atom is
bonded to four atoms. It is not hard to see that there is just one possible structure
for each of the first three paraffins; methane, ethane, and propane. (See Fig 12.8.)
H 
H 
H 
H 
H 
H
H 
C 
H 
H 
C 
C 
H 
H 
C 
H
H 
H 
H 
H 
H 
H
CLH4  
C2 H6  
C3 H8
Methane 
Ethane 
Propane
On the other hand, for k > 4, various arrangements of Ck H2k+2 are possible.
Each arrangement is called an isomer. Arthur Cayley wanted to know the number
of isomers of each paraffin. Each isomer is clearly associated with a connected
graph, a graph which is, in fact, a tree. Here is why.
Each of the k carbon atoms in CkH2k+2 corresponds to a vertex of degree 4 in
the associated graph and each of the 2k + 2 hydrogen atoms to a vertex of degree
1. The total number of vertices in the graph is k + (2k + 2) = 3k + 2 and the total
number of edges is one half the sum of the degrees; that is, 2 (4k + (2k + 2)) =
3k + 1. Since the graph is connected and the number of edges is one less than the
number of vertices, it is a tree (by Theorem 12.2.3).
Cayley also noted that an isomer of CkH2k+2 is completely determined by
the arrangement of the carbon atoms and that these form a tree with each vertex
of degree at most 4. (See Exercise 10.) Note the tree of carbons in each of the
molecules in Fig 12.8. To draw an isomer of CkH2k+2, we draw a tree with k
vertices labeled C, each of degree at most 4, and then add new edges with end
vertices labeled H, of degree 1, at each C vertex where necessary so that each C
vertex acquires degree 4. (It can be shown that 2k + 2 edges must be added. See
Exercise 11.)

12.2 Properties of Trees 
375
To enumerate all trees with n vertices, as Cayley was attempting to do, is
very difficult unless n is small. The situation for n < 4 is shown in Fig 12.9.
0
n = I
one tree
o-
n = 2
one tree
n = 3
one tree
n =4
two trees
Figure 12.9 
The unlabeled trees with n < 4 vertices.
Draw graphs of all possible isomers of butane (whose chemical formula is C4 H1().
How many are there?
There is no closed formula for the number of trees with n vertices, although
these numbers (for various n) appear as the coefficients of a certain generating
function which begins
x +x 2 +x 3 +2x 4 +-3x5 + 6x6 + I 
-x 
+ 23x8,
but whose derivation would take us too far afield.' On the other hand, as we
shall see in the next section, there are precisely nn-2 labeled trees on n vertices
(Theorem 12.3.3). As the name implies, a labeled tree is one in which each vertex
has a distinct label attached to it. Figure 12.10 shows graphs of the 33-2 = 3
different labeled trees with vertices A, B, and C.
B 
A 
C
A 
B 
C
popoe
A 
C 
B
Figure 12.10 
The three labeled trees on three vertices.
nmua~S
A 
* 
g *. 
-
Trees Ti and 12 whose vertices are labeled with the same set of labels are isomor-
phic if and only if, for each pair of labels v and w, vertices v and w are adjacent
in Ti if and only if they are adjacent in 12.
In Fig 12.10, no two of the labeled trees are isomorphic. The situation is
different, however, in Fig 12.11. Here the labeled trees TI and T2 are isomorphic,
although neither is isomorphic to 13. The adjacencies between the labeled vertices
of Ti and 12 are identical. On the other hand, whereas vertices B and C are
adjacent in Ti (and 12), such is not the case in 13.
4.
5.
A leaf is a vertex of degree 1.
Let vI be a leaf in a tree and start a path, as described in Proposition 12.2.1,
with vI. Since there are no circuits in a tree, the path VI, v2, V3, . . . obtained
in the proposition can be extended to a longer path as long as each vertex we
meet has degree at least 2. By finiteness, it must eventually terminate with a
second vertex of degree 1, that is, another leaf.
'The interested reader might consult Frank Harary's book, Graph Theory, Addison-Wesley (1969).

376 
Chapter 12 
Trees
A 
B 
B 
A 
A 
E
\ C
D
R
72 
T3
Figure 12.11 
Tl and T2 are isomorphic labeled trees which are not isomorphic to 73.
6. The tree in Fig 12.2 has 14 vertices and 13 = 14- I edges; the tree in
Fig 12.5 has 19 vertices and 18 = 19 -
edges.
7. No, it isn't. First note that when an edge is added to a tree, any circuit that is
produced must be a cycle. To see why, suppose the addition of edge a I v2 pro-
duces a circuit VI V2V3 ... v, VI. If this circuit is not a cycle, there is a repeated
vertex. This vertex must be Vl or v2; otherwise, the original tree contained a
circuit, contrary to fact. If the repeated vertex is vi (the argument in the case
of V2 is similar), then our circuit has the form VI V ... VI w... Vn 
Since the
edge VI v2 is not repeated in the circuit, v w... vvjI is a circuit in the original
tree, a contradiction. Thus, if an edge VI v2 is added to a tree, it is in fact only
a cycle which is produced. If two cycles were produced, there would be two
paths from VI to V2 in the original graph, contradicting Proposition 12.1.2.
8. Since there are two nonisomorphic trees with four vertices and in each of
these, all vertices have degree at most 4, there are two isomers of butane.
These are pictured in Fig 12.12. (Note the two trees of four carbon atoms and
compare with the two trees on the right of Fig 12.9.)
H
H 
H 
H 
H
I 
SC TC IC SC 
H
H 
H 
H 
H
Figure 12.12 
H
The symbol [BB] means that an answer can be found in the Back of the Book.
1. (a) [BB] Draw the graphs of all nonisomorphic unla- 
(b) [BB] How many isomers does pentane (C5H12)
beled trees with five vertices. 
have? Why?

12.3 Spanning Trees 
377
2. (a) Draw the graphs of all nonisomorphic unlabeled
trees with six vertices.
(b) How many isomers does hexane (C6 Hj4 ) have?
Why?
3. [BB] Suppose 5 is a graph whose vertices represent
cities in a country. An edge in 5 represents a direct (non-
stop) air flight between the corresponding cities. What
does a beta index less than I say about air travel in the
country? There are two possibilities to consider. (See
Exercise 5 of Section 9.1.)
4. Prove that a connected graph with n vertices is a tree
if and only if the sum of the degrees of the vertices is
2(n -
1).
5. [BB] Recall that a graph is acyclic if it has no cycles.
Prove that a graph with n vertices is a tree if and only
if it is acyclic with n -I 
edges.
6. Suppose 0 is an acyclic graph with n > 2 vertices and
we remove one edge. Explain why the new graph 
'
cannot be connected.
7. Suppose a graph g has two connected components, lT,
T2, each of which is a tree. Suppose we add a new edge
to g by joining a vertex of 'T1 to a vertex in 12. Prove
that the new graph is a tree.
8. (a) Let e be an edge in a tree T. Prove that the graph
consisting of all the vertices of T but with the single
edge e deleted is not connected.
(b) Without assuming the existence of vertices of degree
1, use the result of (a) and the strong form of mathe-
matical induction to prove that a tree with n vertices
has n -I 
edges.
9. Let T be a tree with n vertices v l, V2 .
v,. Prove that
the number of leaves in T is 2 + Zdeg v; >3 [deg vi -2].
10. [BB] Prove that the subgraph of a CkH2k+2 tree T con-
sisting of the k carbon vertices and all edges from T
among them is itself a tree.
11. (a) [BB] Suppose T is a tree with k vertices labeled C,
each of degree at most 4. Enlarge T by adjoining
sufficient vertices labeled H so that each vertex C
has degree 4 and each vertex H has degree 1. Prove
that the number of H vertices adjoined to the graph
must be 2k + 2.
(b) Can you prove (a) without assuming that T is a
tree?
12. We have noted in this section that there are n"-2 labeled
trees on n vertices.
(a) Verify this formula for n = 4 by drawing the
nonisomorphic unlabeled trees on four vertices and
discovering how many different labeled trees each
determines. (See Fig 12.9.)
(b) Repeat (a) for n = 5.
13.
14.
Prove that a tree with n > 2 vertices is a bipartite graph.
[BB] Find necessary and sufficient conditions for a tree
to be a complete bipartite graph. Prove your answer.
15. A forest is a graph every component of which is a tree,
equivalently, a graph without cycles. (See Exercise 11
of Section 12. 1.)
(a) [BB] Show that a forest with c components, each
containing at least two vertices, has at least 2c ver-
tices of degree 1.
(b) Is the result of (a) true without the stipulation
that each component contain at least two vertices?
Explain.
(c) Find a formula for the number of edges in a forest
with n vertices and c components and prove your
answer.
16. (a) [BB] Show that a tree with two vertices of degree
3 must have at least four vertices of degree 1.
(b) Show that the result of (a) is best possible: A tree
with two vertices of degree 3 need not have five
vertices of degree 1.
12.3 
SPANNING TREES
Figure 12.13 represents a map: The vertices correspond to towns and the labels on
the edges represent distances along existing gravel roads between adjacent towns.
The province plans to pave certain roads in such a way that one can get between
any two towns on pavement. What roads should be paved so as to minimize
the total length of pavement required? This problem, known as the Minimum
Connector Problem, asks, in the language of graph theory, for a minimum spanning
tree for the graph.

378 
Chapter 12 Trees
A
E
C
Figure 12.13 
D
A spanning tree of a connected graph 5 is a subgraph which is a tree and which
includes every vertex of g. A minimum spanning tree of a weighted graph is a
spanning tree of least weight, that is, a spanning tree for which the sum of the
weights of all its edges is least among all spanning trees.
The concept of spanning tree exists only for a connected graph 5 and, if g
has n vertices, any spanning tree must necessarily contain n -1 edges.
Finding a spanning tree in a connected graph g is not hard. If g has no
circuits, then it is already a tree, so g is a spanning tree for 5. If 5 contains a
circuit, then, just as in the proof of the second half of Theorem 12.2.3, we can
delete an edge (without deleting any vertex) so as to remove the circuit but leave
the graph connected. By repeating this procedure, we eventually find a connected
subgraph without circuits containing all the vertices of g, that is, a spanning tree.
Figure 12.14 shows a graph and three of its spanning trees. Spanning trees are
considered to be "different" if they make use of different edges of the graph.
Trees T1 and T2 in Fig 12.14 are isomorphic, but they are different spanning
trees of g.
C
b
a
5 
Ti 
T2 
2
A graph g and three of its spanning trees.
There is a procedure for obtaining additional spanning trees from a given
spanning tree. In Fig 12.14, 72 and 23 were obtained from Ti as follows: First
edge d was added to TI, giving the circuit abcd; removing a gives T2 and
removing b gives 73. Removing c would give a fourth spanning tree, and, if
we wanted more, we could return to Ti and add edge e, say, thereby complet-
ing another circuit abcef. Successively removing each of the edges a, b, c, and
f of this circuit would give four new spanning trees. Remember that adding
an edge to a tree always produces a circuit (Corollary 12.2.5). In Exercise 14,
we ask you to show how the procedure described in this paragraph can be
I 
6
Figure 12.14
l

12.3 Spanning Trees 
379
adapted to show that all the spanning trees in a graph can be obtained from a
given one.
How many spanning trees does a connected graph possess? For this, there
is a pretty result established in 1847 by the German physicist Gustav Kirchhoff
(1824-1887), who was studying electrical networks.
Readers who have had a first course in linear
algebra should know that a cofactor of a square 
+ +
matrix A is plus or minus the determinant of a 
+ -
submatrix obtained from A by deleting a row and
a column. There is one cofactor for each position
in the matrix. The choice of plus or minus for
the (i, j) cofactor is determined, respectively, by
whether or not there is a plus in position (i, j) of
the configuration shown at the right.
The "+" in position (3, 1), for example, indicates that the (3,1) cofactor is
the determinant of the matrix obtained by deleting row 3 and column 1, while the
"-" in position (2, 3) indicates that the (2, 3) cofactor is minus the determinant
of the matrix obtained by deleting row 2 and column 3.
(Kirchhoff) Let M be the matrix obtained from the adjacency matrix of a con-
nected graph g by changing all l's to 
l's and each diagonal 0 to the degree of
the corresponding vertex. Then the number of spanning trees of 5 is equal to the
value of any cofactor of M.
It is surprising that there is such a simple formula because it is often a difficult
problem to count graphs of a specified type. In particular, counting the number
of nonisomorphic spanning trees in a graph is a complicated affair.
The proof of Kirchhoff's Theorem (which is also known as the Matrix-
Tree Theorem) will not be included here.2 Instead, we content ourselves with
an illustration.
EXAMPLE 1 
Consider the graph whose adjacency matrix is
-O 
1 
1 
1-
A 
I 
A 
1 
A .
I 
I 
0 
O-
The matrix specified in Kirchhoff's Theorem is
3 
-1 
-2 
-l
M= -I 
-I 
2 
0 
.
-1- 
-I 
0 
2-
2 See Chapter 12 of J. A. Bondy and U. S. R. Murty, Graph Theory with Applications, North-Holland,
New York, 1981.

380 
Chapter 12 Trees
The (1, 1) cofactor of M is
+ det 
-I
-1 
Â°1 
2 
0 
- (-0) 
-1 
2 
(
2 
0 
= 3 
1 
2-10+ 
1) 
1 0
0 
2] 
012
= 3(4)+ 1(-2) + (-1)2 = 8
(expanding by cofactors of the first row). Kirchhoff's Theorem guarantees that all
the cofactors of M equal 8. For example, the (2, 3) cofactor of M is
3 -1 
-1
-detL -
1 
01 =- [ (-)(0) + 2(-3 -1)] =-(-8) = 8
-1 
-1 
2
(expanding by cofactors of the third column). Thus, there are eight spanning trees
in the graph. 
A
Draw the graph discussed in the previous example and show each of its eight
spanning trees.
How many spanning trees has the graph in Fig 12.14 and why?
Here is a remarkable application of Kirchhoff's Theorem.
The number of labeled trees with n vertices is n0 2
Proof 
After the vertices of the complete graph IC, are labeled, any spanning tree of KI,
is a labeled tree on n vertices. Conversely, any tree with these n vertices is a
spanning tree for K.n because IC, contains all possible edges.3 Thus, the number
of labeled trees on n vertices is the number of spanning trees for IC,, and the
latter number can be determined by Kirchhoff's Theorem.
The adjacency matrix of KI, contains O's on the diagonal and l's everywhere
off the diagonal. So the matrix whose equal cofactors count the number of trees
is the n x n matrix
/I-1 
I 
... 
-
1
-I 
n -I 
- -
I-
-I 
-1 
-1
-1 
-I 
-I-
-1 
-I 
n-I
The (1, 1) cofactor of M is the determinant of an (n - I) x (n- 
1) matrix which
looks exactly like M. Recall that the determinant of a matrix is not changed if
a row is added to another row. Adding to the first row in turn each of the rows
3Here Fig 12.15 may help. The tree on the left is a spanning tree of K.4 but not of 5 since BD is not
an edge in 9.
0
M

12.3 Spanning Trees 
381
below it gives the matrix
1 
1 
1
-1 
n 
n- -I
-1 
- I 
n- I
-
-i 
-1 
-1
I .
-1
1-1
and then adding the first row of this matrix to each of the rows below it gives the
matrix
1 
I 
.. .
n 
..
O n
0 0...
00
0
L- 0o
which is an upper triangular (n -
diagonal. Its determinant is nn-2.
A
BI,
C 
D
A
I-
01
O J
n -
1) x (n -1) 
matrix with n -
2 n's on the
I
A
C 
9 
D
9. The graph and its eight spanning trees are shown.
VI 
V4
V2 
V3 
Xd 
X 
D 
a
As spanning trees, the eight are all different, although they are partitioned
into just two isomorphism classes, the left six in one class, the rightmost two
in the other.
10. Labeling the graph as shown, the matrix specified in Kirchoff's Theorem
is
3 -1
-1 
3
0 
-1
-1 
0
-1 
-I
0
-1
3
1
-1
-1 
-I
0 
-I
-1 
-1
2 
0
0 
31'
1 
4
2 
3
The value of any cofactor is 24, so the graph in Fig 12.14 has 24 spanning
trees.
Figure 12.15
-
0 *.
[::s: X N
M=

382 
Chapter 12 Trees
The symbol [BB] means that an answer can be found in the Back of the Book.
1. [BB] This exercise concerns the graph 5 shown in
Fig 12.14. Delete edges a, c, and e in order to obtain a
new spanning tree T for g. Reinsert edge a to obtain
the circuit afg. Draw two other spanning trees for 5 by
removing first f and then g from this circuit.
2. For each of the graphs shown,
. find three spanning trees representing two isomor-
phism classes of graphs;
. find the total number of spanning trees.
(a)
(c)
(b)
3. Let e be an edge of the complete graph IC,~. Prove that
the number of spanning trees of KCn which contain e is
2n" 3.
4. [BB] How many labeled trees are there on n vertices,
for I <n <6?
5. EBB] Draw all the labeled trees on four vertices.
6. How many spanning trees does 1(7 have? Why?
7. (a) EBB] Draw all the spanning trees Of KC2,2 and indi-
cate the isomorphism classes of these. How many
isomorphism classes are there?
(b) Repeat (a) for K2,3.
8. Determine the number of spanning trees of the complete
bipartite graph 1C2,n.
9. EBB] Suppose some edge of a connected graphs
belongs to every spanning tree of 5. What can you con-
clude and why?
10. Let g be a tree. Describe all the spanning trees of g and
explain.
11. If 5 is a graph and e is an edge which is not part of a
circuit, then e must belong to every spanning tree of 5.
Why?
12. (a) [BB] Prove that every edge in a connected graph is
part of some spanning tree.
(b) Prove that any two edges of a connected graph are
part of some spanning tree.
(c) [BB] Given three edges in a connected graph, is
there always a spanning tree containing these edges?
Explain your answer.
13. Let 5 be a connected graph with at least two vertices.
Show that g has a vertex v such that 5 \ (v) is still
connected. Show that 5 has at least two vertices with
this property.
14. Suppose that To and T are two different spanning trees
for a graph G.
(a) [BB] Let e be an edge in T which is not in To.
Prove that there is an edge f in To which is not in
I such that (To U {e}) \ If } is a spanning tree.
(b) Describe a procedure for obtaining I from To.
15. Let Cn be the cycle with n vertices labeled 1, 2,.. 
.
n
in the order encountered on the cycle.
(a) Find the number of spanning trees for C, (in two
ways).
(b) Find a general formula for the number of spanning
trees for Cn U {e}, where e joins I to a (3 < a <
n -1).
16. [BB] How many graphs have n vertices labeled
VI, V2, .
v 
.
, vn and n -I 
edges? Compare this number
with the number of trees with vertices VI, 
v,, 
for
2 <n <6.
17. Show that any shortest path algorithm can be used to
construct a spanning tree for an unweighted connected
graph. (Caution! A shortest path algorithm requires a
weighted graph. How are you going to get started?)
12.4 
MINIMUM SPANNING TREE ALGORITHMS
In this section, we answer the Minimum Connector Problem suggested by the town
and road map in Fig 12.13. The problem requires us to find a minimum spanning
FXITMWTl

12.4 Minimum Spanning Tree Algorithms 
383
tree, and we'd like to find one efficiently. In theory, we could enumerate all the
spanning trees of a weighted graph and simply choose the tree of least weight,
but if the graph is at all complicated, this is not an easy chore. In this section,
we discuss two better ways discovered in the 1950s by J. B. Kruskal4 and R. C.
Prim.5 Both algorithms are in some sense "obvious." They produce a minimum
weight spanning tree an edge at a time, at each stage making the best choice of
next edge without thought to what has happened already or what will ensue. For
this reason, they are called greedy algorithms.
To find a minimum spanning tree in a connected weighted graph with n > I
vertices, carry out the following procedure.
Step 1. Find an edge of least weight and call this el. Set k = 1.
Step 2. While k < n
if there exists an edge e such that {e} U {el, e2 .
ek does not contain
a circuit, let eked be such an edge of least weight and replace k by
k + 1;
else output el, e2, .
ek and stop.
end while
We illustrate with reference to the graph of Fig 12.16. Kruskal's algorithm ini-
tially picks an edge of lowest weight. There are several edges of weight 2
and none with less weight. Any of these may be selected. Suppose we begin
with edge el = AJ. There still remain edges of weight 2, so we choose
any other, say e2 = GM. Among those edges which do not form a circuit
with el and e2 (at this point there are no edges which do), we choose one of
lowest weight, say DE, and call this e3. Continuing, we might select edges
AJ, GM, DE, MF, FE, LK, HJ, KM, CK, BC. At this stage, there remains an
edge (GL) of weight 4, but this edge would complete a circuit with LK, KM,
E
An application of Kruskal's algorithm might select, in this order, edges Aj, GM, DE, MF,
FE, LK, HJ, KM, CK, BC, JL, IA.
4J. B. Kruskal, Jr., "On the Shortest Spanning Subtree of a Graph and the Traveling Salesman Problem,"
Proceedings of American Mathematical Societs 7 (1956), 48-50.
5R. C. Prim, "Shortest Connection Networks and Some Generalizations," Bell SYstein Technical Journal
36 (1957), 1389-1401.
EXAMPLE 2
I
Figure 12.16
IN 
I

384 
Chapter 12 Trees
GM already selected, and so we choose an edge of weight 5, say JL, and another,
IA. Now, any of the remaining edges will complete a circuit with those selected
and so we must stop; the algorithm assures us we have the desired minimum
spanning tree. It has weight 39. 
A
Why does the algorithm work? Suppose g is the given connected graph and
TK is the subgraph produced by Kruskal's algorithm. The algorithm terminates
only when the inclusion of any edge of g not in T K produces a circuit in TK. We
must prove that TK is a spanning tree and that it is minimum.
First, note that TK contains every vertex of g. Why? Suppose to the contrary
that some vertex v is not in TK. Since g is connected, there exists some edge
incident with v. Adding this edge to TK cannot produce a circuit in TK since
none of the edges incident with v is in TK. Thus, the algorithm could continue,
a contradiction. By its construction TK contains no circuits. To see that it is
connected, let v and w be any two vertices of 'TK. There is a path in g from v to
w and any edge of this path not in TK can be replaced by a path in TK since the
inclusion of any edge of g not in TK produces a circuit. Thus, TK is a spanning
tree. It is more difficult to establish that TK is minimum.
Let Tm be a minimum spanning tree in G. We wish to show that the weight
of TK equals the weight of Tm. Suppose that g (hence, also Tm and TK) has n
vertices. Then TK contains n -1 
edges. Suppose these were determined by the
algorithm in the order el, e2, . . . , e,-I. If TK = Em, there is nothing to prove;
otherwise, we may suppose that there are edges of TK not in Tm. Let ek be the
first such edge. Since Tm is also a spanning tree, with an argument similar to that
used to solve Exercise 14(a) of Section 12.3, there is an edge e in Trr, different
from el and different from any of el, e2, . . , ek-l in the case k > 1, such that
T = (Tm U {ekd) \ {e} is a spanning tree. The weight of T is
(]) 
w (T) = w(Tm) + w(ek) - w(e) > W(Tm)
since Tm has minimum weight. Therefore, w(ek) > w(e).
If k = 1, w(ek) < w(e) since el was the first edge chosen and so has
minimum weight. So w(e) = w(ek). If k > l, the edges e, el, e2 ...
, ek- I do
not contain a circuit because they are all part of the tree Tm, Again, w(e) = w(ek);
otherwise, w(e) < w(ek) and the algorithm would have chosen e instead of ek.
In all cases, this makes T a minimum spanning tree since, by (1), its weight is
the same as the weight of the minimum spanning tree Eo. Also, T is "closer"
to TK than was Tm in the sense that T has edges el, ... , ek in common with
TK. Now if T = 'K, then TK is minimum (which is what we want to show);
otherwise, we apply to T and TK the procedure just applied to Tm and TK and
obtain another minimum spanning tree with yet another edge in common with TK.
Continuing in this way, we eventually arrive at a minimum spanning tree with
edges el, ... ., en. 
in common with TK (and so equal to TK), proving that TK is
indeed a minimum spanning tree.
What is the complexity of Kruskal's algorithm, in terms of comparisons? To
estimate the number of comparisons, we must first decide how we are going to
determine, at a particular stage, whether or not a given edge forms a circuit with
some of the edges already selected.

12.4 Minimum Spanning Tree Algorithms 
385
At each stage, Kruskal's algorithm has selected certain edges. Think of the
subgraph determined by these edges and all n vertices of 5. This subgraph has
a certain number of connected components, each of which is a tree. The first
such subgraph has n components; the final minimum spanning tree has just one
component. To begin, assign the labels 1, 2, . . ., n to the vertices of g. If the
first edge selected is uv, with u labeled i, v labeled j, and i < j, change the
label of v to i. The subgraph consisting of this edge and all n vertices has n -
I
components and, as at the outset, all the vertices in each component have the same
label. If we could preserve this feature of our labeling, then the edges eligible
for selection at a certain stage (that is, those edges not forming a circuit with
edges already chosen) would be simply those whose end vertices have different
labels.
Suppose, at a certain stage, vertices have the same label if and only if they lie
in the same component of the subgraph whose vertices are all those of g and whose
edges are those the algorithm has chosen so far, and that each such component is
a tree. We seek an edge which does not complete a circuit with previously chosen
edges, hence an edge with end vertices lying in different components. Select an
edge e = xy whose end vertices x and y have different labels and which has
least weight among such edges. If x is labeled k and y is labeled e and k < e,
then x belongs to a component all of whose vertices are labeled k and y belongs
to a component all of whose vertices are labeled e. By changing to k the labels
on all the vertices labeled e, the next subgraph once again has the property that
the vertices have the same label if and only if they lie in the same connected
component. Moreover, each new component is again a tree since a circuit cannot
be produced by joining two vertices in different components.
Describe the labels on the final minimum spanning tree.
This is our suggested procedure for ensuring no circuits. How many compar-
isons does it require? First sort the edges fi, f 2 . 
, fN of g so that w(fl) :
w(f 2 ) < ... 
< w(fN). Using an efficient algorithm such as the merge sort dis-
cussed in Section 8.3, this can be accomplished with O(NlogN) comparisons.
The algorithm selects el = fl, compares the labels of the ends of el, and changes
one of these labels. Then e2 = f2 and, after one more comparison, changes some
labels. The algorithm then looks at f3 and compares the labels of its end vertices
to see if it is eligible for selection. It continues successively to examine f4, f5, . . .
until n -
1 edges have been selected. Each time an edge is examined, one com-
parison of end labels is required. In all, this part of the algorithm could require as
many as N comparisons. Also, for each of the n -1 edges which are eventually
selected, it is necessary to check the labels on n - 2 vertices to see which must be
changed. This contributes a further (n - 1)(n -
2) comparisons. By the approach
outlined here, Kruskal's algorithm is O(N log N + N + n2) = O(N log N + n2).
In fact, the rule by which the labels of vertices are changed can be modified so
that Kruskal's algorithm can be completed with just O(N log N) comparisons.
(See Exercise 12.)
We turn now our attention to another algorithm, a popular one, for finding a
minimum spanning tree. Prim's algorithm is like Kruskal's insofar as it selects an
edge of least weight at each stage. This time, however, instead of merely guarding

386 
Chapter 12 
Trees
against circuits, the algorithm requires that the subgraph determined by selected
edges is always a tree.
B 
4 
C 
lo 
D
I 
E
6 
6K
20
Figure 12.17 
An application of Prim's algorithm might begin with vertex K and then select, in this order,
edges KL, LG, GM, MF, FE, DE, KC, BC, JL, AJ, JH, Al.
We illustrate Prim's approach as it would apply to the graph of Fig 12.16, which
we have shown again in Fig 12.17. Start at any vertex, say K, and select the edge
incident with K of least weight. Thus, we select edge KL of weight 3. The next
edge chosen is the edge of least weight adjacent to KL. Any of LG, KM, or
KC is eligible. Suppose we select LG. Then we select the edge of least weight
among those edges forming a tree with the two edges already selected (GM, for
instance). We continue to select, in succession, the edge of least weight among
those edges, as yet unselected, which form a tree with those already chosen and
continue until we have a spanning tree. You should verify that the spanning tree
shown in Fig 12.17 is one which Prim's algorithm might identify. 
A
To find a minimum spanning tree in a connected weighted graph with n > I
vertices, proceed as follows.
Step 1. Choose any vertex v and let el be an edge of least weight incident with
v. Set k = 1.
Step 2. While k < n
if there exists a vertex which is not in the subgraph T whose edges are
el , e2, . . . , ek,
. let ek+l be an edge of least weight among all edges of the form
ux, where u is a vertex of T and x is a vertex not in I;
. replace k by k + 1;
else output el, e2, .
ek and stop.
end while
Perhaps the best way to see that Prim's algorithm succeeds in finding a min-
imum spanning tree in a connected graph g is to prove that at each stage the
algorithm has found a tree which is a subgraph of some minimum spanning
tree. This is obvious at the beginning since any vertex is a tree and a sub-
graph of any (minimum) spanning tree of g. Suppose that after k steps, the
EXAMPLE 3
m1:111 I

12.4 Minimum Spanning Tree Algorithms 
387
algorithm has produced a tree T that is a subgraph of a minimum spanning
tree 'T0 for the graph. At the next stage, the algorithm produces another sub-
graph T% by adding a vertex x and an edge ux to T, where the weight of
ux is least among all edges joining vertices x 0 T to vertices u E I. Since
T contains no circuits and the additional vertex x is incident with only one
edge in T%, the subgraph T, also contains no circuits. It is also connected and
hence a tree. Why is it contained in a minimum spanning tree for 5? This is
surely the case if it is contained in Tm. If it is not contained in Tm, then the
subgraph Tm with edge ux adjoined contains a circuit, uxxlx2 ..
,U. Such a
circuit must contain an edge of the form yin, with y 0 T and w E T.6 It
follows that w(ux) < w(yuv), since yw was also eligible for selection by the
algorithm when ux was chosen. Thus, the spanning tree (T,, U {ux)) \ {yw),
having weight not exceeding that of T0 , is also a minimum spanning tree, and
it contains T1. By the Principle of Mathematical Induction, it follows that each
of the subgraphs produced by Prim's algorithm is a tree contained in a mini-
mum spanning tree. In particular, the last tree selected is itself a minimum span-
ning tree.
We now show how to implement Prim's algorithm with complexity O(n3)
and leave to the exercises an implementation which is O(n2). (See Exercise 13.)
Recalling that Kruskal's algorithm is O(N log N + n2), where N is the number of
edges, we see that the choice between Kruskal's and Prim's algorithms depends
primarily on the relative sizes of N and n.
Suppose g is a connected graph with n vertices. In Prim's algorithm, we
select a vertex v and find the minimum weight of the potentially n -
I edges
incident with v. For this, at most n -
2 comparisons are required. Suppose vu
is the edge selected. Next, we find the edge of least weight among those which
are incident with u or with v (excluding the edge vu). In the worst case, in
which every vertex is adjacent to each of these vertices, we would have to find
the minimum of 2(n -
2) numbers, a process requiring 2(n -2) 
-I 
compar-
isons. After k edges (and k + I vertices) have been selected, we seek the edge
of least weight among those incident with one of the vertices already selected.
In the worst case, the remaining n -
(k + 1) vertices are adjacent to each of
the first k + I and we must find the minimum of (k + l)(n -
k -
1) num-
bers. This would require (k + 1)(n- 
k -1) 
-
I comparisons. In all then, we
require
n-2 
n-2
(k + I)(n- k-1)-1 
=(nk 
+ n-k
2 -2k-2)
k=O 
k=O
comparisons. Recalling that
k 
n2 
and 
+n2 
n(n + 1)(2n + 1)
2: 
L=kan=E6
k=O 
k=O
6The edge yw is xx1 if xv e T: otherwise, xlx2 if x2 E T; and so on. This process eventually leads
to edge viy, as described, because the last vertex u is in T.

388 
Chapter 12 Trees
we find that the number of comparisons is
(n -2)(n - )+nn- 1)-(n -2) (n -1)(2n -3)
n 
2 
+ n(n 1)-6
2 
6
- 2(n 
2)(n -
1) - 2(n -1) = I1 3_-7 
+ 1.
2 
6 
6'+
The procedure is 0(n 3).
A Bound for a Minimum Hamiltonian Cycle
There is an interesting connection between the Traveling Salesman's Problem
(Section 10.4) and minimum spanning trees in a weighted graph. Recall that the
Traveling Salesman's Problem is to find a Hamiltonian cycle of minimum weight
in a weighted Hamiltonian graph. Our ability to find minimum spanning trees gives
us a way to determine lower bounds for the weight of a minimum Hamiltonian
cycle.
Suppose g is a weighted Hamiltonian graph with Hamiltonian cycle X.
Removing any vertex v of g (and the edges with which it is incident) gives
us a subgraph g' of g and a subgraph X' of N which is a spanning tree for Q'; in
fact, N' is a path through all vertices of 5 except v. It follows that the weight of
X is the weight of N' plus the sum of the weights of the two edges in N incident
with v. Hence,
w(N) > w(minimum spanning tree for A')
+ smallest sum of weights of two edges incident with v.
By choosing several different vertices v, we can obtain various lower bounds for
the weight of the Hamiltonian cycle N and so, in particular, for the weight of a
minimum Hamiltonian cycle.
Considering again the graph in Fig 12.16 (which is Hamiltonian), if we
remove vertex H (and the three edges with which it is incident), it is easily
checked that all the edges of the spanning tree indicated in Fig 12.16, except for
H J, comprise a minimum spanning tree for the subgraph, of weight 39 - 3 = 36.
The smallest two weights of edges incident with H are 3 and 5. Therefore, we
obtain 36 + 3 + 5 = 44 as a lower bound for the weight of any Hamiltonian cycle.
Suppose we remove K instead of H. This time, the heavy edges in Fig 12.18
form a minimum spanning tree in the subgraph, of weight 38. The two smallest
weights of edges incident with K are 3 and 4, so we obtain 38 + 3 + 4 = 45
as a lower bound for the weight of any Hamiltonian cycle, a better estimate than
before.
Find a Hamiltonian cycle in the graph of Fig 12.16. What is its weight?
11. Each time an edge is added, we changed the labels on its end vertices to the
lower of the two previous labels (and all the vertices in a certain component
to the lower as well). All vertices are eventually labeled 1.
S* 
-

12.4 Minimum Spanning Tree Algorithms 
389
I
E
Figure 12.18 
A graph 5 and a spanning tree for 5 \ {K) with weight 38.
12. IHJABCDEFMKLGI is a Hamiltonian cycle of weight 75. Note how the
path JA ... GI which results when H is removed is a spanning tree for the
subgraph without H, and how the path LG *.. FM which results when K is
removed is a spanning tree for the subgraph without K.
The symbol [BB] means that an answer can be found in the Back of the Book.
1. Use Kruskal's algorithm to find a spanning tree of min-
imum total weight in each of the graphs in Fig 12.19.
Give the weight of your minimum tree and show your
steps.
2. [BB; (a)] For each of the graphs of Exercise 1, apply
Prim's algorithm to find a minimum spanning tree. Try
to find a tree different from the one found before. Start
at vertex E in each graph, explain your reasoning, and
draw the tree.
3. [BB] Find a minimum spanning tree for the graph in
Fig 12.13. What is the smallest length of pavement re-
quired to connect the towns in this graph?
4. (a) Explain how Kruskal's algorithm could be modified
so that it finds a spanning tree of maximum weight
in a connected graph.
(b) Apply the modified algorithm described in (a) to find
a maximum spanning tree for each of the following
graphs and give the maximum weight of each.
i. EBB] the graph in Exercise l(a)
ii. the graph in Exercise I (b)
iii. the graph in Exercise l(c)
iv. the graph in Exercise 1(d)
v. the graph in Fig 12.16
5. Repeat Exercise 4 for Prim's algorithm. For each part
of (b), start at vertex A.
6. [BB] Explain how a minimum spanning tree algorithm
can be used to find a spanning tree in a connected graph
where the edges are not weighted.
7. How could a minimum spanning tree algorithm be used
to find a spanning tree in an unweighted graph which
excludes a given edge, assuming such spanning trees
exist?
8. (a) [BB] Suppose we have a connected graph 5 and
we want to find a spanning tree for 5 which con-
tains a given edge e. How could Kruskal's algorithm
be used to do this? Discuss both the weighted and
unweighted cases.
(b) Use Kruskal's algorithm to show that if Â£ is a con-
nected graph, then any (not necessarily connected)
subgraph which contains no circuits is part of some
spanning tree for 5. Consider both the weighted and
unweighted cases.
9. Answer Exercise 8 using Prim's algorithm instead of
Kruskal' s.
10. [BB] Prove that at each vertex v of a weighted connected
graph, Kruskal's algorithm always includes an edge of
lowest weight incident with v.
ffrTIM

390 
Chapter 12 
Trees
(a) [BB]
B
C
(b)
A
A 
2 
D
(C)
C 
6T
6 
F
Figure 12.19
F
B
13
C
F
21
E
(d)
Graphs for Exercise l.
11. (a) Prove that any minimum weight spanning tree in
a connected weighted graph can be obtained by
Kruskal's algorithm. [Hint: Look at the argument
on p. 384 showing that Kruskal's algorithm selects
a minimum spanning tree.]
(b) [BB] If all the weights in a connected weighted
graph are distinct, show that the graph has a unique
spanning tree of minimum weight.
12. In our discussion of the complexity of Kruskal's algo-
rithm, we suggested a certain system of labeling vertices
(p. 385). Consider the following modification.
Suppose that vertex x is labeled k, vertex y is labeled
e, and that we have just selected edge xy. Compare
the relative sizes of the components to which x and
y belong and change the labels of all vertices in the
smaller of these components to the label of the larger. (If
the components have equal size, label with the smaller
number.)
With reference to Example 2, p. 383, we begin with 13
components each containing a single vertex. After the
selection of AJ, component 1 contains two vertices-
A and J-and component 10 is empty; the remaining
components are unchanged. Figure 12.20 shows how the
components change as the edges GM, DE, MF, and
FE are successively selected.
(a) Continue the scheme shown in this figure to show
the relabeling of vertices until the spanning tree of
Fig 12.16 is obtained.
(b) [BB] Show that in the general case the number of
times the label on any vertex is changed is at most
lg 2 n, n the number of vertices of g.
(c) [BB] Show that Kruskal's algorithm can be imple-
mented with a number of comparisons which is
O(N log N), N the number of edges of g.
13. In the implementation of Prim's algorithm discussed on
p. 387 it is not really necessary at each stage to find the
minimum of so many numbers. Consider the following
alternative. Select any vertex v1 and label every other
vertex v with the weight of edge vvj if vvl is an edge
and oc otherwise. Then select edge v V2 such that the
label on v2 is a minimum. For each vertex v adjacent to
v2, change the label of v to the minimum of its old label
and the weight of edge vv2. Select V3 with minimum
label and add the corresponding edge (V3vj or V3v2).
The first graph shows the labels on the vertices of the
graph of Fig 12.16 just after Vl = K has been selected;
the second graph depicts the situation just after v2 has
been selected.
00 
6 
V 4  
8 
2
3o 424loÂ°
006 
00
E
l

12.4 Minimum Spanning Tree Algorithms 
391
Component 
Size 
Vertices
I 
I 
A
2 
1 
B
3 
1 
C
4 
I 
D
5 
1 
E
6 
1 
F 
add AJ
7 
I 
G
8 
I 
H
9 
1 
I
10 
I 
J
II 
I 
K
12 
1 
L
13 
1 
M
Component 
Size 
Vertices
1 
2 
A,J
2 
I 
B
3 
I 
C
4 
I 
D
add GM 
5 
I 
E
6 
I 
F
7 
2 
G,M
8 
I 
H
9 
1 
1
11 
I 
K
12 
I 
L
Component 
Size 
Vertices
1 
2 
A,J
2 
1 
B
3 
I 
C
add MF 
4 
2 
D, E
7 
3 
G,M,F
8 
I 
H
9 
1 
I
11 
I 
K
12 
I 
L
Figure 12.20 
Components not listed are empty.
Component
2
3
4
5
6
7
8
9
11
12
13
Size
2
Component
2
3
4
add DE 
6
7
8
9
11
12
add FE
Component
I
2
3
7
8
9
11
12
_0 6 
6 
V1 
8 
2
0 
25 
s 
V2 
4 
0
23
20 
6
(a) Show the labels just after V3 = G has been selected.
(b) Explain carefully how the process started here
should be continued to produce the next edge. Illus-
trate by showing the labels on the graph just after
V4 has been chosen.
(c) Show that the implementation of Prim's algorithm
described here is 0(n 2) (in terms of comparisons).
14. By considering the subgraphs determined by deleting
each of the vertices, find the best (greatest) lower bound
for the weight of a minimum Hamiltonian cycle. Find a
minimum Hamiltonian cycle.
A
B
E
15. This exercise concerns the graph in Exercise 1(a).
(a) [BB] Try to find a Hamiltonian cycle of lowest
weight. What is the weight?
Vertices
A, J
B
C
D
E
F
G
H
I
K
L
M
Size
2
2
1
2
Size
2
5
Vertices
A, J
B
C
D, E
F
G,M
H
I
K
L
Vertices
A, J
B
C
G, M, F, D, E
H
I
K
L

392 
Chapter 12 
Trees
(b) [BB] By removing vertex A, use the method dis-
cussed in this section to find a lower bound for the
weight of any Hamiltonian cycle.
(c) [BB] Repeat part (b), removing vertex B instead
of A.
(d) Try to improve (increase) the lower bounds found
in parts (b) and (c) by removing some other vertex.
16. Repeat Exercise 15 for the graph in Exercise l(b). Use
vertices D and F in parts (b) and (c).
17. Repeat Exercise 15 for the graph in Exercise 1(c). Use
vertices B and T in parts (b) and (c).
18. Repeat Exercise 15 for the graph in Exercise l(d). Use
vertices E and G in parts (b) and (c).
12.5 
ACYCLIC DIGRAPHS AND BELLMAN'S ALGORITHM
A (directed) graph is acyclic if it contains no (directed) cycles. For example, the
digraph on the left of Fig 12.21 is acyclic, but the one on the right is not-there
is a cycle around the outer vertices. Is there any easy way to see that there are
no cycles in g, on the left? This is where the vertex labels help. The digraph has
been labeled so that vivi is an arc only when i < j. For example, there are no
arcs of the form xvo, the only arc xv1 is vovl, the only arcs xv2 are with x = vo
and x = vI, and so on. So it is clear why there is no cycle: In any path, the
subscripts on the vertices vi must increase, so there is never an arc on which to
return to the first vertex. A labeling of the vertices such as that shown for g has
a special name.
V4
Vo
V3
5
V2 
VI
Figure 12.21 
The digraph on the left is acyclic; the digraph on the right is not.
A labeling vo, VI, . . .v, v,1 of the vertices of a digraph is called canonical if
every arc has the form vivj with i < j. We also refer to the list v(, vI 
, Vn-,
as a canonical ordering of the vertices.
Here's why a digraph with a canonical labeling of vertices must be acyclic: If
ViI vi2  
V Vik is a walk, then iI < i2 < * < ik, so such a walk cannot be closed. It
is interesting that the converse of this statement is also true. Any acyclic digraph
has a canonical labeling of vertices. To prove this, we require a preliminary
result.
Let S be a nonempty set of vertices of an acyclic digraph g. Then there exists
v X S such that Sv = {x E S I xv is an arc) = 0.
Proof 
We establish this result by contradiction. Assume the result is false. Thus, for
each v c S, there is an arc of the form xv with x C S. Let vo be any vertex in S
and let vivo be an arc, VI E S. There exists an arc v2v1, V2 c S, and, in general,
I 
0
= 4 4 LT, 
I

12.5 Acyclic Digraphs and Bellman's Algorithm 
393
6
Proof
having found vertices VI, V2, .
V 
.
, Vk in S with vi+I vi an arc, i = 1, 2, .. ., k-1,
there exists an arc vk+lVk with Vk+l E S. Since g has only a finite number of
vertices, eventually, Vk+4 C {vl, V2, ..
v, 
Vk}, say Vk+I = vi, I < i < k. If k is
minimal with this occurring, Vk+lvkvk- 
... vi is a cycle, contradicting the fact
that g is acyclic. 
I
This is key to the proof of a theorem which characterizes acyclic digraphs.
A digraph is acyclic if and only if it has a canonical labeling of vertices.
We gave the proof of sufficiency prior to the statement of Lemma 12.5.2. For
necessity, suppose g is an acyclic digraph with n > 1 vertices and vertex set
V. Applying the lemma to S = V, we obtain a vertex vo with the property that
there are no arcs of the form xvo. Applying Lemma 12.5.2 to S = V \ {vo}, we
obtain a vertex VI with the property that there are no arcs of the form xvl with
x E S; that is, the only possible arc xv, is with x = vo. Now apply the lemma to
S = V \ {vo, v I}. We obtain a vertex v2 with the property that the only possible
arcs of the form xv2 are VOV2 and VIV2. Continuing in this manner, we obtain
vertices vo, VI, . ... , v-l with the property that for any j, the only arcs xvj are
with x = vl and i < j. Thus vo, VI, . . .., .. .is 
a canonical labeling. 
I
We want to discuss a second algorithm to which the name of Richard Bellman
is attached.
Name the first algorithm described in this book to which Bellman's name is
attached.
The algorithm we have in mind takes as input an acyclic digraph whose
vertices have been labeled canonically, together with a specified vertex v, and
outputs the lengths of shortest paths from v to every other vertex. The algorithm
also describes the shortest path from v to any other vertex by means of a rooted
spanning tree. Remember that a root in a tree is simply a designated vertex. In a
digraph, the concept is stronger. There is only one possible root.
A digraph T is a rooted tree with vertex v as the root if the unoriented graph
(ignoring orientations of arcs) is a tree, if v has indegree 0, and v is the only such
vertex of T.
U
For example, if the edges of the tree shown in
Fig 12.2 are directed down, then we have a rooted
tree with "start" as root. On the other hand, the 
v
digraph to the right is not a rooted tree because
there is more than one vertex of indegree 0. 
w
In Proposition 12.1.2, we showed that any two vertices of a tree are joined
by a unique path. This is clearly not the case if the edges of the tree are oriented
(and we require paths to respect orientation). There is, however, a unique path
from the root to every other vertex.
-M0

394 
Chapter 12 Trees
..
IM 
SA
Proof
Proof
M 
A.
In a rooted (directed) tree with root v, there is a unique path from v to every other
vertex.
Uniqueness is straightforward: If there were two different directed paths PI, P2
from v to some vertex u, then, ignoring orientations, we would have two different
paths from v to u, contradicting the fact that the undirected graph T is a tree. We
now show existence of a directed path from v to any other vertex. So, let u be
a vertex of T different from v. Since indeg u 0 0, there is a directed edge u u.
If uI = v, we have a path from v to u; otherwise, since indegu1 I 
0, we have
a directed edge u2u1. Note that u2 7M u since the arc between u and uI is ulu.
Thus u2uIu is a path and if U2 = v we are done. In general, suppose k > 2 and
we have found a path UkUk- I ... 
uIu with no u, = v. Since indeguk # 0, there
is a directed arc Uk+lUk. Also, Uk+1 , {kU 
I, U2 .
, Uk because the undirected
graph T has no cycles. Thus Uk+lUk 
.. 
uu is a path and, if Uk+I = v, we have
a directed path from v to u. Since our tree is finite, this process cannot continue
indefinitely, so eventually some Uk =v.
In a rooted (directed) tree, every vertex other than the root has indegree 1.
Let T be a rooted tree with root v and suppose u :A v is a vertex with indeg u =# 1.
Since indeg u 0 0, we have indeg u > 2, so there are distinct arcs u u and u'1 U.
The proposition says there is a path P from v to u and also a path P' from v to
u'1. Thus we obtain two different paths from v to u (with final arcs u u and u' u).
This contradicts uniqueness of a directed path from v to u. 
I
Given a weighted acyclic digraph 5 with nonnegative weights and a canonical
labeling vo, VI, .. 
, v, 
I, to find the shortest paths from vo to every other vertex,
Step 1. Set do 
0 and di = o for i = 1,2,... ,n-1.
Set pi =-1 for i = 0,1, . . ., n-l.
Step 2. For t from I to n -
1,
let dt = min dj + w(vj, vt) I j = 0, . . .-, t- 
} and let Pt be a j which gives
this minimum.
As with previous shortest path algorithms, a final value dt = 0o simply
indicates that there is no directed path from vo to Vt.
Consider the acyclic canonically labeled graph 5 with arcs weighted as shown
on the left in Fig 12.22. We show the values of the dt and pt (p for predecessor)
at the beginning, and after each iteration of the loop in Step 2. The final values
of di and pl are 2 and 0, respectively. Thus the shortest distance to v, has length
2, and the last arc on a shortest path is v(vl. The final values of d2 and P2 are
4 and 1, respectively, showing that the shortest path to v2 has length 4, and the
last arc on the corresponding path is vI V2. The final values of d3 and p3 are 2
and 0, respectively, asserting the facts that a shortest path to V3 has length 2 and
VOV3 is the last arc on such a path. On the right in Fig 12.22, we show just those
arcs which are used last on shortest paths from Vt) to each vertex. It is not a

12.5 Acyclic Digraphs and Bellman's Algorithm 
395
V4
V3
V4
2 
> 
V3
V2
V2 
2 
vi
do, po 
di, pi 
d2, P2  
d3, p3  
d4, p4
Initially 
0,-I 
0o,-I 
o, 
-I 
o0,-I 
o0,-I
t= 
I 
0,-1 
2,0 
0o, -1 
0o,1 
o,-I
t =2 
0,-1 
2,0 
4, 1 
oo,-1 oo,-I
t =3 
0, -1 
2,0 
4, 1 
2,0 
o, -1
t=4 
0, -1 
2,0 
4, 1 
2,0 
3,3
y 
-
0 .
M
coincidence that these form a spanning tree rooted at vo. In the Exercises, we ask
you to explain why.
13. In Section 11.2, we met the Bellman-Ford shortest path algorithm.
The symbol [BB] means that an answer can be found in the Back of the Book.
1. For each of the digraphs in Fig 12.23, either show that
the digraph is acyclic by finding a canonical labeling of
vertices or exhibit a cycle.
2. Suppose vo, vj ... , v,, l is a canonical labeling of a
digraph G. What can be said about the indegree and
outdegree of v(, if anything? Explain.
3. [BB] Find an 0(n 2) algorithm which computes the inde-
grees of a digraph with n vertices. (The addition of two
numbers is the basic operation.)
4. (a) Describe an algorithm which finds a canonical
labeling for the vertices of an acyclic digraph.
(b) Find a Big Oh estimate for your algorithm in terms
of some reasonable basic operation (or operations).
(c) Write a computer program which implements your
algorithm.
5. The algorithm described in the proof of Theorem 12.5.3
can in fact be adapted to find a cycle in a digraph which
is not acyclic.
(a) [BB] Explain how this can be accomplished.
(b) Describe an algorithm which implements your idea.
(c) Write computer code which implements your algo-
rithm.
6. How many shortest path algorithms can you name? How
many of these can you describe?
7. [BB] Suppose IT is a rooted (directed) tree with n ver-
tices. How many arcs does T have? Why?
8. Let G be a connected graph and suppose we orient the
edges in such a way that the digraph we obtain has
a unique vertex of indegree 0. Must this digraph be a
rooted tree?
9. The following digraphs are acyclic, and canonical label-
ings are shown. Apply Bellman's algorithm to each
digraph in order to find the lengths of shortest paths
from vo to each other vertex. Find a shortest path to vt
and the predecessor vertex vp,.
vo
Figure 12.22
ff"TIMMM -
__ _ 
-

396 
Chapter 12 Trees
(a) [BB]
(b)
H
G
C
D
(c) 
F 
(d) 
F
Figure 12.23 
Digraphs for Exercise 1.
V 3 
-
I- 
A 
.
-1 
I 
-
| | 
.A 
.
I .
.
A 
-
10. Snow that Benman s algornnm worKs; mat is, it / is an
acyclic digraph with vertices v(, vj,1. . .. , v,.. 
canoni-
cally labeled, then the final value of d, is the length of
a shortest path from vo to v, and there is a path of this
length whose final arc is v,, v,.
11. [BB] Suppose we apply Bellman's algorithm to an acyc-
lic digraph with a canonical ordering of vertices. Explain
why the arcs vp, v, produce a spanning tree rooted
at vo.
12. Find the complexity of Bellman's algorithm (in terms
of additions and comparisons).
13. [BB] Explain how Bellman's algorithm can be mod-
ified to find the length of a shortest path to each v,
from a given vertex 
Vk 
which 
is not 
necessa-
rily vo.
14. [BB; (a)] For each of the digraphs which accompany
Exercise 9, find the shortest distance to each v, and the
corresponding value of pt,
i. when paths start at v1 and,
V7) 
U. wnen pains start at V2.
(a)
V6
(I
- I

Review Exercises 
397
S 
-,
1. Make a tree which displays all monotonically increas-
ing subsequences of 4. 7, 3, 9, 5, 1, 8. How many are
there?
2. Let 5 be a weighted graph with vertices V, 
W2 ....
W6
such that WjWk is an edge if and only if j + k is
odd, in which case the weight of the edge w1wV. is
(max{j, k})2 .
(a) Identify the unweighted graph described.
(b) Using a tree, solve the Traveling Salesman's Prob-
lem for g.
3. (a) Is it possible for a tree to have nine vertices and
degree sequence 4, 2, 22, 2, 2. 2, 1.1 ?
(b) is it possible for a tree to have nine vertices, two of
which have degree 5?
4. Prove that the following conditions are equivalent for a
tree T with n > 2 vertices.
i. T has an Eulerian trail.
ii. T has exactly two vertices of degree l.
iii. T has exactly n -2 
vertices of degree 2.
5. (a) Prove that up to isomorphism there is only one unla-
beled tree on seven vertices with a vertex of degree
5 and another of degree 2. Draw a picture of this
tree.
(b) Label the tree obtained in (a) in two different ways
so as to produce nonisomorphic labeled trees.
6. How many spanning trees has K:8? Why?
7. Use Kirchoff's Theorem to find the number of spanning
trees. Draw pictures of them all.
8. Is it possible for a graph to have exactly two spanning
trees? Explain.
9. In Exercise 8 of Section 12.3, you proved that the num-
ber of spanning trees of the complete bipartite graph
1C2,n is n2n-1. If e is an edge of IC2.n, how many of
these spanning trees contain e? Explain.
10. Use Kruskal's algorithm to find a minimum spanning
tree of the weighted graph shown. What is the weight
of a minimum spanning tree?
B 
I 
E 8 
H
2
A a8C
56
IF
2 
4
9
/3
D 
9 
G
12 
K
1 4
11. Repeat Exercise 10 using Prim's algorithm.
12. Let VI, v2, . . ., v,, denote the vertices of the complete
graph AC,, n > 3, and give edge vivj weight i + j. Find
a minimum spanning tree for this weighted graph and
the weight of such a tree.
13. Determine whether or not each of the digraphs shown
is acyclic by finding a canonical labeling of vertices or
exhibiting a cycle.
(a)
G
(b)
A
E
F
G
14. Change the direction of the arrows on JF and FG in
each digraph of Exercise 13 and answer the questions
again.
15. Can an acyclic digraph have two different canonical
orderings of vertices? Explain.
'11\1
7
a

398 
Chapter 12 
Trees
16. Given that the digraph is acyclic, find a canonical order-
ing vo, vl, .... of the vertices. Then find the lengths of
shortest paths from the root to all other vertices, spec-
ifying the predecessor vertex (as defined in Bellman's
algorithm) in each case when
(a) the root is vo,
(b) the root is V2.
A 
D
17. Repeat Exercise 16 using the digraph shown and root
vertices vo and vj.
B 
2 
C 
3 
D 
G E
A /2 
Io 
1 
1/2
i 
2 
I 
I 
H 
I 
G

e 
, 
.
O 
; 
I 
. X 
-
t. 
.
* 
-~--
* 
I
I
13.1 
DEPTH-FIRST SEARCH
In this short chapter, we describe a procedure called depth-first search, which is
simple, efficient, and the basis for a number of important computer algorithms in
graphs. It quickly tests whether or not a graph is connected, it produces a spanning
tree in the connected case, and it is the key to solving a problem about turning
graphs into digraphs.
Let g be a graph with n vertices.
Step 1. Choose any vertex, label it 1. Set k = 1.
Step 2. While there are unlabeled vertices
if there exists an unlabeled vertex adjacent to k, assign to it the
smallest unused label e from the set {1, 2, . . ., nI and set k = e
else if k = 1, stop;
else backtrack to the vertex e from which k was labeled and set
k = e
end while
Suggest a way that a machine could keep track of the labels 1, 2, . . ., n that have
been used as this algorithm proceeds.
When the algorithm terminates, there is a path from vertex 1 to each labeled
vertex which uses only edges required by the algorithm (Exercise 3). Thus, if the
algorithm successfully labels all n vertices of the graph g, the graph must have
been connected. The converse is also true (Exercise 4). Thus, depth-first search is
an algorithm which tests connectedness in a graph.
EXAMPLE 1 
We consider how the depth-first search algorithm might proceed with the graph
in Fig 13.1(a). Starting at vertex 1, one possible forward procedure in the
399
J J IIUCdLIUI 1Z
0*
Depth-First Search and
A 
.~, 
.
J-; 
.-.
M
.
.
.
-

400 
Chapter 13 
Depth-First Search and Applications
5 
6
3
3
(a) 
(b)
lo 
11 
5 6 
lo 
11 
5 6
9A 
9"1v~2 
1-3
3 
3
8 
48
14 1s
(c) 
(d)
l0 
11 
5 6
1 2 
1 3
3
8 
7 
4
14 15
(e)
Figure 13.1 
A depth-first search and the corresponding spanning tree.
depth-first search yields the labels shown in Fig 13.1(a). All the vertices adja-
cent to vertex 4 have been labeled and k = 4 0 1, so the algorithm backtracks
first to 3, the vertex from which 4 acquired its label. All vertices adjacent to 3
have also been labeled, so it backtracks to 2. Vertex 2 has an unlabeled adjacent
vertex. The smallest unused label to date is 5, so the algorithm would label 5
some vertex adjacent to 2, say the one shown. Vertex 5 has an adjacent unla-
beled vertex, so this gets labeled 6. The current assignment of labels is depicted
in Fig 13.1(b). The algorithm now backtracks until it finds a vertex with an
adjacent unlabeled vertex. It finds vertex I in this way and, since this vertex
has adjacent unlabeled vertices, the algorithm could conceivably assign labels
as far as 11, as shown in Fig 13.1(c). Since all vertices adjacent to II have
been labeled, the algorithm backtracks through vertex 10 to vertex 9 and then
assigns labels 12 and 13. From vertex 13, the algorithm backtracks to 12, then
to 9 (from which 12 received its label), then to 8, to 7 and to 1, after which
vertices 14 and 15 are labeled. Finally, the algorithm backtracks to 14, then to
1, and stops. The final labels are shown in Fig 13.1(d). Since 15 labels were
used and the graph had 15 vertices, the graph was connected, a fact admittedly
obvious by sight, but not to a computer. 
A
In addition to testing for connectedness, depth-first search has another use. If
the graph is connected, those edges which were used in the search form a spanning
tree for the graph (see Exercise 5). Applied to the graph in the preceding example,
the algorithm produces the spanning tree shown in Fig 13.1(e).

13.1 Depth-First Search 
401
For the graph given in Fig 13.1(a), carry out a depth-first search different from
the one in the text and draw the corresponding spanning tree. Start at vertex I as
before.
Show that the complexity function for depth-first search applied to a graph with
n vertices is 0(n 2). [Hint: Think of edges instead of vertices.]
One critical advantage that a person has over a computer in solving elementary
graph problems is sight. The reader with little experience writing computer pro-
grams may well wonder from time to time at the rather detailed way we describe
some "obvious" procedures. When a person, for instance, applies the depth-first
search algorithm to a simple graph which he or she can see, some ways of labeling
the vertices are much more sensible than others. Furthermore, a person can see
when all the vertices are labeled and hence stop without backtracking to vertex 1,
as required by the algorithm.
This section concludes by considering a problem which some readers may
have seen previously in a different context. Our solution involves moving without
thought around the vertices of a graph that is never fully seen, just the way a
computer does. On the other hand, when we stop, we can be confident that we
have indeed explored every vertex.
PROBLEM 2. 
An innkeeper has a full eight-pint flagon of wine and empty
flagons that hold five and three pints, respectively. The three flagons are unmarked
and no other measuring devices are available. Explain how the innkeeper can
divide the wine into two equal amounts in the fewest number of steps.
Solution. 
We imagine the graph whose vertices and edges are as follows: There
is a vertex labeled (a, b, c) if and only if it is possible for the innkeeper to hold,
with certain knowledge, a pints of wine in the eight-pint flagon, b pints in the five-
pint flagon, and c pints in the three-pint flagon. Thus, vertex (8, 0, 0) corresponds
to the initial state. There is an edge joining (a, b, c) and (a', b', c') if it is possible
to reach the state (a', b', c') from (a, b, c), or vice versa, by pouring all the wine
from one of the three flagons into another. For example, from the initial state,
the innkeeper can reach (3, 5, 0) by emptying the eight-pint flagon into the five-
pint flagon; thus, there is an edge between (8, 0, 0) and (3, 5, 0). We explore the
vertices of this graph with a procedure much like depth-first search. Continue
from (3, 5, 0). Emptying the remainder of the eight-pint flagon into the three-pint
flagon takes us to (0, 5, 3), emptying the five-pint flagon into the eight-pint flagon
takes us to (5, 0, 3), then emptying the three-pint flagon into the five-pint flagon
takes us to (5, 3, 0). (See Fig 13.2.)
We continue to visit, in order, vertices (2, 3, 3), (2, 5, 1), (7, 0, 1), (7, 1, 0),
(4, 1, 3), and finally (4, 4, 0). This state is what the innkeeper sought; it has been
reached in ten steps.
Now we backtrack, first to (4, 1, 3). Emptying the contents of the eight-pint
flagon into the five-pint flagon takes us to a previously labeled vertex on the path
to (4, 1, 3), namely, (0, 5, 3). If we could get from (0, 5, 3) to (4, 1, 3) in fewer
than seven steps, then the path to (4, 4, 0) could be shortened, but that issue
will be decided when we have backtracked to (0, 5, 3) and can be ignored for
now. Note, however, that we must be careful because an edge in our graph only

402 
Chapter 13 
Depth-First Search and Applications
(4,4.0)
(1,4,3)
(1,5,2)
(6, 0, 2)
(6, 2, 0)
(3, 2, 3)
1, 0)
1, 3)
4,0)
Figure 13.2 
The spanning tree for a problem of flagons and wine.
signifies that you can go from one of the end vertices to the other, not necessarily
in both directions (see Exercise 9). We continue to investigate vertices adjacent to
(4, 1, 3). Emptying the one pint remaining in the five-pint flagon into the eight-
pint flagon leads to (5, 0, 3), again a vertex already labeled. There are no other
vertices adjacent to (4, 1, 3), so we backtrack to (7, 1, 0). We leave it to you
to confirm that all vertices adjacent to those on the route from (7, 1, 0) back
to (3, 5, 0) have already been labeled lower on the path. The vertex (3, 5, 0),
however, has an adjacent vertex not yet labeled, namely, (3, 
2, 3). From this, we
move in order to (6, 2, 
0), (6, 0, 
2), (1, 
5, 
2), (1, 
4, 
3), and then (4, 
4, 
0). We have
found a route to the desired state which requires just seven steps. Backtracking
again from (4, 4, 0), we come first to (1, 4, 3) and find two adjacent vertices on
the first path-(5, 0, 3) and (0, 5, 3)-and hence two more routes to (4, 4, 0); for
example,
(8, 0, 0) --s (3, 
5, 0) -* 
(3, 
2, 3) --.
-* 
(1, 4, 3) -* 
(5, 0, 3) -* 
(5, 
3, 0) -* 
-- (4, 
4, 0).
Since each of these routes is (much) longer than the current shortest route, we do
not display them on the graph. Continuing to backtrack from (1, 4, 3), we find
that (1, 5, 2) is adjacent to (0, 5, 3) and (6, 0, 2) is adjacent to (5, 0, 3), but, as
before, we do not display these adjacencies since the routes they give to (4, 4, 0)
are longer than the current shortest route. Eventually we reach the initial vertex
(8, 0, 0) and discover that all adjacent vertices have been labeled, so we know
that all vertices of the graph have been visited. We also discover that we can
pass from (8, 0, 0) to (5, 0, 3) in one step, giving yet another route to the desired
vertex (4, 4, 0), a route requiring eight steps. The shortest route, however, remains
at seven steps. 
I
A 
-
g 
*.
1. Set up a one-dimensional array of length n (that is, a I x n matrix) with
all entries initially 0. When label k is selected, change component k of this
vector to 1.

13.1 Depth-First Search 
403
2. One possible answer is given, along with the associated spanning tree.
7 6
5
3
15 
14
12
10 9
7 
6 
15 
14
'4 
2
13
12
10 9
3. Depth-first search proceeds by deciding at each stage either to proceed along
a particular edge to the next unlabeled vertex or not to proceed (because the
edge joins two labeled vertices). If all edges incident with a given vertex
are rejected, then the algorithm backtracks. Hence, focusing our attention on
the edges, each edge need be considered at most twice. (Note that once an
edge has been rejected or used in backtracking, it is never considered again.)
Hence, the total number of steps is at most twice the number of edges, this
number being at most (') = 4n(n -1). So the complexity of depth-first search
is 0(n2).
The symbol [BB] means that an answer can be found in the Back of the Book.
1. For each of the following graphs, carry out a depth-first
search starting at vertex a. Show all labels and list those
used, in order, on the final backtracking. Highlight any
resulting spanning tree.
(a) [BB]
1 
2 
8
(a) [BB]
3 
7
(b)
(c)
(c) 
a 
(d)
(b) 
5 
4 
3
1 2
(d) 
I
144
13 
3~
Figure 13.3
2. In each of the graphs shown in Fig 13.3, a depth-first
search has labeled several vertices. Show all labels, list
in order those used on the final backtracking, and show
any resulting spanning tree.
3. Use mathematical induction to show that when the de-
pth-first search algorithm terminates, there is a path from
vertex I to each labeled vertex which uses only edges
required by the algorithm.
F71101 WE

404 
Chapter 13 
Depth-First Search and Applications
4. (a) [BB] Let v be a vertex in a graph G which is labeled
by the depth-first search algorithm. Prove that the
algorithm labels all the vertices adjacent to v.
(b) Prove that if 5 is connected, the depth-first algo-
rithm labels every vertex of 5.
5. Suppose the depth-first algorithm is applied to a con-
nected graph 5. Prove that the vertices of 5 together
with the edges used by the algorithm form a spanning
tree. [Hint: Exercises 3 and 4.]
6. [BB] Give an example of a connected graph 5 which has
a spanning tree not obtainable as a depth-first spanning
tree for g.
7. (a) [BB] Explain how to change the depth-first search
algorithm so that it can count the number of con-
nected components of a graph.
(b) Table 13.1 shows the adjacencies in a graph with
vertices 
V , V2, . . ., Vj3. Without drawing the
graph, apply a depth-first search and use the method
discovered in part (a) to determine the number
of components. Give the labels which the search
assigns to the vertices.
8. Given a full 12-ounce flagon of wine and two empty
flagons holding eight and five ounces respectively,
explain how to divide the wine into two equal six-ounce
portions in the fewest number of steps. The flagons are
unmarked. No other measuring devices are at hand.
9. [BB] In our wine-pouring Problem 2, if it is possible
to move from (a, b, c) to (a', b', c') in a single step,
is it always possible to move in the other direction,
(a', b', c') to (a, b, c), in a single step?
10. [BB) What might the phrase breadth-first search mean?
Design such a procedure.
11. [BB; (a)] Apply a breadth-first search to each of the
graphs shown in Exercise I (starting at vertex a in each
case).
12. Suppose the breadth-first search algorithm is applied to
an arbitrary graph 5.
(a) Prove that when the algorithm terminates, there is
a path from vertex I to every other labeled vertex
using only edges required by the algorithm.
(b) Prove that if 5 is connected, every vertex is labeled.
(c) Prove that if 5 is connected, then the vertices of g
together with the edges used by the algorithm form
a spanning tree.
Table 13.1
1 
2 
3 
4 
5 
6 
7 
8 
9 
10 
11 
12 
13
1 
0 
1 
0 
0 
0 
1 
0 
0 
0 
0 
1 
0 
0
2 
1 
0 
0 
0 
0 
0 
0 
0 
0 
0 
1 
0 
0
3 
0 
0 
0 
0 
0 
0 
0 
1 
0 
0 
0 
0 
1
4 
0 
0 
0 
0 
1 
0 
1 
0 
0 
0 
0 
1 
0
5 
0 
0 
0 
1 
0 
0 
0 
0 
0 
1 
0 
0 
0
6 
1 
0 
0000000 
0 
1 
0 
0
7 
0 
0 
0 
1 
0 
0 
0 
0 
1 
1 
0 
0 
0
8 
0 
0 
1 
0 
0 
0 
0 
0 
0 
0 
0 
0 
1
9 
0 
0 
0 
0 
0 
0 
1 
0 
0 
0 
0 
1 
0
10 
0 
0 
0 
0 
1 
0 
1 
0 
0 
0 
0 
0 
0
11 
1 
1 
0 
0 
0 
1 
0 
0 
0 
0 
0 
0 
0
12 
0 
0 
0 
1 
0 
0 
0 
0 
1 
0 
0 
0 
0
13 
0 
0 
1 
0 
0 
0 
0 
1 
0 
0 
0 
0 
0

13.2 The One-Way Street Problem 
4.
13. Let g be a connected graph with n > 2 vertices, one
of which is u. Show that g has a spanning tree with
the property that, for any vertex v, the edges of the
tree which connect u and v define a shortest path
between u and v. [Hint: Think of the spanning tree
produced by the breadth-first search algorithm. See
Exercise 10.]
14. Prove that the complete bipartite graph 1C2,n has the
property that every spanning tree is obtainable as a de-
pth-first search spanning tree if and only if n = 2, 3, 4.
13.2 
THE ONE-WAY STREET PROBLEM
Over the years, the amount of traffic on the streets of a small town has increased
enormously and the town planners are trying to decide what should be done. One
suggestion, looked upon favorably by certain members of the town council, is that
all streets be made one-way in order to simplify traffic flow. Certain minimum
requirements must be met, however. For example, it must remain possible to travel
from any point in town to any other point along one-way streets. Is there a way
of putting a direction on each of the streets so that this requirement is met? In
the language of graph theory, the one-way street problem asks, "Does a given
connected graph have a strongly connected orientation?"
Remember that a digraph is strongly connected if it is possible to move
from any vertex to any other vertex along arcs, in the proper direction. (See
Section 11.2.) For example, the digraph shown on the right in Fig 13.4 is strongly
connected.
w] f
Figure 13.4 
A graph and a solution to the One-Way Street Problem.
lip 
Ie
To orient or to assign an orientation to an edge in a graph is to assign a direction
to that edge. To orient or assign an orientation to a graph is to orient every edge in
the graph. A graph has a strongly connected orientation if it is possible to orient
it in such a way that the resulting digraph is strongly connected.
Figure 13.5 
A graph for which the One-Way Street Problem cannot be solved.
The graph on the left in Fig 13.4 has a strongly connected orientation (shown
beside it). On the other hand, Fig 13.5 displays a graph which does not have a
strongly connected orientation. The trouble is the middle edge; once this is given
a direction, flow will only be permitted from one side of that edge to the other,
but not in reverse. Such an edge is called a bridge or cut edge.
FT]Ell

' 
Â¶ter 13 Depth-First Search and Applications
A
= W2
= 
V2
A graph and a strongly connected orientation for it.
Solution. 
We begin by finding a circuit-for example, u U2U3u I -and 
orienting
the edges ul -- 
U2 -> 
U3 -a ul as shown (by single arrows) on the right of
Fig 13.6.
Next, we look for a vertex which is not in but which is adjacent to some
vertex of this circuit; Vl is adjacent to ul, for instance. Now we look for a circuit
containing vlu, 
say, vlV2(= Ul)v3(= U3)V4(= u2)v 5v6v7vSv1. We would like
to orient the edges of this circuit Vl -- 
... -
-v 
v1 as before, but
we cannot because edges v2V3 and V3V4 have already been oriented (and in the
opposite direction). So we do the best we can, orienting those edges of this circuit
not already assigned directions; we orient Vl -* 
v2, V4 -v.s V5, V5 -
V6, V6 -- 
V7,
V7 -* 
VS, V8 
VI (with double arrows). So far, our procedure has identified eight
vertices and oriented all but one of the edges between pairs of these. We orient
the omitted edge V8u2 arbitrarily, say u2 -+ v8. It is critical to observe (and we
leave it for you to check) that, at this stage, the subgraph whose vertices are the
ui and vj and whose edges are all edges of the given graph among these vertices
is strongly connected; you can get from any ui or vj to any other of these vertices
following edges in the direction of arrows.
Again, we next look for a vertex which is not in but which is adjacent to
some vertex in this subgraph; wl is adjacent to 1I, for instance. We find a circuit
which includes the edge wlvi, for example, w w2(= vIl)W3(= V8)w
4 (= V7)W5WI,
and orient the edges of this circuit which have not so far been oriented in the
direction this sequence of vertices indicates. We orient wl -- W2, W4 -W
and w5 -* 
w, as shown (with triple arrows). You should check that a strongly
connected orientation has now been assigned to the given graph. 
I
AC Ton km 
Or, =
Figure 13.6
An edge e of a connected graph 5 is called a bridge or a cut edge if the subgraph
g \ {el is not connected.
Let e be an edge which is not a bridge in a connected graph 5. Show that e is
part of a circuit.
We shall show that the presence of a bridge in a connected graph g is exactly
what prevents g from having a strongly connected orientation. First, however, we
illustrate a technique that will be useful in our proof.
PROBLEM 3. 
Find a strongly connected orientation for the graph on the left of
Fig 13.6.
1=

13.2 The One-Way Street Problem 
407
Proof
Figure 13.7
ffMM93MMMM
A graph has a strongly connected orientation if and only if it is connected and
has no bridges.
(-a) If a graph g has a strongly connected orientation, then g is surely connected.
Let e be an edge, say with end vertices u and v. If e is oriented in the direc-
tion u 
v when g is assigned its strongly connected orientation, then in this
strongly connected digraph, there is a directed path from v to u. In particular,
there is a path P in g from v to u which does not use e (definition of path).
So any walk in 5 which involves e can be replaced by a walk which avoids e,
simply by replacing e with P. It follows that g \ {e) is connected, so e is not a
bridge.
(.a-) Conversely, suppose g is connected and has no bridges. We first remark
that every edge of g must be part of a circuit. (See Pause 4.) Now we show that 9
can be assigned a strongly connected orientation by mimicking the approach we
used to solve Problem 3. Let C: u1u2 ... uu I be a circuit in g. (As noted, every
edge is part of a circuit, so some such circuit certainly exists.) For I < i < n -1,
assign edge uiui+l the orientation ui -* 
ui+l. Assign edge uul the orientation
-Un up. Then orient any other edges between vertices of C arbitrarily.
If C contains all the vertices of g, then clearly we have an orientation of 5
which is strongly connected, since C was strongly connected. Suppose, on the other
hand, that C does not contain all the vertices of g. Since g is connected, there must
exist a vertex vI not in C such that v Iu 
is an edge for some uj. Since every edge
in 5 is part of a circuit, vluj is part of a circuit vluj(= v2)v3 ... *vVI. Assign
V)V2 the direction vl -- 
V2 and vnvl the direction vm 
v,. Leave unchanged
the orientation of edges on the circuit which have already been oriented (that is,
those which are part of C), but orient any vivi+j not yet oriented in the direction
i- 
vi+1. Finally, assign an arbitrary orientation to any remaining edges among
vertices considered to this point. We have drawn two possibilities for the oriented
subgraph whose vertices are uI, . . ., uv, 
1 . . .V, m in Fig 13.7. The subgraph on
the right in this figure is intended to serve as a caution that, in addition to v2, some
other of the vertices V3, .
V., 
vm may coincide with vertices u . For example, in
the rightmost subgraph, if you wanted to get from Vk+J to Vk, you would have to
go first to vl, then to uj and around C to Vk.
Ul 
U2 
Us 
U2
Un 
V3 
an 
VC 
v
C 
U 
C 
U, 
V~ 
k+
', 
V2 
UI 
f 
i- 
\
I 
-V2 
=
VM
V1
In Pause 5, we ask you to verify the following crucial fact: The subgraph of
vertices and edges identified so far is strongly connected. Thus, if this subgraph is
the entire graph, we are finished. Otherwise we find a vertex wl which is not part
of but which is adjacent to some vertex in this subgraph, find a circuit containing

408 
Chapter 13 
Depth-First Search and Applications
this vertex, and orient edges as before. This procedure must terminate, and with
a strongly connected orientation. 
I
Establish the fact mentioned toward the end of the preceding proof.
Since the identification of circuits in a graph is difficult without the advantage
of sight, the following algorithm, based upon depth-first search, is important.
Suppose 5 is a connected graph without bridges. To produce a strongly connected
orientation, proceed as follows.
Step 1. Carry out a depth-first search in
this produces.
g and let T be the spanning tree which
Step 2. For each edge e of g, consider the labels i and j of its ends. Suppose
<.
i <yj.
If e is in T, orient it i -j;
else orient it j -* 
i.
3
Figure 13.8 
A depth-first search, a spanning tree, and a strongly connected orientation.
We apply this algorithm to the graph in Fig 13.6, show in Fig 13.8 the labels
which a depth-first search might yield, and, with heavy lines, show the corre-
sponding spanning tree as well. For each edge ij with i < j, the algorithm
orients i -+ 
j if the edge is part of the tree and otherwise j -, i. Edge 45, for
example, is in the tree, so it is oriented 4 -* 
5; on the other hand, edge 18 is not
in the tree, so it is oriented 8 -+ 
1.
Use Algorithm 13.2.4 to exhibit a strongly connected orientation for the graph in
Fig 13.1 based upon the depth-first search shown in that figure.
Suppose g is a connected graph without bridges. To show that our algorithm
actually works, it suffices to show that it orients the edges of g in such a way
that there is a directed path between 1 and k (in each direction) for all k. For this,
we use the strong form of mathematical induction on k.
The result is immediate if k = 1, so assume that k > I and that for all
l, 1 < e < k, there is a path from 1 to f and from Â£ to 1 which respects the
orientation of edges. We must show that such paths exist between I and k.
Vertex k acquired its label because it was adjacent to one which was already
labeled, say e. Since the depth-first search algorithm always chooses the smallest
available label, we have f < k. By the induction hypothesis, there is a directed
A 
A 
A

13.2 The One-Way Street Problem 
409
path from l to e. Since edge fk is part of the depth-first search spanning tree and
since e < k, the edge incident with f and k is oriented f -* 
k; thus, there is a
directed path from 1 to k. It is more difficult to show that there is also a directed
path from k to 1.
First assume the depth-first search algorithm starts backtracking immediately
after labeling k (because all vertices adjacent to k have already been labeled).
Note that there must be some vertex adjacent to k in addition to e; otherwise, Â£k
would be a bridge. Suppose this other vertex has been labeled t where, necessarily,
t < k. Since edge tk is not part of the spanning tree, Algorithm 13.2.4 orients it
k -* 
t. By the induction hypothesis, there is a directed path from t to 1. Together
with kt, we obtain the desired directed path from k to 1.
On the other hand, suppose the algorithm
does not backtrack after labeling k. Then it will 
k + s
proceed from k to an adjacent vertex, which will
be labeled k + 1, and, if there is an unlabeled 
.
k+- 
I
vertex adjacent to k + 1, to k + 2. Eventually, 
k +i
the algorithm backtracks from a vertex labeled
k+s, s > 1, to k, all vertices adjacent to vertices 
k + I
on this path already labeled. It is important to 
k
note that there is a directed path from k to each
vertex k + i, 0 < i < s. Thus, if any of these
vertices is adjacent to a vertex labeled t with t < k, the induction hypothesis
makes it easy to establish the existence of a directed path from k to 1. On the
other hand, if the only vertices adjacent to vertices of the form k + i are also of
this form, then there is no path in g from k + s to e which avoids the edge k e,
so kU would be a bridge, a contradiction.
As a concluding remark, we mention in passing that Algorithm 13.2.4 can
be applied to give an orientation to any connected graph g although, if 5 has
bridges, the result will not be strongly connected.
4. Let u and v denote the end vertices of e. Since G \ {e} is connected, there
is a path in g \ le) from v to u. This path, followed by uv, is a circuit in g
containing e.
5. We must show that it is possible to get from any ui or vj to any other ui or
vj following edges in the assigned directions. We can get from any ui to any
other uj along the circuit C. Next, we show that there is a directed path from
each vi to vi+I and so, since v,, v I is oriented v,1  
v l, there is a directed path
from any vi to any vj. The orientation vI -+ v2 provides a directed path from
VI to V2 and, for any i = 2, 3, .. 
, m -
1, if the orientation is not vi -vi+l,
then both the vertices vi and vi+l are part of the circuit C, which we can use to
find a directed path from vi to vi+l. In any case, there is always some directed
path from each vl to vi+I as asserted. This also shows that we can pass from
C to any vi via the directed edge uj (= v2)v3. Since we can move in the other
direction via vI v2(= Uj), it follows that the subgraph is strongly connected.
'The second last vertex on a path to e avoiding kU is k + j and, by assumption, e is not adjacent to
k + j since f < k + j.
1

410 
Chapter 13 
Depth-First Search and Applications
6. For each edge ij with i < j, we
orient i -* j if the edge is in the
spanning tree and otherwise
14 
1
The symbol [BB] means that an answer can be found in the Back of the Book.
1. [BB; (a)] For each of the graphs in Exercise I of
Section 13.1, assign an orientation based on your depth-
first search and state whether or not this orientation is
strongly connected.
2. Find strongly connected orientations of the graphs corre-
sponding to the five so-called Platonic solids: the cube,
tetrahedron [BB], octahedron, icosahedron, and dodeca-
hedron. (See pp. 314, 317, and 415.)
3. (a) [BB] Does there exist a strongly connected orienta-
tion for the Petersen graph? (See p. 312.) If so, find
one.
(b) Must a Hamiltonian graph have a strongly connected
orientation? Explain.
(c) What about the converse of (b)? Explain.
4. How many bridges does a tree with n vertices have?
Explain.
5. [BB] Can an Eulerian graph have bridges? Explain.
6. [BB; (-a)] Prove that an edge e in a connected graph 5
is a bridge if and only if there are vertices u and v in 5
such that every path from u to v requires the edge e.
7. (a) [BB] Show that any connected graph can be ori-
ented so that the resulting digraph is not strongly
connected.
(b) Let g be a connected graph with all vertices of
even degree. Can 5 be oriented so that the resulting
digraph is strongly connected? Explain.
8. [BB] Let 9 be a graph with a strongly connected ori-
entation assigned to it. Suppose that the direction of the
arrow on each edge of 9 is reversed. Is the new digraph
still strongly connected? Explain.
9. Answer true or false and explain your answers.
(a) [BB] A graph has a strongly connected orientation
if and only if every edge is part of a circuit.
(b) A graph with a strongly connected orientation has
no vertices of degree 1.
(c) A connected graph with no odd vertices has a stron-
gly connected orientation.
10. Let e = uv be a bridge in a connected graph 9. Let
9 1 be the subgraph of 9 \ {e} whose vertices are those
from which there is a path to u and whose edges are all
the edges of 9 among these vertices. Let 92 be defined
analogously interchanging the roles of u and v.
(a) [BB] Prove that there is no path between u and v
in g \ {e).
(b) Prove that 91 and 92 have no vertices in common.
(c) Prove that 91 is a (connected) component of 9 \ {e),
that is, a maximal connected subgraph of g \ {e).
(In Fig 13.5, 91 and 92 are the two triangles. This
exercise shows that Fig 13.5 shows what happens in
general when there is a bridge in a graph.)
11. [BB] Faced with the undeniable fact that his town's
street system does indeed have some bridges, Mayor
Murphy decides that all bridges should remain two-way
streets, but all other streets should be made one-way.
Can this be done so as to allow (legal) travel from any
intersection to any other?
Â°0 
I1
5 
6
9
8
ff Vfz=

Review Exercises 
411
12. Explain why the depth-first search algorithm can be used
to find all bridges in a connected graph. Design a pro-
cedure to find all such bridges which is O(n3 ) (where n
is the number of vertices).
13. Let 5 be a graph with n vertices and m edges.
(a) Assuming mn > (n 
1)(n-2) + 1, show that 5 can be
given a strongly connected orientation. (You may
assume that the condition implies that 5 is con-
nected. See Exercise 22 of Section 10.1.)
(b) Need g have a strongly connected orientation if m >
(n l)(n-2) ?
2
* 
.
* 
.
S
1. In each of the following graphs, a depth-first search has
started and several vertices have been labeled. Finish
each search, show all labels, list in order those used on
the final backtracking, and show the resulting spanning
tree.
(a)
(b)
8
2. Let v be an arbitrary vertex and e an arbitrary edge of
a connected graph G. Show that it is always possible
to carry out a depth-first search beginning at v which
includes e as part of the resulting spanning tree.
3. Assign an orientation to each of the graphs in Exercise I
based upon your depth-first search and state whether or
not this orientation is strongly connected.
4. Which graphs have the property that it is possible to start
at some vertex v and carry out a depth-first search which
labels all vertices without ever backtracking? Prove your
answer.
5. If a connected graph 5 has a bridge e, show that every
spanning tree of 5 must contain e.
6. Is it possible for a Hamiltonian graph to contain a
bridge? Explain.
7. (a) Is the orientation which appears in a tournament
always strongly connected? Explain.
(b) Is it possible to change the directions of some of
the arrows in a tournament and achieve a strongly
connected orientation? Explain. Assume the graph
has at least three vertices.

\ 
.
' 
INDUIS it1'1.' 
k 
"l
'\ 
- i 
-, 
I
14
Planar Graphs and
Colorings
14.1 
PLANAR GRAPHS
The Three Houses-Three Utilities Problem posed in Chapter 9 asks whether or
not it is possible to draw the complete bipartite graph K3,3 without any crossovers
of edges. (See Fig 14.1.)
Figure 14.1 
The graph 1C3,3, representing three houses and three utilities.
Thinking of the edges of this graph as pieces of string and the vertices as
knots, the question is whether or not the "net" can be arranged without string
crossovers. In the language of graph theory, the problem asks if KJ3,3 is planar.
S 
0
A graph is planar if it can be drawn in the plane in such a way that no two edges
cross.
In this chapter (and abusing terminology) we find it convenient to refer to a
picture of a graph in which there are no crossovers of edges as a plane graph.
Thus, a planar graph is one which can be drawn as a plane graph. There are five
places where edges in the graph g of Fig 14.2(a) cross; nevertheless, 5 is planar
because it can be drawn as a plane graph, as shown in Fig 14.2(b).
Figure 14.2(c) shows g with all edges drawn as straight line segments. In
fact, this is possible for any planar graph' and so we lose no generality if planar
graphs are drawn as plane graphs with straight edges.
'This result is due to 1. Fary, "On Straight Line Representation of Planar Graphs," Acta Scientiarum
413
e
1. . ,
I   . .
.
.
.
I 
I
t
.k 
.,
0
W
*R,
A ;'
, 
I 
. ,

414 
Chapter 14 Planar Graphs and Colorings
V4
VI 
V5 
(v1 
V5
V2
13
V2 
R1 
I2 
4
03 
R4
R
V2
g drawn as a plane graph 
5 drawn as a plane graph
with straight edges
Figure 14.2 
(a) 
(b) 
(c)
A plane graph divides the plane into various connected regions, one of which
is called the exterior region. Every region, including the exterior, is bounded by
edges. The graph in Fig 14.2(b) divides the plane into six regions, R6 being the
exterior region. The boundary of R2, for example, consists of the edges VI V3,
V3V4, and V4VJ. The boundary of R6 is v2v4, V4V5, and VsV2. We require that
every edge must be the boundary of some region. Thus, in Fig 14.3(a), the edge
labeled e is part of the boundary of region R, while in Fig 14.3(b) it is part of
the boundary of the exterior region.
e
Figure 14.3 
(a) 
(b) 
(c)
A tree determines just one region in the plane, the exterior region, and every
edge of the tree is part of the boundary of this region. [See Fig 14.3(c).]
Consider the plane graph shown on the left of Fig 14.4.
(a) How many regions are there?
(b) List the edges which form the boundary of each region.
(c) Which region is exterior?
Answer these same questions for the graph on the right as well.
Planar graphs were first studied by Euler because of their connections with
polyhedra. A convex regular polyhedron is a geometric solid all of whose faces
are congruent. There are in all just five of these-the cube, the tetrahedron,
the octahedron, the icosahedron, and the dodecahedron-and they are popularly
known as the Platonic solids because they were regarded by Plato as symbolizing
earth, fire, air, water, and the universe, respectively.
Mathematicarum (Szeged) 11 (1948), 229-233. A proof also appears in Combinatorial Problems and Exer-
cises by Ldszl6 LovAsz, North-Holland (1979) (Problem 5.38).
V5

14.1 Planar Graphs 415
a
I
Figure 14.4 
g 
h
When we discussed Sir William Hamilton's "World Tour" in Section 10.2,
we showed how to associate with the regular dodecahedron a planar graph whose
edges and vertices correspond to the edges and vertices of the solid and whose
regions correspond to the faces of the polyhedron. In the exercises of Section 10.2,
we introduced planar graphs corresponding to the cube and the regular icosahe-
dron. As we said at the time, we can obtain the planar graph associated with a
particular polyhedron by imagining that the bottom face is stretched until the object
collapses flat. Figure 14.5 shows the plane graphs associated with the tetrahedron,
the cube, and the octahedron.
Figure 14.5 
The tetrahedron, cube, and octahedron, and their corresponding planar graphs.
In 1752, Euler published the remarkable formula
V - E + F =2, 1
which holds for any convex polyhedron with V vertices, E edges, and F faces.2
(A polygon is convex if the line joining any pair of nonadjacent vertices lies
entirely within the polygon.) For the cube, for instance, V = 8, E = 12, and
F = 6; for the tetrahedron, V = F = 4 and E = 6. Euler's formula also works
for any plane graph, with regions replacing faces. For example, the plane graph
in Fig 14.2 has V = 5, E =9, R = 6, so, V - E + R =5 - 9 + 6 =2.
Let G be a connected plane graph with V vertices, E edges, and R regions. Then
V - EÂ£+ R =2.
We use induction on E. If E = 0, then V = R = I (because 5 is connected) and
the formula is true. Now assume the formula holds for connected plane graphs
2L. Euler, "Demonstratio nonnullarum insignium proprietatum quibus solida hedris planis inclusa sunt
praedita," Novi Commentarii Academiae Scientarium Petropolitanae 4 (1752/53), 140-160.
Proof
IMMENUMIMME

416 
Chapter 14 Planar Graphs and Colorings
with E -
I edges, where E > 1, and that g is a connected plane graph with
E edges, V vertices, and R regions. We must show that V -
E + R = 2. If
g contains no circuits, then 5 is a tree and so E = V -
I by Theorem 12.2.3.
Since R = 1, we have V-E 
+ R = V-(V 
-1) 
+ I 
2 as desired. Suppose,
on the other hand, that 5 does contain a circuit C. Let e be any edge of C and
consider the subgraph 
( 
\ {e}, which is a plane graph and still connected. The
circuit C determines a region of 5 which disappears in 9 \ {e}. So 9 \ {e} contains
R - 1 regions, all V vertices of 5, and E -I edges. By the induction hypothesis,
V-(E -1) 
+ (R -1) 
= 2; that is, V-E + R = 2. 
I
Show that this theorem is not necessarily true if "connected" is omitted from its
statement.
We are now ready to solve the Three Houses-Three Utilities problem. It
turns out not to be possible to connect three houses to three utilities without
crossovers of connection lines.
k3,3 is not planar.
We provide a proof by contradiction. The graph Kc3,3 has six vertices and nine edges.
If it is planar, it can be drawn as a plane graph with R regions. Since V -E + R = 2,
we have R = 5. Now count the number of edges on the boundary of each region
and sum over all regions. Suppose the sum is N. The point to observe about 1(3,3
is that it contains no triangles (every edge joins a house to a utility; there are no
edges from house to house or utility to utility). Therefore, the boundary of each
region contains at least four edges, from which it follows that N > 4R = 20. On
the other hand, in the calculation of N, each edge was counted at most twice, so
N < 2E = 18. This contradiction establishes the corollary. 
I
Find the number N defined in this proof for the graph on the left of Fig 14.4.
Verify that N < 2E. Give an example of an edge which is counted just once.
Intuitively, a graph with a lot of edges cannot be planar since it will be
impossible to avoid crossovers when drawing it. Thus, we expect planar graphs to
have relatively few edges. The next theorem makes this statement more precise.
Let 9 be a planar graph with V > 3 vertices and E edges. Then E < 3V -
6.
Proof 
We give an argument for the case that 9 is connected and ask you in Exercise 19
to prove the general case.
If V = 3, then E < 3 and the theorem holds. So we assume that V > 3. Thus,
we may also assume that E > 3 (otherwise, the result is clearly true). Draw 9 as a
plane graph with R regions. Then, as in the proof of Corollary 14.1.3, we count the
number of edges on the boundary of each region, sum these numbers, and denote
the sum N. As before, N < 2E. Also, since each boundary contains at least three
edges, N > 3R. Hence, 3R < 2E. Theorem 14.1.2 says that V -
E + R = 2.
Therefore, 6 = 3V -
3E + 3R < 3V -
3E + 2E = 3V -
E and the result
follows. 
I
Proof
-3

14.1 Planar Graphs 
417
1C5 is not planar.
Proof 
In k5, V = 5 and E = (5) = 10 (since every pair of vertices is joined by an
edge). Since it is not true that E < 3V -6, 
KC5 cannot be planar. 
I
In a graph where the number of edges is not too large, it is reasonable to
expect some restrictions on vertex degrees. In Exercise 20, we ask you to show
that a planar graph with at least four vertices has at least four vertices of degree
d < 5. For the present, we content ourselves with a weaker statement.
---- 
,
Every planar graph contains at least one vertex of degree d < 5.
Proof 
Suppose deg vi > 6 for every vertex vi. Since E deg vi = 2E, we would have
2E > 6V and hence E > 3V > 3V -6. This contradicts E < 3V -6. 
I
It was the Polish mathematician Kazimierz Kuratowski (1896-1980) who
discovered the crucial role played by 1C3,3 and k5 in determining whether or not
a graph is planar. (The 1C in 1C, and ICm,, is in Kuratowski's honor.) First, since
these graphs are not planar, no graph which contains either of them as a subgraph
can be planar. Second, any graph obtained from either 1C3,3 or 1(5 simply by
adding more vertices to edges cannot be planar either.
I 
S
EXAMPLE 1
Two graphs are homeomorphic if and only if each can be obtained from the same
graph by adding vertices (necessarily of degree 2) to edges.
The graphs g1 and g2 in Fig 14.6 are homeomorphic since both are obtainable
from the graph g in that figure by adding a vertex to one of its edges. 
A
5
Figure 14.6 
Two homeomorphic graphs obtained from 5 by adding vertices to edges.
EXAMPLE 2
EXAMPLE 3
In Fig 14.7, we show two homeomorphic graphs, each obtained from 1(5 by adding
vertices to edges of IC5. (In each case, the vertices of IC5 are shown with solid
dots.) 
A
Any two cycles are homeomorphic. Why?
Two graphs are homeomorphic if one is simply obtained from the other by adding
vertices to edges; that is, the third graph mentioned in Definition 14.1.7 may be
one of the two given graphs. For instance, graphs g1 and g2 in Fig 14.8 are
--
~
MM

418 
Chapter 14 
Planar Graphs and Colorings
Figure 14.7 
Two homeomorphic graphs obtained from IC5.
homeomorphic because g2 is obtained by adding two vertices (the solid dots) to
edges of gl. 
A
When we say "adding vertices to edges," we do not include the possibility of
adding a vertex where edges cross over each other, for this is achieved by adding
a vertex to each edge and then joining these two vertices together. Joining vertices
is not allowed. For example, graphs g1 and g3 of Fig 14.8 are not homeomorphic.
N
NO
Figure 14.8 
51 is homeomorphic to 52 but not to 93.
S.
EXAMPLE 4
The following theorem characterizes planar graphs in a remarkably simple
way. The proof in one direction is straightforward and was given earlier: A graph
which contains JC5 or JC3,3 cannot be made planar by adding vertices to edges.
The proof of the converse is more complicated and will be omitted.
(Kuratowski 3) A graph is planar if and only if it has no subgraph homeomorphic
to K5 or /C3,3.
The graph 5 in Fig 14.9 is not planar. By deleting two edges, we obtain a sub-
graph S which is /C3,3 (the bipartition sets are the sets of hollow vertices and
solid vertices) except for one vertex (the tiny one) added to an edge. Since S is
homeomorphic to 1C3,3, g is not planar, by Kuratowski's Theorem. 
A
g
S
Figure 14.9 
A nonplanar graph 5 and a subgraph S homeomorphic to K 3, 3.
3K. Kuratowski, "Sur le Problene des Courbes Gauches en Topologie," Fundamenta Matheniaticae 15
(1930), 271-283.
1

14.1 Planar Graphs 
419
The graph on the left in Fig 14.10 is not planar because the subgraph shown on
the right is homeomorphic to K5. Notice, for example, that A is adjacent to C
and D, and, except for intermediate vertices of degree 2, also to B and E. 
A
B
G
S
Figure 14.10 
A nonplanar graph G and a subgraph S homeomorphic to K5.
-
.
.. 
-
1. The graph on the left of Fig 14.4 has three regions whose boundaries are
id, e, h), {a, b, f, g, cl, and {a, b, g, c, d, e, h}; the last region is exterior.
The graph on the right is a tree; it determines only one region, the exterior
one, with boundary {a, b, c, d}.
2. In the graph shown, V-E+R=6-6+3=3. 
/ 
i0
"
3. The boundaries of the regions are given in the answer to Pause 1: N =
3 + 5 + 7 = 15 < 16 = 2E. Edge f is counted only once.
4. Any cycle can be obtained from a 3-cycle by adding vertices to edges.
The symbol [BB] means that an answer can be found in the Back of the Book.
1. (a) [BB] Show that the graph is planar by drawing an
isomorphic plane graph with straight edges.
(b) [BB] Label the regions defined by your plane graph
and list the edges which form the boundary of each
region.
(c) [BB] Verify that V - E + R = 2, N < 2E, and
E < 3V -6 
(where, as defined in the proof of
Corollary 14.1.3, N is the sum of the numbers of
edges on the boundaries of all regions).
2. Repeat Exercise I for the complete bipartite graph
AC2 5.
3. [BB] Verify Euler's formula V
of the five Platonic solids.
E + F = 2 for each
4. One of the two graphs is planar; the other is not. Which
is which? Explain. (Note that the graph on the right is the
Petersen Graph, which was introduced in Section 10.2.)
5. Determine which of the graphs in Fig 14.11 are planar.
In each case, either draw a plane graph and a plane
graph with straight edges isomorphic to the one pre-
sented or exhibit a subgraph homeomorphic to /C3,3
or IC5.
EXAMPLE 5
WMIRM 
__

420 
Chapter 14 
Planar Graphs and Colorings
(a) [BB]
Note that this is just IC33 less
one edge.
(c)
(e) [BB]
Figure 14.11 
Graphs for Exercise 5.
6. Let g be a connected plane graph such that every region
of 5 has at least five edges on its boundary. Prove that
3E < 5V-10.
7. [BB] If 5 is a connected plane graph with V > 3 vertices
and R regions, show that R < 2V -4.
8. (a) [BB] Give an example of a connected planar graph
for which E = 3V -6.
(b) Let 5 be a connected plane graph for which E
3V -6. 
Show that every region of 5 is a triangle.
9. (a) If 5 is a connected plane graph with at least three
vertices such that no boundary of a region is a tri-
angle, prove that E < 2V -4.
(b) Let g be a connected planar bipartite graph with E
edges and V 
> 
3 vertices. Prove that E <
2V -4.
10. (a) [BB] For which n is KI planar?
(b) For which m and n is C,,, planar?
[BB] Show that AC
2,2 is homeomorphic to K3.
Show that any graph homeomorphic to KCs or to KI3,3 is
obtainable from KC
5 or K3,3, respectively, by addition of
vertices to edges.
13. Suppose a graph 51 with VI vertices and El edges is
homeomorphic to a graph g2 with V2 vertices and E2
edges. Prove that E2 -V
2 = El- V.
14. (a) [BB] Let g be a connected graph with VI vertices
and El edges and let - be a subgraph with V2
vertices and E2 edges. Show that E2 - V2 < El -Vt.
(b) Let g be a connected graph with V vertices, E
edges, and E < V + 2. Show that g is planar.
(c) Is (b) true if E = V + 3? Explain.
15. [BB] Let 5 be a graph and let - be obtained from 5
by adjoining a new vertex of degree I to some vertex
of 5. Is it possible for g and 7H to be homeomorphic?
Explain.
16. Discover what you can about Kazimierz Kuratowski and
write a short biographical note about this famous Polish
mathematician (in good, clear English, of course).
17. Answer true or false and explain.
(a) If g is Eulerian and 7- is homeomorphic to 5, then
7 is Eulerian.
(b) [BB] If g is Hamiltonian and 7 is homeomorphic
to g, then Xh is Hamiltonian.
18. (a) Show that any planar graph all of whose vertices
have degree at least 5 must have at least 12 vertices.
[Hint: It suffices to prove this result for connected
planar graphs. Why?]
(b) Find a planar graph each of whose vertices has
degree at least 5.
(b)
(d)
(D
11.
12.

14.2 Coloring Graphs 
421
19. (a) [BB] Prove that if g is a planar graph with n con-
nected components, each component having at least
three vertices, then E < 3V -6n.
(b) Prove that if g is a planar graph with n connected
components, then it is always true that E < 3V-
3n. Deduce that Theorem 14.1.4 holds for arbitrary
planar graphs.
20. (a) [BB] Prove that every planar graph with V > 2
vertices has at least two vertices of degree d < 5.
(b) Prove that every planar graph with V > 3 vertices
has at least three vertices of degree d < 5.
(c) Prove that every planar graph with V > 4 vertices
has at least four vertices of degree d < 5.
21. (a) [BB] A connected planar graph g has 20 vertices.
Prove that 5 has at most 54 edges.
(b) A connected planar graph g has 20 vertices, seven
of which have degree 1. Prove that 5 has at most
40 edges.
22. (a) [BB] Suppose g is a connected planar graph in
which every vertex has degree at least 3. Prove that
at least two regions of g have at most five edges on
their boundaries.
(b) Establish (a) for planar graphs which are not con-
nected.
23. Suppose that a convex polygon with n vertices is tri-
angulated, that is, partitioned into triangles, possibly by
the introduction of new vertices. The graphs illustrate
two triangulations of a convex polygon with seven ver-
tices. In the graph at the left, four edges were required
and, in the graph at the right, 13. Show that the number
of edges added in order to effect a triangulation is at
least n -
3.
24. [BB] Find a formula for V -E + R which applies to
planar graphs which are not necessarily connected.
25. Prove that the Platonic solids are the only regular poly-
hedra. [Hint: In a regular polyhedron, every vertex has
the same degree d and every face has the same number
a of edges on its boundary. Try to solve V -E + F = 2
under such conditions.]
14.2 
COLORING GRAPHS
One of the most exciting mathematical developments of the twentieth century
was the proof, in 1976, of The Four-Color Theorem, which is easy to state and
understand, but whose proof had remained unsolved since 1852 when it was first
posed to his brother by Francis Guthrie. Guthrie had discovered that he could
color a map of the counties of England with only four colors in such a way that
each county had exactly one color and bordering counties had different colors.
He guessed that it was possible to color the countries of any map with just four
colors in such a way that bordering countries have different colors.4 Both brothers
had been students of Augustus De Morgan and so, unable to answer the question
themselves, they asked their former teacher, one of the greatest mathematicians of
the age. De Morgan was able to show that it is impossible to have five countries
each adjacent to all of the others, but this result, while lending support to Francis
Guthrie's guess, did not settle it.
It has long been known that five colors are enough, but for well over 100 years,
whether one could make do with just four colors was not known. In 1879, the pres-
tigious American Journal of Mathematics published a "proof" of the conjecture
40ur use of the term "map" is not intended to limit us to those maps found between the covers of an
atlas. In the context of map colorings, a map just means a plane (possibly pseudo-) graph in which the
edges represent borders and vertices are points where borders meet.
/11__

422 
Chapter 14 Planar Graphs and Colorings
by one Alfred B. Kempe5 (the final "e" is not pronounced), a London barrister,
but II years later a fatal flaw was discovered. In fact, as pointed out by Percy
Heawood,6 Kempe's argument was a valid one for five colors, but not for four. It
turns out that four colors are indeed enough but the proof, by Kenneth Appel and
Wolfgang Haken, 7 occupies almost 140 pages of the Illinois Journal of Mathemat-
ics and will not be presented here. The proof involved showing that any planar
graph must contain a subgraph of a certain type. If this subgraph were deleted, one
could 4-color the resulting reduced graph. With the assistance of J. Koch and 1200
hours of computer time, it was shown that any 4-coloring of the boundary of any
of the subgraphs identified by Appel and Haken could be extended to a 4-coloring
of the subgraph; thus, any planar graph could be 4-colored. The final settling of
what had been the Four-Color Conjecture was considered such an achievement
that for a period of time, the postage meters at the University of Illinois bore the
inscription, "Four Colors Suffice." Some readers might well be interested in an
article by Robin Thomas, which, after a brief history of the Four-Color Problem,
describes subsequent efforts to verify independently the proof, this being no small
task.8
Our modest goal here is to show how graph theory can be used to attack a
coloring problem and also to prove that any map can be 5-colored.
3
V 
8
Figure 14.12 
A map and an associated planar graph.
Our starting point is the observation that with any map we may associate a
planar graph whose vertices correspond to countries and where an edge joins two
vertices if the corresponding countries share a common border. There are nine
countries in the map depicted in the left of Fig 14.12, so the associated planar
graph has nine vertices. Since countries 5 and 6 share a border, vertices 5 and 6
are joined by an edge, and so on. The point is that coloring the countries of the
map so that countries with a common border receive different colors is equivalent
to coloring the vertices of the associated graph so that adjacent vertices have
different colors. For example, the following assignment of four colors to countries
5A. B. Kempe, "On the Geographical Problem of the Four Colors," American Journal ofMathemnatics
2 (1879), 193-200.
6p, J. Heawood, "Map-Color Theorem," Quarterlv Journal of Mathematics 24 (1890), 332-339.
7K. Appel, W. Haken, J. Koch, "Every Planar Map is Four-Colorable," Illinois Journal of Mathematics
21 (1977), 429-567.
8Robin Thomas, "An update on the Four-Color Theorem," Notices of the American Mathematical Society
45 (1998), no. 7, 848-859.
I

14.2 Coloring Graphs 423
(or vertices) in Fig 14.12 colors the map (and the graph) in the proper sense:
1 - red; 2 - blue; 3 - green; 4 - red; 5 - green; 6 - blue;
7 - green; 8 - red; 9 - yellow.
Figure 14.13 shows a map of North America in which most provinces and
states have been colored. Starting the coloring with the western states, it is soon
apparent that three colors are not enough.
Figure 14.13 
A partial 4-coloring of a map of North America.
We formalize the notions we have been discussing.
SM 
A coloring of a graph is an assignment of colors to the vertices so that adjacent
vertices have different colors. An n-coloring is a coloring with n colors. The
chromatic number of a graph 5, denoted X(5), is the minimum value of n for
which an n-coloring of G exists.
Suppose X(g) = 1 for some graph g. What do you know about !?
The graph on the left of Fig 14.14 has been colored with three colors. Thus, its
chromatic number is at most 3. Since it contains several triangles (the vertices of
which must be colored differently), at least three colors are required: Its chromatic
number is 3. The graph on the right has been colored with four colors, so for this
graph 5, X(5) < 4. Since 9 contains AC4 as a subgraph (consider the subgraph
Emu[=

424 
Chapter 14 
Planar Graphs and Colorings
determined by the vertices V3, V4, V5, V6) and since 1(4 requires four colors, 5
cannot be colored with less than four colors. For this graph then, X(5) = 4.
G 
B
v2 
V3
G 
R
V2 
V3
Y VI
G 
B
Figure 14.14 
The graph on the left has chromatic number 3; the graph on the right has chromatic number 4.
11111:86(0110] :U
6'
A 
0'
Proof
What is the chromatic number of the graph in Fig 14.12?
X(ICn) = n, X(ICn,,) -
2. Why?
For any planar graph 5, X(g) < 4.
Because of the Four-Color Theorem, a cartographer with at most four colors
at her disposal is certain to be able to color the countries of any map with which
she is confronted (so that countries with a common border have different colors)
since an n-coloring of the associated (planar) graph with n < 4 translates into a
coloring of the countries of the map.
How can X(5) be determined in a specific situation? For a small graph, trial
and error is likely the best method, though this approach would surely not be fea-
sible for graphs with a large number of vertices and edges. Actually it is unknown
whether or not a "good" (polynomial time) algorithm exists for determining X (5);
like the Traveling Salesman's Problem, this problem is NP-complete.
One general result that applies to any graph links the chromatic number to
the degrees of the vertices.
Let A(g) be the maximum of the degrees of the vertices of a graph 5. Then
X(5) < I + A(g).
The proof is by induction on V, the number of vertices of the graph. When V = 1,
A(g) = 0 and x(5) = 1, so the result clearly holds. Now let k be an integer,
k > 1, and assume that the result holds for all graphs with V = k vertices.
Suppose 5 is a graph with k + I vertices. Let v be any vertex of g and let
go = g \ {v} be the subgraph with v (and all edges incident with it) deleted. Note
that A(g0) < A(5). Now go can be colored with X(5o) colors. Since g0 has k
vertices, we can use the induction hypothesis to conclude that X (go) < I + A (g0).
Thus, X(5o) < 1 + A(g), so go can be colored with at most 1 + A(g) colors.
Since there are at most A(g) vertices adjacent to v, one of the available I + A(g)
colors remains for v. Thus, g can be colored with at most 1 + A(g) colors. 
I
The result of Theorem 14.2.3 is best possible as we see by considering the
complete graph on n vertices. Since X(ICn) = n (Pause 7) and A(K,) = n -1,
we have X(Cn) = 1 + A(IC,).
y VI

14.2 Coloring Graphs 425
If G is an n-cycle, then A(G) = 2 and it is not hard to see that x(G) = 2
or 3 according as n is even or odd. Thus, if 5 is a cycle with an odd number of
vertices, we again have X(G) = I + A(G). A theorem of R. L. Brooks9 asserts
that the only connected graphs G for which X(G) = I + A(G) are IC, and cycles
with an odd number of vertices. So for all other connected graphs, we have
x(G) < A(G)
For either graph G in Fig 14.14, A(5) = 5, and so we can conclude from
Theorem 14.2.3 that X(5) < 6 or, from the result of Brooks, that x(G) < 5. Nei-
ther observation tells us what is evident from the figure, that the actual chromatic
numbers are 3 and 4. Nevertheless, Theorem 14.2.3 and its improvement due to
Brooks do give us some information about the chromatic number of a graph and
are, therefore, of interest since there is, in general, no easy way to find a chromatic
number. Given a graph 5, we must simply apply ad hoc methods and hope to
find X(5) by trial and error.
While we cannot prove the Four-Color Theorem, we can prove the Five-Color
Theorem without too much difficulty.
(Kempe, Heawood) If G is a planar graph, then x(5) < 5.
We must prove that any planar graph with V vertices has a 5-coloring. Again we
use induction on V and note that if V = I the result is clear. Let k > 1 be an
integer and suppose that any planar graph with k vertices has a 5-coloring. Let
G be a planar graph with k + I vertices and assume that G has been drawn as a
plane graph with straight edges. We describe how to obtain a 5-coloring of G.
V5
Proof
Figure 14.15
First, by Corollary 14.1.6, g contains a vertex v of degree at most 5. Let
g0 = g \ tv} be the subgraph obtained by deleting v (and all edges with which it
is incident). By the induction hypothesis, g0 has a 5-coloring. For convenience,
label the five colors 1, 2, 3, 4, and 5. If one of these colors was not used to color
the vertices adjacent to v, then it can be used for v and 5 has been 5-colored.
Thus, we assume that v has degree 5 and that each of the colors 1 through 5
appears on the vertices adjacent to v. In clockwise order, label these vertices
VI, V2, .
V 
., U5 and assume that vi is colored with color i. (See Fig 14.15.) We
show how to recolor certain vertices of g0 so that a color becomes available for
v. There are two possibilities.
Case 1: There is no path in g0 from v, to v3 through vertices all of which
are colored I or 3.
9R. L. Brooks, "On Coloring the Nodes of a Network," Proceedings of the Cambridge Philosophical
SocieAy 37 (1941), 194-197.

426 
Chapter 14 
Planar Graphs and Colorings
In this situation, let Al be the subgraph of g consisting of the vertices and
edges of all paths through vertices colored 1 or 3 which start at vi. By assumption,
V3 is not in X. Also, any vertex which is not in H but which is adjacent to a
vertex of H is colored neither I nor 3. Therefore, interchanging colors I and 3
throughout 'H produces another 5-coloring of g0. In this new 5-coloring both vl
and V3 acquire color 3, so we are now free to give color I to v, thus obtaining a
5-coloring of g.
Case 2: There is a path P in g0 from vI to V3 through vertices all of which
are colored I or 3.
In this case, the path P, followed by v and vI, gives a circuit in g which does
not enclose both v2 and V4. Thus, any path from V2 to V4 must cross P and, since
5 is a plane graph, such a crossing can occur only at a vertex of P. It follows
that there is no path in g( from v2 to V4 which uses just colors 2 and 4. Now
we are in the situation described in Case 1, where we have already shown that a
5-coloring for g exists. 
I
Readers may notice that vertex U5 appears to play no role in this proof. Can
our proof be adapted to prove the Four-Color Theorem? Recall that Alfred Kempe
thought he had such a proof. See Exercise 16.
We conclude this section with an application of the idea of chromatic number
to a problem familiar to most university registrars, the scheduling of exams. At
a university of even moderate size, it is not unusual for 500 or 600 exams to
be scheduled within a reasonably short period of time. The principal problem is
always to minimize "conflicts," that is, to try to avoid situations where a stu-
dent finds the exams in two of his or her courses scheduled for the same time
period.
PROBLEM 6. 
(Examination 
Scheduling) 
Suppose 
that in one particular
semester, there are students taking each of the following combinations of courses.
.
Mathematics, English, Biology, Chemistry
.
Mathematics, English, Computer Science, Geography
.
Biology, Psychology, Geography, Spanish
.
Biology, Computer Science, History, French
.
English, Psychology, History, Computer Science
.
Psychology, Chemistry, Computer Science, French
.
Psychology, Geography, History, Spanish
What is the minimum number of examination periods required for exams in the
ten courses specified so that students taking any of the given combinations of
courses have no conflicts? Find a possible schedule which uses this minimum
number of periods.
Solution. 
In order to picture the situation, we draw a graph (shown on the left of
Fig 14.16) with ten vertices labeled M, E, B, ... corresponding to Mathematics,
English, Biology, and so on, and join two vertices with an edge if exams in the
corresponding subjects must not be scheduled together.
The minimal number of examination periods is evidently the chromatic num-
ber of this graph. What is this? Since the graph contains 1C5 (with vertices

14.2 Coloring Graphs 427
Period 1 
Mathematics, Psychology
Period 2 
English, Spanish, French
Period 3 
Biology
Period 4 
Chemistry, Geography
Period 5 
Computer Science
Period 6 
History
A 
* 
* * 
-~
M, E, B, G, CS), at least five different colors are needed. (The exams in the
subjects which these vertices represent must be scheduled at different times.) Five
colors are not enough, however, since P and H are adjacent to each other and to
each of E, B, G, and CS. The chromatic number of the graph is, in fact, 6. In
Fig 14.16, we show a 6-coloring and the corresponding exam schedule. 
I
5. If g has an edge, its end vertices must be colored differently, so X(5) > 2.
Thus, x(g) = I if and only if g has no edges.
6. A way to 4-color the associated graph was given in the text. From this, we
deduce that X(5) < 4. To see that x(g) = 4, we investigate the consequences
of using fewer than four colors. Vertices 1, 2, 3 form a triangle, so three
different colors are needed for these. Suppose we use red, blue, and green,
respectively, as before. To avoid a fourth color, vertex 4 has to be colored red
and vertex 5 green. Thus, vertex 6 has to be blue. Since vertex 9 is adjacent
to vertices 1, 5, and 6 of colors red, green, and blue, respectively, vertex 9
requires a fourth color.
7. It takes n colors to color IC because any two vertices of IC, are adjacent:
X(ICn) = n. On the other hand, X(ICmn) = 2; coloring the vertices of each
bipartition set the same color produces a 2-coloring of ICmn.
The symbol [BB] means that an answer can be found in the Back of the Book.
Assume that all graphs in these Exercises are connected.
4 
1. Name and describe two major mathematical accomplish-
ments of the twentieth century.
2. (a) [BB] Draw a graph corresponding to the map shown
at the right and find a coloring which requires the
least number of colors. What is the chromatic num-
ber of the graph?
(b) [BB] Answer true or false and explain: The Four-
Color Theorem says that the chromatic number of a
planar graph is 4.
9EN87S
86
R
M
G
G
Figure 14.16
Y
G 
R
Y
3 B

428 
Chapter 14 Planar Graphs and Colorings
3. (a) [BB] When we discussed the coloring of maps at
the beginning of this section, we assumed implicitly
that "bordering" countries were countries which had
some positive length of border in common. Suppose
we deem countries to border if they merely have a
point in common. Will four colors still suffice to
color a map?
(b) [BB] We also assumed that a country should consist
of a single region. If we drop this restriction, will
four colors still suffice to color a map?
4. Compute X(5) for each of the graphs shown in
Fig 14.17. In each case, explain your answer and exhibit
a x(g)-coloring.
5. Answer Exercise 4 for each of the graphs in Exercise 5,
Section 14.1.
6. (a) [BB] Find the chromatic number of each of the
graphs in Exercise 4 of Section 14.1.
(b) [BB] State the converse of the Four-Color Theorem.
Is it true?
7. (a) [BB] Is a tree planar? Explain.
(b) Use (a) to prove that a tree with n vertices has n- I
edges.
(c) Suppose T is a tree with n vertices. What is X(T)
and why?
8. Consider the graph shown on the left.
(a) Is it planar? Either draw an isomorphic plane graph
or explain why the graph is not planar.
(a)
(c)
(e) [BB]
(b) Find its chromatic number and explain why this
piece of information is consistent with the Four-
Color Theorem.
9. [BB] Consider the graph shown on the right.
(a) Find a subgraph homeomorphic to K C.
(b) Find a subgraph homeomorphic to K 3 ,.
(c) Is the graph planar? Explain.
(d) What's the chromatic number of the graph?
(e) Use this graph to comment on the converse of the
Four-Color Theorem.
10. (a) [BB] What is x(7C14 )? What is X(K 5,14)? Why?
(b) Let 91 and g2 be cycles with 38 and 107 edges,
respectively. What is x(g)? What is X(92)?
Explain.
11. Answer true or false and explain:
(a) [BB] If x(G) = 3, then 5 contains a triangle.
(b) If x(g) = 4, then g contains K4 .
12. Let n > 4 be a natural number. Let g be the graph
which consists of the union of Cn-3 and a 5-cycle C
together with all possible edges between the vertices of
these graphs. Show that x(g) = n, yet g does not have
K n as a subgraph.
13. Answer true or false and explain. If g is homeomorphic
to Y, then x(g) = X(H)
(b) [BB]
(d)
(D
Graphs for Exercise 4.
)
Figure 14.17

14.2 Coloring Graphs 429
14. Answer true or false and explain:
(a) [BB] A Hamiltonian graph with chromatic number
two must be planar.
(b) A planar graph with chromatic number two must be
Hamiltonian.
(c) A graph which is both Hamiltonian and Eulerian
and has chromatic number two must be planar.
(d) [BB] A graph which is both Hamiltonian and Eule-
rian must have chromatic number less than six.
15. [BB] The graph arises in a certain problem of exam
scheduling such as that described in Problem 6. Find
the minimum number of exam periods required so that
conflicts are avoided.
8
7
3 
4 
5 
6
16. Can our proof of the Five Color Theorem be adapted to
prove the Four-Color Theorem? Go through the proof
presented in this section assuming that only four colors
are available and find any possible flaw.
17. In addition to the combinations of courses described in
Problem 6, suppose that there are also students taking all
of Geography, Computer Science, Spanish, and French.
Does this force a change in the exam schedule? If it
does, find a new examination schedule which avoids
conflicts and uses the fewest number of periods.
18. lBB] There are ten students who, in the coming
semester, will be taking the courses shown in the fol-
lowing table. How many time periods must be allowed
in order for these students to take the courses they want
without conflicts?
Arnold 
Physics, Mathematics, English
Bill 
Physics, Earth Science, Economics
Carol 
Earth Science, Business
Calvin 
Statistics, Economics
Eleanor 
Mathematics, Business
Frederick 
Physics, Earth Science
George 
Business, Statistics
Huber 
Mathematics, Earth Science
Ingrid 
Physics, Water Skiing, Statistics
Jacquie 
Physics, Economics, Water Skiing
19. [BB] The following semester, all the students in the
previous problem, except Calvin, plan to take second
courses in the same subjects. Calvin decides not to take
further courses in statistics. How many time periods will
then be required?
20. Hubert Noseworthy loves snakes and keeps a dozen
different varieties in his apartment (contrary to regu-
lations). Since some varieties of snake attack other vari-
eties, as shown in the following tables, Hubert needs
several boxes in which to keep his snakes in order to
separate antagonists. What is the minimum number of
boxes he needs?
Variety 
Attacks Variety 
Variety Attacks Variety
1 
3,4,5,8, 10, 12 
2 
1,3,6,7, 10, 11
3 
4,9, 12 
4 
5,8,9
5 
6, 7, 10 
6 
9, 12
7 
10,12 
8 
7
9 
8,11 
10 
11
11 
12
21. The local day care center has a problem because certain
children do not get along with certain others. The table
shows which of 15 children don't get along with whom.
Finally, it is decided that children who do not get along
with each other will have to be put into separate rooms.
Find the minimum number of rooms required.
Child 
doesn't get
along with
1 
2.6,9, 10, 11, 13
3
5
7
9
1 1
1 3
4,5,7,8, 12
3,4,7,8, 12, 13
3,5,6.8.11, 14
1, 8, 10, 12, 15
1,4,7, 10, 12
1,2,5, 14
15 
2,6,9, 10, 12
Child 
doesn't get
along with
2 
1,8,10,12,13,14,15
4
6
8
10
12
14
3,5,6,8, 11, 14
1,4,7, 12, 15
2,3,4,5,7,9, 14
1,2,9, 11, 15
2,3,5,6,9, 11, 15
2,4,7,8, 13
22. Television channels are to be assigned to stations based
in nine cities A, B. ... ,1. Broadcasting regulations
require that cities within 150 km of each other be
assigned different channels. What is the least number
of channels required if the distances between the cities
are as given in the table.
A 
B 
C 
D 
E 
F 
G 
H 
I
B 
85
C 
137 
165
D 
123 
39 205
E 
164 
132 
117 
171
F 
105 
75 235 
92 201
G 
134 
191 
252 
223 298 
177
H 
114 
77 
113 
117 
54 
147 
247
I 
132 
174 
22 213 
138 237 
245 
120
I

430 
Chapter 14 Planar Graphs and Colorings
23. Continuing the previous problem, city J is to acquire a
television station too. Can it be assigned one of the exist-
ing channels or must it have a new one? Its distances
from cities A, . . .I, 
are as follows.
A 
B 
C 
D 
E 
F 
G 
H 
I
J 1 78 
149 
101 
189 
171 
183 
160 
143 
94
24. (a) [BB] Let 5 be a connected graph with n vertices
and n edges. Prove that X(5) 
3.
(b) Show that (a) remains true if 5 has n + I edges.
(c) Does (a) remain true if 9 has n + 2 edges? Explain.
connecting vertices if corresponding countries shared a bor-
der. By introducing one additional vertex corresponding to
the exterior region and additional edges as before, we obtain
a graph known as the dual graph of the map.
25. (a) [BB] Draw the dual graph of the cube (considered
as a map) (Fig 14.5) as a plane graph with straight
edges. Identify this dual graph. [Hint: It's another
of the Platonic solids.]
(b) Repeat (a) for the dodecahedron (Fig 10.13).
26. [BB] Is it possible for a plane graph, considered as a
map, to be its own dual?
In this section, we showed how to associate a planar graph
with a map, by introducing a vertex for each country and
14.3 
CIRCUIT TESTING AND FACILITIES DESIGN
In this section, we present two interesting applications of the material in Sections
14.1 and 14.2. The first shows how knowledge of graph colorings can be used to
assist in testing printed circuit boards for the existence of possible short circuits.
In the second, we apply what we have learned about graph colorings, planarity,
and Hamiltonian cycles to the design of floor plans for facilities such as hospitals
or shopping malls in order to meet, so far as possible, various requirements of
juxtaposition.
Circuit Testing
A printed circuit board can be represented by a finite rectangular grid composed
of evenly spaced rows of evenly spaced grid points called nodes, which are con-
nected by horizontal and vertical line segments called grid segments. On this
board, certain vertices are connected via disjoint paths (called nets) along grid
segments. For example, Fig 14.18 shows a grid with 49 nodes and seven nets
labeled N1, N2, . . , N7.
In general, the grid segments in a particular net pattern correspond to conduc-
tor paths in the circuit board. The problem of interest is to determine whether or
not any extra conductor paths (short circuits) between nets have been introduced
into the board during the manufacturing process. A short circuit need not begin
or end at a node.
One definite way to determine whether or not there are short circuits is to take
each pair of distinct nets, in turn, and to apply an electrical signal to one member
of the pair. If that signal appears in the other net, then there must be a short. This
procedure can be extremely time-consuming; for instance, in Fig 14.18, (7) = 21

14.3 Circuit Testing and Facilities Design 431
N4  
N5
N2
N6
N1
N3  
N7
Figure 14.18 
A grid of 49 nodes and 7 nets, comprising altogether 24 grid segments.
comparisons would be required. Many of these comparisons may be unnecessary,
however. As an example, the left-hand grid in Fig 14.19 shows two nets, A and
C, that cannot possibly have a short between them unless there is also a short
between each of them and B. Hence, it suffices to test B against each of A and C.
B
C
A
Figure 14.19
In the right-hand grid of Fig 14.19, it is theoretically possible to have a short
between A and C which does not touch B, as shown by the dotted line, but
this seems unlikely. We shall assume henceforth that any short circuit between
nets must be a single straight horizontal or vertical line (of arbitrary length) not
touching any other net (but not necessarily through nodes).
An efficient way of testing either grid in Fig 14.19 would be to combine nets
A and C into a single set which could be tested against B. In general, a good
procedure is to partition the set of nets into subsets such that if two nets Ni,
Ni are in the same subset, then Nj and Nj cannot have a short between them.
Then we need only test these subsets against each other to determine whether a
short circuit exists. For example, in Fig 14.18, the subsets could be {N., N3, N6},
{N2, N5, N7}, fN4}, and three tests would suffice (instead of 21). Note that NJ
and N3 cannot have a short between them, nor can N3 and N6, nor N. and N6.
The other subsets are obtained by similar reasoning.
Find another partition of the net pattern in Fig 14.18 into three appropriate subsets.
Pause 8 illustrates an important point: The sorts of partitions we have been
discussing are not necessarily unique. From an efficiency point of view, however,
1=

432 
Chapter 14 
Planar Graphs and Colorings
we don't care about this. What matters is that we find a partition into as few
subsets as possible. Here is where graph theory helps.
N2
N5
Figure 14.20 
N3  
N7
Given a grid with a net pattern, we construct the graph which has a vertex
corresponding to each net and where two vertices are joined by an edge if and
only if there could be a short circuit between the corresponding nets. Figure 14.20
shows the graph corresponding to Fig 14.18. Note that N1 is joined to IV2 but to
no other vertex because the only possible short involving NJ must be between N,
and N2. Other edges are obtained by similar reasoning. Any graph which can be
obtained by the procedure described will be called a line-of-sight graph.
How would the line-of-sight graph change if net N2 were not present in the net
shown in Fig 14.18? Draw the revised graph.
Since two vertices in a line-of-sight graph are joined by an edge if and only if
the corresponding nets could have a short between them, it is easy to see that any
coloring of such a graph yields subsets of the type desired for the corresponding
nets. For example, a 3-coloring of the graph in Fig 14.20 could be obtained by
coloring N1, N3, and N6 blue; N2, N5, and N7 red; and N4 white. Placing like-
colored nets in the same subset gives the partition described earlier.
Another possibility would be to color N1 and N6 blue; N3 and N4 red; and
N2, N5, and N7 white. This yields another suitable partition. Since the graph in
Fig 14.20 contains a triangle, we know that at least three colors are required and,
hence, we cannot reduce further the number of partitions. In general, the minimum
number of subsets obtainable in a suitable partition of nets is the chromatic number
of the associated line-of-sight graph.
Find the chromatic number of the graph you obtained in Pause 9, and determine
a corresponding partition of the nets.
Is our approach to finding partitions of nets really useful? After all, chromatic
numbers are notoriously hard to determine. Fortunately, only certain graphs are
obtainable as line-of-sight graphs. Any planar graph is a line-of-sight graph but
IC9, for example, is not. It is known that no matter how large the grid is or how
many nets are involved, the corresponding graph g has X(5) < 12. It follows that
the nets can always be partitioned into at most 12 subsets and, hence, we never
need to carry out more than (122) = 66 tests. Is 12 best possible? Perhaps nets
can always be partitioned into at most 11 subsets, or at most 10. The answer is
not known, but it is not less than 8 since there exists a line-of-sight graph g for
which X(5) = 8. (See Exercise 9.)
N6
1=

14.3 Circuit Testing and Facilities Design 
433
The preceding results, as well as many others, appear in a fundamental and
very interesting paper by Garey, Johnson, and So.1 0 There are still a number of
intriguing open problems here-for example, is it possible to characterize precisely
those graphs which are line-of-sight graphs? You are encouraged to investigate
this area further, first by examining the aforementioned paper.
Facilities Design
As mentioned earlier, we are interested here in the design and layout of physical
facilities such as hospital floors. In such problems, there are a number of design
areas (rooms perhaps) and it is often desirable (or critical) that certain of these
areas be adjacent to each other. The planner of such a project will be presented
with a list of relationships from which it must be determined whether or not it
is possible to construct such a floor plan and if so how. If it is not possible, the
question becomes how close can one come to meeting the requirements.
If it is possible to produce a layout satisfying all the given relationships of
one area to another, then we say that the given relationships are feasible. If a set
of relationships is not feasible, we would like to determine the smallest number
of relationships whose omission produces a feasible set.
The first thing to do is to draw a graph (called the relationship graph) whose
vertices represent design areas and in which an edge between vertices indicates that
corresponding areas are to be adjacent. Thinking of a given layout of the design
areas as a map whose associated graph (see Fig 14.12) is the relationship graph,
we see that a set of relationships will be feasible if and only if the relationship
graph is planar.
Theoretically then, Kuratowski's Theorem (14.1.8) could be used to decide
whether or not a given set of relationships is feasible. There are, however, two
difficulties with this approach. First, Kuratowski's Theorem is difficult to apply,
and most architects would prefer an easier algorithm. Second, and much more
significant, should the relationship graph not be planar, Kuratowski's Theorem
provides no indication of which relationships should be deleted in order to achieve
planarity.
What we are looking for, therefore, is a simple test for planarity which will
readily identify those edges which are causing a particular graph not to be pla-
nar. While this is too much to expect, progress has been made in the case of
Hamiltonian graphs." The procedure we outline determines, in a rather nice way,
whether or not a Hamiltonian graph is planar. While it does not rigorously identify
those edges which should be deleted in the case of nonplanarity, it does model
the problem in such a way that it is generally not difficult to locate such edges.
We demonstrate this procedure by working through a specific example.
EXAMPLE 7 
Consider the relationship graph g drawn in Fig 14.21. This graph has a Hamil-
tonian cycle, 1243561. We start by drawing a graph 91 isomorphic to g with the
t0Michael R. Garey, David Stifler Johnson, and Hing C. So, "An Application of Graph Coloring to Printed
Circuit Testing," IEEE Transactions on Circuits and Systems, Vol. CAS-23, (1976), no. 10, 591-599.
"1G. Demourcron, V. Maigrance, and R. Pertuiset, "Graphes Planaires: Reconnaissance et Construction
de Representations Planaires Topologiques," Recherche Operationelle 30 (1964), 33.

434 
Chapter 14 
Planar Graphs and Colorings
5
4 
3
Figure 14.21 
5 
g1
vertices of the Hamiltonian cycle in g appearing in order around the circumfer-
ence of a circle. We then label arbitrarily those edges of 51 which are not on the
cycle. Next, we draw a new graph K whose vertices correspond to the edges of
g1 just labeled. Two vertices of X are joined by an edge if the corresponding
edges cross inside the circle. The graph we obtain in this way is shown on the
left in Fig 14.22.
g
a 
a
bb
\ 
C 
C 
R
f 
f
e 
d 
e 
d
Figure 14.22 
K 
A 2-coloring of K \ {g}
Now examine this new graph K. We claim that the original graph g is planar
if and only if x(X) < 2, and here's why. If x(X) < 2, then there is a coloring
of the vertices of K requiring at most two colors. Therefore, the interior edges of
5i could be colored with at most two colors in such a way that edges crossing
inside the circle (if any) have different colors. By drawing all the edges of one
color outside the circle and leaving alone all edges of the other color, we would
then obtain a representation of g5 with no crossovers of edges; in other words,
g would be drawn as a plane graph. Conversely, if g is planar and drawn as a
plane graph, then coloring all edges inside the cycle with one color and all edges
outside with another produces a coloring of the associated graph K which uses at
most two colors.
We return to our example and note from Fig 14.22 that x(X) 7& 2 since 'H
contains a 5-cycle, adbfga; hence, the original graph g is not planar. So we must
now look for the smallest number of vertices which, when removed from K, leave
a graph whose chromatic number is 2. In our example, if we remove any of a, b,
or g, we will achieve the desired result.
Suppose we remove g. We picture the resulting graph and a 2-coloring on
the right in Fig 14.22. This, in turn, provides a coloring of the interior edges of
G5 \ {g}. In Fig 14.23(a), we draw GI \ [g} as a plane graph with all edges of one
of the two colors drawn outside the circle. In order to draw a layout with g1 \ {g)
as its relationship graph, it is helpful first to draw this plane graph with straight

14.3 Circuit Testing and Facilities Design 
435
edges, as in Fig 14.23(b). In Fig 14.23(c), we show the corresponding layout. If
this were, for example, the floor plan of a hospital, Fig 14.23(c) shows a way
that the rooms can be laid out so as to satisfy the aforementioned relationships.
Strange-looking rooms, perhaps, but feasible! 
A
g1 \ (g) drawn as a
plane graph
(a)
g1 \ {g} drawn as a
plane graph with
straight edges
(b)
Figure 14.23 
A plane graph, then drawn with straight edges, and an associated layout of design areas.
Carry out the steps in the previous paragraph, assuming f is removed instead
of g.
1. We proved in Section 14.1 that connected planar graphs with at least three
vertices must satisfy E < 3V -6 (Theorem 14.1.4). Thus, 3V -6 is an upper
bound for the number of relationships which are theoretically possible in a
facilities design having V rooms. Despite what the planner might want, it is
impossible to do better!
2. In many practical problems, some relationships are more important than
others. Certain ones, in fact, might be crucial (in a hospital, for example).
Relative importance of relationships can be incorporated into the model by
assigning weights to the edges of the relationship graph and then attempting to
achieve planarity by removing the least important edges. Kruskal's algorithm,
adapted to choose a maximal weight spanning tree (instead of a minimal one),
has been applied to this case with some success.
3. The authors first read about this fascinating area in Roberts's book Applied
Combinatorics.12 Certainly there is great potential here for further investiga-
tion. We refer the interested reader also to Chapter 8 of Chachra, Ghare, and
Moore1 3 for additional information.
v- 
0 
*. 
-aw
8. IN1, N6}, {N 2, N5, N7}, {N3, N4}
12Fred S. Roberts, Applied Combinatorics, Prentice Hall, New Jersey, 1984.
13V. Chachra, P. M. Ghare, and J. M. Moore, Applications of Graph Theory Algorithms, Elsevier, North-
Holland, New York, 1979.
An associated
layout
(c)

436 
Chapter 14 Planar Graphs and Colorings
9.
N5
Al
NI
10. The chromatic number of the preceding graph is 4 since it contains KC4 as a
subgraph. One partition would be tNI, N3}, {N4}, tN6l, {N5, N7 1.
11. A 2-coloring of 'H \ {f } is shown at the 
L R
right. On the left in the graphs which fol-
low is g1 \{ f }, drawn as a plane graph with
all white edges drawn outside the circle.
In the middle, it's redrawn with straight
edges, and on the right there is a layout
whose relationship graph is G, \ I f .
2
The symbol [BB] means that an answer can be found in the Back of the Book.
questions refer to the net pattern
VI 
Vs
V2  
V4
H
(a) Find the number of nodes, grid segments, and
nets.
(b) Give an example of two nets which cannot have
a vertical or horizontal short circuit between them
unless there is a similar short circuit between one
of them and another net.
(c) Draw the associated line-of-sight graph g.
(d) Determine X(5) and find a corresponding partition
of the nets.
2. Repeat Exercise I if the nodes of the far right-hand col-
umn are all connected by a vertical line of grid segments,
thus forming another net, V6.
3. LBB] True or false? A line-of-sight graph is always
connected.
4. Let .A be the set of nets in a given net pattern. Define
a relation - on X by A - B if there could be a short
circuit between A and B. Determine whether or not - is
c
1. [BB] The following
drawn below.
ff MW
II ___ __ -
-
1-- 
__ 
-
 
I 11 I -
e

14.3 Circuit Testing and Facilities Design 
437
(a) [BB] reflexive,
(b) symmetric,
(c) antisymmetric,
(d) transitive.
5. Refer to the net pattern shown below.
(a) [BB] Draw the associated line-of-sight graph 5.
(b) Determine x(G) and find a corresponding partition
of the nets.
N6
.
.
.,
.
.
.l
.
N7@
N8g
10. Find a best possible feasible relationship graph and draw
the corresponding floor plan for KJ5 [BB], KV3,3, and k6,
each of these considered as a relationship graph.
11. For each of the following relationship graphs, find a
best possible feasible relationship graph and draw the
corresponding floor plan.
(a)
2
I 
II fit IV
(c) 
2
6. Repeat Exercise 5 if net N3 is removed.
7. [BB] True or false? A line-of-sight graph is always
planar.
8. (a) [BB] Assume that the only short circuits in a printed
circuit board are horizontal straight lines; that is,
vertical shorts are not possible. Prove that the asso-
ciated line-of-sight graph 5 is then planar and con-
clude that X(5) < 4.
(b) [BB] Let V and S be the vertices and edges,
respectively, of a general line-of-sight graph 5.
Show that S can be partitioned into subsets SF, E2
such that the graphs Q(V, S), g(V,Â£2) are both
planar.
(c) Using (a) and (b), show that X(5) < 16 for any
line-of-sight graph 5.
(d) Using (b), show that /C1 
is not a line-of-sight
graph.
9. [BB] The net pattern shown has a line-of-sight graph 5
with X(5) = 8. Why? (This example is due to M. R.
Garey, D. S. Johnson, and H. C. So, cited in foot-
note 10.)
5 
6 
7
12. A contractor is building a single-story house for a newly
married couple. The house is to consist of a living room,
dining room, family room, kitchen, two bedrooms, bath-
room, and hall. The couple insists that all rooms border
on the hall. The kitchen is to share a wall with the dining
room, family room, and bathroom. Both bedrooms should
share a wall with the bathroom and the family room. The
living room is to border the family room and the dining
room. Is it possible for the contractor to meet the couple's
demands? If not, how close could the contractor come to
meeting all requirements? Justify your answer.
13. Jack is commissioned to build a nine-hole golf course
which meets the following specifications.
. The first hole must return to the clubhouse and hence
have a common border with the ninth hole.
. To satisfy thirsty patrons, the fifth hole also returns
to the clubhouse; it must have a common border with
the first hole, but not necessarily with the ninth.
NI
N2
N3
, .N 4
N5
(b)
t
r
l
I
.
.
.
.
.
.
.
.
.
.
.
.
.
.
.
.
.
.
.
.
.
.
.
.
.
.
.
.
.
.
.
.
.

438 
Chapter 14 
Planar Graphs and Colorings
. All even-numbered holes share a common water haz-
ard and have some common 
border with each
other.
* Each hole (after the first) has a common border with
the one preceding it.
(a) [BB] Show that it is impossible for Jack to build a
golf course meeting all these requirements.
(b) State three different ways in which Jack could sat-
isfy all but one of the requirements.
14. [BB] Apply Kuratowski's Theorem, Theorem 14.1.8, to
the graph 5 in Fig 14.21 to show that 5 is not
planar.
15. [BB] Apply Brooks's Theorem (p. 425) to find the chro-
matic number of the graph X in Fig 14.22.
I 
M 
A 
X 
1. 
; 
X
1. (a) Show that the graph is planar by drawing an iso-
morphic plane graph with straight edges.
(b) Label the regions defined by your plane graph and
list the edges which form the boundary of each
region.
(c) Verify that V-E+R = 2, N < 2E and E < 3V-6.
(Recall that N is the sum of the numbers of edges
on the boundaries of all regions.)
2. Determine whether or not each of the graphs is planar. In
each case, either draw a plane graph with straight edges
isomorphic to the one presented, or exhibit a subgraph
homeomorphic to 143,3 or 1(C.
(a)
(b)
3. If 5 is a connected plane graph with V > 3 vertices and
R regions, each with at least five edges on its boundary,
prove that 3R < 2V -4. 
(You may use the result of
Exercise 6 of Section 14.1, but first be sure you can
prove it!)
4. (a) A connected planar graph 5 has 30 vertices. Prove
that 5 has at most 84 edges.
(b) A connected planar graph 5 has 30 vertices, 15 of
which have degree l. Prove that 5 has at most 54
edges.
5. Show that /C2,3 is homeomorphic to a subgraph of 1C4.
6. True or false? If g is a tree and 7h is homeomorphic to
g, then 7t is a tree. Explain your answer.
7. Compute X(5), where 5 is the graph in Exercise l.
Explain your answer and exhibit a x(5)-coloring.
8. Compute X(5) for the graphs of Exercise 2. Do your
results say anything about the converse of the Four-
Color Theorem?
9. Answer true or false and explain your answers.
(a) A planar graph with chromatic number 3 must be
Hamiltonian.
(b) If 5 is a planar graph which contains K4 as a sub-
graph, then X(5) = 4.
10. Let 5 be a connected graph with at least two vertices.
Prove that X(5) = 2 if and only if g is bipartite with at
least one edge.
11. (a) Give an example showing that the following theo-
rem, which resembles Theorem 14.2.3, is false:
Let E (5) be the minimum of the
degrees of the vertices of a graph 5.
Then x(5) > I + X(Q).
(b) Is the "theorem" stated in I (a) true if we restrict
our attention to trees with at least two vertices?

Review Exercises 
439
NI
N2
IN4
Fgr 
Ngn
Figure 14.24 
Net patterns for Exercises 13 and 14.
12. A town jail contains four holding cells. On a particularly
busy night, twelve people are arrested. Certain prisoners
do not get along with certain others and must be put
into separate cells, as shown in the following tables. If
possible, find a way of putting the prisoners into the four
cells in such a way as to avoid possible conflicts during
the night.
Prisoner 
doesn't get along with
1 
3,5,8,9, 10, 11
2 
3,4,6,7,9, 11
3 
1,2,6,8, 11, 12
4 
2,5,6,8, 10, 12
5 
1,4,7,9, 10
6 
2,3,4,7,9, 11, 12
7 
2,5,6,8, 10
8 
1,3,4,7, 12
9 
1,2,5,6, 11
10 
1,4,5,7, 12
11 
1.2,3,6,9
12 
3,4,6,8, 10
NN
N4
, 
,N
6
N7 
N 8
13. Draw the line-of-sight graph associated with the net pat-
tern shown on the left in Fig 14.24. Determine X(5) and
find a corresponding partition of the nets.
14. Repeat Exercise 13 for the net pattern shown on the
right of Fig 14.24.
15. Give an example of a net pattern whose line-of-sight
graph is Eulerian but not Hamiltonian.
16. Show that the complete bipartite graph K7,7 is not a line-
of-sight graph. [Hint: Use Exercise 8(b) of Section 14.3
and Exercise 9(a) of Section 14.1.]
17. Find a best possible feasible relationship graph and draw
the corresponding floor plan for each of the graphs in
Exercise 2.

i\ 4 
* 
INDUS 
*d 
U 
.;
N 
*.
* 
.
.
N
* *1
* 
.1.'
I.
15R
0 
. HfESCONU
\ 
11 
.
'\ The Max Flow- Min Cut
.. I 
.. 
..- 
O 
% s
*1
* 
I * .. 
.*. 
'*
I I tr 
rr
1 5.1 
FLOWS AND CUTS
In this chapter, we return to the concept of a directed network, introduced in
Section 11.5, and prove the very important Max Flow-Min Cut Theorem. Recall
that a directed network is a digraph in which each arc is assigned an integer
weight.
Whereas in Section 11.5, the weights on arcs were viewed as times required
to complete certain activities, the point of view we adopt now is rather different.
Here, we think of the arcs of a digraph as pipes and the weight on an arc as the
capacity of the pipe, the maximum amount of some commodity that can flow
through it in a given unit of time-liters of oil or gas, kilowatts of electricity,
numbers of people, messages, trucks, or letters.
a 
12 
C
b 
2 
d
Figure 15.1 
A directed network with a source s and a sink t.
Figure 15.1 shows a network typical of the sort we consider in this chapter.
It has two distinguished vertices s and t called, respectively, the source and the
sink. Intuitively, we think of the source as the start of the flow and expect that
all arcs with source s as an end point should be directed away from s. While
this is generally the situation, it is not important for the theory which follows and
so we do not impose such a special condition on s. Similarly, while we think of
the sink as the place toward which all the flow is directed, we do not make this
assumption.
441
i.
I
. .
.
. 0 4
.
.
0 ,
-
I

442 
Chapter 15 
The Max Flow-Min Cut Theorem
Remember that when we say that uv is an arc in a digraph, we mean that the
arrow on the edge joining u and v is in the direction u -* 
v. We denote by cuV
the capacity of arc uv in a directed network and, in order that cu, has meaning
for any pair of vertices a, v, we define cuv = 0 if uv is not an arc. We require
that all cuv be nonnegative integers.
In contrast to the capacity of an arc, the actual amount of flow passing through
uv is denoted fu, Again, we define fur = 0 if uv is not an arc so that fu, has a
meaning for every u and v. In the physical situations we are trying to model, the
flow through an arc cannot exceed its capacity; thus, we require that 0 < fuv < cu,
for every u and v. We also assume a conservation law at each vertex (except the
source and the sink). This says that for any vertex u (other than s or t) the flow
out of u equals the flow into a; symbolically, 
v fu, 
-Ev fu We hope you
agree that such a law makes good sense in any physical situation.
Given a directed network with vertex set V, the capacity of arc uv denoted cu, and
given two distinguished vertices s and t, called the source and sink, respectively,
an (s, t)-flow is a set F of numbers {fuv1 satisfying
1. 0 < fuv < cur for all a, v E V, and
2. EV 
fuv = E voV fv, for all u c V \ {s, t} 
(Conservation of Flow).
Figure 15.2 shows an (s, t)-flow for the directed network of Fig 15.1. The
label on each arc shows its capacity and the flow through it, in that order. Thus,
the label 12, 10 on arc ac means that this arc has capacity 12 and currently a flow
of 10. Note that the flow fuv in each arc never exceeds its capacity cu, Also
observe that the law of conservation of flow is satisfied at each vertex. Consider
vertex c, for example. The flow away from c is Ev f, = fez = 11 while the flow
into c is Yv f 6 = fac + fbc = 10 + 1 = 11.
a 12, 10 c
,11
t
4,I
b 
2, 1 
d
An (s, t)-flow.
Verify the law of conservation at vertices a, b, and d.
The flow out of the source s equals 10 + 2 = 12 and the flow into the sink
t is 11 + 1, which equals 12 as well. Physically this equality makes sense: Since
conservation of flow means that no flow is lost at any vertex, whatever flow leaves
the source must eventually reach the sink. A general proof follows.
We start with the observation that
E1 fu = E
U, veV 
1i veV
I 
S
Figure 15.2

15.1 Flows and Cuts 
443
and hence,
L fu 
E 
fru = 0.
U, VEV 
UVEV
Summing first over v and then over u, we obtain
(Lfuv 
-
-fu 
0.
uEV VEV 
VeV
Conservation of flow says that the term in the parentheses here is 0, except when
u = s and u = t. Therefore,
fsv -
fvs + Yftv - Yf 
= 0.
v 
I 
v 
v
Hence,
(1) 
fsv - E fvs 
f- t -
Eft
v 
v 
v 
v
The value of a flow .F = Ifuv} in a directed network with source s, sink t, and
vertex set V is the integer
val(F) = E fsv- 
f
vev 
VEV
or, equivalently, by equation (1),
val(.F) = E fIt -
ftv.
vcV 
vUV
The value of a flow is the net amount of flow per unit time leaving the
source, or, equivalently, the net amount of flow per unit time entering the sink. In
the most likely situation where there is no flow into the source and no flow
out of the sink, then fv, = 0 = ftv for all vertices v, so the value of the
flow is
val(JD =E fv 
L fvt
v 
v
This was the case with the network in Fig 15.2; the flow there has value 12.
Our goal in this chapter is to find the (s, t)-flow with the largest possi-
ble value through a given directed network. Such a flow is called a maximum
flow.
With reference to the directed network of Fig 15.2, find a flow whose value
exceeds 12.
In addition to (s, t)-flow, the other important concept in directed networks is
that of an (s, t)-cut.
SM03ESMMM
M

444 
Chapter 15 The Max Flow-Min Cut Theorem
Let V be the vertex set of a directed network with source s and sink t. An (s, t)-
cut is a partition (S, TI of V such that s e S and t E T. The capacity of an
(s, t)-cut IS, T) is the sum cap(S, T) of the capacities of all arcs from S to T:
cap(S, T) = 
E
uGS,vcT
What does it mean to say that {S, T) is a partition of V?
Every path from s to t contains an arc joining a vertex in S to a vertex in E.
Thus, if every such arc is cut, there is no path left from s to t. The flow of goods
or information from s to t has been "cut."
With reference to the network in Fig 15.1, the sets S = (s} and T =
la, b, c, d, t} form an {S, fT-cut. The arcs from S to T are sa and sb: Sev-
ering both of these would eliminate any flow from s to t. Another example is
provided by the sets S = Is, a, c} and T 
{b, d, t). This time, the arcs from S
to T are sb, ad, and ct. Arc bc is not included: It goes from T to S and so can
never affect the flow from s to t.
The capacity of the first cut, { {s), {a, b, c, d, ti }, is Csa +Csb = 10+11 = 21.
The capacity of the cut I s, a, c}, {b, d, tI I is Csb+Cad+Cct = 11+4+11 = 26.
The value of the flow (12) in Fig 15.2 is less than either of these capacities. This
is no accident.
In any directed network, the value of an (s, t)-flow never exceeds the capacity of
any (s, t)-cut.
Proof 
Let F = {fu,) be any (s, t)-flow and IS, Tl any (s, t)-cut. Conservation of flow
tells us that Zv fU -YV f u = 0 for any u c S, u :A s. (The possibility u = t
is excluded because t Â¢ S.) Hence,
val(F) = E fsv -
EJvs
vcV 
vCV
uES veV
= 
E 
fuv
uGSvGV
(since the term in parentheses
is 0 except for u = s)
VEV
E 
fr.
ueS,vEV
Since {S, TI is a partition, this last sum can be written
E 
fuV + 
E 
fuL
ueS, VES 
ueS,veT
EL V
uGS,vGS
ES 
fvu
ueS,vcT
= 
E 
fu -
E 
fL +
ucS,vES 
ueSveS
f1ur- fo11).
ueS, veT
The first two terms in the last line are the same, so we obtain
(2) 
val(Y') = 
L 
(fr -fVU)
uGS,veT
S 
6
6*
CuV.

15.1 Flows and Cuts 445
6~I
But fuv < cuv and fvu > 0, so fu- 
fVU < cuV for all u and v. Therefore,
val(F) < 
E 
cuC = cap(S, T)
U GS, vET
as desired. 
I
Equation (2) relates the value of an (s, t)-flow to any (s, t)-cut. We highlight
this rather surprising fact.
If F is any (s, t)-flow and {S, T} is any (s, t)-cut, then
val(F) = 
E 
(fuv -fU).
UGS,veT
With reference to the network in Fig 15.2 and the cut S = {s, a, c}, 7 =
tb, d, t}, the sum specified in the corollary is
E 
(fuv -fv,) = fb + fad -
fbc + fct = 2 + 0- I + 11 = 12,
uGSveT
which is the value of the flow in this network. We have also the following fun-
damental result about directed networks.
Suppose there exists some (s, t)-flow F and some (s, t)-cut {S, TE such that the
value of F equals the capacity of {S, fT}. Then val(F) is the maximum value of
any flow and cap(S, T ) is the minimum capacity of any cut.
Let F1 be any flow. To see that val(Fl) < val(F), note that the theorem says
that val(Fl) < cap(S, 77) and, by hypothesis, cap(S, T) = val(F). So val(F) is
maximum, as asserted. The proof that cap(S, T ) is minimum is similar and left
to the Exercises. 
I
It turns out that the hypotheses of Corollary 15.1.6 can always be satisfied;
that is, in any directed network, there is always a flow and a cut such that the
value of the flow is the capacity of the cut. By the corollary, such a flow has
maximum value.
The Construction of Flows
We conclude this section with an indication as to how we can construct flows in
a directed network and continue to center our discussion around the network of
Fig 15.1. First locate a path P from s to t (which follows the direction specified
by the arrows on arcs) and define a flow by setting
ff 
1 
if uvEP
UV1 0 if uvP.
Such a flow is called a unit flow because it has value 1. In Fig 15.1, sact is a
path P from s to t for which the unit flow just defined is shown in Fig 15.3.
It is not difficult to see that conservation of flow is guaranteed: If v is a vertex
not on P, then all arcs entering and leaving v have flow 0; if v is on P, there is
Proof

446 
Chapter 15 
The Max Flow-Min Cut Theorem
10.
S
II
,I
,t
4,0
b 
2,0 
d
Figure 15.3 
A unit flow in a network.
precisely one arc entering v which has nonzero flow and precisely one arc leaving
with nonzero flow, and each of these arcs has a flow of 1.
Having obtained one flow, we can continue to increment, by I at a time, the
flow on the arcs of P until we reach the smallest capacity of an arc on the path;
that is, until the path has a saturated arc, meaning one carrying a flow equal to
its capacity.
In our example, we can achieve a flow of 10 on each arc of P, but no larger
number, since at 10, arc sa is saturated. This flow is not by any means maximum,
however: We showed a flow of value 12 in Fig 15.2. By what method can we
obtain such a flow, or any flow of value greater than I 0? We search for another
path, P', from s to t, and a flow in P' such that all f1v are equal and some arc
is saturated.
In Fig 15.4, we show, in addition to a flow through P with a saturated arc,
a flow through the path P': sbdt with the capacity of 2 in each arc and arc bd
saturated. We continue to check every path from s to t. For any such path, we
increase the flow in each arc one unit at a time until the path contains a saturated
arc. We observe that the flow in each arc of the path P": sbct from s to t can be
incremented by 1, as indicated in Fig 15.5.
a 12,10 
c
10
Figure 15.4
a 12,10 
c
'H
'Dt
4, 2
Figure 15.5 
b 
2,2 
d
At this stage, every path between s and t contains a saturated arc, and we
have a flow of value 13. Unfortunately, this is still not a maximum. In fact, there

15.1 Flows and Cuts 
447
A 
-
* **
exists a flow of value 17 (see Fig 15.7) which, as we shall soon see, is maximum
for this network. By what process might this maximum flow be obtained? We
require, and describe in the next section, a refinement of the current technique.
1. The law of conservation holds at a because
E fva = fa= 10 and E 
fav =fa+fad 
=10+0 
-10.
V 
v
It holds at b because ZfVh,b 
= 2 and E 
fbv 
fbc + fbd = 1 + 1 = 2.
V 
V
It holds at d because L 
f d = fad + fbd = 0 + 1 = l and L 
fdv = fdt = 1I
v 
V
2. A flow with value 13 appears in Fig 15.5 and one with value 17 is shown in
Fig 15.7.
3. To say that sets S and T comprise a partition of V is to say that S and T
are disjoint subsets of V whose union is V.
The symbol [BB] means that an answer can be found in the Back of the Book.
1. (a) [BB] Verify the law of conservation of flow at a, e,
and d.
(b) [BB] Find the value of the indicated flow.
(c) [BB] Find the capacity of the (s, t)-cut defined by
S = {s, a, b} and T = {c, d, e, t}.
a 
3,2 
c
4,2 
5,2
s a 
p, 
t
b 
3,3 
d
(d) [BB] Can the flow be increased along the path
sbedt? If so, by how much?
(e) [BB] Is the given flow maximum? Explain.
(f) [BB] Illustrate Corollary 15.1.5 for S and T as in (c).
2. (a)
(b)
(c)
(d)
(e)
Verify the law of conservation of flow at a, e, and d.
[BB] Find the value of the indicated flow.
Find the capacity of the (s, t)-cut defined by S =
Is, a, b, c, d, e} and T = {tl.
Name all saturated arcs.
Is the given flow maximum? Explain.
(I) Illustrate Corollary 15.1.5 for S and T as in (c).
a 4,3 
c
10,6 
6,6
5,
4,,2 
66
b 
6,3 
d
3. (a) Verify the law of conservation of flow at a, c, and d.
(b) Find the value of the indicated flow.
(c) [BB] Find the capacity of the (s, t)-cut defined by
S = {s, a, b, d} and T = {c, e, , t.
a 3,3 c
2t
(d) Is the given flow maximum? Explain.
(e) Illustrate Corollary 15.1.5 for S and T as in (c).
UMM 
0 


448 
Chapter 15 
The Max Flow-Min Cut Theorem
a 
3 
d
3 
i I
S 
t
2 2 
I
C 
2 
f
e
b 
2 
d
(c)
S
d
e
4. (a) Verify the law of conservation of flow at a, b, and e.
(b) Find the value of the indicated flow.
(c) Find the capacity of the (s, t)-cut defined by S
{s, a, c, d} and T = {b, e, t}.
a 
2,1 
b
2,133,0
5,3
6, 2 
4,2
c7.4 d
(d) Can the flow be increased along the path sadt? If
so, by how much? Can it be increased along scdt?
If so, by how much?
(e) Is the given flow maximum? Explain.
(f) Illustrate Corollary 15.1.5 for S and T as in (c).
5. Answer the following questions for each of the networks
shown in Fig 15.6.
i. Exhibit a unit flow.
ii. Exhibit a flow with a saturated arc.
iii. Find a "good" and, if possible, a maximum flow in
the network. State the value of your flow.
6. [BB] Give an example of a flow {f11j} in a directed
network which has the following properties:
. there is no flow into the source or out of the sink;
. not all fur = 0;
. the flow has value 0.
7. [BB] Complete the proof of Corollary 15.1.6 by show-
ing that if a network has an (s, t)-flow Y and an (s, t)-
cut {S, T) such that val(F) = cap(S, T), then cap(S, T)
is the minimum capacity of any cut.
15.2 
CONSTRUCTING MAXIMAL FLOWS
Our goal now is to modify the procedure for constructing flows given at the
end of the previous section in order to construct a maximum flow for a directed
network.
In the theory of directed networks, chain is a more common term than trail
to describe a walk with distinct arcs which can be followed in either direction.
(a) [BB]
(b)
3
6
Figure 15.6

15.2 Constructing Maximal Flows 
449
S 
I
1(
I I
b 
2,2 
d
A maximum flow.
Why does the procedure just described of adding an amount q to the forward
arcs of a chain and subtracting the same amount from the backward arcs preserve
conservation of flow at each vertex?
By checking all possibilities, it can be seen that there are no further flow-
augmenting chains in this network, and, marvelously, this means that a maximum
flow has been achieved! We shall see why shortly, but for now, we content
ourselves with showing that the flow in Fig 15.7 is maximum. For this, we consider
the (s, t)-cut given by S = (s, a, b, c} and T = {d, t}, which has capacity cad +
Cbd+Cct = 4+2+11 = 17. Since the displayed flow has value 17, Corollary 15.1.6
guarantees that it is maximum.
It is important to observe that the vertices of S are exactly those which can be
reached from s by flow-augmenting chains. In addition to s, S includes b (since
fsb = 7 < 11 = CAb) and, therefore, c (since fbc = 5 < 8 = Cb). From c, we are
An arc of a chain is a forward arc if it is followed in the direction of the arrow
and a backward arc if it is followed in a direction opposite that of the arrow. In
Fig 15.5, the chain sbcadt has forward arcs sb, be, ad, and dt, and backward
arc ca.
Given an (s, t)-flow {f,,} in a network, a chain is called flow-augmenting if and
only if f,, < cu, for each forward arc uv of the chain and fur > 0 for each
backward arc.
The chain C: sbcadt from s to t in Fig 15.5 is flow-augmenting because,
checking forward arcs, 3 = fsb < Csb = 11; 1 = fbc < Cbc = 8; 0 = fad < Cad =
4; 2 = fdt < cdt = 14; and, checking the backward arc, 10 
fac > 0.
The term "flow-augmenting" chain derives from the fact that such a chain can
be used to increase flow: increase the flow on each forward arc by some fixed
amount and decrease the flow on each backward arc by the same amount. The
largest "amount" that can be used here is a number called the slack of the chain.
The slack is determined as follows.
Calculate the unused capacity cr 
- f, of each forward arc and the
flow f,, in each backward arc. The slack of the chain is the minimum
of all these numbers.
In our example, the slack is 4, the value of Cad -
fad. Increasing by 4 the
flow in the forward arcs of C and decreasing by 4 the flow in the backward arcs,
we obtain the network and flow shown in Fig 15.7.
a 
12, 6 
c
Figure 15.7
, I )
t
, 6

450 
Chapter 15 The Max Flow-Min Cut Theorem
6
able to continue on a backward arc to a (since fa, = 6 > 0). From a, a backward
arc leads to s, which is already in S. and the forward arc is saturated. The
vertices which can be reached from s by flow-augmenting chains are {s, a, b, c},
precisely the vertices of S. This observation is key to the proof of the famous
Max Flow-Min Cut Theorem of Lester R. Ford Jr. and D. R. Fulkerson.]
Where have you heard Ford's name before?
In a directed network, the maximum value of an (s, t)-flow equals the minimum
capacity of an (s, t)-cut.
Using the procedure just described, we construct an (s, t)-flow Y that does not
contain any flow-augmenting chains from s to t. Corollary 15.1.6 tells us that
the proof will be complete if we can construct an (s, t)-cut {S, T} such that
val(.F) = cap(S, fT).
With the hindsight of our earlier example, we let S be the set of all ver-
tices which can be reached by flow-augmenting chains starting at s (including
s itself) and we let 
' be the set of all remaining vertices. Since there are no
flow-augmenting chains from s to t, it cannot be that t E S, hence t E T. Thus,
{S, T} is an (s, t)-cut.
Let u be any vertex of S and let v be any vertex of T. Because u E S, there
is a flow-augmenting chain from s to u. Since v V S. we conclude that fu, = cuV
and fv, = 0, for otherwise the flow-augmenting chain from s to u (which exists
by definition of S) could be extended to a flow-augmenting chain from s to v.
Now Corollary 15.1.5 tells us that
val(T) = 
E 
(fur -fu)
UES,vcT
= 
E 
(cuv-0) 
cu = cap(S, T).
uGS,vET 
uCS,vGT
Hence, we have found a cut whose capacity equals val(F), proving that T is
maximum. 
I
The proof of this theorem shows that if an (s, t)-flow has the property that
there are no flow-augmenting chains from s to t, then the flow is maximum (a
fact to which we earlier alluded).
Also observe that we have, in this section, provided both a formal algorithm
for constructing a maximum flow and a method for checking that it is maximum
(via the explicit construction of a cut with capacity the value of the flow). We
illustrate with a final example.
PROBLEM 1. 
Find a maximum flow in the directed network shown in Fig 15.8
and prove that it is a maximum.
'L. R. Ford, Jr. and D. R. Fulkerson, "Maximal flow through a network," Canadian Journal of Mathe-
maoics 8 (1956), 399-404.
Proof

15.2 Constructing Maximal Flows 
451
a 
6 
d
2 
4
s 
lb 
e 
9  
t
8 
(5 
2 
/10
c 
3 
f
Figure 15.8 
A directed network.
Solution. 
We start by sending a flow of 2 units through the path sadt, a flow
of 3 units through sbet, and a flow of 3 units through scf t, obtaining the flow
shown on the left in Fig 15.9. Continue by sending flows of 2 units through sbdt
and 2 units through sbf t, obtaining the flow shown on the right.
a 
6,2 
d 
a 
6,2 
d
2
S
8,
2,2 
6,4
s 
107 br3,3ne 9,3 
t
8,3 
c 5,0 
22 
30,5
c 
3,3 
f
Figure 15.9 
Two flows.
At this point, there are no further flow-augmenting chains from s to t involving
only forward arcs. However, we can use the backward arc da to obtain a flow-
augmenting chain scbdaet. Since the slack of this chain is 2, we add a flow of 2
to sc, cb, bd, ae, and et, and subtract 2 from ad. The result is shown in Fig 15.10.
a 
6,0 
d
2,2 
64
10(,7 
3,3 
e 9,5
8, 
15,2 
10,5
Figure 15.10 
c 
3, 3 
f
A search for further flow-augmenting chains takes us from s to c or b and on to
d, where we are stuck. This tells us that the current flow (of value 14) is maximum.
It also presents us with a cut verifying maximality, namely, S = Is, b, c, d) (those
vertices reachable from s by flow-augmenting chains) and T = {a, e, f, t} (the
complement of S). The capacity of this cut is
C,, + Cbe + cbf + Ccf + cdt = 2 + 3 + 2 + 3 + 4 = 14.

452 
Chapter 15 
The Max Flow-Min 
ut Theorem
A -
**
Since this is the same as the value of the flow, we have verified that our flow is
maximum. 
I
Rational Weights
Throughout this chapter there has been the underlying assumption that the weights
attached to arcs are nonnegative integers. In fact, there is no additional complica-
tion if capacities are arbitrary rational numbers since any problem related to such
a network is equivalent to a problem in the related network (where capacities are
integral) obtained by multiplying all capacities by the least common multiple of
the denominators.
Even if some capacities are not rational, the Max Flow-Min Cut Theo-
rem is still true, but the proof we have given breaks down. In fact, Ford and
Fulkerson2 exhibit a small network with irrational capacities and the following
properties:
.
there is a flow, not maximum, for which the process we have described
of obtaining flows of higher value via flow-augmenting chains never termi-
nates;
* the infinite sequence of flows (of higher and higher value) does, however,
converge, to a flow of some value Q; but
.
the maximum value of a flow is 4Q.
4. The flow on the arcs incident with a vertex not on the chain are not changed, so
conservation of flow continues to hold at such a vertex. What is the situation
at a vertex on the chain? Remember that a chain in a directed network is just
a trail whose edges can be followed in either direction; thus, each vertex on
a chain is incident with exactly two arcs. Suppose a chain contains the arcs
uv, vwv (in that order) and that the flows on these arcs before changes are f,
and f10,. There are essentially two cases to consider.
Case 1: Suppose the situation at vertex v in the network is u -* 
v -* 
w.
In this case, both Uv and vw are forward arcs, so each has the flow
increased by q. The total flow into v increases by q, but so does the total
flow out of v, so there is still conservation of flow at v. (The analysis is
similar if the situation at v is u -- v <-- w.)
Case 2: The situation at v is u -* 
v w- U).
Here the flow on the forward arc uv is increased by q and the flow on
the backward arc wvv is decreased by q. There is no change in the flow
out of v. Neither is there any change in the flow into v since the only
terms in the sum Or 
fr which change occur with r = u1 and r = uw, and
these become, respectively, f,,v + q and f v,, -q. (The analysis is similar
if the situation at v is u Ã·- v -1 wp.)
5. Ford was one of the co-discovers of the "Bellman-Ford" shortest path algo-
rithm. See Section 11.2.
2L. R. Ford, Jr. and D. R. Fulkerson, Flows in Networks, Princeton (1962). p. 21.

15.2 Constructing Maximal Flows 
453
The symbol [BB] means that an answer can be found in the Back of the Book.
1. Answer the following two questions for each of the
directed networks shown.
i. Show that the given flow is not maximum by finding
a flow-augmenting chain from s to t. What is the
slack in your chain?
ii. Find a maximum flow, give its value, and prove that
it is maximum by appealing to Theorem 15.2.2.
a 
3,2 
d
2, 2
3, 1o
3,2
2,0 
1, 0
k 
I
b 
1,I 
e
2,0 
1,0
i
4, 2
3,1
24,2
c 
3.2 
f
a 
2, 2 
b
s 
1,3 
t
C 
I'l 
d
(e) 
a 
,
2. [BB; (a)] Find a maximum flow for each of the networks
in Exercise 5 of Section 15.1. In each case, verify that
your flow is maximum by finding a cut whose capacity
equals the value of the flow.
3. Find a maximum flow for each of the networks shown
in Fig 15.11. In each case, verify your answer by find-
ing a cut whose capacity equals the value of the
flow.
4. Shown are two networks whose arc capacities are ratio-
nal but not always integral. Use the idea suggested at
the end of this section to find a maximum flow in each
of these networks. In each case, state the maximum flow
value.
(c)
(a) [BB]
t
(d) [BB]
6,
7,
(b)
(a) [BB]
ff VNI-ITUTM
Is
t

454 
Chapter 15 
The Max Flow-Min CutTheorem
(a) [BB]
S
6 
4
(b) 
(c)
86 
6
2 
4 
3
.5< 
X 
X> 
<1 
t 
s
9 
~ <8
8 
5
(d) 
9 
(e)
14 
48
6 
5
8
t
6
Figure 15.11 
Graphs for Exercise 3.
15.3 
APPLICATIONS
Obvious examples of directed networks include the intake and waste systems
of plumbing in a house, oil and natural gas pipelines, telephone and electrical
networks, mail courier services, and the flow of people through some system of
tunnels. There are, however, less obvious applications, some of which we shall
discuss here. One, a problem of supply and demand, will be discussed in detail;
the others are merely sketched.
Multiple Sources and/or Sinks
Some directed networks have several sources and/or several sinks (an electronic
mail network, for instance). Such networks can be handled easily by adding two
new vertices, s and t, drawing an arc from s to each source and an arc from
each sink to t, and putting a sufficiently large capacity on each of these new
arcs so that their presence does not change the various possibilities for flow
through the original network. A maximum (s, t)-flow in this new network will
give a maximum flow in the other network, simply by forgetting about the added
arcs. We shall see a worked example of this sort in conjunction with our next
application.
t
t

15.3 Applications 
455
Supply and Demand Problems
A small Alberta department store chain maintains three warehouses A, B, and C
in the south of the province and three stores D, E, and F in rural communities
in the far north. The warehouses have, respectively, 500, 500, and 900 snow
blowers in stock on October 1. The first blizzard of winter is forecast to start near
midnight, October 2, and there is an immediate demand from the stores for 700,
600, and 600 snow blowers, respectively. Various routes are available for shipping
merchandise to the stores. These are shown in Fig 15.12, where the capacity of
an arc uv is the largest number of snow blowers that can be shipped from u to v
in the course of a single day.
6 
6 
-
A
B
C
E
F
Figure 15.12 
A supply and demand network (capacities are in hundreds).
The vertices in the middle should be thought of as "middlemen," baggage
handlers, for example, who can only cope with so many snow blowers at once.
We will assume that freight can cover as many arcs as necessary in a single day.
Can all the required snow blowers reach the stores before the blizzard arrives? If
not, how close can the company come to satisfying demand?
The first step in solving this problem is to view it as one with three sources
and three sinks. Following the plan proposed earlier, we add a new source s joined
to each of A, B, C and a new sink t to which D, E, and F are joined. We assign
to each of the arcs incident with s a capacity equal to the number of snow blowers
present at the given warehouse and to each arc incident with t a capacity equal
to the number of snow blowers demanded at the given store. The new network is
shown on the left in Fig 15.13.
A 
6 
6 
n 
A 
6, 5 
G 6,6 
n
S
5,5 
1, 
3.0 
7,6
t 
S 
tH-63
9,5 
3,1 5 
, 
,3
'- 
6 
5 
3 
'-O , " IJ). 4 J 
.53 
I
Figure 15.13 
A supply and demand network and a maximum flow (capacities and flows in hundreds).
The network we have constructed has a nice physical interpretation. Imagine
a new giant warehouse s containing all 1900 snow blowers. The labels on the

456 
Chapter 15 The Max Flow-Min Cut Theorem
arcs from s indicate the number of snow blowers that can be transferred to each
warehouse if need be. Similarly, we have created a single sink which could take
up to 1900 snow blowers. The routing of these machines will indicate which
demands are actually met.
Applying the Max Flow-Min Cut procedure of the previous section, we
obtain the maximum flow for our network shown on the right in Fig 15.13. We
know that the flow is maximum because the cut
S = {s, B, C, I, J}, 
T = {A, G, H, D, E, F, t}
has capacity cap(S, T) = 500 + 100 + 500 + 100 + 300 = 1500, which is the
value of the flow.
We conclude that the snow blowers cannot all be delivered before the blizzard
arrives; in fact, the best one can do is to deliver 1500. On the right of Fig 15.13,
we see one routing by which this occurs, one in which stores D and E receive
600 snow blowers each while store F receives 300. This solution is not unique,
however. For example, some of the snow blowers destined for E could be diverted
to F via arc HF. Such a modification in shipping arrangements could be justified
on the grounds that F is currently receiving only half of its requirements while
the demands of E have been completely met.
Undirected Edges
Suppose a network contains some edges which are undirected. (Some of the pipes
allow flow in two directions.) This turns out to be an easy situation to han-
dle. Replace each undirected edge xy by two directed arcs, xy and yx, each
having the same capacity as the original undirected edge. Two examples are
presented in the exercises (Exercise 5). For these, it is easiest just to "imag-
ine" two arcs, one going each way, rather than to draw them physically on the
graph.
Edge Disjoint Paths
In order to deliver an important message, messengers are to be sent from s to t via
a network of roads. Because terrorists are active in the area, it is prudent for the
messengers to use different roads. What is the largest number of messengers that
can be sent, subject to this constraint? Equivalently, how many edge disjoint paths
are there from s to t? A beautiful theorem of Karl Menger, which is essentially a
corollary of the Max Flow-Min Cut result (Theorem 15.2.2) (though it was first
established much earlier), answers this question.
(Menger 3) The maximum number of edge disjoint paths between two vertices s
and t in a graph is the minimum number of edges whose removal leaves no path
between s and t.
3K. Menger, "Zur aligemeinen Kurventheorie," Fundamenta Matheliaticae 10 (1927), 95- 115.
S.

15.3 Applications 457
EXAMPLE 2 
Consider the graph shown to the right.
The removal of edges ab and cf severs all
paths from s to t and, by inspection, we see that
the removal of no single edge achieves this.
Thus, the minimum number of edges required 
S
to cut all paths from s to t is two. Note that
sabt and scfbgt are two edge disjoint paths
trom s to t. According to Menger's Theorem, 
a 
b
there do not exist more than two edge disjoint
paths, a fact easily checked. 
A
To obtain this result from the Max Flow-Min Cut Theorem, we convert the
given graph to a network by replacing each edge between vertices v and w by
arcs vw and wv, each of capacity 1, and then argue that a maximum flow in this
network is precisely the number of edge disjoint paths from s to t. We refer you
to Dantzig and Fulkerson4 for details.
In Section 15.2, we developed a procedure for finding a maximum flow in
a network. Therefore, we have an algorithm for finding all the edge disjoint
paths in a graph. Be forewarned that the application of this algorithm with-
out computer assistance may not be easy. While it is simple for a computer
to take account of arcs in each direction between two vertices (via the adjacency
matrix, for instance), as we mentioned in connection with undirected edges, it
is better when proceeding by hand just to imagine the arcs rather than trying to
draw them.
Job Assignments
Suppose there are m people PI, P2,..., Pm, and n jobs J1, J2, 
J
. 
, and that
only certain people are qualified for certain jobs. Is it possible to assign to each
person a job for which he or she is qualified? If not, how close can we come? We
represent this problem as a network in Fig 15.14.
Pt. 
J
P2  
J
s 
--- ---- 
t
Figure 15.14 
Pm 
In
A source s is joined to each person by an arc having capacity I and each
job is joined to t by an arc having capacity I also. If person Pi is qualified for
job Jk, then these vertices are joined and given any nonzero integer capacity. (A
capacity of I is fine, but in the next section, we will see that other capacities are
4G. B. Dantzig and D. R. Fulkerson, "On the Max Flow-Min Cut Theorem of Networks," Linear
Inequalities and Related Systems, 215-221. Annals af Mathematics Studies, no. 38, Princeton University
Press, Princeton, N. J., 1956.
t

458 
Chapter 15 The Max Flow-Min Cut Theorem
sometimes useful as well.) A maximum flow through this network will provide
the best possible set of job assignments.
The symbol [BB] means that an answer can be found in the Back of the Book.
1. [BB] In the figure, warehouses a, b, and c have sup-
plies of 30, 20, and 10 Klein bottles, respectively; retail
outlets d and e require 30 and 25 Klein bottles, respec-
tively. The capacities on arcs represent the maximum
number of Klein bottles which can be shipped along that
path. Can the demand be met? If not, find the maximum
number of Klein bottles which can be sent.
5. Find a maximum flow for each of the following net-
works. (Note that some edges are undirected.)
(a) [BB]
20
25
15
15
10
F20
15
10
It) 
5s
I( 
-
20 
1o 
20
A 
10 
5 
) d
10 
10
20 
25
B
10 
10 
10
20 
15
2. Repeat the previous question after reversing the arrow
on edge AB.
3. [BB] Four warehouses A, B, C, and D with monthly
shipping capacities of 4, 10, 3, and 2 units, respectively,
are linked via the network shown to three retail outlets
E, F, G whose monthly requirements are 4, 5, and 6
units, respectively. The monthly capacity of each link
in the network is as indicated.
A 
3 
3
2 
E
B 
64
2 
F
CC
D4
Can these warehouses meet the needs of the retail out-
lets? If not, find the maximum number of units which
the three outlets (combined) can receive in a month.
Explain your answer.
4. Answer the previous question again, this time assuming
that the arc is ab, not ba.
(b)
s
6. Verify Menger's Theorem, Theorem 15.3.1, for the pla-
nar graph of the cube with s and t as shown.
5
7. [BB] The diagram represents a system of roads from A
to B. The mayor of town A wishes to send a message
to the mayor of town B, and since all other means of
communication are tapped, he sends out a certain num-
ber of trusted individuals on foot. If all paths taken by
the individuals are to be disjoint, how many messengers
can he employ?
A
B
8. Repeat Exercise 7 for the following network of roads.
cc
It).
10
b10
10,
ffvr.-= g 
I __ - I - -__ I -__ -  -
I  __
t
3P.
u
t

15.4 Matchings 459
9. [BB] Venty Menger's Theorem for the complete graph
EnC.
10. Verify Menger's Theorem for the complete bipartite
B 
graph ACn,m in each of the following cases.
(a) vertices s and t lie in the bipartition set of order n
(b) vertices s and t lie in different bipartition sets
S
EXAMPLES 3
In Section 15.3, we saw how the procedure we have described for finding a
maximum flow could be applied to the problem of assigning jobs to job appli-
cants. Actually, this is just one example of a whole host of problems concerning
matchings in graphs. We take a brief look at this area in this section.
A matching in a graph is a set of edges with the property that no vertex is incident
with more than one edge in the set. A vertex which is incident with an edge in
the set is said to be saturated. A matching is perfect if and only if every vertex is
saturated; that is, if and only if every vertex is incident with precisely one edge
of the matching.
In the graph shown on the left in Fig 15.15,
.
the single edge bc is a matching which saturates b and c, but neither a nor d;
* the set {bc, bd} is not a matching because vertex b belongs to two edges;
* the set {ab, cd} is a perfect matching. 
A
Ul 
U2 
U3
a 
b
Cd
Figure 15.15
EXAMPLES 4
VI 
V2 
V3 
V4
Edge set lab, cd) is a perfect matching in the graph on the left. In the graph on the right, edge
set (ulv2, u2v4, u3vl} is a matching which is not perfect.
It is worth noticing that if a matching is perfect, the vertices of the graph
can be partitioned into two sets of equal size and the edges of the matching
provide a one-to-one correspondence between these sets. In the graph on the left
in Fig 15.15, for instance, the edges of the perfect matching {ab, cd} establish a
one-to-one correspondence between {a, c} and {b, d}: a e- b, c H- d.
In the graph on the right of Fig 15.15,
* the set of edges {uIv2, U2V4, u3v11 is a matching which is not perfect but
which saturates VI 
{ul, u2, U3};
.
no matching can saturate V2 = {vl, V2, V3, V4} since such a matching would
require four edges, but then at least one ui would be incident with more than
one edge. 
A
15.4 
MATCHINGS

460 
Chapter 15 
The Max Flow-Min 
ut Theorem
Any assignment of workers to jobs in the job assignment application of
Section 15.3 is a matching since no worker is given two jobs and each job is
filled by at most one worker. In this case, we are thinking of the graph whose
vertices correspond to workers and jobs and where edges join workers to jobs
for which they are qualified. This graph is bipartite, and our discussion here will
initially be restricted just to this type of graph. Later we will comment briefly on
matchings for arbitrary graphs.
Let g be a bipartite graph with bipartition sets VI and V2 and assume that
IV I < IV21. Thinking of VI as "workers" and V2 as "jobs," we can follow the
procedure outlined at the end of Section 15.3 to obtain a maximal matching for
A, that is, a matching which saturates as many vertices as possible. One question
remains unanswered, however-is every vertex in VI saturated by this maximal
matching? In the language of job assignments, was every worker successful in
finding a job?
Clearly, if there are more workers than jobs-I VI I, I V2 1-it would be impos-
sible to employ everybody. Thus, the condition IVI I < IV21 is necessary for VI to
be saturated. More generally, if for any subset of k workers, the number of jobs
for which they are collectively qualified is less than k, then again it would be
impossible to employ everybody. In other words, if X is any subset of VI and we
define A(X) to be the set of all vertices in V2 which are adjacent to a vertex in X,
A(X) = {v E V2 I vx is an edge for some x E XI,
then we require IXI < IA(X)I.
CAMAIVIrLC 
in tne ngure to tne rignt, It A = WuI, U2, U4J,
then A(X) = {V3, v4}. Since IXI S IA(X)I, the
workers in X cannot all find jobs for which
they are qualified. There is no matching in this
graph which saturates VI. 
A
V1
-
- I 
I I-
It is surprising that the so obviously necessary condition IXI < IA(X)l for
all X C VI is also sufficient for the existence of a matching which saturates VI.
This was discovered in 1935 by the English mathematician Philip Hall.
0*
(Ha/15) If g is a bipartite graph with bipartition sets VI and V2, then there exists
a matching which saturates VI if and only if, for every subset X of VI, IXI <
IA(X)I.
Proof 
It remains to prove that the given condition is sufficient, so we assume that
IXI < IA(X)I for all subsets X of VI. In particular, this means that every vertex
in VI is joined to at least one vertex in V2 and also that IVI I < IV21. Assume that
there is no matching which saturates all vertices of VI. We derive a contradiction.
We turn g into a directed network in exactly the same manner as with the job
assignment application of Section 15.3. Specifically, we adjoin two vertices s and
t to g and draw directed arcs from s to each vertex in VI and from each vertex
in V2 to t. Assign a weight of I to each of these new arcs. Orient each edge of
5 P. Hall, "On representations of subsets," Journal ofthe London Mathematical Society 10 (1935), 26-30.

15.4 Matchings 461
G from its vertex in VI to its vertex in V2, and assign a large integer I > IVI I
to each of these edges. As noted before, there is a one-to-one correspondence
between matchings of G and (s, t)-flows in this network, and the value of the
flow equals the number of edges in the matching.
Since we are assuming that there is no matching which saturates VI, it follows
that every flow has value less than VVII and, hence, by the Max Flow-Min Cut
Theorem, there exists an (s, t)-cut {S. T) (s c S. t E T) whose capacity is less
than IVI.
Now every original edge of G has been given a weight larger than I VI I. Since
the capacity of our cut is less than [VI 1, no edge of G can join a vertex of S to
a vertex of T. Letting X = V1 n S, we have A(X) C S. Since each vertex in
A(X) is joined to t C T, each such vertex contributes 1 to the capacity of the cut.
Similarly, since s is joined to each vertex in VI \ X, each such vertex contributes
1. Since JXJ < IA(X)I, we have a contradiction to the fact that the capacity is
less than I V 1j. 
I
Theorem 15.4.2 is often called Hall's Marriage Theorem and stated in the
following way:
Given a set of boys and a set of girls some of whom know some of
the boys, then the girls can get married, each to a boy she knows, if
and only if any k of the girls collectively know at least k boys.
PROBLEM 6. 
Let G be a bipartite graph with bipartition sets VI, V2 in which
every vertex has the same degree k. Show that G has a matching which satu-
rates VI.
Solution. 
Let X be any subset of VI and let A(X) be as defined earlier. We
count the number of edges joining vertices of X to vertices of A(X). On the one
hand (thinking of X), this number is kiXi. On the other hand (thinking of A(X)),
this number is at most kIA(X)J since klA(X)J is the total degree of all vertices
in A(X). Hence, kJXJ < kIA(X) , so JXJ < A(X)J and the result follows from
Hall's Theorem. 
I
Can you conclude from this problem that g also has a matching which saturates
V2? More generally, does 5 have a matching which saturates both VI and V2 at
the same time (a perfect matching)?
Imagine a police captain standing in front of all the police constables in her
precinct. She wishes to divide her troops into pairs for patrol duty, but there
are restrictions on how this can be carried out because certain constables do not
work well with certain other constables. Is it possible for the captain to pair her
constables in such a way that all restrictions are met and, if not, how close can
she come?
It is easy to see how graph theory can be used here. We make a graph in which
vertices represent police constables and an edge indicates that the corresponding
constables can be paired. A perfect matching of this graph would give a pairing of
the type desired. Failing this, we seek a matching containing as many pairings as
possible. Notice that in this situation, there is no reason for the graph to be bipartite.
We are most interested in determining whether or not an arbitrary graph
G has a perfect matching, that is, one which saturates every vertex. A theorem

462 
Chapter 15 
The Max Flow-Min Cut Theorem
...
. 
S
giving necessary and sufficient conditions, similar in spirit to Theorem 15.4.2, was
established by Tutte in 1947,6 but we content ourselves here with one example of
a sufficient condition. For this, we require the following proposition, the proof of
which is left to the exercises.
Let g be a graph with vertex set V.
1. If g has a perfect matching, then IVI is even.
2. If g has a Hamiltonian path or cycle, then g has a perfect matching if and
only if IVI is even.
It is now easy to prove our sample result.
If 5 is a graph with vertex set V, IVI is even, and each vertex has degree d > 2JVJ,
then g has a perfect matching.
Proof 
If IVJ = 2, then g is o-o, which clearly has a perfect matching. If IVI >
4, then Dirac's Theorem (10.2.4) tells us that 5 is Hamiltonian, and part 2 of
Proposition 15.4.3 gives us the answer. 
I
A 
* 
* **
6. Yes, the same argument works. But more easily, note that since g is bipartite,
the sum of the degrees of vertices in VI must equal the sum of the degrees
of vertices in V2. Since all vertices have the same degree, we conclude that
I VI = I V2 1, so a matching which saturates VI must automatically saturate V2
as well, and vice versa.
The symbol [BB] means that an answer can be found in the Back of the Book.
1. [BB] Five ladies have men friends as shown in the fol-
lowing table.
Lady 
Men Friends
Karen 
David, Stuart, Paul, Roger
Mary 
Stuart, Philip
Aurie 
David, Paul
Pamela 
Paul, Roger
Lynne 
Stuart, Paul
Draw a bipartite graph depicting this situation. Find a
way in which each lady can marry a man she knows, or
use Hall's Marriage Theorem to explain why no such
matching exists.
2. Repeat the previous question with reference to the fol-
lowing table.
Lady 
Men Friends
Karen 
Stuart, Paul
Mary 
Philip, Stuart
Aurie 
David, Paul, Roger, Stuart
Pamela 
Philip, Paul
Lynne 
Stuart, Philip, Paul
3. [BB] Determine whether or not the graph has
a perfect matching.
6See J. A. Bondy and U.
(1976), 76ff.
S. R. Murty, Graph Theory with Applications, North-Holland, New York

15.4 Matchings 
463
8
7 
6
4. Angela, Brenda, Christine, Helen, Margaret, Phyllis, and
Renee are seeking to fill eight vacant managerial posi-
tions A, B, C, D, E, F, G, and H. Angela can fill A,
B, and F; Brenda can fill B, C, and F; Christine can
fill C, E, and A; Helen can fill D, G, and H; Margaret
can fill E, A, and F; Phyllis can fill F, A, and C; Ren~e
can fill C, E, and F.
(a) [BB] Show that it is not possible for all seven
women to fill managerial positions by showing
that the condition 
in Theorem 15.4.2 
is 
not
satisfied.
(b) Find a matching which allows as many women as
possible to fill positions.
5. (Based upon a problem of Tucker7 ) New Horizons Dat-
ing Service has 13 male and 13 female clients. Each of
the male clients selects five females that he would like
to date, and each female selects five males. By coinci-
dence, it is discovered that every choice is mutual; that
is, a male selected a certain female if and only if that
female selected that male.
(a) Show that it is possible to match the couples into 13
different pairs, following the aforementioned selec-
tions.
(b) Show that it is possible to repeat the matching pro-
cedures given in (a) on five consecutive nights such
that no individual dates the same person twice.
6. Bruce, Edgar, Eric, Herb, Maurice, Michael, Richard,
and Roland decide to go on a week-long canoe trip in
Labrador. They must divide themselves into pairs, one
pair for each of four canoes. The following table indi-
cates those people who are willing to paddle with each
other.
(a) [BB] Find a way of dividing the campers into four
canoes.
(b) Explain why it is impossible to find a pairing in
which Roland and Bruce share a canoe.
(c) Halfway through the trip, Roland decides that he
cannot share a canoe with Eric and Edgar refuses to
7See Chapter 10 of Alan Tucker, Applied Combinatorics, Wiley (New York), 1980.
share a canoe with Herb. Is it now possible to find
a suitable matching?
Bruce Edgar Eric Herb Maurice Michael Richard Roland
Bruce 
/ 
/ 
A
Edgar 
/ 
i 
/
Eric 
i 
/ 
1
Herb 
v" 
/
Maurice 
/ 
A 
$
Michael 
/ 
/
Richard 
$ 
/
Roland 
/ 
/ 
i 
/
7. (a) [BB] Given a set S and n subsets Al, A2 , . 
,
of S, it is possible to select distinct elements sl,
S2, . . ., S, of S such that sl e Al, s2 E A2, .
,
s, E A, if and only if, for each subset X of (I,
2, ... , n) the number of elements in UXEX Ax is at
least lXI. Why?
(b) In a certain game of solitaire, the 52 cards of a
standard deck are dealt face up into 13 columns
of 4 cards each. Show that it is always possible to
select 13 cards, one of each of the 13 denominations
2, 3, ... , 10, Jack, Queen, King, Ace, including at
least one card from each column.
[This problem comes from an article entitled "Mar-
riage, Magic and Solitaire" by David B. Leep and Gerry
Myerson, which appeared in the American Mathematical
Monthly, Vol. 106 (1999), no. 5, 419-429.]
8. Suppose VI, V2 are the bipartition sets of a bipartite
graph g. Let m be the smallest of the degrees of the
vertices in VI and M the largest of the degrees of the
vertices in V2. Prove that if m > M, then 5 has a match-
ing which saturates VI.
9. (a) [BB] Suppose VI and V2 are the bipartition sets in
a bipartite graph G. If V, I > IV2 l, then it is clearly
impossible to find a matching which saturates VI.
State a result which is applicable to this case and
give a necessary and sufficient condition for your
result to hold.
(b) How should your result in (a) be interpreted when
applied to the job assignment problem?
10. (a) [BB] Determine necessary and sufficient conditions
for the complete bipartite graph KC,,n to have a per-
fect matching.
(b) In those cases where ICm,n does not have a perfect
matching, find a matching which saturates as many
vertices as possible.

464 Chapter 15 
The Max Flow-Min Cut Theorem
11. Let g be a bipartite graph with bipartition sets VI, V2 and
assume that g has a perfect matching. Add two vertices
x and y to 5 such that x is adjacent to all vertices in V1,
y is adjacent to all vertices in V2, and x is not adjacent
to y.
(a) Show that 5 U {x, y} is bipartite.
(b) Show that 5 U {x, yl has a perfect matching.
12. (a) [BB] Show that the complete graph IC, has a perfect
matching if and only if n is even.
(b) Let e be a fixed edge in IC,,, where n > 2. Does the
result in (a) still hold for IC, \ {e}? Explain. What if
n = 2?
13. Prove Proposition 15.4.3.
14. [BB] Is the converse of Proposition 15.4.3(1) true?
Explain.
15. [BB] Is the converse of Theorem 15.4.4 true? Explain.
16. Prove that if a tree has a perfect matching, then that
matching is unique.
p 
pa 
I
1. (a)
(b)
(c)
(d)
(e)
Verify the law of conservation of flow at a and at e.
Find the value of the indicated flow.
Find the capacity of the (s, t)-cut defined by
S = {s, a, b}, T = (c, d, e, f, t}. Illustrate Corol-
lary 15.1.5 for this cut.
Can the flow be increased along the path sbf t?
Is the given flow maximum?
S
a 
4,2 
d
2,1 
f
2. In the directed network of Exercise 1, assume that the
flow along each of the paths sbdt and scft has been
increased by one unit.
(a) Show that every path from s to t now contains a
saturated arc.
(b) Despite (a), show that sbeadt is a flow-augmenting
chain from s to t. What is the slack in this chain?
(c) Find a maximum flow for this directed network, give
its value, and prove that it is maximum by appealing
to Theorem 15.2.2.
3. Find a maximal (s, t)-flow. Verify your answer by find-
ing an (s, t)-cut whose capacity equals the value of the
flow.
5
4. One example of an (s, t)-cut in a directed network with
vertex set V is the case S = {s}, T = V \ {s}. Assume
you have a flow in a directed network and you dis-
cover that the capacity of the cut just mentioned equals
the value of the flow. Prove that every arc leaving s
must be saturated. (You may assume no flow is going
into s.)
5. Four warehouses A, B, C, D with shipping capacities 6,
8, 7, 9, respectively, are linked via the network shown
to four retail outlets E, F, G, H with requirements 5,
4, 9, 7, respectively. Can these requirements be met? If
not, find the maximum number of units which the four
outlets (combined) can receive.
A
B
C
D
E
F
G
H
t

Review Exercises 465
6. Find a maximum flow.
7. (a) Which graphs have the property that for any pair
of vertices s and t, the number highlighted by
Menger's Theorem is 1?
(b) Which Hamiltonian graphs have the property that
for any pair of vertices s and t, the number high-
lighted by Menger's Theorem is 2?
8. The six teams entering the final round of the World
Hockey Championships are Canada, Finland, Russia,
Slovakia, Romania, and the United States. Albert, Bruce,
Craig, Camelia, Oana and Yuri wish to bet with each
other on who the winner will be and, ideally, they would
like to all select different teams. The teams that each
bettor is willing to support are shown in the follow-
ing table.
Bettor 
Teams
Albert 
Canada, Finland, Slovakia, USA
Bruce 
Slovakia, Romania
Craig 
Russia, Slovakia
Camelia 
Russia, Romania
Oana 
Canada, Finland, Russia, Romania, USA
Yuri 
Russia, Slovakia, Romania
Can these people indeed bet on different teams? Give
such a selection or use Hall's Marriage Theorem to
explain why such a selection is impossible.
9. Do Exercise 8 again with assumptions as before but for
three exceptions:
. Albert is now happy not to bet on Finland,
. Oana will no longer bet on Russia or Romania, and
. Bruce is now willing to bet on Canada.
10. Let g be a connected graph, every vertex of which has
degree 2. Prove that g has a perfect matching if and
only if g has an even number of vertices.
11. Let g be a connected graph every vertex of which has
degree 3.
(a) Show that g must have an even number of vertices.
(b) Must 9 have a perfect matching?

Solutions to Selected Exercises
Exercises 1.1
1. (a) True, because both 4 = 2 + 2 and 7 < 
50 are true statements.
(c) True, because both hypothesis and conclusion are true.
(e) True, because this is an implication with false hypothesis.
(g) False, because the hypothesis is true but the conclusion is false.
2. (a) This is true: The hypothesis is true only when a > b and b > a, that is, when a = b, and then the conclusion is also
true.
3. (a) a2 < 0 and a is a real number (more simply, a = 0).
(c) x &L I and x 5&-1.
(e) There exists a real number x such that n < x for every integer n.
(g) Every planar graph can be colored with at most four colors.
(i) 
There exist integers a and b such that for all integers q and r, b + qa + r.
4. (a) Converse: If 
is an integer, then a and b are also integers.
b 
c
Contrapositive: If 
is not an integer, then ' is not an integer or b is not an integer.
(c) Converse: A connected graph is Eulerian.
Contrapositive: If a graph is not connected, then it is not Eulerian.
(e) Converse: A four-sided figure is a square.
Contrapositive: If a figure does not have four sides, then it is not a square.
5. (a) There exists a continuous function which is not differentiable.
(c) For every real number x, there exists a real number y such that v > x.
(e) For every positive integer n, there exist primes pi, P2, 
pi such that n = pi P2 
Pt
Exercises 1.2
1. (a) Hypothesis: a and b are positive numbers; Conclusion: a + b is positive.
2. 
This statement is true. Suppose the hypothesis, x is an even integer, is true. Then x = 2k for some other integer k.
Then x + 2 = 2k + 2 = 2(k + I) is also twice an integer. So x + 2 is even. The conclusion is also true.
6. 
The converse is the statement, "A continuous function is differentiable." This is false.
8. 
A is true. It expresses the fact that every real number lies between two consecutive integers. Statement B is most
definitely false. It asserts that there is a remarkable integer n with the property that every real number lies in the unit
interval between n and n + 1.
11. (a) Case I: a is even. In this case, we have one of the desired conclusions.
Case 2: a is odd. In this case, a = 2m + I for some integer m, so a + I = 2m + 2 = 2(m + 1) is even, another
desired result.
(b) n2 + n = n(n + I ) is the product of consecutive integers one of which must be even; so n2 + a is even.
13. 
2x2 - 4x + 3 = 2(x2 - 2x) + 3 = 2[(x -
1)2 -
11 + 3 = 2(x -1)2 + I is the sum of I and a nonnegative number.
So it is at least I and hence positive.
S-1

S-2 
Solutions to Selected Exercises
15. 
(-*) To prove this direction, we establish the contrapositive, that is, we prove that n odd implies n2 odd. For this, if
n is odd, then n = 2m + I for some integer m. Thus n2 = 4m2 + 4m + I = 2(2m2 + 2m) + I is odd.
(<-) 
Here we assume that n is even. Therefore, n = 2m for some integer m. So n2 = (2m)2 = 4m2 = 2(2m2) which
is even, as required.
17. 
Since n is odd, n = 2k + 1 for some integer k.
Case l: k is even.
In this case k = 2m for some integer m, so n = 2(2m) + I = 4m + 1.
Case 2: k is odd.
In this case, k = 2m + 1 for some integer m, so n = 2(2m + 1) + I = 4m + 3.
Since each case leads to one of the desired conclusions, the result follows.
20. 
Since 0 is an eigenvalue of A, there is a nonzero vector x such that Ax = 0. Now suppose that A is invertible. Then
A- (Ax) = A 1o = 0, so x = 0, a contradiction.
22. 
Observe that (I + a)(I + b) = I + a + b + ab = 1. Thus I + a and I + b are integers whose product is 1. There are
two possibilities: 1 + a = I + b = 1, in which case a = b = O, or 1 + a = I + b = -1, in which case a = b = -2.
24. 
We begin by assuming the negation of the desired conclusion; in other words, we assume that there exist real numbers
x, y, z which simultaneously satisfy each of these three equations. Subtracting the second equation from the first we
see that x + 5y -4z = -2. Since the third equation we were given says x + 5y -
= 0, we have x + 5y -
4z equal
to both 0 and to -2. Thus, the original assumption has led us to a contradiction.
25. (a) False: x = y = 0 is a counterexample.
(c) False: x = 0 is a counterexample.
(e) False: a = b = vf is a counterexample.
27. (a) Since n 2 + I is even, n2 is odd, so n must also be odd. Writing n = 2k + 1, then n2 + I = 2m says 4k 2 +4k+2
so m = 2k 2 + 2k + I = (k + 1)2 + k2 is the sum of two squares as required.
2m,
(b) We are given that n2 + I = 2m for n = 4373 and m = 9561565. Since n = 2(2186) + 1, our solution to (a) shows
that m = k2 + (k + 1)2 where k = 2186. Thus, 9561565 = 21862Â±+ 21872.
Exercises 1.3
1. (a)
(d)
P 
q-qI 
(-q) v p 
p A ((-q) v p)
T 
T 
F 
T 
T
T 
F 
T 
T 
T
F 
T 
F 
F 
F
F 
F 
T 
T 
F
-
-q 
rI 
-q 
p v (-q) - (p v (-q)) 
-p 
(-p) v r 
(- P v (-q))) A ((-p) V r)
T 
T 
T 
F 
T 
F 
F 
T 
F
T 
T 
F 
F 
T 
F 
F 
F 
F
T 
F 
T 
T 
T 
F 
F 
T 
F
T 
F F 
T 
T 
F 
F 
F 
F
F 
T 
T 
F 
F 
T 
T 
T 
T
F 
T 
F 
F 
F 
T 
T 
T 
T
F 
F 
T 
T 
T 
F 
T 
T 
F
F F 
F 
T 
T 
F 
T 
T 
F

Section 1.4 
S-3
p 
q 
r 
p- q 
q- r 
(p- q)A(q- r) p- r [(P- q)A(q- 
-r)] 
-
[p-- r1
T 
T 
T 
T 
T 
T 
T 
T
T 
T 
F 
T 
F 
F 
F 
T
T 
F 
T 
F 
T 
F 
T 
T
T 
F 
F 
F 
T 
F 
F 
T
F 
T 
T 
T 
T 
T 
T 
T
F 
T 
F 
T 
F 
F 
T 
T
F 
F 
T 
T 
T 
T 
T 
T
F 
F 
F 
T 
T 
T 
T 
T
Since [(p -* 
q) A (q -+ 
r)] -* [p -* r] is true for all values of p, q and r, this statement is a tautology.
(b) If p implies q which, in turn, implies r, then certainly p implies r.
8. (a) We are given that A is false for any values of its variables. An implication p -* 
q is false only if p is true and q is
false. Since A is always false, A -: 3 is always true. So it is a tautology.
10. (a) 
7 
q pvq
T 
T 
F
T 
F 
T
F 
T 
T
FF 
I 
F
p 
q 
pvq pvq (pvq)-*(pvq)
T 
T 
F 
T 
T
T 
F 
T 
T 
T
F 
T 
T 
T 
T
FF F 
F 
F 
T
The truth table shows that (p V q) --. (p V q) is true for all
values of p and q, so it is a tautology.
Exercises 1.4
1. 1. (Idempotence) The truth tables at the right show that p V p *. - p and
pA p 
O 
p.
P pvp
T 
T
F 
F
P 
TA
F 
F
3. 
(Associativity) The equality of the fifth and seventh columns in the truth table shows that ((p v q) V r) .,
(p V (q V r)).
3.
p I q I r 
s I -r I qA(-r) I p-[qA(-r)] I -S I (-s)vq
T I T I T I T I F I 
F 
I 
F 
I F I 
T
6. (a)
r [(-s) v q] I [p - (qA (-r))] v [r ((-s) v q)]
T 
I 
T
(c)

S-4 
Solutions to Selected Exercises
p 
q 
r I pvq 
(pvq)vr qvr pv(qvr)
T 
T 
T 
T 
T 
T 
T
T 
T 
F 
T 
T 
T 
T
T 
FT 
T 
T 
T 
T
F T 
T 
T 
T 
T 
T
T 
F 
F 
T 
T 
F 
T
F 
T 
F 
T 
T 
T 
T
F 
F 
T 
F 
T 
T 
T
F 
F 
F 
F 
F 
F 
F
The equality of the fifth and seventh columns in the truth table shows that ((p A q) A r) 
> 
(p A (q A r)).
p 
q 
rI 
pAq 
(PAq)Ar 
qAr 
pA(qAr)
T 
T 
T 
T 
T 
T 
T
T 
T 
F 
T 
F 
F 
F
T 
F T 
F 
F 
F 
F
F 
T 
T 
F 
F 
T 
F
T 
F 
F 
F 
F 
F 
F
F 
T 
F 
F 
F 
F 
F
F 
F 
T 
F 
F 
F 
F
F 
F 
F 
F 
F 
F 
F
5. 
(Double negation) The equality of the first and third columns in the truth table shows
that p 
-(-p).
7. 
The two truth tables show, respectively, that p v 1 <=â¢ 
1 and
pA 
I 
p. 
p 
1 
PV
F |T |T
9. 
The two truth tables show, respectively, that (p v (-p)) *-~ 1 and (p A (-p)) 
O 
.
p 
-p 
p V (-p) 
1 
p 
-P 
P A (-P) 
F
11. The third and sixth columns of the truth table show that
(p -
q) 
((-q) -
(-p))
13. The third and fifth columns of the truth table show that
(P 
q) 
((-p) 
v q),
P 
p 
- (-p
T 
F
F 
T 
F
P 
1 
pAA
T 
T|T
F 
T |F
p 
q 
p- 
q 
-q 
-p 
(-q) -
(-p)
T 
T 
T 
F 
F 
T
T 
F 
F 
T 
F 
F
F 
T 
T 
F 
T 
T
F 
F 
T 
T 
T 
T
p 
q 
p -
q 
-p 
(-p)vq
T 
T 
T 
F 
T
T 
F 
F 
F 
F
F 
T 
T 
T 
T
F F 
T 
T 
T

Section 1.5 
S-5
2. (a) Using one of the laws of De Morgan and one distributive property, we obtain
[(p A q) v (-((-p) 
V q))] 
[(p A q) v (p A (-q))] 
[p A (q V (-q))] <--â¢ 
(p A 1) < 
p-
3. (a)
4. (a)
(d)
6. 1.
p 
q 
pAq 
pv(pAq)
T 
T 
T 
T
T 
F 
F 
T
F 
T 
F 
F
F 
F 
F 
F
Distributivity gives [(p v q) A (-'p)] 
* 
(p A (-p)) V (q A (-p)) 
[0 v ((-p) A q)] 
((-p) A q).
-[(p -q) 
V (p A (-q))] -; 
[-(p 
q) A-(p A (-q))] 
= 
[(p -(-q)) 
A ((-p) v q)], using Exercise 4(c).
The truth table shows that idempotence fails. 
v
F 
F
p 
q 
r 
pvq (pvq)vr qvr I pv(qvr)
T 
T 
T 
F 
T 
F 
T
T 
T 
F 
F 
F 
T 
F
T 
F 
T 
T 
F 
T 
F
F 
T 
T 
T 
F 
F 
F
T 
F 
F 
T 
T 
F 
T
F 
T 
F 
T 
T 
T 
T
F 
F 
T 
F 
T 
T 
T
F 
F 
F 
F 
F 
F 
F
7. 
The truth table shows that p v 1 is no longer 1:
9. 
The truth table shows that (p V (-p)) .
1:
13. This is no longer true:
7. (b)
(c)
8. (a)
p I 
1 pv1
T IT T| 
F
P 
-P 
P v (-P) 
1
T 
F 
T 
T
F 
T 
T 
T
p I q I p -
q I -p I (-p) v q
F I T I 
T 
I T I 
F
(p A q) V ((-p) A (-q)) is in disjunctive normal form.
p V ((-p) 
A q) is not in disjunctive normal form: not all variables are included in the first term.
This is already in disjunctive normal form! 
(b) (p A q) V (p A (-q))
Exercises 1.5
1. (a) Since [p -* (q -* r)] <-, 
[p -+ ((-q) V r)] 
* 
[(-p) V (-q) V r],
the given argument can be rewritten as shown and this is valid by
disjunctive syllogism.
[(-p) V r] V (-q)
q
(-p) 
Vr
3. 
Associativity holds.

S-6 
Solutions to Selected Exercises
(b) We analyze with a truth table. In row one, the premises
are true but the conclusion is not. The argument is not
valid.
p 
q 
r 
p- 
q qvr -q 
r -
(-q)
T 
T 
T 
T 
T 
F 
F
T 
T 
F 
T 
T 
F 
T
T 
F 
T 
F 
T 
T 
T
F 
T 
T 
T 
T 
F 
F
T 
F 
F 
F 
F 
T 
T
F 
T 
F 
T 
T 
F 
T
F 
F 
T 
T 
T 
T 
T
F 
F 
F 
T 
F 
T 
T
3. (a) We analyze with a truth table. There are five rows when the premises are all true and in
also true. The argument is valid.
P 
q 
r 
pvq 
p- )r 
q-+r 
(pvq)- 
r
T 
T 
T 
T 
T 
T 
T
T 
T 
F 
T 
F 
F 
F
T 
F 
T 
T 
T 
T 
T
F 
T 
T 
T 
T 
T 
T
T 
F 
F 
T 
F 
T 
F
F 
T 
F 
T 
T 
F 
F
F 
F 
T 
F 
T 
T 
T
F 
F 
F 
F 
T 
T 
T
*
*
each case the conclusion is
*
*
*
*
*
4. (a) Since [(-r) v (-q)] -â¢= 
[q -+ (-r)], the first two premises give p -* (-r) by the chain rule. Now -p follows
by modus tollens.
(b) This argument is not valid. If q and r are false, p and s are true, and t takes on any truth value, then all premises
are true, yet the conclusion is false.
5. (a) Let p and q be the statements 
P
P 
q
The given argument is 
p
q
(b) Let p and q be the statements 
P.
The given argument is
I stay up late at night
I am tired in the morning.
This is valid by modus ponens.
I stay up late at night
I am tired in the morning.
p-* q
q
p
This is not valid, as the truth table shows. In row three, the two premises are true
but the conclusion is false.
(e) Let p and q be the statements 
P
p 
q 
p -
q
T 
T 
T
T 
F 
F
F 
T 
T
F 
F 
T
I wear a red tie
I wear blue socks.
*

Section 2.1 
S-7
The given argument is
p v q
-q
p
P :
(g) Let p, q, and r be the statements 
q:
r :
p- 
q
The given argument is 
q -r 
.
r -* p
This is valid by disjunctive syllogism.
I work hard
I earn lots of money
I pay high taxes.
This is not valid, as the truth table shows. In row five, the two
premises are true but the conclusion is false.
PL:
(I) Let p, q, and r be the statements 
q
r :
p 
q 
r 
pq 
q-r r-Up
T 
T 
T 
T 
T 
T
T 
T 
F 
T 
F 
T
T 
F 
T 
F 
T 
T
T 
F 
F 
F 
T 
T
F 
T 
T 
T 
T 
F
F 
T 
F 
T 
F 
T
F 
F 
T 
T 
T 
F
F 
FF 
T 
T 
T
I like mathematics
I study
I pass mathematics
I graduate.
p- q
The given argument is 
((q) V 
.
This is the same as
(-'s) -* 
(-'r)
s -q
which is certainly not valid, as the following partial truth table shows.
p 
q
q -*r
r -- s
s --- q
p 
q I 
r 
s 
sq 
r 
q
F FF FIT 
T 
T 
T 
F
r v q is logically equivalent to [-(-r) V q] 
; 
[(-r) -
q] so, with p 
-r, 
we get p -+ q by the chain rule.
We will prove by contradiction that no such conclusion is possible. Say to the contrary that there is such a conclusion
e. Since C is not a tautology, some set of truth values for p and q must make C false. But if r is true, then both
the premises (-p) -+ r and r V q are true regardless of the values of p and q. This contradicts C being a valid
conclusion for this argument.
p A q is true precisely when p and q are both true.
In Latin, modus ponens means "method of affirming" and modus tollens means "method of denying". This is a
reflection of the fact that modus tollens has a negative -p as its conclusion, while modus ponens affirms the truth of
a statement q.
(a) {-,15, 15); 
(c) {Â°, -2 }
(a) For example, I + i, I + 2i, I + 3i, -8- 
5i and 17 -43i.
(a) {1,2}, {1,2,3}, {1,2,4}, {1,2,3,4}
*
*
*
*
6.
7.
8. (a)
10.
Exercises 2.1
1.
2.
3.

S-8 
Solutions to Selected Exercises
4. 
Only (c) is true. The set A contains one element, {a, bl.
5. (a) True; 
(d) False.
6. (a) (0}
7. (a) True; 
(e) False; 
(h) False.
8. 
Yes it is; for example, let x = (l) and A = {1, I1)).
9. (a) ii. fa, b, c), [a, b, d), fa, c, d), fb, c, d)
11. (a) 4; 
(b) 8;
(c) There are 2' subsets of a set of n elements. (See Exercise 16 in Section 5.1 for a proof.)
12. (a) False; 
(d) True.
14. (a) True. (-a) If C e 7P(A), then by definition of power set, C is a subset of A; that is, C C A.
(.a-) If C C A, then C is a subset of A and so, again by definition of power set, C E 7P(A).
Exercises 2.2
1. (a) A = (1,2,3,4,5,6}, B = (-l,0, 1,2,3,4,5}, C = 0,2, -21.
2. (a) SnT = {V, 25), SUT = 2,5,V2,25,nr, 5,4,6, -},
T x (S n T) = ((4, a2), (4, 25), (25, a), 
(25, 25), (- 
a), 
(aF2, 25), (6, 
2), (6, 25), (, 
) 
(, 25)).
(b) Z US = Jv2- r, 52 0, 1,-1, 2, -2, ....}; Z n S= (2, 5,251;
ZUT = ( 
4, 
-
lÂ° 1, -1,22, 
2 .... ; ZnT = (4,25,6}.
3. (a) (1,9,0,6,71
5. (a) 
{c, (a,b}}; 
(e) 0
6. (a) Ac = (-2, 1]
7. (a) 2n-2
8. 
(a, b)c = (-co, a] U [b, oc), [a, b)c 
(-oc, a) U [b, oc), (a, 0o)C 
(- o, a] and (-oc, b]C 
(b, oc).
9. (a) T C CS; 
(b) Mn P = 0.
11. (a) En P#? 0
12. (a) A3 UA 3 = A3
13. 
Region 2 represents (A n C) \ B. Region 3 represents A n B n C; region 4 represents (A n B) \ C.
14. (a) A C B, by Problem 7.
15. 
Think of listing the elements of the given set. There are n pairs of the form (1, b), n -I pairs of the form (2, b),
n -
2 pairs of the form (3, b), and so on until finally we list the only pair of the form (n, b). The answer is
l+2+3+ +n= Wn(n+l).
17. (b) Yes. Given A n B = A n C and A" n B = A" n C, certainly we have A n B C C and A" n B C C so, from (a), we
have that B C C. Reversing the roles of B and C in (a), we can also conclude that C C B; hence, B = C.
20. 
Using the fact that X \ Y 
X n Yc, we have
(A \B)\ C = (A n B) n cc = A n (B n Cc) = A n (B U C)' = A \ (B U C).
23. (a) (AUBUC)c=[AU(BUC)]" =ACl(BUC)'= AcU(B'nCc)=AcnBcCc.
(AnBnC), =[AU(BnC)]c=A u(BnC)c =AU(BcUCc)=AcUB'Uc.

Section 2.3 
S-9
24. (a) Looking at the Venn diagram at the right, A (D B consists of the points in regions I and 3.
To have A Â® B = A, we must have both regions 2 and 3 empty; that is, B = 0. On the other
hand, since A Â® 0 = A, this condition is necessary and sufficient.
25. (a) This does not imply B = C. For example, let A = {1, 21, B = {1}, C = 12}. Then A U B = A U C, but B + C.
26. (d) True. Let x e A. Then x e A U B, so x e A n B and, in particular, x E B. Thus, A C B. Similarly, we have B C A,
so A = B.
28. (c) True.Let (x,y) e (A D B) x C.Thismeansthatx e A D B andy c C; thatis,x e A U B,x 
A n B, y e C. If
x e A, then x 0 B, so (X, 
Y) e (A x C) \ (B x C). If x e B, then x Â¢ A, so (x, 
y) e (B x C) \(A x C). In either
case, (x, y) c (A x C) D (B x C). So (A @ B) x C C (A x C) @ (B x C).
Now, let (x, y) e (A x C) ED (B x C). This means that (x, y) e (A x C) U (B x C), but (x, y) 0 (A x C) n (B x C). If
(x, y) c A x C, then (x, y) 0 B x C, so x e A, y E C and, therefore, x 0 B. If (x, y) C B x C, then (x, y) 0 A x C,
so x e B, y e C and, therefore, x 0 A. In either case, x e A E B and y e C, so (x, y) e (A E B) x C. Therefore,
(A x C) @ (B x C) C (A (D B) x C and we have equality, as claimed.
Exercises 2.3
1. 
S x B is the set of ordered pairs (s, b), where s is a student and b is a book; thus, S x B represents all possible pairs
of students and books. One sensible example of a binary relation is {(s, b) I s has used book bh.
3. (a) not reflexive, not symmetric, not transitive.
(c) not reflexive, not symmetric, but it is transitive.
4. (a) 
a 
b 
c 
d
a 
x 
x
b 
x 
x
C 
x
d 
x
5- (a) { (1, 1), (1, 2), (2, 3)}; 
(g) {((1, 2), (2, 1), (1, 1), (2, 2)31.
7. 
The argument assumes that for a c 7Z there exists a b such that (a, b) e 7R. This need not be the case: See
Exercise 5(g).
8. (a) Reflexive since every word has at least one letter in common with itself.
Symmetric since if a and b have at least one letter in common, then so do b and a.
Not antisymmetric. (cat, dot) and (dot, cat) are both in the relation but dot F cat!!
Not transitive. (cat, dot) and (dot, mouse) are both in the relation but (cat, mouse) is not.
9. (b) Not reflexive: (2, 2) 0 R.
Not symmetric: (3, 4) e 'R but (4, 3) Â¢ 'R.
Not antisymmetric: (1, 2) and (2, 1) are both in 'R but 1 # 2.
Not transitive: (2, 1) and (1, 2) are in 1? but (2, 2) is not.
(c) Reflexive: For any a e Z, it is true that a 2 > 0. Thus, (a, a) e 1Z.
Symmetric: If (a, b) c R?, then ab > 0, so ha > 0 and hence, (b, a) e 7R.
Not antisymmetric: (5, 2) e 7Z because 5(2) = 10 > 0 and similarly (2, 5) e 7?, but 5 : 2.
Not transitive: (5, 0) e 7? because 5(0) = 0 > 0 and similarly, (0, -6) e 7?; however, (5, -6) 
Â¢ 1Z because
5(-6) t 0.

S-10 
Solutions to Selected Exercises
(i) 
Reflexive: If (x, y) e R2, then x + y < x + y, so ((x, y), (x, y)) E 'R.
Not symmetric: ((I, 2), (3, 4)) E 7Z since I + 2 < 3 + 4, but ((3, 4), (1, 2)) f 7Z since 3 + 4 4 I + 2.
Not antisymmetric: ((1, 2), (0, 3)) E 7Z since 1 + 2 < 0 + 3 and ((O 3), (1, 2)) E 1Z since 0 + 3 < I + 2, but
(1,2) : (0, 3).
Transitive: If ((a, b), (c, d)) and ((c, d), (e, f)) are both in 'X, then a +-b < c+d and c+d < e +f, so a +b < e+ f
(by transitivity of <) which says ((a, b), (e, f)) e 1Z.
10. (a) Reflexive: For any set X, we have X C X.
Not symmetric: Let a, b c S. Then {a} C {a, b} but {a, b} Z {a}.
Antisymmetric: If X C Y and Y C X, then X = Y.
Transitive: If X C Y and Y C Z. then X C Z.
11. (a) Reflexive: Any book has price > its own price and length > its own length, so (a, a) c 'R for any book a.
Not symmetric: (Y, Z) E 'R because the price of Y is greater than the price of Z and the length of Y is greater than
the length of Z, but for these same reasons, (Z, Y) 0 R.
Antisymmetric: If (a, b) and (b, a) are both in 'X, then a and b must have the same price and length. This is not the
case here unless a = b.
Transitive: If (a, b) and (b, c) are in 'X, then the price of a is > the price of b and the price of b is > the price of c,
so the price of a is > the price of c. Also the length of a is > the length of b and the length of b is > the length of
c, so the length of a is > the length of c. Hence, (a, c) E 7R.
Exercises 2.4
2. (a) This is not reflexive: (2, 2) V 7R.
3. 
Equality! The equivalence classes specify that x - y if and only if x = y.
4. (a) Reflexive: If a c R \ {0}, then a -
a because a = I E Q.
Symmetric: If a - b, then a E Q and this fraction is not zero (because 0 Â¢ A). So it can be inverted and we see that
a = /b E Q too. Therefore, b - a.
Transitive: If a - b and b - c, then a E Q and c E Q. Since the product of rational numbers is rational, a = 
b is
in Q, so a - c.
(b) 1 
a I a - 11 = [a I a i Q) = la I a E Q) = Q \ {O].
(c) 
E=2- 
= 2 E Q, so X 
- v 
and hence 
= 
12.
6. (a) Reflexive: For any a E R, a - a because a -a 
= 0 E Z.
Symmetric: If a - b, then a -b 
E Z, so b - a E Z (because b -a =-(a -b)) 
and, hence, b - a.
Transitive: If a - b and b - c, then both a -b and b - c are integers; hence, so is their sum, (a - b) + (b -c) 
a -c.
Thus, a - c.
(b) 
=(x E R I x - 51 = (x I x -
E Z} = Z;
52 (xERIx -5} 
=xIx=n+ 
, forsomenEZI
(c) For each a E R, 0 < a < 1, there is one equivalence class a- = {x E R I x = a + n for some integer nJ.
The quotient set is (a I 0 < a < 1).
7. 
Reflexive: For any a E Z, a - a because 2a + 3a = 5a.
Symmetric: If a - b, then 2a + 3b = 5n for some integer n. So 2b + 3a = (5a + 5b) -(2a + 3b) = 5(a + b) -n 
=
5(a + b -n). 
Since a + b -n 
is an integer, b - a.
Transitive: If a - b and b - c, then 2a + 3b = 5n and 2b + 3c = Sm for integers n and m. Therefore, (2a + 3b) +
(2b + 3c) = 5(n + m) and 2a + 3c = 5(n + m)- 
5b = 5(n + m -b). 
Since n + m -b is an integer, a - c.

section 2.4 S-11
10. (a) Reflexive: If a E Z \ {0}, then aa = a2 > 0, so a - a.
Symmetric: If a - b, then ab > 0. So ba > 0 and b - a.
Transitive: If a - b and b - c, then ab > 0 and bc > 0. Also b2 > 0 since b # 0. Hence, ac 
(cb
2  
(ab)(bc) > 0
since ab > 0 and bc > 0. Hence, a - c.
(b) 
5 
= 
{x E Z \ {0) x - 5) = {x I 5x > 0) = {x I x > 01
-5 
= 
(x E Z\ {01 I x - -51 = {x I -5x > 0) = {x I x < 01
(c) This equivalence relation partitions Z \ {0) into the positive and the negative integers.
11. (a) Reflexive: For any a E Z, a2 - a2 = 0 is divisible by 3, so a - a.
Symmetric: If a - b, then a2 - b2 is divisible by 3, so b2 - a2 is divisible by 3, so b - a.
Transitive: If a - b and b - c, then a 2 - b2 is divisible by 3 and b2 - c2 is divisible by 3, so a2 - c2
(a2 - b2 ) + (b2 - c2) is divisible by 3.
12. (a) Yes, this is an equivalence relation.
Reflexive: Note that if a is any triangle, a - a because a is congruent to itself.
Symmetric: Assume a - b. Then a and b are congruent. Therefore, b and a are congruent, so b - a.
Transitive: If a -
b and b - c, then a and b are congruent and b and c are congruent, so a and c are congruent.
Thus, a - c.
13. (a) {(1, 1), (1, 2), (2, 1), (2, 2), (3, 3), (3, 4), (3, 5), (4, 4), (4, 5), (5, 5), (4, 3), (5, 3), (5, 4))
14. (c) As suggested in the text, a good way to list the equivalence relations on {a, b, c} is to list the partitions of this set.
Here they are: { {a}, {b}, {c} 1; I {a, b, c} 1; { {a, b}, {c} 1; { {a, c}, {b} }; I {b, c}, {a} 1. There are five in all.
15. (a) The given statement is an implication which concludes "x -y 
= x -
y," whereas what is required is a logical
argument which concludes "so - is reflexive."
A correct argument is this: For any (x, y) e R2, x - y = x -y; 
thus, (x, y) -
(x, y). Therefore, - is reflexive.
16. 
Reflexive: If (x, y) X R2, then x2 - Y2 
x2 
Y2 so (x, 
y) 
(x, 
Y).
Symmetric: If (x, y) - (u, v), then x2 -y
2 =2 u-v2, so U2 -
V2 = x2 - Y2 and (u, v) -
(x, y).
Transitive: If (x, y) - (u, v) and (u, v) - (w, z), then x2 -
y2 = u 2 -v
2 and u2 -
V2 = W2 -
z2, so x2 _ y2
u2 -
= W2 _ z2; X2 -
,2 = 
2 -
z2 and (x, y) - (w, z).
(0, 0) = {(x, y) 
(x, y) - (0, 0)} = {(x, y) X2  
y2 = 02  02 =0 
(XY) Y=Â±X
Thus, the equivalence class of (0, 0) is the pair of lines with equations y = x, y = -x.
2 
_ 
2 
2 
2
(], 0) = {(X, y) I (X, y) -
(1, 0) ={(X, y) 
X 
- y 
= I -2 
=11
Thus, the equivalence class of (1, 0) is the hyperbola whose equation is x2 -
Y2 
1.
19. (a) The ordered pairs defined by - are (1, 
1), (1, 
4), (1, 
9), (2, 2), (2, 8), (3, 3), (4, 1), (4, 4), (4, 9), (5, 5), (6, 6), (7, 7),
(8,2), (8,8), (9, 1), (9,4), (9,9).
(b) I = {l, 4, 9) = 4 = 9; 2 = {2, 8) = 8; 3 
{3}; 5 = {5); 6- 
{6}; 7= {7}.
(c) Since the sets {1, 4, 9}, {2, 8}, {3), {5}, {6} and {7) partition A, they determine an equivalence relation, namely, that
equivalence relation in which a - b if and only if a and b belong to the same one of these sets. This is the given
relation.
20. 
Reflexive: If a E A, then a2 is a perfect square, so a - a.
Symmetric: If a - b, then ab is a perfect square. Since ba = ab, ba is also a perfect square, so b - a.

S-12 
Solutions to Selected Exercises
Transitive: If a - b and b - c, then ab and bc are each perfect squares. Thus ab = x2 and bc = y 2 for integers x
and y Now ab2c = x2y2, so ac = XY 
= 
Because ac is an integer, so also b is an integer. Therefore,
b2  
xb 
b
a -c.
Exercises 2.5
1. (a) This defines a partial order.
Reflexive: For any a E R, a > a.
Antisymmetric: If a, b c R, a > b and b > a, then a = b.
Transitive: If a, b, c e R, a > b and b > c, then a > c.
This partial order is a total order because for any a, b E R, either a > b or b > a.
(b) This is not a partial order because the relation is not reflexive; for example, I < 1 is not true.
2. (a) 1, 10, 100, 1000, 1001, 101, 1010, 11, 110, I11
3. (a) (a, b), (a, c), (a, d), (b, c), (b, d), (c, d) 
(b) (a, b), (c, d)
4. (a) a is minimal and minimum; d is maximal and maximum.
(b) a and c are minimal; b and d are maximal; there are no minimum nor maximum elements.
7. 
A C B and the set B contains exactly one more element than A.
9. (a) Let (A, -<) 
be a finite poset and let a E A. If a is not maximal, there is an element al such that al >- a. If a, is not
maximal, there is an element a2 such that a2 >- al. Continue. Since A is finite, eventually this process must stop, and
it stops at a maximal element. A similar argument shows that (A, -<) must also contain minimal elements.
11. (a) Suppose that a and b are two maximum elements in a poset (A, -<). Then a -< b because b is maximum and b -< a
because a is maximum, so a = b by antisymmetry.
12. (a) Assuming it exists, the greatest lower bound G of A and B has two properties:
(1) G C A, G C B;
(2) 
if C C A and C C B, then C C G.
We must prove that A n B has these properties. Note first that A n B C A and A n B C B, so A n B satisfies (1).
Also, if C C A and C C B, then C C A n B, so A n B satisfies (2) and A n B = A A B.
13. (a) a v b = b and here is why. We are given a -< b and have b -< b by reflexivity. Thus b is an upper bound for a and
b. It is least because if c is any other upper bound, then a -< c, b -< c; in particular, b -< c.
14. (a) Suppose x and y are each glbs of two elements a and b. Then x -< a, x -< b implies x -< y because y is a greatest
lower bound, and y -< a, y -< b implies y -< x because x is greatest. So, by antisymmetry, x = y.
16. (a) (P(S), C) is not totally ordered provided ISI > 2 (since fal and lb} are not comparable if a 7& b). But 0 is a minimum
because 0 is a subset of any set and the set S itself is a maximum because any of its subsets is contained in it.
18. (a) We have to prove that if b -< a, then b = a. So suppose b < a. Since a is minimum, we have also a -< b. By
antisymmetry, b = a.
Exercises 3.1
1. (a) Not a function; f contains two different pairs of the form (3,-). 
(c) This is a function.
2. (a) This is not a function unless each student at the University of Calgary has just one professor, for if student a is taking
courses from professors b, and b2 , the given set contains (a, bl) and (a, b2).
3. 
A x B is a function A -* 
B if and only if B contains exactly one element.
To see why, first note that if B = {b}, then A x B = ((a, b) I a e Al is certainly a function.

Section 3.1 
S-13
Conversely, if A x B is a function but B contains two elements bl, b2, then for any a E A, (a, bl) and (a, b2) are
both in A x B, so A x B is not a function.
4. (a) the function defined by f(n) = 2n, for example.
5. (a) If x c X, then x is a country in the British Commonwealth with a uniquely determined Prime Minister y who lives
in that country; that is, y E Y.
If y E Y, then y is a person living in one of the countries in the British Commonwealth. Thus, the domicile of y is
a uniquely determined element x E X.
6. 
Parking rates, bus fares, admission prices are several common examples.
8. (a) add is not one-to-one since, for example, add(l, l)=add(O, 2) while (1, 1) #* (0, 2). It is onto, however, because, for
any y E R, the equation y = add(x) has the solution x = (y, 0).
9. (a) g is not one-to-one since, for example, g(l) = g(-l) = 2. Neither is g onto: For any x E Z, Ixl > 0, so Ixl + I > 1.
Thus, for example, 0 V rngg.
(b) g is not one-to-one as in (a). This time it is onto, however, because for n E N, the equation n = g(x) has the solution
x = n - 1. (Note that n > 0 for n E N, so In -I 
= n -
1.)
10. (a) If f(x 1 ) = f(x
2), then 3x, + 5 = 3x2 + 5, so x 
x2 which proves that f is one-to-one. Also f is onto, since given
y E Q. y = 
'(3 (y -5)) with 
(y -5) C Q.
13. (a) Note that f(x) = (x + 7)2 -
100. If f(x]) 
= 
f(x2) it follows that (xl + 7)2 _ 100 = (x2 + 7)2 _100, so
(xi + 7)2 = (x2 + 7)2 and, taking square roots, lxi + 71 = Ix2 + 71. Since Xl, X2 E N, we know x] + 7 > 0 and
X2 + 7 > 0. Thus, xl + 7 = x2 + 7 and xi = x2. Thus, f is one-to-one, but it is not onto: For example, I E B, but
there is no x E N with f(x) = I since (x + 7)2 _ 100 = I implies (x + 7)2 = 101 and this equation has no solution
in the natural numbers.
14. (a) The domain of f is R. Its range is also R because every y E R can be written y = f(x) for some x; namely, x = y-/3.
The function is, therefore, onto. It is also one-to-one: If f(xI) = f(x 2 ), then x3 = 
3and this implies xi = x.
1 2 
ndths 
mpie x 
=X2
15. (a) The graph of f shown at the right makes it clear that f is one-to-one and onto.
(b) Since f: R -* 
R is one-to-one by part (a), it is also one-to-one as a function with
domain Z. Here, however. f is not onto for we note that f(0) = 0. f(l) = 4 and f
Ix
is increasing, so 1 is not in the range of f.
17. (a) This is not one-to-one since, for example, f(l, 3) = f(4, 1) = ll while (1, 3) # (4, 1). The function is not onto
since, for example, the equation f (x) = l has no solution x = (n, m) (because 2n + 3m > 5 for every n, m E N).
(b) This is not one-to-one since, for example, f(l, 3) = f(4, 1) = 11 while (1, 3) # (4, 1). The function is onto,
however, since for k E Z, the equation k = f (x) has the solution x = (-k, k).
18. (a) A={x ERlxo3};rngf ={y I y 
O}.
19. (b) Note that f(x) =-(2x - 3)2. This function is not one-to-one since, for example, f(l) = f(2) (= -1). Restrict the
domain to {x I x > 3/2} (or to {x I x < 2
22. (a) Here are the functions X 
Y:
{(a, 1), (b, 1)} 
{(a, 1), (b, 2)} 
{(a, 1), (b, 3)}
{(a, 2), (b, I)} 
((a, 2), (b, 2)} 
{(a, 2), (b, 3)}
{(a, 3), (b, 1)) 
[(a, 3), (b, 2)} 
[(a, 3), (b, 3)}.

S-14 
Solutions to Selected Exercises
Here are the functions Y -X:
{(1, a), (2, a), (3, a))
{(], a), (2, b), (3, a)}
{(I,b), (2, a), (3, a)}
{(I, b), (2, b), (3, a)}
{(1, a), (2, a), (3, b))
{(1, a), (2, b), (3, b)I
{(I, b), (2, a), (3, b)}
{(l,b), (2, b), (3, b)}.
(b) There are no one-to-one functions Y -* 
X. The one-to-one functions from X -) Y are
{(a, 1), (b, 
2)} 
{(a, 1), (b, 3)} 
((a, 2), (b, 1)I
((a, 2), (b, 3)} 
((a, 3), (b, I) I 
(a, 3), (b, 2)}.
(c) There are no onto functions X -Ã·
Y. The onto functions
{(l,a), (2,a), (3,b)}
((1, a), (2, b), (3, b)J
((1, b), (2, a), (3, b)}
Y -- X are
{(1, a), (2, b), (3, a)}
((I, b), (2, a), (3, a)}
((I, b), (2, b), (3, a)}.
n
1 
2 1 3 
4
24. 
1 
1 
2 
3 
4
m 
2 
1 
4 
9 
16
3 
1 
8 
27 
64
4 
1 
16 
81 
256
26. (a)
27. (a)
We would guess that for IXI = m and IYI = n, the number of functions
X -Y 
is nm .
(a) Suppose A and B each contain n elements. Assume that f: A -* 
B is one-to-one and let C = (f(a) j a e Al.
Since f(a 1 ) + f(a 2 ) if al :A a2, C is a subset of B containing n elements; so C = B. Therefore, f is onto.
4
3
2
1
/ 
(b) 
The domain of f is R. The range is the set of all real numbers of the
;
1 23
rorm 12n 4--a, were n E& L and u - a < l.
Exercises 3.2
1. (a) j- 
= ((1, 5), (2, 1), (3, 2), (4, 3), (5, 4))
2. (a) f 
: R- 
R is defined by f- 1 (x) = 3(x
(b) j- 
= ((1, 4), (2, 1), (3, 3), (4, 2), (5, 5)1
y
10
5).
-4
-
I
3. (a) If f(xI) = f(x 2 ), then I + 
-
= 1 + 
-
one-to-one.
rng f = B = 
{y 
e R I y : 1I and f -I (x) = 4 + 
I
X 
I
l 
and xl-4 = X2
x2 -
4
4. Thus xl = X2 and f is

Section 3.2 
S-15
5. (a) maternal grandmother
6. (a) f o g = ((1, 1), (3, 8), (2, 1), (4, 9), (5, 1)3
g o f is not defined because rng f = {1, 2, 3, 8, 9) g domg =I, 
2, 3,4, 5).
f o f is not defined because rng f = {I, 2, 3, 8, 9} q dom f= {1, 2, 3, 4, 5}.
gag = {(1, 2), (2, 2), (3, 2), (4, 1), (5, 2)1.
7. (a) g- o f o g = {(1, 3), (2, 1), (3, 2), (4, 4)}
1 
1 
1 
2x2 +3
8. 
gof x) = 
f og(x)= 
-2 +2 
-
(x + 2)2 + 1 
x 2 + 4x + 5 
x= 
+ 
2 +
hog o f(x) = 3; go ho f(x) = g(3) 
1=0
Since 
o f(x) = x, we have g o f 
o f(x) = g(x) =
Since f 
(x) = x-2, 
we have
f g f( f 
_____I 
2 
-2(x +2)
2 -
= 
k ((x + 2)2 + I) 
(x + 2)2 + 
-
(x + 2) 2 + I
10. 
(g o f)(x) = g(f(x)) = f(x) -
c. Thus the graph of g o f is the graph of f translated vertically c units down if
c > 0 and -c units up if c < 0. The graphs are identical if c = 0.
12. (a) Since -xl 
= 
x 
if X >0 
we have f o gf(x) = f-(-Ix 
= 
I 
f 
) 
if x>0
if x < 0, 
f (x) 
if X< 0.
So the graph of f o g is the same as the graph of f to the left of the y-axis (where x < 0) while to the right of the
y-axis, the graph of f o g is the reflection (mirror image) of the left half of the graph of f in the y-axis. We call
f o g an even function since it is symmetric with respect to the y-axis: f o g(-x) = f o g(x).
15. (a) 
fog 
= {(1, 4), (2, 3), (3, 2), (4,1), (5, 5)}; go f = {(I, 5), (2, 3), (3, 2), (4,4), (5, 1)} Clearly, fog : go f.
2x
16- (a) For x G B. (f og) (x) = f (,2x)= 2 
= x.
-__ -
2
(b) For x E A, (g o f)(x) = g(-rx2) 
X 
= x and so, by Proposition 3.2.7, f and g are inverses.
Tx-2 
I
18. (a) Suppose g(bj) = g(b2 ) for bl,b 2 E B. Since f is onto, bI = f(a]) and b2 = f(a2) for some a1,a2 E A.
Thus, g(f(a,)) 
g(f(a2)); that is, g o f(aj) = g o f(a2). Since g o f is one-to-one, ai = a2. Therefore,
b1 = f(aj) = 1(a2) = b2 proving that g is one-to-one.
19. (a) Suppose f: A -- B and g: B 
C are one-to-one. We prove that g o f: A -* 
C is one-to-one. For this, suppose
(g o f)(aI) = (g o f)(a2) for some a , a2 e A. Then g(f(aI)) = g(f(a2 )) [an equation of the form g(bj) = g(b2 )].
Since g is one-to-one, we conclude that f(a,) = 1 (a2), and then, since f is one-to-one, that a0 = a2.
20. (b) With A = {1, 2}, B = {-1, 1, 2}, C = {5,10}, f = {(1, 1), (2, 2)} and g = {(-I, 5), (1, 5), (2, 10)} we have
g o f = ((I, 5), (2, 101. Then g o f: A 
C is onto but f is not.
21. 
Since a bijective function is, by definition, a one-to-one onto function, we conclude, by the results of part (a) of the
previous two exercises, that indeed the composition of bijective functions is bijective.
24. (b) Writing x = Lx] + a, 0 < a < 1, we have t(x) = Lxj -
a. Now it is straightforward to see that t is one-to-one:
Suppose t(xl) = t(x2), where xi = Lxjj + a,, x2 = Lx2 + a2 and 0 < al, a2 < 1. Then Lxij -at = Lx2 
-a2, 
so
Lxl -Lx21 
= a1 - a2. The left side is an integer; hence, so is the right. Because of the restrictions on a, and a2,
the only possibility is ai = a2. Hence, also Lxj = Lx2j, so xI = X2.

S-16 
Solutions to Selected Exercises
Exercises 3.3
1. 
Ask everyone to find a seat.
2. 
The two lists 12, 22, 32, 42, .... and 1, 2, 3, 4, ... 
obviously have the same length; a2 F- a is a one-to-one correspon-
dence between the set of perfect squares and N.
3. (c) The function f: N x N -* C defined by f(m, n) = m + ni for all m, n E N.
6. 
This is false. For example, INI = IN U {O} , as shown in the text.
9. (a) False. Let X = (l }, Y = (2), Z = {3}. Then ((1, 2), 3) E (X x Y) x Z but ((1, 2), 3) V X x (Y x Z) (a set whose
second coordinates are ordered pairs).
(b) Define f: (X x Y) x Z-* X x (Y x Z) by f((x, y), z) = (x, (y, z)).
11. (a) f (x) = x + 2 is a one-to-one correspondence between (I, oc) and (3, oc). We conclude that these sets have the same
cardinality.
12. (a) The function defined by f(x) = x + I is a one-to-one correspondence between (0, 1) and (1, 2).
13. (a) The function defined by g(x) 
- + 9 is a one-to-one correspondence between (0, 1) and (10, co). This is just
f(x) + 10, where f is the function given in Problem 26.
15. 
f is certainly a function from R to R+ since 3x > 0 for all x E R. If 3' 
= 3), then x log 3 = y log 3 (any base), so
x = y. Thus, f is one-to-one. If r e R+, then 3 1og 3 r = r, so f is onto. We conclude that R and R+ have the same
cardinality.
16. 
Since (a, b) has the same cardinality as R+ by Exercise 14 and since R+ and R have the same cardinality by
Exercise 15, the result follows by transitivity of the notion of "same cardinality"-see Exercise 10.
17. (d) Follow the procedure given in the text for all rational numbers and omit those with even denominators. The listing
starts l, 2, 3, 4, 
.
. 5, 6 . .
.
.
.
.
18. (a) This set is uncountable. The function defined by f (x) = x -
gives a one-to-one correspondence between it and
(0, 1), which we showed in the text to be uncountable.
(e) This set is countably infinite. In Exercise 3(c) we showed it is in one-to-one correspondence with N x N.
20. (a) Impossible. To the contrary, suppose that the union were a finite set S. Since S has only finitely many subsets (the
precise number is 2 Sl), there could not have been infinitely many sets at the outset.
(c) Impossible. If even one infinite set is contained in a union, then the union must be infinite.
21. 
Imagine S, sitting inside S2, both spheres with the same center. Rays emanating from this common point establish a
one-to-one correspondence between the points on S, and the points on 52.
22. 
Let SI, S2, S3, .... 
be a countably infinite subset of S. Define f: S -* 
S U {x} by
f(sI) = x
f(sk+l) = Sk 
for k > I
f(s) =s 
if S V {S],S2,sA, ...)
Then f is a one-to-one correspondence.
24. 
We are given that A = (a,, a2, . . , a,) for some n e N and that B = {bi, b2, b3 , ... ). Then A U B is countably
infinite because it is infinite and its elements can be listed al, a2, ..
, a,,, bl, b2, b3 , 
. 
The function f: N -- AU B
corresponding to this listing is defined by f(i) -
ab, 
if i- <

Section 4.1 
S-17
Exercises 4.1
1. 
(a + b)c = c(a + b) (by commutativity) = ca + cb (by the first distributive law) = ac + bc (by commutativity again).
2. (a) True.
4. (a) q = 29; r = 7; 
(b) q =-30; r = 10 
(c) q =-29; r = 7 
(d) q =30; r = 10
7. (a) The domain of f is Z; its range is Z as well, because given q E Z, we have q = f (qn).
(b) f is not one-to-one since f(0) = f(I). (Note that n > I guarantees that the quotient is 0 when either 0 or I is
divided by n.)
(c) 
f is onto, as shown in (a).
9. 
By definition, x < rx] < x + I for any x. Letting k = 
a/bl], we have a/b < k < (a/b) + 1. Multiplying by the
negative number b, we obtain a > kb > a + b. Thus, 0 < a -kb 
< -b. Letting r = a -kb, 
we have a = kb + r
with 0 < r < Ibl, so, by uniqueness, k 
q as asserted.
10. (a) 4034 = (111,111,000,010)2 = (7702)8 = (FC2) 16.
Exercises 4.2
1. (a) Not totally ordered; for example, 6 and 21 are not comparable.
(b) I is a minimum element since I | n for all n c N, but there is no maximum element since given any n e N, n |2n, 
so
n can't be maximum.
3. 
(a) 
4 
6
2 
3 5 7
5. 
As in Problem 6, write a = nq +r, where 0 < r < n. Thus, r = 0,1,2, .
or n -1. 
If r = 0, then a = qn is
divisible by n. If r = 1, then a = nq + 1, so a + n -
I is divisible by n. If r 
2, then a = nq + 2 and a + n -2 
is
divisible by n. In general, if r = k, then a + n - k is divisible by n.
6. 
Assume, to the contrary, that for some integer n, we have 4 (n2 - 2); that is, n2 - 2 = 4x for some integer x. We
derive a contradiction. First consider the case that n is even; that is, n = 2y for some integer y. Then (2y) 2 - 2 = 4x
says 4(y2 _ x) = 2. Since y2 
-
x is an integer, this says 4 1 2, which is impossible.
Next suppose n is odd; that is, n = 2y + I for some integer y. Then (2y + 1)2 - 2 = 4x says 4(y2 + y - x) = 1. Since
y2 + y-x 
is an integer, this says 4 | 1, another impossibility. In either case we reach a contradiction, so 4 ( 
- 2)
can never be true.
8. 
We have a = qln + r and b = q2n + r for some integers qj, q2 and r. Subtracting, a -b 
= (qln + r) -(q2n 
+ r) =
(q - q2)n. Thus, n I (a - b) as required.
9. (a) True. Since a I b, b = ax for some integer x. Since b | (-c), -c = by for some integer y. Thus, c = -by = -axy 
=
a(-xy). Since -xy is an integer, a I c.
11. (a) gcd(93, 119) = I = (-25)(119) + 32(93).
(b) gcd(-93, 119) = I = (-25)(119) + (-32)(-93).
(c) gcd(-93, -119) 
= I = (25)(-119) + (-32)(-93).
13. 
Since a and b are relatively prime, we have ma+nb = I for some integers m and n, so 2 = 2ma+2nb. Now suppose
x I (a +b) and x I (a -b). Then, by Proposition 4.2.2, x I [(a +b) + (a -b)]; that is, x 12a. Also x I [(a +b) -(a -b)];
that is, x I 2b. Again, by Proposition 4.2.2, x I (2ma + 2nb), so x 1 2 and we conclude that x = Â±1 or x = Â±2. The
result follows.

S-18 
Solutions to Selected Exercises
14. 
If gj and g2 are each greatest common divisors of a and b, then gi < g2 (because g2 is greatest) and g2 <
(because g, is greatest), so g= g2-
16. (a) 17369(-10588) + (5472)(33608) = 4.
(c) Consider the possibility that 154x + 260y = 3 for certain integers x and y. The left side of this equation is even
while the right side is odd, a contradiction.
17. (a) We know that gcd(x, y) I x and gcd(x, y) I y and so gcd(x, y) I (mx + ny) (Proposition 4.2.2).
19. 
Let g, = gcd(a, b) and g2 = gcd(ac, bc). We have to show that g2 = cg9. First note that cgl ac since g, I a, and,
similarly, cg Ibc. Thus, cgl is a common divisor of ac and bc, hence, cgl < g2, the largest of the common divisors
of ac, bc. On the other hand, since g, = am + bn for some integers m, n, cgj = acm + bcn. Since g2 | acm and
g2 bcn, it must be that g2 cgl, and so, since c, gi, g2 are all positive, g2 < cgl. We conclude that g2 = cgi, as
required.
21. 
SayxIn andx|(n+ I).Thenx|[(n+1)-n],sox IIandgcd(n,n+1)= 1.Wehave (- l)n+(l)(n+ I) = 1.
24. 
As suggested by the hint, consider the set S of all positive linear combinations of a and b. Since S contains a = a +Ob
if a > 0 and -a otherwise, S is not empty so, by the Well-Ordering Principle, S contains a smallest element g.
Since g E S, 
we know that g = ma + nb for integers a and b; hence, we have only to prove that g is the greatest
common divisor of a and b. First we prove that g I a. Write a = qg + r with 0 < r < g. Note that r is a linear
combination of a and b since r = a - qg = a - q(ma + nb) = (I -qa)m + (-qn)b. Since g is the smallest positive
linear combination of a and b, we have r = 0, so g I a as desired. Similarly, g I b. Finally, if c a and c b, then
c I (ma + nb), so c Ig, so c < g.
25. 
lcm(63, 273) =63(273) = 819; lcm(56, 200) 
56(200) = 1400.
26. (a) lcm(93, 119) = (93 . 119)/I = 11067
28. 
gcd(a, b) I a and a I Icm(a, b) so gcd(a, b) I lcm(a, b) by transitivity of |. (See Proposition 4.2.3.)
30. (a) Let x = (aa, .... ao)jo be the integer. Thus, x = ao + 1OaI + 
+ 0onan.
Now x = (ao + al + 
+ a,) + (9aI + 99a2 + ... + 99 
9an)
ii times
= (ao + al + 
+ an) + 3(3al + 33a2 + 
+ 33. 
3 an).
n times
Since a( + al + 
+ an is divisible by 3 and 3 clearly divides the second term on the right, 31 x as required.
(b) Reverse the argument in (a); that is, note that if 3l x, then we can conclude from the preceding that 3I (ao+al+Â±. 
+an).
33. (b) 
12
6
24
2 
3
34. (a) By Theorem 4.2.9, we know there is at least one pair of integers a, b such that g = am + bn. Now observe that for
any integer k, it is also true that g = (a + kn)m + (b -km)n.
Exercises 4.3
1. (a) 
157 is prime; 
(b) 9831 is not prime; 319831.

Section 4.3 
S-19
3. (a) Note that n = p(n/p). Now if n/p is not prime, then it has a prime factor q < 
n/p by Lemma 4.3.4. Since a
prime factor of n/p is a prime factor of n, q would then be a prime factor of n not exceeding 
Ip, 
contradicting
the fact that the smallest prime factor of n is bigger than this.
(b) Note that 16,773,121 = 433(38,737) and that 
38,737 
197. Since 433, the smallest prime dividing 38,737, is
larger than 197, 38,737 is prime, by part (a). Thus, 16,773,121 = 433(38,737) is the representation of 16,773,121 as
the product of primes.
4. (a) 856 = 23 
107; 
(e) (28 -
1)20 = 320 520 .1720.
5. 
If 141 terminates in 0, then it is divisible by 10 and, hence, by the prime 5; that is, there is a 5 in the factorization
of 14". This contradicts unique factorization because 14" = 2"7' says that the only primes dividing 14" are 2 and 7.
6. (b) We have to prove that a, b E A implies a + b E A. Let a, b E A. Then a = 
and b = I, where 3 ' n, 3,[ e. Then
mf + nk
a + b = 
. Since 3 is prime, if 3 1 nf, then 3 1 n or 3 1 f, neither of which is true. Thus, 3 ' nf, so a + b e A.
8. (b) False. The prime described here has the miraculous property that it divides all natural numbers greater than 1. Certainly
this prime cannot be 2 since 2 I 3, neither can it be odd since if p is an odd prime, p I 2.
10. (a) This function is one-to-one. If f(n 1, ml) = f(n2, m2), then 2 m1 6 n, = 2 m2 6 n2 , and so 2 m1 2 n' 3 ni = 2 122l 2 3f2. 
By the
Fundamental Theorem of Arithmetic, the powers of 3 and 2 on each side of this equation are the same. So nI = n2,
hence mI = m2 too. Therefore, (ni, ml) = (n2, M2).
11. (a) 7r(I0) = 4, 10/ In 10 ; 4.343 and 
idlO) 
P 
4 
;, 0.921.
IO/ 
In 10 
4.343
14. 
This is a special case of Exercise 10, Section 4.2 since if p and q are distinct primes, then p and q are relatively
prime. The result also follows quickly from the Fundamental Theorem of Arithmetic since, writing n = PI P2 
Pr,
the hypotheses say that one of the pi is p and some other pj is q.
15. 
Without loss of generality, we may assume that a < b. Since there are infinitely many primes, there exists an integer
n > 0 such that b + n is prime. Since a + n < b + n, b + n cannot divide a + n, so a + n and b + n are relatively
prime.
16. (b) First note that, if p is prime, d(p2 ) = 3 since the only divisors of p2 are 1, p and p2 . We claim that only integers
of the form p2 satisfy the condition. To see this, notice that if n is divisible by distinct primes p and q, then n is
divisible by each of 1, p, q and pq (see Exercise 14) and so d(n) > 4. Thus, n has just one prime factor. Also, if n
is divisible by the cube of a prime, p3 , then n is divisible by each of 1, p, p2, p3 so again, d(n) > 4. We conclude
that n = p2 for some prime p.
17. (a) No. 215'I- 
I = (25 - 1)(21 + 25 + 1).
18. (a) 26 + I = (22 + 1)(2 4 -2 2 + 1).
20. 
Suppose, to the contrary, that p and q are consecutive primes (in that order) such that p +q = 2r, where r is a prime.
Then p = P+P < P+4 = r < 
-< = q; that is, p < r < q. This contradicts the fact that p and q are consecutive
primes.
22. 
This is true, and the proof has given Andrew Wiles a place in history. This is Fermat's Last Theorem (4.3.14)!
23. 
The condition tells us that in the prime decompositions of a, b and c, no prime appears in two of the decompositions.
Hence, 
Paj p
2 ..
ar 
010 
1 
YI Y2 .. 
4
a 
2 
r 
b = qI q2 
... q , c = rl r2  
rt with the primes pi, qi, ri all different. Thus,
ab = pl 
... pr 
q 
Ps
ac = pal '. 
prarr '.. 
ri Yt
bc = qp ... qpSri ...* rt'
Suppose gcd(ab, bc, ac) 7 1. Then there must exist a prime s such that s I ab, s I bc, s I ac. But there is no prime
common to the decompositions of ab, ac, bc. Hence, no such s exists and gcd(ab, bc, ac) = 1.
25. (a) gcd(ab, p4 ) = p 3.

S-20 
Solutions to Selected Exercises
27. (a) Writing a = par and b = p"~s with gcd(p, r) = I and gcd(p, s) = 1, there are two possibilities: If , = 1, then
gcd(a 2, b) = p, while if , > 1, then gcd(a2 , b) = p2.
28. 
Let the prime decompositions of a and b be
a 
plP.2 
.pr 
and 
b= q 
.. qs
P~i 
Ps
Since gcd(a, b) = 1, we know that Pi :# qj for any i and j. Thus, ab = pl. 
pq '.. 
qS with no simplification
possible. Since ab = x2, it follows that each ai and each pi must be even. But this means that a and b are perfect
squares.
30. 
Let a = 
pol 
pC2 ... pr. Since a is a square, all the ai are even. Since a is a cube, all the xxi are divisible by 3. It
follows from Exercise 14 that 61 ai for all i. This means that a is a 6th power.
31. (a) True. Write a =p
1 p
2  
Pr 
as the product of powers of primes. Then all = p
1 .. 
p I 
If p I al, then p
must be one of the Pi, so p I a.
32. 
Whenever a, b, c satisfy x2 + y2 = z2 , so also do ka, kb, kc satisfy the equation, for any integer k. Thus, for example,
all triples of the form 3k, 4k, 5k satisfy a2 + b2 = c2 .
33. (a) Write 3n + 2 = PI P2... Pm as the product of (necessarily odd) primes. Each of the pi is either 3 or of the form
3k + I or 3k + 2. Now we notice that the product of integers of the form 3k + 1 is of the same form and the product
of 3 with such an integer is a multiple of 3. So if none of the Pi is of the form 3k + 2, the product cannot be either.
If we drop the word odd, the result is false. For example, 3(2) + 2 = 8 is divisible by only the prime 2, which is not
of the form 3n + 2 for n E N.
35. (a) f(8) = 64; 
(b) x = 1000.
Exercises 4.4
1. (a) 5, 12, 19, -2, -9, -16 
are in 5. 
4, 11, 18, -3, -10, -17 are in -3.
(b) The general element of 5 is an integer of the form 7k + 5 for some integer k. The general form of an element in -3
is an integer of the form 7k - 3 for some integer k.
3. (a) 1286 (mod 39) = 38; 
(c) -545,608 
(mod 51) = 41.
4. (a) False: 18 - 2 = 16 is not divisible by 10. 
(c) True: 44- (-8) = 52 is divisible by 13.
5. (a) 0=3, 1=4,2 =5.
6. (a) 4 (mod 6); 
(e) 2, 4, 8, 5, 10, 9, 7, 3, 6, 1
8. 
Observe that 5Â° -
1 (mod 7), 51 -
5 (mod 7), 52 -
4 (mod 7), 53 -
6 (mod 7), 54 -2 
(mod 7) and 55 -
3
(mod 7). Thus, each of the integers 1, 2, 3, 4, 5, 6 is congruent mod 7 to some power of 5. By Proposition 4.4.5, any
integer a is congruent mod 7 to one of 0, 1, 2, 3, 4, 5, 6. So the result follows.
9. (a) No x exists. The values of 3x mod 6 are 0 and 3. 
(e) x = 9, 34; 
(f) x = 9; 
(k) x = 56.
10. (b) 
i. x = 2, 11. 
iv. No x exists. The values of x2 (mod 6) are 0, 1, 3 and 4.
11. (a) There is just one solution mod 6; namely, x = 0, y = 1.
(b) Subtracting the first congruence from the second gives 3x --
2 =- 7 (mod 9). But the values of 3x mod 9 are just
0, 3 and 6. There is no solution.
12. 
Since gcd(c, n) = 1, we have cx + ny = I for some integers x and y. We also know that ac - bc = nk for some
integer k. So (a -b)cx 
= nkx; that is, (a -b)( 
-ny) 
= nkx, or, a - b = n(kx + (a -b)y). 
Thus, n | (a -b) 
and
a - b (mod n), as desired.
13. 
Since n I (a -b), 
we have a -b 
= qn for some integer q, hence, a - qn = b. Let g = gcd(a, n). Then g | a and
g I n. Therefore, g } b (and g I n), so g I gcd(b, n). Similarly gcd(b, n) I g and so these natural numbers are equal.

Section 4.5 
S-21
14. (a) This is false. Consider r = 5, s = 1, a = 2, n = 4. Then 5 -
I (mod 4), but 25 # 21 (mod 4) because 25 -2' 
= 30
and 4 , 30.
15. (a) False! For example, with a = b 
1 and n = 4, we have a - b (mod 4), but 3a = 3, b2 = I so 3 # I (mod 4).
16. (a) Suppose X = a/b for some integers a and b. If a and b have any factors in common, these can be canceled leaving
us with an equation of the form X2 = a/b where a and b have no common factors (except +1). So we now make
this assumption. Then a2 = 2b2, so a2 + b2 = 3b2 = 0 (mod 3). By Problem 23, a and b have 3 as a common
factor, which is not true.
17. (b) x = I and x = p -1.
18. (a) 
i. x= I andx=24.
20. (a) By Fermat's Little Theorem, 188970 -
1 (mod 8971). So 188971 
- 18 and 188972 
182 = 324 (mod 8971).
21. 
The key to this problem is the observation that 97 is a prime. Thus, by Fermat's Little Theorem, if x # 0 (mod 97),
then x97 -
x (mod 97), so X 97x 
+ I -
I # 0 (mod 97). Since x -
0 (mod 97) is also not a solution, there are
no solutions at all.
Exercises 4.5
1. (a) This number is valid. 
(b) This number is not valid.
2. (a) A = 9; 
(d) A = 7.
4. 
al+2a 2 + .. +9ag+0alo-0 (mod1I1) +-al+2a2+ ++9ag 
-I0ajoÃ·.al 
+2a
2 + ..
+9ag alosince
-
alo = alo (mod 11).
6. (a) For example, 2-419713-29-0 is not valid because al + 2a2 + 
+ lOaI = 208 0 0 (mod 11).
7. (a) The given rule is w a-0 
(mod I1) for a = (a,, a2
, 
alo) and w = (1, ,,1, 1, 1, 1, 1, 1, 1).
8. (a) 
1-13579-02468-8; 
(d) 0-63042-00635-5.
9. (a) Not valid: 3(0+2+4+6+8+0)+(I+3+5+7+9+1)=60+26=86 
0 (mod 10).
(c) Valid: 3(2+2+9+1+3+4)+(5+9+8+7+9+9)=63+47= 110-0 (mod 10).
10. (a) x = 1.
11. (a) Suppose the sum of the digits in the odd positions is a and the sum of the digits in the even positions is b. If the
check digit in our bar code is correct, 3a + b -
0 (mod 10). An error in an even position digit changes b to c = b
(mod 10). For the new number, we compute 3a + c * 3a + b and thus, 3a + c # 0 (mod 10). So we know an error
has been made.
(b) Here is a valid number: 3-12498-66132-9. Changing the I and 4 in positions two and four to 8 and 7 respectively
produces the number 3-82798-66132-9 which is also valid.
13. (a) 1-23586-98732-6; 
(b) 1-23006-98732-6.
15. (b) Single-digit errors are not detected. Since 1Oa3 -
0 (mod 10), the third digit can in fact be changed arbitrarily and
the new number will still pass the test.
16. (a) If n < 9, then any ai in the range 0 < ai < 9 -n 
could be replaced by n + ai and the test would miss the error.
17. (a) x = 18; 
(d) x = 142.
18. (a) x = 53; 
(d) x = 260.
19. 
The number was 340.

S-22 
Solutions to Selected Exercises
20. (a) x -
297 (mod 900). Since there are many integers less than 50,000 which are congruent to 297 (mod 900), it is
impossible to determine ab exactly.
(e) ab- 27,887 (mod 34,300); ab = 27,887.
21. 
First we address the hint. Suppose you want to write 7s + 22t = 1. The "obvious" numbers are s =-3, 
t = 1:
(-3)7 + (1)22 = 1. But suppose you want s > 0. This can be achieved by adding and subtracting 22(7) in the
equation (-3)7 + 1(22): (-3 + 22)7 + (I- 
7)22 = 
1; that is, 19(7) + (-6)22 = 1. In general, we know that
I = sm + tn for some integers s and t by Theorem 4.2.9. Now if s 4 0, choose k such that s + kn > 0 and note that
(s + kn)m + (t- km)n = 1.
22. (a) 300; 
(c) 259.
23. (a) Z; 
(c) G.
24. (a) HI.
Exercises 5.1
1. (a) 
5 
i2
l2+22+32+42+52=55 
(b)Z4=l2'=21+22+23+24=30
(c) E
1 sinjrt = sinnr(l) = sin 
=r 0
4. (a) If n = 1, n2 + n = 12 + I = 2, which is divisible by 2. Suppose k > I and the result is true for n 
k; that is,
21 (k 2+k). We wish to prove that 21 [(k+ 1) 2 +(k+ 1)]. But (k+ 1) 2 +(k+ 1) = k2 +2k+ 1 +k+ I = k2+k+2(k+ 1).
Since 2 1 (k2 + k) (by the induction hypothesis) and since 2 1 2(k + 1), 2 divides the sum of k2 + k and 2(k + 1);
that is, 2 | [(k + 1)2 + (k + 1)] as required. By the Principle of Mathematical Induction, the result holds for all
n> 1.
(c) If n= 1, 
n3 +(n + 1) +(n +2)3 = 13 +2+33= 36 and 9|36. Suppose the result is true forn =k > ;that is,
9 [k 3 +(k+1)3 +(k+2)3 ]. Then (k+1)3 +(k+2) 3 +(k+3)3 =(k+1) 3 +(k+2)3 +k 3 +9k
2 +27k+27=
[k3 + (k + 1)3 + (k + 2)3] + [9k2 + 27k + 27]. Since 9 divides the first term by the induction hypothesis and since 9
clearly divides the second term, 9 divides (k + 1)3 + (k + 2)3 + (k + 3)3, as desired. By the Principle of Mathematical
Induction, the result holds for all n > 1.
5. (a) For n = 1, 1 + 2 + 3 
+ n is 1, by definition, and n(nII) 
2 
1 also. Thus, the result is true for n = 1. Now
2
suppose that k > I and the result is true for k; that is, assume that I + 2 + 3 + 
+ k = 
2(k- 1)
Then1+2+ 
+(k+1)=(1+2+ 
+k)+(k+1)
= 
(k 2 
) + (k + 1) 
(by the induction hypothesis)
2
k(k+ 1)+2(k+ 1) 
(k+ l)(k+2)
2 
2
which is the given statement with n = k + 1. So, by the Principle of Mathematical Induction, we conclude that
I + 2 + 
+ n = Wn + 1) for all n > 1.
6. (a) If n = 1, I + 21 + 22 + 23 + 
+ 2n = I + 2 = 3, while 2 1+ 1 -I = 4-I 
= 3, so the result is true if n = 1.
Suppose the result is true for n = k > 1; that is, suppose I + 2 + 22 + 23 + 
+ 2k = 2k+1 - 1. We wish to
prove the result for n = k + 1; that is, we wish to prove that I + 2 + 22 + 23 + ... + 2k+1 = 2 (k+-)+l -1. Now
1Â±2Â±22 +23. 
+ 2 k+1 
(I + 2 + 22 + 2 3 +... +
2 k) + 2 k+l = (2 k+1-1) + 2k+1 (by the induction hypothesis)
= 2 
2 k+1-I 
= 2 k+2 -
I = 2 (k+l)+l - I as required. By the Principle of Mathematical Induction, we conclude that
the given assertion is true for all n > 1.
(b) If n = 1, 12 -22 
+ 32 - 42 + 
+ (-l)n- 1n2 = 12 = 1, by definition, while (-l)n-l n(nl) = (-1)- 
1(1+1) = 1,
2 
2
and so the result is true for n = 1. Now suppose that k > 1 and the result is true for n = k; that is, suppose that
12 - 22 + 32- 
42 + 
+ ( 
)k- 1k2 = (-W-
1
k(k + 1)

Section 5.1 
S-23
We wish to prove that 2- 22 + 32 -42 + 
+ (-l)(k+I)- (k + 1)2 = (-I)(k+l)-l (k + 1)[(k + 1) + 1]
2
Now 12-22+32 
-42++( 
_ 1 )(k+I)- (k+ 1)2
[ 1222+ 
32- 
42 + 
,.+ (_I )k- k 2 a + (1)(k+I)-I (k+ 
1)2
kI k 
I ) + (- )k (k + 1)2 
(using the induction hypothesis)
2
k k 2 + k 
2
=( 
) 
Â±+(-l) 
(f1)(k
2 + 2k + 1)
(-Â§klk+k 
k2 - 2k -1)
-2
( k)kI (k2 +k -k 2  2 k -i)
=(-)k 1 k 2+k-2k2 
4k 2
2
()I 
1 ( 
2 3 k 
I ) 
2
22
as desired. By the Principle of Mathematical Induction, the result is true for all n > 1.
n
7. (a) E2k
k=O
8. (a) For n-=1, (i + 1)2' = 2(2') = 4, while n2n+1 
-
1(22) = 4. Thus, the formula is correct for n = 1. Now suppose
k
that k > I and the formula is correct for n = k; thus, we suppose that L(i + 1)2' = k2kTI.
ikl
k-I
We must prove that the formula is correct for n = k + 1; that is, we must prove that L(i + 1)2' = (k + I) 2k+2
'il
k+I 
k
Now 
(i 
+ 1)2' = Z(i + 1)2' + (k + 2)2k+I = k2k+I + (k + 2)2k+I 
(using the induction hypothesis)
= (k + k + 2)2k+l = ( 2k + 2)2k+I = 2(k + 1)2 k+I = (k + 1)2k+2
as required. By the Principle of Mathematical Induction, the given assertion is true for all n > 1.
9. (a) If n = 5, 25 = 32, 52 = 25. Since 32 > 25, the result is true for n = 5. Now suppose that k > 5 and the result is
true for n = k; that is, suppose that 2k > k2 We must prove that the result is true for n = k + 1; that is, we must
prove that 2k+I > (k + 1)2. Now 2 k+1 = 2 
2k > 2k2 by the induction hypothesis, and 2k2 = k2 + k2 > k2 + 5k
(since k > 5), and k 2 + 5k = k 2 + 4k + k > k 2 + 2k + I (since k > I), and k 2 + 2k + I 
(k + 1) 2. By the Principle
of Mathematical Induction, the result is true for all n > 5.
10. (a) For n = 1, L(xi + yi) is, by convention, just the single term xI + yl. Since this equals 3xI + 
y, the formula
ihl 
iNI 
iil
holds for n = 
1. Now suppose k > I and the formula holds for n -
k. Then

S-24 
Solutions to Selected Exercises
k+1 
k
(Xi + yi) 
[E(Xi + yi)] + (Xk+I + Yk+l)
k 
k
= 
Xi + 
i + (Xk+1 + Yk+]) 
(by the induction hypothesis)
[(Â± 
xi) + Xk+l] Â± [(I Yi) + Yk+] = 
Xi + E 
i
t=1i 
i
which is the formula with n = k + 1. Thus, the result holds for all n > I by the Principle of Mathematical Induction.
11. 
The k to k + I step does not apply to the case k = 1. When k = 1, G = jal, a2}. Observe that the groups {al}, {a21
have no member in common.
12. 
The induction was not started properly. When n = 1, the left side is 1, while the right side is 9/8. The statement is
not true when n = 1.
15. (a) We leave the primality checking of f(l), 
f (39) to the reader, but note that f (40) = 412.
(b) f (k2 + 40) = (k2 + 41 + k)(k 2 + 41-k).
16. 
If a set A contains n = 0 elements, then A = 0 and A has exactly I subset, namely, 0. Since I = 2(, the statement
is true for n = 0. Now assume that a set of k elements has 2 k subsets. Let A = lal, a2, . ... , ak+I } be a set of k + I
elements. We show that A must have 2 k+1 subsets. This follows because every subset of A either contains ak+1 or it
doesn't. By the induction hypothesis there are 2k sets which do not contain ak+Â±; but, by the induction hypothesis,
there are also 2k subsets which do contain ak+1 since these are precisely those sets obtained by forming the union of
a subset of Jai, a2, . . ., ak} and {akl }. Altogether A has 2k + 2k = 2 (2k) = 2 k+Â± 
subsets. So, by the Principle of
Mathematical Induction, we conclude that a set of n elements contains 2' subsets.
17. 
Let S be a nonempty set of natural numbers. Let a be any element of S. Then the smallest element of S is the smallest
element of the nonempty set (x c S I ' < x < a) (which is finite).
19. 
For n = 
I, nl 
l Bi = B1, and so A U (n0,i7 
Bj) = A U B1 = nf,7= (A U Bj) and the result holds for n = l. Now
assume that A U (nly 
Bj) = ni=, (A U B1) for k > l. Then, given a set A and k + I sets B1, B2, 
Bk+1, we
have
A U (n k+ ' Bj) = A U ( ( 
I,= Bi ) n Bk+1
=(AU(n0= Bj))n(AUBk+I) 
sinceAU(BnC)=(AUB)n(AUC)
=(n=, 
(A U B1)) n (A U Bk+1) 
(by the induction hypothesis)
nlk+V
1 (A U Bi)
giving the result for k + I. By the Principle of Mathematical Induction, we conclude that A U ( 0n7= Bi) = 0n 
1 ( AU
Bi ), for all n > 1.
23. 
When n = 2, gcd(ai, a2) = sIaI + s2a2 by Theorem 4.2.9. Now suppose that k > 2 and the statement is true for
n = k; that is, suppose that the gcd of any k > 2 integers is an integral linear combination of them. We have to show
the statement is true for n = k + 1, that is, that the gcd of k + I integers is an integral linear combination of them.
Now gcd(ala2, .
ak+)= 
gcd(al, gcd(a2,... ,ak+l)). By the induction hypothesis, there are k integers r2, r3,
rk+ such that gcd(a2. 
ak) 
-
k+ riai. Then Theorem 4.2.9 tells us that
gcd(al, yk+1 riai) = xai + y(Zriai) = xal + (yr2)a2 + 
(yrk+l)ak+l
as desired (sl = x, S2 = yr2 .
Sk+1 = yrk+1). By the Principle of Mathematical Induction, the statement is true
for all n > 1.

Section 5.2 
S-25
28. 
When n = 2, we have two distinct points in the plane joined by exactly one line. Since 2(22 1) = 1, the result holds
in this case. Now suppose the result is true for n = k > 2; that is, suppose that the number of lines obtained by
joining k distinct points in the plane, no three of which are collinear, is !k(k -
1). We must prove the result for
n = k + 1; that is, we must prove that the number of lines obtained by joining k + 1 distinct points, no three of which
are collinear, is 1 (k + 1)[(k + 1)-1] = 
I 
k(k + 1). Let P be one of the k + I points. By the induction hypothesis, the
remaining k points are joined by !k(k -1) 
lines. On the other hand, P can be joined to each of those remaining k
points, giving k additional lines. (Since no three of the k + 1 points are collinear, these additional lines are different
from the lines determined by the other k points.) The total number of lines is
k(k -I) 
k(k -1)+2k 
k2 -k+2k 
k2-+k 
k(k+1)
2 
2 
2 
2 
2
as desired. We conclude that the given assertion is true for all n > 2, by the Principle of Mathematical Induction.
31. (a) First set aside two coins; then separate the remaining six into two piles of three and compare weights. If the weights
are equal, the only possible light coin is one of the two set aside and this can be found in a second weighing. If one
set of three is lighter than the other, then there is indeed a light coin and it is one of a known three. Remove one of
these three and compare the weights of the remaining two coins (with a second weighing). Either one of these coins
will be found to be lighter or the one set aside is the light one.
32. (a) False. If n = 3, 5' +n + I = 129 and 7T 129.
l -
X2'+' 
n
36. 
lim 
fi 
2 
= 
7 J(l + x2 ) 
(using the result of Exercise 35)
X Â±l 
I -X2 
X-1 
I
n
= n(I 
+ (Â± 1)2'') = 2 n.
r=1
Exercises 5.2
1. (a) al = 1; ak+l = 5 ak for k > 1.
2. (a) 16,8,4,2,1,1,1
4. 
When n = l, the formula becomes (1-1)(1+2)(12+1+2) = 0, which is al. Now assume that the formula is correct when
4
n =k. Whenn =k+ 1,
ak+l =(k + 1)3 + ak = (k + 1)3 + (kI -)(k 
+ 2)(k 2 + k + 2)
4
4k 3 +12k 2 +12k+4+k4 +2k 3 +k 2 - 4
4
k4 + 6k3 + 13k2 + 12k
4
k(k + 3)(k 2+ 3k +4) 
k(k + 3)[(k + 1)2 + (k + 1) + 2]
4 
4
as desired. By the Principle of Mathematical Induction, we conclude that the formula is correct for all n > l.
6. 
The first six terms are 1, 3, 7, 15, 31, 63. Our guess is that an = 2' - l. When n = 1, 2 
1I = 1, agreeing with
al. Now assume that k > I and the result is true for n = k; that is, assume that ak = 2k -
l. We must prove the
result is true for n = k + I; that is, we must prove that ak+l = 2 k+l -
I. Now ak+l = 2ak + I = 2 (2 k- 
1) + I (by
the induction hypothesis) = 2 k+ 
-2 + I = 2 k+I -1, 
as required. By the Principle of Mathematical Induction, we
conclude that the result is true for all n > l.

S-26 
Solutions to Selected Exercises
9. 
al=1,a2 =22 -al =4-=3,a3 =32-a 2 =9-3=6.a4=4
2 -a3=16-6=10,a=52 -a4=25-10 =15,
a6 = 62 - a5 = 36 -15 
= 21. Thus, the first six terms are 1, 3, 6, 10, 15, 21. We recognize these numbers as the six
sums 1, 1+2,1+2+3, 1+2+3+4, 1 +2+3+4+5 and I +2+3+4+5+6 and so guess that a, = n(n+ 1)/2.
(See Exercise 5(a) of Section 5.1.)
For n = 1, n(n + 1)/2 = 1(2)/2 = 1, which agrees with al. Now assume the formula holds for n 
k; that is, assume
k~k 1(ki-1)(k+2
ak = 
2 
.We must prove the formula holds for n = k + 1; that is, we must prove that ak 
2 
+1 
2) Now
ak+l = (k + 1)2 -ak 
= (k + 1)2 
( 2 
) 
using the induction hypothesis
2
2(k+ 1)2 -k(k+ 1) 
(k+ 1)[2(k+ 1)-k] 
(k+ 1)(k+2)
2 
2 
2
as required. By the Principle of Mathematical Induction, we conclude that the result is true for all n > 1.
11. 
The first few terms are 0, 1, 0, 4, 0, 16, ... . Our guess is that
o 0 
if n is odd
n 
42 
4- 
if n is even.
We will prove this using the strong form of mathematical induction. Note first that al = 0 and 42- = 40 
I = a2
so that our guess is correct for al and a2. Now let k > 2 and assume the result is true for all n, I < n < k. We
must show that the result is true if n = k. If k is odd, then ak = 4ak-2 = 4(0) = 0 since ak-2 = 0 by the induction
hypothesis, k - 2 being odd. If k is even, then
k2 
k-2 
ki
ak = 4ak-2 = 4(4 2 
1) (using the induction hypothesis) = 4 2 
4=-4
as desired. By the Principle of Mathematical Induction, the result is true for all n > 1.
15. (a) The first ten terms are 2, 5, 8, 11, 14, 17, 20, 23, 26, 29. The 123rd term is 2 + 122(3) = 368.
(b) We attempt to solve 752 = 2 + (n -
1)3 and discover n -I 
= 250. So 752 does belong to the sequence; it is the
251 st term.
(d) The sum of 75 terms is 725 [2(2) + (74)3] = 8475.
16. (a) a17 =-1; 
a92 = -382; 
(b) S = 
17
19. 
For n 
1, a + (I - I)d = a, which agrees with al = a. Now assume that the formula is correct for the integer k,
that is, that ak = a + (k - 1)d. Then ak+j = ak +d = a + (k -l)d+d = a +kd shows that the formula is true also
for k + 1. So, by the Principle of Mathematical Induction, the formula is correct for all n > 1.
20. (a) The first ten terms are 59049, -19683, 6561, -2187, 729, -243, 81, -27, 9, -3. 
The 33rd term is 59049(- 1)32 =
3n) = (1)22
312 -3
(b) The sum of the first 12 terms is 59049(1 
( 
(310)3(1 - (1)12) 
(311) -
1 
3121
\l 
-
4)} 
3 
4 
12 
12
23. (a) a129 = (-.00001240)(- 
.1)12S 
-2.4643. 
(b) S = -. 00001240(1-(j129)
2.1 
1.2908.
24. 
This is straightforward to prove by mathematical induction but we give an alternative proof. Letting S = a + ar +
ar 2 + 
+ ar-, 
we have rS =ar+ar
2 + 
+ar'. 
Subtraction gives (I 
r)S -
S 
-rS = a -ar 
= a(l- r)
from which the formula follows.
26. (b) If Irl < 1, then limncc, r' = 0. Hence, lim a 
a 
.
(c) 6.
n-*OC 
r- 
- r
28. (a) This is the sum of an arithmetic sequence with a = 75, d =-4. Solving -61 
= a + (n - I)d = 75 + (n -1)(-4),
we obtain n = 35. So the sum is 35 [2(75) + 34(-4)] = 245.

Section 5.3 S-27
29. 
Suppose the arithmetic sequence ao, ao + d, ao + 2d, ..... is also the geometric sequence al, a I r, al r2, . .. . Then
ao = al. Let's call this number a. Note that one and only one possibility occurs when a = 0 (namely, 0, 0, 0, ... ) so
assume henceforth that a : 0. Since the sequence is both arithmetic and geometric, it follows that all terms of this
sequence are nonzero. We have a + d = ar and a + 2d = ar 2, so
a+d 
ar 
a+2d
a 
a 
a +d
So (a+d)2 =-a(a+2d), giving a 2 +2ad+d 2 =a 2 +2ad andhence d =0. Since ar =a+d =a, r =1. The
only arithmetic sequences which are also geometric are constant, of the form a, a, a, ... for some number a.
31. (a) $1000(1.15)2 = $1322.50.
(b) We seek t such that 1000(. 1 5)t = 2000. Thus, 1. 15t = 2, t = log 2/ log 1.15 t 4.9595 years.
36. 
Rewriting fk+l = fk + fk 
as fk-1 = fk+l- fk, we see that fo = f2 -f 
= 1 -1 
= 0. Similarly, f-l = 1,
f-2 =-1, f-3 = 2, f-4 =-3, 
f-5 = 5, f-6 = -8. 
In general, f-= 
(- l)'+1fn
37. 
The Fibonacci sequence is the sequence 1, 1, 2, 3, 5, 8... , each term after the first two being the sum of the
two previous terms. For n = 1, f2fl = I(]) = 1= 
f=2. So the assertion is correct for n = 1. Let k > I
and assume the assertion is correct for n = k; that is, assume that fk+lfk = Tk .
7. We wish to prove the
assertion is correct for n = k + I; that is, we wish to prove that fk+2fk-l = 
f2 
But fk+2 = fk+1 + fk, SO,
fkÂ±2fkÂ±1 = (fk+1 + fk)fkÂ±1 = f7+1 + fk~lfk = fk+] +>j=1 fi (using the induction hypothesis) = ,+ 
t2 as
desired. By the Principle of Mathematical Induction, we conclude that the assertion is correct for all n > 1.
40. 
The induction hypothesis is valid only for n in the interval 3 < n < k because all integers in this problem are at least
as large as no = 3. But the induction hypothesis is applied to the integer k -2; 
this is not valid if k = 4.
42. (a) aI = l, a2 = 2 (2 and l + 1), a3 = 4, as given. We can write 4 = 4 = 3 + I = I + 3 = 2 + I + I = I + 2 + I
1 + 
+ 2 =2 +2 
Â±= 1 
+ I + I + 
so a4 = 8. Careful counting shows that a 5 = 16.
44. (a) an = 2a, 
1. The sequence is the sequence 2, 4, 8, ... of powers of 2.
47. (b) fl(l) = f(l) = [4(1) -l]/3 = 1. f 2(1) = f o f(l) = f(f(l)) -
f(l) = 1. This continues: fn(l) = I for all n.
Exercises 5.3
1. 
a,= 
3n
3. 
a, =- 5 (3f) + 6n (3)
5. 
an, = 
(-4 + Â± 
15)n 
(-4 
-15)
7. 
a, 
-2(-1)" + 2(3n) =2[(-I)n+l + 3 n
10. (a) an = 2(3f) + 2(-5)f; 
(b) an = 2(3n) + (-5)f -2.
13. (a) an =4"; 
(b) a, = 2(8n) - 4'.
(c) For n = 0, 2(80) -40 
= 2 -
= 1, as required.
Let k > 0 and assume that ak = 2 (8 k) -
4 k. We wish to prove that ak+1 -
2 (8 k+l) -
4k+1. Now
ak+l = 4 ak + 8 k+1 = 4 [ 2 (8 k) - 4k] + 8 k+1 
(by the induction hypothesis)
= 8k+1 - 4k+1 + 8k+1 = 2 (8 k+1) -
4k+1
as desired. By the Principle of Mathematical Induction, the result is true for all n > 0.
16. (a) an = 4f + 3; 
(b) a, = 10(4) 
-(3n 
+ 6)2n.
18. 
The nth term of the Fibonacci sequence is a,_1 = , ( 
/ 
_ I (1-,( 
2)n 
* Thus, lan-, -
I 
,)n
1 (-1)nV 
Now II(-V5)nl 
< 
1 
< 1 since I1-V51 < 
1, 
SO la,_1 
I+V5)'I 
< 2. Remembering that
I/-( 
2) 
o 
/5( 
2) 
-
5
2 
2 
oj 
7i5 ( 
22

S-28 
Solutions to Selected Exercises
a,-, is an integer, the result follows from the fact that there is precisely one integer within 
of any given real
number.
22. (a) Since x is a root of the characteristic polynomial, x2 = rx + s. Hence, ran_1 + sa,-2 = r(cx'-1) + s(cx'-2) =
cxn-2(rX + S) = Cx,-
2 (X 2 ) = cXn = an.
(b) We know that pn = rpn-l + SPn-2 and qn = rqn-l + sqn-2. Thus, Pn + qn = rPnt + SPn-2 + rqn-i + sqn-2 =
r(pn-1 + qn-]) + s(pn-2 + qn-2).
(c) If xl and x2 are the characteristic roots, part (a) tells us that clx" and c2x' both satisfy the recurrence relation while
part (b) says that c1xln + C2X2' is also a solution. If either xl or x2 is 0, one initial condition determines the single
unknown constant. Otherwise, two initial conditions will determine cl and c2 for they determine two linear equations
in the unknowns Cl, C2 which, because xl :A X2, must have a unique solution.
23. (a) The characteristic polynomial is x2-rx-s 
with characteristic roots x = ri2 
Since there is only one root,
we must have r2 = -4s in which case x = r/2. Hence, r = 2x and s =-r
2 /4 = -4X 2/4 
-
x2 .
Exercises 5.4
1. (a) 4, -12, 9, 0, 0....; 
(c) 1,-6, 27,-108, .
(n + 1)(-3), .
2. (a) I + 2x + 5X2; 
(f) 
I
3. 
an = 2n
5. 
an =-2n + 2. 3n
7. 
an = 2n+1 + 3
9. (a) an = 2(-5)n
11. 
an = -2 
+ (-6)(-l)n + Â±(2n)
12. 
an = 1(2n + 1) + 7(-Â±)n
4 
4
Exercises 6.1
1. 
Let B be the set of connoisseurs of Canadian bacon, and A the set of those who like anchovies.
(a) lB U Al =BI + Al -lB fl Al = 10+7-6 = 11; 
(b) lB \ Al =BI - IB n Al = 4;
(c) lBDAl=BUAl-lBnAlA=5; 
(d) lUI-IBUAl=4.
4. 
Let A be the set of people with undergraduate degrees in arts, S those with undergraduate degrees in science, and G
those with graduate degrees.
(a) IAUSUGI =300; 
(b) IS\(AUGI =35.
7. 
Let D be the set of delegates who voted to decrease the deficit, E be the set of delegates who voted in favor of the
motion concerning environmental issues, and T be the set of delegates who voted in favor of not increasing taxes.
(a) |(D U E U T)Cl = 200; 
(b) lT \ (D U E)l = 316.
9. 
Let 0, A, G, and C denote the sets of people who bought orange juice, apple juice, grapefruit juice, and citrus punch,
respectively.
(a) lOnAnGnCI = I
10. (a) 75 -(4(28) -6(12) 
+ 4(5) -1) = 75 -59 
= 16

Section 6.2 
S-29
11. (a) Let A and B be the set of integers between I and 500 which are divisible by 3 and 5, respectively. The question asks
for IA U BI. This number is JAI + BI -
IA n BI= L5-3[ = 233.
(b) The question asks for IA \ (B U C)I = 66.
13. 
Let A, B, and C be the sets of integers between 1 and 250 which are divisible by 4, by 6, and by 15, respectively.
We want IAU BU Cl = 91.
14. (a) Let A, B. C, D be the sets of integers between 1 and 1000 (inclusive) which are divisible by 2, by 3, by 5. and by
7, respectively. We want IA U B U C U DIC = 1000 - 772 = 228.
17. 
Let A, B, C, D, E, F be the sets of natural numbers between 1 and 200 (exclusive) which are not prime and divisible
by 2, 3, 5, 7, 11, and 13, respectively. Let A, B, C, D, E, F be the sets of natural numbers between 1 and 200
(exclusive) which are not prime and divisible by 2, 3, 5, 7, 11, and 13, respectively. IA U B U C U D U E U Fl = 152,
so the number of primes less than 200 is 198 -152 
= 46.
18. 
Write a = qb + r with 0 < r < b. Then L[j = q. Clearly the positive integers b, 2b, .
qb are all less than or
equal to a and are all divisible by b. On the other hand, if sb < a, then s must belong to the set {1, 2, 
q. Hence,
there are exactly q such natural numbers, as required.
22. (a) l(AEB)nCl= #((A\B)U(B\A))nC( = I((A\B)nC)u((B\A)nC)I
=l(A 
nC)\BI+l(BRnC)\AI 
since(A\RB)n(B\A)=0
= IA n Cl -
IA n B n Cl + lB n Cl -
IA n B n Cl
= IAn Cl +lB n CI - 21A n Rn Cl
Exercises 6.2
1. (a) 
12; 
(b) 7.
3. 
10x9x8=720
5. (a) 9 x 26 x 26 x 26 x 10 x 10 x 10 = 158,184,000 
(b) 9 x 26 x 105 = 23,400,000
(c) 
158,184,000 + 23,400,000 = 181,584,000
7. (a) 
13 x 6 x 2 x 4 = 624; 
(b) 13 + 4 = 17; 
(c) 25.
9. (a) 4x4= 16; 
(b) 4 x 4 x 4 = 64; 
(c) 16 + 64 = 80.
11. 
60x60x60=216,000
13. 
500 + (500)(499) + (500)(499)(498) = 1.24501 x 108
16. (a) 52 x 3 x 2 x 1 = 312
Total 
| 2 
3 
4 
5 
6 
7 
8 
9 
10 
11 
12
1 
No. of ways I1 
2 
3 
4 
5 
6 
5 
4 
3 
2 
1
20. (a) HHHH, HHHT, HHTH, HTHH, THHH, HHTT, HTHT, HTTH, THHT, THTH, TTHH, HTT 
,THTT, TTHT, 1TTH, 1TTT. There are
16 possibilities in all.
22. (a) 26 x 26 x 26 x 10 x 9 x 8 = 12,654,720
25. (a) The easiest way to see that there are 2' functions from A to B is to note that {ai I (ai, 0) E fl }+ f is a one-to-one
correspondence between the (2f) 
subsets of A and the set of functions f: A -* 
B.
(b) Of the 2' functions A -Ã· B, precisely two are not onto,
{(aI, 0), (a2, 0), .
(a, 0)} 
and 
{(a,, 1), (a2, 1), .
(an, 1)}.
Thus, the number of onto functions is 2n - 2 as claimed.

S-30 
Solutions to Selected Exercises
Exercises 6.3
1. 
There are seven days of the week. Hence, we wish to put eight objects (people) into seven boxes (days). By the
Pigeon-Hole Principle, some day must have at least two people corresponding to it.
4. 
F102 I = 9
6. (a) Any given processor is connected to at least one of 19 other processors. There are 20 processors, so the Pigeon-Hole
Principle assures us that at least two are connected to the same number.
(b) The result is still true, though for a somewhat more subtle reason. The number of processors to which a given
processor is connected is in the range 0-19 (inclusive). On the other hand, if 0 occurs (that is, some processor is
not connected to any other), then 19 cannot. So, as in part (a), there are at most 19 possibilities for the number of
processors connected to a given processor. By the Pigeon-Hole Principle, at least two processors are connected to the
same number.
9. 
Mimicking the solution to Problem 14, we let ai be the number of sets Martina plays on day i. Then we have
1 < al < al + a2 < ... 
< al + a2 + 
+ a77 < 132. Now it is not true that the only integer in the range 1-77
which is divisible by 21 is 21 itself. Thus, while two of these sums must leave the same remainder upon division by
21, we can conclude this time only that the difference of these sums is divisible by 21, not that the difference is 21.
10. 
Suppose Brad and his mother drive al quarter hours on day one, a2 quarter hours on day two, and so on, a35 quarter
hours on day 35. The list
al, al + a2, al + a 2 + a3 , . 
al + a2 + 
+ a35
consists of 35 natural numbers between 1 and 15 x 4 = 60 (15 hours = 60 quarter hours) and so, if any of them
is divisible by 35 (83 hrs. = 35 quarter hrs.), it is 35 and we are done. Otherwise, each of these numbers leaves a
remainder between I and 34 upon division by 35, and so two leave the same remainder. Suppose
al +a2+ 
+aS =35q+r
aÂ±+a2+ *+at=35q' +r.
Then (assuming s > t) at+1 + at+2 + 
+ a, is divisible by and, hence, equal to 35; that is, Brad drives 8 3 hours
ondayst+l,t+2 .+ ,s.
13. 
Let box 1 correspond to days 1, 2, and 3, box 2 to days 4, 5, and 6, box 3 to days 7, 8, and 9, and box 4 to days 10,
11, and 12. Putting each bill into the box corresponding to the day it was mailed, we see that one box must contain
at least Fr91 = 49 bills, by the general form of the Pigeon-Hole Principle. This gives the desired result.
16. 
Divide the rectangle into 25 rectangles, each 3 x 4. By the Pigeon-Hole Principle, at least two points are within, or
on the boundary, of one of these smaller rectangles. This gives the result since the maximum distance between two
points of such a rectangle is 
32+ 42= 5.
20. 
As suggested, we consider the sequence of natural numbers MI = 3, M2 = 33, 
...
= 33 ... 3 (n 3's). If one
of these is divisible by n, we have the desired result. Otherwise, at least two of these natural numbers leave the
same (nonzero) remainder upon division by n; that is, for some i 0 j, Mi = qn + r, Mj = q'n + r for the same r.
Assuming, without loss of generality, that i > j, Mi -Mj 
= (q - q')n is divisible by n and has only 3's and 0's in
its base 10 representation.
22. 
After finitely many steps in the long division process, we will be adjoining a "0" at each stage to the remainder from
the division at the previous stage. Since only finitely many remainders are possible (each remainder is less than the
divisor), two must be the same and from the first repetition, all steps (and corresponding decimal places) will repeat.
24. (a) Suppose no two people have the same age so that there are at least 51 different ages in the room. Let box 1 correspond
to integers I and 2, box 2 correspond to integers 3 and 4, ... , box 50 to 99 and 100. Assigning ages to boxes, by
the Pigeon-Hole Principle, some box contains two ages. This says that ages of two people are consecutive integers,
as required.
26. (a) Focus on one of the ten people, say Hilda. Suppose first that at least four of the remaining nine people are strangers
to Hilda. If these four are mutual friends we are done; otherwise two of these are strangers and, hence, together with

Section 7.1 
S-31
Hilda, we have three mutual strangers and again we are done. Thus, we suppose that less than four people are strangers
to Hilda; so Hilda has at least six friends in the group. By Problem 17, this group of six contains either three mutual
strangers (in which case we are done) or three mutual friends who, together with Hilda, give four mutual friends.
Exercises 7.1
1. 
13 12 11 ... 6 = P(13, 8) = 51,891,840
3. 
10 9 8 7 = P(10, 4) = 5040
5. 
3 x 5! = 360
7. (b) 10!4!2!
9. (a) 3! x 4! = 144; 
(b) P(4, 2) x 4! = 288.
10. (a) m!
(b) If m > n, there are 0 invective functions X 
Y.
If m < n, the number isn(n 
)(n 
2) .
(n-m 
+ 1)= P(n, m).
m factors
12. 
Let N be the set of lines in which the Noseworthys are beside each other and A the set of lines in which the Abbotts
are beside each other.
(a) INI = 2 x 3! = 12; 
(b) IN11 = 24 -12 
= 12; 
(c) NfnAl=2x2x2=8;
(d) 4; 
(e) NUAl =N +IAl-jNfnAl = 12+ 12-8=16;
(f) IN 
AI = N+IAI-2lNfnAl 
-
12+12-2(8)=8.
14. (a) 2 x 5! = 240
16. (a) 9 x 9 x 8 x 7 x 6 x 5 x 4 = 9 x P(9, 6) = 9 x 60, 480 = 544,320.
17. (b) 7 x 6 x P(7, 5) = 42 x 2520 = 105,840; 
(d) P(7, 7) = 5040.
Exercises 7.2
1.
3.
5.
6.
8.
10.
11.
13.
17.
19.
20.
(a) (6) 
(G) 
(8) = 8820; 
(b) (6) (7) (1) + (6) (7) (1) + (6) (7) (3) 44,100
(12) = 
12! = 792
(a) (15)(10); 
(b) (15)(8); 
(c) 315)(8).
(o) + ( I) + ( 2 )+ () 
176
(a) 
4(153) = 5148
(a) 210; 
(b) 
(12) = 210.
(a) (25) = 53,130; 
(b) (15) = 3003; 
(c) (15)(2) = 20,475.
(a) (100). 
(b) ('00); 
(c) ( I 00) x (1Â°00).
(d) The answer is ()) x (95) x (80). This is also ( 1)0(0) (20) 
(Why?)
(a) ( Â°) = 45; 
(c) (5) + (4) (5) = 10 + 25 = 35.
(a)
(a)
( 2)
(12)
= 45
= 220

S-32 
Solutions to Selected Exercises
21. (a) () -8 = 28 -8 = 20
23. 
The product of n consecutive natural numbers starting at m is
m(m + 1)(m + 2) .(m + n-1) 
P(m + n 
, n) =n!(m+n-)
SO r(m+I)(m+-) 
(r-i(m+n 1) is the integer (m+n1
Exercises 7.3
30+7- 1) -36)
1. 
(30 
3)0()
3. 
(6+5 
) 
(0) 
= 252
4 
(10+4-1)= (I3) = 286
6. (a) 
(27) 
2,220,075
7. (c) 
121 = 79,833,600
3!
8. (a) 
(12)(9)(6)(3) = 369,600; 
(b) 
-69600 
1 5,400.
2 
a 60)(-50) (40) = 
60!
14. 
(3)(12)(10) 
= 
215! 
= 216,216
15. (a) 2130! 
= 302,400
16. 
30!
10!5!7!8!
19. (a) Given any solution (xI, x2, X3, X4) of (*) with xl > 8, then (xl 
8, x2, X3, X4) is a solution of (**) with xl
8, x2, X3, X4 nonnegative integers. Conversely, given a solution (xI, x2, X3, X4) of (**) in nonnegative integers, then
(xl + 8, x2, X3, x4 ) is a solution to (*) with xl + 8 > 8. The number of solutions to (**) in nonnegative integers
corresponds to the number of ways to put 13 identical marbles into four boxes labeled xI, X2, X3, X4. This number is
(3 
= 560.
Exercises 7.4
1. 
D6 = 265; D7 = 1854; D8 = 14,833.
3. 
DI1 = ll !(l -
1 
2! 
3
5. (b) 7! -D
7
6. (c) 20D19
7. (a) 9! -[5(8!) 
-10(7!) 
+ 10(6!) -5(5!) 
+ 4!] = 205,056
10. (a) Using Proposition 7.4.2,
D,, = n! -n! + [n(n -)(n 
-2) 
. 3] -[n(n -)(n 
-2) 
.. 4] + 
+ (- )"I n + ( I)n
=n[ (n -)(n 
-2) 
3 -(n -
)(n -2)... 
4 + 
+ (-1)' I(n- 
I)+ (-1) 
(- 1()" 
(mod n).
(b) This follows immediately from part (a).

Section 7.5 
S-33
11. (a) (n -I)(D,-, + Dn-2)
= (n-1)1 (n-l)![' 
I! 
+ 2! 
+ 
( 
1)!J
2 
I
+(n 2)! 
1 
+ -
+ ( 1) 
2)
+n >L 
! 
2! 
(ni 
2)!J
n(n 
!+ 2! 
+ (1)f 
(n 
1)I] 
(n 
L 
1! +2
+(n-Â±- 
+ 
+ 
1)-2 
1
)[ 1+2! 
(ii 
2)j
=n! 
+ 
-
)n)n!(-)n! 
-
( 
1)"
=D,, -(-I)n - (-I)n-l 
D,
*. + (-I )n 
I)!
Exercises 7.5
1. (a) 
(x + y) 6 = x6 + 6x5 y + 15x4 y2 + 20x3Y3 + 15x 2V4 + 6x 15 + 
-6
(b) (2x + 3y) 6 =64X6 + 576x5y + 2160x4v2 + 4320x3y3 + 4860x2 V4 Â±+ 2916xy5 + 729y6
3. 
(b) 
(2x 3 - X2)8 -
256x 24 -
1024x23 + 1792x22 -1792X21 
+ I 
120x 20- 
448x19 + 112x18 -16x1 7 + x 16
4. 
('X)(x )9(-2v 2 )3 =-1760x2 7y6
5. (c) The seventh term is (20X))XI4V6 
38,760x14 V6. The fifteenth term is (l2)X6yI4 = 38,760x6 y'4 .
6. (a) 
17 terms
(b) There is a middle term (since 16 is even). This tern is ( 16)(2x)8(-y) 8 = 3,294,720x 8 y8 .
8. 
The required term is (17Â°)(4x)3(5y)7 =120(64x3)(78125y 7). The coefficient is 600,000,000.
9. 
The term in question is ( 17)x13(3y2)4 = 2380x13(81v 8). The coefficient is 2380(81) = 192,780.
11. 
The general term is (18)(3) 8-k(x2)k = (18)318-kx3k 
18. We want 3k -
18 -27, 
so k 
15 and the coefficient is
(:5)33 = (816)(27) 
22,032.
14. (a) If n = 0, (1 + 
')) = 
I 
= I + 02, 
so x()= 1, yo = 0.
If n = 1, (1 + Vi)' = 1+ /2, sox I = 1, yi = 1.
If n =2, (1 +v )2 = I +2 
+2 =3+2V/2soX2=3, Y2 =2.
If n = 5, (I + /2)5 = I + 5 /2 + I 0(,2) 2 + I 0 (,2)3 + 5 (,2) 
4 + (,2) 5
= I +l,5 
2-+20+20V+20+4 2=41 +29,/V
and so xs = 41, y5 = 29.
16. 
With the given interpretation, row n of Pascal's triangle becomes the single number
1"0)+1- 
(1) 
+ ''+ 
10(n 
1 
~ 
r )
So we are trying to prove that y7 =(( 10o 
r(11) 
= II". This follows immediately from the Binomial Theorem since
I1, 
= (10 + 
I )= 
(n)(1)" 
r(1)r.
Ir

S-34 
Solutions to Selected Exercises
20. 
Consider (x - y)f = En 
(n)xn-k(_y)k = 
no 
(n)xn-k(_.)kyk
Setting x = y = 1, we obtain 0 = (1 -
I)n = yo=O (n)ln k(_l)klk = yk=O (n)(_I)k
= n) _(n) + (2)-'' 
+ (-I)"'
22. (a) 
ken) = (1) + 2(2) + 3(3) +4()+ 
+ (n 1)( 
)+ n
k=1
(n 
I)+ n(n-l)(n-2) 
n(n -l)(n -2)(n-3) 
( 
1)
=nnn 
lÂ± 
2 
+3! 
lÂ±
=n[lÂ±+(n 
+ (n- 
l)(n-2) + (n -l)(n -2)(n-3)
[ 
2 
1 
3)(n2l) 
( 
3 
) 
]
using the result of Problem 18 in the last step.
Exercises 8.1
1. 
To find the mid-point of a line segment AB, choose a radius r (for example, r = IABI) such that the arcs with
centers A and B and radius r meet at two distinct points, P and Q. The point of intersection, M, of AB and PQ is
the required mid-point.
lo see why tils worKs, consider the uiagram to ne rignt, in wnicn the labels are
given as before and line segments AP, BP, AQ, BQ are joined. Note that
ZPAB= ZPBA since AAPB is isosceles. Since ABPQ is congruent to AAPQ
(three pairs of sides of equal length), ZBPQ = LAPQ. Thus, triangles PAM and 
A
PBM are congruent (two equal pairs of sides and equal contained angles), so
IAMI = IBMI as required.
Q
3. (a) Let A be any point on e and let r = IAPI. Draw the circle with center P and radius r. If this meets e in only the
single point A, then PA is the desired perpendicular to e. Otherwise, the circle meets e in two points, A and B. Draw
arcs with centers A and B and radius r meeting in P and Q. Then P Q is the desired perpendicular to f.
To see this, consider the diagram at the right, with M the point of intersection of 
P
PQ and e. Since triangles PAQ and PBQ are congruent, LAPM = 1BPM.
Then it follows that AAPM -ABPM 
and thus, ZAMP = LBMP. Since these
angles have sum 180Â°, each is a right angle.
/o
5. 
The basic idea behind this is the simple fact that xy = (-)(2y). When x is even, the product xy can be equally well
2
determined as the product of x/2 and 2y. This explains why one crosses out a line where the first term is even: The
product of the two numbers in a crossed out line equals the product of the numbers in the line below.
B

Section 8.1 
S-35
When x is odd, however, the entry below x is X2 I while the entry below y is 2y. Their product is (x< -1.)(2y) = xy-y,
so the product xy is the product of the numbers in the line below, plus y. Note that y is the number in the right
column corresponding to the odd x on the left. Thus, we do not cross out lines where x is odd; the y terms must be
added at the end to give the correct product.
7. 
We find the sum of the numbers and divide by n. Thus, to find the average of n numbers al, a2, 
an,
Step 1. set S = 0;
Step 2. for i = I to n, replace S by S + aj;
Step 3. output S.
8. 
To find the maximum of n numbers ai, a2, 
an,
Step 1. let M = a,;
Step 2. for i = 2 to n, if ai > M, replace M by a1;
Step 3. output M.
The value of M output in Step 3 is the maximum of the aj.
11. 
If x < al, we wish to output x, at, a2, . . ., an. If al < x < a2, we wish to output al, x, a2,..., an, and so on. If
x > an, we wish to output al, a2, . .. ,a, ax. 
Here is one suitable algorithm.
To insert x into its correct position in the ordered list al < a2 < ... 
< a.,
Step 1. set F = 0;
Step 2. for i 
I to n,
if x < ai and F = 0, output x and set F = I;
else output aj.
Step 3. if F = 0, output x.
The variable F introduced here is a flag, whose purpose is to tell us whether or not x has been output. At the end of
the loop in Step 2, if x has not been output (that is, x is larger than all the ai's), then we will know this, because F
will not have changed from its initial value of 0; hence, we must output x as the final element. Note that the "and"
in Step 2 is the logical "and" introduced in Section 1.1. We output x and set F = 1 only if both x < ai and F = 0
are true.
13. 
Here's the idea. Divide a by 2, thereby obtaining a = 2 ql + al, 0 < al < 2. Then divide q, by 3, obtaining
ql = 3q2 + a2, 0 < a2 < 3. Note that, at this point, we have a = 2(3q2 + a2) + al = 3!q2 + 2!a2 + al. Next, divide
q2 by 4, obtaining q2 = 4q3 + a3 and a = 4!q3 + 3!a3 + 2!a2 + al. Eventually we have
a= n!qn- I+ a, -I(n -)! 
+ 
+ a2 2! +Â±aI,
which, with al -
q,-,, is the required expression. (Note that if at some stage qk-1 = 0, we have a. = an-l =
a: = 0, but the procedure is still valid.) Here is the algorithm for writing a = ann! +an-l(n - 1)! + 
+a22! + al.
Step 1. Let qo = a.
Step 2. For i = I to n -1, write qj-1 = (i + l)qi + ai with O < ai < i +1.
Step 3. Let an = q,- I.
15. 
A number between 0 and 2n - 1, when expressed in base 2, is a string of at most n O's and I's. By "padding" with
initial O's, if necessary, we can assume that all such strings have length exactly n. Then such a string, 61E2 
.. En, each
ci = 0 or 1, determines the subset A of [al, a2 .
, an } as follows: ai E A + 
= 1. Thus, the string 00... .0 of n
O's corresponds to the empty set, the string 11 ... I of n l's to the entire set (al, a2 . . ., an}, the string 11010... 0 to

S-36 
Solutions to Selected Exercises
the subset {al, a2, a4}, and so on. Enumerating the subsets of {al, 
a., 
a} now simply amounts to listing the integers
between 0 and 2' -
I in base 2. Here is an algorithm.
Step 1. Let M = 0. Output the words "empty set."
Step 2. for i = 1 to 2' - I
. replace M by M + 1;
. write M = 6162 ... cn as an n-digit number in base 2;
. for k = 1 to n, if Ek = 1, output ak.
Each value of i in Step 2 yields one subset of {al, . . ., a,} and, when Step 2 is complete, all subsets have been
output.
16. (a) i. S =1; S = 
+ (-3)(2) = -5; S = -5 + 2(22 ) = -5 + 8 = 3.
ii. S = 2; S -- 3 + 2(2) = 1; S = I + 1(2) = 3.
17. 
The first value of S is S = an.
With i = I in Step 2, the value of S is a, l + Sx = an-I + anx.
With i = 2 in Step 2, the value of S is a,-2 + Sx = an-2 + (an-I + anx)x = an-2 + an-Ix + anx2 .
With i = 3 in Step 2, the value of S is an-3 + Sx = 
3+an 2x an -x2 
+ anx3.
With i = n, the value of S is an-n +an-(n- l)x +an-(n-2)x2 + 
Â±+anXn = ao +alx +a2X 2 +. 
+ anx' as desired.
Exercises 8.2
1. 
f(n) =n+2n+n-1+20=4n+19
q
3. 
Consider the division of a number a, which has at most two 
bI
digits, by a single-digit number b, where a < lOb. 
qb
Since the quotient q has just one digit, the division counts as one operation, the product qb counts as another, and
since a - qb < b, the difference a -qb has just a single digit, so the subtraction requires a third operation. In the
division of an n-digit number by a single-digit number, this process is repeated at most n - 1 or n times, depending
on whether or not b is greater than the first digit of a. So at most 3n operations are required.
6. (a) With reference to Horner's algorithm as described in (8.1.1), each iteration of Step 2 requires two operations. Since
Step 2 is repeated n times, this method requires 2n operations. This is fewer operations than are needed by the
obvious method of polynomial evaluation, as we now show.
Assuming i multiplications to compute aix', 1+2+ 
+n = !n(n+ 1) multiplications are involved in the evaluation
Xnn(n 
+1) 
n2 Â±+3n
of ao + aix + *.* + 
. As well, n additions are required, for a total of 
( 
+ 
= 
2 
operations. This
22
estimate can be improved. Problem 18 shows that xi can be computed with approximately logi multiplications. So
1 + log i multiplications are required for aixi and
1 + (1 + log2) + (1 + log3) + 
+ (I + logn) = n + logn!
for the polynomial. Including additions, approximately 2n + log n! operations are required.
7. (a) Since 5n < n3 for all n > 3, we can take c = 1, no = 3, or c = 5, no = 1.
(c) For n > 1, we have 8n 3 + 4n2 + 5n + I < 9n4 + 18n2 + 24n + 6 = 3(3n4 + 6n2 + 8n + 2), so we can take c = 3,
no = 1.
8. (a) By Proposition 8.2.7, for instance, 
n -n, and by Proposition 8.2.8, n -< n3 . Thus, Sn -< n3.
(c) By Proposition 8.2.7, f(n) 
n3 and g(n) -n 4 . By Proposition 8.2.8, n3 -< n4 , so f _< g.

Section 8.3 S-37
10. (b) Suppose f 
-< g and g -< h. We must prove f -< h. By part (a), f = 0(h), so it remains only to prove that h #7 Off).
Assume to the contrary that h = 0(f). Then, since f = 0(g), using part (a) again, we would have that h = 0(g),
contradicting g -< h.
11. 
If f- 
g, then f = 0(g). Since g -< h, g = 0(h) and so, by Exercise 10(a), f = 0(h). To obtain f c h, we
have now to prove that h is not 0(f). But if h = 0(f), then, because f = 0(g), we would have that h = 0(g),
contradicting g -< h.
12. 
We have a' < b" for n > I since a < b, so an 
0(bn). We must prove bn :A 0(a"). If bn = 0(an), then there
would exist a constant c such that bn < can for all suitably large n. Dividing by a, we obtain (a)f < c, for all
suitably large n, but this is not true because b > 1 implies that (ab)n grows without bound as n increases.
13. (a) We established 2" < n! for n > 4 in Problem 6 of Chapter 5. Thus, 2' = 0(n!) (c = 1, no = 4). On the other hand,
n! #* 0(2n), for consider
n! 
1234 
n
2n 
2 2 2 2 
2
The product of the first three factors on the right is 3 and each of the remaining n - 3 terms is bigger than 2. So
2n! > (2n-3) for n > 3. If n! = 0(2"), then n! < c2" for some constant c and all suitably large n and so n! < c.
We have shown this is not possible. Since 2" = 0(n!) but n! :A 0 (2f), 
we have 2" -< n! as required.
15. 
For any n > 1, Jkf(n)l = JklIf(n)L. Taking no = 1 and c = Ikl in Definition 8.2.1, we see that kf is 0(f). Also,
If(n)l = Tk- Ik(f (n)I says that f = 0(kf) and so f 
kf.
18. 
Since log2 n = 0(n) by Proposition 8.2.9 and n = 0(n), we have n log2 n = 0(n 2 ) by Proposition 8.2.3. Thus,
it remains only to show that n2 54 0(n 1og2 n). Assume to the contrary that for some positive constant c, we have
n2 < cn lg 2 n for sufficiently large n. Then, for large n, we would have n < c log2 n. This says n = 0(log2 n),
contradicting Proposition 8.2.9.
19. (b) f zn2
20. (a) n5
21. 
Since logan = (logb)(logbn), we have Ilogn1 = IlogabIIlogbnI for all n > 1. With c = logb and no = 1 in
Definition 8.2.1 we see that log, n is O(logb n). By symmetry, logb n = 0(loge n); hence, log, n 
o1gb n.
23. 
Since n! = n(n- 
1)(n -2) ... 3 2 
< n', logn! < n logn. With c = 1, no = 1 in Definition 8.2.1, we see that
logn! = 0((n logn) as required.
Exercises 8.3
1. (a) Since n = 9 :A 1, we set m = L22 = 4. Since 2 = x = a4 = 4 is false and x < a4 is true, we set n = m = 4 and
change the list to 1, 2, 3, 4.
Since 4 = n :$ 1, we set m 
L-2 j = 2. Since 2 = x = a2 we output "true" and stop.
This search required three comparisons of 2 with an element in the list-x = a4, x < a4 and x = a2. A linear search
would have used two comparisons.
3. (a) To find the complement of A = [ai, a2, .
akI with respect to U = (1, 2, .
1001,
Step 1. For i = I to 100, search A for i and if i is not found, output i.
The output numbers are the elements of Ac.

S-38 
Solutions to Selected Exercises
4. 
2,3,4,5
3, 4, 5
3,4,5
4, 5
5
5
2,4,6,8, 10 
1
2,4,6,8, 10 
1,2
4,6,8, 10 
1,2,2
4,6,8, 10 
1,2,2,3
4,6,8, 10 
1,2,2,3,4
6,8, 10 
1,2,2,3,4,4
6,8, 10 
1,2,2,3,4,4,5
1,2,2,3,4,4,5,6,8, 10
The algorithm required seven comparisons.
6. (a) Here's the bubble sort:
k-5: 3,1,7,2,5,44 
1,3,7,2,5,44 
1,3,7,2,5,44 
1,3,2,7,5,4 
1,3,2,5,7,4
k 4: 1, 3, 2, 5,4,7 
1, 3, 2, 5,4,7 1,2, 3, 5,4,7 
1, 2,3, 5,4, 7
k 3: 1, 2,3, 4, 5,7 
1,2,3, 4, 5,7 
1, 2,3, 4,5, 7
k 
2: 1, 2,3, 4, 5,7 
1, 2,3, 4,5, 7
k 
1: 1, 2,3, 4, 5,7 
1, 2,3, 4, 5,7.
This required a total of 5 + 4 + 3 + 2 + I = 15 comparisons.
(b) Here's the merge sort.
Step 2. 
1; 
3; 
2; 
7; 
4; 
5
Step 3. 
1,3; 
2,7; 
4,5
Step 3. 
1,2,3,7; 
4,5
Step 3. 
1,2,3,4,5,7
Merging two lists of length I to one of length 2 requires I + I1 1 
1 comparison. Thus, the initial merging of six
lists of length I to three lists of length 2 requires I + 1 + 1 = 3 comparisons. Merging three lists of length 2 to one
of length 2 and one of length 2 requires 2 + 2 - 1 = 3 comparisons. The final merging of lists of lengths 4 and 2
requires 4 + 2-I 
= 5 comparisons, for a total of 3 + 3 + 5 = 11 comparisons.
8. 
Sort the list into increasing order al < a2 < 
< a,. If n = 2m + I is odd, the median is am; if n = 2m is even,
the median is 
(am + am+1). Since determining the parity of n adds only another operation, the complexity of this
algorithm is the complexity of the sort, at best O(n log n).
9. (a) Here's the bubble sort.
k =7: a.b.c.d.u.v.w.x -a.b.c.d.u.v.w.x --- a.c.b.d.u.v.w.x -a.c.d.b.u.v.w.x
10. (a)
(b)
(c)
a, C, d, u, b, v, w, x 
a, c, d, u, b, v, w, x 
a, c, d, u, 
b, v, w, x
k =6: a, c, d, u, b, v, x, w -* a, c, d, u, b, v, x, V -
a, d, c, u, b, v, x, w 
a, d, u, 
c, b, v, x, w
--. a, d, u, 
c, b, v, x, w -+ a, d, u, 
c, b, v, x, w
k=5: a,d,uc,b,x,v,w-*da,u,c,b,xv,w 
d,a,u,c,b,xv,w 
d,a,uc,bxv,w
-* 
d, a, u, c, b, x, v, w
k =4: d, a,u c, Xb, v, w 
d,a, U, c,x,b, v, w 
d, a, U, c,x, b, v, u- 
d, a, u, cx, b, v, w
k = 3: d, a, u, c, x, b, v, w 
d, a, u, c, x, b, v, w 
d, a, u, 
c, x, b, v, iv
k = 2: d, a, u, cx, b, v, w 
d,a, u, c,xb, v, w
k = 1: d, a, u, c, x, b, v, w 
d, a, u, c, x, b, v, w
A total of 7 + 6 + 5 + 4 + 3 + 2 + I = 28 comparisons is needed.
The lists I and 2, 3, 4 can be merged with one comparison.
The lists 5 and 2, 3, 4 can be merged with three comparisons.
The lists 1, 3, 5 and 2, 4, 6 can be merged with 3 + 3-I 
= 5 comparisons.

Section 8.4 
S-39
11. (a) c, a, e, b, d 
a, c, e, b, d 
a, c, e, b, d -- a, c, b, e, d
a, c, b, d, e 
a, c, b, d, e 
a, b, c, d, e
a, b, c, d, e 
a, b, c, d, e
a, b, c, d, e -
a, b, c, d, e
14. 
The answer is minfs, tl. It is impossible to have fewer than this number of comparisons since until mints, t} of
comparisons have been made, elements remain in each list. To see that minis, t} can be achieved, consider ordered
lists al, a2, . . ., as and bl, b2, . . ., bt where s < t and as < bl. After s comparisons, the first list is empty.
16. 
Using the efficient binary search, O(log k) comparisons are needed to search the predecessors of ak . In all, the number
of comparisons is O(log I +log 2+ + 
+logn). Since loga+logb = log ab, we have log l+log 2+- + 
-+log n -
logn!.
The result follows.
18. 
This is less efficient. A merge sort is tP(n logn) and a binary search is O(logn). Since n + n logn - n logn, the
suggested procedure is O(n log n), while a linear search is ((n), which is better.
Exercises 8.4
1. (a) 
t 
Perm(t) 
j 
m 
S
l 
1 234
2 
1 243
3 
1 3 24
4 
1 342
5 
1 423
7r 1J 2 737 4
1 43 2
7 
2 1 3 4
71721374
3 
4 
{l, 2, 4}' ={3
2 
3 
{l, 31' = {2, 41
3 
4 
{1, 3, 4}' = (2)
2 
4 
(1, 41' = {2, 3)
3 
3 
(1, 4, 31' = {2}
1 
2 
{2)c = {I, 3, 4)
3 
4 
{2, 1, 4) =3
8 
2 1 4 3
2. (b) 42531,43125, 43152, 43215, 43251
3. (a) We consider each part of Step 2. Finding the largest j such that wy < rj+l requires at most n comparisons. At most
another n comparisons are needed to find the minimum of {r Ii 
,< 
J. r > rj 1. To find the complement of a subset A
of { I, 2, ... , n} requires searching A for each of the elements 1, 2, ... , n and noting those which are not in A. Using
the efficient binary search, each search is O(log2 n), adding another n log2 n comparisons. An efficient merge sort adds
another n 1og2 n comparisons, so each pass through Step 2 requires at most n +n +n log2 n +n log2 n = 2(n +n log2 n)
comparisons. Since this step is executed n! -
I times and n + n log2 n - n log2 n, the algorithm is 0(n !n log2 n).
1235 
1236 
1245 
1246
1345 
1346 
1356 
1456
2346 
2356 
2456 
3456
23467, 23468 precede; 23478, 23479, 23489 follow.
7. (b) First list the combinations of 1, 2, ... , n taken r at a time by the method of Proposition 8.4.3. Then, for each of
these combinations, enumerate all permutations of its elements using Algorithm 8.4.2.
5. (a) 
1234
1256
2345
6. (a) 23459,

S-40 
Solutions to Selected Exercises
8. (a) 
123456 
123457 
123458 
123467 
123468 
123478 
123567
123568 
123578 
123678 
124567 
124568 
124578 
124678
125678 
134567 
134568 
134578 
134678 
135678 
145678
234567 
234568 
234578 
234678 
235678 
245678 
345678
9. 
If ala2 . . . ar is one of the combinations of 1, 2, .. , n taken r at a time, a, cannot be less than 1, a2 cannot be less
than 2 and, in general, ai cannot be less than i. Thus, 123 . . . r is the smallest combination.
Now let 7r be a combination and 7r' the combination determined by or as in the proposition. We show that 7r' is the
immediate successor of or with respect to lexicographic order. First, since all numbers to the left of k - I are the
same in both combinations, while k -I 
is increased to k, we conclude that Jr -< 7'. Now suppose that Tr -< a < 7r<
for some combination a. All integers to the left of k - 1 (in 7r) are the same in 7r' as well, and hence also in a. If
k -I 
were also the same in a, then we would have a = 
r since no number to the right of k -
I can be increased
in xr. Thus, in a, k -I 
must be increased to k (and no more, since a -< 7r'). It then follows that a = 7r' since IT/ is
the smallest sequence whose initial segment (up to k) consists of the integers of jr'.
10. (a) n; n- r+ 1; n -r+ 
j.
(b) It must be 123 . . . r.
(c) It must be (n-r 
+ 1) (n-r 
+ 2) ... n.
11. 
Given n > r > 0, to enumerate the (n) combinations of 1, 2, .
n taken r at a time, proceed as follows.
Step 1. Set t = 1. Output Comb(1) = 123 ... r. If r = n, stop.
Step 2. For t = I to (r) -
1, given combination Comb(t) = ala2 . . . ar, determine the next combination Comb(t + I)
as follows.
(i) Find the largest j such that aj < n -r + j.
(ii) Output Comb(t + 1) = al a2 ... aj-1 aj + I aj + 2 ... aj + r-j 
+1.
Exercises 9.1
A
1.
C
2. 
HI 
H2
4. (a) We
corresponds to the cubes, and two edge disjoint subgraphs.
B 
3 
R 
B 
R
2 
4
C 
W 
4 
C

Section 9.2 
S-41
Here is the solution indicated.
'F 
B 
R 
L
Cube4 
B 
G 
W 
G
Cube 3 | R 
B 
R 
W
Cube 2 
W 
R 
G 
B
Cube I 
G 
W 
B 
R
(e) Here are the graph corresponding to the cubes and two edge disjoint subgraphs.
2
B 
K
4
W 
G
Here is the solution indicated.
B 
R 
B 
R
3 
3 
1
WI) 
G 
W 
G
F 
B 
R 
L
Cube4 
G 
B 
W 
R
Cube 3 
R 
G 
B 
W
Cube2 
B 
R 
G 
B
Cube 1 
W 
W 
R 
G
5. (a) Beta index = 7
6
1 4 5
,2
9. 
If there are four or more vertices of one color, say red, then there are at least (t4) = 4 red triangles. Otherwise, there
are three red and three white vertices, hence, one triangle of each color.
Exercises 9.2
V2
1. 
Here is one possibility. 
VI 
1  
V3
V5 
V4
5. 
10 edges. This is KC
5, the complete graph on five vertices.
V1
V2
9. (a) 
i 
V3
V4
V5
V6
V1 
V2 
V3 
V4 
V5 
V6
0 
1 
2 
2 
2 
1
1 
0 
1 
2 
3 
2
2 
1 
0 
1 
2 
1
2 
2 
1 
0 
2 
1
2 
3 
2 
2 
0 
1
1 
2 
1 
1 
1 
0
6.
-
-
'Z

S-42 
Solutions to Selected Exercises
ii.
vertex 
V1  
V2  
v 3  
V4  
V5  
V6
column total 
8 
9 
7 
8 
10 
6
vertex degree 
2 
2 
3 
2 
1 
4
accessibility index 
4 
4.5 
2.3 
4 
10 
1.5
City V6 has the lowest accessibility index; it is the most accessible. City V5 is least accessible.
iii. Joining v1 and 03 gives now eight edges, with still six vertices.
New beta index = 
O= 
1.3
New accessibility indices are 2.3, 4.5, 1.5, 4, 10, 1.5.
Cities V6 and V3 are now tied for most accessible; V5 is least accessible.
iv. Joining v2 and V6 gives eight edges and still six vertices.
New beta index = 
1 3
6
New accessibility indices are 4, 2.3, 2.3, 4, 9, 1.
City V6 is most accessible; Vs is least accessible.
10. 
IC,, has (") = ,(n2 I) edges. Each of the n vertices has degree n -1, 
so the sum of the degrees is n(n - 1). This is
twice the number of edges, as asserted by Proposition 9.2.5. If n is even there are n odd vertices; if n is odd, there
are 0 odd vertices. In either case the number of odd vertices is even, in accordance with Corollary 9.2.7. The beta
index is n, 
-1) 
2 = nI
12. 
Consider the graph in which the vertices correspond to the people at the party and an edge between vertices indicates
that the corresponding people shook hands. The degree of a vertex in this graph is the number of hands that person
shook. Thus, the result is an immediate consequence of Corollary 9.2.7.
14. (a) Yes, as indicated.
15. (a)
16. (a)
(b)
17. (a)
(c)
A 
D
B 
C
A
B -~wC
D
V
5 \ {e} 
5 \ {v) 
5 \ {U)
Degree of vl is l; degree of V2 is 3; degree of V3 is 4; degree of V4 is 2.
No. The maximum degree of a vertex in a graph with four vertices is 3. (Loops are not allowed in graphs.)
No such graph exists. The sum of the degrees of the vertices is an odd number, 17, which is impossible.
Impossible. A vertex of degree 5 in a graph with six vertices must be adjacent to all other vertices. Two vertices of
degree 5 means all other vertices have degree at least 2, but the given degree sequence contains a 1.
19. (a) 
12
20. (a) This is not bipartite because it contains a triangle.
(c) This is bipartite with bipartition sets indicated R and W.
R 
W 
R
W 
W
R 
W 
R
21. 
At least two of the three vertices must lie in one of the bipartition sets. Since these two are joined by an edge, the
graph cannot be bipartite.
Q

Section 9.3 
S-43
23. 
Let x be the number of vertices in one of the bipartition sets. Then n -x 
is the number of vertices in the other.
The largest number of edges occurs when all x vertices in one set are joined to all n - x vertices in the other; so
the number of edges is at most x(n - x). The function f(x) = x(n -x) 
(whose graph is a parabola) has a unique
maximum at (n, ' 2), so x(n -x) 
< 
2 for all x, and the result follows.
25. 
(a) 2(2) 
(c) (3)2(') 3
27. 
23
29. 
E deg vi = kI V. But also, E degvh = 2 1 . Therefore, 21I = kIVj and so k divides 2181. But k is odd, so k I 18I.
30. 
There are n vertices and n possible degrees for the vertices; namely, 0, 1, 2, . . ., n-1. If, however, we have a vertex
of degree 0, then it is not possible to have another vertex of degree n -1. Hence, there are really only n -1 possible
"holes" into which the n vertices can fit. Hence, some vertex degree is repeated.
Exercises 9.3
1. 
(i) and (ii) are not isomorphic because (i) has five edges and (ii) has four.
(i) and (iii) are isomorphic, as shown by the labeling.
A 
B 
A D 
A 
B 
'A B 
C
C 
D B 
C 
C 
D 
D
(i) and (iii) 
(i) and (v)
(i) and (iv) are not isomorphic because (iv) has a vertex of degree I and (i) does not. (Also, (iv) has only four edges.)
(i) and (v) are isomorphic, as shown by the labeling.
(ii) and (iii) are not isomorphic because (ii) has four edges and (iii) has five edges. 
A 
D 
B
(ii) and (iv) are not isomorphic because (iv) has a vertex of degree I and (ii) does not.A 
C
(ii) and (v) are not isomorphic because (v) has five edges and (ii) has four edges. 
\
(iii) and (iv) are not isomorphic because (iv) has a vertex of degree I and (iii) does not. 
B 
C 
D
(iii) and (v) are isomorphic, as shown by the labeling to the right.
(iv) and (v) are not isomorphic because (iv) has a vertex of degree I [or because (v) has five edges].
3. (a) 
o 
Â°
0,0,0 
1, 1,0 
2, 1, 1 
2,2,2
4. (b) These graphs are isomorphic. One possible isomorphism is given by
(p(A) = p, 
(p(B) 
t, 
p ((C) = u, 
(p(D) = v, 
(p(E) -
Q. 
p(F) = s, 
(p(G) 
r
as illustrated. 
p
AE
r 
SB
G 
F t
C 
DF 
G 
/ \
Cu 
vD
5. (a) No; it has a vertex of degree 5.
6. 
Any graph 5 with n vertices is a subgraph of IC,, as is easily seen by joining any pair of vertices of 9 where there
is not already an edge.

S-44 
Solutions to Selected Exercises
7. (a) Suppose that g and a 
are isomorphic graphs and ,p: V(5) 
V(H) is the isomorphism of vertex sets given
by Definition 9.3.1. Label the edges of 5 arbitrarily, g1, g2, 
g,,, and then use So to label the edges of NH as
hI, h2 ,.. ,hm; that is, if edge gi has end vertices v and w in 5, let h, be the edge joining p(v) and js(w) in N.
Repeat to obtain h2 , . . ., hm. Now a triangle in 5 is a set of three edges {gj, g9, g9} each two of which are adjacent.
It follows from the way we labeled the edges of 'H that {gi, gj, gk) is a triangle in g if and only if (hi,hj, hk} is a
triangle in A. Thus, the number of triangles in each graph is the same.
10. (a) No.
5 
N
Exercises 10.1
1. (a) 
0 
0
2. 
Since the graph describing the Konigsberg Bridge Problem (Fig 9.2) has several odd vertices, it is not Eulerian. It is
not possible to walk over the bridges of Konigsberg exactly once and return to the starting position.
3. (a) The graph is Eulerian because it is connected and each vertex has even degree 4. Piecing the circuits ABCDEFGA
and ACFBDGEA together at A gives the Eulerian circuit ABCDEFGACFBDGEA.
4. (a) 
14 
1
7 
6 
2
8 
3
12V 
4
9 
10
5 
6
6. (a) Yes, there is because A and B are the only vertices of odd degree. 
3
21
19B
7. (a) No. In the graph representing the modified Konigsberg Bridge Problem
there are two vertices of odd degree. 
A 
B
D
(b) This question asks about the possibility of an Eulerian trail and there is one, between the two vertices A and B of
odd degree. One possibility is ACBDADCAB.
9. 
Yes. In this case, both 5 and N must be cycles.
11. (a) KI, is Eulerian 
-* 
n is odd.
(b) k,, has an Eulerian trail if and only if n = 2. For n = 2, certainly o-o has an Eulerian trail. For n > 2, if two
vertices have odd degree, then there are other vertices of odd degree so no Eulerian trail can exist.
14. 
Suppose the vertices of the circuit are vo, vl, . . .v, ,, vo. Consider all subcircuits of the form vi, vi+1, vi+2, .
.vi
(There is at least one such, taking i = 0.) That subcircuit vi, vi+1, vi+2, .v .
, vi which uses the fewest number of
vertices is a cycle. If the original circuit was not a cycle, then those vertices not on the first chosen subcircuit

Section 10.2 5-45
v,, vi+1, Vi+2, . .., vi, together with vi, form another subcircuit, and the same argument as before shows that this
contains a second cycle.
VI 
V2 
V3
15. 
False. In the graph shown, vlv2v3v2vl is a closed walk that does not contain a cycle. 
3 
0 
-0
17. 
By definition, u - u, so - is reflexive. If u -
v, then there is a walk u = uo, uI, ... , Uk = v from u to v. But then
V = Uk, Uk- 
, 
1. .
, ul, uo = u is a walk from v to u, so v - u and - is symmetric. Finally, if u - v and v - w,
then there is a walk u = uo, ul, . 
u. 
, Uk = v from u to v and a walk v = vo, vl, ... , vi = w from v to w. But then
U = Uo, U1, .
U 
.
, Uk = v = Vo, VI, 
v
. .
, vt = w is a walk from u to w, proving u - w and establishing transitivity.
20. 
We must show that there is a walk between any two vertices x and y of G. We show that there is, in fact, a walk of
length at most 2 between x and y. If xy is an edge, then obviously there is a walk from x to y, so suppose that xy
is not an edge. Let S be the set of vertices adjacent to x and T be the set of vertices adjacent to y. Thus x 0 S U T
and y V S U T so the number of vertices in G is 20 > IS U TI + 2. Using the Principle of Inclusion-Exclusion,
20 > ISI+ IÂ±f -ISn fI+2= degx+deg y- ISn flTI+2>21 -ISn T ItfollowsthatS n T $ 0, so there is a
vertex u in both S and T and, thus, a walk xuy from x to y.
21. (a) Since 5 is connected and n > 1, no vertices have degree zero. Therefore, if there are no vertices of degree one, every
vertex of g has degree at least 2. Using Â£ to denote the set of edges of 5, it follows that 21 81 = 
deg vi > 2n (by
Proposition 9.2.5) and the number of edges IS1 > n as required.
24. 
Suppose that gl has ni components and that C2 has n2 < ni components. Let v , 
VnI be vertices of C1 each in
a different component. Then there is no walk between any pair of these vertices. On the other hand, if wi, .. , Wni
are any n1 vertices of 52, at least two of these must lie in the same component (by the Pigeon-Hole Principle) and
hence there is a walk between these two. Thus, the vertices v, in C1 do not correspond to any nl vertices of 52, so
these graphs cannot be isomorphic.
Exercises 10.2
1. 
This graph is not Hamiltonian. To see this, suppose X were a Hamiltonian cycle.
Rin-_ 
V-or-i,%. 
A 
-AI 
) 1-- 
U 
hspI 
AP tfl- 
fL- 
-A- 
IiU-iM-f -VitL -1Uh of t-p 
e 
A 
B
-111U 
MILtlC-; 
A WMl D HaY,~ uvrl.,, a, tile 
tW- 
-~ur-D Ili.-tll 
Wl" 
-~~l --ti
vertices would be in X. Thus, X would contain the cycle ACBDA, which cannot
be the case since this does not contain all vertices of the graph. The graph is not
Eulerian because it contains vertices of odd degree.
2. (b) This is not Hamiltonian. since it isn't connected. 
(d) 
1
3
5
4. (a) Yes, it is Hamiltonian: ABDCEA is a Hamiltonian cycle.
(c) The graph is not Eulerian. Vertices A and E have odd degree.
A3 
B 4 C~5
7. 
In the graph to the right, vertices correspond to rooms and edges to doorways. 
2 
10
E 1
7F
8 G

S-46 
Solutions to Selected Exercises
(a) No, because the graph is not Hamiltonian. Since vertices A, C, D, and E have degree 2, the edges labeled 3, 4, 5,
6, 1, and 2 would have to be part of any Hamiltonian cycle. These edges, however, define a proper cycle, which is
not allowed.
8. 
The result is obvious if n = 1 since in this case there are just two people who are friends. So we assume that n > 1.
Consider the graph whose vertices correspond to people and where an edge between vertices v and u signifies that
v and u are friends. The question asks us to prove that this graph is Hamiltonian. This is an immediate consequence
of Dirac's Theorem since the graph in question has 2n > 3 vertices each of degree d > n = 2n
9. (a) n edges.
(c) IC, has n(1) edges, so the maximum is -2 1 edge disjoint cycles.
1 
8
10. 
The cube is indeed Hamiltonian; the labels 1, . . , 8 on the vertices
exhibit a Hamiltonian cycle.
4 
5
13. (a) As suggested, add an extra vertex v to g and join it to all other vertices. Then deg v = n > n 1, and degw >
Â± 
1 + I 
for all other vertices. By Theorem 10.2.4, this new graph with n + 1 vertices has a Hamiltonian cycle.
2 
2
Deleting v and all the new edges incident with v leads to a Hamiltonian path in our original graph.
(e) o-o is an example!
14. 
As in the proof of Dirac's Theorem all vertices adjacent to vi are in P.
(a) If Vl and vt are adjacent, C1: VI V2 
V.Vt 
is a cycle. If t < n, then there exists a vertex w not in C1 . As noted, w is
not adjacent to v1, hence the hypothesis tells us that deg V I + deg w > n. It follows that there exists some vertex u
which is adjacent to both Vl and w; otherwise, the graph has at least n + 2 vertices, counting Vl and w and the disjoint
sets of vertices adjacent to Vl and to w. Since u is adjacent to Vi, u = vi for some i. Now wvivi+1 ... vtv ... vi-
is a path longer than P. a contradiction. Thus t = n, so Cl is a Hamiltonian cycle and we're done.
15. 
Add a new vertex adjacent to all existing vertices and apply the result of Exercise 14.
16. (c) False. 
K 
is Eulerian but not Hamiltonian.
17. (a) Yes! Since there is a path between any two vertices, the graph is connected. Thus, there exists an edge e in the graph,
joining, say, vertices v and w. Now let P be a Hamiltonian path from v to w. Then starting at v, following P to w
and then e to v produces a Hamiltonian cycle from V to v.
Exercises 10.3
F 1 0 1 
0 
0
1. 
A 
0 
1 0 
1 1 1
0 
0 
1 
0 
0 
1
0 01 
00 
1

Section 10.4 
S-47
3. (a) The (3, 5) entry of A3 is 5. The (2, 2) entry of A3 is 2.
4. 
Each I represents an edge. Each edge v, vj contributes two I 's to the matrix, in positions (i, j) and (j, i). The number
of l's is twice the number of edges.
6. (a) The (i, j) entry in A2 is the number of walks of length 2 from i to j. Hence, the sum of all such entries is the total
number of walks of length 2.
I 
0 
10 
F 1 01 0 0
8. (a) A1 
0 
1 
0 
0 
, 
A2 = 
0 
0 
1 I
1 000 
0 
0 
1 
0 1 
I
I 
1 
0 
A 
0 
0 
1 
0-
(b) The function So is an isomorphism because, if the vertices of g1 are relabeled, vi being replaced by Sp(vi) 
ui, then
the adjacency matrix of g1 relative to the ui's is A2. (See Theorem 10.3.3.)
F 
00 10 
0
0 000 
1
(c) P= 
0 0 0 
1 
0
1 
000 
0
[0100 
0
p 
q 
r
11. (a) PA = 
x 
y 
z 
is A, but with rows written in the order 2, 3, 1, the order in which the rows of I were
a 
b 
c
rearranged to give P.
13. (a) The matrices are the adjacency matrices of graphs Qi, g2, respectively. Since g2 has three vertices of degree I while
g1 has only one, the graphs are not isomorphic, so no such P exists, by Theorem 10.3.4.
14. 
The ith entry on the diagonal of A37 is the number of walks of length 37 from vi to itself. But in a bipartite graph,
you can only get from v, back to itself in an even number of steps. Hence, the entry is 0.
15. (a) A2 is an adjacency matrix * 
A is the 0 matrix.
Proof. For A2 to be an adjacency matrix, it must have all diagonal entries equal to 0. But the ith diagonal entry of
A2 is the number of walks of length 2 from vi to itself. Now, if vi vj is an edge of 5, then vi vj vi is a walk of length
2 from vi to itself, and the ith diagonal entry would not be 0. We conclude that g cannot have any edges; that is, A
is the zero matrix. On the other hand, if A is the zero matrix, certainly A2 = A is an adjacency matrix.
18. 
We could store the incidence matrix, whose columns correspond to edges and rows to vertices. The (i, j) entry is I
if vertex i is incident with edge j, and otherwise 0. We could also simply store the edges as a linear list, perhaps of
numbers: Assuming less than 100 edges, we could store the edge ij as lOOi + j and recover i as L 
and j as
(lOOi + j) -
lOOi.
Exercises 10.4
2. (a) [BB] The final labeling starting at A is shown to the 
B(A 2 
3 
D C5
right. The shortest path from A to E is 
( 
2 
1 CB 3) 2 
( 
5
ABCJIGFKE and has length 13.
A( 
0) 
/E(K 
13)
Hf(A, 1) 9 G(I, 9) 
1 F(G, 10)

S-48 
Solutions to Selected Exercises
3. 
If we start at A, permanent labels will be assigned in the order A, H, B, C, D, J, I. G, F, K, E.
5. 
A shortest path has length I 1. One way in which permanent labels might be assigned is in the order A, B, D, C, S,
J, 1, H, E, L, G, F, K, M, 0, P, N, Q, R.
7. 
The shortest path has length 13, as shown.
Q000D
0)
0
1A
VI
0 
0 
0
In each case the answer is yes, if A and E were in different components of a graph which was not connected.
(a) Assign each edge a weight of l.
As explained in the text, the complexity function for determining the shortest distance from a given vertex to each
of the others is 0(n 2 ); that is, for sufficiently large n and some constant c, the algorithm requires at most cn2
comparisons. Applying the algorithm to each of the n vertices (after which all shortest distances are known) requires
at most n(cn2 ) = cn3 comparisons. Thus, this process is 0(n 3 ).
(b) d(l, 5) = 27; d(l, 6) is still c; d(3, 4) is 8; d(8, 5) = 24.
It is indeed necessary to continue. An identical set of d(i, j) for k = r and k = r + 1 simply 
V2 
3 
v13
indicates that the shortest path from each vi to each vj passing through vi, . . .V, r has the
same length as the shortest path through vI, . . ., Vr+I. In the graph shown to the right, for 
I
instance, the values of d(i, j) do not change until k = 3 since the shortest path between
pairs of vertices cannot be reduced until vertex V3 is used.
)I
Exercises 11.1
1. (a)
2. 
)C5 is Eulerian, so no additional
3. 
Here is the unique solution.
edges are needed.
C 
2
A
3 1 
I
4. 
We show one of several solutions in each case.
9.
11.
12.
13.
16.
I

Section 11.2 
S-49
A 
s A q
) 
( 
I
B 
-. 
] 
B
C 3 
z F 
C
D 
. ,~ E 
D
D 
E
4
3
~2 g
,2F
2
6
V 
V 
-I 
-
6. 
The shortest route from X to X is a circuit (perhaps in a pseudograph) passing through Y. Hence, it can also be
viewed as a circuit from Y to Y. Any other route from Y to Y could also be viewed as a route from X to X. So there
cannot be any shorter route from Y to Y.
9. 
Each odd vertex in G is the end vertex of precisely one new path constructed by the algorithm, so it is even in A'.
Each even vertex in g either has unchanged degree in 5' or, as an intermediate point on one or more paths between
odd vertices, has its degree increased by a multiple of 2, and so remains even in 5'.
Exercises 11.2
1. (a) These digraphs are not isomorphic because one has six vertices while the other has five.
3. 
Every arc comes out of one vertex and goes into another, hence, adds one to the sum of all indegrees and one to the
sum of all outdegrees.
5. 
The answer is yes. Since g is an Eulerian graph, there exists an Eulerian circuit. Now just orient the edges of this
circuit in the direction of a walk along it.
~0
i1 1  0]
7. (a) A L I 
Y 
I
(b) The (3, 3) entry of A2 is 2 because there are two directed walks of length 2 from vertex 3 to vertex 3; namely, 323
and 343. The (1, 4) entry of A2 is I because the only directed walk of length 2 from vertex 1 to vertex 4 is 134.
(c) The (4, 2) entry of A3 is 4 because there are four directed walks of length 3 from vertex 4 to vertex 2; namely, 4212,
4232, 4132, and 4342. The (1, 3) entry of A4 is 6. There are six walks of length 4 from vertex I to vertex 3; namely,
13423, 13413, 13213, 12123, 12323, and 12343.
(d) The digraph is strongly connected; 12341 is a directed circuit which permits travel in the right direction between any
two vertices.
(e) The digraph is not Eulerian. Vertices 2, 3, and 4 have different indegree and outdegree; vertex 3, for instance, has
indegree 3 and outdegree 2.
10. (a) With the graphs labeled as shown, the adjacency matrices are 
6 
e 
2' 
5
4
5
F 01 00001 
F 0 00 01
Al 
0= 00100 
and A2  
0 1 
0 
0 
0
0 0 0 0 1 0 
00 
1 0 0
L 00 0001] 
Loo 
0 
I 0]
I 
1)

5-50 Solutions to Selected Exercises
-
1 0 
1 
0 0 0 
1]
11. (a) A= 
0 
0 
1 0 
and 
A2 
I 
0 
1 0
I 1 
0 
0 
0 
0 
1 
0
(b) With the vertices of g1 relabeled according to So, its adjacency matrix becomes that of g2-
0 1 
0 
0
(c) P 
0I 0 0 1
L 001 
0j
(d) The digraphs are strongly connected: In g1 , for instance, vIv2v 3v4vI is a circuit which respects arrows and 52 is
isomorphic to 61 hence, also strongly connected.
(e) The digraphs are not Eulerian. In Qi, for instance, vertex v2 has indegree 2 but outdegree 1.
14. (a) Each of these graphs is strongly connected; each is a cycle.
15. (a) There are just two possibilities for the outdegree sequence; 1, 1,1 and
2, 1, 0. The corresponding graphs are shown at the right.
16. 
No. IC3 is connected, but 
is not strongly connected.
18. 
True. Let v be a vertex. Since g has at least two vertices and 5 is strongly connected there is some arc of the form
vw. Since 5 is strongly connected, there is a path from w to v. This path does not use arc vw since all vertices of a
path are distinct. For the same reason, all arcs on this (or any) path are distinct. Thus, arc vw followed by the path
from w to v gives the desired circuit.
19. (a)
V2
V3
V4
V5
V6
Max. no. of arcs
1 
2 
3 
4 
5 
6
l,vI 
1,vI 
l,v, 
l,vI 
l,vI 
t,VI
8, VI 
2, v2 
2, v2 
2, v2 
2, v2 
2, v2
oo 
I 1, V3 
5, V3 
4, v5 
4, V5 
4, V5
Â°Â° 
4,V2 
3,v3  
3,V3 
3,v3 
3,v3
7,vI 
7,v, 
7,v, 
6,v5 
6,v5 
6,vs
20. 
Bellman-Ford works fine on undirected graphs without negative edges. It wouldn't make sense to apply Bellman-Ford
to an undirected graph with a negative edge weight, since any walk could be shortened by passing up and down that
edge as often as desired.
V,(V1. ()
21. (a) Dijkstra incorrectly determines that the length of a shortest path to v2 is
1. Dijkstra does not always work when applied to digraphs which have 
(-k
arcs of negative weight. 
VI
(b) No shortest path algorithm will work. There is a negative weight cycle,
-2
V3
(V2, 2)
hence no shortest distance to V2, Tor example. 
v4 (vI, 1)
23. (a) As Step 2 of the algorithm shows, for each j, the values di (j) depend only on the values di-I (k) and the arc weights.
It follows that if the values d-I (j) = d, (j) are identical, then di- (j) = di (j) = di+, (j) = 
=d, -I(j).

Section 11.3 
S-51
Exercises 11.3
IrqUt1 
SIVWI 
Q;- 
lla.l~ 
-1l3 IlUIII ally 
Us- 
.'a 
Rneteoni 
.n.l 
h ivnfsmtnrefrom -v of'Al = Ai 
C 
CUG 
G
chains. The given U,C-fragments arise from any of 5!/2! = 60 chains. The
better estimate is 6. The abnormal fragment is UC, and this ends the chain. 
CAAG
The interior extended bases are U, G. The unsplittable fragments are G, C,
C, U. The chain starts and ends with C. The only answer is CAAGCUGGUC.
GGU
AAG 
U
(e) Since the chain ends CC, the G-fragments arise from any of 4! = 24 chains. 
GU 
GAU
The UC-fragments arise from any of 6!/2! = 360 chains. The better estimate 
U 
GAU
is 24. The only interior extended base is C. The unsplittable fragments are G, 
UG 
AUG AU
C, C. This chain starts with G and ends with C. There are two answers: 
GAG 
CC*G
GUGAUGACCAGCC and GAUGUGACCAGCC.
AG
AC 
C
ACCAG 
AGC
2. (a) The last letter in the chain is U, C, G, or A. If it is U or C, the last G-fragment will be abnormal. If it is G, the last
U,C-fragment will be abnormal. If it is A, the last G and the last U,C-fragments will each be abnormal.
(b) There are two abnormal fragments if and only if the chain ends with A.
3. 
The chains GGUGU and GUGGU have the same G- and U,C-fragments. We leave it to you to check that no shorter
chains exist.
4. (a) Let B be an interior extended base. Then B came from some fragment, say a U,C-fragment. (The argument which
follows easily adapts to the case of a G-fragment.) Thus our fragment has the form XBY, and the only U or C here
is possibly at the end of Y. Since the G-enzyme splits off B, both X and B end with a G and B contains no other G.
Thus B is itself a G-fragment. Since B contains no U, C or G, it's unsplittable.
(b) The first extended base is certainly an unsplittable fragment: It ends at the first U, C or G. Clearly, it isn't interior.
(It's first!) The last extended base contains at most one U, C or G (and this at its end) so it is also unsplittable. Again,
it is clearly not interior. (It is last!)
Exercises 11.4
1. (a) See Exercise 15(a) of Section 11.2. The score sequences (left to right) are 1, 1, I and 2, 1, 0. The tournament on the
left is not transitive; the one on the right is.
2. 
Since for each pair of (distinct) vertices vi, vj precisely one of vivj, vjvi is an arc, in the adjacency matrix A, for
each i 0 j, precisely one of aij, aji is 1. Thus, A+AT has O's on the diagonal and l's in every off-diagonal position.
5. (a) The sum of the scores is the number of arcs, by Proposition 11.2.2; thus, yn 
si = (2) = in(n -
1). Since
7i=i(n 
1 si) = Z 
(n 
1)- 
si = n(n - 1) -n(n1) 
= 
I 
n(n -1), 
we have the desired result. In a
tournament with n players, each player plays n - 1 games, so if a player wins se games, he loses n - 1 - si games.
The result says that the sum of the numbers of wins equals the sum of the numbers of losses.
6. 
Let w be any other vertex. If v beats w, there is a path of length 1 from v to w and we're fine. Hence, assume that w
beats v, that is, w -
v. Among those vertices that v beats there must be one, say x, which beats w, since otherwise
s(w) > s(v) + 1 (recall that w beats v), contradicting the maximum score of v. Hence, for some x, we have
v
0 
, but then there is a path of length 2 from v to w.
7. (a) No. The sum of the scores, E s(v), is the number of arcs. Here, I + 1 + 2 + 3 = 7, but the number of arcs is (4) = 6.

S-52 
Solutions to Selected Exercises
11. 
Suppose T is a transitive tournament that contains the cycle VI v2 ... vnVI. Since T contains no 3-cycle, upon
considering the vertices v , v2 and V3, we see that V IV3 must be an arc. Then, considering v , V3, V4, we see that V IV4
is an arc. Continuing, we eventually have an arc vlv,, contradicting the fact that vnVI is an arc. (In a tournament,
for any pair u, v of vertices, precisely one of uv, vu is an arc.)
Exercises 11.5
1. 
With reference to Fig 11.18, the arc BD now has weight 4. This does not change any of the labels shown, but it does
eliminate the possibility of a second shortest path. Now the only shortest path is SADFT, requiring 11 units of time
as before.
5. 
The new digraph is shown. The project now requires 18 units of time. The critical path is SFEWPaDVCT. The
slack in PI is now 1; the slack in the installation of kitchen cabinets is 3. All other tasks have slack 0 since they lie
on the critical path.
K(Pa, 15)
(S. 4) 
(F. 8) (E, 12) 
(W 1) 
< 
+ 
,
4 F 
4  PI 3  W 
2 
Pa 
DPIOT(,)
S -0 
F 
s 
, 
9 
T(C, 18)
E(F,9) 
I 
V(D, 16) 
2 
C(V, 18)
6. 
Since the time required for a task does not depend on which other tasks have been completed and since some tasks
can occur simultaneously, this a Type II scheduling problem.
(a) 
Po(G,12) 
4 
A(Sh, 20) 
4 
R(A, 24)
S(- 
0) 
7
T(Pa, 27)
(b) The only critical path is SGShHPaT, taking a total of 27 months.
(c) The slack of Po is 4. This job could take as much as 9 units of time without affecting the time (21) by which the task
H, subsequent to Po and on the critical path, would be accomplished. There is no slack in Sh. It's on the critical
path. The slack in A is 3. If this task took 7 units of time, its label would be (Sh, 23) and the label on R would
become (A, 27). There would be another critical path, SGShART, but the time for the job would be unaffected. The
slack in Tw is 4. Twisting could take as long as 6 units of time and the project would still be completed in 27 units.
The slack in R is 3.
(d) No, the project will not be delayed. Delaying Po by three months changes Po's label to (G, 15), but this does not
affect any other labels on the digraph. Delaying A by three months changes A's label to (Sh, 23), but does not affect
the critical path, or its length.
10. (a) This type I scheduling problem is described by the following digraph.

Section 12.1 
S-53
T(M, 12)
E(S, 2)
(b) The shortest time is 12 units.
(c) One of several ways in which this time can be achieved is to first conduct the library search, then do the field work,
then the laboratory analysis, then create the database and finally do the write-up.
Exercises 12.1
Rnd I 
Rnd 2 
Rnd 3
Series A 8
3
Series C 6
Series B 27
4
Series D 5
Champion
5.
Friday
Saturday
7.
There are (') = 10 committees.
I T DT D D 
T D D D
12. 
We think of a path as a sequence of vertices. There are at least two vertices of P2 which are also in Pi (v and w,
for example). Let u :A w be the first vertex of Pi which is encountered on the reversed path P2 from w back to v.
1.
5(-,(I

S-54 
Solutions to Selected Exercises
(It is possible that u might equal v.) It follows that the path from u to w along Pi followed by the path back to u
along P2 in reverse from w is a cycle.
Exercises 12.2
1. (a) 
e
(b) Since each tree with five vertices has all vertices of degree at most four, there is one isomer for each such tree, the
C atoms corresponding to the vertices. There are three isomers of C5 Hi2.
3. 
A beta index less than 1 says that there are fewer edges than vertices. One possibility is that the graph is not
connected; in other words, there exist two cities such that it is impossible to fly from one city to the other. If the
graph is connected, then it must be a tree by Theorem 12.2.3. This means there is a unique way of flying from any
city to any other city.
5. 
() 
A tree with n vertices has n - 1 edges by Theorem 12.2.3 and no cycles by Proposition 12.1.2.
() 
Suppose 5 is an acyclic graph with n vertices and n -I 
edges. Since g has no cycles, Proposition 12.1.2 shows
that we have only to prove that g is connected. Let then C1, C2 , . . ., Ck be the connected components of 5 and
suppose that Ci has ni vertices. (Thus, E ni = n.) Since g has no cycles, there are no cycles within each Ci. It follows
that each Ci is a tree with ni - I edges. The number of edges in g is, therefore, rk (ni - 1) = (Ek ni) -k = n -k.
So n -k 
= n -1, k = 1, g has only one component; that is, g is connected.
10. 
There are no circuits in the subgraph since there are no circuits in CkH2k+2. Also, given any two C vertices, there is a
path between them in CkH2k+2 (because CkH2k+2 is connected). Any H vertex on this path would have degree two.
Thus, there is none; the path consists entirely of C vertices and hence lies within the subgraph. Thus, the subgraph
is connected, hence a tree.
11. (a) Let x be the number of H vertices adjoined. Since T had k -I 
edges, and one new edge is added for each H, 5
has (k- 
1) + x edges. Therefore, E deg vi = 2(k -I + x). But E deg vi = 4k + x since each C has degree 4 and
each H has degree l. Therefore, 4k + x = 2k - 2 + 2x and x = 2k + 2.
14. 
A tree is a complete bipartite graph if and only if it is Ci,,n for some n.
Proof. Certainly Cin is a tree. Conversely, if a tree is complete bipartite, then it is Kmn for some m and n. But such
a graph has no vertices of degree one unless m or n is 1. The result follows.
15. (a) By Corollary 12.2.4, each of the c components has at least two vertices of degree 1. So there are at least 2c vertices
of degree 1 altogether.
16. (a) Using Corollary 12.2.4, we have E deg(vi) > 8, so the tree has at least four edges and hence at least five vertices. If
the result is not true, then there are at most three vertices of degree one while the rest have degree at least two. Then
Z degvi >2(3)+3(l)+(n -5)2=2n -1,
contradicting the fact that E deg vi = 2(n -1).
Exercises 12.3
1. 
We show T and two other spanning trees found by
adding a and then successively deleting f and g. 
d 
b 
d 
b 
d 
b
a 
a

Section 12.4 
S-55
4. 
By Theorem 12.3.3, the numbers are I-' = 1, 20 = 1, 3' = 3, 42 = 16, 53 = 125, and 64 = 1296.
A 
BA 
BA 
BA 
BA 
BA 
BA 
BA 
B
C 
DC 
DC 
DC DC DC DC DC 
D
A 
BA 
BA 
BA 
BA 
BA 
BA 
BA 
B
C 
DC DC DC DC DC DC DC 
1)
7. (a) /C2,2 has four spanning trees (obtained by deleting each edge in succession). They are all isomorphic to G-e--e-.
9. 
The edge in question is a bridge (see Definition 13.2.2); that is, its removal disconnects the graph. To see why, call
the edge e. If 5 \ {e) were connected, it would have a spanning tree. However, since g \ {e) contains all the vertices
of g, any spanning tree for it is also a spanning tree for g. We have a contradiction.
12. (a) Say the edge is e and T is any spanning tree. If e is not in T, then TU {e) must contain a circuit. Deleting any edge
of this circuit other than e gives another spanning tree which includes e.
(c) No. If the three edges form a circuit, no spanning tree can contain them.
14. (a) The subgraph To U {e) is connected because To is. Since it has the same number of vertices and edges it cannot be a
tree; therefore, it contains a circuit. Let f be an edge on this circuit such that fI T. (Since T does not contain a
circuit, this is possible.) Then (( U {e)) \ ff) is still connected (you can go either way around a circuit), and it has
n vertices and n- I edges, so it's a spanning tree.
16. 
There are (') possible edges from which we choose n -. The number of graphs is, therefore, ((2) ). The number
of trees on n labeled vertices is 0n 
2 The number of trees on n labeled vertices is n" -2 For n < 6, the table shows
the numbers of trees vs. graphs.
n No. of trees 
No. of graphs
2 
1
3 
3 
3
4 
16 
20
5 
125 
210
6 
1296 
3003
Exercises 12.4
A
1. (a) We want five edges (since there are six vertices). Choose BC, then AD, FE, and 
B 
5 
F
DE. We would like next to choose AE, but this would complete a circuit with AD 
1 
2 
2
and DE, so we choose AC and obtain the spanning tree shown, of weight 13. 
C 
E
D
A
2. a) 'I he edge ot least weight incident with L is t r. I he least weight ot those eoges
adjacent to EF is 3; we choose one of them, say AE (in an effort to obtain a 
B
different tree from before). There is just one edge of least weight among whose
which, together with EF and AE, form a tree; namely, AD. Now those edges
which together with EF, AE, and AD form a tree have weights 5 and 6. We 
C
.^oc 
-
rf mot -- 1 ikht 
- v 
fF 
noi 
M-n1x 
-
we 
C' 
R 
ht nnrin 
tre 
f
F
F
weight 13 shown to the right.

S-56 
Solutions to Selected Exercises
3. 
We need five edges because there are six vertices in the graph. We use Kruskal's
algorithm. First select BC of weight 5, then DF of weight 6. Next we select BF and
AB, both of weight 7. We would like to select AF next, but cannot since it completes
the circuit ABFA, so we select EF of weight 9 next. The five edges we have selected
comprise a minimum spanning tree. The smallest length of pavement required is
5 + 6 + 7 + 7 + 9 = 34.
E
4. (b) i. Choose BD, BE, and CE each of weight 6. The remaining edge, CD, of maximum 
B
weight (6) cannot be chosen because it would complete the circuit BDCEB with the
previously chosen edges. So we choose DF and then AB obtaining the spanning tree
shown at the right of maximum weight 28. 
C
D
6. 
Assign all edges of the graph a weight of 1. Then carry out the algorithm.
8. (a) If the graph is unweighted, put a weight of I on edge e and 2 on every other edge. If the graph is weighted, ensure
(by temporarily changing weights if necessary) that the weights of the edges different from e are all larger than the
weight of e. In either case, Kruskal's algorithm will select e first.
10. 
Let d be the lowest weight among the edges incident with vertex v. The first time that an edge incident with v is
considered for selection (because it has least weight among remaining edges), no edge incident with v will complete
a circuit with edges previously selected. Always seeking edges of lowest weight, the algorithm must select an edge
of weight d.
11. (b) If the weights of a graph with n vertices are distinct, then Kruskal's algorithm selects at each stage a unique edge
of lowest weight. Since Kruskal's algorithm yields only one tree, the graph has only one minimum spanning tree,
by (a).
12. (b) Each time a vertex is relabeled, the component to which it belongs contains at least twice as many vertices as before.
Thus, if the label on a vertex changes t times, 2' < n; so t < log2 n as required.
(c) Since the initial sorting of edges requires C(N log N) comparisons, we have only to show that the relabeling process
described in (a) and (b) can also be accomplished within this bound. By (b), the total number of vertex relabelings
is O(n log n). If n < N, we are done. If n = N + I, then n log n < (2N) log N2 = 4N log N and again we are done,
except when n = I or 2 when no steps are needed. Finally, if N < n - 2, no spanning tree is possible and a check
for this could be included at the beginning of the algorithm.
15. (a) The graph is complete, so an obvious approach is to try to choose the lowest weight available edge at each vertex.
Such a cycle is ADEFBCA, which has weight 2 + 3 + 2 + 5 + I + 5 = 18.
(b) As shown on the left, the minimum weight of a spanning tree after A is removed is 11. The two edges of least weight
at A have weights 2 and 3 so we obtain an estimate of II + 2 + 3 = 16 as a lower bound for the weight of any
Hamiltonian cycle.
,Ac 
eA
B
C
D 
D
(c) As shown on the right, the minimum weight of a spanning tree after B is removed is 12. The two least edges at B
have weights I and 5, so we obtain 12 + 1 + 5 = 18 as a lower bound.
A)

Section 12.5 S-57
Exercises 12.5
1. (a) This is acyclic: F. B, D, H, A, E, C, G is a canonical labeling.
3. 
Let 5 be a digraph with n vertices and let A be the adjacency matrix of g. The indegree of vertex i is the sum of the
entries in column i. This requires n - 1 two-number additions. Repeating for n vertices involves n(n -
1) = 0(n 2)
additions.
5. (a) We use the notation and ideas of the proof of Theorem 12.5.3. If g has a cycle, then we can construct a (possibly
empty) set of vertices {vo, VI, . . ., Vk} such that some S = V \ {Vo, VI, V2, . .. , Vk} is nonempty and has the property
that Sv # 0 for all v E S; that is, for every v E S, there exists an arc of the form xv with x E S. Let uo E S
be arbitrary and choose ul c S such that uluo is an arc. Choose u2 E S such that u2u1 is an arc. If U2 = Uo,
then u2u uo is a cycle. Otherwise, choose U3 e S so that u3u2 is an arc. In general, having chosen distinct vertices
u0,o1, ... , Uk e S such that u,+lui is an arc for i = 0, 1, ... k -1 
choose Uk+l E S such that Uk+I uk is an arc.
Since S is finite, there exists k such that Uk+i = ue with l < k. Then Uk+lUkUk-i ... 
Ue is a cycle.
7. 
Since the undirected graph is a tree with n vertices, T has n -I 
arcs, by Theorem 12.2.3.
9. (a) Here are the distances d, and the corresponding values of pt. 
t 
0 
1 
2 
3 
4 
5 
6 
7
dt 
0 
5 
7 
4 
5 
7 
6 
6
Pt 
-I 
0 
0 
0 
0 
4 
4 
3
11. 
The arc vpt vt is the last on a shortest path which the algorithm has found from vo to v,. Let 5 be the digraph which
consists of precisely those arcs (and their end vertices). Vertex vo has indegree 0 since there is no arc vivo with
i > 0. Every other vertex in g has indegree I since it is the last on a shortest directed path. Suppose 5 has r vertices.
Then it has r -I 
edges, one for each of its vertices other than vo. By Theorem 12.2.3, it suffices to show that 5
is connected. This will certainly be the case if we show that every vertex of 5 is connected to vo by some path in
5. Suppose this is not the case and let t be minimal with the property that there is no directed path from vo to vt.
Clearly t > 0. Then g contains an arc vp, v,, the last on a directed path to v,. Since pt < t, there is a directed path
from vo to vp,, and the arc vp, vt is directed vp
1 
-+ 
vt. Thus there is a path from vo to v,.
13. 
It is sufficient simply to modify Step I by setting dk = 0 and di = oc for i < k. (We could also modify Step 2 by
starting the for loop at t = k + 1, but there is little change in efficiency unless k is roughly the size of n.)
14. (a) 
i. Here are the distances d, from vl and the corresponding
values of pt.
ii. Here are the distances d, from v2 and the corresponding
values of pt.
Exercises 13.1
1. (a) The final backtracking is 7, 2, 1.
t 
0 
1 
2 
3 
4 
5 
6 
7
dt 
o 
0 Â°Â° 
Â°Â° 
Â°Â° 
6 
4 2
Pt 
-
I 1 
-I 
-I 
1 
1 1
t I 0 
1 
2 
3 
4 
5 
6 
7
dt 
c
Pt 
-
00 
0 
Â¢x 
0o 
3 
2 7
-1 
-1 
-1 
1- 2 
2 
5
6
5 
4 
17

S-58 
Solutions to Selected Exercises
I 
2 
58
2. (a) 
16 
3 
10 
7 
The final backtracking 16, 15, 14, 13, 12, 11, 6, 5, 4, 3, 2, 1.
lo 
6
> 
'3 
2 
IIl
4. (a) Consider the status of the algorithm at the time that v is labeled. If there are no unlabeled vertices adjacent to v at
this stage, we have nothing to prove. So we assume that there are some. Let 5' denote the subgraph of 5 consisting
of those vertices as yet unlabeled which are connected to v via a path of unlabeled vertices, and all the edges among
these vertices. After v is labeled, the algorithm moves to an unlabeled vertex adjacent to v and hence into the subgraph
g'. It then either returns to v or moves to another vertex in g' and gives it a label.
Now the depth-first search algorithm covers any edge at most twice, once when it labels a vertex and once when
it backtracks. Since there are only finitely many edges in 5', the algorithm must eventually backtrack to v. If there
remain any adjacent unlabeled vertices, the algorithm chooses one to label and moves again into g'. As before, it
must eventually backtrack to v. The process continues until all vertices adjacent to v are labeled.
6. 
If g is E 
, one spanning tree, namely F , is not obtainable by depth-first search.
7. (a) Each time the procedure terminates, start it again with an unlabeled vertex. The number of connected components is
equal to the number of times the procedure terminates.
9. 
No. For instance, you can get from (7, 1, 0) to (3, 5, 0) in one step, but not back.
10. 
Breadth-first search is another way of systematically moving through all the vertices of a graph. Suppose a graph has
n vertices. The procedure assigns to these vertices labels from the set {l, 2, . . ., n }. Assign label I to any vertex. Then
label all vertices adjacent to vertex I with consecutive labels starting at 2. Then pass to vertex 2 and label all vertices
adjacent to 2 which have not yet been labeled with consecutive labels from the unused members of (I, 2, . . ., n},
always using the smallest available integer first. Then pass to vertex 3 and so on, at each stage moving to the next
highest labeled vertex and labeling all adjacent vertices not yet labeled with the unused members of {1, 2, . . ., n},
smallest unused integer first. Continue until some vertex acquires label n or all vertices adjacent to the vertex with
the highest label are already labeled.
11. 
(a)
53 
I 
2
Exercises 13.2
6
1. (a) Not strongly connected; edge 36 is a bridge.
5 
4 
1 
7

Section 14.1 
S-59
2.
3. (a) A strongly connected orientation tor the Petersen graph is shown to the right.
5. 
No, it cannot. Every edge of an Eulerian graph is part of a circuit; the removal of an edge of a circuit certainly does
not disconnect a graph.
6. 
If e is a bridge, we can let u and v be its ends. If there were a path from u to v which did not require e, together with
e, we would have a circuit containing e. Since the deletion of an edge which is part of a circuit cannot disconnect a
graph, we have a contradiction.
7. (a) Choose a vertex v. For each vertex u adjacent to v, orient the edge uv in the direction u -Ã· v.
8. 
Yes. To get from a to b in the new orientation, just find the path from b to a in the old orientation and follow it in
reverse.
9. (a) False. The graph shown at the right cannot be given a strongly connected orientation, yet
every edge is part of a circuit. 
\ 
/
10. (a) If there were a path P between u and v in 5 \ (e}, then P U {e) would be a circuit, contradicting the fact that e is a
bridge.
11. 
Yes it can. Cutting all the bridges divides the city into connected components without bridges. Each component,
therefore, has a strongly connected orientation (by Theorem 13.2.3), so it is possible to assign directions to the streets
of each component which allows the possibility of (legal) travel between any two points. Now note that making each
bridge a two-way street allows arbitrary travel between components.
Exercises 14.1
1. (a) We draw the graph quickly as a planar and then, after some thinking, as a plane graph with straight edges.
j
7 
a 
b
I 
3 
5
jg 
hi 
C
2 
4
6
e 
d
k
(b) There are seven regions, numbered 1, 2,... , 7, with boundaries afg, ghe, hbi, icd, bjc, f edk, and ajk, respectively.
(c) E = I 1, V = 6, R = 7, N = 22; so V-E + R = 6 -11 
+ 7 = 2; N = 22 < 22 = 2E and E = I I < 12 = 3V -6.

S-60 
Solutions to Selected Exercises
3.
Solid 
V 
E 
F V-E+F
tetrahedron 
4 
6 
4 
2
cube 
8 
12 
6 
2
octahedron 
6 
12 
8 
2
dodecahedron 
20 
30 
12 
2
icosahedron 
12 
30 
20 
2
5. (a) This is planar. Here it is drawn as a plane graph (with straight edges).
(e) This is not planar. There is a subgraph homeomorphic to K3,3 as shown.
7. 
We know from Theorem 14.1.4 that E < 3V -6. Substituting in E 
V + R -2, we obtain V + R -2 < 3V -6,
or R < 2V -4, 
as required.
8. (a) e 
E= 3=3(3) -6= 3V -6.
10. (a) IC,, is planar if and only if n < 4.
11. 
Introduce B
A 
B 
A 
here
1 
2 
1 
2
14. (a) Assume the result is not true. Then there is some counterexample 5 and subgraph X; that is, for these graphs,
E,- V < E2 -
V2. (In particular, VI 0 V2.) Choose 1- such that VI -V
2 is as small as possible. Since g is
connected, we can find a vertex v which is in X, but not XH, which is joined to some vertex in H. Let IC be that
subgraph of 5 consisting of A, v and all edges joining v to vertices in 'H. Letting V3 and E3 denote the numbers of
vertices and edges, respectively, in IC, we have V3 = V2 + 1, while E3 > E2 + 1. Hence, E2 -V
2 < E3- V3 and so
E,- V < E3 -V
3. Thus, g and its subgraph IC provide another counterexample, but this contradicts the minimality
of VI -
V2 since VI -
V3 < VI -
V2.
15. 
Yes. An example is shown to the right. The graphs are homeomorphic since the one 
e-) 
e ---
on the right is obtainable from the other by adding a vertex of degree 2. 
A 
B 
A 
B
17. (b) False, as shown by the homeomorphic graphs at the right. The graph on the left is
Hamiltonian, but the one on the right is not. 
E 
N
19. (a) Let 1, 92, ... 
5,, be the connected components of g. Since gi has at least three vertices, we have Egj < 3Vg -6.
Hence, 
Egj < 3 13 Vg- 
6n, so E < 3V -6n 
as required.
20. (a) We may assume that g is connected. Say there is only one vertex of degree at most 5. Then 
deg vi > 6(V -
=)
6V -6, contradicting Ydeg vi = 2E < 6V -
12.
21. (a) By Theorem 14.1.4, E < 3V -6, 
so E < 3(20) -6 = 54.

Section 14.2 
S-61
22. (a) Say at most one region has at most five edges on its boundary. Then, with N as in the proof of Corollary 14.1.3,
N > 6(R-1). But N < 2E, so 2E > 6R-6,3R < E+3. Since V -E+R = 2,6 = 3V -3E+3R < 3V -2E+3;
that is, 2E < 3V -3. But 2E = rdegvi > 3V by assumption, and this is a contradiction.
24. 
Letting x denote the number of connected components of 5, we have V - E + R = 1 + x.
Proof. For each component C, Vc -
EC + Rc
E Vc = V and E Ec = E, but E Rc = R + (x
V -E+R+x -I =2x, V-E+R= 
x+l.
= 2. Adding, we get E Vc-E Ec + A Rc = 2x. We have
1) since the exterior region is common to all components. Thus,
Exercises 14.2
2. (a) We show the graph superimposed over the given map. Since this graph contains triangles,
at least three colors are necessary. A 3-coloring is shown, so the chromatic number is 3.
(b) False! The Four-Color Theorem says that the chromatic number of a planar graph is at most 4. The planar graph in
(a) has chromatic number 3.
3. 
In neither case, will four colors necessarily suffice as the pictures to the
right demonstrate.
ZI1 
2
4. (b) A S-coloring is shown; hence, X(5) < 5. Since K5 is a subgraph, X(5) = 5.
5
(e) A 4-coloring is shown; hence, X(5) < 4. Since g contains )C4 as a subgraph, X(5) = 4.
6. (a) The graph g1 on the left has a 3-coloring, as shown. Since it contains a
triangle, X(51) = 3. The graph 52 on the right has a 3-coloring, as
shown. By trying to label alternately the vertices of the outer pentagon,
we see that two colors will not suffice, so X(52) = 3 too. 
I
3
2
13
3 
4
2 
1 
2
2 
2
1 
3
(b) The converse of the Four-Color Theorem states that if the chromatic number of a graph is at most four, then the
graph is planar. This result is false. The Petersen graph is not planar (Exercise 4 of Section 14.1), but, as we saw in
part (a), X = 3.

S-62 
Solutions to Selected Exercises
7. (a) Yes, a tree is planar and we can prove this by induction on n, the number of vertices. Certainly a tree with one vertex
is planar. Then, given a tree with n vertices, removing a vertex of degree I (and the edge with which it is incident)
leaves a tree with n -I vertices which is planar by the induction hypothesis. The deleted vertex and edge can now
be reinserted without destroying planarity.
9. (a) 
(b)
(c) The graph isn't planar, by Kuratowski's Theorem, as the results of (a) and (b) each illustrate.
(d) A 3-coloring is shown. Since the graph contains triangles, fewer than three colors will 
3 
3
not suffice. The chromatic number is three.
2
(e) The converse of the Four-Color Theorem says that a graph with X < 4 is planar. This is not true, as this graph
illustrates: The chromatic number is 3, but the graph is not planar.
10. (a) By Pause 7 of this section, for any n, X(Kn) = n and for any m, n, X(I,n,n) = 2. Thus, X('IC4) = 14 and
XK,14) = 2.
11. (a) False. If 5 is a 5-cycle, then X(5) = 3 since 5 is odd but g contains no triangle.
14. (a) False. C3,3 is Hamiltonian and has chromatic number two (by Pause 7) but is not planar.
(d) False. C7 is Eulerian (since the degree of every vertex is six) and Hamiltonian (since every complete graph is
Hamiltonian), yet X(AC7) = 7.
15. 
Three exam periods are required since this is the chromatic number of the graph.
18. 
We draw a graph 5. The vertices are courses, and two vertices are joined if somebody is taking both courses. Since
X(5) = 4, four time periods are required.
19. 
This means we can delete the edge joining "Econ" to "Stat," so "Stat" can be colored 3, X(5) = 3 and three time
periods now suffice.
24. (a) We assume g has more than three vertices for otherwise there is nothing to prove. Let T be a spanning tree for 5.
By Exercise 7(c) we know that x(f) = 2. Since g has n vertices, g = T U {e) for some edge e. If the ends of e
have different colors in T, then X(5) = 2; otherwise, one of these ends must be given a third color and X(5) = 3.
In either case, X(5) < 3 as required.
25. (a) The dual of the cube is the octahedron whose graph appears in Fig 14.5.
26. 
Yes, it is. Both the tetrahedron and its dual are K4.
Exercises 14.3
1. (a) 36 nodes, 14 grid segments, 6 nets. 
(c) v
V3
(b) 
VI and V'3, for example. 
V5  
V4
(d) We know X(5) > 4 since 5 contains K34 (vertices H, V2, 1/3, V4). On the other hand, a 4-coloring is given by
WI/, 
V3N, {V 2, Vj5, 
{V41, {H). Hence, x(5) = 4. The above 4-coloring is also a partition of the nets.

Section 14.3 
S-63
3. 
False. An example is the net pattern .
. I for which the line-of-sight graph is o 
o.
4. (a) 
- need not be reflexive. Consider
5. (a)
Nc
N:
N7
7. 
False. The graph in Exercise 5 isn't planar. The subgraph with vertices N1, N3, N4 , N5, N6, N7 and with edge N3 N4
removed is isomorphic to JC3,3.
8. (a) Imagine the possible shorts between nets as the edges in a graph: They won't cross since they're all parallel. Now
compress each net to a point, and we have a plane graph. By the Four Color Theorem, X(5) < 4.
(b) Draw separate graphs 9(V, E1 ), 9(V, S2) for horizontal lines of sight [as in (a)] and vertical lines of sight. These
graphs have the same vertex set, so combine them. If an edge is repeated (that is, both horizontal and vertical lines
exist between nets), then omit one of the original occurrences of it.
9. 
It is possible for a short to exist between any pair of nets here. Hence, 5 -
Kgs, and X(g) = 8, as required.
10. 
105: 
g1
d
X cannot be 2-colored since it is a cycle of odd length. If we delete any vertex, however,
the resulting graph can be 2-colored. If we delete e, for example, we obtain the graph at
the right. Shown are 5' and a corresponding floor plan.
5
R a 
bhR
W d
il
Lii
141
13. (a) We can immediately draw g1 for this problem (using the obvious Hamiltonian cycle that a golfer must follow). Both
g1 and X are shown.
a 
D
3
4
g o 
/ 
C 
.
f
0 d
t)
Since X contains a triangle, x(X) = 3, so such a course is impossible.
Deleting vertex 2 (and the three edges incident with 2) leaves AZ
5.
Since the graph is not IC, for any n, nor an odd cycle, Brooks's Theorem says X(5) < A(5). Here A(5) = 3, so we
have X(5) < 3. But this graph contains cycles of odd length, so X(5) > 3. We conclude that X(5) = 3.
8
7
14.
15.
-0
3
51

S-64 
Solutions to Selected Exercises
Exercises 15.1
1. (a) At a, Y, fwa = f, 
= 2 and Y, fa, = fief + fae 
2 + 0 = 2. At e, At fte = fae + Tie = 0 + I = I and
Zv fe, = fee + fed = 0 + I = 1. At d, Zv fvd = fbd + fed = 3 + I = 4 and >V fdV = fft = 4.
(b) The value of the flow is 6.
(c) The capacity of the cut is Cac + Cae + cbe + Cbd = 3 + I + 4 + 3 = I 1.
(d) No. Arc dt is saturated.
(e) The flow is not maximum. For instance, it can be increased by adding I to the flow in the arcs along sact.
(f) (fac -fca) 
+ (fae -fea) 
+ (fbe -feb) 
+ (fbd -fdb) 
= (2 -0) 
+ (0 -0) 
+ (I -0) 
+ (3 -0) 
= 6.
2. (b) The value of the flow is 14.
3. (c) cac+cbe+cdr =3+9+9= 21.
5. (a) 
i. Send one unit through the path sbet.
ii. The flow in (a) has a saturated arc, be.
iii. Here is a maximum flow, of value 6. (Did you get it?) To see that the
flow is maximum, consider the cut S = {s, a, b), 7 = {c, d, e, f, t}.
b
1, 1
6. 
s10 
a 
II
C
a 
3,3 
d
3,3 
1,0 
1,) 0 
3,3
s 
I b 
1,1 
eI .
2.2 
2.0 
1 
11
c 
2.2 
f
7. 
Let {Sj, Tfi 
be any cut. By Theorem 15.1.4, val(F) < cap(Si,Ti). But val(1) = cap(S, T). So cap(S, 7) 
<
cap(SI, 'T). Since {S,, Tj I was an arbitrary cut, the result is proven.
Exercises 15.2
1. (a) 
i. One flow-augmenting chain is sbadt in which the slack is 1.
ii. Here is a maximum flow, of value 7. We can see this is maximum by
examining the cut S = {s, a, b}, T = {c, d, e, f t}, of capacity
C5C + cad + cbe = 3 + 3 + I = 7, the value of the flow.
(d) 
i. One flow-augmenting chain is sacdfgt, which has slack 1.
ii. Here is a maximum flow, of value 20. We can see this is maximum
by examining the cut S = {s, a, b, c}, 7 = {d, e. If g, h, t). This has
capacity cse + c,/, + cad = 7 + 4 + 9 = 20, the value of the flow.
a 
3.3 
d
2 2s
x 
3,2
3, 3X
2,1 
1.t)
b 
1, 1 
e
1, I
2, 0
C 
3.3
a
6.
7,
e 
6,6 
t 7.7 
X
4. 3
f
t
\
0

Section 15.3 
S-65
2. (a) A flow of value 6 is given in Exercise 5(a) of Section 15.1. To see this is maximum, consider the cut S = {s, a, bl,
T = [c, d, e, f, t}.
3. (a) To see that the pictured flow is maximum, consider the cut S = {s, bI,
= {a,c,d,e,f,t).
4. (a) We multiply the capacities by 10, the greatest common divisor of the denominators, and find a maximum flow in the
new network, as shown on the left. Then, dividing by 10, we find a maximum flow in the given network, of value
67/10, as shown on the right. (Only the flow in each arc is shown.)
s
Exercises 15.3
1.
s
The demand cannot be met; the best that can be done is as shown. Warehouse b sends out 20 Klein bottles and the
others send out none. Five go to retail outlet d and 15 go to e.
3. 
The needs of the retail outlets cannot be met. They can receive at most 14 units a month, as shown. To see that the
flow there is a maximum, consider the cut in which 
= {a. F, G. t} and S is the set of all other vertices.
t
s
t
t
A

S-66 
Solutions to Selected Exercises
5. (a) A maximum flow is shown, with direction added to the undirected edges. 
' 3 
4
S 
`2, 22'2
7. 
Four messengers can be sent.
9. 
Let u and v be two vertices of KC,. If x is any other vertex, u, x, v is a path from u to v, while u, v is also a path.
These n -I 
paths are edge disjoint. Also, there cannot be more than n -I paths from u to v since deg u = n -I 
and
edge disjoint paths must start with different edges. Thus, the maximum number of edge disjoint paths between u and
v is n -1. But this is also the minimum number of edges which must be removed in order to sever all paths from u
to v (in accordance with Menger's Theorem). To see this, note that deleting all edges incident with u certainly severs
all paths, so at most n -I 
edges need be deleted. On the other hand, if we remove fewer than n- 
I edges, then
some path from u to v remains because we have already exhibited n -I 
edge disjoint paths.
Exercises 15.4
Karen Mary Aurie Pamela Lynne
1. 
One possible matching is shown.
3. 
{12, 34, 56, 78} is a perfect matching.
4. (a) Let X = (Angela, Brenda, Christine, Margaret, Phyllis, Renee). Then A(X) = {A, B, C, E, F), so XJ > A(X)l and
the condition fails.
6. (a) Bruce Ã·* Maurice, Edgar ~- Michael, Eric 4* Roland, Herb *-> Richard.
7. (a) Construct a bipartite graph with vertex sets VI and V-, where VI has n vertices corresponding to Al, . . ., A,,, V2 has
one vertex for each element of S and there is an edge joining Ai to s if and only if x E Ai. Given a subset X of
VI, the set A(X) (notation as in the text) is precisely the set of elements in J1Ex 
A,. Thus this question is just a
restatement of Hall's Marriage Theorem.
9. (a) Exchange the roles of VI and V2 in Theorem 15.4.2. It may be possible to find a matching which saturates V2. Here's
a necessary and sufficient condition for this to happen: If X is any subset of V) and A(X) is the set of all vertices
of VI which are adjacent to some vertex of X, then IA(X)l > X1.
10. (a) K,,,,,, has a perfect matching if and only if m = n. To see this, first assume that m = n and let the vertex sets be
VI = 
, U2, ... , u,,,) and V2 = (VI, V2, .
V m 
, vm). Then {u IV, u2v2, . .u , u,,,v,,,I is a perfect matching. Conversely,
say we have a perfect matching and m < n. Since each edge in a matching must join a vertex of VI to a vertex of
V2, there can be at most m edges. If m < n, some vertex in V2 would not be part of any edge in the matching, a
contradiction. Thus, m = n.
12. (a) By Proposition 15.4.3, if K,, has a perfect matching, then n must be even. Conversely, assume that n = 2m is even
and label the vertices u I, U2, . . ., U2,n. Since every pair of vertices is joined by an edge, {u u2, U3U4, 
2 
. ., U2in -U2m)
will give us a perfect matching.
14. 
No. The graph N has IVI even, but it has no perfect matching.
15. 
No. The graph 
has a perfect matching, but each vertex has degree 2, which is less than 2V = 3.

Glossary
Without a firm grasp of vocabulary, it is impossible to speak, let alone understand, a language. The same applies to any
science. If you aren't comfortable with its terminology, you can't expect to understand the subject.
What follows is a vocabulary list of all the technical terms discussed in this book together with the page where each was
first introduced. In most cases, each definition is followed by an example.
A
absolute value 
The absolute value of a number x, denoted
Ix, is defined to be x if x > 0 and-x if x < 0. For
example, 101 = 0, 151 = 5 and I-51 = 5. 
p. 76
acyclic 
A graph is acyclic if it contains no cycles. 
p. 369
adjacency matrix 
The adjacency matrix of a graph with n
vertices v , V2, . . ., v, is the n xn matrix A = [aij] whose
(i, j) entry aij is I if vertices vs and vj are adjacent and
otherwise, aj = 0. 
p. 318
adjacent 
Two vertices v, w of a pseudograph are adjacent
if {v, w} is an edge. 
p. 286
algorithm 
An algorithm is a procedure for carrying out
some process. Its ingredients are an input, an output,
and a sequence of precise steps for converting the input
to the output. For example, the method by which a
perpendicular to a line can be constructed at a speci-
fied point is a familiar algorithm of Euclidean geometry.
p. 240
antisymmetric 
A binary relation - on a set A is antisym-
metric if a - b and b - a imply a = b. For example, <
is antisymmetric on R but - defined by a - b if ab > 0
is not. 
p. 53
arc 
An arc is a directed edge in a digraph. 
p. 342
argument 
An argument is a finite collection of statements
AI, A2, . . . , A,, called premises or hypotheses followed
by a statement 23 called the conclusion. Such an argument
is valid if, whenever Al, A 2. 
A 
.
are all true, then 3
is also true. 
p. 28
arithmetic sequence 
The arithmetic sequence with first
term a and common difference d is the sequence a,
a+d, a+2d, .... Forexample, 11, 8, 5, 2,... is an arith-
metic sequence with first term II and common difference
-3. 
p. 166
B
base b representation 
The base b representation of a natu-
ral number N is the expression (an -a,-2 ... ao)b, where
the integers ao, al, . . ., a,-_ 
are all in the range 0 < ai <
b and N = a,,b" 
I
1 + a - 2b-2 + 
2
* 
+ alb + ao. For
example, 100 
(10201)3 because 100= 1(34)+0(33)+
2(32) + 0(31) + 1(30). 
p. 102
Big Oh 
For functions f, g: N -* R, we say that f is Big
Oh of g, written f = 0(g), if there is an integer no and
a positive real number c such that Lf(n)l < clg(n)l for
all n > no. For example, Inn = 0(n). 
p. 247
bijection 
A bijection is a one-to-one onto function. For
example, n F-+ 2n defines a bijection from Z to 2Z. 
p. 73
binary relation 
A binary relation from a set A to a set
B is any subset of A x B. A binary relation on A is a
binary relation from A to A. For example, ((I, a), (2, a))
is a binary relation from N to the letters of the English
alphabet, and {(x, y) E R2 I x2 + y2 = 1) is a binary
relation on R. 
p. 51
bipartite graph 
A bipartite graph is a graph whose vertices
can be partitioned into two disjoint sets in such a way that
every edge joins a vertex in one set to a vertex in the other.
p. 288
bipartition set 
The bipartition sets of a bipartite graph are
the two disjoint sets into which the vertices are partitioned
so that any edge joins a vertex in one set to a vertex in
the other. 
p. 288
bridge 
An edge e of a connected graph g is a bridge if and
only if the subgraph g \ {e} is not connected. 
p. 406
C
canonical labeling 
A labeling vo, vI, . . ., v,, 
of the ver-
tices of a digraph is canonical if every arc is of the form
vivj with i < j. 
p. 392
capacity 
The capacity of an (s, t)-cut {S, TI (s E S, t X
T) is the sum of the capacities of all arcs from S to T.
p. 444
cardinality 
The cardinality of a finite set is the num-
ber of elements in the set. While this book does not
define the term cardinality for infinite sets, it does dis-
cuss the concept of same cardinality (see definition).
pp. 88 and 89
Cartesian product 
The Cartesian product of sets A and
B-denoted A x B or A2 if B = A-is the set of ordered
G-1

G-2 
Glossary
pairs (a, b), where a E A and b E B. For example,
J1, 2} x {x) = {(l, x), (2, x)}. 
p. 48
ceiling 
The ceiling of a real number x, denoted rxJ, is
the least integer greater than or equal to x. For example,
[3 
-4, 
rO[ = 0 and F-341 = -3. 
p. 76
chain 
A chain is a trail in a directed network, that is, a
walk in which the arcs are distinct and can be followed
in either direction. 
p. 448
chromatic number The chromatic number of a graph is the
smallest natural number n for which an n-coloring exists.
p. 423
circuit A circuit in a pseudograph is a closed trail.
p. 303
coloring 
A coloring of a graph is an assignment of col-
ors to vertices so that adjacent vertices have different
colors. An n-coloring is a coloring which uses n colors.
p. 423
combination A combination of objects is a subset of them.
An r-combination is a subset of r objects. For example,
{Charles, Andrew) is a 2-combination of the members of
the British royal family. 
p. 218.
common difference 
See 
the 
definition 
of arithmetic
sequence.
common ratio See the definition of geometric sequence.
comparable 
Two elements a and b are comparable with
respect to a partial order -< if and only if either a -< b
or b -< a. For example, with respect to "divides" on N, 2
and 6 are comparable, but 2 and 7 are not. 
p. 64
complement 
The complement of a set A, written AC, is
the set of elements which belong to some universal set,
defined by the context, but which do not belong to A. For
example, if the universal set is R, then {x I x < I}c =
{xlx>l}. 
p.445
complete bipartite The complete bipartite graph on two
sets VI and V2 is that bipartite graph whose vertices are
the union of VI and V2 and whose edges consist of all
possible edges between these sets. 
p. 288
complete graph The complete graph on n vertices is that
graph which has n vertices, each pair of which are adja-
cent. 
p. 288
complexity 
The complexity of an algorithm is a function
which gives an upper bound for the number of operations
required to carry out the algorithm. It is usually specified
in general terms, by giving another function of which it
is Big Oh. The binary search algorithm, for example, has
complexity (9(10g2 n). 
p. 246
component A component of a graph is a connected sub-
graph which is properly contained in no connected sub-
graph with a larger vertex set or larger edge set. 
p. 310
composite 
A composite number is a natural number larger
than I which is not prime; for example, 6 and 10.
p. 114
composition 
The composition of functions f: A -- B and
g: B-* 
C is the function g o : A- 
C defined by
g o f (a) = g(f(a)) for a c A. For example, if f and g
are the functions R -
R defined by f (x) = x + 2 and
g(x) = 2x -3, then g o f (x) = 2x + l. 
p. 82
conclusion 
See argument.
congruence class 
The congruence class of an integer a
(mod n) is the set {b E Z I a 
b (mod n)] of all integers
to which a is congruent mod n; for example, the congru-
ence class of 5 (mod 7) is the set 7Z + 5 of integers of
the form 7k + 5. 
p. 126
congruence mod n Integers a and b are congruent module
n, where n > I is a natural number-and we write a - b
(mod n)-if a -b is divisible by n. For example, -2 -1 I0
(mod 4), but 7 # -19 (mod 12). 
p. 126
connected 
A pseudograph is connected if there is a walk
between any two vertices. 
p. 305
contradiction 
A contradiction is a compound statement
that is always false. For example, ((-p) A q) A (p V (-q))
is a contradiction. (Examine the truth table.) 
p. 20
contrapositive 
The contrapositive of the implication "p
q" is the implication "(-q) -* 
(-p)." For example, the
contrapositive of "If a graph is planar, then it can be col-
ored with at most four colors" is "If a graph cannot be
colored with at most four colors, then it is not planar."
p. 5
converse 
The converse of the implication p -* q is the
implication q -- p. For example, the converse of "If a
graph is planar, then it can be colored with at most four
colors" is "If a graph can be colored with at most four
colors, then it is planar." 
p. 4
countable 
A set is countable if and only if it is finite or
countably infinite. For example, the rational numbers and
the set of natural numbers not exceeding 1000 are both
countable sets. 
p. 90
countably infinite A countably infinite set is an infinite set
which has the cardinality of the natural numbers. For
example, the rational numbers form a countably infinite
set. 
p. 90
cut An (s, t)-cut in a directed network with vertex set V,
two of whose members are s and t, is a pair of dis-
joint sets S and T, s E S, t e T. whose union is V.
p. 444
cycle 
A cycle in a pseudograph is a circuit in which the
first vertex appears exactly twice (at the beginning and
the end) and in which no other vertex appears more than
once. An n-cycle is a cycle with n vertices. 
p. 303
D
degree 
The degree of a vertex in a pseudograph is the num-
ber of edges incident with that vertex. 
p. 286

Glossary 
G-3
degree sequence 
The degree sequence of a pseudograph is
a list of the degrees of the vertices in nonincreasing order.
p. 290
derangement 
A derangement of n distinct symbols which
have some natural order is a permutation of them in which
no symbol is in its correct position. For example, 312 is
a derangement of 1, 2, 3. 
p. 228
digraph 
A digraph is a pair (V, Â£) of sets, V nonempty and
each element of Â£ an ordered pair of distinct elements of
V. The elements of V are called vertices, and the elements
of Â£ are called arcs. 
p. 342
direct product This is another name for the Cartesian
product, whose definition appeared previously. 
p. 48
directed network 
A directed network is a digraph with an
integer weight assigned to each arc. 
p. 360
disjunctive normal form 
A compound statement based on
variables xi, X2, .. ., Xn, n > 1, is in disjunctive normal
form if and only if it has the form (al l AaI2 A. 
Aal,) v
(a2l A a22 A 
A a2n) V ... 
V (am A am2 A 
A amn)
where, for each i and j, I < i < m, I < i < n, either
aij = Xj or aij = -xj and all minterms ai I Aai2 A .
Aain
are distinct. For example, the statement (xI A x2 A X3) V
(Xl A (-x2) A (-X3)) is in disjunctive normal form on the
variables xl, X2, X3. 
p. 26
divides 
Given integers a and b, b # 0, we say that b divides
a-written b I a-and say that b is a factor or a divisor of
a if and only if a = qb for some integer q. For example,
3 118 but 5 ,+18. 
p. 104
divisor See the definition of divides.
domain The domain of a function f: A -* B is the set A.
p. 73
E
edge 
An edge in a graph is a set of two distinct vertices.
p. 286
equivalence class 
If - denotes an equivalence relation (see
definition) on a set A and a e A, then the equivalence
class of a is the set of all elements x E A with x - a. For
example, for the equivalence relation "congruence mod
2" on Z, the equivalence class of 17 is the set of all odd
integers. 
p. 57
equivalence relation An equivalence relation on a set is a
binary relation which is reflexive, symmetric, and transi-
tive. For example, congruence module a natural number
n > I is an equivalence relation on Z but divides is not.
p. 56
Eulerian circuit An Eulerian circuit in a pseudograph is a
circuit which contains every vertex and every edge of the
pseudograph. 
p. 304
Eulerian pseudograph 
An Eulerian pseudograph is a
pseudograph 
which 
possesses 
an 
Eulerian 
circuit.
p. 304
even cycle 
An even cycle in a pseudograph is a cycle which
contains an even number of edges. 
p. 303
even vertex An even vertex of a pseudograph is one of
even degree. 
p. 286
F
factor 
See the definition of divides.
factorial 
For a natural number n > 1, n factorial means
the product of the first n natural numbers. It's denoted
n!. For example, 3! = 6 and 5! = 120. By convention,
0!= 1. 
p. 155
Fibonacci sequence 
The 
Fibonacci sequence 
is 
the
sequence 
which 
begins 
1, 1, and each 
of whose
subsequent terms is the sum of the preceding two.
Thus, the first ten terms are 1, 1, 2, 3, 5, 8, 13, 21, 34, 55.
p. 168
floor The floor of a real number x, denoted Lxj, is the
greatest integer less than or equal to x. For example,
L3!j = 3, LOJ = 0, and L-3ij = -4. 
p. 76
flow 
Given a directed network with vertex set V, the weight
(or capacity) of arc uv denoted cu, and two distinguished
vertices s and t called the source and the sink, respec-
tively, an (s, t)-flow is a set of numbers {fi% satisfying
1. 0 < fu < cur for all u, v E V
2. ZvEV fuv = 
,v~V fvu for all u E V\ {s, t}. 
p. 442
flow-augmenting chain 
A flow-augmenting chain in a net-
work with (s, t)-flow {fur} is a chain in which fu, < cu,
for each forward arc uv of the chain and fu, > 0 for each
backward arc. 
p. 449
function 
A function from a set A to a set B is a binary
relation f from A to B with the property that for every
a E A, there is exactly one b E B such that (a, b) E f.
We write f: A --. B to indicate that f is a function from
A to B. For example, a sequence of integers is just a
function N -* Z. 
p. 71
G
generating function 
The generating function of a sequence
ao, al, a2, . .. is the expression f(x) = ao+alx+a2x2 +
* .
The generating function of the natural numbers, for
instance, is the expression I + 2x + 3x 2 + .-. .
p. 178
geometric sequence 
The geometric sequence with first
term 
a 
and 
common ratio r 
is 
the 
sequence
a, ar, ar2 , ar3 , . 
For example, 1, i, I, 1, ... 
is the
geometric sequence with first term I and common ratio 2
p. 167
graph A graph is a pair (V, Â£) of sets, V nonempty and
each element of & an unordered pair of distinct elements
of V. The elements of V are called vertices; the elements
of Â£ are called edges. 
p. 286

G-4 
Glossary
greatest common divisor 
The greatest common divisor
(abbreviated gcd) of integers a and b not both of which
are zero is the largest common divisor of a and b; that is,
a number g such that
1. g I a, g I b (it's a common divisor) and,
2. if c I a and c I b, then c < g (it's the largest common
divisor).
In general, for n > 2, the gcd of n nonzero integers
al, a2, . . ., a,, can be defined either as the largest of the
common divisors of these integers or, inductively, by
gcd(al, a 2 , . . ., a,) = gcd(al, gcd(a 2 , . . ., a,)).
For example, gcd(4, 18) = 2, gcd(18, -30) 
= 6 and
gcd(-6, 10, -15)= 1. 
p. 105
greatest lower bound 
A greatest lower bound (abbreviated
glb) for two elements a, b in a partially ordered set (A, <)
is an element g E A satisfying
1. g -< a, g -< b; and
2. if c -< a and c -< b for some c E A then c -< g.
If a and b have a glb, then this element is unique and
denoted a A b. For example, the greatest lower bound of
two natural numbers with respect to "divides" is just their
greatest common divisor. 
p. 66
H
Hamiltonian cycle 
A Hcmiltonian cycle in a graph is
a cycle in which every vertex of the graph appears.
p. 310
Hamiltonian graph 
A Hamiltonian graph is one which has
a Hamiltonian cycle. 
p. 310
homeomorphic 
Two graphs are homeomorphic if and only
if each can be obtained from the same graph by adding
vertices to edges. 
p. 417
hypothesis 
See argument.
I
ideal 
An ideal of Z is a subset A of Z with three properties:
(i) 0 e A; (ii) a e 
A implies -a e A; (iii) a,b E A
implies a + b E A. For example, the set of even integers
is an ideal of Z. 
p. 162
identityfunction 
The identity function on a set A is the
function t: A 
-* 
A defined by t(a) = a for any a E A.
Sometimes we write tA to emphasize that the domain of
this function is the set A. 
p. 77
incident 
A vertex v of a pseudograph is incident with an
edge e if and only if e = {v, w} for some vertex w.
p. 286
indegree 
The indegree of a vertex in a directed graph
is the number of arcs directed towards that vertex.
p. 343
invective 
This is another word for one-to-one (see defini-
tion). 
p. 73
intersection 
The intersection of sets-denoted A n B for
two sets, A n B n C for three, and nj' I Ai for n sets-
is the set of elements which belong to each of the sets.
For example, (0, 1, 2) n 
}0, 
l,3} = {0, I1}; (0} n N = 0.
p. 43
inverse function 
The inverse of a one-to-one onto function
f: A -
B is the function B -- A obtained by reversing
the pairs of f. (Only a one-to-one onto function has an
inverse.) For example, if f = ((1, a), (2, b)}, then f - =
{(a, 1), (b, 2)}. The inverse of the exponential function
R -* 
(0, o0) defined by f (x) = ex is the natural logarithm
(0, oo)- 
R defined by f - '(x) = lnx. 
p. 80
isolated vertex 
An isolated vertex in a pseudograph is one
of degree 0. 
p. 286
isomorphic 
Graphs are isomorphic if and only if there is
an isomorphism (see definition) from one to the other.
p. 295
isomorphic labeled trees 
Labeled trees Ti and T2 are iso-
morphic if and only if they have the same number of
vertices, they are labeled with the same set of labels, and
vertices labeled v and w in fi are adjacent if and only if
v and w are adjacent in T2.
p. 375
isomorphism 
An isomorphism from a graph g1 (VI, li) to
a graph 9 2(V2, Â£2) is a one-to-one function qo from VI
onto V2 such that if vw is an edge in El, then qo(v)4o(w)
is an edge is Â£2, and such that every edge in Â£2 has the
form qo(v)$o(w) for some edge vw E EI. 
p. 295
L
lattice 
A lattice is a partially ordered set in which every
two elements have a greatest lower bound and a least
upper bound. For example, the set of subsets of a set is a
lattice. 
p. 67
leaf 
A leaf in a graph is a vertex of degree 1. 
p.3 7 2
least common multiple 
The least common multiple (1cm)
of nonzero integers a and b is the smallest of the positive
common multiples of a and b; that is, it's an integer f > 0
such that
1. a I f, b I f (it's a common multiple) and,
2. if m > 0, a I m and b I m, then f < m (it's the smallest
positive common multiple).
For example, lcm(10, 12) = 60 and lcm(18, 30) = 90.
p. 110
least upper bound 
A least upper bound (abbreviated lub)
for two elements a, b in a partially ordered set (A, -<) is
an element f e A satisfying
1. a -< e, b -< f and,
2. if a -< c and b -< c for some c E A, then f -< c.

Glossary 
G-5
If a and b have a lub, then this element is unique and
denoted a v b. For example, the least upper bound of two
natural numbers with respect to "divides" is just their least
common multiple. 
p. 66
length 
The length of a walk in a pseudograph is the number
of edges it contains. 
p. 303
logically equivalent 
Statements A and 3 are logically
equivalent and we write "A 
-3" 
if A and 3 have
identical truth tables. For example, A: p -+ (-q) is log-
ically equivalent to 93: -(p A q). 
p. 20
loop 
A loop is an edge of a pseudograph which is incident
with only one vertex. 
p. 286
M
map 
This is another word for function, which was defined
previously. 
p. 71
matching 
A matching in a graph is a set of edges with
the property that no vertex is incident with more than one
edge in the set. 
p. 459
maximal 
A maximal element of a partially ordered set
(A, <) is an element a with the property that a -< b
implies a = b. For example, 4 is a maximal element of
1{, 2, 3, 4, 5, 6} with respect to "divides." 
p. 66
maximum 
A maximum element of a partially ordered set
(A, <) is an element a with the property that a >- b for
every b e A. For example, N is a maximum element with
respect to C on N; also, 10 is not a maximum element
with respect to "divides" on N. 
p. 65
minimal 
A minimal element of a partially ordered set
(A, -<) is an element a with the property that b -< a
implies a = b. For example, 3 is a minimal element of
{2, 3, 4, 5, 61 with respect to "divides." 
p. 66
minimum 
A minimum element of a partially ordered set
(A, -<) is an element a with the property that a -< b for
every b E A. For example, I is a minimum element with
respect to "divides" on N but 3 is not. 
p. 65
Minimum Connector Problem 
Find the spanning tree of
least weight in a weighted connected graph. 
p. 377
minimum spanning tree 
A minimum spanning tree in a
weighted graph is a spanning tree for which the sum of
the weights of the edges is least among all spanning trees.
p. 378
multiple edges 
Multiple edges are edges (by implication,
more than one) in a pseudograph which are incident with
the same two vertices. 
p. 286
multiplicity 
See the definition of prime decomposition.
N
n-coloring 
See coloring.
n-cycle 
See cycle.
negation 
The negation of the statement p is the statement
-p 
which asserts that p is not true. For example, the
negation of "x equals 4" is the statement "x does not
equal 4." 
p. 5
0
odd cycle 
An odd cycle is a cycle which contains an odd
number of edges. 
p. 303
odd vertex 
An odd vertex in a pseudograph is a vertex of
odd degree. 
p. 286
one-to-one 
A function f: A implies B is one-to-one, or
1-1, if and only if f(al) = f(a2) implies al = a2. For
example, the function f: Z implies Z defined by f (n) =
2n is one-to-one, but the floor function L j: R implies Z
is not. 
p. 73
one-to-onecorrespondence 
This is the same as bijection
and is the preferred term in the context of cardinality.
The function x F-> ex defines a one-to-one correspondence
between the reals and the positive reals showing that these
sets have the same cardinality. 
p. 89
onto 
A function f: A 
-* 
B is onto if and only if for
each b E B, there exists a E A such that b = f(a).
For example, the function f: (0, oo) 
R defined by
f(x) = Inx is onto. 
p. 73
order See same order or smaller order or total order.
orient 
To orient an edge in a pseudograph is to assign a
direction to it. 
p. 405
outdegree 
The outdegree of a vertex in a directed graph
is the number of arcs directed away from that vertex.
p. 343
P
partially ordered set 
A partially ordered set is a pair (A, <
), where A is a set on which there is defined the partial
order -<. For example, (R, <) is a partially ordered set.
p. 63
partial order 
A partial order on a set A is a binary relation
on A which is reflexive, antisymmetric, and transitive. For
example, < defines a partial order on R. 
p. 63
partition A partition of a set A is a collection of disjoint
subsets (sometimes called cells) of A whose union is A.
For example, the positive integers, the negative integers,
and {0} form a partition of Z. 
p. 59
path 
A path in a pseudograph is a walk in which all ver-
tices are distinct. 
p. 303
perfect matching 
A perfect matching in a graph is a set of
edges which have the property that each vertex is incident
with exactly one edge in the set. 
p. 459
permutation 
A permutation of a set of distinct symbols
is an arrangement of them in a line in some order. For
example, cab is a permutation of a, b, c. 
p. 213

G-6 
Glossary
planar A planar graph is one that can be drawn in
the plane in such a way that no two edges cross.
p. 413
poset 
This is an abbreviation for partially ordered set.
p. 63
power set 
The power set 7P(A) of a set A is the set of all
subsets of A. For example, if A 
I 
{1, 2), then P(A)
{0, A, {1}, {2} }. 
p. 41
premise 
See argument.
prime 
A prime or prime number is a natural number p > 2
whose only positive divisors are itself and 1; for example,
2, 3, and 5. 
p. 114
prime decomposition 
The 
prime 
decomposition 
of
an integer n > 2 is its representation in the form
n = q1 q 2 
. .. qs , where q , 
q, are distinct primes
and al, ... , as are natural numbers called the multi-
plicities of qj .
, qu, respectively. For example, the
prime decomposition of 200 is 200 = 2352. The prime
factors of 200 are 2 and 5, with multiplicities 3 and 2,
respectively. 
p. ]18
prime divisor 
See prime factor.
prime factor 
The prime factors (or prime divisors) of an
integer n > 2 are the prime numbers which divide it.
These are the pi or qi when n is expressed in the form n =
PIP2 ... Pr or n = 
q'q 
... q0' by the Fundamental
Theorem of Arithmetic. For example, the prime factors
of 15 are 3 and 5; the prime factors of 36 are 2 and 3.
p. 118
Principle of Mathematical Induction 
Given a statement P
concerning the integer n, suppose
1. T is true for some particular integer no, and
2. if X is true for some particular integer k > no, then it
is true for the next integer k + 1.
Then Y is true for all integers n > no. 
p. 151
proper subset: 
A set A is a proper subset of a set B and
we write A 
B if and only if every element of A is
also an element of B, but A # B. For example, N C Z.
p. 40
pseudograph 
A pseudograph is like a graph, but it may
contain multiple edges or loops. 
p. 287
Q
quotient 
If a and b are integers, b 0 0, and a = qb + r
with 0 < r < b, then q is called the quotient and r the
remainder when a is divided by b. For example, when 26
is divided by 7, the quotient is 3 and the remainder is 5,
because 26 = 3(7) + 5. 
p. 99
quotient set 
The quotient set of an equivalence relation is
the set of all equivalence classes. For example, if the
equivalence relation on Z is defined by a - b if and only
if a -b is divisible by 2, there are two equivalence classes,
the even integers and the odd integers, so the quotient set
is the set {evens, odds}. 
p. 57
R
range 
The range of a function f: A -* 
B is the set of
elements b E B which are of the form b = f (a) for
some a E A. For example, the range of the floor function
L J: R -* R is the set of integers. 
p. 73
recombination 
See combination.
reflexive 
A binary relation - on a set A is reflexive if and
only if a - a for all a e A. For example, < is reflexive
on R but < is not. 
p. 52
relatively prime Integers are relatively prime if and only
if they are nonzero and the only positive integer which
divides each of them is 1; equivalently, their greatest com-
mon divisor is 1. For example, 2 and 3 are relatively
prime, as are the pairs -16, 21 and -15, 
-28. 
p. 108
remainder See the definition of quotient.
r-permutation An r-permutation of n symbols (r and n
positive integers, r < n) is an arrangement of r of them in
a line in some order. For example, caz is a 3-permutation
of the letters of the English alphabet. 
p. 213
root, rooted tree 
A tree is rooted if it comes with a spec-
ified vertex, called the root. A digraph is a rooted tree if
the underlying graph is a tree and there is a unique vertex
called the root, of indegree 0. 
p. 370 and p.393
S
same cardinality 
Two sets A and B have the same cardi-
nality if and only if there is a one-to-one correspondence
between them. For example, the integers and the even
integers have the same cardinality. 
p. 89
same order 
Functions f and g: N -* 
R have the same
order, and we write f - g, if and only if each is Big Oh
of the other. For example, I5n3 
4n3.
p. 248
saturated A saturated vertex in a graph is a vertex which
is incident with one of the edges in a given matching.
p. 459
score 
The score of a vertex in a tournament is the outdegree
of that vertex. 
p. 355
score sequence 
The score sequence of a tournament is the
list of outdegrees, in nonincreasing order. 
p. 355
sequence 
A sequence is a function with domain some set
of integers (often N). It is usually described by listing the
elements of its range. For example, the sequence which
is the function f: N -* 
R defined by f (n) -
n2 would
likely be described by the list 1, 4, 9, 16, .... 
p. 163
set difference 
The set difference A \ B of sets A and B
is the set of elements which are in A but not in B. For
example, (0, 1, 2, 31 \ {0, 1, 4) = {2, 3). 
p. 45
sink This is a distinguished vertex in a directed network.
p. 44]

Glossary G-7
smaller order A function f: N -* 
R has smaller order
than another function g, written f -< g, if and only if
f is Big Oh of g but g is not Big Oh of f. For example,
n7 -< 2'. 
p. 248
source 
This is a distinguished vertex in a directed network.
p. 441
spanning tree A spanning tree for a connected graph G is a
subgraph which is a tree and which includes every vertex
of 5. 
p. 378
strongly connected 
A digraph is strongly connected if and
only if there is a walk from any vertex to any other vertex
which respects orientation of arcs. 
p. 343
strongly connected orientation 
A strongly connected ori-
entation of a graph is an assignment of orientations (direc-
tions) to all edges in such a way that the resulting digraph
is strongly connected. 
p. 405
subgraph 
A subgraph of a pseudograph ! is a pseudograph
whose vertices and edges are subsets of the vertices and
edges, respectively, of G. 
p. 287
subset 
A set A is a subset of a set B, denoted A C B. if
and only if every element of A is also an element of B.
For example, {0, 1 C (0, 1, 2} but Z : N. 
p. 40
surjective 
Another word for onto. 
p. 73
symmetric 
A binary relation - on a set A is symmetric if
and only if a - b implies b - a. For example, a - b if
and only if ab = I defines a symmetric relation on Q, but
< does not. 
p. 52
symmetric difference 
The symmetric difference of sets A
and B, denoted A @ B, is the set of elements which
belong to precisely one of the sets. More generally,
the symmetric difference AI (d A2 a A3 E .
D A,,
of n sets AI, A2, A3 , . . , An is the set of those ele-
ments which are members of an odd number of the sets
Ai. For example, (0, 1, 2, 3} D (0, 1, 4, 5} = (2, 3, 4, 5}.
pages 47 and 161.
T
tautology 
A tautology is a compound statement that is
always true. For example, (pAq) -* (pvq) is a tautology.
(Examine the truth table.) 
p. 20
term 
The terms of a sequence are the numbers of its range
or, thinking of a sequence as a list, the numbers in the list.
For example, the first five terms of the Fibonacci sequence
are 1, 1,2,3,5. 
p. 164
total order 
A total order on a set is a partial order in which
every two elements are comparable. For example, < is
a total order on R, but C is not a total order on P(R).
p. 64
tournament 
A tournament is a digraph with the property
that for every two distinct vertices u, v, exactly one of
uv, vu is an arc. 
p. 355
trail A trail in a pseudograph is a walk in which all edges
are distinct. 
p. 303
transitive A binary relation - on a set A is transitive if
and only if a - b and b - c implies a - c. For example,
the binary relation - defined by a - b if ab > 0 is a
transitive relation on Z \ (0} but not on Z. 
p. 54
transitive tournament 
A transitive tournament is a tour-
nament with the property that whenever uv and vw are
arcs, so is uw an arc. 
p. 357
Traveling Salesman's Problem 
The Traveling Salesman's
Problem is to find a Hamiltonian cycle of least weight in
a weighted connected graph. 
p. 325
tree 
A tree is a connected graph which contains no circuits.
p. 369
triangle 
A triangle in a graph is a 3-cycle. 
p. 299
U
uncountable 
An uncountable set is an infinite set which
does not have the cardinality of N. For example, the real
numbers form an uncountable set. 
p. 90
union The union of sets-denoted A U B for two sets,
A U B U C for three, and U. I A, for n-is the set of ele-
ments which belong to at least one of them. For example,
0,1,2)U{0,1,3 ={0,1,2,3}. 
p.43
V
valid argument 
See argument.
value of a flow 
The value of a flow {fu,,1 in a directed net-
work with source s, sink t, and vertex set V is the integer
val(.F) =E fsv -
f Vs;
tEV 
VCV
equivalently,
val(.F) = 
E fp.- 
fv 
p 443
VEV 
evV
W
walk 
A walk in a pseudograph is an alternating sequence of
vertices and edges, beginning and ending with a vertex,
in which each vertex (except the last) is incident with
the edge which follows it and the last vertex is incident
with the preceding edge. It is closed if and only if the
first vertex is the same as the last and otherwise open.
p. 303
weighted graph 
A weighted graph is a graph in which
there is a nonnegative real number associated with each
edge. 
p. 325
Well-Ordering Principle 
This principle asserts that every
nonempty set of natural numbers has a smallest element.
p. 98

Index
A
absolute value, 76
absorption, 28
accessibility index, 292
acyclic, 369, 377
digraph, 392
addition rule, 196
adjacency matrix, 318
of a digraph, 343
adjacent, 286
Adleman, Leonard, 143
algorithm, 240
Bellman's, 394
Bellman-Ford, 345
binary search, 261
complexity, 262
bubble sort, 263
complexity, 264
canonical labeling, 395
Chinese Postman, 338
depth-first search, 399
complexity, 401
Dijkstra's, 326, 361, 362
complexity, 327
improved, 328, 329
division, 100
edge disjoint paths, 457
enumerating permutations, 272
Euclidean, 106
complexity, 257
Eulerian circuit, 307
exponential, 253
Floyd-Warshall, 330
complexity, 333
greedy, 383
Horner's, 243
complexity, 258
Kruskal's, 383
complexity, 384
linear search, 260
logarithmic, 253
merge sort, 267
merging, 265
polynomial, 253
Prim's, 386
complexity, 387
RSA, 143
strongly connected orientation,
408
ternary search, 270
and, 2
antisymmetric, 53
Appel, Kenneth, 422
arc, 342
backward, 449
forward, 449
saturated, 446
argument, 28
valid, 28
arithmetic sequence, 166
sum of, 166
Armengaud, Joel, 114
associative, 43, 47, 84, 98
associativity, 22
asymptotic, 121, 155
B
backward arc, 449
bar code, 137
base, 101, 102
Bellman, Richard, 345, 393
algorithm of, 394
beta index, 285, 292, 377
bijection, 73
bijective, 73
binary, 102
relation, 51
search, 261
complexity, 262
binomial coefficient, 217, 234
bipartite, 288
bipartition set, 288
block, 59
Boole, George, 46
breadth-first search, 404
bridge, 406
Brooks, R. L., 425
Brun, Viggo, 123
bubble sort, 263
complexity, 264
C
canonical
labeling, 392
ordering, 392
Cantor, Georg, 92, 93
capacity, 441, 442
of a cut, 444
cardinality, 87
same, 89
Cartesian product, 48
cases
proof by, 12, 44, 100, 199, 200,
425
Cayley, Arthur, 374
ceiling, 76, 100, 206
cell, 59
chain, 448
flow-augmenting, 449
rule, 31
characteristic
polynomial, 174
roots, 174
check digit, 136-138
Chen, J., 123
Chinese
Postman Problem, 338
Remainder Theorem, 140, 141
chromatic number, 423
circuit, 303
Eulerian, 304, 338, 343, 351
Hamiltonian, 311
closed
interval, 46
under a binary operation, 98
walk or trail, 303
closure, 97, 98
cofactor, 379
Cohen, Paul, 93
1-1

1-2 
Index
coloring, 423
n-, 423
combination, 218
linear, 161
combinations
how to order, 273
common
difference, 166
ratio, 167
commutative, 97
commutativity, 22
comparable, 65
comparison, 260
complement of a set, 45
complete, 288
bipartite, 288
complex numbers, 39
complexity
binary search, 262
bubble sort, 264
depth-first search, 401
Dijkstra, 327
improved, 329
enumerating permutations,
274
Euclidean algorithm, 257
Floyd-Warshall, 333
function, 246
Kruskal, 384
merge sort, 268
Prim, 387
component, 310
composite, 114
composition of functions, 82
compound statement, 2, 17
disjunctive normal form, 26
conclusion, 3, 28
condition
necessary, 9
sufficient, 9
conditions
necessary and sufficient, 10
congruence
class, 126
to solve, 129
congruent, 126
connected, 297, 305
strongly, 343, 405
conservation of flow, 442
continuum hypothesis, 93
contradiction, 20
proof by, 13, 14, 40, 59, 92,
115, 117, 312, 358, 392,
409, 416, 460
contrapositive, 5, 13, 20, 73,
206
converse, 4, 23, 133, 392
convex, 162, 415
Cook, Stephen, 254
coordinate, 48
countable, 90, 125
counter, 242
counterexample, 10, 44, 74
covers, 66
CPM, see critical path method
critical path, 361
method, 361
cryptology, 142
cube, 317, 415, 430
cut
(s, t)-, 444
capacity of, 444
edge, 406
cycle, 303
n-, 299, 303
even, 303
Hamiltonian, 310, 311, 343, 368,
462
odd, 303
proper, 311
D
de la Vall6e-Pousin, C.-J., 121
De Morgan, Augustus, 5, 421
laws of, 22, 46
decomposition
prime, 118
degree, 286
sequence, 290
delete
a vertex, 288
an edge, 288
depth-first search, 399
complexity, 401
derangement, 228
Descartes, Ren6, 48
difference
set, 45
symmetric, 47
digit, 101
check, 136-138
hundreds, 101
tens, 101
thousands, 101
units, 101
digraph, 342
acyclic, 392
Dijkstra, Edsger, 326
algorithm, 326
complexity, 327
improved, 328, 329
Dirac, G. A., 314
theorem of, 314
direct
product, 48
proof, 12, 84, 130, 248,
250
directed network, 360, 441
disjunctive
normal form, 26
syllogism, 31
distributive, 98
distributivity, 22
divides, 104
divisible, 104
division algorithm, 100
divisor, 104
prime, 118
dodecahedron, 314, 415, 430
domain, 73
restrict the, 75
dot product, 137
double implication, 4
dual graph, 430
Dudeney, H. E., 337
E
edge, 286
cut, 406
delete, 288
disjoint, 317, 456
multiple, 286
empty set, 39
enzyme digest, 350, 353

Index 
1-3
equivalence
class, 57, 126
logical, 20, 21
relation, 56, 251, 297
equivalent
statements, 11
the following are, 358, 369
Eratosthenes, 116
Sieve of, 116
Euclid, 106, 115
Euclidean algorithm, 106
complexity, 257
Euler, LUonhard, 120, 161, 277,
304, 415
Eulerian
circuit, 304, 338, 343, 351
pseudograph, 304, 306, 339
even cycle, 303
event, 196
events
mutually exclusive, 196
exclusive or, 21, 28
existential quantifier, 6
exponential time, 253
extended bases, 351
F
factor, 104
prime, 118
factorial, 155, 163, 211
Faltings, Gerd, 122
feasible relationships, 433
Fermat, Pierre de, 48, 120, 121
Last Theorem of, 121
Little Theorem of, 133
number, 120
prime, 119, 163
Fibonacci, Leonardo, 168
sequence, 168, 173, 232, 237,
257
Fields Medal, 93
finite, 88
Five-Color Theorem, 425
flag, 268, S-36
floor, 76, 100
flow
(s, t)-, 442
conservation of, 442
maximum, 443
unit, 445
value, 443
flow-augmenting chain, 449
Floyd, R. W., 330
Floyd-Warshall algorithm, 330
complexity, 333
for all, 6
Ford Jr., Lester Randolph, 345, 450
forest, 372, 377
forward arc, 449
Four-Color Theorem, 46, 421, 424
fragment, 350
unsplittable, 352
Fulkerson, D. R., 450
function, 71
3m + 1, 173
bijective, 73
ceiling, 76
complexity, 246
composition, 82
floor, 76
generating, 375
greatest integer, see floor
identity, 77
inverse, 80
powers of, 172
Fundamental Theorem of
Arithmetic, 118, 157
G
Gage, Paul, 114
gcd, see greatest common divisor
generality
without loss of, 14
generating function, 178, 375
geometric sequence, 167
sum of, 167
glb, see greatest lower bound
Goldbach, Christian, 123
conjecture of, 123
golden mean, 171
graph, 286
acyclic, 369, 377
bipartite, 288
complete, 288
connected, 305
dual, 430
finite, 286
Hamiltonian, 310
line-of-sight, 432
Petersen, 312, 419
planar, 278, 413
plane, 413
relationship, 433
weight of, 325
weighted, 325
greatest
common divisor, 105, 113
lower bound, 67
greedy, 383
grid segment, 430
Guthrie, Francis, 421
H
Hadamard, Jacques, 121
Hajratwala, Nayan, 115
Haken, Wolfgang, 422
Hall, Philip, 460
Marriage Theorem, 460,
461
Hamilton, William Rowan, 313,
374, 415
Hamiltonian
circuit, 311
cycle, 310, 311, 343, 368,
462
graph, 310
path, 316, 356, 358, 462
Hasse, Helmut, 66
diagram, 66, 111
Heawood, Percy, 422
hexadecimal, 102
homeomorphic, 417
homogeneous, see recurrence
relation
Horner, William, 243
algorithm, 243
hundreds digit, 101
hypothesis, 3, 28
I
icosahedron, 317, 415
ideal, 162
idempotence, 22

1-4 
Index
identity, 98
function, 77
matrix, 319
if and only if, 4, 10, 59, 306, 372,
407
image, 72, 73
implication, 3, 17
double, 4
implies, 3
incidence relations, 296
incident, 286
inclusion-exclusion
principle of, 190
indegree, 343
sequence, 343
Indelkofer, Karl-Heinz, 122
induction
hypothesis, 151
principle of mathematical, 151
proof by, 356, 372, 415, 424,
425
strong form, 157, 408
infinite, 88
countably, 90
initial condition, 164
injective, 73
Instant Insanity, 279
intersection, 43
interval
closed, 46
half open, 46
notation, 46
open, 46
inverse, 80
additive, 98, 132
function, 80
has an, 80
multiplicative, 98, 132
of an implication, 23
irrational number, 14, 39
ISBN, 136
isolated, 286
isomer, 374
isomorphic, 294-296
labeled trees, 375
isomorphism, 295
class, 297
J
Jarai, Antal, 122
joins, 286
K
Kempe, Alfred B., 422
Kirchhoff, Gustav, 319, 379
Theorem of, 379
knight's tour, 316
Koch, J., 422
Konigsberg Bridge Problem, 277
Kruskal, J. B., 383
algorithm of, 383
complexity, 384
Kuratowski, Kazimierz, 417
Theorem of, 418
Kwan, M. K., 337
L
labeled tree, 375
labeling
canonical, 392
lattice, 68, 110
lcm, see least common multiple
leaf, 372
least
common multiple, 110
upper bound, 67
length
of walk, 303
level
of a vertex, 370
lexicographic order, 65, 271
line-of-sight graph, 432
linear
combination, 108, 161
search, 260
time, 253
logarithmic time, 253
logically equivalent, 20, 21
loop, 242, 286
lub, see least upper bound
Lucas-Lehmer Test, 115
M
map, see function
Marriage Theorem, 461
matching, 459
perfect, 459
mathematical induction, see
induction
matrix
adjacency, 318
identity, 319
permutation, 321
transpose, 322
Matrix-Tree Theorem, 379
maximal, 67
maximum, 66
flow, 443
Menger, Karl, 456
theorem of, 456
merge sort, 267
complexity, 268
merging ordered lists, 265
Mersenne, Marin, 119
prime, 119
minimal, 67
minimum, 66
connector problem, 377, 382
spanning tree, 378
minterm, 26
mod, 126, 129
modulus, 126
modus
ponens, 31
tollens, 31
multiplication rule, 197
multiplicity, 118
mutually exclusive, 196
N
n!, n factorial, 155, 163, 211
n-coloring, 423
n-cycle, 299, 303
n -gon, 162
n-tuple, 48
natural numbers, 37
necessary, 9
and sufficient, 10
negation, 5, 17
double, 22
net, 430
network
directed, 360, 441

Index 
1-5
node, 430
NP-complete, 254, 325, 424
0
octahedron, 415
octal, 102
odd cycle, 303
one-to-one, 73
correspondence, 88, 89
one-way street problem, 405
onto, 73
open
interval, 46
walk or trail, 303
or, 2, 3
exclusive, 21, 28
order
lexicographic, 65, 271
partial, 64
same, 248
smaller, 248
ordered pair, 48
ordering
canonical, 392
Ore, Oystein, 314
theorem of, 317
orient, 405
orientation, 349, 405
strongly connected, 405
outdegree, 343
sequence, 343
p
pairwise
disjoint, 196
relatively prime, 141
palindrome, 202
partial
fractions, 182
order, 64, 97
partially ordered set. 64
particular solution, 175
partition, 59, 126-128, 447
Pascal, Blaise, 231
triangle of, 232
path, 303
critical, 361
Hamiltonian, 316, 356, 358,
462
shortest, 325
paths
edge disjoint, 456
Pell sequence, 185
perfect
matching, 459
square, 125, 170
permutation, 213
matrix, 321
r-, 213
permutations
enumerating, 272
complexity, 274
ordering, 272
PERT, see project evaluation and
review
Petersen, Julius, 312
graph of, 312, 419
Pigeon-Hole Principle, 204
strong form, 206
planar, 278, 413
plane graph, 413
Platonic solid, 317, 410, 415
polyhedron
convex regular, 415
polynomial time, 253
poset, 64
power set, 41
powers of a function, 172
premise, 28
Prim, R. C., 383
algorithm of, 386
complexity, 387
prime, 114
decomposition, 118
divisor, 118
factor, 118
Fermat, 119, 163
Mersenne, 119
number, 114
relatively, 108
Prime Number Theorem, 121
primes
twin, 122
Principle of Mathematical
Induction, see induction
product
Cartesian, 48
direct, 48
project evaluation and review, 361
proof
by contradiction, see
contradiction
cases, see cases
direct, see direct
proper
cycle, 311
subset, 40
proposition, 22
pseudograph, 287
Eulerian, 304, 306, 339
Q
Q.E.D., 12
quadratic time, 253
quadrilateral, 299
quantifier, 6
existential, 6
universal, 6
quaternions, 313
quotient, 98, 99
set, 57
R
recombination, 218
r-permutation, 213
Rddei, L., 356
theorem of, 356
range, 73
rational number, 14, 38
recurrence relation, 164
homogeneous, 173
second order linear, 173
solve, 164
recursive definition, 163
reduce modulo n, 129
reflexive, 52, 296
relation
binary, 51
equivalence, 56, 251, 297
relationship graph, 433
relationships
feasible, 433

1-6 
Index
relatively prime, 108
pairwise, 141
remainder, 98, 99
resolution, 31
restrict the domain, 75
ribonucleic acid, 350
Rivest, Ronald, 143
RNA, see ribonucleic acid
root, 370, 393
rooted tree, 393
RSA Algorithm, 143
rules of inference, 30
Russian peasant multiplication,
240, 256
S
(s, t)-cut, 444
(s, t)-flow, 442
same cardinality, 89
saturated
arc, 446
vertex, 459
Schroder Bernstein Theorem, 93
score, 355
search
binary, 261
breadth-first, 404
depth-first, 399
linear, 260
ternary, 270
second order linear recurrence
relation, 173
sequence, 163
degree, 290
Fibonacci, 168, 232, 237,
257
indegree, 343
outdegree, 343
Pell, 185
set
builder notation, 38
difference, 45
empty, 39
finite, 88
infinite, 88
partially ordered, 64
power, 41
totally ordered, 65
Shamir, Adi, 143
Shimura, Goro, 122
shortest path, 325
Sieve of Eratosthenes, 116
sink, 441
slack, 363, 449
Slowinski, David, 114
solve (a recurrence relation), 164,
173
sort
bubble, 263
merge, 267
source, 441, 442
spanning tree, 378
Spence, Gordon, 114
statement, 2, 17
compound, 2, 17
Stirling, James, 155
formula of, 155
strongly connected, 343, 405
orientation, 405
subgraph, 280, 287
subset, 40
proper, 40
substitution theorem, 30
sufficient, 9
sum
arithmetic sequence, 166
geometric sequence, 167
superset, 40
surjective, 73
swap, 263
symmetric, 52, 296
difference, 47, 161
matrix, 319
T
Taniyama, Yutaka, 122
target, 73
tautology, 20
Taylor, Richard, 122
tens digit, 101
term (of a sequence), 164
ternary search, 270
tetrahedron, 415
theorem
Schroder-Bernstein, 93
substitution, 30
there exists, 6
thousands digit, 101
Three Houses-Three Utilities,
278, 413, 416
time
exponential, 253
linear, 253
logarithmic, 253
polynomial, 253
quadratic, 253
total order, 65
totally ordered, 65
tournament, 355
transitive, 357
Towers of Hanoi, 177
trail, 303
closed, 303
Eulerian, 307
open, 303
transitive, 54, 296, 357
transpose
of matrix, 322
Traveling Salesman's Problem,
271, 325, 368,
388
tree, 369
labeled, 375
minimum spanning, 378
rooted, 370, 393
spanning, 378
triangle, 289, 293, 299
inequality, 248, 250
triangulate, 421
truth
table, 17
value, 2
twin prime conjecture, 123
twin primes, 122
U
uncountable, 90
union, 43
unit flow, 445
units digit, 101
universal product code, 137
unsplittable fragment, 352
UPC, see universal product code

Index 1-7
V
valid argument, 28
value of a flow, 443
vector, 137
Venn diagram, 43
vertex, 286
delete, 288
even, 286
isolated, 286
odd, 286
saturated, 459
Vinogradov, I. M., 123
W
walk, 303
closed, 303
length, 303
open, 303
Warshall, S., 330
Wassing, Heinz-Georg, 122
weight
of a subgraph graph, 325
of an edge, 325
weighted, 325
Well-Ordering Principle, 98, 158
Wiles, Andrew, 121
without loss of generality, 14

Page 
Symbol 
Meaning
Complexity/Order of Functions
247 
0) 
Big Oh
248 
f -< g 
f has smaller order than g
248 
f 
g 
functions f and g have the same order
Number
58
58
76
76
104
121
126
Combina
155
212
217
Theory
nZ
nZ+ r
Lxj
zr(x)
a - b (mod n)
torial
n !
P(n, r)
ci)
228 
D,
Graph Theoretical
286 
Q(V, E)
286 
deg v
288 
9 \ {e}
288 Q\{vj
288
288
295
325
355
423
Kwn
Â£m'n
Â£7i 2-
w(e)
s(v)
Y (5)
the set of multiples of the integer n
the set of integers of the form na + r, equivalently, the set of integers
congruent to r (mod n)
ceiling of x, least integer > x
floor of x, greatest integer < x
divides
number of primes p < x
a is congruent to b mod n, i.e., n I (a - b)
n factorial
the number of permutations of n objects taken r at a time
a binomial coefficient; read "n choose r," it equals the number of
combinations of n objects taken r at a time; i.e., the number of ways
to choose r objects from n
number of derangements of n symbols
g is a graph with venex set V and edge set Â£
the degree of vertex v
the graph whose vertices are those of g and whose edges consist of
those of g except for e
the graph whose vertices are those of Q except for v and whose edges
are those edges of g not incident with v
complete graph on n vertices
complete bipartite graph on vertex sets of m and n elements
295 and Å½ and isomorphic
weight of edge e
score of vertex v in a tournament
chromatic number of the graph G
Page 
Symbol
Meanling

Page 
Symbol 
Meaning
Set Theoretical
38
39
40
40
40
41
43
43
45
45
46
46
46
46
47
48
88
c
0
C
C
D
1P(A)
U
n
AC
[a, b]
(a, b]
(-oc, b]
(a, o)
x
JAl
Equivalence Relations
57 
A/-
57, 126 a-
Partially Ordered Sets
63 
-<
66 
v
66 
A
Functions
72 
f:A-mB
73
77
77
80
82
1-1
tA
fl
0
belongs to, is an element of
the empty set
is a subset of
is a proper subset of
is a superset of, contains
the power set (the set of all subsets) of A
union
intersection
set difference
the complement of A
{x e R I a < x < b}, where a, b c R
{x E R I a < x < b}, where a, b E R
{x E R I x < b}, where b c R
{x E R I x > a}, where a E R
symmetric difference
Cartesian (or direct) product
the cardinality of A (if A is finite, this is just the number of elements
in A)
quotient set of A (the set of equivalence classes of an equivalence
relation on a set A)
equivalence class of a; also used to denote the congruence class of an
integer a (mod n)
a partial order
least upper bound
greatest lower bound
f is a function from A to B
one-to-one
the identity function
the identity function on the set A
inverse of the function f
composition (of functions)

PRENTICE 
ALL
Uppr 
Sddl RIv5NJ 0745
pren 
o
ISBN 0-13-092000-2
978130!11 920003

