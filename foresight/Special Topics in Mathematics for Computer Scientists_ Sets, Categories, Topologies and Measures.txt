Ernst-Erich Doberkat
Special Topics 
in Mathematics 
for Computer 
Scientists
Sets, Categories, Topologies and 
Measures

Special Topics in Mathematics for
Computer Scientists


Ernst-Erich Doberkat
Special Topics
in Mathematics
for Computer Scientists
Sets, Categories, Topologies
and Measures
123

Ernst-Erich Doberkat
Math ++ Software
Lewackerstr. 6 b
Bochum, Germany
math@doberkat.de
ISBN 978-3-319-22749-8
ISBN 978-3-319-22750-4
(eBook)
DOI 10.1007/978-3-319-22750-4
Library of Congress Control Number: 2015954182
Mathematical Subject Classiﬁcation (2010): 03-01, 03B45, 03B70, 18-01, 18C20, 18C50, 54-01,
54B99, 54D99, 60-01, 60B05, 60J05, 68Q87, 68Q55, 68N30
Springer Cham Heidelberg New York Dordrecht London
© Springer International Publishing Switzerland 2015
This work is subject to copyright. All rights are reserved by the Publisher, whether the whole or part
of the material is concerned, speciﬁcally the rights of translation, reprinting, reuse of illustrations,
recitation, broadcasting, reproduction on microﬁlms or in any other physical way, and transmission
or information storage and retrieval, electronic adaptation, computer software, or by similar or
dissimilar methodology now known or hereafter developed.
The use of general descriptive names, registered names, trademarks, service marks, etc. in this
publication does not imply, even in the absence of a speciﬁc statement, that such names are exempt
from the relevant protective laws and regulations and therefore free for general use.
The publisher, the authors and the editors are safe to assume that the advice and information in this
book are believed to be true and accurate at the date of publication. Neither the publisher nor the
authors or the editors give a warranty, express or implied, with respect to the material contained
herein or for any errors or omissions that may have been made.
Printed on acid-free paper
Springer International Publishing AG Switzerland is part of Springer Science+Business Media
(www.springer.com)

*
F¨ur Nina Luise


Preface
The idea to write this book came to me when, after having taught an un-
dergraduate course on concrete mathematics using the wonderful epony-
mous book Concrete Mathematics: A Foundation for Computer Science
[GKP89], I wanted to do a graduate course on Markov transition sys-
tems for computer scientists. It turned out that I had to devote most
of the time to laying the foundations from sets, measures, and topol-
ogy and that I could not ﬁnd an adequate textbook to recommend to my
students. This contrasts signiﬁcantly the situation in other areas, such
as the analysis of algorithms, where many ﬁne textbooks are available.
Consequently, I had to dig through the mathematical literature, taking
pieces from here and there, in effect trying to nail a ﬁrm albeit makeshift
mathematical scaffold the students could stand on securely.
Looking at the research literature in this area and in related ﬁelds, one
also ﬁnds a lack of quotable resources. Each author has to construct her
or his own foundations in order to get going, wasting considerable effort
to prove the same lemmata over and over again.
So the plan for this book began to develop. I decided to focus on sets,
topologies, categories, and measures. Let me tell you why.
Sets and the Axiom of Choice
Sets are a universal tool for computer
scientists, the tool which has been imported as a lingua franca from
mathematics. When surveying the computer science literature, we see
that sets and the corresponding constructs like maps, power sets, orders,
etc., are being used freely, but there is usually no concern regarding the
axiomatic basis of these objects—sets are being used, albeit in a fairly
naive way. This should not be surprising, because they are just tools
vii

viii
PREFACE
and often not the objects of consideration themselves. However, fairly
early in education, a computer scientist encounters the phenomenon of
recursion, either as a recursive function or as a recursive deﬁnition. And
here immediately arises the question as to why the corresponding con-
structs work and, speciﬁcally, how one can be sure that a particular re-
cursive program is actually terminating. The same question, probably
a little more precisely, appears in techniques which are related to term
rewriting. Here, one inquires whether a particular chain of replacements
will actually lead to a result in a ﬁnite amount of time. People in term
rewriting have found a way of writing this down, namely, a terminating
condition which is closely related to some well ordering. This means
that there are no inﬁnitely long chains, which is of course a very similar
condition to the one that is encountered when talking about the termina-
tion of a recursive procedure: Here, one does not want to have inﬁnitely
long chains of procedure or method calls. This suggests structural sim-
ilarities between the termination of a recursive method and rewriting a
term.
When investigating the background of all these events, we1 ﬁnd that we
need to look at well orderings. These are orderings which forbid the
existence of inﬁnitely long decreasing chains. Do well orderings always
exist? This question is of course fairly easy to answer when we talk
about ﬁnite scenarios, but sometimes it is mandatory to consider inﬁnite
objects as well. The world may be ﬁnite, but our models of the world
are not always so. Hence, the question arises whether we can take an
arbitrary set and construct a well ordering for it. As it turns out, this
question is very closely connected with another question, which at ﬁrst
glance does not look related at all: Given a collection of nonempty sets,
are we able to select from each set exactly one element? One of the in-
teresting points which indicates that things are probably a little bit more
complicated than they look is the observation that the possibility of well
ordering an arbitrary set is equivalent to that of the question of selection,
which came to be known as the axiom of choice. It turned out during the
1For the usage of the ﬁrst person plural in this treatise, let me quote William Gold-
bloom Bloch. He writes in his enjoyable book on Borges’ mathematical ideas in a sim-
ilar situation: “This should not be construed as a ‘royal we.’ It has been a construct of
the community of mathematicians for centuries and it traditionally signiﬁes two ideas:
that ‘we’ are all in consultation with each other through space and time, making use of
each other’s insights and ideas to advance the ongoing human project of mathematics,
and that ‘we’—the author and reader—are together following the sequences of logical
ideas that lead to inexorable, and sometimes poetic, conclusions.” [Blo08, p. 19].

PREFACE
ix
discussion in mathematics that there is a whole bag of other properties
that are equivalent to this axiom. We will see that the axiom of choice
is equivalent to some well-known proof principles like Zorn’s Lemma
or Tuckey’s Maximality Principle. Because this discussion relating to
the axiom of choice and similar constructions has been raging in math-
ematics for more than a century now, we cannot hope to be able to even
completely list out all those things which we have to eliminate. Never-
theless, we try to touch upon some topics that appear to be important for
developing mathematical structures within computer science. We can
even show that some results do not hold if another path is pursued and
the axiom of choice is replaced by another one; this refers to a game-
theoretic scenario, which is of course of interest to computer scientists
as well.
Because the discussion on the axiom of choice touches upon so many
areas in mathematics, it gives us the opportunity to look at some of them.
In this sense, the axiom of choice is a peg on which we hang our walking
stick.
Categories
Many areas of mathematics show surprising structural
similarities, which suggests that it might be interesting and helpful to
focus on an abstract view, hereby unifying concepts. This abstract view
looks at the mathematical objects from the outside and studies the re-
lationship between them, for example, groups (as objects) and homo-
morphisms (as an indicator of their relationship), or topological spaces
together with continuous maps, or ordered sets with monotone maps,
etc. It leads to the general notion of a category. A category is based on a
class of objects together with morphisms for each pair of objects. Mor-
phisms can be composed; the composition follows some laws which are
considered evident and natural.
This approach has considerable appeal to a software engineer. In soft-
ware engineering, the implementation details of a software system are
usually not particularly important from an architectural point of view;
they are encapsulated in a component. In contrast, the relationship of
components with each other is of interest because this knowledge is nec-
essary for composing a system from its components. Roughly speaking,
the architecture of a software system is characterized both by its com-
ponents and their interaction, the static part of which can be described
by what we may perceive as morphisms.

x
PREFACE
This has been recognized fairly early in the software architecture com-
munity, witnessed by the April 1995 issue of the IEEE Transactions
on Software Engineering. It was devoted to software architecture and
demonstrated that formalisms from category theory in discussing archi-
tectures are very helpful for clarifying structures. So the language of
categories offers some attractions to software engineers. We will also
see that the tool set of modal logics, another area which is important
to software construction, proﬁts substantially from constructions which
are ﬁrmly grounded in categories.
We are going to discuss categories here and introduce the reader to the
basic constructions. The world of categories is too rich to be captured in
these few pages, so we have made an attempt to provide the reader with
some basic proﬁciency in categories, helping her or him to get a grasp
of the basic techniques. This modest goal is attained by blending the
abstract mathematical development with a plethora of examples.
Topological Spaces
A topology formalizes the notion of an open set;
call a set open iff each of its members leaves a little room, something like
a breathing space, around it. This gives immediately an idea of the struc-
ture of the collection of open sets—they should be closed under ﬁnite
intersections, but under arbitrary unions, yielding the base for a calculus
of observable properties. This approach puts its emphasis subtly away
from the classic approach, e.g., in mathematical analysis or probability
theory, by stressing on different properties of a space. The traditional
approach, for example, stresses on separation properties, such as being
able to separate two distinct points through an open set. Such a strong
emphasis is not necessarily observed in the computationally oriented use
of topologies, where, to give an example, pseudometrics for measuring
the conceptual distance between objects are important for ﬁnding an ap-
proximation between Markov transition systems.
We give a brief introduction to some of the main properties of topolog-
ical spaces. The objective is to provide the tools and methods offered
by the set-theoretic topology to an application- oriented reader; thus,
we introduce the very basic notions of this topology and discuss brieﬂy
the applications of its tools. Some connections to logic and set the-
ory are indicated. Compactness has been made available very early;
thus, compact spaces serve occasionally as an exercise ground, before
compactness with its ramiﬁcations is discussed in depth. Continuity is

PREFACE
xi
an important topic and so are the basic constructions like product or
quotients which are enabled by it. Since some interesting and impor-
tant topological constructions are linked to ﬁlters, we study ﬁlters and
convergence, comparing through examples the sometimes more easy-
to-handle nets with the occasionally more cumbersome ﬁlters. Talking
about convergence, separation properties suggest themselves. Often it
happens that one works with a powerful concept but that this concept
requires assumptions which are too strong; hence, one has to weaken
it in a sensible way. This is demonstrated in the transition from com-
pactness to local compactness; we discuss local compact spaces, and we
give an example of a compactiﬁcation. Quantitative aspects come into
the picture when one measures openness through a pseudometric; here,
many concepts are seen in a new, brighter light; in particular, the prob-
lem of completeness emerges. Complete spaces have some very spe-
cial properties, for example, the intersection of countably many open
dense sets is dense again. This is Baire’s Theorem; we show through
a Banach–Mazur game played on a topological space that being of the
ﬁrst category can be determined through one of the players having a
winning strategy.
This completes the overview of the basic properties of topological
spaces. We present next a small gallery in which topology is in action.
The reason for singling out some topics is that we want to demonstrate
the techniques developed with topological spaces for some interesting
applications. For example, G¨odel’s Completeness Theorem for (count-
able) ﬁrst-order logic has been proved by Rasiowa and Sikorski through
a combination of Baire’s Theorem and Stone’s topological representa-
tion of Boolean algebras. This topic is discussed in detail. The calculus
of observations, which is mentioned above, leads to the notion of topo-
logical systems. This hints at an interplay of topology and order, since
a topology is after all a complete Heyting algebra in the partial order
provided by inclusion. Another important topic is the approximation of
continuous functions by a given class of functions, like polynomials on
a closed interval, leading directly to the Stone–Weierstraß Theorem on
a compact topological space, a topic with a rich history. Finally, the
relationship of pseudometric spaces with general topological spaces is
reﬂected again; we introduce uniform spaces as an ample class of spaces
which are more general than pseudometric spaces but less general than

xii
PREFACE
their topological cousins. Here, we ﬁnd concepts like completeness or
uniform continuity, which are formulated for metric spaces but which
cannot be realized in general topological ones.
Measures for Probabilistic Systems
Markov transition systems are
based on transition probabilities on a measurable space. This is a gen-
eralization of discrete spaces, where certain sets are declared to be mea-
surable. So, in contrast to assuming that we know the probability for the
transition between two states, we have to model the probability of a tran-
sition going from one state to a set of states: Point-to-point probabilities
are no longer available due to working in a comparatively larger space.
Measurable spaces are the domains of these probabilities. This approach
has the advantage of being more general than ﬁnite or countable spaces,
but now one deals with a fairly involved mathematical structure.
We start off with a discussion of -algebras, which are also discussed in
the chapter of sets, and we look at the structure of -algebras, in particu-
lar at its generators; it turns out that the underlying space has something
to say about it. In particular, we deal with Polish and related spaces.
Some constructions in this area are studied; they have immediate appli-
cations in logic and in Markov transition systems, in which measures
are vital. We show also that we can construct measurable selections,
which we use for an investigation into the structure of quotients in the
Kleisli monad, providing an interesting and fruitful example of the inter-
play of arguments from measure theory and categories. This interplay
is stressed upon also for the investigation of stochastic effectivity func-
tions, which leads to an interpretation of game logics.
After having laid the groundwork, we construct the integral of a mea-
surable function through an approximation process, very much in the
tradition of the Riemann integral but with a larger scope. We also go the
other way: Given an integral, we construct a measure from it. This is
the elegant way proposed by P.J. Daniell for constructing measures, and
it can be brought to fruit in this context for a fairly simple proof of the
Riesz Representation Theorem on compact metric spaces.
Having all these tools at our disposal, we look at product measures,
which can be introduced now through a kind of line sweeping—if you
want to measure an area in the plane, you measure the line length as
you sweep over the area; this produces a function of the abscissa, which

PREFACE
xiii
then yields the area through integration. One of the main tools here
is Fubini’s Theorem. Applications include a discussion of projective
systems. A case study shows that projective systems arise naturally in
the study of continuous time stochastic logics.
Finally, we take up a classic: Lp-spaces. We start from Hilbert spaces,
apply the representation of linear functionals on L2 to obtain the Radon–
Nikodym Theorem through von Neumann’s ingenious proof, and derive
from it the representation of the dual spaces.
Because we are driven by applications to Markov transition systems and
similar objects, we do not strive for the most general approach to mea-
sure and integral. We usually formulate the results for ﬁnite or -ﬁnite
measures, leaving the more general cases outside our focus. This also
means that we do not deal with complex measures; we show, however,
how to deal with complex measures when the occasion arises.
Things Left Out
Several things had to be left out. This is an incom-
plete list, from which many things had to be left out. For example, I
do not discuss ill-founded sets in the chapter on set theory, and I cannot
take even a tiny step into forcing or inﬁnite combinatorics. I do not cover
ﬁnal coalgebras or coinduction in the chapter on categories, which also
excludes an extensive discussion on limits and colimits. It would have
been helpful to look into hyperspaces in the chapter on topologies or to
discuss topological groups with their Haar measure, let alone provide a
glimpse at topological vector spaces. Talking about measures, martin-
gales are missing, and the connections to topological measure theory are
looked at through the lens of Polish or analytic spaces.
But, alas, many a choice had to be made, and since I am a confessing
Westphalian, I quote this proverb:
Wat dem een sin Uhl, is dem anneren sin Nachtigal.
So I have tried to incorporate topics which to me seem useful.
Organization
Each chapter derives its content in the usual strict
mathematical way, with proofs and all that.
It belongs certainly to
the education of a computer scientist of the theoretical variety to carry
out proofs, and not to rely on good faith or on the well-known art of
handwaving. The development is supported by many examples, some

xiv
PREFACE
motivating, some mathematically interesting, but most of them oriented
toward applications in computer science. Larger examples are presented
as case studies. They appear interesting from a modeling point of view
as well as due to their application of the mathematical techniques at
hand. The same applies to exercises, which are given at the end of each
chapter. Bibliographic notes provide usually the source for some partic-
ular approach, a proof, or an idea which is pursued; they also give hints
where further information may be found. It has not always been easy
to attribute a development to a particular paper, book, or author, since
folklore quickly spreads, and results and ideas are amended or otherwise
modiﬁed, sometimes obscuring the true originators. Thus, the author
apologizes if results could not always be attributed properly, or not at
all.
How to Read This Book
This is a book with an intended audience
which is somewhat advanced, hence, it seems to be a bit out of place to
give suggestions on how to read it. The advice to the reader is just to
take what she or he needs, do the exercises, and, if this is not enough,
look for further information in the literature. The author put in a great
deal of effort to provide an ample list of references. Good luck!
Thanks
Finally,
I want to thank J. Bessai,
B. Fuchssteiner,
H.G. Kellerer, E.O. Omodeo, P. Panangaden, D. Pumpl¨un, H. Sabad-
hikary and S.M. Srivastava, P. S´anchez Terraf, and F. Stetter.
They
helped in opening some doors—mathematically or otherwise—for me,
made some insightful comments, and gave me a helping hand which,
sometimes in the transitive closure, had some impact on this book. The
Deutsche Forschungsgemeinschaft supported my research into algebraic
and coalgebraic properties of stochastic relations for more than ten years;
some results of this work could be used for this book. Stefan Dissmann
and Alla Stankjawitschene, my former secretary, helped clear my path
by taking many administrative obstacles off it.

PREFACE
xv
The cooperation with Dr. Mario Aigner and Sonja Gasser of Springer-
Verlag was constructive and helpful. I want to thank them all.
Above all, I owe my thanks to Gudrun for all her love and understanding.
I devote this book to our youngest granddaughter Nina Luise; she will
probably like the idea of playing with symbols.
Bochum, Germany
Ernst-Erich Doberkat


Contents
1
The Axiom of Choice and Some of Its Equivalents
1
1.1
The Axiom of Choice . . . . . . . . . . . . . . . . . . .
9
1.2
Cantor’s Enumeration of N  N
. . . . . . . . . . . . .
10
1.3
Well-Ordered Sets . . . . . . . . . . . . . . . . . . . . .
15
1.4
Ordinal Numbers . . . . . . . . . . . . . . . . . . . . .
21
1.5
Zorn’s Lemma and Tuckey’s Maximality Principle
. . .
29
1.5.1
Compactness for Propositional Logic
. . . . . .
32
1.5.2
Extending Orders . . . . . . . . . . . . . . . . .
35
1.5.3
Bases in Vector Spaces . . . . . . . . . . . . . .
37
1.5.4
Extending Linear Functionals
. . . . . . . . . .
39
1.5.5
Maximal Filters . . . . . . . . . . . . . . . . . .
42
1.5.6
Ideals and Filters . . . . . . . . . . . . . . . . .
44
1.5.7
The Stone Representation Theorem
. . . . . . .
52
1.5.8
Compactness and Alexander’s Subbase
Theorem
. . . . . . . . . . . . . . . . . . . . .
56
1.6
Boolean -Algebras . . . . . . . . . . . . . . . . . . . .
64
1.6.1
Construction Through Transﬁnite Induction . . .
69
1.6.2
Factoring Through -Ideals
. . . . . . . . . . .
72
1.6.3
Measures . . . . . . . . . . . . . . . . . . . . .
73
1.6.4
-Measurable Sets . . . . . . . . . . . . . . . .
88
1.7
Banach–Mazur Games
. . . . . . . . . . . . . . . . . .
90
1.7.1
Determined Games . . . . . . . . . . . . . . . .
92
1.7.2
Proofs Through Games . . . . . . . . . . . . . .
95
1.8
Wrapping It Up . . . . . . . . . . . . . . . . . . . . . . 103
1.9
Bibliographic Notes . . . . . . . . . . . . . . . . . . . . 104
1.10 Exercises
. . . . . . . . . . . . . . . . . . . . . . . . . 104
xvii

xviii
CONTENTS
2
Categories
109
2.1
Basic Deﬁnitions
. . . . . . . . . . . . . . . . . . . . . 111
2.2
Elementary Constructions . . . . . . . . . . . . . . . . . 128
2.2.1
Products and Coproducts . . . . . . . . . . . . . 129
2.2.2
Pullbacks and Pushouts . . . . . . . . . . . . . . 138
2.3
Functors and Natural Transformations . . . . . . . . . . 145
2.3.1
Functors
. . . . . . . . . . . . . . . . . . . . . 145
2.3.2
Natural Transformations . . . . . . . . . . . . . 154
2.3.3
Limits and Colimits
. . . . . . . . . . . . . . . 162
2.4
Monads and Kleisli Tripels . . . . . . . . . . . . . . . . 165
2.4.1
Kleisli Tripels . . . . . . . . . . . . . . . . . . . 165
2.4.2
Monads . . . . . . . . . . . . . . . . . . . . . . 167
2.4.3
Monads in Haskell . . . . . . . . . . . . . . . 176
2.5
Adjunctions and Algebras . . . . . . . . . . . . . . . . . 179
2.5.1
Adjunctions . . . . . . . . . . . . . . . . . . . . 179
2.5.2
Eilenberg–Moore Algebras . . . . . . . . . . . . 188
2.6
Coalgebras
. . . . . . . . . . . . . . . . . . . . . . . . 197
2.6.1
Bisimulations . . . . . . . . . . . . . . . . . . . 202
2.6.2
Congruences
. . . . . . . . . . . . . . . . . . . 219
2.7
Modal Logics . . . . . . . . . . . . . . . . . . . . . . . 224
2.7.1
Frames and Models . . . . . . . . . . . . . . . . 227
2.7.2
The Lindenbaum Construction . . . . . . . . . . 245
2.7.3
Coalgebraic Logics . . . . . . . . . . . . . . . . 255
2.8
Bibliographic Notes . . . . . . . . . . . . . . . . . . . . 268
2.9
Exercises
. . . . . . . . . . . . . . . . . . . . . . . . . 269
3
Topological Spaces
281
3.1
Deﬁning Topologies . . . . . . . . . . . . . . . . . . . . 283
3.1.1
Continuous Functions
. . . . . . . . . . . . . . 287
3.1.2
Neighborhood Filters . . . . . . . . . . . . . . . 297
3.2
Filters and Convergence
. . . . . . . . . . . . . . . . . 300
3.3
Separation Properties . . . . . . . . . . . . . . . . . . . 308
3.4
Local Compactness and Compactiﬁcation . . . . . . . . 320
3.5
Pseudometric and Metric Spaces . . . . . . . . . . . . . 329
3.5.1
Completeness . . . . . . . . . . . . . . . . . . . 340
3.5.2
Baire’s Theorem and a Banach–Mazur
Game . . . . . . . . . . . . . . . . . . . . . . . 357
3.6
A Gallery of Spaces and Techniques . . . . . . . . . . . 363
3.6.1
G¨odel’s Completeness Theorem . . . . . . . . . 364
3.6.2
Topological Systems or Topology via Logic . . . 371

CONTENTS
xix
3.6.3
The Stone–Weierstraß Theorem . . . . . . . . . 387
3.6.4
Uniform Spaces . . . . . . . . . . . . . . . . . . 396
3.7
Bibliographic Notes . . . . . . . . . . . . . . . . . . . . 420
3.8
Exercises
. . . . . . . . . . . . . . . . . . . . . . . . . 421
4
Measures for Probabilistic Systems
427
4.1
Measurable Sets and Functions . . . . . . . . . . . . . . 429
4.1.1
Measurable Sets
. . . . . . . . . . . . . . . . . 431
4.1.2
A -Algebra on Spaces of Measures . . . . . . . 437
4.1.3
Case Study: Stochastic Effectivity
Functions . . . . . . . . . . . . . . . . . . . . . 440
4.1.4
The Alexandrov Topology on Spaces
of Measures . . . . . . . . . . . . . . . . . . . . 458
4.2
Real-Valued Functions
. . . . . . . . . . . . . . . . . . 467
4.2.1
Essentially Bounded Functions . . . . . . . . . . 472
4.2.2
Convergence Almost Everywhere
and in Measure . . . . . . . . . . . . . . . . . . 474
4.3
Countably Generated -Algebras . . . . . . . . . . . . . 482
4.3.1
Borel Sets in Polish and Analytic Spaces
. . . . 490
4.3.2
Manipulating Polish Topologies . . . . . . . . . 496
4.4
Analytic Sets and Spaces . . . . . . . . . . . . . . . . . 500
4.4.1
Souslin’s Separation Theorem . . . . . . . . . . 503
4.4.2
Smooth Equivalence Relations . . . . . . . . . . 508
4.5
The Souslin Operation
. . . . . . . . . . . . . . . . . . 517
4.6
Universally Measurable Sets . . . . . . . . . . . . . . . 524
4.6.1
Lubin’s Extension Through von Neumann’s
Selectors
. . . . . . . . . . . . . . . . . . . . . 528
4.6.2
Completing a Transition Kernel
. . . . . . . . . 532
4.7
Measurable Selections
. . . . . . . . . . . . . . . . . . 538
4.8
Integration . . . . . . . . . . . . . . . . . . . . . . . . . 541
4.8.1
From Measure to Integral . . . . . . . . . . . . . 542
4.8.2
The Daniell Integral and Riesz Representation
Theorem
. . . . . . . . . . . . . . . . . . . . . 549
4.9
Product Measures . . . . . . . . . . . . . . . . . . . . . 557
4.9.1
Fubini’s Theorem . . . . . . . . . . . . . . . . . 564
4.9.2
Inﬁnite Products and Projective Limits . . . . . . 568
4.9.3
Case Study: Continuous Time Stochastic
Logic . . . . . . . . . . . . . . . . . . . . . . . 576
4.9.4
Case Study: A Stochastic Interpretation of Game
Logic . . . . . . . . . . . . . . . . . . . . . . . 587

xx
CONTENTS
4.10 The Weak Topology . . . . . . . . . . . . . . . . . . . . 608
4.10.1 The Hutchinson Metric . . . . . . . . . . . . . . 616
4.10.2 Case Study: Eilenberg–Moore Algebras
for the Giry Monad . . . . . . . . . . . . . . . . 619
4.10.3 Case Study: Bisimulation
. . . . . . . . . . . . 622
4.10.4 Case Study: Quotients for Stochastic
Relations . . . . . . . . . . . . . . . . . . . . . 632
4.11 Lp-Spaces . . . . . . . . . . . . . . . . . . . . . . . . . 640
4.11.1 A Spoonful Hilbert Space Theory . . . . . . . . 641
4.11.2 The Lp-Spaces are Banach Spaces . . . . . . . . 647
4.11.3 The Lebesgue–Radon–Nikodym Theorem . . . . 653
4.11.4 Continuous Linear Functionals on Lp . . . . . . 661
4.11.5 Disintegration . . . . . . . . . . . . . . . . . . . 668
4.12 Bibliographic Notes . . . . . . . . . . . . . . . . . . . . 676
4.13 Exercises
. . . . . . . . . . . . . . . . . . . . . . . . . 677
List of Examples
685
Bibliography
697
Index
709

Chapter 1
The Axiom of Choice
and Some of Its
Equivalents
Sets are a universal tool for computer scientists, the tool which has
been imported as a lingua franca from mathematics. Program devel-
opment, for example, starts sometimes from a mathematical descrip-
tion of the things to be done, the speciﬁcation, and the data structures,
and—you guess it—sets are the language in which these ﬁrst designs
are usually written down. There is even a programming language called
SETL based on sets [SDDS86]; this language served as a prototyping
tool, its development having been essentially motivated by the ambi-
tion to shorten as much as possible the road from a formal descrip-
tion of an object to its representation through an executable program;
see [CFO89, COP01] and for practical issues [DF89].
In fact, it turned out that programming in what might be called exe-
cutable set theory has the advantage of having the capability to exper-
iment with the objects at hand, leading, for example, to the ﬁrst im-
plementation of the programming language Ada, the implementation
of which was deemed for quite some time as nearly impossible. On
the other hand it turned out that sets may be a feature nice to have in
a programming language, but that they are probably not always the ap-
propriate universal data structure for engineering program systems. This
© Springer International Publishing Switzerland 2015
E.-E. Doberkat, Special Topics in Mathematics for Computer
Scientists, DOI 10.1007/978-3-319-22750-4 1
1

2
CHAPTER 1. THE AXIOM OF CHOICE
is witnessed by the fact that some languages, like Haskell [OGS09],
have set-like constructs such as list comprehension, but they do not im-
plement sets fully. As the case may be, sets are important objects when
arguing about programs. They constitute an important component of
the tool kit which a serious computer scientist should have at her or his
disposal.
When surveying the computer science literature, we see that sets and
the corresponding constructs like maps, power sets, orders, etc., are be-
ing used freely, but there is usually no concern regarding the axiomatic
basis of these objects—sets are being used, albeit in a fairly naive way.
This should not be surprising, because they are just tools and often not
the objects of consideration themselves. A tool should be available to
a computer scientist whenever needed, but it really should not bring
with it complications of its own. However, fairly early in education, a
computer scientist encounters the phenomenon of recursion, be it as a
recursive function, be it as a recursive deﬁnition. And here immediately
arises the question as to why the corresponding constructs work and,
speciﬁcally, how one can be sure that a particular recursive program is
actually terminating. The same question, probably a little bit more fo-
cused, appears in techniques which are related to term rewriting. Here
one inquires whether a particular chain of replacements will actually
lead to a result in a ﬁnite amount of time. People in term rewriting have
found a way of writing this down, namely, a terminating condition which
is closely related to some well ordering. This means that we do not have
inﬁnitely long chains, which is of course a very similar condition to the
one that is encountered when talking about the termination of a recur-
sive procedure: Here we do not want to have inﬁnitely long chains of
procedure or method calls. This suggests structural similarities between
the termination of a recursive method and rewriting a term. If you think
about it, mathematical induction enters this family of observations, the
members of which show a considerable similarity.
When we investigate the background in which all this happens, we ﬁnd
that we need to look at well orderings. These are orderings which for-
bid the existence of inﬁnitely long decreasing chains. It turns out that
the mathematical ideas expressed here are fairly closely connected to
ordinal numbers. It is not difﬁcult to construct a bridge from orderings
and well orders to the question whether it is actually possible to ﬁnd a
well order for each and every set. The bridge a computer scientist might
traverse is loosely described as follows: Because we want to be able to

CHAPTER 1. THE AXIOM OF CHOICE
3
deal with arbitrary objects and because we want to run programs with
these arbitrary objects, it should be possible to construct terminating re-
cursive methods for those objects. But in order to do that, we should
make sure that no inﬁnite chains of method invocations occur, which in
turn poses the question whether or not we can impose an order on these
objects that renders inﬁnite chains impossible (admittedly somewhat in-
directly, because the order is imposed actually by procedure calls). But
here we are—we want to know whether such a construction is possible;
mathematically this leads to the possibility of well ordering each and
every set.
This question is of course fairly easy to answer when we talk about ﬁ-
nite scenarios, but sometimes it is mandatory to consider inﬁnite objects
as well. The world may be ﬁnite, but our models of the world are not
always so. Hence the question arises whether we can take an arbitrar-
ily large set and construct a well ordering for this set. As it turns out,
this question is very closely connected with another question, which at
ﬁrst glance does not look similar at all: We are given a collection of
nonempty sets; are we able to select from each set exactly one element?
This question has vexed mathematicians for more than a century now.
One of the interesting points, which indicates that things are probably a
little more complicated than they look, is the observation that the possi-
bility of well ordering an arbitrary set is equivalent to that of the question
of selection, which came to be known as the axiom of choice. It turned
out during the discussion in mathematics that there is a whole bag of
other properties that are equivalent to this axiom. We will see that the
axiom of choice is equivalent to some well-known proof principles like
Zorn’s Lemma or Tuckey’s Maximality Principle. Because this discus-
sion relating to the axiom of choice and similar constructions has been
raging in mathematics for more than a century now, we cannot hope to
be able to even completely list out all those things which we have to
leave out. Nevertheless, we try to touch upon some topics that appear
to be important for developing mathematical structures within computer
science.
Since the axiom of choice and its variants touch upon those topics in
mathematics that are much in use in computer science, this presents
us with the opportunity to select some of these and discuss them inde-
pendently and in light of the use of the axiom of choice. We discuss,
for example, lattices; introduce ideals and ﬁlters; and pose the maxi-
mality question: Is it always possible to extend a ﬁlter to a maximal

4
CHAPTER 1. THE AXIOM OF CHOICE
ﬁlter? It turns out that the answer is in the afﬁrmative, and this has some
interesting applications in the structure theory of, for example, Boolean
algebras. Because of this we are able to discuss one of the true classics
in this area, namely, Stone’s Representation Theorem, which says that
every Boolean algebra is isomorphic to an algebra of sets. Another in-
teresting application of Zorn’s Lemma is Alexander’s Theorem, which
shows that for establishing compactness of the space, one may restrict
one’s attention to covering a topological space with subbase elements.
Because we have then compactness at our disposal, we establish also
compactness of the space of all prime ideals of a Boolean algebra. Quite
apart from these questions, which are oriented toward order structures,
we establish the Hahn–Banach Theorem, which shows that a dominated
linear functional can be extended from a linear subspace to the entire
space in a dominated way.
A particular class of Boolean algebras are closed even under countable
inﬁma and suprema; these algebras are called -algebras. Since these al-
gebras are interesting, speciﬁcally when it comes to probabilistic models
in computer science, we treat these -algebras in some detail, in partic-
ular with respect to measures and their extensions. The general situation
in application is sometimes that one has the generator of a Boolean -
algebra and a set function which behaves decently on this generator, and
one wants to extend this set function to the whole -algebra. This gives
rise to a fairly rich and interesting construction, which in turn has some
connection with the question of the axiom of choice. The extension pro-
cess extends the measure far beyond the Boolean -algebra generated
by the family under consideration, and the question arises as to how far
this extension really goes. This may be of interest, e.g., if one wants
to measure some set, since one needs to know whether this set can be
measured at all, hence whether it is actually in the domain of the ex-
tended measure. The axiom of choice helps in demonstrating that this is
not always possible. It can be shown that there are sets which cannot be
measured. This depends on a selection argument for classes of an easily
constructed equivalence relation.
This will be discussed further in the chapter.
Then we turn to games, games as a model for human interaction, in
which two players, Angel and Demon, play against each other. We de-
scribe how a game is played and what are the strategies. In particular, we
say what constitutes winning strategies. This is done ﬁrst in the context

CHAPTER 1. THE AXIOM OF CHOICE
5
of inﬁnite sequences of natural numbers. The model has the advantage
of being fairly easy to grasp; it has the additional structural advantage
in that we can map many applications to this scenario.
Actually, games become really interesting when we know that one of the
participants has actually a chance to win. Hence, we postulate that our
games are of this kind, so that always either Angel or Demon has a strat-
egy to win the game. Unfortunately it turns out that this postulate, called
the axiom of determinacy, is in conﬂict with the axiom of choice. This
is of course a fairly unpleasant situation, because both axioms appear as
reasonable statements. So we have to see what can be done about this.
We show that if we assume the axiom of determinacy, we can actually
demonstrate that each and every subset of the real line is measurable.
This is in contradiction to the observation we just described.
This discussion serves two purposes. The ﬁrst one is that one some-
times wants to challenge the axiom of choice in favor of other postu-
lates, which may turn out to have more advantages (in the context of
games, the postulate that one of the players has a winning strategy, no
matter how the game is constructed, has certainly some advantageous
aspects). But the axiom of choice is, as we will see, quite a fundamental
postulate, so one has to ﬁnd a balance between both. This does look
terribly complicated, but on the other hand does not seem to be difﬁ-
cult to manage from a practical point of view—and computer scientists
are by deﬁnition practical people! The second reason for introducing
games and for elaborating on these results is to demonstrate that games
can actually be used as tools for proofs. These tools are used in some
branches of mathematics quite extensively, and it appears that this may
be an attractive choice for computer scientists as well.
We work usually in what is called naive set theory, in which sets are
used as a formal manner of speaking without much thinking about it.
Sets are just tools to formally express ideas.
When mathematicians and logicians like G. Frege, G. Cantor, or B. Rus-
sell thought about the basic foundations of mathematics, they found a
huge pile of unposed and unanswered questions about the basic build-
ing blocks of mathematics, e.g., the deﬁnition of a cardinal number was

6
CHAPTER 1. THE AXIOM OF CHOICE
usually taken for granted, without a formal foundation; a foundation was
even resisted or ridiculed.1
The Axioms of ZFC.
Nevertheless, at around the turn of the century,
there seems to have been some consensus among mathematicians that
the following axioms are helpful for their work; they are called the
Zermelo–Fraenkel System With Choice (ZFC) after E. Zermelo and A.A.
Fraenkel.
We will discuss them brieﬂy and informally now. Here they are.
Extensionality Two sets are equal iff they contain the same elements.
This requires that sets exist and that we know which elements are
contained in them; usually these notions (set, element) are taken
for granted.
Empty set axiom There is a set with no elements. This is of course the
empty set, denoted by ;.
Axiom of pairs For any two sets, there exists a set whose elements are
precisely these sets. From the extensionality axiom, we conclude
that this set is uniquely determined. Without the axiom of pairs, it
would be difﬁcult to construct maps. Hence we can construct sets
like fa; bg and singleton sets fag (because the axiom does not talk
about different elements, so we can form the set fa; ag, which,
by the axiom of extensionality, equals the set fag). We can also
deﬁne an ordered pair through ha; bi WD ffag; fa; bgg.
Axiom of separation Let ' be a statement of the formal language with
a free variable ´. For any set x, there is a set containing all ´ in x
for which '.´/ holds. This permits forming sets by describing the
properties of their elements. Note the restriction “for any set x”;
suppose we drop this and postulate “There is a set containing all ´
for which '.´/ holds.” Let '.´/ be the statement ´ 62 ´, then we
would have postulated the existence of the set a WD f´ j ´ 62 ´g
(is a 2 a?). Hence we have to be a bit more modest.
1Frege’s position, for example, was considered in the polemic by J.K. Thomae,
“Gedankenlose Denker, eine Ferienplauderei” (Thinkers without a thought, a causerie
for the vacations). Jahresber. Deut. Math.Ver. 15, 1906, 434–438 as somewhat hare-
brained; see Thiel’s treatise [Thi65].

CHAPTER 1. THE AXIOM OF CHOICE
7
Power set axiom For any set x, there exists a set consisting of all sub-
sets of x. This set is called the power set of x and denoted by
P .x/. Of course, we have to deﬁne the notion of a subset, before
we can determine all subsets of a set x. A set u is called a subset
of set x (in symbols u  x) iff every element of u is an element
of x.
Union axiom For any set there is a set which is the union of all elements
of x. This set is denoted by S x. If x contains only a handful of
elements like x D fa; b; cg, we write S x as a[b[c. The notion
of a union is not yet deﬁned, although intuitively clear. We could
rewrite this axiom by stating it as given a set x, there exists a set y
such that w 2 y iff there exists a set a with a 2 x and w 2 a. The
intersection of two sets a and b can then be deﬁned through the
axiom of separation with the predicate '.´/ WD ´ 2 a and ´ 2 b,
so that we obtain a \ b WD f´ 2 a [ b j ´ 2 a and ´ 2 bg:
This is the ﬁrst group of axioms which are somewhat intuitive. It is pos-
sible to build from it many mathematical notions (like maps with their
domains and ranges, ﬁnite Cartesian products). But it turns out that they
are not yet sufﬁcient, so an extension to them is needed.
Axiom of inﬁnity There is an inductive set. This means that there ex-
ists a set x with the property that ; 2 x and that y [ fyg 2 x
whenever y 2 x. Apparently, this permits building inﬁnite sets.
Axiom of replacement Let ' be a formula with two arguments. If for
every a there exists exactly one b such that '.a; b/ holds, then
for each set x there exists a set y which contains exactly those
elements b for which '.a; b/ holds for some a 2 x.
Intuitively,
if we can ﬁnd for formula ' for each a 2 x exactly an element b
such that '.a; b/ is true, then we can collect all these elements b
in a set. Let ' be the formula '.x; y/ iff x is a set and y D P .x/;
then there exists for a given family x of sets the set of all power
sets P .a/ with a 2 x.
Axiom of foundation
Every set contains a 2-minimal element. Sets
contain other sets as elements, as we have seen, so there might be
the danger that a situation like a 2 b 2 c 2 a occurs, hence there
is a 2-cycle. In some situations this might be desirable, but not
in this very basic scenario, where we try to ﬁnd a ﬁxed ground to
work on. A formal description of this axiom reads that for each

8
CHAPTER 1. THE AXIOM OF CHOICE
set x there exists a set y such that y 2 x and x \ y D ;. We will
have to deal with a very similar property when discussing ordinal
numbers in Sect. 1.4.
Now we have recorded some axioms which provide the basis of our
daily work, to be used without any qualms. They permit building up
mathematical structures like relations, maps, injectivity, surjectivity, and
so on. We will not do this here (it gets somewhat boring after a time
if one is not seeing some special effect—then it may become awfully
hard), and trust that the reader is familiar with these structures.
But there still is a catch: Look at the argumentation in the following
proposition which constructs some sort of an inverse for a surjective
map.
Proposition 1.0.1 There exists for each surjective map f W A ! B a
function g W B ! A such that .f ı g/.b/ D b for all b 2 B.
Proof For each b 2 B, the set f 1
fbg

is not empty, because f is sur-
jective. Thus we can pick for each b 2 B an element g.b/ 2 f 1
fbg

.
Then g W B ! A is a map, and f .g.b// D b by construction. a
a is end of
proof.
WHERE IS THE CATCH? The proof seems to be perfectly innocent and
straightforward. We simply have a look at all the inverse images of
elements of the image set B, and all these inverse images are not empty,
so we pick from each of these inverse images exactly one element and
construct a map from this.
Well, the catch lies in picking an element from each member of this col-
lection. The collection of axioms above says nowhere that this selection
is permitted (now you might think that mathematicians ﬁnd a sneaky
way of permitting such a pick, through the back door, so to speak; trust
me—they cannot!).
Hence we need some additional device, and this is the axiom of choice.
It will be discussed at length now; we take the opportunity to use this
discussion as a kind of a peg onto which we hang some other objects as
well. The general approach will be that we will discuss mathematical
objects of interest, and at a crucial point the discussion of .AC/ and its
equivalents will be continued (if you ever listened to a Wagner opera,
you will have encountered his leitmotifs).

1.1. THE AXIOM OF CHOICE
9
1.1
The Axiom of Choice
The axiom of choice states that
.AC/ Given a family F of non-empty
subsets of some set X, there exists a
function f W F ! X such that f .F / 2 F
for all F 2 F.
The function, the existence of which is postulated by this axiom, is
called a choice function on F.
It is at this point not quite clear why mathematicians make such a fuss
about .AC/:
W. Sierpinski It is the great and ancient problem of existence that un-
derlies the whole controversy about the axiom of choice.
P. Maddy The axiom of choice has easily the most tortured history of
all set-theoretic axioms.
T. Jech There has been some controversy about the axiom of choice,
indeed.
H. Herrlich AC, the axiom of choice, because of its nonconstructive
character, is the most controversial mathematical axiom, shunned
by some, and used indiscriminately by others
(see [Her06]). In fact, let X D N, the set of natural numbers. If F is a
set of nonempty subsets of N, a choice function is immediate—just let
f .F / WD min F . So why bother? We will see below that N is a special
case. B. Russell gave an interesting illustration: Suppose that you have
an inﬁnite set of pairs of shoes, and you are to select systematically one
shoe from each pair. You can always take either the left or the right one.
But now try the same with an inﬁnite set of pairs of socks, where the left
sock cannot be told from the right one. Then you have to have a choice
function.
But we do not have to turn to socks in order to see that a choice function
is helpful; we rather prove Proposition 1.0.1 again.
Proof (of Proposition 1.0.1)
Deﬁne
F WD ff 1
fbg

j b 2 BgI

10
CHAPTER 1. THE AXIOM OF CHOICE
then F is a collection of nonempty subsets of A, since f is onto. By
assumption there exists a choice function G W F ! A on F. Put
g.b/ WD G.f 1
fbg

/, then f .g.b// D b. a
So this is a pure, simple, and direct application of .AC/, making one
wonder what application the existence of a choice function will ﬁnd.
We will see.
1.2
Cantor’s Enumeration of N  N
We will deal in this section with the comparison of sets with respect to
their size. We say that two sets A and B have the same cardinality iff
there exists a bijection between them. This condition can sometimes be
relaxed by saying that there exists an injective map f W A ! B and
an injective map g W B ! A. Intuitively, A and B have the same size,
since the image of each set is contained in the other one. So we would
expect that there exists a bijection between A and B. This is what the
famous Schr¨oder–Bernstein Theorem says.
Theorem 1.2.1 Let f W A ! B and g W B ! A be injective maps.
Schr¨oder-
Bernstein
Theorem
Then there exists a bijection h W A ! B.
Proof Deﬁne recursively
A0 WD A n g

B

;
AnC1 WD g

f

An

and
Bn WD f

An

:
If a 2 A with a 62 A0, there exists a unique b DW g.a/ such that
a D g.b/, because g is an injection. Now deﬁne the map h W A ! B
through
h.a/ WD
(
f .a/;
if a 2 S
n0 An
g.a/;
otherwise:
Assume that h.a/ D h.a0/. If a; a0 2 S
n0 An, we may conclude that
a D a0, since f is one to one. If a 2 An for some n and a0 62 S
n0 An,
then h.a/ D f .a/; h.a0/ D g.a0/; hence a0 D g.h.a0// D g.h.a// D
g.f .a//: This implies a 2 AnC1; contrary to our assumption. Hence
h is an injection. If b 2 S
n0 Bn, then b D f .a/ D h.a/: Now let

1.2. CANTOR’S ENUMERATION OF N  N
11
b … S
n0 Bn. We claim that g.b/ 62 An for any n  0. In fact,
if g.b/ 2 An with n > 0, we know that g.b/ D g.f .a// for some
a 2 An1, so b D f .a/ 2 f

An1

, contrary to our assumption.
Hence h.g.b// D g.g.b// D b. Thus h is also onto. a
Another proof will be suggested in Exercise 1.7 through a ﬁxed point
argument.
This is a ﬁrst application of the Schr¨oder–Bernstein Theorem.
Example 1.2.2 Let X D N. If there exists an injection P .N/ ! N,
then the Schr¨oder–Bernstein Theorem implies that there exists a bijec-
tion f W N ! P .N/, because we have the injective map N 3 x 7!
fxg 2 P .N/. Now look at A WD fx 2 N j x 62 f .x/g. Then there exists
a 2 N with A D f .a/. But a 2 A iff a 62 A, and thus there cannot exist
an injection P .N/ ! N. ✌
✌is end of
example.
Call a set A countably inﬁnite iff there exists a bijection A ! N. By the
Schr¨oder–Bernstein Theorem 1.2.1, it then sufﬁces to ﬁnd an injective
map A ! N and an injective map N ! A. A set is called countable iff
it is either ﬁnite or countably inﬁnite. Example 1.2.2 tells us that P .N/
is not countable.
We will have a closer look at countably inﬁnite sets now and show that
the set of all ﬁnite sequences of natural numbers is countable; for sim-
plicity, we work with N0 WD N [ f0g.
N0
We start with showing that there exists a bijection from the Cartesian
product N0N0 ! N0. Cantor’s celebrated procedure for producing an
enumeration for N0  N0 works for an initial section as follows:
Deﬁne the function
J.x; y/ WD
 
x C y C 1
2
!
C xI

12
CHAPTER 1. THE AXIOM OF CHOICE
then an easy computation shows that this yields just the enumeration
scheme of Cantor’s procedure. We will have a closer look at J now;
note that the function x 7!
x
2

increases monotonically.
Proposition 1.2.3 J W N0  N0 ! N0 is a bijection.
Proof 1. J is injective. We show ﬁrst that J.a; b/ D J.x; y/ implies
a D x. Assume that x > a; then x can be written as x D a C r for
some positive r, so
 
a C r C y C 1
2
!
C r D
 
a C b C 1
2
!
I
hence b > r C y, so that b can be written as b D r C y C s with some
positive s. Abbreviating c WD a C r C y C 1, we obtain
 
c
2
!
C r D
 
c C s
2
!
:
But because we have r < c, we get
 
c
2
!
C r <
 
c
2
!
C c D
 
c C 1
2
!

 
c C s
2
!
:
This is a contradiction. Hence x  a. Interchanging the rˆoles of x and
a, one obtains a  x, so that x D a may be inferred.
Thus we obtain
 
a C y C 1
2
!
D
 
a C b C 1
2
!
:
This yields the quadratic equation
y2 C 2ay  .b2 C 2ab/ D 0
which has the solutions b and .2a C b/. If a D b D 0, then y D
0 D b, if b > 0; the only nonnegative solution is b, so that y D b
also in this case. Hence we have shown that J.a; b/ D J.x; y/ implies
ha; bi D hx; yi.
2. J is onto. Deﬁne Z WD J

N0  N0

, then 0 D J.0; 0/ 2 Z and
1 D J.0; 1/ 2 Z. Assume that n 2 Z, so that n D J.x; y/ for some
hx; yi 2 N0. We consider these cases
y > 0 W nC1 D J.x; y/C1 D
xCyC1
2

CxC1 D J.xC1; y1/ 2 Z.

1.2. CANTOR’S ENUMERATION OF N  N
13
y D 0 W n D
x
2

C x D
xC1
2

, and thus n C 1 D
xC1
2

C 1.
x > 0 W nC1 D
xC1
2

C1 D
1C.x1/C1
2

C1 D J.1; x1/ 2 Z.
x D 0 W Then n D 0, so that n C 1 D J.0; 1/ 2 Z.
Thus we have shown that 0 2 Z and that n 2 Z implies n C 1 2 Z,
from which we infer Z D N0. a
This construction permits the construction of an enumeration for the set
of all nonempty sequences of elements of N0. First we have a look at
sequences of ﬁxed length. For this, deﬁne inductively
t1.x/ WD x;
tkC1.x1; : : : ; xk; xkC1/ WD J.tk.x1; : : : ; xk/; xkC1/
(x 2 N0 and k 2 N, hx1; : : : ; xkC1i 2 NkC1
0
), the idea being that
Idea
an enumeration of Nk  N is reduced to an enumeration of N  N, an
enumeration of which in turn is known.
Proposition 1.2.4 The maps tk are bijections Nk
0 ! N0.
Proof 1. The proof proceeds by induction on k. It is trivial for k D
0. Now assume that we have established bijectivity for tk W Nk
0 !
N0.
2.tkC1 is injective:
Assume tkC1.x1; : : : ; xk; xkC1/DtkC1.x0
1; : : : ;
x0
k; x0
kC1/; this means
J.tk.x1; : : : ; xk/; xkC1/ D J.tk.x0
1; : : : ; x0
k/; x0
kC1/;
and hence tk.x1; : : : ; xk/ D tk.x0
1; : : : ; x0
k/ and xkC1 D x0
kC1 by Propo-
sition 1.2.3. By induction hypothesis, hx1; : : : ; xki D hx0
1; : : : ; x0
ki.
3.tkC1 is onto: Given n 2 N0, there exists ha; bi 2 N0  N0 with
J.a; b/ D n. Given a 2 N0, there exists hx1; : : : ; xki 2 Nk
0 with
tk.x1; : : : ; xk/ D a by induction hypothesis, so
n D J.a; b/ D J.tk.x1; : : : ; xk/; b/ D tkC1.x1; : : : ; xk; b/:
a

14
CHAPTER 1. THE AXIOM OF CHOICE
From this, we can manufacture a bijection
[
k2N
Nk
0 ! N0
in the following way. Given a ﬁnite sequence v of natural numbers, we
use its length, say, k, as one parameter of an enumeration of N  N,
and the other parameter for this enumeration is tk.v/. This yields a
bijection.
Proposition 1.2.5 There exists a bijection s W S
k2N Nk
0 ! N0.
Proof Deﬁne
s.x1; : : : ; xk/ WD J.k; tk.x1; : : : ; xk//
for k 2 N and hx1; : : : ; xki 2 Nk
0. Because both J and tk are injective, s
is injective. Given n 2 N0, we can ﬁnd ha; bi 2 N0N0 with J.a; b/ D
n. Given b 2 N0, we can ﬁnd hx1; : : : ; xai 2 Na
0 with ta.x1; : : : ; xa/ D
b, so that
n D J.a; b/ D J.a; ta.x1; : : : ; xa//:
Hence s is also surjective. a
One wonders why we did go through this somewhat elaborate construc-
tion.
First, the construction is elegant in its simplicity, but there is
another, more subtle reason. When tracing the arguments leading to
Proposition 1.2.5, one sees that the argumentation is elementary; it does
not require any set-theoretic assumptions like .AC/. But now look at
this:
Proposition 1.2.6 Let fAn j n 2 N0g be a sequence of countably inﬁ-
nite sets. Then .AC/ implies that S
n2N0 An is countable.
Proof We assume for simplicity that the An are mutually disjoint. Given
n 2 N0, there exists an enumeration  n W An ! N0. .AC/ permits us
to ﬁx for each n such an enumeration  n; then deﬁne
 W
( S
n2N0 An
! N0
x
7! J.k;  k.x//; if x 2 Ak
with J as the bijection deﬁned in Proposition 1.2.3. a

1.3. WELL-ORDERED SETS
15
This is somewhat puzzling at ﬁrst; but note that the proof of Proposi-
tion 1.2.5 does not require a selection argument, because we are in a
position to construct tk for all k 2 N.
Having .AC/, hence Proposition 1.2.6 at our disposal, one shows by
induction that
NkC1
0
D
[
n2N0
Nk
0  fng
is countable for every k 2 N.
This establishes the countability of
S
k2N Nk
0 immediately. On the other hand it can be shown that Proposi-
tion 1.2.6 is not valid if .AC/ is not assumed [KM76, p. 172] or [Her06,
Sect. 3.1]. This is also true if .AC/ is weakened somewhat to postulate
the existence of a choice function for countable families of nonempty
sets (which in our case would sufﬁce). The proof of nonvalidity, how-
ever, is in either case far beyond our scope.
1.3
Well-Ordered Sets
A relation R on a set M is called an order relation iff it is reﬂexive (thus
xRx holds for all x 2 M), antisymmetric (this means that xRy and
yRx imply x D y for all x; y 2 M), and transitive (hence xRy and
yR´ imply xR´ for all x; y; ´ 2 M). The relation R is called linear iff
one of the cases x D y, xRy, or yRx applies for all x; y 2 M, and it is
called strict iff xRx is false for each x 2 M. If R is strict and transitive,
then it is called a strict order.
Let R be an order relation; then x 2 M is called a lower bound for
; 6D A  M iff xR´ holds for all ´ 2 M and a smallest element
for A iff it is both a lower bound for A and a member of A. Upper
bounds and largest elements are deﬁned similarly.
An element y is
called maximal iff there exists no element x with yRx; minimal ele-
ments are deﬁned similarly. A minimal upper bound for a set A 6D
; is called the supremum of A and is denoted by sup A; similarly, a
maximal lower bound for A is called the inﬁmum of A and is denoted
by inf A. Neither inﬁmum nor supremum of a nonempty set needs to
sup; inf
exist.

16
CHAPTER 1. THE AXIOM OF CHOICE
Example 1.3.1 Look at this ordered set:
Here A is the maximum, because
every element is smaller than A;
the minimal elements are D, E,
and F , but there is no minimum.
The minimal elements cannot be
compared to each other.
✌
Example 1.3.2 Deﬁne a d b iff a divides b for a; b 2 N; thus a d b
iff there exists k 2 N such that b D k  a. Let g be the greatest common
divisor of a and b, then g D inffa; bg, and if s is the smallest common
multiple of a and b, then s D supfa; bg. Here is why: One notes ﬁrst
that both g d a and g d b hold, because g is a common divisor of
a and b. Let g0 be another common divisor of a and b, and then one
shows easily that g0 divides g, so that g0 d g holds. Thus g is in
fact the greatest common divisor. One argues similarly for the lowest
common multiple of a and b. ✌
Example 1.3.3 Order S WD P .N/ n fNg by inclusion. Then N n fkg is
maximal in S for every k 2 N. We obtain from the deﬁnition of S and
its order that each element which contains N n fkg properly would be
outside the basic set S. The set A WD ffn; nC2g j n 2 Ng is unbounded
in S. Assume that T is an upper bound for A; then n 2 fn; n C 2g  T
and for each n 2 N, so that T D N 62 S. ✌
Usually strict orders are written as < (or <M, if the basis set is to be
emphasized) and order relations as  or M, resp.
Let <M be a strict order on M and <N be a strict order on N ; then a
map f W M ! N is called increasing iff x <M y implies f .x/ <N
f .y/; M and N are called similar iff f is a bijection such that x <M y
is equivalent to f .x/ <N f .y/. An order isomorphism is a bijection
which together with its inverse is increasing.
Deﬁnition 1.3.4 The strict linear order < on a set M is called a well
ordering on M iff each nonempty subset of M has a smallest element.
M is then called well ordered (under <).
These are simple examples of well-ordered sets.

1.3. WELL-ORDERED SETS
17
Example 1.3.5 N (this shows the special rˆole of N alluded to above),
ﬁnite linearly ordered sets, and f1  1
n j n 2 Ng are well ordered. ✌
Not every ordered set, however, is well ordered, witnessed by these sim-
ple examples.
Example 1.3.6 Z is not well ordered, because it does not have a mini-
mal element. R is neither, because, e.g., the open interval 0; 1Œ does not
have a smallest element. The power set of N, denoted by P .N/, is not
well ordered by inclusion because a well order is linear, and f1; 2g and
f3; 4g are not comparable. Finally, f1 C 1
n j n 2 Ng is not well ordered,
because the set does not contain a smallest element. ✌
Example 1.3.7 A reduction system R D .A; !/ is a set A with a re-
lation !  A  A; the intent is to have a set of rewrite rules, say,
ha; bi 2 ! such that a may be replaced by b in words over an alpha-
bet which includes the carrier A of R. Usually, one writes a ! b iff
ha; bi 2 !. Denote by
C
! the reﬂexive-transitive closure of relation !,
i.e., x
C
! y iff x D y or there exists a chain x D a0 ! : : : ! ak D y.
We call R terminating iff there are no inﬁnite chains a0 ! a1 ! : : : !
ak ! : : :. The following proof rule is associated with a reduction sys-
tem:
.WFI/ 8x 2 A W

8y 2 A W x
C
! y ) P.y/

) P.x/
8x 2 A W P.x/:
Here P is a predicate on A so that P.x/ is true iff x has property P . The
rule (WFI) says that if we can conclude for every x that P.x/ holds, pro-
vided the property holds for all predecessors of x, then we may conclude
that P holds for each element of A.
This rule is equivalent to termination. In fact
 If ! terminates, then (WFI) holds. Assume that (WFI) does not
hold, then we ﬁnd x0 2 A such that P.x0/ does not hold, hence
we can ﬁnd some x1 with x0
C
! x1 and P.x1/ does not hold.
For x1 we ﬁnd x2 for which P does not hold with x1
C
! x2,
etc. Hence we construct an inﬁnite chain x0
C
! x1
C
! : : : of
elements for which P does not hold. But this means that ! does
not terminate.

18
CHAPTER 1. THE AXIOM OF CHOICE
 If (WFI) holds, then ! terminates. Take the predicate P.x/ iff
there is no inﬁnite chain starting from x. Now (WFI) says that if
y
C
! x, and if P.y/ holds, then P.x/ holds. This means that no
inﬁnite chain starts from y, and x is a successor to y, and so no
inﬁnite chain starts from x either. Hence, to conclude this rule,
no x is the starting point of an inﬁnite chain; consequently !
terminates.
Now let .A; !/ be a terminating reduction system; then each nonempty
subset B  A has a minimal element, because if this is not the case, we
can construct an inﬁnite descending chain. But .A; !/ is usually not
well ordered, because
C
! is not necessarily strict. ✌
There are some helpful ways of producing a new well order from old
ones.
Example 1.3.8 Let M and N be well-ordered and disjoint sets, deﬁne
on M [ N
a < b iff
8
ˆ<
ˆ:
a <M b;
if a; b 2 M;
a <N b;
if a; b 2 N;
a 2 M; b 2 N;
otherwise:
Then M [ N is well ordered; this well-ordered set is usually denoted
by M C N . Note that M C N is not the same as N C M.
If the sets are not disjoint, make a copy of each upon setting M 0 WD
M f1g; N 0 WD N f2g, and order these sets through, e.g., hm; 1i <M 0
hm0; 1i iff m <M m0: ✌
Example 1.3.9 Deﬁne on the Cartesian product M  N
hm; ni < hm0; n0i iff
(
m < m0
n < n0;
if m D m0:
This lexicographic order yields a well ordering again. ✌
Example 1.3.10 Let Z be well ordered, and assume that for each ´ 2
Z the set M´ is well ordered so that the sets .M´/´2Z are mutually
disjoint. Then S
´2Z M´ is well ordered. ✌
Having a look at .AC/ again, we see that it holds in a well-ordered
set.

1.3. WELL-ORDERED SETS
19
Proposition 1.3.11 Let F be a family of nonempty subsets of the well-
ordered set M. Then there exists a choice function on F.
Proof For each F 2 F, there exists a smallest element mF 2 F. Put
f .F / WD mF ; then f W F ! M is a choice function on F. a
Thus, if we can ﬁnd a well order on a set, then we know that we can ﬁnd
choice functions. We formulate ﬁrst this property.
.WO/ Each set can be well ordered.
We will refer to this property as .WO/. Hence we can rephrase Propo-
sition 1.3.11 as
.WO/ H) .AC/:
Establishing the converse will turn out to be more interesting, since it
will require the introduction of a new class of objects, viz., the ordinal
numbers. This is what we will undertake in the next section.
We start with some preparations which deal with properties of well or-
ders.
Lemma 1.3.12 Let M be well ordered and f W M ! M be an increas-
ing map. Then x  f .x/ (thus x < f .x/ or x D f .x/) holds for all
x 2 M.
Proof Suppose that the set Y WD fy 2 M j f .y/ < yg is not empty;
then it has a smallest element ´. Since f .´/ < ´, we obtain f .f .´// <
f .´/ < ´, because f is increasing. This contradicts the choice of ´.
a
Let M be well ordered; then deﬁne for x 2 M the initial segment O.x/
(or OM.x/) for x as O.x/ WD f´ 2 M j ´ < xg:
O.x/; OM.x/
We obtain as a consequence
Corollary 1.3.13 No well-ordered set is order isomorphic to an initial
segment of itself.
Proof An isomorphism f W M ! OM.x/ for some x 2 M would have
f .x/ < x, which contradicts Lemma 1.3.12. a
A surprising consequence of Lemma 1.3.12 is that there exists at most
one isomorphism between well-ordered sets.

20
CHAPTER 1. THE AXIOM OF CHOICE
Corollary 1.3.14 Let A and B be well-ordered sets. If f W A ! B and
g W A ! B are order isomorphisms, then f D g.
Proof Clearly both g1 ı f and f 1 ı g are increasing, yielding x 
.g1 ı f /.x/ and x  .f 1 ı g/.x/ for each x 2 A, which means
g.x/  f .x/ and f .x/  g.x/ for each x 2 A. a
This is an important property of well-ordered sets akin to induction in
the set of natural numbers. Accordingly it is called the principle of
transﬁnite induction, sometimes also called Noetherian induction (after
the eminent German mathematician Emmy Noether) or well-founded
induction (after the virtually unknown Chinese mathematician WNel FLun
D`ed).
Theorem 1.3.15 Let M be well ordered and B  M be a set which
has for each x 2 M the property that O.x/  B implies x 2 B. Then
B D M.
Proof Assume that M nB 6D ;; then there exists a smallest element x in
this set. Since x is minimal, all elements smaller than x are elements of
B; hence O.x/  B. But this implies x 2 B, a contradiction. a
Let us have a second look at a proof of Lemma 1.3.12, this time using
the principle of transﬁnite induction. Put B WD f´ 2 M j ´  f .´/g;
and assume O.x/  B. If y 2 B with y 6D f .y/, then y < f .y/ and
y < x, so that f .y/ < f .x/, and thus y < f .x/. Hence f .x/ is larger
than any element of O.x/, and thus f .x/ 2 M n O.x/. But x is the
smallest element of the latter set, which implies x < f .x/, so x 2 B.
From Theorem 1.3.15, we see now that B D M.
We will show now that each set can be well ordered. In order to do this,
we construct a prototypical well order and show that each set can be
mapped bijectively to this set. This then will serve as the basis for the
construction of a well order for this set.
Carrying out this program requires the prototype. This will be consid-
ered next.

1.4. ORDINAL NUMBERS
21
1.4
Ordinal Numbers
Following von Neumann [KM76, VII.9], ordinal numbers are deﬁned
as sets with these special properties.
Deﬁnition 1.4.1 A set ˛ is called an ordinal number iff these conditions
are satisﬁed:
①Every element of ˛ is a set.
②If ˇ 2 ˛, then ˇ  ˛.
③If ˇ;  2 ˛, then ˇ D  or ˇ 2  or  2 ˇ.
④If ; 6D B  ˛, then there exists  2 B with  \ B D ;.
Hence in order to show that a given set is an ordinal, we have to show
Obligation
that the properties ①, ②, ③, and ④hold. We will demonstrate this prin-
ciple for some examples.
Example 1.4.2 Consider this deﬁnition of the somewhat natural num-
bers N0
0 WD ;;
n C 1 WD f0; : : : ; ng;
N0 WD f0; 1; : : :g:
Then N0 is an ordinal number. Each element of N0 is a set by deﬁnition.
Let ˇ 2 N0. If ˇ D 0, ˇ D ;  N0, and if ˇ 6D 0, ˇ D n D
f0; : : : ; n  1g  N0. One argues similarly for property ③. Finally, let
; 6D ˇ  N0, and let  be the smallest element of ˇ. If ı 2  \ ˇ, then
ı is both an element of ˇ and smaller than , and this is a contradiction.
Hence  \ ı D ;. ✌
Example 1.4.3 Let ˛ be an ordinal number, and then ˇ WD ˛ [ f˛g is
an ordinal. It is the smallest ordinal which is greater than ˛. Property ①
is evident, so is property ②. Let ; 0 2 ˇ with  6D 0, and assume that
 D ˛, then 0 6D ˛, and consequently 0 2 . If neither  nor 0 is
equal to ˛, property ③trivially holds. Assume ﬁnally that ; 6D B  ˇ.
If B \ ˛ 6D ;, property ④for ˇ follows from this property for ˛; if,
however, B D f˛g, observe that ˛ 2 ˇ with B \ ˛ D ;. Hence this
property holds for ˇ as well. ✌

22
CHAPTER 1. THE AXIOM OF CHOICE
Deﬁnition 1.4.4 Let ˛ be an ordinal, and then ˛ [ f˛g is called the
successor to ˛ denoted by ˛ C 1.
˛ C 1
It is clear from this deﬁnition that no ordinal can be squeezed in between
an ordinal ˛ and its successor ˛ C 1.
Lemma 1.4.5 If M is a nonempty set of ordinals, then
1. ˛ WD T M is an ordinal; it is the largest ordinal contained in
all elements of M.
2. ˛ WD S M is an ordinal; it is the smallest ordinal which con-
tains all elements of M.
Proof We iterate over the deﬁning properties of an ordinal number for
T M. Since every element  of T M is also an element of every ˛ 2
M, we may conclude that  is a set and that   T M. If ; ı 2
T M  ˛ for each ˛ 2 M, we have either  D ı,  2 ı or ı 2 .
Finally, if ; 6D B  T M  ˛ for each ˛ 2 M, we ﬁnd  2 B such
that  \ B D ;. Thus ˛ WD T M has all the properties of an ordinal
number from Deﬁnition 1.4.1. It is clear that ˛ is the largest ordinal
contained in all elements of M.
The proof for S M works along the same lines. a
Corollary 1.4.6 Given a nonempty set M of ordinals, there is always
an ordinal which is strictly larger than all the elements of M.
Proof If ˛ WD S M 2 M, then ˛C1 is the desired ordinal; otherwise
˛ is suitable. a
This is an interesting consequence.
Corollary 1.4.7 There is no set of all ordinals.
Proof If Z is the set of all ordinals, then Lemma 1.4.5 shows that ˛ WD
S Z is an ordinal. But the successor ˛ C 1 to ˛ is an ordinal as well
by Example 1.4.3, which, however, is not an element of Z. This is a
contradiction. a
Deﬁnition 1.4.8 An ordinal  is called a limit ordinal iff ˛ <  implies
˛ C 1 <  for all ordinals ˛.
Limit ordinal
Thus a limit ordinal is not reachable through the successor operation.
This is a convenient characterization of limit ordinals.

1.4. ORDINAL NUMBERS
23
Proposition 1.4.9 Let  be an ordinal. Then
1. If  is a limit ordinal, then S  D .
2. If S  D , then  is a limit ordinal.
Proof 1. Assume ﬁrst that  is a limit ordinal. Let ˇ 2 S , and then
ˇ 2 ˛ for some ˛ 2 . Since ˛ is an ordinal, we conclude ˇ 2 ˛  ,
so S   . On the other hand, if ˛ 2 , then ˛ C 1 2 , since  is a
limit ordinal. Thus ˛ 2 S , so S  	 . This proves part 1.
2. Let ˛ <  D S , and then ˛ 2 ˇ for some ˇ 2 . Then either
˛ C 1 2 ˇ or ˛ C 1 D ˇ, in any case ˛ C 1  ˇ, so that ˛ C 1 2 .
Thus  is a limit ordinal. This establishes part 2. a
Ordinals can be odd or even: A limit ordinal is said to be even; if the
Odd, even
ordinal 	 can be written as 	 D 
 C 1 and 
 is even, then 	 is odd,
and if 
 is odd, 	 is even. This classiﬁcation is sometimes helpful, and
some constructions involving ordinals depend on it; see, for example,
Sect. 1.6.1 on page 69.
Several properties of ordinal numbers are established now; this is re-
quired for carrying out the program sketched above. The ﬁrst property
states that the 2-relation is not cyclic, which seems to be trivial. But
since ordinal numbers have the dual face of being elements and subsets
of the same set, we will need to exclude this property explicitly by show-
ing that the properties of ordinals prevent this undesired behavior.
Lemma 1.4.10 If ˛ is an ordinal number, then there does not exist a
sequence ˇ1; : : : ; ˇk of sets with ˇk 2 ˇ1 2 : : : ˇk1 2 ˇk 2 ˛:
Proof If there exist such sets ˇ1; : : : ; ˇk, put  WD fˇ1; : : : ; ˇkgI then
 is the smallest ordinal containing ˇ1; : : : ; ˇk. Now ˇk 2 ˛ implies
ˇk  ˛, thus ˇk1 2 ˛, and hence ˇk1  ˛, so that ˇ1; : : : ; ˇk 2 ˛.
But now ˇi1 2 ˇi \  for 2  i  k and ˇk 2 ˇ1 \ , so that
property ④in Deﬁnition 1.4.1 is violated. Hence  is not an ordinal at
all. a
Lemma 1.4.11 If ˛ is an ordinal, then each ˇ 2 ˛ is an ordinal as well.
Proof 1. The properties of ordinal numbers from Deﬁnition 1.4.1 are
inherited. This is immediate for properties ①, ③, and ④, so we have to
take care of property ②.

24
CHAPTER 1. THE AXIOM OF CHOICE
2. Let  2 ˇ, and we have to show that   ˇ. So if  2 , we have by
property ③for ˛ in the deﬁnition of ordinals either  D  (which would
imply  2  2 ˇ 2 ˛, contradicting Lemma 1.4.10) or  2  (which
would yield  2  2  2 ˇ 2 ˛, contradicting Lemma 1.4.10 again).
Thus  2 ˇ, so that property ②also holds. a
Lemma 1.4.12 Let ˛ and ˇ be ordinals, and then these properties are
equivalent:
1. ˛ 2 ˇ.
2. ˛  ˇ and ˛ 6D ˇ.
Proof 1 ) 2: We obtain ˛  ˇ from ˛ 2 ˇ and from property ②
and ˛ 6D ˇ from Lemma 1.4.10, for otherwise we could conclude ˇ 2
ˇ.
2 ) 1: Because ˛ is a proper subset of ˇ, thus ; 6D ˇ n ˛  ˇ, and
we infer from property ④for ordinals that we can ﬁnd  2 ˇ n ˛ such
that  \ ˇ n ˛ D ;. We claim that  D ˛.
“”: Since  2 ˇ, we know that   ˇ, and since  \ ˇ n ˛ D ;, it
follows   ˛.
“	”: We will show that the assumption ˛ n  6D ; is contradictory.
Because ; 6D ˛ n   ˛, we ﬁnd  2 ˛ n  with  \ ˛ n  D
;. Because  2 ˛ n   ˛  ˇ, we conclude  2 ˇ. From
property ③, we infer that the cases  D ,  2  and  2  may
occur. Look at these cases in turn
  D : This is impossible, because we would have then
 2 ˛ and  2 ˇ n ˛.
  2 : This is impossible because  2 ˛ n .
  2 : We know that  62 ˛ n , but  2 ˛, which implies
 2  2 ˛, contradicting Lemma 1.4.10.
Thus we conclude that the assumption ˛ n  6D ; leads us to a
contradiction, from which the desired inclusion is inferred.
a
Consequently, the containment relation 2 yields a total order on an or-
dinal number.

1.4. ORDINAL NUMBERS
25
Lemma 1.4.13 If ˛ and ˇ are ordinals, then either ˛  ˇ or ˇ  ˛.
Thus ˛ 2 ˇ or ˇ 2 ˛ for ˛ 6D ˇ.
Proof Suppose ˛ 6D ˛ \ ˇ 6D ˇ, then ˛ \ ˇ 2 ˛ and ˛ \ ˇ 2 ˇ by
Lemma 1.4.12, and hence ˛ \ ˇ 2 ˛ \ ˇ, contradicting Lemma 1.4.10.
a
Since we want to use the ordinals as prototypes for well orders, we have
to show that they constitute a well order themselves; inclusion, or, what
amounts to be the same, containment suggests itself as an order rela-
tion.
Lemma 1.4.14 Every ordinal is well ordered by the inclusion relation.
Proof Let ˛ be an ordinal, we show ﬁrst that ˛ is linearly ordered by
inclusion. Take ˇ;  2 ˛, then either ˇ D , ˇ 2 , or  2 ˇ. The last
two conditions translate to ˇ   or   ˇ because of property ②. Now
let B be a nonempty subset of ˛, and then we know from property ④
that there exists  2 B with  \ B D ;. This is the smallest element
of B. In fact, let  2 B with  6D ; then either  2  or  2 . But
 2  is impossible, since otherwise  2 B \. So  2 , hence   .
a
We can describe this strict order even a bit more precise.
Lemma 1.4.15 If ˛ and ˇ are distinct ordinals, then either ˛ is an ini-
tial segment of ˇ or ˇ is an initial segment of ˛.
Proof Because ˛ 6D ˇ, we have either ˛  ˇ or ˇ  ˛ by Lemma
1.4.13. Assume that ˛  ˇ holds. If  2 ˛, then   ˛, and thus all
elements of ˛ precede the element ˛; conversely, if  2 ˇ with   ˛,
then  2 ˛. Hence ˛ is a segment of ˇ. It cannot be similar to ˇ because
of Corollary 1.3.13. a
Historically, ordinal numbers have been introduced as some sort of
equivalence classes of well-ordered sets under order isomorphisms (note
that some sort of equivalence classes is a cautionary expression, alluding
to the fact that there is no such thing as a set of all sets). We show now
that the present deﬁnition is not too far away from the traditional deﬁni-
tion. Loosely speaking, the ordinals deﬁned here may serve as represen-
tatives for those classes of well-ordered sets. We want to establish
Theorem 1.4.16 If M is a well-ordered set, then there exists an ordinal
˛ such that M and ˛ are isomorphic.

26
CHAPTER 1. THE AXIOM OF CHOICE
The proof will be done in several steps. Call two well-ordered sets A and
B similar (A 
 B) iff there exists an isomorphism between them. Re-
Outline for
the proof
call that isomorphisms preserve order relations in both directions.
Deﬁne the set H as all elements of M, the initial segment of which is
similar to some ordinal number, i.e.,
H WD f´ 2 M j ˛´ 
 O.´/ for some ordinal ˛´g:
In view of Lemma 1.4.15, if ˛´ 
 O.´/ and ˛0
´ 
 O.´/, then ˛´ D ˛0
´,
so the ordinal ˛´ is uniquely determined, if it exists. We ﬁrst show by
induction that H D M. For this, assume that O.´/  H; then we have
to show that ´ 2 H, so we have to ﬁnd an ordinal ˛´ with ˛´ 
 O.´/.
In fact, the natural choice is
˛´ WD f˛x 2 M j x < ´g;
so we show that this is an ordinal number by going through the proper-
ties according to Deﬁnition 1.4.1:
 Since each element of ˛´ is an ordinal, property ①is satisﬁed.
 Let ˛x 2 ˛´, and then x < ´; if  2 ˛x, then  is an ordinal
number, hence an initial segment of ˛x by Lemma 1.4.15; thus
 
 O.t/ for some t. Hence t < x < ´, so that ˛t D  2 ˛´.
Thus property ②is satisﬁed.
 Property ③follows from Lemma 1.4.13: Take ˛x; ˛y 2 ˛´; then
˛x and ˛y are ordinals. Assume that they are different; then either
˛x  ˛y nor ˛y  ˛x, so that by Lemma 1.4.12 ˛x 2 ˛y or
˛y 2 ˛x follows.
 Finally, let ; 6D B  ˛x. Then B corresponds to a nonempty
subset of M with a smallest element y. Then ˛y 2 ˛´, because
y < ´, and we claim that ˛y \ B D ;. In fact, if  2 ˛y \ B,
then  D ˛t for some t 2 B, so that y would not be minimal.
This shows that Property ④is satisﬁed.
Hence ˛´ is an ordinal. In order to establish that ´ 2 H we have to
show that ˛´ is similar to O.´/. But this follows from the construction.
Consequently we know that the initial segment for each element of M
is similar to an ordinal.
We are now in a position to complete the proof.

1.4. ORDINAL NUMBERS
27
Proof (for Theorem 1.4.16) Let
˛ WD f˛´ j ˛´ 
 O.´/ for some ´ 2 MgI
then one shows with exactly the arguments from above that ˛ is an ordi-
nal. Moreover, ˛ is similar to M: Consider the map ´ 7! ˛´; provided
˛´ 
 O.´/. It is clear that it is one to one, since x < y implies ˛x 2 ˛y,
for O.x/ is a (proper) initial segment of O.y/. It is also onto, because
given  2 ˛, we ﬁnd ´ 2 M with  
 O.´/, so that ´ 7! . a
Let us have a brief look at all countable ordinals. They will be used
later on for a particular construction in Sect. 1.7 for the construction of
a game and in Sect. 1.6.1 for the construction of a -algebra.
Proposition 1.4.17 Let !1 WD f˛ j ˛ is a countable ordinalg. Then !1
is an ordinal, the ﬁrst uncountable ordinal.
!1
Proof Exercise 1.11; the proof will have to look at the properties ①
through ④. a
Denote by W.˛/ WD f	 j 	 < ˛g all ordinals smaller than ˛, hence
the initial segment of ordinals determined by ˛. Given an arbitrary
nonempty set S, a map f W W.˛/ ! S is called an ˛-sequence over
S and sometimes denoted by ha j 	 < ˛i, where a WD f .	/. The
next very general statement says that these sequences can be deﬁned by
transﬁnite recursion in the following manner:
Theorem 1.4.18 Let S be a nonempty set, and let ˚ be the set of all ˛-
sequences over S for some ordinal ˛. Moreover, assume that h W ˚ ! S
is a map of ˛-sequences over S to S. Then there exists a uniquely
determined .˛ C 1/-sequence ha j 	  ˛i such that
a D h.ha j 
 < 	i/
for all 	  ˛.
Proof 0. The proof works by induction. We show ﬁrst that the sequence
Outline
is uniquely determined, and then we deﬁne this uniquely determined
sequence inductively.
1. We show uniqueness ﬁrst. Assume that we have two ˛ C1-sequences
ha j 	  ˛i and hb j 	  ˛i such that
a D h.ha j  < 	i/;
b D h.hb j  < 	i/

28
CHAPTER 1. THE AXIOM OF CHOICE
for all 	  ˛. Then we show by induction on 	 that a D b. The
induction begins at the smallest ordinal 	 D ;, so that a; D h.;/ D b;,
and the induction step is trivial.
2. The sequence ha j 	  ˛i is deﬁned now by induction on 	. If
h˛ j   	i is deﬁned, then deﬁne
˛C1 WD h.ha j   	i/:
If, however,  is a limit ordinal such that h˛ j   	i is deﬁned for each
	 < , then one notes that ha j 
 < 	0i is the restriction of ha j 
 < 	i
for 	 < 	0 <  by uniqueness, so that
˛ WD h.ha j 	 < i/
deﬁnes ˛ uniquely. a
We are now in a position to show that the existence of a choice function
implies that each set S can be well ordered. The idea of the proof is
to ﬁnd for some suitable ordinal ˛ an ˛-sequence ha j 	 < ˛i over S
which exhausts S, so that S D fa j 	 < ˛g, and then to use the well
Idea: exhaust
S
ordering of the ordinals by saying that a < a iff 	 < 
:
Constructing the sequence will use the choice function, selecting an el-
ement in such a way that one can be sure that it has not been selected
previously.
Theorem 1.4.19 If .AC/ holds, then each set S can be well ordered.
Proof Let f W P .S/ n f;g ! S be a choice function on the nonempty
subset of S. Extend f by putting f .;/ WD p, where p 62 S. This
element p serves as an indicator that we are done with constructing
the sequence. Let C be the set of all ordinals 	 such that there exists
a well order <B on a subset B  S with .B; <B/ similar to .O.	/,
cp. Theorem 1.4.16. Since C is a set of ordinals, there exists a smallest
ordinal ˛ not in C by Corollary 1.4.6.
By Theorem 1.4.18, there exists an ˛-sequence ha j 	 < ˛i over S
such that
a WD f

S n ha j  < 	i

2 S n ha j  < 	i
for all 	 < ˛. Now if S n ha j  < 	i 6D ;, then a 6D p, and
a … fa j  < 	g, so that the a are mutually different. Suppose that

1.5. ZORN’S LEMMA AND TUCKEY’S MAXIMALITY. . .
29
this process does not exhaust S; then a 6D p for all 	 < ˛. Construct
the corresponding well order < on fa j 	 < ˛g; then .fa j 	 <
˛g; </ 
 O.˛/. Thus ˛ 2 C, contradicting the choice of ˛. Hence
there exists a smallest ordinal 
 < ˛ with a D p, which implies that
S D fa j 	 < 
g so that elements having different labels are in fact
different. This yields a well order on S. a
Hence we have shown
Theorem 1.4.20 The following statements are equivalent:
.AC/ The axiom of choice.
.WO/ Each set can be well ordered.
a
.AC/ has other important and often used equivalent formulations, which
we will discuss now.
1.5
Zorn’s Lemma and Tuckey’s Maximality
Principle
Let A be an ordered set, and then B  A is called a chain iff it is
linearly ordered, an ordered set in which each chain has an upper bound
sometimes called inductively ordered. Then Zorn’s Lemma states
.ZL/ If A is an ordered set in which every
chain has an upper bound, then A has a
maximal element.
Proposition 1.5.1 .ZL/ implies .AC/.
Proof 0. Given a family of nonempty sets F, we want to ﬁnd a choice
function for it. In order to apply Zorn’s Lemma, we have to put our-
selves in a position that we have an ordered set at our disposal in which
every chain has an upper bound. We take as the ordered set all functions Proof outline
f which are deﬁned on subsets of F, for which f .F / 2 F holds, when-
ever F is in the domain of f . This set can be ordered in a natural way,
and it is then not difﬁcult to see that each chain has an upper bound.
Thus we obtain from .ZL/ a maximal element, which easily is shown to
be a map with F as its domain. This is the plan:

30
CHAPTER 1. THE AXIOM OF CHOICE
1. Let F 6D ; be a family of nonempty subsets of a set S; we want to
ﬁnd a choice function on F. Deﬁne
R WD fhF; si j s 2 F 2 FgI
then R  F  A is a relation. Put
C WD ff j f is a function with f  Rg
(note that we use functions here as sets of pairs). Then C 6D ;, because
hF; si 2 C for each hF; si 2 R. C is ordered by inclusion, and each
chain has an upper bound in C. In fact, if K  C is a chain, then S K
is a map: Let hF; si; hF; s0i 2 S K; then there exists f1; f2 2 K with
hF; si 2 f1; hF; s0i 2 f2. Because K is a chain, either f1  f2 or
vice versa; let us assume f1  f2. Thus hF; si 2 f2, and since f2 is a
map, we may conclude that s D s0. Hence S K is an upper bound to K
in C.
2. By .ZL/, C has a maximal element f . We prove that f  is the
desired choice function and hence that there exists for each and every
F 2 F some s 2 F with f .F / D s, or, equivalently, hF; si 2 f .
Consequently, the domain of f  should be all of F. Assume that the
domain of f  does not contain some F  2 F, and then the map f  [
fhF ; aig contains for each a 2 F  the map f  properly. This is a
contradiction; thus f  W F ! S with f .F / 2 F for all F 2 F.
a
We will encounter this pattern over and over again when applying .ZL/.
We need an ordered set, for which we can establish the chain condition.
.ZL/:
Pattern
The maximal element obtained from .ZL/ will then have to be checked
for its suitability, usually by bringing the assumption that it is not the
one we are looking for to a contradiction.
A proof for .AC/ ) .ZL/ uses a well-ordering argument for construct-
ing a maximal chain.
Proposition 1.5.2 Assume that A is an ordered set in which each chain
has an upper bound, and assume that there exists a choice function on
P .A/ n f;g. Then A has a maximal element.
Proof 0. We construct from the choice function a maximal element for
A by transﬁnite induction.

1.5. ZORN’S LEMMA AND TUCKEY’S MAXIMALITY. . .
31
1. As in the proof of Theorem 1.4.19, let C be the set of all ordinals 	
such that there exists a well order <B on a subset B  A with .B; <B/

 O.	/, and let ˛ be the smallest ordinal not in C; see Corollary 1.4.6.
Extend the choice function f on P .A/ n f;g upon setting f .;/ WD p
with p 62 A. This element will again serve as a marker, indicating that
the selection process is ﬁnished.
2. Deﬁne by induction a transﬁnite sequence ha j 	 < ˛i such that
a; 2 A is arbitrary and
a WD f .fx 2 A j x > a for all  < 	g/:
Assume that a 6D p; then a > a for all  < 	. As in the proof of
Theorem 1.4.19, there is a smallest ordinal ˇ < ˛ such that aˇ D p.
The selection process makes sure that ha j 	 < ˇi is an increasing
sequence, and that there does not exists an element x 2 A such that
a < x for all 	 < ˇ.
3. Let t be an upper bound for the chain ha j 	 < ˇi. If t is not a
maximal element for A, then there exists x with x > t; hence x > a
for all 	 < ˇ, which is a contradiction. a
Call a subset F  P .A/ of ﬁnite character iff the following condition
holds: F is a member of F iff each ﬁnite subset of F is a member of
F. The following statement is known as Tuckey’s Lemma or as Tuckey’s
Maximality Principle:
.MP/ Each family of ﬁnite character has a
maximal element.
This is another equivalent to .AC/.
Proposition 1.5.3 .MP/ , .AC/.
Proof 0. We show .MP/ ) .AC/; the other direction is delegated to
the exercises.
1. Let F  P .S/ n f;g be a family of nonempty sets. We construct a
choice function for F. Consider
G WD ff j f is a choice function for some E  Fg:
Then G is of ﬁnite character. In fact, let f be map from E  F to S such
that each ﬁnite subset f0  f is a choice function for some E0  E;
then f is itself a choice function for E. Conversely, if f W E ! S is

32
CHAPTER 1. THE AXIOM OF CHOICE
a choice function for E  F, then each ﬁnite subset of f is a choice
function for its domain. Thus there exists by the Maximality Principle
a maximal element f  2 G. The domain of f  is all of F, because
otherwise f  could be extended as in the proof of Proposition 1.5.1,
and it is clear that f  is a choice function on F. a
Thus we have shown
Theorem 1.5.4 The following statements are equivalent:
.AC/ The axiom of choice.
.WO/ Each set can be well ordered.
.ZL/ If A is an ordered set in which every chain has an upper bound,
then A has a maximal element (Zorn’s Lemma).
.MP/ Each family of ﬁnite character has a maximal element (Tuckey’s
Maximality Principle).
We will discuss some applications of Zorn’s Lemma and the Maximality
Principle now. From Theorem 1.5.4 we know that in each case we could
use also .AC/ or .WO/, as the case may be. An application of Zorn’s
Lemma appears sometimes to be more convenient and less technical
than using .WO/.
1.5.1
Compactness for Propositional Logic
We will show that a set of propositional formulas is satisﬁable iff each
ﬁnite subset is satisﬁable. This is usually called the Compactness Theo-
rem for Propositional Logic.
Fix a set V 6D ; of variables. A propositional formula ' is given through
this grammar
' WWD x j ' ^ ' j :'
with x 2 V . Hence a formula is either a variable, the conjunction of two
formulas, or the negation of a formula. The disjunction ' _ is deﬁned
through :.:' ^ : /, implication ' !  as :' _  , ﬁnally ' $  
is deﬁned through .' !  / ^ . ! '/. Denote by F the set of all
propositional formulas—actually, the set of all formulas depends on the
set of variables, so we ought to write F.V /; since we ﬁx V , however,
we use this somewhat lighter notation.

1.5. ZORN’S LEMMA AND TUCKEY’S MAXIMALITY. . .
33
A valuation v evaluates formulas. Instead of using true and false,
we use the values 0 and 1; hence a valuation is a map V ! f0; 1g which
is extended in a straightforward manner to a map F ! f0; 1g, which is
again denoted by v:
v.'1 ^ '2/ WD minfv.'1/; v.'2/g;
v.:'/ WD 1  v.'/:
Then we have obviously, e.g.,
v.'1 _ '2/ D maxfv.'1/; v.'2/g;
v.'1 ! '2/ D 1 iff v.'1/  v.'2/;
v.'1 $ '2/ D 1 iff v.'1/ D v.'2/:
For example,
v.' ! . ! // D maxf1  v.'/; maxf1  v. /; v./gg
D maxf1  v.'/; 1  v. /; v./g
D maxf1  v. /; maxf1  v.'/; v./gg
D v. ! .' ! //:
Hence

' ! . ! /

$

 ! .' ! /

$

.' ^  / ! 

:
A formula is true for a valuation iff this valuation gives it the value 1; a
set A of formulas is satisﬁed by a valuation iff each formula in A is true
under this valuation. Formally
Deﬁnition 1.5.5 Let v W F ! f0; 1g be a valuation. Then formula '
is true for v (in symbols: v ˆ ') iff v.'/ D 1. If A  F is a set
v ˆ '
of propositional formulas, then A is said to be satisﬁed by v iff each
formula in A is true for v, i.e., iff v ˆ ' for all ' 2 A. This is written
as v ˆ A.
v ˆ A
We are interested in the question whether or not we can ﬁnd for a set of
formulas a valuation satisfying it.
Deﬁnition 1.5.6 A  F is called satisﬁable iff there exists a valuation
v W F ! f0; 1g with v ˆ A.

34
CHAPTER 1. THE AXIOM OF CHOICE
Depending on the size of the set of variables, the set of formulas may
be quite large. If V is countable, however, F is countable as well, so
in this case the question may be easier to answer; this will be discussed
brieﬂy after giving the proof of the Compactness Theorem. We want to
establish the general case.
Before we state and prove the result, we need a lemma which permits
us to extend the range of our knowledge of satisﬁability just by one
formula.
Lemma 1.5.7 Let A  F be satisﬁable and ' 62 A be a formula. Then
one of A [ f'g and A [ f:'g is satisﬁable.
Proof If A [ f'g is not satisﬁable, but A is, let v be the valuation for
which v ˆ A holds. Because v.'/ D 0, we conclude v.:'/ D 1, so
that v ˆ A [ f:'g. a
We establish now the Compactness Theorem for propositional logic. It
permits reducing the question of satisﬁability of a set A of formulas to
ﬁnite subsets of A.
Theorem 1.5.8 Let A  F be a set of propositional formulas. Then A
is satisﬁable iff each ﬁnite subset of A is satisﬁable.
Proof 0. We will focus on satisﬁability of A provided each ﬁnite subset
of A is satisﬁable, because the other half of the assertion is trivial . The
Outline for
the proof
idea is to apply .ZL/, so that we have to construct an ordered set which
satisﬁes the chain condition. This set will consist of pairs hB; vi with
B  A and v ˆ B. We know from the assumption that we have plenty
of these pairs. The order is straightforward, and we will establish the
chain condition easily. The maximal element will have A as its ﬁrst
component.
1. Let
C WD fhB; vi j B  A; v ˆ Bg;
and deﬁne hB1; v1i  hB2; v2i iff B1  B2 and v1.'/ D v2.'/ for
all ' 2 B1, so that hB1; v1i  hB2; v2i holds iff B1 is contained in B2
and if the valuations coincide on the smaller set. This is a partial order.
If D  C is a chain, then put B WD S D; and deﬁne v.'/ WD v0.'/,
if ' 2 B0 with hB0; v0i 2 D. Since D is a chain, v is well deﬁned.
Moreover, v ˆ B: Let ' 2 B, then ' 2 B0 for some hB0; v0i 2 D, since
v0 ˆ B0, we have v.'/ D v0.'/ D 1. Hence by Zorn’s Lemma there
exists a maximal element hM; wi, in particular w ˆ M.

1.5. ZORN’S LEMMA AND TUCKEY’S MAXIMALITY. . .
35
We claim that M D A. Suppose this is not the case; then there exists
' 2 A with ' 62 M. But either M [ f'g or M [ f:'g is satisﬁable
by Lemma 1.5.7; hence hM; wi is not maximal. This is a contradic-
tion.
But this means that M D A; hence A is satisﬁable. a
Suppose that V is countable, then we know that F is countable as well.
Then another proof for Theorem 1.5.8 can be given; this will be sketched
now. Enumerate F as f'1; '2; : : :g. Call—just temporarily—A  F
ﬁnitely satisﬁable iff each ﬁnite subset of A is satisﬁable. Let A be
such a ﬁnitely satisﬁable set. We construct a sequence M0; M1; : : :
of ﬁnitely satisﬁable sets, starting from M0 WD A. If Mn is deﬁned,
put
MnC1 WD
(
Mn [ f'nC1g
if Mn [ f'nC1g is ﬁnitely satisﬁable,
Mn [ f:'nC1g
otherwise.
This will give a ﬁnitely satisﬁable set M WD S
n0 Mn. Now deﬁne
v.'/ WD 1 iff ' 2 M. We claim that v ˆ ' iff ' 2 M. This
is proved by a straightforward induction on '. Because A  M, we
know that v ˆ A. This approach could be modiﬁed for the general
case well ordering F.
The approach used for the general proof can be extended from propo-
sitional logic to ﬁrst-order logic by introducing suitable constants (they
are called Henkin’s constants). We refer the reader to [Bar77, Chap. 1],
since we are concentrating presently on applications of Zorn’s Lemma;
see, however, the discussion in Sect. 3.6.1, where additional references
can be found.
1.5.2
Extending Orders
We will establish a generalization to the well-known fact that each ﬁ-
nite graph G can be embedded into a linear order, provided the graph
does not have any cycles. This is known as a topological sort of the
graph [Knu73, Algorithm T, p. 262] or [CLR92, Sect. 23.4]. One notes
ﬁrst that G must have a node k which does not have any predecessor
(hence there is no node ` which is connected to k through an edge
` ! k). If such a node k would not exist, one could construct for
each node a cycle on which it lies. The algorithm proceeds recursively.

36
CHAPTER 1. THE AXIOM OF CHOICE
If the graph contains at most one node, it returns either the empty list or
the list containing the node. The general case constructs a list having k
as its head and the list for G n k as its tail; here G n k is the graph with
node k and all edges emanating from k are removed.
Finiteness plays a special role in the argument above, because it makes
sure that we have a well order among the nodes, which in turn is needed
for making sure that the algorithm terminates. Let us turn to the general
case. Given a partial order  on a set S, we show that  can be extended
to a strict order s (hence a  b implies a s b for all a; b 2 S).
This will be shown through Zorn’s Lemma. Put
G WD fR j R is a partial order on S with 
 Rg
and order G by inclusion. Let C  G be a chain, and then we claim that
R0 WD S C is a partial order. It is obvious that R0 is reﬂexive; if aR0b
and bR0a, then there exist relations R1; R2 2 C with aR1b and bR2a.
Since C is a chain, we know that R1  R2 or R2  R1 holds. Assume
that the former holds, and then aR2b follows, so that we may conclude
a D b. Hence R0 is antisymmetric. Transitivity is proved along the
same lines, using that C is a chain. By Zorn’s Lemma, G has a maximal
element M; since M 2 G, M is a partial order which contains the given
partial order .
We have to show that M is linear. Assume that it is not, so that there
exists a; b 2 S such that both aMb and bMa are false. Put
M 0 WD M [ fhx; yi j xMa and bMyg:
Then M 0 contains M properly. If we can show that M 0 is a partial order,
Plan
we have shown that M is not maximal, which is a contradiction. Let us
see:
 M 0 is reﬂexive: Since M  M 0 and M is reﬂexive, xMx holds
for all x 2 S.
 M 0 is transitive: Let xM 0y and yM 0´; then these cases are pos-
sible:
1. xMy and yM´, hence xM´, thus xM 0´.
2. xMy and yMa and bM´, thus xMa and bM´, so that
xM 0´.

1.5. ZORN’S LEMMA AND TUCKEY’S MAXIMALITY. . .
37
3. xMa and bMy and yM´, hence xM 0´.
4. xMa and bMy and yMa and bM´, but then bMa contrary
to our assumption. Hence this case cannot occur.
Thus we may conclude that M 0 is transitive.
 M 0 is antisymmetric. Assume that xM 0y and yM 0x, and look at
the cases above with ´ D x. Case 2 would imply xMa and bMx,
so it is not possible; case 3 is excluded for the same reason, so
only case 1 is left, which implies x D y.
Thus the assumption that there exists a; b 2 S such that both aMb and
bMa are false leads to the conclusion that M is not maximal in G, which
is a contradiction.
Then a <s b iff ha; bi 2 M deﬁnes the desired total order, and by
construction it extends the given order.
Hence we have shown
Proposition 1.5.9 Each partial order on a set can be extended to a total
order. a
It is clear that this applies to acyclic graphs, so that we have here a very
general version of topological sorting.
1.5.3
Bases in Vector Spaces
Fix a vector space V over ﬁeld K. A set B  V is called linearly
independent iff P
b2B0 ab  b D 0 implies ab D 0 for all b 2 B0,
Linear inde-
pendence
whenever B0 is a ﬁnite nonempty subset of B. Hence, e.g., a single
vector v with v 6D 0 is linear independent.
Example 1.5.10 The reals R form a vector space over the rationals Q.
Then
p
2 and
p
3 are linearly independent. In fact, assume that q1
p
2C
q2
p
3 D 0 with rational numbers q1 D r1=s1 and q2 D r2=s2. Then we
can ﬁnd integers t1; t2 such that t1
p
2 D t2
p
3 so that t1 and t2 have no
common divisors. But 2t2
1 D 3t2
2 implies that 2 and 3 are both common
divisors to t1 and to t2. ✌

38
CHAPTER 1. THE AXIOM OF CHOICE
The linear independent set B is called a base for V iff B is linear inde-
Base
pendent and if each element v 2 V can be represented as
v D
n
X
iD1
ai  bi
for some a1; : : : ; an 2 K and b1; : : : ; bn 2 B. This representation is
unique.
Proposition 1.5.11 Each vector space V has a base.
Proof 0. We ﬁrst ﬁnd a maximal independent set through .ZL/ by con-
Plan
sidering the family of all independent sets, and then we show that this
set is a base.
1. Let
V WD fB  V j B is linear independentg:
Then V contains all singletons with non-null vectors; hence it is not
empty. Order V by inclusion, and let B be a chain in V. Then B0 WD
S B is independent. In fact, if Pn
iD1 ai bi D 0; let bi 2 Bi 2 B for 1 
i  n. Since C is linearly ordered, we ﬁnd some k such that bi 2 Bk,
and since Bk is independent, we may conclude b1 D : : : D bn D 0. By
Zorn’s Lemma there exists a maximal independent set B 2 V.
2. If B is not a basis, then we ﬁnd a vector x which cannot be repre-
sented as a ﬁnite linear combination of elements of B. Clearly x 62 B.
But then B [ fxg is linear independent, for it could otherwise be rep-
resented by elements from B. This contradicts the maximality of B.
a
One notes that part 1 of the proof could as well argue with the Maximal-
ity Principle, because a set is linear independent iff each ﬁnite subset is
linear independent. The set V constructed in the proof is of ﬁnite char-
acter and hence contains by .MP/ a maximal element. Then one argues
exactly as in part 2 of the proof. This shows that .ZL/ and .MP/ are
close relatives.
These proofs are not constructive, since they do not tell us how to con-
struct a base for a given vector space, not even in the ﬁnite dimensional
case.

1.5. ZORN’S LEMMA AND TUCKEY’S MAXIMALITY. . .
39
1.5.4
Extending Linear Functionals
Sometimes one is given a linear map from a subspace of a vector space
to the reals, and one wants to extend this map to a linear map on the
whole space. Usually there is the constraint that both the given map and
the extension should be dominated by a sublinear map.
Let V be a vector space over the reals. A map f W V ! R is said to be a
linear functional (or a linear map) on V iff f .˛  x C ˇy/ D ˛  f .x/ C
Linear map
ˇ  f .y/ holds for all x; y 2 V and ˛; ˇ 2 R. Thus a linear functional
is compatible with the vector space structure of V . Call p W V ! R
sublinear iff p.x C y/  p.x/ C p.y/, and p.˛  x/ D ˛  p.x/ for all
Sublinearity
x; y 2 V and ˛  0.
We have a look at the situation in the ﬁnite dimensional case ﬁrst. This
will permit us to isolate the central argument easily, which then will be
applied to the general situation.
Proposition 1.5.12 Let V be a ﬁnite dimensional real vector space with
a sublinear functional p W V ! R. Given a subspace V0 and a lin-
ear map f0 W V0 ! R such that f0.x/  p.x/ for all x 2 V0, then
there exists a linear functional f W V ! R which extends f0 such that
f .x/  p.x/ for all x 2 V .
Proof 1. It is enough to show that f0 can be extended to a linear func-
tional dominated by p to the vector space generated by V0 [ f´g with
´ 62 V0. In fact, we can then repeat this procedure a ﬁnite number of
Line of
attack
times, in each step adding a new basis vector not contained in the previ-
ous subspace. Since V is ﬁnite dimensional, this will eventually give us
V as the domain for the linear functional.
2. Let ´ 62 V0, and then fv C ˛  ´ j v 2 V0; ˛ 2 Rg is the vector space
generated by V0 and ´, because this is clearly a vector space containing
V0 [ f´g, and each vector space containing V0 [ f´g must also contain
linear combinations of the form v C ˛  ´ with v 2 V0 and ˛ 2 R.
The representation of an element in this vector space is unique: Assume
v C ˛  ´ D v0 C ˛0  ´, then v  v0 D .˛  ˛0/  ´, and because ´ 62 V0,
this implies v  v0 D 0, and hence also ˛ D ˛0.

40
CHAPTER 1. THE AXIOM OF CHOICE
3. Now set
f .v C ˛  ´/ WD f0.v/ C ˛  c
with a value c which will have to be determined. Consider v; v0 2 V0;
then we have
f0.v/  f0.v0/ D f0.v  v0/  p.v  v0/  p.v C ´/ C p.´  v0/
for an arbitrary v1 2 V . Thus we obtain p.´  v0/  f0.v0/  p.v C
´/  f0.v/: Note that the left-hand side of this inequality is independent
of v and that the right-hand side is independent of v0, which means that
we can ﬁnd c with
i c  p.v C ´/  f0.v/ for all v 2 V0,
ii c  p.´  v0/  f0.v0/ for all v 2 V0.
Now let us see what happens. Fix ˛. If ˛ D 0, we have f .v C 0  ´/ D
f0.v/  p.v C 0  ´/. If ˛ > 0, we have
f .v C ˛  ´/
D
˛  f .v=˛ C ´/ D ˛  .f0/.v=˛/ C c/

˛  .f0.v/ C p.v=˛ C ´/  f0.v=˛/
D
p.v C ˛  ´/
by i and sublinearity. If, however, ˛ < 0, we use the inequality ii and
sublinearity of p; note that the coefﬁcient ´=˛ of ´ is positive in this
case.
Summarizing, we have f .v C ˛  ´/  p.v C ˛  ´/ for all v 2 V0 and
˛ 2 R. a
When having a closer look at the proof, we see that the assumption
on working in a ﬁnite dimensional vector space is only important for
making sure that the extension process terminates in a ﬁnite number
of steps. The core of this proof, however, consists in the observation
that we can extend a linear functional from a vector space V0 to a vector
space fvC˛´ j v 2 V0; ˛ 2 Rg with ´ 62 V0 without losing domination
by the sublinear functional p. Let us record this important intermediate
result.
Corollary 1.5.13 Let V0 be a vector space, V0  V , p W V ! R
be a sublinear functional, and ´ 62 V0. Then each linear functional
f0 W V0 ! R which is dominated by p can be extended to a linear
functional f on the vector space generated by V0 and ´ such that f is
also dominated by p. a

1.5. ZORN’S LEMMA AND TUCKEY’S MAXIMALITY. . .
41
Now we are in a position to formulate and prove the Hahn–Banach The-
orem. We will use Zorn’s Lemma for the proof by setting up a partial
Outline
order such that each chain has an upper bound. The elements of this
ordered set will be pairs hV 0; f 0i such that V 0 is a subspace of V with
V0  V , and f 0 will be a linear map extending f0 and being dominated
by p, the order being straightforward, induced by the extension condi-
tion. We may conclude then that there exists a maximal element. By
the “dimension free” version of the extension just stated, we will then
show that the assumption that we did not capture the whole vector space
through our maximal element will yield a contradiction.
Theorem 1.5.14 Let V be a real vector space with a sublinear func-
tional p W V ! R. Given a subspace V0 and a linear map f0 W V0 ! R
such that f0.x/  p.x/ for all x 2 V0, then there exists a linear func-
tional f W V ! R which extends f0 such that f .x/  p.x/ for all
x 2 V .
Proof 1. Deﬁne hV 0; f 0i 2 W iff V 0 is a vector space with V0 
V 0  V , and f 0 W V 0 ! R extends f0 and is dominated by p. Deﬁne
hV 0; f 0i  hV 00; f 00i iff V 0 is a subspace of V 00 and f 00 is an extension
to f 0 for hV 0; f 0i; hV 00; f 00i 2 W. Then  is a partial order on W. Let

hVi; fii

i2I be a chain in W, and then V 0 WD S
i2I Vi is a subspace
of V . In fact, let x; x0 2 V 0, and then x 2 Vi and x0 2 Vi0. Then
either Vi  Vi0 or Vi0  Vi. Assume the former, hence x; x0 2 Vi0; thus
˛  x C ˇ  x0 2 Vi0  V 0 for all ˛; ˇ 2 R. Put f 0.x/ WD fi.x/; if
x 2 Vi for some i 2 I, then f 0 W V 0 ! R is well deﬁned, linear, and
dominated by p; moreover, f 0 extends every fi, hence, by transitivity,
f0: This implies hV 0; f 0i 2 W, and this is obviously an upper bound
for the chain.
2. Hence each chain has an upper bound in W, so that Zorn’s Lemma
implies the existence of a maximal element hV C; f Ci 2 W. Assume
that V C 6D V ; then there exists ´ 2 V with ´ 62 V C. Then the vector
space V  generated by V C [ f´g contains V C properly, and f C has a
linear extension f  to V  which is dominated by p by Corollary 1.5.13.
But this means hV C; f Ci is strictly smaller than hV ; f i 2 W, a con-
tradiction. Hence V C D V , and f C is the desired extension. a
The Hahn–Banach Theorem is sometimes considered as one of the cor-
nerstones in functional analysis, because it permits to construct linear
functionals with given properties. A ﬁrst idea why this might be impor-
tant is hinted at in Exercise 4.32.

42
CHAPTER 1. THE AXIOM OF CHOICE
1.5.5
Maximal Filters
Fix a set S. The power set P .S/ is ordered by inclusion , exhibiting
some interesting properties. We single out subsets of P .S/ which are
called ﬁlters. These ﬁlters will be discussed in subsequent sections, and
then the aspect that a ﬁlter lives in an ordered environment becomes
dominant. But here is the deﬁnition of a ﬁlter of subsets.
Deﬁnition 1.5.15 A nonempty subset F  P .S/ is called a ﬁlter iff
1. ; 62 F,
2. if F1; F2 2 F, then F1 \ F2 2 F,
3. if F 2 F and F  F 0, then F 0 2 F.
Thus a ﬁlter is closed under ﬁnite intersections and closed with respect
to super sets, and it must not contain the empty set.
Example 1.5.16 Given s 2 S, the set Fs WD fA  S j s 2 Ag is a
ﬁlter, which is called the principal ultraﬁlter associated with x. Let M
Principal
ultraﬁlter
be an inﬁnite set. Then F WD fA  M j M n A is ﬁniteg is a ﬁlter, the
ﬁlter of coﬁnite sets. ✌
The ﬁlter Fs from Example 1.5.16 is special because it is maximal; we
cannot ﬁnd a ﬁlter G which properly contains Fs. Let us try: Take G 2
G with G 62 Fs, then s 62 G, and hence s 2 S n G, so that both G 2 G
and S n G 2 G, the latter one via Fs. This implies ; 2 G, since a ﬁlter
is closed under ﬁnite intersections. We have arrived at a contradiction,
giving rise to the deﬁnition of a maximal ﬁlter (Deﬁnition 1.5.20) in a
moment.
Before stating it, we will introduce ﬁlter bases. Sometimes we are not
presented with a ﬁlter proper, but rather with a family of sets which
generates one.
Deﬁnition 1.5.17 A subset B  P .S/ is called a ﬁlter base iff no in-
tersection of a ﬁnite collection of elements of B is empty and thus iff
; 62 fB1 \ : : : \ Bn j B1; : : : ; Bn 2 Bg:
Example 1.5.18 . Fix x 2 R; then the set B WD
˚
a; bŒ j a < x < b

of
all open intervals containing x is a ﬁlter base. Let .an/n2N be a sequence
in R; then the set E WD
˚
fak j k  ng j n 2 N

of inﬁnite tails of the
sequence is a ﬁlter base as well. ✌

1.5. ZORN’S LEMMA AND TUCKEY’S MAXIMALITY. . .
43
Clearly, if B is to be contained in a ﬁlter F, then it must not have the
empty sets among its ﬁnite intersections, because all these ﬁnite inter-
sections are elements of F. It is easy to characterize the ﬁlter generated
by a base.
Lemma 1.5.19 Let B  P .S/ be a ﬁlter base; then
F WD fB  S j B 	 B1 \ : : : \ Bn for some B1; : : : ; Bn 2 Bg
is the smallest ﬁlter containing B.
Proof It is clear that F is a ﬁlter, because it cannot contain the empty
set, it is closed under ﬁnite intersections, and it is closed under super
sets. Let G be a ﬁlter containing B, and let B 	 B1 \ : : : \ Bn for some
B1; : : : ; Bn 2 B  G; hence B 2 G. Thus F  G, so that F is in fact
the smallest ﬁlter containing B. a
Let us return to the properties of the ﬁlter which is deﬁned in Exam-
ple 1.5.16.
Deﬁnition 1.5.20 A ﬁlter is called maximal iff it is not properly con-
tained in another ﬁlter. Maximal ﬁlters are also called ultraﬁlters.
This is an easy characterization of maximal ﬁlters.
Lemma 1.5.21 These conditions are equivalent for a ﬁlter F:
1. F is maximal.
2. For each subset A  S, either A 2 F or S n A 2 F.
Proof 1 ) 2: Assume there is a set A  S such that both A 62 F and
S n A 62 F hold. Then
G0 WD fF \ A j F 2 Fg
is a ﬁlter base, because F \ A D ; for some F 2 F would imply
F  S n A; thus S n A 2 F. Because F \ A 62 F for all F 2 F, we
conclude that the ﬁlter G generated by G0 contains F properly. Thus F
is not maximal.
2 ) 1: A ﬁlter G which contains F properly will contain a set A 62 F.
By assumption, S n A 2 F  G, so that ; 2 G. Thus G is not a ﬁlter.
a

44
CHAPTER 1. THE AXIOM OF CHOICE
Example 1.5.22 The ﬁlter F of coﬁnite sets from Example 1.5.15 for
an inﬁnite set M is not an ultraﬁlter. In fact, decompose M D M0[M1
into disjoint sets M0 and M1 which are both inﬁnite. Then neither M0
nor its complement is contained in F. ✌
The existence of ultraﬁlters is trivial by Example 1.5.16, but we do not
know whether each ﬁlter is actually contained in an ultraﬁlter. The an-
swer is in the afﬁrmative.
Theorem 1.5.23 Each ﬁlter can be extended to a maximal ﬁlter.
Proof Let F be a ﬁlter on S, and deﬁne
V WD fG j G is a ﬁlter with F  Gg:
Order V by inclusion. Then each chain C in V has an upper bound in
V. In fact, let H WD S C. If A 2 H and A  B, there exists a ﬁlter
G 2 C with A 2 G; hence B 2 G, so that B 2 H. If A; B 2 H, we ﬁnd
GA; GB 2 H with either GA  GB or GB  GA, because C is linearly
ordered. Assume the former, hence A; B 2 CB, hence A\B 2 GB  H.
So H is a ﬁlter in V.
Thus there exists in V a maximal element F which is a maximal ﬁlter
(just repeat the argument in the proof of 2 ) 1 for Lemma 1.5.21).
F contains F. a
Corollary 1.5.24 Let ; 6D A  X be a nonempty subset of a set X.
Then there exists an ultraﬁlter containing A.
Proof Using Theorem 1.5.23, extend the ﬁlter fB  X j A  Bg to an
ultraﬁlter. a
1.5.6
Ideals and Filters
We will now translate some of the arguments above from the power set
of a set to a partially ordered set which has at least part of the algebraic
properties of the power set.
Recall that a lattice .L; / is a set L with an order relation  such that
each nonempty ﬁnite subset has a lower bound and an upper bound. Put
a ^ b WD inffa; bg (this is the meet of a and b) and a _ b WD supfa; bg
(this is the join of a and b). In a similar way, we put for W S WD sup S
Lattice, join,
meet

1.5. ZORN’S LEMMA AND TUCKEY’S MAXIMALITY. . .
45
and V S WD inf S for S  L, provided sup S resp. inf S exists in
L.
We note these properties (a; b 2 L):
Impotency a ^ a D a _ a D a.
Commutativity a ^ b D b ^ a and a _ b D b _ a.
Absorption a^.a_b/ D a and a_.a^b/ D a. In fact, a  a_b, and
thus a D a ^ a  a ^ .a _ b/; on the other hand a ^ .a _ b/  a.
The second equality is proved similarly.
For simplicity we assume that the lattice is bounded, i.e., that it has a
smallest element ? and a largest element >, so that we can put ? WD
sup ; and > WD inf ;, resp.
That is, the generalization of the properties of a power set is clear.
Example 1.5.25 The power set P .S/ of a set S is a lattice, where A 
B iff A  B, so that
A \ B D inffA; Bg;
A [ B D supfA; Bg:
✌
But there are lattices which do not derive from a power set, as the fol-
lowing example shows:
Example 1.5.26 Look at this example
⊤
H
I
J
E
F
G
A
B
C
D
⊥
Then
fB; Cg
has
these
upper
bounds, f>; H; Ig, and thus has
no smallest upper bound, so that—
probably
contrary
to
the
ﬁrst
view—B _ C does not exist. Try-
ing to determine A_B, we see that
the set of upper bounds to fA; Bg is
just f>; F; H; Ig: hence A _ B D
F .
✌

46
CHAPTER 1. THE AXIOM OF CHOICE
This is another example of a lattice. It indicates that we have to carefully
look at the context, when discussing joins and meets.
Example 1.5.27 Consider the set J of all open intervals a; bŒ with
a; b 2 R, and take the order inherited from P .R/; then J is closed
under taking the inﬁmum of two elements (since the intersection of two
open intervals is again an open interval), but J is not closed under tak-
ing the supremum of two elements in P .R/, since the union of two open
intervals is not necessarily an open interval. Nevertheless, J is a lattice
in its own right, because we have
a1; b1Œ _ a2; b2Œ D  minfa1; a2g; maxfb1; b2gŒ
in J . Hence we have to make sure that we look for the supremum in the
proper set. ✌
The next example also asks for a cautionary approach.
Example 1.5.28 Similarly, consider the set R of all closed rectangles
in the plane R  R, again with the order inherited from P .R  R/. The
intersection R1\R2 of two closed rectangles R1; R2 2 R is an element
of R and is indeed the inﬁmum of R1 and R2. But what do we take
as the supremum in R if it exists at all? From the deﬁnition of the
supremum, we have
R1 _ R2 D
\
fR 2 R j R1  R and R2  Rg;
in plain words, the smallest closed rectangle which encloses both R1
and R2. Hence, e.g.,
Œ0; 1  Œ0; 1 _ Œ5; 6  Œ8; 9 D Œ0; 6  Œ0; 9:
This renders R a lattice indeed. ✌
A lattice is called distributive iff
a ^ .b _ c/ D .a ^ b/ _ .a ^ c/;
a _ .b ^ c/ D .a _ b/ ^ .a _ c/
holds (both equations are actually equivalent; see Exercise 1.23).
Example 1.5.29 The power set lattice P .S/ is a distributive lattice, be-
cause unions and intersections are distributive.

1.5. ZORN’S LEMMA AND TUCKEY’S MAXIMALITY. . .
47
But BEWARE! Distributivity is not necessarily inherited. Consider the
lattice J of closed intervals of the real line, as in Example 1.5.27; then
I1 ^ I2 D I1 \ I2;
I1 _ I2 D Œmin I1 [ I2; max I1 [ I2;
as above. Put A WD Œ3; 2; B WD Œ1; 1; C WD Œ2; 3; then
.A ^ B/ _ .B ^ C/ D ;;
B ^ .A _ C/ D Œ1; 1:
Thus J is not distributive, although the order has been inherited from
the power set. ✌
Example 1.5.30 Let P be a set with a partial order . A set D  P
is called a down set iff t 2 D and s  t imply s 2 D. Hence a down
set is downward closed in the sense that all elements below an element
of the set belong to the set as well. A generic example for a down set is
fs 2 P j s  tg with t 2 P . Down sets of this shape are called principal
down sets. The intersection and the union of two down sets are down
sets again. For example, let D1 and D2 be down sets, let t 2 D1 [ D2,
and assume s  t. Because t 2 D1 or t 2 D2, we may conclude that
s 2 D1 or s 2 D2; hence s 2 D1 [ D2. Let D.P / be the set of all
down sets of P ; then D.P / is a distributive lattice; this is so because the
inﬁmum and the supremum of two elements in D.P / are the same as in
P .P /.
Deﬁne
 W
(
P
! D.P /
t
7! fs 2 P j s  tg:
Then t1  t2 implies .t1/  .t2/; hence the order structure carries
over from P to D.P /. Moreover .t1/ D .t2/ implies t1 D t2, so
that  is injective. Hence we have embedded the partially ordered set
P into a distributive lattice. ✌
Filters and ideals are important structures in a lattice.

48
CHAPTER 1. THE AXIOM OF CHOICE
Deﬁnition 1.5.31 Let L be a lattice.
J  L is called an ideal iff
 ; 6D J 6D L.
 If a; b 2 J , then a _ b 2 J .
 If a 2 J and b 2 L with b 
a, then b 2 J .
The ideal J is called prime iff a ^
b 2 J implies a 2 J or b 2 J ,
and it is called maximal iff it is
not properly contained in another
ideal.
F  L is called a ﬁlter iff
 ; 6D F 6D L.
 If a; b 2 F , then a ^ b 2 F .
 If a 2 F and b 2 L with
b  a, then b 2 F .
The ﬁlter F is called prime iff a _
b 2 F implies a 2 F or b 2 F ,
and it is called maximal iff it is not
properly contained in another ﬁl-
ter.
Maximal ﬁlters are also called ultraﬁlters. Recall the deﬁnition of an
ultraﬁlter of sets in Deﬁnition 1.5.20; we have deﬁned already ultraﬁl-
ters for the special case that the underlying lattice is the power set of
a given set. The notion of a ﬁlter base fortunately carries over directly
from Deﬁnition 1.5.17, so that we may use Lemma 1.5.19 in the present
context as well. We will talk in this section in a more general context,
but ﬁrst some simple examples.
Example 1.5.32 I WD fF  N j F is ﬁnite g is an ideal in P .N/ with
set inclusion as the partial order. This is so since the intersection of
two ﬁnite sets is ﬁnite again and because subsets of ﬁnite sets are ﬁnite
again. Also ; 6D I 6D P .N/. This ideal is not prime. ✌
Example 1.5.33 Consider all divisors of 24.
24
12
8
6
4
3
2
1
f1; 2; 3; 6g is an ideal, and f1; 2; 3; 4; 6g is not. ✌
Example 1.5.34 Let S 6D ; be a set, a 2 S. Then P .S n fag/ is a
prime ideal in P .S/ (with set inclusion as the partial order). In fact,
; 6D P .S n fag/ 6D P .S/, and if a 62 A and a 62 B, then a 62 A [ B.
On the other hand, if a 62 A \ B, then a 62 A or a 62 B. ✌

1.5. ZORN’S LEMMA AND TUCKEY’S MAXIMALITY. . .
49
Lemma 1.5.35 Let L be a lattice and ;; 6D F 6D L be a proper nonempty
subset of L.
 These conditions are equivalent
1. F is a ﬁlter.
2. > 2 F and (a ^ b 2 F , a 2 F and b 2 F ).
 If ﬁlter F is maximal and L is distributive, then F is a prime ﬁlter
Proof 1. The implication 1 ) 2 in the ﬁrst part is trivial, for 2 ) 1
one notes that a  b is equivalent to a ^ b D a.
2. In order to show that the maximal ﬁlter F is prime, we show that
a _ b 2 F implies a 2 F or b 2 F . Assume that a _ b 2 F with
a 62 F . Consider B WD ff ^ b j f 2 F g; then ? 62 B. In fact,
assume that f ^ b D ? for some f 2 F ; then we could write a D
.f ^ b/ _ a D .f _ a/ ^ .b _ a/ by distributivity. Since f 2 F and F
are a ﬁlter, f _ a 2 F follows, and since b _ a 2 F , we obtain a 2 F ,
contradicting the assumption. Thus B is a ﬁlter base, and because F is
maximal, we may conclude that B  F , which in turn implies b 2 F .
a
Hence maximal ﬁlters are prime in a distributive lattice. If the lattice is
not distributive, this may not be true. Look at this example:
⊤
a
b
c
⊥
The lattice is not distributive, be-
cause .a ^ b/ _ c D c 6D > D
.a _ c/ ^ .b _ c/.
Then f>g,
f>; ag, f>; bg, f>; cg and f>; dg
are ﬁlters, f>; ag, f>; bg, f>; cg
are maximal, but none of them is
prime.
Prime ideals and prime ﬁlters are not only dual notions, they are also
complementary concepts.
Lemma 1.5.36 In a lattice L a subset F is a prime ﬁlter iff its comple-
ment L n F is a prime ideal.
Proof Exercise 1.15. a

50
CHAPTER 1. THE AXIOM OF CHOICE
When deﬁning a lattice as a generalization of the power set construct,
we restricted the attention to joins and meets of elements but neglected
the observation that in a power set each set has a complement. The
corresponding abstraction is a Boolean algebra. Such a Boolean algebra
B is a distributive lattice such that there exists a unary operation  W
B ! B such that
Boolean
algebra
a _ a D >
a ^ a D ?
a is called the complement of a. We assume that ^ binds stronger
than _ and that complementation binds stronger than the binary opera-
tions.
The power of complementation shows already in the next lemma, which
relates prime ideals to maximal ideals and prime ﬁlters to maximal ﬁl-
ters.
Lemma 1.5.37 Let B be a Boolean algebra. Then an ideal is maximal
iff it is prime, and a ﬁlter is maximal iff it is prime.
Proof Note that a Boolean algebra is a distributive lattice with more than
one element (viz., ? and >). We prove the assertion only for ﬁlters. That
a maximal ﬁlter is prime has been shown in Lemma 1.5.35. If F is not
maximal, there exists a with a 62 F and a 62 F by Lemma 1.5.21. But
> D a _ a 2 F; hence F is not prime. a
This is another and probably surprising equivalent to .AC/.
.MI/ Each lattice with more than one
element contains a maximal ideal.
Theorem 1.5.38 .MI/ is equivalent to .AC/.
Proof 1. .MI/ ) .AC/: We show actually that .MI/ implies .MP/;
an application of Theorem 1.5.4 will then establish the claim. Let F 
P .S/ be a family of ﬁnite character. In order to apply .MI/, we need
a lattice, which we will deﬁne now. Deﬁne L WD F [ fSg, and put for
X; Y 2 F
X ^ Y WD X \ Y;
X _ Y WD
(
X [ Y;
if X [ Y 2 F;
S;
otherwise:

1.5. ZORN’S LEMMA AND TUCKEY’S MAXIMALITY. . .
51
Then L is a lattice with top element S and bottom element ;. Let M
be a maximal ideal in L; then we assert that M  WD S M is a maximal
element of F. Then M  6D S.
First we show that M  2 F. If fa1; : : : ; akg 2 M ; then we can ﬁnd
Mi 2 M such that mi 2 Mi for 1  i  n. Since M is an ideal in L,
we know that M1 _ : : : _ Mn 2 M, so that fa1; : : : ; akg 2 F; hence
M  2 F.
Now assume that M  is not maximal, then we can ﬁnd N 2 F such
that M  is a proper subset of N , and hence there exists t 2 N such that
t 62 M . Because N 2 F and F are of ﬁnite character, ftg 2 F. Now
put M0 WD M[fM _ftg j M 2 Mg D M[fM [ftg j M 2 MgI then
M0 is an ideal in L which properly contains M. This is a contradiction;
hence we have found a maximal element of F.
2. .AC/ ) .MI/: Again, we use the equivalences in Theorem 1.5.4,
because we actually show .ZL/ ) .MI/. Let L be a lattice with at least
two elements, and order
I WD fI  L j I is an ideal in Lg
by inclusion. Because fb 2 L j b  ag 2 I for a 2 L; a 6D > (by
assumption, such an element exists), we know that I 6D ;. If C  I is
a chain, then I WD S C 2 I. In fact, ; 6D I 6D L, because > 62 I, and
if a; b 2 I, we ﬁnd I1; I2 with a 2 I1; b 2 I2, because C is a chain; we
may assume that I1  I2, and hence a; b 2 I2, so that a _ b 2 I2  I.
If a  b and b 2 I, then a 2 I, because b 2 I1 for some I1 2 I.
Hence each chain has an upper bound in I. .ZL/ implies the existence
of a maximal element M 2 I. a
Since each Boolean algebra is a lattice with more than the top element,
the following corollary is a consequence of Theorem 1.5.38. It is known
under the name Prime Ideal Theorem. We know from Lemma 1.5.37
that prime ideals and maximal ideals are really the same.
Theorem 1.5.39 .AC/ implies the existence of a prime ideal in a
Boolean algebra. a
The converse does not hold—it can be shown that the Prime Ideal The-
orem is strictly weaker than .AC/ [Jec06, p. 81].

52
CHAPTER 1. THE AXIOM OF CHOICE
1.5.7
The Stone Representation Theorem
Let us stick for a moment to Boolean algebras and discuss the famous
Stone Representation Theorem, which requires the Prime Ideal Theorem
at a crucial point.
Fix a Boolean algebra B and deﬁne for two elements a; b 2 B their
symmetric difference a  b through
a  b WD .a ^ b/ _ .a ^ b/:
If B D P .S/ for some set S and if ^; _;  are the respective set opera-
tions \; [; S n , then A  B is in fact equal to the symmetric difference
AB WD .A n B/ [ .B n A/ D .A [ B/ n .B \ A/:
Fix an ideal I of B, and deﬁne

I
a 
I b , a  b 2 I:
Then 
I is a congruence, i.e., an equivalence relation which is compati-
ble with the operations on the Boolean algebra. This will be shown now
through a sequence of statements.
We state some helpful properties.
Lemma 1.5.40 Let B be a Boolean algebra; then
1. a  a D ?, a  b D b  a and a  b D .a/  .b/.
2. a  b D .a _ b/ ^ .a ^ b/.
3. .ab/^c D .a^c/.b^c/ and c^.ab/ D .c^a/.c^b/.
Proof The properties under 1 are fairly obvious, 2 is calculated directly
using distributivity, and ﬁnally the ﬁrst part of 3 follows; thus
.a ^ c/  .b ^ c/ D .a ^ c ^ .b ^ c// _ .b ^ c ^ .a ^ c//
D .a ^ c ^ .b _ c// _ .b ^ c ^ .a _ c//
D .a ^ b ^ c/ _ .b ^ a ^ c/
D .a  b/ ^ b;
because a ^ c ^ c D ? D b ^ c ^ c. a

1.5. ZORN’S LEMMA AND TUCKEY’S MAXIMALITY. . .
53
Lemma 1.5.41 
I is an equivalence relation on B with these proper-
ties:
1. a 
I a0 and b 
I b0 imply a ^ b 
I a0 ^ b0 and a _ b 
I a0 _ b0.
2. a 
I a0 implies a 
I a0.
Proof Because a  a0 2 I and b  b0 2 I, we conclude that .a  a0/ _
.b  b0/ 2 I; thus
.a _ a0/  .b _ b0/  ..a _ b/ ^ .a ^ b// _ ..a0 _ b0/ ^ .a0 ^ b0//
D .a  a0/ _ .b  b0/ 2 I:
Since I is an ideal, we conclude .a _ a0/  .b _ b0/ 2 I.
From Lemma 1.5.40, we conclude that a ^ b 
I a0 ^ b 
I a0 ^ b0. The
assertion about complementation follows from Lemma 1.5.40 as well.
a
Denote by ŒxI the equivalence class of x 2 B, and let I W x 7!
ŒxI be the associated factor map. Deﬁne on the factor space B=I WD
fŒxI j x 2 Bg the operations
B=I; I
ŒaI ^ ŒbI WD Œa ^ bI ;
ŒaI _ ŒbI WD Œa _ bI ;
 ŒaI WD ŒaI :
We have also
ŒaI  ŒbI , a  .a ^ b/ 2 I , b  .a _ b/ 2 I;
a 2 I , a 
I ?:
The following statement is now fairly easy to prove. Recall that a ho-
momorphism f W .B; ^; _; / ! .B0; ^0; _0; 0/ is a map f W B ! B0
such that
f .a^b/ D f .a/^0f .b/; f .a_b/ Df .a/_0f .b/,andf .a/ D 0f .a/
for all a; b 2 B are valid.
Proposition 1.5.42 The factor space B=I is a Boolean algebra, and
I is a homomorphism of Boolean algebras.

54
CHAPTER 1. THE AXIOM OF CHOICE
Proof The operations on B=I are well deﬁned by Lemma 1.5.41 and
yield a lattice with Œ>I as the largest and and Œ?I as the small-
est element, resp. Hence  is a complementation operator on B=I be-
cause
ŒaI ^ ŒaI D Œ?I ;
ŒaI _ ŒaI D Œ>I :
It is evident from the construction that I is a homomorphism. a
The Prime Ideal Theorem implies that the Boolean algebra B=I has a
prime ideal J by Corollary 1.5.39. This observation leads to a stronger
version of this theorem for the given Boolean algebra.
Theorem 1.5.43 Let I be an ideal in a Boolean algebra. Then .AC/
implies that there exists a prime ideal K which contains I.
Proof 0. The plan of the proof is fairly straightforward: We know that
Plan
B=I has a maximal ideal by the Prime Ideal Theorem. This prime ideal
is lifted to the given Boolean algebra B, and then we claim that this is
the prime ideal on B we are looking for.
1. Construct the factor algebra B=I; then .AC/ implies that this Boolean
algebra has a prime ideal J . We claim that
K WD fx 2 B j ŒxI 2 J g
is the desired prime ideal. Since I D Œ?I 2 J , we see that I  K
holds; thus K 6D ;.
2. K is an ideal. If K D B, then > 2 K which would mean Œ>I 2 J ,
but this is impossible. Let a  b with b 2 K; hence a D a ^ b, so that
ŒaI D Œa ^ bI . Because b 2 K, we infer Œa ^ bI 2 J ; hence
ŒaI 2 J , so that a 2 K. If a; b 2 K, then a _ b 2 K, because J is an
ideal.
3. K is prime. In fact, we have
a ^ b 2 K
,
Œa ^ bI 2 J
,
ŒaI ^ ŒbI 2 J
)
ŒaI 2 J or ŒbI 2 J
,
a 2 K or b 2 K:
a
As a consequence, we can ﬁnd in a Boolean algebra for any given ele-
ment a 6D > a prime ideal which does contain it.

1.5. ZORN’S LEMMA AND TUCKEY’S MAXIMALITY. . .
55
Corollary 1.5.44 Let B be a Boolean algebra and assume that .AC/
holds.
1. Given a 6D >, there exists a prime ideal which contains a.
2. Given a; b 2 B with a 6D b, there exists a prime ideal which
contains a but not b.
3. Given a; b 2 B with a 6D b, there exists an ultraﬁlter which
contains a but not b.
Proof We ﬁnd a prime ideal K which extends the ideal fx 2 B j x  ag.
This establishes the ﬁrst part.
If a 6D b, we have a  b 6D ?, so a ^ b 6D ? or a ^ b 6D ?. Assume
the former; then there exists a prime ideal K with .a ^ b/ 2 K,
so that both b 2 K and a 2 K hold. Since a 2 K implies a 62
K, we are done with the second part. The third part follows through
Lemma 1.5.36. a
This yields one of the classics, the Stone Representation Theorem.
It states that each Boolean algebra is essentially a set algebra, i.e., a
Boolean algebra comprised of sets.
Theorem 1.5.45 Let B be a Boolean algebra, and assume that .AC/
holds. Then there exists a set S0 and a Boolean set algebra S  P .S0/
such that B is isomorphic to S.
Proof 0. We map each element of the Boolean algebra to the ultraﬁlters
Outline
in which it is contained as an element. This yields a map which is com-
patible with the Boolean structure, from which we obtain the objects we
are looking for.
1. Deﬁne
S0 WD fU j U is an ultraﬁlter on Bg;
 .b/ WD fU 2 S0 j b 2 U g:
Then these properties are easily established:
 .b1 ^ b2/ D  .b1/ \  .b2/;
 .b1 _ b2/ D  .b1/ [  .b2/;
 .b/ D S0 n  .b/:

56
CHAPTER 1. THE AXIOM OF CHOICE
For example, we obtain from Lemma 1.5.35 that
U 2  .b1 ^ b2/ , b1 ^ b2 2 U
, b1 2 U and b2 2 U
, U 2  .b1/ and U 2  .b2/
, U 2  .b1/ \  .b2/:
Similarly, U 2  .b/ , b 2 U , b 62 U , U 62  .b/ by
Lemma 1.5.21, because U is an ultraﬁlter.
3. Because we can ﬁnd by Corollary 1.5.44 for b1 6D b2 an ultraﬁlter
which contains b1, but not b2, we conclude that  is injective (this is ac-
tually the place where .AC/ is used). Thus the Boolean algebras B and
 

B

are isomorphic, and the latter one is comprised of sets. a
The Stone Representation Theorem gives a representation of a Boolean
algebra as a set algebra. So, at ﬁrst sight, the effort of introducing the
additional abstraction looks futile. But it is not. First, it does not say
that a Boolean algebra is always a full power set. Second, it is some-
times much easier in an application to work with an abstract tool like
a Boolean algebra than with a set algebra (because you then have to
cater for a carrier set, after all). A third reason is a classiﬁcation issue—
Boolean algebras are isomorphic to set algebras, are lattices then always
isomorphic to set lattices? The representation through down sets from
Example 1.5.30 seems to suggest just that. But looking at this repre-
sentation more closely, one sees that additional properties are probably
not preserved; for example, a Boolean algebra may be represented as
a lattice through its down sets, but it is far from clear that the repre-
sentation preserves also complements. Thus we do not have in general
such a clear-cut picture for general lattices, as we have for Boolean al-
gebras.
1.5.8
Compactness and Alexander’s Subbase Theorem
We will prove in this section Alexander’s Subbase Theorem as an ap-
plication for Zorn’s Lemma. The theorem states that when proving a
topological space compact, one may restrict one’s attention to a partic-
ular subclass of open sets, a class which is usually easier to handle than
the full family of open sets. This application of Zorn’s Lemma is in-
teresting because it shows in which way a maximality argument can be

1.5. ZORN’S LEMMA AND TUCKEY’S MAXIMALITY. . .
57
used for establishing a property through a subclass (rather than extend-
ing a property until maximality puts a stop to it, as we did in showing
that each vector space has a basis). Alexander’s Theorem is also a very
practical tool, as we will see later.
This section assumes that .AC/ holds.
We start with the closed interval Œu; v with 1 < u < v < C1 as
an important example of a compact space. It has the following property:
Each cover through a countable number of open intervals contains a
ﬁnite subcover which already cover the interval. This is what the famous
Heine–Borel Theorem states. We give below Borel’s proof [Fic64, vol.
I, p. 163].
Theorem 1.5.46 Let an interval Œu; v with 1 < u < v < C1 be
given. Then each cover
˚
xn; ynŒ j n 2 N

of Œu; v through a countable
number of open intervals contains a ﬁnite cover xn1; yn1Œ; : : : ; xnk;
ynkŒ.
Proof Suppose the assertion is false; then either Œu; 1=2.u C v/ or
Œ1=2.u C v/; v is not covered by ﬁnitely many of those intervals; select
the corresponding one, and call it Œa1; b1. This interval can be halved;
let Œa2; b2 be the half which cannot be covered by ﬁnitely many inter-
vals. Repeating this process, one obtains a sequence
˚
Œan; bn j n 2 N

of closed intervals, each having half of the length of its predecessor
and each one not being covered by an ﬁnite number of intervals from
˚
xn; ynŒ j n 2 N

. Because the lengths of the intervals shrink to zero,
there exists c 2 Œu; v with limn!1 an D c D limn!1 bn; hence
c 2 xm; ymŒ for some m. But there is some n0 2 N with Œan; bn 
xm; ymŒ for n  n0, contradicting the assumption that Œan; bn cannot
be covered by a ﬁnite number of those intervals. a
Although the proof is given for a countable cover, its analysis shows
that it goes through for an arbitrary cover of open intervals. This is so
because each cover induces a partition of the interval considered into
two parts, so a sequence of intervals will result in any case.
This section will discuss compact spaces which have the property that
an arbitrary cover contains a ﬁnite one.
To be on ﬁrm ground, we
ﬁrst introduce topological spaces as the kind of objects to be discussed
here.

58
CHAPTER 1. THE AXIOM OF CHOICE
Deﬁnition 1.5.47 Given a set X, a subset   P .X/ is called a topol-
ogy iff these conditions are satisﬁed:
 ;; X 2 .
 If G1; : : : ; Gk 2 , then G1 \ : : : \ Gk 2 , and thus  is closed
under ﬁnite intersections.
 If 0  , then S 0 2 , and thus  is closed under arbitrary
unions.
The pair .X; / is then called a topological space, and the elements of 
are called open sets. An open neighborhood U of an element x 2 X is
an open set U with x 2 U , a neighborhood of x is a set which contains
an open neighborhood of x.
These are the topologies one can always ﬁnd on a set X.
Example 1.5.48 P .X/ and f;; Xg are always topologies; the former
one is called the discrete topology, the latter one is called indiscrete. ✌
The topology one deals with usually on the reals is given by intervals,
and the plane is topologically described by open balls (well, they really
are disks, but they are given through measuring a distance, and in this
case the name “ball” sticks).
Example 1.5.49 Call a set G  R open iff for each x 2 G there exists
a; b 2 R with a < b such that x 2 a; bŒ  G; note that ; is open.
Then the open sets form a topology on the reals, which is also called the
interval topology.
Clearly, G is open iff, given x 2 G, there exists  > 0 with x  ; x C
Œ  G. Call a subset G  R2 of the Euclidean plane open iff, given
x 2 G, there exists  > 0 such that B.x/  G, where
B.hx1; x2i; r/ WD fhy1; y2i j
q
.y1  x1/2 C .y2  x2/2 < rg
is the open ball centered at hx1; x2i with radius r. ✌
Let .X; / be a topological space. If Y  X, then the trace of  on
Y gives a topology Y on Y , formally, Y WD fG \ Y j G 2 g, the
Y
subspace topology. This permits sometimes to transfer a property from
the space to its subsets.
A set F  X is called closed iff its complement X n F is open. Then
Closed set
both ; and X are closed, and the closed sets are closed (no pun intended)

1.5. ZORN’S LEMMA AND TUCKEY’S MAXIMALITY. . .
59
under arbitrary intersections and ﬁnite unions. We associate with each
set an open set and a closed set.
Deﬁnition 1.5.50 Let M  X; then
 M o WD SfG 2  j G  Mg is called the interior of M.
 M a WD TfF  X j M  F and F is closedg is called the
closure of M.
 @M WD M a n M o is called the boundary of M.
M o; M a; @M
We have always M o  M  M a; this is apparent from the deﬁnition.
Clearly, M o is an open set, and it is the largest open set which is con-
tained in M, so that M is open iff M D M o. Similarly, M a is a closed
set, and it is the smallest closed set which contains M. We also have M
is closed iff M D M a. The boundary @M is also a closed set, because
it is the intersection of two closed sets, and we have @M D @.X n M/.
M is closed iff @M  M. All this is easily established through the
deﬁnitions.
Look at the indiscrete topology: Here we have fxgo D ; and fxga D X
for each x 2 X. For the discrete topology, one sees Ao D Aa D A for
each A  X.
Example 1.5.51 In the Euclidean topology on R2 of Example 1.5.49,
we have
Br.x1; x2/a D fhy1; y2i j
q
.y1  x1/2 C .y2  x2/2  rg;
@Br.x1; x2/ D fhy1; y2i j
q
.y1  x1/2 C .y2  x2/2 D rg:
✌
Just to get familiar with boundaries
Lemma 1.5.52 Let .X; / be a topological space, A  X. Then x 2 @A
iff each open neighborhood of x has a nonempty intersection with A and
with X nA. In particular @A D @.X nA/ and @.A[B/  .@A/[.@B/.
Proof Let x 2 @A and U an open neighborhood of x. If A\U D ;, then
A  X nU , so x 62 Aa, and if U \X nA D ;, it follows x 2 Ao. So we
arrive at a contradiction. Assume that x 2 TfU 2  j x 2 U; U \ A 6D
;; U \ X n A 6D ;g; then x 62 Ao; similarly, x 62 X n Ao D X n .Aa/.
a

60
CHAPTER 1. THE AXIOM OF CHOICE
A set without a boundary is both closed and open, so it is called clopen.
Clopen set
The clopen sets of a topological space form a Boolean algebra.
Sometimes it is sufﬁcient to describe the topology in terms of some
special sets, like the open balls for the Euclidean topology. These balls
form a base in the following sense:
Deﬁnition 1.5.53 A subset ˇ   of the open sets is called a base for
the topology iff for each open set G 2  and for each x 2 G, there exists
B 2 ˇ such that x 2 B  G and thus iff each open set is the union of
all base elements contained in it.
Base,
subbase
A subset    is called a subbase for  iff the set of ﬁnite intersections
of elements of  forms a base for .
Then the open intervals are a base for the interval topology, and the open
balls are a base for the Euclidean topology (actually, we did introduce
the respective topologies through their bases). A subbase for the interval
topology is given by the sets
˚
  1; aŒ
j a 2 R

, because the set
of ﬁnite intersections includes all open intervals, which in turn form a
base. Bases and subbases are not uniquely determined, for example,
˚
r; sŒ j r < s; r; s 2 Q

is a base for the interval topology.
Let us return to the problem discussed in the opening of this section. We
have seen that bounded closed intervals have the remarkable property
that, whenever we cover them by an arbitrary number of open intervals,
we can ﬁnd a ﬁnite collection among these intervals which already cover
the interval. This property can be generalized to arbitrary topological
spaces; subsets with this property are called compact, formally:
Deﬁnition 1.5.54 The topological space .X; / is called compact iff
each cover of X by open sets contains a ﬁnite subcover.
Thus X is compact iff, whenever .Gi/i2I is a collection of open sets
with X D S
i2I Gi, there exists I0  I ﬁnite such that C  S
i2I0 Gi.
It is apparent that compactness is a generalization of ﬁniteness, so that
compact sets are somewhat small, measured in terms of open sets. Con-
sider as a trivial example the discrete topology. Then X is compact
precisely when X is ﬁnite.
This is an easy consequence of the deﬁnition.
Lemma 1.5.55 Let .X; / be a compact topological space and F  X
closed. Then .F; F / is a compact topological space. a

1.5. ZORN’S LEMMA AND TUCKEY’S MAXIMALITY. . .
61
The following example shows a close connection of Boolean algebras
to compact topological spaces; this is the famous Stone Duality Theo-
rem.
Example 1.5.56 Let B be a Boolean algebra with }B as the set of all
prime ideals of B. Deﬁne
Xa WD fI 2 }B j a 62 Ig:
Then we have these properties:
 X> D }B, since an ideal does not contain >.
 Xa D }B n Xa. To see this, let I be a prime ﬁlter, and then
I 2 Xa iff a 62 I; this is the case iff a 2 B n I and hence
iff a 62 B n I, since B n I is a maximal ﬁlter by Lemmas 1.5.36
and 1.5.37; the latter condition is equivalent to a 2 I and hence
to I 62 Xa.
 Xa^b D Xa \ Xb and Xa_b D Xa [ Xb. This follows similarly
from Lemma 1.5.35.
Deﬁne a topology  on }B by taking the sets Xa as a base, formally
ˇ WD fXa j a 2 Bg:
We claim that .}B; / is compact. In fact, let U be a cover of }B with
open sets. Because each U 2 U can be written as a union of elements
of ˇ, we may and do assume that U  ˇ, so that U D fXa j a 2 Ag for
some A  B. Now let J be the ideal generated by A, so that J can be
written as
J WD fb 2 B j b  a1 _ : : : _ ak for some a1; : : : ; ak 2 Ag:
We distinguish these cases:
> 2 J : In this case we have > D a1_: : :_ak for some a1; : : : ; ak 2 A,
which means
}B D X> D Xa1_:::_ak D Xa1 [ : : : [ Xak
with Xa1; : : : ; Xak 2 U, so we have found a ﬁnite subcover in U.
> 62 J : Then J is a proper ideal, so by Corollary 1.5.39 there exists
a prime ideal K with J  K. But we cannot ﬁnd a 2 A such

62
CHAPTER 1. THE AXIOM OF CHOICE
that K 2 Xa: Assume on the contrary that K 2 Xa for some
a 2 A, then a 62 K, and hence a 2 K, since K is prime
(Lemma 1.5.36). But by construction a 2 J , since a 2 A, which
implies a 2 K; hence > 2 K, a contradiction. Thus K 2 }B, but
K fails to be covered by U, which is a contradiction.
Thus .}B; / is a compact space, which is sometimes called the prime
ideal space of the Boolean algebra.
We conclude that the sets Xa are clopen, since Xa D }B n Xa.
Moreover, each clopen set in this space can be represented in this way.
In fact, let U be clopen, and thus U D SfXa j a 2 Ag for some
A  B. Since U is closed, it is compact by Lemma 1.5.55, so there
exist a1; : : : ; an 2 A such that U D Xa1 [ : : : [ Xan D Xa1_:::_an. ✌
Compactness is formulated in terms of a cover through arbitrary open
sets. Alexander’s Theorem states that it is sufﬁcient to consider covers
which come from a subbase for the topology. This is usually quite a
considerable help, since subbases are mostly easier to handle than the
collection of all open sets; Example 1.5.58 conﬁrms this impression.
The proof comes as an application of Zorn’s Lemma. The proof follows
essentially the one given in [HS65, Theorem 6.40].
Theorem 1.5.57 Let .X; / be a topological space with a subbase .
Then the following statements are equivalent:
1. X is compact.
2. Each cover of X by elements of  contains a ﬁnite subcover.
Proof 0. Because the elements of a subbase are open, the implication
1
)
2 is trivial; hence we have to show 2
)
1. The idea of
the proof goes as follows: If the assertion is false, there exists a cover
Proof outline
which does not have a ﬁnite subcover. Take the set of all these covers,
and order them by inclusion. It is not difﬁcult to see that each chain
has an upper bound in this set, so Zorn’s Lemma gives a maximal ele-
ment. Maximality is somewhat fragile here, because adding something
to this maximal element will break it. This will permit us to derive a
contradiction.
1. Assume that the assertion is false, and deﬁne
Z WD fC j C is on open cover of X without a ﬁnite subcoverg:

1.5. ZORN’S LEMMA AND TUCKEY’S MAXIMALITY. . .
63
Order Z by inclusion, and let Z0  Z be a chain; then C WD S Z0 2 Z. In
fact, it is clear that C is a cover, and assume that C has a ﬁnite subcover,
say fE1; : : : ; Ekg. Then Ej 2 Cj 2 Z0, and since Z0 is a chain with
respect to inclusion, we ﬁnd some Ci 2 Z0 with fE1; : : : ; Ekg  Ci,
which is a contradiction. By Zorn’s Lemma, Z has a maximal element
V. This means that
 V is an open cover of X.
 V does not contain a ﬁnite subcover.
 If U 2  is open with U 62 V, then V [ fU g contains a ﬁnite
subcover.
Let W WD V \ , and hence W contains all elements of V which are
taken from the subbase. By assumption, no ﬁnite subfamily of W covers
X; hence W is not a cover for X, which implies that R WD X n S W 6D
;. Let x 2 R; then there exists V 2 V such that x 2 V , because V is a
cover for X. Since V is open and  is a subbase, we ﬁnd S1; : : : ; Sk 2 
with x 2 S1 \ : : : \ Sn  V . Because x 62 S W, we conclude that no
Sj is an element of V (otherwise Sj 2 V \  D W, a contradiction). V
is maximal, each Sj is open, and thus V [ fSj g contains a ﬁnite cover
of X. Hence we can ﬁnd for each j some open set Aj which is a ﬁnite
union of elements in V such that Aj [ Sj D X. But this means
V [
k
[
jD1
Aj 	 .
k
\
jD1
Sj / [ .
k
[
jD1
Aj/ D X:
Hence X can be covered through a ﬁnite number of elements in V; this
is a contradiction to the maximality of V. a
Observe how .ZL/ enters the argument precisely when we need a max-
imal cover with no ﬁnite subcover.
The Priestley topology as discussed by Goldblatt [Gol12] provides a ﬁrst
example for the use of Alexander’s Theorem. It illustrates that using
a cover comprised of elements coming from a subbase simpliﬁes the
argumentation considerably.
Example 1.5.58 Given x 2 X, deﬁne
kxk WD fA  X j x 2 Ag;
kxk WD fA  X j x 62 Ag:

64
CHAPTER 1. THE AXIOM OF CHOICE
The Priestley topology on P .X/ is deﬁned as the topology which is
generated by the subbase
 WD fkxk j x 2 Xg [ fkxk j x 2 Xg:
Hence the basic sets of this topology have the form
kx1k \ : : : \ kxkk \ ky1k \ : : : \ kynk
for x1; : : : ; xk; y1; : : : ; yn 2 X and some n; k 2 N.
We claim that P .X/ is compact in the Priestley topology. In fact, let C
be a cover of P .X/ with elements from the subbase . Put P WD fx 2
X j kxk 2 Cg. Then P 2 P .X/, so we must ﬁnd some element from
C which contains P . If P 2 kxk 2 C for some x 2 X, this means
x 62 P , so by deﬁnition kxk 62 C, which is a contradiction. Thus there
exists x 2 X such that P 2 kxk 2 C. But this means x 2 P ; hence
kxk 2 C, so fkxk; kxkg  C is a cover of P .X/. Thus P .X/ is
compact by Alexander’s Theorem 1.5.57. ✌
Alexander’s Subbase Theorem will be of considerable help, e.g., when
characterizing compactness through ultraﬁlters in Theorem 3.2.11 and
in establishing Tihonov’s Theorem 3.2.12 on product compactness. It
also emphasizes the close connection of compactness and .AC/.
1.6
Boolean -Algebras
We generalize the notion of a Boolean algebra by introducing countable
operations, leading to Boolean -algebras. This extension becomes im-
portant, e.g., when working with probabilities or, more generally, with
measures. For example, one of the fundamental probability laws states
that the probability of a disjoint union of countable events equals the
inﬁnite sum of the events’ probabilities. In order to express this ade-
quately, the domain of the probability must be closed under countable
unions.
We assume in this section that .AC/ holds.
Given a Boolean algebra B, we associate as above with the lattice oper-
ations on B an order relation  by
a  b ” a ^ b D a .” a _ b D b/:

1.6. BOOLEAN -ALGEBRAS
65
We will switch in the discussion below between the order and the use of
the algebraic operations.
Deﬁnition 1.6.1 A Boolean algebra B is called a Boolean -algebra iff
it is closed under countable suprema and inﬁma.
Example 1.6.2 The power set of each set is a Boolean -algebra. Con-
sider
A WD fA  R j A is countable or R n A is countableg:
Then A is a Boolean -algebra (we use here that the countable union
of countable set is countable again, hence .AC/). This is sometimes
called the countable–cocountable -algebra. On the other hand, her
little sister,
D WD fA  R j A is ﬁnite or R n A is ﬁniteg;
the ﬁnite–coﬁnite algebra, is a Boolean algebra, but evidently not -
algebra. ✌
We deﬁne for the countable subset A D fan j n 2 Ng of a Boolean
algebra B
^
A WD
^
n2N
an WD inffan j n 2 Ng;
_
A WD
_
n2N
an WD supfan j n 2 Ng
as its inﬁmum resp. its supremum, in which both exist, since B is closed
under countable inﬁma and suprema. In addition, we note that
inf ; D >;
sup ; D ?:
We know that a Boolean algebra is a distributive lattice, in addition to
that a stronger inﬁnite distributive law holds for a Boolean -algebra.
Lemma 1.6.3 Let B be a Boolean -algebra and .an/n2N be a se-
quence of elements in B; then
b ^
_
n2N
an D
_
n2N
.b ^ an/;
b _
^
n2N
an D
^
n2N
.b _ an/
holds for any b 2 B.

66
CHAPTER 1. THE AXIOM OF CHOICE
Proof We establish the ﬁrst equality, and the second one follows by
duality. Since b^an  b and b^an  an, we see that W
n2N.b^an/ 
b ^W
n2N an: For establishing the reverse inequality, assume that s is an
upper bound to fb ^ an j n 2 Ng; hence b ^ an  s for all n 2 N, and
consequently, an D .b ^ an/ _ .b ^ an/  s _ .b ^ an/  s _ b:
Thus
b ^
_
n2N
an  b ^ .s _ b/ D .b ^ s/ _ .b ^ b/  b ^ s  s:
Hence s is an upper bound to b ^ W
n2N an as well. Now apply this to
the upper bound s WD W
n2N.b ^ an/. a
Let A be a nonempty subset of a Boolean -algebra B, and then there
exists a smallest -algebra C which contains A.
In fact, this must
be
C D
\
fD  B j D is a -algebra with A  Dg:
We ﬁrst note that the intersection of a set of -algebras is a -algebra
again. Moreover, there exists always a -algebra which contains A, viz.,
the superset B. Consequently, C, the object of our desire, is denoted by
.A/, so that .A/ denotes the smallest -algebra containing A.  is
.A/
an example for a closure operator: We have A  .A/, and A1  A2
implies .A1/  .A2/; moreover, applying the operator twice does
not yield anything new: ..A// D .A/.
Example 1.6.4 Let A WD fŒa; b j a; b 2 Œ0; 1g be the set of all
closed intervals Œa; b WD fx 2 R j a  x  bg of the unit interval
Œ0; 1. Denote by B WD .A/ the -algebra generated by A; the ele-
ments of B are sometimes called the Borel sets of Œ0; 1. Then the half
Borel sets
open intervals Œa; bŒ and a; b are members of B. We can write, e.g.,
Œa; bŒD S
n2NŒa; b  1=n. Since Œa; b  1=n 2 A  B for all n 2 N
and since B is closed under countable unions, the claim follows.
A more complicated Borel set is constructed in this way: Deﬁne C0 WD
Œ0; 1 and assume that Cn is deﬁned already as a union of 2n mutually
disjoint closed intervals of length 1=3n each, say Cn D S
1j2n Ij .
Obtain CnC1 by removing the open middle third of each interval Ij. For

1.6. BOOLEAN -ALGEBRAS
67
example,
C0 DŒ0; 1;
C1 DŒ0; 1=3 [ Œ2=3; 1;
C2 DŒ0; 1=9 [ Œ2=9; 1=3 [ Œ2=3; 7=9 [ Œ8=9; 1;
C3 DŒ0; 1=27 [ Œ2=27; 1=9 [ Œ2=9; 7=27 [ Œ8=27 [ Œ2=3; 19=27
[ Œ20=27; 7=9 [ Œ8=9; 25=27 [ Œ26=27; 1
and so on. Clearly Cn 2 B, because this set is the ﬁnite union of closed
intervals. Now put
C WD
\
n2N
CnI
then C 2 B, because it is the countable intersection of sets in B. This
Cantor set
set is known as the Cantor ternary set. ✌
The next two examples deal with -algebras of sets, each deﬁned on
the inﬁnite product f0; 1gN. It may be used as a model for an inﬁnite
sequence of ﬂipping coins—0 denoting head and 1 denoting tail. But
we can only observe a ﬁnite number of these events, probably as long as
we want. So we cater for that by having a look at the -algebra which
is deﬁned by these ﬁnite observations.
Example 1.6.5 Let X WD f0; 1gN be the set of all inﬁnite binary se-
quences, and put B WD .fAk;i j k 2 N; i D 0; 1g/ with Ak;i WD
fhx1; x2; : : :i j xk D ig as the set of all sequences, the kth component
of which is i.
We claim that for r 2 N0 both Sk;r WD fhx1; x2; : : :i 2 X j x1 C : : : C
xk D rg and Tr WD fhx1; x2; : : :i 2 X j P1
iD0 xi D rg are elements of
B.
In fact, given a ﬁnite binary sequence v WD hv1; : : : ; vki, the set
Qv WD fx 2 X j hx1; : : : xki D vg D
k
\
iD1
Ai;vi
is a member of B, and the set Lk;r of binary sequences of length k which
sum up to r is ﬁnite. Thus
Sk;r D
[
v2Lk;r
Qv 2 B:

68
CHAPTER 1. THE AXIOM OF CHOICE
Since
Tr D
[
n2N
Sn;r \

Xk 
Y
k>n
f0g

;
the assertion follows also for Tr. ✌
We continue the example by looking at all sequences for which the aver-
age result of ﬂipping a coin n times will converge as n tends to inﬁnity.
This is a bit more involved because we now have to take care of the
limit.
Example 1.6.6 Let X WD f0; 1gN be the set of all inﬁnite binary se-
quences as in Example 1.6.5, and put
W WD fhx1; x2; : : :i 2 X j 1
n
n
X
iD1
xi convergesg:
We claim that W 2 B, noting that a real sequence .yn/n2N converges
iff it is a Cauchy sequence, i.e., iff given 0 <  2 Q there exists n0 2 N
such that jym  ynj <  for all n; m  n0.
Given F  N ﬁnite, the set
HF WD fx 2 X j xj D 1 for all j 2 F and xi D 0 for all i 62 F g
D
\
j2F
Aj;1 \
\
i62F
Ai;0
is a member of B; since there are countably many ﬁnite subsets of
N which have exactly r elements, we obtain T D SfHF j F 
N with jF j D rg; which is a countable union of elements of B, hence
an element of B.
The sequence
 1
n
Pn
iD1 xi

n2N converges iff
8 > 0;  2 Q9n0 2 N8n  n08m  n0 W
ˇˇ1
n
n
X
iD1
xi  1
m
m
X
iD1
xi
ˇˇ <  and
thus iff
hx1; x2; : : :i 2
\
>0;2Q
[
n02N
\
N3nn0
\
N3mn0
Wn;m;
with
Wn;m; WD fhx1; x2; : : :i j
ˇˇ1
n
n
X
iD1
xi  1
m
m
X
iD1
xi
ˇˇ < g:

1.6. BOOLEAN -ALGEBRAS
69
Now hx1; x2; : : :i 2 Wn;m; iff
ˇˇm Pn
iD1 xi  n  Pm
jD1 xj
ˇˇ < n  m  :
If n < m, this is equivalent to
n  m   < .m  n/ 
n
X
iD1
xi  n 
m
X
jDnC1
xj < n  m  I
hence n  m   < .m  n/  a  n  b < n  m   for a D Pn
iD1 xi and
b D Pm
jDnC1 xj; the same applies to the case m < n. Since there are
only ﬁnitely many combinations of ha; bi satisfying these constraints,
we conclude that Wn;m; 2 B, so that the set W of all sequences for
which the average sum converges is a member of B as well. ✌
1.6.1
Construction Through Transﬁnite Induction
We will in this section show that the -algebra generated by a subset of
a Boolean -algebra can actually be constructed directly through trans-
ﬁnite induction. We have introduced .H/ as a closure operation, viz.,
the smallest -algebra containing H; this is an operation which works
from outside H. In contrast, the inductive construction works from the
inside, constructing .H/ through operations with the elements of H,
the elements derived from it, etc. In addition, the description of .A/
given above is nonconstructive. Transﬁnite induction permits us to con-
struct .A/ explicitly (if one dares to speak in these terms of a transﬁnite
operation).
In order to describe it, we introduce two operators on the subsets of B
as follows. Let H  B; then
H; Hı
H WD f
_
n2N
an j an 2 H for all n 2 Ng;
Hı WD f
^
n2N
an j an 2 H for all n 2 Ng:
Thus H contains all countable suprema of elements of H, and Hı
contains all countable inﬁma. Hence A is a Boolean sub -algebra of B
iff
A  A; Aı  A; and fa j a 2 Ag  A
hold.

70
CHAPTER 1. THE AXIOM OF CHOICE
So could we not, when constructing .A/, just take all complements,
then all countable inﬁma and suprema of elements in A, then their count-
able suprema and inﬁma, and so on? This is the basic idea for the
construction. But since the process indicated above is not guaranteed
to terminate after a ﬁnite number of applications of the - and the ı-
operations, we do a transﬁnite construction.
In order to implement this idea, we ﬁx a set algebra A  B; hence
A is a Boolean algebra. Thus, we have only to focus on the inﬁnitary
operations, and the union and intersection of two elements are special
cases. Deﬁne by transﬁnite induction
A0 WD A;
A WD
[
<
A; if 	 is a limit ordinal
AC1 WD .A/; if 	 is odd;
AC1 WD .A/ı; if 	 is even;
A!1 WD
[
<!1
A:
It is clear that A  C holds for each -algebra C which contains A, so
that A!1  .A/ is inferred.
Let us work on the other inclusion. It is sufﬁcient to show that A!1
is a -algebra. This is so because A  A!1, so that in this case A!1
would contribute to the intersections deﬁning .A/; hence we could
infer A!1  .A/. We prove the assertion through a series of auxiliary
statements, noting that hA j 	 < !1i forms a chain with respect to set
inclusion.
Lemma 1.6.7 For each 	 < !1, if a 2 A, then a 2 AC1.
Proof 0. The proof proceeds by transﬁnite induction on 	; it will have
to discuss the case that 	 is a limit ordinal and distinguish whether 	 is
Plan
even or odd.
1. The assertion is true for 	 D 0. Assume for the induction step that it
is true for all  < 	.
2. If 	 is a limit ordinal, we know that we can ﬁnd for a 2 A an ordinal
 < 	 with a 2 A, hence by induction hypothesis a 2 AC1  A,

1.6. BOOLEAN -ALGEBRAS
71
because  C 1 < 	 by the deﬁnition of a limit ordinal (see Deﬁni-
tion 1.4.8 on page 22).
If 	 is even, but not a limit ordinal, we can write 	 as 	 D 
 C 1. Then
A D .A/, and hence a D W
n2N an for some an 2 A  A, so that
a D V
n2N.an/ 2 .A/ı D AC1. The argumentation for 	 odd is
exactly the same. a
Thus A!1 is closed under complementation. Closure under countable
inﬁma and suprema is shown similarly, but we have to cater for a count-
able sequence of countable ordinals.
Lemma 1.6.8 A!1 is closed under countable inﬁma and countable
suprema.
The proof rests on the observation that the supremum of a countable
number of countable ordinals is countable again (or, putting it differ-
ently, that !1 is not reachable by countable suprema of countable ordi-
Basic
observation
nals).
Proof We focus on countable suprema; the proof for inﬁma works ex-
actly in the same way. Let .an/n2N be a sequence of elements in A!1;
then we ﬁnd ordinal numbers 	n < !1 such that an 2 An. Because
	n is countable for each n 2 N, we conclude from Proposition 1.4.17
that 	 WD S
n2N 	n is a countable ordinal, so that 	 < !1. Because
hA j 	 < !1i forms a chain, we infer that an 2 A for all n 2 N.
Consequently, W
n2N an 2 .A/  A!1. a
Thus we have shown
Proposition 1.6.9 A!1 D .A/. a
To summarize, we have two possibilities to construct the -algebra gen-
erated by an algebra A: We can use the closure operation suggested
by the -operator, or we can go through the explicit construction using
transﬁnite induction. One usually prefers the ﬁrst way, since it is easier
to handle, and, as we will see, information about the context will be eas-
ier to be factored in. But sometimes one does not have another choice
but going the inductive way. An immediate use of this construction will
be the Extension Theorem 1.6.29 for measures.

72
CHAPTER 1. THE AXIOM OF CHOICE
1.6.2
Factoring Through -Ideals
Factoring a Boolean -algebra through an ideal works as for general
Boolean algebras, resulting in a Boolean algebra again. There is no
reason why the factor algebra should be a -algebra, however, so if we
want to obtain a -algebra, we have to make stronger assumptions on
the object used for factoring.
Deﬁnition 1.6.10 Let B be a Boolean algebra and I  B an ideal. I
is called a -ideal iff supn2N an 2 I, provided an 2 I for all n 2 N.
Not every ideal is a -ideal: fF  N j F is ﬁniteg is an ideal but cer-
tainly not a -ideal in P .N/, even if P .N/ is a Boolean -algebra.
The following statement is the -variant of Proposition 1.5.42; its proof
follows [Aum54, p. 79] quite closely.
Proposition 1.6.11 Let B be a Boolean -algebra and I  B be a
-ideal. Then B=I is a Boolean -algebra.
Proof 1. Because each Boolean -algebra is a Boolean algebra and each
Approach
-ideal is an ideal, we may conclude from Proposition 1.5.42 that B=I
is a Boolean algebra. Hence it remains to be shown that this Boolean
algebra is closed under countable suprema; since B=I is closed under
complementation, closedness under countable inﬁma will follow.
2. Let an 2 B, and then a WD W
n2N an 2 B. We claim that ŒaI D
W
n2N ŒanI . Because an  a for all n 2 N, we conclude that ŒanI 
ŒaI for all n 2 N; hence W
n2N ŒanI  ŒaI . Now let ŒanI 
ŒbI for all n 2 N; then we show that ŒaI  ŒbI . In fact, because
ŒanI  ŒbI , we conclude that cn WD an.an^b/ 2 I and b^cn D
? for all n 2 N (since cn D an ^.an^b/). Thus an D cn _.an ^cn/,
so that we have W
n2N an D .a ^ b/ _ W
n2N cn by the inﬁnite distribu-
tive law from Lemma 1.6.3. This implies a  .a ^ b/ D W
n2N cn 2 I,
or, equivalently, ŒaI  ŒbI . Consequently, ŒaI is the smallest
upper bound to fŒanI j n 2 Ng. a
This construction will be put to use later on when we want to identify
sets which differ only by a set of measure zero. Then it will turn out that
this equivalence relation on subsets is based on a -ideal. But before we
can do that, we have to know what a measure is. This is what we will
discuss next.

1.6. BOOLEAN -ALGEBRAS
73
1.6.3
Measures
Boolean -algebras model events. The top element > is interpreted as
an event which can happen unconditionally and always; the bottom ele-
ment ? is the impossible event. The complement of an event is an event,
and if we have a countable sequence of events, then their supremum is
an event, viz., the event that at least one of the events in the sequence
happens.
To illustrate, suppose that we have a set T of traders which may form
unions or coalitions; then T and ; are coalitions; if A is a coalition, then
T n A is a coalition as well, and if An is a coalition for each n 2 N, then
we want to be able to form the “big” coalition S
n2N An. Hence the set
of all coalitions forms a -algebra.
We deal in the sequel with set-based -algebras, so we ﬁx a set S of
events.
Deﬁnition 1.6.12 Let C  P .S/ be a family of sets with ; 2 C. A map
 W C ! Œ0; 1 with .;/ D 0 is called
1. monotone iff .A/  .B/ for A; B 2 C; A  B,
2. additive iff .A [ B/ D .A/ C .B/ for all A; B 2 C, with
A [ B 2 C and A \ B D ;,
3. countably subadditive iff .S
n2N An/  P
n2N .An/; when-
ever .An/n2N is a sequence of sets in C with S
n2N An 2 C,
4. countably additive iff .S
n2N An/ D P
n2N .An/; whenever
.An/n2N is a mutually disjoint sequence of sets in C with S
n2N
An 2 C,
If C is a -algebra, then a map  W C ! Œ0; 1 with .;/ D 0 is called
a measure iff  is monotone and countably additive. If S can be written
as S D S
n2N Sn with Sn 2 C and .Sn/ < 1 for all n 2 N, then the
measure is called -ﬁnite.
We permit that  assumes the value C1. Clearly, a countably additive
set function is additive, and it is countably subadditive, provided it is
monotone.

74
CHAPTER 1. THE AXIOM OF CHOICE
Example 1.6.13 Let S be a set, and deﬁne for a 2 S; A  S
ıa.A/ WD
(
1;
if a 2 A
0;
otherwise:
Then ıa is a measure on the power set of S. It is usually referred to as
the Dirac measure on a. ✌
Dirac
measure
A slightly more complicated example indicates the connection to ultra-
ﬁlters.
Example 1.6.14 Let  W P .S/ ! f0; 1g be a binary-valued measure.
Deﬁne
F WD fA  S j .A/ D 1g:
Then F is an ultraﬁlter on P .S/. First, we check that F is a ﬁlter:
; 62 F is obvious, and if A 2 F with A  B, then certainly B 2 F. Let
A; B 2 F, then 2 D .A/ C .B/ D .A [ B/ C .A \ B/, hence
.A \ B/ D 1, and thus A \ B 2 F. Thus F is indeed a ﬁlter. It is also
an ultraﬁlter by Lemma 1.5.21, because A 62 F implies S n A 2 F.
The converse construction, viz., to generate a binary-valued measure
from a ﬁlter, would require S
n2N An 2 F if and only if there exists
n 2 N with An 2 F for any disjoint family .An/n2N. This, however,
leads to very deep questions on set theory; see [Jec06, Chap. 10] for a
discussion. ✌
Let us have a look at an important example.
Example 1.6.15 Let C WD
˚
a; b j a; b 2 Œ0; 1

be all left open, right
closed intervals of the unit interval. Put `.a; b/ WD b  a; hence `.I/
is the length of interval I. Note that `.;/ D `.a; a/ D 0. Certainly
` W C ! RC is monotone and additive.
1. If Sk
iD1ai; bi  a; b and the intervals are disjoint, then Pk
iD1
`.ai; bi/  `.a; b/. The proof proceeds by induction on the
number k of intervals. For the induction step, we have mutu-
ally disjoint intervals with SkC1
iD1 ak; bk  a; b. Renumber-
ing, if necessary, we may assume that a1  b1  a2  b2 
: : :  ak  bk  akC1  bkC1. Then Pk
iD1 `.ai; bi/ C
`.akC1; bkC1/  `.a1; bk/ C `.akC1; bkC1/  `.a; b/,
because ` is monotone and additive.

1.6. BOOLEAN -ALGEBRAS
75
2. If S1
iD1ai; bi a; b and the intervals are disjoint, then Pk
iD1
`.ai; bi/  `.a; b/ for all k; hence
1
X
iD1
`.ai; bi/ D sup
k2N
k
X
iD1
`.ai; bi/  `.a; b/:
3. If a; b  Sk
iD1ai; bk, then `.a; b/  Pk
iD1 `.ai; bi/ with
no necessarily disjoint intervals. This is established by induction
on k. If k D 1, the assertion is obvious. The induction step pro-
ceeds as follows: Assume that a; b  SkC1
iD1 ai; bk. By renum-
bering, if necessary, we can assume that akC1 < b  bkC1. If
akC1  a, the assertion follows, so let us assume that a < akC1.
Then a; akC1  Sk
iD1ai; bi; so that by the induction hypoth-
esis akC1  a D `.a; akC1/  Pk
iD1 `.ai; bi/: Thus
`.b; a/ D ba  .akC1a/C.bkC1akC1/ 
kC1
X
iD1
`.ai; bi/:
4. Now assume that a; b  S1
iD1ai; bi: This is a little bit more
complicated since we do not know whether the interval a; b is
covered already by a ﬁnite number of intervals, so we have to
resort to a little trick. The interval ŒaC; b is closed and bounded,
hence compact, for every ﬁxed  > 0; we also know that for each
i 2 N the semi-open interval ai; bi is contained in the open
interval ai; bi C =2iŒ, so that we have
Œa C ; b 
1
[
iD1
ai; bi C =2iŒ:
By the Heine–Borel Theorem 1.5.46, we can ﬁnd a ﬁnite sub-
set of these intervals which cover Œa C ; b, say Œa C ; b 
S
i2Kai; bi C =2iŒ; with K  N ﬁnite. Hence
a C ; b 
[
i2K
ai; bi C =2i;
and we conclude from the ﬁnite case that
b  .a C /
D
`.Œa C ; b/ 
X
i2K
`.ai; bi C =2i/
D
1
X
iD1
.bi C =2i  ai/ <
1
X
iD1
`.ai; bi/ C :

76
CHAPTER 1. THE AXIOM OF CHOICE
Since  > 0 was arbitrary, we have established
`.a; b/ 
1
X
iD1
`.ai; bi/:
✌
Thus we have shown
Proposition 1.6.16 Let C be the set of all left open, right closed inter-
vals of the unit interval, and denote by `.a; b/ WD b  a the length
of interval a; b 2 C. Then ` W C ! RC is monotone and countably
additive. a
When having a look at C, we note that this family is not closed under
complementation, but the complement of a set in C can be represented
through elements of C, e.g., 0; 1 n 1=3; 1=2 D0; 1=3 [ 1=2; 1. This
is captured through the following deﬁnition:
Deﬁnition 1.6.17 R  P .S/ is called a semiring iff
1. ; 2 R,
2. R is closed under ﬁnite intersections,
3. If B 2 R, then there exists a ﬁnite family of mutually disjoint sets
C1; : : : ; Ck 2 R with S n B D C1 [ : : : [ Ck:
Thus the complement of a set in R can be represented through a ﬁnite
disjoint union of elements of R.
We want to extend ` W C ! RC from the semiring of left open, right
closed intervals to a measure  on the -algebra .C/. This measure
is fairly Important; it is called the Lebesgue measure on the unit inter-
Lebesgue
measure
val.
A ﬁrst step toward an extension of ` to the -algebra generated by the
intervals is the extension to the algebra generated by them. This can be
accomplished easily once this algebra has been identiﬁed.
Lemma 1.6.18 Let C be the set of all left open, right closed intervals in
0; 1. Then the algebra generated by C consists of all disjoint unions of
elements of C.

1.6. BOOLEAN -ALGEBRAS
77
Proof Denote by
D WD
˚ n
[
iD1
ai; bi j n 2 N; a1  b1  a2  b2 : : :  an  bn

:
Then all elements of D are certainly contained in the algebra generated
by C. If we can show that D is an algebra itself, we are done, because
then D is the smallest algebra containing C.
D is certainly closed under ﬁnite unions and ﬁnite intersections, and
; 2 D. Then
0; 1 n
n
[
iD1
ai; bi D0; a1 [ b1; a2 [ : : : [ bn; 1;
which is a member of D as well. Thus D is also closed under comple-
mentation and hence is an algebra. a
This permits us to extend ` to the algebra generated by the Intervals.
Corollary 1.6.19 ` extends uniquely to the algebra generated by C such
that the extension is monotone and countably additive.
Proof Put
`
 n
[
iD1
ai; bi

WD
n
X
iD1
`.ai; bi/;
whenever ai; bi 2 C. This is well deﬁned. Assume
n
[
iD1
ai; bi D
m
[
jD1
cj; dj I
then ai; bi can be represented as a disjoint union of those intervals
cj; dj  which it contains, so that we have
n
X
iD1
`.ai; bi/ D
n
X
iD1
m
X
jD1
`.ai; bi\cj; dj /
D
m
X
jD1
m
X
iD1
`.cj; dj \ai; bi/
D
m
X
jD1
`.cj; dj /:

78
CHAPTER 1. THE AXIOM OF CHOICE
We may conclude from Example 1.6.15 that ` is countably additive on
the algebra. a
For the sake of illustration, let us assume that we have Lebesgue mea-
sure constructed already, and let us compute .C/ where C is the Cantor
ternary set constructed in Example 1.6.4 on page 66. The construction
of the ternary set is done through sets Cn, each of which is the union of
2n mutually disjoint intervals of length 3n. If I is an interval of length
3n, we know that .I/ D 3n, so that .Cn/ D .2=3/n: We also know
that C1 	 C2 	 : : :, so that we have a descending chain of sets with
C D T
n2N Cn and infn2N .Cn/ D 0.
In order to compute .C/, we need so know something about the behav-
ior of measures when monotone limits of sets are encountered.
Lemma 1.6.20 Let  W A ! Œ0; 1 be a measure on the -algebra A.
1. If An 2 A is a monotone increasing sequence of sets in A and
A D S
n2N An, then .A/ D supn2N .An/:
2. If An 2 A is a monotone decreasing sequence of sets in A and
A D T
n2N An, then .A/ D infn2N .An/; provided .Ak/ <
1 for some k 2 N.
Proof 1. We can write An D Sn
iD1 Bi with B1 WD A1 and Bi WD Ai n
Ai1. Because the An form an increasing sequence, the Bn are mutually
disjoint. Assume without loss of generality that .An/ < 1 for all
n 2 N (otherwise the assertion is trivial); then by countable additivity
and through telescoping
.A/
D
1
X
iD1
.Bi/ D .A1/ C
1
X
iD1

.AiC1/  .Ai/

D
lim
n!1 .An/ D sup
n2N
.An/:
2. Assume .A1/ < 1, and then the sequence A1 n An is increasing
toward A1 n A; hence
.A/ D .A1/  .A1 n A/ D .A1/  sup
n2N
.A1 n An/ D inf
n2N .An/:
a

1.6. BOOLEAN -ALGEBRAS
79
Ok, so let us return to the discussion of Cantor’s set. We know that
.Cn/ D .2=3/n and that C1 	 C2 	 C3 : : :, so we conclude
.C/ D inf
n2N .Cn/ D 0:
We have identiﬁed a geometrically fairly complicated set which has
measure zero. This set is not easy to visualize, since it does not con-
tain an interval of positive length.
Now ﬁx a semiring C  P .S/ and  W C ! Œ0; 1 with .;/ D 0,
which is monotone and countably subadditive. We will ﬁrst compute an
outer approximation for each subset of S by elements of C. But since
the subsets of S may be as a whole somewhat inaccessible and since C
may be somewhat small, we try to cover the subsets of S by countable
unions of elements of C and take the best approximation we can, i.e., we
take the inﬁmum. Deﬁne
.A/ WD inf
˚P
n2N .Cn/ j A  S
n2N Cn; Cn 2 C

for A  S. This is the outer measure of A associated with .
These are some interesting (for us, that is) properties of .
Lemma 1.6.21  W P .S/ ! Œ0; 1 is monotone and countably sub-
additive, .;/ D 0. If A 2 C, then .A/ D .A/.
Proof 1. Let .An/n2N be a sequence of subset of S; put A WD S
n2N An.
If P
n2N .An/ < 1, ﬁxing n, we ﬁnd a cover fCn;m j m 2 Ng  C
for An with
.An/ 
X
m2N
.Cn;m/  .An/ C =2n; and
thus fCn;m j n; m 2 Ng  C is a cover of A with
.A/ 
X
n;m2N
.Cn;m/ 
X
n2N
.An/ C :
Since  > 0 was arbitrary, we conclude .A/  P
n2N .An/: If,
however, P
n2N .An/ D 1, the assertion is immediate.
2. The other properties are readily seen. a

80
CHAPTER 1. THE AXIOM OF CHOICE
The next step is somewhat mysterious—it has been suggested by
Carath´eodory around 1914 for the construction of a measure exten-
sion.
It splits a set A D .A \ X/ [ .A \ S n X/ along an arbi-
trary other set X, and look what happens to the outer measure.
If
.A/ D .A \ X/ C .A \ S n X/; then A is considered well
behaved. Those sets which are well behaved no matter what set X we
use for splitting are considered next.
Deﬁnition 1.6.22 A set A  S is called -measurable iff .X/ D
.X \ A/ C .X \ S n A/ holds for all X  S. The set of all
-measurable sets is denoted by C.
C
So take a -measurable set A and an arbitrary subset X  S; then X
splits into a part X \ A which belongs to A and another one X \ S n A
outside of A. Measuring these pieces through , we demand that they
add up to .X/ again.
These properties are immediate.
Lemma 1.6.23 The outer measure has these properties:
1. .;/ D 0.
2. .A/  0 for all A  S.
3.  is monotone.
4.  is countably subadditive.
Proof We establish only the last property. Here we have to show that
.S
n2N An/  P
n2N .An/: We may and do assume that all
.An/ are ﬁnite. Given  > 0, we ﬁnd for each n 2 N a sequence
Bn;k 2 C for An such that An  S
k2N Bn;k and P
k2N .Bn;k/ 
.An/ C =2n: Thus
X
n;k2N
.Bn;k/ 
X
n2N
..An/ C =2n/ <
X
n2N
.An/ C ;
which implies P
n2N .An/  .S
n2N An/; because S
n2N An 
S
n;k2N Bn;k and because  > 0 was arbitrary. a
Because of countably subadditivity, we conclude
Corollary 1.6.24 A 2 C iff .X \ A/ C .X \ S n A/  .X/
for all X  S. a

1.6. BOOLEAN -ALGEBRAS
81
Let us have a look at the set of all -measurable sets. It turns out that
the originally given sets are all -measurable and that C is an alge-
bra.
Proposition 1.6.25 C is an algebra. Also if  is additive, C  C and
.A/ D .A/ for all A 2 C.
Proof 1. C is closed under complementation; this is obvious from its
deﬁnition, and S 2 C is also clear. So we have only to show that C
is closed under ﬁnite intersections. For simplicity, denote complemen-
tation by c.
Now let A; B 2 C; we want to show
.X/  ..A \ B/ \ X/ C ..A \ B/c \ X/;
for each X  S; from Corollary 1.6.24, we infer that this implies A \
B 2 C. Since B 2 C and then A 2 C, we know
.X/ D .X \ B/ C .X \ Bc/
D 
X \ .A \ B/

C 
X \ .Ac \ B/

C 
X \ .A \ Bc/

C 
X \ .Ac \ Bc/

 
X \ .A \ B/

C 
X \ ..Ac \ B/ [ .A \ Bc/
[ .Ac \ Bc//

.	/
D 
X \ .A \ B/

C 
X \ .A \ B/c
:
Equality ./ uses
.Ac \ B/ [ .A \ Bc/ [ .Ac \ Bc/ D

Ac \ .B [ Bc/

[ .A \ Bc/
D Ac [ .A \ Bc/
D Ac [ Bc:
Hence we see that A \ B satisﬁes the deﬁning inequality.
2. We still have to show that C  C and that  extends . Let
A 2 C, and then S n A D D1 [ : : : [ Dk for some mutually disjoint
D1; : : : ; Dk 2 C, because C is a semiring. Fix X  S, and assume
that .S/ < 1 (otherwise, the assertion is trivial). Given  > 0, there
exists in C a cover .An/n2N of X with .X/ < P
n2N .An/C: Now
put Bn WD A\An and Ci;n WD An \Di. Then X \A  S
n2N Bn with

82
CHAPTER 1. THE AXIOM OF CHOICE
Bn 2 C and X \ Ac  S
n2N;1ik Ci;n with Ci;n 2 C. Hence
.X \ A/ C .X \ AC / 
X
n2N
.Bn/ C
X
n2N;1ik
.Ci;n/

X
n2N
.An/
< .X/  ;
because  is (ﬁnitely) additive. Hence A 2 C.  is an extension to 
by Lemma 1.6.21. a
But we can in fact say more on the behavior of  on C: It turns out to
be additive on the splitting parts.
Lemma 1.6.26 Let D  C be a ﬁnite or inﬁnite family of mutually
disjoint sets in C; then
.X \
[
D2D
D/ D
X
D2D
.X \ D/
holds for all X  S.
Proof 1. The proof goes like this: We establish the equality above
Plan
for ﬁnite D, say, D D fA1; : : : ; Ang with An 2 C for 1  j  n.
From this we obtain the equality for the countable case as well, because
then
.X \
1
[
iD1
Ai/  .X \
n
[
iD1
Ai/ D
n
X
iD1
.X \ Ai/;
for all n 2 N, so that .X \ S1
iD1 Ai/  P1
iD1 .X \ Ai/; which
together with countable subadditivity gives the desired result.
2. The proof for .X \ Sn
iD1 Ai/ D Pn
iD1 .X \ Ai/ proceeds
by induction on n, starting with n D 2. If A1 [ A2 D S, this is just
the deﬁnition that A1 (or A2) is -measurable, so the equality holds. If
A1 [ A2 6D S, we note that
.X/D
.X \ .A1 [ A2// \ A1

C 
.X \ .A1 [ A2// \ S n A1

:
Evaluating the pieces, we see that

X \ .A1 [ A2/

\ A1 D X \ A1;

X \ .A1 [ A2/

\ S n A1 D X \ A2;

1.6. BOOLEAN -ALGEBRAS
83
because A1 \ A2 D ;. The induction step is straightforward:
.X \
nC1
[
iD1
Ai/ D ..X \
n
[
iD1
An/ [ .X \ AnC1//
D
n
X
iD1
.X \ Ai/ C .X \ AnC1/
D
nC1
X
iD1
.X \ Ai/:
a
We can relax the condition on a set being a member of C if we know
that the domain C from which we started is an algebra and that  is
additive on C. Then we do not have to test whether a -measurable set
splits all the subsets of S, but it is rather sufﬁcient that A splits S, to be
speciﬁc
Proposition 1.6.27 Let C be an algebra and  W C ! Œ0; C1 be addi-
tive. Then A 2 C iff .A/ C .S n A/ D .S/.
Proof This is a somewhat lengthy and laborious computation similarly
to the one above; see [Bog07, 1.11.7, 1.11.8]. a
Returning to the general discussion, we have
Proposition 1.6.28 C is a -algebra, and  is countably additive on
C.
Proof 0. Let .An/n2N be a countable family of mutually disjoint sets in
C, then we have to show that A WD S
n2N An 2 C, and thus we have
to show that
.X \ A/ C .X \ Ac/  .X/
for each X  S (here c is complementation again). Fix X.
1. We know that C is closed under ﬁnite unions, so we have for each
n 2 N
.X/ 
n
X
iD1
.X \ Ai/ C .X \
n
\
iD1
Ac
i /

n
X
iD1
.X \ Ai/ C .X \ A/;

84
CHAPTER 1. THE AXIOM OF CHOICE
because Tn
iD1 Ac
i
	 Ac.
Letting n ! 1 we obtain the desired
inequality.
3. Thus C is closed under disjoint countable unions. Using the ﬁrst
entrance trick (Exercise 1.37) and the observation that C is an algebra
by Proposition 1.6.25, we convert each countable union into a countable
union of mutually disjoint sets, so we have shown that C is a -algebra.
Countable additivity of  on C follows from Lemma 1.6.26 when
putting X WD S. a
Summarizing, we have demonstrated this Extension Theorem.
Theorem 1.6.29 Let C be an algebra over a set S and  W C ! Œ0; 1
monotone and countably additive.
Extension
Theorem
1. There exists an extension of  to a measure on the -algebra .C/
generated by C.
2. If  is -ﬁnite, the extension is uniquely determined.
Proof 0. For establishing the existence of an extension, we simply col-
lect the results obtained so far. For a ﬁnite measure, we obtain unique-
Steps in the
proof
ness by following the construction of .C/ through transﬁnite induction,
as outlined in Sect. 1.6.1; note that ﬁniteness is necessary here because
we are bound by Lemma 1.6.20 to ﬁnite measures for establishing the
limit of a decreasing sequence. Finally, we localize the measure in the
-ﬁnite case to the countably many ﬁnite pieces which make up the en-
tire space.
1. Proposition 1.6.28 shows that C is a -algebra containing C and
that  is a measure on C. Hence .C/  C, and we can restrict
 to .C/. Denote this restriction also by ; then  is a measure on
.C/.
2. In order to establish uniqueness, assume ﬁrst that .S/ < 1. Let 
be a measure which extends  to .C/. Recall the construction of .C/
through transﬁnite induction on page 70. We claim that
.A/ D .A/ for all A 2 C
holds for all ordinals 	 < !1. Because C is an algebra, it is easy to
see that for odd ordinals 	 a set A 2 .C/ı iff there exists a decreasing
sequence .An/n2N  C with A D T
n2N An; similarly, each element
of .C/ can be represented as the union of an increasing sequence of

1.6. BOOLEAN -ALGEBRAS
85
elements of A if 	 is even. Assume for the induction step that 	 is
odd, and let A 2 CC1; thus A D T
n2N An with A1 	 A2 	 : : : and
An 2 C. Hence by Lemma 1.6.20
.A/ D .
\
n2N
An/ D inf
n2N .An/ D inf
n2N .An/ D .A/:
Thus  and  coincide on CC1, if 	 is odd. One argues similarly, but
with a monotone increasing sequence in the case that 	 is even. If  and
 coincide on all C for all  with  < 	 for a limit number 	, then it is
clear that they also coincide on C as well.
3. Assume that .S/ D 1, but that there exists a sequence .Sn/n2N in
C with .Sn/ < 1 and S D S
n2N Sn. Because .S1 [ : : : [ Sn/ 
.S1/ C : : : C .Sn/ < 1; we may and do assume that the sequence is
monotonically increasing. Let n.A/ WD .A \ Sn/ be the localization
of  to Sn. n has a unique extension to .C/, and since we have
.A/ D supn2N n.A/ for all A 2 .C/, the assertion follows. a
But we are not quite done yet, witnessed by a glance at Lebesgue mea-
sure. There we started from the semiring of intervals, but our uniqueness
theorem states only what happens when we carry out our extension pro-
cess starting from an algebra.
It turns out to be most convenient to have a closer look at the con-
struction of -algebras when the family of sets we start from has al-
ready some structure. This gives the occasion to introduce Dynkin’s
--Theorem. This is a very important tool, which sometimes simpli-
ﬁes the identiﬁcation of the -algebra generated from some family of
sets.
Theorem 1.6.30 (--Theorem) Let P be a family of subsets of S that
is closed under ﬁnite intersections (this is called a -class). Then .P/
is the smallest -class containing P, where a family L of subsets of S is
--
Theorem
called a -class iff it is closed under complements and countable disjoint
unions.
Proof 1. Let L be the smallest -class containing P ; then we show that
L is a -algebra.
2. We show ﬁrst that it is an algebra. Being a -class, L is closed under
complementation. Let A  S; then LA WD fB  S j A \ B 2 Lg is a

86
CHAPTER 1. THE AXIOM OF CHOICE
-class again: If A \ B 2 L, then
A \ .S n B/ D A n B D S n ..A \ B/ [ .S n A//;
which is in L, since .A \ B/ \ S n A D ; and since L is closed under
disjoint unions.
If A 2 P, then P  LA, because P is closed under intersections. Be-
cause LA is a -system, this implies L  LA for all A 2 P. Now take
B 2 L, then the preceding argument shows that P  LB, and again
we may conclude that L  LB. Thus we have shown that A \ B 2 L,
provided A; B 2 L, so that L is closed under ﬁnite intersections. Thus
L is a Boolean algebra.
3. L is a -algebra as well. It is enough to show that L is closed under
countable unions. But since
[
n2N
An D
[
n2N
 
An n
n1
[
iD1
Ai
!
;
this follows immediately. a
Consider an immediate and fairly typical application. It states that two
ﬁnite measures are equal on a -algebra, provided they are equal on a
generator which is closed under ﬁnite intersections. The proof technique
Principle of
good sets
called the principle of good sets in [Els99] is worth noting: We collect
all sets for which the assertion holds into one family of sets and investi-
gate its properties, starting from an originally given set. If we ﬁnd that
the family has the desired property, then we look at the corresponding
closure. With this in mind, we have a look at the proof of the following
statement:
Lemma 1.6.31 Let ;  be ﬁnite measures on a -algebra .B/, where
B is a family of sets which is closed under ﬁnite intersections. Then
.A/ D .A/ for all A 2 .B/, provided .B/ D .B/ for all B 2 B.
Proof We investigate the family of all sets for which the assertion is
true. Put
G WD fA 2 .B/ j .A/ D .A/gI
then G has these properties:
 B  G by assumption.
 Since B is closed under ﬁnite intersections, S 2 B  G:

1.6. BOOLEAN -ALGEBRAS
87
 G is closed under complements.
 G is closed under countable disjoint unions; in fact, let .An/n2N
be a sequence of mutually disjoint sets in G and A WD S
n2N An;
then
.A/ D
X
n2N
.An/ D
X
n2N
.An/ D .A/;
hence A 2 G.
But this means that G is a -class containing B. But the smallest -class
containing G is .B/ by Theorem 1.6.30, so that we have now
.B/  G  .B/;
the last inclusion coming from the deﬁnition of G. Thus we may con-
clude that G D .B/; hence all sets in .B/ have the desired property.
a
We obtain as a slight extension to Theorem 1.6.29 through Lemma
1.6.18.
Theorem 1.6.32 Let C be a semiring over a set S and  W C ! Œ0; 1
monotone and countably additive.
1. There exists an extension of  to a measure on the -algebra .C/
generated by C.
2. If  is -ﬁnite, then the extension is uniquely determined.
a
The assumption on  being -ﬁnite is in fact necessary.
Example 1.6.33 Let S be the semiring of all left open, right closed
intervals on R, and put
.I/ WD
(
0
if I D ;;
1;
otherwise.
Then  has more than one extension to .S/. For example, let c > 0
and put c.A/ WD c  jAj with jAj as the number of elements of A.
Plainly, c extends  for every c. ✌
Consequently, the assumption that  is -ﬁnite cannot be omitted in
order to make sure that the extension is uniquely determined.

88
CHAPTER 1. THE AXIOM OF CHOICE
1.6.4
-Measurable Sets
Carath´eodory’s approach gives even more than an extension to the -
algebra generated from a semiring. This is what we will discuss next in
order to point out a connection with the discussion about the axiom of
choice.
Fix for the time being an outer measure  on P .S/ which we assume
to be ﬁnite. Call A  S a -null set iff we can ﬁnd a -measurable set
A1 with A  A1 and .A1/ D 0. Thus a -null set is a set which is
covered by a measurable set with -measure 0. Because .X \S nA/ 
.X/ for every X  S and because an outer measure is monotone,
we conclude that each -null set is itself -measurable. In the same
way, we conclude that each set A which can be squeezed between two
-measurable sets of the same measure (hence A1  A  A2 with
.A1/ D .A2/) must be -measurable, because in this case A n A1 
A n A2 with .A n A2/ D 0. Hence C is complete in the sense that any
A which can be sandwiched in this way is a member of C.
Completeness
This is a characterization of C using these ideas.
Corollary 1.6.34 Let C be an algebra over a set S and  W C ! RC
monotone and countably additive with .;/ D 0. Then these statements
are equivalent for A  S:
1. A 2 C.
2. There exists A1; A2 2 .C/ with A1  A  A2 and .A1/ D
.A2/.
Proof The implication 2 ) 1 follows from the discussion above, so
we will look at 1 ) 2. But this is trivial. a
Looking back at this development, we see that we can extend our mea-
sure far beyond the -algebra which is generated from the given semir-
ing. One might even suspect that this extension process gives us the
whole power set of the set we started from as the domain for the extended
measure. That would of course be tremendously practical, because we
then could assign a measure to each subset. But, alas, if the axiom of
choice is assumed, these hopes are shattered. The following example
demonstrates this. Before discussing it, however, we deﬁne and charac-
terize -measurable sets on a -algebra.

1.6. BOOLEAN -ALGEBRAS
89
If  is a ﬁnite measure on -algebra B, we can deﬁne the outer measure
.A/ for any subset A  S in the same way as we did for functions
on a semiring. But since the algebraic structure of a -algebra is richer,
it is not difﬁcult to see that
.A/ D inff.B/ j B 2 B; A  Bg:
This is so because a cover of the set A through a countable union of
elements on B is the same as the cover of A through an element of B,
because the -algebra B is closed under countable unions. In a similar
way, we can try to approximate A from the inside, deﬁning the inner
measure through
; 
.A/ WD supf.B/ j B 2 B; A 	 Bg:
So .A/ is the best approximation from the inside that is available to
us. Of course, if A 2 B, we have .A/ D .A/ D .A/; because
apparently A is the best approximation to itself.
We can perform the approximation through a sequence of sets, so we are
able to precisely ﬁx the inner and the outer measure through elements
of the -algebra.
Lemma 1.6.35 Let A  S and  be a ﬁnite measure on the -algebra
B.
1. There exists A 2 B such that .A/ D .A/.
2. There exists A 2 B such that .A/ D .A/.
Proof We demonstrate only the ﬁrst part. For each n 2 N, there exists
An 2 B such that A  Bn and .Bn/ < .A/ C 1=n. Put An WD
B1 \ : : : \ Bn 2 B, then A  An, .An/ < .A/ C 1=n, and .An/n2N
decreases. Let A WD T
n2N An 2 B; then .A/ D infn2N .An/ D
.A/ by the second part of Lemma 1.6.20, because .A1/ < 1.
a
The set A could be called the measurable closure of A; similarly,
A is its measurable kernel. Using this terminology, we call a set -
measurable iff its closure and its kernel give the same value.
Deﬁnition 1.6.36 Let  be a ﬁnite measure on the -algebra B. A  S
is called -measurable iff .A/ D .A/.

90
CHAPTER 1. THE AXIOM OF CHOICE
Every set in B is -measurable, and B is the -algebra of all
-measurable sets.
The example which has been announced above shows us that under the
assumption of .AC/ not every subset of the unit interval is -measurable,
where  is Lebesgue measure. Hence we will present a set the inner and
the outer measure of which are different.
Example 1.6.37 Deﬁne x ˛ y iff xy is rational for x; y 2 Œ0; 1. Then
˛ is an equivalence relation, because the sum of two rational numbers is
a rational number again. This is sometimes called Vitali’s equivalence
relation. The relation ˛ partitions the interval Œ0; 1 into equivalence
Vitali’s
relation
classes. Select from each equivalence class an element (which we can
do by .AC/), and denote by V the set of selected elements. Hence
V \ Œx˛ contains for each x 2 Œ0; 1 exactly one element. We want to
show that V is not -measurable, where  is Lebesgue measure.
The set P WD Q \ Œ0; 1 is countable. Deﬁne Vp WD fv C p j v 2 V g;
for p 2 P . If p; q 2 P are different, Vp \ Vq D ;. This is so because
v1 C p D v2 C q implies v1  v2 D q  p 2 Q, and thus v1 ˛ v2, so
v1 and v2 are in the same class; hence v1 D v2, and thus p D q, which
is a contradiction.
Put A WD S
p2P Vp; then Œ0; 1  A  Œ0; 2: Take x 2 Œ0; 1, then
there exists v 2 V with x ˛ v, thus r WD x  v 2 Q, and hence x 2 Vr.
On the other hand, if x 2 Vr, then x D v C r, and hence 0  x  2.
If A is -measurable, then .A/ D 0 is impossible, because this would
imply .Œ0; 1/ D 0, since  is monotone. Thus .A/ > 0. But .Vp/ D
.V / for each p, so that .A/ D 1 by countable additivity. But this
contradicts .Œ0; 2/ D 2. Hence A is not -measurable, which implies
that V is not -measurable. ✌
So, let us record for later use: If .AC/ holds, then there exists a subset
of the unit interval which is not Lebesgue measurable.
1.7
Banach–Mazur Games
We will now demonstrate that the games we are about to introduce lead
to considerations replacing .AC/ by another axiom, which in turn will
be the base for establishing that every subset of Œ0; 1 is Lebesgue mea-
surable. This will be done through a suitable two-person game.

1.7. BANACH–MAZUR GAMES
91
We have two players, Angel and Demon, playing against each other. For
simplicity, we assume that playing means offering a natural number and
that the game—like True Love—never ends. Let A be a set of inﬁnite
sequences of natural numbers; then the game GA is played as follows.
Angel starts with a0 2 N, and Demon answers with b0 2 N, taking
Angel’s move a0 into account. Angel replies with a1, taking the game’s
history ha0; b0i into account, and then Demon answers with b1, contin-
gent upon ha0; b0; a1i, and so on. Angel wins this game, if the sequence
ha0; b0; a1; b1; : : :i is a member of A; otherwise Demon wins.
Let us have a look at strategies. Deﬁne
N WD N1
as the set of all sequences of natural numbers, and let
S WD
[
fhn1; : : : ; nki j k  0; n1; : : : ; nk 2 Ng
be the set of all ﬁnite sequences of natural numbers. For easier nota-
tion later on, we deﬁne appending an element to a ﬁnite sequence by
hn1; : : : ; nki a n WD hn1; : : : ; nk; ni. Su and Sg denote all sequences
of odd, resp., even and length, the empty sequence is denoted by , and
we assume  2 Sg.
S;Su; Sg
A strategy d for Angel is a map d W Sg ! N which works in the fol-
lowing way: a0 WD d./ is the ﬁrst move of Angel, Demon replies
with b0, then Angel answers with a1 WD d.a0; b0/, Demon reacts with
b1, which Angel answers with a2 WD d.a0; b0; a1; b1/, and so on. If
Angel plays according to strategy d and Demon’s moves are given by
b WD hb0; b1; : : :i 2 N, then the game’s events are collected in d 
b 2 N, where we deﬁne d  b WD ha0; b0; a1; b1; : : :i with a2kC1 D
d.a0; b0; : : : ; a2k; b2ki for k  0 and a0 D d./. Similarly, a strat-
egy a for Demon is a map a W Su ! N, working in this manner: If
Angel plays a0, Demon answers with b0 WD a.a0/; then Angel plays
a1, to which Demon replies with b1 WD a.a0; b1; a1/; and so on. If
Angel’s moves are collected in a WD ha0; a1; : : :i and if Demon plays
strategy a, then the entire game is recorded in the sequence a  a. Thus
we deﬁne a  a WD ha0; b0; a1; b1; : : :i with bk D a.a0; b0; : : : ; ak/ for
k  0.
d  b; a  a
Deﬁnition 1.7.1 d W Sg ! N is a winning strategy for Angel in game
GA iff
fd  b j b 2 Ng  A;

92
CHAPTER 1. THE AXIOM OF CHOICE
a W Su ! N is a winning strategy for Demon in game GA iff
fa  a j a 2 Ng  N n A:
It is clear that at most one of Angel and Demon can have a winning
strategy. Suppose that in the contrary both have one, say, d for Angel
and a for Demon. Then d  a 2 A, since d is winning for Angel, and
d  a 62 A, since a is winning for Demon. So this assumption does not
make sense.
We have a look at Banach–Mazur games, another formulation of the
games just introduced, which is sometimes more convenient.
Each
Banach–Mazur game can be transformed into a game which we have
deﬁned above.
Banach-
Mazur
game
Before discussing it, it will be convenient to introduce some notation.
Let a; b 2 S; hence a and b are ﬁnite sequences of natural numbers. We
say that a  b iff a is an initial piece of b (including a D b), so there
exists c 2 S with b D ac; c is denoted by b=a. If we want to exclude
equality, we write a  b.
Example 1.7.2 The game is played over S; a subset B  N indicates a
winning situation. Angel plays a0 2 S, Demon plays b0 with a0  b0,
then Angel plays a1 with a0b0  a1, etc. Angel wins this game iff the
ﬁnite sequence a0b0a1b1 : : : converges to an inﬁnite sequence x 2 B.
We encode this game in the following way. S is countable by Proposi-
tion 1.2.5, so write this set as S D frn j n 2 Ng. Put
A WD fhw0; w1; : : :i j rw0  rw1  rw2 : : : converges to a sequence in Bg:
It is then immediate that Angel has a strategy for winning the Banach–
Mazur game iff it has one for winning that game GA. ✌
Consequently, this class of games will be called Banach–Mazur games
throughout (we will encounter other games as well).
1.7.1
Determined Games
Games in which neither Angel nor Demon has a winning strategy are
somewhat, well, indeterminate and might be avoided. We see some sim-
ilarity between a strategy and the selection argument in .AC/, because

1.7. BANACH–MAZUR GAMES
93
a strategy selects an answer among several possible choices, while a
choice function picks elements, each from a given set. This intuitive
similarity will be investigated now.
Deﬁnition 1.7.3 A game GA is called determined iff either Angel or
Demon has a winning strategy.
Suppose that each game GA is determined, no matter what set A  N
we chose; then we can deﬁne a choice function for countable families
of nonempty subsets of N.
Theorem 1.7.4 Assume that each game is determined. Then there exists
a choice function for countable families of nonempty subsets of N.
Proof 1. Let F WD fXn j n 2 Ng be a countable family with ; 6D Xn 
N for n 2 N. We will deﬁne a function f W F ! N such that f .Xn/ 2
Xn for all n 2 N: The idea is to play a game which Angel cannot win,
The idea is to
play a game
hence for which Demon has a winning strategy. To be speciﬁc, if Angel
plays ha0; a1; : : :i and Demon plays b WD hb0; b1; : : :i, then Demon
wins iff b 2 Xa0. Since by assumption Demon has a winning strategy
a, we then put
f .Xn/ WD hn; 0; 0; : : :i  a:
2. Let us look at this idea. Put
A WD fhx0; x1; : : :i 2 N j hx1; : : :i 62 Xx0g:
Suppose that Angel starts upon playing a0. Since Xa0 6D ;, Demon can
take an arbitrary b 2 Xa0 and plays hb0; b1; : : :i. Hence Angel cannot
win, so B has a winning strategy a.
3. Now look at hn; 0; 0; : : :i  a 62 A, because a is a winning strategy.
From the deﬁnition of A, we see that this is an element of Xn, so we
have found a choice function indeed. a
The space N looks a bit artiﬁcial, just as a mathematical object to play
around with. But this is not the case. It can be shown that there exists a
bijection N ! R with some desirable properties (we will not enter into
this construction, however, but refer the reader to Sect. 4.4).
We state as a consequence of Theorem 1.7.4
Corollary 1.7.5 Assume that each game is determined. Then there ex-
ists a choice function for countable families of nonempty subsets of R.
a

94
CHAPTER 1. THE AXIOM OF CHOICE
Let us ﬁx the assumption on the existence of a winning strategy for
either Angel or Demon in an axiom, the axiom of determinacy.
.AD/ Each game is determined.
Given Corollary 1.7.5, the relationship of the axiom of determinacy to
the axiom of choice is of interest.
Does .AD/ imply .AC/?
The hope of establishing this is shattered, however, by this observa-
tion.
Proposition 1.7.6 If .AC/ holds, there exists A  N such that GA is
not determined.
Before entering the proof, we observe that the set of all strategies SA
for Angel resp. SD for Demon has the same cardinality as the power set
P .N/ of N.
Proof 0. We have to ﬁnd a set A  N such that neither Angel nor
Demon has a winning strategy for the game GA. By .AC/, the sets SA
resp. SD can be well ordered; by the observation just made, we can
write
SA D fd˛ j ˛ < !1g;
SD D fa˛ j ˛ < !1g:
1. We will construct now disjoint sets X D fx˛ j ˛ < !1g  N and
Y D fy˛ j ˛ < !1g  N indexed by f˛ j ˛ < !1g, which will help
deﬁne the game. Suppose xˇ and yˇ are deﬁned for all ˇ < ˛. Then,
because ˛ is countable, the sets fxˇ j ˇ < ˛g and fyˇ j ˇ < ˛g are
countable as well, and there are uncountably many b 2 N such that
d˛  b 62 fxˇ j ˇ < ˛g. Take one of them and put y˛ WD d˛  b. For
the same reason, there are uncountably many a 2 N such that a  a˛ 62
fyˇ j ˇ  ˛g; take one of them and put x˛ WD a  a˛.
2. Clearly, X and Y are disjoint. Angel does not have a strategy for
winning game GX. Suppose it has a winning strategy d, so that d D d˛
for some ˛ < !1. But y˛ D d˛  b 62 X by construction, which is a
contradiction. One similarly shows that Demon cannot have a winning
strategy for game GX. Hence this game is not determined. a

1.7. BANACH–MAZUR GAMES
95
1.7.2
Proofs Through Games
Games are a tool for proofs. The basic idea is to attach a statement
to a game, and if Angel has a strategy for winning the game, then the
statement is established; otherwise it is not. Hence we have to encode
the statement in such a way that this mechanism can be used, but we
have also to establish a scenario in which to argue. The formulation
chosen suggests that Angel has to have a winning strategy for winning
a game, which in turn suggests that we assume a framework in which
games are determined. But we have seen above that this is not without
conﬂicts when considering .AC/.
This section is devoted to establish that every subset of the unit inter-
val is Lebesgue measurable, provided each game is determined. We
have seen in Example 1.6.37 that .AC/ implies that there exists a set
which is not Lebesgue measurable. Hence “it is natural to postulate that
Determinacy holds to the extent that it does not contradict the Axiom of
Choice,” as T. Jech writes in his massive treatise of set theory [Jec06, p.
628].
We will discuss another example for using games as tools for proofs
when we formulate a Banach–Mazur game for establishing properties
of a topological space in Sect. 3.5.2.
The Goal.
We want to show that each subset of the unit interval is
measurable, provided each game is determined. This is based on the
observation that it is sufﬁcient to establish that .A/ > 0 or .Œ0; 1 n
A/ > 0 for each and every subset A  Œ0; 1, where, as above,  is
Lebesgue measure on the unit interval. This is the reason, which fol-
lows from the construction for Vitali’s equivalence relation; see Exam-
ple 1.6.37.
Lemma 1.7.7 Assume that there exists a subset of the unit interval
which is not -measurable. Then there exists a subset M  Œ0; 1 with
.M/ D 0 and .M/ D 1. a
The Basic Approach.
Given an arbitrary subset X  Œ0; 1, we will
deﬁne a game GX such that if there exists a winning strategy for An-
gel, then we can ﬁnd a measurable subset A  X which has posi-
tive Lebesgue measure (hence .X/ > 0). If there exists, however,

96
CHAPTER 1. THE AXIOM OF CHOICE
a winning strategy for Demon, then we can ﬁnd a measurable subset
A  Œ0; 1 with positive Lebesgue measure such that A \ X D ; (hence
.Œ0; 1 n A/ > 0).
Little Helpers.
We need some preparations before we start. So let
us get on with it now as not to interrupt the ﬂow of discussion later
on.
Lemma 1.7.8 Let .Fn/n2N be a sequence of nonempty subsets of the
unit interval Œ0; 1 such that
1. Each Fn is a ﬁnite union of closed intervals.
2. The sequence is monotonically decreasing; hence F1 	 F1 	 : : :.
3. The sequence of diameters diam.Fn/ WD supx;y2Fn jx  yj tends
Diameter
to zero.
Then there exists a unique p 2 Œ0; 1 with fpg D T
n2N Fn:
Proof 1. It is clear from the last condition that there can be at most
one point in the intersection of this sequence: Suppose there are two
distinct points p; q in this intersection; then ı WD jp  qj > 0. But
there exists some n0 2 N with diam.Fm/ < ı for all m  n0. This is a
contradiction.
2. Assume that T
n2N Fn D ;. Put Gn WD Œ0; 1 n Fn; then Gn is
the union of a ﬁnite number of open intervals, say Gn D Hn;1 [ : : : [
Hn;kn and Œ0; 1  S
n2N Gn: By the Heine–Borel Theorem 1.5.46,
there exists a ﬁnite set of intervals Hni;ji with 1  i  r; 1  ji 
kni such that Œ0; 1  Sr
iD1 Hni;ji : Because the sequence of the Fn
decreases, the sequence .Gn/n2N is increasing, so we ﬁnd an index N
such that Hni;ji  GN for 1  i  r; 1  ji  kni. But this means
Œ0; 1  GN ; thus FN D ;, contradicting the assumption that all Fn are
nonempty. a
A more general version of this Lemma will be found in Propositions
3.5.25 and 3.6.67; interesting enough, Proposition 3.5.25 will also be an
important tool in the investigation of the game in Sect. 3.5.2.
Another preparation concerns the convergence of an inﬁnite product.

1.7. BANACH–MAZUR GAMES
97
Lemma 1.7.9 Let .an/n2N be a sequence of real numbers with 0 <
an < 1 for all n 2 N. Then the following statements are equivalent:
1. Q
i2N.1  ai/ WD limn!1
Qn
iD1.1  ai/ exists.
2. P
n2N an converges.
Proof One shows easily by induction on n that
n
Y
iD1
.1  ai/ > 1 
 n
X
1D1
an

for n  2. Since 0 < an < 1 for all n 2 N, this implies the equivalence.
a
This has an interesting consequence, viz., that we have a positive inﬁ-
nite product, provided the corresponding series converges. To be spe-
ciﬁc
Corollary 1.7.10 Let .an/n2N be a sequence of real numbers with 0 <
an < 1 for all n 2 N. Then the following statements are equivalent:
1. Q
i2N.1  ai/ is positive.
2. P
n2N an converges.
Proof 1.
Put Qk WD Qk
iD1 ai; Q WD limk!1 Qk.
Assume that
P
n2N an converges; then there exists m 2 N such that dm WD P1
iDm <
1. Hence we have
Qn
Qm
> 1  .amC1 C : : : C an/ > 1  dm
for n > m, so that
Q D lim
k!1 Qk > Qm  .1  dm/ > 0:
2. On the other hand, if the series diverges, then we can ﬁnd an index m
for N 2 N such that a1 C: : :Can > N whenever n > m. Hence
Y
n2N
1
1  an
 lim
k!1
1
1  .a1 C : : : C ak/ D 0:
a
This observation will be helpful when looking at our game.

98
CHAPTER 1. THE AXIOM OF CHOICE
The Game.
Before discussing the game proper, we set its stage. Fix
a sequence .rn/n2N of positive reals such that P
n2N rn < 1 and 1=2 >
r1 > r2 > : : : :
Let k 2 N be a natural number, and deﬁne Jk as the collection of sets
S with these properties:
 S  Œ0; 1 is a ﬁnite union of closed intervals with rational end-
points.
 The diameter diam.S/ D supx;y2S jx  yj of S is smaller than
1=2k.
 The Lebesgue measure .S/ of S is r1  : : :  rk.
Put J0 WD fŒ0; 1g as the mandatory ﬁrst draw of Angel. Note that Jk
is countable for all k 2 N, so that S
k0 Jk is countable as well by
Proposition 1.2.6 (it is important to note this was proved without using
.AC/).
Important
note
The game starts. We ﬁx X  Œ0; 1 as the Great Prize; this is the set
we want to investigate. Angels starts with choosing the unit interval
S0 WD Œ0; 1, Demon chooses a set S1 2 J1, then Angel chooses a
set S2 2 J2 with S2  S1  S0, Demon chooses a set S3  S2
with S3 2 J3, and so on. In this way, the game deﬁnes a decreasing
The game
sequence .Sn/n2N of closed sets, the diameter of which tends to zero.
By Lemma 1.7.8 there exists exactly one point p with p 2 T
n2N Sn. If
p 2 Œ0; 1nX, then Angel wins, and if p 2 X, then Demon wins.
Analysis of the Game.
First note that we will not encode the game
into a syntactic form according to the deﬁnition of GA. This would
require much encoding and decoding between the formal representation
and the informal one, so that the basic ideas might get lost [Ven07].
Since life is difﬁcult enough, we stick to the informal representation,
trusting that the formal one is easily derived from it, and focus on the
ideas behind the game. After all, we want to prove something through
this game which is not entirely trivial.
The game spawns a tree rooted at S0 WD Œ0; 1 with offsprings all those
elements S1 of J1 with S1  S0. Continuing inductively, assume that
we are at node Sk 2 Jk; then this node has all elements S 2 JkC1
as offsprings for which S  Sk holds. Consequently, the tree’s depth

1.7. BANACH–MAZUR GAMES
99
will be inﬁnite, because the game continues forever. The offsprings of a
node will be investigated in a moment.
We deﬁne for easier discussion the sets
Wk WD fhS0; : : : ; Ski 2
k
Y
iD0
Ji j S0  S1  : : :  Skg;
W WD
[
k0
Wk
as the set of all paths which are possible in this game. Hence Angel
chooses initially S0 D Œ0; 1, Demon chooses S1 2 J1 with S1  S0
(hence hS0; S1i 2 W1), so that hS0; S1; S2i 2 W2, etc. W2n is the set
of all possible paths after the nth draw of Angel, and W2nC1 yields the
state of affairs after the nth move of Demon.
For an analysis of strategies, we will ﬁx now k 2 N and a map  W
Wk ! JkC1 such that  .S0; : : : ; Sk/  Sk; hence hS0; : : : ; Sk;
 .S0; : : : ; Sk/i D hS0; : : : ; Ski a  .S0; : : : ; Sk/ 2 WkC1: Just to
have a handy name for it, call such a map admissible at k.
 admissible
Lemma 1.7.11 Assume  is admissible at k. Given hS0; : : : ; Ski 2
Wk, there exists m 2 N and a ﬁnite sequence TkC1;i 2 JkC1 for 1 
i  m such that
1. TkC1;i  Sk for all i,
2. 
Sm
iD1  .S0; : : : ; Sk; TkC1;i/

 .Sk/  .1  2  rkC1/,
3. The sets  .S0; : : : ; Sk; TkC1;1/; : : : ;  .S0; : : : ; Sk; TkC1;m/ are
mutually disjoint.
Proof The sets TkC1;i are deﬁned by induction. Assume that TkC1;1;
: : : ; TkC1;j is already deﬁned for j  0; put
Rj WD Sk n
j[
iD1
 .S0; S1; : : : ; Sk; TkC1;i/:
Now we have two possible cases: either
./ .Rj/ > 2  .Sk/  rkC1
or this inequality is false. Note that .Sk/ D r1  : : :  rk, and 1=2 >
rk > rkC1, so that initially .R0/ D .Sk/ > 2  .Sk/  rkC1. Now

100
CHAPTER 1. THE AXIOM OF CHOICE
assume that ./ holds. Because Sk is the union of a ﬁnite number of
closed intervals and because Rj does not exhaust Sk, we conclude that
Rj contains a subset P with diameter diam.P /  diam.Rj/  2.kC1/
such that .P / > .Sk/. We can select P in such a way that it is a ﬁnite
union of intervals. Then there exists TkC1;jC1  P which belongs to
JkC1. Take it. Then the ﬁrst property is satisﬁed.
This process continues until inequality ./ becomes false, which gives
the second property. Because
 .S0; : : : ; Sk; TkC1;i/  TkC1;i  Sk n
i1
[
jD1
 .S0; : : : ; Sk; TkC1;j /;
we conclude that the sets  .S0; : : : ; Sk; TkC1;1/; : : : ;  .S0; : : : ; Sk;
TkC1;m/ are mutually disjoint. a
Now let a be a strategy for Demon; hence a W S
k0 W2kC1 ! S
k0
J2k is a map such that a.S0; : : : ; S2k/  S2k.
If the game’s his-
tory at time k is given by the path hS0; : : : ; S2ki with Angels having
played S2k as a last move, then the game continues with a.S0; : : : ; S2k/
as Demon’s next move, so that the new path is just hS0; : : : ; S2ki a
a.S0; : : : ; S2k/:
Let us see what happens if Angel selects the next move according to
Lemma 1.7.11. Initially, Angels plays S0, then Demon plays a.S0/, so
that the game’s history is now hS0i a a.S0/; let T0;1; : : : ; T0;m0 be
the sets selected according to Lemma 1.7.11 for this history; then the
possible continuations in the game are ti WD hS0i a a.S0/ a T0;i for
1  i  m0, so that Demon’s next move is ti a a.ti/, and thus
Ka

hS0i a a.S0/

WD fhS0i a a.S0/ a T0;i a ahS0i a a.S0/ a T0;i/ j 1  i  m0g 2 W3
describes all possible moves for Demon in this scenario. Given a, this
depends on S0 as the history up to that moment and on the choice to
Angel’s moves according to Lemma 1.7.11. To see the pattern, con-
sider Demon’s next move. Take t D ht0; t1; t2; t3i 2 Ka.S0 a a.S0//,
then a.t/ 2 J4 with a.t/  t3, and choose T1;1; : : : ; T1;m1 according
to Lemma 1.7.11 as possible next moves for Angel, so that the set of

1.7. BANACH–MAZUR GAMES
101
all possible moves for Demon given this history is an element of the
set
Ka.t/
D
Ka.ht1; t2; t3i a a.t1; t2; t3//
WD
ft a T1;i a a.t a T1;i/ j 1  i  m1g 2 W5:
This provides a window into what is happening. Now let us look at the
broader picture. Denote for t 2 Wn by Ja.t/ the set ft a Tn;1; : : : ; t a
Tn;mg; where Tn;1; : : : ; Tn;m are determined for t and a according to
Lemma 1.7.11 as the set of all possible moves for Angel. Hence given
history t, Ja.t/ is the set of all possible paths for which Demon has to
provide the next move. Then put
J n
a WD
[
s22Ja.hS0iaa.S0//
[
s42Ja.s2aa.s2//
: : :
[
s2.n1/2Ja.s2.n2/aa.s2.n2///
Ja

s2.n1/ a a.s2.n1//

with
J 1
a D Ja.hS0i a a.S0//:
Finally, deﬁne
An WD
[
fa.s2n/ j s2n 2 J n
a g:
Hence J n
a contains all possible moves of Angel at time 2n, so that An
tells us what Demon can do at time 2n C 1. These are the important
properties of .An/n2N.
Lemma 1.7.12 We have for all n 2 N
1. .An/  r1  Qn
iD1.1  2  r2i/
2. AnC1  An
Proof 1. The second property follows immediately from Lemma 1.7.11,
so we will focus on the ﬁrst property. It will be proved by induction on n.
We infer from Lemma 1.7.11 that the sets a.s2n/ are mutually disjoint,
when s2n runs through J n
a .
2.
The induction begins at n D 1.
We obtain immediately from
Lemma 1.7.11 that
.A1/ D 
[
fa.s2/ j s2 2 Ja.hS0i a a.S0/g/

 r1  .1  2  r2/
(set  WD a and k D 1).

102
CHAPTER 1. THE AXIOM OF CHOICE
2. Induction step n ! n C 1. We infer from Lemma 1.7.11 that
./ 
[
fa.s2.nC1/ j s2.nC1/ 2 Ja.s2n/g

 .a.s2nC1//  .1  2  r2.nC1//:
Disjointness then implies
.AnC1/ D
X
s2n2J n
a

[
fa.s2.nC1/ j s2.nC1/ 2 Ja.s2n/g


X
s2n2J n
a
.a.s2n//  .1  2  r2.nC1//
(inequality .//
D 

[
s2n2J n
a
a.s2nC1/

 .1  2  r2.nC1//
(disjointness)
D .An/  .1  2  r2.nC1//
(induction
hypothesis)
 r1 
nC1
Y
iD1
.1  2  r2i/:
a
Now we are getting somewhere—we show that we can ﬁnd for every
element in T
n2N An a strategy so that the moves of Angel and of Demon
converge to this point. To be more speciﬁc
Lemma 1.7.13 Assume that Demon adopts strategy a. For every point
p 2 T
n2N An, there exists for Angel a strategy dp with this property:
If Angel plays dp and Demon plays a, then T1
iD0 Si D fpg, where
S0; S1; : : : are the consecutive moves of the players.
Proof The sets s2n 2 J n
a are mutually disjoint for ﬁxed n, so we ﬁnd
a unique sequence s0
2n 2 J n
a for which p 2 a.s0
2n/. Represent s0
2n D
hS0; : : : ; S2ni, and let dp be a strategy for Angel such that dp.hS0; : : : ;
S2n1i a a.S0; : : : ; S2n1// D S2n holds. Thus p 2 T
n2N Sn, if
Angel plays dp and Demon plays a. a
Now let a be a winning strategy for Demon; then A WD T
n2N An 
Œ0; 1 n XI this is the outcome if Angel plays one of the strategies in
fdp j p 2 Ag. There may be other strategies for Angel than the one
described above, but no matter how Angel plays the game, we will end
up in an element not in X. This implies .A/  .Œ0; 1 n X/. But
we know from Lemma 1.7.12 that .A/  r1  Q1
iD1.1  2  r2i/ > 0
by Lemma 1.7.9 and its corollary, consequently, .Œ0; 1 n X/ > 0.

1.8. WRAPPING IT UP
103
If, however, Demon does not have a winning strategy, then Angel has
one, if we assume that the game is determined. The argumentation is
completely the same as above to show that .X/ > 0.
Thus we have shown
Theorem 1.7.14 If each game is determined, then each subset of the
unit interval is -measurable. a
We have seen that games are not only just for fun, but are a tool for
investigating properties of sets. In fact, one can deﬁne games for inves-
tigating many topological properties, not all as laborious as the one we
have deﬁned above.
1.8
Wrapping It Up
This summarizes the discussion.
Some hints for further information
can be found in the Bibliographic Notes. The Lecture Note [Her06]
by H. Herrlich and the list of its references contain a lot of suggestions
for further reading. The discussion in P. Taylor’s book [Tay99, p. 58]
(“Although we, at the cusp of the century, now reject Choice : : :”) is also
worth looking at, albeit from a completely different angle.
This is a small diagram indicating the dependencies discussed here:
The symbols provide a guide to the corresponding statements:
✧
Theorem 1.4.20
❏
Proposition 1.5.1
●
Theorem 1.5.38
✜
Proposition 1.5.3
✕
Existence of a nondetermined game under .AC/, Proposition 1.7.6
▲
Choice function for countable families under .AD/, Theorem 1.7.4
❡
Measurability of every subset of Œ0; 1 under .AD/, Theorem 1.7.14

104
CHAPTER 1. THE AXIOM OF CHOICE
1.9
Bibliographic Notes
This chapter contains mostly classical topics. The proof of Cantor’s
enumeration and its consequences for enumerating the set of all ﬁnite
sequences of natural numbers is taken from [KM76], so is the discus-
sion of ordinals. Jech’s representation [Jec06] has been helpful as well,
so was [Gol96]. The books by Davis [Dav00] and by Aczel [Acz00]
contain some gripping historical information on the subject of early set
theory; the monograph [COP01] discusses implications for computing
when the axiom of foundations (p. 7) is weakened.
Term
rewriting
is
discussed
in
[BN98];
reduction
systems
(Example 1.3.7) are central to it. Aumanns’s classic [Aum54], unfor-
tunately not as frequently used as this valuable book should be, helped
in discussing Boolean algebras, and the proof for the general distribu-
tive law in Boolean algebras as well as some exercises has been taken
from [Bir67] and from [DP02]; see also [Sta97] for ﬁnite lattices. The
discussion on measure extension follows quite closely the representation
given in the ﬁrst three chapters of [Bil95] with an occasional glimpse
at [Els99] and the awesome [Bog07]. Finally, games are introduced
as in [Jec06, Chap. 33]; see also [Jec73]; the game-theoretic proofs on
measurability are taken from [MS64]. Inﬁnite products are discussed at
length in the delightful textbook [Bro08]; see also [Chr64]. A general
source for this chapter was the exposition by Herrlich [Her06], provid-
ing a tour d’horizon. A graphic view of the foundational crisis in math-
ematics at the turn of the twentieth century and B. Russell’s attempts to
solve it can be found in [DPP09].
1.10
Exercises
Exercise 1.1 The axiom of pairs deﬁnes ha; bi WD
˚
fag; fa; bg

I see
page 6. Using the axioms of ZFC, show that ha; bi D ha0; b0i iff a D a0
and b D b0:
Exercise 1.2 Show that f W A ! B is injective iff f 1 W P .B/ !
P .A/ is surjective; f is surjective iff f 1 is injective.
Exercise 1.3 Deﬁne d on N as in Example 1.3.2. Show that p is prime
iff p is a minimal element of N n f1g.

1.10. EXERCISES
105
Exercise 1.4 Order S WD P .N/ n fNg by inclusion as in Example 1.4.
Show that the set A WD ff2  n; 2  n C 1g j n 2 Ng is bounded in S; does
A have a smallest lower bound?
Exercise 1.5 Let S be a set and H W P .S/ ! P .S/ be an order pre-
serving map. Show that A WD SfX 2 P .S/ j X  H.X/g is a ﬁxed
point of H, i.e., that satisﬁes H.A/ D A. Moreover, A is the greatest
ﬁxed point of H ,i.e., if H.Y / D Y , then Y  A:
Exercise 1.6 Let f W X ! Y and g W Y ! X be maps. Using
Exercise 1.5, show that there exist disjoint subsets X1 and X2 of X and
disjoint subsets Y1 and Y2 of Y such that X D X1 [ X2, Y D Y1 [ Y2
and f

X1

D Y1, g

Y2

D X2. The map A 7! X n g

Y n f

A

might
be helpful.
This decomposition is attributed to S. Banach.
Exercise 1.7 Use Exercise 1.6 for a proof of the Schr¨oder–Bernstein
Theorem 1.2.1.
Exercise 1.8 Show that there exist for the bijection J from Proposi-
tion 1.2.3 surjective maps K W N0 ! N0 and L W N0 ! N0 such that
J

K.x/; L.x/

D x; K.x/  x and L.x/  x for all x 2 N0.
Exercise 1.9 Construct a bijection from the power set P .N/ to R using
the Schr¨oder–Bernstein Theorem 1.2.1.
Exercise 1.10 Show using the Schr¨oder–Bernstein Theorem 1.2.1 that
the set of all subsets of N of size exactly 2 is countable. Extend this
result by showing that the set of all subsets of N of size exactly k is
countable. Can you show without .AC/ that the set of all ﬁnite subsets
of N is countable?
Exercise 1.11 Show that !1 WD f˛ j ˛ is a countable ordinalg is an
ordinal. Show that !1 is not countable.
Exercise 1.12 An undirected graph G D .V; E/ has nodes V and (undi-
rected) edges E. An edge connecting nodes x and y should be written
as fx; yg; note x 6D y. A subgraph G0 D .G0; E0/ of G is a graph
with G0  G and E0  E. G is k-colorable iff there exists a map
c W V ! f1; : : : ; kg such that c.x/ 6D c.y/, whenever fx; yg 2 E is an
edge in G. Show that G is k-colorable iff each of its ﬁnite subgraphs is
k-colorable.

106
CHAPTER 1. THE AXIOM OF CHOICE
Exercise 1.13 Let B be a Boolean algebra, and deﬁne a  b WD .a _
b/ ^ .a ^ b/, as in Sect. 1.5.6. Show that .B; ; ^/ is a commutative
ring.
Exercise 1.14 Complete the proof of Proposition 1.5.3 by proving that
.AC/ ) .MP/.
Exercise 1.15 Complete the proof of Lemma 1.5.36.
Exercise 1.16 Using the notation of Sect. 1.5.1, show that v ˆ ' iff
' 2 M using induction on the structure of '.
Exercise 1.17 Do Exercise 1.12 again, using the Compactness Theo-
rem 1.5.8.
Exercise 1.18 Let F be an ultraﬁlter over an inﬁnite set S. Show that
if F contains a ﬁnite set, then there exists s 2 S such that F D Fs, the
ultraﬁlter deﬁned by s; see Example 1.5.16.
Exercise 1.19 Consider this ordered set:
⊤
K
L
M
I
J
F
G
H
C
D
E
A
B
⊥
Discuss whether these values exist,
and determine their values, if they
do:
D ^ EI
D _ EI
.J ^ L/ ^ K
.L ^ E/ ^ KI
L ^ .E ^ K/I
C ^ E
.C _ D/ _ EI
supfC; D; EgI
C _ .D _ E/
J ^ .L _ K/I
.J ^ L/
C _ G:
_.J ^ K/I
Exercise 1.20 Let L be a lattice. An element s 2 L with s 6D ? is
called join irreducible iff s D r _ t implies s D r or s D t. Element t
covers element s iff s < t and if s < v < t for no element v. Show that
if L is a ﬁnite distributive lattice, then s is join irreducible iff s covers
exactly one element.
Exercise 1.21 Let P be a ﬁnite partially ordered set. Show that the
down set I 2 D.P / is join irreducible iff I is a principal down set.
Exercise 1.22 Identify the join-irreducible elements in P .S/ for S 6D ;
and in the lattice of all open intervals
˚
a; bŒ j a  b

, both ordered by
inclusion.

1.10. EXERCISES
107
Exercise 1.23 Show that in a lattice one distributive law implies the
other one.
Exercise 1.24 Give an example for a down set in a lattice which is not
an ideal.
Exercise 1.25 Show that in a distributive lattice c ^ x D c ^ y and
c _ x D x _ y for some c implies x D y.
Exercise 1.26 Let .G; C/ be a commutative group. Show that the sub-
groups form a lattice under the subset relation.
Exercise 1.27 Assume that in lattice L there exists for each a; b 2 L
the relative pseudo-complement a ! b of a in b; this is the largest
element x 2 L such that a ^ x  b. Show that a pseudo-complemented
lattice is distributive. Furthermore, show that each Boolean algebra is
pseudo-complemented. Lattices with pseudo-complements are called
Brouwerian lattices or Heyting algebras.
Exercise 1.28 A lattice is called complete iff it contains suprema and
inﬁma for arbitrary subsets. Show that a bounded partially ordered set
.L; / is a complete lattice if the inﬁmum for arbitrary sets exists. Con-
clude that the set of all equivalence relations on a set forms a complete
lattice under inclusion.
Exercise 1.29 Let L be a complete lattice and f W L ! L monotone.
Then the set fx 2 L j f .x/ D xg of ﬁx points of f is not empty,
and a complete lattice is in the induced order. This is Tarski’s Fixpoint
Theorem.
Exercise 1.30 Let S 6D ; be a set and a 2 S. Compute for the Boolean
algebra B WD P .S/ and the ideal I WD P .S n fag/ the factor algebra
B=I.
Exercise 1.31 Show that a topology  forms a complete Brouwerian
lattice under inclusion.
Exercise 1.32 Given a topological space .X; /, the following condi-
tions are equivalent for all x; y 2 X:
1. fxga  fyga.
2. x 2 fyga.
3. x 2 U implies y 2 U for all open sets U .

108
CHAPTER 1. THE AXIOM OF CHOICE
Exercise 1.33 Characterize those ideals I in a Boolean algebra B for
which the factor algebra B=I consists of exactly two elements.
Exercise 1.34 Let ; 6D A  P .S/ be a ﬁnite family of sets with S 2
A, say A D fA1; : : : ; Ang. Deﬁne AT WD T
i2T Ai \ T
i62T S n Ai for
T  f1; : : : ; ng.
1. P WD fAT j ; 6D T  f1; : : : ; ng; AT 6D ;g forms a partition of
S.
2. fS P0 j P0  Pg is the smallest set algebra over S which con-
tains A.
Exercise 1.35 As in Example 1.6.5 on page 67, let X WD f0; 1gN be the
space of all inﬁnite sequences. Put
C WD fA 
Y
j>k
f0; 1g j k 2 N; A 2 P

f0; 1gk
g:
Show that C is an algebra.
Exercise 1.36 Let X and C be as in Exercise 1.35. Show that


A 
Y
j>k
f0; 1g

WD jAj
2k
deﬁnes a monotone and countably additive map  W C ! Œ0; 1 with
.;/ D 0.
Exercise 1.37 Show that a countably subadditive and monotone set
function on a set algebra is additive.

Chapter 2
Categories
Many areas of mathematics show surprising structural similarities,
which suggests that it might be interesting and helpful to focus on an
abstract view, hereby unifying concepts. This view looks at the math-
ematical objects from the outside and studies the relationship between
them, for example, groups and homomorphisms, or topological spaces
together with continuous maps, or ordered sets with monotone maps.
The list could be extended. It leads to the general notion of a category.
A category is based on a class of objects together with morphisms for
each pair of objects. Morphisms can be composed; the composition
follows laws which are considered evident and natural.
This approach has considerable appeal to a software engineer as well.
In software engineering, the implementation details of a software sys-
tem are usually not particularly important from an architectural point of
view; they are encapsulated in a component. In contrast, the relationship
of components with each other is of interest because this knowledge is
necessary for composing a system from its components. Roughly speak-
ing, the architecture of a software system is characterized both by its
components and their interaction, the static part of which can be de-
scribed by what we may perceive as morphisms.
This has been recognized fairly early in the software architecture com-
munity, witnessed by the April 1995 issue of the IEEE Transactions on
Software Engineering, which was devoted to software architecture and
which introduced some categorical language in discussing architectures.
© Springer International Publishing Switzerland 2015
E.-E. Doberkat, Special Topics in Mathematics for Computer
Scientists, DOI 10.1007/978-3-319-22750-4 2
109

110
CHAPTER 2. CATEGORIES
So the language of categories offers some attractions to software engi-
neers, as can also be seen from, e.g., [Bar01, Fia05, Dob03]. We will
also see that the tool set of modal logics, another area which is important
to software construction, proﬁts substantially from constructions which
are ﬁrmly grounded in categories.
We will discuss categories here and introduce the reader to the basic
constructions. The world of categories is too rich to be captured in these
few pages, so we have made an attempt to provide the reader with some
basic proﬁciency in categories, helping her or him to get a grasp of the
basic techniques. This modest goal is attained by blending the abstract
mathematical development with a plethora of examples. We give a brief
overview over the contents.
Overview
The deﬁnition of a category and a discussion of its most
elementary properties are found in Sect. 2.1; examples show that cat-
egories are indeed a very versatile and general instrument for math-
ematical modeling. Section 2.2 discusses constructions like products
and coproducts, which are familiar from other contexts, in this new lan-
guage, and we look at pushouts and pullbacks, ﬁrst in the familiar con-
text of sets and then in a more general setting. Functors are introduced
in Sect. 2.3 for relating categories to each other, and natural transfor-
mations permit functors to enter into a relationship. We show also that
set-valued functors play a special rˆole, which provides an opportunity
to investigate more deeply the hom sets of a category. Products and
coproducts have an appearance again, but this time as instances of the
more general concept of limits resp. colimits.
Monads and Kleisli tripels are introduced as very special functors and
discussed in Sect. 2.4, their relationship is investigated, and some exam-
ples are given, which provide an idea about the usefulness of this con-
cept; a small section on monads in the programming language Haskell
provides a pointer to the practical use of monads. Next, we show that
monads are generated from adjunctions. This important concept is intro-
duced and discussed in Sect. 2.5; we deﬁne adjunctions, show by exam-
ples that adjunctions are a colorfully blooming and nourished ﬂower in
the garden of mathematics, and give an alternative formulation in terms
of units and counits; we then show that each adjunction gives us a monad
and that each monad also generates an adjunction. The latter part is in-
teresting since it provides an opportunity of introducing the algebras for

2.1. BASIC DEFINITIONS
111
a monad; we discuss two examples fairly extensively, indicating what
such algebras might look like.
While an algebra provides a morphism Fa ! a, a coalgebra provides
a morphism a ! Fa. This is introduced and discussed in Sect. 2.6;
many examples show that this concept models a broad variety of ap-
plications in the area of systems. Coalgebras and their properties are
studied, among them bisimulations, a concept which originates from the
theory of concurrent systems and which is captured now coalgebraically.
The Kripke models for modal logics provide an excellent playground for
coalgebras, so they are introduced in Sect. 2.7; examples show the broad
applicability of this concept (but neighborhood models as a generaliza-
tion are introduced as well). We go a bit beyond a mere application of
coalgebras and give also the construction of the canonical model through
Lindenbaum’s construction of maximally consistent sets, which, by the
way, provide an application of transﬁnite induction as well. We ﬁnally
show that coalgebras may be put to use when constructing coalgebraic
logics, a very fruitful and general approach to modal logics and their
generalizations.
2.1
Basic Deﬁnitions
We will deﬁne what a category is and give some examples for cate-
gories. It shows that this is a very general notion, covering also many
formal structures that are studied in theoretical computer science. A
very rough description would be to say that a category is a bunch of
objects which are related to each other, the relationships being called
morphisms. This gives already the gist of the deﬁnition—objects which
are related to each other. But the relationship has to be made a bit more
precise to be amenable for further investigation. So here is the deﬁnition
of a category.
Deﬁnition 2.1.1 A category K consists of a class jKj of objects and for
any objects a; b in jKj of a set homK.a; b/ of morphisms with a com-
position operation ı, mapping homK.b; c/  homK.a; b/ to homK.a; c/
with the following properties:
Identity For every object a in jKj, there exists a morphism ida 2
homK.a; a/ with f ı ida D f
D idb ı f , whenever f
2
homK.a; b/.

112
CHAPTER 2. CATEGORIES
Associativity If f
2
homK.a; b/; g
2
homK.b; c/, and h
2
homK.c; d/, then h ı .g ı f / D .h ı g/ ı f .
Note that we do not think that a category is based on a set of objects
(which would yield difﬁculties) but rather on a class. In fact, if we would
insist on having a set of objects, we would not be able to talk about the
category of sets, which is an important species for a category. We insist,
however, on having sets of morphisms, because we want morphisms to
be somewhat clearly represented. Usually we write for f 2 homK.a; b/
also f W a ! b, if the context is clear. Thus if f W a ! b and
g W b ! c, then g ı f W a ! c; one may think that ﬁrst f is applied
(or executed), and then g is applied to the result of f . Note the order in
which the application is written down: g ı f means that g is applied to
the result of f . The ﬁrst postulate says that there is an identity morphism
ida W a ! a for each object a of K which does not have an effect on
the other morphisms upon composition, so no matter if you do ida ﬁrst
and then morphism f W a ! b or if you do f ﬁrst and then idb, you
end up with the same result as if doing only f . Associativity is depicted
through this diagram:
Hence if you take the fast train g ı f from a to c ﬁrst (no stop at b) and
then switch to train h or if you travel ﬁrst with f from a to b and then
change to the fast train h ı g (no stop at c), you will end up with the
same result.
Given f 2 homK.a; b/, we call object a the domain and object b the
codomain of morphism f .
Let us have a look at some examples.
Example 2.1.2 The category Set is the most important of them all. It
Set
has sets as its class of objects, and the morphisms homSet.a; b/ are just
the maps from set a to set b. The identity map ida W a ! a maps each
element to itself, and composition is just composition of maps, which is

2.1. BASIC DEFINITIONS
113
associative:

f ı .g ı h/

.x/ D f

g ı h.x/

D f

g.h.x//

D

f ı g

.h.x// D

.f ı g/ ı h

.x/
✌
The next example shows that one class of objects can carry more than
one kind of morphisms.
Example 2.1.3 The category Rel has sets as its class of objects. Given
Rel
sets a and b, f 2 homRel.a; b/ is a morphism from a to b iff f  a  b
is a relation. Given set a, deﬁne
ida WD fhx; xi j x 2 ag
as the identity relation and deﬁne for f 2 homRel.a; b/; g 2 homRel.b; c/
the composition as
g ı f WD fhx; ´i j there exists y 2 b with hx; yi 2 f and hy; ´i 2 gg
Because existential quantiﬁers can be interchanged, composition is as-
sociative, and ida serves in fact as the identity element for composition.
✌
But morphisms do not need to be maps or relations.
Example 2.1.4 Let .P; / be a partially ordered set. Deﬁne P by taking
the class jPj of objects as P , and put
homP.p; q/ WD
(
fhp; qig;
if p  q
;;
otherwise:
Then idp is hp; pi, the only element of homP.p; p/, and if f W p !
q; g W q ! r, thus p  q and q  r; hence by transitivity p  r, so
that we put g ı f WD hp; ri. Let h W r ! s, then
h ı .g ı f / D h ı hp; ri D hp; si D hq; si ı f D .h ı g/ ı f
It is clear that idp D hp; pi serves as a neutral element. ✌
A directed graph generates a category through all its ﬁnite paths. Com-
position of two paths is then just their combination, indicating move-
ment from one node to another, possibly via intermediate nodes. But we
also have to cater to the situation that we want to stay in a node.

114
CHAPTER 2. CATEGORIES
Example 2.1.5 Let G D .V; E/ be a directed graph. Recall that a path
hp0; : : : ; pni is a ﬁnite sequence of nodes such that adjacent nodes form
an edge, i.e., hpi; piC1i 2 E for 0  i < n; each node a has an
empty path ha; ai attached to it, which may or may not be an edge in
the graph. The objects of the category F.G/ are the nodes V of G,
and a morphism a ! b in F.G/ is a path connecting a with b in G,
hence a path hp0; : : : ; pni with p0 D a and pn D b. The empty path
serves as the identity Morphism; the composition of morphism is just
their concatenation; this is plainly associative. This category is called
the free category generated by graph G. ✌
Free
category
These two examples base categories on a set of objects; they are in-
stances of small categories. A category is called small iff the objects
form a set (rather than a class).
The discrete category is a trivial but helpful example.
Example 2.1.6 Let X 6D ; be a set, and deﬁne a category K through
jKj WD X with
homK.x; y/ WD
(
fidxg;
x D y
;;
otherwise
This is the discrete category on X. ✌
Algebraic structures furnish a plentiful source for examples. Let us have
a look at groups and at Boolean algebras.
Example 2.1.7 The category of groups has as objects all groups .G; /
and as morphisms f W .G; / ! .H; / all maps f W G ! H which
are group homomorphisms, i.e., for which f .1G/ D 1H (with 1G; 1H
as the respective neutral elements), for which f .a1/ D .f .a//1 and
f .a  b/ D f .a/  f .b/ always hold. The identity morphism id.G;/
is the identity map, and composition of homomorphisms is composition
of maps. Because composition is inherited from category Set, we do not
have to check for associativity or for identity.
We do not associate the category with a particular name; it is simply
referred to as the category of groups. ✌
Category of
groups
Example 2.1.8 Similarly, the category of Boolean algebras has Boolean
algebras as objects, and a morphism f W G ! H for the Boolean alge-

2.1. BASIC DEFINITIONS
115
bras G and H is a map f between the carrier sets with these properties:
f .a/ D f .a/
f .a ^ b/ D f .a/ ^ f .b/
f .>/ D >
(hence also f .?/ D ?, and f .a _ b/ D f .a/ _ f .b/). Again, compo-
sition of morphisms is composition of maps, and the identity morphism
is just the identity map. ✌
The next example deals with transition systems. Formally, a transition
system is a directed graph. But whereas discussing a graph puts the em-
phasis usually on its paths, a transition system is concerned more with
the study of, well, the transition between two states; hence the focus
is more strongly localized. This is reﬂected when deﬁning morphisms,
which, as we will see, come in two ﬂavors.
Example 2.1.9 A transition system .S;  S/ is a set S of states together
.S;  S/
with a transition relation  S  S  S. Intuitively, s  S s0 iff there is
a transition from s to s0. Transition systems form a category: the objects
are transition systems, and a morphism f W .S;  S/ ! .T;  T / is a
map f W S ! T such that s  S s0 implies f .s/  T f .s0/. This
means that a transition from s to s0 in .S;  S/ entails a transition from
f .s/ to f .s0/ in the transition system .T;  T /. Note that the deﬁning
condition for f can be written as  S  .f  f /1
 T

with f f W
hs; s0i 7! hf .s/; f .s0/i. ✌
The morphisms in Example 2.1.9 are interesting from a relational point
of view. We will require an additional property which, roughly speak-
ing, makes sure that we not only transport transitions through mor-
phisms but that we are also able to capture transitions which emanate
from the image of a state. So we want to be sure that we obtain a transi-
tion f .s/  T t from a transition arising from s in the original system.
This idea is formulated in the next example; it will arise again in a very
natural manner in Example 2.6.12 in the context of coalgebras.
Example 2.1.10 We continue with transition systems, so we deﬁne a
category which has transition systems as objects.
A morphism f
W
.S;  S/ ! .T;  T / in the present category is a map f W S ! T
such that for all s; s0 2 S; t 2 T .
Forward: s  S s0 implies f .s/  T f .s0/.

116
CHAPTER 2. CATEGORIES
Backward: if f .s/  T t0, then there exists s0 2 S with f .s0/ D t0 and
s  S s0.
The forward condition is already known from Example 2.1.9; the back-
ward condition is new. It states that if we start a transition from some
f .s/ in T , then this transition originates from some transition starting
from s in S; to distinguish these morphisms from the ones considered in
Example 2.1.9, they are called bounded morphisms. The identity map
Bounded
morphisms
S ! S yields a bounded morphism, and the composition of bounded
morphisms is a bounded morphism again. In fact, let f W .S;  S/ !
.T;  T /; g W .T;  T / ! .U;  U / be bounded morphisms, and as-
sume that g.f .s//  U u0: Then we can ﬁnd t0 2 T with g.t0/ D u0
and f .s/  T t0; hence we ﬁnd s0 2 S with f .s0/ D t0 and s  S s0.
Bounded morphisms are of interest in the study of models for modal
logics [BdRV01]; see Lemma 2.7.25. ✌
The next examples reverse arrows when it comes to deﬁning morphisms.
The examples so far observed the effects of maps in the direction in
which the maps were deﬁned. We will, however, also have an opportu-
nity to operate in the backward direction and to see what properties the
inverse image of a map is supposed to have.
We study this in the context of topological and of measurable spaces.
Example 2.1.11 Let .S;/ be a topological space; see Deﬁnition 1.5.47;
hence   P .S/ with ;; S 2 ,  is closed under ﬁnite intersections
and arbitrary unions. Given another topological space .T; #/, a map
f W S ! T is called -#-continuous iff the inverse image of an open set
is open again, i.e., iff f 1
G

2 # for all G 2 ; this will be discussed
in greater depth in Sect. 3.1.1. Category Top of topological spaces has
Top
all topological spaces as objects and continuous maps as morphisms.
The identity .S; / ! .S; / is certainly continuous. Again, it follows
that the composition of morphisms yields a morphism and that their
composition is associative. ✌
The next example deals with -algebras, which are of course also sets
of subsets. Measurability is formulated similar to continuity in terms of
the inverse rather than the direct image.

2.1. BASIC DEFINITIONS
117
Example 2.1.12 Let S be a set, and assume that A is a -algebra on S.
Then the pair .S; A/ is called a measurable space; the elements of the
-algebra are sometimes called A-measurable sets. The category Meas
Meas
has as objects all measurable spaces.
Given two measurable spaces .S; A/ and .T; B/, a map f W S ! T
is called a morphism of measurable spaces iff f is A-B-measurable.
This means that f 1
B

2 A for all B 2 B; hence the set fs 2
S j f .s/ 2 Bg is an A-measurable set for each B-measurable set B.
Each -algebra is a Boolean algebra, but the deﬁnition of a morphism
of measurable spaces does not entail that such a morphism induces a
morphism of Boolean algebras, as deﬁned in Example 2.1.8. Measur-
able maps are rather modeled on the prototype of continuous maps, for
which the inverse image of an open set is open again. Replace “open”
by r“measurable”; then you obtain the deﬁnition of a measurable map.
Consequently the behavior of f 1 rather than the one of f determines
whether f belongs to this distinguished set of morphisms.
Thus the A-B-measurable maps f W S ! T are the morphisms f W
.S; A/ ! .T; B/ in category Meas. The identity morphism on .S; A/
is the identity map (this map is measurable because id 1
A

D A 2 A
for each A 2 A). Composition of measurable maps yields a measurable
map again: let f W .S; A/ ! .T; B/ and g W .T; B/ ! .U; C/, then
.g ı f /1
D

D f 1
g1
D

2 A; for D 2 C, because g1
D

2
B. It is clear that composition is associative, since it is based on compo-
sition of ordinary maps. ✌
Now that we know what a category is, we begin constructing new cate-
gories from given ones. We start by building on category Meas another
interesting category, indicating that a category can be used as a building
block for another one.
Example 2.1.13 A measurable space .S; A/ together with a probability
measure  on A (see Deﬁnition 1.6.12) is called a probability space
and written as .S; A; /. The category Prob of all probability spaces
Prob
has—you guessed it—as objects all probability spaces; a morphism f W
.S; A; / ! .T; B; / is a morphism f W .S; A/ ! .T; B/ in Meas for
the underlying measurable spaces such that .B/ D .f 1
B

/ holds
for all B 2 B. Thus the -probability for event B 2 B is the same as the
-probability for all those s 2 S, the image of which is in B. Note that

118
CHAPTER 2. CATEGORIES
f 1
B

2 A due to f being a morphism in Meas, so that .f 1
B

/
is in fact deﬁned. ✌
We go a bit further and combine two measurable spaces into a third one;
this requires adjusting the notion of a morphism, which are in this new
category basically pairs of morphisms from the underlying category.
This shows the ﬂexibility with which we may—and do—manipulate
morphisms.
Example 2.1.14 Denote for the measurable space .S; A/ by P .S; A/
P .S; A/
the set of all subprobability measures. Deﬁne
ˇˇˇA.A; r/ WD f 2 P .S; A/ j .A/  rg;
}}}.X; A/ WD }}}.A/ WD 

fˇˇˇA.A; r/ j A 2 A; 0  r  1g

:
Thus ˇˇˇA.A; r/ denotes all probability measures which evaluate set A
not smaller than r, and }}}.X; A/ collects all these sets into a -algebra;
}}}.X; A/ is called the weak -algebra associated with A as the -algebra
generated by the family of sets; its elements are sometimes called weakly
measurable sets. We will usually omit the carrier set from the notation.
ˇS.A; r/;
}}}.A/
This renders

P .S; A/ ;}}}.A/

a measurable space.
Let .T; B/ be another measurable space. A map K W S ! P .T; B/ is
A-}}}.B/-measurable iff fs 2 S j K.s/.B/  rg 2 A for all B 2 B;
this follows from Exercise 2.7. We take as objects for our category
the triplets

.S; A/; .T; B/; K

, where .S; A/ and .T; B/ are measurable
spaces and K W S ! P .T; B/ is A-}}}.B/-measurable. A morphism
.f; g/ W

.S; A/; .T; B/; K

!

.S0; A0/; .T 0; B0/; K0
is a pair of morphisms
f W .S; A/ ! .S0; A0/ and g W .T; B/ ! .T 0; B0/
such that
K.s/.g1
B0
/ D K0.f .s//.B0/
holds for all s 2 S and for all B0 2 B0.
The composition of morphisms is deﬁned component wise:
.f 0; g0/ ı .f; g/ WD .f 0 ı f; g0 ı g/:
Note that f 0 ı f and g0 ı g refer to the composition of maps, while
.f 0; g0/ ı .f; g/ refers to the newly deﬁned composition in our new

2.1. BASIC DEFINITIONS
119
spic-and-span category (we should probably use another symbol, but no
confusion can arise, since the new composition operates on pairs). The
identity morphism for

.S; A/; .T; B/; K

is just the pair .idS; idT /.
Because the composition of maps is associative, composition in our
new category is associative as well, and because .idS; idT / is composed
from identities, it is also an identity.
This category is sometimes called the category of stochastic relations.
Category of
stochastic re-
lations
✌
Before continuing, we introduce commutative diagrams. Suppose that
we have in a category K morphisms f W a ! b and g W b ! c. The
combined morphism g ı f is represented graphically as
If the morphisms h W a ! d and ` W d ! c satisfy g ı f D ` ı h,
we have a commutative diagram; in this case, we do not draw out the
morphism in the diagonal.
We consider automata next, to get some feeling for the handling of
commutative diagrams and as an illustration for an important formal-
ism looked at through the glasses of categories.
Example 2.1.15 Given sets X and S of inputs and states, respectively,
an automaton .X; S; ı/ is deﬁned by a map ı W X  S ! S. The inter-
pretation is that ı.x; s/ is the new state after input x 2 X in state s 2 S.
Reformulating, ı.x/ W s 7! ı.x; s/ is perceived as a map S ! S for
each x 2 X, so that the new state now is written as ı.x/.s/; manipulat-
ing a map with two arguments in this way is called currying and will be
examined in Example 2.5.2. The objects of our category of automata are

120
CHAPTER 2. CATEGORIES
the automata, and an automaton morphism f W .X; S; ı/ ! .X; S0; ı0/
is a map f W S ! S0 such that this diagram commutes for all x 2 X:
Hence we have f .ı.x/.s// D ı0.x/.f .s// for each x 2 X and s 2
S (or, in the old notation, f

ı.x; s/

D ı0
x; f .s/

); this means that
computing the new state and mapping it through f yields the same result
as computing the new state for the mapped one. The identity map S !
S yields a morphism; hence automata with these morphisms form a
category.
Note that morphisms are deﬁned only for automata with the same input
alphabet. This reﬂects the observation that the input alphabet is usu-
ally given by the environment, while the set of states represents a model
about the automata’s behavior and, hence, is at our disposal for manip-
ulation. ✌
Whereas we constructed the above new categories from the given one in
an ad hoc manner, categories also yield new categories systematically.
This is a simple example.
Example 2.1.16 Let K be a category; ﬁx an object x on K. The objects
of our new category are the morphisms f 2 homK.a; x/ for an object
a. Given objects f 2 homK.a; x/ and g 2 homK.b; x/ in the new
category, a morphism ' W f ! g is a morphism ' 2 homK.a; b/ with
f D g ı ', so that this diagram commutes
Composition is inherited from K. The identity idf W f ! f is ida 2
homK.a; a/, provided f 2 homK.a; x/. Since the composition in K
is associative, we have only to make sure that the composition of two

2.1. BASIC DEFINITIONS
121
morphisms is a morphism again. This can be read off the following
diagram: .' ı  / ı h D ' ı . ı h/ D ' ı g D f .
This category is sometimes called the slice category K=x; the object x
K=x
is interpreted as an index, so that a morphism f W a ! x serves as an
indexing function. A morphism ' W a ! b in K=x is then compatible
with the index operation. ✌
The next example reverses arrows while at the same time maintaining
the same class of objects.
Example 2.1.17 Let K be a category. We deﬁne Kop, the category dual
Kop
to K, in the following way: the objects are the same as for the original
category; hence jKopj D jKj, and the arrows are reversed; hence we put
homKop.a; b/ WD homK.b; a/ for the objects a; b; the identity remains
the same. We have to deﬁne composition in this new category. Let f 2
homKop.a; b/ and g 2 homKop.b; c/; then gf WD f ıg 2 homKop.a; c/.
It is readily veriﬁed that  satisﬁes all the laws for composition from
Deﬁnition 2.1.1.
The dual category is sometimes helpful because it permits to cast notions
into a uniform framework. ✌
Example 2.1.18 Let us look at Rel again. The morphisms homRelop
.S; T / from S to T in Relop are just the morphisms homRel.T; S/ in
Rel. Take f 2 homRelop.S; T / and then f  T S; hence f t  S T ,
where relation
f t WD fhs; ti j ht; si 2 f g
is the transposed of relation f . The map f 7! f t is injective and
compatible with composition; moreover, it maps homRelop.S; T / onto
homRel.T; S/. But this means that Relop is essentially the same as Rel.
✌
It is sometimes helpful to combine two categories into a product:
Lemma 2.1.19 Given categories K and L, deﬁne the objects of K  L
K  L
as pairs ha; bi, where a is an object in K and b is an object in L. A

122
CHAPTER 2. CATEGORIES
morphism ha; bi ! ha0; b0i in K L is comprised of morphisms a ! a0
in K and b ! b0 in L. Then K  L is a category. a
We have a closer look at morphisms now. Experience tells us that in-
jective and surjective maps are important, so a characterization in a cat-
egory might be desirable. There is a small but not insigniﬁcant catch,
however. We have seen that morphisms are not always maps, so that
we are forced to ﬁnd a characterization purely in terms of composition
and equality, because this is all we have in a category. The following
characterization of injective maps provides a clue for a more general
deﬁnition.
Proposition 2.1.20 Let f W X ! Y be a map; then these statements
are equivalent.
1. f is injective.
2. If A is an arbitrary set, g1; g2 W A ! X are maps with f ı g1 D
f ı g2, then g1 D g2.
Proof 1 ) 2: Assume f is injective and f ıg1 D f ıg2, but g1 6D g2.
Thus there exists x 2 A with g1.x/ 6D g2.x/.
But f .g1.x// D
f .g2.x//, and since f is injective, g1.x/ D g2.x/. This is a con-
tradiction.
2 ) 1: Assume the condition holds, but f is not injective. Then there
exists x1 6D x2 with f .x1/ D f .x2/. Let A WD fg and put g1./ WD
x1, g2./ WD x2; thus f .x1/ D .f ıg1/./ D .f ıg2/./ D f .x2/: By
the condition g1 D g2, thus x1 D x2. Another contradiction. a
This leads to a deﬁnition of the category version of injectivity as a mor-
phism which is cancelable on the left.
Deﬁnition 2.1.21 Let K be a category, a; b objects in K. Then f W a !
b is called a monomorphism (or a mono) iff whenever g1; g2 W x ! a
are morphisms with f ı g1 D f ı g2; then g1 D g2.
Mono
These are some simple properties of monomorphisms, which are also
sometimes called monos.
Lemma 2.1.22 In a category K:
1. The identity is a monomorphism.
2. The composition of two monomorphisms is a monomorphism
again.

2.1. BASIC DEFINITIONS
123
3. If k ı f is a monomorphism for some morphism k, then f is a
monomorphism.
Proof The ﬁrst part is trivial. Let f W a ! b and g W b ! c both monos.
Assume h1; h2 W x ! a with h1 ı .g ı f / D h2 ı .g ı f /: We want to
show h1 D h2. By associativity .h1 ı g/ ı f D .h2 ı g/ ı f: Because f
is a mono, we conclude h1 ı g D h2 ı g; because g is a mono, we see
h1 D h2:
Finally, let f W a ! b and k W b ! c. Assume h1; h2 W x ! a with
f ı h1 D f ı h2: We claim h1 D h2. Now f ı h1 D f ı h2 implies
k ı f ı h1 D k ı f ı h2: Thus h1 D h2. a
In the same way, we characterize surjectivity purely in terms of compo-
sition, exhibiting a nice symmetry between the two notions.
Proposition 2.1.23 Let f W X ! Y be a map; then these statements
are equivalent.
1. f is surjective.
2. If B is an arbitrary set, g1; g2 W Y ! B are maps with g1 ı f D
g2 ı f , then g1 D g2.
Proof 1 ) 2: Assume f is surjective, g1 ı f D g2 ı f , but g1.y/ 6D
g2.y/ for some y. If we can ﬁnd x 2 X with f .x/ D y, then g1.y/ D
.g1 ı f /.x/ D .g2 ı f /.x/ D g2.y/; which would be a contradiction.
Thus y … f

X

; hence f is not onto.
2
)
1: Assume that there exists y 2 Y with y … f

X

. Deﬁne
g1; g2 W Y ! f0; 1; 2g through
g1.y/ WD
(
0;
if y 2 f

X

;
1;
otherwise:
g2.y/ WD
(
0;
if y 2 f

X

;
2;
otherwise:
Then g1 ı f D g2 ı f , but g1 6D g2. This is a contradiction. a
This suggests a deﬁnition of surjectivity through a morphism which is
right cancelable.
Deﬁnition 2.1.24 Let K be a category, a; b objects in K. Then f W a !
b is called a epimorphism (or an epi) iff whenever g1; g2 W b ! c are
Epi
morphisms with g1 ı f D g2 ı f ; then g1 D g2.

124
CHAPTER 2. CATEGORIES
These are some important properties of epimorphisms, which are some-
times called epis:
Lemma 2.1.25 In a category K:
1. The identity is an epimorphism.
2. The composition of two epimorphisms is an epimorphism again.
3. If f ı k is an epimorphism for some morphism k, then f is an
epimorphism.
Proof We sketch the proof only for the third part:
g1 ı f D g2 ı f ) g1 ı f ı k D g2 ı f ı k ) g1 D g2:
a
This is a small application of the decomposition of a map into an epi-
morphism and a monomorphism.
Proposition 2.1.26 Let f W X ! Y be a map. Then there exists a
factorization of f into m ı e with e an epimorphism and m a monomor-
phism.
The idea of the proof may best be described in terms of X as inputs
and Y as outputs of system f . We collect all inputs with the same
functionality, and assign each collection the functionality through which
it is deﬁned.
Proof Deﬁne
ker .f / WD fhx1; x2i j f .x1/ D f .x2/g
(the kernel ker .f / of f ). This is an equivalence relation on X:
ker .f /
 reﬂexivity: hx; xi 2 ker .f / for all x,
 symmetry: if hx1; x2i 2 ker .f /, then hx2; x1i 2 ker .f /;
 transitivity: hx1; x2i 2 ker .f / and hx2; x3i 2 ker .f / together
imply hx1; x3i 2 ker .f /.

2.1. BASIC DEFINITIONS
125
Deﬁne
e W
(
X
! X=ker .f /;
x
7! Œxker.f /
then e is an epimorphism. In fact, if g1 ı e D g2 ı e for g1; g2 W
X=ker .f / ! B for some set B, then g1.t/ D g2.t/ for all t 2
X=ker .f /; hence g1 D g2.
Moreover,
m W
(
X=ker .f /
! Y
Œxker.f /
7! f .x/
is well deﬁned, since if Œxker.f / D Œx0ker.f /, then f .x/ D f .x0/.
It is also a monomorphism. In fact, if m ı g1 D m ı g2 for arbitrary
g1; g2 W A ! X=ker .f / for some set A, then f .g1.a// D f .g2.a// for
all a; hence hg1.a/; g2.a/i 2 ker .f /. But this means Œg1.a/ker.f / D
Œg2.a/ker.f / for all a 2 A, so g1 D g2. Evidently, f D mıe. a
Looking a bit harder at the diagram, we ﬁnd that we can say even more,
viz., that the decomposition is unique up to isomorphism.
Corollary 2.1.27 If the map f W X ! Y can be written as f D eım D
e0 ı m0 with epimorphisms e; e0 and monomorphisms m; m0, then there
is a bijection b with e0 D b ı e and m D m0 ı b.
Proof Since the composition of bijections is a bijection again, we may
and do assume without loss of generality that e W X ! X=ker .f / maps
x to its class Œxker.f / and that m W X=ker .f / ! Y maps Œxker.f / to
f .x/. Then we have this diagram for the primed factorization e0 W X !
Z and m0 W Z ! Y :
Note that
Œxker.f / 6D

x0
ker.f / , f .x/ 6D f .x0/
, m0.e0.x// 6D m0.e0.x0//
, e.x/ 6D e.x0/

126
CHAPTER 2. CATEGORIES
Thus deﬁning b.Œxker.f // WD e0.x/ gives an injective map X=ker .f /
! Z. Given ´ 2 Z, there exists x 2 X with e0.x/ D ´; hence
b.Œxker.f // D ´; thus b is onto. Finally, m0.b.Œxker.f /// D m0.e0.x//
D f .x/ D m.Œxker.f //: a
This factorization of a morphism is called an epi/mono factorization,
and we just have shown that such a factorization is unique up to isomor-
phisms (a.k.a. bijections in Set).
The following example shows that epimorphisms are not necessarily
surjective, even if they are maps.
Example 2.1.28 Recall that .M; / is a monoid iff  W M  M !
M is associative with a neutral element 0M . For example, .Z; C/ and
.N; / are monoids, so is the set X of all strings over alphabet X with
concatenation as composition and the empty string as neutral element.
A morphism f W .M; / ! .N; / is a map f W M ! N such that
f .a  b/ D f .a/f .b/, and f .0M/ D 0N :
Now let f W .Z; C/ ! .N; / be a morphism; then f is uniquely deter-
mined by the value f .1/. This is so since m D 1 C : : : C 1 (m times)
for m > 0; thus f .m/ D f .1 C : : : C 1/ D f .1/ : : : f .1/: Also
f .1/f .1/ D f .1 C 1/ D f .0/, so f .1/ is inverse to f .1/; hence
f .m/ is inverse to f .m/. Consequently, if two morphisms map 1 to
the same value, then the morphisms are identical.
Note that the inclusion i W x 7! x is a morphism i W .N0; C/ ! .Z; C/.
We claim that i is an epimorphism. Let g1 ı i D g2 ı i for some
morphisms g1; g2 W .Z; C/ ! .M; /. Then g1.1/ D .g1 ı i/.1/ D
.g2 ı i/.1/ D g2.1/: Hence g1 D g2. Thus epimorphisms are not
necessarily surjective. ✌
Composition induces maps between the hom sets of a category, which
we are going to study now. Speciﬁcally, let K be a ﬁxed category, take
objects a and b, and ﬁx for the moment a morphism f W a ! b. Then
g 7! f ı g maps homK.x; a/ to homK.x; b/, and h 7! h ı f maps
homK.b; x/ to homK.a; x/ for each object x. We investigate g 7! f ı g
ﬁrst. Deﬁne for an object x of K the map
homK.x; /
homK.x; f / W
(
homK.x; a/
! homK.x; b/
g
7! f ı g

2.1. BASIC DEFINITIONS
127
Then homK.x; f / deﬁnes a map between morphisms, and we can deter-
mine through this map whether or not f is a monomorphism.
Lemma 2.1.29 f W a ! b is a monomorphism iff homK.x; f / is injec-
tive for all objects x.
Proof This follows immediately from the observation
f ı g1 D f ı g2 , homK.x; f /.g1/ D homK.x; f /.g2/:
a
Dually, deﬁne for an object x of K the map
homK.; x/
homK.f; x/ W
(
homK.b; x/
! homK.a; x/
g
7! g ı f
Note that we change directions here: f
W a ! b corresponds to
homK.b; x/ ! homK.a; x/.
Note also that we did reuse the name
homK.; /; but no confusion should arise, because the signature tells
us which map we speciﬁcally have in mind. Lemma 2.1.29 seems to
suggest that surjectivity of homK.f; x/ and f being an epimorphism are
related. This, however, is not the case. But try this:
Lemma 2.1.30 f W a ! b is an epimorphism iff homK.f; x/ is injec-
tive for each object x.
Proof homK.f; x/.g1/ D homK.f; x/.g2/ is equivalent to g1 ı f D
g2 ı f . a
Not surprisingly, an isomorphism is an invertible morphism; this is de-
scribed in our scenario as follows.
Deﬁnition 2.1.31 f W a ! b is called an isomorphism iff there exists a
morphism g W b ! a such that g ı f D ida and f ı g D idb.
It is clear that morphism g is in this case uniquely determined: let g and
g0 be morphisms with the property above; then we obtain g D gıidb D
g ı .f ı g0/ D .g ı f / ı g0 D ida ı g0 D g0:
When we are in the category Set of sets with maps, an isomorphism f
is bijective. In fact, let g be chosen to f according to Deﬁnition 2.1.31,
then
h1 ı f D h2 ı f
) h1 ı f ı g D h2 ı f ı g
) h1 D h2;
f ı g1 D f ı g2
) g ı f ı g1 D g ı f ı g2
) g1 D g2;

128
CHAPTER 2. CATEGORIES
so that the ﬁrst line makes f an epimorphism, and the second one a
monomorphism.
The following lemma is often helpful (and serves as an example of the
popular art of diagram chasing).
Lemma 2.1.32 Assume that in this diagram
the outer diagram commutes, that the leftmost diagram commutes, and
that f is an epimorphism. Then the rightmost diagram commutes as
well.
Proof In order to show that m ı g D s ı `, it is enough to show that
m ı g ı f D s ı ` ı f , because we then can cancel f , since f is an epi.
But now
.m ı g/ ı f D m ı .g ı f /
D .s ı r/ ı k
(commutativity of the outer diagram)
D s ı .r ı k/
D s ı .` ı f /
(commutativity of the leftmost diagram)
D .s ı `/ ı f
Now cancel f . a
2.2
Elementary Constructions
In this section, we deal with some elementary constructions, showing
mainly how some important constructions for sets can be carried over to
categories, hence are available in more general structures. Speciﬁcally,
we will study products and sums (coproducts) as well as pullbacks and
pushouts. We will not study more general constructs at present; in par-
ticular we will not have a look at limits and colimits. Once products and
pullbacks are understood, the step to limits should not be too compli-
cated, similarly for colimits, as the reader can see in the brief discussion
in Sect. 2.3.3.
We ﬁx a category K.

2.2. ELEMENTARY CONSTRUCTIONS
129
2.2.1
Products and Coproducts
The Cartesian product of two sets is just the set of pairs. In a general cat-
egory, we do not have a characterization through sets and their elements
at our disposal, so we have to ﬁll this gap by going back to morphisms.
Thus we require a characterization of the product through morphisms.
The ﬁrst thought is using the projections hx; yi 7! x and hx; yi 7! y,
since a pair can be reconstructed through its projections. But this is not
speciﬁc enough. An additional characterization of the projections is ob-
tained through factoring: if there is another pair of maps pretending to
be projections, they better be related to the “genuine” projections. This
is what the next deﬁnition expresses.
Deﬁnition 2.2.1 Given objects a and b in K. An object c is called the
product of a and b iff:
1. there exist morphisms a W c ! a and b W c ! b,
2. for each object d and morphisms ˛a W d ! a and ˛b W d ! b,
there exists a unique morphism  W d ! c such that ˛a D a ı 
and ˛b D b ı .
Morphisms a and b are called projections to a resp. b.
Thus ˛a and ˛b factor uniquely through a and b. Note that we in-
sist on having a unique factor and that the factor should be the same for
both pretenders. We will see in a minute why this is a sensible assump-
tion. If it exists, the product of objects a and b is denoted by a  b;
the projections a and b are usually understood and not mentioned
explicitly.
This diagram depicts the situation:
(PRODUCT)
Lemma 2.2.2 If the product of two objects exists, it is unique up to
isomorphism.
Proof Let a and b be the objects in question; also assume that c1 and
c2 are products with morphisms i;a ! a and i;b ! b as the corre-
sponding morphisms, i D 1; 2.

130
CHAPTER 2. CATEGORIES
Because c1 together with 1;a and 1;b is a product, we ﬁnd a unique
morphism 
 W c2 ! c1 with 2;a D 1;a ı 
 and 2;b D 1;b ı 
;
similarly, we ﬁnd a unique morphism 	 W c1 ! c2 with 1;a D 2;a ı 	
and 1;b D 2;b ı 	.
Now look at 
 ı 	: We obtain
1;a ı 
 ı 	 D 2;a ı 	 D 1;a
1;b ı 
 ı 	 D 2;b ı 	 D 1;b
Then uniqueness of the factorization implies that 
 ı	 D idc1; similarly,
	 ı 
 D idc2. Thus 
 and 	 are isomorphisms. a
Let us have a look at some examples, ﬁrst and foremost sets.
Example 2.2.3 Consider the category Set with maps as morphisms.
Given sets A and B, we claim that A  B together with the projec-
tions A W ha; bi 7! a and B W ha; bi 7! b constitute the product of
A and B in Set. In fact, if #A W D ! A and #B W D ! B are maps
for some set D, then  W d 7! h#A.d/; #B.d/i satisﬁes the equations
#A D A ı , #B D B ı , and it is clear that this is the only way to
factor, so  is uniquely determined. ✌
If sets carry an additional structure, this demands additional attention.
Example 2.2.4 Let .S; A/ and .T; B/ be measurable spaces, so we are
now in the category Meas of measurable spaces with measurable maps
as morphisms; see Example 2.1.12. For constructing a product, one is
tempted to take the product S T as Set and to ﬁnd a suitable -algebra
C on S  T such that the projections S and T become measurable.
Thus C would have to contain 1
S

A

D A  T and 1
T

B

D S  B
for each A 2 A and each B 2 B. Because a -algebra is closed under
intersections, C would have to contain all measurable rectangles A  B
with sides in A and B. So let us try this:
C WD 

fA  B j A 2 A; B 2 Bg

:

2.2. ELEMENTARY CONSTRUCTIONS
131
Then clearly, S W .S  T; C/ ! .S; A/ and T W .S  T; C/ ! .T; B/
are morphisms in Meas. Now let .D; D/ be a measurable space with
morphisms #S W D ! S and #T W D ! T , and deﬁne  as above
through .d/ WD h#S.d/; #T .d/i. We claim that  is a morphism in
Meas. It has to be shown that 1
C

2 D for all C 2 C. We have a
look at all elements of C for which this is true, and we deﬁne
G WD fC 2 C j 	1
C

2 Dg:
We plan to use the principle of good sets from page 86. If we can show
that G D C, we are done. It is evident that G is a -algebra, because the
inverse image of a map respects countable Boolean operations. More-
over, if A 2 A and B 2 B, then 1
AB

D #1
S

A

\#1
T

B

2 D;
so that A  B 2 G, provided A 2 A; B 2 B. But now we have
C D .fA  B j A 2 A; B 2 Bg/  G  C:
Hence each element of C is a member of G; thus  is D-C-measurable.
Again, the construction shows that there is no other possibility for deﬁn-
ing . Hence we have shown that two objects in the category Meas of
measurable spaces with measurable maps have a product.
The -algebra C which is constructed above is usually denoted by A˝B
A ˝ B
and called the product -algebra of A and B. ✌
The next example requires a forward reference to the construction of the
product measure in Sect. 4.9. I suggest that you skip them on the ﬁrst
reading; just to make things easier, I have marked them with a special
symbol.
Example 2.2.5 s While the category Meas has products, the situation
changes when taking probability measures into account; hence when
changing to the category Prob of probability spaces, see Example 2.1.13.
The product measure ˝ of two probability measures  on -algebra
A resp.  on B is the unique probability measure on the product -
algebra A ˝ B with . ˝ /.A  B/ D .A/  .B/ for A 2 A and
B 2 B, in particular
S W .S  T; A ˝ B;  ˝ / ! .S; A; /;
T W .S  T; A ˝ B;  ˝ / ! .T; B; /
are morphisms in Prob.

132
CHAPTER 2. CATEGORIES
Now deﬁne S WD T WD Œ0; 1 and take in each case the smallest -
algebra which is generated by the open intervals as a -algebra; hence
put A WD B WD B.Œ0; 1/;  is Lebesgue measure on B.Œ0; 1/. Deﬁne
.E/ WD .fx 2 Œ0; 1 j hx; xi 2 Eg/
for E 2 A ˝ B (well, we have to show that fx 2 Œ0; 1 j hx; xi 2 Eg 2
B.Œ0; 1/, whenever E 2 A ˝ B. This is relegated to Exercise 2.10).
Then
S W .S  T; A ˝ B; / ! .S; A; /
T W .S  T; A ˝ B; / ! .T; B; /
are morphisms in Prob, because
.1
S

G

/ D .G  T / D .fx 2 Œ0; 1 j hx; xi 2 G  T g/ D .G/
for G 2 B.S/. If we could ﬁnd a morphism f W .S  T; A ˝ B; / !
.S  T; A ˝ B;  ˝ / factoring through the projections, f would have
to be the identity; thus it would imply that  D  ˝ , but this is not the
case: take E WD Œ1=2; 1  Œ0; 1=3I then .E/ D 0, but . ˝ /.E/ D
1=6.
Thus we conclude that the category Prob of probability spaces does not
have products. ✌
The product topology on the Cartesian product of the carrier sets of
topological spaces is familiar, open sets in the product just contain open
rectangles. The categorical view is that of a product in the category of
topological spaces.
Example 2.2.6 Let .T; / and .S; #/ be topological spaces, and equip
the Cartesian product S T with the product topology  #. This is the
smallest topology on ST which contains all the open rectangles GH
with G 2  and H 2 #. We claim that this is a product in the category
Top of topological spaces. In fact, the projections S W S  T ! S and
T W S  T ! T are continuous, because, e.g, 1
S

G

D G  T 2
  #. Now let .D; / be a topological space with continuous maps

S W D ! S and 
T W D ! T , and deﬁne 	 W D ! S  T through
	 W d 7! h
S.d/; 
T .d/i. Then 	1
G H

D 
1
S

G

\
1
T

H

2 ,
and since the inverse image of a topology under a map is a topology
again, 	 W .D; D/ ! .S  T;   #/ is continuous. Again, this is the
only way to deﬁne a morphism 	 so that 
S D S ı 	 and 
T D T ı 	.
✌

2.2. ELEMENTARY CONSTRUCTIONS
133
The category coming from a partially ordered set from Example 2.1.4 is
investigated next.
Example 2.2.7 Let .P; / be a partially ordered set, considered as a
category P. Let a; b 2 P , and assume that a and b have a product x in
P. Thus there exist morphisms a W x ! a and b W x ! b, which
means by the deﬁnition of this category that x  a and x  b hold and
hence that x is a lower bound to fa; bg. Moreover, if y is such that there
are morphisms a W y ! a and b W y ! b, then there exists a unique
 W y ! x with a D aı and b W b ı. Translated into .P; /, this
means that if y  a and y  b, then y  x (morphisms in P are unique,
if they exist). Hence the product x is just the greatest lower bound of
fa; bg.
So the product corresponds to the inﬁmum. This example demonstrates
again that products do not necessarily exist in a category and, if they
exist, are not always what one would expect. ✌
Given morphisms f W x ! a and g W x ! b, and assuming that the
product a  b exists, we want to “lift” f and g to the product; i.e., we
want to ﬁnd a morphism h W x ! ab with f D aıh and g D b ıh.
Let us see how this is done in Set: Here, f W X ! A and g W X ! B
are maps, and one deﬁnes the lifted map h W X ! A  B through
h W x 7! hf .x/; g.x/i, so that the conditions on the projections are
satisﬁed. The next lemma states that this is always possible in a unique
way.
Lemma 2.2.8 Assume that the product ab exists for the objects a and
b. Let f W x ! a and g W x ! b be morphisms. Then there exists a
unique morphism q W x ! a  b such that f D a ı q and g D b ı q.
Morphism q is denoted by f  g.
Proof The diagram looks like this:
Because f W x ! a and g W x ! b, there exists a unique q W x ! a  b
with f D a ı q and g D b ı q. This follows from the deﬁnition of
the product. a
Let us look at the product through our homK-glasses. If ab exists, and
if 	a W d ! a and 	b W d ! b are morphisms, we know that there is a

134
CHAPTER 2. CATEGORIES
unique 
 W d ! a  b rendering this diagram commutative
Thus the map
pd W
(
homK.d; a/  homK.d; b/
! homK.d; a  b/
h	a; 	bi
7! 
is well deﬁned. In fact, we can say more.
Proposition 2.2.9 pd is a bijection.
Proof Assume 
 D pd.f; g/ D pd.f 0; g0/. Then f D a ı 
 D f 0
and g D b ı 
 D g0. Thus hf; gi D hf 0; g0i. Hence pd is injective.
Similarly, one shows that pd is surjective: Let h 2 homK.d; a  b/,
then a ı h W d ! a and b ı h W d ! b are morphisms, so there
exists a unique h0 W d ! a  b with a ı h0 D a ı h and b ı h0 D
b ı h. Uniqueness implies that h D h0, so h occurs in the image of pd.
a
Let us consider the construction dual to the product.
Deﬁnition 2.2.10 Given objects a and b in category K, the object s
together with morphisms ia W a ! s and ib W b ! s is called the
coproduct(or the sum) of a and b iff for each object t with morphisms
ja W a ! t and jb W b ! t there exists a unique morphism r W s ! t
such that ja D r ı ia and jb D r ı ib. Morphisms ia and ib are called
injections; the coproduct of a and b is denoted by a C b.
This is the corresponding diagram:
(COPRODUCT)
These are again some simple examples.

2.2. ELEMENTARY CONSTRUCTIONS
135
Example 2.2.11 Let .P; / be a partially ordered set, and consider cat-
egory P, as in Example 2.2.7. The coproduct of the elements a and b
is just the supremum supfa; bg. This is shown with exactly the same
arguments which have been used in Example 2.2.7 for showing that the
product of two elements corresponds to their inﬁmum. ✌
And then there is of course the category Set.
Example 2.2.12 Let A and B be disjoint sets. Then S WD A [ B to-
gether with
iA W
(
A
! S
a
7! a
iB W
(
B
! S
b
7! b
form the coproduct of A and B. In fact, if T is a set with maps jA W
A ! T and jB W B ! T , then deﬁne
r W
8
ˆ<
ˆ:
S
! T
s
7! jA.a/; if s D iA.a/;
s
7! jB.b/; if s D iB.b/
Then jA D r ı iA and jB D r ı iB, and these deﬁnitions are the only
possible ones.
Note that we needed for this construction to work disjointness of the
participating sets. Consider, for example, A WD f1; 0g, B WD f0; 1g,
and let T WD f1; 0; 1g with jA.x/ WD 1, jB.x/ WD C1. No matter
where we embed A and B, we cannot factor jA and jB uniquely.
If the sets are not disjoint, we ﬁrst do a preprocessing step and embed
them, so that the embedded sets are disjoint. The injections have to be
adjusted accordingly. So the following construction would work: Given
sets A and B, deﬁne S WD fha; 1i j a 2 Ag [ fhb; 2i j b 2 Bg with
iA W a 7! ha; 1i and b 7! hb; 2i. Note that we do not take a product
like S  f1g, but rather use a very speciﬁc construction; this is so since
the product is determined uniquely only by isomorphism, so we might
not have gained anything by using that product. Of course, one has to be
sure that the sum is not dependent in an essential way on this embedding.
✌
The question of uniqueness is answered through this observation. It
relates the coproduct in K to the product in the dual category Kop (see
Example 2.1.17).

136
CHAPTER 2. CATEGORIES
Proposition 2.2.13 The coproduct s of objects a and b with injections
ia W a ! s and ib W b ! s in category K is the product in category Kop
with projections ia W s !op a and is W s !op b.
Proof Revert in diagram (COPRODUCT) on page 134 to obtain diagram
(PRODUCT) on page 129. a
Corollary 2.2.14 If the coproduct of two objects in a category exists, it
is unique up to isomorphisms.
Proof Proposition 2.2.13 together with Lemma 2.2.2. a
Let us have a look at the coproduct for topological spaces.
Example 2.2.15 Given topological spaces .S; / and .T; #/, we may
and do assume that S and T are disjoint. Otherwise, wrap the elements
of the sets accordingly; put
A
 WD fha; 1i j a 2 Ag;
B	 WD fhb; 2i j b 2 Bg;
and consider the topological spaces .S
; fG
 j G 2 g/ and .T 	; fH 	 j
H 2 #g/ instead of .S; / and .T; #/. Deﬁne on the coproduct S C T
of S and T in Set with injections iS and iT the topology
 C # WD fW  S C T j i1
S

W

2  and i1
T

W

2 #g:
This is a topology: Both ; and S C T are members of  C #, and since
 and # are topologies,  C # is closed under ﬁnite intersections and
arbitrary unions. Moreover, both iS W .S; / ! .S C T;  C #/ and
iT W .T; #/ ! .S C T;  C H/ are continuous; in fact,  C # is the
smallest topology on S C T with this property.
Now assume that jS W .S; / ! .R; / and jT W .T; #/ ! .R; / are
continuous maps, and let r W S CT ! R be the unique map determined
by the coproduct in Set. Would it not be nice if r would be continu-
ous? Actually, it is. Let W 2  be open in R, then i1
S

r1
W

D
.r ı iS/1
W

D j 1
S

W

2 ; similarly, i1
S

r1
W

2 #; thus by
deﬁnition, r1
W

2  C #. Hence we have found the factorization
jS D r ı iS and jT D r ı iT in the category Top. This factorization
is unique, because it is inherited from the unique factorization in Set.
Hence we have shown that Top has ﬁnite coproducts. ✌
A similar construction applies to the category of measurable spaces.

2.2. ELEMENTARY CONSTRUCTIONS
137
Example 2.2.16 Let .S; A/ and .T; B/ be measurable spaces; we may
assume again that the carrier sets S and T are disjoint. Take the injec-
tions iS W S ! S C T and iT W T ! S C T from Set. Then
A C B WD fW  S C T j i1
S

W

2 A and i1
T

W

2 Bg
is a -algebra and iS W .S; A/ ! .S C T; A C B/ and iT W .T; B/ !
.S C T; A C B/ are measurable. The unique factorization property is
established in exactly the same way as in Top. ✌
Example 2.2.17 Let us consider the category Rel of relations, which
is based on sets as objects. If S and T are sets, we again may and do
assume that they are disjoint. Then S C T D S [ T together with the
injections
IS WD fhs; iS.s/i j s 2 Sg;
IT WD fht; iT .t/i j t 2 T g
form the coproduct, where iS and iT are the injections into S C T from
Set. In fact, we have to show that we can ﬁnd for given relations qS 
S  D and qT  T  D a unique relation Q  .S C T /  D with
qS D IS ı Q and qT D IT ı Q. The choice is fairly straightforward:
Deﬁne
Q WD fhiS.s/; qi j hs; qi 2 qSg [ fhiT .t/; qi j ht; qi 2 qT g:
Thus
hs; qi 2 IS ı Q , there exists x with hs; xi 2 IS and hx; qi 2 Q
, hs; qi 2 qS:
Hence qS D IS ı Q, similarly, qT D IT ı Q. It is clear that no other
choice is possible.
Consequently, the coproduct is the same as in Set. ✌
We have just seen in a simple example that dualizing, i.e., going to the
dual category, is very helpful. Instead of proving directly that the co-
product is uniquely determined up to isomorphism, if it exists, we turned
to the dual category and reused the already established result that the
product is uniquely determined, casting it into a new context. The dual-
ity, however, is a purely structural property; it usually does not help us
with speciﬁc constructions. This became apparent when we constructed

138
CHAPTER 2. CATEGORIES
the coproduct of two sets; it did not help here at all that we knew how
to construct the product of two sets, even though product and coprod-
uct are intimately related through dualization. We will make the same
observation when we deal with pullbacks and pushouts.
2.2.2
Pullbacks and Pushouts
Sometimes, one wants to complete the square, as in the diagram below
on the left-hand side:
Hence one wants to ﬁnd an object d together with morphisms i1 W d !
a and i2 W d ! b rendering the diagram on the right-hand side commu-
tative. This completion should be as coarse as possible in the following
sense. If we have another object, say, e with morphisms j1 W e ! a
and j2 W e ! b such that f ı j1 D g ı j2, then we want to be able to
uniquely factor through i1 and i2.
This is captured in the following deﬁnition.
Deﬁnition 2.2.18 Let f W a ! c and g W b ! c be morphisms in K
with the same codomain. An object d together with morphisms i1 W d !
a and i2 W d ! b is called a pullback of f and g iff:
1. f ı i1 D g ı i2,
2. If e is an object with morphisms j1 W e ! a and j2 W e ! b
such that f ı j1 D g ı j2, then there exists a unique morphism
h W e ! d such that j1 D i1 ı h and j2 D i2 ı h:
If we postulate the existence of the morphism h W e ! d, but do not
insist on its uniqueness, then d with i1 and i2 is called a weak pullback.

2.2. ELEMENTARY CONSTRUCTIONS
139
A diagram for a pullback looks like this:
It is clear that a pullback is unique up to isomorphism; this is shown in
exactly the same way as in Lemma 2.2.2. Let us have a look at Set as
an important example to get a ﬁrst impression on the inner workings of
a pullback.
Example 2.2.19 Let f W X ! Z and g W Y ! Z be maps. We claim
that
P WD fhx; yi 2 X  Y j f .x/ D g.y/g
together with the projections X W hx; yi 7! x, and Y W hx; yi 7! y is
a pullback for f and g.
Let hx; yi 2 P , then
.f ı X/.x; y/ D f .x/ D g.y/ D .g ı Y /.x; y/;
so that the ﬁrst condition is satisﬁed. Now assume that jX W T ! X
and jY W T ! Y satisfy f .jX.t// D g.jY .t// for all t 2 T . Thus
hjX.t/; jY .t/i 2 P for all t, and deﬁning r.t/ WD hjX.t/; jY .t/i; we
obtain jX D X ı r and jY D Y ı r. Moreover, this is the only
possibility to deﬁne a factor map with the desired property.
An interesting special case occurs for X D Y and f D g. Then P D
ker .f /, so that the kernel of a map occurs as a pullback in category Set.
✌
As an illustration for the use of a pullback construction, look at this
simple statement.
Lemma 2.2.20 Assume that d with morphisms ia W d ! a and ib W
d ! b is a pullback for f W a ! c and g W b ! c. If g is a mono, so is
ia.
Proof Let g1; g2 W e ! d be morphisms with ia ı g1 D ia ı g2. We
have to show that g1 D g2 holds. If we know that ib ı g1 D ib ı g2; we
may use the deﬁnition of a pullback and capitalize on the uniqueness of
the factorization. But let us see.

140
CHAPTER 2. CATEGORIES
From ia ı g1 D ib ı g2, we conclude f ı ia ı g1 D f ı ib ı g2, and
because f ı ia D g ı ib, we obtain g ı ib ı g1 D g ı ib ı g2. Since g
is a mono, we may cancel on the left of this equation, and we obtain, as
desired, ib ı g1 D ib ı g2:
But since we have a pullback, there exists a unique h W e ! d with
ia ıg1 D ia ıh

D ia ıg2

and ib ıg1 D ib ıh

D ib ıg2

. We see that
the morphisms g1, g2, and h have the same properties with respect to
factoring, so they must be identical by uniqueness. Hence g1 D h D g2,
and we are done. a
This is another simple example for the use of a pullback in Set.
Example 2.2.21 Let R be an equivalence relation on a set X with pro-
jections 1 W hx1; x2i 7! x1; the second projection 2 W R ! X is
deﬁned similarly. Then
(with R W x 7! ŒxR) is a pullback diagram. In fact, the diagram
commutes. Let ˛; ˇ W M ! X be maps with ˛ ı R D ˇ ı R; thus
Œ˛.m/R D Œˇ.m/R for all m 2 M; hence h˛.m/; ˇ.m/i 2 R for all
m. The only map # W M ! R with ˛ D 1 ı # and ˇ D 2 ı # is
#.m/ WD h˛.m/; ˇ.m/i. ✌
Pullbacks are compatible with products in a sense which we will make
precise in a moment. Before we do that, however, we need an auxiliary
statement:
Lemma 2.2.22 Assume that the products a  a0 and b  b0 exist in cat-
egory K. Given morphisms f W a ! b and f 0 W a0 ! b0, there exists a
unique morphism f  f 0 W a  a0 ! b  b0 such that
b ı f  f 0 D f ı a
b0 ı f  f 0 D f 0 ı a0

2.2. ELEMENTARY CONSTRUCTIONS
141
Proof Apply the deﬁnition of a product to the morphisms f ı a W
a  a0 ! b and f 0 ı a0 W a  a0 ! b0. a
The morphism f  f 0 constructed in the lemma renders both parts of
this diagram commutative.
Denoting this morphism as f f 0, we note that  is overloaded for mor-
phisms; a look at domains and codomains indicates without ambiguity,
however, which version is intended.
Quite apart from its general interest, this is what we need Lemma 2.2.22
for.
Lemma 2.2.23 Assume that we have these pullbacks:
Then this is a pullback diagram as well:
Proof 1. We show ﬁrst that the diagram commutes. It is sufﬁcient to
compute the projections. From uniqueness equality will follow. Al-
lora:
d ı .h  h0/ ı .f  f 0/ D .h ı a/ ı .f  f 0/ D h ı f ı a
d ı .k  k0/ ı .g  g0/ D k ı c ı .g  g0/ D k ı g ı a
D h ı f ı a:
A similar computation is carried out for a0.
2. Let j W t ! c  c0 and ` W t ! b  b0 be morphisms such that
.k  k0/ ı j D .h  h0/ ı `; then we claim that there exists a unique
morphism r W t ! aa0 such that j D .gg0/ır and ` D .f f 0/ır:

142
CHAPTER 2. CATEGORIES
The plan is to obtain r from the projections and then show that this
morphism is unique.
3. We show that this diagram commutes
We have
k ı .c ı j / D .k ı c/ ı j
D .d ı k  k0/ ı j
D d ı .k  k0 ı j /
.	/
D d ı .h  h0 ı `/
D .d ı h  h0/ ı ` D .h ı b/ ı `
D h ı .b ı `/
In ./,
we use Lemma 2.2.22.
Using the primed part
of
Lemma 2.2.22, we obtain k0 ı .c0 ı j / D h0 ı .b0 ı `/:
Because the left-hand side in the assumption is a pullback diagram, there
exists a unique morphism  W t ! a with c ıj D gı; b ı` D f ı:
Similarly, there exists a unique morphism 0 W t ! a0 with c0 ı j D
g0 ı 0; b0 ı ` D f 0 ı 0:
4. Put r WD 0, then r W t ! aa0, and we have this diagram:
Hence
c ı .g  g0/ ı .  0/ D g ı a ı .  0/ D g ı  D c ı j;
c0 ı .g  g0/ ı .  0/ D g0 ı a0 ı .  0/ D g0 ı 0 D c0 ı j:
Because a morphism into a product is uniquely determined by its pro-
jections, we conclude that .g  g0/ ı .  0/ D j . Similarly, we obtain
.f  f 0/ ı .  0/ D `.

2.2. ELEMENTARY CONSTRUCTIONS
143
5. Thus r D   0 can be used for factoring; it remains to be shown
that this is the only possible choice. In fact, let  W t ! a  a0 be a
morphism with .g g0/ı D j and .f f 0/ı D `; then it is enough
to show that a ı  has the same properties as  and that a0 ı  has the
same properties as 0. Calculating the composition with g resp. f , we
obtain
g ı a ı 
D c ı .g  g0/ ı 
D c ı j;
f ı a ı 
D d ı .f  f 0/ ı 
D b ı `:
This implies a ı D  by uniqueness of ; the same argument implies
a0 ı  D 0. But this means  D   0, and uniqueness is established.
a
Let us dualize. The pullback was deﬁned so that the upper left corner
of a diagram is ﬁlled in an essentially unique way; the dual construction
will have to ﬁll the lower right corner of a diagram in the same way.
But by reversing arrows, we convert a diagram in which the lower right
corner is missing into a diagram without an upper left corner:
The corresponding construction is called a pushout.
Deﬁnition 2.2.24 Let f W a ! b and g W a ! c be morphisms in
category K with the same domain. An object d together with morphisms
pb W b ! d and pc W c ! d is called the pushout of f and g iff these
conditions are satisﬁed:
1. pb ı f D pc ı g
2. if qb W b ! e and qc W c ! e are morphisms such that qb ı f D
qc ı g, then there exists a unique morphism h W d ! e such that
qb D h ı pb and qc D h ı qc.
This diagram obviously looks like this:

144
CHAPTER 2. CATEGORIES
It is clear that the pushout of f 2 homK.a; b/ and g 2 homK.a; c/
is the pullback of f 2 homKop.b; a/ and of g 2 homKop.c; a/ in the
dual category. This, however, does not really provide assistance when
constructing a pushout. Let us consider speciﬁcally the category Set of
sets with maps as morphisms. We know that dualizing a product yields
a sum, but it is not quite clear how to proceed further. The next example
tells us what to do.
Example 2.2.25 We are in the category Set of sets with maps as mor-
phisms now. Consider maps f W A ! B and g W A ! C. Construct
on the sum B C C the smallest equivalence relation R which contains
R0 WD fh.iB ı f /.a/; .iC ı g/.a/i j a 2 Ag: Here, iB and iC are
the injections of B resp. C into the sum. Let D be the factor space
.A C B/=R with pB W b 7! ŒiB.b/R and pC W c 7! ŒiC .C/R. The
construction yields pB ıf D pC ıg, because R identiﬁes the embedded
elements f .a/ and g.a/ for any a 2 A.
Now assume that qB W B ! E and qC W C ! E are maps with
qB ı f D qC ı g. Let q W D ! E be the unique map with q ı iB D qB
and q ı iC D qC (Lemma 2.2.8 together with Proposition 2.2.13). Then
R0  ker .q/: Let a 2 A, then
q.iB.f .a/// D qB.f .a// D qC .g.a// D q.iC .f .a//;
so that hiB.f .a//; iC.f .a//i 2 ker .q/. Because ker .q/ is an equiva-
lence relation on D, we conclude R  ker .q/. Thus h.ŒxR/ WD q.x/
deﬁnes a map D=R ! E with
h.pB.b//
D h.ŒiB.b/R/
D q.iB.b//
D qB.b/;
h.pC .c//
D h.ŒiC .c/R/
D q.iC .c//
D qC .c/
for b 2 B and c 2 C. It is clear that there is no other way to deﬁne a
map h with the desired properties. ✌
So we have shown that the pushout in the category Set of sets with maps
exists. To illustrate the construction, consider the pushout of two factor
maps. In this example,  _  denotes the smallest equivalence relation
which contains the equivalence relations  and .
Example 2.2.26 Let  and # be equivalence relations on a set X with
factor maps  W X ! X= and # W X ! X=#. Then the pushout
of these maps is X=. _ #/ with 	 W Œx 7! Œx_# and 	# W Œx# 7!
Œx_# as the associated maps. In fact, we have  ı	 D # ı	#, so the

2.3. FUNCTORS AND NATURAL TRANSFORMATIONS
145
ﬁrst property is satisﬁed. Now let t W X= ! E and t# W X=# ! E be
maps with tı D t# ı# for a set E, then h W Œx_# 7! t.Œx/ maps
X=. _ #/ to E with plainly t D hı	 and t# D hı	#; moreover, h is
uniquely determined by this property. Because the pushout is uniquely
determined up to isomorphism by Lemma 2.2.2 and Proposition 2.2.13,
we have shown that the supremum of two equivalence relations in the
lattice of equivalence relations can be computed through the pushout of
its components. ✌
2.3
Functors and Natural Transformations
We introduce functors which help in transporting information between
categories in a way similar to morphisms, which are thought to transport
information between objects. Of course, we will have to observe some
properties in order to capture the intuitive understanding of a functor
as a structure-preserving element in a formal way. Functors themselves
can be related, leading to the notion of a natural transformation. Given
a category, there is a plethora of functors and natural transformations
provided by the hom sets; this is studied in some detail, ﬁrst, because it
is a built-in for every category and second because the Yoneda lemma
relates this rich structure to set-based functors, which in turn will be
used when studying adjunctions.
2.3.1
Functors
Loosely speaking, a functor is a pair of structure-preserving maps be-
tween categories: it maps one category to another one in a compatible
way. A bit more precise, a functor F between categories K and L assigns
to each object a in category K an object F.a/ in L, and it assigns each
morphism f W a ! b in K a morphism F.f / W F.a/ ! F.b/ in L; some
obvious properties have to be observed. To be more speciﬁc:
Deﬁnition 2.3.1 A functor F W K ! L assigns to each object a in cate-
gory K an object F.a/ in category L and maps each hom set homK.a; b/

146
CHAPTER 2. CATEGORIES
of K to the hom set homL.F.a/; F.b// of L subject to these conditions:
 F.ida/ D idF.a/ for each object a of K,
 if f W a ! b and g W b ! c are morphisms in K, then F.gıf / D
F.g/ ı F.f /.
A functor F W K ! K is called an endofunctor on K.
The ﬁrst condition says that the identity morphisms in K are mapped
to the identity morphisms in L, and the second condition tells us that
F has to be compatible with composition in the respective categories.
Note that for specifying a functor, we have to say what the functor does
with objects and how the functor transforms morphisms. By the way,
we often write F.a/ as Fa and F.f / as Ff .
Let us have a look at some examples. Trivial examples for functors
include the identity functor IdK, which maps objects resp. morphisms
to itself, and the constant functor x for an object x, which maps every
object to x and every morphism to idx.
Example 2.3.2 Consider the category Set of sets with maps as mor-
phisms. Given set X, PX is a set again; deﬁne P.f /.A/ WD f

A

for
the map f W X ! Y and for A  X, then Pf W PX ! PY . We check
the laws for a functor:
 P.idX/.A/ D idX

A

D A D idPX.A/, so that PidX D
idPX.
 let f W X ! Y and g W Y ! Z, then Pf W PX ! PY and
Pg W PY ! PZ with
.P.g/ ı P.f //.A/
D P.g/.P.f /.A//
D g

f

A

D fg.f .a// j a 2 Ag
D .g ı f /

A

D P.g ı f /.A/
for A  X. Thus the power set functor P is compatible with
composition of maps.
✌
Example 2.3.3 Given a category K and an object a of K, associate
aC W x 7! homK.a; x/
aC W x 7! homK.x; a/

2.3. FUNCTORS AND NATURAL TRANSFORMATIONS
147
with a together with the maps on hom sets homK.a; / resp. homK.; a/. hom functors
Then aC is a functor K ! Set.
In fact, given morphism f W x ! y, we have aCf W homK.a; x/ !
homK.a; y/, taking g into f ı g. Plainly, aC.idx/ D idhomK.a;x/ D
idaC.x/, and
aC.g ı f /.h/ D .g ı f / ı h D g ı .f ı h/ D aC.g/.aC.f /.h//;
if f W x ! y; g W y ! ´ and h W a ! x. ✌
Functors come in handy when we want to forget part of the structure.
Example 2.3.4 Let Meas be the category of measurable spaces. Assign
to each measurable space .X; C/ its carrier set X and to each morphism
f W .X; C/ ! .Y; D/ the corresponding map f W X ! Y . It is imme-
diately checked that this constitutes a functor Meas ! Set. Similarly,
we might forget the topological structure by assigning each topological
space its carrier set, and assign each continuous map to itself. These
functors are sometimes called forgetful functors. ✌
The following example twists Example 2.3.4 a little bit.
Example 2.3.5 Assign to each measurable space .X; C/ its -algebra
B.X; C/ WD C. Let f W .X; C/ ! .Y; D/ be a morphism in Meas; put
B.f / WD f 1, then B.f / W B.Y; D/ ! B.X; C/; because f is C-D-
measurable. We plainly have B.idX;C/ D idB.X;C/ and B.g ı f / D
.g ı f /1 D f 1 ı g1 D B.f / ı B.g/; so B W Meas ! Set is no
functor, although it behaves like one. DO NOT PANIC! If we reverse
arrows, things work out properly: B W Meas ! Setop is, as we have just
shown, a functor (the dual Kop of a category K has been introduced in
Example 2.1.17).
This functor could be called the Borel functor (the measurable sets are
sometimes called the Borel sets). ✌
Deﬁnition 2.3.6 A functor F W K ! Lop is called a contravariant func-
tor between K and L; in contrast, a functor according to Deﬁnition 2.3.1
is called covariant.
If we talk about functors, we always mean the covariant ﬂavor; con-
travariance is mentioned explicitly.
Let us complete the discussion from Example 2.3.3 by considering aC,
which takes f W x ! y to aCf W homK.y; a/ ! homK.x; a/ through

148
CHAPTER 2. CATEGORIES
g 7! g ı f . aC maps the identity on x to the identity on homK.x; a/. If
g W y ! ´, we have
aC.f /.aC.g/.h// D aC.f /.h ı g/ D h ı g ı f D aC.g ı f /.h/
for h W ´ ! a. Thus aC is a contravariant functor K ! Set, while its
cousin aC is a covariant.
Functors may also be used to model structures.
Example 2.3.7 Consider this functor S W Set ! Set which assigns each
set X the set XN of all sequences over X; the map f W X ! Y is as-
signed the map S W .xn/n2N 7!

f .xn/

n2N. Evidently, idX is mapped
to idXN, and it is easily checked that S.g ı f / D S.g/ ı S.f /. Hence S
constitutes an endofunctor on Set. ✌
Example 2.3.8 Similarly, deﬁne the endofunctor F on Set by assigning
X to XN [ X with X as the set of all ﬁnite sequences over X. Then
FX has all ﬁnite or inﬁnite sequences over the set X. Let f W X ! Y
be a map, and let .xi/i2I 2 FX be a ﬁnite or inﬁnite sequence; then
put .Ff /.xi/i2I WD

f .xi/

i2I2 FY . It is not difﬁcult to see that F
satisﬁes the laws for a functor. ✌
The next example deals with automata which produce an output (in
contrast to Example 2.1.15 where we mainly had state transitions in
view).
Example 2.3.9 An automaton with output .A; B; X; ı/ has an input al-
phabet A, an output alphabet B, and a set X of states with a map
ı W X  A ! X  B; ı.x; a/ D hx0; bi yields the next state x0 and the
output b, if the input is a in state x. A morphism f W .X; A; B; ı/ !
.Y; A; B; #/ of automata is a map f W X ! Y such that #.f .x/; a/ D
.f  idB/.ı.x; a// for all x 2 X; a 2 A; thus .f  idB/ ı ı D
# ı .f  idA/. This yields apparently a category AutO, the category
of automata with output.
We want to expose the state space X in order to make it a parameter to an
automata, because input and output alphabets are given from the outside;
so for modeling purposes, only states are at our disposal. Hence we
reformulate ı and take it as a map ı W X ! .XB/A with ı.x/.a/ WD
ı.x; a/. Now f W .X; A; B; ı/ ! .Y; A; B; #/ is a morphism iff this

2.3. FUNCTORS AND NATURAL TRANSFORMATIONS
149
diagram commutes:
with f .t/.a/ WD .f  idB/.t.a//: Let us see why this is the case.
Given x 2 X; a 2 A, we have
f .ı.x//.a/ D .f  idB/.ı.x/.a// D .f  idB/.ı.x; a//
D #.f .x/; a/ D #.f .x//.a/I
thus f .ı.x// D #.f .x// for all x 2 X; hence f  ı ı D # ı f ,
so the diagram is commutative indeed. Deﬁne F.X/ WD .X  A/B;
for an object .A; B; X; ı/ in category AutO, and put F.f / WD f  for
the automaton morphism f W .X; A; B; ı/ ! .Y; A; B; #/; thus F.f /
renders this diagram commutative:
We claim that F W AutO ! Set is a functor. Let g W .Y; A; B; #/ !
.Z; A; B; 	/ be a morphism; then F.g/ makes this diagram commutative
for all s 2 .Y  B/A:
In particular, we have for s WD F.f /.t/ with an arbitrary t 2 .X  B/A
this commutative diagram:
Thus the outer diagram commutes

150
CHAPTER 2. CATEGORIES
Consequently, we have
F.g/.F.f /.t// D .g  idB/ ı .f  idB/ ı t
D

.g ı f /  idB

ı t
D F.g ı f /.t/:
Now F.idX/ D id.X	B/A is trivial, so that we have established that
F W AutO ! Set is indeed a functor, assigning states to possible state
transitions. ✌
The next example shows that we may perceive labeled transition systems
as functors based on the power set functor.
Example 2.3.10 A labeled transition system is a collection of transi-
tions indexed by a set of actions. Formally, given a set A of actions,

S; . a/a2A

is a labeled transition system iff  a  S  S for all
a 2 A. Thus state s may go into state s0 after action a 2 A; this is writ-
ten as s  a s0. A morphism f W

S; . S;a/a2A

!

T; . T;a/a2A

of transition systems is a map f W S ! T such that s  S;a s0 implies
f .s/  T;a f .s0/ for all actions a, cp. Example 2.1.9.
We model a transition system

S; . a/a2A

as a map F
W S !
P .A  S/ by deﬁning F.s/ WD fha; s0i j s  a s0g; thus F.s/  A  S
collects actions and new states; conversely, we may recover  a from
F :  aD fhs; s0i j ha; s0i 2 F.s/g. This suggests deﬁning F.S/ WD
P .A  S/ which can be made a functor once we have decided what to
do with morphisms
f W

S; . S;a/a2A

!

T; . T;a/a2A

:
Take V  A  S and deﬁne F.f /.V / WD fha; f .s/i j ha; si 2 V g
(clearly we want to leave the actions alone). Then we have
F.g ı f /.V / D fha; g.f .s//i j ha; si 2 V g
D fha; g.y/i j ha; yi 2 F.f /.V /g
D F.g/.F.f /.V //
for a morphism g W

T; . T;a/a2A

!

U; . U;a/a2A

. Thus we
have shown that F.g ı f / D F.g/ ı F.f / holds. Because F maps
the identity to the identity, F is a functor from the category of labeled
transition systems to Set. ✌
The next examples deal with functors induced by probabilities.

2.3. FUNCTORS AND NATURAL TRANSFORMATIONS
151
Example 2.3.11 Given a set X, deﬁne the support supp.p/ for a map
p W X ! Œ0; 1 as supp.p/ WD fx 2 X j p.x/ 6D 0g. A discrete Support supp
probability p on X is a map p W X ! Œ0; 1 with ﬁnite support such that
X
x2X
p.x/ WD
X
x2supp.p/
p.x/ D 1:
Denote by
D.X/ WD fp W X ! Œ0; 1 j p is a discrete probabilityg
the set of all discrete probabilities. Let f W X ! Y be a map, and deﬁne
D.f /.p/.y/ WD
X
fx2Xjf .x/Dyg
p.x/:
Because D.f /.p/.y/ > 0 iff y 2 f

supp.p/

, D.f /.p/ W Y ! Œ0; 1
has ﬁnite support, and
X
y2Y
D.f /.p/.y/ D
X
y2Y
X
fx2Xjf .x/Dyg
p.x/ D
X
x2X
p.x/ D 1:
It is clear that D.idX/.p/ D p, so we have to check whether D.gıf / D
D.g/ ı D.f / holds.
We use a little trick for this, which will turn out to be helpful later as
well. Deﬁne
p.A/ WD
X
x2A\supp.p/
p.x/
for p 2 D.X/ and A  X; then p is a probability measure on PX. A di-
rect calculation shows that D.f /.p/.y/ D p.f 1
fyg

/ and D.f /.B/
D p.f 1
B

/ for B  Y hold. Thus we obtain for the maps f W X !
Y and g W Y ! Z
D.g ı f /.p/.´/
D p

.g ı f /1
f´g

D p

f 1
g1
f´g

D D.f /.p/.g1
f´g

/
D D.f /.D.g/.p//.´/:
Thus D.g ı f / D D.g/ ı D.f /, as claimed.
Hence D is an endofunctor on Set, the discrete probability functor. It is
Discrete
probability
functor D
immediate that all the arguments above hold also for probabilities, the
support of which is countable; but since we will discuss an interesting
example on page 192 which deals with the ﬁnite case, we stick to that
here. ✌

152
CHAPTER 2. CATEGORIES
There is a continuous version of this functor as well. We generalize
things a bit and formulate the example for subprobabilities.
Example 2.3.12 We are now working in the category Meas of measur-
able spaces with measurable maps as morphisms. Given a measurable
space .X; A/, the set S.X; A/ of all subprobability measures is a mea-
surable space with the weak -algebra }}}.A/ associated with A; see Ex-
ample 2.1.14. Hence S maps measurable spaces to measurable spaces.
Deﬁne for a morphism f W .X; A/ ! .Y; B/
S.f /./.B/ WD .f 1
B

/
for B 2 B. Then S.f / W S.X; A/ ! S.Y; B/ is }}}.A/-}}}.B/-measurable
by Exercise 2.8. Now let g W .Y; B/ ! .Z; C/ be a morphism in Meas;
then we show as in Example 2.3.11 that
S.g ı f /./.C/ D 

f 1
g1
C

D S.f /

S.g/./

.C/;
for C 2 C; thus S.g ı f / D S.g/ ı S.f /: Since S preserves the identity,
S W Meas ! Meas is an endofunctor, the (continuous space) subproba-
Subprobability
functor S
bility functor. ✌
The next two examples deal with upper closed sets, the ﬁrst one with
these sets proper and the second one with a more reﬁned version, viz.,
with ultraﬁlters. Upper closed sets are used, e.g., for the interpreta-
tion of game logic, a variant of modal logics; see Example 2.7.22 and
Sect. 4.1.3.
Example 2.3.13 Call a subset V  PS upper closed iff A 2 V and
A  B together imply B 2 V ; for example, each ﬁlter is upper closed.
Denote by
VS WD fV  PS j V is upper closedg
the set of all upper closed subsets of PS. Given f W S ! T , deﬁne
V, Upper
closed sets
.Vf /.V / WD fW  PT j f 1
W

2 V g
for V 2 VS. Let W 2 V.V / and W0 	 W , then f 1
W

 f 1
W0

,
so that f 1
W0

2 V ; hence Vf W VS ! VW . It is easy to see
that V.g ı f / D V.g/ ı V.f /, provided f W S ! T and g W T !
V . Moreover, V.idS/ D idV.S/. Hence V is an endofunctor on the
category Set of sets with maps as morphisms. ✌

2.3. FUNCTORS AND NATURAL TRANSFORMATIONS
153
Ultraﬁlters are upper closed, but are much more complex than plain
upper closed sets, since they are ﬁlters and they are maximal. Thus
we have to look a bit closer at the properties which the functor is to
represent.
Example 2.3.14 Let
US WD fq j q is an ultraﬁlter over Sg
assign to each set S its ultraﬁlters, to be more precise, all ultraﬁlters
U,
Ultraﬁlters
of the power set of S. This is the object part of an endofunctor over
the category Set with maps as morphisms. Given a map f W S ! T ,
we have to deﬁne Uf W US ! UT . Before doing so, a preliminary
consideration will help.
One ﬁrst notes that, given two Boolean algebras B and B0 and a Boolean
algebra morphism  W B ! B0, 1 maps ultraﬁlters over B0 to ultra-
ﬁlters over B. In fact, let w be an ultraﬁlter over B0; put v WD 1
w

;
we go quickly over the properties of an ultraﬁlter should have. First, v
does not contain the bottom element ?B of B, for otherwise, ?B0 D
.?B/ 2 w. If a 2 v and b  a, then .b/  .a/ 2 w; hence
.b/ 2 w; thus b 2 v; plainly, v is closed under ^. Now assume a 62 v,
then .a/ 62 w; hence .a/ D .a/ 2 w, since w is an ultraﬁlter.
Consequently, a 2 v. This establishes the claim.
Given a map f W S ! T , deﬁne Ff W PT ! PS through Ff WD f 1.
This is a homomorphism of the Boolean algebras PT and PS; thus F 1
f
maps US to UT . Put U.f / WD F 1
f ; note that we reverse the arrows’
directions twice. It is clear that U.idS/ D idU.S/, and if g W T ! Z,
then
U.g ı f / D F 1
gıf D .Ff ı Fg/1 D F 1
g
ı F 1
f
D U.g/ ı U.f /:
This shows that U is an endofunctor on the category Set of sets with
maps as morphisms (U is sometimes denoted by ˇ). ✌
We can use functors for constructing new categories from given ones.
As an example, we deﬁne the comma category associated with two func-
tors.
Deﬁnition 2.3.15 Let F W K ! L and G W M ! L be functors.
The comma category .F; G/ associated with F and G has as objects
the triplets ha; f; bi with objects a from K, b from M, and morphisms

154
CHAPTER 2. CATEGORIES
f W Fa ! Gb. A morphism .';  / W ha; f; bi ! ha0; f 0; b0i is a pair
of morphisms ' W a ! a0 of K and  W b ! b0 of M such that this
diagram commutes:
Composition of morphism is component wise.
The slice category K=x deﬁned in Example 2.1.16 is apparently the
comma category .IdK; x/.
Functors can be composed, yielding a new functor. The proof for this
statement is straightforward.
Proposition 2.3.16 Let F W C ! D and G W D ! E be functors. Deﬁne
.G ı F/a WD G.Fa/ for an object a of C and .G ı F/f WD G.Ff / for a
morphism f W a ! b in C; then G ı F W C ! E is a functor. a
2.3.2
Natural Transformations
We see that we can compose functors in an obvious way. This raises the
question whether or not functors themselves form a category. But we do
not yet have morphisms between functors at out disposal. Natural trans-
formations will assume this rˆole. Nevertheless, the question remains,
but it will not be answered in the positive; this is so because morphisms
between objects should form a set, and it will be clear that this is not the
case. Pumpl¨un [Pum99] points at some difﬁculties that might arise and
arrives at the pragmatic view that for practical problems this question is
not particularly relevant.
But let us introduce natural transformations between functors F; G now.
The basic idea is that for each object a, Fa is transformed into Ga in
a way which is compatible with the structure of the participating cate-
gories.
Deﬁnition 2.3.17 Let F; G W K ! L be covariant functors. A family
 D .a/a2jKj is called a natural transformation  W F ! G iff a W
Fa ! Ga is a morphism in L for all objects a in K such that this
a W Fa !
Ga

2.3. FUNCTORS AND NATURAL TRANSFORMATIONS
155
diagram commutes for any morphism f W a ! b in K:
Thus a natural transformation  W F ! G is a family of morphisms,
indexed by the objects of the common domain of F and G; a is called
the component of  at a.
If F and G are both contravariant functors K ! L, we may perceive
them as covariant functors K ! Lop, so that we get for the contravariant
case this diagram:
Let us have a look at some examples.
Example 2.3.18 aC W x 7! homK.a; x/ yields a (covariant) functor
K ! Set for each object a in K; see Example 2.3.3 (just for simplifying
notation, we use again aC rather than homK.a; /; see page 126). Let
	 W b ! a be a morphism in K; then this induces a natural transforma-
tion  W aC ! bC with
;x W
(
aC.x/
! bC.x/
g
7! g ı 	
In fact, look at this diagram with a K-morphism f W x ! y:
Then we have for h 2 aC.x/ D homK.a; x/
.;y ı aC.f //.h/
D ;y.f ı h/
D .f ı h/ ı 	
D f ı .h ı 	/
D bC.f /.;x.h//
D .bC.f / ı ;x/.h/
Hence  is in fact a natural transformation. ✌

156
CHAPTER 2. CATEGORIES
This is an example in the category of groups:
Example 2.3.19 Let K be the category of groups (see Example 2.1.7).
It is not difﬁcult to see that K has products. Deﬁne for a group H the
map FH.G/ WD H  G on objects, and if f W G ! G0 is a morphism
in K, deﬁne FH.f / W H  G ! H  G0 through FH.f / W hh; gi 7!
hh; f .g/i. Then FH is an endofunctor on K. Now let ' W H ! K be a
morphism. Then ' induces a natural transformation ' upon setting
';G W
(
FH
! FK
hh; gi
7! h'.h/; gi:
In fact, let  W L ! L0 be a group homomorphism, then this diagram
commutes:
To see this, take hh; `i 2 FH L D H  L, and chase it through the
diagram:
.';L0 ı FH  /.h; `/ D h'.h/; '.`/i D .FK. / ı ';L/.h; `/:
✌
Consider as another example a comma category .F; G/ (Deﬁ-
nition 2.3.15). There are functors akin to a projection which permit to
recover the original functors and which are connected through a natural
transformation. To be speciﬁc:
Proposition 2.3.20 Let F W K ! L and G W M ! L be functors. Then
there are functors S W .F; G/ ! K and R W .F; G/ ! L rendering this
diagram commutative:
There exists a natural transformation  W F ı S ! G ı R.
Proof Put for the object ha; f; bi of .F; G/ and the morphism .';  /
Sha; f; bi
WD a;
S.';  / WD ';
Rha; f; bi
WD b;
R.';  / WD  :

2.3. FUNCTORS AND NATURAL TRANSFORMATIONS
157
Then it is clear that the desired equality holds. Moreover, ha;f;bi WD f
is the desired natural transformation. The crucial diagram commutes by
the deﬁnition of morphisms in the comma category. a
Example 2.3.21 Assume that the product a  b for the objects a and b
in category K exists; then Proposition 2.2.9 tells us that we have for each
object d a bijection pd W homK.d; a/  homK.d; b/ ! homK.d; a  b/.
Thus .a ıpd/.f; g/ D f and .b ıpd/.f; g/ D g for every morphism
f W d ! a and g W d ! b. Actually, pd is the component of a
natural transformation p W F ! G with F WD homK.; a/homK.; b/
and G WD homK.; a  b/ (note that this is shorthand for the obvious
assignments to objects and functors). Both F and G are contravariant
functors from K to Set. So in order to establish naturalness, we have to
establish that the following diagram commutes:
Now take hg; hi 2 homK.d; a/  homK.d; b/; then
a

.pc ı F f /.g; h/

D g ı f D a

.G f / ı pd

.g; h/;
b

.pc ı F f /.g; h/

D h ı f D b

.G f / ı pd

.g; h/:
From this, commutativity follows. ✌
We will—for the sake of illustration—deﬁne two ways of composing
natural transformations. One is somewhat canonical, since it is based
on the composition of morphisms; the other one is a bit tricky, since
it involves the functors directly. Let us have a look at the direct one
ﬁrst.
Lemma 2.3.22 Let  W F ! G and 	 W G ! H be natural transforma-
tions. Then
.# ı 	/a WD #a ı 	a
deﬁnes a natural transformation # ı 	 W F ! H.
# ı 	

158
CHAPTER 2. CATEGORIES
Proof Let K be the domain of functor F, and assume that f W a ! b is
a morphism in K. Then we have this diagram:
Then
H.f / ı .# ı 	/a D H.f / ı #a ı 	a D #b ı G.f / ı 	a
D #b ı 	b ı F.f / D .# ı 	/b ı F.f /:
Hence the outer diagram commutes. a
The next composition is slightly more involved.
Proposition 2.3.23 Given natural transformations  W F ! G and # W
S ! R for functors F; G W K ! L and S; R W L ! M. Then #Ga ı
S.a/ D R.a/ ı #Fa always holds. Put
.#  /a WD #Ga ı S.a/:
Then #   deﬁnes a natural transformation S ı F ! R ı G. #   is
#  
called the Godement product of  and #.
Proof 1. Because a W Fa ! Ga, this diagram commutes by naturality
of #:
This establishes the ﬁrst claim.
2. Now let f W a ! b be a morphism in K, then the outer diagram com-
mutes, since S is a functor and since # is a natural transformation.
Hence #   W S ı F ! R ı G is natural indeed. a

2.3. FUNCTORS AND NATURAL TRANSFORMATIONS
159
In [ML97],  ı # is called the vertical and   # the horizontal compo-
sition of the natural transformations  and #. If  W F ! G is a natural
transformation, then the morphisms .F/.a/ WD Fa W .F ı F/.a/ !
.F ı G/.a/ and .F/.a/ WD Fa W .F ı F/.a/ ! .G ı F/.a/ are avail-
able.
We know from Example 2.3.3 that homK.a; / deﬁnes a covariant set-
valued functor; suppose we have another set- valued functor F W K !
Set. Can we somehow compare these functors? This question looks on
ﬁrst sight quite strange, because we do not have any yardstick to com-
pare these functors against. On second thought, we might use natural
transformations for such an endeavor. It turns out that for any object
a of K, the set Fa is essentially given by the natural transformations
 W homK.a; / ! F. We will show now that there exists a bijective
assignment between Fa and these natural transformations. The reader
might wonder about this somewhat intricate formulation; it is due to the
observation that these natural transformations in general do not form a
set but rather a class, so that we cannot set up a proper bijection (which
would require sets as the basic scenario).
Lemma 2.3.24 Let F W K ! Set be a functor; given the object a of K
and a natural transformation  W homK.a; / ! F , deﬁne the Yoneda
isomorphism
ya;F./ WD .a/.ida/ 2 F a
Then ya;F is bijective (i.e., onto and one to one).
Proof 0. The assertion is established by deﬁning for each t 2 Fa a natu-
ral transformation a;F.t/ W homK.a; / ! F which is inverse to ya;F.
This is also the outline for the proof: we deﬁne a map, establish that it
Outline for
the proof
is a natural transformation, and show that it is inverse to ya;F.
1. Given an object b of K and t 2 F a, put

a;F.t/

b WD a;F.t/.b/ W
(
homK.a; b/
! F b
f
7! .F f /.t/

160
CHAPTER 2. CATEGORIES
(note that F f W F a ! F b for f W a ! b; hence .F f /.t/ 2 F b).
This deﬁnes a natural transformation a;F.t/ W homK.a; / ! F. In
fact, if f W b ! b0, then
a;F.t/.b0/.homK.a; f /g/ D a;F.t/.b0/.f ı g/ D F.f ı g/.t/
D .F f /.F.g/.t// D .F f /.a;F.t/.b/.g//:
Hence a;F.t/.b0/ ı homK.a; f / D .F f / ı a;F.t/.b/.
2. We obtain
.ya;F ı a;F/.t/ D ya;F.a;F.t// D a;F.t/.a/.ida/
D .F ida/.t/ D idFa.t/ D t
That is not too bad; so let us try to establish that a;F ı ya;F is the
identity as well. Given a natural transformation  W homK.a; / ! F ,
we obtain
.a;F ı ya;F/./ D a;F.ya;F.// D a;F.a.ida//:
Thus we have to evaluate a;F.a.ida//. Take an object b and a mor-
phism f W a ! b; then
a;F.a.ida/.b/.f // D .Ff /.a.ida//
D .F.f / ı a/.ida/
D .b ı homK.a; f //
( is natural)
.ida/
D b.f /
(since homK.a; f /
ıida D f ı ida D f )
Thus a;F.a.ida// D . Consequently we have shown that ya;F is left
and right invertible, hence is a bijection. a
Now consider the set-valued functor homK.b; /; then the Yoneda em-
bedding says that homK.b; a/ can be mapped bijectively to the natu-
ral transformations from homK.a; / to homK.b; /. This means that
these natural transformations are essentially the morphisms b ! a,
and, conversely, each morphism b ! a yields a natural transforma-
tion homK.a; / ! homK.b; /. The following statement makes this
observation precise.

2.3. FUNCTORS AND NATURAL TRANSFORMATIONS
161
Proposition 2.3.25 Given a natural transformation  W homK.a; / !
homK.b; /, there exists a unique morphism g W b ! a such that
c.h/ D h ı g for every object c and every morphism h W a ! c
(thus  D homK.g; /).
Proof 0. Let y WD ya;homK.a;/ and  WD a;homK.a;/. Then y is a
bijection with .y ı /./ D  and . ı y/.h/ D h.
1. Put g WD a.ida/; then g 2 homK.b; a/, since a W homK.a; a/
! homK.b; a/ and ida 2 homK.a; a/.
Now let h 2 homK.a; c/,
then
c.h/ D 

a.ida/

.c/.h/
(since  D y ı )
D .g/.c/.h/
(Deﬁnition of )
D homK.b; g/.h/
(homK.b; / is the target functor)
D h ı g
2. If  D homK.g; /, then a.ida/ D homK.g; ida/ D ida ı g D g,
so g W b ! a is uniquely determined. a
A ﬁnal example for natural transformations comes from measurable
spaces, dealing with the weak -algebra. We consider in Example 2.3.5
the contravariant functor which assigns to each measurable space its -
algebra, and we have deﬁned in Example 2.1.14 the weak -algebra on
its set of probability measures together with a set of generators. We
show that this set of generators yields a family of natural transforma-
tions between the two contravariant functors involved.
Example 2.3.26 The contravariant functor B W Meas ! Set assigns to
each measurable space its -algebra and to each measurable map its in-
verse. Denote by W WD PıB the functor that assigns to each measurable
space the weak -algebra on its probability measures; W W Meas ! Set
is contravariant as well. Recall from Example 2.1.14 that the set
ˇˇˇA.A; r/ WD f 2 P .S; A/ j .A/  rg
denotes the set of all probability measures which evaluate the measur-
able set A not smaller than a given r and that the weak -algebra on
P .S; A/ is generated by all these sets. We claim that ˇ.; r/ is a nat-

162
CHAPTER 2. CATEGORIES
ural transformation B ! W. Thus we have to show that this diagram
commutes
Recall that we have B.f /.C/ D f 1
C

for C 2 B and that W.f /.D/
D P .f /1
D

, if D  P .T; B/ is measurable. Now, given C 2 B, by
expanding deﬁnitions we obtain
 2 W.f /.ˇˇˇB.C; r//
,
 2 P .f /1
ˇˇˇB.C; r/

,
P .f / ./ 2 ˇˇˇB.C; r/
,
P .f / ./.C/  r
,
.f 1
C

/  r
,
 2 ˇˇˇA.B.f /.C/; r/
Thus the diagram commutes in fact, and we have established that the
generators for the weak -algebra come from a natural transformation.
✌
2.3.3
Limits and Colimits
We deﬁne above some constructions which permit to build new objects
in a category from given ones, e.g., the product from two objects or the
pushout. Each time we had some universal condition which had to be
satisﬁed.
We will discuss these general constructions very brieﬂy and refer the
reader to [ML97, BW99, Pum99], where they are studied in great de-
tail.
Deﬁnition 2.3.27 Given a functor F W K ! L, a cone on F consists
of an object c in L and of a family of morphisms pd W c ! Fd in L
for each object d in K such that pd 0 D .Fg/ ı pd for each morphism
g W d ! d 0 in K.

2.3. FUNCTORS AND NATURAL TRANSFORMATIONS
163
So a cone .c; .pd/d2jKj/ on F looks like, well, a cone:
A limiting cone provides a factorization for each other cone, to be spe-
ciﬁc:
Deﬁnition 2.3.28 Let F W K ! L be a functor. The cone .c; .pd/d2jKj/
is a limit of F iff for every cone .e; .qd/d2jKj/ on F there exists a unique
morphism f W e ! c such that qd D pd ı f for each object d in K.
Thus we have locally this situation for each morphism g W d ! d 0 in
K:
The unique factorization probably gives already a clue for the applica-
tion of this concept. Let us interpret two known examples in the light of
this concept.
Example 2.3.29 Let X WD f1; 2g and K be the discrete category on
X (see Example 2.1.6). Put F1 WD a and F2 WD b for the objects
a; b 2 jLj. Assume that the product a  b with projections a and b
exists in L, and put p1 WD a, p2 WD b. Then .a  b; p1; p2/ is a limit
of F. Clearly, this is a cone on F, and if q1 W e ! a and q2 W e ! b
are morphisms, there exists a unique morphism f W e ! a  b with
q1 D p1 ı f and q2 D p2 ı f by the deﬁnition of a product. ✌
The next example shows that a pullback can be interpreted as a limit.
Example 2.3.30 Let a; b; c objects in category L with morphisms f W
a ! c and g W b ! c. Deﬁne category K by jKj WD fa; b; cg; the hom

164
CHAPTER 2. CATEGORIES
sets are deﬁned as follows:
homK.x; y/ WD
8
ˆˆˆˆ<
ˆˆˆˆ:
fidxg;
x D y
ff g;
x D a; y D c
fgg;
x D b; y D c
;;
otherwise
Let F be the identity on jKj with Ff WD f; Fg WD g, and Fidx WD idx
for x 2 jKj. If object p together with morphisms ta W p ! a and tb W
p ! b is a pullback for f and g, then it is immediate that .p; ta; tb; tc/
is a limit cone for F, where tc WD f ı ta D g ı tb. ✌
Dualizing the concept of a cone, we obtain cocones.
Deﬁnition 2.3.31 Given a functor F W K ! L, an object c 2 jLj to-
gether with morphisms sd W FD ! c for each object d of K such that
sd D sd 0 ı Fg for each morphism g W d ! d 0 is called a cocone on F.
Thus we have this situation
A colimit is then deﬁned for a cocone.
Deﬁnition 2.3.32 A cocone .c; .sd/d2jKj/ is called a colimit for the
functor F W K ! L iff for every cocone .e; .td/d2jKj/ for F there ex-
ists a unique morphism f W c ! e such that td D f ı sd for every
object d 2 jKj.
So this yields
Coproducts are examples of cocones.

2.4. MONADS AND KLEISLI TRIPELS
165
Example 2.3.33 Let a and b be objects in category L and assume that
their coproduct a C b with injections ja and jb exists in L. Take again
I WD f1; 2g, and let K be the discrete category over I. Put F1 WD a and
F2 WD b; then it follows from the deﬁnition of the coproduct that the
cocone .a C b; ja; jb/ is a colimit for F. ✌
One shows that the pushout can be represented as a colimit in the same
way as in Example 2.3.30 for the representation of the pullback as a
limit.
Both limits and colimits are powerful general concepts for representing
important constructions with and on categories. We will encounter them
later on, albeit mostly indirectly.
2.4
Monads and Kleisli Tripels
We have now functors and natural transformations at our disposal, and
we will put them to work. The ﬁrst application we will tackle concerns
monads. Moggi’s work [Mog91, Mog89] shows a connection between
monads and computation which we will discuss now. Kleisli tripels as a
practical disguise for monads are introduced ﬁrst, and it will be shown
through Manes’ Theorem that they are equivalent in the sense that each
Kleisli tripel generates a monad, and vice versa, in a reversible con-
struction. Some examples for monads follow, and we will ﬁnally have
a brief look at the monadic construction in the programming language
Haskell.
2.4.1
Kleisli Tripels
Assume that we work in a category K and interpret values and computa-
tions of a programming language in K. We need to distinguish between
the values of type a and the computations of type a, which are of type
Ta. For example:
Values vs.
computa-
tions
Nondeterministic computations Taking the values from set A yields
computations of type TA D Pf .A/, where the latter denotes all
ﬁnite subsets of A.

166
CHAPTER 2. CATEGORIES
Probabilistic computations Taking values from set A will give compu-
tations in the set TA D DA of all discrete probabilities on A; see
Example 2.3.11.
Exceptions Here, values of type A will result in values taken from
TA D A C E with E as the set of exceptions.
Side effects Let L be the set of addresses in the store and U the set of
all storage cells; a computation of type A will assign each element
of U L an element of A or another element of U L; thus we have
TA D .A C U L/U L.
Interactive input Let U be the set of characters; then TA is the set of
all trees with ﬁnite fan out, so that the internal nodes have labels
coming from U and the leaves have labels taken from A.
In order to model this, we require an embedding of the values taken
from a into the computations of type Ta, which is represented as a mor-
phism a W a ! Ta. Moreover, we want to be able to “lift” values
to computations in this sense: if f W a ! Tb is a map from values
to computations, we want to extend f to a map f  W Ta ! Tb from
computations to computations (thus we will be able to combine compu-
tations in a modular fashion). Understanding a morphism a ! Tb as
a program performing computations of type b on values of type a, this
lifting will then permit performing computations of type b depending
on computations of type a.
This leads to the deﬁnition of a Kleisli tripel.
Deﬁnition 2.4.1 Let K be a category. A Kleisli tripel .T; ; / over K
consists of a map T W jKj ! jKj on objects, a morphism a W a ! Ta
Kleisli tripel
for each object a, and an operation  such that f  W Ta ! Tb, if
f W a ! Tb with the following properties:
➀
a D idTa.
➁f  ı a D f , provided f W a ! Tb.
➂g ı f  D .g ı f / for f W a ! Tb and g W b ! Tc.
The ﬁrst property says that lifting the embedding a W a ! Ta will give
the identity on Ta. The second condition says that applying the lifted
morphism f  to an embedded value a will yield the same value as the
given f . The third condition says that combining lifted morphisms is

2.4. MONADS AND KLEISLI TRIPELS
167
the same as lifting the lifted second morphism applied to the value of
the ﬁrst morphism.
The category associated with a Kleisli tripel has the same objects as
the originally given category (which is not too much of a surprise), but
morphisms will correspond to programs: a program which performs a
computation of type b on values of type a. Hence a morphism in this
new category is of type a ! Tb (this is a morphism on K).
Deﬁnition 2.4.2 Given a Kleisli tripel .T; ; / over category K, the
Kleisli category KT is deﬁned as follows:
KT
 jKTj D jKj; thus KT has the same objects as K.
 homKT.a; b/ D homK.a; Tb/; hence f is a morphism a ! b in
KT iff f W a ! Tb is a morphism in K.
 The identity for a in KT is a W a ! Ta.
 The composition g  f of f 2 homKT.a; b/ and g 2 homKT.b; c/
is deﬁned through g  f WD g ı f .
We have to show that Kleisli composition is associative: in fact, we
have
.h  g/  f D .h  g/ ı f
D .h ı g/ ı f
(deﬁnition of h  g)
D h ı g ı f
(property ➂)
D h ı .g  f /
(deﬁnition of g  f )
D h  .f  g/
Thus KT is indeed a category. The map on objects in a Kleisli category
extends to a functor (note that we did not postulate for a Kleisli tripel
that Tf is deﬁned for morphisms). This functor is associated with two
natural transformations which together form a monad. We will ﬁrst de-
ﬁne what a monad formally is and then discuss the construction in some
detail.
2.4.2
Monads
Deﬁnition 2.4.3 A monad over a category K is a triple .T; ; / with
these properties:

168
CHAPTER 2. CATEGORIES
➊T is an endofunctor on K.
➋ W IdK ! T and  W T2 ! T are natural transformations.  is
called the unit and  the multiplication of the monad.
➌These diagrams commute
Each Kleisli tripel generates a monad, and vice versa. This is what
Manes’ Theorem says:
Theorem 2.4.4 Given a category K, there is a one-to-one correspon-
dence between Kleisli tripels and monads.
Proof 0. The proof will be somewhat longish, because so many prop-
erties have to be established or checked. In the ﬁrst part, T will be
Outline and
strategy
extended to a functor, and a multiplication will be deﬁned (the unit re-
mains what it is in the Kleisli tripel), and the laws for a monad will be
established. The second part will deﬁne the  operation and establish
the corresponding properties of a Kleisli tripel; again, the unit remains
what it is in the monad. The proof as a whole demonstrates the interac-
tion of the concepts in a very clean way; this is why I did not put it into
separate pieces.
1. Let .T; ; / be a Kleisli tripel. We will extend T to a functor
K ! K and deﬁne the multiplication; the monad’s unit will be . De-
ﬁne
Tf WD .b ı f /; if f W a ! b;
a WD .idTa/:
Then  is a natural transformation T2 ! T. Clearly, a W T2a ! Ta is
a morphism. Let f W a ! b be a morphism in K; then we have
b ı T2f D id 
Tb ı .Tb ı .b ı f //
D

id 
Tb ı .Tb ı .b ı f //

(by ➂)
D

idTb ı .b ı f /
(since id 
Tb ı Tb D idTb)
D .b ı f /:

2.4. MONADS AND KLEISLI TRIPELS
169
Similarly, we obtain
.Tf / ı a D .b ı f / ı id 
Ta D

.b ı f / ı idTa
 D .b ı f /:
Hence  W T2 ! T is natural. Because we obtain for the morphisms
f W a ! b and g W b ! c the identity
.Tg/ ı .Tf / D .c ı g/ ı .b ı f / D

.c ı g/ ı b ı f

D .c ı g ı f / D T.g ı f /;
and since by ➀
T ida D .a ı idTa/ D 
a D idTa;
we conclude that T is an endofunctor on K.
We check the laws for unit and multiplication according to ➌. One notes
ﬁrst that
a ı Ta D id 
Ta ı Ta
.	/
D idTa
(in equation ./ we use ➁) and that
a ı Ta
D
id 
Ta.Ta ı a/ D .id 
Ta ı Ta ı a/ .
/
D 
a
D
.a ı ida/ D T .ida/
(in equation ./ we use ➁again). Hence the rightmost diagram in ➌
commutes. Turning to the leftmost diagram, we note that
a ı Ta D id 
Ta ı id 
T2a D .id 
Ta ı idT2a/ .%/
D 
a;
using ➂in equation .%/. On the other hand,
a ı .T a/
D
id 
Ta ı .T id 
Ta/ D id 
Ta ı .Ta ı id 
Ta/
D
id 
Ta
 D 
a;
because id 
TaıTa D idTa by ➁. Hence the leftmost diagram commutes
as well, and we have indeed deﬁned a monad.
2. To establish the converse, deﬁne f  WD b ı .Tf / for the morphism
f W a ! Tb. We obtain from the right-hand triangle 
a D a ı
.Ta/ D idTa; thus ➀holds. Since  W IdK ! T is natural, we have
.Tf / ı a D Tb ı f for f W a ! Tb. Hence
f  ı a D b ı .Tf / ı a D b ı Tb ı f D f

170
CHAPTER 2. CATEGORIES
by the left-hand side of the right triangle, giving ➁. Finally, note that due
to  W T2 ! T being natural, we have for g W b ! Tc the commutative
diagram
Then
g ı f  D c ı .Tg/ ı b ı .Tf /
D c ı Tc ı .T2g/ ı .Tf /
(since .Tg/ ı b
D Tc ı T2g)
D c ı .Tc/ ı T.T.g/ ı f /
(since c ı Tc
D c ı .Tc/)
D c ı T.c ı T.g/ ı f /
D c ı T.g ı f /
D .g ı f /
This establishes ➂and shows that this deﬁnes a Kleisli tripel. a
Taking a Kleisli tripel and producing a monad from it, one suspects that
one might end up with a different Kleisli tripel for the generated monad.
But this is not the case; just for the record:
Corollary 2.4.5 If the monad is given by a Kleisli tripel, then the Kleisli
tripel deﬁned by the monad coincides with the given one. Similarly, if
the Kleisli tripel is given by the monad, then the monad deﬁned by the
Kleisli tripel coincides with the given one.
Proof We use the notation from above. Given the monad, put f C WD
idTb ı .b ı f /; then
f C D Tb ı .b ı f / D .idTa ı f / D f :
On the other hand, given the Kleisli tripel, put T0f WD .b ı f /;
then
T0f D b ı T.b ı f / D b ı T.b/ D Tf:
a

2.4. MONADS AND KLEISLI TRIPELS
171
Some examples explain this development. Theorem 2.4.4 tells us that
the speciﬁcation of a Kleisli tripel will give us the monad, and vice
versa. Thus we are free to specify one or the other; usually the speciﬁ-
cation of the Kleisli tripel is shorter and more concise.
Example 2.4.6 Nondeterministic
computations
may
be
modeled
through a map f W S ! P .T /: given a state (or an input, or what-
ever) from set S, the set f .s/ describes the set of all possible outcomes.
Thus we work in category Set with maps as morphisms and take the
power set functor P as the functor. Deﬁne
S.x/ WD fxg;
f .B/ WD
[
x2B
f .x/
for the set S, for B  S and the map f W S ! P .T /. Then clearly
S W S ! P .S/, and f  W P .S/ ! P .T /. We check the laws for a
Kleisli tripel:
➀Since 
S.B/ D S
x2B S.x/ D B, we see that 
S D idP.S/.
➁It is clear that f  ı a D f holds for f W S ! P .S/.
➂Let f W S ! P .T / and g W T ! P .U /, then
u 2 .g ı f /.B/ , u 2 g.y/ for some x 2 B
and some y 2 f .x/
, u 2 g.f .x// for some x 2 B
Thus .g ı f /.B/ D .g ı f /.B/.
Hence the laws for a Kleisli tripel are satisﬁed. Let us just compute
S D id 
P.S/: Given ˇ 2 P .P .S//, we obtain
S.ˇ/ D id 
P.S/ D
[
B2ˇ
B D
[
ˇ:
The same argumentation can be carried out when the power set functor is
replaced by the ﬁnite power set functor Pf W S 7! fA  S j A is ﬁniteg
with the obvious deﬁnition of Pf on maps. ✌
In contrast to nondeterministic computations, probabilistic ones argue
with probability distributions. We consider the discrete case ﬁrst, and
here we focus on probabilities with ﬁnite support.

172
CHAPTER 2. CATEGORIES
Example 2.4.7 We work in the category Set of sets with maps as mor-
phisms and consider the discrete probability functor DS WD fp W S !
Œ0; 1 j p is a discrete probabilityg; see Example 2.3.11. Let f W S !
DS be a map and p 2 DS, put
f .p/.s/ WD
X
t2S
f .t/.s/  p.t/:
Then
X
s2S
f .p/.s/
D
X
s
X
t
f .t/.s/  p.t/ D
X
t
X
s
f .t/.s/  p.t/
D
X
t
p.t/ D 1I
hence f  W DS ! DS. Note that the set fhs; ti 2 S  T j f .s/.t/ 
p.s/ > 0g is ﬁnite, because p has ﬁnite support and because each f .s/
has ﬁnite support as well. Since each of the summands is nonnegative,
we may reorder the summations at our convenience. Deﬁne moreover
S.s/.s0/ WD dS.s/.s0/ WD
(
1;
s D s0
0;
otherwise;
so that S.s/ is the discrete Dirac measure on s. Then:
➀
S.p/.s/ D P
s0 dS.s/.s0/  p.s0/ D p.s/; hence we may con-
clude that 
S ı p D p.
➁f .S/.s/ D f .s/ is immediate.
➂Let f W S ! DT and g W T ! DU ; then we have for p 2 DS
and u 2 U
.g ı f /.p/.u/
D P
t2T g.t/.u/  f .p/.u/
D P
t2T
P
s2S g.t/.u/  f .s/.t/  p.s/
D P
hs;ti2S	T g.t/.u/  f .s/.t/  p.s/
D P
s2S
P
t2T g.t/.u/  f .s/.t/

 p.s/
D P
s2S g.f .s//.u/  p.s/
D .g ı f /.p/.u/
Again, we are not bound to any particular order of summation.

2.4. MONADS AND KLEISLI TRIPELS
173
We obtain for M 2 .D ı D/S
S.M/.s/ D id 
DS.M/.s/ D
X
q2D.S/
M.q/  q.s/:
The last sum extends over a ﬁnite set, because the support of M is ﬁnite.
✌
Since programs may fail to halt, one works sometimes in models which
are formulated in terms of subprobabilities rather than probabilities.
This is what we consider next, extending the previous example to the
case of general measurable spaces. Recall that examples requiring tech-
niques from Chap. 4 are marked.
Example 2.4.8 s
We work in the category of measurable spaces
with measurable maps as morphisms; see Example 2.1.12. In Exam-
ple 2.3.12, the subprobability functor was introduced, and it was shown
that for a measurable space S, the set SS of all subprobabilities is a
measurable space again (we omit in this example the -algebra from
notation, a measurable space is for the time being a pair consisting of a
carrier set and a -algebra on it). A probabilistic computation f on the
measurable spaces S and T produces from an input of an element of S
a subprobability distribution f .s/ on T , hence an element of ST . We
want f to be a morphism in Meas, so f W S ! ST is assumed to be
measurable.
We know from Example 2.1.14 and Exercise 2.7 that f W S ! ST is
measurable iff these conditions are satisﬁed:
1. f .s/ 2 S.T / for all s 2 S; thus f .s/ is a subprobability on (the
measurable sets of) T .
2. For each measurable set D in T , the map s 7! f .s/.D/ is mea-
surable.
Returning to the deﬁnition of a Kleisli tripel, we deﬁne for the measur-
able space S, f W S ! ST ,
eS WD ıS;
f ./.B/ WD
Z
S
f .s/.B/ .ds/
. 2 SS; B  T measurable/:
Thus eS.x/ D ıS.x/, the Dirac measure associated with x, and f  W
SS ! SS is a morphism (in this example, we write e for the unit and m

174
CHAPTER 2. CATEGORIES
for the multiplication). Note that f ./ 2 S.T / in the scenario above;
in order to see whether the properties of a Kleisli tripel are satisﬁed, we
need to know how to integrate with this measure. Standard arguments
like Levi’s Theorem 4.8.2 show that
Z
T
h df ./ D
Z
S
Z
T
h.t/ f .s/.dt/ .ds/;
(2.1)
whenever h W T ! RC is measurable and bounded; see also the discus-
sion leading to Eq. (4.20) on page 633.
Let us again check the properties of a Kleisli tripel. Fix B as a mea-
surable subset of S, f W S ! SS and g W T ! SU as morphisms in
Meas.
➀Let  2 SS; then
e
S./.B/ D
Z
S
ıS.x/.B/ .dx/ D .B/I
hence e
S D idSS.
➁If x 2 S, then
f .eS.x//.B/ D
Z
S
f .s/.B/ ıS.x/.ds/ D f .x/.B/;
since
R
S h dıS.x/ D h.x/ for every measurable map h. Thus
f  ı eS D f .
➂Given  2 SS, we have
.g ı f /./.B/ D g.f .//.B/
D
Z
T
g.t/.B/ f ./.dt/
.2.1/
D
Z
S
Z
T
g.t/.B/ f .s/.dt/ .ds/
D
Z
S
g.f .s//.B/ .ds/
D .g ı f /./.B/
Thus g ı f  D .g ı f /.

2.4. MONADS AND KLEISLI TRIPELS
175
Hence .S; e; / forms a Kleisli tripel over the category Meas of mea-
surable spaces.
Let us ﬁnally determine the monad’s multiplication. We have for M 2
.S ı S/S and the measurable set B  S
mS.M/.B/ D id 
S.S/.M/.B/ D
Z
S.S/
.B/ M.d/:
✌
The underlying monad has been investigated by M. Giry, so it is called
in her honor the Giry monad, and S is called the Giry functor. Both are
Giry monad
used extensively as the machinery on which Markov transition systems
are based.
The next example shows that ultraﬁlter deﬁnes a monad as well.
Example 2.4.9 Let
U
be
the
ultraﬁlter
functor
on
Set;
see
Example 2.3.14. Deﬁne for the set S and the map f W S ! UT
S.s/ WD fA  S j s 2 Ag;
f .U / WD
˚
B  T j fs 2 S j B 2 f .s/g 2 U

;
provided U 2 US is an ultraﬁlter. Then ; 62 f .U /, since ; 62 U .
S.s/ is the principal ultraﬁlter associated with s 2 S (see page 42);
hence S W S ! US. Because the intersection of two sets is a member
of an ultraﬁlter iff both sets are elements of it,
fs 2 S j B1\B2 2 f .s/g D fs 2 S j B1 2 f .s/g\fs 2 S j B2 2 f .s/g;
f .U / is closed under intersections; moreover, B  C and B 2 f .U /
imply C 2 f .U /. If B 62 f .U /, then fs 2 S j f .s/ 2 Bg 62 U ;
hence fs 2 S j B 62 f .s/g 2 U ; thus S n B 2 f .U /, and vice versa.
Hence f .U / is an ultraﬁlter; thus f  W US ! UT .
We check whether .U; ; / is a Kleisli tripel:
➀Since B 2 
S.U / iff B D fs 2 S j s 2 Bg 2 U , we conclude
that 
S D idUS.
➁Similarly, if f W S ! UT and s 2 S, then B 2 .f  ı S/.s/ iff
B 2 f .s/; hence f  ı S D f:

176
CHAPTER 2. CATEGORIES
➂Let f W S ! UT and g W T ! UW . Then
B 2 .g ı f /.U / ,
˚
s 2 S j ft 2 T j B 2 g.t/g 2 f .s/

2 U
, B 2 .g ı f /.U /
for U 2 US. Consequently, g ı f  D .g ı f /:
Let us compute the monad’s multiplication. Deﬁne for B  S the set
ŒB WD fC 2 US j B 2 Cg
as the set of all ultraﬁlters on S which contain B as an element; then an
easy computation shows
S.V / D id 
US.V / D fB  S j ŒB 2 V g
for V 2 .U ı U/S. ✌
Example 2.4.10 This example deals with upper closed subsets of the
power set of a set; see Example 2.3.13. Let again
VS WD fV  PS j V is upper closedg
be the endofunctor on Set which assigns to set S all upper closed subsets
of PS. We deﬁne the components of a Kleisli tripel as follows: S.s/ is
the principal ultraﬁlter generated by s 2 S, which is upper closed, and
if f W S ! VT is a map, we put
f .V / WD
˚
B  T j fs 2 S j B 2 f .s/g 2 V

for V 2 VT ; see in Example 2.4.9.
The argumentation in Example 2.4.9 carries over and shows that this
deﬁnes a Kleisli tripel. ✌
These examples show that monads and Kleisli tripels are constructions
which model many computationally interesting subjects. After looking
at the practical side of this, we return to the discussion of the relationship
of monads with adjunctions, another important concept.
2.4.3
Monads in Haskell
The functional programming language Haskell thrives on the con-
struction of monads. We have a brief look.

2.4. MONADS AND KLEISLI TRIPELS
177
Haskell permits the deﬁnition of type classes; the deﬁnition of a type
class requires the speciﬁcation of the types on which the class is based
and the signature of the functions deﬁned by this class. The deﬁnition
of class Monad is given below (actually, it is rather a speciﬁcation of
Kleisli tripels).
class Monad m where
(>>=)
:: m a -> (a -> m b) -> m b
return :: a -> m a
(>>)
:: m a -> m b -> m b
fail
:: String -> m a
Thus class Monad is based on type constructor m; it speciﬁes four func-
tions of which >>= and return are the most interesting. The ﬁrst one
is called bind and used as an inﬁx operator: given x of type m a and a
function f of type a -> m b, the evaluation of x >>= f will yield
a result of type m b. This corresponds to f . The function return
takes a value of type a and evaluates to a value of type m a; hence it
corresponds to a (the name return has probably not been a fortunate
choice). The function >>, usually used as an inﬁx operator as well, is
deﬁned by default in terms of >>=, and function fail serves to han-
dling exceptions; both functions will not concern us here.
Not every conceivable deﬁnition of the functions return and the bind
function >>= is suitable for the deﬁnition of a monad. These are the
laws the Haskell programmer has to enforce, and it becomes evident
that these are just the laws for a Kleisli tripel from Deﬁnition 2.4.1:
return x >>= f
== f x
p >>= return
== p
p >>= (\x -> (f x >>= g)) == (p >>= (\x ->
f x)) >>= g
(here, x is not free in g; \x -> f x is Haskell’s way of express-
ing the anonymous function x:f x). The compiler for Haskell can-
not check these laws, so the programmer has to make sure that they
hold.
We demonstrate the concept with a simple example. Lists are a popular
data structure. They are declared as a monad in this way:
instance Monad [] where
return t = [t]
x >>= f
= concat (map f x)

178
CHAPTER 2. CATEGORIES
This makes the polymorphic-type constructor [] for lists a monad; it
speciﬁes essentially that f is mapped over the list x (x has to be a list,
and f a function deﬁned on the list’s base type yielding a list as a value);
this results in a list of lists which then will be ﬂattened through an appli-
cation of function concat. This example should clarify things:
>>> q = (\w -> [0 .. w])
>>> [0 .. 2] >>= q
[0,0,1,0,1,2]
The effect is explained in the following way: The deﬁnition of the bind
operation >>= requires the computation of
concat (map q [0 .. 2])
= concat [(q 0), (q 1), (q 2)]
== concat [[0], [0, 1], [0, 1, 2]]
== [0,0,1,0,1,2].
We check the laws of a monad.
 We have return x == [x]; hence
return x >>= f == [x] >>= f
== concat (map f [x])
== concat [f x]
== f x
 Similarly, if p is a given list, then
p >>= return == concat (map return p)
== concat [[x] | x <- p]
== [x | x <- p]
== p
 For the third law, if p is the empty list, then the left- and the right-
hand side are empty as well. Hence let us assume that p = [x1,
.., xn]. We obtain for the left-hand side
p >>= (\x -> (f x >>= g))
== concat (map (\x -> (f x >>= g)) p)
== concat (concat [map g (f x) | x <-p]),
and for the right-hand side
(concat [f x | x <- p]) >>= g
== ((f x1) ++ (f x2) ++ .. ++ (f xn))
>>= g
== concat (map g ((f x1) ++ (f x2) ++ ..

2.5. ADJUNCTIONS AND ALGEBRAS
179
++ (f xn)))
== concat (concat [map g (f x) | x <- p])
(this argumentation could of course be made more precise through
a proof by induction on the length of list p, but this would lead us
too far from the present discussion).
Kleisli composition >=> can be deﬁned in a monad as follows:
(>=>) :: Monad m => (a -> m b) -> (b -> mc)
-> (a -> m c) f >=> g = \x -> (f x) >>= g
This gives in the ﬁrst line a type declaration for operation >=> by indi-
cating that the inﬁx operator >=> takes two arguments, viz., a function
with the signature a -> m b and a second one with the signature b
-> m c, and that the result will be a function of type a -> m c, as
expected. The precondition to this type declaration is that m is a monad.
The body of the function will use the bind operator for binding f x to
g; this results in a function depending on x. It can be shown that this
composition is associative.
2.5
Adjunctions and Algebras
An adjunction relates two functors F W K ! L and G W L ! K in a
systematic way. We deﬁne this formally and investigate some examples
in order to show that this is a natural concept which arises in a variety
of situations. In fact, we will show that monads are closely related to
adjunctions via algebras, so we will study algebras as well and provide
the corresponding constructions.
2.5.1
Adjunctions
We deﬁne the basic notion of an adjunction and show that an adjunc-
tion deﬁnes a pair of natural transformations through universal arrows
(which is sometimes taken as the basis for adjunctions).
Deﬁnition 2.5.1 Let K and L be categories. Then .F; G; '/ is called an
adjunction iff:
1. F W K ! L and G W L ! K are functors,

180
CHAPTER 2. CATEGORIES
2. for each object a in L and x in K there is a bijection
'x;a W homL.Fx; a/ ! homK.x; Ga/
which is natural in x and a.
F is called the left adjoint to G; G is called the right adjoint to F.
That 'x;a is natural for each x; a means that for all morphisms f W a !
b in L and g W y ! x in K, both diagrams commute:
Here, f WD homL.Fx; f / and g WD homK.g; Ga/ are the hom set
functors associated with f resp. g, similar for .Gf / and for .Fg/;
for the hom set functors, see Example 2.3.3.
Let us have a look at currying as a simple example.
Example 2.5.2 A map f W X  Y ! Z is sometimes considered as a
map f W X ! .Y ! Z/, so that f .x; y/ is considered as the value
F.x/.y/ at y for the “higher order” map F.x/ WD b:f .x; b/. This
technique is popular in functional programming; it is called currying
Currying
and will be discussed now.
Fix a set E and deﬁne the endofunctors F; G W Set ! Set by F WD E
resp. G WD E. Thus we have in particular .Ff /.x; e/ WD hf .x/; ei
and .Gf /.g/.e/ WD f .g.e//, whenever f W X ! Y is a map.
Deﬁne the map 'X;A W homSet.FX; A/ ! homSet.X; GA/ by 'X;A.k/
.x/.e/ WD k.x; e/. Then 'X;A is a bijection. In fact, let k1; k2 W FX !
A be different maps, then k1.x; e/ 6D k2.x; e/ for some hx; ei 2 X E;
hence 'X;A.k1/.x/.e/ 6D 'X;A.k2/.x/.e/, so that 'X;A is one to one.
Let ` W X ! GA be a map, then ` D 'X;A.k/ with k.x; e/ WD `.x/.e/.
Thus 'X;A is onto.
In order to show that ' is natural both in X and in A, take maps f W
A ! B and g W Y ! X and trace k 2 homSet.FX; A/ through the
diagrams in Deﬁnition 2.5.1. We have
'X;B.f.k//.x/.e/ D f.k/.x; e/ D f .k.x; e// D f .'X;A.k/.x; e//
D .Gf /.'X;A.k/.x/.e/:

2.5. ADJUNCTIONS AND ALGEBRAS
181
Similarly,
g.'X;A.k//.y/.e/
D
k.g.y/; e/ D .Fg/.k/.y; e/
D
'Y;A..Fg/.k//.y/.e/:
This shows that .F; G; '/ with ' as the currying function is an adjunc-
tion. ✌
Another popular example is furnished through the diagonal functor.
Example 2.5.3 Let K be a category such that for any two objects a
and b, their product a  b exists. Recall the deﬁnition of the Cartesian
product of categories from Lemma 2.1.19. Deﬁne the diagonal functor
 W K ! K K through a WD ha; ai for objects and f WD hf; f i for
morphism f . Conversely, deﬁne T W K  K ! K by putting T.a; b/ WD
a  b for objects and Thf; gi WD f  g for morphism hf; gi.
Let hk1; k2i 2 homK	K.a; hb1; b2i/; hence we have morphisms k1 W
a ! b1 and k2 W a ! b2. By the deﬁnition of the product, there
exists a unique morphism k W a ! b1  b2 with k1 D 1 ı k and
k2 D 2 ı k, where i W b1  b2 ! bi are the projections, i D
1; 2. Deﬁne 'a;b1	b2.k1; k2/ WD k; then it is immediate that 'a;b1	b2 W
homK	K.a; hb1; b2i/ ! homK.a; T.b1; b2/ is a bijection.
Let hf1; f2i W ha1; a2i ! hb1; b2i be a morphism; then the diagram
splits into the two commutative diagrams
for i D 1; 2, hence is commutative itself. One argues similarly for a
morphism g W b ! a. Thus the bijection ' is natural.
Hence we have found out that .; T; '/ is an adjunction, so that the
diagonal functor has the product functor as an adjoint. ✌

182
CHAPTER 2. CATEGORIES
A map f W X ! Y between sets provides us with another example,
which is the special case of a Galois connection: A pair f W P ! Q
and g W Q ! P of monotone maps between the partially ordered sets
P and Q form a Galois connection iff f .p/  q , p  g.q/ for all
p 2 P; q 2 Q.
Example 2.5.4 Let X and Y be sets, then the inclusion on PX resp.
PY makes these sets categories of their own; see Example 2.1.4. Given
a map f W X ! Y , deﬁne f‹ W PX ! PY as the direct image f‹.A/ WD
f

A

and fŠ W PY ! PX as the inverse image fŠ.B/ WD f 1
B

.
Now we have for A  X and B  Y
B  f‹.A/ , B  f

A

, f 1
B

 A , fŠ.B/  A:
This means in terms of the hom sets that homPY.B; f‹.A// 6D ; iff
homPX.fŠ.B/; A/ 6D ;. Hence this gives an adjunction .fŠ; f‹; '/. ✌
Back to the general development. This auxiliary statement will help in
some computations.
Lemma 2.5.5 Let .F; G; '/ be an adjunction and f W a ! b and g W
y ! x be morphisms in L resp. K. Then we have
.Gf / ı 'x;a.t/ D 'x;b.f ı t/;
'x;a.t/ ı g D 'y;a.t ı Fg/
for each morphism t W Fx ! a in L.
Proof Chase t through the left-hand diagram of Deﬁnition 2.5.1 to
obtain
..Gf / ı 'x;a/.t/ D .Gf / ı 'x;a.t/ D 'x;b.f.t// D 'x;b.f ı t/:
This yields the ﬁrst equation; the second is obtained from tracing t
through the diagram on the right-hand side. a
An adjunction induces natural transformations which make this impor-
tant construction easier to handle and which helps indicating connec-
tions of adjunctions to monads and Eilenberg–Moore algebras. Before
entering the discussion, universal arrows are introduced.
Deﬁnition 2.5.6 Let S W C ! D be a functor and c an object in C.
1. the pair hr; ui is called a universal arrow from c to S iff r is an
object in C and u W c ! Sr is a morphism in D such that for any

2.5. ADJUNCTIONS AND ALGEBRAS
183
arrow f W c ! Sd there exists a unique arrow f 0 W r ! d in C
such that f D .Sf 0/ ı u.
2. the pair hr; vi is called a universal arrow from S to c iff r is an
object in C and v W Sr ! c is a morphism in D such that for any
arrow f W Sd ! c there exists a unique arrow f 0 W d ! r in C
such that f D v ı .Sf 0/.
Thus, if the pair hr; ui is universal from c to S, then each arrow c ! Sd
in C factors uniquely through the S-image of an arrow r ! d in C.
Similarly, if the pair hr; vi is universal from S to c, then each D-arrow
Sd ! c factors uniquely through the S-image of an C-arrow d ! r.
These diagrams depict the situation for a universal arrow u W c ! Sr
resp. a universal arrow v W Sr ! c.
This is a characterization of a universal arrow from c to S.
Lemma 2.5.7 Let S W C ! D be a functor. Then hr; ui is a universal
arrow from c to S iff the function  d which maps each morphism f 0 W
r ! d to the morphism .Sf 0/ ı u is a natural bijection homC.r; d/ !
homD.c; Sd/.
Proof 1. If hr; ui is a universal arrow, then bijectivity of  d is just a
reformulation of the deﬁnition. It is also clear that  d is natural in d,
because if g W d ! d 0 is a morphism, then S.g0 ı f 0/ ı u D .Sg0/ ı
.Sg/ ı u.
2. Now assume that  d W homC.r; d/ ! homD.c; Sd/ is a bijection for
each d, and choose in particular r D d. Deﬁne u WD  r.idr/; then
u W c ! Sr is a morphism in D. Consider this diagram for an arbitrary
f 0 W r ! d
Given a morphism f W c ! Sd in D, there exists a unique morphism
f 0 W r ! d such that f D  d.f 0/, because  d is a bijection. Then we

184
CHAPTER 2. CATEGORIES
have
f D  d.f 0/
D

 d ı homC.r; f 0/

.idr/
D

homD.c; Sf 0/ ı  r

.idr/
(commutativity)
D homD.c; Sf 0/ ı u
.u D  r.idr//
D .Sf 0/ ı u:
a
Universal arrows will be used now for a characterization of adjunctions
in terms of natural transformations (we will sometimes omit the indices
for the natural transformation ' that comes with an adjunction).
Theorem 2.5.8 Let .F; G; '/ be an adjunction for the functors F W K !
L and G W L ! K: Then there exist natural transformations  W IdK !
G ı F and " W F ı G ! IdL with these properties:
1. the pair hFx; xi is a universal arrow from x to G for each x in
K, and '.f / D Gf ı x holds for each f W Fx ! a,
2. the pair hGa; "ai is universal from F to a for each a in L, and
'1.g/ D "a ı Fg holds for each g W x ! Ga,
3. the composites
are the identities for G resp. F.
Proof 1. Put x WD 'x;Fx.idFx/; then x W x ! GFx. In order to show
that hFx; xi is a universal arrow from x to G, we take a morphism
f W x ! Ga for some object a in L. Since .F; G; '/ is an adjunction,
we know that there exists a unique morphism f 0 W Fx ! a such that
'x;a.f 0/ D f . We have also this commutative diagram

2.5. ADJUNCTIONS AND ALGEBRAS
185
Thus
.Gf 0/ ı x D

homL.x; Gf 0/ ı 'x;Fx

.idFx/
D

'x;a ı homK.Fx; f 0/

.idFx/
D 'x;a.f 0/
D f
2.  W IdK ! G ı F is a natural transformation. Let h W x ! y be a
morphism in K, then we have by Lemma 2.5.5
G.Fh/ ı x
D G.Fh/ ı 'x;Fx.idFx/
D 'x;Fy.Fh ı idFx/
D 'x;Fy.idFy ı Fh/
D 'y;Fy.idFy/ ı h
D y ı h:
3. Put "a WD '1
Ga;a.idGa/ for the object a in L; then the properties for "
are proved in exactly the same way as for those of .
4. From 'x;a.f / D Gf ı x; we obtain
idGa D '."a/ D G"a ı Ga D .G" ı G/.a/;
so that G" ı G is the identity transformation on G. Similarly, F ı F"
is the identity for F. a
The transformation  is sometimes called the unit of the adjunction,
whereas " is called its counit. The converse to Theorem 2.5.8 holds as
Unit, counit
well: from two transformations  and " with the signatures as above,
one can construct an adjunction. The proof is a fairly straightforward
veriﬁcation.
Proposition 2.5.9 Let F W K ! L and G W L ! K be functors, and
assume that natural transformations  W IdK ! G ı F and " W F ı G !
IdL are given so that .G"/ ı .G/ is the identity of G and ."F/ ı .F/ is
the identity of F. Deﬁne 'x;a.k/ WD .Gk/ ı x, whenever k W Fx ! a
is a morphism in L. Then .F; G; '/ deﬁnes an adjunction.

186
CHAPTER 2. CATEGORIES
Proof 1. Deﬁne #x;a.`/ WD "aıFg for ` W x ! Ga; then we have
'x;a.#x;a.g// D G."a ı Fg/ ı x
D .G"a/ ı .GFg/ ı x
D .G"a/ ı Ga ı g
( is natural)
D

.G" ı G/a

ı g
D idGag
D g
Thus 'x;aı#x;a D idhomL.x;Ga/. Similarly, one shows that #x;aı'x;a D
idhomK.Fx;a/, so that 'x;a is a bijection.
2. We have to show that 'x;a is natural for each x; a, so take a morphism
f W a ! b in L and chase k W Fx ! a through this diagram.
Then

.Gf / ı 'x;a

.k/ D .Gf ı Gk/ ı x D G.f ı k/ ı x D
'x;b.f ı k/: a
Thus it is sufﬁcient to identify its unit and its counit for identifying an
adjunction. This includes verifying the identity laws of the functors for
the corresponding compositions. The following example has another
look at currying (Example 2.5.2), demonstrating the approach and sug-
gesting that identifying unit and counit is sometimes easier than working
with the originally given deﬁnition.
Example 2.5.10 Continuing Example 2.5.2, we take the deﬁnitions of
the endofunctors F and G from there. Deﬁne for the set X the natural
transformations  W IdSet ! G ı F and " W F ı G ! IdSet through
X W
(
X
! .X  E/E
x
7! e:hx; ei
and
"X W
(
.X  E/E  E
! X
hg; ei
7! g.e/

2.5. ADJUNCTIONS AND ALGEBRAS
187
Note that we have .Gf /.h/ D f ı h for f W XE ! Y E and h 2 XE,
so that we obtain
G"X.GX.g//.e/
D ."X ı GX.g//.e/
D "X.GX.g//.e/
D "X.GX.g/.e//
D "X.g; e/
D g.e/;
whenever e 2 E and g 2 GX D XE; hence .G"/ ı .G/ D idG. One
shows similarly that ."F/ ı .F/ D idF through
"FX.FX.x; e// D X.x/.e/ D hx; ei:
✌
Now let .F; G; '/ be an adjunction with functors F W K ! L and G W
L ! K, the unit , and the counit ". Deﬁne the functor T through
T WD GıF: Then T W K ! K deﬁnes an endofunctor on category K with
a WD .G"F/ .a/ D G"Fa as a morphism a W T2 .a/ ! Ta: Because
"a W FGa ! a is a morphism in L, and because " W F ı G ! IdL is
natural, the diagram
is commutative. This means that this diagram
of functors and natural transformations commutes. Multiplying from
the left with G and from the right with F gives this diagram.
Because T D .G ı F ı G/"F, and G".F ı G ı F/ D T, this diagram
can be written as

188
CHAPTER 2. CATEGORIES
This gives the commutativity of the left-hand diagram in Deﬁnition 2.4.3
for a monad. Because G" ı G is the identity on G, we obtain
Lo and
behold!
G"Fa ı GFa D .G" ı G/.Fa/ D GFa;
which implies that the diagram
commutes. On the other hand, we know that "F ı F is the identity on
F; this yields
G"Fa ı GFa D G."F ı F/a D GFa:
Hence we may complement the last diagram:
This gives the right-hand-side diagram in Deﬁnition 2.4.3 for a monad.
We have shown
Proposition 2.5.11 Each adjunction deﬁnes a monad. a
It turns out that we not only may proceed from an adjunction to a monad,
but that it is also possible to traverse this path in the other direction.
2.5.2
Eilenberg–Moore Algebras
We will show that a monad deﬁnes an adjunction. In order to do that, we
have to represent the functorial part of a monad as the composition of
two other functors, so we need a second category for this. The algebras
which are deﬁned for a monad provide us with this category. So we will
deﬁne algebras (and in a later chapter, their counterparts, coalgebras),
and we will study them. This will help us in showing that each monad
deﬁnes an adjunction. Finally, we will have a look at two examples for
algebras, in order to illuminate this concept.

2.5. ADJUNCTIONS AND ALGEBRAS
189
Given a monad .T; ; / in a category K, a pair hx; hi consisting of an
object x and a morphism h W Tx ! x in K is called an Eilenberg–Moore
algebra for the monad iff the following diagrams commute
The morphism h is called the structure morphism of the algebra, x its
Eilenberg-
Moore
algebra
carrier.
An algebra morphism f W hx; hi ! hx0; h0i between the algebras hx; hi
and hx0; h0i is a morphism f W x ! x0 in K which renders the dia-
gram
commutative. Eilenberg–Moore algebras together with their morphisms
form a category Alg.T;;/. We will usually omit the reference to the
monad. Fix for the moment .T; ; / as a monad in category K, and
let Alg WD Alg.T;;/ be the associated category of Eilenberg–Moore
algebras.
Alg.T;;/
We give some simple examples.
Lemma 2.5.12 The pair hTx; xi is a T-algebra for each x in K.
Proof This is immediate from the laws for  and  in a monad. a
These algebras are usually called the free algebras for the monad. Mor-
Free algebra
phisms in the base category K translate into morphisms in Alg through
functor T.
Lemma 2.5.13 If f W x ! y is a morphism in K, then Tf W hTx; xi
! hTy; yi is a morphism in Alg. If hx; hi is an algebra, then h W
hTx; xi ! hx; hi is a morphism in Alg.
Proof Because  W T2 ! T is a natural transformation, we see y ı
T2f D .Tf / ı x: This is just the deﬁning equation for a morphism in
Alg. The second assertion follows also from the deﬁning equation of an
algebra morphism. a

190
CHAPTER 2. CATEGORIES
We will identify the algebras for the power set monad now, which are
closely connected to semi-lattices. Recall that an ordered set .X; / is
a sup semi-lattice iff each subset has its supremum in X.
Example 2.5.14 The algebras for the monad .P; ; / in the category
Set of sets with maps (sometimes called the Manes monad) may be iden-
Manes
monad
tiﬁed with the complete sup semi-lattices. We will show this now.
Assume ﬁrst that  is a partial order on a set X that is sup-complete, so
that sup A exists for each A  X: Deﬁne h.A/ WD sup AI then we have
for each A 2 P .P .X// from the familiar properties of the supremum
sup.
[
A/ D sup fsup a j a 2 Ag:
This translates into

hıX

.A/ D

hı.Ph/

.A/: Because x D supfxg
holds for each x 2 X, we see that hX; hi deﬁnes an algebra.
Assume on the other hand that hX; hi is an algebra, and put
x  x0 , h.fx; x0g/ D x0
for x; x0 2 X. This deﬁnes a partial order: reﬂexivity and antisymmetry
are obvious. Transitivity is seen as follows: assume x  x0 and x0  x00;
then
h.fx; x00g/
D h.fh.fxg/; h.fx0; x00g//
D

h ı .Ph/

.ffxg; fx0; x00gg/
D

h ı X

.ffxg; fx0; x00gg/
D h.fx; x0; x00g/
D

h ı X

.ffx; x0g; fx0; x00gg/
D

h ı .Ph/

.ffx; x0g; fx0; x00gg/
D h.fx0; x00g/
D x00:
It is clear from fxg [ ; D fxg for every x 2 X that h.;/ is the smallest
element. Finally, it has to be shown that h.A/ is the smallest upper
bound for A  X in the order . We may assume that A 6D ;. Suppose
that x  t holds for all x 2 A, then
h.A [ ftg/
D h
S
x2Afx; tg

D

h ı X

.ffx; tg j x 2 Ag/
D

h ı .Ph/

.ffx; tg j x 2 Ag/
D h

fh.fx; tg/ x 2 Ag

D h.ftg/
D t:
Thus, if x  t for all x 2 A, hence h.A/  t, thus h.A/ is an upper
bound to A, and similarly, h.A/ is the smallest upper bound. ✌
We have shown that each adjunction deﬁnes a monad, and—as
announced above—now turn to the converse.
In fact, we will show

2.5. ADJUNCTIONS AND ALGEBRAS
191
that each monad deﬁnes an adjunction, the monad of which is the given
monad.
Fix the monad .T; ; / over category K, and deﬁne as above Alg WD
Alg.T;;/ as the category of Eilenberg–Moore algebras. We intend to
deﬁne an adjunction, so by Proposition 2.5.9, it will be the most con-
venient approach to solve the problem by deﬁning unit and counit, after
the corresponding functors have been identiﬁed.
Lemma 2.5.15 Deﬁne Fa WD hTa; ai for the object a 2 jKj, and if
f W a ! b is a morphism if K, deﬁne Ff WD Tf . Then F W K ! Alg is
a functor.
Proof We have to show that Ff W hTa; ai ! hTb; bi is an algebra
morphism. Since  W T2 ! T is natural, we obtain this commutative
diagram:
But this is just the deﬁning condition for an algebra morphism. a
This statement is trivial:
Lemma 2.5.16 Given an Eilenberg–Moore algebra hx; hi 2 jAlgj, de-
ﬁne G.x; h/ WD x; if f W hx; hi ! hx0; h0i is a morphism in Alg,
put Gf WD f . Then G W Alg ! K is a functor. Moreover, we have
G ı F D T. a
We require two natural transformations, which are deﬁned now and
which are intended to serve as the unit and as the counit, respectively,
for the adjunction. We deﬁne for the unit  the originally given , so that
 W IdK ! G ı F is a natural transformation. The counit " is deﬁned
through "hx;hi WD h, so that "hx;hi W .F ı G/.x; h/ ! IdAlg.x; h/.
This deﬁnes a natural transformation " W F ı G ! IdAlg. In fact,
let f W hx; hi ! hx0; h0i be a morphism in Alg; then—by expanding
deﬁnitions—the diagram on the left-hand side translates to the one on
the right-hand side, which commutes:

192
CHAPTER 2. CATEGORIES
Now take an object a 2 jKj; then
."F ı F/.a/ D "Fa.Fa/ D "hTa;ai.Ta/ D a.Ta/ D idFa:
On the other hand, we have for the algebra hx; hi
.G" ı G/.x; h/ D G"hx;hi.Ghx;hi/ D G"hx;hi.x/ D "hx;hi.x/
D hx
./
D idx D idGhx;hi
where ./ uses that h W Tx ! x is the structure morphism of an algebra.
Taken together, we see that  and " satisfy the requirements of unit and
counit for an adjunction according to Proposition 2.5.9.
Hence we have nearly established:
Proposition 2.5.17 Every monad deﬁnes an adjunction.
The monad
deﬁned by the adjunction is the original one.
Proof We have only to prove the last assertion.
But this is trivial,
because .G"F/a D .G"/hTa; ai D Ga D a. a
Algebras for Discrete Probabilities
We identify now the Eilenberg–
Moore algebras for the functor D, which assigns to each set its discrete
subprobabilities with ﬁnite support; see Example 2.3.11. Some prelimi-
nary and motivating observations are made ﬁrst.
Put
˝ WD fh˛1; : : : ; ˛ki j k 2 N; ˛i  0; Pk
iD1 ˛i  1g
as the set of all positive convex coefﬁcients, and call a subset V of a real
vector space positive convex iff Pk
iD1 ˛i  xi 2 V: for x1; : : : ; xk 2 V ,
h˛1; : : : ; ˛ki 2 ˝. Positive convexity is to be related to subprobabili-
ties: if Pk
iD1 ˛i  xi is perceived as an observation in which item xi is
assigned probability ˛i, then clearly Pk
iD1 ˛i  1 under the assumption
that the observation is incomplete, i.e., that not every possible case has
been observed.
Suppose a set X over which we formulate subprobabilities is embedded
as a positive convex set into a linear space V over R. In this case we
could read off a positive convex combination for an element the proba-
bilities with which the respective components occur.

2.5. ADJUNCTIONS AND ALGEBRAS
193
These observations meet the intuition about positive convexity, but it
has the drawback that we have to look for a linear space V into which
X to embed. It has the additional shortcoming that once we did iden-
tify V , the positive convex structure on X is ﬁxed through the vector
space, but we will see soon that we need ﬂexibility. Consequently, we
propose an abstract description of positive convexity, much in the spirit
of Pumpl¨un’s approach [Pum03]. Thus the essential properties (for us,
that is) of positive convexity are described intrinsically for X without
having to resort to a vector space, leading to the deﬁnition of a positive
convex structure.
Deﬁnition 2.5.18 A positive convex structure p on a set X has for each
˛ D h˛1; : : : ; ˛ni 2 ˝ a map ˛p W Xn ! X which we write as
Pp
˛p.x1; : : : ; xn/ D Pp
1in ˛i  xi;
such that
✩Pp
1in ıi;k xi D xk; where ıi;j is Kronecker’s ı (thus ıi;j D 1
if i D j , and ıi;j D 0; otherwise),
✪the identity
Pp
1in ˛i 
Pp
1km ˇi;k  xk

D Pp
1km
Pp
1in ˛iˇi;k

xk
holds whenever h˛1; : : : ; ˛ni; hˇi;1; : : : ; ˇi;mi 2 ˝; 1  i  n:
Property ✩looks quite trivial, when written down this way. Rephrasing,
it states that the map
hı1;k; : : : ; ın;kip W T n ! T;
which is assigned to the n-tuple hı1;k; : : : ; ın;ki through p acts as the
projection to the kth component for 1  k  n. Similarly, property ✪
may be recoded in a formal but less concise way. Thus we will use
freely the notation from vector spaces, omitting in particular the ex-
plicit reference to the structure whenever possible. Hence simple addi-
tion ˛1  x1 C ˛2  x2 will be written rather than Pp
1i2 ˛i  xi; with
the understanding that it refers to a given positive convex structure p
on X.
It is an easy exercise to establish that for a positive convex structure,
the usual rules for manipulating sums in vector spaces apply, e.g., 1 

194
CHAPTER 2. CATEGORIES
x D x; Pn
iD1 ˛i  xi D Pn
iD1;˛i6D0 ˛i  xi or the law of associativity,
.˛1 x1 C˛2 x2/C˛3 x3 D ˛1 x1 C.˛2 x2 C˛3 x3/: Nevertheless,
care should be observed, for of course not all rules apply: we cannot in
general conclude x D x0 from ˛  x D ˛  x0; even if ˛ 6D 0:
A morphism # W hX1; p1i ! hX2; p2i between positive convex struc-
tures is a map # W X1 ! X2 such that
#
Pp1
1in ˛i  xi

D Pp2
1in ˛i  #.xi/
holds for x1; : : : ; xn 2 X and h˛1; : : : ; ˛ni 2 ˝. In analogy to linear
algebra, # will be called an afﬁne map. Positive convex structures with
their morphisms form a category StrConv.
We need some technical preparations, which are collected in the follow-
ing:
Lemma 2.5.19 Let X and Y be sets.
1. Given a map f W X ! Y , let p D ˛1  ıa1 C : : : C ˛n  ıan
be the linear combination of Dirac measures for x1; : : : ; xn 2 X
with positive convex h˛1; : : : ; ˛ni 2 ˝: Then D.f /.p/ D ˛1 
ıf .x1/ C : : : C ˛n  ıf .xn/:
2. Let p1; : : : ; pn be discrete subprobabilities X, and let M D ˛1 
ıp1 C : : : C ˛n  ıpn be the linear combination of the correspond-
ing Dirac measures in .D ı D/X with positive convex coefﬁcients
h˛1; : : : ; ˛ni 2 ˝: Then X.M/ D ˛1  p1 C : : : C ˛n  pn:
Proof The ﬁrst part follows directly from the observation D.f /.ıx/.B/
D ıx.f 1
B

/ D ıf .x/.B/; and the second one is easily inferred from
the formula for  in Example 2.4.7. a
The algebras are described now without having to resort to DX through
an intrinsic characterization using positive convex structures with afﬁne
maps. This characterization is comparable to the one given by Manes
for the power set monad (which also does not resort explicitly to the
underlying monad or its functor); see Example 2.5.14.
Lemma 2.5.20 Given an algebra hX; hi for D, deﬁne for x1; : : : ; xn 2
X and the positive convex coefﬁcients h˛1; : : : ; ˛ni 2 ˝; put
h˛1; : : : ; ˛nip.x1; : : : ; xn/ WD h
Pn
iD1 ˛i  ıxi

This deﬁnes a positive convex structure p on X:

2.5. ADJUNCTIONS AND ALGEBRAS
195
Proof 1. Write Pn
iD1 ˛i  xi WD h.Pn
iD1 ˛i  ıxi/ for convenience.
Because h
Pn
iD1 ıi;j  ıxi

D h.ıxj / D xj; property ✩in Deﬁni-
tion 2.5.18 is satisﬁed.
2. Proving property ✪, we resort to the properties of an algebra and a
monad:
Pn
iD1 ˛i 
Pm
kD1 ˇi;k  xk

D
h
Pn
iD1 ˛i  ıPm
kD1 ˇi;kxk

(2.2)
D
h
Pn
iD1 ˛i  ıh.
Pm
kD1 ˇi;kıxk/

(2.3)
D
h
Pn
iD1 ˛i  S.h/

ıPm
kD1 ˇi;kıxk

(2.4)
D

h ı S.h/
Pn
iD1 ˛i  ıPm
kD1 ˇi;kıxk

(2.5)
D

h ı X
Pn
iD1 ˛i  ıPm
kD1 ˇi;kıxk

(2.6)
D
h
Pn
iD1 ˛i  X

ıPm
kD1 ˇi;kıxk

(2.7)
D
h
Pn
iD1 ˛i 
Pm
kD1 ˇi;k  ıxk

(2.8)
D
h
Pm
kD1
Pn
iD1 ˛i  ˇi;k

ıxk

(2.9)
D
Pm
kD1
Pn
iD1 ˛i  ˇi;k

xk:
(2.10)
Equations (2.2) and (2.3) reﬂect the deﬁnition of the structure, Eq. (2.4)
applies ıh./ D S.h/.ı/; Eq. (2.5) uses the linearity of S.h/ according
to Lemma 2.5.19, and Eq. (2.6) is due to h being an algebra. Winding
down, Eq. (2.7) uses Lemma 2.5.19 again; this time for X, Eq. (2.8)
uses that X ıı D I Eq. (2.9) is just rearranging terms; and Eq. (2.10)
is the deﬁnition again. a
The converse holds as well, as we will show now.
Lemma 2.5.21 Let p be a positive convex structure on X. Put
h
Pn
iD1 ˛i  ıxi

WD Pp
1in ˛i  xi
for h˛1; : : : ; ˛ni 2 ˝ and x1; : : : ; xn 2 X. Then hX; hi is an algebra.
Proof 0. We show ﬁrst that h is well deﬁned, and then we establish
Outline
that h is an afﬁne map, so that we may interchange the application of h
with summation. Then we apply the elementary properties established
in Lemma 2.5.19 for X W .D ı D/X ! DX to show that the equation
h ı X D idX holds.
1. We ﬁrst check that h is well deﬁned: This is so since
Pn
iD1 ˛i  ıxi D Pm
jD1 ˛0
j  ıx0
j

196
CHAPTER 2. CATEGORIES
implies that
Pn
iD1;˛i6D0 ˛i  ıxi D Pm
jD1;˛0
j 6D0 ˛0
j  ıx0
j I
hence given i with ˛i 6D 0, there exists j with ˛0
j 6D 0 such that xi D x0
j
with ˛i D ˛0
j and vice versa. Consequently,
Pp
1in ˛i  xi
D
p
X
1in;˛i6D0
˛i  xi D
p
X
1jn;˛0
j 6D0
˛0
j  x0
j
D
p
X
1jn
˛0
j  x0
j
is inferred from the properties of positive convex structures. Thus h W
DX ! X.
An easy induction using property ✪shows that h is an afﬁne map, i.e.,
that we have
h
Pn
iD1 ˛i  i

D Pp
1in ˛i  h.i/
(2.11)
for h˛1; : : : ; ˛ni 2 ˝ and 1; : : : ; n 2 DX.
Now let f D Pn
iD1 ˛i  ıi 2 D2X with 1; : : : ; n 2 DX. Then we
obtain from Lemma 2.5.19 that Xf D Pn
iD1 ˛i  i: Consequently,
we obtain from (2.11) that h.Xf / D Pp
1in ˛i  h.i/: On the other
hand, Lemma 2.5.19 implies together with (2.11)
.h ı Dh/f D h
Pp
1in ˛i  .Dh/.i/

D Pp
1in ˛i  h

.Dh/.i/

D Pp
1in ˛i  h.ıh.i //
D Pp
1in ˛i  h.i/;
because h.ıh.i// D h.i/. We infer from ✩that h ı X D idX.
a
Hence we have established:
Proposition 2.5.22 Each positive convex structure on X induces an al-
gebra for DX. a
Summarizing, we obtain a complete characterization of the Eilenberg–
Moore algebras for this monad.

2.6. COALGEBRAS
197
Theorem 2.5.23 The Eilenberg–Moore algebras for the discrete prob-
ability monad are exactly the positive convex structures. a
This characterization carries over to the probabilistic version of the
monad; we leave the simple formulation to the reader. A similar charac-
terization is possible for the continuous version of this functor, at least
in Polish spaces. This requires a continuity condition, however, and is
further discussed in Sect. 4.10.2.
2.6
Coalgebras
A coalgebra for a functor F is characterized by a carrier object c and
by a morphism c ! Fc. This fairly general structure can be found in
many applications, as we will see. So we will ﬁrst deﬁne formally what
a coalgebra is and then provide a gallery of examples, some of them
already discussed in another disguise, some of them new. The common
thread is their formulation as a coalgebra. The fundamental notion of
bisimilarity is introduced, and bisimilar coalgebras will be discussed,
indicating some interesting facets of the possibilities to describe behav-
ioral equivalence of some sorts.
Deﬁnition 2.6.1 Given the endofunctor F on category K, an object a on
K together with a morphism f W a ! Fa is a coalgebra .a; f / for K.
Morphism f is sometimes called the dynamics of the coalgebra, a its
carrier.
Comparing the deﬁnitions of an algebra and a coalgebra, we see that
for a coalgebra, the functor F is an arbitrary endofunctor on K, while
an algebra requires a monad and compatibility with unit and multipli-
cation. Thus coalgebras are conceptually simpler by imposing less con-
straints.
We are going to enter now the gallery of examples and start with coal-
gebras for the power set functor.
This example will be with us for
quite some time, in particular when we will interpret modal logics. A
reﬁnement of this example will be provided by labeled transition sys-
tems.
Example 2.6.2 We consider the category Set of sets with maps as mor-
phisms and the power set functor P. An P-coalgebra consists of a
set A and a map f W A ! P.A/. Hence we have f .a/  A for

198
CHAPTER 2. CATEGORIES
all a 2 A, so that a Set coalgebra can be represented as a relation
fha; bi j b 2 f .a/; a 2 Ag over A. If, conversely, R  A  A is a
relation, then f .a/ WD fb 2 A j ha; bi 2 Rg is a map f W A ! P.A/.
✌
A slight extension is to be observed when we introduce actions, for-
mally captured as labels for our transitions. Here a transition is depen-
dent on an action, which then serves as a label to the corresponding
relation.
Example 2.6.3 Let us interpret a labeled transition system

S;
. a/a2A

over state space S with set A of actions; see Example 2.3.10.
Then  a S  S for all actions a 2 A.
Working again in Set, we deﬁne for the set S and for the map f W S !
T
TS WD P.A  S/;
.Tf /.B/ WD fha; f .x/i j ha; xi 2 Bg
(hence T D P.A  /). Deﬁne f .s/ WD fha; s0i j s  a s0g; thus
f W S ! TS is a morphism in Set. Consequently, a labeled transition
system is interpreted as a coalgebra for the functor P.A  /. ✌
Example 2.6.4 Let A be the inputs, B the outputs, and X the states of
an automaton with output; see Example 2.3.9. Put F WD .  B/A. For
f W X ! Y , we have this commutative diagram:
Let .S; f / be an F-coalgebra; thus f W S ! FS D .S  B/A. Input
a 2 A in state s 2 S yields f .s/.a/ D hs0; bi, so that s0 is the new
state and b is the output. Hence automata with output are perceived as
coalgebras, in this case for the functor .  B/A. ✌
While the automata in Example 2.6.4 are deterministic (and completely
speciﬁed), we can also use a similar approach to modeling nondetermin-
istic automata.

2.6. COALGEBRAS
199
Example 2.6.5 Let A; B; X be as in Example 2.6.4, but take this time
F WD P.  B/A as a functor, so that this diagram commutes for f W
X ! Y :
Thus P.f  B/.D/ D fhf .x/; bi 2 Y  B j hx; bi 2 Bg. Then .S; g/
is an F coalgebra iff input a 2 A in state s 2 S gives g.s/.a/ 2 S  B
as the set of possible new states and outputs.
As a variant, we can replace P.  B/ by Pf .  B/, so that the
automaton presents only a ﬁnite number of alternatives. ✌
Binary trees may be modeled through coalgebras as well:
Example 2.6.6 Put FX WD fg C X  X, where  is a new symbol. If
f W X ! Y , put
F.f /.t/ WD
(
;
if t D 
hx1; x2i;
if t D hx1; x2i:
Then F is an endofunctor on Set. Let .S; f / be an F-coalgebra, then
f .s/ 2 fg C S  S. This is interpreted that s is a leaf iff f .s/ D  and
an inner node with offsprings hs1; s2i, if f .s/ D hs1; s2i. Thus such a
coalgebra represents a binary tree (which may be of inﬁnite depth). ✌
The following example shows that probabilistic transitions may also be
modeled as coalgebras.
Example 2.6.7 Working in the category Meas of measurable spaces
with measurable maps, we have introduced in Example 2.4.8 the sub-
probability functor S as an endofunctor on Meas.
Let .X; K/ be a
coalgebra for S (we omit here the -algebra from the notation); then
K W X ! SX is measurable, so that:
1. K.x/ is a subprobability on (the measurable sets of) X,
2. for each measurable set D  X, the map x 7! K.x/.D/ is mea-
surable,
See Example 2.1.14 and Exercise 2.7. Thus K is a subprobabilistic
transition kernel (or a stochastic relation) on X. ✌

200
CHAPTER 2. CATEGORIES
Let us have a look at the upper closed sets introduced in Example 2.3.13.
Coalgebras for this functor will be used for an interpretation of games;
see Example 2.7.22.
Example 2.6.8 Let VS WD fV  PS j V is upper closedg. This func-
tor has been studied in Example 2.3.13. A coalgebra .S; f / for V is
a map f W S ! VS, so that f .s/  P.S/ is upper closed; hence
A 2 f .s/ and B 	 A imply B 2 f .s/ for each s 2 S. We interpret
f .s/ as the collection of all sets of states a player has a strategy to reach
in state s, so that if the player can reach A and A  B, then the player
certainly can reach B.
V is the basis for neighborhood models in modal logics; see, e.g.,
[Che89, Ven07] and page 232. ✌
It is natural to ask for morphisms of coalgebras, which relate coalgebras
to each other. This is a fairly straightforward deﬁnition.
Deﬁnition 2.6.9 Let F be an endofunctor on category K, then t W .a; f /
! .b; g/ is a coalgebra morphism for the F-coalgebras .a; f / and
.b; g/ iff t W a ! b is a morphism in K such that g ı t D F.t/ ı f .
Thus t W .a; f / ! .b; g/ is a coalgebra morphism iff t W a ! b is a
morphism so that this diagram commutes:
It is clear that F-coalgebras form a category with coalgebra morphisms
as morphisms. We reconsider some previously discussed examples and
shed some light on the morphisms for these coalgebras.
Example 2.6.10 Continuing Example 2.6.6 on binary trees, let r W
.S; f / ! .T; g/ be a morphism for the F-coalgebras .S; f / and .T; g/.
Thus g ı r D F.r/ ı f . This entails:
1. f .s/ D , then g.r.s// D .Fr/.f .s// D  (thus s is a leaf iff
r.s/ is one),
2. f .s/ D hs1; s2i, then g.r.s// D ht1; t2i with t1 D r.s1/ and
t2 D r.s2/ (thus r.s/ branches out to hr.s1/; r.s2/i, provided s
branches out to hs1; s2i).
A coalgebra morphism preserves the tree structure. ✌

2.6. COALGEBRAS
201
Example 2.6.11 Continuing the discussion of deterministic automata
with output from Example 2.6.4, let .S; f / and .T; g/ be F-coalgebras
and r W .S; F / ! .T; g/ be a morphism.
Given state s 2 S, let
f .s/.a/ D hs0; bi be the new state and the output, respectively, after
input a 2 A for automaton .S; f /. Then g.r.s//.a/ D hr.s0/; bi, so
after input a 2 A, the automaton .T; g/ will be in state r.s/ and give the
output b, as expected. Hence coalgebra morphisms preserve the work-
ing of the automata. ✌
Example 2.6.12 Continuing the discussion of transition systems from
Example 2.6.3, let .S; f / and .T; g/ be labeled transition systems with
A as the set of actions. Thus a transition from s to s0 on action a is given
in .S; f / iff ha; s0i 2 f .s/. Let us just for convenience write s  a;S s0
iff this is the case; similarly, we write t  a;T t0 iff t; t0 2 T with
ha; t0i 2 g.t/.
Now let r W .S; f / ! .T; g/ be a coalgebra morphism. We claim
that for given s 2 S, we have a transition r.s/  a;T t0 for some t0
iff we can ﬁnd s0 such that s  a;S s0 and r.s0/ D t0. Because r W
.S; f / ! .T; g/ is a coalgebra morphism, we have g ı r D .Tr/ ı f
with T D P.A  /. Thus
g.r.s// D P.A  r/.s/ D fha; r.s0/i j ha; s0i 2 f .s/g:
Consequently,
r.s/  a;T t0 , ha; t0i 2 g.r.s//
, ha; t0i D ha; r.s0/i for some ha; s0i 2 f .s/
, s  a;S s0 for some s0 with r.s0/ D t0
This means that the transitions in .T; g/ are essentially controlled by
the morphism r and the transitions in .S; f /. Hence a coalgebra mor-
phism between transition systems is a bounded morphism in the sense
of Example 2.1.10. ✌
Example 2.6.13 We continue the discussion of upper closed sets from
Example 2.6.8. Let .S; f / and .T; g/ be V-coalgebras, so this diagram
is commutative for morphism r W .S; F / ! .T; g/:

202
CHAPTER 2. CATEGORIES
Consequently, W 2 g.r.s// iff r1
W

2 f .s/. Taking up the interpre-
tation of sets of states which may be achieved by a player, we see that
it1 may achieve W in state r.s/ in .T; g/ iff it may achieve in .S; f / the
set r1
W

in state s. ✌
2.6.1
Bisimulations
The notion of bisimilarity is fundamental for the application of coal-
gebras to system modeling. Bisimilar coalgebras behave in a similar
fashion, witnessed by a mediating system.
Deﬁnition 2.6.14 Let F be an endofunctor on a category K. The F-
coalgebras .S; f / and .T; g/ are said to be bisimilar iff there exists a
coalgebra .M; m/ and coalgebra morphisms (S f)
(M m)
(T g).
The coalgebra .M; m/ is called mediating.
Thus we obtain this characteristic diagram with ` and r as the corre-
sponding morphisms.
This gives us f ı ` D .F`/ ı m and together with g ı r D .Fr/ ı m: It
is easy to see why .M; m/ is called mediating.
Bisimilarity was originally investigated when concurrent systems be-
came of interest. The original formulation, however, was not coalge-
braic but rather relational. Here it is:
Deﬁnition 2.6.15 Let .S;  S/ and .T;  T / be transition systems.
Then B  S  T is called a bisimulation iff for all hs; ti 2 B these
conditions are satisﬁed:
1. if s  S s0, then there is a t0 2 T such that t  T t0 and hs0; t0i 2
B,
1The present author is not really sure about the players’ gender—players are con-
sidered female in the overwhelming majority of papers in the literature, but addressed
as Angel or Demon. This may be politically correct, but does not seem to be biblically
so with a view toward Matthew 22:30. To be on the safe side, players are neutral in the
present treatise.

2.6. COALGEBRAS
203
2. if t  T t0, then there is a s0 2 S such that s  S s0 and hs0; t0i 2
B.
Hence a bisimulation simulates transitions in one system through the
other one. On ﬁrst sight, these notions of bisimilarity are not related to
each other. Recall that transition systems are coalgebras for the power
set functor P. This is the connection:
Theorem 2.6.16 Given the transition systems .S;  S/ and .T;  T /
with the associated P-coalgebras .S; f / and .T; g/, then these state-
ments are equivalent for B  S  T :
1. B is a bisimulation.
2. There exists a P-coalgebra structure h on B
such that
with the projections as morphisms is
mediating.
Proof That
is mediating follows from commu-
tativity of this diagram:
1
)
2: We have to construct a map h W B ! P.B/ such that
f .S.s; t// D P.S/.h.s; t// and f .T .s; t// D P.T /.h.s; t// for
all hs; ti 2 B.
The choice is somewhat obvious: put for hs; ti 2
B
h.s; t/ WD fhs0; t0i 2 B j s  S s0; t  T t0g:
Thus h W B ! P.B/ is a map; hence .B; h/ is a P-coalgebra.
Now ﬁx hs; ti 2 B; then we claim that f .s/ D P.S/.h.s; t//:
“”: Let s0 2 f .s/; hence s  S s0; thus there exists t0 with hs0; t0i 2
B such that t  T t0; hence
s0 2 fS.s0; t0/ j hs0; t0i 2 h.s; t/g
D fs0 j hs0; t0i 2 h.s; t/ for some t0g
D P.S/.h.s; t//:
“	”: If s0 2 P.S/.h.s; t//, then in particular s  S s0; thus s0 2
f .s/.

204
CHAPTER 2. CATEGORIES
Thus we have shown that P.S/.h.s; t// D f .s/ D f .S.s; t//. One
shows P.T /.h.s; t// D g.t/ D f .T .s; t// in exactly the same way.
We have constructed h such that .B; h/ is a P-coalgebra and such that
the diagrams above commute.
2 ) 1: Assume that h exists with the properties described in the asser-
tion; then we have to show that B is a bisimulation. Now let hs; ti 2 B
and s  S s0; hence s0 2 f .s/ D f .S.s; t// D P.S/.h.s; t//. Thus
there exists t0 with hs0; t0i 2 h.s; t/  B, and hence hs0; t0i 2 B. We
claim that t  T t0, which is tantamount to saying t0 2 g.t/. But g.t/ D
P.T /.h.s; t//, and hs0; t0i 2 h.s; t/; hence t0 2 P.T /.h.s; t// D
g.t/.
This establishes t  T t0.
A similar argument ﬁnds s0 with
s  S s0 with hs0; t0i 2 B in case t  T t0.
This completes the proof. a
Thus we may use bisimulations for transition systems as relations and
bisimulations as coalgebras interchangeably, and this characterization
suggests a deﬁnition in purely coalgebraic terms for those cases in which
a set-theoretic relation is not available or not adequate. The connection
to P-coalgebra morphisms and bisimulations is further strengthened by
investigating the graph of a morphism (recall that the graph of a map
graph.r/
r W S ! T is the relation graph.r/ WD fhs; r.s/i j s 2 Sg).
Proposition 2.6.17 Given coalgebras .S; f / and .T; g/ for the power
set functor P, r W .S; f / ! .T; g/ is a morphism iff graph.r/ is a
bisimulation for .S; f / and .T; g/.
Proof 1. Assume that r W .S; f / ! .T; g/ is a morphism, so that
g ı r D P.r/ ı f . Now deﬁne
h.s; t/ WD fhs0; r.s0/i j s0 2 f .s/g  graph.r/
for hs; ti 2 graph.r/. Then g.T .s; t// D g.t/ D P.T /.h.s; t// for
t D r.s/.
“”: If t0 2 g.t/ for t D r.s/, then
t0 2 g.r.s//
D P.r/.f .s// D fr.s0/ j s0 2 f .s/g
D P.T /.fhs0; r.s0/i j s0 2 f .s/g/
D P.T /.h.s; t//
“	”: If hs0; t0i 2 h.s; t/, then s0 2 f .s/ and t0 D r.s0/, but this implies
t0 2 P.r/.f .s// D g.r.s//:

2.6. COALGEBRAS
205
Thus g ı T D P.T / ı h. The equation f ı S D P.S/ ı h is
established similarly.
Hence we have found a coalgebra structure h on graph.r/ such that
are coalgebra morphisms, so that .graph.r/; h/ is now ofﬁcially a bisim-
ulation.
2. If, conversely, .graph.r/; h/ is a bisimulation with the projections as
morphisms, then we have r D T ı 1
S . Then T is a morphism, and
1
S
is a morphism as well (note that we work on the graph of r). So r
is a morphism. a
Let us have a look at upper closed sets from Example 2.4.10. There we
ﬁnd a comparable situation. We cannot, however, translate the deﬁnition
directly, because we do not have access to the transitions proper, but
rather to the sets from which the next state may come from. Let .S; f /
and .T; g/ be V-coalgebras, and assume that hs; ti 2 B. Assume X 2
f .s/; then we want to ﬁnd Y 2 g.t/ such that, when we take t0 2 Y ,
we ﬁnd a state s0 2 X with s0 being related via B to s0, and vice versa.
Formally:
Deﬁnition 2.6.18 Let
VS WD fV  P.S/ j V is upper closedg
be the endofunctor on Set which assigns to set S all upper closed subsets
of PS. Given V-coalgebras .S; f / and .T; g/, a subset B  S  T is
called a bisimulation of .S; f / and .T; g/ iff for each hs; ti 2 B
1. for all X 2 f .s/, there exists Y 2 g.t/ such that for each t0 2 Y ,
there exists s0 2 X with hs0; t0i 2 B,
2. for all Y 2 g.t/, there exists X 2 f .s/ such that for each s0 2 X,
there exists t0 2 Y with hs0; t0i 2 B.
We have then a comparable characterization of bisimilar coalgebras.
Proposition 2.6.19 Let .S; f / and .T; g/ be coalgebras for V. Then the
following statements are equivalent for B  S  T with S

B

D S
and T

B

D T
1. B is a bisimulation of .S; f / and .T; g/.

206
CHAPTER 2. CATEGORIES
2. There exists a coalgebra structure h on B so that the projections
S
W
B
!
S; T
W
B
!
T
are morphisms
.
Proof 1 ) 2: Deﬁne hs; ti 2 B
h.s; t/ WD fD  B j S

D

2 f .s/ and T

D

2 f .t/g:
Hence h.s; t/  P .S/, and because both f .s/ and g.t/ are upper
closed, so is h.s; t/.
Now ﬁx hs; ti 2 B. We show ﬁrst that f .s/ D fS

Z

j Z 2 h.s; t/g:
From the deﬁnition of h.s; t/, it follows that S

Z

2 f .s/ for each
Z 2 h.s; t/. So we have to establish the other inclusion. Let X 2 f .s/;
then X D S

1
S

X

; because S W B ! S is onto, so it sufﬁces
to show that 1
S

X

2 h.s; t/ hence that T

1
S

X

2 g.t/: Given
X, there exists Y 2 g.t/ so that for each t0 2 Y , there exists s0 2 X
such that hs0; t0i 2 B. Thus Y D T

.X  Y / \ B

: But this implies
Y  T

1
S

X

I hence Y  T

1
S

X

2 g.t/: One similarly
shows that g.t/ D fT

Z

j Z 2 h.s; t/g.
In a second step, we show that
fS

Z

j Z 2 h.s; t/g D fC j 1
S

C

2 h.s; t/g:
In fact, if C D S

Z

for some Z 2 h.s; t/, then Z  1
S

C

D
1
S

S

Z

; hence 1
S

C

2 h.s; t/. If, conversely, Z WD 1
S

C

2
h.s; t/, then C D S

Z

. Thus we obtain
f .s/ D fS

Z

j Z 2 h.s; t/g D fC j 1
S

C

2 h.s; t/g
D .VS/.h.s; t//
for hs; ti 2 B. Summarizing, this means that S W .B; h/ ! .S; f / is
a morphism. A very similar argumentation shows that T W .B; h/ !
.T; g/ is a morphism as well.
2 ) 1: Assume, conversely, that the projections are coalgebra mor-
phisms, and let hs; ti 2 B. Given X 2 f .s/, we know that X D S

Z

for some Z 2 h.s; t/. Thus we ﬁnd for any t0 2 Y some s0 2 X with
hs0; t0i 2 B. The symmetric property of a bisimulation is established ex-
actly in the same way. Hence B is a bisimulation for .S; f / and .T; g/.
a

2.6. COALGEBRAS
207
Encouraged by these observations, we deﬁne bisimulations for set- based
functors, i.e., for endofunctors on the category Set of sets with maps as
morphisms. This is nothing but a specialization of the general notion
of bisimilarity, taking speciﬁcally into account that in Set we may con-
sider subsets of the Cartesian product and that we have projections at
our disposal.
Deﬁnition 2.6.20 Let F be an endofunctor on Set. Then R  S  T
is called a bisimulation for the F-coalgebras .S; f / and .T; g/ iff there
exists a map h W R ! F.R/ rendering this diagram commutative:
These are immediate consequences:
Lemma 2.6.21 S WD fhs; si j s 2 Sg is a bisimulation for every F-
coalgebra .S; f /. If R is a bisimulation for the F-coalgebras .S; f /
and .T; g/, then R1 is a bisimulation for .T; g/ and .S; f /. a
It is instructive to look back and investigate again the graph of a mor-
phism r W .S; f / ! .T; g/, where this time we do not have the power
set functor—as in Proposition 2.6.17—but a general endofunctor F on
Set.
Corollary 2.6.22 Given coalgebras .S; f / and .T; g/ for the endofunc-
tor F on Set, r W .S; f / ! .T; g/ is a morphism iff graph.r/ is a bisim-
ulation for .S; f / and .T; g/.
Proof 0. The proof for Proposition 2.6.17 needs some small adjust-
ments, because we do not know how exactly functor F is operating on
maps.
1. If r W .S; f / ! .T; g/ is a morphism, we know that gır D F.r/ıf .
Consider the map  W S ! S  T which is deﬁned as s 7! hs; r.s/i,
thus F./ W F.S/ ! F.S  T /. Deﬁne
h W
(
graph.r/
! F.graph.r//
hs; r.s/i
7! F./.f .s//
Then it is not difﬁcult to see that both g ı T D F.T / ı h and f ı
S D F.S/ıh hold. Hence .graph.r/; h/ is an F-coalgebra mediating
between .S; f / and .T; g/.

208
CHAPTER 2. CATEGORIES
2. Assume that graph.r/ is a bisimulation for .S; f / and .T; g/, then
both T and 1
S
are morphisms for the F-coalgebras, so the proof pro-
ceeds exactly as the corresponding one for Proposition 2.6.17. a
We will study some properties of bisimulations now, including a preser-
vation property of functor F W Set ! Set. This functor will be ﬁxed for
the time being.
We may construct bisimulations from morphisms. This is what we show
ﬁrst.
Lemma 2.6.23 Let .S; f /, .T; g/, and .U; h/ be F-coalgebras with
morphisms ' W .S; f / ! .T; g/ and  W .S; f / ! .U; h/. Then
the image of S under '   ,
h';  iŒS WD fh'.s/;  .s/i j s 2 Sg
is a bisimulation for .T; g/ and .U; h/.
Proof 1. Look at this diagram:
Here j.s/ WD h'.s/;  .s/i; hence j W S ! h';  iŒS is surjective. We
can ﬁnd a map i W h';  iŒS ! S so that j ı i D idh'; iŒS using
the Axiom of Choice: For each r 2 h';  iŒS, there exists at least one
s 2 S with r D h'.s/;  .s/i. Pick for each r such an s and call it i.r/;
thus r D h'.i.r//;  .i.r//i. So we have a left inverse to j , which will
help us in the construction below.
2. We want to deﬁne a coalgebra structure for h';  iŒS such that the
diagram below commutes, i.e., forms a bisimulation diagram. Put k WD
F.j / ı f ı i; then we have

2.6. COALGEBRAS
209
Now
F.T / ı k D F.T / ı F.j / ı f ı i
D F.T ı j / ı f ı i
D F.'/ ı f ı i
(since T ı j D ')
D g ı ' ı i
(since F.'/ ı f D g ı ')
D g ı T
Hence the left-hand diagram commutes. Similarly
F.U / ı k D F.U ı j / ı f ı i D F. / ı f ı i D h ı  ı i D h ı U
Thus we obtain a commutative diagram on the right-hand side as well.
a
This technical result is applied to the composition of relations:
Lemma 2.6.24 Let R  S  T and Q  T  U be relations, and put
X WD fhs; t; ui j hs; ti 2 R; ht; ui 2 Qg. Then
R ı Q D hS ı R; U ı QiŒX:
Proof Simply trace an element of RıQ through this construction:
hs; ui 2 R , 9t 2 T W hs; ti 2 R; ht; ui 2 Q
, 9t 2 T W hs; t; ui 2 X
, 9t 2 T W s D .S ı R/.s; t; u/
and u D .U ı Q/.s; t; u/:
a
Looking at X in its relation to the projections, we see that X is actually
a weak pullback (Deﬁnition 2.2.18), to be precise:
Lemma 2.6.25 Let R; Q; X be as above; then X is a weak pullback of
R
T W R ! T and Q
T W Q ! T , so that in particular Q
T ı Q D
R
T ı R.
Proof 1. We establish ﬁrst that this diagram

210
CHAPTER 2. CATEGORIES
commutes. In fact, given hs; t; ui 2 X, we know that hs; ti 2 R and
ht; ui 2 Q; hence .Q
T ı Q/.s; t; u/ D Q
T .t; u/ D t and .R
T ı
R/.s; t; u/ D R
T .s; t/ D t.
2. Now for the pullback property in its weak form. If f1 W Y ! R
and f2 W Y ! Q are maps for some set Y such that R
T ı f1 D
R
T ı f2, we can write f1.y/ D hf S
1 .y/; f T
2 .y/i 2 R and f2.y/ D
hf T
2 .y/; f U
2 .y/i
2
Q.
Put
.y/
WD
hf S
1 .y/; f T
2 .y/;
f U
2 .y/i, then  W Y ! X with f1 D R ı  and f2 D q ı .
Thus X is a weak pullback. a
It will turn out that the functor should preserve the pullback property.
Preserving the uniqueness property of a pullback will be too strong a
requirement, but preserving weak pullbacks will be helpful and not too
restrictive.
Deﬁnition 2.6.26 Functor F preserves weak pullbacks iff F maps weak
pullbacks to weak pullbacks.
Take a weak pullback diagram; then
We want to show that the composition of bisimulations is a bisimulation
again: this requires that the functor preserves weak pullbacks. Before
we state and prove a corresponding property, we need an auxiliary state-
ment which is of independent interest, viz., that the weak pullback of
bisimulations forms a bisimulation again. To be speciﬁc:
Lemma 2.6.27 Assume that functor F preserves weak pullbacks, and
let r W .S; f / ! .T; g/ and s W .U; h/ ! .T; g/ be morphisms for the
F-coalgebras .S; f /, .T; g/, and .U; h/. Then there exists a coalgebra
structure p W P ! FP for the weak pullback P of r and s with pro-
jections S and T such that .P; p/ is a bisimulation for .S; f / and
.U; h/.

2.6. COALGEBRAS
211
Proof We will need these diagrams:
(2.12)
(2.13)
(2.14)
While the ﬁrst two diagrams are helping with the proof’s argument, the
third diagram has a gap in the middle; this is this gap which we have
to ﬁll. We want to ﬁnd an arrow P ! FP so that the diagrams will
commute. Actually, the weak pullback will help us obtain this informa-
Plan
tion.
Because
F.r/ ı f ı S D g ı r ı S
(diagram 2.12, left)
D g ı s ı U
(diagram 2.13)
D F.s/ ı h ı U
(diagram 2.12, right)
we may conclude that F.r/ ı f ı S D F.s/ ı h ı U . Diagram 2.13
is a pullback diagram. Because F preserves weak pullbacks, this dia-
gram can be complemented by an arrow P ! FP rendering the upper
triangles commutative.
Hence there exists p W P ! FP with F.S/ ı p D f ı S and
F.U / ı p D h ı U . Thus p makes diagram (2.14) a bisimulation
diagram. a

212
CHAPTER 2. CATEGORIES
Now we are in a position to show that the composition of bisimulations
is a bisimulation again, provided the functor F behaves decently.
Proposition 2.6.28 Given the F-coalgebras .S; f /, .T; g/, and .U; h/,
assume that R is a bisimulation of .S; f / and .T; g/ and Q is a bisimu-
lation of .T; g/ and .U; h/, and assume moreover that F preserves weak
pullbacks. Then R ı Q is a bisimulation of .S; f / and .U; h/.
Proof We can write R ı Q D hS ı R; U ı QiŒX with X WD
fhs; t; ui j hs; ti 2 R; ht; ui 2 Qg: Since X is a weak pullback of
R
T and Q
T by Lemma 2.6.25, we know that X is a bisimulation of
.R; r/ and .Q; q/, with r and q as the dynamics of the corresponding
F-coalgebras. S ıR W X ! S and U ıQ W X ! U are morphisms;
thus hS ı R; U ı QiŒX is a bisimulation, since X is a weak pull-
back. Thus the assertion follows from Lemma 2.6.24. a
The proof shows in which way the existence of the morphism P ! FP
is used for achieving the desired properties.
Bisimulations on a single coalgebra may have an additional structure,
viz., they may be equivalence relations as well. Accordingly, we call
these bisimulations bisimulation equivalences. Hence given a coalge-
Bisimulation
equivalence
bra .S; f /, a bisimulation equivalence ˛ for .S; f / is a bisimulation
for .S; f / which is also an equivalence relation. While bisimulations
carry properties which are concerned with the coalgebraic structure, an
equivalence relation is purely related to the set structure. It is, however,
fairly natural to ask in view of the properties which we did explore so far
(Lemma 2.6.21, Proposition 2.6.28) whether or not we can take a bisim-
ulation and turn it into an equivalence relation, or at least do so under
favorable conditions on functor F. We will deal with this question and
some of its cousins now.
Observe ﬁrst that the factor space of a bisimulation equivalence can be
turned into a coalgebra.
Lemma 2.6.29 Let .S; f / be an F-coalgebra and ˛ be a bisimula-
tion equivalence on .S; f /. Then there exists a unique dynamics ˛R W
S=˛ ! F.S=˛/ with F.˛/ ı f D ˛R ı ˛.
Proof Because ˛ is in particular a bisimulation, we know that there
exists by Theorem 2.6.16 a dynamics  W ˛ ! F.˛/ rendering this

2.6. COALGEBRAS
213
diagram commutative:
The obvious choice for the dynamics ˛R would be to deﬁne ˛R.Œs˛/ WD
.F.˛/ ı f /.s/, but this is only possible if we know that the map is well
Outline
deﬁned, so we have to check whether .F.˛/ıf /.s1/ D .F.˛/ıf /.s2/
holds, whenever s1 ˛ s2.
But this holds indeed, for s1 ˛ s2 means hs1; s2i 2 ˛, so that f .s1/ D
f ..1/
S .s1; s2// D .F..1/
S / ı /.s1; s2/, similarly for f .s2/. Because ˛
is an equivalence relation, we have ˛ ı .1/
S
D ˛ ı .2/
S . Thus
F.˛/.f .s1// D

F.˛ ı .1/
S / ı 

.s1; s2/
D

F.˛ ı .2/
S / ı 

.s1; s2/
D F.˛/.f .s2//
This means that ˛R is in fact well deﬁned and that ˛ is a morphism.
Hence the dynamics ˛R exists and renders ˛ a morphism.
Now assume that ˇR W S=˛ ! F.S=˛/ satisﬁes also F.˛/ ı f D
ˇR ı ˛. But then ˇR ı ˛ D F.˛/ ı f D ˛R ı ˛; and, since ˛
is onto, it is an epi, so that we may conclude ˇR D ˛R. Hence ˛R is
uniquely determined. a
Bisimulations can be transported along morphisms, if the functor pre-
serves weak pullbacks.
Proposition 2.6.30 Assume that F preserves weak pullbacks, and let
r W .S; f / ! .T; g/ be a morphism. Then:
1. If R is a bisimulation on .S; f /, then .r  r/

R

D fhr.s/; r.s0/i j
hs; s0i 2 Rg is a bisimulation on .T; g/.
2. If Q is a bisimulation on .T; g/, then .r  r/1
Q

D fhs; s0i j
hr.r/; r.s0/i 2 Qg is a bisimulation on .S; f /.
Proof 0. Note that graph.r/ is a bisimulation by Corollary 2.6.22, be-
cause r is a morphism.

214
CHAPTER 2. CATEGORIES
1. We claim that
.r  r/

R

D

graph.r/
1 ı R ı graph.r/
holds.
Granted that, we can apply Proposition 2.6.28 together with
Lemma 2.6.21 for establishing the ﬁrst property. But ht; t0i 2 .r  r/

R

iff we can ﬁnd hs; s0i 2 R with ht; t0i D hr.s/; r.s0/i; hence hr.s/; si 2
graph.r/1,
hs; s0i
2
R
and
hs0; r.s0/i
2
graph.r/, hence iff ht; t0i 2 graph.r/1ıRıgraph.r/. Thus the equality
holds indeed.
2. Similarly, we show that .r  r/1
Q

D graph.r/ ı R ı graph.r/1.
This is left to the reader. a
For investigating further structural properties, we need:
Lemma 2.6.31 If .S; f / and .T; g/ are F-coalgebras, then there exists
a unique coalgebraic structure on S C T such that the injections iS and
iT are morphisms.
Proof We have to ﬁnd a morphism S C T ! F.S C T / such that this
diagram is commutative
Because F.iS/ ı f W S ! F.S C T / and F.iT / ı g W T ! F.S C T /
are morphisms, there exists a unique morphism h W S CT ! F.S CT /
with h ı iS D F.iS/ ı f and h ı iT D F.iT / ı g. Thus .S C T; h/ is a
coalgebra, and iS and iT are morphisms. a
The attempt to establish a comparable property for the product could not
work with the universal property for products, as a look at the diagram
for the universal property of the product will show.
We obtain as a consequence that bisimulations are closed under ﬁnite
unions.
Lemma 2.6.32 Let .S; f / and .T; g/ be coalgebras with bisimulations
R1 and R2. Then R1 [ R2 is a bisimulation.
Proof 1. We can ﬁnd morphisms ri W Ri ! FRi for i D 1; 2 rendering
the corresponding bisimulation diagrams commutative. Then R1 C R2

2.6. COALGEBRAS
215
is an F-coalgebra with
as commuting diagram, where ji W Ri ! R1 C R2 is the respective
embedding, i D 1; 2.
2. We claim that the projections 0
S W R1 C R2 ! S and 0
T W R1 C
R2 ! T are morphisms. We establish this property only for 0
S. First
note that 0
S ıj1 D R1
S , so that we have f ı0
S ıj1 D F.0
S/ıF.j1/ı
r1 D F.0
S/ırıj1; similarly, f ı0
S ıj2 D F.0
S/ırıj2: Thus we may
conclude that f ı 0
S D F.0
S/ ı r, so that indeed 0
S W R1 C R2 ! S
is a morphism.
3. Since R1 C R2 is a coalgebra, we know from Lemma 2.6.23 that
h0
S; 0
T iŒR1 CR2 is a bisimulation. But this equals R1 [R2. a
We brieﬂy explore lattice properties for bisimulations on a coalgebra.
For this, we investigate the union of an arbitrary family of bisimulations.
Looking back at the union of two bisimulations, we used their sum as
an intermediate construction. A more general consideration requires
the sum of an arbitrary family. The following deﬁnition describes the
coproduct as a speciﬁc form of a colimit; see Deﬁnition 2.3.32.
Deﬁnition 2.6.33 Let .sk/k2I be an arbitrary nonempty family of ob-
jects on a category K. The object s together with morphisms ik W sk ! s
is called the coproduct of .sk/k2I iff given morphisms jk W sk ! t for
an object t there exists a unique morphism j W s ! t with jk D j ı ik
for all k 2 I. s is denoted as P
k2I sk.
Taking I D f1; 2g, one sees that the coproduct of two objects is in fact a
special case of the coproduct just deﬁned. The following diagram gives
a general idea:
The coproduct is uniquely determined up to isomorphisms.

216
CHAPTER 2. CATEGORIES
Example 2.6.34 Consider the category Set of sets with maps as mor-
phisms, and let .Sk/k2I be a family of sets. Then
S WD
[
k2I
fhs; ki j s 2 Skg
is a coproduct. In fact, ik W s 7! hs; ki maps Sk to S, and if jk W Sk !
T , put j W S ! T with j.s; k/ WD jk.s/; then jk D j ı ik for all k. ✌
We put this new machinery to use right away, returning to our scenario
given by functor F.
Proposition 2.6.35 Assume that F preserves weak pullbacks.
Let
.Rk/k2I be a family of bisimulations for coalgebras .S; f / and .T; g/.
Then S
k2I Rk is a bisimulation for these coalgebras.
Proof 1. Given k 2 I, let rk W Rk ! FRk be the morphism on Rk such
that S;k W .S; f / ! .Rk; rk/ and T;k W .T; g/ ! .Rk; rk/ are mor-
phisms for the coalgebras involved. Then there exists a unique coalgebra
structure r on P
k2I Rk such that i` W .R`; r`/ ! .P
k2I Rk; r/ is a
coalgebra structure for all ` 2 I. This is shown exactly through the same
argument as in the proof of Lemma 2.6.32 (mutatis mutandis: replace
the coproduct of two bisimulations by the general coproduct).
2. The projections 0
S W P
k2I Rk ! S and 0
T W P
k2I Rk ! T
are morphisms, and one shows exactly as in the proof of Lemma 2.6.32
that
[
k2I
Rk D h0
S; 0
T iŒ
X
k2I
Rk:
An application of Lemma 2.6.23 now establishes the claim. a
This is applied to an investigation of the lattice structure on the set of all
bisimulations between coalgebras.
Proposition 2.6.36 Assume that F preserves weak pullbacks.
Let
.Rk/k2I be a nonempty family of bisimulations for coalgebras .S; f /
and .T; g/. Then:
1. There exists a smallest bisimulation R with Rk  R for all k.
2. There exists a largest bisimulation R with Rk 	 R for all k.
Proof 1. We claim that R D S
k2I Rk. It is clear that Rk  R for all
k 2 I. If R0 is a bisimulation on .S; f / and .T; g/ with Rk  R0 for all

2.6. COALGEBRAS
217
k, then S
k Rk  R0; thus R  R0. In addition, R is a bisimulation
by Proposition 2.6.35. This establishes part 1.
2. Put
R WD fR j R is a bisimulation for .S; f / and .T; g/
with R  Rk for all kg
If R D ;, we put R WD ;, so we may assume that R 6D ;. Put
R WD S R. By Proposition 2.6.35, this is a bisimulation for .S; f /
and .T; g/ with Rk  R for all k. Assume that R0 is a bisimulation for
.S; f / and .T; g/ with R0  Rk for all k; then R0 2 R; hence R0  R,
so R is the largest one. This settles part 2. a
Looking a bit harder at bisimulations for .S; f / alone, we ﬁnd that the
largest bisimulation is actually an equivalence relation. But we have to
make sure ﬁrst that a largest bisimulation exists at all.
Proposition 2.6.37 If functor F preserves weak pullbacks, then there
exists a largest bisimulation R on coalgebra .S; f /. R is an equiva-
lence relation.
Proof 1. Let
R WD fR j R is a bisimulation on .S; f /g:
Then S 2 R; hence R 6D ;. We know from Lemma 2.6.21 that
R 2 R entails R1 2 R, and from Proposition 2.6.35, we infer that
R WD S R 2 R. Hence R is a bisimulation on .S; f /.
2. We use the characterization of the inﬁmum as the supremum of the
Idea
lower bounds. R is even an equivalence relation.
 Since S 2 R, we know that S  R; thus R is reﬂexive.
 Because R 2 R, we conclude that .R/1 2 R; thus .R/1 
R. Hence R is symmetric.
 Since R 2 R, we conclude from Proposition 2.6.28 that R ı
R 2 R; hence R ı R  R. This means that R is transitive.
a
This has an interesting consequence. Given a bisimulation equivalence
on a coalgebra, we do not only ﬁnd a larger one which contains it, but

218
CHAPTER 2. CATEGORIES
we can also ﬁnd a morphism between the corresponding factor spaces.
This is what I mean:
Corollary 2.6.38 Assume that functor F preserves weak pullbacks and
that ˛ is a bisimulation equivalence on .S; f /; then there exists a unique
morphism #˛ W .S=˛; f˛/ ! .S=R; fR/; where f˛ W S=˛ ! F.S=˛/
and fR W S=R ! F.S=R/ are the induced dynamics.
Proof 0. The dynamics f˛ W S=˛ ! F.S=˛/ and fR W S=R !
F.S=R/ exist by the deﬁnition of a bisimulation.
1. Deﬁne
#.Œs˛/ WD ŒsR
for s 2 S. This is well deﬁned. In fact, if s ˛ s0, we conclude by
the maximality of R that s R s0, so Œs˛ D Œs0˛ implies ŒsR D
Œs0R.
2. We claim that #˛ is a morphism, hence that the right-hand side of
this diagram commutes; the left-hand side of the diagram is just for
nostalgia.
Now #˛ ı˛ D R, and the outer diagram commutes. The left diagram
commutes because ˛ W .S; f / ! S=f˛ is a morphism; moreover, ˛ is
a surjective map. Hence the claim follows from Lemma 2.1.32, so that
#˛ is a morphism indeed.
3. If #0
˛ is another morphism with these properties, then we have #0
˛ ı
˛ D R D #˛ ı ˛, and since ˛ is surjective, it is an epi by Proposi-
tion 2.1.23, which implies #˛ D #0
˛. a
This is all very well, but where do we get bisimulation equivalences
from? If we cannot ﬁnd examples for them, the efforts just spent may
run dry. Fortunately, we are provided with ample bisimulation equiv-
alences through coalgebra morphisms, speciﬁcally through their kernel
(for a deﬁnition, see page 124). It will turn out that all such equivalences
can be generated in this way.

2.6. COALGEBRAS
219
Proposition 2.6.39 Assume that F preserves weak pullbacks and that
' W .S; f / ! .T; g/ is a coalgebra morphism. Then ker .'/ is a bisim-
ulation equivalence on .S; f /. Conversely, if ˛ is a bisimulation equiv-
alence on .S; f /, then there exists a coalgebra .T; g/ and a coalgebra
morphism ' W .S; f / ! .T; g/ with ˛ D ker .'/.
Proof 1. We know that ker .'/ is an equivalence relation; since ker .'/ D
graph.'/ ı graph.'/1, we conclude from Corollary 2.6.22 that ker .'/
is a bisimulation.
2. Let ˛ be a bisimulation equivalence on .S; f /; then the factor map
˛ W .S; f / ! .S=˛; f˛/ is a morphism by Lemma 2.6.29, and
ker .˛/ D fhs; s0i j Œs˛ D Œs0˛g D ˛: a
We know what morphisms are, and usually morphisms are studied also
in the context of congruences as those equivalence relations which re-
spect the underlying structure. This is what we will do next.
2.6.2
Congruences
Bisimulations compare two systems with each other, while a congru-
ence permits to talk about elements in a coalgebra which behave in
a similar manner. Let us have a look at Abelian groups. An equiva-
lence relation ˛ on an Abelian group .G; C/ is a congruence iff g ˛ h
and g0 ˛ h0 together imply .g C g0/ ˛ .h C h0/. This means that ˛
is compatible with the group structure; an equivalent formulation says
that there exists a group structure on G=˛ such that the factor map ˛ W
G ! G=˛ is a group morphism. Thus the factor map is the harbinger of
the good news. We translate this observation now into the language of
coalgebras.
Deﬁnition 2.6.40 Let .S; f / be an F-coalgebra for the endofunctor F
on the category Set of sets. An equivalence relation ˛ on S is called an
F-congruence iff there exists a coalgebra structure f˛ on S=˛ such that
˛ W .S; f / ! .S=˛; f˛/ is a coalgebra morphism.
Thus we want that this diagram

220
CHAPTER 2. CATEGORIES
is commutative, so that we have
f˛.Œs˛/ D .F˛/.f .s//
for each s 2 S. A brief look at Lemma 2.6.29 shows that bisimula-
tion equivalences are congruences, and we see from Proposition 2.6.39
that the kernels of coalgebra morphisms are congruences, provided the
functor F preserves weak pullbacks.
Hence congruences and bisimulations on a coalgebra are actually very
closely related. They are, however, not the same, because we have:
Proposition 2.6.41 Let ' W .S; f / ! .T; g/ be a morphism for the F-
coalgebras .S; f / and .T; g/. Assume that ker .F'/  ker

Fker.'/

:
Then ker .'/ is a congruence for .S; f /.
Proof Deﬁne fker.'/.Œsker.'// WD F.ker.'//.f .s// for s 2 S. Then
fker.'/ W S=ker .'/ ! F.S=ker .'// is well deﬁned. In fact, assume that
Œsker.'/ D Œs0ker.'/, then g.'.s// D g.'.s0//, so that .F'/.f .s// D
.F'/.f .s0//, consequently hf .s/; f .s0/i 2 ker .F'/. By assumption,
.Fker.'//.f .s//
D
.Fker.'//.f .s0//, so that fker.'/.Œsker.'//
D
fker.'/.Œs0ker.'//. It is clear that ˛ is a coalgebra morphism. a
The deﬁnition of a congruence is not tied to functors which operate on
the category of sets. The next example leaves this category and consid-
ers the category of measurable spaces, introduced in Example 2.1.12.
The subprobability functor S from Example 2.3.12 is an endofunctor
on Meas, and we know that the coalgebras for this functor are just the
subprobabilistic transition kernels K W .S; A/ ! .S; A/; see Exam-
ple 2.6.7.
Deﬁnition 2.6.42 A measurable map f W .S; A/ ! .T; B/ measurable
spaces .S; A/ and .T; B/ is called ﬁnal iff B is the largest -algebra on
T which renders f measurable.
Final
measurable
map
Thus, if f is onto, we conclude from f 1
B

2 A that B 2 B, because
f 1 is injective. Given an equivalence relation ˛ on S, we can make
the factor space S=˛ a measurable space by endowing it with the ﬁnal
-algebra A=˛ with respect to ˛; compare Exercise 2.25.
This, then, is the deﬁnition of a morphism for coalgebras for the Giry
functor (see Example 2.4.8).
Deﬁnition 2.6.43 Let .S; A; K/ and .T; B; L/ be coalgebras for the
subprobability Functor; then ' W .S; A; K/ ! .T; B; L/ is a coalge-

2.6. COALGEBRAS
221
bra morphism iff ' W .S; A/ ! .T; B/ is a measurable map such that
this diagram commutes:
Thus we have
L.'.s//.B/ D S.'/.K.s//.B/ D K.s/.'1
B

/
for each s 2 S and for each measurable set B 2 B. We will investigate
the kernel of a morphism now in order to obtain a result similar to the
one reported in Proposition 2.6.41. The crucial property in that develop-
ment has been the comparison of the kernel ker .F'/ with ker

Fker.'/

.
We will concentrate on this property now.
Call a morphism ' strong iff ' is surjective and ﬁnal. Now ﬁx a strong
Strong
morphism
morphism ' W K ! L. A measurable subset A 2 A is called '-
invariant iff a 2 A and '.a/ D '.a0/ together imply a0 2 A, so that A 2
A is ' invariant iff A is the union of ker .'/-equivalence classes.
We obtain this characterization of '-invariant sets (note that this is an
intrinsic property of the map proper):
Lemma 2.6.44 Let ' W .S; A/ ! .T; B/ be a strong morphism, and
deﬁne
˙' WD fA 2 A j A is '-invariantg:
Then:
1. ˙' is a -algebra.
2. ˙' is isomorphic to f'1
B

j B 2 Bg as a Boolean -algebra.
Proof 1. Clearly, both ; and S are '-invariant, and the complement
of an invariant set is invariant again. Invariant sets are closed under
countable unions. Hence ˙' is a -algebra.
2. Given B 2 B, it is clear that '1
B

is '-invariant; since the latter is
also a measurable subset of S, we conclude that f'1
B

j B 2 Bg 
˙'. Now let A 2 ˙'; we claim that A D '1
'

A

. In fact, since
'.a/
2
'

A

for
a
2
A,
the
inclusion
A

'1
'

A

is trivial. Let a 2 '1
'

A

, so that there exists a0 2 A

222
CHAPTER 2. CATEGORIES
with '.a/ D '.a0/. Since A is '-invariant, we conclude a 2 A, estab-
lishing the other inclusion. Because ' is ﬁnal and surjective, we infer
from this representation that '

A

2 B, whenever A 2 ˙', and that
'1 W B ! ˙' is surjective. Since ' is surjective and '1 is injec-
tive, hence '1 yields a bijection. The latter map is compatible with the
operations of a Boolean -algebra, so it is an isomorphism. a
This result is usually the unbeknownst and deeper reason why the con-
struction of various kinds of bisimulations for Markov transition sys-
tems work. In our context, it helps in establishing the crucial property
for kernels.
Corollary 2.6.45 Let ' W K ! L be a strong morphism; then ker .S'/
 ker

Sker.'/

.
Proof Let h; 0i 2 ker .S'/; thus .S'/./.B/ D .S'/.0/.B/ for all
B 2 B. Now let C 2 A=ker .'/, then 1
ker.'/

C

2 ˙', so that there
exists by Lemma 2.6.44 some B 2 B such that 1
ker.'/

C

D '1
B

.
This is the central property. Hence
.Sker.'//./.C/
D .1
ker.'/

C

/
D .'1
B

/
D .S'/./.B/
D .S'/.0/.B/
D .Sker.'//.0/.C/;
so that h; 0i 2 ker

Sker.'/

. a
Now everything is in place to show that the kernel of a strong morphism
is a congruence for the S-coalgebra .S; A; K/.
Proposition 2.6.46 Let ' W K ! L be a strong morphism for the S-
coalgebras .S; A; K/ and .T; B; L/. Then ker .'/ is a congruence for
.S; A; K/.
Proof 0. We have to ﬁnd a coalgebra structure on the measurable space
Plan
.S=ker .'/; A=ker .'// ﬁrst; the candidate is obvious.
After having
established that this is possible indeed, we check the condition for a
congruence. This invites an application of Proposition 2.6.41 through
Corollary 2.6.45.
1. We want to deﬁne the coalgebra Kker.'/ on .S=ker .'/; A=ker .'//
upon setting
Kker.'/.Œsker.'//.C/
WD
.Sker.'//.K.s//.C/

D K.s/.1
ker.'/

C

/


2.6. COALGEBRAS
223
for C 2 A=ker .'/, but we have to be sure ﬁrst that this is well de-
ﬁned. In fact, let Œsker.'/ D Œs0ker.'/, which means '.s/ D '.s0/;
hence L.'.s// D L.'.s0//, so that .S'/K.s/ D .S'/K.s0/, because ' W
K ! L is a morphism. But the latter equality implies hK.s/; K.s0/i 2
ker .S'/  ker

Sker.'/

, the inclusion holding by Corollary 2.6.45.
Thus we conclude
.Sker.'//.K.s// D .Sker.'//.K.s0//;
so that Kker.'/ is well deﬁned indeed.
2. It is immediate that C 7! Kker.'/.Œsker.'//.C/ is a subprobability on
A=ker .'/ for ﬁxed s 2 S, so it remains to show that t 7! Kker.'/.t/.C/
is
a
measurable
map
on
the
factor
space
.S=ker .'/;
A=ker .'//. Let q 2 Œ0; 1, and consider for C 2 A=ker .'/ the set
G WD ft 2 S=ker .'/ j Kker.'/.t/.C/ < qg:
We have to show that G 2 A=ker .'/. Because C 2 A=ker .'/, we
know that A WD 1
ker.'/

C

2 ˙'; hence it is sufﬁcient to show that the
set H WD fs 2 S j K.s/.A/ < qg is a member of ˙f . Since K is the
dynamics of a S-coalgebra, we know that H 2 A, so it remains to show
that H is '-invariant. Because A 2 ˙f , we infer from Lemma 2.6.44
that A D '1
B

for some B 2 B. Now take s 2 H and assume
'.s/ D '.s0/. Thus
K.s0/.A/
D K.s0/.'1
B

/
D .S'/.K.s0//.B/
D L.'.s0//.B/
D L.'.s//.B/
D K.s/.A/
< q;
so that H 2 ˙' indeed. Because H D 1
ker.'/

G

, it follows that
G 2 A=ker .f /, and we are done. a
We will deal with coalgebras now when interpreting modal logics. This
connection between modal logics and coalgebras is at ﬁrst sight fairly
surprising but becomes at second sight interesting because modal log-
ics are ﬁrmly tied to transition systems, and we have seen that transi-
tion systems can be interpreted as coalgebras. So one wants to know
what coalgebraic properties are reﬂected in the relational interpretation
of modal logics, in particular the relation to the coalgebraic reading of
bisimilarity is interesting and may promise new insights.

224
CHAPTER 2. CATEGORIES
2.7
Modal Logics
This section will discuss modal logics and provide a closer look at the
interface between models for this logics and coalgebras. Thus the topics
of this section may be seen as an application and illustration of coalge-
bras.
We will deﬁne the language for the formulas of modal logics, ﬁrst for the
conventional logics which permits expressing sentences like “it is possi-
ble that formula ' holds” or “formula ' holds necessarily” and then for
an extended version, allowing for modal operators that govern more than
one formula. The interpretation through Kripke models is discussed,
and it becomes clear that at least elementary elements of the language
of categories are helpful in investigating these logics. For completeness,
we also give the construction for the canonical model, displaying the
elegant construction through the Lindenbaum Lemma.
It shows that coalgebras can be used directly in the interpretation of
modal logics. We demonstrate that a set of predicate liftings deﬁne a
modal logics, discuss brieﬂy expressivity for these modal logics, and
display an interpretation of CTL*, one of the basic logics for model
checking, through coalgebras.
We ﬁx a set ˚ of propositional letters.
˚
Deﬁnition 2.7.1 The basic modal language L.˚/ over ˚ is given by
this grammar:
L.˚/
' WWD ? j p j '1 ^ '2 j :' j Þ '
with p 2 ˚.
We introduce additional operators:
> denotes :?;
'1 _ '2 denotes :.:'1 ^ :'2/;
'1 ! '2 denotes :'1 _ '2;
' denotes : Þ :':
The constant ? denotes falsehood, consequently, > D :? denotes
truth, and negation : as well as conjunction ^ should not come as a
surprise; informally, Þ' means that it is possible that formula ' holds,

2.7. MODAL LOGICS
225
while ' expresses that ' holds necessarily. Syntactically, this looks
like propositional logic, extended by the modal operators Þ and .
Before we have a look at the semantics of modal logic, we indicate that
this logic is syntactically sometimes a bit too restricted; after all, the
modal operators operate only on one argument at a time. The extension
we want should offer modal operators with more arguments. For this,
we introduce the notion of a modal similarity type t D .O; /, which
.O;/
is a set O of operators; each operator  2 O has an arity ./ 2 N0.
Note that ./ D 0 is not excluded; these modal constants will not play
a distinguished rˆole; however, they are sometimes nice to have.
Clearly, the set fÞg together with .Þ/ D 1 is an example for such a
modal similarity type.
Deﬁnition 2.7.2 Given a modal similarity type t D .O; / and the set
˚ of propositional letters, the extended modal language L.t; ˚/ is given
by this grammar:
' WWD ? j p j '1 ^ '2 j :' j .'1; : : : ; 'k/
with p 2 ˚ and  2 O such2 that ./ D k.
We also introduce for the general case operators which are called nablas.
The nabla r of  is deﬁned through ( 2 O; ./ D k)
r.'1; : : : ; 'k/ WD :.:'1; : : : ; :'k/
 is the nabla of Þ, so r generalizes a well-known operation.
It is time to have a look at some examples.
Example 2.7.3 Let O D fF; Pg with .F/ D .P/ D 1; the operator F
looks into the future and P into the past. This may be useful, e.g., when
you are traversing a tree and are visiting an inner node. The future may
then look at all nodes in its subtree, the past at all nodes on a path from
the root to this tree.
Then tF ut WD .O; / is a modal similarity type. If ' is a formula in
L.tF ut; ˚/, formula F' is true iff ' will hold in the future, and P' is
2In this section,  does not denote the diagonal of a set (as elsewhere in this book);
we could have used another letter, but the symmetry of  and r is too good to be
missed.

226
CHAPTER 2. CATEGORIES
true iff ' did hold in the past. The nablas are deﬁned as
G' WD :F:'
(' will always be the case)
H' WD :P:'
(' has always been the case).
Look at some formulas:
P' ! GP': If something has happened, it will always have happened.
F' ! FF': If ' will be true in the future, then it will be true in the
future that ' will be true.
GF' ! FG': If ' will be true in the future, then it will at some point
be always true.
✌
The next example deals with a simple model for sequential programs.
Example 2.7.4 Take  as a set of atomic programs (think of elements
of  as executable program components). The set of programs is de-
ﬁned through this grammar:
t WWD  j t1 [ t2 j t1I t2 j t j '‹
with  2  and ' a formula of the underlying modal logic.
Here t1 [ t2 denotes the nondeterministic choice between programs t1
and t2, t1I t2 is the sequential execution of t1 and t2 in that order, and
t is iteration of program t a ﬁnite number of times (including zero).
The program '‹ tests whether or not formula ' holds; '‹ serves as a
guard: .'‹I t1/[.:'‹I t2/ tests whether ' holds, if it does t1 is executed;
otherwise, t2 is. So the informal meaning of hti' is that formula ' holds
after program t is executed (we use here and later an expression like hti'
rather than the functional notation or just juxtaposition).
So, formally we have the modal similarity type tPDL WD .O; / with
O WD fhti j t is a programg. This logic is known as PDL—propositional
dynamic logic. ✌
The next example deals with games and a syntax very similar to the one
just explored for PDL.
Example 2.7.5 We introduce two players, Angel and Demon, playing
against each other, taking turns. So Angel starts, then Demon makes the
next move, then Angel replies, etc.

2.7. MODAL LOGICS
227
For modeling game logic, we assume that we have a set  of simple
games; the syntax for games looks like this:
g WWD  j g1 [ g2 j g1 \ g2 j g1I g2 j gd j g j g	 j '‹
with  2  and ' a formula of the underlying logic. The informal inter-
pretation of g1[g2, g1I g2, g and '‹ are as in PDL (Example 2.7.4) but
as actions of player Angel. The actions of player Demon are indicated
by:
g1 \ g2: Demon chooses between games g1 and g2; this is called de-
monic choice (in contrast to angelic choice g1 [ g2).
g	: Demon decides to play game g a ﬁnite number of times (including
not at all).
gd: Angel and Demon change places.
Again, we indicate through hgi' that formula ' holds after game g. We
obtain the similarity type tGL WD .O; / with O WD fhgi j g is a gameg
and  D 1. The corresponding logic is called game logic ✌
Another example is given by arrow logic. Assume that you have arrows
in the plane; you can compose them, i.e., place the beginning of one
arrow at the end of the ﬁrst one, and you can reverse them. Finally, you
can leave them alone, i.e., do nothing with an arrow.
Example 2.7.6 The set O of operators for arrow logic is given by
fı; ˝; skipg with .ı/ D 2, .˝/ D 1 and .skip/ D 0. The arrow
composed from arrows a1 and a2 is arrow a1 ı a2, ˝a1 is the reversed
arrow a1, and skip does nothing. ✌
2.7.1
Frames and Models
For interpreting the basic modal language, we introduce frames.
A
frame models transitions, which are at the very heart of modal logics.
Let us have a brief look at a modal formula like p for some propo-
sitional letter p 2 ˚. This formula models “p always holds,” which
implies a transition from the current state to another one, in which p is
assumed to hold always; without a transition, we would not have to think
whether p always holds—it would just hold or not. Hence we need to

228
CHAPTER 2. CATEGORIES
have transitions at our disposal, thus a transition system, as in Exam-
ple 2.1.9. In the current context, we take the disguise of a transition
system as a relation. All this is captured in the notion of a frame.
Deﬁnition 2.7.7 A Kripke frame F WD .W; R/ for the basic modal lan-
guage is a set W 6D ; of states together with a relation R  W  W .
W is sometimes called the set of worlds, R the accessibility relation.
The accessibility relation of a Kripke frame does not yet carry enough
information about the meaning of a modal formula, since the proposi-
tional letters are not captured by the frame. This is the case, however, in
a Kripke model.
Deﬁnition 2.7.8 A Kripke model (or simply a model, for the time being)
M D .W; R; V / for the basic modal language consists of a Kripke
frame .W; R/ together with a map V W ˚ ! P .W /.
So, roughly speaking, the frame part of a Kripke model caters to the
propositional and the modal part of the logic, whereas the map V takes
care of the propositional letters. This will enable us to deﬁne the mean-
ing of the formulas for the basic modal language. We state the con-
ditions under which a formula ' is true in a world w 2 W ; this is
expressed through M; w ˆ '; note that this will depend on the model
M; w ˆ '
M; hence, we incorporate it usually into the notation. Here we go.
M; w ˆ ? is always false.
M; w ˆ p , w 2 V.p/; if p 2 ˚:
M; w ˆ '1 ^ '2 , M; w ˆ '1 and M; w ˆ '2:
M; w ˆ :' , M; w ˆ ' is false.
M; w ˆ Þ' , there exists v with hw; vi 2 R and M; v ˆ ':
The interesting part is of course the last line. We want Þ' to hold in
state w; by our informal understanding, this means that a transition into
a state such that ' holds in this state is possible. But this means that
there exists some state v with hw; vi 2 R such that ' holds in v. This is
just the formulation we did use above. Look at '; an easy calculation
shows that M; w ˆ ' iff M; w ˆ ' for all v with hw; vi 2 R; thus,
no matter what transition from world w to another world v we make,
and M; v ˆ ' holds, then M; w ˆ '. But we want to emphasize
that for M; w ˆ Þ' to hold, we infer that w has at least one successor
under relation R.

2.7. MODAL LOGICS
229
We deﬁne ŒŒ'M as the set of all states in which formula ' holds. For-
mally,
ŒŒ'M WD fw 2 W j M; w ˆ 'g:
Let us look at some examples.
Example 2.7.9 Put ˚ WD fp; q; rg as the set of propositional letters and
W WD f1; 2; 3; 4; 5g as the set of states; relation R is given through
Finally, put
V.`/ WD
8
ˆ<
ˆ:
f2; 3g;
` D p
f1; 2; 3; 4; 5g;
` D q
;;
` D r
Then we have for the Kripke model M WD .W; R; V /, for example:
M; 1 ˆ Þp: This is so since M; 3 ˆ p (because 3 2 V.p/); thus
M; 2 ˆ p; hence M; 1 ˆ Þp.
M; 1 6ˆ Þp ! p: Since 1 62 V.p/, we have M; 1 6ˆ p.
M; 2 ˆ Þ.p ^ :r/: The only successor to 2 in R is state 3, and we see
that 3 2 V.p/ and 3 62 V.r/.
M; 1 ˆ q ^ Þ.q ^ Þ.q ^ Þ.q ^ Þq///: Because 1 2 V.q/ and 2 is
the successor to 1, we investigate whether M; 2 ˆ q ^ Þ.q ^
Þ.q ^ Þq// holds. Since 2 2 V.q/ and h2; 3i 2 R, we look at
M; 3 ˆ q ^ Þ.q ^ Þq/; now h3; 4i 2 R and M; 3 ˆ q, so we
investigate M; 4 ˆ q ^ Þq. Since 4 2 V.q/ and h4; 5i 2 R, we
ﬁnd that this is true. Let ' denote the formula q ^ Þ.q ^ Þ.q ^
Þ.q ^ Þq///; then this peeling-off layers of parentheses shows
that M; 2 6ˆ ', because M; 5 ˆ Þp does not hold.
M; 1 6ˆ Þ' ^ q: Since M; 2 6ˆ ', and since state 2 is the only succes-
sor to 1, we see that M; 1 6ˆ '.
M; w ˆ q: This is true for all worlds w, because w0 2 V.q/ for all
w0 which are successors to some w 2 W .
✌

230
CHAPTER 2. CATEGORIES
Example 2.7.10 We have two propositional letters p and q; as set of
states, we put W WD f1; 2; 3; 4; 6; 8; 12; 24g; and we say
x R y , x 6D y and x divides y:
This is what R looks like without transitive arrows:
Put V.p/ WD f4; 8; 12; 24g and V.q/ WD f6g. Deﬁne the Kripke model
M WD .W; R; V /. We obtain for example:
M; 4 ˆ p: The set of successor to state 4 is just f8; 12; 24g which is
a subset of V.p/.
M; 6 ˆ p: Here we may reason in the same way.
M; 2 6ˆ p: State 6 is a successor to 2, but 6 62 V.p/.
M; 2 ˆ Þ.q ^ p/ ^ Þ.:q ^ p/: State 6 is a successor to state 2
with M; 6 ˆ q ^ p, and state 4 is a successor to state 2 with
M; 4 ˆ :q ^ p
✌
Let us introduce some terminology which will be needed later. We say
that a formula ' is globally true in a Kripke model M with state space
W iff ŒŒ'M D W , hence iff M; w ˆ ' for all states w 2 W ; this is
indicated by M ˆ '. If ŒŒ'M 6D ;, thus if there exists w 2 W with
M; w ˆ ', we say that formula ' is satisﬁable; ' is said to be refutable
or falsiﬁable iff :' is satisﬁable. A set ˙ of formulas is said to be
Satisﬁability
etc
globally true iff M; w ˆ ˙ for all w 2 W (where we put M; w ˆ ˙
iff M; w ˆ ' for all ' 2 ˙). ˙ is satisﬁable iff M; w ˆ ˙ for some
w 2 W .
Kripke models are but one approach for interpreting modal logics. We
observe that for a given transition system .S;  /, the set N.s/ WD fs0 2
S j s  s0g may consist of more than one state; one may consider
N.s/ as the neighborhood of state s. An external observer may not be
able to observe N.s/ exactly, but may determine that N.s/  A for
subsets A  S. Obviously, N.s/  A and A  B imply N.s/  B, so
that the sets deﬁned by containing the neighborhood N.s/ of a state s
forms an upper closed set. This leads to the deﬁnition of neighborhood
frames.

2.7. MODAL LOGICS
231
Deﬁnition 2.7.11 Given a set S of states, a neighborhood frame N WD
.S; N / is deﬁned by a map N W S ! V.S/ WD fV  P .S/ j V
is upper closedg. N is called an effectivity function on S.
Effectivity
function
The set V.S/ of all upper closed families of subsets of S was introduced
in Example 2.3.13.
So if we consider state s 2 S in a neighborhood frame, then N.s/ is an
upper closed set which gives all sets the next state may be a member of.
These frames occur in a natural way in topological spaces.
Example 2.7.12 Let T be a topological space, then
V.t/ WD fA  T j U  A for some open neighborhood U of tg
deﬁnes a neighborhood frame .T; V /. ✌
Another straightforward example is given by ultraﬁlters.
Example 2.7.13 Given a set S, deﬁne
U.x/ WD fU  S j x 2 U g;
the ultraﬁlter associated with x. Then .S; U / is a neighborhood frame.
✌
Each Kripke frame gives rise to neighborhood frames in this way:
Example 2.7.14 Let .W; R/ be a Kripke frame, and deﬁne for the world
w 2 W the sets
VR.w/ WD fA 2 P .W / j R.w/  Ag;
V 0
R.w/ WD fA 2 P .W / j R.w/ \ A 6D ;g
(with R.w/ WD fv 2 W j hw; vi 2 Rg); then both .W; VR/ and .W; V 0
R/
are neighborhood frames. ✌
A neighborhood frame induces a map on the power set of the state space
into this power set. This map is used sometimes for an interpretation
in lieu of the neighborhood function. Fix a map P W S ! VS for
illustrating this.
Given a subset A  S, we determine those states
#P .A/ which can achieve a state in A through P ; hence #P .A/ WD
fs 2 S j A 2 P.s/g. This yields a map #P W P .S/ ! P .S/, which
is monotone since P.s/ is upper closed for each s. Conversely, given
a monotone map # W P .S/ ! P .S/, we deﬁne P# W S ! V.S/

232
CHAPTER 2. CATEGORIES
through R#.s/ WD fA  S j s 2 #.A/g. It is plain that #R# D # and
R#P D P .
Deﬁnition 2.7.15 Given a set S of states, a neighborhood frame .S; N /,
and a map V W ˚ ! P .S/, associating each propositional letter with
a set of states. Then N WD .S; N; V / is called a neighborhood model
We deﬁne validity in a neighborhood model by induction on the struc-
ture of a formula, this time through the validity sets:
ŒŒ>N WD S;
ŒŒpN WD V.p/; if p 2 ˚;
ŒŒ'1 ^ '2N WD ŒŒ'1N \ ŒŒ'2N;
ŒŒ:'N WD S n ŒŒ'N;
ŒŒ'N WD fs 2 S j ŒŒ'N 2 N.s/g:
In addition, we put N; s ˆ ' iff s 2 ŒŒ'N. Consider the last line and
N; s ˆ '
assume that the neighborhood frame underlying the model is generated
by a Kripke frame (W, R), so that A 2 N.w/ iff R.w/  A. Then
N; w0 ˆ ' translates into w0 2 fw 2 S j R.w/  ŒŒ'Ng, so that
N; w ˆ ' iff each world which is accessible from world w satisﬁes
'; this is what we want. Extending the deﬁnition above, we put
ŒŒÞ'N WD fs 2 S j S n ŒŒ'N 62 N.s/g;
so that N; s ˆ Þ' iff N; s ˆ ::'.
Back to the general discussion. We generalize the notion of a Kripke
model for capturing extended modal languages. The idea for an ex-
tension is straightforward—for interpreting a modal formula given by a
modal operator of arity n, we require a subset of W nC1. This leads to
the deﬁnition of a frame, adapted to this purpose.
Deﬁnition 2.7.16 Given a similarity type t D .O; /, F D .W;
.R/2O/ is said to be a t-frame iff W 6D ; is a set of states, and
R  W ./C1 for each  2 O. A t-model M D .F; V / is a t-frame
F with a map V W ˚ ! P .W /.

2.7. MODAL LOGICS
233
Given a t-model M, we deﬁne the interpretation of formulas like
.'1; : : : ; 'n/ and its nabla-cousin r.'1; : : : ; 'n/ in this way:
 M; w ˆ .'1; : : : ; 'n/ iff there exist w1; : : : ; wn with:
1. M; wi ˆ 'i for 1  i  n,
2. hw; w1; : : : ; wni 2 R,
if n > 0,
 M; w ˆ  iff w 2 R for n D 0,
 M; w ˆ r.'1; : : : ; 'n/ iff

hw; w1; : : : ; wni 2 R implies M;
wi ˆ 'i for all i 2 f1; : : : ; ng

for all w1; : : : ; wn 2 W , if n > 0,
 M; w ˆ r iff w 62 R, if n D 0.
In the last two cases, r is the nabla for modal operator .
Just in order to get a grip on these deﬁnitions, let us have a look at some
examples.
Example 2.7.17 The set O of modal operators consists just of the unary
operators fhai; hbi; hcig, the relations on the set W WD fw1; w2; w3; w4g
of worlds are given by:
Ra WD fhw1; w2i; hw4; w4ig;
Rb WD fhw2; w3ig;
Rc WD fhw3; w4ig:
There is only one propositional letter p, and put V.p/ WD fw2g. This
comprises a t-model M. We want to check whether M; w1 ˆ haip !
hbip holds. Allora: In order to establish whether or not M; w1 ˆ haip
holds, we have to ﬁnd a state v such that hw1; vi 2 Ra and M; v ˆ p;
state w2 is the only possible choice. But M; w1 6ˆ p, because w1 62
V.p/. Hence M; w1 6ˆ haip ! hbip. ✌
Example 2.7.18 Let W D fu; v; w; sg be the set of worlds; we take
O WD f}; |g with .}/ D 2 and .|/ D 3. Put R} WD fhu; v; wig and
R| WD fhu; v; w; sig. The set ˚ of propositional letters is fp0; p1; p2g
with V.p0/ WD fvg, V.p1/ WD fwg and V.p2/ WD fsg. This yields a
model M.

234
CHAPTER 2. CATEGORIES
1. We want to determine ŒŒ}.p0; p1/M. From the deﬁnition of ˆ,
we see that
M; x ˆ }.p0; p1/ iff 9x0; x1 W M; x0 ˆ p0 and M; x1 ˆ p1
and hx; x0; x1i 2 R}:
We obtain by inspection ŒŒ}.p0; p1/M D fug.
2. We have M; u ˆ |.p0; p1; p2/. This is so since M; v ˆ p0,
M; w ˆ p1, and M; s ˆ p2 together with hu; v; w; si 2 R|.
3. Consequently, we have ŒŒ}.p0; p1/ ! |.p0; p1; p2/M D fug.
✌
Example 2.7.19 Let us look into the future and into the past. We are
given the unary operators O D fF; Pg as in Example 2.7.3. The in-
terpretation requires two binary relations RF and RP; we have deﬁned
the corresponding nablas G resp H. Unless we want to change the past,
we assume that RP D R1
F , so just one relation R WD RF sufﬁces for
interpreting this logic. Hence:
M; x ˆ F': This is the case iff there exists ´ 2 W such that hx; ´i 2 R
and M; ´ ˆ '.
M; x ˆ P': This is true iff there exists ´ 2 W with hv; xi 2 R and
M; v ˆ '.
M; x ˆ G': This holds iff we have M; y ˆ ' for all y with hx; yi 2
R.
M; x ˆ H': Similarly, for all y with hy; xi 2 R, we have M; y ˆ '.
✌
The next case is a little more involved since we have to construct the
relations from the information that is available. In the case of PDL
(see Example 2.7.4), we have only information about the behavior of
atomic programs, and we construct from it the relations for compound
programs, since, after all, a compound program is composed from the
atomic programs according to the rules laid down in Example 2.7.4.
Example 2.7.20 Let  be the set of all atomic programs, and assume
that we have for each t 2  a relation Rt  W  W ; so if atomic
program t is executed in state s, then Rt.s/ yields the set of all possible

2.7. MODAL LOGICS
235
successor states after execution. Now we deﬁne by induction on the
structure of the programs these relations:
R1[2 WD R1 [ R2;
R1I2 WD R1 ı R2;
R WD
[
n0
Rn:
(here we put R0 WD fhw; wi j w 2 W g, and RnC1 WD R ı Rn).
Then, if hx; yi 2 R1[2, we know that hx; yi 2 R1 or hx; yi 2 R2,
which reﬂects the observation that we can enter a new state y upon
choosing between 1 and 2. Hence executing 1 [ 2 in state x, we
should be able to enter this state upon executing one of the programs.
Similarly, if in state x we execute ﬁrst 1 in x and then 2, we should
enter an intermediate state ´ after executing 1 and then execute 2
in state ´, yielding the resulting state. Executing  means that we
execute n a ﬁnite number of times (probably not at all). This explains
the deﬁnition for R.
Finally, we should deﬁne R'‹ for a formula '. The intuitive meaning of
a program like '‹I  is that we want to execute , provided formula '
holds. This suggests deﬁning
R'‹ WD fhw; wi j M; w ˆ 'g:
Note that we rely here on a model M which is already deﬁned.
Just to get familiar with these deﬁnitions, let us have a look at the com-
position operator.
M; x ˆ h1I 2i' , 9v W M; v ˆ ' and hx; vi 2 R1I2
, 9w 2 W 9v 2 ŒŒ'M W hx; wi 2 R1 and hw; vi 2 R2
, 9w 2 ŒŒh2i'M W hx; wi 2 R1
, M; x ˆ h1ih2i'
This means that h1I 2i' and h1ih2i' are semantically equivalent,
which is intuitively quite clear.
The test operator is examined in the next formula. We have
R'‹I D R'‹ıR D fhx; yi j M; x ˆ x and hx; yi 2 Rg D R'‹\R:

236
CHAPTER 2. CATEGORIES
hence M; y ˆ h'‹I i iff M; y ˆ ' and M; y ˆ hi ; so that
M; y ˆ .h'‹I 1i [ h:'‹I 2i/' iff
(
M; y ˆ h1i';
if M; y ˆ '
M; y ˆ h2i';
otherwise
✌
The next example shows that we can interpret PDL in a neighborhood
model as well.
Example 2.7.21 We associate with each atomic program t 2  of PDL
an effectivity function Et W W ! V.W / on the state space W . Hence if
we execute t in state w, then Et.w/ is the set of all subsets A of the states
so that the next state is a member of A (we say that the program t can
achieve a state in A). Hence

W; .Et/t2

is a neighborhood frame. We
have indicated on page 231 that we can construct from a neighborhood
function a monotone map from the power set of W into itself; see also
Exercise 2.43; so we deﬁne
R0
t.A/ WD fw 2 W j A 2 Rt.w/g;
giving a function R0
t W P .W / ! P .W /. R0
t is monotone, since Rt
is an effectivity function: A  B, and w 2 R0
t.A/, then A 2 Rt.w/;
hence B 2 Rt.w/, and thus w 2 R0
t.B/. These maps can be extended to
programs along their syntax in the following way, which is very similar
to the one for relations:
R0
1[2 WD R0
1 [ R0
2;
R0
1I2 WD R0
1 ı R0
2
R0
 WD
[
n0
R0
n
with R0
0 and R0
n deﬁned as above.
Assume that we have again a function V W ˚ ! P .W /, yielding a
neighborhood model N. The deﬁnition above are used now for the in-
terpretation of formulas hi' through
ŒŒhi'N WD R0
.ŒŒ'N/:

2.7. MODAL LOGICS
237
Interpreting R.w/ WD fA  W j w 2 R0
.A/g as the sets which can
be achieved by the execution of program , we have ŒŒhi'N D fw 2
W j ŒŒ'N 2 R.w/g, so that ŒŒhi'N describes the set of all states
for which ŒŒ'N can be achieved upon execution of . The deﬁnition of
R'‹ carries over, so that this yields an interpretation of PDL. ✌
Turning to game logic from Example 2.7.5, we note that neighborhood
models are suited to interpret this logic as well. Assign for each atomic
game  2  to Angel the effectivity function P, then P.s/ indi-
cates what Angel can achieve when playing  in state s. Speciﬁcally,
A 2 P.s/ indicates that Angel has a strategy for achieving by playing
 in state s that the next state of the game is a member of A. We will
not formalize the notion of a strategy here but appeal rather to an infor-
mal understanding. The dual operator permit converting a game into its
dual, where players change rˆoles: the moves of Angel become moves of
Demon, and vice versa.
We should note that the Banach–Mazur games modeled in Sect. 1.7
and the games considered here display signiﬁcant differences. First,
Banach–Mazur games are played essentially over the playground NN,
which means that it should always be possible that such a game, if it
is played over another domain, can be mapped to this urform. By con-
struction, those games continue inﬁnitely, and they have a well-deﬁned
notion of strategy, which permits to deﬁne what a winning strategy is.
As pointed just out, the games we are about to consider do not have a
formal deﬁnition of a strategy, we work rather with the informal notion
that, e.g., Angel has a strategy to achieve something. When discussing
games, we will be careful to distinguish both varieties.
Let us just indicate informally by hi' that Angel has a strategy in game
 which makes sure that game  results in a state which satisﬁes formula
'. We assume the game to be determined: if one player does not have a
winning strategy, then the other one has. Thus if Angle does not have a
:'-strategy, then Demon has a '-strategy, and vice versa. This means
that we can derive the way Demon plays the game from the way Angel
does, and vice versa.
Example 2.7.22 As in Example 2.7.5, we assume that games are given
through this grammar
g WWD  j g1 [ g2 j g1 \ g2 j g1I g2 j gd j g j g	 j '‹

238
CHAPTER 2. CATEGORIES
with  2  , the set of atomic games. We assume that the game is deter-
mined; hence we may express demonic choice g1 \ g2 through .gd
1 [
gd
2 /d and demonic iteration g	 through angelic iteration

.gd/d/.
Assign to each  2  an effectivity function P on the set W of worlds,
and put
P 0
.A/ WD fw 2 W j A 2 P.w/g:
Hence w 2 P 0
.A/ indicates that Angel has a strategy to achieve A by
playing game  in state w. We extend P 0 to games along the lines of
the games’ syntax, and put
ŒŒhgi'N WD P 0
g.ŒŒ'N/:
for neighborhood model N, the game g and formula ' (see the con-
struction after Deﬁnition 2.7.15). This is the extension:
P 0
g1[g2.A/ WD P 0
g1.A/ [ P 0
g2.A/;
P 0
gd .A/ WD W n P 0
g.W n A/;
P 0
g1Ig2.A/ WD P 0
g1.P 0
g2.A//;
P 0
g1\g2.A/ WD P 0
.gd
1 [gd
2 /d .A/;
P 0
g.A/ WD
[
n0
P 0
gn.A/;
P 0
g.A/ WD P 0
.gd /d .A/;
P 0
'‹.A/ WD ŒŒ'N \ A:
A straightforward suggestion for the interpretation of game logic is the
approach through Kripke models, very much in line with the interpre-
tation of modal logics in general. There are, however, some difﬁculties
associated with this idea, which are discussed in [PP03, Sect. 3], in par-
ticular [PP03, Theorem 1]. This is the reason why Kripke models are not
adequate for interpreting game logics: If games are interpreted through
Kripke models, the interpretation turns out to be disjunctive. This means
that hg1I .g2 [ g3/i' is semantically equivalent to hg1I g2 [ g1I g3i'
for all games g1; g2; g3. This, however, is not desirable: Angle’s deci-
sion after playing g1 whether to play g2 or g3 should not be equivalent
to decide whether to play g1I g2 or g1I g3. Neighborhood models in
their greater generality do not display this equivalence, so they are more
general. ✌
In this little gallery of examples, let us ﬁnally have a look at arrow logic;
see Example 2.7.6.
Example 2.7.23 Arrows are interpreted as vectors, hence, e.g., as pairs.
Let W be a set of states; then we take W  W as the domain of our
interpretation. We have three modal operators:

2.7. MODAL LOGICS
239
 The nullary operator skip is interpreted through Rskip WD
fhw; wi j w 2 W g.
 The unary operator ˝ is interpreted through R˝ WD
˚˝
ha; bi;
hb; ai
˛
j a; b 2 W

:
 The binary operator is intended to model composition; thus one
end of the ﬁrst arrow should be the be other end of the second
arrow; hence Rı WD
˚˝
ha; bi; hb; ci; ha; ci
˛
j a; b; c 2 W

:
With this, we obtain, for example, M; hw1; w2i ˆ  1 ı  2 iff there
exists v such that M; hw1; vi ˆ  1 and M; hv; w2i ˆ  2. ✌
Frames are related through frame morphisms. Take a frame .W; R/
for the basic modal language; then R W W ! P .W / is perceived
as a coalgebra for the power set functor. This helps in deﬁning mor-
phisms.
Deﬁnition 2.7.24 Let F D .W; R/ and G D .X; S/ be Kripke frames.
A frame morphism f W F ! G is a map f W W ! X which makes this
f frame
morphism
diagram commutative:
Hence we have the condition for a frame morphism f W F ! G
S.f .w// D .Pf /.R.w// D f

R.w/

D ff .w0/ j w0 2 R.w/g:
for all w 2 W .
This is a characterization of frame morphisms.
Lemma 2.7.25 Let F and G be frames, as above. Then f W F ! G is a
frame morphism iff these conditions hold:
1. w R w0 implies f .w/ S f .w0/.
2. If f .w/ S ´, then there exists w0 2 W with ´ D f .w0/ and
w R w0.
Proof 1. These conditions are necessary. In fact, if hw; w0i 2 R, then
f .w0/ 2 f

R.w/

D S.f .w//, so that hf .w/; f .w0/i 2 S. Similarly,
assume
that
f .w/
S
´;
thus
´
2
S.f .w//
D
P .f /

240
CHAPTER 2. CATEGORIES
.R.w// D f

R.w/

. Hence there exists w0 with hw; w0i 2 R and
´ D f .w0/.
2. The conditions are sufﬁcient. The ﬁrst condition implies f

R.w/

 S.f .w//. Now assume ´ 2 S.f .w//; hence f .w/ S ´, and thus
there exists w0 2 R.w/ with f .w0/ D ´, consequently, ´ D f .w0/ 2
f

R.w/

. a
We see that the bounded morphisms from Example 2.1.10 appear here
again in a natural context.
If we want to compare models for the basic modal language, then we
certainly should be able to compare the underlying frames. But this is
not yet enough, because the interpretation for atomic propositions has
to be taken care of.
Deﬁnition 2.7.26 Let M D .W; R; V / and N D .X; S; Y / be models
for the basic modal language and f W .W; R/ ! .X; S/ be a frame
morphism. Then f W M ! N is said to be a model morphism iff
f model
morphism
f 1 ı Y D V .
Hence f 1
Y.p/

D V.p/ for a model morphism f and for each
atomic proposition p; thus M; w ˆ p iff N; f .w/ ˆ p for each
atomic proposition. This extends to all formulas of the basic modal
language.
Proposition 2.7.27 Assume M and N are models as above, and f W
M ! N is a model morphism. Then
M; w ˆ ' iff N; f .w/ ˆ '
for all worlds w of M and for all formulas '.
Proof 0. The assertion is equivalent to
ŒŒ'M D f 1
ŒŒ'N

for all formulas '. This is the claim which will be established by induc-
Line of
attack
tion on the structure of a formula now.
1. If p is an atomic proposition, then this is just the deﬁnition of a frame
morphism to be a model morphism:
ŒŒpM D V.p/ D f 1
Y.p/

D ŒŒpN:

2.7. MODAL LOGICS
241
Assume that the assertion holds for '1 and '2; then
ŒŒ'1 ^ '2M
D ŒŒ'1M \ ŒŒ'2M
D f 1
ŒŒ'1N

\ f 1
ŒŒ'2N

D f 1
ŒŒ'1N \ ŒŒ'2N

D f 1
ŒŒ'1 ^ '2N

:
Similarly, one shows that ŒŒ:'M D f 1
ŒŒ:'N

.
2. Now consider Þ'; assume that the hypothesis holds for formula ',
then we have
ŒŒÞ'M D fw j 9w0 2 R.w/ W w0 2 ŒŒ'Mg
D fw j 9w0 2 R.w/ W f .w0/ 2 ŒŒ'Ng
(by hypothesis)
D fw j 9w0Wf .w0/ 2 S.f .w//; f .w0/ 2 ŒŒ'Ng
(by Lemma 2.7.25)
D f 1
fx j 9x0 2 S.x/ W x0 2 ŒŒ'Ng

D f 1
ŒŒÞ'N

:
Thus the assertion holds for all formulas '. a
The observation from Proposition 2.7.27 permits comparing worlds
which are given through two models. Two worlds are said to be equiva-
lent iff they cannot be separated by a formula, i.e., iff they satisfy exactly
the same formulas.
Deﬁnition 2.7.28 Let M and N be models with state spaces W resp.
X. States w 2 W and x 2 X are called modally equivalent iff we have
M; w ˆ ' iff N; x ˆ '
for all formulas '
Hence if f W M ! N is a model morphism, then w and f .w/ are
modally equivalent for each world w of M. One might be tempted
to compare models with respect to their transition behavior; after all,
underlying a model is a transition system, a.k.a. a frame. This leads
directly to this notion of bisimilarity for models—note that we have to
take the atomic propositions into account.
Deﬁnition 2.7.29 Let M D .W; R; V / and N D .X; S; Y / be models
for the basic modal language; then a relation B  W  X is called a
bisimulation iff:
1. If w B x, then w and x satisfy the same propositional letters
(“atomic harmony”).

242
CHAPTER 2. CATEGORIES
2. If w B x and w R w0, then there exists x0 with x S x0 and w0 B x0
(forth condition).
3. If w B x and x S x0, then there exists w0 with w R w0 and w0 B x0
(back condition).
Atomic
harmony,
forth, back
States w and x are called bisimilar iff there exists a bisimulation B with
hw; xi 2 B.
Hence the forth condition says for a pair of worlds hw; xi 2 B that
if w  R w0, there exists x0 with hw0; x0i 2 B such that x  S x0,
similarly for the back condition. So this rings a bell: we did discuss this
in Deﬁnition 2.6.15. Consequently, if models M and N are bisimilar,
then the underlying frames are bisimilar coalgebras.
Consider this example for bisimilar states.
Example 2.7.30 Let relation B be deﬁned through
B WD fh1; ai; h2; bi; h2; ci; h3; di; h4; ei; h5; eig
with V.p/ WD fa; dg; V.q/ WD fb; c; eg.
The transitions for M are given
through
N is given through
Then B is a bisimulation ✌
The ﬁrst result relating bisimulation and modal equivalence is intuitively
quite clear. Since a bisimulation reﬂects the structural similarity of the
transition structure of the underlying transition systems, and since the
validity of modal formulas is determined through this transition struc-
ture (and the behavior of the atomic propositional formulas), it does not
come as a surprise that bisimilar states are modally equivalent.
Proposition 2.7.31 Let M and N be models with states w and x. If w
and x are bisimilar, then they are modally equivalent.

2.7. MODAL LOGICS
243
Proof 0. Let B be the bisimulation for which we know that hw; xi 2 B.
We have to show that
M; w ˆ ' , N; x ˆ '
for all formulas '. This is done by induction on the formula.
1. Because of atomic harmony, the equivalence holds for propositional
formulas. It is also clear that conjunction and negation are preserved
under this equivalence, so that the case of proving the equivalence for a
formula Þ' under the assumption that it holds for ' remains to be taken
care of.
“)”: Assume that M; w ˆ Þ' holds. Thus there exists a world w0
in M with w R w0 and M; w0 ˆ '. Hence there exists by the
forward condition a world x0 in N with x S x0 and hw0; x0i 2 B
such that N; x0 ˆ ' by the induction hypothesis. Because x0 is a
successor to x, we conclude N; x ˆ Þ'.
“(”: This is shown in the same way, using the back condition for B.
a
The converse holds only under the restrictive condition that the models
are image ﬁnite. Thus each state has only a ﬁnite number of succes-
sor states; formally, model .W; R; V / is called image ﬁnite iff for each
Image ﬁnite
world w the set R.w/ is ﬁnite. Then the famous Hennessy–Milner The-
orem says:
Theorem 2.7.32 If the models M and N are image ﬁnite, then modal
equivalent states are bisimilar.
Proof 1. Given two modal equivalent states w and x, we have to ﬁnd
a bisimulation B with hw; xi 2 B. The only thing we know about the
states is that they are modally equivalent, hence that they satisfy exactly
the same formulas. This suggests to deﬁne
Plan
B WD fhw0; x0i j w0 and x0 are modally equivalentg
and to establish B
as a bisimulation.
Since by assumption
hw; xi 2 B, this will then prove the claim.
2. If hw; xi 2 B, then both satisfy the same atomic propositions by
the deﬁnition of modal equivalence. Now let hw; xi 2 B and w R w0.
Assume that we cannot ﬁnd x0 with x S x0 and hw0; x0i 2 B. We

244
CHAPTER 2. CATEGORIES
know that M; w ˆ Þ>, because this says that there exists a successor
to w, viz., w0. Since w and x satisfy the same formulas, N; x ˆ Þ>
follows; hence S.x/ 6D ;. Let S.x/ D fx1; : : : ; xkg. Then, since w
and xi are not modally equivalent, we can ﬁnd for each xi 2 S.x/ a
formula  i such that M; w0 ˆ  i, but N; xi 6ˆ  i,. Hence M; w ˆ
Þ. 1 ^ : : : ^  k/, but N; w 6ˆ Þ. 1 ^ : : : ^  k/. This is a contra-
diction, so the assumption is false, and we can ﬁnd x0 with x S x0 and
hw0; x0i 2 B.
The other conditions for a bisimulation are shown in exactly the same
way. a
Neighborhood models can be compared through morphisms as well.
Recall that the functor V underlies a neighborhood frame; see Exam-
ple 2.3.13.
Deﬁnition 2.7.33 Let N D .W; N; V / and M D .X; M; Y / be neigh-
borhood models for the basic modal language. A map f W W ! X is
called a neighborhood morphism f W N ! M iff:
f neighbor-
hood
morphism
 N ı f D .Vf / ı M,
 V D f 1 ı Y .
A neighborhood morphism is a morphism for the neighborhood frame
(the deﬁnition of which is straightforward), respecting the validity of
atomic propositions. In this way, the deﬁnition follows the pattern laid
out for morphisms of Kripke models. Expanding the deﬁnition above,
f W N ! M is a neighborhood morphism iff these conditions hold:
B 2 N.f .w// iff f 1
B

2 M.w/ for all B  X and all worlds
w 2 W , and V.p/ D f 1
Y.p/

for all atomic sentences p 2 ˚.
Morphisms for neighborhood models preserve validity in the same way
as morphisms for Kripke models do:
Proposition 2.7.34 Let f W N ! M be a neighborhood morphism for
the neighborhood models N D .W; N; V / and M D .X; M; Y /. Then
N; w ˆ ' , M; f .w/ ˆ '
for all formulas ' and for all states w 2 W .
Proof The proof proceeds by induction on the structure of formula '.
The induction starts with ' an atomic proposition.
The assertion is

2.7. MODAL LOGICS
245
true in this case because of atomic harmony; see the proof of Propo-
sition 2.7.27. We pick only the interesting modal case for the induc-
tion step.
Hence assume the assertion is established for formula ';
then
M; f .w/ ˆ ' , ŒŒ'M 2 M.f .w//
(by deﬁnition)
, f 1
ŒŒ'M

2 N.w/
(f is a morphism)
, ŒŒ'N 2 N.w/
(by induction hypothesis)
, N; w ˆ '
a
We will not pursue this observation further at this point, but rather turn
to the construction of a canonic model. When we will discuss coal-
gebraic logics, however, this striking structural similarity of models
and their morphisms will be shown to be an instance of more general
pattern.
Before proceeding, we introduce the notion of a substitution, which is
Substitution
a map  W ˚ ! L.t; ˚/. We extend a substitution in a natural way to
formulas. Deﬁne by induction on the structure of a formula
p WD .p/; if p 2 ˚;
.:'/ WD :.'/;
.'1 ^ '2/ WD '
1 ^ '
2 ;

.'1; : : : ; 'k/
 WD .'
1 ; : : : ; '
k /; if  2 O with ./ D k:
2.7.2
The Lindenbaum Construction
We will show now how we obtain from a set of formulas a model which
satisﬁes exactly these formulas. The scenario is the basic modal lan-
guage, and it is clear that not every set of formulas is in a position to
generate such a model.
Let  be a set of formulas; then we say that:
  is closed under modus ponens iff ' 2  and ' !  together
imply  2 ;
  is closed under uniform substitution iff given ' 2  we may
conclude that ' 2  for all substitutions .

246
CHAPTER 2. CATEGORIES
These two closure properties turn out to be crucial for the generation of
a model from a set of formulas. Those sets which satisfy them will be
called modal logics, to be precise:
Deﬁnition 2.7.35 Let  be a set of formulas of the basic modal lan-
guage.  is called a modal logic iff these conditions are satisﬁed:
1.  contains all propositional tautologies.
2.  is closed under modus ponens and under uniform substitution.
If formula ' 2 , then ' is called a theorem of ; we write this as
` '.
` '
Example 2.7.36 These are some instances of elementary properties for
modal logics.
1. If i is a modal logic for each i 2 I 6D ;, then T
i2I i is a
modal logic. This is fairly easy to check.
2. We say for a formula ' and a frame F over W as a set of states
that ' holds in this frame (in symbols F ˆ ') iff M; w ˆ ' for
F ˆ '
each w 2 W and each model M which is based on F. Let C be a
class of frames, then
C WD
\
F2C
f' j F ˆ 'g
is a modal logic. We abbreviate ' 2 C by C ˆ '.
3. Deﬁne similarly M ˆ ' for a model M iff M; w ˆ ' for each
M ˆ '
world w of M. Then put for a class M of models
M WD
\
M2M
f' j M ˆ 'g:
There are sets M for which M is not a modal language. In fact,
take a model M with world W and two propositional letters p; q
with V.p/ D W and V.q/ 6D W , then M; w ˆ p for all w;
hence M ˆ p, but M 6ˆ q. On the other hand, q D p under the
substitution  W p 7! q. Hence fMg is not closed under uniform
substitution.
✌
This formalizes the notion of deduction:

2.7. MODAL LOGICS
247
Deﬁnition 2.7.37 Let  be a logic, and  [f'g a set of modal formulas.
 ' is deducible in  from  iff either ` or if there exist formulas
 1; : : : ;  k 2  such that ` . 1 ^ : : : ^  k/ ! '. We write
this down as  ` '.
 ` '
 
is -consistent iff 
6`
?;
otherwise, 
is called
-inconsistent.
 ' is called -consistent iff f'g is -consistent.
This is a simple and intuitive criterion for inconsistency. We ﬁx for the
discussions below a modal logic .
Lemma 2.7.38 Let  be a set of formulas. Then these statements are
equivalent:
1.  is -inconsistent.
2.  ` ' ^ :' for some formula '.
3.  `  for all formulas  .
Proof 1 ) 2: Because  ` ?, we know that  1 ^ : : : ^  k ! ?
is in  for some formulas  1; : : : ;  k 2  . But ? ! ' ^ :' is a
tautology; hence  ` ' ^ :'.
2
) 3: By assumption there exists  1; : : : ;  k 2  such that `
 1 ^ : : : ^  k ! ' ^ :', and ' ^ :' !  is a tautology for an
arbitrary formula  ; hence ` ' ^ :' !  . Thus  `  .
3 ) 1: We have in particular  ` ?. a
-consistent sets have an interesting compactness property.
Lemma 2.7.39 A set  of formulas is -consistent iff each ﬁnite subset
in  is -consistent.
Proof If  is -consistent, then certainly each ﬁnite subset is. If, on the
other hand, each ﬁnite subset is -consistent, then the whole set must be
consistent, since consistency is tested with ﬁnite witness sets. a
Proceeding on our path to ﬁnding a model for a modal logic, we deﬁne
normal logics. These logics are closed under some properties which
appear as fairly, well, normal, so it is not surprising that they will play
an important rˆole.

248
CHAPTER 2. CATEGORIES
Deﬁnition 2.7.40 Modal logic  is called normal iff it satisﬁes these
Normal
conditions for all propositional letters p; q 2 ˚ and all formulas ':
(K) ` .p ! q/ ! .p ! q/,
(D) ` Þp $ ::p,
(G) If ` ', then ` '.
Property (K) states that if it is necessary that p implies q, then the fact
that p is necessary will imply that q is necessary. Note that the formulas
in  do not have a semantics yet; they are for the time being just syn-
tactic entities. Property (D) connects the constructors Þ and  in the
desired manner. Finally, (G) states that, loosely speaking, if something
is the case, then it is necessarily the case. We should ﬁnally note that (K)
and (D) are both formulated for propositional letters only. This, how-
ever, is sufﬁcient for modal logics, since they are closed under uniform
substitution.
In a normal logic, the equivalence of formulas is preserved by the dia-
mond.
Lemma 2.7.41 Let  be a normal modal logic, then ` ' $  im-
plies ` Þ' $ Þ .
Proof We show that ` ' !  implies ` Þ' ! Þ , the rest will
follow in the same way.
` ' !  )` : ! :'
(contraposition)
)` .: ! :'/
(by (G))
)` ..: ! :'//
(uniform substitution, (K))
! .: ! :'/
)` : ! :'
(modus ponens)
)` ::' ! :: 
(contraposition)
)` Þ' ! Þ 
(by (D))
a
We deﬁne a semantic counterpart to  ` now. Let F be a frame and 
be a set of formulas; then we say that  holds on F (written as F ˆ  )
F ˆ 
iff each formula in  holds in each model which is based on frame F
(see Example 2.7.36). We say that  entails formula ' ( ˆF ') iff
F ˆ  implies F ˆ '. This carries over to classes of frames in an

2.7. MODAL LOGICS
249
obvious way. Let C be a class of frames; then  ˆC ' iff we have
 ˆF ' for all frames F 2 C.
Deﬁnition 2.7.42 Let C be a class of frames, then the normal logic 
is called C-sound iff   C. If  is C-sound, then C is called a class
of frames for .
Note that C-soundness indicates that ` ' implies F ˆ ' for all frames
F 2 C and for all formulas '.
This example dwells on traditional names.
Example 2.7.43 Let 4 be the smallest modal logic which contains
Þ Þ p ! Þp (if it is possible that p is possible, then p is possi-
ble), and let K4 be the class of transitive frames. Then 4 is K4-sound.
In fact, it is easy to see that M; w ˆ Þ Þ p ! Þp for all worlds w,
whenever M is a model, the frame of which carries a transitive relation.
✌
Thus C-soundness permits us to conclude that a formula which is de-
ducible from  holds also in all frames from C. Completeness goes the
other way: roughly, if we know that a formula holds in a class of frames,
then it is deducible. To be more precise:
Deﬁnition 2.7.44 Let C be a class of frames and  a normal modal
logic.
1.  is strongly C-complete iff for any set  [f'g of formulas  ˆC
' implies  ` '.
2.  is weakly C-complete iff C ˆ ' implies ` ' for any formula
'.
This is a characterization of completeness.
Proposition 2.7.45 Let  and C be as above.
1.  is strongly C-complete iff every -consistent set of formulas is
satisﬁable for some F 2 C.
2.  is weakly C-complete iff every -consistent formula is satisﬁ-
able for some F 2 C.
Proof 1. If  is not strongly C-complete, then we can ﬁnd a set  of
formulas and a formula ' with  ˆC ', but  6` '. Then  [f:'g is
-consistent, but this set cannot be satisﬁed on C. So the condition for

250
CHAPTER 2. CATEGORIES
strong completeness is sufﬁcient. It is also necessary. In fact, we may
assume by compactness that  is ﬁnite. Thus by consistency  6` ?;
hence  6ˆC ? by completeness, and thus there exists a frame F 2 C
with F ˆ  but F 6ˆ ?.
2. This is but a special case of cardinality 1. a
Consistent sets are not yet sufﬁcient for the construction of a model, as
we will see soon. We need consistent sets which cannot be extended
further without jeopardizing their consistency. To be speciﬁc:
Deﬁnition 2.7.46 The set  of formulas is maximally -consistent iff
 is -consistent, and it is not properly contained in a -consistent set.
Thus if we have a maximal -consistent set  , and if we know that
  0 with  6D 0, then we know that 0 is not -consistent. This
criterion is sometimes a bit unpractical, but we have:
Lemma 2.7.47 Let  be a normal logic and  be a maximally -
consistent set of formulas. Then:
1.  is closed under modus ponens.
2.    .
3. ' 2  or :' 2  for all formulas '.
4. ' _  2  iff ' 2  or  2  for all formulas ';  .
5. '1 ^ '2 2  if '1; '2 2  .
Proof 1. Assume that ' 2  and ' !  2  , but  62  . Then
 [ f g is inconsistent; hence  [ f g ` ? by Lemma 2.7.38. Thus
we can ﬁnd formulas  1; : : : ;  k 2  such that `  ^ 1^: : :^ k !
?. Because ` ' ^  1 ^ : : : ^  k !  ^  1 ^ : : : ^  k, we conclude
 ` ?. This contradicts -consistency by Lemma 2.7.38.
2. In order to show that    , we assume that there exists  2 
such that  62  , then  [ f g is inconsistent; hence `  1 ^ : : : ^
 k ! : for some  1; : : : ;  k 2  (here we use  [ f g `  and
Lemma 2.7.38). By propositional logic, `  ! :. 1 ^ : : : ^  k/;
hence  2  implies  ` :. 1^: : :^ k/. But  `  1^: : :^ k,
consequently,  is -inconsistent.
3. If both ' 62  and :' 62  ,  is -inconsistent.

2.7. MODAL LOGICS
251
4. Assume ﬁrst that ' _ 2  , but ' 62  and  62  ; hence both  [
f'g and  [f g are inconsistent. Thus we can ﬁnd  1; : : : ;  k; '1; : : : ;
'n 2  with `  1^: : :^ k ! : and ` '1^: : :^'n ! :'. This
implies `  1 ^ : : :^  k ^ '1 ^ : : : ^ 'n ! : ^ :', and by arguing
propositionally, ` . _ '/ ^  1 ^ : : : ^  k ^ '1 ^ : : : ^ 'n ! ?,
which contradicts -consistency of  . For the converse, assume that
' 2  . Since ' ! ' _  is a tautology, we obtain ' _  from modus
ponens.
5. Assume '1^'2 62  , then :'1_:'2 2  by part 3. Thus :'1 2 
or :'2 2  by part 4; hence '1 62  or '2 62  . a
Hence consistent sets have somewhat convenient properties; they re-
mind the reader probably of the properties of an ultraﬁlter in
Lemma 1.5.35, and we will use this close relationship when establishing
G¨odel’s Completeness Theorem in Sect. 3.6.1. But how do we construct
them? The famous Lindenbaum Lemma states that we may obtain them
by enlarging consistent sets.
From now on we ﬁx a normal modal logic .
Lemma 2.7.48 If  is a -consistent set, then there exists a maximal
-consistent set  C with    C.
We will give two proofs for the Lindenbaum Lemma, depending on the
cardinality of the set of all formulas. If the set ˚ of propositional letters
is countable, the set of all formulas is countable as well, so the ﬁrst proof
may be applied. If, however, we have more than a countable number
of formulas, then this proof will fail to exhaust all formulas, and we
have to apply another method, in this case transﬁnite induction. The
basic idea, however, is the same in each case. Based on the observation
that either ' or :' is a member of a maximally consistent set, we take
the consistent set presented to us and look at each formula. If adding
the formula will leave the set consistent, then we add it; otherwise, we
add its negation. If the set of all formulas is not countable, the process
of adding formulas will be controlled by a well-ordering, i.e., through
transﬁnite induction in the form of Tuckey’s Lemma, if it is countable,
however, life is easier and we may access the set of all formulas through
enumerating them.
Plan

252
CHAPTER 2. CATEGORIES
Proof (First—countable case) Assume that the set of all formulas is
countable, and let f'n j n 2 Ng be an enumeration of them. Deﬁne by
induction
0 WD ;
nC1 WD n [ f ng;
where
 n WD
(
'n;
if n [ f'ng is consistent,
:'n;
otherwise.
Put
 C WD
[
n2N
n:
Then these properties are easily checked:
 n is consistent for all n 2 N0.
 Either ' 2  C or :' 2  C for all formulas '.
 If  C ` ', then ' 2  C.
  C is maximal.
a
It may be noted that this proof is fairly similar to the second proof of
the Compactness Theorem 1.5.8 for propositional logic in Sect. 1.5.1,
suggested for the countable case.
Proof (Second—general case) Let
C WD f 0 j  0 is -consistent and    0g:
Then C contains  ; hence C 6D ;, and C is ordered by inclusion. By
Tuckey’s Lemma, it contains a maximal chain C0. Let  C WD S C0.
Then  C is a -consistent set which contains  as a subset. While the
latter is evident, we have to take care of the former. Assume that  C
is not -consistent; hence  C ` ' ^ :' for some formula '. Thus
we ﬁnd  1; : : : ;  k 2  C with `  1 ^ : : : ^  k ! ' ^ :'. Given
 i 2  C, we ﬁnd i 2 C0 with  i 2 i. Since C0 is linearly or-
dered, we ﬁnd some  0 among them such that i   0 for all i. Hence
 1; : : : ;  k 2  0, so that  0 is not -consistent. This is a contradic-
tion. Now assume that  C is not maximal, then there exists ' such that

2.7. MODAL LOGICS
253
' 62  C and :' 62  C. If  C [ f'g is not consistent,  C [ f:'g is,
and vice versa, so either one of  C [ f'g and  C [ f:'g is consistent.
But this means that C0 is not maximal. a
We are in a position to construct a model now, speciﬁcally, we will
deﬁne a set of states, a transition relation and the validity sets for the
propositional letters. Put
W ] WD f˙ j ˙ is -consistent and maximalg;
R] WD fhw; vi 2 W ]  W ] j for all formulas  ;  2 v
implies Þ  2 wg;
V ].p/ WD fw 2 W ] j p 2 wg for p 2 ˚:
Then M] WD .W ]; R]; V ]/ is called the canonical model for .
This is another view of relation R]:
Lemma 2.7.49 Let v; w 2 W ], then wR]v iff  2 w implies  2 v
for all formulas  .
Proof 1. Assume that hw; vi 2 R] but that  62 v for some formula
 . Since v is maximal, we conclude from Lemma 2.7.47 that : 2 v;
hence the deﬁnition of R] tells us that Þ: 2 w, which in turn implies
by the maximality of w that :Þ: 62 w. Thus  62 w follows.
2. If Þ 62 w, then by maximality : Þ  2 w, so : 2 w, which
means by assumption that : 2 v. Hence  62 v. a
The next lemma gives a more detailed look at the transitions which are
modeled by R].
Lemma 2.7.50 Let w 2 W ] with Þ' 2 w. Then there exists a state
v 2 W ] such that ' 2 v and w R] v.
Proof 0. Because we can extend -consistent sets to maximal consistent
ones by the Lindenbaum Lemma 2.7.48, it is enough to show that v0 WD
f'g [ f j  2 wg is -consistent. If this succeeds, we extend the
Plan
set v0 to obtain v.
1.
Assume it is not.
Then we have ` . 1 ^ : : : ^  k/ ! :'
for some  1; : : : ;  k 2 v0, from which we obtain with (G) and (K)
that ` . 1 ^ : : : ^  k/ ! :': Because  1 ^ : : : ^  k !
. 1 ^ : : : ^  k/; this implies `  1 ^ : : : ^  k ! :': Since

254
CHAPTER 2. CATEGORIES
 1; : : : ;  k 2 w, we conclude from Lemma 2.7.47 that  1^: : :^
 k 2 w; thus we have :' 2 w by modus ponens; hence :Þ' 2 w.
Since w is maximal, this implies Þ' 62 w. But this is a contradiction.
So v0 is consistent; thus there exists by the Lindenbaum Lemma a max-
imal consistent set v with v0  v. We have in particular ' 2 v, and we
know that  2 w implies  2 v; hence hw; vi 2 R]: a
This helps in characterizing the model, in particular the validity relation
ˆ by the well-known Truth Lemma.
Lemma 2.7.51 M]; w ˆ ' iff ' 2 w.
Proof The proof proceeds by induction on formula '. The statement
is trivially true if ' D p 2 ˚ is a propositional letter. The set of
Plan
formulas for which the assertion holds is certainly closed under Boolean
operations, so the only interesting case is the case that the formula in
question has the shape Þ' and that the assertion is true for '.
“)”: If M]; w ˆ Þ', then we can ﬁnd some v with w R] v and
M]; v ˆ '. Thus there exists v with hw; vi 2 R] such that ' 2 v
by hypothesis, which in turn means Þ' 2 w.
“(”: Assume Þ' 2 w; hence there exists v 2 W ] with w R] v and
' 2 v; thus M]; v ˆ '. But this means M]; w ˆ Þ'.
a
Finally, we obtain:
Theorem 2.7.52 Any normal logic is complete with respect to its canon-
ical model.
Proof Let ˙ be a -consistent set for the normal logic . Then there
exists by Lindenbaum’s Lemma 2.7.48 a maximal -consistent set ˙C
with ˙  ˙C. By the Truth Lemma, we have now M]; ˙C ˆ ˙.
a
We will generalize modal logics now to coalgebraic logics, which is par-
ticularly streamlined to be interpreted within the context of coalgebras
and which contains the interpretation of modal logics as a special case.
Neighborhood models may be captured in this realm as well, which in-
dicates that the coalgebraic way of thinking about logics is a useful gen-
eralization of the relational way.

2.7. MODAL LOGICS
255
2.7.3
Coalgebraic Logics
We have seen several points where coalgebras and modal logics touch
each other, for example, morphisms for Kripke models are based on
morphisms for the underlying P-coalgebra, as a comparison of Exam-
ple 2.1.10 and Lemma 2.7.25 demonstrates. Let M D .W; R; V / be a
Kripke model; then the accessibility relation R  W  W can be per-
ceived as a map, again denoted by R, with the signature W ! P .W /.
Map V W ˚ ! P .W /, which indicates the validity of atomic propo-
sitions, can be encoded through a map V1 W W ! P .˚/ upon setting
V1.w/ WD fp 2 ˚ j w 2 V.p/g: Both V and V1 describe the same rela-
tion fhp; wi 2 ˚  W j M; w ˆ pg; albeit from different angles. They
are trivially interchangeable for each other. This new representation has
the advantage of describing the model from the vantage point w.
Deﬁne FX WD P .X/  P .˚/ for the set X, and put, given map f W
X ! Y , .Ff /.A; Q/ WD hf

A

; Qi D h.Pf /A; Qi for A  X; Q 
˚; then F is an endofunctor on Set. Hence we obtain from the Kripke
model M the F-coalgebra .W; / with .w/ WD R.w/  V1.w/. This
construction can easily be reversed: given a F-coalgebra .W; /, we put
R.w/ WD 1..w// and V1.w/ WD 2..w// and construct V from V1;
then .W; R; V / is a Kripke model (here 1; 2 are the projections). Thus
Kripke models and F-coalgebras are in a one-to-one correspondence
with each other. This correspondence goes a bit deeper, as can be seen
when considering morphisms.
Proposition 2.7.53 Let M D .W; R; V / and N D .X; S; Y / be Kripke
models with associated F-coalgebras .W; / resp. .X; ı/. Then these
statements are equivalent for a map f W W ! X:
1. f W .W; / ! .X; ı/ is a morphism of coalgebras.
2. f W M ! N is a morphism of Kripke models.
Proof 1 ) 2: We obtain for each w 2 W from the deﬁning equation
.Ff / ı  D ı ı f the equalities f

R.w/

D S.f .w//; and V1.w/ D
Y1.f .w//: Since f

R.w/

D .Pf /.R.w//, we conclude that .Pf / ı
R D S ıf , so f is a morphism of the P-coalgebras. We have moreover
for each atomic sentence p 2 ˚
w 2 V.p/ , p 2 V1.w/ , p 2 Y1.f .w// , f .w/ 2 Y.p/:
This means V D f 1 ı Y , so that f W M ! N is a morphism.

256
CHAPTER 2. CATEGORIES
2 ) 1: Because we know that S ı f D .Pf / ı R, and because one
shows as above that V1 D Y1 ı f , we obtain for w 2 W
.ı ı f /.w/
D
hS.f .w//; Y1.f .w//i D h.Pf /.R.w//; V1.w/i
D

.Ff / ı 

.w/:
Hence f W .W; / ! .X; ı/ is a morphism for the F-coalgebras. a
Given a world w, the value of .w/ represents the worlds which are ac-
cessible from w, making sure that the validity of the atomic propositions
is maintained; recall that they are not affected by a transition. This infor-
mation is to be extracted in a variety of ways. We need predicate liftings
for this. Before we deﬁne them, we observe that the same mechanism
works for neighborhood models.
Example 2.7.54 Let N D .W; N; V / be a neighborhood model. Deﬁne
functor G by putting G.X/ WD V.X/P .˚/ for sets, and if f W X ! Y
is a map, put .Gf /.U; Q/ WD h.Vf /U; Qi. Then G is an endofunctor
on Set. The G-coalgebra .W; / associated with N is deﬁned through
.w/ WD hN.w/; V1.w/i (with V1 deﬁned through V as above).
Let M D .X; M; Y / be another neighborhood model with associated
coalgebra
.X; /.
Exactly
the
same
proof
as
the
one
for
Proposition 2.7.53 shows that f W N ! M is a neighborhood mor-
phism iff f W .W; / ! .X; / is a coalgebra morphism. ✌
Proceeding to deﬁne predicate liftings, let Pop W Set ! Set be the
contravariant power set functor, i.e., given the set X, Pop.X/ is the
power set P .X/ of X, and if f W X ! Y is a map, then .Popf / W
Pop.Y / ! Pop.Y / works as B 7! f 1
B

.
Deﬁnition 2.7.55 Given a (covariant) endofunctor T on Set, a predicate
lifting  for T is a monotone natural transformation  W Pop ! PopıT .
Interpret A 2 Pop.X/ as a predicate on X, then X.A/ 2 Pop.TX/ is
a predicate on TX; hence X lifts the predicate into the realm of func-
tor T; the requirement of naturalness is intended to reﬂect compatibility
with morphisms, as we will see below. Thus a predicate lifting helps
in specifying a requirement on the level of sets, which it then transports
onto the level of those sets that are controlled by functor T. Techni-
cally, this requirement means that this diagram commutes, whenever

2.7. MODAL LOGICS
257
f W X ! Y is a map:
Hence we have X.f 1
G

/ D .Tf /1
Y .G/

for any G  Y .
Finally, monotonicity says that X.D/  X.E/, whenever D  E 
X; this condition models the requirement that information about states
should only depend on their precursors. Informally it is reﬂected in the
rule ` .' !  / ! .' !  /.
This example illuminates the idea.
Example 2.7.56 Let F D P ./  P˚ be deﬁned as above; put for the
set X and for D  X
X.D/ WD fhD0; Qi 2 P .X/  P .˚/ j D0  Dg:
This deﬁnes a predicate lifting  W Pop ! Pop ı F. In fact, let f W
X ! Y be a map and G  Y , then
X.f 1
G

/ D fhD0; Qi j D0  f 1
G

g
D fhD0; Qi j f

D0
 Gg
D .Ff /1
fhG0; Qi 2 P .Y /  P .˚/ j G0  Gg

D .Ff /1
Y .G/

(remember that Ff leaves the second component of a pair alone). It is
clear that X is monotone for each set X.
Let  W W ! FW be the coalgebra associated with Kripke model
M WD .W; R; V /, and look at this (' is a formula):
w 2 1
W .ŒŒ'M/

, .w/ 2 W .ŒŒ'M/
, hR.w/; V1.w/i 2 W .ŒŒ'M/
, R.w/  ŒŒ'M
, w 2 ŒŒ'M
This means that we can describe the semantics of the -operator through
a predicate lifting, which cooperates with the coalgebra’s dynamics.

258
CHAPTER 2. CATEGORIES
Note that it would be equally possible to do this for the Þ-operator:
deﬁne the lifting through D 7! fhD0; Qi j D0 \ D 6D ;g: But we will
stick to the -operator, keeping up with tradition. ✌
Example 2.7.57 The same technique works for neighborhood models.
In fact, let .W; / be the G-coalgebra associated with neighborhood
model N D .W; N; V / as in Example 2.7.54, and deﬁne
X.D/ WD fhV; Qi 2 V.X/  P .˚/ j D 2 V g:
Then X W P .X/ ! P .V.X/  P .˚// is monotone, because the ele-
ments of VX are upper closed. If f W .W; / ! .X; / is a G-coalgebra
morphism, we obtain for D  X
W .f 1
D

/ D fhV; Qi 2 V.W /  P .˚/ j f 1
D

 V g
D fhV; Qi 2 V.W /  P .˚/ j D 2 .Vf /.V /g
D .Gf /1
fhV 0; Qi 2 V.X/  P .˚/ j D 2 V 0g

D .Gf /1
X.D/

Consequently,  is a predicate lifting for G. We see also for formula '
w 2 W .ŒŒ'N/ , hŒŒ'N; V1.w/i 2 X.ŒŒ'N/
, ŒŒ'N 2 N.w/
(by deﬁnition of )
, w 2 ŒŒ'N
Hence we can deﬁne the semantics of the -operator also in this case
through a predicate lifting. ✌
There is a general mechanism permitting us to deﬁne predicate liftings,
which is outlined in the next lemma.
Lemma 2.7.58 Let  W T ! P be a natural transformation, and deﬁne
X.D/ WD fc 2 TX j X.c/  Dg
for D  X. Then  deﬁnes a predicate lifting for T.
Proof It is clear from the construction that D 7! X.D/ deﬁnes a
monotone map, so we have to show that the diagram below is com-
mutative for f W X ! Y .

2.7. MODAL LOGICS
259
We note that
X.c/  f 1
E

, f

X.c/

 E , .Pf /.X.c//  E
and
.Pf / ı X D Y ı .Tf /;
because  is natural. Hence we obtain for E  Y :
X.f 1
E

/ D fc 2 TX j X.c/  f 1
E

g
D fc 2 TX j

.Pf / ı X

.c/  Eg
D fc 2 TX j .Y ı Tf /.c/  Eg
D .Tf /1
fd 2 TY j Y .d/  Eg

D

.Tf /1 ı Y

.E/:
a
Let us return to the endofunctor F D P ./  P .˚/ and ﬁx for the mo-
ment an atomic proposition p 2 ˚. Deﬁne the constant function
p;X.D/ WD fhD0; Qi 2 FX j p 2 Qg:
Then an easy calculation shows that p W Pop ! Pop ı F is a natural
transformation, hence a predicate lifting for F. Let  W W ! FW
be a coalgebra with carrier W which corresponds to the Kripke model
M D .W; R; V /; then
w 2 .1 ı p;W /.D/
,
.w/ 2 p;W .D/ , p 2 2..w//
,
w 2 V.p/;
which means that we can use p for expressing the meaning of formula
p 2 ˚. A very similar construction can be made for functor G, leading
to the same conclusion.
We cast this into a more general framework now. Let `X W X ! f0g be
the unique map from set X to the singleton set f0g. Given A  T.f0g/,
deﬁne A;X.D/ WD fc 2 TX j .T`X/.c/ 2 Ag D .T`X/1
A

. This
deﬁnes a predicate lifting for T. In fact, let f W X ! Y be a map; then
`X D `Y ı f , so
.Tf /1ı.T`Y /1 D

.T`Y /ı.Tf /
1D

T.`Y ıf /
1 D .T`X/1;

260
CHAPTER 2. CATEGORIES
hence
A;X.f 1
B

/ D .Tf /1
A;Y .B/

:
As we have seen, this construction is helpful for capturing the semantics
of atomic propositions.
Negation can be treated as well in this framework. Given a predicate
lifting  for T, we deﬁne for the set X and A  X the set
:
X.A/ WD .TX/ n X.X n A/I
then this deﬁnes a predicate lifting for T. This is easily checked: mono-
tonicity of : follows from  being monotone, and since f 1 is com-
patible with the Boolean operations, naturality follows.
Summarizing, those operations which are dear to us when interpreting
modal logics through a Kripke model or through a neighborhood model
can also be represented using predicate liftings.
We now take a family L of predicate liftings and deﬁne a logic for
it.
Deﬁnition 2.7.59 Let T be an endofunctor on the category Set of sets
with maps, and let L be a set of predicate listings for T. The formulas
for the language L.L/ are deﬁned through
L.L/
' WWD ? j '1 ^ '2 j :' j Œ'
with  2 L.
The semantics of a formula in L.L/ in a T-coalgebra .W; / is deﬁned
recursively by describing the sets of worlds ŒŒ' in which formula '
holds (with w ˆ ' iff w 2 ŒŒ'):
w ˆ '
ŒŒ? WD ;
ŒŒ'1 ^ '2 WD ŒŒ'1 \ ŒŒ'2
ŒŒ:' WD W n ŒŒ'
ŒŒŒ' WD .1 ı C /.ŒŒ'/:
The most interesting deﬁnition is of course the last one. It is deﬁned
through a modality for the predicate lifting , and it says that formula
Œ' holds in world w iff the transition .w/ achieves a state which
is lifted by  from one in which ' holds. Hence each successor to w
satisﬁes the predicate for ' lifted by .

2.7. MODAL LOGICS
261
Example 2.7.60 Continuing Example 2.7.56, we see that the simple
modal logic can be deﬁned as the modal logic for L D fg [ fp j
p 2 ˚g, where  is deﬁned in Example 2.7.56, and p are the constant
liftings associated with ˚. ✌
We obtain also in this case the invariance of validity under morphisms.
Proposition 2.7.61 Let f W .W; / ! .X; ı/ be a T-coalgebra mor-
phism. Then
w ˆ ' , f .w/ ˆı '
holds for all formulas ' 2 L.L/ and all worlds w 2 W .
Proof The proof proceeds by induction on ', the interesting case occur-
ring for a modal formula Œ' with  2 L. So assume that the hypothesis
is true for '; then we have
f 1
ŒŒŒ'ı

D

.ı ı f /1 ı D

.ŒŒ'ı/
D

.T.f / ı /1 ı D

.ŒŒ'ı/
(f is a morphism)
D

1 ı .Tf /1 ı D

.ŒŒ'ı/
D

1 ı C ı f 1
.ŒŒ'ı/
( is natural)
D

1 ı C

.ŒŒ'/
(by hypothesis)
D ŒŒŒ'
a
Let .C; / be a T-coalgebra, then we deﬁne the theory of c:
T h.c/
T h.c/ WD f' 2 L.L/ j c ˆ 'g
for c 2 C. Two worlds which have the same theory cannot be distin-
guished through formulas of the logic L.L/.
Deﬁnition 2.7.62 Let .C; / and .D; ı/ be T-coalgebras, c 2 C and
d 2 D.
 We call the states c and d logically equivalent iff T h.c/ D
T hı.d/.
 The states c and d are called behaviorally equivalent iff there
exists a T-coalgebra .E; / and morphisms .C; /
f! .E; /
g 
.D; ı/ such that f .c/ D g.d/.
Logical,
behavioral
equivalence

262
CHAPTER 2. CATEGORIES
Thus, logical equivalence looks locally at all the formulas which are
true in a state and then compares two states with each other. Behavioral
equivalence looks for an external instance, viz., a mediating coalgebra,
and at morphisms; whenever we ﬁnd states the image of which coincide,
we know that the states are behaviorally equivalent.
This implication is fairly easy to obtain.
Proposition 2.7.63 Behaviorally equivalent states are logically equiv-
alent.
Proof Let c 2 C and d 2 D be behaviorally equivalent for the T-
coalgebras .C; / and .D; ı/, and assume that we have a mediating T-
coalgebra .E; / with morphisms
.C; /
f
! .E; /
g
  .D; ı/:
and f .c/ D g.d/. Then we obtain
' 2 T h.c/
,
c ˆ ' , f .c/ ˆ ' , g.d/ ˆ ' , d ˆı '
,
' 2 T hı.d/
from Proposition 2.7.61. a
We have seen that coalgebras are useful when it comes to generalize
modal logics to coalgebraic logics. Morphisms arise in a fairly natural
way in this context, giving rise to behaviorally equivalent coalgebras.
It is quite clear that bisimilarity can be treated on this level as well,
by introducing a mediating coalgebra and morphisms from it; bisimilar
states are logically equivalent; the argument to show this is exactly as
in the case above through Proposition 2.7.61. In each case, the question
arises whether the implications can be reversed—are logically equiva-
lent states behaviorally equivalent? Bisimilar? Answering this question
requires a fairly elaborate machinery and depends strongly on the un-
derlying functor. We will not discuss this question here but rather point
to the literature, e.g., to [Pat04]. For the subprobability functor, some
answers and some techniques can be found in [DS11].
The following example discusses the basic modal language with no
atomic propositions.
Example 2.7.64 We interpret L.fÞg/ with ˚ D ; through P-coal-
gebras, i.e., through transition systems. Given a transition system .S; R/,

2.7. MODAL LOGICS
263
denote by 
 the equivalence provided by logical equivalence, so that
s 
 s0 iff states s and s0 cannot be separated through a formula in the
logic, i.e., iff T hR.s/ D T hR.s0/. Then  W .S; R/ ! .S=
; R=
/ is
a coalgebra morphism. Here
R=
 WD fhŒs1 ; Œs2i j hs1; s2i 2 Rg:
In fact, look at this diagram:
Then
Œs2 2 R=
.Œs1/ , Œs2 2
˚
Œs j s 2 Œs1

D P ./

R=
.Œs1/

;
which means that the diagram commutes. We denote the factor model
.S=
; R=
/ by .S0; R0/ and denote the class of an element without an
indication of the equivalence relation. It will be clear from the context
from which set of worlds a state will be taken.
Call the transition systems .S; R/ and .T; L/ logically equivalent iff
for each state in one system there exists a logically equivalent state in
the other one. We carry over behavioral equivalence and bisimilarity
from individual states to systems, taking the discussion for coalgebras
in Sect. 2.6.1 into account. Call the transition systems .S; R/ and .T; L/
behaviorally equivalent iff there exists a transition system .U; M/ with
surjective morphisms
Finally, they are called bisimilar iff there exists a transition system
Bisimilar
.U; M/ with surjective morphisms
We claim that logical equivalent transition systems have isomorphic fac-
tor spaces under the equivalence induced by the logic, provided both are
image ﬁnite. Consider this diagram:

264
CHAPTER 2. CATEGORIES
with 	.Œs/ WD Œt iff T hR.s/ D T hL.t/. Thus 	 preserves classes
of logically equivalent states. It is immediate that 	 W S0 ! T 0 is a
bijection, so commutativity has to be established.
Before working on the diagram, we show ﬁrst that for any ht; t0i 2 L
and for any s 2 S with T hR.s/ D T hL.t/, there exists s0 2 S with
hs; s0i 2 R and T hR.s0/ D T hL.t0/ (written more graphically in terms
of arrows, we claim that t !L t0 and T hR.s/ D T hL.t/ together imply
the existence of s0 with s !R s0 and T hR.s0/ D T hL.t0/). This is
established by adapting the idea from the proof of the Hennessy–Milner
Theorem 2.7.32 to the situation at hand. Well, then: Assume that such
a state s0 cannot be found. Since L; t0 ˆ >, we know that L; t ˆ Þ>;
thus T hL.t/ D T hR.s/ 6D ;. Let R.s/ D fs1; : : : ; skg for some k  1,
then we can ﬁnd for each si a formula  i with L; t0 ˆ  i and R; si 6ˆ
 i. Thus L; t ˆ Þ. 1 ^ : : : ^  k/, but R; s 6ˆ Þ. 1 ^ : : : ^  k/,
which contradicts the assumption that T hR.s/ D T hL.t/. This uses
only image ﬁniteness of .S; R/, by the way.
Now let s 2 S with Œt1 2 L0
	.Œs/

D L0
Œt

for some t 2 T .
Thus ht; t1i 2 L, so we ﬁnd s1 2 S with T hR.s1/ D T hL.t1/ and
hs; s1i 2 R. Consequently, Œt1 D 	.Œs1/ 2 P.	/

R0.Œs/

. Hence
L0
	.Œs/

 P .	/

R0.Œs/

.
Working on the other inclusion, we take Œt1 2 P .	/

R0.Œs

, and we
want to show that Œt1 2 L0
	.Œs/

. Now Œt1 D 	.Œs1/ for some
s1 2 S with hs; s1i 2 R; hence T hR.s1/ D T hL.t1/. Put Œt D 	.Œs/;
thus T hR.s/ D T hL.t/. Because .T; L/ is image ﬁnite as well, we
may conclude from the Hennessy–Milner argument above—by inter-
changing the rˆoles of the transition systems—that we can ﬁnd t2 2 T
with ht; t2i 2 L so that T hL.t2/ D T hR.s1/ D T hL.t1/. This im-
plies Œt2 D Œt1 and Œt1 2 L0.Œt/ D L0
	.Œs/

. Hence L0
	.Œs/

	
P .	/

R0.Œs/

.
Thus the diagram above commutes, and we have shown that the factor
models are isomorphic. Consequently, two image ﬁnite transition sys-
tems which are logically equivalent are behaviorally equivalent with one
of the factors acting as a mediating system. ✌

2.7. MODAL LOGICS
265
Clearly, behaviorally equivalent systems are bisimilar, so that we obtain
these relationships:
We ﬁnally give an idea of modeling CTL* as a popular logic for model
checking coalgebraically. This shows how this modeling technique is
applied, and it shows also that some additional steps become necessary,
since things are not always straightforward.
Example 2.7.65 The logic CTL* is used for model checking [CGP99].
The abbreviation CTL stands for computational tree logic. CTL* is ac-
tually one of the simpler members of this family of tree logics used
for this purpose, some of which involve continuous time [BHHK03,
Dob07]. The logic has state formulas and path formulas; the former
ones are used to describe a particular state in the system, and the latter
ones express dynamic properties. Hence CTL* operates on two levels.
These operators are used:
State operators They include the operators A and E, indicating that a
property holds in a state iff it holds on all paths resp. on at least
one path emanating from it.
Path operators They include the operators:
 X for next time—a property holds in the next, i.e., second
state of a path,
 F for in the future—the speciﬁed property holds for some
state on the path,
 G for globally—the property holds always on a path,
 U for until—this requires two properties as arguments; it
holds on a path if there exists a state on the path for which
the second property holds, and the ﬁrst one holds on each
preceding state.
State formulas are given through this syntax:
' WWD ? j p j :' j '1 ^ '2 j E j A 

266
CHAPTER 2. CATEGORIES
with p 2 ˚ an atomic proposition and  a path formula. Path formulas
are given through
 WWD ' j : j  1 ^  2 j X j F j G j  1U 2
with ' a state formula. So both state and path formulas are closed under
the usual Boolean operations; each atomic proposition is a state formula,
and state formulas are also path formulas. Path formulas are closed
under the operators X; F; G; U, and the operators A and E convert a path
formula to a state formula.
Let W be the set of all states, and assume that V W ˚ ! P .W / assigns
to each atomic formula the states for which it is valid. We assume also
that we are given a transition relation R  W  W ; it is sometimes as-
sumed [CGP99] that R is left total, but this is mostly for computational
purposes, so we will not make this assumption here. Put
S WD fhw1; w2; : : :i 2 W N j wi R wiC1 for all i 2 Ng
as the set of all inﬁnite R-paths over W . The interpretation of formulas
is then deﬁned as follows:
State formulas Let w 2 W , '; '1; '2 be state formulas and  be a path
formula, then w ˆ > holds always, and proceeding inductively,
we put
s ˆ p , w 2 V.p/
w ˆ :' , w ˆ ' is false
w ˆ '1 ^ '2 , w ˆ '1 and w ˆ '2
w ˆ E ,  ˆ  for some path  starting from w
w ˆ A ,  ˆ  for all paths  starting from w
Path formulas Let  2 S be an inﬁnite path with the ﬁrst node 1; k
is the path with the ﬁrst k nodes deleted;  is a path formula and
' a state formula; then
 ˆ ' , 1 ˆ '
 ˆ : ,  ˆ  is false
 ˆ  1 ^  2 ,  ˆ  1 and  ˆ  2
 ˆ X , 1 ˆ  
 ˆ F , k ˆ  for some k  0

2.7. MODAL LOGICS
267
 ˆ G , k ˆ  for all k  0
 ˆ  1U 2 , 9k  0 W k ˆ  2 and 80  j < k W j ˆ  1:
Thus a state formula holds on a path iff it holds on the ﬁrst node, X 
holds on path  iff  holds on  with its ﬁrst node deleted, and  1U 2
holds on path  iff  2 holds on k for some k, and iff  1 holds on i
for all i preceding k.
We need to provide interpretations only for conjunction, negation, for
A, X, and U. This is so since E is the nabla of A, G is the nabla of F,
and F is equivalent to .:?/U . Conjunction and negation are easily
interpreted, so we have to take care only of the temporal operators A, X,
and U.
A coalgebraic interpretation reads as follows. The P-coalgebras to-
gether with their morphisms form a category CoAlg. Let .X; R/ be a
P-coalgebra, then
R.X; R/ WD f.xn/n2N 2 X1 j xn R xnC1 for all n 2 Ng
is the object part of a functor, .Rf /

.xn/n2N

WD .f .xn/n2N/ sends
each coalgebra morphism f W .X; R/ ! .Y; S/ to a map Rf W R.X; R/
! R.Y; S/, which maps .xn/n2N to f .xn/n2N; recall that x R x0 im-
plies f .x/ S f .x0/. Thus R W CoAlg ! Set is a functor. Note that the
transition structure of the underlying Kripke model is already encoded
through functor R. This is reﬂected in the deﬁnition of the dynamics
 W X ! R.X; R/  P .˚/ upon setting
.x/ WD
˝
fw 2 R.X; R/ j w1 D xg; V1.x/i;
where V1 W X ! P .˚/ is deﬁned according to V W ˚ ! P .X/
as above. Deﬁne for the model M WD .W; R; V / the map R.W;R/ W
C 7! fhC 0; Ai 2 P .R.W; R//  P .˚/ j C 0  Cg; then  deﬁnes
a natural transformation Pop ı R ! Pop ı F ı R (the functor F has
been deﬁned in Example 2.7.56); note that we have to check naturality
in terms of model morphisms, which are in particular morphisms for the
underlying P-coalgebra. Thus we can deﬁne for w 2 W
w ˆM A , w 2

1 ı R.W;R/

.ŒŒ M/
In a similar way, we deﬁne w ˆM p for atomic propositions p 2 ˚;
this is left to the reader.

268
CHAPTER 2. CATEGORIES
The interpretation of path formulas requires a slightly different approach.
We deﬁne
R.X;R/.A/ WD f 2 R.X; R/ j 1 2 Ag;
#R.X;R/.A; B/ WD
[
k2N
f 2 R.X; R/ j k 2 B; i 2 A for 0  i < kg;
whenever A; B 2 R.X; R/. Then  W Pop ı R ! Pop ı R and # W
.Pop ı R/  .Pop ı R/ ! Pop ı R are natural transformations, and we
put
ŒŒX M WD R.M;R/.ŒŒ M/;
ŒŒ 1U 2M WD #R.X;R/.ŒŒ 1M; ŒŒ 2M/:
The example shows that a two-level logic can be interpreted as well
through a coalgebraic approach, provided the predicate liftings which
characterize this approach are complemented by additional natural trans-
formations (which are called bridge operators in [Dob09]). It indicates
also that deﬁning a coalgebraic logic requires ﬁrst and foremost the def-
inition of a functor and of natural transformations. Thus a certain over-
head comes with it.
✌
2.8
Bibliographic Notes
The monograph by Mac Lane [ML97] discusses all the deﬁnitions and
basic constructions; the text [BW99] takes much of its motivation for
categorical constructions from applications in computer science. Mon-
ads are introduced following essentially Moggi’s seminal paper
[Mog91]. The textbook [Pum99] is an exposition ﬁne-tuned toward
students interested in categories; the proof of Lemma 2.3.24 and the
discussion on Yoneda’s construction follow its exposition rather closely.
There are many other ﬁne textbooks on categories available, catering
also to the needs of computer scientists, among them [Awo10, Bor94a,
Bor94b]; giving an exhaustive list is difﬁcult.
The discrete probability functor has been studied extensively in [Sok05],
its continuous step twin in [Gir81, Dob03]. The use of upper closed sub-
sets for the interpretation of game logic is due to Parikh [Par85]; Pauly

2.9. EXERCISES
269
and Parikh [PP03] deﬁnes bisimilarity in this context. The coalgebraic
interpretation is investigated in [Dob10]. Coalgebras are carefully dis-
cussed at length in [Rut00], to which the present discussion in Sect. 2.6
owes much of its structure.
The programming language Haskell is discussed in a growing num-
ber of accessible books - a personal selection includes [OGS09, Lip11];
the present short discussion is taken from [Dob12a]. The representation
of modal logics draws substantially from [BdRV01], and the discussion
on coalgebraic logic is strongly inﬂuenced by Pattinson [Pat04], the sur-
vey paper [DS11], and the monograph [Dob09].
2.9
Exercises
Exercise 2.1 The category uGraph has as objects undirected graphs. A
morphism f W .G; E/ ! .H; F / is a map f W G ! H such that
ff .x/; f .y/g 2 F whenever fx; yg 2 E (hence a morphism respects
edges). Show that the laws of a category are satisﬁed.
Exercise 2.2 A morphism f W a ! b in a category K is a split monomo-
rphism iff it has a left inverse, i.e., there exists g W b ! a such that
g ı f D ida. Similarly, f is a split epimorphism iff it has a right
inverse, i.e. there exists g W b ! a such that f ı g D idb.
1. Show that every split monomorphism is monic and every split
epimorphism is epic.
2. Show that a split epimorphism that is monic must be an isomor-
phism.
3. Show that for a morphism f W a ! b, it holds that:
(i) f is a split monomorphism , homK.f; x/ is surjective for
every object x,
(ii) f is a split epimorphism , homK.x; f / is surjective for
every object x,
4. Characterize the split monomorphisms in Set. What can you say
about split epimorphisms in Set?

270
CHAPTER 2. CATEGORIES
Exercise 2.3 The category Par of sets and partial maps is deﬁned as
follows:
1. Objects are sets.
2. A morphism in homPar.A; B/ is a partial map f W A * B, i.e., it
is a set-theoretic map f W car.f / ! B from a subset car.f /  A
into B. car.f / is called the carrier of f .
3. The identity idA W A * A is the usual identity map with car.idA/
D A.
4. For f W A * B and g W B * C the composition g ı f is deﬁned
as the usual composition g.f .x// on the carrier:
car.g ı f / WD fx 2 car.f / j f .x/ 2 car.g/g:
1. Show that Par is a category and characterize its monomorphisms
and epimorphisms.
2. Show that the usual set-theoretic Cartesian product you know is
not the categorical product in Par. Characterize binary products
in Par.
Exercise 2.4 Deﬁne the category Pos of ordered sets and monotone
maps. The objects are ordered sets .P; /; morphisms are monotone
maps f W .P; / ! .Q; v/, i.e., maps f W P ! Q such that x  y
implies f .x/ v f .y/. Composition and identities are inherited from
Set.
1. Show that under this deﬁnition Pos is a category.
2. Characterize monomorphisms and epimorphisms in Pos.
3. Give an example of an ordered set .P; / which is isomorphic (in
Pos) to .P; /op but .P; / ¤ .P; /op.
Show that if .P; / is isomorphic (in Pos) to a totally ordered set
.Q; v/, then .P; / is also totally ordered. Use this result to give an
example of a monotone map f W .P; / ! .Q; v/ that is monic and
epic but not an isomorphism.
Exercise 2.5 Given a set X, the set of (ﬁnite) strings of elements of X
is again denoted by X.
1. Show that X forms a monoid under concatenation, the free
monoid over X.

2.9. EXERCISES
271
2. Given a map f W X ! Y , extend it uniquely to a monoid mor-
phism f  W X ! Y . In particular for all x 2 X, it should hold
that f .hxi/ D hf .x/i, where hxi denotes the string consisting
only of the character x.
3. Under what conditions on X is X a commutative monoid, i.e.,
has a commutative operation?
Exercise 2.6 Let .M; / be a monoid. We deﬁne a category M as fol-
lows: it has only one object , homM.; / D M with id as the unit of
the monoid, and composition is deﬁned through m2 ı m1 WD m2  m1.
1. Show that M indeed forms a category.
2. Characterize the dual category Mop. When are M and Mop equal?
3. Characterize monomorphisms, epimorphisms, and isomorphisms
for ﬁnite M. (What happens in the inﬁnite case?)
Exercise 2.7 Let .S; A/ and .T; B/ be measurable spaces, and assume
that the -algebra B is generated by B0. Show that a map f W S ! T
is A-B-measurable iff f 1
B0

2 A for all B0 2 B0.
Exercise 2.8 Let .S; A/ and .T; B/ be measurable spaces and f W S !
T be A-B-measurable.
Deﬁne f./.B/ WD .f 1
B

/ for  2
P .S; A/ ; B 2 B, then f W P .S; A/ ! P .T; B/. Show that f is
}}}.A/-}}}.B/-measurable. Hint: Use Exercise 2.7.
Exercise 2.9 Let S be a countable sets with p W S ! Œ0; 1 as a discrete
probability distribution; thus P
s2S p.s/ D 1; denote the corresponding
probability measure on P .S/ by p; hence p.A/ D P
s2A p.s/. Let
T be an at most countable set with a discrete probability distribution q.
Show that a map f W S ! T is a morphism for the probability spaces
.S; P .S/ ; p/, and .T; P .T / ; q/ iff q.t/ D P
f .s/Dt p.s/ holds for
all t 2 T .
Exercise 2.10 Show that fx 2 Œ0; 1 j hx; xi 2 Eg 2 B.Œ0; 1/, when-
ever E 2 B.Œ0; 1/ ˝ B.Œ0; 1/.
Exercise 2.11 Let us chase some objects through diagrams. Consider
the following diagram in a category K:

272
CHAPTER 2. CATEGORIES
1. Show that if the left inner and right inner diagrams commute, then
the outer diagram commutes as well.
2. Show that if the outer and right inner diagrams commute and s is
a monomorphism, then the left inner diagram commutes as well.
3. Give examples in Set such that:
(a) the outer and left inner diagrams commute, but not the right
inner diagram,
(b) the outer and right inner diagrams commute, but not the left
inner diagram.
Exercise 2.12 Give an example of a product in a category K such that
one of the projections is not epic.
Exercise 2.13 What can you say about products and sums in the cat-
egory M given by a ﬁnite monoid .M; /, as deﬁned in Exercise 2.5?
(Consider the case that .M; / is commutative ﬁrst.)
Exercise 2.14 Show that the product topology has this universal prop-
erty: f W .D; D/ ! .S T; G H/ is continuous iff S ıf W .D; D/ !
.S; G/ and T ı f W .D; D/ ! .T; H/ are continuous. Formulate and
prove the corresponding property for morphisms in Meas.
Exercise 2.15 A collection of morphisms

fi W a ! bi

i2I with the
same domain in category K is called jointly monic whenever the follow-
ing holds: If g1 W x ! a and g2 W x ! a are morphisms such that
fi ı g1 D fi ı g2 for all i 2 I, then g1 D g2. Dually one deﬁnes a
collection of morphisms to be jointly epic.
Show that the projections from a categorical product are jointly monic
and the injections into a categorical sum are jointly epic.
Exercise 2.16 Assume the following diagram in a category K com-
mutes:
Prove or disprove: if the outer diagram is a pullback, one of the inner
diagrams is a pullback as well. Which inner diagram has to be a pullback
for the outer one to be also a pullback?

2.9. EXERCISES
273
Exercise 2.17 Suppose f; g W a ! b are morphisms in a category C.
An equalizer of f and g is a morphism e W x ! a such that f ıe D gıe,
and whenever h W y ! a is a morphism with f ı h D g ı h, then there
exists a unique j W y ! x such that h D e ı j .
This is the diagram:
1. Show that equalizers are uniquely determined up to isomorphism.
2. Show that the morphism e W x ! a is a monomorphism.
3. Show that a category has pullbacks if it has products and equaliz-
ers.
Exercise 2.18 A terminal object in category K is an object 1 such that
for every object a, there exists a unique morphism Š W a ! 1.
1. Show that terminal objects are uniquely determined up to isomor-
phism.
2. Show that a category has (binary) products and equalizers if it has
pullbacks and a terminal object.
Exercise 2.19 Show that the coproduct -algebra has this universal
property: f W .S C T; A C B/ ! .R; X/ is A C B-X-measurable
iff f ı iS and f ı iT are A-X- resp. B-X-measurable. Formulate and
prove the corresponding property for morphisms in Top.
Exercise 2.20 Assume that in category K, any two elements have a
product. Show that a  .b  c/ and .a  b/  c are isomorphic.
Exercise 2.21 Prove Lemma 2.2.22.
Exercise 2.22 Assume that the coproducts a C a0 and b C b0 exist in
category K. Given morphisms f W a ! b and f 0 W a0 ! b0, show
that there exists a unique morphism q W a C a0 ! b C b0 such that this
diagram commutes:

274
CHAPTER 2. CATEGORIES
Exercise 2.23 Show that the category Prob has no coproducts (Hint:
Considering .S; C/ C .T; D/, show that, e.g., i1
S

iS

A

equals A for
A  S).
Exercise 2.24 Identify the product of two objects in the category Rel of
relations.
Exercise 2.25 We investigate the epi-mono factorization in the cate-
gory Meas of measurable spaces. Fix two measurable spaces .S; A/
and .T; B/ and a morphism f W .S; A/ ! .T; B/.
1. Let A=ker .f / be the largest -algebra X on S=ker .f / render-
ing the factor map ker.f / W S ! S=ker .f / A-X-measurable.
Show that A=ker .f / D fC  S=ker .f / j 1
ker.f /

C

2 Ag, and
show that A=ker .f / has this universal property: given a measur-
able space .Z; C/, a map g W S=ker .f / ! Z is A=ker .f /-C
measurable iff g ı ker.f / W S ! Z is A-C-measurable.
2. Show that ker.f / is an epimorphism in Meas and that f W
Œxker.f / 7! f .x/ is a monomorphism in Meas.
3. Let f
D m ı e with an epimorphism e W .S; A/ ! .Z; C/
and a monomorphism m W .Z; C/ ! .T; B/, and deﬁne b W
S=ker .f / ! Z through Œsker.f / 7! e.s/; see Corollary 2.1.27.
Show that b is A=ker .f /-C-measurable, and prove or disprove
measurability of b1.
Exercise 2.26 Let AbGroup be the category of Abelian groups. Its ob-
jects are commutative groups; a morphism ' W .G; C/ ! .H; / is a
map ' W G ! H with '.a C b/ D '.a/  '.b/ and '.a/ D '.a/.
Each subgroup V of an Abelian group .G; / deﬁnes an equivalence re-
lation V through a V b iff a  b 2 V . Characterize the pushout of
V and W for subgroups V and W in AbGroup.
Exercise 2.27 Given a set X, deﬁne F.X/ WD X  X, for a map f W
X ! Y , F.f /.x1; x2/ WD hf .x1/; f .x2/i is deﬁned. Show that F is an
endofunctor on Set.
Exercise 2.28 Let .X; / be a topological space, the closed sets of
which are denoted just by F for this exercise. Deﬁne f W P .X/ ! F
by f .A/ WD Aa and by i the embedding i W F ! P .X/. Then i
and f are a Galois connection. Similarly, deﬁning g W P .X/ !  as
g.A/ WD Ao and j W  ! P .X/ as the embedding, show that g and j
form a Galois connection.

2.9. EXERCISES
275
Exercise 2.29 Fix a set A of labels; deﬁne F.X/ WD fg[AX for the
set X, if f W X ! Y is a map; put F.f /./ WD  and F.f /.a; x/ WD
ha; f .x/i: Show that F W Set ! Set deﬁnes an endofunctor.
This endofunctor models termination or labeled output.
Exercise 2.30 Fix a set A of labels, and put for the set X
F.X/ WD Pf .A  X/;
where Pf denotes all ﬁnite subsets of its argument. Thus, G  F.X/ is
a ﬁnite subset of AX, which models ﬁnite branching, with ha; xi 2 G
as one of the possible branches, which is in this case labeled by a 2 A.
Deﬁne
F.f /.B/ WD
˚
ha; f .x/i j ha; xi 2 B

for the map f W X ! Y and B  A  X. Show that F W Set ! Set is
an endofunctor.
Exercise 2.31 Show that the limit cone for a functor F W K ! L is
unique up to isomorphisms, provided it exists.
Exercise 2.32 Let I 6D ; be an arbitrary index set, and let K be the
discrete category over I. Given a family .Xi/i2I, deﬁne F W I ! Set
by Fi WD Xi. Show that
X WD
Y
i2I
Xi WD fx W I !
[
i2I
Xi j x.i/ 2 Xi for all i 2 Ig
with i W x 7! x.i/ is a limit .X; .i/i2I/ of F.
Exercise 2.33 Formulate the equalizer of two morphisms (cp. Exer-
cise 2.17) as a limit.
Exercise 2.34 Deﬁne for the set X the free monoid X generated by X
through
X WD fhx1; : : : ; xki j xi 2 X; k  0g
with juxtaposition as multiplication, i.e., hx1; : : : ; xkihx0
1; : : : ; x0
ri WD
hx1; : : : ; xk; x0
1; : : : ; x0
ri; the neutral element  is hx1; : : : ; xki with k D
0; see Exercise 2.5. Deﬁne
f .x1  : : :  xk/ WD f .x1/  : : :  f .xk/
X.x/ WD hxi

276
CHAPTER 2. CATEGORIES
for the map f W X ! Y  and x 2 X. Put FX WD X. Show that
.F; ; / is a Kleisli tripel, and compare it with the list monad; see
page 177. Compute X for this monad.
Exercise 2.35 Given are the systems S and T .
1. Consider the transition systems S and T as coalgebras for a suit-
able functor F W Set ! Set, X 7! P.X/. Determine the dynamics
of the respective coalgebras.
2. Show that there is no coalgebra morphism S ! T .
3. Construct a coalgebra morphism T ! S.
4. Construct a bisimulation between S and T as a coalgebra on the
carrier
fhs2; t3i; hs2; t4i; hs4; t2i; hs5; t6i; hs5; t7i; hs6; t5ig:
Exercise 2.36 Characterize this nondeterministic transition system S as
a coalgebra for a suitable functor F W Set ! Set.
Show that
˛
WD
fhsi; siij 0  i  12g [ fhs2; s4i; hs4; s2i; hs9; s12i; hs12; s9i;
hs13; s14i; hs14; s13ig
is a bisimulation equivalence on S. Simplify S by giving a coalge-
braic characterization of the factor system S=˛. Furthermore, determine
whether ˛ is the largest bisimulation equivalence on S.

2.9. EXERCISES
277
Exercise 2.37 The deterministic ﬁnite automata A1; A2 with input and
output alphabet f0; 1g and the following transition tables are given:
A1
state
input
output
next state
A2
state
input
output
next state
s0
0
0
s1
s0
0
0
0
s0
0
s0
1
1
s0
s0
0
1
1
s0
1
s1
0
0
s2
s0
1
0
0
s0
0
s1
1
1
s3
s0
1
1
1
s0
2
s2
0
1
s4
s0
2
0
1
s0
3
s2
1
0
s2
s0
2
1
0
s0
2
s3
0
0
s1
s0
3
0
1
s0
4
s3
1
1
s3
s0
3
1
0
s0
2
s4
0
1
s3
s0
4
0
0
s0
5
s4
1
0
s2
s0
4
1
1
s0
4
s0
5
0
0
s0
2
s0
5
1
1
s0
4
1. Formalize the automata as coalgebras for a suitable functor F W
Set ! Set, F.X/ D .X O/I. You have to choose I and O ﬁrst.
2. Construct a coalgebra morphism from A1 to A2, and use this to
ﬁnd a bisimulation R between A1 and A2. Describe the dynamics
of R coalgebraically.
Exercise 2.38 Let P be an effectivity function on X, and deﬁne
@P.A/ WD XnP.XnA/. Show that @P deﬁnes an effectivity function on
X. Given an effectivity function Q on Y and a morphism f W P ! Q,
show that f W @P ! @Q is a morphism as well.
Exercise 2.39 Show that the power set functor P W Set ! Set does not
preserve pullbacks. (Hint: You can use the fact that in Set, the pullback
of the left diagram is explicitly given as P WD fhx; yi j f .x/ D g.y/g
with X and Y being the usual projections.)
Exercise 2.40 Suppose F; G W Set ! Set are functors.
1. Show that if F and G both preserve weak pullbacks, then also the
product functor F  G W Set ! Set, deﬁned as .F  G/.X/ D
F.X/  G.X/ and .F  G/.f / D F.f /  G.f /, preserves weak
pullbacks.
2. Generalize to arbitrary products, i.e., show the following: If I is
a set and for every i 2 I, Fi W Set ! Set is a functor preserving
weak pullbacks, then also the product functor Q
i2I Fi W Set !
Set preserves pullbacks.

278
CHAPTER 2. CATEGORIES
Use this to show that the exponential functor ./A W Set ! Set,
given by X 7! XA D Q
a2A X and f 7! f A D Q
a2A f pre-
serves weak pullbacks.
3. Show that if F preserves weak pullbacks and there exist natural
transformations  W F ! G and  W G ! F, then also G preserves
weak pullbacks.
4. Show that if both F and G preserve weak pullbacks, then also
F C G W Set ! Set, deﬁned as X 7! F.X/ C G.X/ and f 7!
F.f / C G.f /, preserves weak pullbacks. (Hint: Show ﬁrst that
for every morphism f W X ! A C B, one has a decomposition
X Š XA C XB and fA W XA ! A, fB W XB ! B such that
f Š .fA ı iA/ C .fB ı iB/.)
Exercise 2.41 Consider the modal similarity type t D .O; /, with
O WD fhai; hbig and .hai/ D .hbi/ D 1, over the propositional letters
fp; qg. Let furthermore Œa; Œb denote the nablas of hai and hbi.
Show that the following formula is a tautology, i.e., it holds in every
possible t-model:
.haip _ haiq _ Œb.:p _ q// ! .hai.p _ q/ _ :Œbp _ Œbq/
A frame morphism between frames .X; .Rhai; Rhbi// and .Y; .Shai;
Shbi// is given for this modal similarity type by a map f W X ! Y
which satisﬁes the following properties:
 If hx; x1i 2 Rhai, then hf .x/; f .x1/i 2 Shai.
Moreover, if
hf .x/; y1i 2 Shai, then there exists x1 2 X with hx; x1i 2 Rhai
and y1 D f .x1/.
 If hx; x1i 2 Rhbi, then hf .x/; f .x1/i 2 Shbi.
Moreover, if
hf .x/; y1i 2 Shbi, then there exists x1 2 X with hx; x1i 2 Rhbi
and y1 D f .x1/.
Give a coalgebraic deﬁnition of frame morphisms for this modal simi-
larity type, i.e., ﬁnd a functor F W Set ! Set such that frame morphisms
correspond to F-coalgebra morphisms.
Exercise 2.42 Consider the fragment of PDL deﬁned mutually recur-
sive by:
Formulas ' WWD p j '1 ^ '2 j :'1 j hi' (where p 2 ˚ for a set of
basic propositions ˚, and  is a program).

2.9. EXERCISES
279
Programs  WWD t j 1I 2 j '‹ (where t 2 Bas for a set of basic
programs Bas and ' is a formula).
Suppose you are given the set of basic programs Bas WD finit; run; printg
and basic propositions ˚ WD fis init; did printg.
We deﬁne a model M for this language as follows:
 The basic set of M is X WD f1; 0; 1g.
 The modal formulas for basic programs are interpreted by the re-
lations
Rinit WD fh1; 0i; h0; 0i; h1; 1ig;
Rrun WD fh1; 1i; h0; 0i; h1; 1ig;
Rprint WD fh1; 1i; h0; 1i; h1; 1ig:
 The modal formulas for composite programs are deﬁned by
R1I2 WD R1 ı R2 and R'‹ WD fhx; xij M; x ˆ 'g, as usual.
 The valuation function is given by V.is init/ WD f0; 1g and
V.did print/ WD f1g.
Show the following:
1. M; 1 ² hrunI printidid print,
2. M; x ˆ hinitI runI printidid print (for all x 2 X),
3. M; x ² h.:is init/‹I printidid print (for all x 2 X).
Informally speaking, the model above allows one to determine whether
a program composed of initialization (init), doing some kind of work
(run), and printing (print) is initialized or has printed something.
Suppose we want to modify the logic by counting how often we have
printed, i.e., we extend the set of basic propositional letters by fdid
printnj n 2 Ng. Give an appropriate model for the new logic.
Exercise 2.43 Let E be the monad which is given by all upper closed
subsets of the power set of a set; see Example 2.4.10. Show that 	S W
A 7! fV 2 E.S/ j A 2 V g deﬁnes a natural transformation P ! E.
Compute the composition of two Kleisli morphisms for E.

Chapter 3
Topological Spaces
A topology formalizes the notion of an open set; call a set open iff each
of its members leaves a little room like a breathing space around it.
This gives immediately a hint at the structure of the collection of open
sets—they should be closed under ﬁnite intersections but under arbitrary
unions, yielding the base for a calculus of observable properties, as out-
lined in [Smy92, Chap. 1] or in [Vic89]. This development makes use
of properties of topological spaces but puts its emphasis subtly away
from the classic approach, e.g., in mathematical analysis or probabil-
ity theory, by stressing different properties of a space. The traditional
approach, for example, stresses separation properties like being able to
separate two distinct points through an open set. Such a strong empha-
sis is not necessarily observed in the computationally oriented use of
topologies, where, for example, pseudometrics for measuring the con-
ceptual distance between objects are important, when it comes to ﬁnding
an approximation between Markov transition systems.
We give in this chapter a brief introduction to some of the main proper-
ties of topological spaces, given that we have touched upon topologies
already in the context of the axiom of choice in Sect. 1.5.8. The objec-
tive is to provide the tools and methods offered by set-theoretic topol-
ogy to an application-oriented reader. Thus we introduce the very basic
notions of topology and hint at applications of these tools. Some con-
nections to logic and set theory are indicated, but as Moschovakis writes
© Springer International Publishing Switzerland 2015
E.-E. Doberkat, Special Topics in Mathematics for Computer
Scientists, DOI 10.1007/978-3-319-22750-4 3
281

282
CHAPTER 3. TOPOLOGICAL SPACES
“General (pointset) topology is to set theory like parsley to Greek food:
some of it gets in almost every dish, but there are no ‘parsley recipes’
that the good Greek cook needs to know” [Mos06, 6.27, p. 79]. In this
metaphor, we study the parsley here, so that it can get into the dishes
which require it.
Basic notions of a topology and its construction, including bases and
subbases, are already known from Chap. 1. Since compactness has been
made available very early, compact spaces serve occasionally as an ex-
ercise ground. Continuity is an important topic in this context and the
basic constructions like product or quotients which are enabled by it.
Since some interesting and important topological constructions are tied
to ﬁlters, we study ﬁlters and convergence, comparing in examples the
sometimes more easily handled nets to the occasionally more cumber-
some ﬁlters, which, however, offer some conceptual advantages. Talk-
ing about convergence, separation properties suggest themselves; they
are studied in detail, providing some classic results like Urysohn’s The-
orem. It happens so often that one works with a powerful concept but
that this concept requires assumptions which are too strong; hence, one
has to weaken it in a sensible way. This is demonstrated in the transition
from compactness to local compactness; we discuss locally compact
spaces, and we give an example of a compactiﬁcation. Quantitative as-
pects enter when one measures openness through a pseudometric; here
many concepts are seen in a new, sharper light; in particular, the problem
of completeness comes up—you have a sequence, the elements of which
are eventually very close to each other, and you want to be sure that a
limit exists. This is possible on complete spaces, and, even better, if a
space is not complete, then you can complete it. Complete spaces have
some very special properties, for example, the intersection of countably
many open dense sets is dense again. This is Baire’s Theorem. We show
through a Banach–Mazur game played on a topological space that being
of ﬁrst category can be determined through Demon having a winning
strategy.
This completes the round trip of the basic properties of topological
spaces. We then present a small gallery in which topology is in ac-
tion. The reason for singling out some topics is that we want to demon-
strate the techniques developed with topological spaces for some in-
teresting applications. For example, G¨odel’s Completeness Theorem
for (countable) ﬁrst-order logic has been proved by Rasiowa and Siko-
rski through a combination of Baire’s Theorem and Stone’s topological

3.1. DEFINING TOPOLOGIES
283
representation of Boolean algebras. This topic is discussed. The cal-
culus of observations, which is mentioned above, leads to the notion of
topological systems, as demonstrated by Vickers. This hints at an inter-
play of topology and order, since a topology is after all a complete Heyt-
ing algebra. Another important topic is the approximation of continuous
functions by a given class of functions, like the polynomials on an in-
terval, leading quickly to the Stone–Weierstraß Theorem on a compact
topological space, a topic with a rich history. Finally, the relationship of
pseudometric spaces to general topological spaces is reﬂected again; we
introduce uniform spaces as an interesting class of spaces which is more
general than pseudometric spaces but less general than their topological
cousins. Here we ﬁnd concepts like completeness or uniform continuity,
which are formulated for metric spaces, but which cannot be realized in
general topological ones. This gallery could be extended; for example,
Polish spaces could be discussed here with considerable relish, but it
seemed to be more adequate to discuss these spaces in the context of
their measure theoretic use.
We assume throughout that the axiom of choice is valid.
3.1
Deﬁning Topologies
Recall from Sect. 1.5.8 that a topology  on a carrier set X is a collection
of subsets which contains both ; and X and which is closed under ﬁnite
intersections and arbitrary unions. The elements of  are called the open
sets. Usually, a topology is not written down as one set, but it is speciﬁed
what an open set looks like. This is done through a base or a subbase.
Recall that a base ˇ for  is a set of subsets of  such that for any x 2 G,
Base,
subbase
there exists B 2 ˇ with x 2 B  G. A subbase is a family of sets for
which the ﬁnite intersections form a base.
Not every family of subsets qualiﬁes as a subbase or a base.
Kel-
ley [Kel55, p. 47] gives the following example: Put X WD f0; 1; 2g,
A WD f0; 1g and B WD f1; 2g; then ˇ WD fX; A; B; ;g cannot be the
base for a topology. Assume it is, then the topology must be ˇ itself, but
A \ B 62 ˇ. We have the following characterization of a base.
Proposition 3.1.1 A family ˇ of sets is the base for a topology on X D
S ˇ iff given U; V 2 ˇ and x 2 U \ V , there exists W 2 ˇ with
x 2 W  U \ V , and if X.

284
CHAPTER 3. TOPOLOGICAL SPACES
Thus we have to be a bit careful, in view of Kelley’s example. Let us
have a look at the proof.
Proof Checking the properties for a base shows that the condition is
certainly necessary. Suppose that the condition holds, and deﬁne
 WD fS ˇ0 j ˇ0  ˇg:
Then ;; X 2 , and  is closed under arbitrary unions, so that we have
to check whether  is closed under ﬁnite intersections. In fact, let x 2
U \ V with U; V 2 ; then we can ﬁnd U0; V0 2 ˇ with x 2 U0 \ V0.
By assumption there exists W 2 ˇ with x 2 W  U0 \ V0  U \ V ,
so that U \ V can be written as union of elements in ˇ. a
We perceive a base and a subbase, resp., relative to a topology, but it is
usually clear what the topology looks like, once a basis is given. Let us
have a look at some examples to clarify things.
Example 3.1.2 Consider the real numbers R with the Euclidean topol-
ogy . We say that a set G is open iff given x 2 G, there exists an
open interval a; bŒ with x 2
a; bŒ  G. Hence the set
˚
a; bŒ
j
a; b 2 R; a < b

forms a base for ; actually, we could have chosen
a and b as rational numbers, so that we have even a countable base
for . Note that although we can ﬁnd a closed interval Œv; w such that
x 2 Œv; w  a; bŒ  G, we could not have used the closed intervals
for a description of , since otherwise the singleton sets fxg D Œx; x
would be open as well. This is both undesirable and counterintuitive:
in an open set, we expect each element to have some breathing space
around it. ✌
The next example looks at higher dimensional Euclidean spaces; here
we do not have intervals directly at our disposal, but we can measure
distances as well, which is a suitable generalization, given that the inter-
val x  r; x C rŒ equals fy 2 R j jx  yj < rg.
Example 3.1.3 Consider the three-dimensional space R3, and deﬁne
for x; y 2 R3 their distance
d.x; y/ WD
3
X
iD1
jxi  yij:
Call G  R3 open iff given x 2 G, there exists r > 0 such that fy 2
R3 j d.x; y/ < rg  G. Then it is clear that the set of all open sets

3.1. DEFINING TOPOLOGIES
285
form a topology:
 Both the empty set and R3 are open.
 The union of an arbitrary collection of open sets is open again.
 Let G1; : : : ; Gk be open, and x 2 G1 \ : : : \ Gk. Take an index
i; since x 2 Gi, there exists ri > 0 such that K.d; x; r/ WD fy 2
R3 j d.x; y/ < rig  Gi. Let r WD minfr1; : : : ; rkg, then
fy 2 R3 j d.x; y/ < rg D
k
\
iD1
fy 2 R3 j d.x; y/ < rig 
k
\
iD1
Gi:
Hence the intersection of a ﬁnite number of open sets is open
again.
This argument would not work with a countable number of open sets,
by the way.
We could have used other measures for the distance, e.g.,
d 0.x; y/ WD
sX
i
jxi  yij2;
d 00.x; y/ WD max
1i3 jxi  yij:
Then it is not difﬁcult to see that all three describe the same collection
of open sets. This is so because we can ﬁnd for x and r > 0 some
r0 > 0 and r00 > 0 with K.d 0; x; r0/  K.d; x; r/ and K.d 00; x; r00/ 
K.d; x; r/, similarly for the other combinations.
It is noted that 3 is not a magical number here; we can safely replace it
with any positive n, indicating an arbitrary ﬁnite dimension. Hence we
have shown that Rn is a topological space in the Euclidean topology for
each n 2 N. ✌
The next example uses also some notion of distance between two ele-
ments, which are given through evaluating real-valued functions. Think
of f .x/ as the numerical value of attribute f for object x; then jf .x/ 
f .y/j indicates how far apart x and y are with respect to their attribute
values.
Example 3.1.4 Let X be an arbitrary nonempty set and E be a nonempty
collection of functions f W X ! R. Deﬁne for the ﬁnite collection

286
CHAPTER 3. TOPOLOGICAL SPACES
F  E, for r > 0, and for x 2 X, the base set
WFIr.x/ WD fy 2 X j jf .x/  f .y/j < r for all f 2 Fg:
We deﬁne as a base ˇ WD fWFIr.x/ j x 2 X; r > 0; F  G ﬁniteg, and
hence call G  X open iff given x 2 G, there exists F  E ﬁnite and
r > 0 such that WFIr.x/  G.
It is immediate that the ﬁnite intersection of open sets is open again.
Since the other properties are checked easily as well, we have deﬁned
a topology, which is sometimes called the weak topology on X induced
Weak
topology
by E.
It is clear that in the last example, the argument would not work if we
restrict ourselves to elements of G for deﬁning the base, i.e., to sets of
the form WfggIr. These sets, however, have the property that they form
a subbase, since ﬁnite intersections of these sets form a base. ✌
The next example shows that a topology may be deﬁned on the set of
all partial functions from some set to another one. In contrast to the
previous example, we do without any numerical evaluations.
Example 3.1.5 Let A and B be nonempty sets; deﬁne
A * B
A * B WD ff  A  B j f is a partial mapgI
see Exercise 2.3. A set G  A * B is called open iff given f 2 G,
there exists a ﬁnite f0 2 A * B such that
f 2 N.f0/ WD fg 2 A * B j f0  gg  G:
Thus we can ﬁnd for f a ﬁnite partial map f0 which is extended by f ,
such that all extensions to f0 are contained in G.
Then this is in fact a topology. The collection of open sets is certainly
closed under arbitrary unions, and both the empty set and the whole set
A * B are open. Let G1; : : : ; Gn be open, and f 2 G WD G1 \ : : : \
Gn; then we can ﬁnd ﬁnite partial maps f1; : : : ; fn which are extended
by f such that N.fi/  Gi for 1  i  n. Since f extends all these
maps, f0 WD f1 [ : : : [ fn is a well-deﬁned ﬁnite partial map which is
extended by f , and
f 2 N.f0/ D N.f1/ \ : : : [ N.fn/  G:
Hence the ﬁnite intersection of open sets is open again.

3.1. DEFINING TOPOLOGIES
287
A base for this topology is the set fN.f / j f is ﬁniteg; a subbase is the
set
˚
N.fha; big/ j a 2 A; b 2 B

. ✌
The next example deals with a topology which is induced by an order
structure. Recall from Sect. 1.5 that a chain in a partially ordered set is
a nonempty totally ordered subset and that in an inductively ordered set,
each chain has an upper bound.
Example 3.1.6 Let .P; / be a inductively ordered set. Call G  P
Scott open iff:
1. G is upper closed (hence x 2 G and x  y imply y 2 G),
2. if S  P is a chain with sup S 2 G, then S \ G 6D ;.
Again, this deﬁnes a topology on P . In fact, it is enough to show that
G1 \ G2 is open, if G1 and G2 are. Let S be a chain with sup S 2
G1 \ G2; then we ﬁnd si 2 S with si 2 Gi. Since S is a chain, we
may and do assume that s1  s2; hence s2 2 G1, because G1 is upper
closed. Thus s2 2 S \.G1 \G2/. Because G1 and G2 are upper closed,
so is G1 \ G2.
As an illustration, we show that the set F WD fx 2 P j x  tg is Scott
closed for each t 2 P . Put G WD P n F . Let x 2 G, and x  y; then
obviously y 62 F , so y 2 G. If S is a chain with sup S 2 G, then there
exists s 2 S such that s 62 F ; hence S \ G 6D ;. ✌
3.1.1
Continuous Functions
A continuous map between topological spaces is compatible with the
topological structure. This is familiar from real functions, but we cannot
copy the deﬁnition, since we have no means of measuring the distance
between points in a topological space. All we have is the notion of an
open set. So the basic idea is to say that given an open neighborhood
U of the image, we want to be able to ﬁnd an open neighborhood V of
the inverse image so that all element of V are mapped to U . This is a
direct translation of the familiar -ı-deﬁnition from calculus. Since we
are concerned with continuity as a global concept (as opposed to one
which focuses on a given point), we arrive at this deﬁnition and observe
in the subsequent example that it is really a faithful translation.

288
CHAPTER 3. TOPOLOGICAL SPACES
Deﬁnition 3.1.7 Let .X; / and .Y; #/ be topological spaces. A map
f W X ! Y is called -#-continuous iff f 1
H

2  for all H 2 #
holds; we write this also as f W .X; / ! .Y; #/.
If the context is clear, we omit the reference to the topologies. Hence
we say that the inverse image of an open set under a continuous map is
an open set again; see Example 2.1.11.
Let us have a look at real functions.
Example 3.1.8 Endow the reals with the Euclidean topology, and let
f W R ! R be a map. Then the deﬁnition of continuity given above
coincides with the usual -ı-deﬁnition.
1. Assuming the -ı-deﬁnition, we show that the inverse image of an
-ı?
open set is open. In fact, let G  R be open, and pick x 2 f 1
G

.
Since f .x/ 2 G, we can ﬁnd  > 0 such that f .x/; f .x/CŒ  G.
Pick ı > 0 for this ; hence x0 2 x  ı; x C ıŒ implies f .x0/ 2 f .x/ 
; f .x/ C Œ  G. Thus x 2 x  ı; x C ıŒ  f 1
G

.
2. Assuming that the inverse image of an open set is open, we establish
the -ı-deﬁnition. Given x 2 R, let  > 0 be arbitrary; we show that
there exists ı > 0 such that jx  x0j < ı implies jf .x/  f .x0/j < .
Now f .x/  ; f .x0/ C Œ is an open set; hence H WD f 1
f .x/ 
; f .x0/ C Œ

is open by assumption, and x 2 H, Select ı > 0 with
x  ı; x C ıŒ  H, then jx  x0j < ı implies x0 2 H; hence f .x0/ 2
f .x/  ; f .x0/ C Œ. ✌
Thus we work on familiar ground, when it comes to the reals. Continuity
may be tested on a subbase:
Lemma 3.1.9 Let .X; / and .Y; #/ be topological spaces and f
W
X ! Y be a map. Then f is -#-continuous iff f 1
S

2  for
each S 2  with   # a subbase.
Proof Clearly, the inverse image of a subbase element is open, whenever
f is continuous. Assume, conversely, that the f 1
S

2  for each S 2
. Then f 1
B

2  for each element B of the base ˇ generated from
, because B is the intersection of a ﬁnite number of subbase elements.
Now, ﬁnally, if H 2 #, then H D SfB j B 2 ˇ; B  Hg, so that
f 1
H

D Sff 1
B

j B 2 ˇ; B  Hg 2 . Thus the inverse
image of an open set is open. a

3.1. DEFINING TOPOLOGIES
289
Example 3.1.10 Take the topology from Example 3.1.5 on the space
A * B of all partial maps. A map q W .A * B/ ! .C * D/ is
continuous in this topology iff the following condition holds: whenever
q.f /.c/ D d, then there exists f0  f ﬁnite such that q.f0/.c/ D d.
In fact, let q be continuous, and q.f /.c/ D d, then G WD q1
N
.fhc; dig/

is open and contains f ; thus there exists f0  f with f 2
N.f0/  G, in particular q.f0/.c/ D d. Conversely, assume that
H  C * D is open, and we want to show that G WD q1
H


A * B is open. Let f 2 G; thus q.f / 2 H; hence there exists
g0  q.f / ﬁnite with q.f / 2 N.g0/  H. g0 is ﬁnite, say g0 D
fhc1; d1i; : : : ; hcn; dnig. By assumption, there exists f0 2 A * B with
q.f0/.ci/ D di for 1  i  n; then f 2 N.f0/  G, so that the latter
set is open. ✌
This is an easy criterion for continuity with respect to the Scott topol-
ogy.
Example 3.1.11 Let .P; / and .Q; / be inductively ordered sets,
then f W P ! Q is Scott continuous (i.e., continuous when both or-
dered sets carry their respective Scott topology) iff f is monotone and
if f .sup S/ D sup f

S

holds for every chain S.
Assume that f is Scott continuous. If x  x0, then every open set which
contains x also contains x0; so if x 2 f 1
H

, then x0 2 f 1
H

for
every Scott open H  Q; thus f is monotone. If S  P is a chain,
then sup S exists in P , and f .s/  f .sup S/ for all s 2 S, so that
sup f

S

 f .sup S/. For the other inequality, assume that f .sup S/ 6
sup f

S

. We note that G WD f 1
fq 2 Q j q 6 sup f

S

g

is open
with sup S 2 G; hence there exists s 2 S with s 2 G. But this is
impossible. On the other hand, assume that H  Q is Scott open; we
want to show that G WD f 1
H

 P is Scott open. G is upper closed,
since x 2 G and x  x0 imply f .x/ 2 H and f .x/  f .x0/; thus
f .x0/ 2 H, so that x0 2 G. Let S  P be a chain with sup S 2
G; hence f .sup S/ 2 H. Since f

S

is a chain, and f .sup S/ D
sup f

S

, we infer that there exists s 2 S with f .s/ 2 H; hence there
is s 2 S with s 2 G. Thus G is Scott open in P , and f is Scott
continuous. ✌
The interpretation of modal logics in a topological space is interest-
ing, when we interpret the transition which is associated with the di-
amond operator through a continuous map. Thus the next step of a

290
CHAPTER 3. TOPOLOGICAL SPACES
transition is uniquely determined, and it depends continuously on its
argument.
Example 3.1.12 The syntax of our modal logics is given through
' WWD > j p j '1 _ '2 j '1 ^ '2 j :' j Þ'
with p 2 ˚ an atomic proposition. The logic has the usual operators,
viz., disjunction and negation, and Þ as the modal operator.
For interpreting the logic, we take a topological state space .S; / and
a continuous map f W X ! X, and we associate with each atomic
proposition p an open set Vp as the set of all states in which p is true.
We want the validity set ŒŒ' of all those states in which formula ' holds
to be open and deﬁne inductively the validity of a formula in a state in
the following way:
ŒŒ> WD S
ŒŒp WD Vp; if p is atomic
ŒŒ'1 _ '2 WD ŒŒ'1 [ ŒŒ'2
ŒŒ'1 ^ '2 WD ŒŒ'1 \ ŒŒ'2
ŒŒ:' WD .S n ŒŒ'/o
ŒŒÞ' WD f 1
ŒŒ'

All deﬁnitions but the last two are self-explanatory. The interpretation
of ŒŒÞ through f 1
ŒŒ'

suggests itself when considering the graph
of f in the usual interpretation of the diamond in modal logics; see
Deﬁnition 2.7.15.
Since we want ŒŒ:' to be open, we cannot take the complement of ŒŒ'
and declare it as the validity set for ', because the complement of an
open set is not necessarily open. Instead, we take the largest open set
which is contained in S n ŒŒ' (this is the best we can do) and assign it
to :'. One shows easily through induction on the structure of formula
' that ŒŒ' is an open set.
But now look at this. Assume that X WD R in the usual topology, Vp D
ŒŒp D 0; C1Œ, then ŒŒ:p D   1; 0o D   1; 0Œ; thus ŒŒp _ :p D
R n f0g 6D ŒŒ>. Thus the law of the excluded middle does not hold in
this model. ✌
Returning to the general discussion, the following fundamental property
is immediate; we state it here just for the record; see Example 2.1.11.

3.1. DEFINING TOPOLOGIES
291
Proposition 3.1.13 The identity .X; / ! .X; / is continuous, and
continuous maps are closed under composition. Consequently, topolog-
ical spaces with continuous maps form a category. a
Continuous maps can be used to deﬁne topologies.
Deﬁnition 3.1.14 Given a family F of maps f
W A ! Xf , where
.Xf ; f / is a topological space for each f 2 F, the initial topology
in;F on A with respect to F is the smallest topology on A so that f is
in;F-f -continuous for every f 2 F. Dually, given a family G of maps
g W Xg ! Z, where .Xg; g/ is a topological space for each g 2 G,
the ﬁnal topology f i;G on Z is the largest topology on Z so that g is
-f i;G-continuous for every g 2 G.
In the case of the initial topology for just one map f W A ! Xf ,
note that P .A/ is a topology which renders f continuous, so there ex-
ists in fact a smallest topology on A with the desired property; because
ff 1
G

j G 2 f g is a topology that satisﬁes the requirement, and be-
cause each such topology must contain it, this is in fact the smallest one.
If we have a family F of maps A ! Xf , then each topology making
all f 2 F continuous must contain 
 WD S
f 2Fff 1
G

j G 2 f g;
so the initial topology with respect to F is just the smallest topology
on A containing 
. Similarly, being the largest topology rendering each
g 2 G continuous, the ﬁnal topology with respect to G must contain the
set S
g2GfH j g1
H

2 gg.
An easy characterization of the initial resp. the ﬁnal topology is pro-
posed here:
Proposition 3.1.15 Let .Z; / be a topological space and F be a family
of maps A ! Xf with .Xf ; f / topological spaces; A is endowed with
the initial topology in;F with respect to F. A map h W Z ! A is
-in;F-continuous iff h ı f W Z ! Xf is -f -continuous for every
f 2 F.
Proof 1. Certainly, if h W Z ! A is -in;F continuous, then h ı f W
Z ! Xf is -f -continuous for every f 2 F by Proposition 3.1.13.
2. Assume, conversely, that h ı f is continuous for every f 2 F; we
want to show that h is continuous. Consider
	 WD fG  A j h1
G

2 g:

292
CHAPTER 3. TOPOLOGICAL SPACES
Because  is a topology, 	 is; because h ı f is continuous, 	 contains
the sets ff 1
H

j H 2 f g for every f 2 F. But this implies that 	
contains in;F; hence h1
G

2  for every G 2 in;F. This establishes
the assertion. a
There is a dual characterization for the ﬁnal topology; see Exercise 3.1.
These are the most popular examples for initial and ﬁnal topologies:
1. Given a family .Xi; i/i2I of topological spaces, let X
WD
Q
i2I Xi be the Cartesian product of the carrier sets.1 The prod-
Product
uct topology Q
i2I i is the initial topology on X with respect to
the projections i W X ! Xi. The product topology has as a base
˚Q
i2I Ai j Ai 2 i and Ai 6D Xi only for ﬁnitely many indices

2. Let .X; / be a topological space, A  X. The trace .A;  \A/ of
 on A is the initial topology on A with respect to the embedding
iA W A ! X. It has the open sets fG \ A j G 2 g; this is
Subspace
sometimes called the subspace topology; see page 58. We do not
assume that A is open.
3. Given the family of spaces as above, let X WD P
i2I Xi be the
direct sum. The sum topology P
i2I i is the ﬁnal topology on
Sum
X with respect to the injections i W Xi ! X. Its open sets are
described through
˚X
i2I
i

Gi

j Gi 2 i for all i 2 I

:
4. Let  be an equivalence relation on X with  a topology on the
base space. The factor space X= is equipped with the ﬁnal topol-
ogy = with respect to the factor map  which sends each ele-
ment to its -class. This topology is called the quotient topology
Factor
(with respect to  and ). If a set G  X= is open, then its in-
verse image 1


G

D S G  X is open in X. But the converse
holds as well: assume that S G is open in X for some G  X=,
then G D 
S G

, and, because S G is the union if equivalence
classes, one shows that 1


G

D 1



S G

D S G. But
this means that G is open in X=.
1This works only if X 6D ;; recall that we assume here that the axiom of choice is
valid.

3.1. DEFINING TOPOLOGIES
293
Just to gain some familiarity with the concepts involved, we deal with
an induced map on a product space and with the subspace coming from
the image of a map. The properties we ﬁnd here will be useful later on
as well.
The product space ﬁrst. We will use that a map into a topological prod-
uct is continuous iff all its projections are; this follows from the charac-
terization of an initial topology. It goes like this:
Lemma 3.1.16 Let M and N be nonempty sets and f W M ! N be a
map. Equip both Œ0; 1M and Œ0; 1N with the product topology. Then
f  W
(
Œ0; 1N
! Œ0; 1M
g
7! g ı f
is continuous.
Proof Note the reversed order; we have f .g/.m/ D .g ı f /.m/ D
g.f .m// for g 2 Œ0; 1N and m 2 M.
Because f  maps Œ0; 1N into Œ0; 1M , and the latter space carries the
initial topology with respect to the projections .M;m/m2N with M;m W
q 7! q.m/, it is by Proposition 3.1.15 sufﬁcient to show that M;mıf  W
Œ0; 1N ! Œ0; 1 is continuous for every m 2 M. But M;m ı f  D
N;f .m/; this is a projection, which is continuous by deﬁnition. Hence
f  is continuous. a
Hence an application of the projection defuses a seemingly complicated
map. Note in passing that neither M nor N are assumed to carry a
topology; they are simply plain sets.
The next observation displays an example of a subspace topology. Each
continuous map f W X ! Y of one topological space to another one
induces a subspace f

X

of Y , which may or may not have interest-
ing properties. In the case considered, it inherits compactness from its
source.
Proposition 3.1.17 Let .X; / and .Y; #/ be topological spaces and f W
X ! Y be -#-continuous. If .X; / is compact, so is .f

X

; # \
f

X

/, the subspace of .Y; #/ induced by f .
Proof We take on open cover of f

X

and show that it contains a ﬁ-
nite cover of this space. So let .Hi/i2I be an open cover of f

X

.
There exists open sets H 0
i 2 # such that H 0
i D Hi \ f

X

, since

294
CHAPTER 3. TOPOLOGICAL SPACES
.f

X

;  \ f

X

/ carries the subspace topology. Then .f 1
H 0
i

/i2I
is an open cover of X, so there exists a ﬁnite subset J  I such that
X D S
i2J f 1
H 0
i

, since X is compact. But then .H 0
i \ f

X

/i2J
is an open cover of f

X

. Hence this space is compact. a
Before proceeding further, we introduce the notion of homeomorphism
(as an isomorphism in the category of topological spaces with continu-
ous maps).
Deﬁnition 3.1.18 Let X and Y be topological spaces. A bijection f W
X ! Y is called a homeomorphism iff both f and f 1 are continuous.
It is clear that continuity and bijectivity alone do not make a homeo-
morphism. Take as a trivial example the identity .R; P .R// ! .R; /
with  as the Euclidean topology. It is continuous and bijective, but its
inverse is not continuous.
Let us have a look at some examples, ﬁrst one for the quotient topol-
ogy.
Example 3.1.19 Let U WD Œ0; 2  , and identify the endpoints of the
interval, i.e., consider the equivalence relation
 WD fhx; xi j x 2 U g [ fh0; 2  i; h2  ; 0ig:
Let K WD U=, and endow K with the quotient topology.
A set G  K is open iff 1


G

 U is open, thus iff we can ﬁnd an
open set H  R such that 1


G

D H \ U , since U carries the trace
of R. Consequently, if Œ0 62 G, we ﬁnd that 1


G

D fx 2 U j
fxg 2 Gg, which is open by construction. If, however, Œ0 2 G, then
1


G

D fx 2 U j fxg 2 Gg [ f0; 2  g, which is open in U .
We claim that K and the unit circle S WD fhs; ti j 0  s; t  1; s2 C
t2 D 1ig are homeomorphic under the map  W Œx 7! hsin x; cos xi.
Because hsin 0; cos 0i D hsin 2  ; cos 2  i, the map is well deﬁned.
Since we can write S D fhsin x; cos xi j 0  x  2  g, it is clear
that  is onto. The topology on S is inherited from the Cartesian plane,
so open arcs are a subbasis for it. Because the old Romans Sinus and
Cosinus both are continuous, we ﬁnd that  ı  is continuous. We
infer from Exercise 3.1 that  is continuous, since K has the quotient
topology, which is ﬁnal.

3.1. DEFINING TOPOLOGIES
295
We show now that  1 is continuous. The argumentation is geomet-
rical. Given an open arc on K, we may describe it through its end-
points .P1; P2/ with a clockwise movement. If the arc does not con-
tain the critical point P WD h0; 1i, we ﬁnd an open interval I WDa; bŒ
with 0 < a < b < 2   such that  

.P1; P2/

D fŒx j x 2 Ig,
which is open in K. If, however, P is on this arc, we decompose it
into two parts .P1; P / [ .P; P2/. Then .P1; P / is the image of some
interval a; 2  , and .P; P2/ is the image of an interval Œ0; bŒ, so that
 

.P1; P2/

D 

Œ0; bŒ [ a; 2  

, which is open in K as well (note
that Œ0; bŒ and a; 2   are open in U ). ✌
While we have described so far direct methods to describe a topology
by saying under which conditions a set is open, we turn now to an ob-
servation due to Kuratowski which yields an indirect way. It describes
axiomatically what properties the closure of a set should have. Assume
that we have a closure operator, i.e., a map A 7! Ac on the powerset of
Closure
operator
a set X with these properties:
1. ;c D ; and Xc D X.
2. A  Ac, and .A [ B/c D Ac [ Bc.
3. .Ac/c D Ac.
Thus the operator leaves the empty set and the whole set alone, the clo-
sure of the union is the union of the closures, and the operator is idem-
potent. One sees immediately that the operator which assigns to each
set its closure with respect to a given topology is such a closure opera-
tor. It is also quite evident that a closure operator is monotone. Assume
that A  B, then B D A [ .B n A/, so that Bc D Ac [ .B n A/c
	 Ac.
Example 3.1.20 Let .D; / be a ﬁnite partially ordered set. We put
;c WD ; and Dc WD D; moreover,
fxgc WD fy 2 D j y  xg
is deﬁned for x 2 D and Ac WD S
x2X fxgc for subsets A of D. Then
this is a closure operator. It is enough to check whether .fxgc/c D fxgc

296
CHAPTER 3. TOPOLOGICAL SPACES
holds. In fact, we have
´ 2 .fxgc/c , ´ 2 fygc for some y 2 fxgc
, there exists y  x with ´  y
, ´  x
, ´ 2 fxgc:
Thus we associate with each ﬁnite partially ordered set a closure oper-
ator, which assigns to each A  D its down set. The map x 7! fxgc
embeds D into a distributive lattice; see the discussion in Sect. 1.5.6. ✌
We will show now that we can obtain a topology by calling open all
those sets the complements of which remain ﬁxed under the closure
operator; in addition, it turns out that the topological closure and the
one from the closure operator are the same.
Theorem 3.1.21 Let c be a closure operator. Then:
1. The set  WD fX n F j F  X; F c D F g is a topology.
2. For each set Aa D Ac with a as the closure in .
Proof 1. For establishing that  is a topology, it is enough to show
that  is closed under arbitrary unions, since the other properties are
evident. Let G  , and put G WD S G, so we want to know whether
X n Gc D X n G. If H 2 G, then X n G  X n H, so .X n G/c 
.X n H/c D X n H; thus .X n G/c  X n G. Since the operator is
monotone, it follows that .X n G/c D X n G; hence  is in fact closed
under arbitrary unions, and hence it is a topology.
2. Given A  X,
Aa D TfF  X j F is closed, and A  F g;
and Ac takes part in the intersection, so that Aa  Ac. On the other
hand, A  Aa, thus Ac  .Aa/c D Aa by part 1. Consequently, Aa and
Ac are the same. a
It is on ﬁrst sight a bit surprising that a topology can be described by
ﬁnitary means, although arbitrary unions are involved for the topology.
But we should not forget that we have also the subset relation at our
disposal. Nevertheless, a rest of surprise remains.

3.1. DEFINING TOPOLOGIES
297
3.1.2
Neighborhood Filters
The last method for describing a topology we are discussing here deals
also with some order properties. Assume that we assign to each x 2 X,
where X is a given carrier set, a ﬁlter U.x/  P .X/ with the property
that x 2 U holds for each U 2 U.x/. Thus U.x/ has these proper-
ties:
1. x 2 U for all U 2 U.x/.
2. If U; V 2 U.x/, then U \ V 2 U.x/.
3. If U 2 U.x/ and U  V , then V 2 U.x/.
It is fairly clear that, given a topology  on X, the neighborhood ﬁl-
ter
U.x/
U.x/ WD fV  X j there exists U 2  with x 2 U and U  V g
for x has these properties. It has also an additional property, which we
will discuss shortly—for dramaturgical reasons.
Such a system of special ﬁlters deﬁnes a topology. We declare all those
sets as open which belong to the neighborhoods of their elements. So if
we take all balls in Euclidean R3 as the basis for a ﬁlter and assign to
each point the balls which it centers, then the sphere of radius 1 around
the origin would not be open (intuitively, it does not contain an open
ball). So this appears to be an appealing idea. In fact:
Proposition 3.1.22 Let fU.x/ j x 2 Xg be a family of ﬁlters such that
x 2 U for all U 2 U.x/. Then
 WD fU  X j U 2 U.x/ whenever x 2 U g
deﬁnes a topology on X.
Proof We have to establish that  is closed under ﬁnite intersections,
since the other properties are fairly straightforward. Now, let U and V
be open, and take x 2 U \V . We know that U 2 U.x/, since U is open,
and we have V 2 U.x/ for the same reason. Since U.x/ is a ﬁlter, it is
closed under ﬁnite intersections; hence U \ V 2 U.x/, and thus U \ V
is open. a
We cannot, however, be sure that the neighborhood ﬁlter U.x/ for this
new topology is the same as the given one. Intuitively, the reason is that

298
CHAPTER 3. TOPOLOGICAL SPACES
we do not know if we can ﬁnd for U 2 U.x/ an open V 2 U.x/ with
V  U such that V 2 U.y/ for all y 2 V . To illustrate, look at R3, and
take the neighborhood ﬁlter for, say, 0 in the Euclidean topology. Put
for simplicity
kxk WD
q
x2
1 C x2
2 C x2
3:
Let U 2 U.0/; then we can ﬁnd an open ball V 2 U.0/ with V  U .
In fact, assume U D fa j kak < qg: Take ´ 2 U ; then we can ﬁnd
r > 0 such that the ball V WD fy j ky  ´k < rg is entirely contained
in U (select k´k < r < q); thus V 2 U.0/. Now let y 2 V , let
0 < t < r  k´  yk, then fa j ka  yk < tg  V , since ka  ´k 
ka  yk C k´  yk < r. Hence U 2 U.y/ for all y 2 V .
We obtain now as a simple corollary:
Corollary 3.1.23 Let fU.x/ j x 2 Xg be a family of ﬁlters such that
x 2 U for all U 2 U.x/, and assume that for any U 2 U.x/, there
exists V 2 U.x/ with V  U and U 2 U.y/ for all y 2 V . Then
fU.x/ j x 2 Xg coincides with the neighborhood ﬁlter for the topology
deﬁned by this family. a
In what follows, unless otherwise stated, U.x/ will denote the neighbor-
hood ﬁlter of a point x in a topological space X.
Example 3.1.24 Let L WD f1; 2; 3; 6g be the set of all divisors of 6, and
deﬁne x  y iff x divides y, so that we obtain
Let us compute—just for fun—the topology associated with this partial
order and a basis for the neighborhood ﬁlters for each element. The
topology can be seen from the table below (we have used that Ao D
X n .X n A/a; see page 59):

3.1. DEFINING TOPOLOGIES
299
Set
Closure
Interior
f1g
f1g
;
f2g
f1; 2g
;
f3g
f1; 3g
;
f6g
f1; 2; 3; 6g
f6g
f1; 2g
f1; 2g
;
f1; 3g
f1; 3g
;
f1; 6g
f1; 2; 3; 6g
f6g
f2; 3g
f1; 2; 3; 5g
;
f2; 6g
f1; 2; 3; 6g
f2; 6g
f3; 6g
f1; 2; 3; 6g
;
f1; 2; 3g
f1; 2; 3g
;
f1; 2; 6g
f1; 2; 3; 6g
f2; 6g
f1; 3; 6g
f1; 2; 3; 6g
f3; 6g
f2; 3; 6g
f1; 2; 3; 6g
f2; 3; 6g
f1; 2; 3; 6g
f1; 2; 3; 6g
f1; 2; 3; 6g
This is the topology:
 D
˚
;; f6g; f2; 6g; f3; 6g; f2; 3; 6g; f1; 2; 3; 6g

:
A basis for the respective neighborhood ﬁlters is given in this table:
Element
Basis
1
˚
f1; 2; 3; 6g

2
˚
f2; 6g; f1; 2; 3; 6g

3
˚
f3; 6g; f2; 3; 6g; f1; 2; 3; 6g

6
˚
f6g; f2; 6g; f3; 6g; f2; 3; 6g; f1; 2; 3; 6g

✌
The next example deals with topological groups, i.e., topological spaces
which have also a group structure rendering the group operations contin-
uous. Here the neighborhood structure is fairly uniform—if you know
the neighborhood ﬁlter of the neutral element, you know the neighbor-
hood ﬁlter of each element, because you obtain them by a left shift or a
right shift.
Example 3.1.25 Let .G; / be a group and  be a topology on G such
that the map hx; yi 7! xy1 is continuous. Then .G; ; / is called a
topological group. We will write down a topological group as G; the
group operations and the topology will not be mentioned. The neutral

300
CHAPTER 3. TOPOLOGICAL SPACES
element is denoted by e; multiplication will usually be omitted. Given
a subset U of G, deﬁne gU WD fgh j h 2 U g and Ug WD fhg j h 2 U g
for g 2 G.
Let us examine the algebraic operations in a group. Put 	.x; y/ WD
xy1, then the map 
 W g 7! g1 which maps each group element
to its inverse is just 	.e; g/; hence the cut of a continuous map to it
is continuous as well. 
 is a bijection with 
 ı 
 D idG, so it is in
fact a homeomorphism. We obtain multiplication as xy D 	.x; 
.y//,
so multiplication is also continuous. Fix g 2 G, then multiplication
g W x 7! gx from the left and g W x 7! xg from the right are
continuous. Now both g and g are bijections, and g ı g1 D
g1 ı g D idG, also g ı g1 D g1 ı g D idG; thus g and g
are homeomorphisms for every g 2 G.
Thus we have in a topological group this characterization of the neigh-
borhood ﬁlter for every g 2 G:
U.g/ D fgU j U 2 U.e/g D fUg j U 2 U.e/g:
In fact, let U be a neighborhood of g, then 1
g

U

D g1U is a neigh-
borhood of e, so is 1
g

U

D Ug1. Conversely, a neighborhood V of
e determines a neighborhood 1
g1

V

D gV resp. 1
g1

V

D Vg of
g. ✌
3.2
Filters and Convergence
The relationship between topologies and ﬁlters turns out to be fairly
tight, as we saw when discussing the neighborhood ﬁlter of a point. We
saw also that we can actually grow a topology from a suitable family of
neighborhood ﬁlters. This relationship is even closer, as we will discuss
now when having a look at convergence.
Let .xn/n2N be a sequence in R which converges to x 2 R. This means
that for any given open neighborhood U of x, there exists an index n 2
N such that fxm j m  ng  U , so all members of the sequence having
an index larger than n are members of U . Now consider the ﬁlter F
generated by the set
˚
fxm j m  ng j n 2 N

of tails. The condition
above says exactly that U.x/  F, if you think a bit about it. This leads
to the deﬁnition of convergence in terms of ﬁlters.

3.2. FILTERS AND CONVERGENCE
301
Deﬁnition 3.2.1 Let X be a topological space and F a ﬁlter on X. Then
F converges to a limit x 2 X iff U.x/  F. This is denoted by F ! x.
F ! x
Plainly, U.x/ ! x for every x. Note that the deﬁnition above does not
force the limit to be uniquely determined. If two different points x; y
share their neighborhood ﬁlter, then F ! x iff F ! y. Look again at
Example 3.1.24. There, all neighborhood ﬁlters are contained in U.6/,
so that we have U.6/ ! t for t 2 f1; 2; 3; 6g. It may seem that the
deﬁnition of convergence through a ﬁlter is too involved (after all, being
a ﬁlter should not be taken on a light shoulder!). In fact, sometimes
convergence is deﬁned through a net as follows. Let .I; / be a directed
Net
set, i.e.,  is a partial order such that, given i; j 2 I, there exists k with
i  k and j  k. An I-indexed family .xi/i2I is said to converge to
a point x iff, given a neighborhood U 2 U.x/, there exists k 2 I such
that xi 2 U for all i  k. This generalizes the concept of convergence
from sequences to index sets of arbitrary size. But look at this. The sets
˚
fxj j j  ig j i 2 I

form a ﬁlter base, because .I; / is directed.
The corresponding ﬁlter converges to x iff the net converges to x.
But what about the converse? Take a ﬁlter F on X; then F1  F2 iff
F2  F1 renders .F; / a net. In fact, given F1; F2 2 F, we have
F1  F1 \ F2 and F2  F1 \ F2. Now pick xF 2 F . Then the
net .xF /F 2F converges to x iff F ! x. Assume that F ! x; take
U 2 U.x/, then U 2 F; thus if F 2 F with F  U , then F  U ; hence
xF 2 U for all such xF . Conversely, if each net .xF /F 2F derived from
F converges to x, then for a given U 2 U.x/, there exists F0 such that
xF 2 U for F  F0. Since xF has been chosen arbitrarily from F , this
can only hold if F  U for F  F0, so that U 2 F. Because U 2 U.x/
was arbitrary, we conclude U.x/  F.
Hence we ﬁnd that ﬁlters offer a uniform generalization.
The argument above shows that we may select the elements xF from
a base for F. If the ﬁlter has a countable base, we construct in this
way a sequence; conversely, the ﬁlter constructed from a sequence has a
countable base. Thus the convergence of sequences and the convergence
of ﬁlters with a countable base are equivalent concepts.
We investigate the characterization of the topological closure in terms of
ﬁlters. In order to do this, we need to be able to restrict a ﬁlter to a set,
Trace

302
CHAPTER 3. TOPOLOGICAL SPACES
i.e., looking at the footstep the ﬁlter leaves on the set, hence at
F \ A WD fF \ A j F 2 Fg:
This is what we will do now.
Lemma 3.2.2 Let X be a set and F be a ﬁlter on X. Then F \ A is a
ﬁlter on A iff F \ A 6D ; for all F 2 F.
Proof Since a ﬁlter must not contain the empty set, the condition is
necessary. But it is also sufﬁcient, because it makes sure that the laws
of a ﬁlter are satisﬁed. a
Looking at F \ A for an ultraﬁlter F, we know that either A 2 F or
X n A 2 F, so if F \ A 6D ; holds for all F 2 F, then this implies that
A 2 F. Thus we obtain:
Corollary 3.2.3 Let X be a set and F be an ultraﬁlter on X. Then F\A
is a ﬁlter iff A 2 F. Moreover, in this case, F \ A is an ultraﬁlter on A.
Proof It remains to show that F \ A is an ultraﬁlter on A, provided
F \ A is a ﬁlter. Let B 62 F \ A for some subset B  A. Since
A 2 F, we conclude B 62 F; thus X n B 2 F, since F is an ultraﬁlter.
Thus .X n B/ \ A D A n B 2 F \ A, so F \ A is an ultraﬁlter by
Lemma 1.5.21. a
From Lemma 3.2.2, we obtain a simple and elegant characterization of
the topological closure of a set.
Proposition 3.2.4 Let X be a topological space, A  X. Then x 2 Aa
iff U.x/ \ A is a ﬁlter on A. Thus x 2 Aa iff there exists a ﬁlter F on A
with F ! x.
Proof We know from the deﬁnition of Aa that x 2 Aa iff U \ A 6D ;
for all U 2 U.x/. This is by Lemma 3.2.2 equivalent to U.x/ \ A being
a ﬁlter on A. a
We know from calculus that continuous functions preserve convergence,
i.e., if xn ! x and f is continuous, then f .xn/ ! f .x/. We want to
carry this over to the world of ﬁlters. For this, we have to deﬁne the
image of a ﬁlter. Let F be a ﬁlter on a set X and f W X ! Y a map;
then
f .F/ WD fB  Y j f 1
B

2 Fg
is a ﬁlter on Y . In fact, ; 62 f .F/, and, since f 1 preserves the Boolean
Image of a
ﬁlter
operations, f .F/ is closed under ﬁnite intersections. Let B 2 f .F/ and

3.2. FILTERS AND CONVERGENCE
303
B  B0. Since f 1
B

2 F, and f 1
B

 f 1
B0
, we conclude
f 1
B0
2 F, so that B0 2 f .F/. Hence f .F/ is also upper closed, so
that it is in fact a ﬁlter.
This is an easy representation through the direct image.
Lemma 3.2.5 Let f W X ! Y be a map, F a ﬁlter on X, then f .F/
equals the ﬁlter generated by ff

A

j A 2 Fg.
Proof Because f

A1 \ A2

 f

A1

\ f

A2

, the set G0 WD ff

A

j
A 2 Fg is a ﬁlter base. Denote by G the ﬁlter generated by G0.
We claim that f .F/ D G.
“”: Assume that B 2 f .F/; hence f 1
B

2 F. Since f

f 1
B

 B, we conclude that B is contained in the ﬁlter generated by
G0, hence in G.
“	”: If B 2 G0, we ﬁnd A 2 F with B D f

A

; hence A 
f 1
f

A

D f 1
B

2 F, so that B 2 f .F/. This implies
the desired inclusion, since f .F/ is a ﬁlter.
This establishes the desired equality and proves the claim. a
We see also that not only the ﬁlter property is transported through maps,
but also the property of being an ultraﬁlter.
Lemma 3.2.6 Let f W X ! Y be a map and F an ultraﬁlter on X.
Then f .F/ is an ultraﬁlter on Y .
Proof It is by Lemma 1.5.21 enough to show that if f .F/ does not con-
tain a set, it will contain its complement, since f .F/ is already known to
be a ﬁlter. In fact, assume that H 62 f .F/, so that f 1
H

62 F. Since
F is an ultraﬁlter, we know that X n f 1
H

2 F; but X n f 1
H

D
f 1
Y n H

, so that Y n H 2 f .F/. a
Example 3.2.7 Let X be the product of the topological spaces .Xi/i2I
with projections i W X ! Xi. For a ﬁlter F on X, we have j .F/ D
fAj  Xj j Aj  Q
i6Dj Xi 2 Fg: ✌
Continuity preserves convergence:
Proposition 3.2.8 Let X and Y be topological spaces and f W X ! Y
a map.
1. If f is continuous and F a ﬁlter on X, then F ! x implies
f .F/ ! f .x/ for all x 2 X.

304
CHAPTER 3. TOPOLOGICAL SPACES
2. If F ! x implies f .F/ ! f .x/ for all x 2 X and all ﬁlters F on
X, then f is continuous.
Proof Let V 2 U.f .x//; then there exists U 2 U.f .x// open with
U  V . Since f 1
U

2 U.x/  F, we conclude U 2 f .F/; hence
V 2 f .F/. Thus U.f .x//  f .F/, which means that f .F/ ! f .x/
indeed. This establishes the ﬁrst part.
Now assume that F ! x implies f .F/ ! f .x/ for all x 2 X and
an arbitrary ﬁlter F on X. Let V  Y be open. Given x 2 f 1
V

,
we ﬁnd an open set U with x 2 U  f 1
V

in the following way.
Because x 2 f 1
V

, we know f .x/ 2 V . Since U.x/ ! x, we obtain
from the assumption that f .U.x// ! f .x/; thus U.f .x//  f .U.x//.
Because V 2 U.f .x//, it follows f 1
V

2 U.x/; hence we ﬁnd an
open set U with x 2 U  f 1
V

. Consequently, f 1
V

is open in
X. a
Thus continuity and ﬁlters cooperate in a friendly manner.
Proposition 3.2.9 Assume that X carries the initial topology with re-
spect to a family .fi W X ! Xi/i2I of functions. Then F ! x iff
fi.F/ ! fi.x/ for all i 2 I.
Proof Proposition 3.2.8 shows that the condition is necessary. Assume
that fi.F/ ! fi.x/ for every i 2 I, let i be the topology on Xi. The
sets
˚
ff 1
i1

Gi1

\ : : : \ f 1
ik

Gik

g j i1; : : : ; ik 2 I;
fi1.x/ 2 Gi1 2 i1; : : : ; fik.x/ 2 Gik 2 ik; k 2 N

form a base for the neighborhood ﬁlter for x in the initial topology.
Thus, given an open neighborhood U of x, we have f 1
i1

Gi1

\ : : : \
f 1
ik

Gik

 U for some suitable ﬁnite set of indices. Since fij .F/ !
fij .x/, we infer Gij 2 fij .F/; hence f 1
ij

Gij

2 F for 1  j  k,
and thus U 2 F. This means U.x/  F. Hence F ! x, as asserted.
a
We know that in a product, a sequence converges iff its components
converge. This is the counterpart for ﬁlters:
Corollary 3.2.10 Let X D Q
i2I Xi be the product of the topological
spaces. Then F ! .xi/i2I in X iff Fi ! xi in Xi for all i 2 I, where
Fi is the i-th projection i.F/ of F. a

3.2. FILTERS AND CONVERGENCE
305
The next observation further tightens the connection between topologi-
cal properties and ﬁlters. It requires the existence of ultraﬁlters, so recall
that we assume that the axiom of choice holds.
Theorem 3.2.11 Let X be a topological space. Then X is compact iff
each ultraﬁlter converges.
Thus we tie compactness, i.e., the possibility to extract from each cover
a ﬁnite subcover, to the convergence of ultraﬁlters. Hence an ultraﬁl-
ter in a compact space cannot but converge. The proof of Alexander’s
Subbase Theorem 1.5.57 indicates already that there is a fairly close
connection between the axiom of choice and topological compactness.
This connection is tightened here.
Proof 1. Assume that X is compact but that we ﬁnd an ultraﬁlter F
which fails to converge. Hence we can ﬁnd for each x 2 X an open
neighborhood Ux of x which is not contained in F. Since F is an ultra-
ﬁlter, X n Ux 2 F. Thus fX n Ux j x 2 Xg  F is a collection of closed
sets with T
x2X.X n Ux/ D ;. Since X is compact, we ﬁnd a ﬁnite
subset F  X such that T
x2F .X n Ux/ D ;. But X n Ux 2 F, and
F is closed under ﬁnite Intersections; hence ; 2 F. This is a contradic-
tion.
2. Assume that each ultraﬁlter converges. It is sufﬁcient to show that
each family H of closed sets for which every ﬁnite subfamily has a
nonempty intersection has a nonempty intersection itself. Now, the set
fT H0 j H0  H ﬁniteg of all ﬁnite intersections forms the base for a
ﬁlter F0, which may be extended to an ultraﬁlter F by Theorem 1.5.43.
By assumption F ! x for some x, hence U.x/  F. The point x is a
candidate for being a member in the intersection. Assume the contrary.
Then there exists H 2 H with x 62 H, so that x 2 X nH, which is open.
Thus X n H 2 U.x/  F. On the other hand, H D TfHg 2 F0  F,
so that ; 2 F. Thus we arrive at a contradiction, and x 2 T H. Hence
T H 6D ;. a
From Theorem 3.2.11 we obtain Tihonov’s celebrated theorem2 as an
easy consequence.
2“The Tychonoff Product Theorem concerning the stability of compactness un-
der formation of topological products may well be regarded as the single most impor-
tant theorem of general topology” according to H. Herrlich and G.E. Strecker, quoted
from [Her06, p. 85].

306
CHAPTER 3. TOPOLOGICAL SPACES
Theorem 3.2.12 (Tihonov’s Theorem) The product Q
i2I Xi of topo-
logical spaces with Xi 6D ; for all i 2 I is compact iff each space Xi is
compact.
Proof If the product X WD Q
i2I Xi is compact, then i

X

D Xi is
compact by Proposition 3.1.17. Let, conversely, be F an ultraﬁlter on
X, and assume all Xi are compact. Then i.F/ is by Lemma 3.2.6 an
ultraﬁlter on Xi for all i 2 I, which converges to some xi by Theo-
rem 3.2.11. Hence F ! .xi/i2I by Corollary 3.2.10. This implies the
compactness of X by another application of Theorem 3.2.11. a
According to [Eng89, p. 146], Tihonov established the theorem for a
product of an arbitrary numbers of closed and bounded intervals of the
real line (we know from the Heine–Borel Theorem 1.5.46 that these
intervals are compact). Kelley [Kel55, p. 143] gives a proof of the
nontrivial implication of the theorem which relies on Alexander’s Sub-
base Theorem 1.5.57. It goes like this. It is sufﬁcient to establish that
whenever we have a family of subbase elements, each ﬁnite family of
which fails to cover X, then the whole family will not cover X. The
sets
˚
1
i

U

j U  Xi open; i 2 I

form a subbase for the prod-
uct topology of X. Let S be a family of sets taken from this subbase
such that no ﬁnite family of elements of S covers X. Put Si WD fU 
Xi j 1
i

U

2 Sg, then Si is a family of open sets in Xi. Suppose Si
contains sets U1; : : : ; Uk which cover Xi, then 1
i

U1

; : : : ; 1
i

Uk

are elements of S which cover X; this is impossible, and hence Si fails
to contain a ﬁnite family which covers Xi. Since Xi is compact, there
exists a point xi 2 Xi with xi 62 S Si. But then x WD .xi/i2I cannot
be a member of S S. Hence S does not cover X. This completes the
proof.
Both proofs rely heavily on the axiom of choice, the ﬁrst one through
the existence of an ultraﬁlter extending a given ﬁlter and the second one
through Alexander’s Subbase Theorem. The relationship of Tihonov’s
Axiom of
Choice
Theorem to the axiom of choice is even closer: It can actually be shown
that
the
theorem
and
the
axiom
of
choice
are
equivalent
[Her06, Theorem 4.68]; this requires, however, establishing the exis-
tence of topological products without any recourse to the inﬁnite Carte-
sian product as a carrier.
We have deﬁned above the concept of a limit point of a ﬁlter. A weaker
concept is that of an accumulation point. Talking in terms of sequences,
an accumulation point of a sequence has the property that each

3.2. FILTERS AND CONVERGENCE
307
neighborhood of the point contains inﬁnitely many elements of the se-
quence. This carries over to ﬁlters in the following way.
Deﬁnition 3.2.13 Given a topological space X, the point x 2 X is
called an accumulation point of ﬁlter F iff U \ F 6D ; for every U 2
U.x/ and every F 2 F.
Since F ! x iff U.x/  F, it is clear that x is an accumulation point of
F. But a ﬁlter may fail to have an accumulation point at all. Consider the
ﬁlter F over R which is generated by the ﬁlter base
˚
a; 1Œ j a 2 R

;
it is immediate that F does not have an accumulation point. Let us have
a look at a sequence .xn/n2N, and the ﬁlter F generated by the inﬁnite
tails
˚
fxm j m  ng j n 2 N

. If x is an accumulation point of the
sequence, U \ fxm j m  ng 6D ; for every neighborhood U of x;
thus U \ F 6D ; for all F 2 F and all such U . Conversely, if x is an
accumulation point for ﬁlter F, it is clear that the deﬁning property holds
also for the elements of the base for the ﬁlter; thus x is an accumulation
point for the sequence. Hence we have found the “right” generalization
from sequences to ﬁlters.
An easy characterization of the set of all accumulation points goes like
this:
Lemma 3.2.14 The set of all accumulation points of ﬁlter F is exactly
T
F 2F F a.
Proof This follows immediately from the observation that x 2 Aa iff
U \ A 6D ; for each neighborhood U 2 U.x/. a
The lemma has an interesting consequence for the characterization of
compact spaces through ﬁlters:
Corollary 3.2.15 X is compact iff each ﬁlter on X has an accumulation
point.
Proof Let F be a ﬁlter in a compact space X, and assume that F does not
have an accumulation point. Lemma 3.2.14 implies that T
F 2F F a D ;.
Since X is compact, we ﬁnd F1; : : : ; Fn 2 F with Tn
iD1 Fi a D ;. Thus
Tn
iD1 Fi D ;. But this set is a member of F, a contradiction.
Now assume that each ﬁlter has an accumulation point. It is by Theo-
rem 3.2.11 enough to show that every ultraﬁlter F converges. An accu-
mulation point x for F is a limit: assume that F 6! x, then there exists

308
CHAPTER 3. TOPOLOGICAL SPACES
V 2 U.x/ with V 62 F; hence X nV 2 F. But V \F 6D ; for all F 2 F,
since x is an accumulation point. This is a contradiction. a
This is a characterization of accumulation points in terms of converging
ﬁlters.
Lemma 3.2.16 In a topological space X, the point x 2 X is an accu-
mulation point of ﬁlter F iff there exists a ﬁlter F0 with F  F0 and
F0 ! x.
Proof Let x be an accumulation point of F, then fU \ F j U 2
U.x/; F 2 Fg is a ﬁlter base. Let F0 be the ﬁlter generated by this
base, then F  F0, and certainly U.x/  F0, thus F0 ! x.
Conversely, let F  F0 ! x. Since U.x/  F0 follows, we con-
clude U \ F 6D ; for all neighborhoods U and all elements F 2 F,
for otherwise we would have ; D U \ F 2 F for some U; F 2 F,
which contradicts ; 2 F. Thus x is indeed an accumulation point of F.
a
3.3
Separation Properties
We see from Example 3.1.24 that a ﬁlter may converge to more than one
point. This may be undesirable. Think of a ﬁlter which is based on a
sequence, and each element of the sequence indicates an approximation
step. Then you want the approximation to converge, but the result of
this approximation process should be unique. We will see that this is
actually a special case of a separation property.
Proposition 3.3.1 Given a topological space X, the following proper-
ties are equivalent:
1. If x 6D y are different points in X, there exists U 2 U.x/ and
V 2 U.y/ with U \ V D ;.
2. The limit of a converging ﬁlter is uniquely determined.
3. fxg D TfU j U 2 U.x/ is closedg or all points x.
4. The diagonal  WD fhx; xi j x 2 Xg is closed in X  X.

3.3. SEPARATION PROPERTIES
309
Proof
1 ) 2: If F ! x and F ! y with x 6D y, we have U \ V 2 F for all
U 2 U.x/ and V 2 U.y/; hence ; 2 F. This is a contradiction.
2 ) 3: Let y 2 TfU j U 2 U.x/ is closedg; thus y is an accumula-
tion point of U.x/. Hence there exists a ﬁlter F with U.x/  F ! y by
Lemma 3.2.16. Thus x D y.
3 ) 4: Let hx; yi 62 ; then there exists a closed neighborhood W of
x with y 62 W . Let U 2 U.x/ open with U  W , and put V WD X nW ;
then hx; yi 2 U  V \  D ;, and U  V is open in X  X.
4 ) 1: If hx; yi 2 .X  X/ n , there exists open sets U 2 U.x/ and
V 2 U.y/ with U  V \  D ;; hence U \ V D ;. a
Looking at the proposition, we see that having a unique limit for a ﬁl-
ter is tantamount to being able to separate two different points through
disjoint open neighborhoods. Because these spaces are important, they
deserve a special name.
Deﬁnition 3.3.2 A topological space is called a Hausdorff space iff any
two different points in X can be separated by disjoint open neighbor-
hoods, i.e., iff condition (1) in Proposition 3.3.1 holds. Hausdorff spaces
are also called T2-spaces.
Example 3.3.3 Let X WD R, and deﬁne a topology through the base
˚
Œa; bŒ j a; b 2 R; a < b

. Then this is a Hausdorff space. This space
is sometimes called the Sorgenfrey line. ✌
Being Hausdorff can be determined from neighborhood ﬁlters:
Lemma 3.3.4 Let X be a topological space. Then X is a Hausdorff
space iff each x 2 X has a base U0.x/ for its neighborhood ﬁlters
such that for any x 6D y, there exists U 2 U0.x/ and V 2 U0.y/ with
U \ V D ;. a
It follows a ﬁrst and easy consequence for maps into a Hausdorff space,
viz., the set of arguments on which they coincide is closed.
Corollary 3.3.5 Let X, Y be topological spaces and f; g W X ! Y
continuous maps. If Y is a Hausdorff space, then fx 2 X j f .x/ D
g.x/g is closed.

310
CHAPTER 3. TOPOLOGICAL SPACES
Proof The map t W x 7! hf .x/; g.x/i is a continuous map X ! Y  Y .
Since   Y  Y is closed by Proposition 3.3.1, the set t1


is
closed. But this is just the set in question. a
The reason for calling a Hausdorff space a T2 space3 will become clear
once we have discussed other ways of separating points and sets; then
T2 will be a point in a spectrum denoting separation properties. For the
moment, we introduce two other separation properties which deal with
the possibility of distinguishing two different points through open sets.
Let for this X be a topological space.
T0-space: X is called a T0-space iff, given two different points x and
T0; T1
y, there exists an open set U which contains exactly one of them.
T1-space: X is called a T1-space iff, given two different points x and
y, there exist open neighborhoods U of x and V of y with y 62 U
and x 62 V .
The following examples demonstrate these spaces.
Example 3.3.6 Let X WD R, and deﬁne the topologies on the real num-
bers through
< WD f;; Rg [
˚
  1; aŒ j a 2 R

;
 WD f;; Rg [
˚
  1; a j a 2 R

:
Then < is a T0-topology.  is a T1-topology which is not T0. ✌
This is an easy characterization of T1-spaces.
Proposition 3.3.7 A topological space X is a T1-space iff fxg is closed
for all x 2 X.
Proof Let y 2 fxga, then y is in every open neighborhood U of x.
But this can happen in a T1-space only if x D y. Conversely, if fxg is
closed, and y 6D x, then there exists a neighborhood U of x which does
not contain y, and x is not in the open set X n fxg. a
Example 3.3.8 Let X be a set with at least two points, x0 2 X be ﬁxed.
Put ;c WD ; and for Ac WD A [ fx0g for A 6D ;. Then c is a closure
operator, and we look at the associated topology. Since fxg is open for
x 6D x0, X is a T0 space, and since fxg is not closed for x 6D x0, X is
not T1. ✌
3T stands for German Trennung, i.e., separation.

3.3. SEPARATION PROPERTIES
311
Example 3.3.9 Let .D; / be a partially ordered set. The topology as-
sociated with the closure operator for this order according to Exam-
ple 3.1.20 is T1 iff y  x , x D y, because this is what fxgc D fxg
says. ✌
Example 3.3.10 Let X WD N, and  WD fA  N j A is coﬁniteg [ f;g.
Recall that a coﬁnite set is deﬁned as having a ﬁnite complement. Then
 is a topology on X such that X n fxg is open for each x 2 X. Hence
X is a T1-space. But X is not a Hausdorff. If x 6D y and U is an open
neighborhood of x, then X n U is ﬁnite. Thus if V is disjoint from U ,
we have V  X n U . But then V cannot be an open set with y 2 V . ✌
While the properties discussed so far deal with the relationship of two
different points to each other, the next group of axioms looks at closed
sets; given a closed set F , we call an open set U with F  U an open
neighborhood of F . Let again X be a topological space.
T3-space: X is a T3-space iff given a point x and a closed set F , which
T3; T3 1
2 ; T4
does not contain x, there exist disjoint open neighborhoods of x
and of F .
T3 1
2 -space: X is a T3 1
2 -space iff given a point x and a closed set F
with x 62 F there exists a continuous function f W X ! R with
f .x/ D 1 and f .y/ D 0 for all y 2 F .
T4-space: X is a T4-space iff two disjoint closed sets have disjoint open
neighborhoods.
T3 and T4 deal with the possibility of separating a closed set from a
point resp. another closed set. T3 1
2 is squeezed in between these axioms.
Because fx 2 X j f .x/ < 1=2g and fx 2 X j f .x/ > 1=2g are disjoint
open sets, it is clear that each T3 1
2-space is a T3-space. It is also clear
that the deﬁning property of T3 1
2 is a special property of T4, provided
singletons are closed. The relationship and further properties will be
explored now.
It might be noted that continuous functions play now an important rˆole
here in separating objects.
T3 1
2 entails among others that there are
“enough” continuous functions. Engelking [Eng89, p. 29 and 2.7.17]
mentions that there are spaces which satisfy T3 but have only constant
continuous functions, and comments “they are, however, fairly compli-
cated : : :” (p. 29); Kuratowski [Kur66, p. 121] makes a similar remark.

312
CHAPTER 3. TOPOLOGICAL SPACES
So we will leave it at that and direct the reader, who wants to know
more, to these sources and the papers quoted there.
We look at some examples.
Example 3.3.11 Let X WD f1; 2; 3; 4g.
1. With the indiscrete topology f;; Xg, X is a T3- space, but it is
neither T2 nor T1.
2. Take the topology
˚
f1g; f1; 2g; f1; 3g; f1; 2; 3g; X; ;

; then two
closed sets are only disjoint when one of them is empty, because
all of them contain the point 4 (with the exception of ;, of course).
Thus the space is T4. The point 1 and the closed set f4g cannot be
separated by open sets; thus the space is not T3.
✌
The next example displays a space which is T2 but not T3.
Example 3.3.12 Let X WD R, and put Z WD f1=n j n 2 Ng. Deﬁne in
addition for x 2 R and i 2 N the sets Bi.x/ WD x1=i; xC1=iŒ: Then
U0.x/ WD fBi.x/ j i 2 Ng for x 6D 0, and U0.0/ WD fBi.0/nZ j i 2 Ng
deﬁne neighborhood ﬁlters for a Hausdorff space by Lemma 3.3.4. But
this is not a T3-space. One notes ﬁrst that Z is closed: if x 62 Z and
x 62 Œ0; 1, one certainly ﬁnds i 2 N with Bi.x/ \ Z D ;, and if
0 < x  1, there exists k with 1=.k C 1/ < x < 1=k, so taking
1=i less than the minimal distance of x to 1=k and 1=.k C 1/, one
has Bi.x/ \ Z D ;. If x D 0, each neighborhood contains an open
set which is disjoint from Z. Now each open set U which contains Z
contains also 0, so we cannot separate 0 from Z. ✌
Just one positive message: the reals satisfy T3 1
2 .
Example 3.3.13 Let F  R be nonempty, then
f .t/ WD inf
y2F
jt  yj
1 C jt  yj
deﬁnes a continuous function f W R ! Œ0; 1 with ´ 2 F , f .´/ D 0.
Thus, if x 62 F , we have f .x/ > 0, so that y 7! f .y/=f .x/ is a
continuous function with the desired properties. Thus the reals with the
usual topology are a T3 1
2 -space. ✌

3.3. SEPARATION PROPERTIES
313
The next proposition is a characterization of T3-spaces in terms of open
neighborhoods, motivated by the following observation. Take a point
x 2 R and an open set G  R with x 2 G.
Then there exists
r > 0 such that the open interval x  r; x C rŒ is entirely contained
in G. But we can say more: by making this open interval a little bit
smaller, we can actually ﬁt a closed interval around x into the given
neighborhood as well, so, for example, x 2 x  r=2; x C r=2Œ 
Œx  r=2; x C r=2  x  r; x C rŒ  G. Thus we ﬁnd for the given
neighborhood another neighborhood, the closure of which is entirely
contained in it.
Proposition 3.3.14 Let X be a topological space. Then the following
are equivalent:
1. X is a T3-space.
2. For every point x and every open neighborhood U of x, there
exists an open neighborhood V of x with V a  U .
Proof 1
)
2: Let U be an open neighborhood of x, then x is not
contained in the closed set X n U , so by T3 we ﬁnd disjoint open
sets U1; U2 with x 2 U1 and X n U  U2; hence X n U2  U .
Because U1  X n U2  U , and X n U2 is closed, we conclude
U a
1  U .
2
)
1: Assume that we have a point x and a closed set F with
x 62 F . Then x 2 X n F , so that X n F is an open neighborhood
of x. By assumption, there exists an open neighborhood V of x with
x 2 V a  X nF ; then V and X n.V a/ are disjoint open neighborhoods
of x resp. F . a
This characterization can be generalized to T4-spaces (roughly, by re-
placing the point through a closed set) in the following way.
Proposition 3.3.15 Let X be a topological space. Then the following
are equivalent:
1. X is a T4-space.
2. For every closed set F and every open neighborhood U of F ,
there exists an open neighborhood V of F with F  V  V a 
U .

314
CHAPTER 3. TOPOLOGICAL SPACES
The proof of this proposition is actually nearly a copy of the preceding
one, mutatis mutandis.
Proof 1 ) 2: Let U be an open neighborhood of the closed set F ,
then the closed set F 0 WD X n U is disjoint from F , so that we can
ﬁnd disjoint open neighborhoods U1 of F and U2 of F 0; thus U1 
X n U2  X n F 0 D U , so V WD U1 is the open neighborhood we are
looking for.
2
)
1: Let F and F 0 be disjoint closed sets, then X n F 0 is an
open neighborhood for F . Let V be an open neighborhood for F with
F  V  V a  X n F 0, then V and U WD X n .V a/ are disjoint open
neighborhoods of F and F 0. a
We mentioned above that the separation axiom T3 1
2 makes sure that
there are enough continuous functions on the space. Actually, the con-
tinuous functions even determine the topology in this case, as the fol-
lowing characterization shows.
Proposition 3.3.16 Let X be a topological space, then the following
statements are equivalent:
1. X is a T3 1
2 -space.
2. ˇ WD
˚
f 1
U

j f W X ! R is continuous; U  R is open

constitutes a basis for the topology of X.
Proof The elements of ˇ are open sets, since they are comprised of
inverse images of open sets under continuous functions.
1 ) 2: Let G  X be an open set with x 2 G. We show that we
can ﬁnd B 2 ˇ with x 2 B  G. In fact, since X is T3 1
2, there exists
a continuous function f W X ! R with f .x/ D 1 and f .y/ D 0 for
y 2 X nG. Then B WD fx 2 X j 1 < x < 1=2g D f 1
1; 1=2Œ

is a suitable element of ˇ.
2 ) 1: Take x 2 X and a closed set F with x 62 F . Then U WD
X n F is an open neighborhood x. Then we can ﬁnd G  R open
and f W X ! R continuous with x 2 f 1
G

 U . Since G is
the union of open intervals, we ﬁnd an open interval I WD a; bŒ  G
with f .x/ 2 I. Let G W R ! R be a continuous with g.f .x// D 1
and g.t/ D 0, if t 62 I; such a function exists since R is a T3 1
2 -space

3.3. SEPARATION PROPERTIES
315
(Example 3.3.13). Then g ı f is a continuous function with the desired
properties. Consequently, X is a T3 1
2 -space. a
The separation axioms give rise to names for classes of spaces. We will
introduce their traditional names now.
Deﬁnition 3.3.17 Let X be a topological space, then X is called:
 regular iff X satisﬁes T1 and T3,
 completely regular iff X satisﬁes T1 and T3 1
2 ,
 normal iff X satisﬁes T1 and T4.
The reason T1 is always included is that one wants to have every single-
ton as a closed set, which, as the examples above show, is not always
the case. Each regular space is a Hausdorff space, each regular space
is completely regular, and each normal space is regular. We will ob-
tain as a consequence of Urysohn’s Lemma that each normal space is
completely regular as well (Corollary 3.3.24).
In a completely regular space, we can separate a point x from a closed
set not containing x through a continuous function. It turns out that
normal spaces have an analogous property: Given two disjoint closed
sets, we can separate these sets through a continuous function. This is
what Urysohn’s Lemma says, a famous result from the beginnings of
set-theoretic topology. To be precise:
Theorem 3.3.18 (Urysohn) Let X be a normal space. Given disjoint
closed sets F0 and F1, there exists a continuous function f W X ! R
such that f .x/ D 0 for x 2 F0 and f .x/ D 1 for x 2 F1.
We need some technical preparations for proving Theorem 3.3.18; this
gives also the opportunity to introduce the concept of a dense set.
Deﬁnition 3.3.19 A subset D  X of a topological space X is called
dense iff Da D X.
Dense sets are fairly practical when it comes to comparing continuous
functions for equality: if it sufﬁces that the functions coincide on a dense
set, then they will be equal. Just for the record:
Lemma 3.3.20 Let f; g W X ! Y be continuous maps with Y Haus-
dorff, and assume that D  X is dense. Then f D g iff f .x/ D g.x/
for all x 2 D.

316
CHAPTER 3. TOPOLOGICAL SPACES
Proof Clearly, if f D g, then f .x/ D g.x/ for all x 2 D. So we have
to establish the other direction.
Because Y is a Hausdorff space, Y WD fhy; yi j y 2 Y g is closed
(Proposition 3.3.1), and because f g W X X ! Y Y is continuous,
.f  g/1
Y

 X X is closed as well. The latter set contains D,
hence its closure X. a
It is immediate that if D is dense, then U \ D 6D ; for each open set U ,
so in particular each neighborhood of a point meets the dense set D. To
provide an easy example, both Q and R n Q are dense subsets of R in
the usual topology. Note that Q is countable, so R has even a countable
dense set.
The ﬁrst lemma has a family of subsets indexed by a dense subset of R
exhaust a given set and provides a useful real function.
Lemma 3.3.21 Let M be set, D  RC be dense, and .Et/t2D be a
family of subsets of M with these properties:
 if t < s, then Et  Es,
 M D S
t2D Et.
Put f .m/ WD infft 2 D j m 2 Etg, then we have for all s 2 R:
1. fm j f .m/ < sg D SfEt j t 2 D; t < sg,
2. fm j f .m/  sg D TfEt j t 2 D; t > sg.
Proof 1. Let us work on the ﬁrst equality. If f .m/ < s, there exists
t < s with m 2 Et. Conversely, if m 2 Et for some t < s, then
f .m/ D inffr 2 D j m 2 Erg  t < s.
2. For the second equality, assume f .m/  s, then we can ﬁnd for each
r > s some t < r with m 2 Et  Er. To establish the other inclusion,
assume that f .m/  t for all t > s. If f .m/ D r > s, we can ﬁnd
some t0 2 D with r > t0 > s; hence f .m/  t0. This is a contradiction;
hence f .m/  s. a
This lemma, which does not assume a topology on M by requiring only
a plain set, is extended now for the topological scenario in which we
will use it. We assume that each set Et is open, and we assume that Et
contains the closures of its predecessors. Then it will turn out that the
function we just have deﬁned is continuous, speciﬁcally:

3.3. SEPARATION PROPERTIES
317
Lemma 3.3.22 Let X be a topological space and D  RC a dense
subset, and assume that .Et/t2D is a family of open sets with these
properties:
 if t < s, then Ea
t  Es,
 X D S
t2D Et.
Then f W x 7! inf ft 2 D j x 2 Etg deﬁnes a continuous function
on X.
Proof 0. Because a subbase for the topology on R is comprised of the
intervals   1; xŒ resp. x; C1Œ, we see from Lemma 3.1.9 that it is
sufﬁcient to show that for any s 2 R the sets fx 2 X j f .x/ < sg
and fx 2 X j f .x/ > sg are open, since they are the corresponding
inverse images under f . For the latter set, we show that its complement
fx 2 X j f .x/  sg is closed. Fix s 2 R.
1. We obtain from Lemma 3.3.21 that fx 2 X j f .x/ < sg equals
SfEt j t 2 D; t < sg; since all sets Et are open, their union is. Hence
fx 2 X j f .x/ < sg is open.
2. We obtain again from Lemma 3.3.21 that fx 2 X j f .x/  sg equals
TfEt j t 2 D; t > sg, so if we can show that TfEt j t 2 D; t >
sg D TfEa
t j t 2 D; t > sg, we are done. In fact, the left-hand side
is contained in the right-hand side, so assume that x is an element of
the right-hand side. If x is not contained in the left-hand side, we ﬁnd
t0 > s with t0 2 D such that x 62 Et 0. Because D is dense, we ﬁnd
some r with s < r < t0 with Ea
r  Et 0. But then x 62 Ea
r ; hence
x 62 TfEa
t j t 2 D; t > sg, a contradiction. Thus both sets are equal,
so that fx 2 X j f .x/  sg is closed. a
We are now in a position to establish Urysohn’s Lemma. The idea of
the proof rests on this observation for a T4-space X: suppose that we
Idea of the
proof
have open sets A and B with A  Aa  B. Then we can ﬁnd an open
set C such that Aa  C  C a  B; see Proposition 3.3.15.
Denote
just for the proof for open sets A; B the fact that Aa  B by A v B.
A v B
Then we may express the idea above by saying that A v B implies the
existence of an open set C with A v C v B, so C may be squeezed
in. But now we have A v C and C v B, so we ﬁnd open sets E
and F with A v E v C and C v F v B, arriving at the chain
A v E v C v F v B. But why stop here?

318
CHAPTER 3. TOPOLOGICAL SPACES
The proof makes this argument systematic and constructs in this way a
continuous function.
Proof (of Theorem 3.3.18) 1. Let D WD fp=2q j p; q nonnegative
integersg. These are all dyadic numbers, which are dense in RC. We
are about to construct a family .Et/t2D of open sets Et indexed by D
in the following way.
2. Put Et WD X for t > 1, and let E1 WD X n F1; moreover, let E0 be
an open set containing F0 which is disjoint from E1. We now construct
open sets Ep=2n by induction on n in the following way. Assume that
we have already constructed open sets
E0 v E
1
2n1 v E
2
2n1 : : : v E 2n11
2n1
v E1:
Let t D
2mC1
2n
, then we ﬁnd an open set Et with E 2m
n
v Et v
E 2mC2
2n ; we do this for all m with 0  m  2n1  1.
3. Look as an illustration at the case n D 3. We have found already
the open sets E0 v E1=4 v E1=2 v E3=4 v E1. Then the
construction goes on with ﬁnding open sets E1=8; E3=8; E5=8, and E7=8
such that after the step is completed, we obtain this chain:
E0 v E1=8 v E1=4 v E3=8 v E1=2 v E5=8
v E3=4 v E7=8 v E1:
4. In this way, we construct a family .Et/t2D with the properties re-
quested by Lemma 3.3.22. It yields a continuous function f W X ! R
with f .x/ D 0 for all x 2 F0 and f .1/.x/ D 1 for all x 2 F1. a
Urysohn’s Lemma is used to prove the Tietze extension theorem, which
we will only state, but not prove.
Theorem 3.3.23 Let X be a T4-space and f W A ! R be a function
which is continuous on a closed subset A of X. Then f can be extended
to a continuous function f  on all of X. a
We obtain as an immediate consequence of Urysohn’s Lemma:
Corollary 3.3.24 A normal space is completely regular.
We have obtained a hierarchy of spaces through gradually tightening the
separation properties and found that continuous functions help with the

3.3. SEPARATION PROPERTIES
319
separation. The question arises, how compactness ﬁts into this hierar-
chy. It turns out that a compact Hausdorff space is normal; the converse
obviously does not hold: the reals with the Euclidean topology are nor-
mal, but by no means compact.
We call a subset K in a topological space X compact iff it is compact as
a subspace, i.e., a compact topological space in its own right. This is a
ﬁrst and fairly straightforward observation; see Lemma 1.5.55.
Lemma 3.3.25 A closed subset F of a compact space X is compact.
Proof Let .Gi \ F /i2I be an open cover of F with Gi  X open; then
fF g [ fGi j i 2 Ig is an open cover of X, so we can ﬁnd a ﬁnite subset
J  I such that fF g [ fGj j i 2 J g covers X; hence fGi \ F j i 2 J g
covers F . a
In a Hausdorff space, the converse holds as well:
Lemma 3.3.26 Let X be a Hausdorff space and K  X compact, then:
1. Given x 62 K, there exist disjoint open neighborhoods U of x and
V of K.
2. K is closed.
Proof Given x 62 K, we want to ﬁnd U 2 U.x/ with U \ K D ; and
V 	 K open with U \ V D ;.
Let us see how to do that. There exists for x and any element y 2 K
disjoint open neighborhoods Uy 2 U.x/ and Wy 2 U.y/, because X is
Hausdorff. Then .Wy/y2Y is an open cover of K; hence by compact-
ness, there exists a ﬁnite subset W0  W such that fWy j y 2 W0g
covers K. But then T
y2W0 Uy is an open neighborhood of x which is
disjoint from V WD S
y2W0 Wy, hence from K. V is the open neighbor-
hood of K we are looking for. This establishes the ﬁrst part; the second
follows as an immediate consequence. a
Look at the reals as an illustrative example.
Corollary 3.3.27 A  R is compact iff it is closed and bounded.
Proof If A  R is compact, then it is closed by Lemma 3.3.26, since
R is a Hausdorff space. Since A is compact, it is also bounded. If,
conversely, A  R is closed and bounded, then we can ﬁnd a closed
interval Œa; b such that A  Œa; b. We know from the Heine–Borel

320
CHAPTER 3. TOPOLOGICAL SPACES
Theorem 1.5.46 that this interval is compact, and a closed subset of a
compact space is compact by Lemma 3.3.25. a
This has yet another, frequently used consequence, viz., that a contin-
uous real-valued function on a compact space assumes its minimal and
its maximal value. Just for the record:
Corollary 3.3.28 Let X be a compact Hausdorff space and f W X !
R a continuous map.
Then there exist x; x 2 X with f .x/ D
min f

X

and f .x/ D max f

X

. a
But—after traveling an interesting side path—let us return to the prob-
lem of establishing that a compact Hausdorff space is normal. We know
now that we can separate a point from a compact subset through dis-
joint open neighborhoods. This is but a small step from establishing the
solution to the above problem.
Proposition 3.3.29 A compact Hausdorff space is normal.
Proof Let X be compact and A and B disjoint closed subsets. Since X
is a Hausdorff, A and B are compact as well. Now the rest is an easy
application of Lemma 3.3.26. Given x 2 B, there exist disjoint open
neighborhoods Ux 2 U.x/ of x and Vx of A. Let B0 be a ﬁnite subset
of B such that U WD SfU.x/ j b 2 B0g covers B and V WD TfVx j
x 2 B0g is an open neighborhood of A. U and V are disjoint. a
From the point of view of separation, to be compact is a stronger prop-
erty than being normal for a topological space. The example R shows
that this is a strictly stronger property. We will show now that R is just
one point apart from being compact by investigating locally compact
spaces.
3.4
Local Compactness and Compactiﬁcation
We restrict ourselves in this section to Hausdorff spaces.
Sometimes a space is not compact but has enough compact subsets, be-
cause each point has a compact neighborhood. These spaces are called
locally compact, and we investigate properties they share with and prop-
erties they distinguish them from compact spaces. We show also that a
locally compact space misses being compact by just one point. Adding
this point will make it compact, so we have an example here where we

3.4. LOCAL COMPACTNESS AND COMPACTIFICATION
321
embed a space into one with a desired property. While we are compacti-
fying spaces, we also provide another one, named after Stone and LCech,
which requires the basic space to be completely regular. We establish
another classic, the Baire Theorem, which states that in a locally com-
pact T3-space, the intersection of a countable number of open dense
sets is dense again; applications will capitalize on this observation, as
we will see.
Deﬁnition 3.4.1 Let X be a Hausdorff space. X is called locally com-
pact iff for each x 2 X and each open neighborhood U 2 U.x/ there
exists a neighborhood V 2 U.x/ such that V a is compact and V a  U .
Thus the compact neighborhoods form a basis for the neighborhood ﬁl-
ter for each point. This implies that we can ﬁnd for each compact subset
an open neighborhood with compact closure. The proof of this property
gives an indication of how to argue in locally compact spaces.
Proposition 3.4.2 Let X be a locally compact space and K a compact
subset. Then there exists an open neighborhood U of K and a compact
set K0 with K  U  K0.
Proof Let x 2 K, then we ﬁnd an open neighborhood Ux 2 U.x/ with
U a
x compact. Then .Ux/x2K is a cover for K, and there exists a ﬁnite
subset K0  K such that .Ux/x2K0 covers K. Put U WD S
x2K0, and
note that this open set has a compact closure. a
So this is not too bad: We have plenty of compact sets in a locally com-
pact space. Such a space is very nearly compact. We add to X just
one point, traditionally called 1, and deﬁne the neighborhood for 1
in such a way that the resulting space is compact. The obvious way
to do that is to make all complements of compact sets a neighborhood
of 1, because it will then be fairly easy to construct a ﬁnite subcover
from a cover of the new space. This is what the compactiﬁcation which
we discuss now will do for you. We carry out the construction in a
sequence of lemmata, just in order to render the process a bit more
transparent.
Lemma 3.4.3 Let X be a Hausdorff space with topology  and 1 62 X
be a distinguished new point. Put X WD X [ f1g, and deﬁne
One point
extension
 WD fU  X j U \X 2 g[fU  X j 1 2 U; XnU is compactg:

322
CHAPTER 3. TOPOLOGICAL SPACES
Then  is a topology on X, and the identity iX W X ! X is --
continuous.
Proof ; and X are obviously members of ; note that X n U being
compact entails U \ X being open. Let U1; U2 2 . If 1 2 U1 \ U2,
then X n .U1 \ U2/ is the union of two compact sets in X, hence is
compact. If 1 62 U1 \ U2, X \ .U1 \ U2/ is open in X. Thus  is
closed under ﬁnite intersections. Let .Ui/i2I be a family of elements of
. The critical case is that 1 2 U WD S
i2I Ui, say, 1 2 Uj . But
then X n U  X  Uj , which is compact, so that U 2 . Continuity
of iX is now immediate. a
We ﬁnd X in this new construction as a subspace.
Corollary 3.4.4 .X; / is a dense subspace of .X; /.
Proof We have to show that  D  \ X. But this is obvious from the
deﬁnition of . a
Now we can state and prove the result which has been announced above.
Theorem 3.4.5 Given a Hausdorff space X, the one point extension X
is a compact space, in which X is dense. If X is locally compact, X is
a Hausdorff space.
Proof It remains to show that X is compact and that it is a Hausdorff
space, whenever X is locally compact.
Let .Ui/i2I be an open cover of X, then 1 2 Uj for some j 2 I;
thus X n Uj is compact and is covered by .Ui/i2I;i6Dj . Select a ﬁnite
subset J  I such that .Ui/i2J covers X n Uj , then—voil`a—we have
found a ﬁnite cover .Ui/i2J[fjg of X.
Since the given space is Hausdorff, we have to separate the new point
1 from a given point x 2 X, provided X is locally compact. But take
a compact neighborhood U of x; then X n U is an open neighborhood
of 1. a
X is called the Alexandrov one-point compactiﬁcation of X. The new
point is sometimes called the inﬁnite point. It is not difﬁcult to show
that two different one-point compactiﬁcations are homeomorphic, so we
may talk about the (rather than a) one-point compactiﬁcation.

3.4. LOCAL COMPACTNESS AND COMPACTIFICATION
323
Looking at the map iX W X ! X, which permits looking at elements
of X as elements of X, we see that iX is injective and has the prop-
erty that iX

G

is an open set in the image iX

X

of X in X, when-
ever G  X is open. These properties will be used for characterizing
compactiﬁcations. Let us ﬁrst deﬁne embeddings, which are of interest
independently of this process.
Deﬁnition 3.4.6 The continuous map f W X ! Y between the topo-
logical spaces X and Y is called an embedding iff:
 f is injective,
 f

G

is open in f

X

, whenever G  X is open.
So if f W X ! Y is an embedding, we may recover a true image of
X from its image f

X

, so that f W X ! f

X

is a homeomor-
phism.
Consider again the map Œ0; 1N ! Œ0; 1M which is induced by a map
f W M ! N and which we dealt with in Lemma 3.1.16. We will put
this map to good use in a moment, so it is helpful to analyze it a bit more
closely.
Example 3.4.7 Let f W M ! N be a surjective map. Then f  W
Œ0; 1N ! Œ0; 1M , which sends g W N ! Œ0; 1 to g ı f W M ! Œ0; 1
is an embedding. We have to show that f  is injective and that it maps
open sets into open sets in the image. This is done in two steps:
f  is injective: In fact, if g1 6D g2, we ﬁnd n 2 N with g1.n/ 6D
g2.n/, and because f is onto, we ﬁnd m with n D f .m/; hence
f .g1/.m/ D g1.f .m// 6D g2.f .m// D f .g2/.m/. Thus
f .g1/
6D
f .g2/ (an alternative proof is proposed in
Lemma 2.1.29 in a more general scenario).
Open sets are mapped to open sets: We
know
already
from
Lemma 3.1.16 that f  is continuous, so we have to show that
the image f

G

of an open set G  Œ0; 1N is open in the sub-
space f

Œ0; 1M 
. Let h 2 f

G

; hence h D f .g/ for some
g 2 G. G is open; thus we can ﬁnd a base element H of the
product topology with g 2 H  G, say, H D Tk
iD1 1
N;ni

Hi

for some n1; : : : ; nk 2 N and some open subsets H1; : : : ; Hk
in Œ0; 1. Since f is onto, n1 D f .m1/; : : : ; nk D f .mk/ for

324
CHAPTER 3. TOPOLOGICAL SPACES
some m1; : : : ; mk 2 M. Since h 2 1
N;ni

Hi

iff f .h/ 2
1
M;mi

Hi

, we obtain
h
D
f .g/ 2 f  k
\
iD1
1
N;ni

Hi

D
 k
\
iD1
1
M;mi

Hi

\f 
Œ0; 1N 
The latter set is open in the image of Œ0; 1N under f , so we have
shown that the image of an open set is open relative to the subset
topology of the image.
These proofs will serve as patterns later on. ✌
Given an embedding, we deﬁne the compactiﬁcation of a space.
Deﬁnition 3.4.8 A pair .e; Y / is said to be a compactiﬁcation of a topo-
logical space X iff Y is a compact topological space and if e W X ! Y
is an embedding.
The pair .iX; X/ constructed as the Alexandrov one-point compacti-
ﬁcation is a compactiﬁcation in the sense of Deﬁnition 3.4.8, provided
the space X is locally compact. We are about to construct another im-
portant compactiﬁcation for a completely regular space X. Deﬁne for
X the space ˇX as follows4: Let F.X/ be the set of all continuous
maps X ! Œ0; 1 and map x to its evaluations from F.X/, so construct
eX W X 3 x 7! .f .x//f 2F .X/ 2 Œ0; 1F .X/. Then ˇX WD .eX

X

/a,
the closure being taken in the compact space Œ0; 1F .X/. We claim that
.eX; ˇX/ is a compactiﬁcation of X.
Before delving into the proof, we note that we want to have a com-
pletely regular space, since in these spaces we have enough continuous
functions, e.g., to separate points, as will become clear shortly. We will
ﬁrst show that this is a compactiﬁcation indeed, and then investigate an
interesting property of it.
Proposition 3.4.9 .eX; ˇX/ is a compactiﬁcation of the completely reg-
ular space X.
4It is a bit unfortunate that there appears to be an ambiguity in notation, since
we denote the basis of a topological space by ˇ as well. But tradition demands this
compactiﬁcation to be called ˇX, and from the context it should be clear what we have
in mind.

3.4. LOCAL COMPACTNESS AND COMPACTIFICATION
325
Proof 1. We take the closure in the Hausdorff space Œ0; 1F .X/, which is
compact by Tihonov’s Theorem 3.2.12. Hence ˇX is a compact Haus-
dorff space by Lemma 3.3.25.
2. eX is continuous, because we have f ı eX D f for f 2 F.X/,
and each f is continuous. eX is also injective, because we can ﬁnd for
x 6D x0 a map f 2 F.X/ such that f .x/ 6D f .x0/; this translates into
eX.x/.f / 6D eX.x0/.f /; hence eX.x/ 6D eX.x0/.
3. The image of an open set in X is open in the image. In fact, let
G  X be open, and take x 2 G. Since X is completely regular, we
ﬁnd f 2 F.X/ and an open set U  Œ0; 1 with x 2 f 1
U

 G;
this is so because the inverse images of the open sets in Œ0; 1 under
continuous functions form a basis for the topology (Proposition 3.3.16).
But x 2 f 1
U

 G is equivalent to x 2 .f ı eX/1
U

 G.
Because eX W X ! eX

X

is a bijection, this implies x 2 1
f

U


eX

G

\ eX

X

 eX

G

\ .eX

X

/a. Hence eX

G

is open in ˇX.
a
If the space we started from is already compact, then we obtain nothing
new:
Corollary 3.4.10 If X is a compact Hausdorff space, eX W X ! ˇX is
a homeomorphism.
Proof A compact Hausdorff space is normal, hence completely regu-
lar by Proposition 3.3.29 and Corollary 3.3.24, so we can construct
the space ˇX for X compact. The assertion then follows from Exer-
cise 3.10. a
This kind of compactiﬁcation is important, so it deserves a name.
Deﬁnition 3.4.11 The compactiﬁcation .eX; ˇX/ is called the Stone–
LCech compactiﬁcation of the regular space X.
This compactiﬁcation permits the extension of continuous maps in the
following sense: suppose that f W X ! Y is continuous with Y com-
pact, then there exists a continuous extension ˇX ! Y . This statement
is slightly imprecise, because f is not deﬁned on ˇX, so we want really
to extend f ı e1
X W eX

X

! Y —since eX is a homeomorphism from
X onto its image, one tends to identify both spaces.
Theorem 3.4.12 Let .eX; ˇX/ be the Stone– LC ech compactiﬁcation of
the completely regular space X. Then, given a continuous map f W

326
CHAPTER 3. TOPOLOGICAL SPACES
X ! Y with Y compact, there exists a continuous extension fŠ W ˇX !
Y to f ı e1
X .
The idea of the proof is to capitalize on the compactness of the target
space Y , because Y and ˇY are homeomorphic. This means that Y
has a topologically identical copy in Œ0; 1F .Y /, which may be used in
a suitable fashion. The proof is adapted from [Kel55, p. 153]; Kelley
calls it a “mildly intricate calculation.”
Proof 1. Deﬁne 'f W F.Y / ! F.X/ through h 7! f ı h; then
this map induces a map '
f
W Œ0; 1F .X/ ! Œ0; 1F .Y / by sending
t W F.X/ ! Œ0; 1 to t ı 'f . Then '
f is continuous according to
Lemma 3.1.16.
2. Consider this diagram:
We claim that '
f ı eX D eY ı f . In fact, take x 2 X and h 2 F.Y /;
then
.'
f ı eX/.x/.h/
D
.eX ı 'f /.h/ D eX.x/.h ı f /
D
.h ı f /.x/ D eY .f .x//.h/
D
.eY ı f /.x/.h/:
3. Because Y is compact, eY is a homeomorphism by Exercise 3.10,
and since '
f is continuous, we have
'
f

ˇX

D '
f

eX

X
a


'
f

eX

X
a  ˇY:
Thus e1
X ı '
f is a continuous extension to f ı eX. a
It is immediate from Theorem 3.4.12 that a Stone– LCech compactiﬁ-
cation is uniquely determined, up to homeomorphism. This justiﬁes
the probably a bit prematurely used characterization as the Stone– LCech
compactiﬁcation above.
Baire’s Theorem, which we will establish now, states a property of lo-
cally compact spaces which has a surprising range of applications—
it states that the intersection of dense open sets in a locally compact

3.4. LOCAL COMPACTNESS AND COMPACTIFICATION
327
T3-space is dense again. This applies of course to compact Hausdorff
spaces as well. The theorem has a counterpart for complete pseudomet-
ric spaces, as we will see below. For stating and proving the theorem,
we lift the assumption of working in a Hausdorff space, because it is
really not necessary here.
Theorem 3.4.13 Let X be a locally compact T3-space. Then the inter-
section of dense open sets is dense.
Proof 0. The idea of the proof is to construct for ; 6D G open a decreas-
ing sequence .Vn/n2N of sets with V a
nC1  Dn\Vn, where .Dn/n2N be
Idea of the
proof
a sequence of dense open sets, where V1 is chosen so that V a
1  D1\G.
Then we will conclude from the ﬁnite intersection property for compact
sets that G contains a point in the intersection T
n2N Dn.
1. Fix a nonempty open set G; then we have to show that G \ T
n2N
Dn 6D ;. Now D1 is dense and open; hence we ﬁnd an open set V1
such that V a
1 is compact and V a
1  D1 \G by Proposition 3.3.14, since
X is a T3-space. We select inductively in this way a sequence of open
sets .Vn/n2N with compact closure such that V a
nC1  Dn \ Vn. This is
possible since Dn is open and dense for each n 2 N.
2. Hence we have a decreasing sequence V a
2 	 : : : V a
n 	 : : : of closed
sets in the compact set V a
1 ; thus T
n2N V a
n D T
n2N Vn is not empty,
which entails G \ T
n2N Dn not being empty. a
Just for the record:
Corollary 3.4.14 The intersection of a sequence of dense open sets in
a compact Hausdorff space is dense.
Proof A compact Hausdorff space is normal by Proposition 3.3.29,
hence regular by Proposition 3.3.15; thus the assertion follows from
Theorem 3.4.13. a
We give an example from Boolean algebras.
Example 3.4.15 Let B be a Boolean algebra with }B as the set of all
prime ideals. Let Xa WD fI 2 }B j a 62 Ig be all prime ideals which do
not contain a given element a 2 B, then fXa j a 2 Bg is the basis for a
compact Hausdorff topology on }B, and a 7! Xa is a Boolean algebra
isomorphism; see the proof of Theorem 1.5.45.

328
CHAPTER 3. TOPOLOGICAL SPACES
Assume that we have a countable family S of elements of B with a D
sup S 2 B, then we say that the prime ideal I preserves the supremum
of S iff ŒaI D sups2S ŒsI holds. Here 
I is the equivalence rela-
tion induced by I, i.e., b 
I b0 , b  b0 2 I with  as the symmetric
difference in B (Lemma 1.5.40).
We claim that the set R of all prime ideals, which do not preserve the
supremum of this family, is closed and has an empty interior. Well, R D
Xa n S
k2K Xak. Because the sets Xa and Xak are clopen, R is closed.
Assume that the interior of R is not empty; then we ﬁnd b 2 B with
Xb  R, so that Xak  Xa n Xb D Xa^b for all k 2 K. Since a 7!
Xa is an isomorphism, this means ak  a ^ b; hence supk2K ak 
a ^ b for all k 2 K; thus a D a ^ b, and hence a  b. But then
Xb  Xa  Xb, which is certainly a contradiction. Consequently, the
set of all prime ideal preserving this particular supremum is open and
dense in }B.
If we are given for each n 2 N a family Sn  B and a0 2 B such that:
 a0 6D >, the maximal element of B,
 an WD sups2Sn s is an element of B for each n 2 N,
then we claim that there exists a prime ideal I which contains a0 and
which preserves all the suprema of Sn for n 2 N.
Let P be the set of all prime ideals which preserve all the suprema of
the families above, then
P D
\
n2N
Pn;
where Pn is the set of all prime ideals which preserve the supremum an,
which is dense and open by the discussion above. Hence P is dense by
Baire’s Theorem (Corollary 3.4.14). Since Xa0 D }B n Xa0 is open
and not empty, we infer that P \Xa0 is not empty, because P is dense.
Thus we can select an arbitrary prime ideal from this set. ✌
This example, which is taken from [RS50, Sect. 5], will help in estab-
lishing G¨odel’s Completeness Theorem; see Sect. 3.6.1. The approach
is typical for an application of Baire’s Theorem—it is used to show that
a set P , which is obtained from an intersection of countably many open
and dense sets in a compact space, is dense and that the object of one’s
desire is a member of P intersecting an open set; hence this object must
exist.

3.5. PSEUDOMETRIC AND METRIC SPACES
329
Having been carried away by Baire’s Theorem, let us return to the main-
stream of the discussion and make some general remarks. We see that
local compactness is a somewhat weaker property than compactness.
Other notions of compactness have been studied; an incomplete list for
Hausdorff space X includes:
countably compact: X is called countably compact iff each countable
open cover contains a ﬁnite subcover.
Lindel¨of space: X is a Lindel¨of space iff each open cover contains a
countable subcover.
paracompactness: X is said to be paracompact iff each open cover
has a locally ﬁnite reﬁnement. This explains it:
 An open cover B is a reﬁnement of an open cover A iff each
member of B is the subset of a member of A.
 An open cover A is called locally ﬁnite iff each point has a
neighborhood which intersects a ﬁnite number of elements
of A.
sequentially compact: X is called sequentially compact iff each se-
quence has a convergent subsequence (we will deal with this when
discussing compact pseudometric spaces; see Proposition 3.5.31).
The reader is referred to [Eng89, Chap. 3] for a penetrating study.
3.5
Pseudometric and Metric Spaces
We turn to a class of spaces now in which we can determine the dis-
tance between any two points numerically. This gives rise to a topology,
declaring a set as open iff we can construct for each of its points an open
ball which is entirely contained in this set. It is clear that this deﬁnes a
topology, and it is also clear that having such a metric gives the space
some special properties, which are not shared by general topological
spaces. It also adds a sense of visual clearness, since an open ball is
conceptually easier to visualize that an abstract open set. We will study
the topological properties of these spaces starting with pseudometrics,
with which we may measure the distance between two objects, but if
the distance is zero, we cannot necessarily conclude that the objects
are identical. This is a situation which occurs quite frequently when

330
CHAPTER 3. TOPOLOGICAL SPACES
modeling an application, so it is sometimes more adequate to deal with
pseudometric rather than metric spaces.
Deﬁnition 3.5.1 A map d W X  X ! RC is called a pseudometric on
X iff these conditions hold:
identity: d.x; x/ D 0 for all x 2 X.
symmetry: d.x; y/ D d.y; x/ for all x; y 2 X,
triangle inequality: d.x; y/  d.x; ´/ C d.´; y/ for all x; y; ´ 2 X.
Then .X; d/ is called a pseudometric space. If, in addition, we have
d.x; y/ D 0 , x D y;
then d is called a metric on X; accordingly, .X; d/ is called a metric
space.
The nonnegative real number d.x; y/ is called the distance of the el-
ements x and y in a pseudometric space .X; d/. It is clear that one
wants point to have distance 0 to itself and that the distance between
two points is determined in a symmetric fashion. The triangle inequal-
ity is intuitively clear as well:
Before proceeding, let us have a look at some examples. Some of them
will be discussed later on in greater detail.
Example 3.5.2
1. Deﬁne for x; y 2 R the distance as jx yj, hence
as the absolute value of their difference. Then this deﬁnes a met-
ric. Deﬁne, similarly,
d.x; y/ WD
jx  yj
1 C jx  yj;
then d deﬁnes also a metric on R (the triangle inequality follows
from the observation that a  b , a=.1 C a/  b=.1 C b/ holds
for nonnegative numbers a and b).

3.5. PSEUDOMETRIC AND METRIC SPACES
331
2. Given x; y 2 Rn for n 2 N, then
d1.x; y/ WD max
1in jxi  yij;
d2.x; y/ WD
n
X
iD1
jxi  yij;
d3.x; y/ WD
v
u
u
t
n
X
iD1
.xi  yi/2
deﬁne all metrics an Rn. Metric d1 measures the maximal dis-
tance between the components, d2 gives the sum of the distances,
and d3 yields the Euclidean, i.e., the geometric, distance of the
given points. The crucial property to be established is in each case
the triangle inequality. It follows for d1 and d2 from the triangle
inequality for the absolute value and for d3 by direct computation.
3. Given a set X, deﬁne
d.x; y/ WD
(
0;
if x D y
1;
otherwise
Then .X; d/ is a metric space, d is called the discrete metric.
Different points are assigned the distance 1, while each point has
distance 0 to itself.
4. Let X be a set, D.X/ be the set of all bounded maps X ! R.
Deﬁne
d.f; g/ WD sup
x2X
jf .x/  g.x/j:
Then .D.X/; d/ is a metric space; the distance between functions
f and g is just their maximal difference.
5. Similarly, given a set X, take a set E  D.X/ of bounded real-
valued functions as a set of evaluations and determine the distance
of two points in terms of their evaluations:
e.x; y/ WD sup
f 2F
jf .x/  f .y/j:
So two points are similar if their evaluations on terms of all ele-
ments of F are close. This is a pseudometric on X. It is not a
metric if F does not separate points.

332
CHAPTER 3. TOPOLOGICAL SPACES
6. Denote by C.Œ0; 1/ the set of all continuous real-valued functions
Œ0; 1 ! R, and measure the distance between f; g 2 C.Œ0; 1/
through
d.f; g/ WD
sup
0x1
jf .x/  g.x/j:
Because a continuous function on a compact space is bounded,
d.f; g/ is always ﬁnite, and since for each x 2 Œ0; 1 the inequal-
ity jf .x/  g.x/j  jf .x/  h.x/j C jh.x/  g.x/j holds, the tri-
angle inequality is satisﬁed. Then .C.Œ0; 1/; d/ is a metric space,
because C.Œ0; 1/ separates points.
7. Deﬁne for the Borel sets B.Œ0; 1/ on the unit interval this dis-
tance:
d.A; B/ WD .AB/
with  as Lebesgue measure.
Then .AB/ D ..AC/
.CB/  .AC/C.CB/ implies the triangle inequality, so
that .B.Œ0; 1/; d/ is a pseudometric space. It is no metric space,
however, because .Q \ Œ0; 1/ D 0; hence d.;; Q \ Œ0; 1/ D 0,
but the latter set is not empty.
8. Given a nonempty set X and a ranking function r W X ! N,
deﬁne the closeness c.A; B/ of two subset A; B of X as
c.A; B/ WD
(
C1;
if A D B;
inf fr.w/ j w 2 ABg;
otherwise
If w 2 AB, then w can be interpreted as a witness that A and
B are different, and the closeness of A and B is just the minimal
rank of a witness. We observe these properties:
 c.A; A/ D C1, and c.A; B/ D C1 iff A D B (because
A D B iff AB D ;).
 c.A; B/ D c.B; A/,
 c.A; C/  min fc.A; B/; c.B; C/g.
If A D C, this is
obvious; assume otherwise that b 2 AC is a witness of
minimal rank. Since AC D .AB/.BC/, b must
be either in AB or BC, so that r.b/  c.A; C/ or
r.b/  c.B; C/.
Now put d.A; B/ WD 2c.A;B/ (with 21 WD 0). Then d is a met-
ric on P .X/. This metric satisﬁes even d.A; B/  max fd.A; C/;

3.5. PSEUDOMETRIC AND METRIC SPACES
333
d.B; C/g for an arbitrary C, and hence d is an ultrametric; see
Exercise 3.18.
9. A similar construction is possible with a decreasing sequence of
equivalence relation on a set X. In fact, let .n/n2N be such a
sequence, and put 0 WD X  X. Deﬁne
c.x; y/ WD
(
C1;
if hx; yi 2 T
n2N n
max fn 2 N j hx; yi 2 ng;
otherwise
Then it is immediate that c.x; y/  min fc.x; ´/; c.´; y/g. In-
tuitively, c.x; y/ gives the degree of similarity of x and y—the
larger this value, the more similar x and y are. Then
d.x; y/ WD
(
0;
if c.x; y/ D 1
2c.x;y/;
otherwise
deﬁnes a pseudometric, which is a metric iff T
n2N n D fhx; xi j
x 2 Xg.
✌
Given a pseudometric space .X; d/, deﬁne for x 2 X and r > 0 the
open ball B.x; r/ with center x and radius r as
B.x; r/
B.x; r/ WD fy 2 X j d.x; y/ < rg:
The closed ball S.x; r/ is deﬁned similarly as
S.x; r/ WD fy 2 X j d.x; y/  rg:
If necessary, we indicate the pseudometric explicitly with B and S. Note
that B.x; r/ is open, and S.x; r/ is closed, but that the closure B.x; r/a
of B.x; r/ may be properly contained in the closed ball S.x; r/ (let d be
the discrete metric, then B.x; 1/ D fxg D B.x; 1/a, but S.x; 1/ D X,
so both closed sets do not coincide if X has more than one point).
Call G  X open iff we can ﬁnd for each x 2 G some r > 0 such that
B.x; r/  G. Then this deﬁnes the pseudometric topology on X. It has Pseudometric
topology
the set ˇ WD fB.x; r/ j x 2 X; r > 0g of open balls as a basis. Let us
have a look at the properties a base is supposed to have. Assume that
x 2 B.x1; r1/\B.x2; r2/, and select r with 0 < r < minfr1d.x; x1/;

334
CHAPTER 3. TOPOLOGICAL SPACES
r2 d.x; x2/g. Then B.x; r/  B.x1; r1/\B.x2; r2/, because we have
for ´ 2 B.x; r/
d.´; x1/

d.´; x/ C .x; x1/ < r C d.x; x1/  .r1  d.x; x1//
Cd.x; x1/ D r1;
(3.1)
by the triangle inequality; similarly, d.x; x2/ < r2. Thus it follows from
Proposition 3.1.1 that ˇ is in fact a base.
Call two pseudometrics on X equivalent iff they generate the same
topology. An equivalent formulation goes like this. Let i be the topolo-
gies generated from pseudometrics di for i D 1; 2, then d1 and d2
are equivalent iff the identity .X; 1/ ! .X; 2/ is a homeomorphism.
These are two common methods to construct equivalent pseudomet-
rics.
Lemma 3.5.3 Let .X; d/ be a pseudometric space. Then
d1.x; y/ WD maxfd.x; y/; 1g;
d2.x; y/ WD
d.x; y/
1 C d.x; y/
both deﬁne pseudometrics which are equivalent to d.
Proof It is clear that both d1 and d2 are pseudometrics (for d2, compare
Example 3.5.2). Let ; 1; 2 be the respective topologies; then it is
immediate that .X; / and .X; 1/ are homeomorphic. Since d2.x; y/ <
r iff d.x; y/ < r=.1r/, provided 0 < r < 1, we obtain also that .X; /
and .X; 2/ are homeomorphic. a
These pseudometrics have the advantage that they are bounded, which
is sometimes quite practical for establishing topological properties. Just
as a point in case:
Proposition 3.5.4 Let .Xn; dn/ be a pseudometric space with associ-
ated topology n. Then the topological product Q
n2N.Xn; n/ is a pseu-
dometric space again.
Proof 1. We may assume that each dn is bounded by 1; otherwise,
we select an equivalent pseudometric with this property (Lemma 3.5.3).
Put
d

.xn/n2N; .yn/n2N

WD
X
n2N
2n  dn.xn; yn/:

3.5. PSEUDOMETRIC AND METRIC SPACES
335
We claim that the product topology is the topology induced by the pseu-
dometric d (it is obvious that d is one).
2. Let Gi  Xi open for 1  i  k, and assume that x 2 G WD
G1: : :GkQ
n>k Xn. We can ﬁnd for xi 2 Gi some positive ri with
Bdi.xi; ri/  Gi. Put r WD minfr1; : : : ; rkg; then certainly, Bd.x; r/ 
G. This implies that each element of the base for the product topology
is open with respect to d.
3. Given the sequence x and r > 0, take y 2 Bd.x; r/. Put t WD
r  d.x; y/ > 0. Select m 2 N with P
n>m 2n < t=2, and let Gn WD
Bdn.yn; t=2/ for n  m. If ´ 2 U WD G1  : : :  Gn  Q
k>m Xk,
then
d.x; ´/  d.x; y/ C d.y; ´/
 r  t C
m
X
nD1
2ndn.yn; ´n/ C
X
n>m
2n
< r  t C t=2 C t=2
D r;
so that U  Bd.x; r/. Thus each open ball is open in the product
topology. a
One sees immediately that the pseudometric d constructed above is a
metric, provided each dn is one. Thus:
Corollary 3.5.5 The countable product of metric spaces is a metric
space in the product topology. a
One expects that each pseudometric space can be made a metric space
by identifying those elements which cannot be separated by the pseudo-
metric. Let us try:
Proposition 3.5.6 Let .X; d/ be a pseudometric space, and deﬁne
x 
 y iff d.x; y/ D 0 for x; y 2 X. Then the factor space X=
 is
a metric space with metric D.Œx ; Œy/ WD d.x; y/.
Proof 1. It is clear that 
 is an equivalence relation, since x 
 y and
y 
 ´ imply d.x; ´/  d.x; y/ C d.y; ´/ D 0; hence x 
 ´ fol-
lows.
Because d.x; x0/
D
0 and d.y; y0/
D
0 imply d.x; y/
D
d.x0; y0/, D is well deﬁned, and it is clear that it has all the properties of

336
CHAPTER 3. TOPOLOGICAL SPACES
a
pseudometric.
D
is
also
a
metric,
since
D.Œx ; Œy/
D 0 is equivalent to d.x; y/ D 0, hence to x 
 y, and thus to Œx D
Œy.
2. The metric topology is the ﬁnal topology with respect to the fac-
tor map . To establish this, take a map f W X=
 ! Z with a
topological space Y . Assume that .f ı /1
G

is open for G  Y
open. If Œx 2 f 1
G

, we have x 2 .f ı /1
G

; thus there
exists r > 0 with Bd.x; r/  1


f 1
G

. But this means that
BD.Œx ; r/  f 1
U

, so that the latter set is open. Thus if f ı 
is continuous, f is. The converse is established in the same way. This
implies that the metric topology is ﬁnal with respect to the factor map
, cp. Proposition 3.1.15. a
We want to show that a pseudometric space satisﬁes the T4-axiom (hence
that a metric space is normal). So we take two disjoint closed sets and
need to produce two disjoint open sets, each of which containing one of
the closed sets. The following construction is helpful.
Lemma 3.5.7 Let .X; d/ be a pseudometric space. Deﬁne the distance
d.x; A/
of point x 2 X to ; 6D A  X through
d.x; A/ WD inf
y2A d.x; y/:
Then d.; A/ is continuous.
Proof Let x; ´ 2 X, and y 2 A, then d.x; y/  d.x; ´/Cd.´; y/. Now
take lower bounds on y, then d.x; A/  d.x; ´/ C d.´; A/. This yields
d.x; A/  d.´; A/  d.x; ´/. Interchanging the rˆoles of x and ´ yields
d.´; A/  d.x; A/  d.´; x/; thus jd.x; A/  d.´; A/j  d.x; ´/. This
implies continuity of d.; A/. a
Given a closed set A  X, we ﬁnd that A D fx 2 X j d.x; A/ D 0g;
we can say a bit more:
Corollary 3.5.8 Let X; A be as above, then Aa D fx 2 X j d.x; A/ D 0g.
Proof Since fx 2 X j d.x; A/ D 0g is closed, we infer that Aa is
contained in this set. If, in the other hand, x 62 Aa, we ﬁnd r > 0 such
that B.x; r/ \ A D ;; hence d.x; A/  r. Thus the other inclusion
holds as well. a
Armed with this observation, we can establish now

3.5. PSEUDOMETRIC AND METRIC SPACES
337
Proposition 3.5.9 A pseudometric space .X; d/ is a T4-space.
Proof Let F1 and F2 be disjoint closed subsets of X. Deﬁne
f .x/ WD
d.x; F1/
d.x; F1/ C d.x; F2/;
then Lemma 3.5.7 shows that f is continuous, and Corollary 3.5.8 indi-
cates that the denominator will not vanish, since F1 and F2 are disjoint.
It is immediate that F1 is contained in the open set fx j f .x/ < 1=2g,
that F2  fx j f .x/ > 1=2g, and that these open sets are disjoint.
a
Note that a pseudometric T1-space is already a metric space (Exer-
cise 3.15).
Deﬁne for r > 0 the r-neighborhood Ar of set A  X as
Ar
Ar WD fx 2 X j d.x; A/ < rg:
This of course makes sense only if d.x; A/ is ﬁnite. Using the trian-
gle inequality, one calculates .Ar/s  ArCs. This observation will be
helpful when we look at the next example.
Example 3.5.10 Let .X; d/ be a pseudometric space, and let
C.X/ WD fC  X j C is compact and not emptyg
be the set of all compact and not empty subsets of X. Deﬁne
ıH .C; D/ WD max fmax
x2C d.x; D/; max
x2D d.x; C/g
for C; D 2 C.X/. We claim that ıH is a pseudometric on C.X/, which
ıH
is a metric if d is a metric on X.
One notes ﬁrst that
ıH.C; D/ D inf fr > 0 j C  Dr; D  C rg:
This follows easily from C  Dr iff maxx2C d.x; D/ < r. Hence we
obtain that ıH.C; D/  r and ıH .D; E/  s together imply ıH.C; E/
 r C s, which implies the triangle inequality. The other laws for a
pseudometric are obvious. ıH is called the Hausdorff pseudometric.
Now assume that d is a metric, and assume ıH .C; D/ D 0. Thus C 
T
n2N D1=n and D  T
n2N C 1=n. Because C and D are closed, and d
is a metric, we obtain C D D from Corollary 3.5.8; thus ıH is a metric,
which is accordingly called the Hausdorff metric. ✌

338
CHAPTER 3. TOPOLOGICAL SPACES
Let us take a magnifying glass and have a look at what happens locally
in a point of a pseudometric space. Given U 2 U.x/, we ﬁnd an open
ball B.x; r/ which is contained in U ; hence we ﬁnd even a rational
number q with B.x; q/  B.x; r/. But this means that the open balls
with rational radii form a basis for the neighborhood ﬁlter of x. This is
sometimes also the case in more general topological spaces, so we deﬁne
this property and two of its cousins for general topological spaces, rather
than pseudometric ones.
Deﬁnition 3.5.11 A topological space:
1. satisﬁes the ﬁrst axiom of countability (and the space is called in
this case ﬁrst countable) iff the neighborhood ﬁlter of each point
has a countable base of open sets,
2. satisﬁes the second axiom of countability (the space is called in
this case second countable) iff the topology has a countable base,
3. is separable iff it has a countable dense subset.
The standard example for a separable topological space is of course R,
where the rational numbers Q form a countable dense subset.
This is a trivial consequence of the observation just made.
Proposition 3.5.12 A pseudometric space is ﬁrst countable. a
In a pseudometric space, separability and satisfying the second axiom
of countability coincide, as the following observation shows.
Proposition 3.5.13 A pseudometric space .X; d/ is second countable
iff it has a countable dense subset.
Proof 1. Let D be a countable dense subset, then
ˇ WD fB.x; r/ j x 2 D; 0 < r 2 Qg
is a countable base for the topology. For, given U  X open, there exists
d 2 D with d 2 U , hence we can ﬁnd a rational r > 0 with B.d; r/ 
U . On the other hand, one shows exactly as in the argumentation leading
to Eq. (3.1) on page 334 that ˇ is a base.
2. Assume that ˇ is a countable base for the topology; pick from each
B 2 ˇ an element xB. Then fxB j B 2 ˇg is dense: given an open
U , we ﬁnd B 2 ˇ with B  U ; hence xB 2 U . This argument does

3.5. PSEUDOMETRIC AND METRIC SPACES
339
not require X being a pseudometric space (but the axiom of choice).
a
We know from Exercise 3.8 that a point x in a topological space is in
the closure of a set A iff there exists a ﬁlter F with iA.F/ ! x with
iA as the injection A ! X. In a ﬁrst countable space, in particular in
a pseudometric space, we can work with sequences rather than ﬁlters,
which is sometimes more convenient.
Proposition 3.5.14 Let X be a ﬁrst countable topological space, A 
X. Then x 2 Aa iff there exists a sequence .xn/n2N in A with xn ! x.
Proof If there exists a sequence .xn/n2N which converges to x such that
xn 2 A for all n 2 N, then the corresponding ﬁlter converges to x, so it
remains to establish the converse statement.
Now let .Un/n2N be the basis of the neighborhood ﬁlter of x 2 Aa
and F be a ﬁlter with iA.F/ ! x. Put Vn WD U1 \ : : : \ Un, then
Vn \ A 2 iA.F/. The sequence .Vn/n2N decreases and forms a basis for
the neighborhood ﬁlter of x. Pick from each Vn an element xn 2 A, and
take a neighborhood U 2 U.x/. Since there exists n with Vn  U , we
infer that xm 2 U for all m  n, hence xn ! x. a
A second countable normal space X permits the following remarkable
construction. Let ˇ be a countable base for X, and deﬁne A WD fhU; V i j
U; V 2 ˇ; U a  V g. Then A is countable as well, and we can ﬁnd for
each pair hU; V i 2 A a continuous map f W X ! Œ0; 1 with f .x/ D 0
for all x 2 U and f .x/ D 1 for all x 2 X n V . This is a consequence
of Urysohn’s Lemma (Theorem 3.3.18). The collection F of all these
functions is countable, because A is countable. Now deﬁne the embed-
ding map
e W
(
X
! Œ0; 1F
x
7! .f .x//f 2F
We endow the space Œ0; 1F with the product topology, i.e., with the
initial topology with respect to all projections f W x 7! f .x/. Then
we observe these properties:
1. The map e is continuous. This is so because f ı e D f and
f is continuous; hence we may infer continuity from Proposi-
tion 3.1.15.
2. The map e is injective.
This follows from Urysohn’s Lemma

340
CHAPTER 3. TOPOLOGICAL SPACES
(Theorem 3.3.18), since two distinct points constitute two disjoint
closed sets.
3. If G  X is open, e

G

is open in e

X

. In fact, let e.x/ 2 e

G

.
We ﬁnd an open neighborhood H of e.x/ in Œ0; 1F such that
e

X

\ H  e

G

in the following way: from the construction,
we infer that we can ﬁnd a map f 2 F such that f .x/ D 0 and
f .y/ D 1 for all y 2 X n G, and hence f .x/ 62 f

X n G
a;
hence the set H WD fy 2 Œ0; 1F j yf 62 f

X n G

g is open in
Œ0; 1F, and H \ e

X

is contained in e

G

.
4. Œ0; 1F is a metric space by Corollary 3.5.5, because the unit in-
terval Œ0; 1 is a metric space and because F is countable.
Summarizing, X is homeomorphic to a subspace of Œ0; 1F. This is what
Urysohn’s Metrization Theorem says.
Proposition 3.5.15 A second countable normal topological space is
metrizable. a
The problem of metrization of topological spaces is nontrivial, as one
can see from Proposition 3.5.15. The reader who wants to learn more
about it may wish to consult Kelley’s textbook [Kel55, p. 124 f] or
Engelking’s treatise [Eng89, 4.5, 5.4].
3.5.1
Completeness
Fix in this section a pseudometric space .X; d/. A Cauchy sequence
.xn/n2N is deﬁned in X just as in R: Given  > 0, there exists an index
n 2 N such that d.xm; xm0/ <  holds for all m; m0  n.
Thus we have a Cauchy sequence, when we know that eventually the
members of the sequence will be arbitrarily close; a converging se-
quence is evidently a Cauchy sequence. But a sequence which con-
verges requires the knowledge of its limit; this is sometimes a problem
in applications. It would be helpful if we could conclude from the fact
that we have a Cauchy sequence that we may safely assume that there
exists a point to which it converges. Spaces for which this is always
guaranteed are called complete; they will be introduced next, and exam-
ples show that there are spaces which are not complete; note, however,
that we can complete each pseudometric space. This will be considered
in some detail later on.

3.5. PSEUDOMETRIC AND METRIC SPACES
341
Deﬁnition 3.5.16 The pseudometric space is said to be complete iff
each Cauchy sequence has a limit.
It is well known that the rational numbers are not complete, which is
usually shown by showing that
p
2 is not rational. Another instructive
example proposed by Bourbaki [Bou89, II.3.3] is the following:
Example 3.5.17 The rational numbers Q are not complete in the usual
metric. Take
xn WD
n
X
iD0
2i.iC1/=2:
Then .xn/n2N is a Cauchy sequence in Q: if m > n, then jxm 
xnj  2.nC3/=2 (this is shown easily through the well-known iden-
tity Pp
iD0 i D p .p C 1/=2). Now assume that the sequence converges
to a=b 2 Q; then we can ﬁnd an integer hn such that
ˇˇa
b 
hn
2n.nC1/=2
ˇˇ 
1
2n.nC3/=2 ;
yielding
ja  2n.nC1/=2  b  hnj  b
2n
for all n 2 N. The left-hand side of this inequality is a whole number,
and the right side is not, once n > n0 with n0 so large that b < 2n.
This means that the left-hand side must be zero, so that a=b D xn for
n > n0. This is a contradiction. ✌
We know that R is complete with the usual metric, and the rationals are
not. But there is a catch: if we change the metric, completeness may be
lost.
Example 3.5.18 The half open interval 0; 1 is not complete under the
usual metric d.x; y/ WD jx  yj. But take the metric
d 0.x; y/ WD
ˇˇ 1
x  1
y
ˇˇ
Because a < x < b iff 1=b < 1=x < 1=a holds for 0 < a  b  1, the
metrics d and d 0 are equivalent on 0; 1. Let .xn/n2N be a d 0-Cauchy
sequence, then .1=xn/n2N is a Cauchy sequence in .R; j  j/; hence it
converges, so that .xn/n2N is d 0-convergent in 0; 1.
The trick here is to make sure that a Cauchy sequence avoids the region
around the critical value 0. ✌

342
CHAPTER 3. TOPOLOGICAL SPACES
Thus we have to carefully stick to the given metric; changing the metric
entails checking completeness properties for the new metric.
Example 3.5.19 Endow the set C.Œ0; 1/ of continuous functions on the
unit interval with the metric d.f; g/ WD sup0x1 jf .x/  g.x/j; see
Example 3.5.2. We claim that this metric space is complete. In fact,
let .fn/n2N be a d-Cauchy sequence in C.Œ0; 1/. Because we have for
each x 2 Œ0; 1 the inequality jfn.x/  fm.x/j  d.fn; fm/; we con-
clude that

fn.x/

n2N is a Cauchy sequence for each x 2 Œ0; 1, which
converges to some f .x/, since R is complete. We have to show that f
is continuous and that d.f; fn/ ! 0.
Let  > 0 be given; then there exists n 2 N such that d.fm; fm0/ < =2
for m; m0  n; hence we have
jfm.x/  fm0.x0/j

jfm.x/  fm.x0/j C jfm.x0/  fm0.x0/j

jfm.x/  fm.x0/j C d.fm; fm0/:
Choose ı > 0 so that jx  x0j < ı implies jfm.x/  fm.x0/j < =2,
then jfm.x/  fm0.x0/j <  for m; m0  n. But this means jx  x0j < ı
implies jf .x/f .x0/j  . Hence f is continuous. Since

fx 2 Œ0; 1 j
jfn.x/  f .x/j  g

n2N constitutes an open cover of Œ0; 1, we ﬁnd a
ﬁnite cover given by n1; : : : ; nk; let n0 be the smallest of these numbers,
then d.f; fn/   for all n  n0, hence d.f; fn/ ! 0. ✌
The next example is suggested by an observation in [MPS86].
Example 3.5.20 Let r W X ! N be a ranking function, and denote the
(ultra-)metric on P .X/ constructed from it by d; see Example 3.5.2.
Then .P .X/ ; d/ is complete. In fact, let .An/n2N be a Cauchy se-
quence; thus we ﬁnd for each m 2 N an index n 2 N such that c.Ak; A`/
 m, whenever k; `  n. We claim that the sequence converges to
A WD
[
n2N
\
kn
Ak;
which is the set of all elements in X which are contained in all but a
ﬁnite number of sequence elements. Given m, ﬁx n as above; we show
that c.A; Ak/ > m, whenever k > n. Take an element x 2 AAk of
minimal rank:
 If x 2 A, then there exists ` such that x 2 At for all t  `, so take
t  max f`; ng; then x 2 AtAk, and hence c.A; Ak/ D r.x/ 
c.At; Ak/ > m.

3.5. PSEUDOMETRIC AND METRIC SPACES
343
 If, however, x 62 A, we conclude that x 62 At for inﬁnitely many
t, so x 62 At for some t > n. But since x 2 AAk, we con-
clude x 2 Ak; hence x 2 AkAt, and thus c.A; Ak/ D r.x/ 
c.Ak; At/ > m.
Hence An ! A in .P .X/ ; d/. ✌
The following observation is trivial but sometimes helpful.
Lemma 3.5.21 A closed subset of a complete pseudometric space is
complete. a
If we encounter a pseudometric space which is not complete, we may
complete it through the following construction. Before discussing it,
we need a simple auxiliary statement, which says that we can check
completeness already on a dense subset.
Lemma 3.5.22 Let D  X be dense.
Then the space is complete
iff each Cauchy sequence on D converges.
Proof If each Cauchy sequence from X converges, so does each such
sequence from D, so we have to establish the converse. Let .xn/n2N be
a Cauchy sequence on X. Given n 2 N, there exists for xn an element
yn 2 D such that d.xn; yn/ < 1=n. Because .xn/n2N is a Cauchy
sequence, .yn/n2N is one as well, which converges by assumption to
some x 2 X. The triangle inequality shows that .xn/n2N converges to
x as well. a
This helps in establishing that each pseudometric space can be em-
bedded into a complete pseudometric space.
The approach may be
described as Charlie Brown’s device—“If you can’t beat them, join
them.” So we take all Cauchy sequences as our space into which we
embed X, and—intuitively—we ﬂesh out from a Cauchy sequence of
these sequences the diagonal sequence, which then will be a Cauchy se-
quence as well and which will be a limit of the given one. This sounds
more complicated than it is, however, because fortunately Lemma 3.5.22
makes life easier, when it comes to establishing completeness. Here we
go.
Proposition 3.5.23 There
exists
a
complete
pseudometric
space
.X; d / into which .X; d/ may be embedded isometrically as a dense
subset.

344
CHAPTER 3. TOPOLOGICAL SPACES
Proof 0. This is the line of attack: We deﬁne X and d , show that
we can embed X isometrically into it as a dense subset, and then we
establish completeness with the help of Lemma 3.5.22.
Fairly direct
approach
1. Deﬁne
X WD f.xn/n2N j .xn/n2N is a d-Cauchy sequence in Xg;
and put
d 
.xn/n2N; .yn/n2N

WD lim
n!1 d.xn; yn/
Before proceeding, we should make sure that the limit in question exists.
In fact, given  > 0, there exists n 2 N such that d.xm0; xm/ < =2 and
d.ym0; ym/ < =2 for m; m0  n; thus, if m; m0  n, we obtain
d.xm; ym/

d.xm; xm0/ C d.xm0; ym0/ C d.ym0; ym/
<
d.xm0; ym0/ C I
interchanging the rˆoles of m and m0 yields
jd.xm; ym/  d.xm0; ym0/j < 
for m; m0  n. Hence .d.xn; yn//n2N is a Cauchy sequence in R, which
converges by completeness of R.
2. Given x 2 X, the sequence .x/n2N is a Cauchy sequence, so it
offers itself as the image of x; let e W X ! X be the corresponding
map, which is injective and which preserves the pseudometric. Hence
e is continuous. We show that e

X

is dense in X: take a Cauchy
sequence .xn/n2N and  > 0. Let n 2 N be selected for , and assume
m  n. Then
D..xn/n2N; e.xm// D lim
n!1 d.xn; xm/ < :
3. The crucial point is completeness. An appeal to Lemma 3.5.22 shows
that it is sufﬁcient to show that a Cauchy sequence in e

X

converges in
.X; d /, because e

X

is dense. But this is trivial. a
Having the completion X of a pseudometric space X at our disposal,
we might be tempted to extend a continuous map X ! Y to a continu-
ous map X ! Y , e.g., in the case that Y is complete. This is usually
not possible; for example, not every continuous function Q ! R has a
continuous extension. We will deal with this problem when discussing

3.5. PSEUDOMETRIC AND METRIC SPACES
345
uniform continuity below, but we will state and prove here a condition
which is sometimes helpful when one wants to extend a function not to
the whole completion but to a domain which is somewhat larger than
the given one. Deﬁne as in Sect. 1.7.2 the diameter diam.A/ of a set A
as
diam.A/
diam.A/ WD sup fd.x; y/ j x; y 2 Ag
(note that the diameter may be inﬁnite). It is easy to see that diam.A/ D
diam.Aa/ using Proposition 3.5.14. Now assume that f W A ! Y
is given, then we measure the discontinuity of f at point x through
the oscillation øf .x/ of f at x 2 Aa. This is deﬁned as the smallest
Oscillation
diameter of the image of an open neighborhood of x, formally,
øf .x/
øf .x/ WD inffdiam.f

A \ V

/ j x 2 V; V openg:
If f is continuous on A, we have øf .x/ D 0 for each element x of A.
In fact, let  > 0 be given; then there exists ı > 0 such that diam.f

A\
V

/ < , whenever V is a neighborhood of x of diameter less than ı.
Thus øf .x/ < ; since  > 0 was chosen to be arbitrary, the claim
follows.
Lemma 3.5.24 Let Y be a complete metric space and X a pseudomet-
ric space, then a continuous map f W A ! Y can be extended to a
continuous map f W G ! Y; where G WD fx 2 Aa j øf .x/ D 0g has
these properties:
Extension
1. A  G  Aa,
2. G can be written as the intersection of countably many open sets.
The basic idea for the proof is rather straightforward. Take an element
in the closure of A; then there exists a sequence in A converging to this
point. If the oscillation at that point is zero, the images of the sequence
Idea for the
proof
elements must form a Cauchy sequence, so we extend the map by form-
ing the limit of this sequence. Now we have to show that this map is
well deﬁned and continuous.
Proof 1. We may and do assume that the complete metric d for Y is
bounded by 1. Deﬁne G as above; then A  G  Aa, and G can be
written as the intersection of a sequence of open sets. In fact, represent
G as
G D
\
n2N
fx 2 Aa j øf .x/ < 1
ng;

346
CHAPTER 3. TOPOLOGICAL SPACES
so we have to show that fx 2 Aa j øf .x/ < qg is open in Aa for any
q > 0. But we have
fx 2 Aa j øf .x/ < qg D
[
fV \ Aa j diam.f

V \ A

/ < qg:
This is the union of sets open in Aa; hence, it is an open set itself.
2. Now take an element x 2 G  Aa. Then there exists a sequence
.xn/n2N of elements xn 2 A with xn ! x. Given  > 0, we ﬁnd a
neighborhood V of x with diam.f

A \ V

/ < , since the oscillation
of f at x is 0. Because xn ! x, we know that we can ﬁnd an index
n 2 N such that xm 2 V \ A for all m > n. This implies that the
sequence .f .xn//n2N is a Cauchy sequence in Y . It converges because
Y is complete. Put
f.x/ WD lim
n!1 f .xn/:
3. We have to show now that:
 f is well deﬁned.
 f extends f .
 f is continuous.
Assume that we can ﬁnd x 2 G such that .xn/n2N and .x0n/n2N are se-
quences in A with xn
!
x and x0
n
!
x, but limn!1 f .xn/
6D limn!1 f .x0
n/.
Thus we ﬁnd some  > 0 such that d.f .xn/;
f .x0
n//   inﬁnitely often. Then the oscillation of f at x is at least
 > 0, a contradiction. This implies that f is well deﬁned, and it im-
plies also that f extends f . Now let x 2 G. If  > 0 is given, we ﬁnd a
neighborhood V of x with diam.f

A \ V

/ < . Thus, if x0 2 G \ V ,
then d.f.x/; f.x0// < . Hence f is continuous. a
We will encounter later on sets which can be written as the countable
intersection of open sets. They are called Gı-sets. Rephrasing Lemma
Gı-set
3.5.24, f can be extended from A to a Gı-set containing A and con-
tained in Aa.
A characterization of complete spaces in terms of sequences of closed
sets with decreasing diameters is given below.

3.5. PSEUDOMETRIC AND METRIC SPACES
347
Proposition 3.5.25 These statements are equivalent:
1. X is complete.
2. For each decreasing sequence .An/n2N of nonempty closed sets
the diameter of which tends to zero, there exists x 2 X such that
T
n2N An D fxga.
In particular, if X is a metric space, then X is complete iff each de-
creasing sequence of nonempty closed sets the diameter of which tends
to zero has exactly one point in common.
Proof The assertion for the metric case follows immediately from the
general case, because fxga D fxg, and because there can be not more
than one element in the intersection.
1 ) 2: Let .An/n2N be a decreasing sequence of nonempty closed
sets with diam.An/ ! 0; then we have to show that T
n2N An D fxga
for some x 2 X. Pick from each An an element xn, then .xn/n2N is
a Cauchy sequence which converges to some x, since X is complete.
Because the intersection of closed sets is closed again, we conclude
T
n2N An D fxga.
2 ) 1: Take a Cauchy sequence .xn/n2N; then An WD fxm j m  nga
is a decreasing sequence of closed sets, the diameter of which tends to
zero. In fact, given  > 0, there exists n 2 N such that d.xm; xm0/ < 
for all m; m0  n, hence diam.An/ < , and it follows that this holds
also for all k  n. Then it is obvious that xn ! x whenever x 2
T
n2N An. a
We mention all too brieﬂy a property of complete spaces which renders
them most attractive, viz., Banach’s Fixed-Point Theorem.
Deﬁnition 3.5.26 Call f W X ! X a contraction iff there exists  with
0 <  < 1 such that d.f .x/; f .y//   d.x; y/ holds for all x; y 2 X.
This is the celebrated Banach Fixpoint Theorem.
Theorem 3.5.27 Let f W X ! X be a contraction with X complete.
Then there exists x 2 X with f .x/ D x. If f .y/ D y holds as well,
then d.x; y/ D 0. In particular, if X is a metric space, then there exists
a unique ﬁxed point for f .
Banach’s
Fixpoint
Theorem

348
CHAPTER 3. TOPOLOGICAL SPACES
The idea is just to start with an arbitrary element of X and to iterate f
on it. This yields a sequence of elements of X. Because the elements
become closer and closer, completeness kicks in and makes sure that
there exists a limit. This limit is independent of the starting point.
Proof Deﬁne the n-th iteration f n of f through f 1 WD f and f nC1 WD
f n ı f . Now let x0 be an arbitrary element of X, and deﬁne xn WD
f n.x0/. Then d.xn; xnCm/  n  d.x0; xm/, so that .xn/n2N is a
Cauchy sequence which converges to some x 2 X, and f .x/ D x.
If f .y/ D y, we have d.x; y/ D d.f .x/; f .y//    d.x; y/; thus
d.x; y/ D 0. This implies uniqueness of the ﬁxed point as well. a
Banach’s Fixed-Point Theorem has a wide range of applications, and it
is used for iteratively approximating the solution of equations, e.g., for
implicit functions. The following example permits a glance at Google’s
Google
page rank algorithm; it follows [Rou15] (the linear algebra behind it is
explored in, e.g., [LM05, Kee93]).
Example 3.5.28 Let S WD fhx1; : : : ; xni j xi  0; x1 C : : : C xn D 1g
be the set of all discrete probability distributions over n objects and
P W Rn ! Rn be a stochastic matrix; this means that P has nonnega-
tive entries and the rows all add up to 1. The set f1; : : : ; ng is usually
interpreted as the state space for some random experiment; entry pi;j
is then interpreted as the probability for the change of state i to state j .
We have in particular P W S ! S, so a probability distribution is trans-
formed into another probability distribution. We assume that P has an
eigenvector v1 2 S for the eigenvalue 1 and that the other eigenvalues
are in absolute value not greater than 1 (this is what the classic Perron–
Frobenius Theorem says; see [LM05, Kee93]); moreover, we assume
that we can ﬁnd a base fv1; : : : ; vng of eigenvectors, all of which may
be assumed to be in S; let i be the eigenvector for vi, then 1 D 1
and jij  1 for i  2. Such a matrix is called a regular transition ma-
trix; these matrices are investigated in the context of stability of ﬁnite
Markov transition chains.
Deﬁne for the distributions p D Pn
iD1 pi  vi and q D Pn
iD1 qi  vi
their distance through
d.p; q/ WD 1
2 
n
X
iD1
jpi  qij:

3.5. PSEUDOMETRIC AND METRIC SPACES
349
Because fv1; : : : ; vng are linearly independent, d is a metric. Because
this set forms a basis, hence is given through a bijective linear maps from
the base given by the unit vectors, and because the Euclidean metric is
complete, d is complete as well.
Now deﬁne f .x/ WD P  x; then this is a contraction S ! S:
d.P  x; P  y/
D
1
2 
n
X
iD1
jxi  P.vi/  yi  P.vi/j

1
2
n
X
iD1
ji  .xi  yi/j  1
2  d.x; y/:
Thus f has a ﬁxed point, which must be v1 by uniqueness.
Now assume that we have a (very little) Web universe with only ﬁve
pages. The links are given as in the diagram:
The transitions between pages are at random; the matrix below describes
such a random walk:
P WD
0
BBBB@
0
1
0
0
0
1
2
0
1
2
0
0
1
3
1
3
0
0
1
3
1
0
0
0
0
0
1
3
1
3
1
3
0
1
CCCCA
It says that we make a transition from state 2 to state 1 with p2;1 D 1
2,
also p2;3 D 1
2, the transition from state 2 to state 3. From state 1, one
goes with probability one to state 2, because p1;2 D 1. Iterating P quite
a few times will yield a solution which does not change much after 32
steps; one obtains
P 32 D
0
BBBB@
0:293
0:390
0:220
0:024
0:073
0:293
0:390
0:220
0:024
0:073
0:293
0:390
0:220
0:024
0:073
0:293
0:390
0:220
0:024
0:073
0:293
0:390
0:220
0:024
0:073
1
CCCCA

350
CHAPTER 3. TOPOLOGICAL SPACES
The eigenvector p for the eigenvalue 1 looks like this: p D h0:293;
0:390; 0:220; 0:024; 0:073i, so this yields a stationary distribution.
In terms of Web searches, the importance of the pages is ordered accord-
Web search
ing to this stationary distribution as 2; 1; 3; 5; 4; so this is the ranking one
would associate with these pages.
This is the basic idea behind Google’s page ranking algorithm.
Of
course, there are many practical considerations which have been elimi-
nated from this toy example. It may be that the matrix does not follow
the assumptions above, so that it has to me modiﬁed accordingly in a
preprocessing step. Size is a problem, of course, since handling the
extremely large matrices occurring in Web searches may become quite
intricate. ✌
Compact pseudometric spaces are complete. This will be a byproduct of
a more general characterization of compact spaces. We show ﬁrst that
compactness and sequential compactness are the same for these spaces.
This is sometimes helpful in those situations in which a sequence is
easier to handle than an open cover, or an ultraﬁlter.
Before discussing this, we introduce -nets as a cover of X through a
-net
ﬁnite family fB.x; / j x 2 Ag of open balls of radius . X may or may
not have an -net for any given  > 0. For example, R does not have an
-net for any  > 0, in contrast to Œ0; 1 or 0; 1.
Deﬁnition 3.5.29 The pseudometric space X is totally bounded iff there
exists for each  > 0 an -net for X. A subset of a pseudometric space
is totally bounded iff it is a totally bounded subspace.
Thus A  X is totally bounded iff Aa  X is totally bounded.
We see immediately
Lemma 3.5.30 A compact pseudometric space is totally bounded. a
Now we are in a position to establish this equivalence, which will help
characterize compact pseudometric spaces.
Proposition 3.5.31 The following properties are equivalent for the
pseudometric space X:
1. X is compact.
2. X is sequentially compact, i.e., each sequence has a convergent
subsequence.

3.5. PSEUDOMETRIC AND METRIC SPACES
351
Proof 1
)
2: Assume that the sequence .xn/n2N does not have a
convergent subsequence, and consider the set F WD fxn j n 2 Ng. This
set is closed, since, if yn ! y and yn 2 F for all n 2 N, then y 2 F ,
because the sequence .yn/n2N is eventually constant. F is also discrete,
since, if we could ﬁnd for some ´ 2 F for each n 2 N an element in F \
B.´; 1=n/ different from ´, we would have a convergent subsequence.
Hence F is a closed discrete subspace of X which contains inﬁnitely
many elements, which is impossible. This contradiction shows that each
sequence has a convergent subsequence.
2 ) 1: Before we enter into the second and harder part of the proof, we
Plan of
attack
have a look at its plan. Given an open cover for the sequential compact
space X, we have to construct a ﬁnite cover from it. If we succeed
in constructing for each  > 0 a ﬁnite net so that we can ﬁt each ball
into some element of the cover, we are done, because in this case we
may take just these elements of the cover, obtaining a ﬁnite cover. That
this construction is possible is shown in the ﬁrst part of the proof. We
construct under the assumption that it is not possible a sequence, which
has a converging subsequence, and the limit of this subsequence will be
used as kind of a ﬂyswatter.
The second part of the proof is then just a simple application of the net
so constructed.
Fix .Ui/i2I as a cover of X. We claim that we can ﬁnd for this cover
some  > 0 such that, whenever diam.A/ < , there exists i 2 I with
A  Ui. Assume that this is wrong; then we ﬁnd for each n 2 N
some An  X which is not contained in one single Ui. Pick from
each An an element xn; then .xn/n2N has a convergent subsequence,
say .yn/n2N, with yn ! y. There exists a member U of the cover with
y 2 U , and there exists r > 0 with B.y; r/  U . Now we catch the ﬂy.
Choose ` 2 N with 1=` < r=2, then ym 2 B.y; r=2/ for m  n0 for
some suitable chosen n0 2 N; hence, because .yn/n2N is a subsequence
of .xn/n2N, there are inﬁnitely many xk contained in B.y; r=2/. But
since diam.A`/ < 1=`, this implies A`  B.y; r/  U , which is a
contradiction.
Now select  > 0 as above for the cover .Ui/i2I, and let the ﬁnite set A
be the set of centers for an =2-net, say, A D fa1; : : : ; akg. Then we can
ﬁnd for each aj 2 A some member Uij of this cover with B.aj; =2/ 
Uij (note that diam.B.x; r/ < 2  r). This yields a ﬁnite cover fUij j
1  j  kg of X. a

352
CHAPTER 3. TOPOLOGICAL SPACES
This proof was conceptually a little complicated, since we had to make
the step from a sequence (with a converging subsequence) to a cover
(with the goal of ﬁnding a ﬁnite cover). Both are not immediately re-
lated. The missing link turned out to be measuring the size of a set
through its diameter and capturing limits through suitable sets.
Using the last equivalence, we are in a position to characterize compact
pseudometric spaces.
Theorem 3.5.32 A pseudometric space is compact iff it is totally
bounded and complete.
Proof 1. Let X be compact. We know already from Lemma 3.5.30
that a compact pseudometric space is totally bounded. Let .xn/n2N be a
Cauchy sequence; then we know that it has a converging subsequence,
which, being a Cauchy sequence, implies that it converges itself.
2. Assume that X is totally bounded and complete. In view of Propo-
sition 3.5.31 it is enough to show that X is sequentially compact. Let
.xn/n2N be a sequence in X. Since X is totally bounded, we ﬁnd a sub-
sequence .xn1/ which is entirely contained in an open ball of radius less
that 1. Then we may extract from this sequence a subsequence .xn2/
which is contained in an open ball of radius less than 1=2. Continu-
ing inductively, we ﬁnd a subsequence .xnkC1/ of .xnk/ the members
of which are completely contained in an open ball of radius less than
2.kC1/. Now deﬁne yn WD xnn; hence .yn/n2N is the diagonal se-
quence in this scheme.
We claim that .yn/n2N is a Cauchy sequence. In fact, let  > 0 be given;
then there exists n 2 N such that P
`>n 2` < =2. Then we have for
m > n
d.yn; ym/  2 
m
X
`Dn
2` < :
By completeness, yn ! y for some y 2 X. Hence we have found
a converging subsequence of the given sequence .xn/n2N, so that X is
sequentially compact. a
It might be noteworthy to observe the shift of emphasis between ﬁnding
Shift of
emphasis
a ﬁnite cover for a given cover and admitting an -net for each  > 0.
While we have to select a ﬁnite cover from an arbitrarily given cover be-
yond our control, we can construct in the case of a totally bounded space
for each  > 0 a cover of a certain size; hence we may be in a position to

3.5. PSEUDOMETRIC AND METRIC SPACES
353
inﬂuence the shape of this special cover. Consequently, the characteriza-
tion of compact spaces in Theorem 3.5.32 is very helpful and handy, but,
alas, it works only in the restricted calls of pseudometric spaces.
We apply this characterization to .C.X/; ıH/, the space of all nonempty
compact subsets of .X; d/ with the Hausdorff metric ıH; see Exam-
ple 3.5.10.
Proposition 3.5.33 .C.X/; ıH/ is complete, if X is a complete pseudo-
metric space.
Proof We ﬁx for the proof a Cauchy sequence .Cn/n2N of elements of
C.X/.
0. Let us pause a moment and discuss the approach to the proof ﬁrst. We
Plan
show in the ﬁrst step that .S
n2N Cn/a is compact by showing that it is
totally bounded and complete. Completeness is trivial, since the space
is complete, and we are dealing with a closed subset, so we focus on
showing that the set is totally bounded. Actually, it is sufﬁcient to show
that S
n2N Cn is totally bounded, because a set is totally bounded iff its
closure is.
Then compactness of .S
n2N Cn/a implies that C
WD
T
n2N
.S
kn Ck/a is compact as well; moreover, we will argue that C must
be nonempty. Then it is shown that Cn ! C in the Hausdorff met-
ric.
1. Let D WD S
n2N Cn, and let  > 0 be given. We will construct an
-net for D. Because .Cn/n2N is Cauchy, we ﬁnd for  an index ` so
that ıH .Cn; Cm/ < =2 for n; m  `. When n  ` is ﬁxed, this means
in particular that Cm  C =2
n
for all m  `, thus d.x; Cn/ < =2 for all
x 2 Cm and all m  `. We will use this observation in a moment.
Let fx1; : : : ; xtg be an =2-net for Sn
jD1 Cj ; we claim that this is an
-net for D. In fact, let x 2 D. If x 2 S`
jD1 Cj, then there exists some
k with d.x; xk/ < =2. If x 2 Cm for some m > n, x 2 C =2
n
, so that
we ﬁnd x0 2 Cn with d.x; x0/ < =2, and for x0, we ﬁnd k such that
d.xk; x0/ < =2. Hence we have d.x; x0
k/ < , so that we have shown
that fx1; : : : ; xtg is an -net for D. Thus Da is totally bounded, hence
compact.
2. From the ﬁrst part it follows that .S
kn Ck/a is compact for each
n 2 N. Since these sets form a decreasing sequence of nonempty closed

354
CHAPTER 3. TOPOLOGICAL SPACES
sets to the compact set given by n D 1, their intersection cannot be
empty; hence C WD T
n2N .S
kn Ck/a is compact and nonempty and
hence a member of C.X/.
We claim that ıH.Cn; C/ ! 0, as n ! 1. Let  > 0 be given; then we
ﬁnd ` 2 N such that ıH.Cm; Cn/  =2, whenever n; m  `. We show
that ıH.Cn; C/ <  for all n  `. Let n  `. The proof is subdivided
into showing that C  C 
n and Cn  C .
 Let us work on the ﬁrst inclusion. Because D WD .S
in Ci/a is
totally bounded, there exists a =2-net, say, fx1; : : : ; xtg, for D.
If x 2 C  D, then there exists j such that d.x; xj/ < =2, so
that we can ﬁnd y 2 Cn with d.y; xj / < =2. Consequently, we
ﬁnd for x 2 C some y 2 Cn with d.x; y/ < . Hence C  C 
n.
 Now for the second inclusion. Take x 2 Cn. Since ıH.Cm; Cn/ <
=2 for m  `, we have Cn  C =2
m ; hence ﬁnd xm 2 Cm with
d.x; xm/ < =2. The sequence .xk/km consists of members
of the compact set D, so it has a converging subsequence which
converges to some y 2 D. But it actually follows from the con-
struction that y 2 C, and d.x; y/  d.x; xm/ C d.xm; y/ < 
for m taken sufﬁciently large from the subsequence. This yields
x 2 C .
Taking these inclusions together, they imply ıH.Cn; C/ <  for n > `.
This shows that .C.X/; ıH/ is a complete pseudometric space, if .X; d/
is one. a
The topology induced by the Hausdorff metric can be deﬁned in a way
which permits a generalization to arbitrary topological spaces, where it
is called the Vietoris topology. It has been studied with respect to ﬁnding
continuous selections, e.g., by Michael [Mic51]; see also [JR02, CV77].
The reader is also referred to [Kur66, 33] and to [Eng89, p. 120] for a
study of topologies on subsets.
We will introduce uniform continuity now and discuss this concept
brieﬂy here. Uniform spaces will turn out to be the proper scenario for
the more extended discussion in Sect. 3.6.4. As a motivating example,
assume that the pseudometric d on X is bounded, take a subset A  X,
and look at the function x 7! d.x; A/. Since
jd.x; A/  d.y; A/j  d.x; y/;

3.5. PSEUDOMETRIC AND METRIC SPACES
355
we know that this map is continuous. This means that, given x 2 X,
there exists ı > 0 such that d.x; x0/ < ı implies jd.x; A/d.x0; A/j < .
We see from the inequality above that the choice of ı does only depend
on , but not on x. Compare this with the function x 7! 1=x on 0; 1.
This function is continuous as well, but the choice of ı depends on the
point x you are considering: whenever 0 < ı <   x2=.1 C   x/, we
may conclude that jx0  xj  ı implies j1=x0  1=xj  . In fact, we
may easily infer from the graph of the function that a uniform choice of
ı for a given  is not possible.
This leads to the deﬁnition of uniform continuity in a pseudometric
space: the choice of ı for a given  does not depend on a particular
point, but is rather, well, uniform.
Deﬁnition 3.5.34 The map f W X ! Y into the pseudometric space
.Y; d 0/ is called uniformly continuous iff given  > 0 there exists ı > 0
such that d 0.f .x/; f .x0// <  whenever d.x; x0/ < ı.
Doing a game of quantiﬁers, let us just point out the difference between
Continuity
vs. uniform
continuity
uniform continuity and continuity:
1. Continuity says
8
>
08x 2 X9ı > 08x0 2 X W d.x; x0/
<
ı ) d 0.f .x/; f .x0// < :
2. Uniform continuity says
8 > 09ı > 08x 2 X8x0 2 X W d.x; x0/
< ı ) d 0.f .x/; f .x0// < :
The formulation suggests that uniform continuity depends on the cho-
sen metric. In contrast to continuity, which is a property depending on
the topology of the underlying spaces, uniform continuity is a property
of the underlying uniform space, which will be discussed below. We
note that the composition of uniformly continuous maps is uniformly
continuous again.
A uniformly continuous map is continuous. The converse is not true,
however.
Example 3.5.35 Consider the map f W x 7! x2, which is certainly
continuous on R. Assume that f is uniformly continuous, and ﬁx  > 0,

356
CHAPTER 3. TOPOLOGICAL SPACES
then there exists ı > 0 such that jx  yj < ı always implies jx2 
y2j < . Thus we have for all x and for all r with 0 < r  ı that
jx2 .x Cr/2j D j2x r Cr2j <  after Binomi’s celebrated theorem.
But this would mean j2x Crj < =r for all x, which is not possible. In
general, a very similar argument shows that polynomials Pn
iD1 ai  xi
with n > 1 and an 6D 0 are not uniformly continuous. ✌
A continuous function on a compact pseudometric space, however, is
uniformly continuous. This is established through an argument con-
structing a cover of the space; compactness will then permit us to extract
a ﬁnite cover, from which we will infer uniform continuity.
Proposition 3.5.36 Let f W X ! Y be a continuous map from the
compact pseudometric space X to the pseudometric space .Y; d 0/. Then
f is uniformly continuous.
Proof Given  > 0, there exists for each x 2 X a positive ıx such that
f

B.x; ıx/

 Bd 0.f .x/; =3/. Since fB.x; ıx=3/ j x 2 Xg is an open
cover of X, and since X is compact, we ﬁnd x1; : : : ; xn 2 X such that
B.x1; ıx1=3/; : : : ; B.xn; ıxn=3/ cover X. Let ı be the smallest among
ıx1; : : : ; ıxn. If d.x; x0/ < ı=3, then there exist xi; xj with d.x; xi/ <
ı=3 and d.x0; xj / < ı=3, so that d.xi; xj /  d.xi; x/ C d.x; x0/ C
d.x0; xj / < ı; hence d 0.f .xi/; f .xj// < =3, and thus
d 0.f .x/; f .x0//

d 0.f .x/; f .xi// C d 0.f .xi/; f .xj//
Cd 0.f .xj/; f .x0// < 3  =3 D :
This establishes uniform continuity. a
One of the most attractive features of uniform continuity is that it per-
mits certain extensions—given a uniform continuous map f W D ! Y
with D  X dense and Y complete metric, we can extend f to a
uniformly continuous map F on the whole space. This extension is
Idea for a
proof
necessarily unique (see Lemma 3.3.20).
The basic idea is to deﬁne
F.x/ WD limn!1 f .xn/, whenever xn ! x is a sequence in D which
converges to x. This requires that the limit exists and that it is in this
case unique; hence it demands the range to be a metric space which is
complete.
Proposition 3.5.37 Let D  X be a dense subset, and assume that
f W D ! Y is uniformly continuous, where .Y; d 0/ is a complete metric
space. Then there exists a unique uniformly continuous map F W X !
Y which extends f .

3.5. PSEUDOMETRIC AND METRIC SPACES
357
Proof 0. We have already argued that an extension must be unique, if
it exists. So we have to construct it and to show that it is uniformly
continuous. We will generalize the argument from above referring to
a limit by considering the oscillation at each point. A glimpse at the
Outline—use
the
oscillation
proof of Lemma 3.5.24 shows indeed that we argue with a limit here
and are able to take into view the whole set of points which makes this
possible.
1. Let us have a look at the oscillation øf .x/ of f at a point x 2 X (see
page 345), and we may assume that x 62 D. We claim that øf .x/ D 0.
In fact, given  > 0, there exists ı > 0 such that d.x0; x00/ < ı im-
plies d 0.f .x0/; f .x00// < =3, whenever x0; x00 2 D. Thus, if y0; y00 2
f

D \ B.x; ı=2/

, we ﬁnd x0; x00 2 D with f .x0/ D y0; f .x00/ D
y00 and d.x0; x00/  d.x; x0/ C d.x00; x/ < ı; hence d 0.y0; y00/ D
d 0.f .x0/; f .y00// < . This means that diam.f

D \ B.x; ı=2/

/ <
.
2. Lemma 3.5.24 tells us that there exists a continuous extension F of
f to the set fx 2 X j øf .x/ D 0g D X. Hence it remains to show
that F is uniformly continuous. Given  > 0, we choose the same ı as
above, which did not depend on the choice of the points we were con-
sidering above. Let x1; x2 2 X with d.x1; x2/ < ı=2; then there exists
v1; v2 2 D such that d.x1; v1/ < ı=4 with d 0.F.x1/; f .v1//  =3
and d.x2; v2/ < ı=4 with d 0.F.x2/; f .v2//  =3. We see as above
that d.v1; v2/ < ı; thus d 0.f .v1/; f .v2// < =3, consequently,
d 0.F.x1; x2//

d 0.F.x1/; f .v1//
Cd 0.f .v1/; f .v2// C d 0.f .v2/; F.x2//
<
3  =3 D :
But this means that F is uniformly continuous. a
Looking at x 7! 1=x on 0; 1 shows that uniform continuity is indeed
necessary to obtain a continuous extension.
3.5.2
Baire’s Theorem and a Banach–Mazur Game
The technique of constructing a shrinking sequence of closed sets with
a diameter tending to zero used for establishing Proposition 3.5.25 is
helpful in establishing Baire’s Theorem 3.4.13 also for complete pseu-
dometric spaces; completeness then makes sure that the intersection is

358
CHAPTER 3. TOPOLOGICAL SPACES
not empty. The proof is essentially a blend of this idea with the proof
given above (p. 327). We will then give an interpretation of Baire’s The-
orem in terms of the game Angel vs. Demon introduced in Sect. 1.7. We
show that Demon has a winning strategy iff the space is the countable
union of nowhere dense sets (the space is then called to be of the ﬁrst
category). This is done for a subset of the real line but can be easily
generalized.
This is the version of Baire’s Theorem in a complete pseudometric space.
We mimic the proof of Theorem 3.4.13, having the diameter of a set at
our disposal.
Theorem 3.5.38 Let X be a complete pseudometric space, and then the
intersection of a sequence of dense open sets is dense again.
Baire’s
Theorem
Proof Let .Dn/n2N be a sequence of dense open sets. Fix a nonempty
open set G, then we have to show that G \ T
n2N Dn 6D ;. Now
D1 is dense and open; hence we ﬁnd an open set V1 and r > 0 such
that diam.V a
1 /  r and V a
1  D1 \ G. We select inductively in this
way a sequence of open sets .Vn/n2N with diam.V a
n / < r=n such that
V a
nC1  Dn \ Vn. This is possible since Dn is open and dense for each
n 2 N.
Hence we have in the complete space X a decreasing sequence V a
1 	
: : : V a
n
	 : : : of closed sets with diameters tending to 0.
Thus
T
n2N V a
n D T
n2N Vn is not empty by Proposition 3.5.25, which en-
tails G \ T
n2N Dn not being empty. a
Kelley [Kel55, p. 201] remarks that there is a slight incongruence with
this theorem, since the assumption of completeness is non-topological in
nature (hence a property which may get lost when switching to another
pseudometric; see Example 3.5.18), but we draw a topological conclu-
sion. He suggests that the assumption on space X should be reworded
to X being a topological space for which there exists a complete pseu-
dometric. But, alas, the formulation above is the usual one, because it is
pretty suggestive after all.
Deﬁnition 3.5.39 Call a set A  X nowhere dense iff Aoa D ;, i.e.,
the closure of the interior is empty, equivalently, iff the open set X n Aa
is dense. The space X is said to be of the ﬁrst category iff it can be
written as the countable union of nowhere dense sets.

3.5. PSEUDOMETRIC AND METRIC SPACES
359
Then Baire’s Theorem can be reworded that the countable union of
nowhere dense sets in a complete pseudometric space is nowhere dense.
Cantor’s ternary set constitutes an important example for a nowhere
dense set:
Example 3.5.40 Cantor’s ternary set C from Example 1.6.4 can be writ-
ten as
Cantor’s
ternary set
C D
˚ 1
X
iD1
ai3i j ai 2 f0; 2g for all i 2 N

:
This is seen as follows: Deﬁne Œa; b0 WD Œa C .b  a/=3 [ Œa C 2 
.b  a/=3 for an interval Œa; b, and .A1 [ : : :[ A`/0 WD A0
1 [ : : :[ A0
`;
then C D T
n2N Cn with the inductive deﬁnition C1 WD Œ0; 10 and
CnC1 WD C 0
n: It is shown easily by induction that
Cn D f
1
X
iD1
ai  3i j ai 2 f0; 2g for i  n and ai 2 f0; 1; 2g for i > ng:
The representation above implies that the interior of C is empty, so that
C is in fact nowhere dense in the unit interval. ✌
Cantor’s ternary set is a helpful device for investigating the structure
of complete metric spaces which have a countable dense subset, i.e., in
Polish spaces.
We will give now a game theoretic interpretation of spaces of the ﬁrst
category through a game which is attributed to Banach and Mazur, ty-
ing the existence of a winning strategy for Demon to spaces of the ﬁrst
category. For simplicity, we discuss it for a closed interval of the real
line. We do not assume that the game is determined; determinacy is
not necessary here (and its assumption would bring us into serious dif-
ﬁculties with the assumption of the validity of the axiom of choice; see
Sect. 1.7.1).
Let a subset S of a closed interval L0  R be given; this set is assigned
to Angel, and its adversary Demon is assigned its complement T WD
L0 n S. The game is played in this way:
Banach-
Mazur
game
 Angel chooses a closed interval L1  L0,
 Demon reacts with choosing a closed interval L2  L1,
 Angel chooses then—knowing the moves L0 and L1—a closed
interval L2  L1,

360
CHAPTER 3. TOPOLOGICAL SPACES
 and so on: Demon chooses the intervals with even numbers, and
Angel selects the intervals with the odd numbers, each interval
is closed and contained in the previous one; both Angel and De-
mon have complete information about the game’s history, when
making a move.
Angel wins iff T
n2N Ln \ S 6D ;; otherwise, Demon wins.
We focus on Demon’s behavior. Its strategy for the n-th move is mod-
eled as a map fn which is deﬁned on 2  n-tuples hL0; : : : ; L2n1i of
closed intervals with L0 	 L1 	 : : : 	 L2n1, taking a closed interval
L2n as a value with
L2n D fn.L0; : : : ; L2n1/  L2n1:
The sequence .fn/n2N will be a winning strategy for Demon iff T
n2N
Ln  T , when .Ln/n2N is chosen according to these rules.
The following theorem relates the existence of a winning strategy for
Demon with S being of ﬁrst category.
Theorem 3.5.41 There exists a strategy for Demon to win iff S is of the
ﬁrst category.
We divide the proof into two parts—we show ﬁrst that we can ﬁnd a
strategy for Demon, if S is of the ﬁrst category. The converse is techni-
cally somewhat more complicated, so we delay it and do the necessary
constructions ﬁrst.
Proof (First part) Assume that S is of the ﬁrst category, so that we can
write S D S
n2N Sn with Sn nowhere dense for each n 2 N. Angel
starts with a closed interval L1, and then Demon has to choose a closed
interval L2; the choice will be so that L2  L1 nS1. We have to be sure
that such a choice is possible; our assumption implies that L1 \ Sa
1 is
open and dense in L1; thus it contains an open interval. In the inductive
step, assume that Angel has chosen the closed interval L2n1 such that
L2n1  : : :  L2  L1  L0. Then Demon will select an interval
L2n  L2n1 n .S1 [ : : : [ Sn/. For the same reason as above, the
latter set contains an open interval. This constitutes Demon’s strategy,
and evidently T
n2N Ln \ S D ;, so Demon wins. a
The proof for the second part requires some technical constructions. We
assume that fn assigns to each 2  n-tuple of closed intervals I1 	 I2 	

3.5. PSEUDOMETRIC AND METRIC SPACES
361
: : : 	 I2n a closed interval fn.I1; : : : ; I2n/  I2n, but do not make
any further assumptions, for the time being, that is. We are given a
closed interval L0 and a subset S  L0.
In the ﬁrst step, we deﬁne a sequence .Jn/n2N of closed intervals with
these properties:
 Jn  L0 for all n 2 N,
 Kn WD f1.L0; Jn/ deﬁnes a sequence .Kn/n2N of mutually dis-
joint closed intervals,
 S
n2N Ko
n is dense in L0.
Let us see how to do this. Deﬁne F as the sequence of all closed in-
tervals with rational endpoints that are contained in Lo
0. Take J1 as
the ﬁrst element of F. Put K1 WD f1.L0; J1/; then K1 is a closed
interval with K1  J1 by assumption on f1. Let J2 be the ﬁrst ele-
ment in F which is contained in L0 n K1, and put K2 WD f1.L0; J2/.
Inductively, select JiC1 as the ﬁrst element of F which is contained
in L0 n Si
tD1 Kt, and set KiC1 WD f1.L0; JiC1/. It is clear from
the construction that .Kn/n2N forms a sequence of mutually disjoint
closed intervals with Kn  Jn  L0 for each n 2 N. Assume that
S
n2N Ko
n is not dense in L0, then we ﬁnd x 2 L0 which is not con-
tained in this union; hence we ﬁnd an interval T with rational end-
points which contains x but T \ S
n2N Ko
n D ;. So T occurs some-
where in F, but it is never the ﬁrst interval to be considered in the
selection process. Since this is impossible, we arrive at a contradic-
tion.
We repeat this process for Ko
i rather than L0 for some i; hence we will
deﬁne a sequence .Ji;n/n2N of closed intervals Ji;n with these proper-
ties:
 Ji;n  Ko
i for all n 2 N,
 Ki;n WD f2.L0; Ji; Ki; Ji;n/ deﬁnes a sequence .Ki;n/n2N of
mutually disjoint closed intervals,
 S
n2N Ko
i;n is dense in Ki.
It is immediate that S
i;j Ko
i;j is dense in L0.

362
CHAPTER 3. TOPOLOGICAL SPACES
Continuing inductively, we ﬁnd for each ` 2 N two families Ji1;:::;i` and
Ki1;:::;i` of closed intervals with these properties:
 Ki1;:::;i` D f`.L0; Ji1; Ki1; Ji1;i2; Ki1;i2; : : : ; Ji1;:::;i`/,
 Ji1;:::;i`C1  Ko
i1;:::;i`,
 the intervals .Ki1;:::;i`1;i`/i`2N are mutually disjoint for each
i1; : : : ; i`1,
 SfKo
i1;:::;i`1;i` j hi1; : : : ; i`1; i`i 2 N`g is dense in L0.
Note that this sequence depends on the chosen sequence .fn/n2N of
Relax NOW! functions that represents the strategy for Demon.
Proof (Second part) Now assume that Demon has a winning strategy
.fn/n2N; hence no matter how Angel plays, Demon will win. For prov-
ing the assertion, we have to construct a sequence of nowhere dense
subsets, the union of which is S. In the ﬁrst move, Angel chooses a
closed interval L1 WD Ji1  L0 (we refer here to the enumeration given
by F above, so the interval chosen by Angel has index i1). Demon’s
countermove is then
L2 WD Ki1 WD f1.L0; L1/ D f1.L0; Ji1/;
as constructed above. In the next step, Angel selects L3 WD Ji1;i2 among
those closed intervals which are eligible, i.e., which are contained in Ko
i1
and have rational endpoints; Demon’s countermove is
L4 WD Ki1;i2 WD f2.L0; L1; L2; L3/ D f2.L0; Ji1; Ki1; Ji1;i2/:
In the n-th step, Angel selects L2n1 WD J11;:::;in and Demon selects
L2n WD Ki1;:::;in. Then we see that the sequence L0 	 L1 : : : 	
L2n1 	 L2n : : : decreases and L2n D fn.L0; L1; : : : ; L2n1/ holds,
as required.
Put T WD S n L0 for convenience, then T
n2N Ln  T by assumption
(after all, we assume that Demon wins); put
Gn WD
[
hi1;:::;ini2Nn
Ko
i1;:::;in:

3.6. A GALLERY OF SPACES AND TECHNIQUES
363
Then Gn is open. Let E WD T
n2N Gn. Given x 2 E, there exists a
unique sequence .in/n2N such that x 2 Ki1;:::;in for each n 2 N. Hence
x 2 T
n2N Ln  T , so that E  T . But then we can write
S D L0 n T  L0 n T D
[
n2N
.L0 n Gn/:
Because SfKo
i1;:::;in1;in j hi1; : : : ; in1; ini 2 Nng is dense in L0 for
each n 2 N by construction, we conclude that L0nGn is nowhere dense,
so S is of the ﬁrst category. a
Games are an interesting tool for proofs, as we can see in this exam-
ple; we have shown already that games may be used for other purposes,
e.g., demonstrating the each subset of Œ0; 1 is Lebesgue measurable un-
der the axiom of determinacy; see Sect. 1.7.2. Further examples for
using games to derive properties in a metric space can be found, e.g., in
Kechris’ book [Kec94].
3.6
A Gallery of Spaces and Techniques
The discussion of the basic properties and techniques suggests that we
now have a powerful collection of methods at our disposal. Indeed,
we set up a small gallery of showcases, in which we demonstrate some
approaches and methods.
We ﬁrst look at the use of topologies in logics from two different angles.
The more conventional one is a direct application of the important Baire
Theorem, which permits the construction of a model in a countable lan-
guage of ﬁrst-order logic. Here the application of the theorem lies at the
heart of the application, which is a proof of G¨odel’s Completeness The-
orem. The other vantage point starts from a calculus of observations and
develops the concept of topological systems from it, stressing an order
theoretic point of view by perceiving topologies as complete Heyting al-
gebras, when considering them as partially ordered subset of the power
set of their carrier. Since partial orders may generate topologies on the
set they are based on, this yields an interesting interplay between order
and topology, which is reﬂected here in the Hofmann–Mislove Theo-
rem.
Then we return to the green pastures of classic applications and give
a proof of the Stone–Weierstraß Theorem, one of the true classics. It

364
CHAPTER 3. TOPOLOGICAL SPACES
states that a subring of the space of continuous functions on a com-
pact Hausdorff space, which contains the constants and which separates
points, is dense in the topology of uniform convergence. We actually
give two proofs for this. One is based on a covering argument in a gen-
eral space; it has a wide range of applications, of course. The second
proof is no less interesting. It is essentially based on Weierstraß’ orig-
inal proof and deals with polynomials over Œ0; 1 only; here concepts
like elementary integration and uniform continuity are applied in a very
concise and beautiful way.
Finally, we deal with uniform spaces; they are a generalization of pseu-
dometric spaces, but more speciﬁc than topological spaces. We argue
that the central concept is closeness of points, which is, however, for-
mulated in conceptual rather than quantitative terms. It is shown that
many concepts which appear speciﬁc to the metric approach like uni-
form continuity or completeness may be carried into this context. Nev-
ertheless, uniform spaces are topological spaces, but the assumption on
having a uniformity available has some consequences for the associated
topology.
The reader probably misses Polish spaces in this little gallery. We deal
with these spaces in depth, but since most of our applications of them are
measure theoretic in nature, I decided to discuss them in the context of a
discussion of measures as a kind of natural habitat; see Chap. 4.
3.6.1
G¨odel’s Completeness Theorem
G¨odel’s Completeness Theorem states that a set of sentences of ﬁrst-
order logic is consistent iff it has a model.
The crucial part is the
construction of a model for a consistent set of sentences. This is usu-
ally done through Henkin’s approach; see, e.g., [Sho67, 4.2], [CK90,
Chap. 2] or [Sri08, 5.1]. Rasiowa and Sikorski [RS50] followed a com-
pletely different path in their topological proof by making use of Baire’s
Category Theorem and using the observation that in a compact topolog-
ical space, the intersection of a sequence of open and dense sets is dense
again. The compact space is provided by the clopen sets of a Boolean
algebra which in turn is constructed from the formulas of the ﬁrst-order
language upon factoring. The equivalence relation is induced by the
consistent set under consideration.

3.6. A GALLERY OF SPACES AND TECHNIQUES
365
We present the fundamental ideas of their proof in this section, since it
is an unexpected application of a combination of the topological version
of Stone’s Representation Theorem for Boolean algebras and Baire’s
Theorem, hinted at already in Example 3.4.15. Since we assume that
the reader is familiar with the semantics of ﬁrst-order languages, we
do not want to motivate every deﬁnition for this area in detail, but we
sketch the deﬁnitions, indicate the deduction rules, say what a model is,
and rather focus on the construction of the model. The references given
above may be used to ﬁll in any gaps.
A slightly informal description of the ﬁrst-order language L with iden-
tity which we will be working with is given ﬁrst. For this, we assume
that we have a countable set fxn j n 2 Ng of variables and countably
many constants. Moreover, we assume countably many function sym-
bols and countably many predicate symbols. In particular, we have a
binary relation DD, the identity. Each function and each predicate sym-
bol have a positive arity.
These are the components of our language L.
Terms. A variable is a term and a constant symbol is a term. If f
is a function symbol of arity n, and t1; : : : ; tn are terms, then
f .t1; : : : ; tn/ is a term. Nothing else is a term.
Atomic Formulas. If t1 and t2 are terms, then t1 DD t2 is an atomic
formula. If p is a predicate symbol of arity n, and t1; : : : ; tn are
terms, then p.t1; : : : ; tn/ is an atomic formula.
Formulas. An atomic formula is a formula. If ' and  are formulas,
then ' ^  and :' are formulas. If x is a variable and ' is a
formula, then 8x:' is a formula. Nothing else is a formula.
Because there are countably many variables resp. constants, the lan-
guage has countably many formulas.
One usually adds parentheses to the logical symbols, but we do without,
using them, however, freely, when necessary. We will use also disjunc-
tion ['_ abbreviates :.:'^: /], implication [' !  for :'_ ],
logical equivalence [' $  for .' !  / ^ . ! '/], and existential
quantiﬁcation [9x:' for :.8x::'/]. Conjunction and disjunction are
associative.
We need logical axioms and inference rules as well.
We have four
groups of axioms:

366
CHAPTER 3. TOPOLOGICAL SPACES
Propositional Axioms. Each propositional tautology is an axiom.
Identity Axioms. x DD x, when x is a variable.
Equality Axioms. y1 DD ´1 ! : : : ! yn DD ´n ! f .y1; : : : ; yn/
DD f .´1; : : : ; ´n/, whenever f is a function symbol of arity n,
and y1 DD ´1 ! : : : ! yn DD ´n ! p.y1; : : : ; yn/ !
p.´1; : : : ; ´n/ for a predicate symbol of arity n.
Substitution Axiom. If ' is a formula, 'xŒt is obtained from ' by
freely substituting all free occurrences of variable x by term t;
then 'xŒt ! 9x:' is an axiom.
These are the inference rules:
Modus Ponens. From ' and ' !  , infer  .
Generalization Rule. From ', infer 8x:'.
A sentence is a formula without free variables. Let ˙ be a set of sen-
tences and ' a formula; then we denote that ' is deducible from ˙ by
˙ ` ', i.e., iff there is a proof for ' in ˙. ˙ is called inconsistent iff
˙ ` '
˙ ` ? or, equivalently, iff each formula can be deduced from ˙. If ˙
is not inconsistent, then ˙ is called consistent or a theory.
Fix a theory T , and deﬁne
' 
  iff T ` ' $  
for formulas ' and  ; then this deﬁnes an equivalence relation on the
set of all formulas. Let BT be the set of all equivalence classes Œ', and
BT
deﬁne
Œ' ^ Œ  WD Œ' ^  
Œ' _ Œ  WD Œ' _  
Œ' WD Œ:':
This deﬁnes a Boolean algebra structure on BT , the Lindenbaum al-
gebra of T . The maximal element > of BT is f' j T ` 'g, and its
Lindenbaum
algebra
minimal element ? is f' j T ` :'g. The proof that BT is a Boolean al-
gebra follows the lines of Lemma 1.5.40 closely; hence it can be safely
omitted. It might be noted, however, that the individual steps in the
proof require additional properties of `; for example, one has to show
that T ` ' and T `  together imply T ` ' ^  . We trust that the

3.6. A GALLERY OF SPACES AND TECHNIQUES
367
reader is in a position to recognize and accomplish this; [Sri08, Chap. 4]
provides a comprehensive catalog of useful derivation rules with their
proofs.
Let ' be a formula, then denote by '.k=p/ the formula obtained in this
way:
 all bound occurrences of xp are replaced by x`, where x` is the
ﬁrst variable among x1; x2; : : : which does not occur in ',
 all free occurrences of xk are replaced by xp.
This construction is dependent on the integer `, so the formula '.k=p/ is
not uniquely determined, but its class is. We have these representations
in the Lindenbaum algebra for existentially resp. universally quantiﬁed
formulas.
Lemma 3.6.1 Let ' be a formula in L, then we have for every k 2 N:
1. supp2NŒ'.k=p/ D Œ9xk:',
2. infp2NŒ'.k=p/ D Œ8xk:'.
Proof 1. Fix k 2 N, then we have T ` '.k=p/ ! 9xk:' for each
p 2 N by the 9 introduction rule. This implies Œ'.k=p/  Œ9xk:' for
all p 2 N; hence supp2NŒ'.k=p/  Œ9xk:', and thus Œ9xk:' is an
upper bound to fŒ'.k=p/ j p 2 Ng in the Lindenbaum algebra. We
have to show that it is also the least upper bound, so take a formula  
such that Œ'.k=p/  Œ  for all k 2 N. Let q be an index such that xq
does not occur free in  , then we conclude from T ` '.k=p/ !  for
all p that 9xq:'.k=q/ !  . But T ` 9xk:' $ 9xq:'.k=q/; hence
T ` 9xk:' !  . This means that Œ9xk:' is the least upper bound to
fŒ'.k=p/ j p 2 Ng, proving the ﬁrst equality.
2. The second equality is established in a very similar way. a
These representations motivate
Deﬁnition 3.6.2 Let F be an ultraﬁlter on the Lindenbaum algebra BT ,
S  BT .
1. F preserves the supremum of S iff sup S 2 F , s 2 F for some
s 2 S.
2. F preserves the inﬁmum of S iff inf S 2 F , s 2 F for all s 2 S.

368
CHAPTER 3. TOPOLOGICAL SPACES
Preserving the supremum of a set is similar to being inaccessible by
joins (see Deﬁnition 3.6.29), but inaccessibility refers to directed sets,
while we are not making any assumption on S, except, of course, that its
supremum exists in the Boolean algebra. Note also that one of the char-
acteristic properties of an ultraﬁlters is that the join of two elements is
in the ultraﬁlter iff it contains at least one of them. Preserving the supre-
mum of a set strengthens this property for this particular set only.
The de Morgan laws and F being an ultraﬁlter make it clear that F pre-
serves inf S iff it preserves supfs j s 2 Sg, resp. that F preserves
sup S iff it preserves inffs j s 2 Sg. This cuts our work in half.
Proposition 3.6.3 Let .Sn/n2N be a sequence of subsets Sn  BT such
that sup Sn exists in BT . Then there exists an ultraﬁlter F such that F
preserves the supremum of Sn for all n 2 N.
Proof This is an application of Baire’s Category Theorem 3.4.13 and is
discussed in Example 3.4.15. We ﬁnd there a prime ideal which does
not preserve the supremum for Sn for all n 2 N. Since the complement
of a prime ideal in a Boolean algebra is an ultraﬁlter, see Lemmas 1.5.36
and 1.5.37; the assertion follows. a
So much for the syntactic side of our language L. We will leave the
ultraﬁlter F alone for a little while and turn to the semantics of the
logic.
An interpretation of L is given by a carrier set A, each constant c is
interpreted through an element cA of A, each function symbol f with
arity n is assigned a map fA W An ! A, and each n-ary predicate p is
interpreted through an n-ary relation pA  An; ﬁnally, the binary pred-
icate DD is interpreted through equality on A. We also ﬁx a sequence
fwn j n 2 Ng of elements of A for the interpretation of variables, set
A WD .A; fwn j n 2 Ng/, and call A a model for the ﬁrst-order language.
We then proceed inductively:
Terms. Variable xi is interpreted by wi. Assume that the term f .t1; : : : ;
tn/ is given. If the terms t1; : : : ; tn are interpreted through the re-
spective elements tA;1; : : : ; tA;n of A, then f .t1; : : : ; tn/ is inter-
preted through fA.tA;1; : : : ; tA;n/.
Atomic Formulas. The atomic formula t1 DD t2 is interpreted through
tA;1 D tA;2. If the n-ary predicate p is assigned pA  An, then
p.t1; : : : ; tn/ is interpreted as htA;1; : : : ; tA;ni 2 pA.
A ˆ '

3.6. A GALLERY OF SPACES AND TECHNIQUES
369
We denote by A ˆ ' that the interpretation of the atomic formula
' yields the value true. We say that ' holds in A.
Formulas. Let ' and  be formulas, then A ˆ ' ^  iff A ˆ ' and
A ˆ  , and A ˆ :' iff A ˆ ' is false. Let ' be the formula
8xi: , then A ˆ ' iff A ˆ  xija for every a 2 A, where
 xja is the formula  with each free occurrence of x replaced
by a.
Construct the ultraﬁlter F constructed in Proposition 3.6.3 for all possi-
ble suprema arising from existentially quantiﬁed formulas according to
Lemma 3.6.1. There are countably many suprema, because the number
of formulas is countable. This ultraﬁlter and the Lindenbaum algebra
BT will be used now for the construction of a model A for T (so that
Model
A ˆ ' holds for all ' 2 T ).
We will ﬁrst need to deﬁne the carrier set A. Deﬁne for the variables xi
and xj the equivalence relation  through xi  xj iff Œxi DD xj  2 F;
denote by Oxi the -equivalence class of xi. The carrier set A is deﬁned
as f Oxn j n 2 Ng.
Let us take care of the constants now. Given a constant c, we know
that ` 9xi:c DD xi by substitution. Thus Œ9xi:c DD xi D > 2 F.
But Œ9xi:c DD xi D supi2NŒc DD xi, and F preserves suprema, so
we conclude that there exists i with Œc DD xi 2 F. We pick this i and
deﬁne cA WD Oxi. Note that it does not matter which i to choose. Assume
that there is more than one. Since Œc DD xi 2 F and Œc DD xj 2 F
imply Œc DD xi ^ c DD xj  2 F, we obtain Œxi DD xj  2 F, so the
class is well deﬁned.
Coming to terms, let t be a variable or a constant, so that it has an
interpretation already, and assume that f is a unary function. Then
` 9xi:f .t/ DD xi, so that Œ9xi:f .t/ DD xi 2 F; hence there ex-
ists i such that Œf .t/ DD xi 2 F, then put fA.tA/ WD Oxi. Again, if
Œf .t/ DD xi 2 F and Œf .t/ DD xj 2 F, then Œxi DD xj 2 F, so that
fA.cA/ is well deﬁned. The argument for the general case is very sim-
ilar. Assume that terms t1; : : : ; tn have their interpretations already and
f is a function with arity n; then ` 9xi:f .t1; : : : ; tn/ DD xi, and hence
we ﬁnd j with Œf .t1; : : : ; f .tn/ DD xj  2 F, so put fA.tA;1; : : : ; tA;n/
WD
Oxj .
The same argument as above shows that this is well
deﬁned.

370
CHAPTER 3. TOPOLOGICAL SPACES
Having deﬁned the interpretation tA for each term t, we deﬁne for the
n-ary relation symbol p the relation pA  An by
htA;1; : : : ; tA;ni 2 pA , Œp.t1; : : : ; tn 2 F
Then pA is well deﬁned by the equality axioms.
Thus A ˆ ' is deﬁned for each formula '; hence we know how to
interpret each formula in terms of the Lindenbaum algebra of T (and
the ultraﬁlter F). We can show now that a formula is valid in this model
iff its class is contained in ultraﬁlter F.
Proposition 3.6.4 A ˆ ' iff Œ' 2 F holds for each formula ' of L.
Proof The proof is done by induction on the structure of formula '
and is straightforward, using the properties of an ultraﬁlter. For exam-
ple,
A ˆ ' ^  , A ˆ ' and A ˆ  
(deﬁnition)
, Œ' 2 F and Œ  2 F
(induction hypothesis)
, Œ' ^   2 F
(F is an ultraﬁlter)
For establishing the equivalence for universally quantiﬁed formulas
8xi: , assume that xi is a free variable in  such that A ˆ  xija ,
Œ xija 2 F has been established for all a 2 A. Then
A ˆ 8xi: , A ˆ  xija for all a 2 A
(deﬁnition)
, Œ xija 2 F for all a 2 A
(induction hypothesis)
, sup
a2A
Œ xija 2 F
(F preserves the inﬁmum)
, Œ8xi:  2 F
(by Lemma 3.6.1)
This completes the proof. a
As a consequence, we have established this version of G¨odel’s Com-
pleteness Theorem:
Corollary 3.6.5 A is a model for the consistent set T of formulas. a
This approach demonstrates how a topological argument is used at the
center of a construction in logic. It should be noted, however, that the
argument is only effective since the universe in which we work is count-
able. This is so because the Baire Theorem, which enables the con-
struction of the ultraﬁlter, works for a countable family of open and

3.6. A GALLERY OF SPACES AND TECHNIQUES
371
dense sets. If, however, we work in an uncountable language L, this
instrument is no longer available ([CK90, Exercise 2.1.24] points to a
possible generalization).
But even in the countable case, one cannot help but note that the con-
struction above depends on the axiom of choice, because we require an
ultraﬁlter. The approach in [CK90, Exercise 2.1.22] resp. [Kop89, The-
orem 2.21] suggests to construct a ﬁlter without the help of a topology,
but, alas, this ﬁlter is extended to an ultraﬁlter, and here the dreaded
axiom is needed again.
3.6.2
Topological Systems or Topology via Logic
This section investigates topological systems.
They abstract from
topologies being sets of subsets and concentrate on the order structure
imposed by a topology instead. We focus on the interplay between a
topology and the base space by considering these objects separately.
A topology is considered a complete Heyting algebra; the carrier set is,
well, a set of points; both are related through a validity relation ˆ which
mimics the 2 relation between a set and its elements. This leads to the
deﬁnition of a topological system, and the question is whether this sepa-
ration really bears fruits. It does; for example, we may replace the point
set by the morphisms from the Heyting algebra to the two element alge-
bras 22, giving sober spaces, and we show that, e.g., a Hausdorff space
is isomorphic to such a structure.
The interplay of the order structure of a topology and its topological
obligations will be investigated through the Scott topology on a dcpo, a
directed complete partial order, leading to the Hofmann–Mislove The-
orem which characterizes compact sets that are represented as the in-
tersection of the open sets containing them in terms of Scott open ﬁl-
ters.
Before we enter into a technical discussion, however, we put the follow-
ing deﬁnitions on record.
Deﬁnition 3.6.6 A partially ordered set P is called a complete Heyting
algebra iff:
1. each ﬁnite subset S has a join V S,
2. each subset S has a meet W S,

372
CHAPTER 3. TOPOLOGICAL SPACES
3. ﬁnite meets distribute over arbitrary joins, i.e.,
a ^
_
S D
_
fa ^ s j s 2 Sg
holds for a 2 L; S  L.
A morphism f between the complete Heyting algebras P and Q is a
map f W P ! Q such that:
1. f .V S/ D V f

S

holds for ﬁnite S  P ,
2. f .W S/ D W f

S

holds for arbitrary S  P .
kP; Qk denotes the set of all morphisms P ! Q.
kP; Qk
The deﬁnition of a complete Heyting algebra is a bit redundant, but
never mind. Because the join and the meet of the empty set is a mem-
ber of such an algebra, it contains a smallest element ? and a largest
element >, and f .?/ D ? and f .>/ D > follow. A topology is
a complete Heyting algebra with inclusion as the partial order, as an-
nounced already in Exercise 1.27. Sometimes, complete Heyting alge-
bras are called frames; but since the structure underlying the interpreta-
tion of modal logics are also called frames, we stick here to the longer
name.
Example 3.6.7 Call a lattice V pseudo-complemented iff given a; b 2
V , there exists c 2 V such that x  c iff x ^a  b; c is usually denoted
by a ! b. A complete Heyting algebra is pseudo-complemented. In
fact, let c WD Wfx 2 V j x ^ a  bg, then
c ^a D
_
fx 2 V j x ^a  bg^a D
_
fx ^a 2 V j x ^a  bg  b
by the general distributive law, hence x  c implies x ^ a  b. Con-
versely, if x ^ a  b, then x  c follows. ✌
Example 3.6.8 Assume that we have a complete lattice V which is
pseudo-complemented. Then the lattice satisﬁes the general distributive
law. In fact, given a 2 V and S  V , we have s^a  Wfa^b j b 2 Sg,
thus s  a ! Wfa ^ b j b 2 Sg for all s 2 S, from which we ob-
tain W S  a ^ Wfa ^ b j b 2 Sg, which in turn gives a ^ W S 
a^Wfa^b j b 2 Sg. On the other hand, Wfa^b j b 2 Sg  W S, and
Wfa ^ b j b 2 Sg  a, so that we obtain Wfa ^ b j b 2 Sg  a ^ W S.
✌

3.6. A GALLERY OF SPACES AND TECHNIQUES
373
We note:
Corollary 3.6.9 A complete Heyting algebra is a complete distributive
lattice. a
Quite apart from investigating what can be said if open sets are replaced
by an element of a complete Heyting algebra, and thus focussing on the
order structure, one can argue as follows. Suppose we have observers
and events, say, X is the set of observers, and A is the set of events.
The observers are not assumed to have any structure; the events have a
partial order making them a distributive lattice; an observation may be
incomplete, so a  b indicates that observing event b contains more
information than observing event a. If observer x 2 X observes event
a 2 A, we denote this as x ˆ a. The lattice structure should be compat-
ible with the observations, that is, we want to have for S  A that
x ˆ
^
S iff x ˆ a for all a 2 S; S ﬁnite;
x ˆ
_
S iff x ˆ a for some a 2 S; S arbitrary:
(recall V ; D > and W ; D ?). Thus our observations should be
closed under ﬁnite conjunctions and arbitrary disjunctions; replacing
disjunctions by intersections and conjunctions by unions, this shows a
somewhat topological face. We deﬁne accordingly:
Deﬁnition 3.6.10 A topological system .X[; X]; ˆ/ has a set X[ of
points, a complete Heyting algebra X] of observations, and a satis-
faction relation ˆ  X[  X] (written as x ˆ a for hx; ai 2 ˆ) such
that we have for all x 2 X]:
 If S  X] is ﬁnite, then x ˆ W S iff x ˆ a for all a 2 S.
 For S  X] arbitrary, x ˆ W S iff x ˆ a for some a 2 S.
The elements of X[ are called points, and the elements of X] are called
X[; X]
opens.
We will denote a topological system X D .X[; X]/ usually without
writing down the satisfaction relation, which is either explicitly deﬁned
or understood from the context.
Example 3.6.11
1. The obvious example for a topological system
D is a topological space .X; / with D[ WD X and D] WD ,
ordered through inclusion. The satisfaction relation ˆ is given by

374
CHAPTER 3. TOPOLOGICAL SPACES
the containment relation 2, so that we have x ˆ G iff x 2 G for
x 2 D[ and G 2 D].
2. But it works the other way around as well. Given a topological
system X, deﬁne for the open a 2 X] its extension
Extension
.j  j/
.jaj/ WD fx 2 X[ j x ˆ ag:
Then  WD f.jaj/ j a 2 X]g is a topology on X[. In fact, ; D .j?j/,
X[ D .j>j/, and if S   is ﬁnite, say, S D f.ja1j/; : : : ; .janj/g,
then T S D .j Vn
iD1 aij/. Similarly, if S D f.jaij/ j i 2 Ig  
is an arbitrary subset of , then S S D .j W
i2I aij/. This follows
directly from the laws of a topological system.
3. Put 22 WD f?; >g; then this is a complete Heyting algebra. Let
22
X] WD A be another complete Heyting algebra, and put X[ WD
kX]; 22k deﬁning x ˆ a iff x.a/ D > then yields a topolog-
ical system. Thus a point in this topological system is a mor-
phism X] ! 22, and a point satisﬁes the open a iff it assigns > to
it.
✌
Next, we want to deﬁne morphisms between topological systems. Be-
fore we do that, we have another look at topological spaces and con-
tinuous maps. Recall that a map f W X ! Y between topological
spaces .X; / and .Y; #/ is -#-continuous iff f 1
H

2  for all
H 2 #.
Thus f spawns a map f 1 W # ! —note the oppo-
site direction. We have x 2 f 1
H

iff f .x/ 2 H, accounting for
containment.
This leads to the deﬁnition of a morphism as a pair of maps, one work-
ing in the opposite direction of the other one, such that the satisfaction
relation is maintained, formally:
Deﬁnition 3.6.12 Let X and Y be topological systems. Then f W X !
Y is a c-morphism iff:
1. f is a pair of maps f D .f [; f ]/ with f [ W X[ ! Y [, and
f ] 2 kY ]; X]k is a morphism for the underlying algebras.
2. f [.x/ ˆY b iff x ˆX f ].b/ for all x 2 X[ and all b 2 Y ].
f [; f ]

3.6. A GALLERY OF SPACES AND TECHNIQUES
375
We have indicated above for the reader’s convenience in which system
the satisfaction relation is considered. It is evident that the notion of
continuity is copied from topological spaces, taking the slightly different
scenario into account.
Example 3.6.13 Let X and Y be topological systems with f W X ! Y
a c-morphism. Let .X[; X[/ and .Y [; Y [/ be the topological spaces
generated from these systems through the extent of the respective opens,
as in Example 3.6.11, part 2.
Then f [ W X[ ! Y [ is X[-Y [-
continuous. In fact, let b 2 Y ], then
x 2 .f [/1
.jbj/

, f [.x/ 2 .jbj/ , f [.x/ ˆ b , x ˆ f ].b/I
thus
.f [/1
.jbj/

D .jf ].b/j/ 2 X[:
This shows that continuity of topological spaces is a special case of c-
morphisms between topological systems, in the same way as topological
spaces are special cases of topological systems. ✌
Let f W X ! Y and g W Y ! Z be c-morphisms; then their composi-
tion is deﬁned as gıf WD .g[ıf [; f ]ıg]/. The identity idX W X ! X
is deﬁned through idX WD .idX[; idX]/. If, given the c-morphism
f W X ! Y , there is a c-morphisms g W Y ! X with g ı f D idX and
f ı g D idY , then f is called a homeomorphism.
Corollary 3.6.14 Topological systems for a category TS, the objects of
which are topological systems, with c-morphisms as morphisms. a
Given a topological system X, the topological space .X[; X[/ with
X[ WD
˚
.jaj/ j a 2 X]
is called the spatialization of X and de-
noted by SP.X/. We want to make SP a (covariant) functor TS ! Top,
the latter one denoting the category of topological spaces with contin-
uous maps as morphisms. Thus we have to deﬁne the image SP.f / of
TS; Top; SP
a c-morphism f W X ! Y . But this is fairly straightforward, since
we have shown in Example 3.6.13 that f induces a continuous map
.X[; X[/ ! .Y [; Y [/. It is clear now that SP W TS ! Top is a co-
variant functor. On the other hand, part 1 of Example 3.6.11 shows that
we have a forgetful functor V W Top ! TS with V.X; / WD .X[; X]/
with X[ WD X and X] WD , and V.f / WD .f; f 1/. These functors
are related.

376
CHAPTER 3. TOPOLOGICAL SPACES
Proposition 3.6.15 SP is right adjoint to V.
Proof 0. Given a topological space X and a topological system A, we
have to ﬁnd a bijection 'X;A W homTS.V.X/; A/ ! homTop.X; SP.A//
rendering these diagrams commutative:
and
where F WD homTS.V.X/; F / W f 7! F ı f for F W A ! B in TS,
and G WD homTop.G; SP.A// W g 7! g ı G for G W Y ! X in Top; see
Sect. 2.5.
We deﬁne 'X;A.f [; f ]/ WD f [; hence we focus on the component of a
c-morphism which maps points to points.
1. Let us work on the ﬁrst diagram. Take f D .f [; f ]/ W V.X/ ! A as
a morphism in TS, and let F W A ! B be a c-morphism, F D .F [; F ]/;
then 'X;B.F.f // D 'X;B.F ıf / D F [ıf [, and .SP.F //.'X;A.f //
D SP.F / ı f [ D F [ ı f [.
2. Similarly, chasing f through the second diagram for some continuous
map G W Y ! X yields
'Y;A..V.G//.f //
D
'Y;A..f [; f ]/ ı .G; G1//
D
f [ ı G D G.f [/ D G.'X;A.f //:
This completes the proof. a
Constructing SP, we went from a topological space to its associated
topological system by exploiting the observation that a topology  is a
complete Heyting algebra. But we can travel in the other direction as
well, as we will show now.
Given a complete Heyting algebra A, we take the elements of A as
opens and take all morphisms in kA; 22k as points, deﬁning the relation
ˆ which connects the components through
x ˆ a , x.a/ D >:

3.6. A GALLERY OF SPACES AND TECHNIQUES
377
This construction was announced already in Example 3.6.11, part 3. In
order to extract a functor from this construction, we have to cater for
morphisms. In fact, let  2 kB; Ak be a morphism B ! A of the
complete Heyting algebras B and A and p 2 kA; 22k a point of A;
then p ı  2 kB; 22k is a point in B. Let cHA be the category of
all complete Heyting algebras with homcHA.A; B/ WD kB; Ak, then we
deﬁne the functor Loc W cHA ! TS through Loc.A/ WD .kA; 22k; A/,
and Loc. / WD . ;  / for  2 homcHA.A; B/ with  .p/ WD p ı  .
Thus Loc. / W Loc.A/ ! Loc.B/, if  W A ! B in cHA. In fact, let
f WD Loc. /, and p 2 kA; 22k a point in Loc.A/, then we obtain for
b 2 B
cHA; Loc
f [.p/ ˆ b , f [.p/.b/ D >
, .p ı  /.b/ D >
(since f [ D p ı  /
, p ˆ  .b/
, p ˆ f ].b/
(since f ] D  /:
This shows that Loc. / is a morphism in TS. Loc.A/ is called the
localization of the complete Heyting algebra A. The topological system
Localization
is called localic iff it is homeomorphic to the localization of a complete
Heyting algebra.
We have also here a forgetful functor V W TS ! cHA, and with a proof
very similar to the one for Proposition 3.6.15, one shows:
Proposition 3.6.16 Loc is left adjoint to the forgetful functor V. a
In a localic system, the points enjoy as morphisms evidently much more
structure than just being ﬂat points without a face, in an abstract set.
Before exploiting this wondrous remark, recall these notations, where
.P; / is a reﬂexive and transitive relation:
"p WD fq 2 P j q  pg;
#p WD fq 2 P j q  pg:
The following properties are stated just for the record.
Lemma 3.6.17 Let a 2 A with A a complete Heyting algebra. Then
"a is a ﬁlter, and #a is an ideal in A. a

378
CHAPTER 3. TOPOLOGICAL SPACES
Deﬁnition 3.6.18 Let A be a complete Heyting algebra.
1. a 2 A is called a prime element iff #a is a prime ideal.
2. The ﬁlter F  A is called completely prime iff W S 2 F implies
s 2 F for some s 2 S, where S  A.
Thus a 2 A is a prime element iff we may conclude from V S  a that
there exists s 2 S with s  a, provided S  A is ﬁnite. Note that a
prime ﬁlter has the stipulated property for ﬁnite S  A, so a completely
prime ﬁlter is a prime ﬁlter by implication.
Example 3.6.19 Let .X; / be a topological space, x 2 X, then
Gx WD fG 2  j x 2 Gg
is a completely prime ﬁlter in . It is clear that Gx is a ﬁlter in , since
it is closed under ﬁnite intersections, and G 2 Gx and G  H implies
H 2 Gx for H 2 . Now let S
i2I Si 2 Gx with Si 2  for all i 2 I,
then there exists j 2 I such that x 2 Sj, hence Sj 2 Gx. ✌
Prime ﬁlters in a complete Heyting algebra have this useful property: if
we have an element which is not in the ﬁlter, then we can ﬁnd a prime
element not in the ﬁlter dominating the given one. The proof of this
property requires the axiom of choice through Zorn’s Lemma.
Proposition 3.6.20 Let F  A be a prime ﬁlter in the complete Heyting
algebra A. Let a 62 F ; then there exists a prime element p 2 A with
a  p and p 62 F .
Proof Let Z WD fb 2 A j a  b and b 62 F g, then Z 6D ;, since
a 2 Z. We want to show that Z is inductively ordered. Hence take a
chain C  Z, then c WD sup C 2 A, since A is a complete lattice.
Clearly, a  c; suppose c 2 F ; then, since F is completely prime,
we ﬁnd c0 2 C with c0 2 F , which contradicts the assumption that
C  Z. But this means that Z contains a maximal element p by Zorn’s
Lemma.
Since p 2 Z, we have a  p and p 62 F , so we have to show that p is a
prime element. Assume that x ^ y  p, then either of x _ p or y _ p is
not in F : if both are in F , we have by distributivity .x _p/^.y _p/ D
.x ^ y/ _ p D p, so p 2 F , since F is a ﬁlter; this is a contradiction.
Assume that x _ p 62 F , then a  x _ p, since a  p; hence even
x _ p 2 Z. Since p is maximal, we conclude x _ p  p, which entails
x  p. Thus p is a prime element. a

3.6. A GALLERY OF SPACES AND TECHNIQUES
379
The reader might wish to compare this statement to an argument used
in the proof of Stone’s Representation Theorem; see Sect. 1.5.7. There
it is established that in a Boolean algebra, we may ﬁnd for each ideal
a prime ideal which contains it. The argumentation is fairly similar,
but, alas, one works there in a Boolean algebra, and not in a complete
Heyting algebra, as we do presently.
This is a characterization of completely prime ﬁlters and prime elements
in a complete Heyting algebra in terms of morphisms into 22. We will
use this characterization later on.
Lemma 3.6.21 Let A be a complete Heyting algebra, then:
1. F  A is a completely prime ﬁlter iff F D f 1.>/ WD f 1
f>g

for some f 2 kA; 22k.
2. I D f 1.?/ for some f 2 kA; 22k iff I D# p for some prime
element p 2 A.
Proof 1. Let F  A be a completely prime ﬁlter, and deﬁne
f .a/ WD
(
>;
if a 2 F
?;
if a 62 F
Then f W A ! 22 is a morphism for the complete Heyting algebras A
and 22. Since F is a ﬁlter, we have f .V S/ D V
s2S f .s/ for S  A
ﬁnite. Let S  A, then
_
s2S
f .s/ D > , f .s/ D > for some s 2 S , f .
_
S/ D >;
since F is completely prime. Thus f 2 kA; 22k and F D f 1.>/.
Conversely, given f 2 kA; 22k, the ﬁlter f 1.>/ is certainly completely
prime.
2. Assume that I D f 1.?/ for some f 2 kA; 22k, and put
p WD
_
fa 2 A j f .a/ D ?g:
Since A is complete, we have p 2 A, and if a  p, then f .a/ D ?.
Conversely, if f .a/ D ?, then a  p, so that I D# p; moreover, I
is a prime ideal, for f .a/ ^ f .b/ D ? iff f .a/ D ? or f .b/ D ?;
thus a ^ b 2 I implies a 2 I or b 2 I. Consequently, p is a prime
element.

380
CHAPTER 3. TOPOLOGICAL SPACES
Let, conversely, the prime element p be given, then one shows as in part
1 that
f .a/ WD
(
?;
if a  p
>;
otherwise
deﬁnes a member of kA; 22k with #p D f 1.?/. a
Continuing Example 3.6.19, we see that there exists for a topological
space X WD .X; / for each x 2 X an element fx 2 k; 22k such that
fx.G/ D > iff x 2 G. Deﬁne the map ˚X W X ! k; 22k through
˚X.x/ WD fx (so that ˚X.x/ D fx iff Gx D f 1
x
.>/). We will
examine ˚X now in a little greater detail.
˚X
Lemma 3.6.22 ˚X is injective iff X is a T0-space.
Proof Let ˚X be injective, x 6D y, then Gx 6D Gy. Hence there exists an
open set G which contains one of x; y, but not the other. If, conversely,
X is a T0-space, then we have by the same argumentation Gx 6D Gy for
all x; y with x 6D y, so that ˚X is injective. a
Well, that is not too bad, because the representation of elements into
k; 22k is reﬂected by a (very basic) separation axiom. Let us turn to
surjectivity. For this, we need to transfer reducibility to the level of
open or closed sets; since this is formulated most concisely for closed
sets, we use this alternative. A closed set is called irreducible iff each
of its covers with closed sets entails its being covered already by one of
them (but compare Exercise 1.20), formally:
Deﬁnition 3.6.23 A closed set F  X is called irreducible iff F 
S
i2I Fi implies F  Fi for some i 2 I for any family .Fi/i2I of
closed sets.
Thus a closed set F is irreducible iff the open set X n F is a prime ele-
ment in . Let us see: Assume that F is irreducible, and let T
i2I Gi 
X n F for some open sets .Gi/i2I. Then F  S
i2I X n Gi with
X n Gi closed; thus there exists j 2 I with F  X n Gj , and hence
Gj  X n F . Thus # .X n F / is a prime ideal in . One argues in
exactly the same way for showing that if # .X n F / is a prime ideal in
, then F is irreducible.
Now we have this characterization of surjectivity of our map ˚X through
irreducible closed sets.

3.6. A GALLERY OF SPACES AND TECHNIQUES
381
Lemma 3.6.24 ˚X is onto iff for each irreducible closed set F there
exists x 2 X such that F D fxga.
Proof 1. Let ˚X be onto, F  X be irreducible. By the argumentation
above, X n F is a prime element in ; thus we ﬁnd f 2 k; 22k with
# .X n F / D f 1.?/. Since ˚X is into, we ﬁnd x 2 X such that
f D ˚X.x/; hence we have x 62 G , f .x/ D ? for all open G  X.
It is then elementary to show that F D fxga.
2. Let f 2 k; 22k, then we know that f 1.?/ D# G for some prime
open G. Put F WD X n G, then F is irreducible and closed; hence
F D fxga for some x 2 X. Then we infer f .H/ D > , x 2 H for
each open set H, so we have indeed f D ˚X.x/. Hence ˚X is onto.
a
Thus, if ˚X is a bijection, we can recover (the topology on) X from the
morphisms on the complete Heyting algebra k; 22k.
Deﬁnition 3.6.25 A topological space .X; / is called sober5 iff ˚X W
X ! k; 22k is a bijection.
Thus we obtain as a consequence this characterization.
Corollary 3.6.26 Given a topological space X, the following condi-
tions are equivalent:
 X is sober.
 X is a T0-space and for each irreducible closed set F there exists
x 2 X with F D fxga.
Exercise 3.32 shows that each Hausdorff space is sober. This property
is, however, seldom made use of in the context of classic applications of
Hausdorff spaces in, say, analysis.
Before continuing, we generalize the Scott topology, which has been
deﬁned in Example 3.1.6 for inductively ordered sets. The crucial prop-
erty is closedness under joins, and we stated this property in a linearly
ordered set by saying that, if the supremum of a set S is in a Scott open
set G, then we should ﬁnd an element s 2 S with s 2 G. This will have
5The rumors in the domain theory community that a certain Johann Heinrich-
Wilhelm Sober was a skat partner of Hilbert’s gardener at G¨ottingen could not be
conﬁrmed—anyway, what about the third man?

382
CHAPTER 3. TOPOLOGICAL SPACES
to be relaxed somewhat. Let us analyze the argument why the intersec-
tion G1 \ G2 of two Scott open sets (old version) G1 and G2 is open
by taking a set S such that W S 2 G1 \ G2. Because Gi is Scott open,
we ﬁnd si 2 S with si 2 Gi (i D 1; 2), and because we work in a linear
ordered set, we know that either s1  s2 or s2  s1. Assuming s1  s2,
we conclude that s2 2 G1, because open sets are upper closed, so that
G1 \G2 is indeed open. The crucial ingredient here is evidently that we
can ﬁnd for two elements of S an element which dominates both, and
this is the key to the generalization.
We want to be sure that each directed set has an upper bound; this is
the case, e.g., when we are working in a complete Heyting algebra.
The structure we are deﬁning now, however, is considerably weaker,
but makes sure that we can do what we have in mind.
Deﬁnition 3.6.27 A partially ordered set in which every directed subset
has an upper bound is called a directed completed partial ordered set,
abbreviated as dcpo.
dcpo
Evidently, complete Heyting algebras are dcpos; in particular topologies
are under inclusion. Sober topological spaces with the specialization or-
der induced by the open sets, as introduced in the next example, furnish
another example for a dcpo.
Example 3.6.28 Let X D .X; / be a sober topological space. Hence
the points in X and the morphisms in k; 22k are in a bijective corre-
spondence. Deﬁne for x; x0 2 X the relation x v x0 iff we have for
all open sets x ˆ G ) x0 ˆ G (thus x 2 G implies x0 2 G). If we
think that being contained in more open sets means having better infor-
mation, x v x0 is then interpreted as x0 being better informed than x; v
is sometimes called the specialization order.
Then .X; v/ is a partially ordered set, antisymmetry following from the
observation that a sober space is a T0-space. But .X; v/ is also a dcpo.
Let S  X be a directed set, then L WD ˚X

S

is directed in k; 22k.
Deﬁne
p.G/ WD
(
>;
if there exists ` 2 L with `.G/ D >
?;
otherwise
We claim that p 2 k; 22k. It is clear that p.W W / D W
w2W p.w/ for
W  . Now let W   be ﬁnite, and assume that V p

W

D >;
hence p.w/ D > for all w 2 W . Thus we ﬁnd for each w 2 W some

3.6. A GALLERY OF SPACES AND TECHNIQUES
383
`w 2 L with `w.w/ D >. Because L is directed, and W is ﬁnite, we
ﬁnd an upper bound ` 2 L to f`w j w 2 W g, hence `.w/ D > for all
w 2 W , so that `.V W / D >, and hence p.V W / D >. This implies
V p

W

D p.V W /. Thus p 2 k; 22k, so that there exists x 2 X with
x D ˚X.p/. Clearly, x is an upper bound to S. ✌
Deﬁnition 3.6.29 Let .P; / be a dcpo, then U  P is called Scott
open iff:
1. U is upper closed.
2. If sup S 2 U for some directed set S, then there exists s 2 S with
s 2 U .
The second property can be described as inaccessibility through directed
joins: If U contains the directed join of a set, it must contain already
one of its elements. The following example is taken from [GHKC03, p.
136].
Example 3.6.30 The powerset P .X/ of a set X is a dcpo under inclu-
sion. The sets fF  P .X/ j F is of weakly ﬁnite characterg are Scott
open (F  P .X/ is of weakly ﬁnite character iff this condition holds:
F 2 F iff some ﬁnite subset of F is in F). Let F be of weakly ﬁnite
character. Then F is certainly upper closed. Now let S WD S S 2 F for
some directed set S  P .X/; thus there exists a ﬁnite subset F  S
with F 2 F. Because S is directed, we ﬁnd S0 2 S with F  S0, so
that S0 2 F. ✌
In a topological space, each compact set gives rise to a Scott open ﬁlter
as a subset of the topology.
Lemma 3.6.31 Let .X; / be a topological space and C  X compact,
then
H.C/ WD fU 2  j C  U g
is a Scott open ﬁlter.
Proof Since H.C/ is upper closed and a ﬁlter, we have to establish that
it is not accessible by directed joins. In fact, let S be a directed subset of
 such that S S 2 H.C/. Then S forms a cover of the compact set C;
hence there exists S0  S ﬁnite such that C  S S0. But S is directed,
so S0 has an upper bound S 2 S; thus S 2 H.C/. a
Scott opens form in fact a topology, and continuous functions are char-
acterized in a fashion similar to Example 3.1.11. We just state and prove

384
CHAPTER 3. TOPOLOGICAL SPACES
these properties for completeness, before entering into a discussion of
the Hofmann–Mislove Theorem.
Proposition 3.6.32 Let .P; / be a dcpo:
1. fU  P j U is Scott openg is a topology on P , the Scott topology
of P .
2. F  P is Scott closed iff F is downward closed (x  y and
y 2 F imply x 2 F ) and closed with respect to suprema of
directed subsets.
3. Given a dcpo .Q; /, a map f W P ! Q is continuous with
respect to the corresponding Scott topologies iff f preserves di-
rected joins (i.e., if S  P is directed, then f

S

 Q is directed
and sup f

S

D f .sup S/).
Proof 1. Let U1; U2 be Scott open, and sup S 2 U1\U2 for the directed
set S. Then there exist si 2 S with si 2 Gi for i D 1; 2. Since S is
directed, we ﬁnd s 2 S with s  s1 and s  s2, and since U1 and U2
both are upper closed, we conclude s 2 U1 \ U2. Because U1 \ U2
is plainly upper closed, we conclude that U1 \ U2 is Scott open; hence
the set of Scott opens is closed under ﬁnite intersections. The other
properties of a topology are evidently satisﬁed. This establishes the ﬁrst
part.
2. The characterization of closed sets follows directly from the one for
open sets by taking complements.
3. Let f W P ! Q be Scott-continuous. Then f is monotone: if
x  x0, then x0 is contained in the closed set f 1
# f .x0/

; thus
x 2 f 1
# f .x0/

, and hence f .x/  f .x0/. Now let S  P be
directed, then f

S

 Q is directed by assumption, and S  f 1
#
.sups2S f .s//

. Since the latter set is closed, we conclude that it con-
tains sup S, hence f .sup S/  sup f

S

. On the other hand, since f
is monotone, we know that f .sup S/  sup f

S

. Thus f preserves
directed joins.
Assume that f preserves directed joins, then, if x  x0,
f .x0/ D f .sup fx; x0g/ D sup ff .x/; f .x0/g
follows; hence f is monotone. Now let H  Q be Scott open, then
f 1
H

is upper closed. Let S  P be directed, and assume that

3.6. A GALLERY OF SPACES AND TECHNIQUES
385
sup f

S

2 H; then there exists s 2 S with f .s/ 2 H, and hence s 2
f 1
H

, which therefore is Scott open. Hence f is Scott continuous.
a
Following [GHKC03, Chap. II-1], we show that in a sober space, there
is an order morphism between Scott open ﬁlters and certain compact
subsets. Preparing for this, we observe that in a sober space, every open
subset which contains the intersection of a Scott open ﬁlter is already
an element of the ﬁlter. This will turn out to be a consequence of the
existence of prime elements not contained in a prime ﬁlter, as stated in
Proposition 3.6.20.
Lemma 3.6.33 Let F   be a Scott open ﬁlter of open subsets in a
sober topological space .X; /. If T F  U for the open set U , then
U 2 F.
Proof 0. The plan of the proof goes like this: Since F is Scott open, it
Plan
is a prime ﬁlter in . We assume that there exists an open set which con-
tains the intersection, but which is not in F. This is exactly the situation
in Proposition 3.6.20, so there exists an open set which is maximal with
respect to not being a member of F and which is prime; hence we may
represent this set as f 1.?/ for some f 2 k; 22k. But now sobriety
kicks in, and we represent f through an element x 2 X. This will then
lead us to the desired contradiction.
1. Because F is Scott open, it is a prime ﬁlter in . Let G WD T F,
and assume that U is open with G  U (note that we do not know
whether or not G is empty). Assume that U 62 F, then we obtain from
Proposition 3.6.20 a prime open set V which is not in F, which contains
U , and which is maximal. Since V is prime, there exists f 2 k; 22k
such that fH 2  j f .H/ D ?g D# V by Lemma 3.6.21. Since
X is sober, we ﬁnd x 2 X such that ˚X.x/ D f ; hence X n V D
fxga.
2. We claim that fxga  G. If this is not the case, we have ´ 62 H for
some H 2 F and ´ 2 fxga. Because H is open, this entails fxga\H D
;; thus by maximality of V , H  V . Since F is a ﬁlter, this implies
V 2 F, which is not possible. Thus fxga  G, hence G 6D ;, and
X n V \ G D ;. Thus U \ G D ;, contradicting the assumption.
a
This is a fairly surprising and strong statement, because we usually can-
not conclude from T F  U that U 2 F holds, when F is an arbitrary

386
CHAPTER 3. TOPOLOGICAL SPACES
ﬁlter. But we work here under stronger assumptions: the underlying
space is sober, so each point is given by a morphism for the underly-
ing complete Heyting algebra and vice versa. In addition, we deal with
Scott open ﬁlters. They have the pleasant property of being inaccessible
by directed suprema.
But we may even say more, viz., that the intersection of these ﬁlters is
compact. For, if we have an open cover of the intersection, the union of
this cover is open, thus must be an element of the ﬁlter by the previous
lemma. We may write the union as a union of a directed set of open
sets, which then lets us apply the assumption that the ﬁlter is inaccessi-
ble.
Corollary 3.6.34 Let X be sober and F be a Scott open ﬁlter. Then
T F is compact and nonempty.
Proof Let K WD T F and S be an open cover of K. Thus U WD S S
is open with K  S, hence U 2 F by Lemma 3.6.33. But S S D
S˚S S0 j S0  S ﬁnite

, and the latter collection is directed, so there
exists S0  S ﬁnite with S S0 2 F. But this means S0 is a ﬁnite
subcover of K, which consequently is compact. If K is empty, ; 2 F
by Lemma 3.6.33, which is impossible. a
This gives a complete characterization of the Scott open ﬁlters in a sober
space. The characterization involves compact sets which are represented
as the intersections of these ﬁlters. But we can represent only those
compact sets C which are upper sets in the specialization order, i.e., for
which holds x 2 C and x v x0 implies x0 2 C. These sets are called
saturated. Recall that x v x0 means x 2 G ) x0 2 G for all open
sets G; hence a set is saturated iff it equals the intersection of all open
sets containing it. With this in mind, we state the Hofmann–Mislove
Theorem.
Theorem 3.6.35 Let X be a sober space. Then the Scott open ﬁlters are
in one-to-one and order preserving correspondence with the nonempty
saturated compact subsets of X via F 7! T F.
Proof We have shown in Corollary 3.6.34 that the intersection of a
Scott open ﬁlter is compact and nonempty; it is saturated by construc-
tion. Conversely, Lemma 3.6.31 shows that we may obtain from a com-
pact and saturated subset C of X a Scott open ﬁlter, the intersection of
which must be C. It is clear that the correspondence is order preserving.
a

3.6. A GALLERY OF SPACES AND TECHNIQUES
387
It is quite important for the proof of Lemma 3.6.33 that the underlying
space is sober. Hence it does not come as a surprise that the Theorem of
Hofmann–Mislove can be used for a characterization of sober spaces as
well [GHKC03, Theorem II-1.21].
Proposition 3.6.36 Let X be a T0-space. Then the following statements
are equivalent:
1. X is sober.
2. Each Scott open ﬁlter F on  consists of all open sets containing
T F.
Proof 1 ) 2: This follows from Lemma 3.6.33.
2 ) 1: Corollary 3.6.26 tells us that it is sufﬁcient to show that each
irreducible closed set is the closure of one point.
Let A  X be irreducible and closed. Then F WD fG open j G \ A 6D
;g is closed under ﬁnite intersections, since A is irreducible. In fact,
let G and H be open sets with G \ A 6D ; and H \ A 6D ;. If
A  .X n G/ [ .X n H/, then A is a subset of one of these closed sets,
say, X n G, but then A \ H D ;, which is a contradiction. This implies
that F is a ﬁlter, and F is obviously Scott open.
Assume that A cannot be represented as fxga for some x. Then X nfxga
is an open set the intersection of which with A is not empty; hence
X n fxga 2 F. We obtain from the assumption that X n A 2 F, because
with K WD T F  T
x2X.X n fxga/; we have K  X n A, and X n A
is open. Consequently, A \ X n A 6D ;, which is a contradiction.
Thus there exists x 2 X such that A D fxga. Hence X is sober.
a
These are the ﬁrst and rather elementary discussions of the interplay be-
tween topology and order, considered in a systematic fashion in domain
theory. The reader is directed to [GHKC03] or to [AJ94] for further
information.
3.6.3
The Stone–Weierstraß Theorem
This section will see the classic Stone–Weierstraß Theorem on the ap-
proximation of continuous functions on a compact topological space.
We need for this a ring of continuous functions, and show that—under

388
CHAPTER 3. TOPOLOGICAL SPACES
suitable conditions—this ring is dense. This requires some preliminary
considerations on the space of continuous functions, because this con-
struction evidently requires a topology.
Denote for a topological space X by C.X/ the space of all continuous
C.X/
and bounded functions f W X ! R.
The structure of C.X/ is algebraically fairly rich; just for the record:
Proposition 3.6.37 C.X/ is a real vector space which is closed under
constants, multiplication, and under the lattice operations. a
This describes the algebraic properties, but we need a topology on this
space, which is provided by the supremum norm.
Deﬁne for f
2
C.X/
kf k WD sup
x2X
jf .x/j:
Then .C.X/; kk/ is an example for a normed linear (or vector) space.
Deﬁnition 3.6.38 Let V be a real vector space. A norm k  k W V !
RC assigns to each vector v a nonnegative real number kvk with these
properties:
1. kvk  0, and kvk D 0 iff v D 0.
2. k˛  vk D j˛j  kvk for all ˛ 2 R and all v 2 V .
3. kx C yk  kxk C kyk for all x; y 2 V .
A vector space with a norm is called a normed space.
It is immediate that a normed space is a metric space, putting d.v; w/ WD
kv  wk. It is also immediate that f 7! kf k deﬁnes a norm on C.X/.
But we can say actually a bit more: with this deﬁnition of a metric, C.X/
is a complete metric space; we have established this for the compact in-
terval Œ0; 1 in Example 3.5.19 already. Let us have a look at the general
case.
Lemma 3.6.39 C.X/ is complete with the metric induced by the supre-
mum norm.
Proof Let .fn/n2N be a kk-Cauchy sequence in C.X/, then .fn.x//n2N
is bounded, and f .x/ WD limn!1 fn.x/ exists for each x 2 X. Let
 > 0 be given, then we ﬁnd n0 2 N such that kfn  fmk <  for all
n; m  n0; thus jf .x/  fn.x/j   for n  n0. This inequality holds

3.6. A GALLERY OF SPACES AND TECHNIQUES
389
for each x 2 X, so that we obtain kf  fnk   for n  n0. It implies
also that f 2 C.X/. a
Normed spaces for which the associated metric space is complete are
special, so they deserve their own name.
Deﬁnition 3.6.40 A normed space .V; k  k/ which is complete in the
metric associated with k  k is called a Banach space.
The topology induced by the supremum norm is called the topology of
uniform convergence, so that we may restate Lemma 3.6.39 by saying
the C.X/ is closed under uniform convergence. A helpful example is
Dini’s Theorem for uniform convergence on C.X/ for compact X. It
gives a criterion of uniform convergence, provided we know already
that the limit is continuous.
Proposition 3.6.41 Let X be a compact topological space, and assume
that .fn/n2N is a sequence of continuous functions which increases
monotonically to a continuous function f . Then .fn/n2N converges
uniformly to f .
Proof We know that fn.x/  fnC1.x/ holds for all n 2 N and all
x 2 X and that f .x/ WD supn2N fn.x/ is continuous. Let  > 0 be
given, then Fn WD fx 2 X j f .x/  fn.x/  g deﬁnes a closed set
with T
n2N Fn D ;; moreover, the sequence .Fn/n2N decreases. Thus
we ﬁnd n0 2 N with Fn D ; for n  n0; hence kf  fnk <  for
n  n0. a
The goal of this section is to show that, given the compact topological
space X, we can approximate each continuous real function uniformly
through elements of a subspace of C.X/. It is plain that this subspace
has to satisfy some requirements; it should:
 be a vector space itself,
 contain the constant functions,
 separate points,
 be closed under multiplication.
Hence it is in particular a subring of the ring C.X/. Let A be such a
subset, then we want to show that the closure Aa with respect to uniform
convergence equals C.X/. We will show ﬁrst that Aa is closed under the
lattice operations, because we will represent an approximating function

390
CHAPTER 3. TOPOLOGICAL SPACES
as the ﬁnite supremum of a ﬁnite inﬁmum of simpler approximations.
So the ﬁrst goal will be to establish closure under inf and sup. Recall
that
f ^ g D 1
2  .f C g  jf  gj/;
f _ g D 1
2  .f C g C jf  gj/:
Now it is easy to see that Aa is closed under the vector space operations,
if A is. Our ﬁrst step boils down to showing that jf j 2 Aa if f 2 A.
Thus, given f 2 A, we have to ﬁnd a sequence .fn/n2N such that jf j
is the uniform limit of this sequence. It is actually enough to show
But wait!
that t 7! pt can be approximated uniformly on the unit interval Œ0; 1,
because we know that jf j D
p
f 2 holds. It sufﬁces to do this on the
unit interval, as we will see below.
Lemma 3.6.42 There exists a sequence .fn/n2N in C.Œ0; 1/ which con-
verges uniformly to the function t 7! pt.
Proof Deﬁne inductively for t 2 Œ0; 1
f0.t/ WD 0;
fnC1.t/ WD fn.t/ C 1
2  .t  f 2
n .t//:
We show by induction that fn.t/  pt holds. This is clear for n D 0. If
we know already that the assumption holds for n, then we write
p
t  fnC1.t/
D
p
t  fn.t/  1
2  .t  f 2
n .t//
D
.
p
t  fn.t// 

.1  1
2  .
p
t C fn.t//

:
Because t 2 Œ0; 1 and from the induction hypothesis, we have pt C
fn.t/  2  pt  2, so that pt  fnC1.t/  0.
Thus we infer that fn.t/  pt for all t 2 Œ0; 1, and limn!1 fn.t/ D
pt. From Dini’s Proposition 3.6.41, we now infer that the convergence
is uniform. a
This is the desired consequence from this construction.
Corollary 3.6.43 Let X be a compact topological space, and let A 
C.X/ be a ring of continuous functions which contains the constants
and which is closed under uniform convergence. Then A is a lattice.

3.6. A GALLERY OF SPACES AND TECHNIQUES
391
Proof It is enough to show that A is closed under taking absolute val-
ues. Let f 2 A, then we may and do assume that 0  f  1 holds
(otherwise consider .f kf k/=kf k, which is an element of A as well).
Because jf j D
p
f 2, and the latter is a uniform limit of elements of A
by Lemma 3.6.42, we conclude jf j 2 A, which entails A being closed
under the lattice operations. a
We are now in a position to establish the classic Stone–Weierstraß Theo-
rem, which permits to conclude that a ring of bounded continuous func-
tions on a compact topological space X is dense with respect to uniform
convergence in C.X/, provided it contains the constants and separates
points. The latter condition is obviously necessary, but has not been
used in the argumentation so far. It is clear, however, that we cannot
do without this condition, because C.X/ separates points, and it is difﬁ-
cult to see how a function which separates points could be approximated
from a collection which does not.
The polynomials on a compact interval in the reals are an example for
a ring which satisﬁes all these assumptions. This collection shows also
that we cannot extend the result to a non-compact base space like the
reals. Take x 7! sin x, for example; this function cannot be approxi-
mated uniformly over R by polynomials. For, assume that given  > 0
there exists a polynomial p such that supx2R jp.x/sinxj < , then we
would have   1 < p.x/ < 1 C  for all x 2 R, which is impossible,
because a polynomial is unbounded.
Here, then, is the Stone–Weierstraß Theorem for compact topological
spaces.
Theorem 3.6.44 Let X be a compact topological space and A  C.X/
be a ring of functions which separates points and which contains all
constant functions. Then A is dense in C.X/.
Proof 0. Our goal is to ﬁnd for some given f 2 C.X/ and an arbi-
Approach
trary  > 0 a function ' 2 Aa such that kf  'k < . Since X
is compact, we will ﬁnd ' through a reﬁned covering argument in the
following way. If a; b 2 X are given, we ﬁnd a continuous function
fa;b 2 A with fa;b D f .a/ and fa;b D f .b/. From this we con-
struct a cover; using sets like fx j fa;b.x/ < f .x/ C g and fx j
fa;b.x/ > f .x/  g, extract ﬁnite subcovers and construct from the
corresponding functions the desired function through suitable lattice
operations.

392
CHAPTER 3. TOPOLOGICAL SPACES
1. Fix f 2 C.X/ and  > 0. Given distinct point a 6D b, we ﬁnd a
function h 2 A with h.a/ 6D h.b/; thus
g.x/ WD h.x/  h.a/
h.b/  h.a/
deﬁnes a function g 2 A with g.a/ D 0 and g.b/ D 1. Then
fa;b.x/ WD .f .b/  f .a//  g.x/ C f .a/
is also an element of A with fa;b.a/ D f .a/ and fa;b.b/ D f .b/. Now
deﬁne
Ua;b WD fx 2 X j fa;b.x/ < f .x/ C g;
Va;b WD fx 2 X j fa;b.x/ > f .x/  gI
then Ua;b and Va;b are open sets containing a and b.
2. Fix b, then fUa;b j a 2 Xg is an open cover of X, so we can ﬁnd
points a1; : : : ; ak such that fUa1;b; : : : ; Uak;bg is an open cover of X by
compactness. Thus
fb WD
k
^
iD1
fai;b
deﬁnes an element of Aa by Corollary 3.6.43. We have fb.x/ < f .x/C
 for all x 2 X, and we know that fb.x/ > f .x/   for all x 2 Vb WD
Tk
iD1 Vai;b. The set Vb is an open neighborhood of b, so from the open
cover fVb j b 2 Xg, we ﬁnd b1; : : : ; b` such that X is covered through
fVb1; : : : ; Vb`g. Put
' WD
`_
iD1
fbi;
then f 2 Aa and kf  'k < . a
This is the example already discussed above.
Example 3.6.45 Let X WD Œ0; 1 be the closed unit interval, and let A
consist of all polynomials Pn
iD0 ai  xi for n 2 N and a0; : : : ; an 2 R.
Polynomials are continuous, they form a vector space and are closed
under multiplication. Moreover, the constants are polynomials. Thus we
obtain from the Stone–Weierstraß Theorem 3.6.44 that every continuous
function on Œ0; 1 can be uniformly approximated through a sequence of
polynomials. ✌

3.6. A GALLERY OF SPACES AND TECHNIQUES
393
The polynomials discussed in Example 3.6.45 are given algebraically
as the ring generated by the functions f1; idŒ0;1g in the ring of all con-
tinuous functions over Œ0; 1. In general, given a subset A  C.X/
which is closed under multiplication, the smallest ring R.A/ containing
A is
R.A/ D
˚Pn
iD1 ai  fi j n 2 N; a1; : : : ; an 2 R; f1; : : : ; fn 2 A

:
This is so because the set above is a ring which must be contained in
every ring containing A, and it is a ring itself. We obtain from this
consideration:
Corollary 3.6.46 Let .X; d/ be compact metric, then .C.X/; k  k/ is a
separable Banach space.
Proof Let G be a countable basis for the topology of X, then the count-
able set A0 WD fd.; X n G/ j G 2 Gg of continuous functions separates
points; hence R.A0 [ R/ is dense in C.X/ by the Stone–Weierstraß
Theorem 3.6.44. Given f D Pn
iD1 ai  fi and  > 0, there exists
f 0 D Pn
iD1 a0
i  fi with a0
i 2 Q for 1  i  n and kf  f 0k  , so
that the elements from R.A/ with rational coefﬁcients form a countable
dense subset as well. a
It is said that Oscar Wilde could resist everything but a good temptation.
Oscar Wilde
The author concurs. Here is a classic proof of the Weierstraß Approxi-
mation Theorem, the original form of Theorem 3.6.44, which deals with
polynomials on Œ0; 1 only, and establishes the statement given in Exam-
ple 3.6.45. We will give this proof now, based on the discussion in the
classic [CH67, II.4.1]. This proof is elegant and based on the manipu-
lation of speciﬁc functions (we are all too often focussed on our pretty
little garden of beautiful abstract structures, all too often in danger of
loosing the contact to concrete mathematics and to our roots).
As a preliminary consideration, we will show that
lim
n!1
R 1
ı .1  v2/n dv
R 1
0 .1  v2/n dv
D 0
for every ı 2 0; 1Œ. Deﬁne for this
Jn WD
Z 1
0
.1  v2/n dv;
J 
n WD
Z 1
ı
.1  v2/n dv:

394
CHAPTER 3. TOPOLOGICAL SPACES
(we will keep these notations for later use). We have
Jn >
Z 1
0
.1  v/n dv D
1
n C 1
and
J 
n D
Z 1
ı
.1  v2/n dv < .1  ı2/n  .1  ı/ < .1  ı2/n:
Thus
J 
n
Jn
< .n C 1/  .1  ı2/n ! 0:
This establishes the claim.
Let f W Œ0; 1 ! R be continuous. Given  > 0, there exists ı > 0 such
that jx  yj < ı implies jf .x/  f .y/j <  for all x 2 Œ0; 1, since f
is uniformly continuous by Proposition 3.5.36. Thus 0  v < ı implies
jf .x C v/  f .x/j <  for all x 2 Œ0; 1.
Put
Qn.x/ WD
Z 1
0
f .u/ 

1  .u  x/2n du;
Pn.x/ WD Qn.x/
2  Jn
:
We will show that Pn converges to f in the topology of uniform con-
vergence.
We note ﬁrst that Qn is a polynomial of degree 2n. In fact, put
Aj WD
Z 1
0
f .u/  uj du
for j  0; expanding yields the formidable representation
Qn.x/ D
n
X
kD0
2k
X
jD0
 
n
k
! 
2k
j
!
.1/nkCj Aj  x2kj:
Let us work on the approximation. We ﬁx x 2 Œ0; 1, and note that the
inequalities derived below do not depend on the speciﬁc choice of x.
Hence they will provide a uniform approximation.

3.6. A GALLERY OF SPACES AND TECHNIQUES
395
Substitute u by v C x in Qn; this yields
Z 1
0
f .u/

1  .u  x/2n du D
Z 1x
x
f .v C x/.1  v2/n dv
D I1 C I2 C I3
with
I1 WD
Z ı
x
f .v C x/.1  v2/n dv;
I2 WD
Z Cı
ı
f .v C x/.1  v2/n dv;
I3 WD
Z 1x
Cı
f .v C x/.1  v2/n dv:
We work on these integrals separately. Let M WD max0x1 jf .x/j,
then
I1  M
Z ı
1
.1  v2/n dv D M  J 
n ;
and
I3  M
Z 1
ı
.1  v2/n dv D M  J 
n :
We can rewrite I2 as follows:
I2 D f .x/
Z Cı
ı
.1  v2/n dv C
Z Cı
ı

f .x C v/  f .x/

.1  v2/n dv
D 2f .x/.Jn  J 
n / C
Z Cı
ı

f .x C v/  f .x/

.1  v2/n dv:
From the choice of ı for , we obtain
ˇˇ
Z Cı
ı

f .x C v/  f .x/

.1  v2/n dv
ˇˇ


Z Cı
ı
.1  v2/n dv
<

Z C1
1
.1  v2/n dv
D
2  Jn
Combining these inequalities, we obtain
jPn.x/  f .x/j < 2M  J 
n
Jn
C :

396
CHAPTER 3. TOPOLOGICAL SPACES
Hence the difference can be made arbitrarily small, which means that f
can be approximated uniformly through polynomials.
The two approaches presented are structurally very different; it would
be difﬁcult to recognize the latter as a precursor of the former. While
both make substantial use of uniform continuity, the ﬁrst one is an ex-
istential proof, constructing two covers from which to choose a ﬁnite
subcover each and deriving from this the existence of an approximating
function. It is nonconstructive because it would be difﬁcult to construct
an approximating function from it, even if the ring of approximating
functions is given by a base for the underlying vector space. The second
one, however, starts also from uniform continuity and uses this property
to ﬁnd a suitable bound for the difference of the approximating poly-
nomial and the function proper through integration. The representation
of Qn above shows what the constructing polynomial looks like, and
the coefﬁcients of the polynomials may be computed (in principle, at
least). And, ﬁnally, the abstract situation gives us a greater degree of
freedom, since we deal with a ring of continuous functions observing
certain properties, while the original proof works for the class of poly-
nomials only.
3.6.4
Uniform Spaces
This section will give a brief introduction to uniform spaces. The objec-
tive is to demonstrate that the notion of a metric space can be generalized
in meaningful ways without arriving at the full generality of topological
spaces but retaining useful properties like completeness or uniform con-
tinuity. While pseudometric spaces formulate the concept of two points
to be close to each other through a numeric value, and general topo-
logical spaces use the concept of an open neighborhood, uniform spaces
formulate neighborhoods on the Cartesian product. This concept is truly
in the middle: each pseudometric generates neighborhoods, and from a
neighborhood, we may obtain the neighborhood ﬁlter for a point.
For motivation and illustration, we consider a pseudometric space .X; d/
and say that two points are neighbors iff their distance is smaller that r
for some ﬁxed r > 0; the degree of neighborhood is evidently depend-
ing on r. The set
Vd;r WD Vr WD fhx; yi j d.x; y/ < rg

3.6. A GALLERY OF SPACES AND TECHNIQUES
397
is then the collection of all neighbors.
We may obtain from Vr the
Vd;rI Vr
neighborhood B.x; r/ for some point x upon extracting all y such that
hx; yi 2 Vr; thus
B.x; r/ D VrŒx WD fy 2 X j hx; yi 2 Vrg:
The collection of all these neighborhoods observes these properties:
1. The diagonal  WD X is contained in Vr for all r > 0, because
d.x; x/ D 0.
2. Vr is—as a relation on X—symmetric: hx; yi 2 Vr iff hy; xi 2
Vr; thus V 1
r
D Vr. This property reﬂects the symmetry of d.
3. Vr ı Vs  VrCs for r; s > 0; this property is inherited from the
triangle inequality for d.
4. Vr1\Vr2 D Vminfr1;r2g; hence this collection is closed under ﬁnite
intersections.
It is convenient to consider not only these immediate neighborhoods
but rather the ﬁlter generated by them on X  X (which is possible be-
cause the empty set is not contained in this collection, and the properties
above shows that they form the base for a ﬁlter indeed). This leads to
this deﬁnition of a uniformity. It focusses on the properties of the neigh-
borhoods rather than on that of a pseudometric, so we formulate it for a
set in general.
Deﬁnition 3.6.47 Let X be a set. A ﬁlter u on P .X  X/ is called a
uniformity on X iff these properties are satisﬁed:
1.   U for all U 2 u.
2. If U 2 u, then U 1 2 u.
3. If U 2 u, there exists V 2 u such that V ı V  U .
4. u is closed under ﬁnite intersections.
5. If U 2 u and U  W , then W 2 u.
The pair .X; u/ is called a uniform space. The elements of u are called
u-neighborhoods.
The ﬁrst three properties are gleaned from those of the pseudometric
neighborhoods above, the last two are properties of a ﬁlter, which have
been listed here just for completeness.

398
CHAPTER 3. TOPOLOGICAL SPACES
Figure 3.1: Some relational identities
We will omit u when talking about a uniform space, if this does not
yield ambiguities. The term “neighborhood” is used for elements of
a uniformity and for the neighborhoods of a point. There should be
Neigh-
borhood,
entourage,
Nach-
barschaft
no ambiguity, because the point is always attached, when talking about
neighborhood in the latter, topological sense. Bourbaki uses the term
entourage for a neighborhood in the uniform sense; the German word
for this is Nachbarschaft (while the term for a neighborhood of a point
is Umgebung).
We will need some relational identities; they are listed in Fig. 3.1 for the
reader’s convenience.
We will proceed here as we do in the case of topologies, where we do
not always specify the entire topology, but occasionally make use of the
possibility to deﬁne it through a base. We have this characterization for
the base of a uniformity.
Proposition 3.6.48 A family ; 6D b  P .X  X/ is the base for a
Base
uniformity iff it has the following properties:
1. Each member of b contains the diagonal of X.
2. For U 2 b, there exists V 2 b with V  U 1.
3. For U 2 b, there exists V 2 b with V ı V  U .
4. For U; V 2 b, there exists W 2 b with W  U \ V .

3.6. A GALLERY OF SPACES AND TECHNIQUES
399
Proof Recall that the ﬁlter generated by a ﬁlter base b is deﬁned through
fF j U  F for some U 2 bg. With this in mind, the proof is straight-
forward. a
This permits a description of a uniformity in terms of a base, which is
usually easier than giving a uniformity as a whole. Let us look at some
examples.
Example 3.6.49
1. The uniformity f; X  Xg is called the indis-
crete uniformity, and the uniformity fA  X  X j   Ag is
called the discrete uniformity on X.
2. Let Vr WD fhx; yi j x; y 2 R; jx  yj < rg, then fVr j r > 0g is
a base for a uniformity on R. Since it makes use of the structure
of .R; C/ as an additive group, it is called the additive uniformity
on R.
3. Put VE WD fhx; yi 2 R2 j x=y 2 Eg for some neighbor-
hood E of 1 2 R n f0g. Then the ﬁlter generated by fVE j
E is a neighborhood of 1g is a uniformity. This is so because the
logarithm function is continuous on RC n f0g. This uniformity
is nourished from the multiplicative group .R n f0g; /, so it is
called the multiplicative uniformity on R n f0g. This is discussed
in greater generality in part 9.
4. A partition  on a set X is a collection of nonempty and mutually
disjoint subsets of X which covers X. It generates an equivalence
relation on X by rendering two elements of X equivalent iff they
are in the same partition element. Deﬁne V WD Sn
iD1.Pi  Pi/
for a ﬁnite partition  D fP1; : : : ; Pkg. Then
b WD fV j  is a ﬁnite partition on Xg
is the base for a uniformity. Let  be a ﬁnite partition, and denote
the equivalence relation generated by  by jj; hence x jj y iff
x and y are in the same element of .
   V is obvious, since jj is reﬂexive.
 U 1 D U for all U 2 V, since jj is symmetric.
 Because jj is transitive, we have V ı V  V.

400
CHAPTER 3. TOPOLOGICAL SPACES
 Let 0 be another ﬁnite partition, then fA \ B j A 2 ; B 2
0; A \ B 6D ;g deﬁnes a partition 00 such that V00 
V \ V0.
Thus b is the base for a uniformity, which is, you guessed it, called
the uniformity of ﬁnite partitions.
5. Let ; 6D I  P .X/ be an ideal (Deﬁnition 1.5.31), and deﬁne
AE WD fhA; Bi j AB 2 Eg for E 2 I;
b WD fAE j E 2 Ig:
Then b is a base for a uniformity on P .X/. In fact, it is clear
that P.X/  AE always holds and that each member of b is
symmetric.
Let AB  E and BC  F , then AC D
.AB/.BC/  .AB/[.AC/  E[F ; thus AE ıAF 
AE[F , and ﬁnally AE \ AF  AE\F . Because I is an ideal, it
is closed under ﬁnite intersections and ﬁnite unions; the assertion
follows.
6. Let p be a prime, and put Wk WD fhx; yi j x; y 2 Z; pk divides
x  yg. Then Wk ı W`  Wminfk;`g D Wk \ W`; thus b WD
fWk j k 2 Ng is the base for a uniformity up on Z, the p-adic
uniformity.
7. Let A be a set, .X; u/ a uniform space, and let F.A; X/ be the set
of all maps A ! X. We will deﬁne a uniformity on F.A; X/; the
approach is similar to the one in Example 3.1.4. Deﬁne for U 2 u
the set
UF WD fhf; gi 2 F.A; X/ j hf .x/; g.x/i 2 U for all x 2 Xg:
Thus two maps are close with respect to UF iff all their images
are close with respect to U . It is immediate that fUF j U 2 ug
forms a uniformity on F.A; X/ and that fUF j U 2 bg is a base
for a uniformity, provided b is a base for uniformity u.
If X D R is endowed with the additive uniformity, a typical set
of the base is given for  > 0 through
fhf; gi 2 F.A; R/ j sup
a2A
jf .a/  g.a/j < gI

3.6. A GALLERY OF SPACES AND TECHNIQUES
401
hence the images of f and of g have to be uniformly close to each
other.
8. Call a map f W R ! R afﬁne iff it can be written as f .x/ D
a  x C b with a 6D 0; let fa;b be the afﬁne map characterized by
the parameters a and b, and deﬁne X WD ffa;b j a; b 2 R; a 6D 0g
the set of all afﬁne maps. Note that an afﬁne map is bijective and
that its inverse is an afﬁne map again with f 1
a;b D f1=a;b=a; the
composition of an afﬁne map is an afﬁne map as well, since fa;b ı
fc;d D fac;adCb. Deﬁne for  > 0; ı > 0 the ; ı-neighborhood
U;ı by
U;ı WD ffa;b 2 X j ja  1j < ; jbj < ıg:
Put
U L
;ı WD fhfx;y; fa;bi 2 X  X j fx;y ı f 1
a;b 2 U;ıg;
bL WD fU L
;ı j  > 0; ı > 0g;
U R
;ı WD fhfx;y; fa;bi 2 X  X j f 1
x;y ı fa;b 2 U;ıg;
bR WD fU R
;ı j  > 0; ı > 0g:
Then bL resp. bR is the base for a uniformity uL resp. uR on
X. Let us check this for bR. Given positive ; ı, we want to ﬁnd
positive r; s with hfm;n; fp;qi 2 V R
r;s implies hfp;q; fm;ni 2 U R
;ı.
Now we can ﬁnd for  > 0 and ı > 0 some r > 0 and s > 0 so
that
j p
m  1j < r ) jm
p  1j < 
j q
m  n
mj < s ) j n
p  q
p j < ı
holds, which is just what we want, since it translates into V R
r;s 

U R
;ı
1. The other properties of a base are easily seen to be
satisﬁed. One argues similarly for bL.
Note that .X; ı/ is a topological group with the sets fU;ı j  >
0; ı > 0g as a base for the neighborhood ﬁlter of the neutral el-
ement f1;0 (topological groups are introduced in Example 3.1.25
on page 299).

402
CHAPTER 3. TOPOLOGICAL SPACES
9. Let, in general, G be a topological group with neutral element e.
Deﬁne for U 2 U.e/ the sets
UL WD fhx; yi j xy1 2 U g;
UR WD fhx; yi j x1y 2 U g;
UB WD UL \ UR:
Then fUL j U 2 U.e/g, fUR j U 2 U.e/g and fUB j U 2 U.e/g
deﬁne bases for uniformities on G; it can be shown that they do
not necessarily coincide; see Example 3.6.74.
✌
Before we show that a uniformity generates a topology, we derive a
sufﬁcient criterion for a family of subsets of X  X is a subbase for a
uniformity.
Lemma 3.6.50 Let s  P .X  X/, then s is the subbase for a unifor-
Subbase
mity on X, provided the following conditions hold:
1.   S for each S 2 s.
2. Given U 2 s, there exists V 2 s such that V  U 1.
3. For each U 2 s, there exists V 2 s such that V ı V  U .
Proof We have to show that
b WD fU1 \ : : : \ Un j U1; : : : ; Un 2 s for some n 2 Ng
constitutes a base for a uniformity. It is clear that every element of
b contains the diagonal.
Let U D Tn
iD1 Ui 2 b with Ui 2 s for
i D 1; : : : ; n, choose Vi 2 s with Vi  U 1
i
for all i, then V WD
Tn
iD1 Vi 2 b and V  U 1. If we select Wi 2 s with Wi ı Wi  Ui,
then W WD Tn
iD1 Wi 2 b and W ı W  U . The last condition of
Proposition 3.6.48 is trivially satisﬁed for b, since b is closed under ﬁ-
nite intersections. Thus we conclude that b is a base for a uniformity
on X by Proposition 3.6.48, which in turn entails that s is a subbase.
a
The Topology Generated by a Uniformity
A pseudometric space .X; d/ generates a topology by declaring a set G
open iff there exists for x 2 G some r > 0 with B.x; r/  G; from this

3.6. A GALLERY OF SPACES AND TECHNIQUES
403
we obtain the neighborhood ﬁlter U.x/ for a point x. Note that in the
uniformity associated with the pseudometric, the identity
B.x; r/ D VrŒx
holds. Encouraged by this, we approach the topology for a uniform
space in the same way. Given a uniform space .X; u/, a subset G 
X is called open iff we can ﬁnd for each x 2 G some neighborhood
U 2 u such that U Œx  G. The following proposition investigates this
construction.
Proposition 3.6.51 Given a uniform space .X; u/, for each x 2 X, the
From u to u
family
uŒx WD fU Œx j U 2 ug
is the base for the neighborhood ﬁlter of x for a topology u, which is
called the uniform topology. The neighborhoods for x in u are just
uŒx.
Proof It follows from Proposition 3.1.22 that uŒx deﬁnes a topology u;
it remains to show that the neighborhoods of this topology are just uŒx.
We have to show that U 2 u there exists V 2 u with V Œx  U Œx
and V Œx 2 uŒy for all y 2 V Œx, then the assertion will follow from
Corollary 3.1.23. For U 2 u, there exists V 2 u with V ı V  U ; thus
hx; yi 2 V and hy; ´i 2 V imply hx; ´i 2 U . Now let y 2 V Œx and
´ 2 V Œy; thus ´ 2 U Œx, but this means U Œx 2 uŒy for all x 2 V Œy.
Hence the assertion follows. a
Here are some illustrative example. They indicate also that different
uniformities can generate the same topology.
Example 3.6.52
1. The topology obtained from the additive unifor-
mity on R is the usual topology. The same holds for the multi-
plicative uniformity on R n f0g.
2. The topology induced by the discrete uniformity is the discrete
topology, in which each singleton fxg is open. Since
˚
fxg; X n
fxg

forms a ﬁnite partition of X, the discrete topology is induced
also by the uniformity deﬁned by the ﬁnite partitions.
3. Let F.A; R/ be endowed with the uniformity deﬁned by the sets
fhf; gi 2 F.A; R/ j supa2A jf .a/  g.a/j < g; see Exam-
ple 3.6.49.
The corresponding topology yields for each f
2

404
CHAPTER 3. TOPOLOGICAL SPACES
F.A; R/ the neighborhood fg 2 F.A; R/ j supa2A jf .a/  g.a/j
< g. This is the topology of uniform convergence.
4. Let up for a prime p be the p-adic uniformity on Z; see Exam-
ple 3.6.49, part 6. The corresponding topology p is called the
p-adic topology. A basis for the neighborhoods of 0 is given by
the sets Vk WD fx 2 Z j pk divides xg. Because pm 2 Vk for
m  k, we see that limn!1 pn D 0 in p, but not in q for
q 6D p, q prime. Thus the topologies p and q differ, hence also
the uniformities up and uq.
✌
Now that we know that each uniformity yields a topology on the same
space, some questions are immediate:
 Do the open resp. the closed sets play a particular role in describ-
ing the uniformity?
 Does the topology have particular properties, e.g., in terms of sep-
aration axioms?
 What about metric spaces—can we determine from the uniformity
that the topology is metrizable?
 Can we ﬁnd a pseudometric for a given uniformity?
 Is the product topology on X  X somehow related to u, which is
deﬁned on X  X, after all?
We will give answers to some of these questions; some will be treated
only lightly, with an in depth treatment to be found in the ample litera-
ture on uniform spaces; see the Bibliographic Notes in Sect. 3.7.
Fix a uniform space X with uniformity u and associated topology .
References to neighborhoods and open sets are always to u resp. ,
unless otherwise stated.
This is a ﬁrst characterization of the interior of an arbitrary set. Recall
that in a pseudometric space x is an interior point of A iff B.x; r/ 
A for some r > 0; the same description applies here as well, mu-
tatis mutandis (of course, this “mutatis mutandis” part is the interesting
one).
Lemma 3.6.53 Given A  X, x 2 Ao iff there exists a neighborhood
U with U Œx  A.

3.6. A GALLERY OF SPACES AND TECHNIQUES
405
Proof Assume that x 2 Ao D SfG j G open and G  Ag; then it
follows from the deﬁnition of an open set that we must be able to ﬁnd
an neighborhood U with U Œx  A.
Conversely, we show that the set B WD fx 2 X j U Œx  A for some
neighborhood U g is open, then this must be the largest open set which
is contained in A, hence B D Ao. Let x 2 B, thus U Œx  A, and we
should ﬁnd now a neighborhood V such that V Œy  B for y 2 V Œx.
But we ﬁnd a neighborhood V with V ı V  U . Let us see whether
V is suitable: if y 2 V Œx, then V Œy  .V ı V /Œx (this is so because
hx; yi 2 V , and if ´ 2 V Œy, then hy; ´i 2 V ; this implies hx; ´i 2
V ıV , hence ´ 2 .V ıV /Œx). But this yields V Œy  U Œx  B, hence
y 2 B. This means V Œx  B, so that B is open. a
The observation above gives us a handy way of describing the base for
a neighborhood ﬁlter for a point in X. It states that we may restrict our
attention to the members of a base or of a subbase, when we want to
work with the neighborhood ﬁlter for a particular element.
Corollary 3.6.54 If u has base or subbase b, then fU Œx j U 2 bg is a
base resp. subbase for the neighborhood ﬁlter for x.
Proof This follows immediately from Lemma 3.6.53 together with
Proposition 3.6.48 resp. Lemma 3.6.50 a
Let us have a look at the topology on X  X induced by . Since the
open rectangles generate this topology, and since we can describe the
open rectangles in terms of the sets U ŒxV Œy, we can expect that these
open sets can also be related to the uniformity proper. In fact:
Proposition 3.6.55 If U 2 u; then both U o 2 u and U a 2 u.
Proof 1. Let G  X  X be open, then hx; yi 2 G iff there exist
neighborhoods U; V 2 u with U ŒxV Œy  G, and because U \V 2 u,
we may even ﬁnd some W 2 u such that W ŒxW Œy  G. Thus
G D
[
fW Œx  W Œy j hx; yi 2 G; W 2 ug:
2. Let W 2 u; then there exists a symmetric V 2 u with V ıV ıV  W ,
and by the identities in Fig. 3.1, we may write
V ı V ı V D
[
hx;yi2V
V Œx  V Œy:

406
CHAPTER 3. TOPOLOGICAL SPACES
Hence hx; yi 2 W o for every hx; yi 2 V , so V  W o, and since V 2 u,
we conclude W o 2 u from u being upper closed.
3. Because u is a ﬁlter, and U  U a, we infer U a 2 u. a
The closure of a subset of X and the closure of a subset of X  X
may be described as well directly through uniformity u. These are truly
remarkable representations.
Proposition 3.6.56 Aa D TfU ŒA j U 2 ug for A  X, and M a D
TfU ı M ı U j U 2 ug for M  X  X.
Proof 1. We use the characterization of a point x in the closure through
its neighborhood ﬁlter from Lemma 1.5.52: x 2 Aa iff U Œx \ A 6D ;
for all symmetric U 2 u, because the symmetric neighborhoods form a
base for u. Now ´ 2 U Œx \ A iff ´ 2 A and hx; ´i 2 U iff ´ 2 U Œ´
and ´ 2 A, hence U Œx \ A 6D ; iff x 2 U ŒA, because U is symmetric.
But this means Aa D TfU ŒA j U 2 ug.
2. Let hx; yi 2 M a, then U Œx  U Œy \ M 6D ; for all symmetric
neighborhoods U 2 u, so that hx; yi 2 U ı M ı U for all symmetric
neighborhoods. This accounts for the inclusion from left to right. If
hx; yi 2 U ıM ıU for all neighborhoods U , then for every U 2 u there
exists ha; bi 2 M with ha; bi 2 U Œx  .U 1/Œy, thus hx; yi 2 M a.
a
Hence
Corollary 3.6.57 The closed symmetric neighborhoods form a base for
the uniformity.
Proof Let U 2 u, then there exists a symmetric V 2 u with V ıV ıV 
U with V  V a  V ı V ı V by Proposition 3.3.1. Hence W WD
V a \ .V a/1/ is a member of u which is contained in U . a
Proposition 3.6.56 has also an interesting consequence when looking at
the characterization of Hausdorff spaces in Proposition 3.3.1. Putting
M D , we obtain a D TfU ı U j U 2 ug, so that the associated
topological space is Hausdorff iff the intersection of all neighborhoods
is the diagonal . Uniform spaces with T u D  are called sepa-
rated.
Separated
space

3.6. A GALLERY OF SPACES AND TECHNIQUES
407
Pseudometrization
We will see shortly that the topology for a separated uniform space is
completely regular. First, however, we will show that we can generate
pseudometrics from the uniformity by the following idea: suppose that
we have a neighborhood V , then there exists a neighborhood V2 with
V2 ı V2 ı V2  V1 WD V ; continuing in this fashion, we ﬁnd for the
neighborhood Vn a neighborhood VnC1 with VnC1ıVnC1 ıVnC1  Vn,
and ﬁnally put V0 WD X X. Given a pair hx; yi 2 X X, this sequence
.Vn/n2N is now used as a witness to determine how far apart these points
are: put fV .x; y/ WD 2n, iff hx; yi 2 Vn n Vn1, and dV .x; y/ WD 0
iff hx; yi 2 T
n2N Vn. Then fV will give rise to a pseudometric dV , the
dV
pseudometric associated with V , as we will show below.
This means that many pseudometric spaces are hidden deep inside a
uniform space! Moreover, if we need a pseudometric, we construct one
from a neighborhood. These observations will turn out to be fairly prac-
tical later on. But before we are in a position to make use of them, we
have to do some work.
Proposition 3.6.58 Assume that .Vn/n2N is a sequence of symmetric
subsets of X  X with these properties for all n 2 N:
   Vn,
 VnC1 ı VnC1 ı VnC1  Vn.
Put V0 WD X  X. Then there exists a pseudometric d with
Vn  fhx; yi j d.x; y/ < 2ng  Vn1
for all n 2 N.
Proof 0. The proof uses the idea outlined above. The main effort will
be showing that we can squeeze fhx; yi j d.x; y/ < 2ng between Vn
and Vn1.
1. Put f .x; y/ WD 2n iff hx; yi 2 Vn n Vn1, and let f .x; y/ WD 0 iff
hx; yi 2 T
n2N Vn. Then f .x; x/ D 0, and f .x; y/ D f .y; x/, because
each Vn is symmetric. Deﬁne
d.x; y/ WD inf
˚ k
X
iD0
f .xi; xiC1/ j x0; : : : ; xkC1 2 X with
x0 D x; xkC1 D y; k 2 N


408
CHAPTER 3. TOPOLOGICAL SPACES
So we look at all paths leading from x to y, sum the weight of all their
edges, and look at their smallest value. Since we may concatenate a
path from x to y with a path from y to ´ to obtain one from x to ´, the
triangle inequality holds for d, and since d.x; y/  f .x; y/, we know
that Vn  fhx; yi j d.x; y/ < 2ng. The latter set is contained in Vn1;
to show this is a bit tricky and requires an intermediary step.
2. We show by induction on n that
f .x0; xnC1/  2 
n
X
iD0
f .xi; xiC1/;
so if we have a path of length n, then the weight of the edge connect-
ing their endpoints cannot be greater than twice the weight on an ar-
bitrary path. If n D 1, there is nothing to show. So assume the as-
sertion is proved for all path with less that n edges. We take a path
from x0 to xnC1 with n edges hxi; xiC1i.
Let w be the weight of
the path from x0 to xnC1, and let k be the largest integer such that
the path from x0 to xk is at most w=2.
Then the path from xkC1
to xnC1 has a weight at most w=2 as well.
Now f .x0; xk/  w
and f .xkC1; xnC1/  w by induction hypothesis, and f .xk; xkC1/ 
w. Let m 2 N the smallest integer with 2m  w, then we have
hx0; xki; hxk; xkC1i; hxkC1; xnC1i 2 Vm, thus hx0; xnC1i 2 Vm1.
This
implies
f .x0; xnC1/

2.m1/  2  w D 2  Pn
iD0 f .xi; xiC1/.
3. Now let d.x; y/ < 2n, then f .x; y/  2.n1/ by part 2., and
hence hx; yi 2 Vn1. a
This has a—somewhat unexpected—consequence because it permits
characterizing those uniformities, which are generated by a pseudomet-
ric.
Proposition 3.6.59 The uniformity u of X is generated by a pseudomet-
ric iff u has a countable base.
Proof Let u be generated by a pseudometric d, then the sets fVd;r j 0 <
r 2 Qg are a countable basis. Let, conversely, b WD fUn j n 2 Ng be a
countable base for u. Put V0 WD X  X and V1 WD U1, and construct
inductively the sequence .Vn/n2N  b of symmetric base elements with
Vn ı Vn ı Vn  Vn1 and Vn  Un for n 2 N. Then fVn j n 2 Ng is
a base for u. In fact, given U 2 u, there exists Un 2 b with Un  U ,

3.6. A GALLERY OF SPACES AND TECHNIQUES
409
hence Vn  U as well. Construct d for this sequence as above, then we
have Vn  fhx; yi j d.x; y/ < 2ng  Vn1. Thus the sets Vd;r are a
base for the uniformity. a
Note that this does not translate into an observation of the metrizability
of the underlying topological space. This space may carry a metric, but
the uniform space from which it is derived does not.
Example 3.6.60 Let X be an uncountable set, and let u be the unifor-
mity given by the ﬁnite partitions; see Example 3.6.49. Then we have
seen in Example 3.6.52 that the topology induced by u on X is the dis-
crete topology, which is metrizable.
Assume that u is generated by a pseudometric, then Proposition 3.6.59
implies that u has a countable base; thus given a ﬁnite partition , there
exists a ﬁnite partition  such that V  V, and V is an element of
this base. Here VfP1;:::;Png WD Sn
iD1.Pi Pi/ is the basic neighborhood
for u associated with partition fP1; : : : ; Png. But for any given partition
 we can only form a ﬁnite number of other partitions  with V 
V, so that we have only a countable number of partitions on X. ✌
This is another consequence of Proposition 3.6.58: each uniform space
satisﬁes the separation axiom T3 1
2 . For establishing this claim, we take
a closed set F  X and a point x0 62 F , then we have to produce a
continuous function f W X ! Œ0; 1 with f .x0/ D 0 and f .y/ D 1 for
y 2 A. This is how to do it. Since XnF is open, we ﬁnd a neighborhood
U 2 u with U Œx0  X n F . Let dU be the pseudometric associated
with U , then fhx; yi j dU .x; y/ < 1=2g  U . Clearly, x 7! dU .x; x0/
is a continuous function on X; hence
f .x/ WD maxf0; 1  2  dU .x; x0/g
is continuous with f .x0/ D 1 and f .y/ D 0 for y 2 F , and thus f has
the required properties. Thus we have shown
Proposition 3.6.61 A uniform space is a T3 1
2-space; a separated uni-
form space is completely regular. a
Cauchy Filters
We generalize the notion of a Cauchy sequence to uniform spaces now.
We do this in order to obtain a notion of convergence which includes

410
CHAPTER 3. TOPOLOGICAL SPACES
convergence in topological spaces and which carries the salient features
of a Cauchy sequence with it.
First, we note that ﬁlters are a generalization for sequences. So let us
have a look at what can be said, when we construct the ﬁlter F for a
Cauchy sequence .xn/n2N in a pseudometric space .X; d/. F has the
sets c WD fBn j n 2 Ng with Bn WD fxm j m  ng as a base. Being
a Cauchy ﬁlter says that for each  > 0, there exists n 2 N such that
Bn  Bn  Vd;; this inclusion holds then for all Bm with m  n as
well. Because c is the base for F, and the sets Vd;r are a base for the uni-
formity, we may reformulate that F is a Cauchy ﬁlter iff for each neigh-
borhood U there exists B 2 F such that BB  U . Now this looks like
a property which may be formulated for general uniform spaces.
Fix the uniform space .X; u/. Given U 2 u, the set M  X is called
U -small iff M  M  U . A collection F of sets is said to contain
Small sets
small sets iff given U 2 u there exists A 2 F which is U -small, or,
equivalently, given U 2 u there exists x 2 X with A  U Œx.
This helps in formulating the notion of a Cauchy ﬁlter.
Deﬁnition 3.6.62 A ﬁlter F is called a Cauchy ﬁlter iff it contains small
sets.
In this sense, a Cauchy sequence induces a Cauchy ﬁlter. Convergent
ﬁlters are Cauchy ﬁlters as well:
Lemma 3.6.63 If F ! x for some x 2 X, then F is a Cauchy ﬁlter.
Proof Let U 2 u, then there exists a symmetric V 2 u with V ıV  U .
Because U.x/  F, we conclude V Œx 2 F, and V Œx  V Œx  U ; thus
V Œx is a U -small member of F. a
But the converse does not hold, as the following example shows.
Example 3.6.64 Let u be the uniformity induced by the ﬁnite partitions
with X inﬁnite. We claim that each ultraﬁlter F is a Cauchy ﬁlter. In
fact, let  D fA1; : : : ; Ang be a ﬁnite partition, then V D Sn
iD1 Ai 
Ai is the corresponding neighborhood, then there exists i with Ai 2
F. This is so since, if an ultraﬁlter contains the ﬁnite union of sets, it
must contain one of them. Ai is V -small.
The topology induced by this uniformity is the discrete topology; see
Example 3.6.52. This topology is not compact, since X is inﬁnite. By
Theorem 3.2.11, there are ultraﬁlters which do not converge. ✌

3.6. A GALLERY OF SPACES AND TECHNIQUES
411
If x is an accumulation point of a Cauchy sequence in a pseudometric
space, then we know that xn ! x; this is fairly easy to show. A similar
observation can be made for Cauchy ﬁlters, so that we have a partial
converse to Lemma 3.6.63.
Lemma 3.6.65 Let x be an accumulation point of the Cauchy ﬁlter F,
then F ! x.
Proof Let V 2 u be a closed neighborhood; in view of Corollary 3.6.57
is sufﬁcient to show that V Œx 2 F; then it will follow that U.x/  F.
Because F is a Cauchy ﬁlter, we ﬁnd F 2 F with F  F  V , and be-
cause V is closed, we may assume that F is closed as well (otherwise,
we replace it by its closure). Because F is closed and x is an accu-
mulation point of F, we know from Lemma 3.2.14 that x 2 F ; hence
F  V Œx. This implies U.x/  F. a
Deﬁnition 3.6.66 The uniform space .X; u/ is called complete iff each
Cauchy ﬁlter converges.
Each Cauchy sequence converges in a complete uniform space, because
the associated ﬁlter is a Cauchy ﬁlter.
A slight reformulation is given in the following proposition, which is
the uniform counterpart to the characterization of complete pseudomet-
ric spaces in Proposition 3.5.25. Recall that a collection of sets is said
to have the ﬁnite intersection property iff each ﬁnite subfamily has a
nonempty intersection.
Proposition 3.6.67 The uniform space .X; u/ is complete iff each fam-
ily of closed sets which has the ﬁnite intersection property and which
contains small sets has a non-void intersection.
Proof This is essentially a reformulation of the deﬁnition, but let us
see.
1. Assume that .X; u/ is complete, and let A be a family of closed sets
with the ﬁnite intersection property, which contains small sets. Hence
F0 WD fF1 \ : : : \ Fn j n 2 N; F1; : : : ; Fn 2 Ag is a ﬁlter base. Let
F be the corresponding ﬁlter, then F is a Cauchy ﬁlter, for A; hence
F0 contains small sets. Thus F ! x, so that U.x/  F; thus x 2
T
F 2F F a  T
A2A A.
2. Conversely, let F be a Cauchy ﬁlter. Since fF a j F 2 Fg is a family
of closed sets with the ﬁnite intersection property which contains small

412
CHAPTER 3. TOPOLOGICAL SPACES
sets, the assumption says that T
F 2F F a is not empty and contains some
x. But then x is an accumulation point of F by Lemma 3.2.14, so F ! x
by Lemma 3.6.65. a
As in the case of pseudometric spaces, compact spaces are derived from
a complete uniformity.
Lemma 3.6.68 Let .X; u/ be a uniform space so that the topology as-
sociated with the uniformity is compact. Then the uniform space .X; u/
is complete.
Proof In fact, let F be a Cauchy ﬁlter on X. Since the topology for X
is compact, the ﬁlter has an accumulation point x by Corollary 3.2.15.
But Lemma 3.6.65 tells us then that F ! x. Hence each Cauchy ﬁlter
converges. a
The uniform space which is derived from an ideal on the powerset of
a set, which has been deﬁned in Example 3.6.49 (part 5) is complete.
We establish this ﬁrst for Cauchy nets as the natural generalization of
Cauchy sequences and then translate the proof to Cauchy ﬁlters. This
will permit an instructive comparison of the handling of these two con-
cepts.
Example 3.6.69 Recall the deﬁnition of a net on page 301.
A net
.xi/i2N in the uniform space X is called a Cauchy net iff, given a
Cauchy net
neighborhood U 2 u, there exists i 2 N such that hxj; xki 2 U for
all j; k 2 N with j; k  i. The net converges to x iff given a neighbor-
hood U , there exists i 2 N such that hxj; xi 2 U for j  i.
Now assume that I  P .X/ is an ideal; part 5 of Example 3.6.49
deﬁnes a uniformity uI on P .X/ which has the sets VI WD fhA; Bi j
A; B 2 P .X/ ; AB  Ig as a base, as I runs through I. We claim
that each Cauchy net .Fi/i2N converges to F WD S
i2N
T
ji Fj .
In fact, let a neighborhood U be given; we may assume that U D VI
for some ideal I 2 I. Thus there exists i 2 N such that hFj ; Fki 2 VI
for all j; k  i; hence Fj Fk  I for all these j; k. Let x 2 FFj
for j  i.
 If x 2 F , we ﬁnd i0 2 N such that x 2 Fk for all k  i0. Fix
k 2 N so that k  i and k  i0, which is possible since N is
directed. Then x 2 FkFj  I:

3.6. A GALLERY OF SPACES AND TECHNIQUES
413
 If x 62 F , we ﬁnd for each i0 2 N some k  i0 with x 62 Fk.
Pick k  i0, then x 62 Fk; hence x 2 FFj  I
Thus hF; Fj i 2 VI for j  i, and hence the net converges to F . ✌
Now let us investigate convergence of a Cauchy ﬁlter. One obvious
obstacle in a direct translation seems to be the deﬁnition of the limit,
because this appears to be bound to the net’s indices. But look at this. If
.xi/i2N is a net, then the sets Bi WD fxj j j  ig form a ﬁlter base B,
as i runs through the directed set N (see the discussion on page 301).
Thus we have deﬁned F in terms of this base, viz., F D S
B2B
T B.
This gives an idea for the ﬁlter-based case.
Example 3.6.70 Let uI be the uniformity on P .X/ discussed in Exam-
ple 3.6.69. Then each Cauchy ﬁlter F converges. In fact, let B be a base
for F, then F ! F with F WD S
B2B
T B.
Let U be a neighborhood in uI, and we may assume that U D VI for
some I 2 I. Since F is a Cauchy ﬁlter, we ﬁnd F 2 F which is VI-
small; hence FF 0  I for all F; F 0 2 F. Let F0 2 F, and consider
x 2 FF0; we show that x 2 I by distinguishing these cases:
 If x 2 F , then there exists B 2 B such that x 2 T B. Because B
is an element of base B, and because F is a ﬁlter, B \ F 6D ;, so
we ﬁnd G 2 B with G 2 F, in particular x 2 G. Consequently
x 2 GF0  I, since F is VI-small.
 If x 62 F , we ﬁnd for each B 2 B some G 2 B with x 62 G.
Since B is a base for F, there exists B 2 B with B  F, so there
exists G 2 F with x 62 G. Hence x 2 GF0  I.
Thus FF0  I, and hence hF; F0i 2 VI. This means F  VIŒF ,
which in turn implies U.F /  F, or, equivalently, F ! F . ✌
For further investigations of uniform spaces, we deﬁne uniform continu-
ity as the brand of continuity which is adapted to uniform spaces.
Uniform Continuity
Let f W X ! X0 be a uniformly continuous map between the pseudo-
metric spaces .X; d/ and .X0; d 0/. This means that given  > 0, there
exists ı > 0 such that, whenever d.x; y/ < ı, d 0.f .x/; f .y// <  fol-
lows. In terms of neighborhoods, this means Vd;ı  .f  f /1
Vd 0;

,

414
CHAPTER 3. TOPOLOGICAL SPACES
or, equivalently, that .f  f /1
V

is a neighborhood in X, whenever
V is a neighborhood in X0. We use this formulation, which is based
only on neighborhoods, and not on pseudometrics, for a formulation of
uniform continuity.
Deﬁnition 3.6.71 Let .X; u/ and .Y; v/ be uniform spaces. Then f W
X ! Y is called uniformly continuous iff .f  f /1
V

2 u for all
V 2 v.
Proposition 3.6.72 Uniform spaces form a category with uniform con-
tinuous maps as morphisms.
Proof The identity is uniformly continuous, and, since .g  g/ ı .f 
f / D .g ı f /.g ı f /, the composition of uniformly continuous maps
is uniformly continuous again. a
We want to know what happens in the underlying topological space.
But here nothing unexpected will happen: a uniformly continuous map
is continuous with respect to the underlying topologies, formally:
Proposition 3.6.73 If f W .X; u/ ! .Y; v/ is uniformly continuous,
then f W .X; u/ ! .Y; v/ is continuous.
Proof Let H  Y be open with f .x/ 2 H. If x 2 f 1
H

, there
exists a neighborhood V 2 v such that V Œf .x/  H. Since U WD
.f  f /1
V

is a neighborhood in X, and U Œx  f 1
H

, it fol-
lows that f 1
H

is open in X. a
The converse is not true, however, as Example 3.5.35 shows.
Before proceeding, we brieﬂy discuss two uniformities on the same
topological group which display quite different behaviors, so that the
identity is not uniformly continuous.
Example 3.6.74 Let X WD ffa;b j a; b 2 R; a 6D 0g be the set of all
afﬁne maps fa;b W R ! R with the separated uniformities uR and uL,
as discussed in Example 3.6.49, part 8.
Let an WD dn WD 1=n, bn WD 1=n and cn WD n. Put gn WD fan;bn
and hn WD fcn;dn, jn WD h1
n . Now gn ı hn D f1;1=n21=n ! f1;0,
hn ı gn D f1;1C1=n ! f1;1. Now assume that uR D uL. Given
U 2 U.e/, there exists V 2 U.e/ symmetric such that V R  U L. Since
gn ı hn ! f1;0, there exists for V some n0 such that gn ı hn 2 V
for n  n0; hence hgn; jni 2 V R, thus hjn; gni 2 V R  U L, which

3.6. A GALLERY OF SPACES AND TECHNIQUES
415
means that hn ı gn 2 U for n  n0. Since U 2 U.e/ is arbitrary, this
means that hn ı gn ! e, which is a contradiction.
Thus we ﬁnd that the left and the right uniformity on a topological group
are different, although they are derived from the same topology. In par-
ticular, the identity .X; uR/ ! .X; uL/ is not uniformly continuous.
✌
We will construct the initial uniformity for a family of maps now. The
approach is similar to the one observed for the initial topology (see Def-
inition 3.1.14), but since a uniformity is in particular a ﬁlter with certain
properties, we have to make sure that the construction can be carried
out as intended. Let F be a family of functions f W X ! Yf , where
.Yf ; vf / is a uniform space. We want to construct a uniformity u on X
rendering all f uniformly continuous, so u should contain
s WD
[
f 2F
f.f  f /1
V

j V 2 vf g;
and it should be the smallest uniformity on X with this property. For
this to work, it is necessary for s to be a subbase. We check this along
the properties from Lemma 3.6.50:
1. Let f
2 F and V
2 vf , then Yf
 V .
Since X D
f 1
Yf

, we conclude X  .f  f /1
V

. Thus each ele-
ment of s contains the diagonal of X.
2. Because

.f  f /1
V
1D .f  f /1
V 1
, we ﬁnd that,
given U 2 s, there exists V 2 s with V  U 1.
3. Let U 2 b, so that U D .f  f /1
V

for some f 2 F and
V 2 vf . We ﬁnd W 2 vf with W ı W  V ; put W0 WD
.f  f /1
W

, then W0 ı W0
 .f  f /1
W ı W


.f  f /1
V

D U , so that we ﬁnd for U 2 s an element
W0 2 s with W0 ı W0  U .
Thus s is the subbase for a uniformity on X, and we have established
Proposition 3.6.75 Let F be a family of maps X ! Yf with .Yf ; vf /
a uniform space, then there exists a smallest uniformity uF on X render-
ing all f 2 F uniformly continuous. uF is called the initial uniformity
on X with respect to F.
Proof We know that s WD S
f 2Ff.f  f /1
V

j V 2 vf g is a sub-
base for a uniformity u, which is evidently the smallest uniformity so

416
CHAPTER 3. TOPOLOGICAL SPACES
that each f 2 F is uniformly continuous. So uf WD u is the uniformity
we are looking for. a
Having this tool at our disposal, we can now—in the same way as we
did with topologies—deﬁne
Product The product uniformity for the uniform spaces .Xi; ui/i2I is
Product
the initial uniformity on X WD Q
i2I Xi with respect to the pro-
jections i W X ! Xi.
Subspace The subspace uniformity uA is the initial uniformity on A 
Subspace
X with respect to the embedding iA W x 7! x.
We can construct dually a ﬁnal uniformity on Y with respect to a family
F of maps f W Xf ! Y with uniform spaces .Xf ; uf /, for example,
when investigating quotients. The reader is referred to [Bou89, II.2] or
to [Eng89, 8.2].
The following is a little ﬁnger exercise for the use of a product unifor-
mity. It takes a pseudometric and shows what you would expect: the
pseudometric is uniformly continuous iff it generates neighborhoods.
The converse holds as well. We do not assume here that d generates
u, rather, it is just an arbitrary pseudometric, of which there may be
many.
Proposition 3.6.76 Let .X; u/ be a uniform space, d W X  X ! RC
a pseudometric. Then d is uniformly continuous with respect to the
product uniformity on X  X iff Vd;r 2 u for all r > 0.
Proof 1. Assume ﬁrst that d is uniformly continuous; thus we ﬁnd for
each r > 0 some neighborhood W on X X such that
˝
hx; ui; hy; vi
˛
2
W implies jd.x; y/  d.u; v/j < r. We ﬁnd a symmetric neighborhood
U
on
X
such
that
U1 \ U2

W ,
where
Ui
WD
.i  i/1
U

for i D 1; 2, and
U1 D f
˝
hx; ui; hy; vi
˛
j hx; yi 2 U g;
U2 D f
˝
hx; ui; hy; vi
˛
j hu; vi 2 U g:
Thus if hx; yi 2 U , we have
˝
hx; yi; hy; yi
˛
2 W ; hence d.x; y/
< r, so that U  Vd;r, and thus Vd;r 2 u.

3.6. A GALLERY OF SPACES AND TECHNIQUES
417
2. Assume that Vd;r 2 u for all r > 0, and we want to show that d is uni-
formly continuous in the product. If hx; ui; hy; vi 2 Vd;r, then
d.x; y/  d.x; u/ C d.u; v/ C d.v; y/
d.u; v/  d.x; u/ C d.x; y/ C d.y; v/;
hence jd.x; y/  d.u; v/j
<
2  r.
Thus .1  1/1
Vd;r

\
.2  2/1
Vd;r

is a neighborhood on X  X such that
˝
hx; ui;
hy; vi
˛
2 W implies jd.x; y/  d.u; v/j < 2  r. a
Combining Proposition 3.6.58 with the observation from Proposition
3.6.76, we have established this characterization of a uniformity through
pseudometrics.
Proposition 3.6.77 The uniformity u is the smallest uniformity which
is generated by all pseudometrics which are uniformly continuous on
X  X, i.e., u is the smallest uniformity containing Vd;r for all such d
and all r > 0. a
We ﬁx for the rest of this section the uniform spaces .X; u/ and .Y; v/.
Note that for checking uniform continuity it is enough to look at a sub-
base. The proof is straightforward and hence omitted.
Lemma 3.6.78 Let f W X ! Y be a map. Then f is uniformly contin-
uous iff .f  f /1
V

2 u for all elements of a subbase for v. a
Cauchy ﬁlters are preserved through uniformly continuous maps (the
image of a ﬁlter is deﬁned on page 303).
Proposition 3.6.79 Let f W X ! Y be uniformly continuous and F a
Cauchy ﬁlter on X. Then f .F/ is a Cauchy ﬁlter.
Proof Let V 2 v be a neighborhood in Y , then U WD .f  f /1
V

is a neighborhood in X, so that there exists F 2 F which is U -small;
hence F  F  U , and hence .f  f /

F  F

D f

F

 f

F

 V .
Since f

F

2 f .F/ by Lemma 3.2.5, the image ﬁlter contains a V -
small member. a
A ﬁrst consequence of Proposition 3.6.79 shows that the subspaces in-
duced by closed sets in a complete uniform space are complete again.
Proposition 3.6.80 If X is separated, then a complete subspace is
closed. Let A  X be closed and X be complete, then the subspace
A is complete.

418
CHAPTER 3. TOPOLOGICAL SPACES
Note that the ﬁrst part does not assume that X is complete and that the
second part does not assume that X is separated.
Proof 1. Assume that X is a Hausdorff space and A a complete subspace
of X. We show @A  A, from which it will follow that A is closed. Let
b 2 @A, then U \ A 6D ; for all open neighborhoods U of b. The
trace U.b/ \ A of the neighborhood ﬁlter U.b/ on A is a Cauchy ﬁlter.
In fact, if W 2 u is a neighborhood for X, which we may choose as
symmetric, then

.W Œb \ A/  .W Œb \ A/

 W \ .A  A/, which
means that W Œb \ A is W \ .A  A/- small. Thus U.b/ \ A is a
Cauchy ﬁlter on A, hence it converges to, say, c 2 A. Thus U.c/ \
A  U.b/ 2 A, which means that b D c, since X, and hence A, is
Hausdorff as a topological space. Thus b 2 A, and A is closed by
Proposition 3.2.4.
2. Now assume that A  X is closed, and that X is complete. Let F
be a Cauchy ﬁlter on A, then iA.F/ is a Cauchy ﬁlter on X by Proposi-
tion 3.6.79. Thus iA.F/ ! x for some x 2 X, and since A is closed,
x 2 A follows. a
We show that a uniformly continuous map on a dense subset into a
complete and separated uniform space can be extended uniquely to a
uniformly continuous map on the whole space. This was established
in Proposition 3.5.37 for pseudometric spaces; having a look at the
proof displays the heavy use of pseudometric machinery such as the
oscillation and the pseudometric itself.
This is not available in the
present situation, so we have to restrict ourselves to the tools at our
disposal, viz., neighborhoods and ﬁlters, in particular Cauchy ﬁlters
for a complete space.
We follow Kelley’s elegant proof [Kel55, p.
195].
Theorem 3.6.81 Let A  X be a dense subsets of the uniform space
.X; u/, and .Y; v/ be a complete and separated uniform space. Then a
uniformly continuous map f W A ! Y can be extended uniquely to a
uniformly continuous ' W X ! Y .
Proof 0. The proof starts from the graph fha; f .a/i j a 2 Ag of f
and investigates the properties of its closure in X  Y . It is shown that
Plan of the
proof
the closure is a relation which has Aa D X as its domain, and which
is the graph of a map, since the topology of Y is Hausdorff. This map
is an extension ' to f , and it is shown that ' is uniformly continuous.
We also use the observation that the image of a converging ﬁlter under

3.6. A GALLERY OF SPACES AND TECHNIQUES
419
a uniform continuous map is a Cauchy ﬁlter, so that completeness of Y
kicks in when needed. We do not have to separately establish unique-
ness, because this follows directly from Lemma 3.3.20.
1. Let Gf WD graph.f / D fha; f .a/i j a 2 Ag be the graph of f . We
claim that the closure of the domain of f is the domain of the closure of
Gf . Let x be in the domain of the closure of Gf , then there exists y 2 Y
with hx; yi 2 Ga
f , thus we ﬁnd a ﬁlter F on Gf with F ! hx; yi. Thus
1.F/ ! x, so that x is in the closure of the domain of f . Conversely,
if x is in the closure of the domain of Gf , we ﬁnd a ﬁlter F on the
domain of Gf with F ! x. Since f is uniformly continuous, we know
that f .F/ generates a Cauchy ﬁlter G on Y , which converges to some
y. The product ﬁlter F  G converges to hx; yi (see Exercise 3.36), thus
x is in the domain of the closure of Gf .
2. Now let W 2 v; we show that there exists a neighborhood U 2 u with
this property: if hx; yi; hu; vi 2 Ga
f , then x 2 U Œu implies y 2 W Œv.
After having established this, we know
 Ga
f is the graph of a function '. This is so because Y is separated,
hence its topology is Hausdorff. For, assume there exists x 2
X some y1; y2 2 Y with y1 6D y2 and hx; y1i; hx; y2i 2 Ga
f .
Choose W 2 v with y2 62 W Œy1, and consider U as above.
Then x 2 U Œx, hence y2 2 W Œy1, contradicting the choice of
W .
 ' is uniformly continuous. The property above translates to ﬁnd-
ing for W 2 v a neighborhood U 2 u with U  .'  '/1
W

.
So we are done after having established the statement above.
3. Assume that W 2 v is given, and choose V 2 v closed and symmetric
with V ı V  W . This is possible by Corollary 3.6.57. There exists
U 2 u open and symmetric with f

U Œx

 V Œf .x/ for every x 2 A,
since f is uniformly continuous. If hx; yi; hu; vi 2 Ga
f and x 2 U Œu,
then U Œx \ U Œu is open (since U is open), and there exists a 2 A
with x; u 2 U Œa, since A is dense. We claim y 2

f

U Œa
a. Let H
be an open neighborhood of y, then, since U Œa is a neighborhood of x,
U ŒaH is a neighborhood of hx; yi; thus Gf \U ŒaH 6D ;. Hence
we ﬁnd y0 2 H with hx; y0i 2 Gf , which entails H \ f

U Œa

6D ;.
Similarly, ´ 2

f

U Œa
a; note

f

U Œa
a  V Œf .a/. But now

420
CHAPTER 3. TOPOLOGICAL SPACES
hy; vi 2 V ı V  W , hence y 2 W Œv. This establishes the claim
above, and ﬁnishes the proof. a
Let us just have a look at the idea lest it gets lost. If x 2 X, we ﬁnd a
ﬁlter F on A with iA.F/ ! x. Then f .ia.F// is a Cauchy ﬁlter; hence
it converges to some y 2 Y , which we deﬁne as F.x/. Then it has to be
shown that F is well deﬁned; it clearly extends f . It ﬁnally has to be
shown that F is uniformly continuous. So there is a lot technical ground
which to be covered.
We note on closing that also the completion of pseudometric spaces
can be translated into the realm of uniform spaces. Here, naturally, the
Cauchy ﬁlters deﬁned on the space play an important rˆole, and things
get very technical. The interplay between compactness and uniformities
yields interesting results as well; here the reader is referred to [Bou89,
Chap. II] or to [Jam87].
3.7
Bibliographic Notes
The towering references in this area are [Bou89, Eng89, Kur66, Kel55];
the author had the pleasure of taking a course on topology from one of
the authors of [Que01], so this text has been an important source, too.
The delightful Lecture Note [Her06] by Herrlich has a chapter “Dis-
asters without Choice” which discusses among others the relationship
of the axiom of choice and various topological constructions. The dis-
cussion of the game related to Baire’s Theorem in Sect. 3.5.2 in taken
from Oxtoby’s textbook [Oxt80, Sect. 6] on the duality between measure
and category (category in the topological sense introduced on page 358
above); he attributes the game to Banach and Mazur. Other instances
of proofs by games for metric spaces are given, e.g., in [Kec94, 8.H,
21]. The uniformity discussed in Example 3.6.70 has been considered
in [Dob89] in greater detail. The section on topological systems follows
fairly closely the textbook [Vic89] by Vickers, but see also [GHKC03,
AJ94], and for the discussion of dualities and the connection to intuition-
istic logics [Joh82, Gol06]. The discussion of G¨odel’s Completeness
Theorem in Sect. 3.6.1 is based on the original paper by Rasiowa and
Sikorski [RS50] together with occasional glimpses at [RS63], [CK90,
Chap. 2.1], [Sri08, Chap. 4] and [Kop89, Chap. 1.2]. Uniform spaces
are discussed in [Bou89, Eng89, Kel55, Que01]; special treatises

3.8. EXERCISES
421
include [Jam87] and [Isb64], the latter one emphasizing an early
categorical point of view. A survey on metric techniques in the theory
of computation can be found in [SH10].
3.8
Exercises
Exercise 3.1 Formulate and prove an analogue of Proposition 3.1.15
for the ﬁnal topology for a family of maps.
Exercise 3.2 The Euclidean topology on Rn is the same as the product
topology on Qn
iD1 R.
Exercise 3.3 Recall that the topological space .X; / is called discrete
iff  D P .X/. Show that the product Q
i2I.f0; 1g; P .f0; 1g// is dis-
crete iff the index set I is ﬁnite.
Exercise 3.4 Let L WD f.xn/n2Ng  RN j P
n2N jxnj < 1g be all
sequences of real numbers which are absolutely summable. 1 is deﬁned
as the trace of the product topology on Q
n2N R on L, 2 is deﬁned in the
following way: A set G is 2-open iff given x 2 G, there exists r > 0
such that fy 2 L j P
n2N jxn  ynj < rg  G: Investigate whether the
identity maps .L; 1/ ! .L; 2/ and .L; 2/ ! .L; 1/ are continuous.
Exercise 3.5 Deﬁne for x; y 2 R the equivalence relation x 
 y iff x 
y 2 Z: Show that R=
 is homeomorphic to the unit circle. Hint: Ex-
ample 3.1.19.
Exercise 3.6 Let A be a countable set. Show that a map q W .A *
B/ ! .C * D/ is continuous in the topology taken from Exam-
ple 3.1.5 iff it is continuous, when A * B as well as C * D are
equipped with the Scott topology.
Exercise 3.7 Let D24 be the set of all divisors of 24, including 1, and
deﬁne an order v on D24 through x v y iff x divides y. The topol-
ogy on D24 is given through the closure operator as in Example 3.1.20.
Write a Haskell program listing all closed subsets of D24 and deter-
mining all ﬁlters F with F ! 1. Hint: It is helpful to deﬁne a type Set
with appropriate operations ﬁrst, see [Dob12a, 4.2.2].
Exercise 3.8 Let X be a topological space, A  X, and iA W A ! X
the injection. Show that x 2 Aa iff there exists a ﬁlter F on A such that
iA.F/ ! x.

422
CHAPTER 3. TOPOLOGICAL SPACES
Exercise 3.9 Show by expanding Example 3.3.13 that R with its usual
topology is a T4-space.
Exercise 3.10 Given a continuous bijection f W X ! Y with the Haus-
dorff spaces X and Y , show that f is a homeomorphism, if X is com-
pact.
Exercise 3.11 Let A be a subspace of a topological space X.
1. If X is a T1; T2; T3; T3 1
2 space, so is A.
2. If A is closed, and X is a T4-space, then so is A.
Exercise 3.12 A function f W X ! R is called lower semicontinuous
iff for each c 2 R the set fx 2 X j f .x/ < cg is open. If fx 2
X j f .x/ > cg is open, then f is called upper semicontinuous. If X is
compact, then a lower semicontinuous map assumes on X its maximum,
and an upper semicontinuous map assumes its minimum.
Exercise 3.13 Let X WD Q
i2I Xi be the product of the Hausdorff space
.Xi/i2I. Show that X is locally compact in the product topology iff Xi
is locally compact for all i 2 I, and all but a ﬁnite number of Xi are
compact.
Exercise 3.14 Given x; y 2 R2, deﬁne
D.x; y/ WD
(
jx2  y2j;
if x1 D y1
jx2j C jy2j C jx1  y1j;
otherwise:
Show that this deﬁnes a metric on the plane R2. Draw the open ball
fy j D.y; 0/ < 1g of radius 1 with the origin as center.
Exercise 3.15 Let .X; d/ be a pseudometric space such that the induced
topology is T1. Then d is a metric.
Exercise 3.16 Let X and Y be two ﬁrst countable topological spaces.
Show that a map f W X ! Y is continuous iff xn ! x implies always
f .xn/ ! f .x/ for each sequence .xn/n2N in X.
Exercise 3.17 Consider the set C.Œ0; 1/ of all continuous functions on
the unit interval, and deﬁne
e.f; g/ WD
Z 1
0
jf .x/  g.x/j dx:

3.8. EXERCISES
423
Show that
1. e is a metric on C.Œ0; 1/.
2. C.Œ0; 1/ is not complete with this metric.
3. The metrics d on C.Œ0; 1/ from Example 3.5.2 and e are not
equivalent.
Exercise 3.18 Let .X; d/ be an ultrametric space, hence d.x; ´/ 
max fd.x; y/; d.y; ´/g (see Example 3.5.2). Show that
 If d.x; y/ 6D d.y; ´/, then d.x; ´/ D max fd.x; y/; d.y; ´/g.
 Any open ball B.x; r/ is both open and closed, and B.x; r/ D
B.y; r/, whenever y 2 B.x; r/.
 Any closed ball S.x; r/ is both open and closed, and S.x; r/ D
S.y; r/, whenever y 2 S.x; r/.
 Assume that B.x; r/ \ B.x0; r0/ 6D ;, then B.x; r/  B.x0; r0/
or B.x0; r0/  B.x; r/.
Exercise 3.19 Let .X; d/ be a metric space. Show that X is compact iff
each continuous real-valued function on X is bounded.
Exercise 3.20 Show that the set of all nowhere dense sets in a topo-
logical space X forms an ideal. Deﬁne a set A  X as open modulo
nowhere dense sets iff there exists an open set G such that the symmet-
ric difference AG is nowhere dense (hence both A n G and G n A are
nowhere dense). Show that the open sets modulo nowhere dense sets
form an -algebra.
Exercise 3.21 Consider the game formulated in Sect. 3.5.2; we use the
notation from there. Show that there exists a strategy that Angel can win
iff L1 \ B is of ﬁrst category for some interval L1  L0.
Exercise 3.22 Let u be the additive uniformity on R from Example
3.6.49. Show that fhx; yi j jx  yj < 1=.1 C jyj/g is not a member
of u.
Exercise 3.23 Show that V ı U ı V D S
hx;yi2U V Œx  V Œy for sym-
metric V  X  X and arbitrary U  X  X.

424
CHAPTER 3. TOPOLOGICAL SPACES
Exercise 3.24 Given a base b for a uniformity u, show that
b0 WD fB \ B1 j B 2 bg;
b00 WD fBn j B 2 bg
are also bases for u, when n 2 N (recall B1 WD B and BnC1 WD BıBn).
Exercise 3.25 Show that the uniformities on a set X form a complete
lattice with respect to inclusion. Characterize the initial and the ﬁnal
uniformity on X for a family of functions in terms of this lattice.
Exercise 3.26 If two subsets A and B in a uniform space .X; u/ are
V -small then A [ B is V ı V -small, if A \ B 6D ;.
Exercise 3.27 Show that a discrete uniform space is complete. Hint: A
Cauchy ﬁlter is an ultraﬁlter based on a point.
Exercise 3.28 Let F be a family of maps X ! Yf with uniform spaces
.Yf ; vf /. Show that the initial topology on X with respect to F is the
topology induced by the product uniformity.
Exercise 3.29 Equip the product X WD Q
i2I Xi with the product uni-
formity for the uniform spaces

.Xi; ui/

i2I, and let .Y; v/ be a uniform
space. A map f W Y ! X is uniformly continuous iff i ıf W Y ! Xi
is uniformly continuous for each i 2 I.
Exercise 3.30 Let X be a topological system. Show that the following
statements are equivalent
1. X is homeomorphic to SP.Y / for some topological system Y .
2. For all a; b 2 X] holds a D b, provided we have x ˆ a , x ˆ
b for all x 2 X[.
3. For all a; b 2 X] holds a  b, provided we have x ˆ a ) x ˆ b
for all x 2 X[.
Exercise 3.31 Let L be a dcpo with a smallest element ?, f W L ! L
a monotone map. Then f has a least ﬁxed point (i.e., there exists d with
x D f .x/, and if y D f .y/ for some y 2 L, then x  y. (Hint: Use
transﬁnite induction.)
Exercise 3.32 Show that a Hausdorff space is sober.

3.8. EXERCISES
425
Exercise 3.33 Let X and Y be compact topological spaces with their
Banach spaces C.X/ resp. C.Y / of real continuous maps. Let f W X !
Y be a continuous map, then
f  W
(
C.Y /
! C.X/
g
7! g ı f
deﬁnes a continuous map (with respect to the respective norm topolo-
gies). f  is onto iff f is an injection. f is onto iff f  is an isomorphism
of C.Y / onto a ring A  C.X/ which contains constants.
Exercise 3.34 Let L be a language for propositional logic with con-
stants C and V as the set of propositional variables. Prove that a con-
sistent theory T has a model, hence a map h W V ! 22 such that each
formula in T is assigned the value >. Hint: Fix an ultraﬁlter on the Lin-
denbaum algebra of T and consider the corresponding morphism into 22.
Exercise 3.35 Let G be a topological group; see Example 3.1.25. Given
F  G closed, show that
1. gF and Fg are closed,
2. F 1 is closed,
3. MF and FM are closed, provided M is ﬁnite.
4. If A  G, then Aa D T
U 2U.e/ AU D T
U 2U.e/ UA D T
U 2
AU D T
U 2 UA:
Exercise 3.36 Let .X; u/ and .Y; v/ be uniform spaces with Cauchy ﬁl-
ters F and G on X resp. Y . Deﬁne F  G as the smallest ﬁlter on X  Y
which contains fA  B j A 2 F; B 2 Gg. Show that F  G is a Cauchy
ﬁlter on X  Y with F  G ! hx; yi iff F ! x and G ! y.

Chapter 4
Measures for Probabilistic
Systems
Markov transition systems are based on transition probabilities on a
measurable space. This is a generalization of discrete spaces, declar-
ing certain sets to be measurable. So, in contrast to assuming that we
know the probability for the transition between two states, we have to
model the probability of a transition going from one state to a set of
states: Point-to-point probabilities are no longer available due to work-
ing in a comparatively large space. Measurable spaces are the domains
of the probabilities involved. This approach has the advantage of being
more general than ﬁnite or countable spaces, but now one deals with
a fairly involved mathematical structure; all of a sudden the dictionary
has to be extended with words like “universally measurable” or “sub-
-algebra.” Measure theory becomes an area where one has to ﬁnd
answers to questions which did not appear to be particularly involved
before, in the much simpler world of discrete measures (the impres-
sion should not arise that I consider discrete measures as kiddie stuff;
they are difﬁcult enough to handle. The continuous case, as it is called
sometimes, offers questions, however, which simply do not arise in the
discrete context). Many arguments in this area are of a measure theo-
retic nature, and I want to introduce the reader to the necessary tools and
techniques.
© Springer International Publishing Switzerland 2015
E.-E. Doberkat, Special Topics in Mathematics for Computer
Scientists, DOI 10.1007/978-3-319-22750-4 4
427

428
CHAPTER 4. MEASURES FOR PROBABILISTIC SYSTEMS
It starts off with a discussion of -algebras, which have already been
met in Sect. 1.6. We look at the structure of -algebras, in particular at
its generators; it turns out that the underlying space has something to
say about it. In particular we will deal with Polish spaces and their
brethren. Two aspects deserve to be singled out. The -algebra on
the base space determines a -algebra on the space of all ﬁnite mea-
sures, and, if this space has a topology, it determines also a topology,
the Alexandrov topology. These constructions are studied, since they
also affect the applications in logic, and for transition systems, in which
measures are vital. Second, we show that we can construct measurable
selections, which then enable constructions which are interesting from
a categorical point of view.
After having laid the groundwork with a discussion of -algebras as the
domains of measures, we show that the integral of a measurable function
can be constructed through an approximation process, very much in the
tradition of the Riemann integral, but with a larger scope. We also go
the other way: Given an integral, we construct a measure from it. This is
the elegant way P.J. Daniell did propose for constructing measures, and
it can be brought to fruit in this context for a direct and elegant proof of
the Riesz Representation Theorem on compact metric spaces.
Having all these tools at our disposal, we look at product measures,
which can be introduced now through a kind of line sweeping—if you
want to measure an area in the plane, you measure the line length as
you sweep over the area; this produces a function of the abscissa, which
then yields the area through integration. One of the main tools here is
Fubini’s Theorem. The product measure is not conﬁned to two factors;
we discuss the general case. This includes a discussion of projective
systems, which may be considered as a generalization of sequences of
products. A case study shows that projective systems arise easily in the
study of continuous time stochastic logics.
Now that integrals are available, we turn back and have a look at topolo-
gies on spaces of measures; one suggests itself—the weak topology
which is induced by the continuous functions. This is related to the
Alexandrov topology.
It is shown that there is a particularly handy
metric for the weak topology and that the space of all ﬁnite measures
is complete with this metric, so that we now have a Polish space. This
is capitalized on when discussing selections for set-valued maps into
this space, which are helpful in showing that Polish spaces are closed
under bisimulations. We use measurable selections for an investigation

4.1. MEASURABLE SETS AND FUNCTIONS
429
into the structure of quotients in the Kleisli monad, providing another
example for the interplay of arguments from measure theory and cate-
gories.
This interplay is stressed also for the investigation of stochastic effectiv-
ity functions, which leads to an interpretation of game logics. Since it
is known in the world of relations that nondeterministic Kripke models
are inadequate for the study of game logics and that effectivity functions
serve this purpose well, we develop an approach to stochastic effectivity
functions and apply these functions to an interpretation of game logics.
This serves as an example for stochastic modeling in logics; it demon-
strates the close interaction of algebraic and probabilistic reasoning,
indicating the importance of structural arguments, which go beyond the
mere discussion of probabilities.
Finally, we take up a true classic: Lp-spaces. We start from Hilbert
spaces, apply the representation of linear functionals on L2 to obtain
the Radon–Nikodym Theorem through von Neumann’s ingenious proof,
and derive from it the representation of the dual spaces. This is applied
to disintegration, where we show that a measure on a product can be
decomposed into a projection and a transition kernel. On the surface
this does not look like an application area for Lp-spaces; the relationship
derives from the Radon–Nikodym Theorem.
Because we are driven by applications to Markov transition systems and
similar objects, we did not strive for the most general approach to mea-
sure and integral. In particular, we usually formulate the results for ﬁ-
nite or -ﬁnite measures, leaving the more general cases outside of our
focus. This means also that I do not deal with complex measures (and
the associated linear spaces over the complex numbers). Things are dis-
cussed rather in the realm of real numbers; we show, however, in which
way one could start to deal with complex measures when the occasion
arises. Of course, a lot of things had to be left out, among them a careful
study of the Borel hierarchy and applications to descriptive set theory,
as well as martingales.
4.1
Measurable Sets and Functions
This section contains a systematic study of measurable spaces and mea-
surable functions with a view toward later developments.
A brief
overview is in order, and a preview indicates why the study of

430
CHAPTER 4. MEASURES FOR PROBABILISTIC SYSTEMS
measurable sets is important, nay, fundamental for discussing many of
the applications we have in mind.
The measurable structure is lifted to the space of ﬁnite measures, which
form a measurable set under the weak -algebra. This is studied in
Sect. 4.1.2. If the underlying space carries a topology, the topologi-
cal structure is handed down to ﬁnite measures through the Alexandrov
topology. We will have a look at it in Sect. 4.1.4. The measurable func-
tions from a measurable space to the reals form a vector space, which is
also a lattice, and we will show that the step functions, i.e., those func-
tions which take only ﬁnite number of values, are dense with respect to
pointwise convergence. This mode of convergence is relaxed in the pres-
ence of a measure in various ways to almost uniform convergence, con-
vergence almost everywhere, and convergence in measure (Sects. 4.2.1
and 4.2.2), from which also various (pseudo)metrics and norms may be
derived.
If the underlying measurable spaces are the Borel sets of a metric space,
and if the metric has a countable dense set, then the Borel sets are
countably generated as well. But the irritating observation is that be-
ing countably generated is not hereditary—a sub--algebra of a count-
able -algebra need not be countably generated. So countably generated
-algebras deserve a separate look, which is what we will do in Sect. 4.3.
The very important class of Polish spaces will be studied in this context
as well, and we will show how to manipulate a Polish topology into
making certain measurable functions continuous. This is one of the rea-
sons why Polish spaces did not go into the gallery of topological spaces
in Sect. 3.6. Polish spaces generalize to analytic spaces in a most natural
manner, for example, when taking the factor of a countably generated
equivalence relation in a Polish space; we will study the relationship in
Sect. 4.3.1. The most important tool here is Souslin’s Separation Theo-
rem. This discussion leads quickly to a discussion of the abstract Souslin
operation in Sect. 4.5, through which analytic sets may be generated in a
Polish space. From there it is but a small step to introducing universally
measurable sets in Sect. 4.6, which turn out to be closed under Souslin’s
operation in general measurable spaces.
Two
applications
of
these
techniques
are
given:
Lubin’s
Theorem extends a measure from a countably generated sub--algebra
of the Borel sets of an analytic space to the Borel sets proper; the other
application explores the extension a transition kernel to the universal

4.1. MEASURABLE SETS AND FUNCTIONS
431
completion (Sects. 4.6.1 and 4.6.2).
Lubin’s Theorem is established
through von Neumann’s Selection Theorem, which provides a univer-
sally measurable right inverse to a surjective measurable map from an
analytic space to a separable measurable space. The topic of selections
is taken up in Sect. 4.7, where the selection theorem of Kuratowski and
Ryll-Nardzewski is in the center of attention. It gives conditions un-
der which a map which takes values in the closed nonempty subsets
of a Polish space has a measurable selector. This is of interest, e.g.,
when it comes to establishing the existence of bisimulations for Markov
transition systems or for identifying the quotient structure of transition
kernels.
4.1.1
Measurable Sets
Recall from Example 2.1.12 that a measurable space .X; A/ consists of
a set X with a -algebra A, which is a Boolean algebra of subsets of X
that is closed under countable unions (hence countable intersections or
countable disjoint unions). If A0 is a family of subsets of X, then
 .A0/ D
\
fB j B is a -algebra on M with A0  Ag
is the smallest -algebra on M which contains A0. This construction
works since the power set P.X/ is a -algebra on X. Take, for example,
as a generator I all open intervals in the real numbers R; then .I/ is the
-algebra of real Borel sets. These Borel sets are denoted by B.R/, and
since each open subset of R can be represented as a countable union of
open intervals, B.R/ is the smallest -algebra which contains the open
sets of R. Unless otherwise stated, the real numbers are equipped with
the -algebra B.R/.
In general, if .X; / is a topological space, the -algebra B./ WD ./
is called its Borel sets. They will be discussed extensively in the context
B./
of Polish spaces. This is, however, not the only -algebra of interest on
a topological space.
Example 4.1.1 Call F  X functionally closed iff F D f 1
f0g

for
some continuous function f W X ! R; G  X is called functionally
open iff G D X n F with F functionally closed. The Baire sets Ba./
Ba./
of .X; / are the -algebra generated by the functionally closed sets of
the space. We write sometimes also Ba.X/, if the context is clear.

432
CHAPTER 4. MEASURES FOR PROBABILISTIC SYSTEMS
Let F  X be a closed subset of a metric space .X; d/; then d.x; F / WD
inffd.x; y/ j y 2 F g is the distance of x to F with x 2 F iff d.x; F / D 0;
see Lemma 3.5.7.
Moreover, d.; F / is continuous, and thus F D
d.; F /1
f0g

is functionally closed; hence the Baire and the Borel
sets coincide for metric spaces. ✌
The next example constructs a -algebra which comes up quite naturally
in the study of stochastic nondeterminism.
Example 4.1.2 Let A  P .X/ for some set X, the family of hit sets,
and G a distinguished subsets of P .X/. Deﬁne the hit--algebra HA.G/
as the smallest -algebra on G which contains all the sets HA with
A 2 A, where HA is the hit set associated with A, i.e., HA WD fB 2 G j
B \ A 6D ;g. ✌
Rather than working with a closure operation ./, one sometimes can
adjoin additional elements to obtain a -algebra from a given one; see
also Exercise 4.5. This is demonstrated for a -ideal through the fol-
lowing construction, which will be helpful when completing a measure
space. Recall that N  P .X/ is a -ideal iff it is an order ideal which
is closed under countable unions (Deﬁnition 1.6.10).
Lemma 4.1.3 Let A be a -algebra on a set X, N  P .X/ a -ideal.
Then
AN WD fAN j A 2 A; N 2 Ng
is the smallest -algebra containing both A and N.
Proof It is sufﬁcient to demonstrate that AN is a -algebra. Because
X n .AN / D X.AN / D .XA/N D .X n A/N;
we see that AN is closed under complementation. Now let

AnNn

n2N
be a sequence of sets with .An/n2N in A and .Nn/n2N in N, and we
have
[
n2N
.AnNn/ D
[
n2N
An

N
with
N D
[
n2N
.AnNn/
[
n2N
An
 .	/

[
n2N

.AnNn/An

D
[
n2N
Nn;
using Exercise 4.10 in ./. Because N is a -ideal, we conclude that
N 2 N. Thus AN is also closed under countable unions. Since ;; X 2
AN, it follows that this set is a -algebra indeed. a

4.1. MEASURABLE SETS AND FUNCTIONS
433
If .Y; B/ is another measurable space, then a map f W X ! Y is called
A-B-measurable iff the inverse image under f of each set in B is a
member of A, hence iff f 1
G

2 A holds for all G 2 B; this is
discussed in Example 2.1.12.
Checking measurability is made easier by the observation that it suf-
ﬁces for the inverse images of a generator to be measurable sets (see
Exercise 2.7).
Lemma 4.1.4 Let .X; A/ and .Y; B/ be measurable spaces, and assume
that B D .B0/ is generated by a family B0 of subsets of Y . Then
f W X ! Y is A-B-measurable iff f 1
G

2 A holds for all G 2 B0:
Proof Clearly, if f is A-B-measurable, then f 1
G

2 A holds for all
G 2 B0:
Conversely, suppose f 1
G

2 A holds for all G 2 B0; then we need
to show that f 1
G

2 A for all G 2 B. We will use the principle
of good sets (see page 86) for the proof. In fact, consider the set G for
which the assertion is true,
G WD fG 2 B j f 1
G

2 Ag:
An elementary calculation shows that the empty set and Y are both
members of G, and since f 1
Y n G

D X n f 1
G

, G is closed
under complementation. Because
f 1S
i2I Gi

D S
i2I f 1
Gi

holds for any index set I, G is closed under ﬁnite and countable unions.
Thus G is a -algebra, so that .G/ D G holds. By assumption, B0  G,
so that
A D .B0/  .G/ D G  A
is inferred.
Thus all elements of B have their inverse image in A.
a
An example is furnished by a real-valued function f W X ! R on X
which is A-B.R/-measurable iff fx 2 X j f .x/ ‰ tg 2 A holds
for each t 2 R; the relation ‰ may be taken from <; ; ; > : We
infer in particular that a function f from an topological space .X; /
which is upper or lower semicontinuous (i.e., for which in the upper
semicontinuous case, the set fx 2 X j f .x/ < cg is open, and in the
lower semicontinuous case, the set fx 2 X j f .x/ > cg is open, c 2 R

434
CHAPTER 4. MEASURES FOR PROBABILISTIC SYSTEMS
being arbitrary) is Borel measurable. Hence a continuous function is
Borel measurable. A continuous function f W X ! Y into a metric
space Y is Baire measurable (Exercise 4.2).
These observations will be used frequently.
The proof’s strategy is worthwhile repeating, since we will use this strat-
egy over and over again. It consists in having a look at all objects that
have the desired property and showing that this set of good guys is a
-algebra. It is similar to showing in a proof by induction that the set of
all natural numbers having a certain property is closed under construct-
ing the successor. Then we show that the generator of the -algebra is
contained in the good guys, which is rather similar to begin the induc-
tion. Taking both steps together then yields the desired properties for
both cases.
An example is furnished by the equivalence relation induced by a family
of sets.
Example 4.1.5 Given a subset C  P .X/ for a set X, deﬁne the equiv-
alence relation C on X upon setting
x C x0
x C x0 iff 8C 2 C W x 2 C , x0 2 C:
Thus x C x0 iff C cannot separate the elements x and x0; call C the
equivalence relation generated by C.
Now let A be a -algebra on X with A D .A0/. Then A and A0
generate the same equivalence relation, i.e., A D A0. In fact, deﬁne
for x; x0 2 X with x A0 x0
B WD fA 2 A j x 2 A , x0 2 Ag:
Then B is a -algebra with A0  B; hence .A0/  B  A, so
that .A0/ D B. Thus x A0 x0 implies x A x0; since the reverse
implication is obvious, the claim is established. ✌
Let us just brieﬂy discuss initial and ﬁnal -algebras again. The spirit
of this is very much similar to deﬁning initial and ﬁnal topologies; see
Sect. 3.1.1 and Deﬁnition 2.6.42. If .X; A/ is a measurable space and
f W X ! Y is a map, then
B WD fD  Y j f 1
D

2 Ag

4.1. MEASURABLE SETS AND FUNCTIONS
435
is the largest -algebra B0 on Y that renders f A-B0-measurable; then
B is called the ﬁnal -algebra with respect to f . In fact, because the
inverse set operator f 1 is compatible with the Boolean operations, it
is immediate that B is closed under the operations for a -algebra, and
a little moment’s reﬂection shows that this is also the largest -algebra
with this property.
Symmetrically, let g W P ! X be a map; then
g1
A

WD fg1
E

j E 2 Ag
is the smallest -algebra P0 on P that renders g W P0 ! A-measurable;
accordingly, g1
A

is called initial with respect to f . It is fairly clear
that this is the smallest one with the desired property. In particular,
the inclusion iQ W Q ! X becomes measurable for a subset Q  X
when Q is endowed with the -algebra fQ \ B j B 2 Ag: It is called
the trace of A on Q and is denoted—in a slight abuse of notation—by
A \ Q.
Initial and ﬁnal -algebras generalize in an obvious way to families of
maps. For example, 
S
i2I g1
i

Ai

is the smallest -algebra P0 on
P which makes all the maps gi W P ! Xi P0-Ai-measurable for a
family

.Xi; Ai/

i2I of measurable spaces.
This is an intrinsic, universal characterization of the initial -algebra for
a single map.
Lemma 4.1.6 Let .X; A/ be a measurable space and f W X ! Y be a
map. The following conditions are equivalent:
1. The -algebra B on Y is ﬁnal with respect to f .
2. If .P; P/ is a measurable space, and g W Y ! P is a map, then
the A-P-measurability of g ı f implies the B-P-measurability
of g.
Proof 1. Taking care of 1 ) 2, we note that
.g ı f /1
P

D f 1
g1
P

 A:
Consequently, g1
P

is one of the -algebras B0 with f 1
B0

 A. Since B is the largest of them, we have g1
P

 B. Hence
g is B-P-measurable.

436
CHAPTER 4. MEASURES FOR PROBABILISTIC SYSTEMS
2. In order to establish the implication 2 ) 1, we have to show that
B0  B whenever B0 is a -algebra on Y with f 1
B0

 A. Put
.P; P/ WD .Y; B0/, and let g be the identity idY . Because f 1
B0


A, we see that idY ı f is B0-A-measurable.
Thus idY is B-B0-
measurable. But this means B0  B. a
We will use the ﬁnal -algebra mainly for factoring through an equiva-
lence relation. In fact, let ˛ be an equivalence relation on a set X, where
.X; A/ is a measurable space. Then the factor map
˛ W
(
X
! X=˛
x
7! Œx˛
that maps each element to its class can be made a measurable map by
taking the ﬁnal -algebra A=˛ with respect to ˛ and A as the -algebra
on X=˛.
Dual to Lemma 4.1.6, the initial -algebra is characterized.
Lemma 4.1.7 Let .Y; B/ be a measurable space and f W X ! Y be a
map. The following conditions are equivalent:
1. The -algebra A on X is initial with respect to f .
2. If .P; P/ is a measurable space, and g W P ! X is a map, then
the P-B-measurability of f ı g implies the P-A-measurability
of g.
a
Let

.Ai; Ai/

i2I be a family of measurable spaces; then the product-
-algebra N
i2I Ai denotes that initial -algebra on Q
i2I Xi for the
projections
j W hmi j i 2 Ii 7! mj :
It is not difﬁcult to see that N
i2I Ai D .Z/ with
Z WD f
Y
i2I
Ei j 8i 2 I W Ei 2 Mi; Ei D Mi for almost all indicesg
as the collection of cylinder sets (use Theorem 1.6.30 and the observa-
tion that Z is closed under intersection).
For I D f1; 2g, the -algebra A1 ˝ A2 is generated from the set of
measurable rectangles
fE1  E2 j E1 2 A1; E2 2 A2g:

4.1. MEASURABLE SETS AND FUNCTIONS
437
This is discussed in Example 2.2.4 as the example of a product in the
category of measurable spaces.
Dually, the sum .X1CX2; A1CA2/ of the measurable spaces .X1; A1/
and .X2; A2/ is deﬁned through the ﬁnal -algebra on the sum X1CX2
for the injections Xi ! X1 C X2: This is the special case of the co-
product L
i2I.Xi; Ai/; where the -algebra L
i2I Ai is initial with
respect to the injections. This is discussed in a general context in Exam-
ple 2.2.16.
We will construct horizontal and vertical cuts from subsets of a Carte-
sian product, e.g., when deﬁning the product measure and for investigat-
ing measurability properties. We deﬁne for Q  X  Y the horizontal
cut
Qx; Qy
Qx WD fy 2 Y j hx; yi 2 Qg
and the vertical cut
Qy WD fx 2 X j hx; yi 2 Qg:
Lemma 4.1.8 Let .X; A/ and (Y; B/ be measurable spaces. If Q 2
A ˝ B, then Qx 2 B and Qy 2 A hold for x 2 X; y 2 Y .
Proof Take the vertical cut Qx and consider the set
Q WD fQ 2 A ˝ B j Qx 2 Bg:
Then A  B 2 Q, whenever A 2 A; B 2 B; this is so since the set of
all measurable rectangles forms a generator for the product -algebra
which is closed under ﬁnite intersections. Because .X  Y / n Q/x D
Y n Qx, we infer that Q is closed under complementation, and because
.S
n2N Qn/x D S
n2N Qn;x, we conclude that Q is closed under dis-
joint countable unions. Hence Q D A ˝ B by the --Theorem 1.6.30.
a
The converse does not hold. We cannot conclude from the fact for a
subset S  X  Y that S is product measurable whenever all its cuts
are measurable; this follows from Example 4.3.7.
4.1.2
A -Algebra on Spaces of Measures
We will now introduce a -algebra on the space of all -ﬁnite measures.
It is induced by evaluating measures at ﬁxed events. Note the inversion:

438
CHAPTER 4. MEASURES FOR PROBABILISTIC SYSTEMS
Instead of observing a measure assigning a real number to a set, we take
a set and have it act on measures. This approach is fairly natural for
many applications.
In addition to S resp. P, the functors which assign to each measurable
space its subprobabilities and its probabilities (see Example 2.3.12), we
introduce the space of ﬁnite resp. -ﬁnite measures.
Denote by M.X; A/ the set of all ﬁnite measures on .X; A/; the set
M; M
of all -ﬁnite measures is denoted by M.X; A/. Each set A 2 A
gives rise to the evaluation map evA W  7! .A/; the weak -algebra
}}}.X; A/ on M.X; A/ is the initial -algebra with respect to the family
fevA j A 2 Ag; actually, it sufﬁces to consider a generator A0 of A;
see Exercise 4.1. This is just an extension of the deﬁnitions given in
}}}.X; A/
Example 2.1.14. It is clear that we have
}}}.X; A/ D .fˇˇˇA.A; ‰ q/ j A 2 A; q 2 RCg/
when we deﬁne
ˇˇˇA.A; ‰ q/ WD f 2 M.X; A/ j .A/ ‰ qg:
Here ‰ is one of the relational operators ; <; ; >, and it is apparent
ˇˇˇA.A; ‰ q/
that q may be taken from the rationals. We will use the same symbol ˇˇˇA
when we refer to probabilities or subprobabilities, if no confusion arises.
Thus the base space from which the weak -algebra will be constructed
should be clear from the context. We will also write }}}.X/ or }}}.A/ for
}}}.X; A/, as the situation requires.
Let .Y; B/ be another measurable space, and let f W X ! Y be A-B-
measurable. Deﬁne
M.f /./.B/ WD .f 1
B

/
for  2 M.X; A/ and for B 2 B, then M.f /./ 2 M.Y; B/; hence
M.f /
M.f / W M.X; A/ ! M.Y; B/ is a map, and since
.M.f //1
ˇˇˇB.B; ‰ q/

D ˇˇˇA.f 1
B

; ‰ q/;
this map is }}}.A/-}}}.B/-measurable; see Exercise 2.8. Thus M is an
endofunctor on the category of measurable spaces.
Measurable maps into M./ deserve special attention.

4.1. MEASURABLE SETS AND FUNCTIONS
439
Deﬁnition 4.1.9 Given measurable spaces .X; A/ and .Y; B/, an A-
}}}.B/-measurable map K W X ! M.Y; B/ is called a transition kernel
and denoted by K W .X; A/  .Y; B/. A transition kernel with values
X  Y
in S.Y; B/ is also called a stochastic relation.
A transition kernel K W .X; A/  .Y; B/ associates to each x 2 X
a -ﬁnite measure K.x/ on .Y; B/. In a probabilistic setting, this may
be interpreted as the probability that a system reacts on input x with
K.x/ as the probability distribution of its responses. For example, if
.X; A/ D .Y; B/ is the state space of a probabilistic transition system,
then K.x/.B/ is often interpreted as the probability that the next state is
a member of measurable set B after a transition from x.
This is an immediate characterization of transition kernels.
Lemma 4.1.10 K W .X; A/  .Y; B/ is a transition kernel iff these
conditions are satisﬁed:
1. K.x/ is a -ﬁnite measure on .Y; B/ for each x 2 X.
2. x 7! K.x/.B/ is a measurable function for each B 2 B.
Proof If K W .X; A/  .Y; B/, then K.x/ is a -ﬁnite measure on
.Y; B/, and
fx 2 XjK.x/.B/ > qg D K1
ˇˇˇB.B; > q/

2 A:
Thus x 7! K.x/.B/ is measurable for all B 2 B.
Conversely, if
x 7! K.x/.B/ is measurable for B 2 B, then the above equation shows
that K1
ˇˇˇB.B; > q/

2 A, so K W .X; A/ ! M.Y; B/ is A-}}}.B/-
measurable by Lemma 4.1.4. a
A special case of transition kernels are Markov kernels, sometimes also
called stochastic relations. These are kernels, the image of which is in
S or in P, whatever the case may be. We encountered these Markov
kernels already in Example 2.4.8 as the Kleisli morphisms for the Giry
Kleisli
monad.
Example 4.1.11 Transition kernels may be used for interpreting modal
logics. Consider this grammar for formulas
' WWD > j '1 ^ '2 j Þq'
with q 2 Q; q  0. The informal interpretation in a probabilistic transi-
tion system is that > always holds and that Þq' holds with probability

440
CHAPTER 4. MEASURES FOR PROBABILISTIC SYSTEMS
not smaller than q after a transition in a state in which formula ' holds.
Now let M W .X; A/  .X; A/ be a transition kernel, and deﬁne induc-
tively
ŒŒ>M WD X
ŒŒ'1 ^ '2M WD ŒŒ'1M \ ŒŒ'2M
ŒŒÞq'M WD fx 2 X j M.x/.ŒŒ'M/  qg
D M 1
ˇˇˇA.B;  q/

:
It is easy to show by induction on the structure of the formula that the
sets ŒŒ'M are measurable, since M is a transition kernel. For a gener-
alization, see Example 4.2.7. ✌
4.1.3
Case Study: Stochastic Effectivity Functions
This section will discuss stochastic effectivity functions as a general-
ization of stochastic transition kernels resp. stochastic relations. The
reasons for this discussion are as follows:
Nondeterminism Stochastic effectivity functions are the probabilistic
versions of effectivity functions which are well understood. For
a historic overview, the reader is referred to [vdHP07, Sect. 9] or
to [Dob14, Sect. 1]. Since these functions model nondeterminism
fairly well, their stochastic extensions are also a prime candidate
for modeling applications which incorporate stochastic nondeter-
minism. This argument is studied in depth in [DT41].
Conﬂuence The conﬂuence of categorical and stochastic reasoning can
be studied in this instance, for example, when introducing mor-
phisms and congruences. This cooperation is the more interesting
as these stochastic effectivity functions may be thought of as the
composition of monads, but seem not to be the functorial part of
a monad themselves. Hence it becomes mandatory to ﬁne-tune
the arguments which are already available in the context of, say,
Kleisli morphisms. Extending this argument, the approach pro-
posed here is an exercise in stochastic modeling.
Tool Stochastic effectivity functions are proposed as the tool for in-
terpreting game logic stochastically. It is argued below that the
Kripke models are not suitable for interpreting this logic in the

4.1. MEASURABLE SETS AND FUNCTIONS
441
usual, non-stochastic realm; hence we have to look for other
stochastic methods to interpret this logic. A ﬁrst proposal in this
direction will be discussed in Sect. 4.9.4. Thus the discussion be-
low may also be perceived as sharpening the tools, which later on
will be put to use in the context of game logics.
For an interpretation of game logic as formulated in Example 2.7.5,
Parikh [Par85] use effectivity functions which are closely related to
neighborhood relations [Pau00]; this is sketched in Sect. 2.7.1, in par-
ticular in Example 2.7.22. It is shown that the Kripke models are not
adequate for interpreting game logics. These arguments should be taken
care of for a stochastic interpretation as well, so we need an extension
to the stochastic Kripke models, i.e., to Kripke models which are based
on stochastic transition systems. Since effectivity functions have been
shown to be useful as the formalism underlying neighborhood models,
we will formulate here stochastic effectivity functions as a stochastic
counterpart and for further development.
When constructing such a probabilistic interpretation, we will take dis-
tributions over the state space into account—thus, rather than working
with states directly, we will work with probabilities over them. As with
the interpretation of modal logics through stochastic Kripke models, it
may well be that some information gets lost, so we choose to work with
subprobabilities rather than probabilities. Taking into account that An-
gel may be able to bring about a speciﬁc distribution of the new states
when playing game  in state s, we propose that we model Angel’s ef-
fectivity by a set of distributions; this is remotely similar to the idea of
gambling houses in [DS65]. For example, Angel may have a strategy for
achieving a normal distribution N.s; 2/ centered at s 2 R such that the
standard distribution varies in an interval I, yielding fN.s; 2/ j  2 Ig
as a set of distributions effective for Angel in that situation.
But we cannot do with just arbitrary subsets of the set of all subprobabil-
ities on state space S. We want also to characterize possible outcomes,
i.e., sets of distributions over the state space for composite games. Hence
we will want to average over intermediate states. This in turn requires
measurability of the functions involved, both for the integrand and for
the measure used for integration. Consequently we require measurable
sets of subprobabilities as possible outcomes. We also impose a con-
dition for measurability on the interplay between distributions on states
and reals for measuring the probabilities of sets of states. This leads to
the deﬁnition of a stochastic effectivity function.

442
CHAPTER 4. MEASURES FOR PROBABILISTIC SYSTEMS
Modeling all this requires some preparations by ﬁxing the range of a
stochastic effectivity function. Put for a measurable space .S; A/
E.S; A/ WD fV  }}}.S; A/ j V is upper closedgI
thus if V 2 E.S; A/, then A 2 V and A  B together imply B 2 V ;
note that E D V0 ı S with V0 as the restriction of V to the weakly mea-
surable sets, V being deﬁned in Example 2.3.13. Recall from Sect. 4.1.2
that }}}.S; A/ is the weak -algebra on the set of ﬁnite measures on the
measurable space .X; A/, i.e., the initial -algebra with respect to eval-
uation.
A measurable map f W .S; A/ ! .T; B/ induces a map E.f / W E.S; A/
! E.T; B/ upon setting
E.f /.V / WD fW 2 }}}.T; B/ j .Sf /1
W

2 V g
for V 2 E.S/; then clearly E.f /.V / 2 E.T /.
Note that E.S; A/ has not been equipped with a -algebra, so the usual
notion of measurability between measurable spaces cannot be applied.
In particular, E is not an endofunctor on the category of measurable
spaces. We will not discuss functorial aspects of E here, but rather
refer the reader to the discussion in Sect. 2.3.1, in particular Exam-
ple 2.3.13.
We need some measurability properties for dealing with the compo-
sition of distributions when discussing composite games. Let H 
S.S/  Œ0; 1 be a measurable subset indicating a quantitative assess-
ment of subprobabilities; a typical example could be the set fh; qi j
 2 ˇˇˇA.A; > q/; q 2 Cg for some A 2 A and some C 2 B.Œ0; 1/. Fix
some real q and consider the cut of H at q, viz.,
H q D f j h; qi 2 Hg;
for example,
ˇˇˇA.A; > q/ D fh; ri j .A/ > rgq:
We ask for all states s such that this set H q is effective for s. They
should come from a measurable subset of S. It turns out that this is not
enough; we also require the real components being captured through a
measurable set as well—after all, the real component will be used to
be averaged, i.e., integrated, over later on, so it should behave decently.
This idea is formulated in the following deﬁnition.

4.1. MEASURABLE SETS AND FUNCTIONS
443
Deﬁnition 4.1.12 Call a map P W S ! E.S/ t-measurable iff fhs; qi j
H q 2 P.s/g 2 A ˝ Œ0; 1 whenever H 2 }}}.S/ ˝ Œ0; 1:
t-measurable
Summarizing, we are led to the notion of a stochastic effectivity func-
tion.
Deﬁnition 4.1.13 A stochastic effectivity function P on a measurable
space S is a t-measurable map P ! E.S/.
In order to distinguish between sets of states and sets of state distribu-
tions, we call the latter ones portfolios; thus P.s/ is a set of measur-
Portfolio
able portfolios. This will render some discussions below easier. By the
way, stochastic effectivity functions between measurable spaces S and
T could be deﬁned in a similar way, but this added generality is not of
interest in the present context. Note that an effectivity function is not
given by an endofunctor on the category of measurable spaces, so we
will have to assemble what we need from this context without being
able to directly refer to coalgebras or similar constructions.
We show that a ﬁnite transition system can be converted into a stochastic
effectivity function.
Example 4.1.14 Let S WD f1; : : : ; ng for some n 2 N, and take the
power set as a -algebra. Then S.S/ can be identiﬁed with the compact
convex set
˘n WD fhx1; : : : ; xni j xi  0 for 1  i  n; Pn
iD1 xi  1g:
Geometrically, ˘n is the positive convex hull of the unit vectors ei,
1  i  n and the zero vector; here ei.i/ D 1, and ei.j / D 0 if i 6D j
is the ith n-dimensional unit vector. The weak -algebra }}}.S/ is the
Borel--algebra B.˘n/ for the Euclidean topology on ˘n.
Assume we have a transition system !S on S; hence a relation !S 
S  S. Let succ.s/ WD fs0 2 S j s !S s0g be the set of a successor state
for state s, and deﬁne for s 2 S the set of weighted successors
.s/ WD
˚P
s02succ.s/ ˛s0  es0 j Q 3 ˛s0  0 for s0 2 succ.s/; P
s02succ.s/ ˛s0  1

and the upper closed set
P.s/ WD fA 2 B.˘n/ j .s/  Ag:
A set A is in the portfolio for P in state s if A contains all rational
subprobability distributions on the successor states of s. We will restrict
our attention to these rational distributions.

444
CHAPTER 4. MEASURES FOR PROBABILISTIC SYSTEMS
We claim that P is an effectivity function on S. If P.s/ D ;, there
is nothing to show, so we assume that always P.s/ 6D ;. Let H 2
B.˘n/ ˝ B.Œ0; 1/ D B.˘n ˝ Œ0; 1/, the latter equality holding by
Proposition 4.3.16. Then
fhs; qi j H q 2 P.s/g D
[
1sn
fsg  fq 2 Œ0; 1 j H q 2 P.s/g:
Fix s 2 S, and let succ.s/ D fs1; : : : ; smg: Put
˝m WD fh˛1; : : : ; ˛mi 2 Qm j ˛i  0I P
i ˛i  1g;
hence ˝m is countable, and
fq 2 Œ0; 1 j H q 2 P.s/g D fq 2 Œ0; 1 j .s/  H qg
D
\
h˛1;:::;˛mi2˝m
fq 2 Œ0; 1 j P
i ˛i  eji 2 H qg:
Now ﬁx ˛ WD h˛1; : : : ; ˛mi 2 ˝m. The map 	˛ W Œ0; 1mn ! Œ0; 1n
which maps hv1; : : : ; vmi to Pm
iD1 ˛i  vi is continuous, hence measur-
able, and so is 
 WD 	˛  idŒ0;1 W Œ0; 1mn  Œ0; 1 ! Œ0; 1n  Œ0; 1.
Hence I WD 
1
H

2 B.Œ0; 1mn  Œ0; 1/, and Pm
iD1 ˛i  eji 2 H q
iff hej1; : : : ; ejm; qi 2 I: Consequently,
fq 2 Œ0; 1 j P
i ˛i  eji 2 H qg D I hej1;:::;ejmi 2 B.Œ0; 1/:
But this implies that
fq 2 Œ0; 1 j H q 2 P.s/g D
\
˛2˝m
fq 2 Œ0; 1 j P
i ˛i  eji 2 H qg 2 B.Œ0; 1/
for the ﬁxed state s 2 S. Collecting states, we obtain
fhs; qi 2 S  Œ0; 1 j H q 2 P.s/g 2 P .S/ ˝ B.Œ0; 1/:
Thus we have converted a ﬁnite transition system into a stochastic
effectivity function by constructing all subprobabilities over the respec-
tive successor sets with rational coefﬁcients.
One might ask whether the restriction to rational coefﬁcients is really
necessary. Taking the convex closure with real coefﬁcients might, how-
ever, result in loosing measurability; see [Kec94, p. 216]. ✌

4.1. MEASURABLE SETS AND FUNCTIONS
445
The next example shows that a stochastic effectivity function can be
used for interpreting a simple modal logic.
Example 4.1.15 Let ˚ be a set of atomic propositions, and deﬁne the
formulas of a logic through this grammar
' WWD > j p j '1 ^ '2 j Þq'
with p 2 ˚ an atomic proposition and q 2 Œ0; 1 a threshold value.
Intuitively, Þq' is true in a state s iff there can be a move in s to a state
in which ' holds with probability not smaller than q.
This logic is interpreted over the measurable space .S; A/; assume that
we are given a map V W ˚ ! A, assigning each atomic proposition
a measurable set as its validity set. Let P be a stochastic effectivity
function on S, then deﬁne inductively
ŒŒ> WD S;
ŒŒp WD V.p/; for p 2 ˚;
ŒŒ'1 ^ '2 WD ŒŒ'1 \ ŒŒ'2;
ŒŒÞq' WD fs 2 S j ˇˇˇA.ŒŒ'; > q/ 2 P.s/g:
The interesting line is of course the last one. It assigns to Þq' all states
s such that ˇˇˇA.ŒŒ'; > q/ is in the portfolio of P.s/. These are all states
for which the collection of all measures yielding an evaluation on ŒŒ'
greater than q can be achieved.
Then t-measurability of P and the assumption on V make sure that these
sets are measurable. This is shown by an easy induction on the structure
of the formulas and by observing that ŒŒÞq' D fhs; ri 2 S  Œ0; 1 j
ˇˇˇA.ŒŒ'; > r/ 2 P.s/gq: ✌
We ﬁx for the time being a measurable space .S; A/; if a second measur-
able space enters the discussion, it will be T as carrier with -algebra B.
The relationship of stochastic relations and stochastic effectivity func-
tions is of considerable interest; we will discuss stochastic Kripke mod-
els and general models for game logic in Sect. 4.9.4. Each stochastic
relation K W S  S yields a stochastic effectivity function PK in a
natural way upon setting
PK.s/ WD fA 2 }}}.S/ j K.s/ 2 Ag:
(4.1)

446
CHAPTER 4. MEASURES FOR PROBABILISTIC SYSTEMS
Thus a portfolio in PK.s/ is a measurable subset of S.S/ which contains
K.s/. We observe
Lemma 4.1.16 PK W S ! E.S/ is t-measurable, whenever K W S  
S is a stochastic relation.
Proof Clearly, PK.s/ is upper closed for each s 2 S. Put TH WD
fhs; qi j H q 2 PK.s/g for H  S.S/  Œ0; 1. Thus
hs; qi 2 TH , K.s/ 2 H q , hK.s/; qi 2 H , hs; qi 2 .K  idŒ0;1/1
H

:
Because K  idŒ0;1 W S  Œ0; 1 ! S.S/  Œ0; 1 is a measurable func-
tion, H 2 }}}.S/ ˝ Œ0; 1 implies TH 2 B.S ˝ Œ0; 1/. Hence PK is
t-measurable. a
This argument extends easily to countable families of stochastic rela-
tions.
Corollary 4.1.17 Assume F D fKn j n 2 Ng is a countable family of
stochastic relations Kn W S  S; then
s 7! fA 2 }}}.S/ j Kn.s/ 2 A for some n 2 Ng;
s 7! fA 2 }}}.S/ j Kn.s/ 2 A for all n 2 Ng
deﬁne stochastic effectivity functions on S. a
The following example will be of use later on. It shows that we have
always a stochastic effectivity function at our disposal, albeit a fairly
trivial one.
Example 4.1.18 Let D W S  S be the Dirac relation x 7! ıx with ıx
as the Dirac measure on x (see Example 1.6.13); then ID WD PD deﬁnes
an effectivity function, the Dirac effectivity function. Consequently we
have W 2 ID.s/ iff ıs 2 W for W 2 }}}.S/: This is akin to assigning
each element of a set the ultraﬁlter based on it. ✌
The Dirac effectivity function will be useful for characterizing the effect
of the empty game , and it will also help in modeling the effects of the
test games associated with formula '; see Sect. 4.9.4.
We will use the construction indicated through (4.1) for generating a
model from a stochastic Kripke model, indicating that the models con-
sidered here are more general than Kripke models. The converse con-
struction is of course of interest as well: Given a model, can we deter-
mine whether or not it comes from a Kripke model? This boils down

4.1. MEASURABLE SETS AND FUNCTIONS
447
to the question under which conditions a stochastic effectivity func-
tion is generated through a stochastic relation. We will deal with this
problem now. The tools for investigating the converse to Lemma 4.1.16
come from the investigation of deduction systems for probabilistic log-
ics.
Characteristic Relations
In fact, we are given a set of portfolios and want to know under which
conditions this set is generated from a single subprobability. The sit-
uation is roughly similar to the one observed with deduction systems,
where a set of formulas is given, and one wants to know whether this set
can be constructed as valid under a suitable model. Because of the sim-
ilarity, we may take some inspiration from the work on deduction sys-
tems, and we adapt here the approach proposed by Goldblatt [Gol10].
Goldblatt works with sets of formulas while we are interested foremost
in families of sets; this permits a technically somewhat lighter approach
in the present scenario.
We ﬁrst have a look at a relation R  Œ0; 1  A which models bound-
ing probabilities from below.
Intuitively, hr; Ai 2 R is intended to
characterize a member of the set ˇˇˇA.A;  r/, i.e., a measure  with
.A/  r.
Deﬁnition 4.1.19 R  Œ0; 1  A is called a characteristic relation on
S iff these conditions are satisﬁed :
Characteris-
tic
relation
①hr; Ai 2 R; A  B
hr; Bi 2 R
②hr; Ai 2 R; r  s
hs; Ai 2 R
③hr; Ai … R; hs; Bi … R; rCs1
hrCs; A [ Bi … R
④
hr; A [ Bi 2 R; hs; A [ .SnB/i
2R; rCs1
hrCs; Ai 2 R
⑤hr; Ai 2 R; r C s > 1
hs; S n Ai … R
⑥hr; ;i 2 R
r D 0
⑦A1 	 A2 	 : : : ; 8n 2 N W hr; Ani 2 R
hr; T
n1 Ani 2 R
:
The notation adopted here for convenience and for conciseness is that of
deduction systems. For example, condition ①expresses that hr; Ai 2 R
and A  B together imply hr; Bi 2 R. The interpretations are as fol-
lows. The conditions ①and ②make sure that bounding from below is

448
CHAPTER 4. MEASURES FOR PROBABILISTIC SYSTEMS
monotone both in its numeric and in its set-valued component. By ③
and ④, we cater for sub- and superadditivity of the characteristic rela-
tion, condition ⑥sees to the fact that the probability for the impossible
event cannot be bounded from below but through 0, and ﬁnally ⑦makes
sure that if the members of a decreasing sequence of sets are uniformly
bounded below, then so is its intersection.
We show that each characteristic relation deﬁnes a subprobability mea-
sure; the proof follows mutatis mutandis, the proof of [Gol10, Theorem
5.4].
Proposition 4.1.20 Let R  Œ0; 1  A be a characteristic relation on
S, and deﬁne for A 2 A
R.A/ WD supfr 2 Œ0; 1 j hr; Ai 2 Rg:
Then R is a subprobability measure on A.
Proof 1. ⑥implies that R.;/ D 0, and R is monotone because of
①. It is also clear that R.S/  1. We obtain from ②that hs; Ai … R,
whenever s  r with hr; Ai … R.
2. Let A1; A2 2 A be arbitrary. Then
R.A1 [ A2/  R.A1/ C R.A2/:
In fact, if R.A1/CR.A2/ < q1Cq2  R.A1[A2/ with R.Ai/ <
qi .i D 1; 2/; then hqi; Aii … R for i D 1; 2. Because q1 C q2 
1, we obtain from ③that hq1 C q2; A1 [ A2i … R: By ②this yields
R.a1 [ A2/ < q1 C q2; contradicting the assumption.
3. If A1 and A2 are disjoint, we observe ﬁrst that R.A1/ C R.A2/
 1: Assume otherwise that we can ﬁnd qi  R.Ai/ for i D 1; 2 with
q1 C q2 > 1. Because hq1; A1i 2 R, we conclude from ⑤that hq2; S n
A2i … RI hence hq2; A2i … R by ①, contradicting q2  R.A2/.
This implies that
R.A1/ C R.A2/  R.A1/ C R.A2/:
Assuming this to be false, we ﬁnd q1  R.A1/; q2  R.A2/ with
R.A1 [ A2/ < q1 C q2  R.A1/ C R.A2/:
Because hq1; A1i 2 R, we ﬁnd hq1; .A1 [ A2/ \ A1i 2 R; and because
hq2; A2i 2 R, we see that hq2; .A1 [ A2/ \ .S n A1/i 2 R (note

4.1. MEASURABLE SETS AND FUNCTIONS
449
that .A1 [ A2/ \ A1 D A1 and .A1 [ A2/ \ .S n A1/ D A2, since
A1 \ A2 D ;). From ④we infer that hq1 C q2; A1 [ A2i 2 R; so that
q1 C q2  R.A1 [ A2/; which is a contradiction.
Thus we have shown that R is additive.
4. From ⑦it is obvious that
R.A/ D inf
n2N R.An/;
whenever A D T
n2N An for the decreasing sequence .An/n2N in A.
a
Thus we are in a position now to relationally characterize a subproba-
bility on A. But we can even say more, when taking subsets of }}}.S/
into account. Note that A 7! ˇˇˇA.A;  q/ is monotone for each q.
So if we ﬁx an upper closed subset Q  }}}.S/, then we know that
ˇˇˇA.A;  q/ 2 Q implies ˇˇˇA.B;  q/ 2 Q, provided A  B. We relate
Q to a characteristic relation R on S by comparing ˇˇˇA.A;  q/ 2 Q
with hq; Ai 2 R by imposing a syntactic and a semantic condition. They
will be shown to be equivalent.
Deﬁnition 4.1.21 The upper closed subset Q of }}}.S/ is said to satisfy
the characteristic relation R on S (Q ` R) iff we have
Q ` R
hq; Ai 2 R , ˇˇˇA.A;  q/ 2 Q
for any q 2 Œ0; 1 and any A 2 A.
This is a syntactic notion: We look at R and determine from the knowl-
edge of hq; Ai 2 R whether all evaluations on the measurable set A are
contained in Q. Its semantic counterpart reads like this.
Deﬁnition 4.1.22 Q is said to implement  2 S.S/ iff
.A/  q , ˇˇˇA.A;  q/ 2 Q
for any q 2 Œ0; 1 and any A 2 A. We write this as Q ˆ .
Q ˆ 
Thus we actually evaluate  at A and determine from this value the
membership of ˇˇˇA.A;  q/ in Q.
Note that Q ˆ  and Q ˆ 0 implies
8A 2 A8q  0 W .A/  q , 0.A/  q:

450
CHAPTER 4. MEASURES FOR PROBABILISTIC SYSTEMS
Consequently,  D 0, so that the measure implemented by Q is
uniquely determined.
We will show now that syntactic and semantic issues are equivalent: Q
satisﬁes a characteristic relation if and only if it implements the corre-
sponding measure.
Proposition 4.1.23 Q ` R iff Q ˆ R.
Proof Q ` R ) Q ˆ R: Assume that Q ` R holds. It is then
immediate that R.A/  r iff ˇˇˇA.A;  r/ 2 Q.
Q ˆ R ) Q ` R: If Q ˆ R for relation R  Œ0; 1  A, we show
that the conditions given in Deﬁnition 4.1.19 are satisﬁed.
1. Let ˇˇˇA.A;  r/ 2 Q and A  B; thus R.A/  r; hence
R.B/  r, which in turn implies ˇˇˇA.A;  r/ 2 Q. Hence ①
holds. ②is established similarly.
2. If R.A/ < r and R.B/ < s with r Cs  1, then R.A[B/ D
R.A/C.B/R.A\B/  R.A/CR.B/ < r Cs; which
implies ③.
3. If R.A [ B/  r and R.A [ .S n B//  s, then R.A/ D
R.A [ B/ C R.A [ .S n B//  r C sI hence ④.
4. Assume R.A/  r and r C s > 1; then R.S n A/ D R.S/ 
R.A/ < p; and thus ⑤holds.
5. If R.;/  r, then r D 0, yielding ⑥.
6. Finally, if .An/n2N is decreasing with R.An/  r for each n 2
N, then it is plain that R.T
n2N An/  r: This implies ⑦.
a
This permits a complete characterization of those stochastic effectivity
functions which are generated through stochastic relations.
Proposition 4.1.24 Let P be a stochastic effectivity frame on state
space S. Then these conditions are equivalent:
1. There exists a stochastic relation K W S  S such that P D PK.
2. R.s/ WD fhr; Ai j ˇˇˇA.A;  r/ 2 P.s/g deﬁnes a characteristic
relation on S with P.s/ ` R.s/ for each state s 2 S.

4.1. MEASURABLE SETS AND FUNCTIONS
451
Proof 1
)
2: Fix s 2 S.
Because ˇˇˇA.A;  r/ 2 PK.s/ iff
K.s/.A/  r; we see that P.s/ ˆ K.s/I hence by Proposition 4.1.23
P.s/ ` R.s/:
2 ) 1: Deﬁne K.s/ WD R.s/; for s 2 S; then K.s/ is a subproba-
bility measure on A. We show that K W S  S. Let G  S.S/ be a
measurable set, then G  Œ0; 1 2 A ˝ Œ0; 1I hence the measurability
condition on P yields that
K1
G

D fs 2 S j K.s/ 2 Gg D fs 2 S j G 2 P.s/g
is a measurable subset of S, because
fhs; qi j .GŒ0; 1/q 2 P.s/g D fs 2 S j G 2 P.s/gŒ0; 1 2 A˝Œ0; 1:
This establishes measurability. a
Morphisms and Congruences
Morphisms for stochastic effectivity functions are deﬁned in a way
very similar to the deﬁnition of morphisms for the functor V in
Example 2.3.13, or for the deﬁnition of neighborhood frames; see Def-
inition 2.7.33. We have, however, to take into consideration again that
we are dealing with the respective subprobabilities as an intermediate
layer. Hence, if we consider a measurable map f W S ! T , we must
use the induced map S.f / W S.S/ ! S.T / as an intermediary. This
leads to the following:
Deﬁnition 4.1.25 Given stochastic effectivity functions P on S and Q
on T , a measurable map f W S ! T is called a morphism of effectivity
functions f W P ! Q iff Q ı f D E.f / ı P , hence iff this diagram
commutes
Thus we have
W 2 Q.f .s// , .Sf /1
W

2 P.s/
(4.2)
for all states s 2 S and for all W 2 }}}.T /.

452
CHAPTER 4. MEASURES FOR PROBABILISTIC SYSTEMS
In comparison, recall from Deﬁnition 2.6.43 that a measurable map f W
S ! T is a morphism of stochastic relations f W K ! L for the
stochastic relations K W S  S and L W T  T iff L ı f D S.f / ı K,
hence iff this diagram commutes
Thus
L.f .s//.B/ D S.f /.K.s//.B/ D K.s/.f 1
B

/
(4.3)
for each state s 2 S and each measurable set B  T .
These notions of morphisms are compatible:
Each morphism for
stochastic relations turns into a morphism for the associated effectivity
function.
Proposition 4.1.26 A morphism f W K ! L for stochastic relations K
and L induces a morphism f W PK ! PL for the associated stochastic
effectivity functions.
Proof Fix a state s 2 S. Then W 2 PL.f .s// iff L.f .s// 2 W .
Because f W K ! L is a morphism, this is equivalent to S.f /.K.s// 2
W , hence to K.s/ 2 .Sf /1
W

; thus .Sf /1
W

2 PK.s/: a
We investigate congruences for stochastic effectivity functions next.
Since we have introduced a quantitative component into the argumen-
tation, we want to deal not only with equivalent element of the set S
on which the effectivity function is deﬁned, but we have also to take
the elements of Œ0; 1 into account. The most straightforward equiva-
lence relation of Œ0; 1 is the identity  WD Œ0;1. Given an equivalence
relation  on S, deﬁne by
˙˙˙.A/
˙˙˙.A/ WD fA 2 A j A is -invariantg
all -invariant measurable subsets of S, i.e., all A 2 A which are unions
of -equivalence classes.
Deﬁnition 4.1.27 Call the equivalence relation  on S tame iff
˙˙˙	.A ˝ B.Œ0; 1// D ˙˙˙.A/ ˝ B.Œ0; 1/
holds.

4.1. MEASURABLE SETS AND FUNCTIONS
453
Because ˙˙˙.B.Œ0; 1// D B.Œ0; 1/, we rephrase the deﬁnition that  is
tame iff
˙˙˙	.A ˝ B.Œ0; 1// D ˙˙˙.A/ ˝ ˙˙˙.B.Œ0; 1//:
Thus being tame means for an equivalence relation that it cooperates
well with the identity on Œ0; 1. From a structural point of view, tame-
ness permits us to ﬁnd a Borel isomorphism between S= ˝ Œ0; 1 and
S ˝ Œ0; 1=  , which gives further insight into the cooperation of 
and  on S  Œ0; 1. Here we go.
Lemma 4.1.28 Assume that  is a tame equivalence relation on S; the
measurable spaces .S ˝ Œ0; 1/=   and S= ˝ Œ0; 1 are Borel iso-
morphic.
Proof 0. We deﬁne the Borel isomorphism # through Œhx; qi	 7!
Outline
hŒx ; qi, which is the obvious choice. It is not difﬁcult to see that # is
a bijection and that it is measurable. The converse direction is a bit more
cumbersome and will be dealt with through the principle of good sets via
the --Theorem and the deﬁning property of tameness for .
1. We show that
# W
(
.S ˝ Œ0; 1/=  
! S= ˝ Œ0; 1
Œhs; ti	
7! hŒs ; ti
deﬁnes a measurable map. Let A  B  S= ˝ Œ0; 1 be a measurable
rectangle, 1


A

2 A and B 2 B.Œ0; 1/; then 1
	

#1
A  B

D
1


A

 B 2 A ˝ B.Œ0; 1/. Hence the inverse image of a generator
of the -algebra on S= ˝ Œ0; 1 is a measurable subset of the factor
space of A ˝ B.Œ0; 1/ under the equivalence relation   , so that #
is measurable by Lemma 4.1.4.
2. For establishing that #1 is measurable, one notes ﬁrst that B 2
˙˙˙.S/ ˝ B.Œ0; 1/ implies that .  id/

B

is a measurable subset of
S=  Œ0; 1. This is so because the set of all B for which the assertion
is true is closed under complementation and countable disjoint unions,
and it contains all measurable rectangles, so the assertion is established
by Theorem 1.6.30.
Now take H  .S ˝ Œ0; 1/=   measurable; then
1
	

H

2 ˙˙˙	.S ˝ Œ0; 1/ D ˙˙˙.S/ ˝ B.Œ0; 1/;

454
CHAPTER 4. MEASURES FOR PROBABILISTIC SYSTEMS
since  is tame. Hence .  id/1
#

H

2 ˙˙˙.S/ ˝ B.Œ0; 1/; so
the assertion follows from
#

H

D .  id/

.  id/1
#

H

:
a
Final maps (Deﬁnition 2.6.42) provide a rich source for tame relations.
Lemma 4.1.29 Let f W S ! T be surjective and measurable such that
f  id W S  Œ0; 1 ! T  Œ0; 1 is ﬁnal. Then ker .f / is tame.
Proof Because f  id is surjective and ﬁnal, we infer from Lemma
2.6.44
.f  id/1
B ˝ B.Œ0; 1/

D ˙˙˙ker.f /	.A ˝ B.Œ0; 1//:
But since f id is ﬁnal, f is ﬁnal as well; hence f 1
B

D˙˙˙ker.f /.A/,
again by Lemma 2.6.44. Thus
.f  id/1
B ˝ B.Œ0; 1/

D f 1
B

˝ B.Œ0; 1/:
This establishes the claim. a
Morphisms and congruences are as usual quite closely related, so we
are in a position now to characterize congruences through morphisms
and factorization as those equivalence relations which are related to the
structure of the underlying system. Let P be a stochastic effectivity
function on S. Congruences are deﬁned in this way.
Deﬁnition 4.1.30 The equivalence relation  on S is called a congru-
ence for P iff there exists an effectivity function P on S= which ren-
ders this diagram commutative:
Because  is onto, P is uniquely determined. The next proposition
provides a criterion for an equivalence relation to be a congruence. It
requires the equivalence relation to be tame, so that quantitative aspects
are being taken care of. The factor space S= will be equipped with the
ﬁnal -algebra with respect to the factor map , on which we will have
to consider the weak -algebra }}}.S=/.

4.1. MEASURABLE SETS AND FUNCTIONS
455
Proposition 4.1.31 Let  be a tame equivalence relation on S. Then
these statements are equivalent:
1.  is a congruence for P .
2. Whenever s  s0, we have .S/1
A

2 P.s/ iff .S/1
A

2
P.s0/ for every A 2 }}}.S=/.
The second property can be read off the diagram above, so one might
ask why this property is singled out as characteristic. Well, we have
to deﬁne a stochastic effectivity function of the factor set, and for this
to work, we need t-measurability. The proof shows where the crucial
Note
point is.
Proof 1 ) 2: This follows immediately from the deﬁnition of a mor-
phism; see (4.2).
2 ) 1: Deﬁne for s 2 S
Q.Œs/ WD fA 2 }}}.S=/ j .S/1
A

2 P.s/g;
then Q is well deﬁned by the assumption, and it is clear that Q.Œs/
is an upper closed set of subsets of }}}.S=/ for each s 2 S. It remains
to be shown that Q is a stochastic effectivity function, i.e., that Q is
t-measurable. This is the crucial property. In fact, let H 2 B.S.S=/ ˝
Crucial
Œ0; 1/ be a test set, and let G WD .S./  idŒ0;1/1
H

be its inverse
image under S./  idŒ0;1; then
fht; qi 2 S=  Œ0; 1 j H q 2 Q.t/g D .  idŒ0;1/

Z

with Z WD fhs; qi 2 S  Œ0; 1 j Gq 2 P.s/g: By Lemma 4.1.28 it is
enough to show that Z is contained in ˙˙˙.S/ ˝ B.Œ0; 1/. Because P
is t-measurable, we infer Z 2 B.S ˝ Œ0; 1/; and because Z is .  /-
invariant, we conclude that Z 2 ˙˙˙	.S ˝ Œ0; 1/; the latter -algebra
being equal to ˙˙˙.S/ ˝ B.Œ0; 1/ by deﬁnition of tameness. a
The condition on subsets of }}}.S=/ imposed above asks for measurable
subsets of S.S=/, so factorization is done “behind the curtain” of func-
tor S. It would be more convenient if the space of all subprobabilities
could be factored and the corresponding measurable sets gained from
the latter space.
The following sketch provides an alternative. Lift equivalence  on S to
an equivalence N on S.S/ upon setting
 N 0 iff 8C 2 ˙˙˙.S/ W .C/ D 0.C/;

456
CHAPTER 4. MEASURES FOR PROBABILISTIC SYSTEMS
so measures are considered N-equivalent iff they coincide on the -
invariant measurable sets. Deﬁne the map @ through
(
S.S/= N
! S.S=/
@.Œ N/
7! G:S././.G/:
Then @ ı  N D S./; so that @ is measurable by ﬁnality of  N. If S
is a Polish space and  is countably generated (thus ˙˙˙.S/ D .fAn j
n 2 Ng/ for some sequence .An/n2N with measurable An), then it can
be shown through Souslin’s Theorem 4.4.8 that @ is an isomorphism.
Hence it is in this case sufﬁcient to focus on the sets 1
N

W

with W 2
B.S.S/= N/. But, as said above, this is a sketch in which many things
have to be ﬁlled in.
The relationship of morphisms and congruences through the kernel is
characterized in the following proposition. It assumes the morphism
combined with the identity on Œ0; 1 to be ﬁnal. This is a technical con-
dition rendering the kernel of the morphism a tame equivalence rela-
tion.
Proposition 4.1.32 Given a morphism f W P ! Q for the effectivity
functions P and Q over the state spaces S resp. T , if f  idŒ0;1 W
S  Œ0; 1 ! T  Œ0; 1 is ﬁnal, then ker .f / is a congruence for P .
Proof 0. We have to show that the condition in Proposition 4.1.31 is
Idea for the
proof
satisﬁed. The key idea is that we can ﬁnd for a given H0 2}}}.S=ker .f //
a set H 2 }}}.T / which helps represent H0. But we do not take the rep-
resentation through Sf into account, but factor the space ﬁrst through
ker .f / and use the corresponding factorization Qf ı ker.f /. Using Qf is
helpful because the factor Qf transports measurable sets in a somewhat
advantageous manner. The set H is then used as a stand-in for H0, and
because we know where it comes from, we exploit its properties.
1. We know from Lemma 4.1.29 that ker .f / is a tame equivalence
relation.
2. Given H0 2 }}}.S=ker .f //, we claim that we can ﬁnd H 2 }}}.T /
such that H0 D S. Qf /1
H

; f D Qf ı ker.f / being the decomposition
of f according to Exercise 2.25. In fact, put
Z WD
˚
H0 2 }}}.S=ker .f // j 9H 2 }}}.T / W H0 D S. Qf /1
H

:
Then Z is a -algebra, because ; 2 Z and it is closed under the
countable Boolean operations as well as complementation.
Take an

4.1. MEASURABLE SETS AND FUNCTIONS
457
element of the basis for the weak -algebra, say, ˇˇˇS=ker.f /.A;  q/;
with A  S=ker .f / measurable. Because
Qf 1 is onto, there exists
B  T with A D
Qf

B

; and we know that B 2 B.T /, because f is
ﬁnal. Consequently, .A/ D S. Qf /./.B/ for any  2 S.S=ker .f //:
This implies
ˇˇˇS=ker.f /.A;  q/ D S. Qf /1
ˇˇˇB.B;  q/

2 ZI
consequently,
}}}.S=ker .f // D .fˇˇˇS=ker.f /.A;  q/ j A 2 }}}.S=ker .f //; q  0g/  ZI
thus }}}.S=ker .f // D Z:
3. Now let f .s/ D f .s0/, take H0 2 }}}.S=ker .f //, and choose H 2
}}}.T / according to part 1 for H0; then
1
ker.f /

H0

2 P.s/
, f 1
H

2 P.s/
, H 2 Q.f .s// D Q.f .s0//
, f 1
H

2 P.s0/
, 1
ker.f /

H0

2 P.s0/
because f W P ! Q is a morphism. This is what we want. a
Let us turn to the case of stochastic relations and indicate the relation-
ship of congruences and the effectivity functions generated through the
factor relation. A congruence  for a stochastic relation K W S  S
is an equivalence relation with this property: There exists a (unique)
stochastic relation K W S= ! S= such that this diagram com-
mutes:
This is the direct translation of Deﬁnition 2.6.40 in Sect. 2.6.2. The
diagram translates to
K.Œs/.B/ D K.s/.1


B

/
for all s 2 S and all B  S= measurable.
We obtain from Proposition 4.1.26
Corollary 4.1.33 A congruence  for a stochastic relation K W S  S
is also a congruence for the associated effectivity function PK. More-
over, PK D .PK/; so the effectivity function associated with the fac-
tor relation K is the factor relation of PK with respect to . a

458
CHAPTER 4. MEASURES FOR PROBABILISTIC SYSTEMS
It is noted that we do not require additional assumptions on the congru-
ence for the stochastic relation for being a congruence for the associ-
ated effectivity function. This indicates that the condition on tameness
captures the general class of effectivity functions, but that subclasses
may impose their own conditions. It indicates also that the condition
of being a congruence for a stochastic relation itself is a fairly strong
one when assessed by the rules pertaining to stochastic effectivity func-
tions.
4.1.4
The Alexandrov Topology on Spaces of Measures
Given a topological space .X; /, the Borel sets B.X/ D ./ and the
Baire sets Ba.X/ come for free as measurable structures: B./ is the
smallest -algebra on X that contains the open sets; measurability of
maps with respect to the Borel sets is referred to as Borel measurability.
Ba.X/ is the smallest -algebra on X which contains the functionally
closed sets; they provide yet another measurable structure on .X; /,
this time involving the continuous real-valued functions. Since B.X/ D
Ba.X/ for a metric space X by Example 4.1.1, the distinction between
these -algebras vanishes, and the Borel sets as the -algebra generated
by the open sets dominate the scene.
We will now deﬁne a topology of spaces of measures on a topological
space in a similar way and relate this topology to the weak -algebra,
for the time being in a special case. Fix a Hausdorff space .X; /; the
space will be specialized as the discussion proceeds. Deﬁne for the
functionally open set G, the functionally closed sets F and  > 0 for
0 2 M.X; Ba.X// the sets
WG;.0/ WD f 2 M.X; Ba.X// j .G/ > 0.G/  ; j.X/  0.X/j < g;
WF;.0/ WD f 2 M.X; Ba.X// j .F / < 0.F / C ; j.X/  0.X/j < g:
The topology which has the sets WG;.0/ for functionally open G,
equivalently, WF;.0/ for F functionally closed, as a subbasis is called
the Alexandrov topology or A-topology [Bog07, 8.10 (iv)].
Thus a
A-topology
generic base element has the shape
WG1;:::;Gn;.0/ WD
\
1in
WGi ;.0/;

4.1. MEASURABLE SETS AND FUNCTIONS
459
WF1;:::;Fn;.0/ WD
\
1in
WFi;.0/
with G1; : : : ; Gn functionally open and F1; : : : ; Fn functionally closed.
The A-topology is deﬁned in terms of the Baire sets rather than Borel
sets of .X; /. We prefer here the Baire sets, because they take the
continuous functions on .X; / directly into account. This is in general
not the case with the Borel sets, which are deﬁned purely in terms of
set-theoretic operations. But the distinction vanishes when we turn to
metric spaces, because there each closed set is functionally closed; see
Example 4.1.1. Note also that we deal with ﬁnite measures here.
Lemma 4.1.34 The A-topology on M.X; Ba.X// is Hausdorff.
Proof The family of functionally closed sets of X is closed under ﬁnite
intersections; hence if two measures coincide on the functionally closed
sets, they must coincide on the Baire sets Ba.X/ of X by the --
Theorem 1.6.30. a
Convergence in the A-topology is easily characterized in terms of func-
tionally open or functionally closed sets. Recall that for a sequence
.cn/n2N of real numbers, the statement lim supn!1 c  c is equivalent
to infn2N supkn ck  c which in turn is equivalent to
8 > 09n 2 N8k  n W ck < c C :
Similarly for lim infn!1 cn. This proves
Proposition 4.1.35 Let .n/n2N be a sequence of measures in
M.X; Ba.X//, then the following statements are equivalent:
1. n !  in the A-topology.
2. lim supn!1 n.F /  .F / for each functionally closed set F ,
and n.X/ ! .X/.
3. lim infn!1 n.G/  .G/ for each functionally open set G,
and n.X/ ! .X/.
a
This criterion is sometimes a little impractical, since it deals with in-
equalities. We could have equality in the limit for all those sets for
which the boundary has -measure zero, but, alas, the boundary may

460
CHAPTER 4. MEASURES FOR PROBABILISTIC SYSTEMS
not be Baire measurable. So we try with an approximation—we approx-
imate a Baire set from within by a functionally open set (corresponding
to the interior) and from the outside by a closed set (corresponding to
the closure). This is discussed in some detail now.
Given  2 M.X; Ba.X//, deﬁne by R all those Baire sets which have
R
a functional boundary of vanishing -measure, formally
R WD fE 2 Ba.X/ j G  E  F; .F n G/ D 0;
G functionally open; F functionally closedg:
Hence if X is a metric space, E 2 R iff .@E/ D 0 for the boundary
@E of E.
This is another criterion for convergence in the A-topology.
Corollary 4.1.36 Let .n/n2N be a sequence of the Baire measures.
Then n !  in the A-topology iff n.E/ ! .E/ for all E 2 R.
Proof The condition is necessary by Proposition 4.1.35. Assume, on the
other hand, that n.E/ ! .E/ for all E 2 R, and take a functionally
open set G. We ﬁnd f W X ! R continuous such that G D fx 2 X j
f .x/ > 0g. Fix  > 0; then we can ﬁnd c > 0 such that
.G/ < .fx 2 X j f .x/ > cg/ C ;
.fx 2 X j f .x/ > cg/ D .fx 2 X j f .x/  cg/:
Hence E WD fx 2 X j f .x/ > cg 2 R, since E is open and F WD
fx 2 X j f .x/  cg is closed with .F n E/ D 0. So n.E/ ! .E/,
by assumption, and
lim inf
n!1 n.G/  lim
n!1 n.E/ D .E/ > .G/  :
Since  > 0 was arbitrary, we infer lim infn!1 n.G/  .G/:
Because G was an arbitrary functionally open set, we infer from Propo-
sition 4.1.35 that .n/n2N converges in the A-topology to . a
The family R has some interesting properties, which will be of use
later on, because, as we will show in a moment, it contains a base for
the topology, if the space is completely regular. This holds whenever
there are enough continuous functions to separate points from closed
sets not containing them. Before we state this property, which will be
helpful in the analysis of the A-topology below, we introduce -atoms,

4.1. MEASURABLE SETS AND FUNCTIONS
461
which are of interest for themselves (we will deﬁne later, in Deﬁni-
tion 4.3.13, atoms on a strictly order theoretic basis, without reference
to measures).
Deﬁnition 4.1.37 A set A 2 A is called a -atom iff .A/ > 0 and if
.B/ 2 f0; .A/g for every B 2 A with B  A.
Thus a -atom does not permit values other than 0 and .A/ for its
measurable subsets, so two different -atoms A and A0 are essentially
disjoint, since .A \ A0/ D 0.
Lemma 4.1.38 For the ﬁnite measure space .X; A; /, there exists an
at most countable set fAi j i 2 Ig of atoms such that X n S
i2I Ai is
free of -atoms.
Proof If we do not have any atoms, we are done. Otherwise, let A1 be an
arbitrary atom. This is the beginning. Proceeding inductively, assume
that the atoms A1; : : : ; An are already selected, and let An WD fA 2 A j
A  X n Sn
iD1 Ai is an atomg: If An D ;, we are done. Otherwise se-
lect the atom AnC1 2 An with .AnC1/  1
2  supA2An .A/: Observe
that A1; : : : ; AnC1 are mutually disjoint.
Let fAi j i 2 Ig be the set of atoms selected in this way, after the
selection has terminated. Assume that A  X n S
i2I Ai is an atom;
then the index set I must be inﬁnite, and .Ai/  .A/ for all i 2 I.
But since P
i2I .Ai/  .X/ < 1; we conclude that .Ai/ ! 0,
and consequently, .A/ D 0; hence A cannot be a -atom. a
This is a useful consequence.
Corollary 4.1.39 Let f W X ! R be a continuous function. Then there
are at most countably many r 2 R such that .fx 2 X j f .x/ D
rg/ > 0.
Proof Consider the image measure M.f /./ W B 7! .f 1
B

/ on
B.R/. If .fx 2 X j f .x/ D rg/ > 0, then frg is a M.f /./-
atom. By Lemma 4.1.38, there are only countably many M.f /./-
atoms. a
Returning to R, we are now in a position to take a closer look at its
structure.
Proposition 4.1.40 R is a Boolean algebra. If .X; / is completely
regular, then R contains a basis for the topology .

462
CHAPTER 4. MEASURES FOR PROBABILISTIC SYSTEMS
Proof It is immediate that R is closed under complementation, and it
is easy to see that it is closed under ﬁnite unions.
Let f W X ! R be continuous, and deﬁne U.f; r/ WD fx 2 X j f .x/ >
rg; then U.f; r/ is open, and @U.f; r/  fx 2 X j f .x/ D rg; thus
Mf WD fr 2 R j .@U.f; r// > 0g is at most countable, such that the
sets U.f; r/ 2 R, whenever r 62 Mf .
Now let x 2 X and G be an open neighborhood of x. Because X is
completely regular (see Deﬁnition 3.3.17), we can ﬁnd f W x ! Œ0; 1
continuous such that f .y/ D 1 for all y 62 G, and f .x/ D 0. Hence we
can ﬁnd r 62 Mf such that x 2 U.f; r/  G by Corollary 4.1.39. So
R is in fact a basis for the topology. a
Under the conditions above, R contains a base for ; we lift this base
to M.X; Ba.X// in the hope of obtaining a base for the A-topology.
This works, as we will show now.
Corollary 4.1.41 Let X be a completely regular topological space; then
the A-topology has a basis consisting of sets of the form
QA1;:::;An;./ WD f 2 M.X; Ba.X// j j.Ai/  .Ai/j <  for i D 1; : : : ; ng
with  > 0, n 2 N and A1; : : : ; An 2 R.
Proof Let WG1;:::;Gn;./ with functionally open sets G1; : : : ; Gn and
 > 0 be given. Select Ai 2 R functionally open with Ai  Gi and
.Ai/ > .Gi/  =2; then it is easy to see that QA1;:::;An;=2./ 
WG1;:::;Gn;./: a
We will specialize the discussion now to metric spaces. Fix a metric
space .X; d/, the metric of which we assume to be bounded; other-
wise we would switch to the equivalent metric hx; yi 7! d.x; y/=.1 
d.x; y//. Recall that the -neighborhood B of a set B  X is deﬁned
as B WD fx 2 X j d.x; B/ < g: Thus B is always an open set.
B
Since the Baire and the Borel sets coincide in a metric space by Exam-
ple 4.1.1, the A-topology is deﬁned on M.X; B.X//, and we will relate
it to a metric now.
Deﬁne the L´evy–Prohorov distance dP .; / of the measures ;  2
M.X; B.X// through
L´evy-
Prohorov
metric dP
dP .; / WD inf
˚
 > 0 j .B/  .B/C; .B/  .B/C for all B 2 B.X/

:

4.1. MEASURABLE SETS AND FUNCTIONS
463
We note ﬁrst that dP deﬁnes a metric and that we can ﬁnd a metrically
exact copy of the base space X in the space M.X; B.X//.
Lemma 4.1.42 dP is a metric on M.X; B.X//. X is isometrically iso-
morphic to the set fıx j x 2 Xg of Dirac measures.
Proof It is clear that dP .; / D dP .; /. Let dP .; / D 0; then
.F /  .F 1=n/ C 1=n and .F /  .F 1=n/ C 1=n for each closed
set F  X; hence .F / D .F / (note that F 1 	 F 1=2 	 F 1=3 	 : : :
and F D T
n2N F 1=n). Thus  D . If we have for all B 2 B.X/
that
.B/  .B/C; .B/  .B/C and .B/  .Bı/Cı; .B/  m.Bı/Cı;
then
.B/  .BCı/ C  C ı and .B/  .BCı/ C  C ıI
thus dP .; /  dP .; / C dP .; /. We also have dP .ıx; ıy/ D
d.x; y/, from which the isometry derives. a
We will relate the metric topology to the A-topology now. Without ad-
ditional assumptions, the following relationship is established:
Proposition 4.1.43 Each open set in the A-topology is also metrically
open; hence A-topology is coarser than the metric topology.
Proof Let WF1;:::;Fn;./ be an open basic neighborhood of  in the A-
topology with F1; : : : ; Fn closed. We want to ﬁnd an open metric neigh-
borhood with center  which is contained in this A-neighborhood.
Because .F 1=n/n2N is a decreasing sequence with infn2N .Fn/ D
.F /, whenever F is closed, we ﬁnd ı > 0 such that .F ı
i / < .Fi/C
=2 for 1  i  n and 0 < ı < =2. Thus, if dP .; / < ı, we have
for i D 1; : : : ; n that .Fi/ < .F ı
i / C ı < .Fi/ C : But this means
that  2 WF1;:::;Fn;./.
Thus each neighborhood in the A-topology contains in fact an open ball
for the dP -metric. a
The converse of Proposition 4.1.43 can only be established under addi-
tional conditions, which, however, are met for separable metric spaces.
It is a generalization of -continuity: While the latter deals with se-
quences of sets, the concept of -regularity deals with the more general
notion of directed families of open sets (recall that a family M of sets

464
CHAPTER 4. MEASURES FOR PROBABILISTIC SYSTEMS
is called directed iff given M1; M2 2 M there exists M 0 2 M with
M1 [ M2  M 0).
Deﬁnition 4.1.44 A measure  2 M.X; B.X// is called -regular iff
.
[
G/ D sup
G2G
.G/
for each directed family G of open sets.
It is clear that we restrict our attention to open sets, because the union
of a directed family of arbitrary measurable sets is not necessarily mea-
surable. It is also clear that the condition above is satisﬁed for countable
increasing sequences of open sets, so that -regularity generalizes -
continuity.
It turns out that ﬁnite measures on separable metric spaces are -regular.
Roughly speaking, this is due to the fact that countably many open sets
determine the family of open sets, so that the space cannot be too large
when looked at as a measure space.
Lemma 4.1.45 Let .X; d/ be a separable metric space; then each  2
M.X; B.X// is -regular.
Proof Let G0 be a countable basis for the metric topology. If G is a
directed family of open sets, we ﬁnd for each G 2 G a countable cover
.Gi/i2IG from G0 with G D S
i2IG Gi and .G/ D supi2IG .Gi/.
Thus
.S G/ D sup 

f.G/ j G 2 G0; G  S Gg

D supG2G .G/:
a
As a trivial consequence, it is observed that .S G/ D 0, where G is the
family of all open sets G with .G/ D 0.
The important observation for our purposes is that a -regular measure
is supported by a closed set which in terms of  can be chosen as being
as tightly ﬁtting as possible.
Lemma 4.1.46 Let .X; d/ be a separable metric space. Given  2
M.X; B.X// with .X/ > 0, there exists a smallest closed set C such
that .C/ D .X/. C is called the support of  and is denoted by
supp./.
supp./

4.1. MEASURABLE SETS AND FUNCTIONS
465
We did use the support already for discrete measures; in this case the
support is just the set of points which are assigned positive mass; see
Example 2.3.11.
Proof Let F be the family of all closed sets F with .F / D .X/;
then fX n F j F 2 Fg is a directed family of open sets of measure zero;
hence .T F/ D infF 2F .F / D .X/: Deﬁne supp./ WD T F;
then supp./ is closed with .supp.// D .X/; if F  X is a closed
set with .F / D .X/, then F 2 F; hence supp./  F . a
We may characterize the support of  also in terms of open sets; this is
but a simple consequence of Lemma 4.1.46.
Corollary 4.1.47 Under the assumptions of Lemma 4.1.46, we have
x 2 supp./ iff .U / > 0 for each open neighborhood U of x. a
After all these preparations (with some interesting vistas to the land-
scape of measures), we are in a position to show that the metric topology
on M.X; B.X// coincides with the A-topology for X separable metric.
The following lemma will be the central statement; it is formulated and
proved separately, because its proof is somewhat technical. Recall from
page 345 that the diameter diam.Q/ of Q  X is deﬁned as
diam.Q/
diam.Q/ WD supfd.x1; x2/ j x1; x2 2 Qg:
Lemma 4.1.48 Every dP -ball with center  2 M.X; B.X// contains a
neighborhood of  of the A-topology, if .X; d/ is separable metric.
Proof Fix  2 M.X; B.X// and  > 0, pick ı > 0 with 4  ı < ; it
is no loss of generality to assume that .X/ D 1. Because X is sep-
arable metric, the support S WD supp./ is deﬁned by Lemma 4.1.46.
Because S is closed, we can cover S with a countable number .Vn/n2N
of open sets, the diameter of which is less than ı and .@Vn/ D 0 by
Proposition 4.1.40. Deﬁne
A1 WD V1;
An WD
n
[
iD1
Vi n
n1
[
jD1
VjI
then .An/n2N is a mutually disjoint family of sets which cover S and
for which .@An/ D 0 holds for all n 2 N. We can ﬁnd an index k such
that .Sk
iD1/ > 1  ı. Let T1; : : : ; T` be all sets which are a union of

466
CHAPTER 4. MEASURES FOR PROBABILISTIC SYSTEMS
some of the sets A1; : : : ; Ak; then
W WD WT1;:::;T`;./
is a neighborhood of  in the A-topology by Corollary 4.1.41. We claim
that dP .; / <  for all  2 W . In fact, let B 2 B.X/ be arbitrary,
and put
A WD
[
fAi j 1  i  k; Ai \ B 6D ;gI
then A is among the T s just constructed, and B \S  A[S1
iDkC1 Ai.
Moreover, we know that A  Bı, because each Ai has a diameter less
than ı. This yields
.B/ D .B \ S/  .A/ C ı < .A/ C 2  ı  .Bı/ C 2  ı:
On the other hand, we have
.B/
D .B \ S/ C .B \ .XnS//
 .A \ S1
iDkC1 Ai/ C 3  ı
 .A/ C 3  ı
 .A/ C 3  ı
 .Bı/ C 4  ı:
Hence dP .; / < 4  ı < . Thus W is contained in the open ball
centered at  with radius smaller . a
We have established
Theorem 4.1.49 The A-topology on M.X; B.X// is metrizable by the
L´evy-Skohorod metric dP , provided .X; d/ is a separable metric space.
a
We will see later that dP is not the only metric for this topology and
that these metric spaces have interesting and useful properties. Some
of these properties are best derived through an integral representation,
for which a careful study of real-valued functions is required. This is
what we are going to investigate in Sect. 4.2. But before doing this, we
have a brief and tentative look at the relation between the Borel sets for
A-topology and weak -algebra.
Lemma 4.1.50 Let X be a metric space, then the weak -algebra is
contained in the Borel sets of the A-topology. If the A-topology has a
countable basis, both -algebras are equal.
Proof Denote by C the Borel sets of the A-topology on M.X; B.X//.

4.2. REAL-VALUED FUNCTIONS
467
Since X is metric, the Baire sets and the Borel sets coincide. For each
closed set F , the evaluation map evF W  7! .F / is upper semicon-
tinuous by Proposition 4.1.35, so that the set
G WD fA 2 B.X/ j evA is C  measurableg
contains all closed sets. Because G is closed under complementation and
countable disjoint unions, we conclude that G contains B.X/. Hence
}}}.B.X//  C by minimality of }}}.B.X//.
2. Assume that the A-topology has a countable basis; then each open set
is represented as a countable union of sets of the form WG1;:::;Gn;.0/
with G1; : : : ; Gn open. But WG1;:::;Gn;.0/ 2 }}}.B.X//, so that each
open set is a member of }}}.B.X//. This implies the other inclusion.
a
We will investigate the A-topology further in Sect. 4.10 and turn to real-
valued functions now.
4.2
Real-Valued Functions
In discussing the set of all measurable and bounded functions into the
real line, we show ﬁrst that the set of all these functions is closed under
the usual algebraic operations, so that it is a vector space, and that it
is also closed under ﬁnite inﬁma and suprema, rendering it a distribu-
tive lattice; in fact, algebraic operations and order are compatible. Then
we show that the measurable step functions are dense with respect to
pointwise convergence. This is an important observation, which will
help us later on to transfer relevant properties from indicator functions
(a.k.a. measurable sets) to general measurable functions. This prepares
the stage for discussing convergence of functions in the presence of a
measure. We will deal with convergence almost everywhere, which ne-
glects a set of measure zero for the purposes of convergence, and con-
vergence in measure, which is deﬁned in terms of a pseudometric, but
surprisingly turns out to be related to convergence almost everywhere
through subsequences of subsequences (this sounds a bit mysterious,
but carry on).
Lemma 4.2.1 Let f; g W X ! R be A-B.R/-measurable functions for
the measurable space .X; A/. Then f ^ g, f _ g and ˛  f C ˇ  g are
A-B.R/-measurable for ˛; ˇ 2 R.

468
CHAPTER 4. MEASURES FOR PROBABILISTIC SYSTEMS
Proof If f is measurable, ˛  f is. This follows immediately from
Lemma 4.1.4. From
fx 2 X j f .x/ C g.x/ < qg
D
[
r1;r22Q;r1Cr2q

fx j f .x/ < r1g \ fx j g.x/ < r2g

;
we conclude that the sum of measurable functions is measurable again.
Since
fx 2 X j .f ^ g/.x/ < qg D fx j f .x/ < qg [ fx j g.x/ < qg
fx 2 X j .f _ g/.x/ < qg D fx j f .x/ < qg \ fx j g.x/ < qg;
we see that both f ^ g and f _ g are measurable. a
Corollary 4.2.2 If f W X ! R is A-B.R/-measurable, so is jf j.
Proof Write jf j D f C  f  with f C WD f _ 0 and f  WD .f / _ 0.
a
The consequence is that for a measurable space .X; A/, the set
F.X; A/
F.X; A/ WD ff W N ! R j f is A  B.R/ measurableg
is both a vector space and a distributive lattice; in fact, it is what will be
called a vector lattice later; see Deﬁnition 4.8.10 on page 550. Assume
that .fn/n2N  F.X; A/ is a sequence of bounded measurable func-
tions such that f W x 7! lim infn!1 fn.x/ is a bounded function; then
f 2 F.X; A/. This is so because
fx 2 X j lim inf
n!1 fn.x/  qg D fx j sup
n2N
inf
kn fk.x/  qg
D
\
n2N
fx j inf
kn fk.x/  qg
D
\
n2N
\
`2N
fx j inf
kn fk.x/ < q C 1=`g
D
\
n2N
\
`2N
[
kn
fx j fk.x/ < q C 1=`g:
Similarly, if x 7! lim supn!1 fn.x/ deﬁnes a bounded function, then
it is measurable as well. Consequently, if the sequence .fn.x//n2N con-
verges to a bounded function f , then f 2 F.X; A/.
Hence we have shown

4.2. REAL-VALUED FUNCTIONS
469
Proposition 4.2.3 Let .fn/n2N  F.X; A/ be a sequence of bounded
measurable functions. Then
 If f.x/ WD lim infn!1 fn.x/ deﬁnes a bounded function, then
f 2 F.X; A/,
 If f .x/ WD lim supn!1 fn.x/ deﬁnes a bounded function, then
f  2 F.X; A/.
a
We use occasionally the representation of sets through indicator func-
tions. Recall for A  X its indicator function
A.x/ WD
(
1;
if x 2 A;
0;
if x … A:
Clearly, if A is a -algebra on X, then A 2 A iff A is a A-B.R/-
measurable function. This is so since we have for the inverse image of
an interval under A
1
A

Œ0; q

D
8
ˆ<
ˆ:
;;
if q < 0;
X n A;
if 0  q < 1;
X;
if q  1:
A measurable step function
Step function
f D
n
X
iD1
˛i  Ai
is a linear combination of indicator functions with Ai 2 A. Since A 2
F.X; A/ for A 2 A, measurable step functions are indeed measurable
functions.
Proposition 4.2.4 Let .X; A/ be a measurable space. Then
1. For f
2 F.X; A/ with f
 0, there exists an increasing
sequence .fn/n2N of step functions fn 2 F.X; A/ with
f .x/ D sup
n2N
fn.x/
for all x 2 X:

470
CHAPTER 4. MEASURES FOR PROBABILISTIC SYSTEMS
2. For f 2 F.X; A/, there exists a sequence .fn/n2N of step func-
tions fn 2 F.N; A/ with
f .x/ D lim
n!1 fn.x/
for all x 2 X:
Proof 1. Take f  0, and assume without loss of generality that f  1
(otherwise, if 0  f  m, consider f=m). Put
Ai;n WD fx 2 X j i=n  f .x/ < .i C 1/=ng;
for n 2 N, 0  i  n, then Ai;n 2 A, since f is measurable. De-
ﬁne
fn.x/ WD
X
0i<2n
i  2nAi;2n:
Then fn is a measurable step function, and fn  f ; moreover .fn/n2N
is increasing. This is so because given n 2 N; x 2 X, we can ﬁnd
i such that x 2 Ai;2n D A2i;2nC1 [ A2iC1;2nC1. If f .x/ < .2i C
1/=2nC1, we have x 2 A2i;2nC1 with fn.x/ D fnC1.x/; if, however,
.2i C 1/=2nC1  f .x/, we have fn.x/ < fnC1.x/.
Given  > 0, choose n0 2 N with 2n <  for n  n0. Let x 2 X; n 
n0, then x 2 Ai;2n for some i; hence jfn.x/  f .x/j D f .x/  i2n <
2n < . Thus f D supn2N fn.
2. Given f 2 F.X; A/, write f1 WD f ^ 0 and f2 WD f _ 0, then f D
f1 C f2 with f1  0 and f2  0 as measurable and bounded functions.
Hence f2 D supn2N gn D limn!1 gn and f1 D  supn2N hn D
 limn!1 hn for increasing sequences of step functions .gn/n2N and
.hn/n2N. Thus f D limn!1.gn C hn/, and gn C hn is a step function
for each n 2 N. a
Given f W X ! R with f  0, the set fhx; qi 2 XR j 0  f .x/  qg
can be visualized as the area between the X-axis and the graph of the
function. We obtain as a consequence that this set is measurable, pro-
vided f is measurable. This gives an example of a product measurable
set. To be speciﬁc
Corollary 4.2.5 Let f W X ! R with f  0 be a bounded measurable
function for a measurable space .X; A/, and deﬁne
C‰.f / WD fhx; qi j q  0 and ‰ f .x/g  X  R

4.2. REAL-VALUED FUNCTIONS
471
for the relational operator ‰ taken from f; <; D; 6D; >; g.
Then
C‰.f / 2 A ˝ B.R/.
Proof We prove the assertion for C.f / WD C<.f /, from which the other
cases may easily be derived, e.g.,
C.f / D
\
k2N
fhx; qi j f .x/ < q C 1=kg D
\
k2N
C<.f  1=k/:
Consider these cases:
 If f D A with A 2 A, then C.f / D X n A  f0g [ A  Œ0; 1Œ2
A ˝ B.R/:
 If f is represented as a step function with a ﬁnite number of mu-
tually disjoint steps, say, f D Pk
iD1 ri  Ai with ri  0 and all
Ai 2 A, then
C.f / D

X n
k
[
iD1
Ai

 f0g [
k
[
iD1
Ai  Œ0; riŒ 2 A ˝ B.R/:
 If f is represented as a monotone limit of step function .fn/n2N
with fn  0 according to Proposition 4.2.4, then C.f / D S
n2N
C.fn/I thus C.f / 2 A ˝ B.R/.
a
This is a simple ﬁrst application. We look at the evaluation of a measure
at a certain set and want the value to be not smaller than a given thresh-
old. The pairs of measures and corresponding thresholds constitute a
product measurable set, to be speciﬁc
Example 4.2.6 Given a measurable space .X; A/ and the measurable
set A 2 A, the set fh; ri 2 M.X; A/  RC j .A/ ‰ rg is a member
of }}}.X; A/˝B.R/. This is so by Corollary 4.2.5, since evA is}}}.X; A/-
˝B.R/-measurable. ✌
We obtain also measurability of the validity sets for the simple modal
logic discussed above.
Example 4.2.7 Consider the simple modal logic in Example 4.1.11,
interpreted through a transition kernel M W .X; A/  .X; A/. Given a
formula ', the set fhx; ri j M.x/.ŒŒ'M/  rg is a member of A˝B.R/,
from which ŒŒÞq'M may be extracted through a horizontal cut at q (see

472
CHAPTER 4. MEASURES FOR PROBABILISTIC SYSTEMS
page 437). Hence this observation generalizes measurability of ŒŒM,
one of the cornerstones for interpreting modal logics probabilistically.
✌
We will turn now to the interplay of measurable functions and measures
and have a look at different modes of convergence for sequences of mea-
surable functions in the presence of a (ﬁnite) measure.
4.2.1
Essentially Bounded Functions
Fix for this section a ﬁnite measure space .X; A; /. We say that a mea-
surable property holds -almost everywhere (abbreviated as -a.e.) iff
-a.e.
the set on which the property does not hold has -measure zero.
The measurable function f 2 F.X; A/ is called -essentially bounded
iff
jjf jj
1 WD inffa 2 R j jf j  ag < 1;
where f  a indicates that f  a holds -a.e. Thus a -essentially
bounded function may occasionally take arbitrary large values, but the
set of these values must be negligible in terms of .
The set
L1./ WD L1.X; A; / WD ff 2 F.X; A/ j jjf jj
1 < 1g
of all -essentially bounded functions is a real vector space, and we
have for jjjj
1 these properties.
Lemma 4.2.8 Let f; g 2 F.X; A/ be essentially bounded, ˛; ˇ 2 R,
then jjjj
1 is a pseudo-norm on F.X; A/, i.e.,
1. If jjf jj
1 D 0, then f D 0.
2. jj˛  f jj
1 D j˛j  jjf jj
1,
3. jjf C gjj
1  jjf jj
1 C jjgjj
1.
Proof If jjf jj
1 D 0, we have jf j  1=n for all n 2 N, so that
fx 2 X j jf .x/j 6D 0g 
[
n2N
fx 2 X j jf .x/j  1=ngI
consequently, f D 0. The converse is trivial. The second property
follows from jf j  a iff j˛  f j  j˛j  a and the third one from the

4.2. REAL-VALUED FUNCTIONS
473
observation that jf j  a and jgj  b implies jf Cgj  jf jCjgj 
a C b. a
So jjjj
1 nearly a norm, but the crucial property that the norm for a vec-
tor is zero only if the vector is zero is missing. We factor L1.X; A; /
with respect to the equivalence relation D; then the set
L1./ WD L1.X; A; / WD fŒf  j f 2 L1.X; A; /g
of all equivalence classes Œf  of -essentially bounded measurable func-
tions is a vector space again. This is so because f D g and f 0 D g0
together imply f C f 0 D g C g0 and f D g implies ˛  f D ˛  g
for all ˛ 2 R. Moreover,
jj Œf  jj
1 WD jjf jj
1
deﬁnes a norm on this space. For easier reading, we will identify in the
sequel f with its class Œf .
We obtain in this way a normed vector space, which is complete with
respect to this norm; see Deﬁnition 3.6.40 on page 389.
Proposition 4.2.9 .L1./; jjjj
1/ is a Banach space.
Proof Let .fn/n2N be a Cauchy sequence in L1.X; A; /, and de-
ﬁne
N WD
[
n1;n22N
fx 2 X j jfn1.x/  fn2.x/j > jjfn1  fn2jj
1gI
then .N / D 0.
Put gn WD XnN  fn; then .gn/n2N converges
uniformly with respect to the supremum norm jjjj1 to some element
g 2 F.X; A/; hence also jjfn  gjj
1 ! 0. Clearly, g is bounded.
a
This is the ﬁrst instance of a vector space intimately connected with a
measure space. We will encounter several of these spaces in Sect. 4.11
and discuss them in greater detail, when integration is at our disposal.
The convergence of a sequence of measurable functions into R in the
presence of a ﬁnite measure is discussed now. Without a measure, we
may use pointwise or uniform convergence for modeling approxima-
tions. Recall that pointwise convergence of a sequence .fn/n2N of func-
tions to a function f is given by
8x 2 X W lim
n!1 fn.x/ D f .x/;
(4.4)

474
CHAPTER 4. MEASURES FOR PROBABILISTIC SYSTEMS
and the stronger form of uniform convergence through
lim
n!1 jjfn  f jj1 D 0;
with jjjj1 as the supremum norm, given by
jjf jj1 WD sup
x2X
jf .x/j:
We will weaken the ﬁrst condition (4.4) to hold not everywhere but al-
most everywhere, so that the set on which it does not hold will be a set
of measure zero. This leads to the notion of convergence almost every-
where, which will turn out to be quite close to uniform convergence, as
we will see when discussing Egorov’s Theorem. Convergence almost
everywhere will be weakened to convergence in measure, for which we
will deﬁne a pseudometric. This in turn gives rise to another Banach
space upon factoring.
4.2.2
Convergence Almost Everywhere and in Measure
Recall that we work in a ﬁnite measure space .X; A; /. The sequence
.fn/n2N of measurable functions fn 2 F.X; A/ is said to converge
almost everywhere to a function f 2 F.X; A/ (written as fn
a:e:
! f )
fn
a:e:
! f
iff the sequence .fn.x//n2N converges pointwise to f .x/ for every x
outside a set of measure zero. Thus we have .X n K/ D 0, where
K WD fx 2 X j fn.x/ ! f .x/g. Because
K D
\
n2N
[
m2N
\
`m
fx 2 X j jf`.x/  f .x/j < 1=ng;
K is a measurable set. It is clear that fn
a:e:
! f and fn
a:e:
! f 0 imply
f D f 0.
The next lemma shows that convergence everywhere is compatible with
the common algebraic operations on F.X; A/ like addition, scalar mul-
tiplication, and the lattice operations. Since these functions can be rep-
resented as continuous function of several variables, we formulate this
closure property abstractly in terms of compositions with continuous
functions.
Lemma 4.2.10 Let fi;n
a:e:
! fi for 1  i  k, and assume that g W
Rk ! R is continuous. Then g ı.f1;n; : : : ; fk;n/
a:e:
! g ı.f1; : : : ; fk/.

4.2. REAL-VALUED FUNCTIONS
475
Proof Put hn WD gı.f1;n; : : : ; fk;n/. Since g is continuous, we have
fx 2 X j

hn.x/

n2N does not convergeg

k
[
jD1
fx 2 X j

fj;n.x/

n2N does not convergegI
hence the set on the left-hand side has measure zero. a
Intuitively, convergence almost everywhere means that the measure of
the set
[
nk
fx 2 X j jfn.x/  f .x/j > g
tends to zero, as k ! 1, so we are coming closer and closer to the
limit function, albeit on a set the measure of which becomes smaller and
smaller. We show that this intuitive understanding yields an adequate
model for this kind of convergence.
Lemma 4.2.11 Let .fn/n2N be a sequence of functions in F.X; A/ and
f 2 F.X; A/. Then the following conditions are equivalent:
1. fn
a:e:
! f .
2. limk!1 
S
nkfx 2 X j jfn.x/  f .x/j > g

D 0 for every
 > 0.
Proof 0. Let us ﬁrst write down what the equality in property 2 really
Plan
means; then the proof will be nearly straightforward.
1. Let  > 0 be given; then there exists k 2 N with 1=k < , so
that
lim
k!1 
 [
nk
fx 2 X j jfn.x/  f .x/j > g

./
D 
T
k2N
S
nkfx 2 X j jfn.x/  f .x/j > g

 .fx 2 X j .fn.x//n2N does not convergeg/:
2. Now assume that fn
a:e:
! f ; then the implication 1 ) 2 is immedi-
ate. If, however, fn
a:e:
! f is false, then we ﬁnd for each  > 0 so that
for all k 2 N, there exists n  k with .fx 2 X j jfn.x/  f .x/j 
g/ > 0. Thus property 2 cannot hold. a

476
CHAPTER 4. MEASURES FOR PROBABILISTIC SYSTEMS
Note that the statement above requires a ﬁnite measure space, because
the measure of a decreasing sequence of sets is the inﬁmum of the indi-
vidual measures, used in the equation marked ./. This is not necessar-
ily valid for nonﬁnite measure space.
The characterization implies that a.e.-Cauchy sequences converge.
Corollary 4.2.12 An a.e.-Cauchy sequence .fn/n2N in F.X; A/ con-
verges almost everywhere to some f 2 F.X; A/.
Proof Because .fn/n2N is an a.e.-Cauchy sequence, we have that .X n
K/ D 0 for every  > 0, where
K WD
\
k2N
[
n;mk
fx 2 X j jfn.x/  fm.x/j > g:
Put
N WD
[
k2N
K1=k;
gn WD fn  XnN I
then .gn/n2N is a Cauchy sequence in F.X; A/ which converges point-
wise to some f 2 F.X; A/. Since .X n N / D 0, fn
a:e:
! f follows.
a
Convergence a.e. is very nearly uniform convergence, where very nearly
serves to indicate that the set on which uniform convergence is violated
is arbitrarily small. To be speciﬁc, we ﬁnd for each threshold a set the
complement of which has a measure smaller than this bound, on which
convergence is uniform. This is what Egorov’s Theorem says.
Proposition 4.2.13 Let fn
a:e:
! f for fn; f 2 F.X; A/. Given  > 0,
there exists A 2 A such that
Egorov’s
Theorem
1. supx2A jfn.x/  f .x/j ! 0,
2. .X n A/ < .
The idea of the proof is that we investigate the set of all x for which
uniform convergence is spoiled by 1=k. This set can be made arbitrarily
small in terms of , so the countable union of all these sets can be made
Plan of
attack

4.2. REAL-VALUED FUNCTIONS
477
as small as we want. Outside this set we have uniform convergence. Let
us look at a more formal treatment now.
Proof Fix  > 0; then there exists for each k 2 N an index nk 2 N such
that .Bk/ < =2kC1 with
Bk WD S
mnkfx 2 X j jfm.x/  f .x/j > 1=kg:
Now put A WD T
k2N.X n Bk/; then
.X n A/  P
k2N .Bk/  ;
and we have for all k 2 N
sup
x2A
jfn.x/  f .x/j  sup
x62Bk
jfn.x/  f .x/j  1=k
for n  nk. Thus
lim
n!1 sup
x2A
jfn.x/  f .x/j D 0;
as claimed. a
Convergence almost everywhere makes sure that the set on which a
sequence of functions does not converge has measure zero, and Egorov’s
Theorem shows that this is almost uniform convergence.
Convergence in measure for a ﬁnite measure space .X; A; / takes an-
other approach: Fix  > 0, and consider the set fx 2 X j jfn.x/ 
f .x/j > g. If the measure of this set (for a ﬁxed, but arbitrary ) tends
to zero, as n ! 1, then we say that .fn/n2N converges in measure to
f , and write fn
i:m:
! f . In order to have a closer look at this notion of
fn
i:m:
! f
convergence, we note that it is invariant against equality almost every-
where: If fn D gn and f D g, then fn
i:m:
! f implies gn
i:m:
! g,
and vice versa.
We will introduce a pseudometric ı on F.X; A/ ﬁrst:
ı.f; g/ WD inf
˚
 > 0 j .fx 2 X j jf .x/  g.x/j > g  

:

478
CHAPTER 4. MEASURES FOR PROBABILISTIC SYSTEMS
These are some elementary properties of ı:
Lemma 4.2.14 Let f; g; h 2 F.X; A/; then we have
1. ı.f; g/ D 0 iff f D g,
2. ı.f; g/ D ı.g; f /,
3. ı.f; g/  ı.f; h/ C ı.h; g/.
Proof If ı.f; g/ D 0, but f 6D g, there exists k with .fx 2 X j
jf .x/  g.x/j > 1=kg/ > 1=k. This is a contradiction. The other di-
rection is trivial. Symmetry of ı is also trivial, so the triangle inequality
remains to be shown. If jf .x/g.x/j > 1C2, then jf .x/h.x/j > 1
or jh.x/  g.x/j > 2; thus
.fx 2 X j jf .x/  g.x/j > 1 C 2g/  .fx 2 X j jf .x/  h.x/j > 1g/
C .fx 2 X j jh.x/  g.x/j > 2g/:
This implies the third property. a
This, then, is the formal deﬁnition of convergence in measure:
Deﬁnition 4.2.15 The sequence .fn/n2N in F.X; A/ is said to converge
in measure to f 2 F.X; A/ (written as fn
i:m:
! f ) iff ı.fn; f / ! 0, as
fn
i:m:
! f
n ! 1.
We can express convergence in measure in terms of convergence almost
everywhere.
Proposition 4.2.16 .fn/n2N converges in measure to f iff each subse-
quence of .fn/n2N contains a subsequence .hn/n2N with hn
a:e:
! f .
Proof The proposal singling out a subsequence from a subsequence
rather than from the sequence proper appears strange. The proof will
show that we need a subsequence to “prime the pump,” i.e., to get go-
ing.
“)”: Assume fn
i:m:
! f , and let  > 0 be arbitrary but ﬁxed. Let
.gn/n2N be an arbitrary subsequence of .fn/n2N. We ﬁnd a se-
quence of indices n1 < n2 < : : : such that
.fx 2 X j jgnk.x/  f .x/j > g/ < 1=k2:

4.2. REAL-VALUED FUNCTIONS
479
Let hk WD gnk, then we obtain
.S
k`fx 2 X j jhk  f j > g/  P
k`
1
k2 ! 0;
as ` ! 1. Hence hk
a:e:
! f .
“(”: If ı.fn; f / 6! 0, we can ﬁnd a subsequence .fnk/k2N and r > 0
such that for all k 2 N, .fx 2 X j jfnk.x/  f .x/j > rg/ > r
holds. Let .gn/n2N be a subsequence of this subsequence; then
lim
n!1 .fx 2 X j jgn  f j > rg/
 lim
n!1 .
[
mn
fx 2 X j jgm  f j > rg/ D 0
by Lemma 4.2.11. This is a contradiction.
a
Hence convergence almost everywhere implies convergence in measure.
Just for the record
Corollary 4.2.17 If .fn/n2N converges almost everywhere to f , then
the sequence converges also in measure to f . a
The converse relationship is a bit more involved. Intuitively, a sequence
which converges in measure need not converge almost everywhere.
Example 4.2.18 Let Ai;n WD Œ.i 1/=n; i=n for n 2 N and 1  i  n,
and consider the sequence
.fn/n2N WD hA1;1; A1;2; A2;2; A3;1; A3;2; A3;3; : : :i;
so that in general
A1;n; : : : ; An;n
is followed by
A1;nC1; : : : ; AnC1;nC1:
Let  be the Lebesgue measure  on B.Œ0; 1/. Given  > 0, .fx 2
Œ0; 1 j fn.x/ > g/ can be made arbitrarily small for any given  > 0;
hence fn
i:m:
! 0. On the other hand,

fn.x/

n2N fails to converge for
any x 2 Œ0; 1, so fn
a:e:
! 0 is false. ✌
We have, however, this observation, which draws atom into our game.

480
CHAPTER 4. MEASURES FOR PROBABILISTIC SYSTEMS
Proposition 4.2.19 Let .Ai/i2I be the at most countable collection of
-atoms according to Lemma 4.1.38 such that B WD X n S
i2I Ai does
not contain any atoms. Then these conditions are equivalent:
1. Convergence in measure implies convergence almost everywhere.
2. .B/ D 0.
Proof 1 ) 2: Assume that .B/ > 0; then we know that for each k 2
N there exist mutually disjoint measurable subsets B1;k; : : : ; Bk;k of B
such that .Bi;k/ D 1=k  .B/ and B D S
1ik Bi;k. This is so be-
cause B does not contain any atoms. Deﬁne as in Example 4.2.18
.fn/n2N WD hB1;1; B1;2; B2;2; B3;1; B3;2; B3;3; : : :i;
so that in general
B1;n; : : : ; Bn;n
is followed by
B1;nC1; : : : ; BnC1;nC1:
Because .fx 2 X j fn.x/ > g can be made arbitrarily small for any
positive , we ﬁnd fn
i:m:
! 0. If we assume that convergence in measure
implies convergence almost everywhere, we have fn
a:e:
! 0, but this is
false, because lim infn!1 fn D 0 and lim supn!1 fn D B. Thus we
arrive at a contradiction.
2 ) 1: Let .fn/n2N be a sequence with fn
i:m:
! f . Fix an atom Ai;
then .fx 2 Ai j jfn.x/  f .x/j > 1=kg/ D 0 for all n  nk with
nk suitably chosen; this is so because Ai is an atom; hence measurable
subsets of Ai take only the values 0 and .Ai/. Put
g WD inf
n2N
sup
n1;n2n
jfn1  fn2jI
then g.x/ 6D 0 iff .fn.x//n2N does not converge to f .x/. We infer
.fx 2 Ai j g.x/  2=kg/ D 0. Because the family .Ai/i2I is
mutually disjoint, we conclude that .fx 2 X j g.x/  2=kg/ D 0 for
all k 2 N. But now look at this
.fx 2 X j lim inf
n!1 fn.x/ < lim sup
n!1
fn.x/g D .fx 2 X j g.x/ > 0g/ D 0:
Consequently, fn
a:e:
! f . a

4.2. REAL-VALUED FUNCTIONS
481
Again we want to be sure that convergence in measure is preserved by
the usual algebraic operations like addition or taking the inﬁmum, so we
state as a counterpart to Lemma 4.2.10 now as an easy consequence of
Proposition 4.2.16.
Lemma 4.2.20 Let fi;n
i:m:
! fi for 1  i  k, and assume that g W
Rk ! R is continuous. Then g ı.f1;n; : : : ; fk;n/
i:m:
! g ı.f1; : : : ; fk/.
Proof By iteratively selecting subsequences, we can ﬁnd subsequences
.hi;n/n2N such that hi;n
a:e:
! fi, as n ! 1 for 1  i  k. Then apply
Lemma 4.2.10 and Proposition 4.2.16. a
We are in a position now to establish that convergence in measure ac-
tually yields a Banach space. But we have to be careful with functions
which differ on a set of measure zero, rendering the resulting space non-
Hausdorff. Since functions which are equal except on a set of measure
zero may be considered to be equal, we simply factor them out, obtain-
ing F.X; A/ as the factor space F.X; A/=D of the space F.X; A/ of
F.X; A/
all measurable functions with respect to D. Then this is a real vec-
tor space again, because the algebraic operations on the equivalence
classes are well deﬁned. Note that we have ı.f; g/ D ı.f 0; g0/, pro-
vided f D g and f 0 D g0. We identify again the class Œf  with f .
Deﬁne
jjf jj WD ı.f; 0/
for f 2 F.X; A/.
Proposition 4.2.21

F.X; A/; jj  jj

is a Banach space.
Proof 1. It follows from Lemma 4.2.14 and the observation ı.f; 0/ D
0 , f D 0 that jj  jj is a norm, so we have to show that F.X; A/ is
complete with this norm.
2. Let .fn/n2N be a Cauchy sequence in F.X; A/; then we can ﬁnd a
strictly increasing sequence .`n/n2N of integers such that ı.f`n; f`nC1/
 1=n2; hence


fx 2 X j jf`n.x/  f`nC1.x/j > 1=n2g

 1=n2:

482
CHAPTER 4. MEASURES FOR PROBABILISTIC SYSTEMS
Let  > 0 be given; then there exists r 2 N with P
nr 1=n2 < ; hence
we have
\
n2N
[
m;kn
fx 2 X j jf`m.x/  f`k.x/j > g

[
nk
fx 2 X j jf`n.x/  f`nC1.x/j < 1=n2g;
if k  r. Thus

T
n2N
S
m;knfx 2 X j jf`m.x/  f`k.x/j > g

 P
nk 1=n2 ! 0;
as k ! 1. Hence .f`n/n2N is an a.e.Cauchy sequence which converges
a.e. to some f 2 F.X; A/, which by Proposition 4.2.16 implies that
fn
i:m:
! f . a
A consequence of

F.X; A/; jjjj

being a Banach space is that F.X; A/
is complete with respect to convergence in measure for any ﬁnite mea-
sure  on A. Thus for any sequence .fn/n2N of functions such that
for any given  > 0, there exists n0 such that .fx 2 X j jfn.x/ 
fm.x/j > g/ <  for all n; m  n0, we can ﬁnd f 2 F.X; A/ such
that fn
i:m:
! f with respect to .
We will deal with measurable real-valued functions again and in greater
detail in Sect. 4.11; then we will have integration as a powerful tool at
our disposal, and we will know more about Hilbert spaces.
Now we turn to the study of -algebras and focus on those which have
a countable set as their generator.
4.3
Countably Generated -Algebras
Fix a measurable space .X; A/. The -algebra A is said to be countably
generated iff there exists countable A0 such that A D .A0/.
Example 4.3.1 Let .X; / be a topological space with a countable
basis. Then B.X/ is countably generated. In fact, if 0 is the count-
able basis for , then each open set G can be written as G D S
n2N Gn
with .Gn/n2N  0, and thus each open set is an element of .0/;
consequently, B.X/ D .0/. ✌

4.3. COUNTABLY GENERATED -ALGEBRAS
483
The observation in Example 4.3.1 implies that the Borel sets for a sep-
arable metric space, in particular for the Polish spaces soon to be intro-
duced, are countably generated. Having a countable dense subset for a
metric space, we can use the corresponding base for a fairly helpful char-
acterization of the Borel sets. The next lemma says that the Borel sets
are in this case generated by a countable collection of open balls.
Lemma 4.3.2 Let X be a separable metric space with metric d. B.x; r/
is the open ball with radius r and center x. Then
B.X/ D .fB.x; r/ j r > 0 rational; x 2 Dg/;
where D is countable and dense.
Proof Because an open ball is an open set, we infer that
.fB.x; r/ j r > 0 rational; x 2 Dg/  B.X/:
Conversely, let G be open. Then there exists a sequence .Bn/n2N of
open balls with rational radii such that S
n2N Bn D G; accounting for
the other inclusion. a
Also the characterization of Borel sets in a metric space as the closure
of the open (closed) sets under countable unions and countable intersec-
tions will be occasionally helpful.
Lemma 4.3.3 The Borel sets in a metric space X are the smallest col-
lection of sets that contains the open (closed) sets and that are closed
under countable unions and countable intersections.
Proof The smallest collection G of sets that contains the open sets and
that is closed under countable unions and countable intersections is
closed under complementation. This is so since each closed set F can be
written as the countable intersection T
n2Nfx 2 X j d.x; F / < 1=ng of
open sets; in other words, F is a Gı-set (see page 346). Thus B.X/  G;
on the other hand, G  B.X/ by construction. a
The property of being countably generated is, however, not hereditary
for a -algebra—a sub--algebra of a countably generated -algebra is
not necessarily countably generated. This is demonstrated by the fol-
lowing example. Incidentally, we will see in Example 4.4.28 that the
intersection of two countably generated -algebras need not be count-
ably generated again. This indicates that having a countable generator
is a ﬁckle property which has to be observed closely.

484
CHAPTER 4. MEASURES FOR PROBABILISTIC SYSTEMS
Example 4.3.4 Let
C WD fA  R j A or R n A is countableg:
This -algebra is usually referred to the countable–cocountable
-algebra. Clearly, C  B.R/, and B.R/ is countably generated by
Example 4.3.1. But C is not countably generated. Assume that it is, so
let C0 be a countable generator for C; we may assume that every element
of C0 is countable. Put A WD S C0; then A 2 C, since A is countable.
But
D WD fB  R j B  A or B  R n Ag
is a -algebra, and D D .C0/. On the other hand, there exists a 2 R
with a 62 A; thus A [ fag 2 C, but A [ fag 62 D, a contradiction. ✌
Although the entire -algebra may not be countably generated, we ﬁnd
for each element of a -algebra a countable generator:
Lemma 4.3.5 Let A be a -algebra on a set X which is generated by
family G of subsets. Then we can ﬁnd for each A 2 A a countable subset
G0  G such that A 2 .G0/.
Proof Let D be the set of all A 2 A for which the assertion is true;
then D is closed under complements, and G  A. Moreover, D is
closed under countable unions, since the union of a countable family
of countable sets is countable again. Hence D is a -algebra which
contains G; hence it contains A D .G/. a
This has a fairly interesting and somewhat unexpected consequence,
which will be of use later on. Recall from page 436 or from Exam-
ple 2.2.4 that A ˝ B is the smallest -algebra on X  Y which contains
for measurable spaces .X; A/ and .Y; B/ all measurable rectangles AB
with A 2 A and B 2 B. In particular, P .X/ ˝ P .X/ is generated by
fAB j A; B  Xg. One may be tempted to assume that this -algebra
is the same as P .X  X/, but this is not always the case, because we
have
Proposition 4.3.6 Denote by X the diagonal fhx; xi j x 2 Xg for a
set X. Then X 2 P .X/ ˝ P .X/ implies that the cardinality of X
does not exceed that of P .N/.
Proof Assume X 2 P .X/ ˝ P .X/; then there exists a countable
family C  P .X/ such that X 2 .fA  B j A; B 2 Cg/. The map
q W x 7! fC 2 C j x 2 Cg from X to P .C/ is injective. In fact, suppose

4.3. COUNTABLY GENERATED -ALGEBRAS
485
it is not; then there exists x 6D x0 with x 2 C , x0 2 C for all C 2 C,
so we have for all C 2 C that either fx; x0g  C or fx; x0g \ C D ;,
so that the pairs hx; xi and hx0; x0i never occur alone in any A  B with
A; B 2 C. Hence X cannot be a member of .fA  B j A; B 2 Cg/,
a contradiction. As a consequence, X cannot have more elements that
P .N/. a
Now we are in a position to show that we cannot conclude from the fact
for a subset S  X  Y that S is product measurable whenever all its
cuts are measurable; see Lemma 4.1.8.
Example 4.3.7 Let X be a set, the cardinality of which is greater than
that of P .N/, and let  WD fhx; xi j x 2 Xg  X  X be the diagonal
of X. Then x D fxg D x for all x 2 X; thus x and x are both
members of P .X/, but  62 P .X/ ˝ P .X/ by Proposition 4.3.6. ✌
Among the countably generated measurable spaces, those are of interest
which permit to separate points, so that if x 6D x0, we can ﬁnd A 2 C
with x 2 A and x0 62 A; they are called separable. Formally
Deﬁnition 4.3.8 The -algebra A is called separable iff it is countably
generated and if for any two different elements of X there exists a mea-
surable set A 2 A which contains exactly one of them. The measurable
space .X; A/ is called separable iff its -algebra A is separable.
The argumentation from Proposition 4.3.6 yields
Corollary 4.3.9 Let A be a separable -algebra over the set X with
A D .A0/ for A0 countable. Then A0 separates points, and X 2
A ˝ A.
Proof Because A separates points, we obtain from Example 4.1.5 that
A0 D X, where A0 is the equivalence relation deﬁned by A0. So
A0 separates points. The representation
X  X n X D
[
A2A0
A  .X n A/ [ .X n A/  A:
now yields X 2 A ˝ A. a
In fact, we can say even more.
Proposition 4.3.10 A separable measurable space .X; A/ is isomor-
phic to .X; B.X// with the Borel sets coming from a metric d on X
such that .X; d/ has a separable metric space.

486
CHAPTER 4. MEASURES FOR PROBABILISTIC SYSTEMS
Proof 1. Let A0 D fAn j n 2 Ng be the countable generator for A
which separates points. Deﬁne
.M; M/ WD
Y
n2N
.f0; 1g; P .f0; 1g//
as the product of many countable copies of the discrete space

f0; 1g;
P .f0; 1g/

. Then M has as a basis the cylinder sets fZv j v 2 f0; 1gk
for some k 2 Ng with Zv WD f.tn/n2N 2 M j hm1; : : : ; mki D vg for
v 2 f0; 1gk; see page 436. Deﬁne f W X ! M through f .x/ WD
.An.x//n2N, then f is injective, because A0 separates points. Put
Q WD f

X

, and Q WD M \ Q, the trace of M on Q.
Now let Yv WD Zv \ Q be an element of the generator for Q with
v D hm1; : : : ; mki; then f 1
Yv

D Tk
jD1 Cj with Cj WD Aj , if
mj D 1, and Cj WD X n Aj otherwise. Consequently, f W X ! Q is
A-Q-measurable.
2. Put for x; y 2 X
d.x; y/ WD
X
n2N
2n 
ˇˇAn.x/  An.y/
ˇˇI
then d is a metric on X which has
G WD
˚ \
j2F
Bj j Bj 2 A0 or X n Bj 2 A0; F  N is ﬁnite

as a countable basis. In fact, let G  X be open; given x 2 G, there
exists  > 0 such that the open ball B.x; / WD fx0 2 X j d.x; x0/ <
g with center x and radius  is contained in G. Now choose k with
2k < , and put v WD hx1; : : : ; xki; then x 2 Tk
jD1 Bj  B.x; /.
This argument shows also that A D B.X/.
3. Because .X; d/ has a countable basis, it is a separable metric space.
The map f W X ! Q is a bijection which is measurable, and f 1
is measurable as well. This is so because fA 2 A j f

A

2 Qg is a
-algebra which contains the basis G. a
The representation is due to Mackey. It gives the representation of sep-
arable measurable spaces as subspaces of the countable product of the
discrete space .f0; 1g; P .f0; 1g/. This space is also a compact metric
space, so we may say that a separable measurable space is isomorphic

4.3. COUNTABLY GENERATED -ALGEBRAS
487
to a subspace of a compact metric space. We will make use of this ob-
servation later on.
By the way, this innocently looking statement has some remarkable con-
sequences for our context. Just as an appetizer
Corollary 4.3.11 Let .X; A/ be a separable measurable space. If fi W
Xi ! X is Ai-A-measurable, where .Xi; Ai/ is a measurable space
(i D 1; 2), then
f 1
1
ŒA ˝ f 1
2
ŒA D .f1  f2/1 ŒA ˝ A
holds.
Proof The product -algebra A ˝ A is generated by the rectangles
B1  B2 with Bi taken from some generator B0 for B; i D 1; 2:
Since .f1  f2/1 ŒB1  B2 D f 1
1
ŒB1  f 1
2
ŒB2 ; we see that
.f1  f2/1 ŒB ˝ B  f 1
1
ŒB ˝ f 1
2
ŒB : This is true without the
assumption of separability. Now let  be a second countable metric
topology on Y with B D B./ and let 0 be a countable base for the
topology. Then
ˇp WD fT1  T2 j T1; T2 2 0g
is a countable base for the product topology  ˝; and (this is the crucial
property)
B ˝ B D B.Y  Y;  ˝ /
holds: Because the projections from X  Y to X and to Y are measur-
able, we observe B ˝ B  B.Y  Y;  ˝ /; because ˇp is a countable
base for the product topology  ˝ , we infer the other inclusion.
Since for T1; T2 2 0 clearly
f 1
1
ŒT1  f 1
2
ŒT2 2 .f1  f2/1 
p

 .f1  f2/1 ŒB ˝ B
holds, the nontrivial inclusion is inferred from the fact that the small-
est -algebra containing ff 1
1
ŒT1  f 1
2
ŒT2 j T1; T2 2 0g equals
f 1
1
ŒB ˝ f 1
2
ŒB : a
Given a measurable function into a separable measurable space, we ﬁnd
that its kernel (deﬁned on page 124) yields a measurable subset in the
product of its domain. We will use the kernel for many a construction,
so this little observation is quite helpful.

488
CHAPTER 4. MEASURES FOR PROBABILISTIC SYSTEMS
Corollary 4.3.12 Let f W X ! Y be a A-B-measurable map, where
.X; A/ and .Y; B/ are measurable spaces, the latter being separable.
Then the kernel ker .f / of f is a member of A ˝ A.
Proof Exercise 4.8. a
The observation, made in the proof of Proposition 4.3.6, that it may not
always be possible to separate two different elements in a measurable
space through a measurable set leads there to a contradiction. Neverthe-
less it leads also to an interesting notion.
Deﬁnition 4.3.13 The set A 2 A is called an atom of A iff B  A
implies B D ; or B D A for all B 2 A.
For example, each singleton set fxg is an atom for the -algebra P .X/.
Clearly, being an atom depends also on the -algebra. If A is an atom,
we have alternatively B  A or B \ A D ; for all B 2 A; this is more
radical than being a -atom, which merely restricts the values of .B/
for measurable B  A to 0 or .A/. Certainly, if A is an atom and
.A/ > 0, then A is a -atom.
For a countably generated -algebra, atoms are easily identiﬁed.
Proposition 4.3.14 Let A0 D fAn j n 2 Ng be a countable generator
of A, and deﬁne A˛ WD T
n2N A˛n
n
for ˛ 2 f0; 1gN, where A0 WD
A; A1 WD X n A. Then fA˛ j ˛ 2 f0; 1gN; A˛ 6D ;g is the set of all
atoms of A.
Proof Assume that there exist in A two different nonempty subsets
B1; B2 of A˛, and take y1 2 B1; y2 2 B2. Then y1 A0 y2, but
y1 6A y2, contradicting the observation in Example 4.1.5. Hence A˛ is
an atom. Let x 2 A˛; then A˛ is the equivalence class of x with respect
to the equivalence relation A0 and hence with respect to A. Thus each
atom is given by some A˛. a
Incidentally, this gives another proof that the countable–cocountable -
algebra over R is not countably generated. Assume it is generated by
fAn j n 2 Ng; then
H WD
\
fAn j An is cocountableg \
\
fR n An j An is countableg
is an atom, but H is also cocountable. This is a contradiction to H being
an atom.
We relate atoms to measurable maps.

4.3. COUNTABLY GENERATED -ALGEBRAS
489
Lemma 4.3.15 Let f W X ! R be A-B.R/-measurable. If A 2 A is
an atom of A, then f is constant on A.
Proof Assume that we can ﬁnd x1; x2 2 A with f .x1/ 6D f .x2/, say,
f .x1/ < c < f .x2/. Then fx 2 A j f .x/ < cg and fx 2 A j f .x/ >
cg are two nonempty disjoint measurable subsets of A. This contradicts
A being an atom. a
We will specialize now our view of measurable spaces to the Borel sets
of Polish spaces and their more general cousins, viz., analytic sets. Be-
fore we do that, however, we show that for important cases the Borel
sets B.X  Y / of X  Y coincide with the product B.X/ ˝ B.Y /. We
know from Proposition 4.3.6 that this is not always the case.
Proposition 4.3.16 Let X and Y be topological spaces such that Y has
a countable base. Then B.X  Y / D B.X/ ˝ B.Y /.
Proof 1. We show ﬁrst that each open set G  X  Y is a member
of B.X/ ˝ B.Y /. This shows that B.X  Y /  B.X/ ˝ B.Y /. If
fVn j n 2 Ng is a countable base of Y , we can write G D S U˛  Vm
for suitable open sets U˛  X and Vm  Y taken from the base. Now
deﬁne for ﬁxed m 2 N the set Wm WD SfU˛ j U˛ Vm  Gg, then Wm
is open, and G D S Wm  Vm. This is a countable union of elements
from B.X/ ˝ B.Y /, showing that each open set in X  Y is contained
in B.X/ ˝ B.Y /.
2. We claim that A  Y 2 B.X  Y / for all A 2 B.X/ and that
X  B 2 B.X  Y / for all B 2 B.Y /. Assume that we have established
these claims; then we infer that AB D .AY /\.X B/ 2 B.X Y /,
from which will follow
B.X/ ˝ B.Y / D .fA  B j A 2 B.X/; B 2 B.Y /g/  B.X  Y /:
We use the principle of good sets for proving the ﬁrst assertion; the
second is established in exactly the same way, so we will not bother
with it. In fact, put
G WD fA 2 B.X/ j A  Y 2 B.X  Y /g:
Then G is a -algebra which contains the open sets. This is so because
for an open set H  X the set H  Y is open in X  Y , thus a Borel
set in X  Y . But then G contains the -algebra generated by the open
sets, hence G D B.X/, and we are done. a

490
CHAPTER 4. MEASURES FOR PROBABILISTIC SYSTEMS
The proof shows that B.X/ ˝ B.Y /  B.X  Y / always holds and that
it is the converse inclusion which is sometimes critical. We will apply
Proposition 4.3.16, for example, when we have a separable metric or
even a Polish space as one of the factors.
4.3.1
Borel Sets in Polish and Analytic Spaces
General measurable spaces and even separable metric spaces are some-
times too general for supporting speciﬁc structures. We deal with Pol-
ish and analytic spaces which are general enough to support interesting
applications, but have speciﬁc properties which help establish vital prop-
erties. We remind the reader ﬁrst of some basic facts and provide them
some helpful tools for working with Polish spaces and their more gen-
eral cousins, analytic spaces.
An immediate consequence of Lemma 4.1.4 is that continuity implies
Borel measurability.
Lemma 4.3.17 Let .X1; 1/ and .X2; 2/ be topological spaces. Then
f
W X1 ! X2 is B.1/-B.2/-measurable, provided f is 1-2-
continuous. a
We note for later use that the limit of a sequence of measurable functions
into a metric space is measurable again; see Exercise 4.13.
Proposition 4.3.18 Let .X; A/ be a measurable, .Y; d/ a metric space,
and .fn/n2N a sequence of A-B.Y /-measurable functions fn W X ! Y .
Then
 the set C WD fx 2 X j .fn.x//n2N existsg is measurable,
 f .x/ WD limn!1 fn.x/ deﬁnes a A \ C-B.Y /-measurable map
f W C ! Y .
a
Neither general topological spaces nor metric spaces offer a structure
rich enough for the study of the transition systems that we will enter
into. We need to restrict the class of topological spaces to a particularly
interesting class of spaces that are traditionally called Polish.
As far as notation goes, we will write down a topological or a metric
space without its adornment through a topology or a metric, unless this
becomes really necessary.

4.3. COUNTABLY GENERATED -ALGEBRAS
491
Remember that a metric space .X; d/ is called complete iff each
d-Cauchy sequence has a limit. Recall also that completeness is really a
property of the metric rather than the underlying topological space, so a
metrizable space may be complete with one metric and incomplete with
another one; see Example 3.5.18. In contrast, having a countable base is
a topological property which is invariant under the different metrics the
topology may admit.
Deﬁnition 4.3.19 A Polish space X is a topological space, the topol-
ogy of which is metrizable through a complete metric, and which has a
countable base, or, equivalently, a countable dense subset.
Polish space
Familiar spaces are Polish, as these examples show.
Example 4.3.20 The real R with their usual topology, which is induced
by the open intervals, is a Polish space. The open unit interval 0; 1Œ with
the usual topology induced by the open intervals forms a Polish space.
The latter comes probably as a surprise, because 0; 1Œ is known not to
be complete with the usual metric. But all we need is a dense subset;
here we take of course the rationals Q \ 0; 1Œ; and a complete metric
that generates the topology. Deﬁne
d.x; y/ WD
ˇˇˇˇln
x
1  x  ln
y
1  y
ˇˇˇˇ I
then this is a complete metric for 0; 1Œ. This is so since x 7! ln.x=.1 
x// is a continuous bijection from 0; 1Œ to R, and the inverse y 7!
ey=.1 C ey/ is also a continuous bijection. ✌
Lemma 4.3.21 Let X be a Polish space, and assume that F  X is
closed; then the subspace F is Polish as well.
Proof F is complete by Lemma 3.5.21. The topology that F inherits
from X has a countable base and is metrizable, so F has a countable
dense subset, too. a
Lemma 4.3.22 Let .Xn/n2N be a sequence of Polish spaces, then their
product and their coproduct are Polish spaces.
Proof Assume that the topology n on Xn is metrized through metric
dn, where it may be assumed that dn  1 holds (otherwise use for

492
CHAPTER 4. MEASURES FOR PROBABILISTIC SYSTEMS
n the complete metric dn.x; y/=.1 C dn.x; y//). Then (see Proposi-
tion 3.5.4)
d

.xn/n2N; .yn/n2N

WD
X
n2N
2ndn.xn; yn/
is a complete metric for the product topology Q
n2N n. For the coprod-
uct, deﬁne the complete metric
d.x; y/ WD
(
2;
if x 2 Xn; y 2 Xm; n 6D m
dn.x; y/;
if x; y 2 Xn:
All this is established through standard arguments. a
Example 4.3.23 The set N of natural numbers with the discrete topol-
ogy is a Polish space on account of being the topological sum of its
elements. Thus the set N1 of all inﬁnite sequences is a Polish space.
The sets
˛ WD f 2 N1 j ˛ is an initial piece of g
for ˛ 2 N, the free monoid generated by N, constitute a base for the
˛
product topology. ✌
This last example will be discussed in much greater detail later on. It
permits occasionally reducing the discussion of properties for general
Polish spaces to an investigation of the corresponding properties of N1,
the structure of the latter space being more easily accessible than that of
a general space. We apply Example 4.3.23 directly to show that all open
subsets of a metric space X with a countable base can be represented
through a single open set in N1  X, similarly for closed sets.
Proposition 4.3.24 Let X be a separable metric space. Then there exist
an open set U  N1  X and a closed set F  N1  X with these
properties:
a. For each open set G  X, there exists t 2 N1 such that G D Ut.
b. For each closed set C  X, there exists t 2 N1 such that C D
Ft.
Proof 0. It is enough to establish the property for open sets; taking
complements will prove it for closed ones.

4.3. COUNTABLY GENERATED -ALGEBRAS
493
1. Let .Vn/n2N be a basis for the open sets in X with Vn 6D ; for all
n 2 N. Deﬁne
U WD fht; xi j t 2 NN; x 2
[
n2N
VtngI
then U  N1  X is open. In fact, let ht; xi 2 U , then there exists
n 2 N with x 2 Vn, thus ht; xi 2 n  Vn  U; and n  Vn is open in
the product.
2. Let G  X be open. Because .Vn/n2N is a basis for the topology,
there exists a sequence t 2 N1 with G D S
n2N Vtn D Ut. a
The set U is usually called a universally open set, similar for F , which
Universally
open
is universally closed. These universal sets will be used rather heavily
when we discuss analytic sets.
We have seen that a closed subset of a Polish space is a Polish space in
its own right; a similar argument shows that an open subset of a Polish
space is Polish as well. Both observations turn out to be special cases of
the characterization of Polish subspaces through Gı-sets.
We recall for this characterization an auxiliary statement which permits
the extension of a continuous map from a subspace to a Gı-set contain-
ing it—just far enough to be interesting to us. This has been given in
Lemma 3.5.24, to which we refer.
This technical Lemma is an important step in establishing a far- reaching
characterization of subspaces of Polish spaces that are Polish in their
own right. A subset X of a Polish space is a Polish space itself iff it is
a Gı-set. We will present Kuratowski’s proof for it. It is not difﬁcult
to show that X must be a Gı-set, using Lemma 3.5.24. This is done in
Lemma 4.3.25.
The tricky part, however, is the converse, and at its very center is the
following idea: Assume that we have represented X D T
k2N Gk with
each Gk open, and assume that we have a Cauchy sequence .xn/n2N 
X with xn ! x. How do we prevent x from being outside X? Well,
what we will do is to set up Kuratowski’s trap, preventing the sequence
Kuratowski’s
trap
to wander off. The trap is a new complete and equivalent metric D,
which makes it impossible for the sequence to behave in an undesired
way. So if x is trapped to be an element of X, we may conclude that X
is complete, and the assertion may be established.

494
CHAPTER 4. MEASURES FOR PROBABILISTIC SYSTEMS
Before we begin with the easier half, we ﬁx a Polish space Y and a
complete metric d on Y .
Lemma 4.3.25 If X  Y is a Polish space, then X is a Gı-set.
Proof X is complete and hence closed in Y . The identity idX W X !
Y can be extended continuously by Lemma 3.5.24 to a Gı-set G with
X  G  Xa, thus G D X, so X is a Gı-set. a
Now let X D T
k2N Gk with Gk open for all k 2 N. In order to prepare
for Kuratowski’s trap, we deﬁne
fk.x; x0/ WD
ˇˇ
1
d.x; Y n Gk/ 
1
d.x0; Y n Gk/
ˇˇ
for x; x0 2 X. Because Gk is open, we have x 2 Gk iff d.x; Y n Gk/ >
0, so fk is a ﬁnite and continuous function on X  X. Now let
Fk.x; x0/ WD
fk.x; x0/
1 C fk.x; x0/;
D.x; x0/ WD d.x; x0/ C
X
k2N
2k  Fk.x; x0/
for x; x0 2 X.
Then D is a metric on X, and the metrics d and D are equivalent on X.
Because d.x; x0/  D.x; x0/, it is clear that the identity id W .X; D/ !
.X; d/ is continuous, so it remains to show that id W .X; d/ ! .X; D/
is continuous. Let x 2 X be given, and let  > 0; then we ﬁnd ` 2 N
such that P
k>` 2j  Fk.x; x0/ < =3 for all x0 2 X. For k D 1; : : : ; `
there exists ıj such that Fj .x; x0/ < =.3  `/, whenever d.x; x0/ < ıj ,
since x 7! d.x; Y n Gj / is positive and uniformly continuous. Thus
deﬁne ı WD minf=3; ı1; : : : ; ı`gI then d.x; x0/ < ı implies
D.x; x0/  d.x; x0/C
`
X
kD1
2j Fj .x; x0/C 
3 < 
3 C
`
X
kD1

3  ` C 
3 D :
Thus .X; d/ and .X; D/ have in fact the same open sets.
When establishing that .X; D/ is complete, we spring Kuratowski’s
trap. Let .xn/n2N be a D-Cauchy sequence. Then this sequence is also a
d-Cauchy sequence, and thus we ﬁnd x 2 Y such that xn ! x, because
.Y; d/ is complete. We claim that x 2 X. In fact, if x 62 X, we ﬁnd G`

4.3. COUNTABLY GENERATED -ALGEBRAS
495
with x 62 G`, so that we can ﬁnd for each  > 0 some index n 2 N with
F`.xn; xm/  1   for n; m  n. But then D.xn; xm/  .1  /=2`
for n; m  n, so that .xn/n2N cannot be a D-Cauchy sequence. Con-
sequently, X is complete and hence closed.
Thus we have established
Theorem 4.3.26 Let Y be a Polish space. Then the subspace X  Y is
a Polish space iff X is a Gı-set. a
In particular, open and closed subsets of Polish spaces are Polish spaces
in their subspace topology. Conversely, each Polish space can be rep-
resented as a Gı-set in the Hilbert cube Œ0; 11; this is the famous and
very useful characterization of Polish spaces due to Alexandrov [Kur66,
III.33.VI].
Theorem 4.3.27 (Alexandrov) Let X be a separable metric space; then
X is homeomorphic to a subspace of the Hilbert cube. If X is Polish,
this subspace is a Gı.
Proof 0. The idea is to take a countable and dense subset D of X and
Idea
to map each element x 2 X to the distance it has to each element of
D. Since we may assume without loss of generality that the metric
is bounded, say, by 1, this yields an embedding into the cube Œ0; 11,
which is compact by Tihonov’s Theorem 3.2.12. This map is investi-
gated, and Theorem 4.3.26 is applied.
1. We may and do assume again that the metric d is bounded by 1. Let
.xn/n2N be a countable and dense subset of X, and put
f .x/ WD hd.x; x1/; d.x; x2/; : : :i:
Then f is injective and continuous. Deﬁne g W f

X

! X as f 1;
then g is continuous as well: Assume that f .ym/ ! f .y/ for some y;
hence limm!1 d.ym; xn/ D d.y; xn/ for each n 2 N. Since .xn/n2N
is dense, we ﬁnd for a given  > 0 an index n with d.y; xn/ < ; by
construction we ﬁnd for n an index m0 with d.ym; xn/ <  whenever
m > m0. Thus d.ym; y/ < 2   for m > m0, so that ym ! y. This
demonstrates that g is continuous; thus f is a homeomorphism.
2. If X is Polish, f

X

 Œ0; 11 is Polish as well. Thus the second
assertion follows from Theorem 4.3.26. a
Compact metric spaces are Polish. It is inferred from Tihonov’s Theo-
rem that the Hilbert cube Œ0; 11 is compact, because the unit interval

496
CHAPTER 4. MEASURES FOR PROBABILISTIC SYSTEMS
Œ0; 1 is compact by the Heine–Borel Theorem 1.5.46.
Thus
Alexandrov’s Theorem 4.3.27 embeds a Polish space as a Gı into a
compact metric space, the closure of which will be compact.
4.3.2
Manipulating Polish Topologies
We will show now that a Borel map between Polish spaces can be turned
into a continuous map.
Speciﬁcally, we will show that, given a
measurable map between Polish spaces, we can ﬁnd on the domain a
ﬁner Polish topology with the same Borel sets which renders the map
continuous. This will be established through a sequence of auxiliary
statements, each of which will be of interest and of use in its own
right.
We ﬁx for the discussion to follow a Polish space X with topology .
Recall that a set is clopen in a topological space iff it is both closed and
open.
Lemma 4.3.28 Let F be a closed set in X. Then there exists a Polish
topology 0 such that   0 (hence 0 is ﬁner than ), F is clopen in 0,
and B./ D B.0/:
Proof Both F and X n F are Polish by Theorem 4.3.26, so the topolog-
ical sum of these Polish spaces is Polish again by Lemma 4.3.22. The
sum topology is the desired topology. a
We will now add a sequence of certain Borel sets to the topology; this
will happen step by step, so we should know how to manipulate a se-
quence of Polish topologies. This is explained now.
Lemma 4.3.29 Let .n/n2N be a sequence of Polish topologies n with
  n.
1. The topology 1 generated by S
n2N n is Polish.
2. If n  B./, then B.1/ D B./.
Proof 1. The product Q
n2N.Xn; n/ is by Lemma 4.3.22 a Polish space,
where Xn D X for all n. Deﬁne the map f W X ! Q
n2N Xn through
x 7! hx; x; : : :i; then f is 1-Q
n2N n-continuous by construction.
One infers that f

X

is a closed subset of Q
n2N Xn: If .xn/n2N …
f

X

, take xi 6D xj with i < j , and let Gi and Gj be disjoint open

4.3. COUNTABLY GENERATED -ALGEBRAS
497
neighborhoods of xi resp. xj. Then
Y
`<i
X`  Gi 
Y
i<`<j
X`  Gj 
Y
`>j
X`
is an open neighborhood of .xn/n2N that is disjoint from f

X

. By
Lemma 4.3.21, the latter set is Polish. On the other hand, f is a homeo-
morphism between .X; 1/ and f

X

, which establishes part 1.
2. n has a countable basis fUi;n j i 2 Ng; with Ui;n 2 B./, since
n  B./. This implies that 1 has fUi;n j i; n 2 Ng as a countable
basis, which entails B.1/  B./: The other inclusion is obvious,
giving part 2. a
As a consequence, we may add a Borel set to a Polish topology as a
clopen set without destroying the property of the space to be Polish or
changing the Borel sets. This is extended now to sequences of Borel
sets, as we will see now.
Proposition 4.3.30 If .Bn/n2N is a sequence of Borel sets in X, then
there exists a Polish topology 0 on X such that 0 is ﬁner than ,  and
0 have the same Borel sets, and each Bn is clopen in 0.
Proof 1. We show ﬁrst that we may add just one Borel set to the topol-
ogy without changing the Borel sets. In fact, call a Borel set B 2 B./
neat if there exists a Polish topology B that is ﬁner than  such that B
is clopen with respect to B, and B./ D B.B/. Put
H WD fB 2 B./ j B is neatg:
Then   H, and each closed set is a member of H by Lemma 4.3.28.
Furthermore, H is closed under complements by construction and closed
under countable unions by Lemma 4.3.29. Thus we may now infer that
H D B./, so that each Borel set is neat.
2. Now construct inductively Polish topologies n that are ﬁner than
 with B./ D B.n/. Start with 0 WD . Adding BnC1 to the Pol-
ish topology n according to the ﬁrst part yields a ﬁner Polish topol-
ogy nC1 with the same Borel sets. Thus the assertion follows from
Lemma 4.3.29. a
We are in a position now which permits turning a Borel map into a
continuous one, whenever the domain is Polish and the range is a second
countable metric space.

498
CHAPTER 4. MEASURES FOR PROBABILISTIC SYSTEMS
Proposition 4.3.31 Let Y be a separable metric space with topology #.
If f W X ! Y is a B./-B.#/-Borel measurable map, then there exists
a Polish topology 0 on X such that 0 is ﬁner than ,  and 0 have the
same Borel sets, and f is 0-# continuous.
Make Borel
f
continuous
Proof The metric topology # is generated from the countable basis
.Hn/n2N. Construct from the Borel sets f 1
Hn

and from  a Polish
topology 0 according to Proposition 4.3.30. Because f 1
Hn

2 0
for all n 2 N, the inverse image of each open set from # is 0-open;
hence f is 0-# continuous. The construction entails  and 0 having
the same Borel sets. a
This property is most useful, because it permits rendering measurable
maps continuous, when they go into a second countable metric space
(thus in particular into a Polish space).
As a preparation for dealing with analytic sets, we will show now that
each Borel subset of the Polish space X is the continuous image of
N1. We begin with a reduction of the problem space: It is sufﬁcient to
establish this property for closed sets. This is justiﬁed by the following
observation, the proof of which is sketched by indicating the technical
arguments without giving, however, the somewhat laborious but not par-
ticularly nutritious or difﬁcult details.
Lemma 4.3.32 Assume that each closed set in the Polish space X is
a continuous image of N1. Then each Borel set of X is a continuous
image of N1.
Proof (Sketch) 0. The plan of the proof is to extend the assumption
Plan
that each closed set is the image of N1 to hold for all Borel sets. This
assumption is veriﬁed in the subsequent Proposition 4.3.33; note that a
closed set is a Polish space in its own right by Theorem 4.3.26. The
extension is done by applying the principle of good sets.
1. Let
G WD fB 2 B.X/ j B D f

N1
for f W N1 ! X continuousg
be the set of all good guys. Then G contains by assumption all closed
sets. We show that G is closed under countable unions and countable
intersections. Then the assertion will follow from Lemma 4.3.3.
2. Suppose Bn D fn

N1
for the continuous map fn; then
M WD fht1; t2; : : :i j f1.t1/ D f2.t2/ D : : :g

4.3. COUNTABLY GENERATED -ALGEBRAS
499
is a closed subset of .N1/1, and deﬁning f W ht1; t2; : : :i 7! f1.t1/
yields a continuous map f W M ! X with f

M

D T
n2N Bn: M
is homeomorphic to N1. Thus G is closed under countable intersec-
tions.
3. We show that G is closed also under countable unions. In fact, let
Bn 2 G such that Bn D fn

NN
with fn W NN ! X continuous.
Deﬁne
f W
(
NN
! X
hn; t1; t2; : : : ; i
7! fn.t1; t2; : : :/:
Thus
f

NN
D
[
n2N
fn

NN
D
[
n2N
Bn:
Moreover, f is continuous. If G  X is open, we have f 1
G

D
S
n2Nfng  f 1
n

G

. Since f 1
n

G

is open for each n 2 N, we con-
clude that f 1
G

is open, so that f is indeed continuous. Thus G is
closed under countable unions,
and the assertion follows from
Lemma 4.3.3. a
Thus it is sufﬁcient to show that each closed subset of a Polish space
is the continuous image on N1. And since a closed subset of a Polish
space is Polish itself by Theorem 4.3.26, we may restrict our attention
to Polish spaces proper.
Proposition 4.3.33 For Polish X there exists a continuous map f W
N1 ! X with f

N1
D X:
Proof 0. We will deﬁne recursively a sequence of closed sets indexed
by elements of N that will enable us to deﬁne a continuous map on
N1.
1. Let d be a metric that makes X complete. Represent X as S
n2N
An with closed sets An 6D ; such that the diameter diam.An/ < 1 for
each n 2 N. Assume that for a word ˛ 2 N of length k the closed
set A˛ 6D ; is deﬁned, and write A˛ D S
n2N A˛n with closed sets
A˛n 6D ; such that diam.A˛n/ < 1=.k C 1/ for n 2 N. This yields
for every t D hn1; n2; : : :i 2 N1 a sequence of nonempty closed sets
.An1n2::nk/k2N with diameter diam.An1n2::nk/ < 1=k. Because the

500
CHAPTER 4. MEASURES FOR PROBABILISTIC SYSTEMS
metric is complete, T
k2N An1n2::nk contains exactly one point, which
is deﬁned to be f .t/.
2. This construction renders f W N1 ! X well deﬁned. We can
ﬁnd for each x 2 X an index n0
1 2 N with x 2 An0
1, an index n0
2
with x 2 An0
1n0
2; and so on. The map just deﬁned is onto, so that
f .hn0
1; n0
2; n0
3; : : :i/ D x for some t0 WD hn0
1; n0
2; n0
3; : : :i 2 N1. Sup-
pose  > 0 is given. Since the diameters of the sets .An1n2:::nk/k2N
tend to 0, we can ﬁnd k0 2 N with diam.An0
1n0
2::n0
k/ <  for all k > k0.
Put ˛0 WD n0
1n0
2 : : : n0
k0; then ˛0 is an open neighborhood of t0 with
f

˛0
 B;d.f .t0//: Thus we ﬁnd for an arbitrary open neighbor-
hood V of f .t0/ an open neighborhood U of t0 with f

U

 V , equiv-
alently, U  f 1
V

. Hence f is continuous. a
Proposition 4.3.33 permits sometimes the transfer of arguments pertain-
ing to Polish spaces from arguments using inﬁnite sequences. Thus a
speciﬁc space is studied instead of an abstractly given one, the former
permitting some rather special constructions. This will be capitalized
on for the investigation of some astonishing properties of analytic sets,
which we will study now.
4.4
Analytic Sets and Spaces
We will deal now systematically with analytic sets and spaces. One
of the core results of this section will be the Lusin Separation Theo-
rem, which permits to separate two disjoint analytic sets through disjoint
Borel sets, and its immediate consequence, the Souslin Theorem, which
says that a set which is both analytic and co-analytic is Borel. These
beautiful results turn out to be very helpful, e.g., in the investigation of
Markov transition systems. In addition, they permit to state and prove
a weak form of Kuratowski’s Isomorphism Theorem, which says that
a measurable bijection between two Polish spaces is an isomorphisms
(hence its inverse is measurable as well).
But ﬁrst we give the deﬁnition of analytic and co-analytic sets for a
Polish space X.
Deﬁnition 4.4.1 An analytic set in X is the projection of a Borel subset
of X  X. The complement of an analytic set is called a co-analytic set.

4.4. ANALYTIC SETS AND SPACES
501
One may wonder whether these projections are Borel sets, but we will
show in a moment that there are strictly more analytic sets than Borel
sets, whenever the underlying Polish space is uncountable. Thus an-
alytic sets are a proper extension to Borel sets.
On the other hand,
analytic sets arise fairly naturally, for example, from factoring Polish
spaces through equivalence relations that are generated from a count-
able collection of Borel sets. We will see this in Proposition 4.4.22.
Consequently it is sometimes more adequate to consider analytic sets
rather than their Borel cousins, e.g., when the equivalence of states in a
transition system is at stake.
This is a ﬁrst characterization of analytic sets (using X for the projec-
tion to X).
Proposition 4.4.2 Let X be a Polish space. Then the following state-
ments are equivalent for A  X:
1. A is analytic.
2. There exist a Polish space Y and a Borel set B  X  Y with
A D X

B

.
3. There exists a continuous map f W N1 ! X with f

N1
D A.
4. A D X

C

for a closed subset C  X  N1.
Proof The implication 1 ) 2 is trivial, and 2 ) 3 follows from
Proposition 4.3.33: B D g

N1
for some continuous map g W N1 !
X  Y , so put f WD X ı g. We obtain 3 ) 4 from the observation
that the graph fht; f .t/i j t 2 N1g of f is a closed subset of N1  X,
the ﬁrst projection of which equals A. Finally, 4 ) 1 is obtained again
from Proposition 4.3.33. a
As an immediate consequence, we obtain that a Borel set is analytic.
Just for the record
Corollary 4.4.3 Each Borel set in a Polish space is analytic.
Proof Proposition 4.4.2 together with Proposition 4.3.33. a
The converse does not hold, as we will show now. This statement is
not only of interest in its own right. Historically it initiated the study of
analytic and co-analytic sets as a separate discipline in set theory (what
is called now descriptive set theory).

502
CHAPTER 4. MEASURES FOR PROBABILISTIC SYSTEMS
Proposition 4.4.4 Let X be an uncountable Polish space. Then there
exists an analytic set that is not Borel.
We show as a preparation for the proof of Proposition 4.4.4 that analytic
sets are closed under countable unions, intersections, and direct and in-
verse images of Borel maps. Before doing that, we establish a simple
but useful property of the graphs of measurable maps.
Lemma 4.4.5 Let .M; M/ be a measurable space and f W M ! Z be
a M-B.Z/-measurable map, where Z is a separable metric space. The
graph graph.f / of f is a member if M ˝ B.Z/.
Proof Exercise 4.9. a
Analytic sets have closure properties that are similar to those of Borel
sets, but not quite the same. Suspiciously missing from the list below
is the closure under complementation (which will give rise to Souslin’s
Theorem). This, of course, is different from Borel sets.
Proposition 4.4.6 Analytic sets in a Polish space X are closed under
countable unions and countable intersections. If Y is another Polish
space, with analytic sets A  X and B  Y and f W X ! Y is a Borel
map, then f

A

 Y is analytic in Y , and f 1
B

is analytic in X.
Proof 1. Using the characterization of analytic sets in Proposition 4.4.2,
it is shown exactly as in the proof to Lemma 4.3.32 that analytic sets are
closed under countable unions and under countable intersections. We
trust that the reader will reproduce those arguments here.
2. Note ﬁrst that for A  X the set Y  A is analytic in the Polish space
Y  X by Proposition 4.4.2. In fact, A D X

B

with B  X  X
Borel by the ﬁrst part; hence Y  A D Y 	X

Y  B

with Y  B 
Y X X Borel, which is analytic by the second part. Since y 2 f

A

iff hx; yi 2 graph.f / for some x 2 A, we write
f

A

D Y

Y  A \ fhy; xi j hx; yi 2 graph.f /g

:
The set fhy; xi j hx; yi 2 graph.f /g is Borel in Y X by Lemma 4.4.5,
so the assertion follows for the direct image. The assertion is proved in
exactly the same way for the inverse image. a
Again, the proof for Proposition 4.4.4 will be sketched only, delegat-
ing the very technical details to Srivastava’s book [Sri98, Sect. 2.5]. We
give, however, the argument for the case that the space under consider-
ation is our prototypical space N1 through a pretty diagonal argument

4.4. ANALYTIC SETS AND SPACES
503
using a universal set. From this and the structural arguments used so far,
the reader has no difﬁculties ﬁlling in the details under the leadership of
the text mentioned.
Proof (of Proposition 4.4.4) 1. We will deal with the case X D N1 ﬁrst
and apply a diagonal argument. Let F  N1  .N1  N1/ be a uni-
versal closed set according to Proposition 4.3.24. Thus each closed set
C  N1  N1 can be represented as C D Ft for some t 2 N1. Tak-
ing ﬁrst projections, we conclude that there exists a universal analytic set
U  N1  N1 such that each analytic set A  N1 can be represented
as Ut for some t 2 N1. In fact, we can write A D

0
NN	NN

F

t with
0
NN	NN as the ﬁrst projection of .NN  NN/  NN.
Now set
A WD f	 j h	; 	i 2 U g:
Because analytic sets are closed under inverse images of Borel maps by
Proposition 4.4.6, A is an analytic set. Suppose that A is a Borel set;
then N1 n A is also a Borel set, hence analytic. Thus we ﬁnd 
 2 N1
such that N1 n A D U. But now

 2 A , h
; 
i 2 U , 
 2 U , 
 2 N1 n A:
This is a contradiction.
2. The general case is reduced to the one treated above by observing
that an uncountable Polish space contains a homeomorphic copy on
N1. But since we are interested mainly in showing that analytic sets
are strictly more general than Borel sets, we refrain from a very techni-
cal discussion of this case and refer the reader to [Sri98, Remark 2.6.5].
a
4.4.1
Souslin’s Separation Theorem
The representation of an analytic set through a continuous map on N1
has the remarkable consequence that we can separate two disjoint an-
alytic sets by disjoint Borel sets (Lusin’s Separation Theorem). This
in turn implies a beautiful characterization of Borel sets due to Souslin
which says that an analytic set is Borel iff its complement is analytic as
well. Since the latter characterization will be most valuable to us, we
will discuss it in greater detail now.
We start with Lusin’s Separation Theorem.

504
CHAPTER 4. MEASURES FOR PROBABILISTIC SYSTEMS
Theorem 4.4.7 Given disjoint analytic sets A and B in a Polish space
X, there exist disjoint Borel sets E and F with A  E and B  F .
Proof 0. We investigate ﬁrst what it means for two analytic sets to be
This is the
plan
separated by Borel sets and show that this property carries over to se-
quences of analytic sets. From this observation we argue by contra-
diction what it means that two analytic sets cannot be separated in a
way which we want them to. Here the representation of analytic sets
as continuous images on N1 is used. We construct in this manner a
decreasing sequence of open sets with smaller and smaller diameters,
arriving eventually at a contradiction.
1. Call two analytic sets A and B separated by Borel sets iff there exist
disjoint Borel sets E and F with A  E and B  F . Observe that
if two sequences .An/n2N and .Bn/n2N have the property that Am and
Bn can be separated by Borel sets for all m; n 2 N, then S
n2N An and
S
m2N Bm can also be separated by Borel sets. In fact, if Em;n and
Fm;n separate An and Bm, then E WD T
m2N
S
n2N Em;n and F WD
S
m2N
T
n2N Fm;n separate S
n2N An and S
m2N Bm.
2. Now suppose that A D f

N1
and B D g

N1
cannot be sepa-
rated by Borel sets, where f; g W N1 ! X are continuous and chosen
according to Proposition 4.4.2. Because N1 D S
j2N j; (˛ is de-
ﬁned in Example 4.3.23 for ˛ 2 N), we ﬁnd indices k1 and `1 such
that f

j1

and g

`1

cannot be separated by Borel sets. For the same
reason, there exist indices k2 and `2 such that f

j1j2

and g

`1`2

cannot be separated by Borel sets. Continuing in this way, we deﬁne
inﬁnite sequences  WD hk1; k2; : : :i and  WD h`1; `2; : : :i such that for
each n 2 N the sets f

j1j2:::jn

and g

`1`2:::`n

cannot be separated
by Borel sets.
Because f ./ 2 A and g./ 2 B, we know f ./ 6D g./, so we ﬁnd
 > 0 with d.f ./; g.// < 2: But we may choose n large enough so
that both f

j1j2:::jn

and g

`1`2:::`n

have a diameter smaller than
 each. This is a contradiction since we now have separated these sets
by open balls. a
We obtain as a consequence Souslin’s Theorem.
Theorem 4.4.8 (Souslin) Let A be an analytic set in a Polish space. If
Souslin’s
Theorem
X n A is analytic, then A is a Borel set.

4.4. ANALYTIC SETS AND SPACES
505
Proof Let A and X n A be analytic; then they can be separated by dis-
joint Borel sets E with A  E and F with X n A  F by Lusin’s
Theorem 4.4.7. Thus A D E is a Borel set. a
Souslin’s Theorem is important when one wants to show that a set is a
Borel set that is given, for example, through the image of another Borel
set. A typical scenario for its use is establishing for a Borel set A and a
Borel map f W X ! Y that both C D f

A

and Y n C D f

X n A

hold. Then one infers from Proposition 4.4.6 that both C and Y n C are
analytic and from Souslin’s Theorem that A is a Borel set. This is a ﬁrst
simple example (see also Lemma 2.6.44).
Proposition 4.4.9 Let f W X ! Y be surjective and Borel measurable,
where X and Y are Polish. Assume that A 2 ˙˙˙ker.f /.B.X//; hence
A 2 B.X/ is ker .f /-invariant. Then f

A

2 B.Y /.
Proof Put C WD f

A

, D WD f

X n A

; then both C and D are
analytic sets by Proposition 4.4.6. Clearly Y n C  D. For establishing
the other inclusion, let y 2 D; hence there exists x 62 A with y D f .x/.
But y 62 C, for otherwise there exists x0 2 A with y D f .x0/, which
implies x 2 A. Thus y 2 Y n C; hence D  Y n C, so that we have
shown D D Y n C. We infer f

A

2 B.Y / now from Theorem 4.4.8.
a
This yields the following observation as an immediate consequence. It
will be extended to analytic spaces in Proposition 4.4.13 with essentially
the same argument.
Corollary 4.4.10 Let f W X ! Y be measurable and bijective with X,
Y Polish. Then f is a Borel isomorphism. a
We state ﬁnally Kuratowski’s Isomorphism Theorem.
Theorem 4.4.11 Any two Borel sets of the same cardinality contained
in Polish spaces are Borel isomorphic. a
The proof requires a reduction to the Cantor ternary set, using the tools
we have discussed here so far. Since giving the proof would lead us
fairly deep into the Wonderland of Descriptive Set Theory, we do not
give
it
here
and
refer
rather
to
[Sri98,
Theorem
3.3.13],
[Kec94, Sect. 15.B] or [KM76, p. 442].

506
CHAPTER 4. MEASURES FOR PROBABILISTIC SYSTEMS
We make the properties of analytic sets a bit more widely available by
introducing analytic spaces. Roughly, an analytic space is Borel isomor-
phic to an analytic set in a Polish space; to be more precise
Deﬁnition 4.4.12 A measurable space .M; M/ is called an analytic
space iff there exist a Polish space X and an analytic set A in X such
that the measurable spaces .M; M/ and .A; B.X/ \ A/ are Borel iso-
morphic. The elements of M are then called the Borel sets of M. M is
denoted by B.M/.
We will omit the -algebra from the notation of an analytic space.
Analytic spaces share many favorable properties with analytic sets and
with Polish spaces, but they are a wee bit more general: Whereas an
analytic set lives in a Polish space, an analytic space does only require
a Polish space to sit in the background somewhere and to be Borel iso-
morphic to it. This makes life considerably easier, since we are for this
reason not obliged to present a Polish space directly when dealing with
properties of analytic spaces. We will demonstrate the use (and power)
of the structure theorems studied above for investigating properties of
analytic spaces and their -algebras. The most helpful of these theo-
rems will turn out to be Souslin’s Theorem, which can be applied for
showing that a set is a Borel set by demonstrating that it is an analytic
set and that its complement is analytic as well.
Take a Borel measurable bijection between two Polish spaces. It is not
a priori clear whether or not this map is an isomorphism. Souslin’s
Theorem gives a helpful hand here as well. We will need this property in
a moment for a characterization of countably generated sub--algebras
of Borel sets, but it appears to be interesting in its own right.
Proposition 4.4.13 Let X and Y be analytic spaces and f W X ! Y
be a bijection that is Borel measurable. Then f is a Borel isomorphism.
Proof 1. It is no loss of generality to assume that we can ﬁnd Polish
spaces P and Q such that X and Y are subsets of P resp. Q. We want
to show that f

X \ B

is a Borel set in Y , whenever B 2 B.P / is
a Borel set. For this we need to ﬁnd a Borel set G 2 B.Q/ such that
f

X \ B

D G \ Q.
2. Clearly, both f

X \ B

and f

X n B

are analytic sets in Q by
Proposition 4.4.6, and because f is injective, they are disjoint. Thus
we can ﬁnd a Borel set G 2 B.Q/ with f

X \ B

 G \ Y and

4.4. ANALYTIC SETS AND SPACES
507
f

X n B

 Q n .G \ Y /. Because f is surjective, we have f

X \
B

[ f

X n B

D Y ; thus f

X \ B

D G \ Y . a
Separable measurable spaces are characterized through subsets of Polish
spaces.
Lemma 4.4.14 The measurable space .M; M/ is separable iff there
exist a Polish space X and a subset P  X such that the measurable
spaces .M; M/ and .P; B.X/ \ P / are Borel isomorphic.
It should be noted that we do not assume P to be a measurable subset
of X.
Proof 1. Because B.X/ is countably generated for a Polish space X by
Lemma 4.3.2, the -algebra B.X/\P is countably generated. Since this
property is not destroyed by Borel isomorphisms, the condition above is
sufﬁcient.
2. It is also necessary by Proposition 4.3.10, because Q
n2N

f0; 1g;
P .f0; 1g/

is a Polish space by Lemma 4.3.22. a
Thus analytic spaces are separable measurable spaces; see Deﬁnition
4.3.8.
Corollary 4.4.15 An analytic space is a separable measurable space.
a
Let us have a brief look at countably generated sub--algebras of an an-
alytic space. This will help establish, for example, that the factor space
for a particularly interesting and important class of equivalence relations
is an analytic space. The following statement, which is sometimes re-
ferred to as the Unique Structure Theorem [Arv76, Theorem 3.3.5], says
essentially that the Borel sets of an analytic space are uniquely deter-
mined by being countably generated and by separating points. It comes
as a consequence of our discussion of Borel isomorphisms.
Proposition 4.4.16 Let X be an analytic space and B0 be a countably
generated sub--algebra of B.X/ that separates points. Then B0 D
B.X/.
Proof 1. .X; B0/ is a separable measurable space, so there exist a Polish
space P and a subset Y  P of P such that .X; B0/ is Borel isomorphic
to .Y; B.P / \ Y / by Lemma 4.4.14. Let f be this isomorphism; then
B0 D f 1
B.P / \ Y

.

508
CHAPTER 4. MEASURES FOR PROBABILISTIC SYSTEMS
2. f is a Borel map from .X; B.X// to .Y; B.P /\Y /; thus Y is an ana-
lytic
set
with B.Y /
D
B.X/ \ P
by Proposition
4.4.14.
By Proposition 4.4.6,
f
is an isomorphism;
hence B.X/
D
f 1
B.P / \ Y

. But this establishes the assertion. a
This gives an interesting characterization of measurable spaces to be
analytic, provided they have a separating sequence of sets. Note that the
sequence of sets in the following statement is required to separate points,
but we do not assume that it generates the -algebra for the underlying
space. The statement says that it does, actually.
Lemma 4.4.17 Let X be analytic and f
W X ! Y be B.X/-B-
measurable and onto for a measurable space .Y; B/, which has a se-
quence of sets in B that separates points. Then .Y; B/ is analytic.
Proof 1. The idea is to show that an arbitrary measurable set is con-
Plan
tained in the -algebra generated by the sequence in question. Thus let
.Bn/n2N be the sequence of sets that separates points, take an arbitrary
set N 2 B, and deﬁne the -algebra B0 WD .fBn j n 2 Ng [ fN g/:
We want to show that N 2 .fBn j n 2 Ng/, and we show this in a
roundabout way by showing that B D B.Y / D B0. Here is how.
2. .Y; B0/ is a separable measurable space, so by Lemma 4.4.14 we can
ﬁnd a Polish space P with Y  P and B0 as the trace of B.P / on Y .
Proposition 4.4.6 tells us that Y D f

X

is analytic with B0 D B.Y /,
and from Proposition 4.4.16 it follows that B.Y / D .fBn j n 2 Ng/.
Thus N 2 B.Y /, and since N 2 B is arbitrary, we conclude B  B.Y /;
thus B  B.Y / D .fBn j n 2 Ng/  B. a
4.4.2
Smooth Equivalence Relations
We will use Lemma 4.4.17 for demonstrating that factoring an ana-
lytic space through a smooth equivalence relation yields an analytic
space again. This class of relations will be deﬁned now and brieﬂy
characterized here. We give a deﬁnition in terms of a determining se-
quence of Borel sets and relate other characterizations of smoothness in
Lemma 4.4.21.
Deﬁnition 4.4.18 Let X be an analytic space and  an equivalence re-
lation on X. Then  is called smooth iff there exists a sequence .An/n2N

4.4. ANALYTIC SETS AND SPACES
509
of Borel sets such that
Smooth
equivalence
relation
x  x0 , 8n 2 N W Œx 2 An , x0 2 An:
.An/n2N is said to determine the relation .
Example 4.4.19 Given an analytic space X, let M W X  X be a
transition kernel which interprets the modal logic presented in Exam-
ple 4.1.11. Put for a formula ' and an element of x as usual M; x ˆ '
iff x 2 ŒŒ'M, and thus M; x ˆ ' indicates that formula ' is valid in
state x. Deﬁne the equivalence relation 
 on X through
x 
 x0 ” 8' W

M; x ˆ ' iff M; x0 ˆ :'

Thus x and x0 cannot be separated through a formula of the logic. Be-
cause the logic has only countably many formulas, the relation is smooth
with the countable set fŒŒ'M j ' is a formulag as determining the rela-
tion 
. ✌
We obtain immediately from the deﬁnition that a smooth equivalence
relation—seen as a subset of the Cartesian product—is a Borel set.
Corollary 4.4.20 Let  be a smooth equivalence relation on the ana-
lytic space X; then  is a Borel subset of X  X.
Proof Suppose that .An/n2N determines . Since x  x0 is false iff there
exists n 2 N with hx; x0i 2 .An  .X n An// [ ..X n An/  An/ ; we
obtain
.X  X/ n  D
[
n2N

An  .X n An/

[

.X n An/  An

:
This is clearly a Borel set in X  X. a
The following characterization of smooth equivalence relations is some-
times helpful and shows that it is not necessary to focus on sequences of
sets. It indicates that the kernels of Borel measurable maps and smooth
relations are intimately related.
Lemma 4.4.21 Let  be an equivalence relation on an analytic set X.
Then these conditions are equivalent:
1.  is smooth.
2. There exists a sequence .fn/n2N of Borel maps fn W X ! Z into
an analytic space Z such that  D T
n2N ker .fn/ :

510
CHAPTER 4. MEASURES FOR PROBABILISTIC SYSTEMS
3. There exists a Borel map f W X ! Y into an analytic space Y
with  D ker .f / :
Proof The proof is essentially an expansion of the deﬁnition of smooth-
Guide
through the
proof
ness and the observation that the kernel of a Borel map into an analytic
is determined through the inverse images of a countable generator. Here
we go.
1 ) 2: Let .An/n2N determine ; then
x  x0
,
8n 2 N W Œx 2 An , x0 2 An
,
8n 2 N W An.x/ D An.x0/:
Thus take Z D f0; 1g and fn WD An.
2 ) 3: Put Y WD Z1: This is an analytic space in the product -
algebra, and
f W
(
X
! Y
x
7!

fn.x/

n2N
is Borel measurable with f .x/ D f .x0/ iff 8n 2 N W fn.x/ D fn.x0/:
3
)
1: Since Y is analytic, it is separable; hence the Borel sets
are generated through a sequence .Bn/n2N which separates points. Put
An WD f 1
Bn

I then .An/n2N is a sequence of Borel sets, because the
base sets Bn are Borel in Y and because f is Borel measurable. We
claim that .An/n2N determines :
f .x/ D f .x0/
,
8n 2 N W Œf .x/ 2 Bn , f .x0/ 2 Bn
(since .Bn/n2N separates points in Z/
,
8n 2 N W Œx 2 An , x0 2 An:
Hence hx; x0i 2 ker .f / is equivalent to the pair hx; x0i being deter-
mined by a sequence of measurable sets. a
Thus each smooth equivalence relation may be represented as the kernel
of a Borel map and vice versa. This is an important property which we
will put to use frequently.
The interest in analytic spaces comes from the fact that factoring an
analytic space through a smooth equivalence relation will result in an
analytic space again. This requires ﬁrst and foremost the deﬁnition of a
measurable structure induced by the relation. The natural choice is the

4.4. ANALYTIC SETS AND SPACES
511
structure imposed by the factor map. The ﬁnal -algebra on X= with
respect to the Borel sets on X and the factor map  will be chosen; it
is denoted by B.X/=. Recall that B.X/= is the largest -algebra C
on X= rendering  a B.X/-C-measurable map. Then it turns out that
B.X=/ coincides with B.X/=:
Proposition 4.4.22 Let X be an analytic space, and assume that ˛ is a
smooth equivalence relation on X. Then X=˛ is an analytic space.
Proof In accordance with the characterization of smooth relations in
Lemma 4.4.21, we assume that ˛ is given through a sequence .fn/n2N
of measurable maps fn W X ! R. The factor map is measurable and
onto. Put En;r WD fŒx˛ j x 2 X; fn.x/ < rgI then E WD fEn;r j
n 2 N; r 2 Qg is a countable set of element of the factor -algebra that
separates points. The assertion now follows without difﬁculties from
Lemma 4.4.17. a
Let us have a look at invariant sets for an equivalence relation ˛. Recall
that a subset A  X is invariant for the equivalence relation ˛ on X iff
A is the union of ˛-equivalence classes; see page 452. Thus A  X
is ˛-invariant iff x 2 A and x ˛ x0 implies x0 2 A. For example, if
˛ D ker .f /, then A is ˛-invariant iff A is what we called f -invariant
on page 221, i.e., iff x 2 A and f .x/ D f .x0/ imply x0 2 A.
Denote by
Ar WD
[
fŒx˛ j x 2 Ag
the smallest ˛-invariant set containing A; then we have the representa-
Ar
tion
Ar D 2

˛ \ .X  A/

;
because x0 2 Ar iff there exists x with hx0; xi 2 X  A.
An equivalence relation on X is called analytic resp. closed iff it consti-
tutes an analytic resp.
closed subset of the Cartesian product
X  X.
If X is a Polish space, we know that the smooth equivalence relation
˛  X  X is a Borel subset by Corollary 4.4.20. We want to show
that, conversely, each closed equivalence relation ˛  X X is smooth.
This requires the identiﬁcation of a countable set which generates the
relation, and for this we require the following auxiliary statement. It
may be called separation through invariant sets.

512
CHAPTER 4. MEASURES FOR PROBABILISTIC SYSTEMS
Lemma 4.4.23 Let   X  X be an analytic equivalence relation on
the Polish space X with two disjoint analytic sets A and B. If B is -
invariant, then there exists a -invariant Borel set C with A  C and
B \ C D ;.
Proof 0. This is the plan for the proof. If D is an analytic set, Dr
Approach
is; this follows from the representation of Dr above and from Propo-
sition 4.4.6. It is fundamental for the rest of the proof. We construct a
sequence .An/n2N of invariant analytic sets and a sequence .Bn/n2N of
Borel sets with these properties: An  Bn  AnC1; hence Bn is sand-
wiched between consecutive elements of the ﬁrst sequence, A  A1,
and B \ Bn D ; for all n 2 N.
1. Deﬁne A1 WD Ar, then A  A1, and A1 is -invariant. Since B
is -invariant as well, we conclude A1 \ B D ;: If x 2 A1 \ B, we
ﬁnd x0 2 A with x  x0; hence x0 2 B, a contradiction. Proceeding
inductively, assume that we have already chosen An and Bn with the
properties described above, then put AnC1 WD Br
n , then AnC1 is -
invariant and analytic, and also AnC1 \ B D ; by the argument above.
Hence we can ﬁnd a Borel set BnC1 with AnC1  BnC1 and BnC1 \
B D ;.
2. Now put C WD S
n2N Bn. Thus C 2 B.X/ and C \ B D ;, so it
remains to show that C is -invariant. Let x 2 C and x  x0. Since
x 2 Bn  Br
n  BnC1, we conclude x0 2 BnC1  C, and we are
done. a
We use this observation now for a closed equivalence relation. Note that
the assumption on being analytic in the proof above was made use of
in order to establish that the invariant hull Ar of an analytic set A is
analytic again.
Proposition 4.4.24 A closed equivalence relation on a Polish space is
smooth.
Proof 0. Let X be a Polish space and ˛  X  X be a closed equiva-
This is how
the proof
works
lence relation. We have to ﬁnd a sequence .An/n2N of Borel sets which
determines ˛. This will be constructed through a countable base for the
topology in a somewhat roundabout manner.
1. Since X is Polish, it has a countable basis G. Because ˛ is closed, we
can write
.X  X/ n ˛ D
[
fUn  Um j Un; Um 2 G0; Un \ Um D ;g

4.4. ANALYTIC SETS AND SPACES
513
for some countable subset G0  G. Fix Un and Um; then also U r
n and
Um are disjoint. Select the invariant Borel set An such that Un  An
and An \ Um D ;; this is possible by Lemma 4.4.23.
2. We claim that
.X  X/ n ˛ D
[
n2N

An  .X n An

:
In fact, if hx; x0i 62 ˛, select Un and Um with hx; x0i 2 Un  Um 
An .X nAn/. If, conversely, hx; x0i 2 An .X nAn/, then hx; x0i 2 ˛
implies by the invariance of An that x0 2 An, a contradiction. a
The Blackwell–Mackey Theorem analyzes those Borel sets that are
unions of A-atoms for a sub--algebra A  B.X/. If A is countably
generated by, say, .An/n2N, then it is not difﬁcult to see that an atom
in A can be represented as T
i2T Ai \ T
i2NnT .X n Ai/ for a suitable
subset T  N; see Proposition 4.3.14. It constructs a measurable map f
as it goes, so that the set under consideration is ker .f /-invariant, which
will be helpful in the application of the Souslin Theorem. But let us
see.
Theorem 4.4.25 (Blackwell–Mackey) Let X be an analytic space and
A  B.X/ be a countably generated sub--algebra of the Borel sets of
X. If B  X is a Borel set that is a union of atoms of A, then B 2 A.
The idea of the proof is to show that f

B

and f

X n B

are disjoint
analytic sets for the measurable map f W X ! f0; 1g1 and to conclude
Idea of the
proof
that B D f 1
C

for some Borel set C, which will be supplied to
us through Souslin’s Theorem. Using f0; 1g1 is suggested through the
countable base for the -algebra, because we can then use the indicator
functions of the base elements. The space f0; 1g1 is compact and has
well-known properties, so it is a pleasant enough choice.
Proof Let A be generated by .An/n2N, and deﬁne
f W X ! f0; 1g1
through
x 7! hA1.x/; A2.x/; A3.x/; : : :i:
Then f is A-B.f0; 1g1/-measurable. We claim that f

B

and f

X n
B

are disjoint. Suppose not; then we ﬁnd t 2 f0; 1g1 with t D f .x/ D
f .x0/ for some x 2 B; x0 2 X n B. Because B is the union of atoms,

514
CHAPTER 4. MEASURES FOR PROBABILISTIC SYSTEMS
we ﬁnd a subset T  N with x 2 An, provided n 2 T , and x … An,
provided n … T . But since f .x/ D f .x0/, the same holds for x0 as well,
which means that x0 2 B, contradicting the choice of x0.
Because f

B

and f

X n B

are disjoint analytic sets, we ﬁnd through
Souslin’s Theorem 4.4.8 a Borel set C with
f

B

 C; f

X n B

\ C D ;:
Thus f

B

D C, so that f 1
f

B

D f 1
C

2 A. We show that
f 1
f

B

D B. It is clear that B  f 1
f

B

, so assume that
f .b/ 2 f

B

, so f .b/ D f .b0/ for some b0 2 B. By construction, this
means b 2 B, since B is a union of atoms; hence f 1
f

B

 B.
Consequently, B D f 1
C

2 A. a
When investigating modal logics, one wants to be able to identify the
-algebra which is deﬁned by the validity sets of the formulas. This can
be done through the Blackwell–Mackey Theorem and is formulated for
general smooth equivalence relations with the proviso of being used for
the logics later on.
Proposition 4.4.26 Let  be a smooth equivalence relation on the Pol-
ish space X, and assume that .An/n2N generates . Then
1. .fAn j n 2 Ng/ is the -algebra ˙˙˙.X/ of -invariant Borel
sets,
2. B.X=/ D .f

An

j n 2 Ng.
Proof 1. The -algebra ˙˙˙.X/ D ˙˙˙.B.X// of -invariant Borel sets
is introduced on page 452. We have to show that ˙˙˙.X/ D .fAn j
n 2 Ng:
“	”: Each An is a -invariant Borel set.
“”: Let B be an -invariant Borel set; then B D S
b2B Œb. Each
class Œb can be written as
Œb D
\
b2An
An \
\
b62An
.X n An/I
thus Œb 2 .fAn j n 2 Ng. Moreover, it is easy to see that
the classes are the atoms of this -algebra, since we cannot ﬁnd a
proper nonempty -invariant subset of an equivalence class. Thus
the Blackwell–Mackey Theorem 4.4.25 shows that B 2 .fAn j
n 2 Ng/.

4.4. ANALYTIC SETS AND SPACES
515
2. Now let E WD .f

An

j n 2 Ng, and let g W X= ! P be E-P-
measurable for an arbitrary measurable space .P; P/. Thus we have for
all C 2 P
g1
C

2 E , 1


g1
C

2 .fAn j n 2 Ng/
(since An D 1




An

/
, 1


g1
C

2 I
(part 1)
, 1


g1
C

2 B.X/:
Thus E is the ﬁnal -algebra with respect to  and hence equals
B.X=/. a
The following example shows that the equivalence relation generated
by a -algebra need not return this -algebra as its invariant sets, if the
given -algebra is not countably generated. Proposition 4.4.26 assures
us that this cannot happen in the countably generated case.
Example 4.4.27 Let C be the countable–cocountable -algebra on R.
The equivalence relation C generated by C according to Example 4.1.5
is the identity. Hence it is smooth. The -algebra of C-invariant Borel
sets equals the Borel set B.R/, which is a proper superset of C. ✌
The next example is a somewhat surprising application of the Blackwell–
Mackey Theorem, taken from [RR81, Proposition 57]. It shows that the
set of countably generated -algebras is not closed under ﬁnite intersec-
tions; hence it fails to be a lattice under inclusion.
Example 4.4.28 There exist two countably generated -algebras, the
intersection of which is not countably generated. In fact, let A  Œ0; 1
be an analytic set which is not Borel; then B.A/ is countably gener-
ated by Corollary 4.4.15. Let f W Œ0; 1 ! A be a bijection, and con-
sider C WD f 1
B.A/

, which is countably generated as well. Then
D WD B.Œ0; 1/ \ C is a -algebra which has all singletons in Œ0; 1 as
atoms. Assume that D is countably generated; then D D B.Œ0; 1/ by the
Blackwell–Mackey Theorem 4.4.25. But this means that C D B.Œ0; 1/,
so that f W Œ0; 1 ! A is a Borel isomorphism; hence A is a Borel set in
Œ0; 1, contradicting the assumption. ✌
Among the consequences of Example 4.4.28 is the observation that the
set of smooth equivalence relations of a Polish space does not form
a lattice under inclusion, but is usually only a \-semilattice, as the

516
CHAPTER 4. MEASURES FOR PROBABILISTIC SYSTEMS
following example shows.
Another consequence is mentioned in
Exercise 4.19.
Example 4.4.29 The intersection ˛1 \ ˛2 of two smooth equivalence
relations ˛1 and ˛2 is smooth again: If ˛i is generated by the Borel sets
fAi;n j n 2 Ng for i D 1; 2, then ˛1 \ ˛2 is generated by the Borel
sets fAi;n j i D 1; 2; n 2 Ng. But now take two countably generated -
algebras Ai, and let ˛i be the equivalence relations determined by them;
see Example 4.1.5. Then the -algebra ˛1[˛2 is generated by A1\A2,
which is by assumption not countably generated. Hence ˛1 [ ˛2 is not
smooth. ✌
We digress brieﬂy and establish tameness (Deﬁnition 4.1.27) for smooth
equivalence relations.
Proposition 4.4.30 If  is smooth and S is Polish, then  is tame.
Proof 0. There are many -algebras around, so let us see what we have
to do. We want to show that
Proof outline
˙˙˙.B.X// ˝ B.Œ0; 1/ D ˙˙˙	.B.X ˝ Œ0; 1//
(4.5)
holds. Since X is Polish and  is smooth, X= is an analytic space, so
we know from Proposition 4.3.16 that B.X= ˝ Œ0; 1/ D B.X=/ ˝
B.Œ0; 1/. In order to establish the inclusion from left to right in Eq. (4.5),
we show that each member of the left-hand set is -invariant. For the
converse direction, we show that each member of the set on the right-
hand side can be represented as the inverse image under 	 of a set
in the factor space.
1. Let G D  X Œ0; 1 be a generator of ˙˙˙.B.X//˝B.Œ0; 1/ such
that G 2 ˙˙˙.B.X// and D 2 B.Œ0; 1/. Then G D is -invariant.
But this means
˙˙˙.B.X// ˝ B.Œ0; 1/ D .fG  D j G 2 ˙˙˙.B.X//;
D 2 B.Œ0; 1/g/  ˙˙˙	.B.X ˝ Œ0; 1//:
2. Now let H 2 ˙˙˙	.B.X/ ˝ Œ0; 1/; then we ﬁnd H0 2 B..=X 
Œ0; 1/  / such that H D 1
	

H0

. But
B.X  Œ0; 1=  / D B.X= ˝ Œ0; 1/ D B.X=/ ˝ B.Œ0; 1/;
the ﬁrst equality following from .X  Œ0; 1/=   D X=  Œ0; 1 and
the second from Proposition 4.3.16. This is so since  is smooth; hence

4.5. THE SOUSLIN OPERATION
517
X= is an analytic space, and Œ0; 1 is a Polish space and hence has a
countable basis. On the other hand, 	 D   id; hence we have
found that H D .id/1
H0

with H0 2 B.X=/ ˝ B.Œ0; 1/: This
establishes the other inclusion. a
This shows that tame equivalence relations constitute a generalization
of smooth ones for the case that we do not work in a Polish environ-
ment.
Sometimes one starts not with a topological space and its Borel sets
but rather with a measurable space: A standard Borel space .X; A/ is a
measurable space such that the -algebra A equals B./ for some Polish
topology  on X. We will not dwell on this distinction.
4.5
The Souslin Operation
The collection of analytic sets is closed under Souslin’s operation A ,
which we will introduce now. We will also see that complete mea-
sure spaces are another important class of measurable spaces which are
closed under this operation. Each measurable space can be completed
with respect to its ﬁnite measures, so that we do not even need a topol-
ogy for carrying out the constructions ahead.
Let NC be the set of all ﬁnite and nonempty sequences of natural num-
bers. Denote for t D .xn/n2N 2 NN by tjk D hx1; : : : ; xki its ﬁrst k
elements. Given a subset C  P .X/, put
A .C/ WD f
[
t2NN
\
k2N
Atjk j Av 2 C for all v 2 NCg:
Note that the outer union may be taken of more than countably many
sets. A family .Av/v2NC is called a Souslin scheme, which is called
regular if Aw  Av whenever v is an initial piece of w. Because
[
t2NN
\
k2N
Atjk D
[
t2NN
\
k2N
 \
1jk
Atjj

;
we can and will restrict our attention to regular Souslin schemes when-
ever C is closed under ﬁnite intersections.

518
CHAPTER 4. MEASURES FOR PROBABILISTIC SYSTEMS
We will see now that each analytic set can be represented through a
Souslin scheme with a special shape. This has some interesting conse-
quences, among others, that analytic sets are closed under the Souslin
operation.
Proposition 4.5.1 Let X be a Polish space and .Av/v2NC be a regular
Souslin scheme of closed sets such that diam.Av/ ! 0, as the length of
v goes to inﬁnity. Then
E WD
[
t2NN
\
k2N
Atjk
is an analytic set in X. Conversely, each analytic set can be represented
in this way.
Proof 1. Assume E is given through a Souslin scheme; then we repre-
sent E D f

F

with F  NN a closed set and f W F ! X continu-
ous.
In fact, put
F WD ft 2 NN j Atjk 6D ; for all kg:
Then F is a closed subset of NN: Take s 2 NN n F ; then we can ﬁnd
k0 2 N with Asjk0 D ;, so that G WD ft 2 NN j tjk0 D sjk0g is
open in NN, contains s, and is disjoint to F . Now let t 2 F ; then there
exists exactly one point f .t/ 2 T
k2N Atjk, since X is complete and
the diameters of the sets involved tend to zero; see Proposition 3.5.25.
Then E D f

F

follows from this construction, and we show that f is
continuous.
Let t 2 F and  > 0 be given, take x WD f .t/, and let B be the
ball with center x and radius . Then we can ﬁnd an index k such that
Atjk0  S for all k0  k; hence U WD fs 2 F j tjk D sjkg is an open
neighborhood of t with f

U

 B.
2. Let E be an analytic set; then E D f

NN
with f continuous by
Proposition 4.4.2. Deﬁne Av as the closure of the set f

ft 2 NN j
tjk D vg

; if the length of v is k. Then clearly
E D
[
t2NN
\
k2N
Atjk;
since f is continuous. It is also clear that .Av/v2NC is regular with
diameter tending to zero. a

4.5. THE SOUSLIN OPERATION
519
Before we can enter into the—fairly technical—demonstration that the
Souslin operation is idempotent, we need some auxiliary statements.
The ﬁrst one is readily veriﬁed.
Lemma 4.5.2 b.m; n/ WD 2m1.2n  1/ deﬁnes a bijective map N 
N ! N. Moreover, m  b.m; n/ and n < n0 implies b.m; n/ <
b.m; n0/ for all n; n0; m 2 N. a
Given k 2 N, there exists a unique pair h`.k/; r.k/i 2 N  N with
b.`.k/; r.k// D k. We will need the functions `; r W N ! N later on.
The next function is considerably more complicated, since it caters for
a more involved set of parameters.
Lemma 4.5.3 Given ´ D .´n/n2N 2 .NN/N with ´n D .´n;m/m2N and
t 2 NN, deﬁne the sequence B.t; ´/ 2 NN through
B.t; ´/k WD b.t.k/; ´`.k/;r.k//
(k 2 N). Then B W NN  .NN/N ! NN is a bijection.
Proof 1. We show ﬁrst that B is injective. Let ht; ´i 6D ht0; ´0i. If
t 6D t0, we ﬁnd k with t.k/ 6D t0.k/, so that b.t.k/; ´`.k/;r.k// 6D
b.t0.k/; ´0
`.k/;r.k// follows, because b is injective. Now assume that
t D t0, but ´ 6D ´0, so we can ﬁnd i; j 2 N with ´i;j 6D ´0
i;j . Let k WD
b.i; j /, so that `.k/ D i and r.k/ D j ; hence ht.k/; ´`.k/;r.k/i6Dht.k/;
´0
`.k/;r.k/i, so that B.t; ´/k6DB.t0; ´0/k.
2. Now let s 2 NN, and deﬁne t 2 NN and ´ 2 .NN/N
tk WD `.sk/;
´n;m WD r.sb.n;m//:
Then we have for k 2 N
B.t; ´/k D b.tk; ´`.k/;r.k// D b

`.sk/; r.sb.`.k/;r.k///

D b

`.sk/; r.sk/

D sk:
a
We construct maps ';  from the maps b and B now with special prop-
erties. They will be made use of in the proof that the Souslin operation
is idempotent.

520
CHAPTER 4. MEASURES FOR PROBABILISTIC SYSTEMS
Lemma 4.5.4 There exist maps ';  W NC ! NC with this property:
Let w D B.t; ´/jb.n; m/; then '.w/ D tjm and  .w/ D ´mjn.
Proof Fix v D hx1; : : : ; xki, then deﬁne for m WD `.k/ and n WD
r.k/
'.v/ WD h`.x1/; : : : ; `.xm/i;
 .v/ WD hr.xb.m;1/; : : : ; r.xb.m;n//i:
We see from Lemma 4.5.2 that these deﬁnitions are possible.
Given t 2 NN and ´ 2 .NN/N, we put k WD b.m; n/ and v WD B.t; ´/jk,
then we obtain from the deﬁnition of ' resp.  
'.v/ D h`.v1/; : : : ; `.vm/i D tjm;
 .v/ D hr.vb.m;0//; : : : ; r.vb.m;n//i D ´mjn;
as desired. a
The construction shows that A .C/ is always closed under countable
unions and countable intersections. We are now in a position to prove a
much more general observation of the Souslin operation.
Theorem 4.5.5 A .A .C// D A .C/.
Proof It is clear that C  A .C/, so we have to establish the other inclu-
sion. Let fDv;w j w 2 NCg be a Souslin scheme for each v 2 NC, and
put Av WD S
s2NN
T
m2N Dv;sjm: Then we have
A WD
[
t2NN
\
k2N
Atjk
D
[
t2NN
\
k2N
[
s2NN
\
m2N
Dv;sjm
D
[
t2NN
[
.´n/n2N2.NN/N
\
m2N
\
k2N
Dtjm;´mjn
./
D
[
s2NN
\
k2N
Csjk
with
Cv WD D'.v/; .v/
for v 2 NC. So we have to establish the equality marked ./.

4.5. THE SOUSLIN OPERATION
521
“”: Given x 2 A, there exist t 2 NN and ´ 2 .NN/N such that
x 2 Dtjm;´mjn. Put s WD B.t; ´/.
Let k 2 N be arbitrary;
then there exists a pair hm; ni 2 N  N with k D b.m; n/ by
Lemma 4.5.2. Thus we have tjm D '.sjk/ and ´mjn D  .sjk/
by Lemma 4.5.4, from which x 2 Dtjm;´mjn D Csjk follows.
“	”: Let s 2 NN such that x 2 Csjk for all k 2 N. We can ﬁnd by
Lemma 4.5.3 some t 2 NN and ´ 2 .NN/N with B.t; ´/ D s.
Given k, there exists m; n 2 N with k D b.m; n/; hence Csjk D
Dtjm;´mjn. Thus x 2 A.
a
We obtain as an immediate consequence that analytic sets in a Polish
space X are closed under the Souslin operation. This is so because we
have seen that the collection of analytic sets is contained in A

fF 
X j F is closedg

, so an application of Theorem 4.5.5 proves the claim.
But we can say even more.
Proposition 4.5.6 Assume that the complement of each set in C belongs
to A .C/ and ; 2 C. Then .C/  A .C/. In particular, analytic sets in
a Polish space X are closed under the Souslin operation.
Proof We apply for establishing the general statement the principle of
good sets. Deﬁne
G WD fA 2 A .C/ j X n A 2 A .C/g:
Then G is closed under complementation. If .An/n2N is a sequence in
G, then T
n2N An 2 G, because A .C/ is closed under countable unions.
Similarly, S
n2N An 2 G. Since ; 2 G, we may conclude that G is a
-algebra, which contains C by assumption. Hence .C/  .G/ D
G  A .C/. The assertion concerning analytic sets follows from Propo-
sition 4.5.1, because a closed set is a Gı-set. a
With complete measure spaces, we will meet an important class of mea-
surable spaces, which is closed under the Souslin operation. As a prepa-
ration for this, we state and prove an interesting criterion for being
closed under this operation. This requires the deﬁnition of a particu-
lar kind of cover.

522
CHAPTER 4. MEASURES FOR PROBABILISTIC SYSTEMS
Deﬁnition 4.5.7 Given a measurable space .X; A/ and a subset A 
X, we call A" 2 A an A-cover of A iff
1. A  A".
2. For every B 2 A with A  B, P

A" n B

 A.
Thus A" 2 A covers A in the sense that A  A", and if we have another
set B 2 A which covers A as well, then all the sets which make out
the difference between A" and B are measurable. This last condition
indicates that the “breathing space” between A and its cover A" is an
element of A. In a technical sense, this will give us considerable room
for maneuvering, when applying this concept.
In addition it follows that if A  A0  A" and A0 2 A, then A0 is also an
A-cover. This concept sounds fairly artiﬁcial and somewhat far-fetched,
but we will see that it arises in a natural way when completing measure
spaces. The surprising observation is that a space is closed under the
Souslin operation whenever each subset has an A-cover.
Proposition 4.5.8 Let .X; A/ be a measurable space such that each
subset of X has an A-cover. Then .X; A/ is closed under the Souslin
operation.
Proof 0. The proof is a bit tricky. We ﬁrst construct from a regular
Outline of
the proof
Souslin scheme a sequence of sets which are indexed by the words over
N such that each set Bw can be represented as the union of

Bwn

n2N. For each set Bw, there exists an A-cover, which due to
the properties of Bw can be more easily manipulated than a cover for
the sets in the Souslin scheme proper; in particular we can look at the
difference between the A-cover for Bn and those for Bwn, so that we
can move backward, from longer words to shorter ones. It will then turn
out that we can represent the set deﬁned by the given Souslin scheme
through the A-cover given for the empty word .
1. Let
A WD
[
t2NN
\
k2N
Aajk
with .Av/v2NC a regular Souslin scheme in A. Deﬁne
Bw WD
[ ˚\
n2N
Atjn j t 2 NN; w is a preﬁx of t


4.5. THE SOUSLIN OPERATION
523
for w 2 N D NC [ fg. Then B D A, Bw D S
n2N Bwn, and
Bw  Aw if w 6D .
By assumption, there exists a A-cover B"
w for Bw. We may and do
assume that B"
w  Aw and that .B"
w/w2N is regular; otherwise we
force this condition by considering the A-cover
\
fB"
v \ Av j v preﬁx of wg

w2N
instead. Now put
Dw WD B"
w n
[
n2N
B"
wn
for w 2 N. We obtain from this construction
Bw  B"
w D
[
n2N
B"
wn 2 AI
hence we see that every subset of Dw is in A, since B"
w is an A-cover.
Thus every subset of
D WD
[
w2N
Dw
is in A.
2. We claim that B"
 n D  A. In fact, let x 2 B"
 n D; then x 62 D,
so we can ﬁnd k1 2 N with x 2 B"
k1, but x 62 Dn1. Since x 62 Dk1,
we ﬁnd k2 with x 2 B"
k1;k2 such that x 62 Dk1;k2. So we inductively
deﬁne a sequence t WD .kn/n2N so that x 2 B"
tjk for all k 2 N. Because
B"
tjk  Atjk, we conclude that x 2 A.
3. Hence we obtain B"
 nA  D, and since every subset of D is in A, we
conclude that B"
 n A 2 A, which means that A D B"
 n .B"
 n A/ 2 A.
a
The concept of being closed under the Souslin operation will now be
applied to universally measurable sets, in particular to analytic sets in a
Polish space.

524
CHAPTER 4. MEASURES FOR PROBABILISTIC SYSTEMS
4.6
Universally Measurable Sets
After these technical preparations, we are poised to enter the interesting
world of universally measurable sets with the closure operations that
are associated with them. We deﬁne complete measure spaces and show
that an arbitrary (-)ﬁnite measure space can be completed, uniquely
extending the measure as we go. This leads also to completions with
respect to families of ﬁnite measures, and we show that the resulting
measurable spaces are closed under the Souslin operation.
Two applications are discussed. The ﬁrst one demonstrates that a mea-
sure deﬁned on a countably generated sub--algebra of the Borel sets
of an analytic space can be extended to the Borel sets, albeit not neces-
sarily in a unique way. This result due to Lubin rests on the important
von Neumann Selection Theorem, giving a universally right inverse to
a measurable map from an analytic to a separable space. Another ap-
plication of von Neumann’s result is the observation that under suitable
topological assumptions for a surjective map f , the lifted map M.f / is
surjective as well. The second application shows that a transition kernel
can be extended to the universal closures of the measurable spaces in-
volved, provided the target space is separable. This, however, does not
require a selection.
A -ﬁnite measure space .X; A; / is called complete iff .A/ D 0
Complete
measure
with A 2 A and B  A implies B 2 A. Thus if we have two sets
A; A0 2 A with A  A0 and .A/ D .A0/, then we know that each set
which can be sandwiched between the two will be measurable as well.
This is partly anticipated in the discussion in Sect. 1.6.4, where a similar
extension problem is considered, but starting from an outer measure.
We will discuss the completion of a measure space and investigate some
properties. We ﬁrst note that it is sufﬁcient to discuss ﬁnite measure
spaces; in fact, assume that we have a collection of mutually disjoint sets
.Gn/n2N with Gn 2 A such that 0 < .Gn/ < 1 and S
n2N Gn D X,
and consider the measure
0.B/ WD
X
n2N
.B \ Gn/
2n  .Gn/ I
then  is complete iff 0 is complete, and 0 is a probability mea-
sure.

4.6. UNIVERSALLY MEASURABLE SETS
525
We ﬁx for the time being a ﬁnite measure  on a measurable space
.X; A/.
The outer measure  is deﬁned through
.C/ WD inff
X
n2N
.An/ j C 
[
n2N
An; An 2 A for all n 2 Ng
D inff.A/ j C  A; A 2 Ag
for any subset C of X; see page 79.

Deﬁnition 4.6.1 Call N  X a -null set iff .N / D 0. Deﬁne N
as the set of all -null sets.
Because  is countably subadditive by Lemma 1.6.21, we obtain
Lemma 4.6.2 N is a -ideal. a
Now assume that we have sets A; A0 2 A and N; N 0 2 N with
AN D A0N 0. Then we may infer .A/ D .A0/, because AA0 D
A

A.NN 0/

D NN 0  N [ N 0 2 N, and j.A/  .A0/j 
.AA0/. Thus we may construct an extension of  to the -algebra
generated by A and N in the obvious way. Let us have a look at some
properties of this construction.
Proposition 4.6.3 Deﬁne A WD .A [ N/ and .AN / WD .A/
for A 2 A; N 2 N. Then
1. A D fAN j A 2 A; N 2 Ng, and A 2 A iff there exist
sets A0; A00 2 A with A0  A  A00 and .A00 n A0/ D 0:
2.  is a ﬁnite measure and the unique extension of  to A.
3. The measure space .X; A; / is complete. It is called the -
completion of .X; A; /.
Proof 0. The proof is a fairly straightforward check of the properties.
It rests essentially on the observation that N is a -ideal, so that the
construction of the -algebra under consideration has already been stud-
ied.

526
CHAPTER 4. MEASURES FOR PROBABILISTIC SYSTEMS
1. Since N is a -ideal, we infer from Lemma 4.1.3 that A 2 A iff
there exist B 2 A and N 2 N with A D BN . Now consider
C WD fA 2 A j 9A0; A00 2 A W A0  A  A00; .A00 n A0/ D 0g:
Then C is a -algebra which contains A [ N; thus C D A.
From the observation made just before stating the proposition, it be-
comes clear that  is well deﬁned on A. Since  coincides with  on
A and the outer measure is countably subadditive by Lemma 1.6.23,
we have to show that  is additive on A. This follows immediately
from the ﬁrst part. If  is another extension to  on A, N D N
follows, so that .AN / D .A/ D .A/ D .AN / whenever
AN 2 A.
2. Completeness of .X; A; / follows now immediately from the con-
struction. a
Surprisingly, we have received more than we have shopped for, since
complete measure spaces are closed under the Souslin operation. This
is remarkable because the Souslin operation evidently bears no hint at all
at measures which are deﬁned on the base space. In addition, measures
are deﬁned through countable operations, while the Souslin operation
makes use of the uncountable space NN.
Proposition 4.6.4 A complete measure space is closed under the
Souslin operation.
The proof simply combines the pieces we have constructed already into
a sensible picture.
Proof Let .X; A; / be complete; then it is enough to show that each
B  X has an A-cover (Deﬁnition 4.5.7); then the assertion will follow
from Proposition 4.5.8. In fact, given B, construct B 2 A such that
.B/ D .B/; see Lemma 1.6.35. Whenever C 2 A with B 
C, we evidently have every subset of B n C in A by completeness.
a
These constructions work also for -ﬁnite measure spaces, as indicated
above.
Now let M be a nonempty set of -ﬁnite measures on the
measurable space .X; A/, then deﬁne the M-completion A
M and the

4.6. UNIVERSALLY MEASURABLE SETS
527
universal completion A of the -algebra A through
AM ; A
A
M WD
\
2M
A;
A WD
\
fA j  is a -ﬁnite measure on Ag:
As an immediate consequence, this yields that the analytic sets in a Pol-
ish space are contained in the universal completion of the Borel sets,
speciﬁcally
Corollary 4.6.5 Let X be a Polish space and  be a ﬁnite measure on
B.X/. Then all analytic sets are contained in B.X/.
Proof Proposition 4.5.1 shows that each analytic set can be represented
through a Souslin scheme based on closed sets, and Proposition 4.6.4
shows that B.X/ is closed under the Souslin operation. a
Just for the record
Corollary 4.6.6 The universal closure of a measurable space is closed
under the Souslin operation. a
Measurability of maps is preserved when passing to the universal clo-
sure.
Lemma 4.6.7 Let f W X ! Y be A-B measurable; then f is A-B
measurable.
Proof Let D 2 B be a universally measurable subset of Y ; then we have
to show that E WD f 1
D

is universally measurable in X. So we have
to show that for every ﬁnite measure  on A, there exists E0; E00 2 A
with E0  E  E00 and .E0 n E00/ D 0.
Deﬁne  as the image of  under f , so that .B/ D .f 1
B

/ for
each B 2 B; then we know that there exists D0; D00 2 B with D0 
D  D00 such that .D00 n D0/ D 0; hence we have for the measurable
sets E0 WD f 1
D0
, E00 WD f 1
D00
.E00 n E0/ D .f 1
D00 n D0
/ D .D00 n D0/ D 0:
Thus f 1
D

2 A. a
We will give now two applications of this construction. The ﬁrst will
show that a ﬁnite measure on a countably generated sub--algebra of

528
CHAPTER 4. MEASURES FOR PROBABILISTIC SYSTEMS
the Borel sets of an analytic space has always an extension to the Borel
sets, and the second will construct an extension of a stochastic relation
K W .X; A/  .Y; B/ to a stochastic relation K W .X; A/  .Y; B/,
provided the target space .Y; B/ is separable. This ﬁrst application is
derived from von Neumann’s Selection Theorem, which is established
here as well. It is shown also that a measurable surjection can be lifted
to a measurable map between ﬁnite measure spaces, provided the target
space is a separable metric space.
4.6.1
Lubin’s Extension Through von Neumann’s Selectors
Let X be an analytic space and B be a countably generated sub--
algebra of B.X/. We will show that each ﬁnite measure deﬁned on
B has at least one extension to a measure on B.X/. This is established
through a surprising selection argument, as we will see.
As a preparation, we require a universally measurable right inverse of a
measurable surjective map f W X ! Y . We know from the Axiom of
Choice that we can ﬁnd for each y 2 Y some x 2 X with f .x/ D y,
because ff 1
fyg

j y 2 Y g is a partition of X into nonempty sets;
see Proposition 1.0.1. Set g.y/ WD x. Selecting an inverse image in this
way will not guarantee, however, that g has any favorable properties,
even if, say, both X and Y are compact metric and f is continuous.
Hence we will have to proceed in a more systematic fashion.
We will use the observation that each analytic set in a Polish space can
be represented as the continuous image of NN, as discussed in Proposi-
tion 4.4.2. Again, the strategy of using a particular space as a reference
point pays off. We move the problem to N1, where we can easily de-
ﬁne a total order, which is then used for solving the problem. Then we
port the solution back to the space from which it originated. We will
ﬁrst formulate a sequence of auxiliary statements that deal with ﬁnd-
ing for a given surjective map f W X ! Y a map g W Y ! X such
that f ı g D idY . This map g should have some sufﬁciently pleasant
properties.
In order to make the ﬁrst step, it turns out to be helpful focusing the
attention to analytic sets being the continuous images of NN. This looks
a bit far-fetched, because we want to deal with universally measurable
sets, but remember that analytic sets are universally measurable.

4.6. UNIVERSALLY MEASURABLE SETS
529
We order NN lexicographically by saying that .tn/n2N  .t0n/n2N iff
.tn/  .t0
n/
there exists k 2 N such that tk  t0
k and tj D t0
j for all j with 1  j <
k. Then  deﬁnes a total order on NN. We will capitalize on this order,
to be more precise, on the interplay between the order and the topology.
Let us brieﬂy look into the order structure of NN.
Lemma 4.6.8 Each nonempty closed set F  N1 has a minimal ele-
ment in the lexicographic order.
Proof Let n1 be the minimal ﬁrst component of all elements of F , n2 be
the minimal second component of those elements of F that start with n1,
etc. This deﬁnes an element t WD hn1; n2; : : :i. We claim that t 2 F .
Let U be an open neighborhood of t; then there exists k 2 N such
that t 2 n1:::nk  U (˛ is deﬁned on page 492). By construction,
n1:::nk\F 6D ;; thus each open neighborhood of t contains an element
of F . Hence t is an accumulation point of F , and since F is closed, it
contains all its accumulation points. Consequently, t 2 F . a
We know for f W NN ! X continuous that the inverse images f 1
fyg

with y 2 f

NN
are closed. Thus me may pick for each y 2 f

NN
this
smallest element. This turns out to be a suitable choice, as the following
statement shows:
Lemma 4.6.9 Let X be Polish, Y  X analytic with Y D f

NN
for
some continuous f W NN ! X. Then there exists g W Y ! NN such
that
1. f ı g D idY ,
2. g is B.Y /-B.NN/-measurable.
Proof 1. Since f is continuous, the inverse image f 1
fyg

for each
y 2 Y is a closed and nonempty set in N1. Thus this set contains a
minimal element g.y/ in the lexicographic order  by Lemma 4.6.8. It
is clear that f .g.y// D y holds for all y 2 Y .
2. Denote by A.t0/ WD ft 2 N1 j t  t0gI then A.t0/ is open: Let
.`n/n2N D t  t0 and k be the ﬁrst component in which t differs from
t0; then `1:::`k1 is an open neighborhood of t that is entirely contained
in A.t0/. It is easy to see that fA.t0/ j t0 2 N1g is a generator for the
Borel sets of N1.
3.
We claim that g1
A.t0/

D f

A.t0/

holds.
In fact, let y 2
g1
A.t0/

, so that g.y/ 2 A.t0/; then y D f .g.y// 2 f

A.t0/

:

530
CHAPTER 4. MEASURES FOR PROBABILISTIC SYSTEMS
If, on the other hand, y D f .t/ with t  t0, then by construction
t 2 f 1
fyg

; thus g.y/  t  t0, settling the other inclusion.
This equality implies that g1
A.t0/

is an analytic set, because it is the
image of an open set under a continuous map. Consequently, g1
A.t0/

is universally measurable for each A.t0/ by Corollary 4.6.5. Thus g is a
universally measurable map. a
This statement is the work horse for establishing that a right inverse ex-
ists for surjective Borel maps between an analytic space and a separable
measurable space. All we need to do now is to massage things into a
shape that will render this result applicable in the desired context. The
following theorem is attributed to von Neumann.
Theorem 4.6.10 Let X be an analytic space, .Y; B/ a separable mea-
surable space, and f W X ! Y a surjective measurable map. Then
there exists g W Y ! X with these properties:
Von
Neumann’s
Selection
Theorem
1. f ı g D idY ,
2. g is B-B.X/-measurable.
Proof 0. Lemma 4.6.9 gives the technical link which permits to use N1
as an intermediary for which we have already a partial solution.
1. We may and do assume by Lemma 4.4.17 that Y is an analytic subset
of a Polish space Q and that X is an analytic subset of a Polish space
P . x 7! hx; f .x/i is a bijective Borel map from X to the graph of
f , so graph.f / is an analytic set by Proposition 4.4.6. Thus we can
ﬁnd a continuous map F W NN ! P  Q with F

NN
D graph.f /:
Consequently, Q ı F is a continuous map from NN to Q with
.Q ı F /

NN
D Q

graph.f /

D Y:
Now let G W Y ! NN be chosen according to Lemma 4.6.9 for Q ı F .
Then g WD P ı F ı G W Y ! X is the map we are looking for:
 g is universally measurable, because G is, and because P ı F
are continuous, they are universally measurable as well,
 f ıg D f ı.P ıF ıG/ D .f ıP /ıF ıG D QıF ıG D idY ,
so g is right inverse to f .
a

4.6. UNIVERSALLY MEASURABLE SETS
531
Due to its generality, the von Neumann Selection Theorem has many ap-
plications in diverse areas, many of them surprising. The art in applying
it is to reformulate the problem in a suitable manner so that the require-
ments of this selection theorem are satisﬁed. We pick two applications,
viz., showing that the image M.f / of a surjective Borel map f yields a
surjective Borel map again and Lubin’s measure extension.
Proposition 4.6.11 Let X be an analytic space and Y a second count-
able metric space. If f W X ! Y is a surjective Borel map, so is
M.f / W M.X/ ! M.Y /:
Proof 1. From Theorem 4.6.10, we ﬁnd a map g W Y ! X such that
f ı g D idY and g is B.Y /  B.X/-measurable.
2. Let  2 M.Y /, and deﬁne  WD M.g/./I then  2 M.X; B.X//
by construction. Restrict  to the Borel sets on X, obtaining 0 2
M.X; B.X//: Since we have for each set B

Y the equality
g1
f 1ŒB

D B; we see that for each B 2 B.Y /
M.f /.0/.B/ D 0.f 1
B

/ D .f 1
B

/
D .g1
f 1
B

/ D .B/
holds. a
This has as a consequence that M is an endofunctor on the category
of Polish or analytic spaces with surjective Borel maps as morphisms;
it displays a pretty interaction of reasoning in measurable spaces and
arguing in categories.
The following extension theorem due to Lubin shows that one can ex-
tend a ﬁnite measure from a countably generated sub--algebra to the
Borel sets of an analytic space. In contrast to classical extension theo-
rems like Theorem 1.6.29, it does not permit to conclude that the exten-
sion is uniquely determined.
Theorem 4.6.12 Let X be an analytic space and  be a ﬁnite measure
on a countably generated sub--algebra A  B.X/. Then there exists
an extension of  to a ﬁnite measure  on B.X/.
Proof Let .An/n2N be the generator of A, and deﬁne the map f W X !
f0; 1gN through x 7!

An.x/

n2N. Then M WD f

X

is an analytic

532
CHAPTER 4. MEASURES FOR PROBABILISTIC SYSTEMS
space, and f is B.X/-B.M/-measurable by Propositions 4.3.10 and
4.4.6. Moreover,
A D ff 1
C

j C 2 B.M/g:
(4.6)
By von Neumann’s Selection Theorem 4.6.10, there exists g W M ! X
with f ı g D idM which is B.M/-B.X/-measurable. Deﬁne
.B/ WD 

.g ı f /1
B

for B 2 B.X/ with  as the completion of  on A. Since we have
g1
B

2 B.M/ for B 2 B.X/, we may conclude from (4.6) that
f 1
g1
B

2 A.  is an extension to . In fact, given A 2 A, we
know that A D f 1
C

for some C 2 B.M/, so that we obtain
.A/
D 

.g ı f /1
f 1
C

D 

f 1 ı g1 ı f 1ŒC

./
D 

f 1
C

D .A/
D .A/:
./ holds, since f ı g D idM . This completes the proof. a
Lubin’s Theorem can be rephrased in a slightly different way as follows.
The identity idA W .X; B.X// ! .X; A/ is measurable, because A is a
sub--algebra of B.X/. Hence it induces a measurable map S.idA/ W
S.X; B.X// ! S.X; A/. Lubin’s Theorem then implies that S.idA/ is
surjective. This is so since S.idA/./ is just the restriction of  to the
sub--algebra A for a given  2 S.X; B.X//.
4.6.2
Completing a Transition Kernel
In some probabilistic models for modal logics, it becomes necessary
to assume that the state space is closed under Souslin’s operation (see,
for example, [Dob12b] or Sect. 4.9.4); on the other hand one may not
always assume that a complete measure space is given. Hence one needs
to complete it, but it is then also mandatory to extend the transition law
to the completion as well. This means that an extension of the transition
law to the completion becomes necessary. This problem will be studied
now.
The completion of a measure space is described in terms of null sets and
using inner and outer approximations; see Proposition 4.6.3. We will use

4.6. UNIVERSALLY MEASURABLE SETS
533
the latter here, ﬁxing measurable spaces .X; A/ and .Y; B/. Denote by
SX the smallest -algebra on X which contains A and which is closed
SX
under the Souslin operation; hence SX  A by Corollary 4.6.6.
Fix K W .X; A/  .Y; B/ as a transition kernel, and assume ﬁrst that
B D B.Y / is the -algebra of Borel sets for a separable metric space.
Hence the topology  of Y has a countable base 0, which in turn implies
that G D SfH 2 0 j H  Gg for each open set G 2 .
For each x 2 X, we have a ﬁnite measure K.x/ through the transition
kernel K. We associate to K.x/ an outer measure

K.x/
 on the power
set of X. We want to show that the map
x 7!

K.x/
.A/
is SX-measurable for each A  Y ; deﬁne for convenience
K.x/ WD

K.x/
:
Establishing measurability is broken into a sequence of steps.
We need the following regularity argument (but compare Exercise 4.12
for the nonmetric case):
Lemma 4.6.13 Let  be a ﬁnite measure on .Y; B.Y //, B 2 B.Y /.
Then we can ﬁnd for each  > 0 an open set G  Y with B  G and a
closed set F 	 B such that .G n F / < .
Proof 0. Let
G WD fB 2 B.Y / j the assertion is true for Bg:
We will use a variant of the principle of good sets by showing that G has
Outline of
the proof
these properties:
 G is closed under complementation.
 The open sets (and, by implication, the closed sets) are contained
in G.
 G is closed under taking disjoint countable unions.
This will permit applying the --Theorem, because the open sets are a
\-closed generator of the Borel sets.

534
CHAPTER 4. MEASURES FOR PROBABILISTIC SYSTEMS
1. That G is closed under complementation trivial. G contains the open
as well as the closed sets. If F  Y is closed, we can represent F D
T
n2N Gn with .Gn/n2N as a decreasing sequence of open sets; hence
.F / D infn2N .Fn/ D limn!1 .Fn/; so that G also contains the
closed sets; one argues similarly for the open sets as increasing unions
of open sets.
2. Now let .Bn/n2N be a sequence of mutually disjoint sets in G, and
select Gn open for Bn and =2.nC1/; then G WD S
n2N Gn is open with
B WD S
n2N Bn  G and .G n B/  . Similarly, select the sequence
.Fn/n2N with Fn  Bn and .Bn nFn/ < =2.nC1/ for all n 2 N, put
F WD S
n2N Fn, and select m 2 N with .F n Sm
nD1 Fn/ < =2; then
F 0 WD Sm
nD1 Fn is closed, F 0  B, and .B n F 0/ < .
3. Hence G is closed under complementation as well as countable dis-
joint unions. This implies G D B.Y / by the - Theorem 1.6.30, since
G contains the open sets. a
Fix A  Y for the moment. We claim that
K.x/.A/ D inffK.x/.G/ j A  G openg
holds for each x 2 X. In fact, given  > 0, there exists A  A0 2 B.Y /
with K.x/.A0/  K.x/.A/ < =2: Applying Lemma 4.6.13 to K.x/,
we ﬁnd an open set G 	 A0 with K.x/.G/  K.x/.A0/ < =2I thus
K.x/.G/  K.x/.A/ < :
Since 0 is a countable base for the open sets, which we may assume to
be closed under ﬁnite unions (because otherwise fG1 [ : : : [ Gk j k 2
N; G1; : : : ; Gk 2 0g is a countable base which has this property), we
obtain
K.x/.A/ D inffsup
n2N
K.x/.Gn/ j A 
[
n2N
Gn; .Gn/n2N  0 increasesg:
(4.7)
Let
GA WD f.Gn/n2N  0 j .Gn/n2N increases and A 
[
n2N
Gng

4.6. UNIVERSALLY MEASURABLE SETS
535
be the set of all increasing sequences from base 0 which cover A. Par-
tition GA into the sets
NA WD fg 2 GA j g contains only a ﬁnite number of setsg;
MA WD GA n NA:
Because 0 is countable, NA is.
We want so show that K, suitably restricted, is the extension we are
looking for. In order to establish this, we build a tree with basic open
sets as nodes. The offsprings of node G 2 0 are those open sets G0 2 0
which contain G. Thus each node has at most countably many off-
springs. This tree will be used to construct a Souslin scheme.
Lemma 4.6.14 There exists an injective map ˚ W MA ! NN such that
g j k D g0 j k implies ˚.g/ j k D ˚.g0/ j k for all k 2 N.
Proof 1.
Build an inﬁnite tree in this way: The root is the empty
set, a node G at level k has all elements G0 from 0 with G  G0
as offsprings.
Remove from the tree all paths H1; H2; : : : such that
A 6 S
n2N Hn: Call the resulting tree T .
2. Put G0 WD ;, and let T1;G0 be the set of nodes of T on level 1 (hence
just the offsprings of the root G0); then there exists an injective map
˚1;G0 W T1;G0 ! N: If G1; : : : ; Gk is a ﬁnite path to inner node Gk in
T , denote by TkC1;G1;:::;Gk the set of all offsprings of Gk, and let
˚kC1;G1;:::;Gk W TkC1;G1;:::;Gk ! N
be an injective map. Deﬁne
˚ W
(
MA
! NN;
.Gn/n2N
7!

˚n;G1;:::;Gn1.Gn/

n2N:
3. Assume ˚.g/ D ˚.g0/; then an inductive reasoning shows that g D
g0. In fact, G1 D G0
1, since ˚1;; is injective. If g j k D g0 j k has al-
ready been established, we know that ˚kC1;G1;:::;Gk D ˚kC1;G0
1;:::;G0
k
is injective, so that GkC1 D G0
kC1 follows. A similar inductive argu-
ment shows that ˚.g/ j k D ˚.g0/ j k, provided g j k D g0 j k for each
k 2 N holds. a

536
CHAPTER 4. MEASURES FOR PROBABILISTIC SYSTEMS
The following lemmata collect some helpful properties:
Lemma 4.6.15 g D g0 iff ˚.g/ j k D ˚.g0/ j k for all k 2 N, whenever
g; g0 2 MA. a
The argument for establishing the following statement uses the tree
and the maps associated with it for constructing a suitable Souslin
scheme.
Lemma 4.6.16 Denote by Jk WD f˛ j k j ˛ 2 ˚

MA

g all initial
pieces of sequences in the image of ˚. Then ˛ 2 ˚

MA

iff ˛ j k 2 Jk
for all k 2 N.
Proof Assume that ˛ D ˚.g/ 2 ˚

MA

with g D .Cn/n2N 2 MA
and ˛ j k 2 Jk for all k 2 N, so for given k there exists g.k/ D
.C .k/n/n2N 2 MA with ˛ j k D ˚.g.k// j k. Because ˚1 is injective,
we obtain C1 D C .1/
1 : Assume for the induction step that Gi D G.j/
i
has been shown for 1  i; j  k. Then we obtain from ˚.g/ j k C
1 D ˚.g.kC1// j k C 1 that G1 D G.kC1/
1
; : : : ; Gk D G.kC1/
k
: Since
˚kC1;G1;:::;Gk is injective, the equality above implies GkC1 D G.kC1/
kC1 .
Hence g D g.k/ for all k 2 N, and ˛ 2 ˚

MA

is established. The
reverse implication is trivial. a
Lemma 4.6.17 Er WD fx 2 X j K.x/.A/  rg 2 SX for r 2 RC.
Proof The set Er can be written as
Er D
[
g2NA
fx 2 X j K.x/[
g  rg[
[
g2MA
fx 2 X j K.x/[
g  rg:
Because NA is countable and K W X  Y is a transition kernel, we
infer
[
g2NA
fx 2 X j K.x/
[
g

 rg 2 B.X/:
Put for v 2 NC
Dv WD
(
;;
if v … S
k2N Jk;
fx 2 X j K.x/.Gn/  rg;
if v D ˚

.Gn/n2N

j n:
Lemmata 4.6.15 and 4.6.16 show that Dv 2 B.X/ is well deﬁned.
Because
[
g2MA
fx 2 X j K.x/
[
g

 rg D
[
˛2NN
\
n2N
D˛jn
(4.8)

4.6. UNIVERSALLY MEASURABLE SETS
537
and because SX is closed under the Souslin operation and contains
B.X/, we conclude that Er 2 SX. a
Proposition 4.6.18 Let K W .XI A/  .Y; B/ be a transition kernel,
and assume that Y is a separable metric space. Let SX be the small-
est -algebra which contains A and which is closed under the Souslin
operation. Then there exists a unique transition kernel
K W .X; SX/  .Y; B.Y /
fK.x/jx2Xg/
extending K.
Proof 1. Put K.x/.A/ WDK.x/.A/for x 2 X and A 2 B.Y /
fK.x/jx2Xg.
Because
A
is
an
element
of
the
K.x/-completion
of
B.Y /,
we
know
that
K.x/
D
K.x/
deﬁnes
a
subprobability
on
B.Y /
fK.x/jx2Xg: It is clear that K.x/ is the unique extension of K.x/
to the latter -algebra. It remains to be shown that K is a transition
kernel.
2. Fix A 2 B.Y /
fK.x/jx2Xg and q 2 Œ0; 1; then
fx 2 X j K.x/.A/ < qg D
[
`2N
[
g2GA
fx 2 X j K.x/
[
g

 q  1
`g
The latter set is a member of SX by Lemma 4.6.17. a
Separability of the target space is required because it is this property
which makes sure that the measure for each Borel set can be approxi-
mated arbitrarily well from within by closed sets and from the outside
by open sets (Lemma 4.6.13).
Before discussing consequences, a mild generalization to separable mea-
surable spaces should be mentioned. Proposition 4.6.18 yields as an
immediate consequence.
Corollary 4.6.19 Let K W .XI A/  .Y; B/ be a transition kernel
such that .Y; B/ is a separable measurable space. Assume that X is a
-algebra on X which is closed under the Souslin operation with SX 
X and that Y is a -algebra on X with B  Y  B
fK.x/jx2Xg: Then
there exists a unique extension .X; X/  .Y; Y/ to K. In particular K
has a unique extension to a transition kernel K W .X; A/  .Y; B/.
Proof This follows from Proposition 4.6.18 and the characterization of
separable measurable spaces in Proposition 4.3.10. a

538
CHAPTER 4. MEASURES FOR PROBABILISTIC SYSTEMS
4.7
Measurable Selections
Looking again at von Neumann’s Selection Theorem 4.6.10, we found
for a given surjection f
W X ! Y a universally measurable map
g W Y ! X with f ı g D idY . This can be rephrased: We have
g.y/ 2 f 1
fyg

for each y 2 Y , so g may be considered a universally
measurable selection for the set-valued map y 7! f 1
fyg

.
We will consider constructing a selection from a slightly different angle
by assuming that .X; A/ is a measurable, Y is a Polish space. In addition
we are given a set-valued map F W X ! P .Y / n f;g for which a
measurable selection is to be constructed, i.e., a measurable (not merely
universally measurable) map g W X ! Y such that g.x/ 2 F.x/ for
all x 2 X. Clearly, the Axiom of Choice guarantees the existence of a
map which picks an element from F.x/ for each x, but again this is not
enough.
We assume that F.x/  Y , F.x/ is closed and F.x/ 6D ; for all x 2 X
and that it is measurable. Since F does not necessarily take single values
only, we have to deﬁne measurability in this case. Denote by F.Y / the
set of all closed and nonempty subsets of Y .
Deﬁnition 4.7.1 A map F W X ! F.Y / from a measurable space
.X; A/ to the closed nonempty subsets of a Polish space Y is called
measurable (or a measurable relation) iff
F w
F w.G/ WD fx 2 X j F.x/ \ G 6D ;g 2 A
for every open subset G  Y . The map s W X ! Y is called a measur-
able selector for F iff s is A-B.Y /-measurable such that s.x/ 2 F.x/
for all x 2 X.
Since ff .x/g \ G 6D ; iff f .x/ 2 G, measurability as deﬁned in this
deﬁnition is a generalization of measurability for point-valued maps f W
X ! Y .
The selection theorem due to Kuratowski and Ryll-Nardzewski tells us
that a measurable selection exists for a measurable closed valued map,
provided Y is Polish. To be speciﬁc
Kuratowski
and Ryll-
Nardzewski
selection
theorem
Theorem 4.7.2 Given a measurable space .X; A/ and a Polish space
Y , a measurable map F W X ! F.Y / has a measurable selector.

4.7. MEASURABLE SELECTIONS
539
Proof 0. Fix a complete metric d on Y . As usual, B.y; r/ is the open
ball with center y 2 Y and radius r > 0. Recall that the distance of an
element y to a closed set C is d.y; C/ WD inffd.y; y0/ j y0 2 CgI hence
d.y; C/ D 0 iff y 2 C. The idea of the proof is to deﬁne a sequence
Idea
.fn/n2N of measurable maps such that fn.x/ comes closer and closer
to F.x/, measured in terms of the distance d.fn.x/; F.x// of fn.x/ to
F.x/, and that

fn.x/

n2N is a Cauchy sequence in the complete space
Y for each x.
1. Let .yn/n2N be dense, and deﬁne f1.x/ WD yn, if n is the smallest
index k so that F.x/ \ B.yk; 1/ 6D ;. Then f1 W X ! Y is A-B.Y /-
measurable, because the map takes only a countable number of values
and
fx 2 X j f1.x/ D yng D F w.B.yn; 1// n
n1
[
kD1
F w.B.yk; 1//:
Proceeding inductively, assume that we have deﬁned measurable maps
f1; : : : ; fn such that
d.fj.x/; fjC1.x//
< 2.j1/;
1  j < n;
d.fj.x/; F.x//
< 2j ;
1  j  n:
Put Xk WD fx 2 X j fn.x/ D ykg, and deﬁne fkC1.x/ WD y` for
x 2 Xk, where ` is the smallest index m such that F.x/\B.yk; 2n/\
B.ym; 2.nC1// 6D ;: Moreover, there exists y0 2 B.yk; 2n/ \
B.ym; 2.nC1//; thus
d.fn.x/; fnC1.x//  d.fn.x/; y0/ C f .fnC1.x/; y0/ < 2n C 2.nC1/:
The argumentation from above shows that fnC1 takes only countably
many values, and we know that d.fnC1.x/; F.x//<2.nC1/:
2. Thus .fn.x//n2N/ is a Cauchy sequence for each x 2 X. Since .Y; d/
is complete, the limit f .x/ WD limn!1 fn.x/ exists with d.f .x/;F.x//
D 0; hence f .x/ 2 F.x/, because F.x/ is closed. Moreover, as a point-
wise limit of a sequence of measurable functions, f is measurable, so
f is the desired measurable selector. a
It is possible to weaken the conditions on F and on A; see Exercise 4.23.
This theorem has an interesting consequence, viz., that we can ﬁnd a
sequence of dense selectors for F .

540
CHAPTER 4. MEASURES FOR PROBABILISTIC SYSTEMS
Corollary 4.7.3 Under the assumptions of Theorem 4.7.2, a measur-
able map F W X ! F.Y / has a sequence .fn/n2N of measurable selec-
tors such that ffn.x/ j n 2 Ng is dense in F.x/ for each x 2 X.
Proof 1. We use notations from above. Let again .yn/n2N be a dense
sequence in Y , and deﬁne for n; m 2 N the map
Fn;m.x/ WD
(
F.x/ \ B.yn; 2m/;
if x 2 F w.B.yn; 2m//
F.x/;
otherwise.
Denote by Hn;m.x/ the closure of Fn;m.x/.
2. Hn;m W X ! F.Y / is measurable. In fact, put A1 WD F w.B.yn;
2m//; A2 WD X n A1; then A1; A2 2 A, because F is measurable and
B.yn; 2m/ is open. But then we have for an open set G  Y
fx 2 X j Hn;m \ G 6D ;g Dfx 2 X j Fn;m \ G 6D ;g
Dfx 2 A1 j F.x/ \ G \ B.yn; 2m/ 6D ;g
[ fx 2 A2 j F.x/ \ G 6D ;gI
thus H w
n;m.G/ 2 A.
3. We can ﬁnd a measurable selector sn;m for Hn;m by Theorem 4.7.2,
so we have to show that fsn;m.x/ j n; m 2 Ng is dense in F.x/ for
each x 2 X. Let y 2 F.x/. Given  > 0, select m with 2m < =2;
there exists yn with d.y; yn/ < 2m. Thus x 2 H w
n;m.B.yn; 2m//,
and sn;m.x/ is a member of the closure of B.yn; 2m/, which means
d.y; sn;m.x// < . Now arrange fsn;m.x/ j n; m 2 Ng as a sequence;
then the assertion follows. a
This is a ﬁrst application of measurable selections.
Example 4.7.4 Call a map h W X ! B.Y / for the Polish space Y
hit-measurable iff h is measurable with respect to A and HG.B.Y //,
where G is the set of all open sets in Y ; see Example 4.1.2. Thus h is
hit-measurable iff fx 2 X j h.x/ \ U 6D ;g 2 A for each open set
U  Y . If h is image ﬁnite (i.e., h.x/ is always nonempty and ﬁnite),
then there exists a sequence .fn/n2N of measurable maps fn W X ! Y
such that h.x/ D ffn.x/ j n 2 Ng for each x 2 X. This is so because
h W X ! F.Y / is measurable; hence Corollary 4.7.3 is applicable. ✌
Transition kernels into Polish spaces induce a measurable closed valued
map, for which selectors exist.

4.8. INTEGRATION
541
Example 4.7.5 Let under the assumptions of Theorem 4.7.2 K
W
.X; A/  .Y; B.Y // be a transition kernel with K.x/.Y / > 0 for all
x 2 X. Then there exists a measurable map f W X ! Y such that
K.x/.U / > 0, whenever U is an open neighborhood of f .x/.
In fact, F W x 7! supp.K.x// takes nonempty and closed values by
Lemma 4.1.46. If G  Y is open, then
F w.G/ D fx 2 X j supp.K.x// \ G 6D ;g D fx 2 X j K.x/.G/ > 0g 2 A:
Thus F has a measurable selector f by Theorem 4.7.2. The assertion
now follows from Corollary 4.1.47.
Perceiving a stochastic relation K W .X; A/  .Y; B.Y // as a proba-
bilistic model for transitions such that K.x/.B/ is the probability for
making a transition from x to B (with K.x/.Y /  1), we may interpret
the selection f as one possible deterministic version for a transition:
The state f .x/ is possible, since f .x/ 2 supp.K.x//, which entails
K.x/.U / > 0 for every open neighborhood U of f .x/. There exists
a sequence .fn/n2N of measurable selectors for F such that ffn.x/ j
n 2 Ng is dense in F.x/; this may be interpreted as a form of stochastic
nondeterminism. ✌
4.8
Integration
After having studied the structure of measurable sets under various con-
ditions on the underlying space with an occasional side glance at real-
valued measurable functions, we will discuss integration now. This is a
fundamental operation associated with measures. The integral of a func-
tion with respect to a measure will be what you expect it to be, viz., for
nonnegative functions the area between the curve and the x-axis. This
view will be conﬁrmed later on, when Fubini’s Theorem will be avail-
able for computing measures in Cartesian products. For the time be-
ing, we build up the integral in a fairly straightforward way through an
approximation by step functions, obtaining a linear map with some fa-
vorable properties, for example, the Lebesgue Dominated Convergence
Theorem. All the necessary constructions are given in this section, offer-
ing more than one occasion to exercise the well-known -ı-arguments,
which are necessary, but not particularly entertaining. But that is life.

542
CHAPTER 4. MEASURES FOR PROBABILISTIC SYSTEMS
The second part of this section offers a complementary view—it starts
from a positive linear map with some additional continuity properties
and develops a measure from it. This is Daniell’s approach, suggesting
that measure and integral are really most of the time two sides of the
same coin. We show that this duality comes to life especially when
we are dealing with a compact metric space: Here the celebrated Riesz
Representation Theorem gives a bijection between probability measures
on the Borel sets and normed positive linear functions on the continuous
real-valued functions. We formulate and prove this theorem here; it
should be mentioned that this is not the most general version available,
as with most other results discussed here (but probably there is no such
thing as a most general version, since the development did branch out
into wildly different directions).
This section will be fundamental for the discussions and results later in
this chapter. Most results are formulated for ﬁnite or -ﬁnite measures,
and usually no attempt has been made to ﬁnd the boundary delineating
a development.
4.8.1
From Measure to Integral
We ﬁx a measure space .X; A; /. Denote for the moment by T .X; A/
the set of all measurable step functions, and by TC.X; A/ the nonnega-
T .X; A/
tive step functions; similarly, FC.X; A/ are the nonnegative measurable
functions. Note that T .X; A/ is a vector space under the usual opera-
tions and that it is a lattice under ﬁnite or countable pointwise suprema
and inﬁma. We know from Proposition 4.2.4 that we can approximate
each bounded measurable function by a sequence of step functions from
below.
F.X; A/
Deﬁne
Z
X
n
X
iD1
˛i  Ai d WD
n
X
iD1
˛i  .Ai/
(4.9)
as the integral with respect to  for the step function Pn
iD1 ˛i  Ai 2
T .X; A/. Exercise 4.24 tells us that the integral is well deﬁned: If f; g 2
T .X; A/ with f D g, then
X
˛2R
˛  .fx 2 X j f .x/ D ˛g/ D
X
ˇ2R
ˇ  .fx 2 X j g.x/ D ˇg/:

4.8. INTEGRATION
543
Thus the deﬁnition (4.9) yields the same value for the integral. These
are some elementary properties of the integral for step functions.
Lemma 4.8.1 Let f; g 2 T .X; A/ be step functions, ˛ 2 R. Then
1.
R
X ˛  f d D ˛ 
R
X f d,
2.
R
X.f C g/ d D
R
X f d C
R
X g d,
3. if f
 0, then
R
X f d  0; in particular, the map f
7!
R
X f d is monotone,
4.
R
X A d D .A/ for A 2 A,
5. j
R
X f dj 
R
X jf j d.
Moreover the map A 7!
R
A f d WD
R
X f  A d is additive on A
whenever f 2 TC.X; A/. a
We know from Proposition 4.2.4 that we can ﬁnd for f 2 FC.X; A/
a sequence .fn/n2N in TC.X; A/ such that f1  f2  : : : and supn2N
fn D f . This observation is used for the deﬁnition of the integral for
f . We deﬁne
Z
X
f d WD sup
˚Z
X
g d j g  f and g 2 TC.X; A/

:
Note that the right-hand side may be inﬁnite; we will discuss this shortly.
The central observation is formulated in Levi’s Theorem.
Theorem 4.8.2 Let .fn/n2N be an increasing sequence of functions in
FC.X; A/ with limit f ; then the limit of
R
X fn d

n2N exists and
equals
R
X f d.
Levi’s
Theorem
Proof 1.
Because the integral is monotone in the integrand by
Lemma 4.8.1, the limit
` WD lim
n!1
Z
X
fn d
exists (possibly in R [ f1g), and we know from monotonicity that ` 
R
X f d.
2. Let f D c > 0 be a constant, and let 0 < d < c. Then supn2N d 

544
CHAPTER 4. MEASURES FOR PROBABILISTIC SYSTEMS
fx2Xjfn.x/dg D dI hence we obtain
Z
X
f d 
Z
X
fn d 
Z
fx2Xjfn.x/dg
fn d
 d  .fx 2 X j fn.x/  dg/
for every n 2 N; thus
Z
X
f d  d  .X/:
Letting d approach c, we see that
Z
X
f d  lim
n!1
Z
X
fn d  c  .X/ D
Z
X
f d:
This gives the desired equality.
3. If f D c  A with A 2 A, we restrict the measure space to .A; A \
A; /, so the result is true also for step functions based on one single
set.
4. Let f D Pn
iD1 ˛i  Ai be a step function; then we may assume
that the sets A1; : : : ; An are mutually disjoint. Consider fi WD f 
Ai D ˛i  Ai and apply the previous step to fi, taking additivity
from Lemma 4.8.1, part 2 into account.
5. Now consider the general case. Select step function .gn/n2N with
gn 2 TC.X; A/ such that gn  fn and j
R
X fn d 
R
X gn dj < 1=n.
We may and do assume that g1  g2  : : :, for we otherwise may
pass to the step function hn WD supfg1; : : : ; gng. Let 0  g  f be a
step function; then limn!1.gn ^ g/ D g, so that we obtain from the
previous step
Z
X
g d D lim
n!1
Z
X
gn ^ g d  lim
n!1
Z
X
gn d  lim
n!1
Z
X
fn d:
Because
R
X g d may be chosen arbitrarily close to `, we ﬁnally ob-
tain
lim
n!1
Z
X
fn d 
Z
X
f d  lim
n!1
Z
X
fn d;
which implies the assertion for arbitrary f 2 FC.X; A/. a

4.8. INTEGRATION
545
Since we can approximate each nonnegative measurable function from
below and from above by step functions (Proposition 4.2.4 and Exer-
cise 4.7), we obtain from Levi’s Theorem for f 2 FC.X; A/ the repre-
sentation
sup
˚Z
X
g d j TC.X; A/ 3 g  f

D
Z
X
f d D inf
˚Z
X
g d j f  g 2 TC.X; A/

:
This strongly resembles—and generalizes—the familiar construction of
the Riemann integral for a continuous function f over a bounded in-
terval by sandwiching it between lower and upper sums of step func-
tions.
Compatibility of the integral with scalar multiplication and with addition
is now an easy consequence of Levi’s Theorem.
Corollary 4.8.3 Let a  0 and b  0 be nonnegative real numbers;
then
Z
X
a  f C b  g d D a 
Z
X
f d C b 
Z
X
g d
for f; g 2 FC.X; A/.
Proof Let .fn/n2N and .gn/n2N be sequences of step functions which
converge monotonically to f resp. g. Then .a  fn C b  gn/n2N is a
sequence of step functions converging monotonically to a  f C b  g.
Apply Levi’s Theorem 4.8.2 and the linearity of the integral on step
functions from Lemma 4.8.1 to obtain the assertion. a
Given an arbitrary f 2 F.X; A/, we can decompose f into a positive
and a negative part f C WD f _ 0 resp. f  WD .f / _ 0, so that
f D f C  f  and jf j D f C C f .
A function f 2 F.X; A/ is called integrable (with respect to ) iff
Integrable
Z
X
jf j d < 1I
in this case we set
Z
X
f d WD
Z
X
f C d 
Z
X
f  d:

546
CHAPTER 4. MEASURES FOR PROBABILISTIC SYSTEMS
In fact, because f C  f , we obtain from Lemma 4.8.1 that
R
X f C d
< 1; similarly we see that
R
X f  d < 1. The integral is well
deﬁned, because if f D f1  f2 with f1; f2  0, we conclude f1 
f  jf j, hence
R
X f1 d < 1, and f2  jf j, so that
R
X f2 d < 1,
which implies
R
X f C d C
R
X f2 d D
R
X f  d C
R
X f1 d by
Corollary 4.8.3. Thus we obtain in fact
R
X f C d 
R
X f  d D
R
X f1 d 
R
X f2 d.
This special case is also of interest: Let A 2 A, deﬁne for f inte-
grable
Z
A
f d WD
Z
X
f  A d
(note that jf  Aj  jf j). We emphasize occasionally the integration
variable by writing
R
X f .x/ d.x/ instead of
R
X f d.
Collecting some useful and a.e. used properties, we state
Proposition 4.8.4 Let f; g 2 F.X; A/ be measurable functions; then
1. If f  0, then
R
X f d D 0 iff f D 0.
2. If f is integrable and jgj  jf j, then g is integrable.
3. If f and g are integrable, then so are af Cb g for all a; b 2 R,
and
R
X a  f C b  g d D a 
R
X f d C b 
R
X g d.
4. If f and g are integrable and f  g, then
R
X g d 
R
X f d.
5. If f is integrable, then j
R
X f dj 
R
X jf j d.
a
We now state and prove some statements which relate sequences of
functions to their integrals. The ﬁrst one is traditionally called Fatou’s
Lemma.
Proposition 4.8.5 Let .fn/n2N be a sequence in FC.X; A/. Then
Fatou’s
Lemma
Z
X
lim inf
n!1 fn d  lim inf
n!1
Z
X
fn d:
Proof Since .infmn fm/n2N is an increasing sequence of measurable
functions in FC.X; A/, we obtain from Levi’s Theorem 4.8.2
Z
X
f d D lim
n!1
Z
X
inf
mn fm d D sup
n2N
Z
X
inf
mn fm d:

4.8. INTEGRATION
547
Because we plainly have by monotonicity
R
X infmn fm d  infmn
R
X fm d; the assertion follows. a
The Lebesgue Dominated Convergence Theorem is a very important and
eagerly used tool; it can be derived now easily from Fatou’s Lemma.
Theorem 4.8.6 Let .fn/n2N be a sequence of measurable functions with
Lebesgue
Dominated
Convergence
Theorem
fn
a:e:
! f for some measurable function f and jfnj  g for all n 2 N
and an integrable function g. Then fn and f are integrable, and
lim
n!1
Z
X
fn d D
Z
X
f d and
lim
n!1
Z
X
jfn  f j d D 0:
Proof 1. It is no loss of generality to assume that fn ! f and 8n 2
N W fn  g pointwise (otherwise modify the fn, f , and g on a set of -
measure zero). Because jfnj  g, we conclude from Proposition 4.8.4
that fn is integrable, and since f  g holds as well, we infer that f is
also integrable.
2. Put gn WD jf j C g  jfn  f j, then gn  0, and gn is integrable for
all n 2 N. We obtain from Fatou’s Lemma
Z
X
jf j C g d D
Z
X
lim inf
n!1 gn d
 lim inf
n!1
Z
X
gn d
D
Z
X
jf j C g d  lim sup
n!1
Z
X
jfn  f j d:
Hence we obtain lim supn!1
R
X jfn  f j d D 0, thus limn!1
R
X jfn  f j d D 0.
3. We ﬁnally note that
ˇˇ
Z
X
fn d 
Z
X
f d
ˇˇ D
ˇˇ
Z
X
.fn  f / d
ˇˇ 
Z
X
jfn  f j d;
which completes the proof. a
The following is an immediate consequence of the Lebesgue Theorem.
We know from Calculus that interchanging integration and inﬁnite sum-
mation may be dangerous, so we gain a good criterion here permitting
this operation.

548
CHAPTER 4. MEASURES FOR PROBABILISTIC SYSTEMS
Corollary 4.8.7 Let .fn/n2N be a sequence of measurable functions, g
integrable, such that j Pn
kD1 fkj  g for all n 2 N. Then all fn and
f WD P
n2N fn are integrable, and
R
X f d D P
n2N
R
X fn d. a
Moreover, we conclude that each nonnegative measurable function begets
a ﬁnite measure. This observation will be fruitful for the discussion of
Lp-spaces in Sect. 4.11.
Corollary 4.8.8 Let f
 0 be an integrable function; then A 7!
R
A f d deﬁnes a ﬁnite measure on A.
Proof All the properties of a measure are immediate, and -additivity
follows from Corollary 4.8.7. a
Integration with respect to an image measure is also available right away.
It yields the fairly helpful change of variables formula for image mea-
sures.
Corollary 4.8.9 Let .Y; B/ a measurable space and g W X ! Y be
A-B-measurable. Then h 2 F.Y; B/ is M.g/./ integrable iff g ı h is
-integrable, and in this case we have
Change of
variables
Z
Y
h dM.g/./ D
Z
X
h ı g d:
(4.10)
Proof We show ﬁrst that formula (4.10) is true for step functions. In
fact, if h D B with a measurable set B, then we obtain from the deﬁ-
nition
Z
Y
B dM.g/./ D M.g/./.B/ D .g1
B

/ D
Z
X
B ı g d
(since B.g.x// D 1 iff x 2 g1
B

). This observation extends by lin-
earity to step functions, so that we obtain for h D Pn
iD1 bi  Bi
Z
Y
h dM.g/./ D
n
X
iD1
bi 
Z
X
Bi ı g d D
Z
X
h ı g d:
Thus the assertion now follows from Levi’s Theorem 4.8.2. a
The reader is probably familiar with the change of variables formula in
classical calculus. It deals with k-dimensional Lebesgue measure k
and a differentiable and injective map T W V ! W from an open set
V  Rk to a bounded set W  Rk. T is assumed to have a continuous

4.8. INTEGRATION
549
inverse. Then the integral of a measurable and bounded function f W
T

V

! R can be expressed in terms of the integral over V of f ı T
and the Jacobian JT of T . To be speciﬁc
Z
T

V
 f dk D
Z
V
.f ı T /  jJT j dk:
Recall that the Jacobian JT of T is the determinant of the partial deriva-
tives of T , i.e.,
JT .x/ D det

.@Ti.x/
@xj
/

:
This representation can be derived from the representation for the inte-
gral with respect to the image measure from Corollary 4.8.9 and from
the Radon–Nikodym Theorem 4.11.26 through a somewhat lengthy ap-
plication of results from fairly elementary linear algebra. We do not
want to develop this apparatus in the present presentation; we will,
however, provide a glimpse at the one-dimensional situation in Proposi-
tion 4.11.29. The reader is referred for the general case rather to Rudin’s
exposition [Rud74, pp. 181–188] or to Stromberg’s more elementary
discussion in [Str81, pp.
385–392]; if you read German, Elstrodt’s
derivation [Els99, V.4] should not be missed.
4.8.2
The Daniell Integral and Riesz Representation
Theorem
The previous section developed the integral from a ﬁnite or -ﬁnite mea-
sure; the result was a linear functional on a subspace of measurable
functions, which will be investigated in greater detail later on. This sec-
tion will demonstrate that it is possible to obtain a measure from a linear
functional on a well- behaved space of functions. This approach was
proposed by P. J. Daniell ca. 1920; it is called in his honor the Daniell
integral. It is useful when a linear functional is given, and one wants to
show that this functional is actually deﬁned by a measure, which then
permits putting the machinery of measure theory into action. We will en-
counter such a situation, e.g., when studying linear functionals on spaces
of integrable functions. Speciﬁcally, we derive the Riesz Representa-
tion Theorem, which shows that there is a one-to-one correspondence
between probability measures and normed positive linear functionals on
the vector lattice of continuous real-valued functions on a compact met-
ric space.

550
CHAPTER 4. MEASURES FOR PROBABILISTIC SYSTEMS
Let us ﬁx a set X throughout. We will also ﬁx a set F of functions
X ! R which is assumed to be a vector space (as always, over the
reals) with a special property.
Deﬁnition 4.8.10 A vector space F  RX is called a vector lattice iff
jf j 2 F whenever f 2 F.
Now ﬁx the vector lattice F. Each vector lattice is indeed a lattice:
Deﬁne
f _ g WD .jf  gj C f C g/=2;
f ^ g WD 

.f / _ .g/

f  g , f _ g D g
, f ^ g D f:
Thus F contains f and g also f ^ g and f _ g, and it is easy to
see that  deﬁnes a partial order on F such that supff; gg D f _ g and
infff; gg D f ^g. Note that we have maxf˛; ˇg D .j˛ˇjC˛Cˇ/=2
for ˛; ˇ 2 R; thus we conclude that f  g iff f .x/  g.x/ for all
x 2 R.
We will ﬁnd these properties helpful; they will be used silently be-
low.
Lemma 4.8.11 If 0  ˛  ˇ 2 R and f 2 F with f  0, then
˛  f  ˇ  f . If f; g 2 F with f  g, then f C h  g C h for all
h 2 F. Also, f ^ g C f _ g D f C g.
Proof Because f  0, we obtain from ˛  ˇ
2

.˛ f /_.ˇ f /

D .j˛ ˇjC˛ Cˇ/f D 2.˛ _ˇ/f D 2ˇ f:
This establishes the ﬁrst claim. The second one follows from
2 

.f C h/ _ .g C h/

D jf  gj C f C g C 2  h D 2  .g C h/:
The third one is established through the observation that it holds point-
wise and from the observation that f  g iff f .x/  g.x/ for all
x 2 X. a
We assume that 1 2 F and that a function L W F ! R is given, which
has these properties:
 L.˛  f C ˇ  g/ D ˛  L.f / C ˇ  L.g/, so that L is linear,

4.8. INTEGRATION
551
 if f  0, then L.f /  0, so that L is positive,
 L.1/ D 1, so that L is normed,
 If .fn/n2N is a sequence in F which decreases monotonically to
0, then limn!1 L.fn/ D 0, so that L is continuous from above
at 0.
These are some immediate consequences from the properties of L.
Lemma 4.8.12 If f; g 2 F, then L.f ^ g/ C L.f _ g/ D L.f / C
L.g/. If .fn/n2N and .gn/n2N are increasing sequences of nonnegative
functions in F with limn!1 fn  limn!1 gn, then limn!1 L.fn/ 
limn!1 L.gn/:
Proof The ﬁrst property follows from the linearity of L. For the second
one, we observe that limk!1.fn ^ gk/ D fn 2 F, the latter sequence
being increasing. Consequently, we have
L.fn/  lim
k!1 L.fn ^ gk/  lim
k!1 L.gk/
for all n 2 N, which implies the assertion. a
F determines a -algebra A on X, viz., the smallest -algebra which
renders each f 2 F measurable. We will show now that L determines
a unique probability measure on A such that
L.f / D
Z
X
f d
holds for all f 2 F.
This will be done in a sequence of steps. A brief outline looks like
Outline
this: We will ﬁrst show that L can be extended to the set LC of all
bounded monotone limits from the nonnegative elements of F and that
the extension respects monotone limits. From LC we extract via indi-
cator functions an algebra of sets and from the extension of L an outer
measure. This will then turn out to yield the desired probability.
Deﬁne
LC WD ff W X ! R j f is bounded; there exists 0
 fn 2 F increasing with f D lim
n!1 fng:

552
CHAPTER 4. MEASURES FOR PROBABILISTIC SYSTEMS
Deﬁne L.f / WD limn!1 L.fn/ for f 2 LC, whenever f D limn!1
fn for the increasing sequence .fn/n2N  F. Then we obtain from
Lemma 4.8.12 that this extension L on LC is well deﬁned, and it is clear
that L.f /  0 and that L.˛f Cˇg/ D ˛L.f /CˇL.g/, whenever
f; g 2 LC and ˛; ˇ 2 RC. We see also that f; g 2 LC implies that
f ^ g; f _ g 2 LC with L.f ^ g/ C L.f _ g/ D L.f / C L.g/. It
turns out that L also respects the limits of increasing sequences.
Lemma 4.8.13 Let .fn/n2N  LC be an increasing and uniformly
bounded sequence; then L.limn!1 fn/ D limn!1 L.fn/.
Proof Because fn 2 LC, we know that there exists for each n 2 N
an increasing sequence .fm;n/m2N of elements fm;n 2 F such that
fn D limm!1 fm;n. Deﬁne
gm WD sup
nm
fm;n:
Then .gm/m2N is an increasing sequence in F with fm;n  gm, and
gm  f1 _ f2 _ : : : _ fm D fm, so that gm is sandwiched between
fm;n and fm for all m 2 N and n  m. This yields L.fm;n/ 
L.gm/  L.fm/ for these n; m. Thus limn!1 fn D limm!1 gm;
and hence
lim
n!1 L.fn/ D lim
m!1 L.gm/ D L. lim
m!1 gm/ D L. lim
n!1 fn/:
Thus we have shown that limn!1 fn can be obtained as the limit of an
increasing sequence of functions from F; because .fn/n2N is uniformly
bounded, this limit is an element of LC. a
Now deﬁne
G WD fG  X j G 2 LCg;
.G/ WD L.G/ for G 2 G:
Then G is closed under ﬁnite intersections and ﬁnite unions by the re-
marks made before Lemma 4.8.13. Moreover, G is closed under count-
able unions with .S
n2N Gn/ D limn!1 .Gn/, if .Gn/n2N is an
increasing sequence in G. Also .X/ D 1. Now deﬁne, as in the
Carath´eodory approach in Sect. 1.6.3,
.A/ WD inff.G/ j G 2 G; A  Gg;
B WD fB  X j .B/ C .X n B/ D 1g:
We obtain from the Carath´eodory extension process (Theorem 1.6.29)

4.8. INTEGRATION
553
Proposition 4.8.14 B is a -algebra, and  is countably additive on
B.a
Put .B/ WD .B/ for B 2 B, then .X; B; / is a measure space, and
 is a probability measure on .X; B/.
In order to carry out the program sketched above, we need a -algebra.
We have on one hand the -algebra A generated by F and on the other
hand B gleaned from the Carath´eodory extension. It is not immedi-
ately clear how these -algebras are related to each other. And then we
also have G as an intermediate family of sets, obtained from LC. This
diagram shows the objects we will discuss, together with a shorthand
indication of the respective relationships:
A bird’s eye
view
We investigate the relationship of A and G ﬁrst.
Lemma 4.8.15 A D .G/.
Proof 1. Because A is the smallest -algebra rendering all elements of
F measurable and because each element of LC is the limit of a sequence
of elements of F, we obtain A-measurability for each element of LC.
Thus G  A.
2. Let f 2 LC and c 2 RC; then fn WD 1 ^ n  supff  c; 0g 2 LC,
and fx2Xjf .x/>cg D limn!1 fn: This is a monotone limit. Hence
fx 2 X j f .x/ > cg 2 G; thus in particular each element of F is
.G/-measurable. This implies that A  .G/ holds. a
The relationship between B and G is a bit more difﬁcult to establish.
Lemma 4.8.16 G  B.
Proof We have to show that .G/ C .X n G/ D 1 for all G 2 G.
Fix G 2 G. We obtain from additivity that .G/ C .H/ D .G \
H/ C .G [ H/  .X/ D 1 holds for any H 2 G with X n G  H,
so that .G/ C .X n G/  1 remains to be shown. The idea is
Idea
to approximate G for G 2 G by a suitable sequence from F and to
manipulate this sequence accordingly.

554
CHAPTER 4. MEASURES FOR PROBABILISTIC SYSTEMS
Because G 2 G, there exists an increasing sequence .fn/n2N of ele-
ments in F such that G D supn2N fn; consequently, XnG D infn2N
.1  fn/. Now let n 2 N, and 0 < c  1; then X n G  Un;c WD
fx 2 X j 1  fn.x/ > cg with Un;c 2 G. Because Un;c  .1  fn/=c,
we obtain .X n G/  L.1  fn/=c; this inequality holds for all c
and all n 2 N. Letting c ! 1 and n ! 1, this yields .X n G/ 
1  .G/.
Consequently, .G/C.XnG/ D 1 for all G 2 G, which establishes
the claim. a
This yields the desired relationship of A, the -algebra generated by
the functions in F, and B, the -algebra obtained from the extension
process.
Corollary 4.8.17 A  B, and each element of LC is B-measurable.
Proof We have seen that A D .G/ and that G  B, so the ﬁrst assertion
follows from Proposition 4.8.14. The second assertion is immediate
from the ﬁrst one. a
Because  is countably additive, hence a probability measure on B, and
because each element of F is B-measurable, the integral
R
X f d is
deﬁned, and we are done.
Theorem 4.8.18 Let F be a vector lattice of functions X ! R with
1 2 F, L W F ! R be a linear and monotone functional on F such
that L.1/ D 1, and L.fn/ ! 0, whenever .fn/n2N  F decreases to
0. Then there exists a unique probability measure  on the -algebra A
generated by F such that
L.f / D
Z
X
f d
holds for all f 2 F.
Proof Let G and B be constructed as above.
Existence: Because A  B, we may restrict  to A, obtaining a prob-
ability measure. Fix f 2 F, then f is B-measurable, and hence
R
X f d is deﬁned. Assume ﬁrst that 0  f  1; hence f 2 LC.
We can write f D limn!1 fn with step functions fn, the con-
tributing sets being members of G. Hence L.fn/ D
R
X fn d,
since L.G/ D .G/ by construction. Consequently, we ob-
tain from Lemma 4.8.13 and Lebesgue’s Dominated Convergence

4.8. INTEGRATION
555
Theorem 4.8.6
L.f / D L. lim
n!1 fn/ D lim
n!1 L.fn/ D lim
n!1
Z
X
fn d
D
Z
X
lim
n!1 fn d D
Z
X
f d:
This implies the assertion also for bounded f 2 F with f  0. If
0  f is unbounded, write f D supn2N.f ^ n/ and apply Levi’s
Theorem 4.8.2. In the general case, decompose f D f C  f 
with f C WD f _0 and f  WD .f /_0, and apply the foregoing.
Uniqueness: Assume that there exists a probability measure  on A
with L.f / D
R
X f d for all f 2 F; then the construction
shows that .G/ D L.G/ D .G/ for all G 2 G. Since G is
closed under ﬁnite intersections and since A D .G/, we con-
clude that .A/ D .A/ for all A 2 A.
This establishes the claim. a
We obtain as a consequence the famous Riesz Representation Theorem,
which we state and formulate for the metric case. Recall from Sect. 3.6.3
that C.X/ is the linear space of all bounded continuous functions X !
R on a topological X. We state the result ﬁrst for metric spaces and
for bounded continuous functions, specializing the result subsequently
to the compact metric case.
The reason for not formulating the Riesz Representation Theorem im-
mediately for general topological spaces is that Theorem 4.8.18 works
with the -algebra generated—in this case—by C.X/; this is in general
the -algebra of the Baire sets, which in turn may be properly contained
in the Borel sets. Thus one obtains in the general case a Baire measure
Ba.X/ vs.
B.X/
which then would have to be extended uniquely to a Borel measure. This
is discussed in detail in [Bog07, Sect. 7.3].
Corollary 4.8.19 Let X be a metric space, and let L W C.X/ ! R be
a positive linear function with limn!1 L.fn/ D 0 for each sequence
.fn/n2N  C.X/ which decreases monotonically to 0. Then there exists
a unique ﬁnite Borel measure  such that
L.f / D
Z
X
f d
holds for all f 2 C.X/.

556
CHAPTER 4. MEASURES FOR PROBABILISTIC SYSTEMS
Proof It is clear that C.X/ is a vector lattice with 1 2 C.X/. We may
and do assume that L.1/ D 1. The result follows immediately from
Theorem 4.8.18 now. a
If we take a compact metric space, then each continuous map X ! R
is bounded. We show that the assumption on L’s continuity follows
from compactness (the latter is usually referred to as Dini’s Theorem;
see Proposition 3.6.41).
Theorem 4.8.20 Let X be a compact metric space. Given a positive
linear functional L W C.X/ ! R, there exists a unique ﬁnite Borel
measure  such that
L.f / D
Z
X
f d
holds for all f 2 C.X/.
Riesz Repre-
sentation
Theorem
Proof It is clear that C.X/ is a vector lattice which contains 1. Again,
we assume that L.1/ D 1 holds. In order to apply Theorem 4.8.18,
we have to show that limn!1 L.fn/ D 0, whenever .fn/n2N  C.X/
Proof
obligation
decreases monotonically to 0. But since X is compact, we claim that
supx2X fn.x/ ! 0, as n ! 1.
This is so because fx 2 X j fn  cg is a family of closed sets
with empty intersection for any c > 0, so we ﬁnd by compactness a
ﬁnite subfamily with empty intersection. Hence the assumption that
supx2X fn.x/  c > 0 for all n 2 N would lead to a contradiction
(note that this is a variation of the argument in the proof of Proposi-
tion 3.6.41). Thus the assertion follows from Theorem 4.8.18. a
Because f 7!
R
X f d deﬁnes for each Borel measure  a positive
linear functional on C.X/ and because a measure on a metric space is
uniquely determined by its integral on the bounded continuous func-
tions, we obtain
Corollary 4.8.21 For a compact metric space X, there is a bijection
between positive linear functionals on C.X/ and ﬁnite Borel measures.
a
A typical scenario for the application of the Riesz Theorem runs like
this: One starts with a probability measure on a metric space X. This
space can be embedded into a compact metric space X0; one knows
that the integral on the bounded continuous functions on X extends to a
positive linear map on the continuous functions on X0. Then the Riesz

4.9. PRODUCT MEASURES
557
Representation Theorem kicks in and gives a probability measure on X0.
We will see a situation like this when investigating the weak topology
on the space of all ﬁnite measures on a Polish space in Sect. 4.10.
4.9
Product Measures
As a ﬁrst application of integration, we show that the product of two
ﬁnite measures yields a measure again. This will lead to Fubini’s The-
orem on product integration, which evaluates a product integrable func-
tion on a product along its vertical or its horizontal cuts (in this sense it
may be compared to a line sweeping algorithm—you traverse the Carte-
sian product, and in each instance you measure the cut).
We apply this to inﬁnite products, ﬁrst with a countable index set, then
for an arbitrary one. Inﬁnite products are a special case of projective
systems, which may be described as sequences of probabilities which
are related through projections. We show that such a projective system
has a projective limit, i.e., a measure on the set of all sequences such that
the elements of the projective system proper are obtained through pro-
jections. This construction is, however, only feasible in a Polish space,
since here a compactness argument is available which ascertains that the
measure we are looking for is -additive.
A small step leads to projective limits for stochastic relations.
We
demonstrate an application for projective limits through the interpre-
tation for the logic CSL. An interpretation for game logic, i.e., a modal
logic, the modalities of which are given by games, is discussed as well,
since now all tools for this quest are provided.
Fix for the time being two ﬁnite measure spaces .X; A; / and .Y; B; /.
The Cartesian product XY is endowed with the product -algebra A˝
B which is the smallest -algebra containing all measurable rectangles
A  B with A 2 A and B 2 B; see Sect. 4.1.1.
Take Q 2 A ˝ B; then we know from Lemma 4.1.8 that Qx and Qy
are measurable sets for x 2 X and y 2 Y . We need measurability
urgently here because otherwise functions like x 7! .Qx/ and y 7!
.Qy/ would not be deﬁned. In fact, we can say more about these
functions.

558
CHAPTER 4. MEASURES FOR PROBABILISTIC SYSTEMS
Lemma 4.9.1 Let Q 2 A ˝ B be a measurable set; then both '.x/ WD
.Qx/ and  .y/ WD .Qy/ deﬁne bounded measurable functions with
Z
X
.Qx/ d.x/ D
Z
Y
.Qy/ d.y/:
Proof We use the same argument as in the proof of Lemma 4.1.8 for
establishing that both ' and  are measurable functions, noting that
..A  B/x/ D A.x/  .B/, similarly ..A  B/y/ D B.y/  .A/.
In the next step, the set of all Q 2 A ˝ B is shown to satisfy the as-
sumptions of the --Theorem 1.6.30.
In the same way, the equality of the integrals is ﬁnally established, not-
ing that
Z
X
..A  B/x/ d.x/ D .A/  .B/ D
Z
X
..A  B/y/ d.y/:
a
Thus it does not matter which cut to take—integrating with the other
measure will yield in any case the same result. Visualize this in the
Cartesian plane. You have a geometric ﬁgure F  R2, say, for simplic-
ity, F is compact. For each x 2 R, Fx is a vertical line, probably broken,
the length `.x/ of which you can determine. Then
R
R `.x/ dx yields
the area A of F . But you may obtain A also by measuring the—also
probably broken—horizontal line F y with length r.y/ and integrating
R
R r.y/ dy.
Lemma 4.9.1 yields without much ado.
Theorem 4.9.2 Given the ﬁnite measure spaces .X; A; / and .Y; B; /,
there exists a unique ﬁnite measure ˝ on A˝B such that .˝/.A
B/ D .A/  .B/ for A 2 A; B 2 B. Moreover,
. ˝ /.Q/ D
Z
X
.Qx/ d.x/ D
Z
Y
.Qy/ d.y/
holds for all Q 2 A ˝ B.
Proof 1. We establish the existence of ˝ by an appeal to Lemma 4.9.1
and to the properties of the integral according to Proposition 4.8.4. De-
ﬁne
. ˝ /.Q/ WD
Z
X
.Qx/ d.x/I
then this deﬁnes a ﬁnite measure on A ˝ B:

4.9. PRODUCT MEASURES
559
Monotonicity: Let Q  Q0, then Qx  Q0
x for all x 2 X, and hence
R
X .Qx/ d.x/ 
R
X .Q0
x/ d.x/. Thus  ˝  is monotone.
Additivity: If Q and Q0 are disjoint, then Qx \Q0
x D .Q\Q0/x D ;
for all x 2 X. Thus  ˝  is additive.
-Additivity: Let .Qn/n2N be a sequence of disjoint measurable sets;
then .Qn;x/n2N is disjoint for all x 2 X, and
Z
X
.
[
n2N
Qn;x/ d.x/ D
Z
X
X
n2N
.Qn;x/ d.x/
D
X
n2N
Z
X
.Qn;x/ d.x/
by Corollary 4.8.7. Thus  ˝  is -additive.
2. It remains to establish uniqueness. Here we repeat essentially the
argumentation from Lemma 1.6.31 on page 86. Suppose that  is a
ﬁnite measure on A ˝ B with .A  B/ D .A/  .B/ for all A 2 A
and all B 2 B. Then
G WD fQ 2 A ˝ B j .Q/ D . ˝ /.Q/g
contains the generator fA  B j A 2 A; B 2 Bg of A ˝ B, which is
closed under ﬁnite intersections. Because both  and  ˝  are mea-
sures, G is closed under countable disjoint unions, and because both
contenders are ﬁnite, G is also closed under complementation. The -
-Theorem 1.6.30 shows that G D A ˝ B. Thus  ˝  is uniquely
determined. a
Theorem 4.9.2 holds also for -ﬁnite measures. In fact, assume that the
contributing measure spaces are -ﬁnite, and let .Xn/n2N resp. .Yn/n2N
be increasing sequences in A resp.
B such that .Xn/ < 1 and
.Yn/ < 1 for all n 2 N, and S
n2N Xn D X and S
n2N Yn D Y .
Localize  and  to Xn resp. Yn by deﬁning n.A/ WD .A \ Xn/,
similarly, n.B/ WD .B \ Yn/; since these measures are ﬁnite, we
can extend them uniquely to a measure n ˝ n on A ˝ B. Since
S
n2N Xn  Yn D X  Y with the increasing sequence .Xn  Yn/n2N,
we set
. ˝ /.Q/ WD sup
n2N
.n ˝ n/.Q/:
Then  ˝  is a -ﬁnite measure on A ˝ B. Now assume that we have
another -ﬁnite measure  on A ˝ B with .A  B/ D .A/  .B/

560
CHAPTER 4. MEASURES FOR PROBABILISTIC SYSTEMS
for all A 2 A and B 2 B. Deﬁne n.Q/ WD .Q \ .Xn  Yn//; hence
n D n ˝ n by uniqueness of the extension to n and n, so that we
obtain
.Q/ D sup
n2N
n.Q/ D sup
n2N
.n ˝ n/.Q/ D . ˝ /.Q/
for all Q 2 A ˝ B. Thus we have shown
Corollary 4.9.3 Given two -ﬁnite measure spaces .X; A; / and
.Y; B; /, there exists a unique -ﬁnite measure  ˝  on A ˝ B such
that . ˝ /.A  B/ D .A/  .B/. We have
. ˝ /.Q/ D
Z
X
.Qx/ d.x/ D
Z
Y
.Qy/ d.y/:
a
The construction of the product measure has been done here through
integration of cuts. An alternative would have been the canonical ap-
proach. It would have investigated the map hA; Bi 7! .A/  .B/ on
the set of all rectangles, and then put the extension machinery devel-
oped through the Carath´eodory approach into action. It is a matter of
taste which approach to prefer.
The following example displays a slight generalization (a ﬁnite measure
is but a constant transition kernel).
Example 4.9.4 Let K W .X; A/  .Y; B/ be a transition kernel (see
Deﬁnition 4.1.9) such that the map x 7! K.x/.Y / is integrable with
respect to the ﬁnite measure . Then
. ˝ K/.Q/ WD
Z
X
K.x/.Qx/ d.x/
deﬁnes a ﬁnite measure on .X  Y; A ˝ B/. The --Theorem 1.6.30
tells us that this measure is uniquely determined by the condition . ˝
K/.A  B/ D
R
A K.x/.B/ d.x/ for A 2 A; B 2 B.
Interpret in a probabilistic setting K.x/.B/ as the probability that an
input x 2 X yields an output in B 2 B, and assume that  gives the
initial probability with which the system starts; then  ˝ K gives the
probability of all pairings, i.e., . ˝ K/.Q/ is the probability that a pair
hx; yi consisting of an input value x 2 X and an output value y 2 Y
will be a member of Q 2 A ˝ B. ✌

4.9. PRODUCT MEASURES
561
This may be further extended, replacing the measure on K’s domain by
a transition kernel as well.
Example 4.9.5 Consider the scenario of Example 4.9.4 again, but take
a third measurable space .Z; C/ with a transition kernel L W .Z; C/  
.X; A/ into account; assume furthermore that x 7! K.x/.Y / is in-
tegrable for each L.´/. Then L.´/ ˝ K deﬁnes a ﬁnite measure on
.X  Y; A ˝ B/ for each ´ 2 Z according to Example 4.9.4. We claim
that this deﬁnes a transition kernel .Z; C/  .X Y; A˝B/. For this to
be true, we have to show that ´ 7!
R
X K.x/.Qx/ dL.´/.x/ is measur-
able for each Q 2 A ˝ B. This is a typical application for the principle
of good sets through the --Theorem.
In fact, consider
Q WD fQ 2 A ˝ B j the assertion is true for Qg:
Then Q is closed under complementation. It is also closed under count-
able disjoint unions by Corollary 4.8.7. If Q D A  B is a measurable
rectangle, we have
R
X K.x/.Qx/ dL.´/.x/ D
R
A K.x/.B/ dL.´/.x/:
Then Exercise 4.14 shows that this is a measurable function Z ! R.
Thus Q contains all measurable rectangles, so Q D A ˝ B by the
--Theorem 1.6.30.
This establishes measurability of ´
7!
R
X K.x/.Qx/ dL.´/.x/ and shows that it deﬁnes a transition kernel.
✌
As a slight modiﬁcation, the next example shows the composition of
transition kernels, usually called convolution.
Example 4.9.6 Let K W .X; A/  .Y; B/ and L W .Y; B/  .Z; C/ be
transition kernels, and assume that the map y 7! L.y/.Z/ is integrable
with respect to measures K.x/ for an arbitrary x 2 X. Deﬁne for x 2 X
and C 2 C
.L  K/.x/.C/ WD
Z
X
L.y/.C/ dK.x/.y/:
Then LK W .X; A/  .Z; C/ is a transition kernel. In fact, .LK/.x/
is for ﬁxed x 2 X a ﬁnite measure on C according to Corollary 4.8.7.
From Exercise 4.14, we infer that x 7!
R
X L.y/.C/ dK.x/.y/ is a
measurable function, since y 7! L.y/.C/ is measurable for all C 2 C.
Because transition kernels are the Kleisli morphisms for the endofunc-
tor M on the category of measurable spaces (Example 2.4.8), it is not

562
CHAPTER 4. MEASURES FOR PROBABILISTIC SYSTEMS
difﬁcult to see that this deﬁnes Kleisli composition; in particular it fol-
lows that this composition is associative. ✌
Example 4.9.7 Let f 2 FC.X; A/; then we know that “the area under
the graph,” viz.,
C.f / WD fhx; ri j x 2 X; 0  r  f .x/g
is a member of A ˝ B.R/. This was shown in Corollary 4.2.5. Then
Corollary 4.9.3 tells us that
. ˝ /.C.f // D
Z
X


.C.f //x

d.x/;
where  is the Lebesgue measure on B.R/. Because


.C.f //x

D .fr j 0  r  f .x/g/ D f .x/;
we obtain
. ˝ /.C.f // D
Z
X
f d:
On the other hand,
. ˝ /.C.f // D
Z
RC


.C.f /r

d.r/;
and this gives the integration formula
Z
X
f d D
Z 1
0
.fx 2 X j f .x/  rg/ dr:
(4.11)
In this way, the integral of a nonnegative function may in fact be inter-
preted as measuring the area under its graph. ✌
With a similar technique, we show that  7!
R 1
0 .Br/ dr deﬁnes a
measurable map for B 2 A ˝ B.Œ0; 1/; this may be perceived as the
average evaluation of a set B  X  Œ0; 1. Moreover the set of all these
evaluations is a measurable subset of S.X; A/  Œ0; 1.
Lemma 4.9.8 Let .X; A/ be a measurable space; then
B./ WD
Z 1
0
.Br/ dr
deﬁnes a }}}.X; A/-B.R/-measurable map on S.X; A/, whenever B 2
A ˝ B.R/.

4.9. PRODUCT MEASURES
563
Proof This is established through the principle of good sets: Put
G WD fB 2 A ˝ B.Œ0; 1/ j B is }}}.X; A/  B.Œ0; 1/ measurableg:
Then G contains all sets A  D with A 2 A, B 2 B.Œ0; 1/. This is so
because


.A  D/r
D
(
.A/;
if r 2 D;
0;
otherwise:
Hence A	D./ D
R
D .A/ d D .A/  .D/. This is certainly a
measurable map on S.X; A/. Thus G contains the generator fA  D j
A 2 A; D 2 B.Œ0; 1/g of A ˝ B.Œ0; 1/, which in turn is closed under
ﬁnite intersections. It is clear that G is closed under complementation
and under countable disjoint unions, the latter by Corollary 4.8.7. Hence
we obtain from the --Theorem 1.6.30 that G D A ˝ B.Œ0; 1/.
We obtain from Corollary 4.2.5 that the set
fh; qi 2 S.X; A/  Œ0; 1 j
Z 1
0
.Br/ dr ‰ qg
is a member of }}}.X; A/ ˝ B.Œ0; 1/, whenever B  X  Œ0; 1 is a
member of A ˝ B.Œ0; 1/. a
This provides us with a measurable subset of S.X; A/  Œ0; 1; it will
be useful later on, when discussing the semantics of game logic in Sect.
4.9.4.
Corollary 4.9.9 Let B 2 A ˝ B.Œ0; 1/; then
fh; qi 2 S.X; A/  Œ0; 1 j
Z 1
0
.Br/ dr ‰ qg
is a measurable subset of S.X; A/  Œ0; 1.
Proof 1. We claim that the map  7!
R 1
0 .Br/ dr is }}}.X; A/-B.Œ0; 1/-
Plan
measurable. The claim is established in a stepwise manner: First we
establish that Br is a measurable set for each r, then we show that
r 7! .Br/ gives a measurable function for every , and then we are
nearly done. The assertion follows from Corollary 4.2.5.
2. Lemma 4.1.8 tells us that Br 2 A for all B 2 A ˝ B.Œ0; 1/, so
that .Br/ is deﬁned for each r 2 Œ0; 1. The map r 7! .Br/ deﬁnes
a measurable map Œ0; 1 ! RC; this is shown in Lemma 4.9.1; hence

564
CHAPTER 4. MEASURES FOR PROBABILISTIC SYSTEMS
R 1
0 .Br/ dr is deﬁned. We ﬁnally show that the map in question is
measurable by applying the principle of good sets. Let
G WD fB 2 A ˝ B.Œ0; 1/ j the assertion is true for Bg:
Then B D AC 2 G for A 2 A and C 2 B.Œ0; 1/, since
R 1
0 .Br/ dr
D .A/  .C/, which is deﬁned by a }}}.X; A/-B.Œ0; 1/-measurable
function,  being the Lebesgue measure on Œ0; 1. G is closed under
complementation and under disjoint countable unions by Corollary 4.8.7.
Hence we obtain G D A ˝ B.Œ0; 1/ from the --Theorem 1.6.30, be-
cause the set of all measurable rectangles generates this -algebra and
is closed under ﬁnite intersection. a
4.9.1
Fubini’s Theorem
In order to discuss integration with respect to a product measure, we
introduce the cuts of a function f W X  Y ! R, deﬁning fx WD
y:f .x; y/ and f y WD x:f .x; y/. Thus we have f .x; y/ D fx.y/ D
f y.x/, the ﬁrst equality resembling currying.
For the discussion to follow, we will admit also the values f1; C1g
as function values. So deﬁne eR WD R [ f1; C1g, and let B  eR
e
R, Admit
C1; 1
be a Borel set iff B \ R 2 B.R/. Measurability of functions extends
accordingly: If f W X ! eR is measurable, then in particular fx 2
X j f .x/ 2 Rg 2 A, and the set of values on which f takes the
values C1 or 1 is a member of A. Denote by eF.X; A/ the set of
measurable functions with values in eR and by eFC.X; A/ those which
take nonnegative values. The integral
R
X f d and integrability are
e
F.X; A/
deﬁned in the same way as above for f 2 eFC.X; A/. Then it is clear
that f 2 eFC.X; A/ is integrable iff f  fx2Xjf .x/2Rg is integrable and
.fx 2 X j f .x/ D 1g/ D 0:
With this in mind, we tackle the integration of a measurable function f W
X Y ! eR for the ﬁnite measure spaces .X; A; / and .Y; B; /.
Proposition 4.9.10 Let f 2 eFC.X  Y; A ˝ B/; then
1. x:
R
Y fx d and y:
R
X f y d are measurable functions X !
eR resp. Y ! eR.

4.9. PRODUCT MEASURES
565
2. We have
Z
X	Y
f d ˝  D
Z
X
Z
Y
fx d

d.x/
D
Z
Y
Z
X
f y d

d.y/:
Proof 0. The proof is a bit longish, but, after all, there is a lot to show. It
is an application of the machinery developed so far and shows that it is
well oiled. We start off by establishing the claim for step functions, then
Line of
attack
we go on to apply Levi’s Theorem for settling the general case.
1. Let f D Pn
iD1 ai  Qi be a step function with ai  0 and Qi 2
A ˝ B for i D 1; : : : ; n. Then
Z
Y
fx d D
n
X
iD1
ai  .Qi;x/:
This is a measurable function X ! R by Lemma 4.9.1. We obtain
Z
X	Y
f d ˝  D
n
X
iD1
ai  . ˝ /.Qi/
D
n
X
iD1
ai 
Z
X
.Qi;x/ d.x/
D
Z
X
n
X
iD1
ai  .Qi;x/ d.x/
D
Z
X
Z
Y
fx d

d.x/:
Interchanging the rˆoles of  and , we obtain the representation of
y:
R
X	Y f d ˝  in terms of y:
R
X f y d and . Thus the as-
sertion is true for step functions.
2. In the general case, we know that we can ﬁnd an increasing sequence
.fn/n2N of step functions with f D supn2N fn. Given x 2 X, we infer
that fx D supn2N fx;n, so that
Z
Y
fx d D sup
n2N
Z
X
fn;x d

566
CHAPTER 4. MEASURES FOR PROBABILISTIC SYSTEMS
by Levi’s Theorem 4.8.2. This implies measurability. Applying Levi’s
Theorem again to the results from part 1, we have
Z
X	Y
f d ˝  D sup
n2N
Z
X	Y
fn d ˝ 
D sup
n2N
Z
X
Z
Y
fn;x d

d.x/
D
Z
X

sup
n2N
Z
Y
fn;x d

d.x/
D
Z
X	Y
Z
Y
fx d

d.x/:
Again, interchanging rˆoles yields the symmetric equality. a
This yields as an immediate consequence that the cuts of a product inte-
grable function are integrable almost everywhere, to be speciﬁc
Corollary 4.9.11 Let f W X  Y ! R be  ˝  integrable, and put
A WD fx 2 X j fx is not -integrableg;
B WD fy 2 Y j f y is not -integrableg:
Then A 2 A, B 2 B, and .A/ D .B/ D 0.
Proof Because A D fx 2 X j
R
Y jfxj d D 1g, we see that A 2 A.
By the additivity of the integral, we have
Z
X	Y
jf j d ˝  D
Z
XnA
Z
Y
jfxj d

d.x/
C
Z
A
Z
Y
jfxj d

d.x/ < 1I
hence .A/ D 0. B is treated in the same way. a
It is helpful to extend our integral in a minor way.
Assume that
R
X jf j d < 1 for f W X ! eR measurable and that .A/ D 0 with
A WD fx 2 X j jf .x/j D 1g. Change f on A to a ﬁnite value,
obtaining a measurable function f W X ! R, and deﬁne
Z
X
f d WD
Z
X
f d:
Thus f 7!
R
X f d does not notice this change on a set of measure
zero. In this way, we assume always that an integrable function takes

4.9. PRODUCT MEASURES
567
ﬁnite values, even if we have to convince it to do so on a set of measure
zero.
With this in mind, we obtain
Corollary 4.9.12 Let f W X Y ! R be integrable, then x:
R
Y fx d
and y:
R
X f y d are integrable with respect to  resp. , and
Z
X	Y
f d ˝  D
Z
X
Z
Y
fx d

d.x/ D
Z
Y
Z
X
f y d

d.y/:
Proof After the modiﬁcation on a set of -measure zero, we know
that
ˇˇ
Z
X
fx d
ˇˇ 
Z
Y
jfxj d < 1
for all x 2 X, so that x:
R
Y fx d is integrable with respect to ;
similarly, y:
R
X f y d is integrable with respect to  for all y 2 Y . We
obtain from Proposition 4.9.10 and the linearity of the integral
Z
X	Y
f d ˝  D
Z
X	Y
f C d ˝  
Z
X	Y
f  d ˝ 
D
Z
X
Z
Y
f C
x d

d.x/ 
Z
X
Z
Y
f 
x d

d.x/
D
Z
X
Z
Y
f C
x d 
Z
Y
f 
x d

d.x/
D
Z
X
Z
Y
fx d

d.x/:
The second equation is treated in exactly the same way. a
Now we know how to treat a function which is integrable, but we do not
yet have a criterion for integrability. The elegance of Fubini’s Theorem
shines through the observation that the existence of the iterated integrals
yields integrability for the product integral. To be speciﬁc
Theorem 4.9.13 Let f W X  Y ! R be measurable. Then these
statements are equivalent:
1.
R
X	Y jf j d ˝  < 1.
2.
R
X
R
Y jfxj d

d.x/ < 1.
3.
R
Y
R
X jf yj d

d.y/ < 1.

568
CHAPTER 4. MEASURES FOR PROBABILISTIC SYSTEMS
Under one of these conditions, f is  ˝ -integrable, and
Fubini’s
Theorem
Z
X	Y
f d ˝  D
Z
X
Z
Y
fx d

d.x/ D
Z
Y
Z
X
f y d

d.y/:
(4.12)
Proof We discuss only 1
)
2; the other implications are proved
similarly. From Proposition 4.9.10 it is inferred that jf j is integrable,
so 2. holds by Corollary 4.9.12, from which we also obtain representa-
tion (4.12). a
Product integration and Fubini’s Theorem are an essential extension to
our tool kit.
4.9.2
Inﬁnite Products and Projective Limits
We will discuss as a ﬁrst application of product integration now the ex-
istence of inﬁnite products for probability measures. Then we will go
on to establish the existence of projective limits. These limits will be
useful for interpreting a logic which works with continuous time.
Corollary 4.9.3 extends to a ﬁnite number of -ﬁnite measure spaces
in a natural way. Let .Xi; Ai; i/ be -ﬁnite measure spaces for 1 
i  n, the uniquely determined product measure on A1 ˝ : : : ˝ An is
denoted by 1 ˝ : : : ˝ n, and we infer from Corollary 4.9.3 that we
may write
.1 ˝ : : : ˝ n/.Q/
D
Z
X2	:::	Xn
1.Qx2;:::;xn/ d.2 ˝ : : : ˝ n/.x2; : : : ; xn/;
D
Z
X1	:::	Xn1
n.Qx1;:::;xn1/ d.1 ˝ : : : ˝ n1/.x1; : : : ; xn1/
whenever Q 2 A1 ˝ : : : ˝ An. This is fairly straightforward.
Inﬁnite Products
We will have a closer look now at inﬁnite products, where we restrict
ourselves to probability measures, and here we consider the countable
case ﬁrst. So let .Xn; An; $n/ be a measure space with a probability

4.9. PRODUCT MEASURES
569
measure $n on An for n 2 N. We want to construct the inﬁnite product
of this sequence.
Let us ﬁx some notations ﬁrst and then describe the goal in greater detail.
Put
X.n/ WD
Y
kn
Xk;
A.n/ WD fA  X
.nC`/ j A 2 An ˝ : : : ˝ AnC`1 for some ` 2 Ng:
The elements of A.n/ are the cylinder sets for X.n/. Thus X.1/ D Cylinder sets
Q
n2N Xn, and N
n2N An D .A.1//. Given A 2 A.n/, we can write A
as A D C  XnC` with C 2 An ˝ : : : ˝ AnC`1. So if we set
$.n/.A/ WD $n ˝ : : : ˝ $nC`1.C/;
then $.n/ is well deﬁned on A.n/, and it is readily veriﬁed that it is
monotone and additive with $.n/.;/ D 0 and $.n/.X.n// D 1. More-
over, we infer from Theorem 4.9.2 that
$.n/.C/ D
Z
XnC1	:::	XnCm
$n.C xnC1;:::;xnCm/ d.$nC1 ˝ : : : ˝ $nCm/
.xnC1; : : : ; xnCm/
for all C 2 A.n/.
The goal is to show that there exists a unique probability measure $ on
Goal
N
n2N.Xn; An/ such that $

AX.nC1/
D .$1˝: : :˝$n/.A/ when-
ever A 2 An ˝A.nC1/. If we can show that $.1/ is -additive on A.1/,
then we can extend $.1/ to the desired -algebra by Theorem 1.6.29.
For this it is sufﬁcient to show that infn2N $.1/.An/ >  > 0 implies
Š
(H
T
n2N An 6D ; for any decreasing sequence .An/n2N in A.1/.
The basic idea is to construct a sequence .xn/n2N 2 T
n2N An. We do
Basic idea
this step by step:
 First we determine an element x1 2 X1 such that we can expand
the—admittedly very short—partial sequence x1 to a sequence
which is contained in all An; this means that we have to have
Ax1
n 6D ; for all n 2 N, because Ax1
n contains all possible contin-
uations of x1 into An. We conclude that these sets are nonempty,
because their measure is strictly positive.

570
CHAPTER 4. MEASURES FOR PROBABILISTIC SYSTEMS
 If we have such an x1, we start working on the second element of
the sequence, so we have a look at some x2 2 X2 such that we
can expand x1; x2 to a sequence which is contained in all An, so
we have to have Ax1;x2
n
6D ; for all n 2 N. Again, we look for x2
so that the measure of Ax1;x2
n
is strictly positive for each n.
 Continuing in this fashion, we obtain the desired sequence, which
then has to be an element of T
n2N An by construction.
This is the plan. Let us explore ﬁnding x1. Put
E.n/
1
WD fx1 2 X1 j $.2/.Ax1
n / > =2g:
Because
$.1/.An/ D
Z
X1
$.2/.Ax1
n / d$1.x1/;
we have
0 <  < $.1/.An/ D
Z
E.n/
1
$.2/.Ax1
n / d$1.x1/
C
Z
X1nE.n/
1
$.2/.Ax1
n / d$1.x1/
 $1.E.n/
1 / C =2  $.1/.X1 n E.n/
1 /
 $1.E.n/
1 / C =2:
Thus $1.E.n/
1 /  =2 for all n 2 N: Since A1 	 A2 	 : : :, we have
also E.1/
1
	 E.2/
1
	 : : :, so let E1 WD T
n2N E.n/
1 , then E1 2 A1 with
$1.E1/  =2 > 0. In particular, E1 6D ;. Pick and ﬁx x1 2 E1. Then
Ax1
n 2 A.2/, and $.2/.Ax1
n / > =2 for all n 2 N.
Let us have a look at how to ﬁnd the second element; this is but a
small variation of the idea just presented. Put E.n/
2
WD fx2 2 X2 j
$.3/.Ax1;x2
n
/ > =4g for n 2 N. Because
$.2/.Ax1
n / D
Z
X2
$.3/.Ax1;x2
n
/ d$2.x2/;
we obtain similarly $2.E.n/
2 /  =4 for all n 2 N. Again, we have a
decreasing sequence, and putting E2 WD T
n2N E.n/
2 , we have $2.E2/

4.9. PRODUCT MEASURES
571
 =4, so that E2 6D ;. Pick x2 2 E2; then Ax1;x2
n
2 A.3/ and
$.3/.Ax1;x2
n
/ > =4 for all n 2 N.
In this manner we determine inductively for each k 2 N the ﬁnite se-
quence hx1; : : : ; xki 2 X1  : : :  Xk such that $.kC1/.Ax1;:::;xk
n
/ >
=2k for all n 2 N. Consider now the sequence .xn/n2N. From the con-
struction it is clear that hx1; x2; : : : ; xk; : : :i 2 T
n2N An. This shows
that T
n2N An 6D ;, and it implies by the argumentation above that $.1/
is -additive on the algebra A.1/.
Hence we have established
Theorem 4.9.14 Let .Xn; An; $n/ be probability spaces for all n 2 N.
Then there exists a unique probability measure $ on N
n2N.Xn; An/
such that
$.A  Q
k>n Xk/ D .$1 ˝ : : : ˝ $n/.A/
for all A 2 Nn
iD1 Ai. a
Deﬁne the projection 1
n
W .xn/n2N 7! hx1; : : : ; xni from Q
n2N Xn
to Qn
iD1 Xi. In terms of image measures, the theorem states that there
exists a unique probability measure $ on the inﬁnite product such that
S.1
n /.$/ D $1 ˝ : : : ˝ $n.
Non-countable Index Sets.
Now let us have a look at the general case,
in which the index set is not necessarily countable. Let .Xi; Ai; i/
be a family of probability spaces for i 2 I, put X WD Q
i2I Xi and
A WD N
i2I Ai. Given J  I, deﬁne J W .xi/i2I 7! .xi/i2J as the
projection X ! Q
i2J Xi. Put AJ WD 1
J
N
j2J Aj

.
Although the index set I may be large, the measurable sets in A are
always determined by a countable subset of the index set.
Lemma 4.9.15 Given A 2 A, there exists a countable subset J  I
such that A.x/ D A.x0/, whenever J .x/ D J .x0/.
Proof Let G be the set of all A 2 A for which the assertion is true.
Then G is a -algebra which contains 1
fig

Ai

for every i 2 I; hence
G D A. a
This yields as an immediate consequence.
Corollary 4.9.16 A D SfAJ j J  I is countableg.

572
CHAPTER 4. MEASURES FOR PROBABILISTIC SYSTEMS
Proof It is enough to show that the set on the right-hand side is a -
algebra. This follows easily from Lemma 4.9.15. a
We obtain from this observation and from the previous result for the
countable case that arbitrary products exist.
Theorem 4.9.17 Let .Xi; Ai; $i/ be a family of probability spaces for
i 2 I. Then there exists a unique probability measure $ on Q
i2I
.Xi; Ai/ such that
$

1
fi1;:::;ikg

C

D .$i1 ˝ : : : ˝ $ik/.C/
(4.13)
for all C 2 Nk
jD1 Aij and all i1; : : : ; ik 2 I.
Proof Let A 2 A; then there exists a countable subset J  I such that
A 2 AJ . Let $J be the corresponding product measure on AJ . Deﬁne
$.A/ WD $J .A/; then it easy to see that $ is a well-deﬁned measure
on A, since the extension to countable products is unique. From the
construction it follows also that the desired property (4.13) is satisﬁed.
a
Projective Limits
For the interpretation of some logics, the projective limit of a projective
family of stochastic relations is helpful; this is the natural extension of
a product. It will be discussed now. Denote by X1 WD Q
k2N X the
X1
countable product of X with itself; recall that P is the probability func-
tor, assigning to each measurable space its probability measures.
Deﬁnition 4.9.18 Let X be a Polish space, and .n/n2N a sequence of
probability measures n 2 P .Xn/. This sequence is called a projective
system iff
n.A/ D nC1.A  X/
for all n 2 N and all Borel sets A 2 B.Xn/. A probability measure
1 2 P .X1/ is called the projective limit of the projective system
.n/n2N iff
n.A/ D 1.A  Q
j>n X/
for all n 2 N and A 2 B.Xn/.

4.9. PRODUCT MEASURES
573
Deﬁning the projections
nC1
n
W hx1; : : : ; xnC1i 7! hx1; : : : ; xni;
1
n W hx1; : : : ; i 7! hx1; : : : ; xni;
the projectivity condition on .n/n2N can be rewritten as n
D
P

nC1
n

.nC1/ for all n 2 N and the condition on 1 to be a pro-
jective limit as n D P

1
n

.1/ for all n 2 N: Thus a sequence of
measures is a projective system iff each measure is the projection of
the next one; its projective limit is characterized through the property
that its values on cylinder sets coincide with the value of a member of
the sequence, after taking projections. A special case is given by prod-
uct measures. Assume that n D $1 ˝ : : : ˝ $n, where .$n/n2N
is a sequence of probability measures on X. Then the condition on
projectivity is satisﬁed, and the projective limit is the inﬁnite product
constructed above. It should be noted, however, that the projectivity
condition does not express nC1.A  B/ in terms of n.A/ for an arbi-
trary measurable set B  X, as the product measure does; it only says
that n.A/ D nC1.A  X/ holds.
It is not immediately obvious that a projective limit exists in general,
given the rather weak dependency of the measures. In general, it will
not, and this is why. The basic idea for the construction of the inﬁnite
product has been to deﬁne the limit on the cylinder sets and then to
extend this set function—but it has to be established that it is indeed -
additive, and this is difﬁcult in general. The crucial property in the proof
Crucial
property
above has been that nk.Ak/ ! 0 whenever .An/n2N is a sequence of
cylinder set Ak (with at most nk components that do not equal X) that
decreases to ;. This property has been established above for the case of
the inﬁnite product through Fubini’s Theorem, but this is not available
in the general setting considered here, because we do not deal with an
inﬁnite product of measures. We will see, however, that a topological
argument will be helpful. This is why we did postulate the base space
X to be Polish.
We start with an even stronger topological condition, viz., that the space
under consideration is compact and metric. The central statement is
Proposition 4.9.19 Let X be a compact metric space. Then the projec-
tive system .n/n2N has a unique projective limit 1.
Proof 0. Let A D A0
k  Q
j>k X be a cylinder set with A0
k 2 B.Xk/.
Deﬁne .A/ WD k.A0
k/: Then  is well deﬁned on the cylinder

574
CHAPTER 4. MEASURES FOR PROBABILISTIC SYSTEMS
sets, since the sequence forms a projective system. In order to show
Idea of the
proof
that  is -additive on the cylinder sets, we take a decreasing se-
quence .An/n2N of cylinder sets with T
n2N An D ; and show that
infn2N .An/ D 0: In fact, suppose that .An/n2N is decreasing with
.An/ > ı for all n 2 N; then we show that T
n2N An 6D ; by ap-
proximating each An from within through a compact set, which is given
to us through Lemma 4.6.13. Then we are in a position to apply the
observation that compact sets have the ﬁnite intersection property: A
decreasing sequence of nonempty compact sets cannot have an empty
intersection.
1.
We can write An D A0
n  Q
j>kn X for some A0
n 2 B.Xkn/:
From Lemma 4.6.13 we obtain for each n a closed, hence compact set
K0
n  A0
n such that kn.A0
n n K0
n/ < ı=2n: Because X1 is compact
by Tihonov’s Theorem 3.2.12, K00
n WD K0
n  Q
j>kn X is a compact set,
and Kn WD Tn
jD1 K00
j  An is compact as well, with
.An n Kn/  .
n
[
jD1
A00
n n K00
j / 
n
X
jDi
.A00
j n K00
j /
D
n
X
jD1
kj .A0
j n K0
j / 
1
X
jD1
ı=2j D ı:
Thus .Kn/n2N is a decreasing sequence of nonempty compact sets. Con-
sequently, by the ﬁnite intersection property for compact sets,
; 6D
\
n2N
Kn 
\
n2N
An:
2. Since the cylinder sets generate the Borel sets of X1 and since  is
-additive, we know that there exists a unique extension 1 2 P .X1/
to it. Clearly, if A  Xn is a Borel set, then
1.A  Q
j>n X/ D .A  Q
j>n X/ D n.A/;
so we have constructed a projective limit.
Hurray!
3. Uniqueness is established by an appeal to the --Theorem. Suppose
that 0 is another probability measure in P .X1/ that has the desired
property. Consider
D WD fD 2 B.X1/ j 1.D/ D 0.D/g:

4.9. PRODUCT MEASURES
575
It is clear that D contains all cylinder sets and that it is closed un-
der complements and under countable disjoint unions.
By the --
Theorem 1.6.30, D contains the -algebra generated by the cylinder
sets, hence all Borel subset of X1. This establishes uniqueness of the
extension. a
The proof makes critical use of the observation that we can approxi-
mate the measure of a Borel set arbitrarily well by compact sets from
within; see Lemma 4.6.13. It is also important to observe that compact
sets have the ﬁnite intersection property: If each ﬁnite intersection of a
family of compact sets is nonempty, the intersection of the entire family
cannot be empty. Consequently the proof given above works in general
Hausdorff spaces, provided the measures under consideration have the
approximation property mentioned above.
We free ourselves from the restrictive assumption of having a compact
metric space using the Alexandrov embedding of a Polish space into a
compact metric space.
Proposition 4.9.20 Let X be a Polish space, .n/n2N be a projective
system on X. Then there exists a unique projective limit 1 2 P .X1/
for .n/n2N.
Proof X is a dense measurable subset of a compact metric space EX
by Alexandrov’s Theorem 4.3.27. Deﬁning En.B/ WD n.B \ Xn/
for the Borel set B 
EXn yields a projective system

En

n2N on EX
with a projective limit E1 by Proposition 4.9.19. Since by construction
E1.X1/ D 1; restrict E1 to the Borel sets of X1, then the assertion
follows. a
An interesting application of this construction arises through stochas-
tic relations that form a projective system.
We will show now that
there exists a kernel which may be perceived as a (pointwise) projec-
tive limit.
Corollary 4.9.21 Let X and Y be Polish spaces, and assume that J .n/ W
X  Y n is a stochastic relation for each n 2 N such that the sequence
.J .n/.x//n2N forms a projective system on Y for each x 2 X, in par-
ticular J .n/.x/.Y n/ D 1 for all x 2 X. Then there exists a unique
stochastic relation J1 on X and Y 1 such that J1.x/ is the projective
limit of .J .n/.x//n2N for each x 2 X.

576
CHAPTER 4. MEASURES FOR PROBABILISTIC SYSTEMS
Proof 0. Let for x ﬁxed J1.x/ be the projective limit of the projective
system .J .n/.x//n2N. By the deﬁnition of a stochastic relation, we need
Plan
to show that the map x 7! J1.x/.B/ is measurable for every B 2
B.Y 1/.
1. We apply the principle of good sets, considering
D WD fB 2 B.Y 1/ j x 7! J1.x/.B/ is measurableg:
The general properties of measurable functions imply that D is a -
algebra on Y 1. Take a cylinder set B D B0  Q
j>k Y with B0 2
B.Y k/ for some k 2 N; then, by the properties of the projective limit,
we have J1.x/.B/ D J .k/.x/.B0/: But x 7! J .k/.x/.B0/ consti-
tutes a measurable function on X. Consequently, B 2 D, and so D
contains the cylinder sets which generate B.Y 1/. Thus measurabil-
ity is established for each Borel set B  Y 1; arguing with the --
Theorem 1.6.30 as in the last part of the proof for Proposition 4.9.19.
a
4.9.3
Case Study: Continuous Time Stochastic Logic
We illustrate the construction of the projective limit through the inter-
pretation of a path logic over inﬁnite paths; the logic is called CSL—
continuous time stochastic logic. Since the discussion of this application
requires some preparations, some of which are of independent interest,
we develop the example in a series of steps.
We introduce CSL now and describe it informally ﬁrst.
Fix P as a countable set of atomic propositions. We deﬁne recursively
state formulas and path formulas for CSL:
State formulas are deﬁned through the syntax
' WWD > j a j :' j ' ^ '0 j S‰p.'/ j P‰p. /:
Here a 2 P is an atomic proposition,  is a path formula, ‰
is one of the relational operators <; ; ; >, and p 2 Œ0; 1 is a
rational number.
Path formulas are deﬁned through
 WWD X I ' j ' UI '0

4.9. PRODUCT MEASURES
577
with '; '0 as state formulas, I  RC a closed interval of the real
numbers with rational bounds (including I D RC).
The operator S‰p.'/ gives the steady-state probability for ' to hold
with the boundary condition ‰ p; the formula P replaces quantiﬁca-
tion: The path-quantiﬁer formula P‰p. / holds in a state s iff the prob-
ability of all paths starting in s and satisfying  is speciﬁed by ‰ p.
Thus  holds on almost all paths starting from s iff s satisﬁes P1. /,
a path being an alternating inﬁnite sequence  D hs0; t0; s1; t1; : : :i of
states xi and of times ti. Note that the time is being made explicit here.
The next operator X I ' is assumed to hold on path  iff s1 satisﬁes '
and t0 2 I holds. Finally, the until operator '1 UI '2 holds on path
 iff we can ﬁnd a point in time t 2 I such that the state @t which
@t
 occupies at time t satisﬁes '2, and for all times t0 before that, @t0
satisﬁes '1.
A Polish state space S is ﬁxed; this space is used for modeling a transi-
tion system that takes also time into account. We are not only interested
in the next state of a transition but also in the time after which to make
a transition. So the basic probabilistic data will be a stochastic relation
M W S  RC  S; if we are in state s, we will do a transition to a new
state s0 after we did wait some speciﬁed time t; M.s/.D/ will give the
probability that the pair ht; s0i 2 D. We assume that M.s/.RCS/ D 1
holds for all s 2 S.
A path  is an element of the set .SRC/1: Path  D hs0; t0; s1; t1; : : :i
Path
may be written as s0
t0
! s1
t1
! : : : with the interpretation that ti is the
time spent in state si. Given i 2 N, denote si by Œi as the .i C 1/-st
state of , and let ı.; i/ WD ti. Let for t 2 RC the index j be the small-
est index k such that t < Pk
iD0 ti; and put @t WD Œj , if j is deﬁned;
set @t WD #, otherwise (here # is a new symbol not in S [ RC). S#
denotes S [ f#g; this is a Polish space when endowed with the sum -
algebra. The deﬁnition of @t makes sure that for any time t we can
ﬁnd a rational time t0 with @t D @t0:
We will deal only with inﬁnite paths. This is no loss of generality be-
cause events that happen at a certain time with probability 0 will have
the effect that the corresponding inﬁnite paths occur only with probabil-
ity 0. Thus we do not prune the path; this makes the notation somewhat
easier to handle.

578
CHAPTER 4. MEASURES FOR PROBABILISTIC SYSTEMS
The Borel sets B..S RC/1/ are the smallest -algebra which contains
all the cylinder sets
f
n
Y
jD1
.Bj  Ij/ 
Y
j>n
.S  RC/ j n 2 N; I1; : : : ; In rational intervals,
B1; : : : ; Bn 2 B.S/g:
Thus a cylinder set is an inﬁnite product that is determined through the
ﬁnite product of an interval with a Borel set in S. It will be helpful to
remember that the intersection of two cylinder sets is again a cylinder
set.
Given M W S  RC  S with Polish S, deﬁne inductively M1 WD M,
and
MnC1.s0/.D/ WD
Z
.RC	S/n M.sn/.Dt0;s1;:::;tn1;sn/ dMn.s0/
.t0; s1; : : : ; tn1; sn/
for the Borel set D  .RC  S/nC1. Let us illustrate this for n D 1.
Given D 2 B..RC  S/2/ and s0 2 S as a state to start from, we want
to calculate the probability M2.s0/.D/ that ht0; s1; t1; s2i 2 D. This is
the probability for the initial path hs0; t0; s1; t1; s2i (a pathlet), given the
initial state s0. Since ht0; s1i is taken care of in the ﬁrst step, we ﬁx it
and calculate M.s1/.fht1; s2i j ht0; s1; t1; s2i 2 Dg/ D M.s1/.Dt0;s1/;
by averaging, using the probability provided by M.s0/, so that we ob-
tain
M2.s0/.D/ D
Z
RC	S
M.s1/.Dt0;s1/ dM.s0/.t0; s1/:
We obtain for the general case MnC1.s0/.D/ as the probability for
hs0; t0; : : : ; sn; tn; snC1i as the initial piece of an inﬁnite path to be a
member of D. This probability indicates that we start in s0, remain in
this state for t0 units of time, then enter state s1, remain there for t1 time
units, etc., and ﬁnally leave state sn after tn time units, entering snC1,
all this happening within D.
We claim that

Mn.s/

n2N is a projective system. We ﬁrst see from
Example 4.9.5 that Mn W S  .RC  S/n deﬁnes a transition ker-
nel for each n 2 N. Let D D A  .RC  S/ with A 2 B..RC 

4.9. PRODUCT MEASURES
579
S/n/, then M.sn/.Dt0;s1;:::;tn1;sn/ D M.sn/.RC  S/ D 1 for all
ht0; s1; : : : ; tn1; sni 2 A, so that we obtain MnC1.s/.A.RCS// D
Mn.s/.A/: Consequently, the condition on projectivity is satisﬁed.
Hence there exists a unique projective limit; thus a transition kernel
M1 W S  .RC  S/1
with
Mn.s/.A/ D M1.s/

A 
Y
k>n
.RC  S/

for all s 2 S and for all A 2 B..RC  S/n/.
The projective limit displays indeed limiting behavior: Suppose B is an
inﬁnite measurable cube Q
n2N Bn with Bn 2 B.RC  S/ as Borel sets.
Because
B D T
n2N
Q
1jn Bj  Q
j>n.RC  S/

represents B as the intersection of a monotonically decreasing sequence,
we have for all s 2 S
M1.s/.B/ D limn!1 M1.s/
Q
1jn Bj  Q
j>n.RC  S/

D limn!1 Mn.s/
Q
1jn Bj

:
Hence M1.s/.B/ is the limit of the probabilities Mn.s/.Bn/ at step n.
In this way models based on a Polish state space S yield stochastic re-
lations S  .RC  S/1 through projective limits. Without this limit it
would be difﬁcult to model the transition behavior on inﬁnite paths; the
assumption that we work in Polish spaces makes sure that these limits in
fact do exist. To get started, we need to assume that given a state s 2 S,
there is always a state to change into after a ﬁnite amount of time.
We obtain—as an aside—a recursive formulation for the transition law
M W X  .RC  S/1 as a ﬁrst consequence of the construction for
the projective limit. Interestingly, it reﬂects the domain equation .RC 
S/1 D .RC  S/  .RC  X/1:
Lemma 4.9.22 If D 2 B..RC  S/1/, then
M1.s/.D/ D
Z
RC	S
M1.s0/.Dht;s0i/ M1.s/.dht; s0i/
holds for all s 2 S.

580
CHAPTER 4. MEASURES FOR PROBABILISTIC SYSTEMS
Proof Recall that Dht;s0i D f j ht; s0; i 2 Dg: Let
D D .H1  : : :  HnC1/ 
Y
j>n
.RC  S/
be a cylinder set with Hi 2 B.RC  S/; 1  i  n C 1. The equation
in question in this case boils down to
MnC1.s/.H1 : : :HnC1/ D
Z
H1
Mn.s0/.H2 : : :HnC1/M1.s/.dht; s0i/:
This may easily be derived from the deﬁnition of the projective se-
quence. Consequently, the equation in question holds for all cylinder
sets, and thus the --Theorem 1.6.30 implies that it holds for all Borel
subsets of .RC  S/1. a
This decomposition indicates that we may ﬁrst select in state s a new
state and a transition time; with these data the system then works just
as if the selected new state would have been the initial state. The sys-
tem does not have a memory but reacts depending on its current state,
no matter how it arrived there. Lemma 4.9.22 may accordingly be in-
terpreted as a Markov property for a process, the behavior of which is
Markov
property
independent of the speciﬁc step that is undertaken.
We need some information about the @-operator before continuing.
Lemma 4.9.23 h; ti 7! @t is a Borel measurable map from .S 
RC/1  RC to S#. In particular, the set fh; ti j @t 2 Sg is a
measurable subset of .S  RC/1  RC.
Proof 0. Note that we claim joint measurability in both components,
which is strictly stronger than measurability in each component. Thus
we have to show that fh; ti j @t 2 Ag is a measurable subset of
.S  RC/1  RC, whenever A  S# is Borel.
1. Because the map  7! ı.; i/ is a projection for ﬁxed i 2 N, ı.; i/ is
measurable; hence  7! Pj
iD0 ı.; i/ is. Consequently,
fh; ti j @t D #g D fh; ti j 8j W t 
j
X
iD0
ı.; i/g
D
\
j0
fh; ti j t 
j
X
iD0
ı.; i/g:
This is clearly a measurable set.

4.9. PRODUCT MEASURES
581
2. Put stop.; t/ WD inffk  0 j t < Pk
iD0 ı.; i/gI thus stop.; t/ is
the smallest index for which the accumulated waiting times exceed t.
Xk WD fh; ti j stop.; t/ D kg D fh; ti j
k1
X
iD0
ı.; i/
 t <
k
X
iD0
ı.; i/g
is a measurable set by Corollary 4.2.5. Now let B 2 B.S/ be a Borel
set; then
fh; ti j @t 2 Bg
D S
k0fh; ti j @t 2 B; stop.; t/ D kg
D S
k0fh; ti j Œk 2 B; stop.; t/ D kg
D S
k2N

Xk \
Q
i<k.S  RC/  .B  RC/  Q
i>k.S  RC/

:
Because Xk is measurable, the latter set is measurable. This establishes
measurability of the @-map. a
As a consequence, we establish that some sets and maps, which will
be important for the later development, are actually measurable. A no-
tational convention for improving readability is proposed: The letter 
Convention
will always denote a generic element of .S  RC/1, and the letter #
always a generic element of RC  .S  RC/1.
Proposition 4.9.24 We observe the following properties:
1. fh; ti j limi!1 ı.; i/ D tg is a measurable subset of .S 
RC/1  RC.
2. Let N1 W S  .RC  S/1 be a stochastic relation; then
s 7! lim inf
t!1 N1.s/.f# j hs; #i@t 2 Ag/;
s 7! lim sup
t!1
N1.s/.f# j hs; #i@t 2 Ag/
constitute measurable maps X ! RC for each Borel set A  S.
Proof 0. The proof makes crucial use of the fact that the real line is
a complete metric space and that the rational numbers are a dense and
countable set.

582
CHAPTER 4. MEASURES FOR PROBABILISTIC SYSTEMS
1. In order to establish part 1, write
fh; ti j lim
i!1 ı.; i/ D tg
D
\
Q3>0
[
n2N
\
mn
fh; ti j
ˇˇı.; m/  t
ˇˇ < g:
By Lemma 4.9.23, the set
fh; ti j
ˇˇı.; m/  t
ˇˇ < g D fh; ti j ı.; m/ > t  g
\ fh; ti j ı.; m/ < t C g
is a measurable subset of .S RC/1 RC, and since the union and the
intersections are countable, measurability is inferred.
2. From the deﬁnition of the @-operator, it is immediate that given
an inﬁnite path  and a time t 2 RC, there exists a rational t0 with
@t D @t0: Thus we obtain, for an arbitrary real number x, arbitrary
Borel sets A  S and s 2 S
lim inf
t!1 N1.s/.f# j hs; #i@t 2 Ag/  x
, sup
t0
inf
rt N1.s/.f# j hs; #i@r 2 Ag/  x
, sup
Q3t0
inf
Q3rt N1.s/.f# j hs; #i@r 2 Ag/  x
, s 2
\
Q3t0
[
Q3rt
Ar;x
with
Ar;x WD
˚
s0 j N1.s0/

f# j hs0; #i@r 2 Ag

 x

:
We infer that Ar;x is a measurable subset of S from the fact that N1
is a stochastic relation. Since a map f W W ! R is measurable iff
each of the sets fw 2 W j f .w/  sg is a measurable subset of W ,
the assertion follows for the ﬁrst map. The second part is established
in exactly the same way, using that f W W ! R is measurable iff
fw 2 W j f .w/  sg is a measurable subset of W and observing
lim sup
t!1
N1.s/.f# j hx; #i@t 2 Ag/  x
,
inf
Q3t0 sup
Q3rt
N1.x/.f# j hs; #i@r 2 Ag/  x:
a

4.9. PRODUCT MEASURES
583
This has some consequences which will come in useful for the interpre-
tation of CSL. Before stating them, it is noted that the statement above
(and the consequences below) does not make use of N1 being a projec-
tive limit; in fact, we assume N1 W S  .RC  S/1 to be an arbitrary
stochastic relation. A glimpse at the proof shows that these statements
even hold for ﬁnite transition kernels, but since we will use it for the
probabilistic case, we stick to stochastic relations.
Now for the consequences. As a ﬁrst consequence, we obtain that the set
on which the asymptotic behavior of the transition times is reasonable
(in the sense that it tends probabilistically to a limit) is well behaved in
terms of measurability.
Corollary 4.9.25 Let A  X be a Borel set, and assume that N1 W
S  .RC  S/1 is a stochastic relation. Then
1. the set QA WD fs 2 S j limt!1 N1.s/.f# j hs; #i@t 2
Ag/ existsg on which the limit exists is a Borel subset of S,
2. s 7! limt!1 N1.s/.f# j hs; #i@t 2 Ag is a measurable map
QA ! RC.
Proof Since s 2 QA iff
lim inf
t!1 N1.x/.f# j hs; #i@t 2 Ag/ D lim sup
t!1
N1.x/.f# j hs; #i@t 2 Ag/;
and since the set on which two Borel measurable maps coincide is a
Borel set itself, the ﬁrst assertion follows from Proposition 4.9.24, part 2.
This implies the second assertion as well. a
When dealing with the semantics of the until operator below, we will
also need to establish measurability of certain sets. Preparing for that,
we state
Lemma 4.9.26 Assume that A1 and A2 are Borel subsets of S, and let
I  RC be an Interval; then
U.I; A1; A2/ WD f j 9t 2 I W @t 2 A2 and 8t0 2 Œ0; tŒW @t0 2 A1g
is a measurable set of paths, and thus U.I; A1; A2/ 2 B..S  RC/1/:

584
CHAPTER 4. MEASURES FOR PROBABILISTIC SYSTEMS
Proof 0. Remember that, given a path  and a time t 2 RC, there exists
a rational time tr  t with @t D @tr: Consequently,
U.I; A1; A2/ D
[
t2Q\I

f j @t 2 A2g \
\
t02Q\Œ0;t
f j @t0 2 A1g

:
The inner intersection is countable and is performed over measurable
sets by Lemma 4.9.23, thus forming a measurable set of paths. Inter-
secting it with a measurable set and forming a countable union yield a
measurable set again. a
Interpretation of CSL
Now that a description for the behavior of
paths is available, we are ready for a probabilistic interpretation of CSL.
We did start from the assumption that the one-step behavior is governed
through a stochastic relation M W S  RCS with M.s/.RCS/ D 1
for all s 2 S from which the stochastic relation M1 W S  RC  .S 
RC/1 has been constructed. The interpretations for the formulas can
be established now, and we show that the sets of states resp. paths on
which formulas are valid are Borel measurable.
To get started on the formal deﬁnition of the semantics, we assume that
we know for each atomic proposition which state it is satisﬁed in. Thus
we ﬁx a map V that maps P to B.S/, assigning each atomic proposition
V W P !
B.S/
a Borel set of states.
The semantics is described as usual recursively through relation ˆ be-
tween states resp. paths and formulas. Hence s ˆ ' means that state
formula ' holds in state s, and  ˆ  means that path formula  is true
on path .
Here we go:
1. s ˆ > is true for all s 2 S.
s ˆ '
2. s ˆ a iff s 2 V.a/.
3. s ˆ '1 ^ '2 iff s ˆ '1 and s ˆ '2.
4. s ˆ :' iff s ˆ ' is false.

4.9. PRODUCT MEASURES
585
5. s ˆ S‰p.'/ iff limt!1 M1.s/.f# j hs; #i@t ˆ 'g/ exists and
is ‰ p.
6. s ˆ P‰p. / iff M1.s/.f# j hs; #i ˆ  g/ ‰ p:
7.  ˆ X I ' iff Œ1 ˆ ' and ı.; 0/ 2 I:
 ˆ  
8.  ˆ '1 UI '2 iff 9t 2 I W @t ˆ '2 and 8t0 2 Œ0; tŒW @t0 ˆ
'1:
Most interpretations should be obvious. Given a state s, we say that
s ˆ S‰p.'/ iff the asymptotic behavior of the paths starting at s gets
eventually stable with a limiting probability given by ‰ p. Similarly,
s ˆ P‰p. / holds iff the probability that path formula  holds for
all s-paths is speciﬁed through ‰ p. For hs0; t0; s1; : : : ; i ˆ X I ' to
hold, we require s1 ˆ ' after a waiting time t0 for the transition to be a
member of interval I. Finally,  ˆ '1UI '2 holds iff we can ﬁnd a time
point t in the interval I such that the corresponding state @t satisﬁes
'2, and for all states on that path before t, formula '1 is assumed to
hold. The kinship to CTL* is obvious; see Example 2.7.65.
Denote by ŒŒ' and ŒŒ  the set of all states for which the state formula
ŒŒ'; ŒŒ 
' holds, resp. the set of all paths for which the path formula ' is valid.
We do not distinguish notationally between these sets, as far as the ba-
sic domains are concerned, since it should always be clear whether we
describe a state formula or a path formula.
We show that we are dealing with measurable sets. Most of the work
for establishing this has been done already. What remains to be done
is to ﬁt in the patterns that we have set up in Proposition 4.9.24 and its
corollaries.
Proposition 4.9.27 The set ŒŒ
 is Borel whenever 
 is a state formula
or a path formula.
Proof 0. The proof proceeds by induction on the structure of the formula

. The induction starts with the formula >, for which the assertion is
true, and with the atomic propositions, for which the assertion follows
from the assumption on V : ŒŒa D V.a/ 2 B.S/: We assume for the
induction step that we have established that ŒŒ'; ŒŒ'1 and ŒŒ'2 are Borel
measurable.
1. For the next operator, we write
ŒŒX I ' D f j Œ1 2 ŒŒ' and ı.; 0/ 2 Ig:

586
CHAPTER 4. MEASURES FOR PROBABILISTIC SYSTEMS
This is the cylinder set .S  I  ŒŒ'  RC/  .S  RC/1I hence is a
Borel set.
2. The until operator may be represented through
ŒŒ'1 UI '2 D U.I; ŒŒ'1; ŒŒ'2/;
which is a Borel set by Lemma 4.9.26.
3. Since M1 W S  .RC  S/1 is a stochastic relation, we know
that
ŒŒP‰p. / D fs 2 S j M1.s/.f# j hs; #i 2 ŒŒ'g/ ‰ pg
is a Borel set.
4. We know from Corollary 4.9.25 that the set
QŒŒ' WD fs 2 S j lim
t!1 M1.s/.f# j hs; #i@t 2 ŒŒ'g/ existsg
is a Borel set and that
J' W QŒŒ' 3 s 7! lim
t!1 M1.x/ .f# j hs; #i@t 2 ŒŒ'g/ 2 Œ0; 1
is a Borel measurable function. Consequently,
ŒŒS‰p.'/ D fs 2 QŒŒ' j J'.s/ ‰ pg
is a Borel set. a
Measurability of the sets on which a given formula is valid constitutes
of course a prerequisite for computing interesting properties. So we can
compute, e.g.,
P0:5..:down/ UŒ10;20 S0:8.up2 _ up3///
as the set of all states that with probability at least 0:5 will reach a
state between 10 and 20 time units so that the system is operational
(up2; up3 2 P ) in a steady state with a probability of at least 0:8;
prior to reaching this state, the system must be operational continuously
(down 2 P ).
The description of the semantics is just the basis for entering into the
investigation of expressivity of the models associated with M and with
V . We leave CSL here, however, and note that the construction of the
projective limit is the basic and fundamental ingredient for further in-
vestigations.

4.9. PRODUCT MEASURES
587
4.9.4
Case Study: A Stochastic Interpretation of Game
Logic
Game logic is a modal logic, the modalities of which are given by
games. The grammar for games has been presented and discussed in
Example 2.7.5; here it is again:
g WWD  j g1 [ g2 j g1 \ g2 j g1I g2 j gd j g j g	 j '‹
with  2  and ' a formula of the underlying logic; the set  is the
collection of primitive games, from which compound games are con-
structed.
This section will deal with a stochastic interpretation of game logic,
based on the discussion from Sect. 2.7, which indicates that Kripke mod-
els are not fully adequate for this task. It results in an interpretation of
game logics through neighborhood models, which in turn are deﬁned
through effectivity functions. Since we have stochastic effectivity func-
tions at our disposal, we will base a probabilistic interpretation based on
them. We refer also to the discussion above concerning the observation
that the games we are discussing here are different from the Banach–
Mazur games, which are introduced in Chap. 1 and put to good use in
Sects. 1.7 and 3.5.2.
The games which we consider here are assumed to be determined, so
if one player does not have a winning strategy, the other player has
one (again, we do not formalize the notion of a strategy here); de-
terminedness serves here the purpose of relating the players’ behav-
ior to each other. In this sense, determinedness has the consequence
that if we model Angel’s portfolio for a game  2  through the
effectivity function P, then Demon’s portfolio in state s is given by
fA j S n A 62 P.s/g, which deﬁnes also an effectivity function.
We make as in Example 2.7.5 the following assumptions (when writing
down games, we assume for simplicity that composition binds tighter
than angelic or demonic choice):
❶.gd/d is identical to g.
❷Demonic choice can be represented through angelic choice: The
game g1 \ g2 coincides with the game .gd
1 [ gd
2 /d.
❸Similarly, demonic iteration can be represented through its an-
gelic counterpart: .g	/d is equal to .gd/.

588
CHAPTER 4. MEASURES FOR PROBABILISTIC SYSTEMS
❹Composition is right distributive with respect to angelic choice:
Making a decision to play g1 or g2 and then playing g should
be the same as deciding to play g1I g or g2I g; thus .g1 [ g2/I g
equals g1I g [ g2I g.
Note that left distributivity would mean that a choice between
gI g1 and gI g2 is the same as playing ﬁrst g, then g1 [ g2, as
discussed in Example 2.7.22. This is a somewhat restrictive as-
sumption, since the choice of playing g1 or g2 may be a decision
made by Angel only after g is completed. Thus we do not as-
sume this in general. It will turn out, however, that in Kripke
generated models these choices are in fact equivalent; see Propo-
sition 4.9.40.
❺We assume similarly that gI g0 equals g0 [ gI gI g0: Hence
when playing gI g0, Angel may decide to play g not at all and
to continue with g0 right away or to play g followed by gI g0.
Thus gI g0 expands to g0 [ gI g0 [ gI gI g0 [ : : : :
❻.g1I g2/d is the same as gd
1 I gd
2 .
❼The binary operations angelic and demonic choice are commuta-
tive and associative, and composition is associative as well.
We do not discuss for the time being the test operator, since its semantics
depends on a model; we will ﬁt in the operator later in (p. 603), when
all the necessary operations are available.
This is the stage on which we play our game.
Deﬁnition 4.9.28 A game frame G D

.S; A/; .P/2

has a measur-
able space .S; A/ of states and a t-measurable map P W S ! E.S; A/
for each primitive game  2  .
(E.S; A/ is deﬁned on page 442). As usual, we will omit the reference
to the -algebra of the state space S, unless we really need to write it
down. Fix a game frame G D

S; .P/2

; the set of primitive games
is extended by the empty game , and set P WD D with D as the Dirac
effectivity function according to Example 4.1.18. We assume in the
sequel that  2  .
We deﬁne now recursively the set-valued function ˝G.g j A; q/ with the
informal meaning that this set describes the set of states so that Angel
has a strategy of reaching a state in set A with probability greater than q

4.9. PRODUCT MEASURES
589
upon playing game g. Assume that A 2 A is a measurable subset of S,
and 0  q < 1, and deﬁne for 0  k  1
Q.k/.q/ WD fha1; : : : ; aki 2 Qk j ai  0 and
k
X
iD1
ai  qg
as the set of all nonnegative rational k-tuples, the sum of which does not
exceed q.
➀Let  2  ; then put
˝G. j A; q/ WD fs 2 S j ˇˇˇA.A; > q/ 2 P.s/g;
in particular ˝G. j A; q/ D fs 2 S j ıs.A/ > qg D A. Thus
s 2 ˝G. j A; q/ iff Angel has ˇˇˇA.A; > q/ in its portfolio when
playing  in state s. This implies that the set of all state distribu-
tions which evaluate at A with a probability greater than q can be
effected by Angel in this situation. If Angel does not play at all,
hence if the game  equals , nothing is about to change, which
means ˝G. j A; q/ D fs j ıs 2 ˇˇˇA.A; > q/g D A:
➁Let g be a game; then
˝G.gd j A; q/ WD S n ˝G.g j S n A; q/:
The game is determined; thus Demon can reach a set of states
iff Angel does not have a strategy for reaching the complement.
Consequently, upon playing g in state s, Demon can reach a state
in A with probability greater than q iff Angel cannot reach a state
in S n A with probability greater q.
Illustrating, let us assume for the moment that P D PK, i.e.,
that the effectivity function for  2  is generated from a stochas-
tic relation K; see Lemma 4.1.16. Then
s 2 ˝G.d j A; q/ , s … ˝G. j S nA; q/ , K.s/.S nA/  q:
In general, s 2 ˝G.d j A; q/ iff ˇˇˇA.S n A; > q/ … P.s/ for
 2  . This is exactly what one would expect in a determined
game.
➂Assume s is a state such that Angel has a strategy for reaching a
state in A when playing the game g1 [ g2 with probability not

590
CHAPTER 4. MEASURES FOR PROBABILISTIC SYSTEMS
greater than q. Then Angel should have a strategy in s for reach-
ing a state in A when playing game g1 with probability not greater
than a1 and playing game g2 with probability not greater than a2
such that a1 C a2  q. Thus
˝G.g1 [ g2 j A; q/ WD
\
a2Q.2/.q/

˝G.A j g1; a1/ [ ˝G.A j g2; a2/

:
➃Right distributivity of composition over angelic choice translates
to this equation:
˝G..g1 [ g2/I g j A; q/ WD ˝G.g1I g [ g2I g j A; q/:
➄If  2  , put
˝G.I g j A; q/ WD fs 2 S j Gg.A; q/ 2 P.s/g;
where
Gg.A; q/ WD f 2 S.S/ j
Z 1
0
.˝G.g j A; r// dr > qg:
(4.14)
Suppose that ˝G.g j A; r/ is already deﬁned for each r as the
set of states for which Angel has a strategy to effect a state in A
through playing g with probability greater than r. Given a distri-
bution  over the states, the integral
R 1
0 .˝G.g j A; r// dr is the
expected value for entering a state in A through playing g for .
The set Gg.A; q/ collects all distributions, the expected value of
which is greater than q. We ask for all states such that Angel has
this set in its portfolio when playing  in this state. Being able
to select this set from the portfolio means that, when playing 
and subsequently g, a state in A may be reached with probability
greater than q.
➅This is just the translation of assumption ❺above with a repeated
application of the rule ➂for angelic choice:
˝G.gI g0 j A; q/ WD
\
a2Q.q/.1/
[
n0
˝G.gnI g0 j A; anC1/
with g0 WD  and gn WD gI : : : I g (n times).

4.9. PRODUCT MEASURES
591
One observes that q 7! ˝G. j A; q/ is a monotonically decreasing
function for  2  , because q1  q2 implies ˇˇˇA.> q1; A/  ˇˇˇA.>
q2; A/, so that ˇˇˇA.> q1; A/ 2 P.s/ implies ˇˇˇA.> q2; A/ 2 P.s/.
The situation changes, however, when Demon enters the stage, because
then q 7! ˝G.d j A; Q/ is increasing. So q 7! ˝G.g j A; q/ can
be guaranteed to be monotonically decreasing only if g belongs to the
PDL fragment (shattering the hope to simplify some arguments due to
monotonicity.
It has to be established for every game g that ˝G.g j A; q/ 2 A, pro-
vided A 2 A. We look at different cases, but we do have some prepa-
rations ﬁrst. They address the embedded integration which is found in
case ➄. The technical property on measurability established in Corol-
lary 4.9.9 has an immediate consequence.
Corollary 4.9.29 Let P W S ! E.S/ be a stochastic effectivity func-
tion, and assume B 2 A ˝ B.Œ0; 1/: Put
G WD fh; qi 2 S.S/  Œ0; 1 j
Z 1
0
.Br/ dr ‰ qg:
Then fhs; qi 2 S  Œ0; 1 j Gq 2 P.s/g 2 A ˝ B.Œ0; 1/:
Proof G 2 }}}.S/˝B.Œ0; 1/ by Corollary 4.9.9, so the assertion follows
from t-measurability. a
Perceiving the set ˝G.g j A; r/ as the result of transforming set A
through game g, we may say something about the effect of the trans-
formation which is induced by game I g with  2  . We need this
technical property for making sure that we do not leave the kingdom of
measurable sets while playing our games.
Lemma 4.9.30 Let g be a game such that fhs; ri 2 S  Œ0; 1 j s 2
˝G.g j A; r/g is a measurable subset of S  Œ0; 1, and assume that
 2  . Then
fhs; ri 2 S  Œ0; 1 j s 2 ˝G.I g j A; r/g
is a measurable subset of S  Œ0; 1.
Proof This follows from Corollary 4.9.29, because P is t-measurable.
a
The transformation associated with the indeﬁnite iteration in ➅above
involves an uncountable intersection, since for q > 0 the set Q.1/.q/

592
CHAPTER 4. MEASURES FOR PROBABILISTIC SYSTEMS
has the cardinality of the continuum. Since -algebras are closed only
under countable operations, we might in this way generate a set which
is not measurable at all, unless we do take cautionary measures into
account.
If the state space is closed under the Souslin operation, which is dis-
cussed in Sect. 4.5, then the resulting set will still be measurable. A
fairly popular class of spaces closed under this operation is the class
of universally complete measurable spaces; see Proposition 4.6.4. The
class of analytic sets in a Polish space is closed under the Souslin opera-
tion as well; see Proposition 4.5.1 together with Theorem 4.5.5 (but we
have to be careful here, because the class of analytic sets in not closed
under complementation and demonic argumentation introduces comple-
ments).
In order to deal with indeﬁnite iteration in ➅, we establish ﬁrst that
we can encode the elements of Q.1/.q/ conveniently through inﬁnite
sequences over N0. This will then serve as an encoding, so that we
obtain ˝G.gI g0 j A; q/ as the result of a Souslin scheme, as deﬁned
on page 517.
Recall that jn is the truncation operator which takes the ﬁrst n elements
of an inﬁnite sequence or a sequence of length greater than n.
Lemma 4.9.31 There exists for q > 0 a bijection f W NN
0 ! Q.1/.q/
such that ˛jn D ˛0jn implies f .˛/jn D f .˛0/jn for all n 2 N and all
˛; ˛0 2 NN
0.
Proof 0. Let us look at the idea ﬁrst. Deﬁne Dn WD fajn j a 2
Idea for a
proof
Q.1/.q/g as the set of all truncated sequences in Q.1/.q/ of length n.
Since q > 0, the set D1 D Œ0; q \ Q is not empty and countable; hence
we can ﬁnd a bijection `1 W D1 ! N0. Let us see what happens when
we consider D2. If ha1; a2i 2 D2, we consider two cases: a1 C a2 D q
and a1 C a2 < q. In the former case, we put `2.a1; a2/ WD h`1.a1/; 0i,
and in the latter case we know that Œ0; q  .a1 C a2/ \ Q 6D ; is count-
able; thus we ﬁnd a bijection ha1;a2 W Œ0; q  .a1 C a2/ \ Q ! N0, so
we put `2.a1; a2/ WD h`1.a1/; ha1;a2.a2/i. This yields a bijection, and
the projection of `2 equals `1. The inductive step is done through the
same argumentation. From this construction we piece together a bijec-
tion Q.1/.q/ ! NN
0, which will be inverted to give the function we are
looking for.

4.9. PRODUCT MEASURES
593
1. We construct ﬁrst inductively for each n 2 N a bijection `n W Dn !
Nn
0 such that `nC1.w/jn D `n.wjn/ holds for all w 2 DnC1. `1 W
D1 D Œ0; q \ Q ! N0 is an arbitrary bijection, and if `n is already
deﬁned, put for w D hw1; : : : ; wnC1i 2 DnC1
`nC1.w/ WD
8
ˆ<
ˆ:
h`n.w1; : : : ; wn/; 0i;
if w1 C : : : C wn D q;
h`n.w1; : : : ; wn/;
hw1;:::;wn.wnC1/i;
otherwise;
where hw1;:::;wn W Œ0; q  .w1 C : : : C wn/ \ Q ! N is a bijection.
An easy inductive argument shows that `nC1 is bijective, if `n is, and
that the projectivity condition `nC1.w/jn D `n.wjn/ holds for each
w 2 DnC1.
2. Deﬁne `1.a/jn WD `n.ajn/ for a 2 Q.1/.q/ and n 2 N; then the
projectivity condition makes sure that `1 W Q.1/.q/ ! NN
0 is well
deﬁned. Because each `n is a bijection, `1 is. Assume that ˛jn D ˛0jn
holds for ˛; ˛0 2 NN
0 and for some n 2 N, then ˛ D `1.a/; ˛0 D
`1.a0/ for some a; a0 2 Q.1/.q/. Thus ˛jn D `1.a/jn D `n.ajn/I
hence ajn D a0jn, since `n is injective.
3. Now let f be the inverse to `1, then the assertion follows. a
After this technical preparation, we are in a position to establish this
important property.
Proposition 4.9.32 Let g and g0 be games such that ˝G.gnI g0 j A; r/
is a measurable subset of S for each n 2 N and each rational r 2
Œ0; 1. Assume that the measurable space S is closed under the Souslin
operation. Then ˝G.gI g0 j A; q/ is a measurable subset of S for each
n 2 N and each rational q 2 Œ0; 1.
Proof 0. The proof just encodes the representation of ˝G.gI g0 j A; q/
so that a Souslin scheme arises.
1. Let f W NN
0 ! Q.1/.q/ deﬁne the encoding Lemma 4.9.31. Write
˝G.gI g0 j A; q/ D
\
a2Q.q/.1/
[
n0
˝G.gnI g0 j A; anC1/
D
\
˛2NN
0
[
n0
C˛jn
with C˛jn WD ˝G.gnI g0 j A; f .˛/nC1/: a

594
CHAPTER 4. MEASURES FOR PROBABILISTIC SYSTEMS
Thus we know that the construction above does not lead us outside the
realm of measurable sets, provided the space is closed under the Souslin
operation. We may think of A 7! ˝G.g j A; q/ as a set transformation.
But this applies for the time being only to those games the syntactic
pattern is given by one of the cases above, and we have to investigate
now whether we can interpret each game that way.
Call the game g interpretable iff ˝G.g j A; q/ is deﬁned for each A 2
Interpretable
game
A; q 2 Œ0; 1 rational so that the set
Gr.g; A/ WD fhs; qi 2 S  Œ0; 1 j s 2 ˝G.g j A; q/g
is a measurable subset of S  Œ0; 1. Note that we exclude for the time
being the test operator.
Lemma 4.9.33 Each game g is interpretable, provided the state space
is closed under the Souslin operation.
Proof 0. The proof employs a kind of inductive strategy. We show ﬁrst
Strategy
that all primitive games are interpretable and that the dual of an inter-
pretable game is interpretable again. Then we go through the different
cases and have a look at what happens.
1. Let
J WD fg j g is interpretableg:
We show that J contains all games.
2. Let A 2 A; then
fh; qi 2 S.S/  Œ0; 1 j  2 ˇˇˇA.A; > q/g
D fh; qi 2 S.S/  Œ0; 1 j .A/ > qg
is a measurable subset of S.S/  Œ0; 1; see Corollary 4.2.5. Thus, if
 2  , we have
Gr.; A/ D fhs; qi 2 S  Œ0; 1 j ˇˇˇA.A; > q/g;
which is a measurable
subset
of S  Œ0; 1,
because
P
is
t-measurable. Consequently, we obtain   J .
3. Clearly, J is closed under demonization and angelic choice and hence
under demonic choice as well. Now let
L WD fg j gI g1 is interpretable for all interpretable g1g:

4.9. PRODUCT MEASURES
595
Then Lemma 4.9.30 implies that  [ fd j  2  g  L. Moreover,
because angelic choice distributes from the left over composition, L is
closed under angelic choice. It is also closed under demonization: Let
g 2 L and take an interpretable game g1; then gI gd
1 is interpretable,
and thus the interpretation of .gI gd
1 /d is deﬁned; hence gdI g1 is inter-
pretable. Clearly, L is closed under composition. Thus g 2 L implies
g 2 L as well as g	 2 L, so that L is the set of all games.
This implies that J is closed under composition, and hence both are un-
der angelic and demonic iteration. Consequently, J contains all games.
a
Summarizing, we obtain
Proposition 4.9.34 Assume that the state space is closed under the
Souslin operation; then we have ˝G.g j A; q/ 2 A for all games g,
A 2 A and 0  q  1.
Proof We infer for each game g from Lemma 4.9.33 that the set
Gr.g; A/ is a measurable subset of S  Œ0; 1 for A 2 A. But ˝G.g j
A; q/ D Gr.g; A/q. a
We relate game frames to each other through morphisms. Suppose that
H D

T; .Q/2

is another game frame; then f W G ! H is a game
frame morphism iff f W P ! Q is a morphism for the associated
effectivity functions for all  2  ; these morphisms are deﬁned in Def-
inition 4.1.25.
Game frame
morphism
The transformations above are compatible with frame morphisms.
Proposition 4.9.35 Let f W G ! H be a game frame morphism, and
assume that ˝G.g j ; q/ and ˝H.g j ; q/ always transform measurable
sets into measurable sets for all games g and all q. Then we have
f 1
˝H.g j B; q/

D ˝G.g j f 1
B

; q/
for all games g, all measurable sets B 2 B.T /, and all q.
Proof 0. The proof proceeds by induction on g. Because f is a mor-
phism, the assertion is true for g D  2  . Because f 1 is compatible
with the Boolean operations on sets, it is sufﬁcient to consider the case
g D I g1 in detail. It wants essentially the computation of an image
measure, and it looks worse than it really is.

596
CHAPTER 4. MEASURES FOR PROBABILISTIC SYSTEMS
1. Assume that the assertion is true for game g1, ﬁx B 2 B; q  0.
Then
Gg1;G.f 1
B

; q/
D f 2 S.S/ j
Z 1
0


˝G.g1 j f 1
B

; r/

dr > qg
./
D f 2 S.S/ j
Z 1
0


f 1
˝G.g1 j B; r/

dr > qg
.˚/
D f 2 S.S/ j
Z 1
0
Sf ./

˝H.g1 j B; r/

dr > qg
D .Sf /1
f 2 S.T / j
Z 1
0


˝H.g1 j f 1
B

; r/

dr > qg

D .Sf /1
Gg1;H.B; q/

:
The equation ./ derives from the induction hypothesis, and .˚/ from
the deﬁnition of .Sf /./.
2. Because f W P ! Q is a morphism, we obtain from the ﬁrst
part
˝G.I g1 j f 1
B

; q/ D fs 2 S j Gg1;G.f 1
B

; q/ 2 P.s/g
D fs 2 S j .Sf /1Gg1;H.B; q/ 2 P.s/g
D fs 2 S j Gg1;H.B; q/ 2 Q.f .s//g
D f 1
˝H.I g1 j B; q/

:
This shows that the assertion is also true for g D I g1. a
Let us brieﬂy interpret Proposition 4.9.35 in terms of natural transfor-
mations, providing some coalgebraic sfumatura.
Example 4.9.36 We extract in this example the measurable sets A from
a measurable space .S; A/ which serves as a state space for our discus-
sions. Deﬁne T.S/ WD A; then T acts as a contravariant functor from
the category of measurable spaces satisfying the Souslin condition to the
category of sets, where the measurable map f W S ! T is mapped to
Tf W T.T / ! T.S/ by Tf WD f 1.
Fix a game g and a real q 2 Œ0; 1, then ˝G.g j ; q/ W T.S/ ! T.S/
by Proposition 4.9.34, provided S satisﬁes the Souslin condition. Then

4.9. PRODUCT MEASURES
597
˝G.g j ; q/ induces a natural transformation T ! T, because this
diagram commutes by Proposition 4.9.35:
✌
Kripke Generated Frames
A stochastic Kripke frame K D

S; .K/2

is a measurable state
space S, and each primitive game  2  is associated with a stochastic
relation K W S  S; see Example 4.2.7. Morphisms carry over in the
obvious fashion from stochastic relations to stochastic Kripke frames by
applying the deﬁning condition to the stochastic relation associated with
each primitive game; see Sect. 4.1.3.
We associate with K a game frame GK WD

S; .PK /2

. Thus the
transformations associated with games considered above are also appli-
cable to Kripke models. We will discuss this shortly. An application
of Proposition 4.1.24 for each  2  states under which conditions
a game frame is generated by a stochastic Kripke frame. Just for the
record
Proposition 4.9.37 Let G D

S; .P/2

be a game frame. Then
these conditions are equivalent:
1. There exists a stochastic game frame K with G D GK.
2. R.s/ WD fhr; Ai j ˇˇˇA.A;  r/ 2 P.s/g deﬁnes a characteristic
relation on S such that P.s/ ` R.s/ for each state s 2 S;  2
 . a
Let K D .S; .K/2 / be a Kripke frame with associated game frame
GK. K W S  S are Kleisli morphisms; their product—also known as
convolution (see Example 4.9.6)—is deﬁned through
.K1  K2/.s/.A/ WD
Z
S
K2.t/.A/ K1.s/.dt/I
see Example 4.9.6. Intuitively, this gives the probability of reaching a
state in A 2 A, provided we start with game 1 in state s and continue

598
CHAPTER 4. MEASURES FOR PROBABILISTIC SYSTEMS
with game 2, averaging over intermediate states (here 1; 2 2  ). The
observation that composing stochastic relations models the composition
of modalities is one of the cornerstones for the interpretation of modal
logics through Kripke models [Pan09, Dob09].
Let ˝G.A j g; q/ be deﬁned as above when working in the game frame
associated with Kripke frame K. It turns out that ˝G.A j 1I : : : I k; q/
can be described in terms of the Kleisli product for K1; : : : ; Kk, pro-
vided 1; : : : ; k 2  are primitive games.
Proposition 4.9.38 Assume that 1; : : : ; k 2  ; then this equality
holds in the game frame G associated with the Kripke frame K:
˝G.A j 1I : : : k; q/ D fs 2 S j .K1  : : :  Kk/.s/.A/ > qg
for all A 2 A; 0  q < 1.
Proof 1. The proof proceeds by induction on k. If k D 1, we have
s 2 ˝G.A j 1; q/ , ˇˇˇA.A; > q/ 2 PK;1.s/ , K1.s/.A/ > q:
2. Assume that the claim is established for k, and let 0 2  . Then,
borrowing the notation from above,
s 2 ˝G.A j 0I 1I : : : I k; q/
, G1I:::Ik.A; q/ 2 PK;0.s/
, K0.s/ 2 G1I:::Ik.A; q/
,
Z 1
0
K0.s/

˝G.A j 1I : : : I k; r/

dr > q
.
/
,
Z 1
0
K0.s/

ft j .K1  : : :  Kk/.t/.A/ > rg

dr > q
.	/
,
Z
S
.K1  : : :  Kk/.t/.A/ K0.s/.dt/ > q
.k/
, .K0  K1  : : :  Kk/.s/.A/ > q:
Here ./ marks the induction hypothesis, ./ is just the integral repre-
sentation given in Eq. (4.11) in Example 4.9.7, and .k/ is the deﬁnition
of the Kleisli product. This establishes the claim for k C 1. a
We note as a consequence that the respective deﬁnitions of state trans-
formations through the games under consideration coincide for game

4.9. PRODUCT MEASURES
599
frames generated by Kripke frames. On the other hand, it is noted that
the deﬁnition of these transformations for general frames based on effec-
tivity functions extends the one which has been used for Kripke frames
for general modal logics.
Distributivity in the PDL Fragment
The games which are described through the grammar from Example
2.7.4
t WWD  j t1 [ t2 j t1I t2 j t j '‹
with  2  WD  as the set of atomic programs and ' a formula of
the underlying modal logic deﬁne the PDL fragment of game logic. The
corresponding games are called programs for simplicity. We will show
now that in this fragment
˝G. j g1I .g2 [ g3/; / D ˝G. j g1I g2 [ g1I g3/; /
holds, provided frame G is generated by a stochastic Kripke frame K.
Recall that M.S; A/ is the set of -ﬁnite measures on .S; A/ to the
extended nonnegative reals. M.S/ is closed under addition and under
multiplication with nonnegative reals (we omit the -algebra in the se-
quel). The set is also closed under countable sums: Given .n/n2N with
n 2 M.S/, put
P
n2N n

.A/ WD supn2N
P
in i.A/:
Then P
n2N n is monotone and -additive with
P
n2N n

.;/ D 0,
hence a member of M.S/.
Call a map N W S ! M.S/ an extended kernel iff for each A 2 A the
map s 7! N.s/.A/ is measurable with the usual conventions regarding
measurability to the extended reals eR; see Sect. 4.9.1. Extended kernels
are closed under convolution: Put
.N1  N2/.s/.A/ WD
Z
S
N2.t/.A/ N1.s/.dt/I
then N1  N2 is an extended kernel again. This is but the Kleisli com-
position applied to extended kernels. Thus M.S/ is closed under con-
volution which distributes both from the left and from the right under

600
CHAPTER 4. MEASURES FOR PROBABILISTIC SYSTEMS
addition and under scalar multiplication. Note that the countable sum of
extended kernels is an extended kernel as well.
Deﬁne recursively for the stochastic relations in the Kripke frame K
Kg1[g2 WD Kg1 C Kg2;
Kg1Ig2 WD Kg1  Kg2;
Kg WD P
n0 Kgn:
This deﬁnes Kg for each g in the PDL fragment of game logic, similar
to the proposal in [Koz85].
Deﬁne
L.A j g; r/ WD S n ˝G.A j g; r/;
where G is the game frame associated with the Kripke frame K over
state space S; A 2 A is a measurable set; g is a program, i.e., a member
of the PDL fragment; and r 2 Œ0; 1. It is more convenient to work with
these complements, as we will see in a moment.
Lemma 4.9.39 L.A j g; r/ D fs 2 S j Kg.s/.A/  rg holds for all
programs g, all measurable sets A 2 A, and all r 2 Œ0; 1.
Proof 1. The proof is fairly straightforward and proceeds by induction
on g. Assume that g D  2  is a primitive program; then
K.s/.A/  r , K.s/ … ˇˇˇA.A; > r/ , ˇˇˇA.A; > r/ … P.s/
, s … ˝G.A j g; r/:
2. Assume that the assertion is true for g1 and g2; then
L.A j g1 [ g2; r/
D T
ha1;a2i2Q.k/.r/

L.A j g1; a1/ \ L.A j g2; a2/

D T
ha1;a2i2Q.k/.r/

fs j Kg1.s/.A/  a1g \ fs j Kg2.s/.A/  a2g

D fs 2 S j .Kg1 C Kg2/.s/.A/  rg
D fs 2 S j Kg1[g2.s/.A/  rg:
3. The proof for angelic iteration g is very similar, observing that
P
n0 Kgn.s/.A/  r iff there exists a sequence .an/n2N 2 Q.1/.r/
with Kgn.s/.A/  an for all n 2 N.

4.9. PRODUCT MEASURES
601
4. Finally, assume that the assertion is true for program g, and take
 2  . Then, borrowing the notation from (4.14)
Gg.A; r/ … P.s/ , K.s/ … Gg.A; r/
,
Z 1
0
K.s/.˝G.A j g; t// dt  r
.
/
,
Z 1
0
K.s/.fx 2 S j Kg.x/.A/ > tg/ dt  r
.	/
,
Z
S
Kg.t/.A/ K.s/.dt/  r
./
, KIg.s/.A/  r:
Here ./ is the induction hypothesis, ./ derives from Eq. (4.11) in Ex-
ample 4.9.7, and ./ comes from the deﬁnition of the convolution. a
It follows from this representation that for each program g the set L.A j
g; r/ is a measurable subset of S, provided A 2 A. This holds even
without the assumption that the state space S is closed under the Souslin
operation.
Proposition 4.9.40 If games g1; g2; g3 are in the PDL fragment and
the game frame G is generated by a Kripke frame, then
˝G.A j g1I .g2 [ g3/; r/ D ˝G.A j g1I g2 [ g1I g3; r/
(4.15)
˝G.A j .g1 [ g2/I g3; r/ D ˝G.A j g1I g3 [ g2I g3; r/
(4.16)
for all A 2 A; r  0.
Proof Right distributivity (4.16) is a basic assumption, which is given
here for the sake of completeness. It remains to establish left distribu-
tivity (4.15). Here it sufﬁces to prove the equality for the respective
complements. But this is easily established through Lemma 4.9.39 and
the observation that Kg1I.g2[g3/ D Kg1Ig2 C Kg1Ig3 holds, because
integration of nonnegative functions is additive. a
Game Models
We discuss brieﬂy game models, because we need a model for the dis-
cussion of the test operator, which has been delayed so far. A game
model describes the semantics of a game logic, which in turn is a modal

602
CHAPTER 4. MEASURES FOR PROBABILISTIC SYSTEMS
logic where the modalities are given through games. It is deﬁned through
grammar
' D > j p j '1 ^ '2 j hgiq'I
see Example 4.1.11. Here p 2  is an atomic proposition, g is a game,
and q 2 Œ0; 1 is a real number. Intuitively, formula hgiq' is true in state
s if playing game g in state s will result in a state in which formula '
holds with a probability greater than q.
Deﬁnition 4.9.41 A game model G D

.S; A/; .P/2 ; .Vp/p2

over the measurable space S is given by a game frame

.S; A/;
.P/2

and by a family .Vp/p2  A of sets which assigns to each
atomic statement a measurable set of state space S. We denote the un-
derlying game frame by G as well.
Deﬁne the validity sets for each formula recursively as follows:
ŒŒ'G
ŒŒ>G WD S
ŒŒpG WD Vp; if p 2 
ŒŒ'1 ^ '2G WD ŒŒ'1G \ ŒŒ'2G
ŒŒhgiq'G WD ˝G.ŒŒ'G j g; q/:
Accordingly, we say that formula ' holds in state s, in symbols G; s ˆ
', iff s 2 ŒŒ'G.
G; s ˆ '
The deﬁnition of ŒŒhgiq'G has a coalgebraic ﬂavor. Coalgebraic logics
deﬁne the validity of modal formulas through special predicate liftings
associated with the modalities; see Sect. 2.7.3. This connection becomes
manifest through Example 4.9.36 where ˝G. j g; q/ is shown to be a
natural transformation.
Proposition 4.9.42 If state space S is closed under the Souslin op-
eration, ŒŒ'G is a measurable subset for all formulas '. Moreover,
fhs; ri j s 2 ŒŒhgir'Gg 2 A ˝ Œ0; 1:
Proof The proof proceeds by induction on the formula '. If ' D p 2 
is an atomic proposition, then the assertion follows from Vp 2 A. The
straightforward induction step uses Lemma 4.9.30. a
Stochastic Kripke models are deﬁned similarly to game models: K D

.S; A/; .K/2 ; .Vp/p2

is called a stochastic Kripke model iff

.S; A/; .K/2

is a stochastic Kripke frame with Vp 2 A for each
atomic proposition p 2 . The validity of a formula in the state of

4.9. PRODUCT MEASURES
603
a stochastic Kripke model is deﬁned as validity in the associated game
model. Thus we know that for primitive games 1; : : : ; n 2 
s 2 ŒŒh1I : : : I niq'G , K; s ˆ h1I : : : I niq'
,

K1  : : :  Kn

.s/.ŒŒ'K/  q
(4.17)
holds (Proposition 4.9.38) and that games are semantically equivalent to
their distributive counterparts (Proposition 4.9.40).
Let H D

T; .Q/2 ; .Wp/p2

be a second game model; then a
measurable map f W S ! T which is also a frame morphism f W
.S; .P/2 / ! .T; .Q/2 / is called a model morphism f W G !
H iff f 1
Wp

D Vp holds for all atomic propositions, i.e., if f .s/ 2
Model
morphism
Wp iff s 2 Vp always holds. Model morphisms are compatible with
validity.
Proposition 4.9.43 Let ' be a formula of game logic and f W G ! H
be a model morphism. Then
G; s ˆ ' iff H; f .s/ ˆ ':
Proof The claim is equivalent to saying that
ŒŒ'G D f 1
ŒŒ'H

for all formulas '. This is established through induction on the for-
mula '. Because f is a model morphism, the assertion holds for atomic
proposition.
The induction step is established through Proposition
4.9.35. a
We assume from now on that the respective state spaces of our models
are closed under the Souslin operation.
The Test Operator
The test operator '‹ may be incorporated now. Given a formula ', An-
gel may test whether or not the formula is satisﬁed; this yields the two
games '‹ and '¿. Game '‹ checks whether formula ' is satisﬁed in
'‹; '¿
the current state; if it is, Angel continues with the next game; if it is
not, Angel loses. Similarly for '¿, Angel checks whether formula '
is not satisﬁed. Note that we do not have negation in our logic, so we

604
CHAPTER 4. MEASURES FOR PROBABILISTIC SYSTEMS
cannot test directly for :'. We can test, however, whether a state state
s does not satisfy a formula ' by evaluating s 2 S n ŒŒ'G, since com-
plementation is available in the underlying -algebra. So we actually
extend our considerations by incorporating two test operators, but talk
for convenience usually about “the” test operator.
In order to seamlessly integrate these testing games into our models,
we deﬁne for each formula two effectivity functions for positive and
for negative testing, resp. The following technical observations will be
helpful. It helps transporting stochastic effectivity functions along mea-
surable maps.
Lemma 4.9.44 Let P be a stochastic effectivity function on S, and as-
sume that F W S.S/ ! S.S/ is measurable; then P 0.s/ WD fW 2
}}}.S/ j F 1
W

2 P.s/g deﬁnes a stochastic effectivity function on S.
Proof P 0.s/ is upper closed, since P.s/ is, so t-measurability has to
be established. Let H 2 }}}.S/ ˝ B.Œ0; 1/ be a test set; then H q 2
P 0.s/ ,

.F  idŒ0;1/1
H
q 2 P.s/: Since F is measurable, F 
idŒ0;1 W S.S/Œ0; 1 ! S.S/Œ0; 1 is; hence .F  idŒ0;1/1
H

is a
member of }}}.S/ ˝ B.Œ0; 1/: Because P is t-measurable, we conclude
fhs; qi j H q 2 P 0.s/g 2 A ˝ Œ0; 1: a
Lemma 4.9.45 Deﬁne for A 2 A,  2 S.S/, and B 2 A the local-
ization to A as FA./.B/ WD .A \ B/: Then FA W S.S/ ! S.S/ is
Localization
measurable.
Proof This follows from F 1
A

ˇˇˇA.C; ‰ q/

D ˇˇˇA.A \ C; ‰ q/:
a
FA localizes measures to the set A, because everything outside A is
discarded. Now deﬁne for state s and formula '
P'‹.s/ WD fW 2 }}}.S/ j F 1
ŒŒ'G

W

2 ID.s/g;
P'¿.s/ WD fW 2 }}}.S/ j F 1
SnŒŒ'G

W

2 ID.s/g;
where ID is the Dirac function deﬁned in Example 4.1.18. Let us decode
the deﬁnition for ŒŒ'G. We have W 2 P'‹.s/ iff ıs 2 F 1
ŒŒ'G

W

and
thus iff FŒŒ'G.ıs/ 2 W . Specializing to W D ˇˇˇA.A; > q/ translates the
latter condition to FŒŒ'G.ıs/.A/ > q and hence to ıs.ŒŒ'G \ A/ > q,

4.9. PRODUCT MEASURES
605
which in turn is equivalent to G; s ˆ ' and s 2 A. Thus we see
ˇˇˇA.A; > q/ 2 P'‹.s/ , G; s ˆ ' and s 2 A;
ˇˇˇA.A; > q/ 2 P'¿.s/ , G; s 6ˆ ' and s 2 A;
the argument for P'¿ being completely analogous. We obtain
Proposition 4.9.46 P'‹ and P'¿ deﬁne a stochastic effectivity function
for each formula '.
Proof From Proposition 4.9.42, we infer that ŒŒ'G 2 A; consequently,
FŒŒ'G and FSnŒŒ'G are measurable functions S.S/ ! S.S/ by Lemma
4.9.45. Thus the assertion follows from Lemma 4.9.44. a
Given a stochastic Kripke model, test operators may be deﬁned as well;
they serve also for the integration of the test operators into PDL in a
similar way. The deﬁnitions for the associated stochastic relations K'‹ W
S  S and K'¿ W S  S read
K'‹.s/ WD FŒŒ'G.D.s//;
K'¿.s/ WD FSnŒŒ'G.D.s//:
These relations can be deﬁned for formulas of game logic as well, when
they are interpreted through a Kripke model. Thus we have, e.g.,
K'‹.s/.B/ D
(
1;
if s 2 B and G; s ˆ '
0;
otherwise:
This is but a special case, since P'‹ and P'¿ are generated by these
stochastic relations.
Lemma 4.9.47 Let ' be a formula of game logic; then P'‹ D PK'‹
and P'¿ D PK'¿:
Proof The assertions follow from expanding the deﬁnitions. a
This extension integrates well into the scenario, because it is compat-
ible with morphisms. We will establish this now. Because a model
morphism is given by a morphism for the underlying game frame and
a morphism for game frames is determined by morphisms for the un-
derlying effectivity functions, it is enough to show that a morphism
f W P ! Q for all  2  is also a morphism f W P'‹ ! Q'‹
for all formulas ', similarly for '¿.

606
CHAPTER 4. MEASURES FOR PROBABILISTIC SYSTEMS
Proposition 4.9.48 Let G and H be game models over state spaces S
and T , resp. Assume that f W G ! H is a morphism of game models;
deﬁne for each formula ' the effectivity functions P'‹ and P'¿ for G
resp. Q'‹ and Q'¿ for H. Then f is a morphism P'‹ ! Q'‹ and
P'¿ ! Q'¿ for each formula '.
Proof 0. Fix formula '; we will prove the assertion only for '‹, and the
proof for '¿ is the same. The notation is fairly overloaded. We will use
primed quantities when referring to H and state space T and unprimed
ones when referring to model G with state space S.
The plan for the proof is as follows: We ﬁrst show that Sf transforms
The plan
F'‹ıD into F 0
'‹ıD0; here we use the assumption that f is a morphism,
so the validity sets are respects by the inverse image of f . But once we
have shown this, the proof proper is just a matter of showing that the
corresponding diagram commutes by comparing E.f /.P'‹.s// against
Q'‹.f .s//.
Note ﬁrst that S.f /.F'‹.D.s/// D F 0
'‹.D0.f .s///; because we have
for each G 2 B
Sf

F'‹.D.s//

.G/
D F'‹.D.s//.f 1
G

/
D D.s/

ŒŒ'G \ f 1
G

.
/
D D.s/

f 1
ŒŒ'H

\ f 1
G

D D0.f .s//

ŒŒ'H \ G

D F 0
'‹

D0.f .s//

.G/:
We have used f 1
ŒŒ'H

D ŒŒ'G in (), since f is a morphism; see
Proposition 4.9.43. But now we may conclude
W 2 E.f /.P'‹.s// , Sf .F'‹.D.s/// 2 W , F 0
'‹.D0.f .s/// 2 W
, W 2 Q'‹.f .s//I
hence E.f / ı P'‹ D Q'‹ ı f is established. a
Example 4.9.49 We compute ŒŒhp‹I giq'G and ŒŒhp¿I giq'G for a
primitive formula p 2  and an arbitrary game g for the sake of il-
lustration.
First a technical remark: Let  be Lebesgue measure on the unit interval;
then
G; s ˆ hgiq' , .fr 2 Œ0; 1 j G; s ˆ hgir'g/ > q:
(4.18)

4.9. PRODUCT MEASURES
607
In fact, the map r 7! ŒŒhgir'G is monotone and decreasing; this is
intuitively clear: If Angel will have a strategy for reaching a state in
which formula ' holds with probability at least q > q0, it will have a
strategy for reaching such a state with probability at least q0. But this
entails that the set fr 2 Œ0; 1 j G; s ˆ hgir'g constitutes an interval
which contains 0 if it is not empty. This interval is longer than q (i.e.,
its Lebesgue measure is greater than q) iff q is contained in it. From
this (4.18) follows.
Now assume G; s ˆ hp‹I giq'. Thus
Gg.ŒŒ'G; q/ 2 Pp‹.s/ , FVp.D.s// 2 Gg.ŒŒ'G; q/
,
Z 1
0
D.s/.Vp \ ŒŒhgir'G/ dr > q;
which means
D.s/.Vp/ 
Z 1
0
D.s/.ŒŒhgir'G/ dr > q:
This implies
D.s/.Vp/ D 1 and
Z 1
0
D.s/.ŒŒhgir'G/ dr > q;
the latter integral being equal to .fr 2 Œ0; 1 j G; s ˆ hgir'g/: Hence
by (4.18) it follows that G; s ˆ hgiq'. Thus we have found
G; s ˆ hp‹I giq' , G; s ˆ p ^ hgiq':
Replacing in the above argumentation Vp by S n Vp, we see that G; s ˆ
hp¿I giq' is equivalent to
D.s/.S n Vp/ D 1 and
Z 1
0
D.s/.ŒŒhgir'G/ dr > q:
Because we do not have negation in our logic, we obtain
G; s ˆ hp¿I giq' , G; s 6ˆ p and G; s ˆ hgiq':
✌
We leave this logic now and return to the discussion of topological prop-
erties of the space of all ﬁnite measures.

608
CHAPTER 4. MEASURES FOR PROBABILISTIC SYSTEMS
4.10
The Weak Topology
We will look again at topological issues for the space of ﬁnite mea-
sures. Because we have integration now at our disposal, we can use
it for additional characterizations. We ﬁx in this section .X; d/ as a
metric space. Recall that C.X/ is the space of all bounded continuous
functions X ! R. This space induces the weak topology on the space
M.X/ D M.X; B.X// of all ﬁnite Borel measures on .X; B.X//. This
is the smallest topology which renders the evaluation map
evf W  7!
Z
X
f d
continuous for every continuous and bounded map f W X ! R, i.e.,
the initial topology with respect to .evf /f 2C.X/; see Deﬁnition 3.1.14.
This topology is fairly natural, and it is related to the topologies on
M.X/ considered so far, the Alexandrov topology, and the topology
given by the Levy–Prokhorov metric, which are discussed in Sect. 4.1.4.
We will show that these topologies are the same, provided the under-
lying space is Polish, and we will demonstrate that M.X/ is a Polish
space itself for this case. Somewhat weaker results may be obtained if
the base space is only separable metric, and it turns out that tightness,
i.e., inner approximability through compact sets, is the property which
sets Polish spaces apart. We introduce also a very handy metric for the
weak topology due to Hutchinson. Two case studies on bisimulations
of Markov transition systems and on quotients for stochastic relations
demonstrate the interplay of topological considerations with selection
arguments, which become available on M.X/ once this space is identi-
ﬁed as Polish.
Deﬁne as the basis for the topology the sets
Uf1;:::;fn;./ WD f 2 M.X/ j
ˇˇR
X fi d 
R
X fi d
ˇˇ <  for 1  i  ng
with  > 0 and f1; : : : ; fn 2 C.X/. Call the topology the weak topology
on M.X/.
With respect to convergence, we have this characterization, which indi-
cates the relationship between the weak topology and the Alexandrov
topology investigated in Sect. 4.1.4.
Theorem 4.10.1 The following statements are equivalent for a sequence
.n/n2N  M.X/:

4.10. THE WEAK TOPOLOGY
609
1. n !  in the weak topology.
2.
R
X f dn !
R
X f d for all f 2 C.X/.
3.
R
X f dn !
R
X f d for all bounded and uniformly continuous
f W X ! R.
4. n !  in the A-topology.
Proof The implications 1 ) 2 and 2 ) 3 are trivial.
3 )
4: Let G  X be open, then fk.x/ WD 1 ^ k  d.x; X n G/
deﬁnes a uniformly continuous map, and 0  f1  f2  : : : with
limk!1 fk D G. Hence
R
X fk d 
R
X G d D .G/, and by
monotone convergence
R
X fk d ! .G/. From the assumption we
know that
R
X fk dn !
R
X fk d, as n ! 1, so that we obtain for
all k 2 N
lim
n!1
Z
X
fk dn  lim inf
n!1 n.G/;
which in turn implies .G/  lim infn!1 n.G/:
4 ) 2 We may assume that f  0, because the integral is linear. By
Example 4.9.7, Eq. (4.11), we can represent the integral through
Z
X
f d D
Z 1
0
.fx 2 X j f .x/ > tg/ dt:
Since f is continuous, the set fx 2 X j f .x/ > tg is open. By Fatou’s
Lemma (Proposition 4.8.5), we obtain from the assumption
lim inf
n!1
Z
X
f dn D lim inf
n!1
Z 1
0
n.fx 2 X j f .x/ > tg/ dt

Z 1
0
lim inf
n!1 n.fx 2 X j f .x/ > tg/ dt

Z 1
0
.fx 2 X j f .x/ > tg/ dt
D
Z
X
f d:
Because f  0 is bounded, we ﬁnd T 2 R such that f .x/  T for all
x 2 X; hence g.x/ WD T  f .x/ deﬁnes a nonnegative and bounded

610
CHAPTER 4. MEASURES FOR PROBABILISTIC SYSTEMS
function. Then by the preceding argument lim infn!1
R
X g dn 
R
X g d: Since n.X/ ! .X/, we infer
lim sup
n!1
Z
X
f dn 
Z
X
f d;
which implies the desired equality. a
Let X be separable; then the A-topology is metrized by the Prohorov
metric (Theorem 4.1.49).
Thus we have established that the metric
topology and the topology of weak convergence are the same for sepa-
rable metric spaces. Just for the record
Theorem 4.10.2 Let X be a separable metric space, then the Prohorov
metric is a metric for the topology of weak convergence. a
It is now easy to ﬁnd a dense subset in M.X/. As one might expect, the
measures living on discrete subsets are dense. Before stating and prov-
ing the corresponding statement, we have a brief look at the embedding
of X into M.X/.
Example 4.10.3 The base space X is embedded into M.X/ as a closed
subset through x 7! ıx. In fact, let .ıxn/n2N be a sequence which con-
verges weakly to  2 M.X/. We have in particular .X/ D limn!1
ıxn.X/ D 1; hence  2 P .X/. Now assume that .xn/n2N does not
converge; hence it does not have a convergent subsequence in X. Then
the set S WD fxn j n 2 Ng is closed in X, so are all subsets of S.
Take an inﬁnite subset C  S with an inﬁnite complement S n C;
then .C/  lim supn!1 ıxn.C/ D 1, and with the same argument,
.S n C/ D 1. This contradicts .X/ D 1. Thus we can ﬁnd x 2 X
with xn ! x; hence ıxn ! ıx, so that the image of X in M.X/ is
closed. ✌
This is what one would expect: The discrete measures form a dense set
in the topology of weak convergence.
Proposition 4.10.4 Let X be a separable metric space. The set
˚P
k2N rk  ıxk j xk 2 X; rk  0

of discrete measures is dense in the topology of weak convergence.
Proof 0. The plan for the proof goes like this: We cover the space with
Plan for the
proof
Borel sets of small diameter, and then take a uniformly continuous func-
tion as a witness. Uniform continuity then makes for uniform deviations
on these sets, which establishes the claim.

4.10. THE WEAK TOPOLOGY
611
1. Fix 2M.X/. Cover X for each k 2 N with open sets .Gn;k/n2N,
each of which has a diameter not less than 1=k. Convert the cover
through the ﬁrst entrance trick to a cover of mutually disjoint Borel sets
An;k  Gn;k, eliminating all empty sets arising from this process. Se-
lect an arbitrary xn;k 2 An;k. We claim that
n WD
X
k2N
.An;k/  ıxn;k
converges weakly to .
2. In fact, let f W X ! R be a uniformly continuous and bounded map.
Since f is uniformly continuous,
n WD sup
k2N

sup
x2An;k
f .x/ 
inf
x2An;k
f .x/

tends to 0, as n ! 1. Thus
ˇˇˇˇ
Z
X
f dn 
Z
X
f d
ˇˇˇˇ D
ˇˇX
k2N
Z
An;k
f dn 
Z
An;k
f d
ˇˇ
 n 
X
k2N
.An;k/
 n  .X/
! 0:
This establishes the claim and proves the assertion. a
We may arrange the cover in the proof in such a way that the points are
taken from a dense set. Hence we obtain immediately
Corollary 4.10.5 If X is a separable metric space, then M.X/ is a sep-
arable metric space in the topology of weak convergence.
Proof Because Pn
kD1 rk ıxk ! P
k2N rk ıxk; as n ! 1 in the weak
topology and because the rationals Q are dense in the reals, we obtain
from Proposition 4.10.4 that
˚Pn
kD1 rk ıxk j xk 2 D; 0  rk 2 Q; n 2
N

is a countable and dense subset of M.X/, whenever D  X is a
countable and dense subset of X. a
Another immediate consequence refers to the weak -algebra. We ob-
tain from Lemma 4.1.50 together with Corollary 4.10.5
Corollary 4.10.6 Let X be a metric space, then the weak -algebra is
the Borel sets of the A-topology. a

612
CHAPTER 4. MEASURES FOR PROBABILISTIC SYSTEMS
We will show now that M.X/ is a Polish space, provided X is one; thus
applying the M-functor to a Polish space does not leave the realm of
Polish spaces.
We know from Alexandrov’s Theorem 4.3.27 that a separable metriz-
able space is Polish iff it can be embedded as a Gı-set into the Hilbert
cube. We show ﬁrst that for compact metric X, the space S.X/ of all
subprobability measures with the topology of weak convergence is itself
a compact metric space. This is established by embedding it as a closed
subspace into Œ1; C11. But there is nothing special about taking S;
the important property is that all measures are uniformly bounded (by 1,
in this case). Any other bound would also do.
We require for this the Stone–Weierstraß Theorem, which implies that
the unit ball in the space of all bounded continuous functions on a com-
pact metric space is separable itself (Corollary 3.6.46). The idea of
the embedding is to take a countable dense sequence .gn/n2N of this
unit ball. Since we are dealing with probability measures and since
we know that each gn maps X into the interval Œ1; 1, we know that
1 
R
X gn d  1 for each . This then spawns the desired map,
which, together with its inverse, is shown to be continuous through the
Riesz Representation Theorem 4.8.20.
Well, this is the plan of attack for establishing
Proposition 4.10.7 Let X be a compact metric space. Then S.X/ is a
compact metric space.
Proof 1. The space C.X/ of continuous maps into the reals is for com-
pact metric X a separable Banach space under the sup-norm k  k1 by
Corollary 3.6.46. The closed unit ball
C1 WD ff 2 C.X/ j kf k1  1g
is a separable metric space in its own right, because it is Polish by The-
orem 4.3.26. Let .gn/n2N be a countable sense subset in C1, and de-
ﬁne
˝ W S.X/ 3  7! h
R
X g1 d;
R
X g2 d; : : :i 2 Œ1; 11:
Then ˝ is injective, because the sequence .gn/n2N is dense.

4.10. THE WEAK TOPOLOGY
613
2. Also, ˝1 is continuous. In fact, let .n/n2N be a sequence in S.X/
such that

˝.n/

n2N converges in Œ1; 11I put ˛i WD limn!1
R
X
gi dn: For each f 2 C1, there exists a subsequence .gnk/k2N such
that kf  gnkk1 ! 0 as k ! 1; because .gn/n2N is dense in C1.
Thus
L.f / WD lim
n!1
Z
X
f dn
exists. Deﬁne L.˛  f / WD ˛  L.f /; for ˛ 2 R; then it is immediate
that L W C.X/ ! R is linear and that L.f /  0, provided f  0. The
Riesz Representation Theorem 4.8.20 now gives a unique  2 S.X/
with
L.f / D
Z
X
f d;
and the construction shows that
lim
n!1 ˝.n/ D h
Z
X
g1 d;
Z
X
g2 d; : : :i:
3. Consequently, ˝ W S.X/ ! ˝

S.X/

is a homeomorphism, and
˝

S.X/

is closed, hence compact. Thus S.X/ is compact. a
We obtain as a ﬁrst consequence
Proposition 4.10.8 X is compact iff S.X/ is, whenever X is a Polish
space.
Proof It remains to show that X is compact, provided S.X/ is. Choose a
complete metric d for X. Thus X is isometrically embedded into S.X/
by x 7! ıx with A WD fıx j x 2 Xg being closed. We could appeal
to Example 4.10.3, but a direct argument is available as well. In fact, if
ıxn !  in the weak topology, then .xn/n2N is a Cauchy sequence in X
on account of the isometry. Since .X; d/ is complete, xn ! x for some
x 2 X, hence  D ıx, and thus A is closed, hence compact. a
The next step for showing that M.X/ is Polish is nearly canonical. If
X is a Polish space, it may be embedded as a Gı-set into a compact
space QX, the subprobabilities of which are topologically a closed subset
of Œ1; C11, as we have just seen. We will show now that M.X/ is a
Gı in M. QX/ as well.
Proposition 4.10.9 Let X be a Polish space. Then M.X/ is a Polish
space in the topology of weak convergence.

614
CHAPTER 4. MEASURES FOR PROBABILISTIC SYSTEMS
Proof 1. Embed X as a Gı-subset into a compact metric space QX; hence
X 2 B. QX/. Put
M0 WD f 2 M. QX/ j . QX n X/ D 0g;
so M0 contains exactly those ﬁnite measures on QX that are concentrated
on X. Then M0 is homeomorphic to M.X/.
2. Write X as X D T
n2N Gn, where .Gn/n2N is a sequence of open
sets in QX. Given r > 0, the set
k;r WD f 2 M. QX/ j . QX n Gk/ < rg
is open in M. QX/. In fact, if n … k;r converges to 0 in the weak
topology, then
0. QX n Gk/  lim sup
n!1
n. QX n Gk/  r
by Theorem 4.10.1, since QX n Gk is closed. Consequently, 0 … k;r:
This shows that k;r is open, because its complement is closed. Thus
M0 D
\
n2N
\
k2N
n;1=k
is a Gı-set, and the assertion follows. a
Thus we obtain as a consequence
Proposition 4.10.10 M.X/ is a Polish space in the topology of weak
convergence iff X is.
Proof Let M.X/ be Polish. The base space X is embedded into M.X/
as a closed subset by Example 4.10.3; hence is a Polish space by Theo-
rem 4.3.26. a
Let  2 M.X/ with X Polish. Since X has a countable basis, we
know from Lemma 4.1.46 that  is supported by a closed set, since 
is -regular. But in the presence of a complete metric, we can say a bit
more, viz., that the value of .A/ may be approximated from within by
compact sets to arbitrary precision.
Deﬁnition 4.10.11 A ﬁnite Borel measure  is called tight iff
.A/ D supf.K/ j K  A compactg
holds for all A 2 B.X/.

4.10. THE WEAK TOPOLOGY
615
Thus tightness means for  that we can ﬁnd for any  > 0 and for any
Borel set A  X a compact set K  A with .A n K/ < . Because a
ﬁnite measure on a separable metric space is regular, i.e., .A/ can be
approximated from within A by closed sets (Lemma 4.6.13), it sufﬁces
in this case to consider tightness at X and hence to postulate that there
exists for any  > 0 a compact set K  X with .X n K/ < . We
know in addition that each ﬁnite measure is -regular by Lemma 4.1.45;
hence the union of a directed family of open sets has the supremum of
these open sets as its measure. Capitalizing on this and on completeness,
we ﬁnd
Proposition 4.10.12 Each ﬁnite Borel measure on a Polish space X is
tight.
We cover the space with open sets which are constructed as the open
Line of
attack
neighborhood of ﬁnite sets. From this a directed cover of open sets is
easily constructed, and since we know that the measure is -regular,
we extract suitable ﬁnite sets, from which a compact set is manufac-
tured. This set is then shown to be suitable for our purposes. The im-
portant property here is -regularity and the observation that a complete
bounded set in a metric space is compact.
Proof 1. We show ﬁrst that we can ﬁnd for each  > 0 a compact
set K  X with .X n K/ < . In fact, given a complete metric d,
consider
G WD
˚
fx 2 X j d.x; M/ < 1=ng j M  X is ﬁnite

:
Then G is a directed collection of open sets with S G D X; thus we
know from -regularity of  that .X/ D supf.G/ j G 2 Gg. Conse-
quently, given  > 0, there exists for each n 2 N a ﬁnite set Mn  X
with .fx 2 X j d.x; Mn/ < 1=ng/ > .X/  =2n. Now deﬁne
K WD T
n2Nfx 2 X j d.x; Mn/  1=ng:
Then K is closed and complete (since .X; d/ is complete). Because
each Mn is ﬁnite, K is totally bounded. Thus K is compact by Theo-
rem 3.5.32. We obtain
.X n K/ 
X
n2N
.fx 2 X j d.x; Mn/  1=ng/ 
X
n2N
  2n D :
2. Now let A 2 B.X/, then for  > 0 there exists F  A closed with
.A n F / < =2, and choose K  X compact with .X n K/ < =2.
Then K \ F  A is compact with .A n .F \ K// < . a

616
CHAPTER 4. MEASURES FOR PROBABILISTIC SYSTEMS
Tightness is sometimes an essential ingredient when arguing about mea-
sures on a Polish space. The discussion on the Hutchinson metric in the
next section provides an example; it shows that at a crucial point tight-
ness kicks in and saves the day.
4.10.1
The Hutchinson Metric
We will explore now another approach to the weak topology for Polish
spaces through the Hutchinson metric. Given a ﬁxed metric d on X and
a ﬁxed real  > 0, deﬁne
V WD ff W X ! R j jf .x/  f .y/j  d.x; y/ and jf .x/j   for all x; y 2 Xg:
Thus f is a member of V iff f is non-expanding (hence has a Lipschitz
constant 1) and iff its supremum norm kf k1 is bounded by . Trivially,
all elements of V are uniformly continuous. Note the explicit depen-
dence of the elements of V on the metric d. The Hutchinson distance
H.; / between ;  2 M.X/ is deﬁned as
H.; / WD sup
f 2V
Z
X
f d 
Z
X
f d

:
Then H is easily seen to be a metric on M.X/. H is called the
Hutchinson metric (sometimes also Hutchinson–Monge–Kantorovicz
metric).
The relationship between this metric and the topology of weak con-
vergence is stated in Proposition 4.10.13, the proof of which follows
[Edg98, Theorem 2.5.17]. The program goes as follows. We ﬁrst show
Discussion
and plan
that convergence in the Hutchinson metric implies convergence in the
weak topology. This is a straightforward approximation argument on
closed sets through suitable continuous functions. The converse is more
complicated and relies on tightness. We ﬁnd for the target measure 
of a converging sequence a good approximating compact set, which can
be covered by a ﬁnite number of open sets, the boundaries of which
vanish for . From this we construct a suitable approximation in the
Hutchinson metric; clearly, uniform boundedness will be used heavily
here.
Proposition 4.10.13 Let X be a Polish space. Then H is a metric for
the topology of weak convergence on M.X/ for any  > 0.

4.10. THE WEAK TOPOLOGY
617
Proof 1. We may and do assume that  D 1; otherwise we scale ac-
cordingly. Now let H1.n; / ! 0 as n ! 1; then limn!1 n
.X/ D .X/. Let F  X be closed; then we can ﬁnd for given
 > 0 a function f
2 V1 such that f .x/ D 1 for x 2 F , and
R
X f dm  .F / C . This gives
lim sup
n!1
n.F /  lim
n!1
Z
X
f dn D
Z
X
f d  .F / C :
Thus convergence in the Hutchinson metric implies convergence in the
A-topology and hence in the topology of weak convergence, by Propo-
sition 4.1.35.
2. Now assume that n !  in the topology of weak convergence; thus
n.A/ ! .A/ for all A 2 B.X/ with .@A/ D 0 by Corollary 4.1.36;
we assume that n and  are probability measures; otherwise we scale
again. Because X is Polish,  is tight by Proposition 4.10.12.
Fix  > 0; then there exists a compact set K  X with
.X n K/ <

5   :
Given x 2 K, there exists an open ball Br.x/ with center x and radius r
such that 0 < r < =10 such that .@Br.x// D 0; see Corollary 4.1.39.
Because K is compact, a ﬁnite number of these balls will sufﬁce; thus
K  Br1.x1/ [ : : : [ Brp.xp/. Transform this cover into a disjoint
cover by setting
E1 WD Br1.x1/;
E2 WD Br2.x2/ n E1;
: : :
Ep WD Brp.xp/ n .E1 [ : : : [ Ep1/;
E0 WD S n .E1 [ : : : [ Ep/:
We observe these properties:
1. For i D 1; : : : ; p, the diameter of each Ei is not greater than 2ri,
hence smaller than =5,
2. For i D 1; : : : ; p, @Ei  @

Br1.x1/[: : :[Brp.xp/

, thus @Ei 
.@Br1.x1// [ : : : [ .@Brp.xp//, and hence .@Ei/ D 0.

618
CHAPTER 4. MEASURES FOR PROBABILISTIC SYSTEMS
3. Because the boundary of a set is also the boundary of its com-
plement, we conclude .@E0/ D 0 as well. Moreover, .E0/ <
=.5  /, since E0  X n K.
Eliminate all Ei which are empty. Select  > 0 such that p   < =5,
and determine n0 2 N so that jn.Ei/  .Ei/j <  for i D 0; : : : ; p
and n  n0.
We have to show that
sup
f 2V
Z
X
f dn 
Z
X
f d

! 0; as n ! 1:
So take f 2 V and ﬁx n  n0. Let i D 1; : : : ; p, and pick an arbitrary
ei 2 Ei; because each Ei has a diameter not greater than =5, we know
that jf .x/  f .ei/j < =5 for each x 2 Ei. If x 2 E0, we have
jf .x/j  . Now we are getting somewhere: Let n  n0; then we
obtain
Z
X
f dn D
p
X
iD0
Z
Ei
f dn
   n.E0/ C
p
X
iD1

f .ti/ C 
5

 n.Ei/
   ..E0/ C / C
p
X
iD1

f .ti/ C 
5

 ..Ei/ C /
   . 
5   C / C
p
X
iD1
.f .ti/  
5/  .Ei/
C 2  
5
p
X
iD1
.Ei/ C p    
5

Z
X
f d C :
Recall that
p
X
iD1
.Ei/ 
p
X
iD0
.Ei/ D .X/ D 1
and that
Z
Ei
f d  .Ei/  .f .ti/  =5/:

4.10. THE WEAK TOPOLOGY
619
In a similar fashion, we obtain
R
X f dn 
R
X f d  , so that we
have established
j
Z
X
f d 
Z
X
f dnj < 
for n  n0. Since f 2 V was arbitrary, we have shown that H
.n; / ! 0. a
The Hutchinson metric is occasionally easier to use than the Prohorov
metric, because integrals may sometimes be easily manipulated in con-
vergence arguments than -neighborhoods of sets.
4.10.2
Case Study: Eilenberg–Moore Algebras for the Giry
Monad
We will study the Eilenberg–Moore algebras for the Giry monad again,
but this time for the non-discrete case. Theorem 2.5.23 contains a com-
plete characterization of these algebras for the discrete probability func-
tor D as the positive convex structures on X. We will derive a com-
plete characterization for the probability functor on Polish spaces from
this.
We work in the category of Polish spaces with continuous maps as mor-
phisms and the Borel sets as the -algebra. The Giry monad .P; e; m/
is introduced in Example 2.4.8; its functorial part is the subprobability
functor P, and the unit e and the multiplication m are for a Polish space
X deﬁned through
eX.x/ WD ıx;
mX.M/.A/ WD
Z
X
#.A/ M.d#/
for x 2 X, M 2 P2X, and A 2 B.X/. An Eilenberg–Moore algebra
h W PX ! X is a morphism so that these diagrams from page 189
commute
We note ﬁrst that unit and multiplication of the monad are compatible
with the weak topology.

620
CHAPTER 4. MEASURES FOR PROBABILISTIC SYSTEMS
Lemma 4.10.14 Given a Polish space X, the unit eX W X ! PX and
the multiplication mX W P2X ! PX are continuous in the respective
weak topologies.
Proof We know this already from Lemma 4.1.42 for the unit, so we
have to establish the claim for the multiplication. Let M 2 P2.X/ and
f 2 C.X/ be a bounded continuous function; then
Z
X
f dmX.M/ D
Z
PX
Z
X
f d#

dM.#/
(4.19)
holds. Granted that we have shown this, we argue then as follows: By
the deﬁnition of the weak convergence on PX, the map Ef W # 7!
R
X f d# is continuous, whenever f 2 C.X/; thus M 7!
R
PX Ef dM
is continuous by the deﬁnition of the weak topology on P2X. But this
is just mX.
So it remains to establish Eq. (4.19). If f D A for A 2 B.X/, this
is just the deﬁnition of mX, so the equation holds in this case. Since
the integral is linear, Eq. (4.19) holds for bounded step functions f . If
f  0 is bounded and measurable, Levi’s Theorem 4.8.2 in combination
with Lebesgue’s Dominated Convergence Theorem 4.8.6 shows that the
equation holds. The general case now follows from decomposing f D
f C  f  with f C  0 and f   0. a
Now ﬁx a Polish space X and a complete metric d; the Hutchinson
metric H for some  > 0 is assumed as a metric for the topology of
weak convergence; see Proposition 4.10.13. Put as in Sect. 2.5.2
˝ WD fh˛1; : : : ; ˛ki j k 2 N; ˛i  0; Pk
iD1 ˛i  1g:
Given an Eilenberg–Moore algebra hX; hi for P, deﬁne for ˛ D h˛1; : : : ;
˛ni 2 ˝ the map
h˛1; : : : ; ˛nih.x1; : : : ; xn/ WD h
Pn
iD1 ˛i  ıxi

:
Then the lengthy computation in Lemma 2.5.20 shows that ˛ 7! ˛h
deﬁnes a positive convex structure. Let, conversely, a positive convex
structure p be given; then Lemma 2.5.21 shows that
hp
Pn
iD1 ˛i  ıxi

WD Pp
1in ˛i  xi
for h˛1; : : : ; ˛ni 2 ˝, and x1; : : : ; xn 2 X deﬁnes an algebra hp for
the discrete probability functor DX. Since the discrete probability mea-
sures are dense in PX by Proposition 4.10.4, we look for a continuous

4.10. THE WEAK TOPOLOGY
621
extension from DX to PX. In fact, this is possible provided p is regular
in the following sense:
Deﬁnition 4.10.15 The positive convex structure p is said to be regular
iff the oscillation øhp./ vanishes for every  2 PX.
Thus we measure the oscillation
øhp./ D inf
˚
diam

hp

DX \ B.; r/

j r > 0

for hp at every probability measure  2 PX with B.; r/ as the ball at
center  and radius r for the Hutchinson metric H. The oscillation of
a function is discussed on page 345. Thus p is regular iff we know for
all  2 PX that, given  > 0, there exists r > 0 such that
d
Pp
1in ˛i  xi; Pp
1im ˇj  yj

< ;
whenever
ˇˇPn
iD1 ˛i f .xi/
R
X f d
ˇˇ < r and
ˇˇPm
jD1 ˇi f .yi/
R
X f d
ˇˇ < r
for all f 2 V.
This gives the following characterization of the Eilenberg–Moore alge-
bras
for
the
non-discrete
case,
generalizing
the
“discrete”
Theorem 2.5.23 to the non-discrete case.
Theorem 4.10.16 The Eilenberg–Moore algebras for the Giry monad
for Polish spaces are exactly the regular positive convex structures.
Complete
characteriza-
tion
Proof 1. Let hX; hi be an Eilenberg–Moore algebra; then h W PX ! X
is continuous, and hence the restriction of h to DX has oscillation 0 at
each  2 PX. But this means that the corresponding positive convex
structure is regular.
2. Conversely, given a regular positive convex structure p, the associated
map hp W DX ! X has oscillation zero at each  2 PX. Thus there
exists a unique continuous extension h0
p W PX ! X by Lemma 3.5.24.
It remains to show that h0
p satisﬁes the laws of an Eilenberg–Moore al-
gebra. This follows easily from Lemma 4.10.14, since hp satisﬁes the
corresponding equations. a
We now have a complete characterization of the Eilenberg–Moore alge-
bras for the probability monad over Polish spaces. This closes the gap
we had to leave in Sect. 2.5.2 because we did not yet have the neces-
sary tools at our disposal. It displays an interesting cooperation between
arguments from categories, topology, and measure theory.

622
CHAPTER 4. MEASURES FOR PROBABILISTIC SYSTEMS
4.10.3
Case Study: Bisimulation
Bisimilarity is an important notion in the theory of concurrent systems,
introduced originally by Milner for transition systems; see Sect. 2.6.1
for a general discussion. We will show in this section that the methods
developed so far may be used in the investigation of bisimilarity for
stochastic systems. We will ﬁrst show that the category of stochastic
relations has semi-pullbacks and use this information for a construction
of bisimulations for these systems.
If we are in a general category K, then the semi-pullback for two mor-
phisms f W a ! c and g W b ! c with common range c consists of
an object x and of morphisms pa W x ! a and pb W x ! b such that
f ı pa D g ı pb, i.e., such that this diagram commutes in K:
We want to show that semi-pullbacks exist for stochastic relations over
Polish spaces. This requires some preparations, provided through selec-
tion arguments.
The next statement appears to be interesting in its own right; it shows
that a measurable selection for weakly continuous stochastic relations
exist.
Proposition 4.10.17 Let Xi, Yi be Polish spaces, Ki W Xi  Yi be a
weakly continuous stochastic relation, and i D 1; 2. Let A  X1  X2
and B  Y1 Y2 be closed subsets of the respective Cartesian products
with projections equal to the base spaces, and assume that for hx1; x2i 2
A the set
 .x1; x2/ WD f  2 S.B/ j S.ˇi/./ D Ki.xi/; i D 1; 2 g
is not empty, ˇi W B ! Yi denoting the projections. Then there exists a
stochastic relation M W A  B such that M.x1; x2/ 2  .x1; x2/ for
all hx1; x2i 2 A.
Let us have a look at the ﬂow of the proof, before diving into it. It pro-
Outline of
the proof
ceeds as follows. First, Yi is embedded into its Alexandrov compactiﬁ-
cation Yi with the purpose of obtaining a selector from the Kuratowski

4.10. THE WEAK TOPOLOGY
623
and Ryll-Nardzewski Selection Theorem. But we have to make sure that
the set-valued map remains concentrated on the originally given space.
This can be established; we obtain a selection for the embedding and
adjust the selection accordingly.
Proof 1. Let Yi for i D 1; 2 be the Alexandrov compactiﬁcation of Yi
and B the closure of B in Y 1  Y 2. Then B is compact and contains
the embedding of B into Y 1  Y 2, which we identify with B as a Borel
subset. This is so since Yi is a Borel subset in its compactiﬁcation.
The projections ˇi W B ! Y i are the continuous extensions to the
projections ˇi W B ! Yi.
2. The map ri W S.Yi/ ! S.Y i/ with ri./.G/ WD .G \ Yi/ for
G 2 B.Y i/ is continuous; in fact, it is an isometry with respect to the
respective Hutchinson metrics, once we have ﬁxed metrics for the un-
derlying spaces. Deﬁne for hx1; x2i 2 A the set
0.x1; x2/ WD f  2 S.B/ j S.ˇi/./ D .ri ı Ki/.xi/; i D 1; 2 g:
Thus 0 maps A to the nonempty closed subsets of S.B/, since S.ˇi/
and ri ı Ki are continuous for i D 1; 2. If  2 0.x1; x2/, then
.B n B/  

B \ .Y 1 n Y1  Y 2/ [ .Y 1  Y 2 n Y2/

D S.ˇ1/./.Y 1 n Y1/ C S.ˇ2/./.Y 2 n Y2/
D

r1 ı K1

.x1/.Y 1 n Y1/ C

r2 ı K2

.x2/.Y 2 n Y2/
D 0:
Hence all members of 0.x1; x2/ are concentrated on B.
3. Let C  S.B/ be compact, and assume that .tn/n2N is a converging
sequence in A with tn 2  w
0 .C/ for all n 2 N such that tn ! t0 2 A.
Then there exists some n 2 C \ 0.tn/ for each n 2 N. Since C is
compact, there exists by Proposition 3.5.31 a converging subsequence,
which we assume to be the sequence itself, so n !  for some  2 C
in the topology of weak convergence. Continuity of S.ˇi/ and of Ki.xi/
for i D 1; 2 implies  2 0. Consequently,  w
0 .C/ is a closed subset
of A.
4. Since S.B/ is compact, we may represent each open set G as a count-
able union of compact sets .Cn/n2N, so that
 w
0 .G/ D
[
n2N
 w
0 .Cn/I

624
CHAPTER 4. MEASURES FOR PROBABILISTIC SYSTEMS
hence  w
0 .G/ is a Borel set in A. The Kuratowski and Ryll-Nardzewski
Selection Theorem 4.7.2 together with Lemma 4.1.10 gives us a stochas-
tic relation M0 W A  B with M0.x1; x2/ 2 0.x1; x2/ for all hx1; x2i
2 A. Deﬁne M.x1; x2/ as the restriction of M0.x1; x2/ to the Borel sets
of B; then M W A  B is the desired relation, because M0.x1; x2/.B n
B/ D 0. a
For the construction we are about to undertake, we will put to work the
selection machinery just developed; this requires us to show that the
set from which we want to select is nonempty. The following technical
argument will be of assistance.
Assume that we have Polish spaces X1; X2 and a separable measure
space .Z; C/ with surjective and measurable maps fi W Xi ! Z for
i D 1; 2. We also have subprobability measures i 2 S.Xi/. Since
.Z; C/ is separable, we may assume that C constitutes the Borel sets for
some separable metric space .Z; d/; see Proposition 4.3.10. Proposi-
tion 4.3.31 then tells us that we may assume that f1 and f2 are continu-
ous. Now deﬁne
S WD fhx1; x2i 2 X1  X2 j f1.x1/ D f2.x2/g
A WD S \ .f1  f2/1
C ˝ C

:
Since Z WD fh´; ´i j ´ 2 Zg is a closed subset of Z  Z and since f1
and f2 are continuous, S D .f1  f2/1
Z

is a closed subset of the
Polish space X1  X2 and hence a Polish space itself by Lemma 4.3.21.
Assume that we have a ﬁnite measure # on A such that S.i/.#/.Ei/ D
i.Ei/ for all Ei 2 f 1
i

C

, i D 1; 2 with 1 W X1 ! Z and 2 W
X2 ! Z as the projections. Now A  B.S/ is usually not the -
algebra of Borel sets for some Polish topology on S, which, however,
will be needed. Here Lubin’s construction steps in.
Lemma 4.10.18 In the notation above, there exists a measure #C on
the Borel sets of S extending # such that S.i/.#C/.Ei/ D i.Ei/
holds for all Ei 2 B.S/.
Proof Because C is countably generated, C ˝ C is, so A is a countably
generated -algebra. By Lubin’s Theorem 4.6.12, there exists an exten-
sion #C to #.a
So much for the technical preparations; we will now turn to bisimula-
tions. A bisimulation relates two transition systems which are connected

4.10. THE WEAK TOPOLOGY
625
through a mediating system. In order to deﬁne this for the present con-
text, we need morphisms. Recall from Example 2.1.14 that a morphism
m D .f; g/ W K1 ! K2 for stochastic relations Ki W .Xi; Ai/  
.Yi; Bi/ (i D 1; 2) over general measurable spaces is given through the
measurable maps f W X1 ! X2 and g W Y1 ! Y2 such that this diagram
of measurable maps commutes
Equivalently, K2.f .x1// D S.g/.K1.x1//, which translates to K2
.f .x1//.B/ D K1.x1/.g1
B

/ for all B 2 B2.
Deﬁnition 4.10.19 The stochastic relations Ki W .Xi; Ai/  .Yi; Bi/
(i D 1; 2) are called bisimilar iff there exist a stochastic relation M W
Bisimilarity
.A; X/  .B; Y/ and surjective morphisms mi D .fi; gi/ W M ! Ki
such that the -algebra g1
1

B1

\ g1
2

B2

is nontrivial, i.e., contains
not only ; and B. The relation M is called mediating.
The ﬁrst condition on bisimilarity is in accordance with the general def-
inition of bisimilarity of coalgebras; it requests that m1 and m2 form a
span of morphisms
K1
M
m1
m2 K2
Hence, the following diagram of measurable maps is supposed to com-
mute with mi D .fi; gi/ for i D 1; 2:
Thus, for each a 2 A; D 2 B1; E 2 B2, the equalities
K1

f1.a/

.D/ D

S.g1/ ı M

.a/.D/ D M.a/

g1
1

D

K2

f2.a/

.E/ D

S.g2/ ı M

.a/.E/ D M.a/

g1
2

E

should be satisﬁed. The second condition, however, is special; it states
that we can ﬁnd an event C  2 Y which is common to both K1 and K2
in the sense that
g1
1

B1

D C  D g1
2

B2


626
CHAPTER 4. MEASURES FOR PROBABILISTIC SYSTEMS
for some B1 2 B1 and B2 2 B2 such that both C  6D ; and C  6D B
hold (note that for C  D ; or C  D B, we can always take the empty
and the full set, respectively). Given such a C  with B1; B2 from above,
we get for each a 2 A
K1.f1.a//.B1/ D M.a/.g1
1

B1

/ D M.a/.C /
D M.a/.g1
2

B2

/ D K2.g2.a//.B2/I
thus the event C  ties K1 and K2 together. Loosely speaking, g1
1

B1

\ g1
2

B2

can be described as the -algebra of common events, which
is required to be nontrivial.
Note that without the second condition, two relations K1 and K2 which
are strictly probabilistic (i.e., for which the entire space is always as-
signed probability 1) would always be bisimilar: Put A WD X1  X2,
B WD Y1  Y2 and set for hx1; x2i 2 A as the mediating relation
M.x1; x2/ WD K1.x1/ ˝ K2.x2/I that is, deﬁne M pointwise to be
the product measure of K1 and K2. Then the projections will make
the diagram commutative. But although this notion of bisimilarity is
sometimes suggested, it is way too weak, because bisimulations relate
transition systems, and it does not promise particularly interesting in-
sights when two arbitrary systems can be related. It is also clear that
using products for mediation does not work for the subprobabilistic
case.
We will show now that we can construct a bisimulation for stochas-
tic relations which are linked through a co-span K1
K
K2 The
center K of this co-span should be deﬁned over second countable met-
ric spaces, K1 and K2, over Polish spaces.
This situation is some-
times easy to obtain, e.g., when factoring Kripke models over Polish
spaces through a suitable logic; then K is deﬁned over analytic spaces,
which are separable metric. This is described in greater detail in Exam-
ple 4.10.21.
Proposition 4.10.20 Let Ki W Xi  Yi be stochastic relations over
Polish spaces, and assume that K W X  Y is a stochastic relation,
where X; Y are second countable metric spaces. Assume that we have
a co-span of morphisms mi W Ki ! K; i D 1; 2; then there exist
a stochastic relation M and morphisms mC
i
W M  Ki; i D 1; 2

4.10. THE WEAK TOPOLOGY
627
rendering this diagram commutative:
M
m+
1
m+
2
K2
m2
K1
m1
K
The stochastic relation M is deﬁned over Polish spaces.
Proof 1. Assume Ki D .Xi; Yi; Ki/ with mi D .fi; gi/, i D 1; 2.
Because of Proposition 4.3.31, we may assume that the respective -
algebras on X1 and X2 are obtained from Polish topologies which ren-
der f1 and K1 as well as f2 and K2 continuous. These topologies are
ﬁxed for the proof. Put
A WD fhx1; x2i 2 X1  X2 j f1.x1/ D f2.x2/g;
B WD fhy1; y2i 2 Y1  Y2 j g1.y1/ D g2.y2/gI
then both A and B are closed, hence Polish. ˛i W A ! Xi and ˇi W B !
Yi are the projections, i D 1; 2. The diagrams
are commutative by assumption; thus we know that for xi 2 Xi
K.f1.x1// D S.g1/.K1.x1// and K.f2.x2// D S.g2/.K2.x2//
holds. The construction implies that .g1ıˇ1/.y1;y2/ D .g2ıˇ2/.y1;y2/
is true for hy1; y2i 2 B, and g1 ı ˇ1 W B ! Y is surjective.
2. Fix hx1; x2i 2 A. Separability of the target spaces now enters: We
know that the image of a surjective map under S is onto again by Propo-
sition 4.6.11, so that there exists 0 2 S.B/ with S.g1 ı ˇ1/.0/ D
K.f1.x1//; consequently, S.gi ı ˇi/.0/ D S.gi/.Ki.xi// .i D 1; 2/:
But this means for i D 1; 2
8Ei 2 g1
i

B.Y /

W S.ˇi/.0/.Ei/ D Ki.xi/.Ei/:

628
CHAPTER 4. MEASURES FOR PROBABILISTIC SYSTEMS
Put
 .x1; x2/
WD f 2 S.B/ j S.ˇ1/./ D K1.x1/ and S.ˇ2/./ D K2.x2/gI
then Lemma 4.10.18 shows that  .x1; x2/ 6D ;:
3. The set
 w.C/ D fhx1; x2i 2 A j  .x1; x2/ \ C 6D ;g
is closed in A for compact C  S.B/: This is shown exactly as in
the second part of the proof for Proposition 4.10.17, from which now
is inferred that there exists a measurable map M W A ! S.B/ with
M.x1; x2/ 2  .x1; x2/ for every hx1; x2i 2 A: Thus M W A  B is a
stochastic relation with
K1 ı ˛1 D S.ˇ1/ ı M and K2 ı ˛2 D S.ˇ2/ ı M:
Thus M with mC
1 WD .˛1; ˇ1/ and mC
2 WD .˛2; ˇ2/ is the desired semi-
pullback. a
Now we know that we may construct from a co-span of stochastic rela-
tions a span. Let us have a look at a typical situation in which such a
co-span may occur.
Example 4.10.21 Consider the modal logic from Example 4.1.11 again,
and interpret the logic through stochastic relations K W S  S and
L W T  T over the Polish spaces S and T . The equivalence rela-
tions 
K and 
L are deﬁned as in Example 4.4.19. Because we have
only countably many formulas, these relations are smooth. For read-
ability, denote the equivalence class associated with 
K by ŒK, sim-
ilar for ŒL. Because 
K and 
L are smooth, the factor spaces S=K
resp. T=L are analytic spaces, when equipped with the ﬁnal -algebra
with respect to K resp. L by Proposition 4.4.22. The factor rela-
tion KF W S=K  S=K is then the unique relation which makes this
diagram commutative:

4.10. THE WEAK TOPOLOGY
629
This translates to K.s/.1
K

B

/ D KF .ŒsK/.B/ for all B 2 B.S=K/
and all s 2 X.
Associate with each formula ' its validity sets ŒŒ'K resp. ŒŒ'L, and
call s 2 S logically equivalent to t 2 T iff we have for each formula '
s 2 ŒŒ'K , t 2 ŒŒ'L:
Hence s and t are logically equivalent iff no formula can distinguish
state s from state t. Call the stochastic relations K and L logically
equivalent iff given s 2 S there exists t 2 T such that s and t are
Logical
equivalence
logically equivalent and vice versa.
Now assume that K and L are logically equivalent, and consider
˚ WD
˚
hŒsK ; ŒtLi j s 2 S and t 2 T are logically equivalent

:
Then ˚ is the graph of a bijective map; this is easy to see. Denote
the map by ˚ as well. Since ˚1
L

ŒŒ'L

D K

ŒŒ'K

and since
the set fL

ŒŒ'L

j ' is a formulag generates B.T=L/ by Proposition
4.4.26, ˚ W S=K ! T=L is Borel measurable; interchanging the rˆoles
of K and L yields measurability of ˚1.
Hence we have this picture for logical equivalent K and L:
✌
This example can be generalized to the case that the relations operate
on two spaces rather than only on one. Let K W X  Y be a transition
kernel over the Polish spaces X and Y . Then the pair .; / of smooth
equivalence relations  on X and  on Y is called a congruence for K
Congruence
iff there exists a transition kernel K; W X=  Y= rendering the
diagram commutative:

630
CHAPTER 4. MEASURES FOR PROBABILISTIC SYSTEMS
Because  is an epimorphism, K; is uniquely determined, if it ex-
ists.
For a discussion of congruences for stochastic coalgebras, see
Sect. 2.6.2. Commutativity of the diagram translates to
K.x/.1


B

/ D K;.Œx/.B/
for all x 2 X and all B 2 B.Y=/. Call in analogy to Example 4.10.21
the transition kernels K1 W X1  Y1 and K2 W X2  Y2 logi-
cally equivalent iff there exist congruences .1; 1/ for K1 and .2; 2/
Logical
equivalence
through
factors
for K2 such that the factor relations K1;1 and K2;2 are isomor-
phic.
In the spirit of this discussion, we obtain from Proposition 4.10.20
Theorem 4.10.22 Logically equivalent stochastic relations over Polish
spaces are bisimilar.
Proof 1. The proof applies Proposition 4.10.20; ﬁrst it has to show how
to satisfy the assumptions of that statement. Let Ki W Xi  Yi be
stochastic relations over Polish spaces for i D 1; 2. We assume that K1
is logically equivalent to K2; hence there exist congruences .i; i/ for
Ki such that the associated stochastic relations Ki;i W Xi=i  Yi=i
are isomorphic. Denote this isomorphism by .';  /, so ' W X1=1 !
X2=2 and  W Y1=1 ! Y2=2 are in particular measurable bijections,
so are their inverses.
2. Let 2 WD .2; 2/ be the factor morphisms 2 W K2 ! K2;2,
and put 1 WD .' ı 1;  ı 1/; thus we obtain this co-span of mor-
phisms
K1
η1
Kκ2,λ2
K2
η2
Because both X2=2 and Y2=2 are analytic spaces on account of 2 and
2 being smooth (see Proposition 4.4.22), we apply Proposition 4.10.20
and obtain a mediating relation M W A  B with Polish A and B such
that the projections ˛i W A ! Xi and ˇi W B ! Yi are morphisms for
i D 1; 2. Here
A WD fhx1; x2i j '.Œx11/ D Œx22g;
B WD fhy1; y2i j '.Œy11/ D Œy22g:
It remains to be demonstrated that the -algebra of common events, viz.,
the intersection ˇ1
1

B.Y1/

\ ˇ1
2

B.Y2/

is not trivial.

4.10. THE WEAK TOPOLOGY
631
3.
Let U2 2 B.Y2/ be 2-invariant.
Then 2

U2

2 B.Y2=2/,
because U2 D 1
2

2

U2

on account of U2 being 2-invariant.
Thus U1 WD 1
1

 1
2

U2

is an 1-invariant Borel set in Y1
with
hy1; y2i 2 .Y1  U2/ \ B , y2 2 U2 and  .Œy11/ D Œy22
, hy1; y2i 2 .U1  U2/ \ B:
One shows in exactly the same way
hy1; y2i 2 .U1  Y2/ \ B , hy1; y2i 2 .U1  U2/ \ B:
Consequently, .U1  U2/ \ B belongs to both ˇ1
1

B.Y1/

and
ˇ1
2

B.Y2/

; so that this intersection is not trivial. a
Call a class A of spaces closed under bisimulations if the mediating
relation for stochastic relations over spaces from A is again deﬁned
over spaces from A. Then the result above shows that Polish spaces are
closed under bisimulations. This generalizes a result by Edalat [Eda99]
and Desharnais et al. [DEP02] which demonstrates—through a com-
pletely different approach—that analytic spaces are closed under bisim-
ulations; S´anchez Terraf [ST11] has shown that general measurable
spaces are not closed under bisimulations. In view of von Neumann’s
Selection Theorem 4.6.10, it might be interesting to see whether com-
plete measurable spaces are closed.
We present ﬁnally a situation in which no semi-pullback exists. A ﬁrst
example in this direction was presented in [ST11, Theorem 12]. It is
based on the extension of Lebesgue measure to a -algebra which does
contain the Borel sets of Œ0; 1 augmented by a nonmeasurable set, and
it shows that one can construct Markov transition systems which do not
have a semi-pullback. The example below extends this by showing that
one does not have to consider transition systems, but that a look at the
measures on which they are based sufﬁces.
Example 4.10.23 A morphism f W .X; A; / ! .Y; B; / of measure
spaces is an A-B-measurable map f W X ! Y such that  D M.f /./.
Since each ﬁnite measure can be viewed as a transition kernel, this is
a special case of morphisms for transition kernels. If B is a sub--
algebra of A with  an extension to , then the identity is a morphism
.X; A; / ! .X; B; /.

632
CHAPTER 4. MEASURES FOR PROBABILISTIC SYSTEMS
Denote Lebesgue measure on .Œ0; 1; B.Œ0; 1// by . Assuming the Ax-
iom of Choice, we know that there exists W  Œ0; 1 with .W / D 0
and .W / D 1 by Lemma 1.7.7. Denote by AW WD .B.Œ0; 1/ [
fW g/ the smallest -algebra containing the Borel sets of Œ0; 1 and W .
Then we know from Exercise 4.6 that we can ﬁnd for each ˛ 2 Œ0; 1 a
measure ˛ on AW which extends  such that ˛.W / D ˛.
Hence by the remark just made, the identity yields a morphism f˛ W
.Œ0; 1; AW ; ˛/ ! .Œ0; 1; B.Œ0; 1/; /. Now let ˛ 6D ˇ; then
is a co-span of morphisms.
We claim that this co-span does not have a semi-pullpack. In fact, as-
sume that .P; P; / with morphisms ˛ and ˇ is a semi-pullback; then
f˛ ı ˛ D fˇ ı ˇ, so that ˛ D ˇ, and 1
˛

W

D 1
ˇ

W

2 P.
But then
˛ D ˛.W / D .1
˛

W

/ D .1
ˇ

W

/ D ˇ.W / D ˇ:
This contradicts the assumption that ˛ 6D ˇ. ✌
This example shows that the topological assumptions imposed above
are indeed necessary. It assumes the Axiom of Choice, so one might ask
what happens if this axiom is replaced by the Axiom of Determinacy.
We know that the latter one implies that each subset of the unit interval
is -measurable by Theorem 1.7.14, so .W / D .W / holds for each
W  Œ0; 1. Then at least the construction above does not work. On the
other hand, we made free use of Tihonov’s Theorem, which is known to
be equivalent to the Axiom of Choice [Her06, Theorem 4.68], so there
is probably no escape from the Axiom of Choice.
4.10.4
Case Study: Quotients for Stochastic Relations
As Monty Python used to say, “And now for something completely dif-
ferent!” We will deal now with quotients for stochastic relations, per-
ceived as morphisms in the Kleisli category over the monad which is
given by the subprobability functor. We will ﬁrst have a look at surjec-
tive maps as epimorphisms in the category of sets, explaining the prob-
lem there, show that a straightforward approach gleaned from the cate-
gory of sets does not appear promising, and show then that measurable

4.10. THE WEAK TOPOLOGY
633
selections are the appropriate tool for tackling the problem. The exam-
ple demonstrates also that constructions which are fairly straightforward
for sets may become somewhat involved in the category of stochastic re-
lations.
For motivation, we start with surjective maps on a ﬁxed set M, serving
as a domain. Let f W M ! X and g W M ! Y be onto, and deﬁne
the partial order f  g iff f D 	 ı g for some 	 W Y ! X. Clearly,
 is reﬂexive and transitive; the equivalence relation 
 deﬁnes through
f 
 g iff f  g and g  f are of interest here. Thus f D 	 ı g
and g D 
 ı f for suitable 	 W Y ! X and 
 W X ! Y . Because
surjective maps are epimorphisms in the category of sets with maps as
morphisms, we obtain 	 ı 
 D idX and 
 ı 	 D idY . Hence 	 and

 are bijections. The surjections f and g, both with domain M, are
equivalent iff there exists a bijection ˇ with f D ˇ ı g. This is called
a quotient object for M. We know that the surjection f W M ! Y
Quotient
object in Set
can be factored as f D
Qf ı ker.f / with Qf W Œxker.f / 7! f .x/ as the
bijection; see Proposition 2.1.26. Thus for maps, the quotient objects
for M may be identiﬁed through the quotient maps ker.f /; in a similar
way, the quotient objects in the category of groups can be identiﬁed
through normal subgroups; see [ML97, V.7] for a discussion. Quotients
are algebraically of interest.
We turn to stochastic relations. The subprobability functor on the cate-
gory of measurable spaces is the functorial part of the Giry monad, and
the stochastic relations are just the Kleisli morphism for this monad; see
the discussion in Example 2.4.8 on page 173. Let K W .X; A/  .Y; B/
be a stochastic relation; then Exercise 4.14 shows that
K./ W B 7!
Z
X
K.x/.B/ d.x/
deﬁnes a }}}.X; A/-}}}.Y; B/-measurable map S.X; A/ ! S.Y; B/; K is
the Kleisli map associated with the Kleisli morphism K (it should not
be confused with the completion of K as discussed in Sect. 4.6.2). It is
clear that K 7! K is injective, because K.ıx/ D K.x/.
It will be helpful to evaluate the integral with respect to K./: Let
g W Y ! R be bounded and measurable; then
Z
Y
g dK./ D
Z
X
Z
Y
g.y/ dK.x/.y/ d.x/:
(4.20)

634
CHAPTER 4. MEASURES FOR PROBABILISTIC SYSTEMS
This has been anticipated in Example 2.4.8. In order to establish this,
assume ﬁrst that g D B for B 2 B, then both sides evaluate to
K./.B/, so the representation is valid for indicator functions. Lin-
earity of the integral yields the representation for step functions. Since
we may ﬁnd for general g a sequence .gn/n2N of step functions with
limn!1 gn.y/ D g.y/ for all y 2 Y and since g is bounded, hence in-
tegrable with respect to all ﬁnite measures, we obtain from Lebesgue’s
Dominated Convergence Theorem 4.8.6 that
Z
Y
g dK./ D lim
n!1
Z
Y
gn dKK./
D lim
n!1
Z
X
Z
Y
gn.y/ dK.x/.y/ d.x/
D
Z
X
lim
n!1
Z
Y
gn.y/ dK.x/.y/ d.x/
D
Z
X
Z
Y
g.y/ dK.x/.y/ d.x/:
This gives the desired representation.
The Kleisli map is related to the convolution operation deﬁned in Ex-
ample 4.9.6.
Lemma 4.10.24 Let K W .X; A/  .Y; B/ and L W .Y; B/  .Z; C/;
then L  K D L ı K.
Proof Evaluate both the left-hand and the right-hand sides for  2
S.X; A/ and C 2 C:
L  K./.C/ D
Z
X
Z
Y
L.y/.C/ dK.x/.y/ d.x/
D
Z
Y
L.y/.C/ dK./.y/
(by (4.20))
D L.K/./.C/:
This implies the desired equality. a
Associate with each measurable f W Y ! Z a stochastic relation ıf W
Y  Z through ıf .y/.C/ WD ıy.f 1
C

/; then ıf D S.f / ı ı; and

4.10. THE WEAK TOPOLOGY
635
a direct computation shows ıf  K D S.f / ı K: In fact,

ıf  K

.x/.C/ D
Z
Y
ıf .y/.C/ K.x/.dy/
D
Z
Y
f 1
C
.y/ K.x/.dy/
D K.x/.f 1
C

/
D

S.f / ı K

.x/.C/:
On the other hand, if f W W ! X is measurable, then

K  ıf

.w/.B/ D
Z
X
K.x/.B/ ıf .w/.dx/ D .K ı f /.w/.B/:
In particular, it follows that eX WD S.idX/ is the neutral element: K D
eX  K D K  eX D K. Recall that K is an epimorphism in the Kleisli
category iff L1  K D L2  K implies L1 D L2 for any stochastic
relations L1; L2 W .Y; B/  .Z; C/. Lemma 4.10.24 tells us that if
the Kleisli map K is onto, then K is an epimorphism. Now let K W
.X; A/  .Y; B/ and L W .X; A/  .Z; C/ be stochastic relations, and
assume that both K and L are epis. Deﬁne as above
K  L , K D J  L for some J W .Z; C/  .Y; B/
K  L , K  L and L  K:
Hence we can ﬁnd in case K  L a stochastic relation J such that
K.x/.B/ D
Z
Z
J.´/.B/ dL.x/.´/
for x 2 X and B 2 B.
We will deal for the rest of this section with Polish spaces. Fix X as a
Polish space. For identifying the quotients with respect to Kleisli mor-
phisms, one could be tempted to mimic the approach observed for the
sets as outlined above. This is studied in the next example.
Example 4.10.25 Let K W X  Y be a stochastic relation with Polish
Y which is an epi. X=ker .K/ is an analytic space, since K W X ! S.Y /
is a measurable map into the Polish space S.Y / by Proposition 4.10.10,
so that ker .K/ is smooth. Deﬁne the map EK W X ! S.X=ker .K//

636
CHAPTER 4. MEASURES FOR PROBABILISTIC SYSTEMS
through EK.x/ WD ıŒxker.K/I hence we obtain for each x 2 X and each
Borel set G 2 B.X=ker .K//
EK.x/.G/ D ıŒxker.K/.G/ D ıx.1
ker.K/

G

/ D S.ker.K//.ıx/.G/:
Thus EK is an epi as well: Take  2 S.X/ and G 2 B.X=ker .K//;
then
EK./.G/
D
R
X EK.x/.G/ d.x/
D
R
X ıx.1
ker.K/

G

/ d.x/
D .1
ker.K/

G

/
D S.ker.K//./.G/;
so that EK D S.ker.K//; since the image of a surjective map under S is
surjective again by Proposition 4.6.11, we conclude that EK is an epi.
Now deﬁne for x 2 X the map
QK.Œxker.K// WD K.x/I
then the construction of the ﬁnal -algebra on X=ker .K/ shows that QK
is well deﬁned and constitutes a stochastic relation QK W X=ker .K/  
Y . Moreover we obtain for x 2 X; H 2 B.Y / by the change of vari-
ables formula in Corollary 4.8.9
. QKEK/.x/.H/ D
Z
X=ker.K/
QK.t/.H/ dEK.x/.t/
D
Z
X=ker.K/
QK.t/.H/ dS.ker.K//.ıx/.t/
D
Z
X
QK.Œwker.K//.H/ dıx.w/
D
Z
X
K.w/.H/ dıx.w/
D K.x/.H/:
Consequently, K can be factored as K D
QK  EK with the epi EK.
But there is no reason why in general QK should be invertible; for this
to hold, the map QK W S.X=ker .K// ! S.Y / is required to be injective.
Hence K  EK holds only in very special cases. ✌
This last example indicates that a characterization of quotients for the
Kleisli category at least for the Giry monad cannot be derived directly
by translating a characterization for the underlying category from the
category of sets.

4.10. THE WEAK TOPOLOGY
637
For the rest of the section, we discuss the Kleisli category for the Giry
monad over Polish spaces; hence we deal with stochastic relations. Let
X, Y , and Z be Polish, and ﬁx K W X  Y and L W X  Z so that
K  L. Hence there exists J W Y  Z with inverse H W Z  Y and
L D J K and K D H L. Because both K and L are epis, we obtain
these simultaneous equations
H  J D eY and J  H D eZ:
They entail
Z
Z
H.´/.B/ dJ.y/.´/ D ıy.B/ and
Z
Y
J.y/.C/ dH.´/.y/ D ı´.C/
for all y 2 Y; ´ 2 Z and B 2 B.Y /; C 2 B.Z/. Because singletons are
Borel sets, these equalities imply
Z
Z
H.´/.fyg/ dJ.y/.´/ D 1 and
Z
Y
J.y/.f´g/ dH.´/.y/ D 1:
Consequently, we obtain
8y 2 Y W J.y/.f´ 2 Z j H.´/.fyg/ D 1g/ D 1;
8´ 2 Z W H.´/.fy 2 Y j J.y/.f´g/ D 1g/ D 1:
Proposition 4.10.26 There exist Borel maps f W Y ! Z and g W Z !
Y such that H

f .y/

.fyg/ D 1 and J

g.´/

.f´g/ D 1 for all y 2
Y; ´ 2 Z.
Proof 1. Deﬁne P WD fhy; ´i 2 Y  Z j H.´/.fyg/ D 1g and Q WD
fh´; yi 2 Z  Y j J.y/.f´g/ D 1gI then P and Q are Borel sets. We
establish this for P ; the argumentation for Q is very similar.
2. With a view toward Proposition 4.3.31, we may and do assume that
H W Z ! S.Y / is continuous. Let

hyn; ´ni

n2N be a sequence in
P with hyn; ´ni ! hy; ´i; hence the sequence

H.´n/

n2N converges
weakly H.´/. Given m 2 N, there exists n0 2 N such that yn 2
V1=m.y/ for all n0  n, where V1=m.y/ is the closed ball of radius 1=m
around y. Since H is weakly continuous, we obtain
lim sup
n!1
H.´n/

V1=m.y/

 H.´/

V1=m.y/

from Proposition 4.1.35; hence
H.´/

V1=m.y/

D 1:

638
CHAPTER 4. MEASURES FOR PROBABILISTIC SYSTEMS
Because
\
m2N
V1=m.y/ D fyg;
we conclude H.´/.fyg/ D 1; thus hy; ´i 2 P . Consequently, P is a
closed subset of Y  Z, hence a Borel set.
3. Since P is closed, the cut Py at y is closed as well, and we have
J.y/.Py/ D J.y/.f´ 2 Z j H.´/.fyg/ D 1g D 1I
thus we obtain supp.J.y//  Py, because the support supp.J.y// is
the smallest closed set C with J.y/.C/ D 1. Since y 7! supp.J.y//
is measurable, as we have seen in Example 4.7.5, we obtain from The-
orem 4.7.2 a measurable map f W Y ! Z with f .y/ 2 supp.J.y// 
Py for all y 2 Y ; thus H.f .y//.fyg/ D 1 for all y 2 Y .
4. In the same way, we obtain measurable g W Z ! Y with the desired
properties. a
Discussing the maps f; g obtained above from H and J , we see that
H ı f D eY and J ı g D eZ;
and we calculate through the change of variables formula in Corol-
lary 4.8.9 for each ´0 2 Y and each H 2 B.Z/

H.S.f / ı H/

.´0/.H/ D
Z
Z
H.´/.H/ .S.f / ı H/.´0/.d´/
D
Z
Y
H.f .y//.H/ H.´0/.dy/
D
Z
Y
ıy.H/ H.´0/.dy/
D H.´0/.H/:
Thus H.S.f / ı H/ D H; and because H is a mono, we infer that
S.f / ı H D eZ: Since
S.f / ı H D .eZ ı f /H D J H;
we infer on account of H being an epi that J D eZ ı f . Similarly we
see that H D eY ı g.
Lemma 4.10.27 Given stochastic relations J W Y  Z and H W Z  
Y with H  J D eY and J  H D eZ; there exist Borel isomorphisms
f W Y ! Z and g W Z ! Y with J D eZ ı f and H D eY ı g:

4.10. THE WEAK TOPOLOGY
639
Proof We infer for y 2 Y from
ıy.G/ D eY .y/.G/
D .H  J /.y/.G/
D
Z
Z
H.´/.G/ dJ.y/.´/
D ıf .y/.g1
G

/
D ıy.f 1
g1
G

/
for all Borel sets G 2 B.Y / that g ı f D idY I similarly, f ı g D idZ
is inferred. Hence the Borel maps f and g are bijections and thus Borel
isomorphisms. a
This yields a characterization of the quotient equivalence relation in the
Kleisli category for the Giry monad.
Proposition 4.10.28 Assume the stochastic relations K W X  Y and
L W X  Z are both epimorphisms with respect to Kleisli composition;
then these conditions are equivalent:
1. K  L:
2. L D S.f / ı K for a Borel isomorphism f W Y ! Z.
Proof 1 ) 2: Because K  L, there exists an invertible J W Y  Z
with inverse H W Z  Y and L D J K: We infer from Lemma 4.10.27
the existence of a Borel isomorphism f W Y ! Z such that J D Zıf .
Consequently, we have for x 2 X and the Borel set H 2 B.Z/
L.x/.H/ D
Z
Y
J.y/.H/ dK.x/.y/
D
Z
Y
ıf .y/.H/ dK.x/.y/
D K.x/.f 1
H

/
D

S.f / ı K

.x/.H/:
2 ) 1: If L D S.f / ı K D .Z ı f /  K for the Borel isomorphism
f W Y ! Z, then K D .Y ı g/  L with g W Z ! Y as the inverse to
f . a
Consequently, given the epimorphisms K W X  Y and L W X  
Z, the relation K  L entails their base spaces Y and Z being Borel

640
CHAPTER 4. MEASURES FOR PROBABILISTIC SYSTEMS
isomorphic and vice versa. Hence the Borel isomorphism classes are the
quotient objects for this relation.
This classiﬁcation should be complemented by a characterization of epi-
morphic Kleisli morphisms for this monad. This seems to be an open
question.
4.11
Lp-Spaces
We will construct for a measure space .X; A; / a family fLp j 1 
p  1g of Banach spaces. Some properties of these spaces are dis-
cussed now; in particular we will identify their dual spaces. The case
p D 2 gives the particularly interesting space L2./, which is a Hilbert
space under the inner product hf; gi 7!
R
X f  g d: Hilbert spaces
have some properties which will turn out to be helpful and which will
be exploited for the underlying measure spaces. For example, von Neu-
mann obtained from a representation of their continuous linear maps
both the Lebesgue decomposition and the Radon–Nikodym Theorem
derivative in one step! We join Rudin’s exposition [Rud74, Sect. 6] in
giving the truly ravishing proof here. But we are jumping ahead. After
investigating the basic properties of Hilbert spaces including the clos-
est approximation property and the identiﬁcation of continuous linear
functions, we move to a discussion of the more general Lp-spaces and
investigate the positive linear functionals on them.
Some important developments like the deﬁnition of signed measures are
brieﬂy touched, while some are not. The topics which had to be omitted
here include the weak topology induced by Lq on Lp for conjugate pairs
p; q; this would have required some investigations into convexity, which
would have led into a wonderful, wondrous but unfortunately faraway
country.
The last section deals with disintegration as an application of both the
Radon–Nikodym derivative and the measure extension theorem. It deals
with the problem of decomposing a ﬁnite measure on a product into
its projection onto the ﬁrst component and an associated transition ker-
nel.

4.11. Lp-SPACES
641
4.11.1
A Spoonful Hilbert Space Theory
Let H be a real vector space. A map .; / W H  H ! R is said to
be an inner product iff these conditions hold for all x; y; ´ 2 H and all
Inner
product
˛; ˇ 2 R:
1. .x; y/ D .y; x/, so the inner product is commutative.
2. .˛  x C ˇ  ´; y/ D ˛  .x; y/ C ˇ  .´; y/, so the inner product is
linear in the ﬁrst and hence also in the second component.
3. .x; x/  0, and .x; x/ D 0 iff x D 0.
We conﬁne ourselves to real vector spaces. Hence the laws for the inner
product are somewhat simpliﬁed in comparison to vector spaces over
the complex number. There one would, e.g., postulate that .y; x/ is the
complex conjugate for .x; y/.
The inner product is the natural generalization of the scalar product in
Euclidean spaces
.hx1; : : : ; xni; hy1; : : : ; yni/ WD
n
X
iD1
xi  yi;
which satisﬁes these laws, as one veriﬁes readily.
We ﬁx an inner product .; / on H. Deﬁne the norm of x 2 H through
kxk WD
p
.x; x/I
this is possible because .x; x/  0. We show that this yields a normed
space indeed.
The map k  k has a very appealing geometric property, which is known
as the parallelogram law: The sum of the squares of the diagonals is the
sum of the squares of the sides in a parallelogram.
Parallelo-
gram
law
kx C yk2 C kx  yk2 D 2  kxk2 C 2  kyk2
holds for all x; y 2 H; see Exercise 4.33.
Before investigating k  k in detail, we need the Schwarz inequality as a
tool. It relates the norm to the inner product of two elements. Here it
is.
Lemma 4.11.1 j.x; y/j  kxk  kyk.
Schwarz
inequality

642
CHAPTER 4. MEASURES FOR PROBABILISTIC SYSTEMS
Proof Let a WD kxk2, b WD kyk2, and c WD j.x; y/j. Then c D t .x; y/
with t 2 f1; C1g. We have for each real r
0  .x  r  t  y; x  r  t  y/ D .x; x/  2  r  t  .x; y/ C r2  .y; y/I
thus a2rcCr2b  0. If b D 0, we must also have c D 0; otherwise
the inequality would be false for large positive r. Hence the inequality
is true in this case. So we may assume that b 6D 0. Put r WD c=b, so that
a  c2=b, so that a  b  c2, from which the desired inequality follows.
a
Schwarz’s inequality will help in establishing that a vector space with an
inner product is a normed space, as introduced in Deﬁnition 3.6.38.
Proposition 4.11.2 Let H be a real vector space with an inner product;
then .H; k  k/ is a normed space.
Proof It is clear from the deﬁnition of the inner product that k˛  xk D
j˛j  kxk and that kxk D 0 iff x D 0; the crucial point is the triangle
inequality. We have
kx C yk2 D .x C y; x C y/ D kxk2 C kyk2
C 2  .x; y/
 kxk2 C 2  kxk  kyk C kyk2
(by Lemma 4.11.1)
D .kxk C kyk/2:
a
Thus each inner product space yields a normed space; consequently it
spawns a metric space through hx; yi 7! kx  yk. Finite dimensional
vector spaces Rn are Hilbert spaces under the inner product mentioned
above. It produces for Rn the familiar Euclidean distance
kx  yk D
v
u
u
t
n
X
iD1
.xi  yi/2:
We will meet square integrable functions as another class of Hilbert
spaces, but before discussing them, we need some preparations.
Corollary 4.11.3 The maps x 7! kxk and x 7! .x; y/ with ﬁxed y 2
H are continuous.

4.11. Lp-SPACES
643
Proof We obtain from kxk  kykCkx yk and kyk  kxkCkx yk
that
ˇˇkxk  kyk
ˇˇ  kx  yk; hence the norm is continuous. From
Schwarz’s inequality we see that j.x; y/  .x0; y/j D j.x  x0; y/j 
kx  x0k  kyk, which shows that .; y/ is continuous. a
From the properties of the inner product, it is apparent that x 7! .x; y/
is a continuous linear functional in the following sense:
Deﬁnition 4.11.4 Let H be an inner product space with norm k  k. A
linear map L W H ! R which is continuous in the norm topology is
called a continuous linear functional on H.
We saw linear functionals already in Sect. 1.5.4, where the domination
through a sublinear map was concentrated on, leading to an extension.
This, however, is not the focus in the present discussion.
If L W H ! R is a continuous linear functional, then its kernel
Kern.L/
Kern.L/ WD fx 2 H j L.x/ D 0g
is a closed linear subspace of H, i.e., is a real vector space in its own
right. Note that
hx; yi 2 ker .L/ iff x  y 2 Kern.L/;
so that both versions of kernels are related in an obvious way.
Say that x 2 H is orthogonal to y 2 H iff .x; y/ D 0, and denote this
by x?y. This is the generalization of the familiar concept of orthog-
onality in Euclidean spaces, which is formulated also in terms of the
inner product. Given a linear subspace M  H, deﬁne the orthogonal
complement M ? of M as
M ?
M ? WD fy 2 H j x?y for all x 2 Mg:
The orthogonal complement is a linear subspace as well, and it is closed
by Corollary 4.11.3, since M D T
x2Mfy 2 H j .x; y/ D 0g. Then
M \ M ? D f0g, since a vector ´ 2 M \ M ? is orthogonal to itself;
hence .´; ´/ D 0, which implies ´ D 0.
Hilbert spaces are introduced now as those linear spaces for which this
metric is complete. Our goal is to show that continuous linear func-
tionals on a Hilbert space H are given exactly through the inner prod-
uct.

644
CHAPTER 4. MEASURES FOR PROBABILISTIC SYSTEMS
Deﬁnition 4.11.5 A Hilbert space is a real vector space with an inner
product so that the induced metric is complete.
Note that we ﬁx the metric for which the space is complete, noting that
completeness is not a property of the underlying topological space but
rather of a speciﬁc metric. It is also worth noting that a Hilbert space is
a topological group, as discussed in Example 3.1.25, and hence that it is
a complete uniform space.
Recall that a subset C  H is called convex iff it contains with two
Convex
points also the straight line between them and thus iff ˛xC.1˛/y 2
C, whenever x; y 2 C and 0  ˛  1.
A key tool for our development is the observation that a closed convex
subset of a Hilbert space has a unique element of smallest norm. This
property is familiar from Euclidean spaces. Visualize a compact convex
set in R3; then this set has a unique point which is closest to the origin.
The statement below is more general, because it refers to closed and
convex sets.
Proposition 4.11.6 Let C  H be a closed and convex subset of the
Hilbert space H. Then there exists a unique y 2 C such that kyk D
inf´2C k´k.
Proof 0. We construct a sequence .xn/n2N in C, the norms of which
Plan
converge against the inﬁmum of the vectors’ length in C. Using the par-
allelogram law, we ﬁnd that the vectors themselves converge to a point
of minimal length, which by convexity must belong to the C.
1. Put r WD inf´2C k´k, and let x; y 2 C; hence by convexity .x C
y/=2 2 C as well. The parallelogram law gives
kx  yk2 D 2  kxk2 C 2  kyk2  4  k.x C y/=2k2
 2  kxk2 C 2  kyk2  4  r2:
Hence if we have two vectors x 2 C and y 2 C of minimal norm, we
obtain x D y. Thus, if such a vector exists, it must be unique.
2.
Let .xn/n2N be a sequence in C such that limn!1 kxnk D r.
At this point,
we have only
information
about
the sequence

kxxk

n2N of real numbers, but we can actually show that the sequence
proper is a Cauchy sequence. It works like this. We obtain, again from
the parallelogram law, the estimate
kxn  xmk  2  .kxnk2 C kxmk2  2  r2/;

4.11. Lp-SPACES
645
so that for each  > 0 we ﬁnd n0 such that kxn xmk <  if n; m  n0.
Hence .xn/n2N is actually a Cauchy sequence, and since H is complete,
we ﬁnd some x such that limn!1 xn D x. Clearly, kxk D r, and since
C is closed, we infer that x 2 C. a
Note how the geometric properties of an inner product space, formu-
lated through the parallelogram law, and the metric property of being
complete cooperate.
This unique approximation property has two remarkable consequences.
The ﬁrst one establishes for each element x 2 H a unique representation
as x D x1Cx2 with x1 2 M and x2 2 M ? for a closed linear subspace
M of H, and the second one shows that the only continuous linear maps
on the Hilbert space H are given by the maps x:.x; y/ for y 2 H. We
need the ﬁrst one for establishing the second one, so both ﬁnd their place
in this somewhat minimal discussion of Hilbert spaces.
Proposition 4.11.7 Let H be a Hilbert space, M  H a closed linear
subspace. Each x 2 H has a unique representation x D x1 C x2 with
x1 2 M and x2 2 M ?.
Proof 1. If such a representation exists, it must be unique. In fact,
assume that x1Cx2 D x D y1Cy2 with x1; y1 2 M and x2; y2 2 M ?;
then x1y1 D y2x2 2 M\M ?, which implies x1 D y1 and x2 D y2
by the remark above.
2. Fix x 2 H, we may and do assume that x 62 M, and deﬁne C WD
fx  y j y 2 Mg, then C is convex, and, because M is closed, it is
closed as well. Thus we ﬁnd an element in C which is of smallest norm,
say, x  x1 with x1 2 M. Put x2 WD x  x1, and we have to show that
x2 2 M ? and hence that .x2; y/ D 0 for any y 2 M. Let y 2 M; y 6D 0
and choose ˛ 2 R arbitrarily (for the moment, we will ﬁx it later). Then
x2  ˛  y D x  .x1 C ˛  y/ 2 C, and thus kx2  ˛  yk2  kx2k2.
Expanding, we obtain
.x2  ˛  y; x2  ˛  y/ D .x2; x2/  2  ˛  .x2; y/ C ˛2  .y; y/  .x2; x2/:
Now put ˛ WD .x2; y/=.y; y/; then the above inequality yields
2  .x2; y/2
.y; y/ C .x2; y/2
.y; y/
 0;
which implies .x2; y/2  0; hence .x2; y/ D 0. Thus x2 2 M ?.
a

646
CHAPTER 4. MEASURES FOR PROBABILISTIC SYSTEMS
Thus H is decomposed into M and M ? for any closed linear sub-
space M of H in the sense that each element of H can be written as
a sum of elements of M and of M ?, and, even better, this decom-
position is unique.
These elements are perceived as the projections
to the subspaces. In the case that we can represent M as the kernel
fx 2 H j L.x/ D 0g of a continuous linear map L W H ! R with
L 6D 0, we can say actually more.
Lemma 4.11.8 Given Hilbert space H, let L W H ! R be a continuous
linear functional with L 6D 0. Then Kern.L/? is isomorphic to R.
Proof Deﬁne '.y/ WD L.y/ for y 2 Kern.L/?. Then '.˛y Cˇy0/ D
˛  '.y/ C ˇ  '.y0/ follows from the linearity of L. If '.y/ D '.y0/,
then y  y0 2 Kern.L/ \ Kern.L/?, so that y D y0; hence ' is one
to one. Given t 2 R, we ﬁnd x 2 H with L.x/ D t; decompose x
as x1 C x2 with x1 2 Kern.L/ and x2 2 Kern.L/?, then '.x2/ D
L.x  x1/ D t. Thus ' is onto. Hence we have found a linear and
bijective map Kern.L/? ! R. a
Returning to the decomposition of an element x 2 H, we ﬁx an arbitrary
y 2 Kern.L/nf0g. Then we may write x D x1C˛y, where ˛ 2 R. This
follows immediately from Lemma 4.11.8, and it has the consequence we
are aiming at.
Theorem 4.11.9 Let H be a Hilbert space and L W H ! R be a con-
tinuous linear functional. Then there exists y 2 H with L.x/ D .x; y/
for all x 2 H.
Proof If L D 0, this is trivial. Hence we assume that L 6D 0. Thus
we can ﬁnd ´ 2 Kern.L/? with L.´/ D 1; put y D   ´ so that
L.y/ D .y; y/. Each x 2 H can be written as x D x1 C ˛  y with
x1 2 Kern.L/. Hence
L.x/ D L.x1C˛y/ D ˛L.y/ D ˛.y; y/ D .x1C˛y; y/ D .x; y/:
Thus L D x:.x; y/ is established. a
Thus a Hilbert space does not only determine the space of all continuous
linear maps on it, but it is actually this space. Wonderful world of Hilbert
spaces! This property sets Hilbert spaces apart, making them particu-
larly interesting for applications, e.g., in quantum computing.
The rather abstract view of Hilbert spaces discussed in this section will
be put to use now to the more speciﬁc case of integrable functions.

4.11. Lp-SPACES
647
4.11.2
The Lp-Spaces are Banach Spaces
We will investigate now the structure of integrable functions for a ﬁxed
-ﬁnite measure space .X; A; /. We will obtain a family of Banach
spaces, all of which have some interesting properties. In the course of
investigations, we will usually not distinguish between functions which
differ only on a set of measure zero (because the measure will not be
aware of the differences). For this, we introduced above the equivalence
relation D (“equal -almost everywhere”) with f D g iff .fx 2
X j f .x/ 6D g.x/g/ D 0; see Sect. 4.2.1 on page 472. In those cases
where we will need to look at the value of a function at certain points,
we will make sure that we will point out the difference.
Let us see how this works in practice. Deﬁne
L1./
L1./ WD ff 2 F.X; A/ j
R
X jf j d < 1gI
thus f 2 L1./ iff f W X ! R is measurable and has a ﬁnite -
integral.
Then this space deﬁnes a vector space, which closed with respect to j  j;
hence we have immediately
Proposition 4.11.10 L1./ is a vector lattice.a
Now put
L1./
L1./ WD fŒf  j f 2 L1./gI
then we have to explain how to perform the algebraic operations on the
equivalence classes (note that we write Œf  rather than Œf , which we
will do when more than one measure has to be involved). Since the set
of all null sets is a -ideal, these operations are easily shown to be well
deﬁned:
Œf  C Œg WD Œf C g;
Œf   Œg WD Œf  g;
˛  Œf  WD Œ˛  f :
Thus we obtain
Proposition 4.11.11 L1./ is a vector lattice.a

648
CHAPTER 4. MEASURES FOR PROBABILISTIC SYSTEMS
Let f 2 L1./; then we deﬁne
k  k1
kf k1 WD
Z
X
jf j d
as the L1-norm for f . Let us have a look at the properties which a decent
norm should have. First, we have kf k1  0, and k˛ f k1 D j˛jkf k1;
this is immediate. Because jf C gj  jf j C jgj, the triangle inequality
holds. Finally, let kf k1 D 0, and thus
R
X jf j d D 0; consequently,
f D 0, which means f D Œ0.
This will be a basis for the deﬁnition of a whole family of linear spaces
of integrable functions. Call the positive real numbers p and q conjugate
Conjugate
numbers
iff they satisfy
1
p C 1
q D 1
(for example, 2 is conjugate to itself). This may be extended to p D 0,
so that we also consider 0 and 1 as conjugate numbers, but using this
pair will be made explicit.
The ﬁrst step for extending the deﬁnition of L1 will be H¨older’s inequal-
ity, which is based on this simple geometric fact.
Lemma 4.11.12 Let a; b be positive real numbers and p > 0 conjugate
to q; then
a  b  ap
p C bq
q ;
equality holding iff b D ap1.
Proof The exponential function is convex, i.e., we have
e.1˛/x˛y  .1  ˛/  ex C ˛  ey
for all x; y 2 R and 0  ˛  1. Because both a > 0 and b > 0, we ﬁnd
r; s such that a D er=p and b D es=q. Since p and q are conjugate, we
obtain from 1=p D 1  1=q
a  b D er=pCs=q  es
p C eq
q D ap
p C bq
q :
a
This betrays one of the secrets of conjugate p and q, viz., that they give
rise to a convex combination.

4.11. Lp-SPACES
649
We are ready to formulate and prove H¨older’s inequality, arguably one
of the most frequently used inequalities in integration (as we will see as
well); the proof follows the one given for [Rud74, Theorem 3.5].
Proposition 4.11.13 Let p > 0 and q > 0 be conjugate and f and g
be nonnegative measurable functions on X. Then
H¨older’s
inequality
Z
X
f  g d 
Z
X
f p d
1=p 
Z
X
gq d
1=q:
Proof Put for simplicity
A WD
Z
X
f p d
1=p and B WD
Z
X
gq d
1=q:
If A D 0, we may conclude from f D 0 that f  g D 0, so there is
nothing to prove. If A > 0 and B D 1, the inequality is trivial, so we
assume that 0 < A < 1; 0 < B < 1. Put
F WD f
A ; G WD g
B I
thus we obtain
Z
X
F p d D
Z
X
Gq d D 1:
We obtain F.x/  G.x/  F.x/p=p C G.x/q=q for every x 2 X from
Lemma 4.11.12; hence
Z
X
F  G d  1
p 
Z
X
F p d C 1
q 
Z
X
Gq d  1
p C 1
q D 1:
Multiplying both sides with A  B > 0 now yields the desired result.
a
This gives Minkowski’s inequality as a consequence. Put for f W X !
Minkowski’s
inequality
R measurable and for p  1
kf kp WD
Z
X
jf jp d
1=p:
Proposition 4.11.14 Let 1  p < 1 and let f and g be nonnegative
measurable functions on X. Then
kf C gkp  kf kp C kgkp:

650
CHAPTER 4. MEASURES FOR PROBABILISTIC SYSTEMS
Proof The inequality follows for p D 1 from the triangle inequality for
j  j, so we may assume that p > 1. We may also assume that f; g  0.
Then we obtain from H¨older’s inequality with q conjugate to p
kf C gkp
p D
Z
X
.f C g/p1  f d C
Z
X
.f C g/p1  g d
 kf C gkp=q
p


kf kp C kgkp

:
Now assume that kf C gkp D 1, we may divide by the factor kf C
gkp=q
p
, and we obtain the desired inequality from p  p=q D p  .1 
1=q/ D 1. If, however, the left-hand side is inﬁnite, then the inequal-
ity
.f C g/p  2p  maxff p; gpg  2p  .f p C gp/
shows that the right-hand side is inﬁnite as well. a
Given 1  p < 1, deﬁne
Lp./ WD ff 2 F.X; A/ j kf kp < 1g
with Lp./ as the corresponding set of D-equivalence classes. An
Lp./;
Lp./
immediate consequence from Minkowski’s inequality is
Proposition 4.11.15 Lp./ is a linear space over R, and k  kp is a
pseudo-norm on it. Lp./ is a normed space.
Proof It is immediate from Proposition 4.11.14 that f C g 2 Lp./
whenever f; g 2 Lp./, and Lp./ is closed under scalar multiplica-
tion as well. That k  kp is a pseudo-norm is also immediate. Because
scalar multiplication and addition are compatible with forming equiva-
lence classes, the set Lp./ of classes is a real vector space as well. As
usual, we will identify f with its class, unless otherwise stated. Now
f 2 Lp./ with kf kp D 0, then jf j D 0, hence f D 0, and thus
f D 0. So k  kp is a norm on Lp./. a
In Sect. 4.2.1 the vector spaces L1./ and L1./ are introduced, so
we have now a family

Lp./

1p1 of vector spaces together with
their associated spaces

Lp./

1p1 of -equivalence classes, which
are normed spaces. They share the property of being Banach spaces.
Proposition 4.11.16 Lp./ is a Banach space for 1  p  1.
Proof 1. Let us ﬁrst assume that the measure is ﬁnite. We know al-
ready from Proposition 4.2.9 that L1./ is a Banach space, so we may
assume that p < 1.

4.11. Lp-SPACES
651
Given .fn/n2N as a Cauchy sequence in Lp./, then we obtain
p  .fx 2 X j jfn  fmj  g/ 
Z
X
jfn  fmjp d
for  > 0. Thus .fn/n2N is a Cauchy sequence for convergence in
measure, so we can ﬁnd f 2 F.X; A/ such that fn
i:m:
! f by Propo-
sition 4.2.21. Proposition 4.2.16 tells us that we can ﬁnd a subsequence
.fnk/k2N such that fnk
a:e:
! f . But we do not yet know that f 2
Lp./. We infer limk!1 jfnk  f jp D 0 outside a set of measure
zero. Thus we obtain from Fatou’s Lemma (Proposition 4.8.5) for every
n 2 N
Z
X
jf  fnjp d  lim inf
k!1
Z
X
jfnk  fnjp d:
Thus f  fn 2 Lp./ for all n 2 N, and from f D .f  fn/ C fn,
we infer f 2 Lp./, since Lp./ is closed under addition. We see also
that kf  fnkp ! 0, as n ! 1.
2.
If the measure space is -ﬁnite, we may write
R
X f d as
limn!1
R
An f d, where .An/ < 1 for an increasing sequence
.An/n2N of measurable sets with S
n2N An D X. Since the restric-
tion to each An yields a ﬁnite measure space, where the result holds,
it is not difﬁcult to see that completeness holds for the whole space as
well. Speciﬁcally, given  > 0, there exists n0 2 N so that for all
n; m  n0
kfn  fmkp  kfn  fmk.n/
p
C 
holds, with kgk.n/
p
WD
R
X jgjp dn
1=p and n W B 7! .B \ An/
as the measure  localized to An. Then kfn  f k.n/
p
! 0, from which
we obtain kfn  f kp ! 0. Hence completeness is also valid for the
-ﬁnite case. a
Example 4.11.17 Let j  j be the counting measure on .N; P .N//; then
this is a -ﬁnite measure space. Deﬁne
`p WD Lp.j  j/; 1  p < 1;
`1 WD L1.j  j/:
Then `p is the set of all real sequences .xn/n2N with P
n2N jxnjp < 1
and .xn/n2N 2 `1 iff supn2N jxnj < 1. Note that we do not need to
pass to equivalence classes, since jAj D 0 iff A D ;. These spaces are
well known and well studied; here they make their only appearance. ✌

652
CHAPTER 4. MEASURES FOR PROBABILISTIC SYSTEMS
The case p D 2 deserves particular attention, since the norm in this case
is obtained from the inner product
.f; g/ WD
Z
X
f  g d:
In fact, linearity of the integral shows that
.˛  f C ˇ  g; h/ D ˛  .f; h/ C ˇ  .g; h/
holds, commutativity of multiplications yields .f; g/ D .g; f /, and ﬁ-
nally it is clear that .f; f /  0 always holds. If we have f 2 L2./
with f D 0, then we know that also .f; f / D 0; thus .f; f / D 0 iff
f D 0 in L2./.
Thus we obtain from Proposition 4.11.16
Corollary 4.11.18 L2./ is a Hilbert space with the inner product
.f; g/ WD
R
X f  g d: a
This will have some interesting consequences, which we will explore in
Sect. 4.11.3.
Before doing so, we show that the step functions belonging to Lp are
dense.
Corollary 4.11.19 Given 1  p < 1, the set ff 2 T .X; A/ j .fx 2
X j f .x/ 6D 0g/ < 1g is dense in Lp./ with respect to k  kp.
Proof The proof makes use of the fact that the step functions are dense
with respect to pointwise convergence: We will just have to mark those
functions which are in Lp./. Assume that f 2 Lp./ with f  0;
then there exists by Proposition 4.2.4 an increasing sequence .gn/n2N
of step functions with f .x/ D limn!1 fn.x/. Because 0  gn 
f , we conclude that gn belongs to the set under consideration, and
we know from Lebesgue’s Dominated Convergence Theorem 4.8.6 that
kf  gnkp ! 0. Thus every nonnegative element of Lp./ can be
approximated through elements of this set in the k  kp-norm. In the
general case, decompose f D f C  f  and apply the argument to
both summands separately. a
Because the rationals form a countable and dense subset of the reals, we
take all step functions with rational coefﬁcients, and obtain
Corollary 4.11.20 Lp./ is a separable Banach space for 1  p <
1. a

4.11. Lp-SPACES
653
Note that we did exclude the case p D 1; in fact, L1./ is usually not
a separable Banach space, as this example shows.
Example 4.11.21 Let  be Lebesgue measure on the Borel sets of the
unit interval Œ0; 1. Put ft WD Œ0;t for 0  t  1, then ft 2 L1./ for
all t, and we have jjfs  ftjj
1 D 1 for 0 < s < t < 1: Let
Kt WD ff 2 L1./ j jjf  ftjj
1 < 1=2g:
Then Ks\Kt D ; for s 6D t. In fact, if g 2 Ks\Kt, then jjfs  ftjj
1 
jjg  ftjj
1 C jjfs  gjj
1 < 1: On the other hand, each Kt is open, so
if we have a countable subset D  L1./, then Kt \ D D ; for
uncountably many t. Thus D cannot be dense. But this means that
L1./ is not separable. ✌
This is the ﬁrst installment on the properties of Lp-spaces. We will be
back with a general discussion in Sect. 4.11.4 after having explored the
Lebesgue–Radon–Nikodym Theorem as a valuable tool in general and
for our discussion in particular.
4.11.3
The Lebesgue–Radon–Nikodym Theorem
The Hilbert space structure of the L2-spaces will now be used for de-
composing a measure into an absolutely continuous and a singular part
with respect to another measure and for constructing a density. This
construction requires a more general study of the relationship between
two measures.
We even go a bit beyond that and deﬁne absolute continuity and singu-
larity as a relationship of two arbitrary additive set functions. This will
be specialized fairly quickly to a relationship between ﬁnite measures,
but this added generality will turn out to be beneﬁcial nevertheless, as
we will see.
Deﬁnition 4.11.22 Let .X; A/ be a measurable space with two additive
set functions ; 	 W A ! R.
1.  is said to be absolutely continuous with respect to 	 ( << 	) iff
 << 	
.E/ D 0 for every E 2 A for which 	.A/ D 0.
2.  is said to be concentrated on A 2 A iff .E/ D .E \ A/ for
all E 2 A.

654
CHAPTER 4. MEASURES FOR PROBABILISTIC SYSTEMS
3.  and 	 are called mutually singular ( ? 	) iff there exists a pair
 ? 	
of disjoint sets A and B such that  is concentrated on A and 	 is
concentrated on B.
If two additive set functions are mutually singular, they live on disjoint
measurable sets in the same measurable space. These are elementary
properties.
Lemma 4.11.23 Let 1; 2; 	 W A ! R be additive set functions; then
we have for a1; a2 2 R
1. If 1 ? 	 and 2 ? 	, then a1  1 C a2  2 ? 	.
2. If 1 << 	 and 2 << 	, then a1  1 C a2  2 << 	.
3. If 1 << 	 and 2 ? 	, then 1 ? 2.
4. If  << 	 and  ? 	, then  D 0.
Proof 1. For proving 1, note that we can ﬁnd a measurable set B and
sets A1; A2 2 A with B \ .A1 [ A2/ D ; with 	.E/ D 	.E \ B/
and i.E/ D i.E \ Ai/ for i D 1; 2. By additivity, we obtain .a1 
1 C a2  2/.E/ D .a1  1 C a2  2/.E \ .A1 [ A2//. Property 2 is
obvious.
2. 2 is concentrated on A2, 	 is concentrated on B with A \ B D ;,
hence 	.E \ A2/ D 0, and thus 1.E \ A2/ D 0 for all E 2 A.
Additivity implies 1.E/ D 1

E \ .X n A2/

, so 1 is concentrated
on X n A2. This proves 3. For proving 4, note that  << 	 and  ? 	
imply  ?  by property 3, which implies  D 0. a
We specialize these relations now to ﬁnite measures on A. Absolute
continuity can be expressed in a different way, which makes the con-
cept more transparent. Speciﬁcally, absolute continuity could have been
deﬁned akin to the well-known -ı deﬁnition of continuity for real func-
tions. Then the name becomes a bit more descriptive.
Lemma 4.11.24 Given ﬁnite measures  and  on a measurable space
.X; A/, these conditions are equivalent:
1.  << .
2. For every  > 0, there exists ı > 0 such that .A/ < ı implies
.A/ <  for all measurable sets A 2 A.

4.11. Lp-SPACES
655
Proof 1
)
2: Assume that we can ﬁnd  > 0 so that there ex-
ist sets An 2 A with .An/ < 2n but .An/  . Then we have
.S
kn Ak/   for all n 2 N; consequently, by monotone conver-
gence, also 
T
n2N
S
kn Ak

 . On the other hand, .S
kn Ak/ 
P
kn 2k D 2nC1 for all n 2 N, so by monotone convergence again,

T
n2N
S
kn Ak

D 0: Thus  <<  does not hold.
2 ) 1: Let .A/ D 0, then .A/   for every  > 0; hence  << 
is true. a
Given two ﬁnite measures  and , one, say , can be decomposed
uniquely as a sum a C s such that a <<  and s ? ; additionally
s ? a holds. This is stated and proved in the following theorem,
which actually shows much more, viz., that there exists a density h of
Density
a with respect to . This means that a.A/ D
R
A h d holds for all
A 2 A.
Densities are familiar from probability distributions, for example, the
normal distribution N.0; 1/ has the density ex2=2=
p
2  : This means
that a random variable which is distributed according to N.0; 1/ takes
values in the Borel set A 2 B.R/ with probability
R
A ex2=2=
p
2   dx.
This is but a special case. What a density is used for in our context will
be described now also in greater detail. Before entering into formalities,
it is noted that the decomposition is usually called the Lebesgue decom-
position of  with respect to  and that the density h is usually called
the Radon–Nikodym derivative of a with respect to  and denoted by
d=d.
The proof both for the existence of Lebesgue decomposition and of the
Radon–Nikodym derivative is done in one step. The beautiful proof
given below was proposed by von Neumann; see [Rud74, 6.9]. Here
we go.
Theorem 4.11.25 Let  and  be ﬁnite measures on .X; A/.
1. There exists a unique pair a and s of ﬁnite measures on .X; A/
such that  D a C s with a << , a ? . In addition,
a ? s holds.
2. There exists a unique h 2 L1./ such that
a.A/ D
Z
A
h d
for all A 2 A.

656
CHAPTER 4. MEASURES FOR PROBABILISTIC SYSTEMS
The line of attack will be as follows: We show that f 7!
R
X f d
Overview of
the proof
is a continuous linear functional on the Hilbert space L2. C /. We
can express this functional by the representation for these functionals on
Hilbert spaces through some function g 2 L2. C /; hence
Z
X
f d D
Z
X
f  g d. C /I
note the way the measures  and C interact by exploiting the integral
with respect to  as a linear functional on L2./. A closer investigation
of g will then yield the sets we need for the decomposition and permit
constructing the density h.
Proof 1. Deﬁne the ﬁnite measure ' WD  C  on A; note that
Z
X
f d' D
Z
X
f d C
Z
X
f d
holds for all measurable f for which the sum on the right-hand side is
deﬁned; this follows from Levi’s Theorem 4.8.2 (for f  0) and from
additivity (for general f ). We show ﬁrst that L W f 7!
R
X f d is a
continuous linear operator on L2.'/. In fact,
ˇˇ
Z
X
f d
ˇˇ 
Z
X
jf j d' D
Z
X
jf j  1 d' 
Z
X
djf j21=2 
p
'.X/
by Schwarz’s inequality (Lemma 4.11.1). Thus
sup
kf k21
jL.f /j 
p
'.X/ < 1:
Hence L is continuous (Exercise 4.29); thus by Theorem 4.11.9 there
exists g 2 L2./ such that
L.f / D
Z
X
f  g d'
(4.21)
for all f 2 L2./.
2. Let f D A for A 2 A; then we obtain
Z
A
g d' D .A/  '.A/
from (4.21). This yields 0  g  1 '-a.e.; we can change g on a set of
'-measure 0 to the effect that 0  g.x/  1 holds for all x 2 X. This
will not affect the representation in (4.21).

4.11. Lp-SPACES
657
We know that
Z
X
.1  g/  f d D
Z
X
f  g d
(4.22)
holds for all f 2 L2.'/. Put
A WD fx 2 X j 0  g.x/ < 1g;
B WD fx 2 X j g.x/ D 1g;
then A; B 2 A, and we deﬁne for E 2 A
a.E/ WD .E \ A/;
s.E/ WD .E \ B/:
If f
D B, then we obtain .B/ D
R
B g d D
R
B 0 d D 0
from (4.22), and thus .B/ D 0; so that s ? .
3. Replace for a ﬁxed E 2 A in (4.22) the function f by .1Cg C: : :C
gn/  E; then we have
Z
E
.1  gnC1/ d D
Z
E
g  .1 C g C : : : C gn/ d:
Look at the integrand on the right-hand side: It equals zero on B and in-
creases
monotonically
to
1
on
A;
hence
limn!1
R
E .1  gnC1/ d D .E \ A/ D a.E/. This provides a bound
for the left-hand side for all n 2 N. The integrand on the left-hand
side converges monotonically to some function 0  h 2 L1./ with
limn!1
R
E g  .1 C g C : : : C gn/ d D
R
E h d by Levi’s Theo-
rem 4.8.2. Hence we have
Z
E
h d D a.E/
for all E 2 A, in particular a << .
4. Assume that we can ﬁnd another pair 0
a and 0
s with 0
a << 
and 0
s ?  and  D 0
a C 0
s. Then we have a  0
a D 0
s  s
with a  0
a <<  and 0
s  s ?  by Lemma 4.11.23; hence s 
0
s D 0, again by Lemma 4.11.23, which implies a  0
a D 0. So the
decomposition is unique. From this, the uniqueness of the density h is
inferred. a
We obtain as a consequence the well-known Radon–Nikodym Theo-
rem.

658
CHAPTER 4. MEASURES FOR PROBABILISTIC SYSTEMS
Theorem 4.11.26 Let  and  be ﬁnite measures on .X; A/ with
Radon-
Nikodym
Theorem
 << . Then there exists a unique h 2 L1./ with .A/ D
R
A h d
for all A 2 A. Moreover, f 2 L1./ iff f  h 2 L1./; in this case
Z
X
f d D
Z
X
f  h d:
h is called the Radon–Nikodym derivative of  with respect to  and
sometimes denoted by d=d.
d=d
Proof Write m D a C s, where a and s are the Lebesgue
decomposition of  with respect to  by Theorem 4.11.25. Since s ? ,
we ﬁnd s D 0, so that a D . Then apply the second part of The-
orem 4.11.25 to . This accounts for the ﬁrst part. The second part
follows from this by an approximation through step functions according
to Corollary 4.11.19. a
Note that the Radon–Nikodym Theorem gives a one-to-one correspon-
dence of ﬁnite measures  such that  <<  and the Banach space
L1./.
Theorem 4.11.25 can be extended to complex measures; we will com-
ment on this after the Jordan decomposition has been established in
Proposition 4.11.32.
Both constructions have, as one might expect, a plethora of applica-
tions.
We will not discuss the Lebesgue decomposition further, but
rather focus on the Radon–Nikodym Theorem and discuss two appli-
cations, viz., identifying the dual space of the Lp-spaces for p < 1 and
disintegrating a measure on a product space.
But this is a place to have a look at integration by substitution, a tech-
nique well known from Calculus. The multidimensional case has been
mentioned at the end of Sect. 4.8.1 on page 549; we deal here with the
one-dimensional case. The approach displays a pretty interplay of in-
tegrating with respect to an image measure and the Radon–Nikodym
Theorem, which should not be missed.
We prepare the stage with an auxiliary statement, which is of interest of
its own. Recall that  denotes the inner measure (p. 89) with respect to
measure .
Lemma 4.11.27 Let .X; A; / and .Y; B; / be ﬁnite measure spaces
and  W X ! Y be measurable and onto such that . 

A

/ D 0,

4.11. Lp-SPACES
659
whenever .A/ D 0. Put  WD M. /./. Then there exists a measur-
able function w W X ! RC such that
1. f 2 L1./ iff .f ı g/  w 2 L1./.
2.
R
Y f .y/ d.y/ D
R
X .f ı  /.x/  g.x/ d.x/ for all f 2 L1./.
Proof We show ﬁrst that  << , from which we obtain a derivative.
Plan
This is used then through the change of variables formula from Corol-
lary 4.8.9 for obtaining the desired result.
In fact, assume that .B/ D 0 for some B 2 B and, equivalently,
. 1
B

/ D 0. By assumption 0 D . 

 1
B

/ D .B/, since
B D  

 1
B

due to  being onto. Thus we ﬁnd g1 W Y ! RC
such that f 2 L1./ iff f  g1 2 L1./ and
R
Y f d D
R
Y f  g1 d:
Since  D M. /./, we obtain from Corollary 4.8.9 that
Z
Y
f d D
Z
X
.f ı  /  .g1 ı  / d
holds. Putting g WD g1 ı  , the assertion follows. a
The rˆole of  as the image measure is interesting here. It just serves as a
kind of facilitator, but it remains in the background. Only the measures
 and  are acting, and the image measure is used only for obtaining the
Radon–Nikodym derivative and for converting its integral to an integral
with respect to its preimage through change of variables.
We specialize things now to intervals on the real line and make restric-
tive assumptions on  . Then—voil`a—the well-known formula on inte-
gration by substitution will result.
But ﬁrst a more general consequence of Lemma 4.11.27 is to be pre-
sented. We will be working with Lebesgue measure on intervals of the
reals. Here we assume that  W Œ˛; ˇ ! Œa; b is continuous with
the additional property that .A/ D 0 implies . 

A

/ D 0 for all
A  B.Œ˛; ˇ/. This class of functions is generally known as absolutely
continuous and discussed in great detail in [HS65, Sect. 18, Theorem
(18.25)]. We obtain from Lemma 4.11.27
Corollary 4.11.28 Let Œ˛; ˇ  R be a closed interval and  W Œ˛; ˇ !
Œa; b be a surjective and absolutely continuous function. Then there ex-
ists a Borel measurable function w W Œ˛; ˇ ! R such that
1. f 2 L1.Œa; b; / iff .f ı  /  w 2 L1.Œ˛; ˇ; /

660
CHAPTER 4. MEASURES FOR PROBABILISTIC SYSTEMS
2.
R b
a f .x/ dx D
R ˇ
˛ .f . .t//  w.t/ dt.
Proof The assertion follows from Lemma 4.11.27 by specializing  and
 to . a
If we restrict  further, we obtain even more speciﬁc information about
the function w. The following proof shows how we exploit the proper-
ties of  , viz., being monotone and having a continuous ﬁrst derivative,
through the deﬁnition of the integral as a limit of approximations on a
system on subintervals which get smaller and smaller. The subdivisions
in the domain are then related to the one in the range of  ; the relation-
ship is done through Lagrange’s Theorem which brings in the derivative.
But see for yourself.
Proposition 4.11.29 Assume that  W Œ˛; ˇ ! Œa; b is continuous and
monotone with a continuous ﬁrst derivative such that  .˛/ D a and
 .ˇ/ D b. Then f is Lebesgue integrable over Œa; b iff .f ı  /   0 is
Lebesgue integrable over Œ˛; ˇ, and
Z b
a
f .x/ dx D
Z ˇ
˛
f . .´//   0.´/ d´
holds.
We follow [Fic64, Nr. 316] in his proof. The basic idea is to approxi-
Basic idea
mate the integral through step functions, which are obtained by subdi-
viding the interval Œ˛; ˇ into subintervals, and to reﬁne the subdivisions,
using uniform continuity both of  and  0 on its compact domain. So
this is a fairly classical proof.
Proof 0. We may assume that f  0; otherwise we decompose f D
f C  f  with f C; f   0. Also we assume that f is bounded by
some constant L; otherwise we establish the property for f ^ n with
n 2 N, letting n ! 1 appeal to Levi’s Theorem 4.8.2. Moreover we
assume that  is increasing.
1. The interval Œ˛; ˇ is subdivided through ˛ D ´0 < ´1 < : : : <
´n D ˇ; put xi WD  .´i/; then a D x0  x1  : : :  xn D b, and
´i WD ´iC1´i, and xi WD xiC1xi. Let ` WD maxiD1;:::;n1 ´i;
then if ` ! 0, the maximal difference maxiD1;:::;n1 xi tends to 0 as
well, because  is uniformly continuous. This is so since the interval
Œ˛; ˇ is compact.

4.11. Lp-SPACES
661
For approximating the integral
R ˇ
˛ f . .´// 0.´/ d´, we select 	i from
each interval Œ´i; ´iC1 and write
S WD
X
i
f . .	i//   0.	i/  ´i:
Put 
i WD  .	i/; hence xi  
i  xiC1. By Lagrange’s Formula1 there
exists i 2 Œ´i; ´iC1 such that xi D  0.i/´i, so that we can write
as an approximation to the integral
R b
a f .x/ dx the sum
s WD
X
i
f .
i/  ´i
D
X
i
f .
i/   .i/  ´i
D
X
i
f . .	i//   0.i/  ´i:
If ` ! 0, we know that s !
R b
a f .x/ dx and S !
R ˇ
˛ f . .´// 
 0.´/ d´, so that we have to get a handle at the difference jS  sj. We
claim that this difference tends to zero, as ` ! 0. Given  > 0, we
ﬁnd ı > 0 such that j 0.	i/   0.i/j < , provided ` < ı. This is
so because  0 is continuous, hence uniformly continuous. But then we
obtain by telescoping
jS  sj 
X
i
jf . .	i//j  j 0.	i/   0.i/j  ´i < L  .ˇ  ˛/  :
Thus the difference vanishes, and we obtain indeed the equality claimed
above. a
4.11.4
Continuous Linear Functionals on Lp
After all these preparations and an excursion into classical Calculus, we
will investigate now continuous linear functionals on the Lp-spaces and
show that the map f 7!
R
X f d plays an important rˆole in identify-
ing them. For full generality with respect to the functional concern, we
introduce signed measures here and show that they may be obtained
1Recall that Lagrange’s Formula says the following: Assume that g is continuous
on the interval Œc; d with a continuous derivative g0 on the open interval c; dŒ. Then
there exists t 2 c; dŒ such that g.d/  g.c/ D g0.t/  .d  c/.

662
CHAPTER 4. MEASURES FOR PROBABILISTIC SYSTEMS
in a fairly speciﬁc way from the (unsigned) measures considered so
far.
But before entering into this discussion, we make some general remarks.
If V is a real vector space with a norm k  k, then a map  W V ! R
is a linear functional on V iff it is compatible with the vector space
structure, i.e., iff .˛  x C ˇ  y/ D ˛  .x/ C ˇ  .y/ holds for all
x; y 2 V and all ˛; ˇ 2 R. If  6D 0, the range of  is unbounded,
so supx2V j.x/j D 1. Consequently it is difﬁcult to assign to 
something like the sup-norm for characterizing continuity. It turns out,
however, that we may investigate continuity through the behavior of 
on the unit ball of V , so we deﬁne
kk WD sup
kxk1
j.x/j:
Call  bounded iff kk < 1. Then  is continuous iff  is bounded;
see Exercise 4.29.
Now let  be a ﬁnite measure with p and q conjugate to each other; see
page 648. Deﬁne for g 2 Lq./ the linear functional
g.f / WD
Z
X
f  g d
on Lp./; then we know from H¨older’s inequality in Proposition
4.11.13 that
kgk 
sup
kf kp1
Z
X
jf  gj d  kgkq:
That was easy. But what about the converse? Given a bounded linear
functional  on Lp./, does there exist g 2 Lq./ with  D g?
It is immediate that this will not work in general, since g.f /  0,
provided f  0. So we have to assume that  maps positive functions
to a nonnegative value. Call  positive iff this is the case.
Summarizing, we consider maps  W Lp./ ! R with these proper-
ties:
Linearity: .˛ x Cˇ y/ D ˛ .x/Cˇ .y/ holds for all x; y 2 V
and all ˛; ˇ 2 R.
Boundedness: kk WD supkf kpD1 j.f /j  1 (hence j.f /j 
kk  kf kp for all f ).

4.11. Lp-SPACES
663
Positiveness: f  0 ) .f /  0 (note that f  0 means f 0  0
almost everywhere with respect to  for each representative f 0 of
f by our convention).
We will ﬁrst work on this restricted problem, and then we will expand
the answer. This will require a slight generalization: We will talk about
signed measures rather than about measures.
Let us jump right in.
Theorem 4.11.30 Assume that  is a ﬁnite measure on .X; A/, 1 
p < 1, and that  is a bounded positive linear functional on Lp./.
Then there exists a unique g 2 Lq./ such that
.f / D
Z
X
f  g d
holds for each f 2 Lp./. In addition, kk D kgkq.
This is our line of attack: We will ﬁrst see that we obtain from  a ﬁnite
Line of
attack
measure  on A such that  << . The Radon–Nikodym Theorem will
then give us a density g WD d=d which will turn out to be the function
we are looking for. This is shown by separating the cases p D 1 and
p > 1.
Proof 1. Deﬁne for A 2 A
.A/ WD .A/:
Then A  B implies A  B; hence .A/  .B/. Because  is
monotone,  is monotone as well. Since  is linear, we have .;/ D 0,
and  is additive. Let .An/n2N be an increasing sequence of measurable
sets with A WD S
n2N An, then AnAn ! 0, and thus
.A/  .An/ D kAnAnkp
p D .AnAn/p ! 0;
since  is continuous. Thus  is a ﬁnite measure on A (note .X/ D
.1/ < 1). If .A/ D 0, we see that A D 0; thus .A/ D 0,
because we are dealing with the D-class of A, so that .A/ D 0.
Thus  << , and the Radon–Nikodym Theorem 4.11.26 provides us
with g 2 L1./ with
.A/ D .A/ D
Z
A
g d

664
CHAPTER 4. MEASURES FOR PROBABILISTIC SYSTEMS
for all A 2 A. Since the integral and  are linear, we obtain from
this
.f / D
Z
X
f  g d
for all step functions f .
2. We have to show that g 2 Lq./. Consider these cases.
Case p D 1: We have for each A 2 A
ˇˇ
Z
A
g d
ˇˇ  j.A/j  kk  kAk1 D kk  .A/:
But this implies jg.x/j  kk; thus kgk1  kk.
Case 1 < p < 1: Let
t WD fx2Xjg.x/0g  fx2Xjg.x/<0g;
then jgj D t  g, and t is measurable, since g is. Deﬁne An WD
fx 2 X j jg.x/j  ng, and put f WD An  jgjq1  t. Then
jf jp  An D jgj.q1/p  An
D jgjq  An;
An  .f  g/ D An  jgjq1  t  g
D An  jgjq  tI
thus
Z
An
jgjq d D
Z
An
f  g d D .f /  kk  Z
An
jgjq d1=p:
Since 1  1=p D 1=q, dividing by the factor kk and raising the
result by q yield
Z
En
jgjq d  kkq:
By Lebesgue’s Dominated Convergence Theorem 4.8.6, we ob-
tain kgkq  kk; hence g 2 Lq./, and kgkq D kk.
The proof is completed now by the observation that .f / D
R
X f  g d
holds for all step functions f . Since both sides of this equation represent
continuous functions and since the step functions are dense in Lp./ by
Corollary 4.11.19, the equality holds on all of Lp./. a

4.11. Lp-SPACES
665
This representation says something only for positive linear functions;
what about the rest? It turns out that we need to extend our notion of
measures to signed measures and that a very similar statement holds for
signed measures. Of course we will have to explain what the integral
of a signed measure is, but this will work out very smoothly. So what
we will do next is to deﬁne signed measures and to relate them to the
measures with which we have worked until now. We follow essentially
Halmos’ exposition [Hal50, 29].
Deﬁnition 4.11.31 A map  W A ! R is said to be a signed mea-
sure iff  is -additive, i.e., iff .S
n2N An/ D P
n2N .An/, whenever
.An/n2N is a sequence of mutually disjoint sets in A.
Clearly, .;/ D 0, since a signed measure  is ﬁnite, so the distinguish-
ing feature is the absence of monotonicity. It turns out, however, that we
can partition the whole space X into a positive and a negative part, that
restricting  to these parts will yield a measure each, and that  can be
written in this way as the difference of two measures.
Fix a signed measure . Call N 2 A a negative set iff .A \ N /  0
for all A 2 A; a positive set is deﬁned accordingly. It is immediate that
the difference of two negative sets is a negative set again and that the
union of a disjoint sequence of negative sets is a negative set as well.
Thus the union of a sequence of negative sets is negative again.
Proposition 4.11.32 Let  be a signed measure on A. Then there ex-
ists a pair XC and X of disjoint measurable sets such that XC is a
positive set and X is a negative set. Then C.B/ WD .B \ XC/
and .B/ WD .B \ X/ are ﬁnite measures on A such that  D
C  . The pair C and  is called the Jordan Decomposition of
Jordan de-
composition
C; 
the signed measure .
Proof 1. Deﬁne
˛ WD inff.A/ j A 2 A is negativeg > 1:
Assume that .An/n2N is a sequence of measurable sets with .An/ !
˛; then we know that A WD S
n2N An is negative again with ˛ D .A/.
In fact, put B1 WD A1, BnC1 WD AnC1 n Bn, then each Bn is negative,
and we have
.A/ D .
[
n2N
Bn/ D
X
n2N
.Bn/ D lim
n!1 .An/
by telescoping.

666
CHAPTER 4. MEASURES FOR PROBABILISTIC SYSTEMS
2. We claim that
XC WD X n A
is a positive set. In fact, assume that this is not true—now this is truly
the tricky part—then there exists E0  XC with .E0/ < 0. E0 cannot
be a negative set, because otherwise A[E0 would be a negative set with
.A [ E0/ D .A/ C .E0/ < ˛, which contradicts the construction
of A. Let k1 be the smallest positive integer such that E0 contains a
measurable set E1 with .E1/  1=k1. Now look at E0 n E1. We
have
.E0 n E1/ D .E0/  .E1/  .E0/  .E1/  .E0/  1=k1 < 0:
We may repeat the same consideration now for E0 n E1; let k2 be the
smallest positive integer such that E0 nE1 contains a measurable set E2
with .E2/  1=k2. This produces a sequence of disjoint measurable
sets .En/n2N with
EnC1  E0 n .E1 [ : : : [ En/;
and since P
n2N .En/ is ﬁnite (because S
n2N En 2 A and  takes
only ﬁnite values), we infer that limn!1 1=kn D 0.
3. Let F  F0 WD E0 n S
n2N En, and assume that .F /  0. Let ` be
the largest positive integer with .F /  1=`. Since kn ! 0, as n ! 1,
we ﬁnd m 2 N with 1=`  1=km. Since F  E0 n .E1 [ : : : [ Em/,
this yields a contradiction. But F0 is disjoint from A, and since
.F0/ D .E0/ 
X
n2N
.En/  .E0/ < 0;
we have arrived at a contradiction. Thus .E0/  0.
4. Now deﬁne C and  as the traces of  on XC and X WD A,
resp., then the assertion follows. a
It should be noted that the decomposition of X into XC and X is not
unique, but the decomposition of  into C and  is. Assume that XC
1
with X
1 and XC
2 with X
2 are two such decompositions. Let A 2 A,
then we have A \ .XC
1 n XC
2 /  A \ XC
1 , and hence .A \ .XC
1 n
XC
2 /  0; on the other hand, A \ .XC
1 n XC
2 /  A \ X
2 , and thus
.A \ .XC
1 n XC
2 /  0, so that we have .A \ .XC
1 n XC
2 / D 0, which
implies .A \ XC
1 / D .A \ XC
2 /. Thus uniqueness of C and 
follows.

4.11. Lp-SPACES
667
Given a signed measure  with a Jordan decomposition C and ,
we deﬁne a (positive) measure jj WD C C ; jj is called the total
variation of . It is clear that jj is a ﬁnite measure on A. A set A 2 A
Total
variation jj
is called a -nullset iff .B/ D 0 for every B 2 A with B  A;
hence A is a -null set iff A is a jj-null set iff jj.A/ D 0. In this
way, we can deﬁne that a property holds -everywhere also for signed
measures, viz., by saying that it holds jj everywhere (in the traditional
sense). Also the relation  <<  of absolute continuity between the
signed measure  and the positive measure  can be redeﬁned as saying
that each -null set is a -null set. Thus  <<  is equivalent to jj << 
and to both C <<  and  << . For the derivatives, it is easy to see
that
d
d D dC
d
 d
d ;
djj
d
D dC
d
C d
d
hold.
We deﬁne integrability of a measurable function through jj by putting
Lp.jj/ WD Lp.C/ \ Lp./;
and deﬁne Lp./ again as the set of equivalence classes.
These observations provide a convenient entry point into discussing
complex measures. Call  W A ! C a (complex) measure iff  is
Complex
measure
-additive, i.e., iff .S
n2N An/ D P
n2N .An/ for each sequence
.An/n2N of mutually disjoint sets in A. Then it can be easily shown that
 can be written as  D r C i c with (real) signed measures r and
c, which in turn have a Jordan decomposition and consequently a total
variation each. In this way the Lp-spaces can be deﬁned also for com-
plex measures and complex measurable functions; the reader is referred
to [Rud74] or [HS65] for further information.
Returning to the main current of the discussion, we are able to state the
general representation of continuous linear functionals on an Lp./-
space. We need only to sketch the proof, mutatis mutandis, since the
main work has already been done in the proof of Theorem 4.11.30 for
the real-valued and nonnegative case.
Theorem 4.11.33 Assume that  is a ﬁnite measure on .X; A/, 1 
p < 1 and that  is a bounded linear functional on Lp./. Then

668
CHAPTER 4. MEASURES FOR PROBABILISTIC SYSTEMS
there exists a unique g 2 Lq./ such that
.f / D
Z
X
f  g d
holds for each f 2 Lp./. In addition, kk D kgkq.
Proof .A/ WD .A/ deﬁnes a signed measure on A with  << .
Let h be the Radon–Nikodym derivative of  with respect to ; then
h 2 Lq./ and
.f / D
Z
X
f  h d
are shown as above. a
It should be noted that Theorem 4.11.33 holds also for -ﬁnite measures
and that it is true for 1 < p < 1 in the case of general (positive)
measures; see, e.g., [Els99, VII.3] for a discussion.
The case of continuous linear functionals for the space L1./ is con-
siderably more involved. Example 4.11.21 indicates already that these
spaces play a special rˆole. Looking back at the discussion above, we
found that for p < 1 the map A 7!
R
A jf jp d yields a measure,
and this measure was instrumental through the Radon–Nikodym The-
orem for providing the factor which could be chosen to represent the
linear functional. This argument, however, is not available for the case
p D 1, since we are not working there with a norm which is derived
from an integral. It can be shown, however, that continuous linear func-
tional has an integral representation with respect to ﬁnitely additive set
functions; in fact, [HS65, Theorem 20.35] or [DS57, Theorem IV.8.16]
shows that the continuous linear functionals on L1./ are in a one-to-
one correspondence with all ﬁnitely additive set functions 
 such that

 << . Note that this requires an extension of integration to not neces-
sarily -additive set functions.
4.11.5
Disintegration
We provide another application of the Radon–Nikodym Theorem.
One encounters occasionally the situation of needing to decompose a
measure on a product of two spaces. Consider this scenario. Given

4.11. Lp-SPACES
669
a measurable space .X; A/ as an input and .Y; B/ as an output space,
let
. ˝ K/.B/ D
Z
X
K.x/.Dx/ d.x/
be the probability for hx1; x2i 2 B 2 A˝B with  as the initial distribu-
tion and K W .X; A/  .Y; B/ as the transition law (see Example 4.9.4;
think of an epidemic which is set off according to  and propagates
according to K). Assume that you want to reverse the process: Given
F 2 B, you put
.F / WD S.Y . ˝ K//.F / D . ˝ K/.X  F /;
so this is the probability that your process hits an element of F . Can
you ﬁnd a stochastic relation L W .Y; B/  .X; A/ such that
. ˝ K/.B/ D
Z
X
L.x/.By/ d.y/
holds? The relation L is the converse of K given . It is probably
not particularly important that the measure on the product has the shape
˝K, so we state the problem in such a way that we are given a measure
on a product of two measurable spaces, and the question is whether we
can decompose it into the product of a projection onto one space, and a
stochastic relation between the spaces.
This problem is of course easiest dealt with when one can deduce that
the measure is the product of measures on the coordinate spaces; proba-
bilistically, this would correspond to the distribution of two independent
random variables. But sometimes one is not so lucky, and there is some
hidden dependence, or one simply cannot assess the degree of indepen-
dence. Then one has to live with a somewhat weaker result: In this case
one can decompose the measure into a measure on one component and
a transition probability. This will be made speciﬁc in the discussion to
follow.
Because it will not cost substantially more attention, we will treat the
question a bit more generally. Let .X; A/, .Y; B/; and .Z; C/ be mea-
surable spaces, assume that  2 S.X; A/, and let f W X ! Y and
g W X ! Z be measurable maps. Then f WD S.f /./ and g WD
S.g/./ deﬁne subprobabilities on .Y; B/ resp. .Z; C/. f and g can
be interpreted as the distribution of f resp. g under .

670
CHAPTER 4. MEASURES FOR PROBABILISTIC SYSTEMS
We will show that we can represent the joint distribution as
.fx 2 X j f .x/ 2 B; g.x/ 2 Cg/ D
Z
B
K.y/.C/ df .y/;
where K W .Y; B/  .Z; C/ is a suitable stochastic relation. This will
require Z to be a Polish space with C D B.Z/.
Let us see how this corresponds to the initially stated problem. Suppose
X WD Y  Z with A D B ˝ C, and let f WD Y , g WD Z; then
f .B/
D
.B  Z/;
g.C/
D
.Y  Z/;
.B  C/
D
.fx 2 X j f .x/ 2 B; g.x/ 2 Cg/:
Granted that we have established the decomposition, we can then write
.B  C/ D
Z
B
K.y/.C/ df .y/I
thus we have decomposed the probability on the product into a prob-
ability on the ﬁrst component and, conditioned on the value the ﬁrst
component may take, a probability on the second factor.
Deﬁnition 4.11.34 Using the notation from above, K is called a regular
conditional distribution of g given f iff
.fx 2 X j f .x/ 2 B; g.x/ 2 Cg/ D
Z
B
K.y/.C/ f .dy/
holds for each B 2 B; C 2 C, where K W .Y; B/  .C; C/ is a
stochastic relation on .X; A/ and .Z; C/. If only y 7! K.y/.C/ is
B-measurable for all C 2 C, then it will be called a conditional distri-
bution of g given f .
The existence of a regular conditional distribution will be established,
provided Z is Polish with C D B.Z/. This will be accomplished in sev-
eral steps: First the existence of a conditional distribution will be shown
using the Radon–Nikodym Theorem. The latter construction will then
be examined further. It will turn out that there exists a set of measure
zero outside of which the conditional distribution behaves like a regular
one, but at ﬁrst sight only on an algebra of sets, not on the entire -
algebra. But do not worry; the second step will apply a classical exten-
sion argument and yield a regular conditional distribution on the Borel

4.11. Lp-SPACES
671
sets, just as we want it. The proofs are actually a kind of a round trip
through the important techniques from measure theory, with the Radon–
Nikodym Theorem together in the driver’s seat. It displays also some
nice and helpful proof techniques.
We ﬁx .X; A/, .Y; B/; and .Z; C/ as measurable spaces, assume that
 2 S.X; A/, and take f W X ! Y and g W X ! Z to be measurable
maps. The measures f WD S.f /./ and g WD S.g/./ are deﬁned
as above as the distribution of f resp. g under .
The existence of a conditional distribution of g given f is established
ﬁrst, and it is shown that it is essentially unique.
Lemma 4.11.35 Using the notation from above, then
1. there exists a conditional distribution K0 of g given f ,
2. if there is another conditional distribution K0
0 of g given f , then
there exists for any C 2 C a set NC 2 B with f .NC / D 0 such
that K0.y/.C/ D K0
0.C/ for all y … C.
Proof 1. Fix C 2 C; then
$C .B/ WD .f 1
B

\ g1
C

/
deﬁnes a subprobability measure $C on B which is absolutely continu-
ous with respect to g,
because g.B/
D
0 implies $C
.B/ D 0. The Radon–Nikodym Theorem 4.11.26 now gives a density
hC 2 F.Y; B/ with
$C .B/ D
Z
B
hC df
for all B 2 B. Setting K0.y/.C/ WD hC .y/ yields the desired condi-
tional distribution.
2. Suppose K0
0 is another conditional distribution of g given f ; then we
have
8B 2 B W
Z
B
K0.y/.C/ df .y/ D
Z
B
K0.y/.C/ df .y/;
for all C 2 C, which implies that the set on which K0./.C/ disagrees
with K0
0./.C/ is f -null. a
Essential uniqueness may be strengthened if the -algebra C is count-
ably generated and if the conditional distribution is regular.

672
CHAPTER 4. MEASURES FOR PROBABILISTIC SYSTEMS
Lemma 4.11.36 Assume that K and K0 are regular conditional distri-
butions of g given f and that C has a countable generator. Then there
exists a set N 2 B with f .N / D 0 such that K.y/.C/ D K0.y/.C/
for all C 2 C and all y … N .
Proof If C0 is a countable generator of C, then
Cf WD f
\
E j E  C0 is ﬁniteg
is a countable generator of C as well, and Cf is closed under ﬁnite in-
tersections; note that Z 2 Cf . Construct for D 2 Cf the set ND 2 B
outside of which K./.D/ and K0./.D/ coincide, and deﬁne
N WD
[
D2Cf
ND 2 B:
Evidently, f .N / D 0: We claim that K.y/.C/ D K0.y/.C/ holds for
all C 2 C, whenever y … N . In fact, ﬁx y … N , and let
C1 WD fC 2 C j K.y/.C/ D K0.y/.C/gI
then C1 contains Cf by construction and is closed under complements
and countable disjoint unions. Thus C D .Cf /  C1; by the --
Theorem 1.6.30, and we are done. a
We will show now that a regular conditional distribution of g given f
Steps for the
proof
exists. This will be done through several steps, given the construction
of a conditional distribution K0:
①A set Na 2 B is constructed with f .Na/ D 0 such that K0.y/
is additive on a countable generator C´ for C.
②We construct a set N´ 2 B with f .N´/ D 0 such that K0.y/
.Z/  1 for y … N´.
③For each element G of C´, we will ﬁnd a set NG 2 B with
f .NG/ D 0 such that K0.y/.G/ can be approximated from
inside through compact sets, whenever y … NG.
④Then we will combine all these sets of f -measure zero to pro-
duce a set N 2 B with f .N / D 0 outside of which K0.y/ is
-additive on the generator C´ and hence can be extended to a
measure on all of C.
Well, this looks like a full program, so let us get on with it.

4.11. Lp-SPACES
673
Theorem 4.11.37 Given measurable spaces .X; A/ and .Y; B/, a Pol-
ish space Z, a subprobability  2 S.X; A/, and measurable maps
f W X ! Y , g W X ! Z, there exists a regular conditional distribution
K of g given f . K is uniquely determined up to a set of f -measure
zero.
Proof 0. Since Z is a Polish space, its topology has a countable base.
We infer from Lemma 4.3.2 that B.Z/ has a countable generator C.
Then the Boolean algebra C1 generated by C is also a countable genera-
tor of B.Z/.
1.
Given Cn
2 C1, we ﬁnd by Proposition 4.10.12 a sequence
.En;k/k2N of compact sets in Z with
En;1  En;2  En;3 : : :  Cn
such that
g.Cn/ D sup
k2N
g.En;k/:
Then the Boolean algebra C´ generated by C [ fEn;k j n; k 2 Ng is also
a countable generator of B.Z/.
2. From the construction of the conditional distribution of g given f ,
we infer that for disjoint C1; C2 2 C´
Z
Y
K0.y/.C1 [ C2/ df .y/
D .fx 2 X j f .x/ 2 B; g.x/ 2 C1 [ C2g/
D .fx 2 X j f .x/ 2 B; g.x/ 2 C1g/ C
.fx 2 X j f .x/ 2 B; g.x/ 2 C2g/
D
Z
Y
K0.y/.C1/ df .y/ C
Z
Y
K0.y/.C2/ df .y/:
Thus there exists NC1;C2 2 B with f .NC1;C2/ D 0 such that
K0.y/.C1 [ C2/ D K0.y/.C1/ C K0.y/.C2/
for y … NC1;C2. Because C´ is countable, we may deduce (by taking
the union of NC1;C2 over all pairs C1; C2) that there exists a set Na 2 B
such that K0 is additive outside Na and f .Na/ D 0. This accounts for
part ①in the plan above.
①✓
3. By the previous arguments, it is easy to construct a set N´ 2 B with
f .N´/ D 0 such that K0.y/.Z/  1 for y … N´ (part ②).
②✓

674
CHAPTER 4. MEASURES FOR PROBABILISTIC SYSTEMS
4. Because
Z
Y
K0.y/.Cn/ df .y/
D .f 1
Y

\ g1
Cn

/
D g.Cn/
D sup
k2N
g.En;k/
D sup
k2N
Z
Y
K0.y/.En;k/ f .dy/
(Levi’s Theorem 4.8.2)
D
Z
Y
sup
k2N
K0.y/.En;k/ df .y/;
we ﬁnd for each n 2 N a set Nn 2 B with
8y … Nn W K0.y/.Cn/ D sup
k2N
K0.y/.En;k/
and f .Nn/ D 0. This accounts for part ③.
③✓
5. Now we may begin to work on part ④. Put
N WD Na [ N´ [
[
n2N
NnI
then N 2 B with f .N / D 0. We claim that K0.y/ is a premeasure
on C´ for each y … N . It is clear that K0.y/ is additive on C´, hence
monotone, so only -additivity has to be demonstrated: Let .D`/`2N be
a sequence in C´ that is monotonically decreasing with
 WD inf
`2N K0.y/.D`/ > 0I
then we have to show that
\
`2N
D` 6D ;:
We approximate the sets D` now by compact sets, so we assume that
D` D Cn` for some n` (otherwise the sets are compact themselves).
By construction we ﬁnd for each ` 2 N a compact set En`;k`  C`
with
K0.y/.Cn` n En`;k`/ <   2`C1;

4.11. Lp-SPACES
675
then
Er WD
r\
iD`
En`;k`  Cnr D Dr
deﬁnes a decreasing sequence of compact sets with
K0.y/.Er/  K0.y/.Cnr/ 
r
X
iD`
K0.y/.En`;k`/ > =2; and
thus Er 6D ;. Since Er is compact and decreasing, we know that the
sequence has a nonempty intersection (otherwise one of the Er would
already be empty). We may infer
\
`2N
D` 	
\
r2N
Er 6D ;:
6. The Extension Theorem 1.6.29 now tells us that there exists a unique
extension of K0.y/ from C´ to a measure K.y/ on .C´/ D B.Z/,
whenever y … N . If, however, y 2 N , then we deﬁne K.y/ WD ,
where  2 S.Z/ is arbitrary. Because
Z
B
K.y/.C/ df .y/ D
Z
B
K0.y/.C/ df .y/
D .fx 2 X j f .x/ 2 B; g.x/ 2 Cg/
holds for C 2 C´, the --Theorem 1.6.30 asserts that this equality is
valid for all C 2 B.Z/ as well.
Measurability of y 7! K.y/.C/ needs to be shown, and then we are
done. We do this through the principle of good sets: Put
E WD fC 2 B.Z/ j y 7! K.y/.C/ is B  measurableg:
Then E is a -algebra, and E contains the generator C´ by construction;
thus E D B.Z/. a
④✓
The scenario in which the space X D Y  Z with a measurable space
.Y; B/ and a Polish space Z with A D B ˝ B.Z/ with f and g as
projections deserves particular attention. In this case we decompose a
measure on A into its projection onto Z and a conditional distribution
for the projection onto Z given the projection onto Y . This is sometimes
called the disintegration of a measure  2 S.Y  Z/.
We state the corresponding proposition explicitly, since one needs it usu-
ally in this specialized form.

676
CHAPTER 4. MEASURES FOR PROBABILISTIC SYSTEMS
Proposition 4.11.38 Given a measurable space .Y; B/ and a Polish
space Z, there exists for every subprobability  2 S.Y  Z; B ˝ B.Z//
a regular conditional distribution of Z given Y , that is, a stochastic
relation K W .Y; B/  .Z; B.Z// such that
.E/ D
Z
Y
K.y/.Ey/ dS.Y /./.y/
for all E 2 B ˝ B.Z/. a
The construction requires a Polish as one of the factors. The proof shows
that it is indeed tightness which saves the day. Otherwise it would be
difﬁcult to make sure that the conditional distribution constructed above
is -additive. We know from Proposition 4.10.12 that ﬁnite measures on
a Polish space are tight. In fact, examples show that this assumption is
in fact necessary: [Kel72] constructs a product measure on spaces which
fail to be Polish, for which no disintegration exists.
4.12
Bibliographic Notes
Most topics of this chapter are fairly standard; hence there are plenty
of sources to mention. One of my favorite texts is the rich compendium
written by Bogachev [Bog07], not to forget Fremlin’s massive [Fre08] or
Halmos’ classic [Hal50]. The discussion on Souslin’s operation A .A/
on a -algebra A is heavily inﬂuenced by Srivastava’s representation
[Sri98] of this topic, but see also [Par67, Arv76, Kel72]. The measure
extension
is
taken
from
[Lub74],
following
a
suggestion
by
S.M. Srivastava; the extension of a stochastic relation is from [Dob12b].
The approach to integration centering around B. Levi’s Theorem is taken
mostly from the elegant representation by Doob [Doo94, Chap. VI]; see
also [Els99, Kapitel IV]. The introduction of the Daniell integral follows
essentially [Bog07, Sect. 7.8]; see also [Kel72]. The logic CSL is de-
ﬁned and investigated in terms of model checking in [BHHK03], and the
stochastic interpretation is taken from [Dob07]; see also [DP03]. The
Hutchinson metric is discussed in detail in Edgar’s monograph [Edg98],
from which the present proof of Proposition 4.10.13 is taken. There
are many ﬁne books on Banach spaces, Hilbert spaces, and the applica-
tion to Lp spaces; my sources are [Doo94, Hal50, Rud74, DS57, Loo53,
Sch70]. The exposition of projective limits and of disintegration follows
basically [Par67, Chap. V] with an occasional glimpse at [Bog07].

4.13. EXERCISES
677
4.13
Exercises
Exercise 4.1 Assume that A D .A0/. Show that the weak -algebra
}}}.A/ on M.X; A/ is the initial -algebra with respect to fevA j A 2
A0g.
Show also that both S.X; A/ and P .X; A/ are measurable subsets of
M.X; A/.
Exercise 4.2 Let .X; / be a topological and .Y; d/ a metric space.
Each continuous function X ! Y is also Baire measurable.
Exercise 4.3 Let .X; d/ be a separable metric space,  2 M.X; B.X//.
Show that x 2 supp./ iff .U / > 0 for each open neighborhood U
of x.
Exercise 4.4 Let .X; A; / be a ﬁnite measure space. Show that norm
convergence in L1.X; A; / implies convergence almost everywhere
(fn
a:e:
! f , provided jjfn  f jj
1 ! 0). Give an example showing that
the converse is false.
Exercise 4.5 If A is a -algebra on X and B  X with A 62 A, then
f.A1 \ B/ [ .A2 \ .X n B// j A1; A2 2 Ag
is the smallest -algebra .A [ fBg/ on X containing A and B. If  is
a topology on X with H 62 , then
fG1 [ .G2 \ H/ j G1; G2 2 g
is the smallest topology H on X containing  and H.
Show that
B.H/ D .A [ fHg/
Exercise 4.6 Let .X; A; / be a ﬁnite measure space, B 62 A, and ˇ WD
˛  .B/ C .1  ˛/  .B/ with 0  ˛  1. Then there exists a
measure  on .A [ fBg/ which extends  such that .B/ D ˇ: (Hint:
Exercise 4.5).
Exercise 4.7 Given the measurable space .X; A/ and f 2 F.X; A/
with f  0, show that there exists a decreasing sequence .fn/n2N of
step functions fn 2 F.X; A/ with
f .x/ D inf
n2N fn.x/
for all x 2 X:

678
CHAPTER 4. MEASURES FOR PROBABILISTIC SYSTEMS
Exercise 4.8 Let fi W Xi ! Yi be Ai-Bi-measurable maps for i 2 I.
Show that
f W
( Q
i2I Xi
! Q
i2I Yi
.xi/i2I
7! .fi.xi//i2I
is N
i2I Ai-N
i2I Bi-measurable. Conclude that the kernel of f
ker .f / WD fhx; x0i j f .x/ D f .x0/g
is a measurable subset of Y  Y , whenever f W .X; A/ ! .Y; B/ is
measurable and B is separable.
Exercise 4.9 Let f W X ! Y be A-B measurable, and assume that B
is separable. Show that the graph graph.f / WD fhx; f .x/i j x 2 Xg of
f is a measurable subset of A ˝ B.
Exercise 4.10 Let A be the indicator function of set A. Show that
1. A  B iff A  B,
2. S
n2N An D supn2N An and T
n2N An D infn2N An
3. AB D jA  Bj D A C B .mod 2/. Conclude that the
power set .P .X/ ; / is a commutative group with AA D ;.
4.
S
n2N An


S
n2N Bn

 S
n2N.AnBn/
Exercise 4.11 Let .X; A; / be a ﬁnite measure space, and put
d.A; B/ WD .AB/ for A; B 2 A. Show that .A; d/ is a complete
pseudometric space.
Exercise 4.12 (This Exercise draws heavily on Exercises 4.5 and 4.6).
Let X WD Œ0; 1 with  as the Lebesgue measure on the Borel set of
X. There exists a set B  X with .B/ D 0 and .B/ D 1 by
Lemma 1.7.7, so that B 62 B.X/.
1. Show that .X; B/ is a Hausdorff space with a countable base,
where B is the smallest topology containing the interval topology
on Œ0; 1 and B (see Exercise 4.5).
2. Extend  to a measure  with ˛ D 1=2 in Exercise 4.6.
3. Show that inff.G/ j G 	 X n B and G is B-openg D 1, but
.X n B/ D 1=2. Thus  is not regular (since .X; B/ is not a
metric space).

4.13. EXERCISES
679
Exercise 4.13 Prove Proposition 4.3.18.
Exercise 4.14 Let K W .X; A/  .Y; B/ be a transition kernel.
1. Assume that f 2 FC.Y; B/ is integrable with respect to K.x/ for
all x 2 X. Show that
K.f /.x/ WD
Z
X
f dK.x/
deﬁnes a measurable function K.f / W X ! RC.
2. Assume that x 7! K.x/.Y / is bounded. Deﬁne for B 2 B
K./.B/ WD
Z
X
K.x/.B/ d.x/:
Show that KW S.X; A/!S.Y; B/ is }}}.X; A/-}}}.Y; B/-measurable
(see Example 2.4.8).
Exercise 4.15 Let  2 S.X; A/ be s subprobability measure on .X; A/,
and let K W .X; A/  .Y; B/ be a stochastic relation. Assume that
f W X  Y ! R is bounded and measurable. Show that
Z
X	Y
f d ˝ K D
Z
X
Z
Y
fx dK.x/

d.x/
( ˝ K is deﬁned in Example 4.9.4 on page 560).
Exercise 4.16 Let K W .X; A/  .Y; B/ and L W .Y; B/  .Z; C/ be
stochastic relations. Then the convolution L  K can be represented as
.L  K/.x/ D S.Z/.K.x/ ˝ L/.
Exercise 4.17 Let S WD f1; : : : ; ng for some n 2 N. Show that the weak
topology on M.S; P .S// can be identiﬁed with the Euclidean topology
on .RC/n.
Exercise 4.18 Let .S; A/ be a measurable space, and assume that A
is countably generated. Show that a stochastic effectivity function P W
S ! E.S/ is A-B./-measurable, where  is the Priestley topology on
}}}.S; A/. This topology is deﬁned in Example 1.5.58 on page 63.
Exercise 4.19 Show that the category of analytic spaces with measur-
able maps is not closed under taking pushouts. Hint: Show that the
pushout of X=˛1 and X=˛2 is X=.˛1 [ ˛2/ for equivalence relations
˛1 and ˛2 on a Polish space X. Then use Proposition 4.4.22 and Exam-
ple 4.4.29.

680
CHAPTER 4. MEASURES FOR PROBABILISTIC SYSTEMS
Exercise 4.20 Let X and Y be Polish spaces with a transition kernel
K W X  Y . The equivalence relations ˛ on X and ˇ on Y are assumed
to be smooth with determining sequences .An/n2N resp. .Bn/n2N of
Borel sets. Put I˛ WD .fAn j n 2 Ng and Jˇ WD .fBn j n 2 Ng.
Show that the following statements are equivalent:
1. K W .X; I˛/  .Y; Jˇ/ is a transition kernel.
2. .˛; ˇ/ is a congruence for K.
3. ˛  ker

S.ˇ ı K/

.
4. There exists a transition kernel K0 W .X; I˛/  .Y; Jˇ/ such that
.i˛; jˇ/ W K ! K0 is a morphism, where the measurable maps
i˛ W .X; B.X// ! .X; I˛/ and jˇ W .Y; B.Y // ! .Y; Iˇ/ are
given by the respective identities.
Exercise 4.21 Let SX be the set of all smooth equivalence relations on
the Polish space X, which is ordered by inclusion. Then SX is closed
under countable inﬁma, and X    rX, where rX WD X  X is
the universal relation.
1.  7! fA 2 B.X/ j A is   invariantg is an order reversing bijec-
tion between SX and the countably generated sub--algebras of
B.X/ such that X 7! B.X/ and rX 7! f;; Xg.
2. Deﬁne for x; x0 2 X with x 6D x0 the equivalence relation
#x;x0 WD X [ fhx; x0i; hx0; xig. Then #x;x0 is an atom of SX.
Describe the -algebra of #x;x0-invariant Borel sets.
3. Deﬁne for the Borel set B with ; 6D B 6D X the equivalence
relation B through x B x0 iff fx; x0g  B or fx; x0g \ B D ;
for all x; x0 2 X. Then B is an anti-atom in SX (i.e., an atom in
the reverse order). Describe the -algebra of B-invariant Borel
sets.
4. Show that for each  2 SX, there exists a countable family
.ˇn/n2N of anti-atoms with  D V
n2N ˇn.
5. Show that B ^ #x;x0 D X and B _ #x;x0 D rX, whenever B
is a Borel set with ; 6D B 6D X and x 2 B, x0 62 B.
Exercise 4.22 Let ˛ and ˇ be smooth equivalence relations on the Pol-
ish spaces X resp. Y , and assume that we have an injective map f W

4.13. EXERCISES
681
X=˛ ! Y=ˇ. Deﬁne f  W ˙˙˙˛.X/ ! ˙˙˙ˇ.Y / through f .A/ WD
Sff .Œx˛/ j Œx˛ 2 Ag: Show that f  is an isomorphism.
Exercise 4.23 Let Y be a Polish space, F W X ! F.Y / be a map, and
L be an algebra of sets on X. We assume that F w.G/ 2 L for each
open G  Y (F w is deﬁned on page 538). Show that there exists a map
s W X ! Y such that s.x/ 2 F.x/ for all x 2 X such that s1
B

2 L
for each B 2 B.Y /. Hint: Modify the proof for Theorem 4.7.2 suitably.
Exercise 4.24 Given a ﬁnite measure space .X; A; /, let f D Pn
iD1
˛i Ai be a step function with A1; : : : ; An 2 A and coefﬁcients ˛1; : : : ;
˛n. Show that
n
X
iD1
˛i  .Ai/ D
X
>0
  .fx 2 X j f .x/ D g/:
Exercise 4.25 Let .Y; B/ be a measurable space and assume that X is
compact metric; C.X/ is the set of all nonempty compact subsets of X
endowed with the Hausdorff metric ıH; see Example 3.5.10. Show that
F W Y ! C.X/ is B-B.C.X// measurable iff F is measurable as a
relation (in the sense of Deﬁnition 4.7.1 on page 538).
Exercise 4.26 Show that .C.X/; ıH/ is second countable iff .X; d/ is.
Exercise 4.27 Let .X; A/ be a measurable space with two effectivity
functions P and Q on it.
1. Deﬁne for A 2 A and 0  q  1
P C.A; q/ WD fx 2 X j ˇˇˇA.A; > q/ 2 P.x/g:
Show that P C W A  Œ0; 1 ! A such that A 7! P C.A; q/ is
monotone for each q.
2. Put
GQ.A; q/ WD f 2 S.X; A/ j
Z 1
0
.QC.A; r/ dr  qg:
Show that .P C  QC/.A; q/ WD fx 2 X j GQ.A; q/ 2 P.s/g
deﬁnes a map A  Œ0; 1 ! A such that A 7! .P C  QC/.A; q/
is monotone for each q.
This construction serves as a stand-in for the Kleisli product in the in-
terpretation of game logic in Sect. 4.9.4.

682
CHAPTER 4. MEASURES FOR PROBABILISTIC SYSTEMS
Exercise 4.28 Given the plane E WD fhx1; x2; x3i 2 R3 j 2  x1 C 4 
x2  7  x3 D 12g, determine the point in E which is closest to h4; 2; 0i
in the Euclidean distance.
Exercise 4.29 Let .V; k  k/ be a real normed space and L W V ! R
be linear. Show that L is continuous iff L is bounded, i.e., iff supkvk1
jL.v/j < 1:
Exercise 4.30 Let .V; k  k/ be a real normed space, and deﬁne
V  WD fL W V ! R j L is linear and continuousg;
the dual space of V . Then V  is a vector space. Show that
kLk WD sup
kvk1
jL.v/j
deﬁnes a norm on V  with which .V ; k  k/ is a Banach space.
Exercise 4.31 Let H be a Hilbert space, then H  is isometrically iso-
morphic to H.
Exercise 4.32 Let .V; k  k/ be a real normed space, and deﬁne
.x/.L/ WD L.x/
for x 2 V and L 2 V .
1. Show that .x/ 2 V  and that x 7! .x/ deﬁnes a continuous
map V ! V .
2. Given x 2 V with x 6D 0, there exists L 2 V  with kLk D 1 and
L.x/ D kxk (use the Hahn–Banach Theorem 1.5.14).
3. Show that  is an isometry (thus a normed space can be embedded
isometrically into its bidual).
Exercise 4.33 Given a real vector space V :
1. Let .; / be an inner product on V . Show that the parallelogram
law
kx C yk2 C kx  yk2 D 2  kxk2 C 2  kyk2
always holds (see page 641).

4.13. EXERCISES
683
2. Assume, conversely, that k  k is a norm for which the parallelo-
gram law holds. Show that
.x; y/ WD kx C yk2  kx  yk2
4
deﬁnes an inner product on V .
Exercise 4.34 Let H be a Hilbert space and L W H ! R be a contin-
uous linear map with L 6D 0. Relating Kern.L/ and ker .L/, show that
H=Kern.L/ and R are isomorphic as vector spaces.

List of Examples
This is a list of most examples together with a short description, ordered
by chapters. It should help to ﬁnd an example quickly.
The Axiom of Choice and Some of Its Equivalents
Example 1.2.2
There is no injection P .N/ ! N (p. 11).
Example 1.3.1
Minimum vs. minimal element (p. 16).
Example 1.3.2
The greatest common divisor as sup, the least com-
mon multiple as inf (p. 16).
Example 1.3.3
Maximal element need not be comparable (p. 16).
Example 1.3.7
Reduction systems use well orders for termination
(p. 17).
Example 1.3.10
Well ordering a union of well-ordered sets with a well-
ordered index set (p. 18).
Example 1.4.2
Construct the somewhat natural numbers through a
well order (p. 21).
Example 1.4.3
˛ [ f˛g is an ordinal for ordinal ˛ (p. 21).
Example 1.5.10
p
2 and
p
3 are linearly independent over Q (p. 37).
Example 1.5.16
Filter based on a point, coﬁnite ﬁlter (p. 42).
Example 1.5.18
Filter base of neighborhood ﬁlters in R, inﬁnite tails
of a sequence (p. 42).
Example 1.5.22
The coﬁnite ﬁlter is not an ultraﬁlter, if the carrier set
is inﬁnite (p. 44).
Example 1.5.25
The power set P .S/ is a lattice under inclusion
(p. 45).
© Springer International Publishing Switzerland 2015
E.-E. Doberkat, Special Topics in Mathematics for Computer
Scientists, DOI 10.1007/978-3-319-22750-4
685

686
LIST OF EXAMPLES
Example 1.5.27
Inﬁma and suprema in the lattice of open intervals
(p. 46).
Example 1.5.28
Compute the supremum in the lattice of rectangles
(p. 46).
Example 1.5.29
Distributivity is not inherited to sublattices (p. 46).
Example 1.5.30
Embed a partial order into a distributive lattice
through down sets (p. 47).
Example 1.5.34
Identify some prime ideals in .P .S/ ; / (p. 48).
Example 1.5.48
Discrete and indiscrete topologies (p. 58).
Example 1.5.49
Open subsets of R (p. 58).
Example 1.5.56
Stone Duality—the prime ideal topology as a compact
topology on a Boolean algebra (p. 61).
Example 1.5.58
The Priestley topology is a compact topology on
P .S/: an application of Alexander’s Subbase The-
orem (p. 63).
Example 1.6.4
The Borel sets of Œ0; 1 are generated by the open in-
tervals; Cantor’s ternary set is a Borel set (p. 66).
Example 1.6.5
The set of inﬁnite binary sequences with ﬁxed sums is
measurable in the inﬁnite product (p. 67).
Example 1.6.6
The set of inﬁnite binary sequences with converging
averages is product measurable (p. 68).
Example 1.6.13
Dirac measure (p. 74).
Example 1.6.14
A binary-valued measure generates an ultraﬁlter; the
converse is difﬁcult (p. 74).
Example 1.6.15
The length of an interval has interesting properties as
a measure: It is -additive and monotone (p. 74).
Example 1.6.33
A non--ﬁnite measure may have inﬁnitely many ex-
tensions (p. 87).
Example 1.6.37
The famous Vitali equivalence relation yields a non-
measurable set (p. 90).
Categories
Example 2.1.2
Introduces the category Set of sets with maps as mor-
phisms (p. 112).

LIST OF EXAMPLES
687
Example 2.1.3
Introduces the category of sets with binary relations
as morphisms (p. 113).
Example 2.1.4
Makes a partially ordered sets into a category (p. 113).
Example 2.1.5
Deﬁnes the free category generated by a graph
(p. 114).
Example 2.1.6
The discrete category (p. 114).
Example 2.1.9
The category of transition systems with simple mor-
phisms (p. 115).
Example 2.1.10
The category of transition systems with an added
backward
property
yields
bounded
morphisms
(p. 115).
Example 2.1.11
Top, all topological spaces with continuous maps
(p. 116).
Example 2.1.12
Meas, all measurable spaces with measurable maps
(p. 117).
Example 2.1.13
The category of probability spaces with measure pre-
serving measurable maps (p. 117).
Example 2.1.14
The probabilities P .S; A/ deﬁne a measurable space
through the weak -algebra (p. 118).
Example 2.1.15
State automata with their morphisms (p. 119).
Example 2.1.16
Slice category K=x (p. 120).
Example 2.2.3
The product in the category of sets with maps as mor-
phisms is what you think it is (p. 130).
Example 2.2.4
Constructs the product -algebra A ˝ B for the prod-
uct XY of two measurable spaces .X; A/ and .Y; B/
(p. 130).
Example 2.2.5
The category of probability spaces does not have
products (p. 131).
Example 2.2.6
Construct the product topology   # on the prod-
uct X  Y of the topological spaces .X; / and .Y; #/
(p. 132).
Example 2.2.7
The greatest lower bound inf as a product (p. 133).
Example 2.2.11
The smallest upper bound sup as a coproduct (p. 135).
Example 2.2.17
The coproduct in the category of relations (p. 137).
Example 2.2.19
Construct the pullback in the category of sets (p. 139).

688
LIST OF EXAMPLES
Example 2.2.21
The equivalence relation as a pullback of its factor
map (p. 140).
Example 2.2.25
Construct the pushout in the category of sets (p. 144).
Example 2.2.26
The pushout of the factors of equivalence relations is
the factor of their supremum (p. 144).
Example 2.3.2
Assigning each set its power set yields a functor
(p. 146).
Example 2.3.3
The hom-sets assign to each object two functors
(p. 146).
Example 2.3.4
Forgetting part of the structure leads to a forgetful
functor (p. 147).
Example 2.3.5
Reversing arrows is not a reason to go into panic
mode; this is why we have contravariant functors
(p. 147).
Example 2.3.10
Model a labeled transition system with labels from A
as the functor P .A  / (p. 150).
Example 2.3.11
Discrete probabilities deﬁne a functor on the category
of sets (p. 151).
Example 2.3.12
Introduces the weak -algebra on a measurable space
and deﬁnes the subprobability functor S as a functor
on the category of measurable spaces (p. 152).
Example 2.3.13
The upper closed sets deﬁne a functor on the category
of sets (p. 152).
Example 2.3.14
The ultraﬁlters on the power set of a set deﬁne a func-
tor on the category of sets (p. 153).
Example 2.3.18
Composition as a natural transformation for the hom
functor (p. 155).
Example 2.3.21
Natural transformations for a contravariant functor
(p. 157).
Example 2.3.26
The weak -algebra is generated by natural transfor-
mations (p. 161).
Example 2.3.29
The binary product as a cone (p. 163).
Example 2.3.30
Pullback as a cone (p. 163).
Example 2.3.33
The binary coproduct as a cocone (p. 165).
Example 2.4.6
The powerset functor is the functorial part of a monad
(p. 171).
Example 2.4.7
Discrete probabilities generate a monad (p. 172).

LIST OF EXAMPLES
689
Example 2.4.8
The Giry monad is based on the subprobability func-
tor (p. 173).
Example 2.4.9
The ultraﬁlter monad (p. 175).
Example 2.4.10
Upper closed sets form a monad (p. 176).
Example 2.5.2
  E is left adjoint to E through currying (p. 180).
Example 2.5.3
The diagonal functor has the product functor as an ad-
joint (p. 181).
Example 2.5.4
Direct and inverse images yield an adjunction
(p. 182).
Example 2.5.10
Unit and counit for currying (p. 186).
Example 2.5.14
The Eilenberg–Moore algebras for the power set
monad are the complete sup semi-lattices (p. 190).
Example 2.6.2
Coalgebras for the power set functor are identiﬁed
with binary relations (p. 197).
Example 2.6.3
Transforming a labeled transition system into a coal-
gebra (p. 198).
Example 2.6.4
Automata as coalgebras through currying (p. 198).
Example 2.6.6
Binary trees as coalgebras (p. 199).
Example 2.6.7
Subprobabilistic transition kernels (a.k.a stochastic re-
lations) as coalgebras for the subprobability functor
(p. 199).
Example 2.6.8
Upper closed subsets as coalgebras (p. 200).
Example 2.6.10
Coalgebra morphisms preserve the tree structure
(p. 200).
Example 2.6.12
Coalgebra morphisms for transition structures are just
the bounded morphisms (p. 201).
Example 2.7.3
A modal logic for the Roman god Janus (p. 225).
Example 2.7.4
Modalities for propositional dynamic logic (PDL)
(p. 226).
Example 2.7.5
Modalities for game logic—Angel and Demon play
(p. 226).
Example 2.7.6
Arrow logic (p. 227).
Example 2.7.12
Topological
spaces
deﬁne
neighborhood
frames
(p. 231).
Example 2.7.13
The frame deﬁned by ultraﬁlters (p. 231).

690
LIST OF EXAMPLES
Example 2.7.14
Translate a Kripke frame into a neighborhood frame
(p. 231).
Example 2.7.19
Interpret Janus’ logic (p. 234).
Example 2.7.20
Prepare an interpretation of PDL through a Kripke
model (p. 234).
Example 2.7.21
Interpret PDL in a neighborhood model (p. 236).
Example 2.7.22
Interpret game logic in a neighborhood
model
(p. 237).
Example 2.7.54
A functor for interpreting neighborhood models
through coalgebraic logic (p. 256).
Example 2.7.56
Predicate liftings for Kripke models (p. 257).
Example 2.7.57
Predicate liftings for neighborhood models (p. 258).
Example 2.7.64
Interpretation of a basic modal language through a
transition system, constructing a factor systems and
relating logically equivalent and bisimilar systems
factors (p. 262).
Example 2.7.65
A coalgebraic interpretation of the computational tree
logic CTL* (p. 265).
Topological Spaces
Example 3.1.2
The topology on R given by open intervals (p. 284).
Example 3.1.3
The Euclidean topology on R3 (p. 284).
Example 3.1.4
A base for the weak topology which is induced by a
family of functions (p. 285).
Example 3.1.5
A topology induced on the set A * B of all partial
maps between sets A and B (p. 286).
Example 3.1.6
Scott open sets on an inductive ordered set (p. 287).
Example 3.1.8
The deﬁnition of continuity is equivalent -ı to the
deﬁnition with open sets in R (p. 288).
Example 3.1.10
Continuity of maps .A * B/ ! .C * D/ (p. 289).
Example 3.1.11
Scott continuous maps between inductive ordered sets
(p. 289).
Example 3.1.12
Interpreting a modal logic in a topological space may
violate the law of the excluded middle (p. 290).

LIST OF EXAMPLES
691
Example 3.1.19
The quotient topology on Œ0; 2 identifying the end-
points yields the unit circle (p. 294).
Example 3.1.20
A closure operator on a ﬁnite partially ordered set
(p. 295).
Example 3.1.24
Computing the open sets for the topology from Exam-
ple 3.1.20 for the set of all divisors of 6 (p. 298).
Example 3.1.25
The topology on a topological group is determined by
the neighborhood of the neutral element (p. 299).
Example 3.3.6
T1 but not T0 (p. 310).
Example 3.3.8
T0 but not T1 (p. 310).
Example 3.3.10
The topology of coﬁnite sets is T1 but not T2 (p. 311).
Example 3.3.11
T3 but not T2 or T1 (p. 312).
Example 3.3.12
T2 but not T3 (p. 312).
Example 3.3.13
T3 1
2 (p. 312).
Example 3.4.7
An embedding Œ0; 1N ! Œ0; 1M for sets M and N
(p. 323).
Example 3.4.15
The prime ideal topology on a Boolean algebra has a
prime ideal which does not preserve a countable set of
given suprema and contains a given element (p. 327).
Example 3.5.2
Pseudometric spaces: R resp. R3 with the Euclidean
topology, discrete spaces, the uniform distance of sets
of bounded resp.
bounded continuous maps, point
evaluations for functions, the measure of the symmet-
ric difference for Borel sets, a metric induced by a
ranking resp. by a sequence of equivalence relations
(p. 330).
Example 3.5.10
The Hausdorff metric on the space of compact and
non-empty sets of a metric space (p. 337).
Example 3.5.17
The rationals are not complete: another example due
to Bourbaki (p. 341).
Example 3.5.18
Completeness is not a topological property of a met-
ric space; equivalent metrics do not need both to be
complete (p. 341).
Example 3.5.19
The continuous functions on Œ0; 1 are complete with
the sup-norm (p. 342).
Example 3.5.20
A ranking function induces a complete metric on the
power set (p. 342).

692
LIST OF EXAMPLES
Example 3.5.28
The Banach Fixed Point Theorem explains how
micro-Google works (p. 348).
Example 3.5.35
x 7! x2 is not uniformly continuous (p. 355).
Example 3.5.40
The Cantor ternary set is nowhere dense (p. 359).
Example 3.6.7
A complete Heyting algebra is pseudo-complemented
(p. 372).
Example 3.6.8
A complete pseudo-complemented lattice satisﬁes the
general distributive law (p. 372).
Example 3.6.11
Topological spaces and complete Heyting alge-
bras with homomorphisms are topological systems
(p. 373).
Example 3.6.13
Continuity of c-morphisms (p. 375).
Example 3.6.28
A sober topological space is a dcpo under the special-
ization order (p. 382).
Example 3.6.30
Sets of weakly ﬁnite character are Scott open (p. 383).
Example 3.6.45
The polynomials over the closed unit interval are
dense in the topology of uniform convergence
(p. 392).
Example 3.6.49
Uniform spaces: Discrete and indiscrete uniformities,
the additive and the multiplicative uniformity on R,
the uniformity deﬁned through ﬁnite partitions on a
set, the p-adic uniformity on Z, the uniformity of uni-
form convergence, left and right uniformity for a topo-
logical group (p. 399).
Example 3.6.52
The additive and the multiplicative uniformity on R
give the same topology, the discrete topology is also
induced by the uniformity of ﬁnite partitions, the
topologies induced by the p-adic and q-adic unifor-
mities are distinct for different primes p, q (p. 403).
Example 3.6.60
The topology for the uniformity of ﬁnite partitions is
not metrizable for an inﬁnite carrier set (p. 409).
Example 3.6.64
Each ultraﬁlter on the space of ﬁnite partitions is a
Cauchy ﬁlter (p. 410).
Example 3.6.69
The uniformity on P .X/ induced by an ideal (part 5
of Example 3.6.49) is complete—net version (p. 412).

LIST OF EXAMPLES
693
Example 3.6.70
The uniformity on P .X/ induced by an ideal
(part 5 of Example 3.6.49) is complete—ﬁlter version
(p. 413).
Example 3.6.74
The left and the right uniformities on a topological
group are not necessarily identical (p. 414).
Measures for Probabilistic Systems
Example 4.1.1
Functionally closed sets lead to the -algebra of Baire
sets (p. 431).
Example 4.1.2
The hit -algebra deﬁes measurability in terms of hit
sets for a distinguished family of sets (p. 432).
Example 4.1.5
A -algebra generates the same equivalence relation
as each of its generators (p. 434).
Example 4.1.11
Transition kernels may be used for interpreting modal
logics (p. 439).
Example 4.1.14
A ﬁnite transition system can be converted into a
stochastic effectivity function. (p. 443).
Example 4.1.15
Stochastic effectivity function interprets a simple
modal logic (p. 445).
Example 4.1.18
The Dirac kernel deﬁnes a stochastic effectivity func-
tion (p. 446).
Example 4.2.6
Evaluation of measures is measurable both for mea-
sures and for reals (p. 471).
Example 4.2.7
fhx; ri j M.x/.ŒŒ'M/  rg is product measurable
for modal formula ' (p. 471).
Example 4.2.18
Convergence in measure does in general not imply
convergence almost everywhere (p. 479).
Example 4.3.1
If the base space is separable, its Borel sets are count-
ably generated (p. 482).
Example 4.3.4
The countable–cocountable -algebra is not count-
ably generated (p. 484).
Example 4.3.7
Even if all horizontal and all vertical cuts are mea-
surable, a set is not necessarily product measurable
(p. 485).

694
LIST OF EXAMPLES
Example 4.3.20
Construct a metric so that the open unit interval is
complete (p. 491).
Example 4.3.23
The set of all inﬁnite sequences over N is a Polish
space in the product topology (p. 492).
Example 4.4.19
A modal logic induces a smooth equivalence relation
(p. 509).
Example 4.4.27
The
equivalence
generated
by
the
countable–
cocountable -algebra is the identity, which in turn
has the Borel sets as their -algebra of invariant sets
(p. 515).
Example 4.4.28
We ﬁnd two -algebras which are countably gener-
ated, but their intersection is not (p. 515).
Example 4.4.29
The supremum of two countably generated equiv-
alence relations is not always countably generated
(p. 516).
Example 4.7.4
Image ﬁnite hit-measurable maps into a Polish space
have a countable family of selectors (p. 540).
Example 4.7.5
The support function associated with a stochastic re-
lation is measurable and has a dense set of selectors;
this is a form of stochastic nondeterminism (p. 541).
Example 4.9.4
˝K deﬁnes a ﬁnite measure on X Y for the ﬁnite
measure  on X and the transition kernel K W X  Y
(p. 560).
Example 4.9.5
L.´/ ˝ K deﬁnes a transition kernel Z  X  Y for
the transition kernels L W Z  X and K W X  Y
(p. 561).
Example 4.9.6
The convolution of kernels is the Kleisli product in the
Giry category (p. 561).
Example 4.9.7
Integrating a nonnegative function means computing
the area under the graph through Choquet’s represen-
tation (p. 562).
Example 4.9.36
A morphism for game frames induces a natural trans-
formation (p. 596).
Example 4.9.49
Computing
the
validity
sets
ŒŒhp‹I giq'G
and
ŒŒhp¿I giq'G for a primitive formula p and an arbi-
trary game g (p. 606).

LIST OF EXAMPLES
695
Example 4.10.3
For separable metric X, the base space can be embed-
ded isometrically into the space of all ﬁnite measures
as a closed subset (p. 610).
Example 4.10.21 Comparing logically equivalent and bisimilar stochas-
tic relations requires factoring (p. 628).
Example 4.10.23 The existence of a non-measurable sets implies
the non-existence of a semi-pullback of measures
(p. 631).
Example 4.10.25 The factorization from Set is not suitable for the Giry
monad (p. 635).
Example 4.11.17 The sequence spaces `p and `1 are the well-known
Lp-spaces for the counting measure on N (p. 651).
Example 4.11.21 The space L1./ is not separable (p. 653).

Bibliography
[Acz00]
A. D. Aczel.
The Mystery of the Aleph - Mathematics,
the Kabbalah and the Search for Inﬁnity. Pocket Books,
New York, 2000. h75i
[AJ94]
S. Abramsky and A. Jung. Domain theory. In A. Abramsky,
D. M. Gabbay, and T. S. E. Maibaum, editors, Handbook of
Logic in Computer Science, volume 3 — Semantic Struc-
tures, pages 1–168. Oxford University Press, Oxford, 1994.
h282; 306i
[Arv76]
W. Arveson.
An Invitation to C*-Algebra.
Num-
ber 39 in Graduate Texts in Mathematics. Springer-Verlag,
New York, Berlin, Heidelberg, 1976. h369; 492i
[Aum54]
G. Aumann. Reelle Funktionen. Springer-Verlag, Berlin,
G¨ottingen, Heidelberg, 1954. h52; 75i
[Awo10]
S. Awodey.
Category Theory.
Number 52 in Oxford
Logic Guides. Oxford University Press, Oxford, 2nd edi-
tion, 2010. h197i
[Bar77]
J. Barwise, editor.
Handbook of Mathematical Logic.
North-Holland Publishing Company, Amsterdam, 1977.
h25i
[Bar01]
L. M. Barbosa. Components as Coalgebras. PhD thesis,
Universidade do Minho, 2001. h79i
[BdRV01]
P. Blackburn, M. de Rijke, and Y. Venema. Modal Logic.
Number 53 in Cambridge Tracts in Theoretical Computer
Science. Cambridge University Press, Cambridge, UK,
2001. h84; 197i
© Springer International Publishing Switzerland 2015
E.-E. Doberkat, Special Topics in Mathematics for Computer
Scientists, DOI 10.1007/978-3-319-22750-4
697

698
BIBLIOGRAPHY
[BHHK03] C. Baier, B. Haverkort, H. Hermanns, and J.-P. Katoen.
Model-checking algorithms for continuous time Markov
chains.
IEEE Trans. Softw. Eng., 29(6):524–541, June
2003. h195; 492i
[Bil95]
P. Billingsley.
Probability and Measure.
John Wiley &
Sons, New York, third edition, 1995. h75i
[Bir67]
G. Birkhoff.
Lattice Theory, volume 25 of Colloquium
Publications. American Mathematical Society, Providence,
RI, 1967. h75i
[Blo08]
W. B. Bloch. The Unimaginable Mathematics of Borges’
Library of Babel. Oxford University Press, Oxford, 2008.
hxi
[BN98]
F. Baader and T. Nipkow.
Term rewriting and all that.
Cambridge University Press, Cambridge, UK, 1998. h75i
[Bog07]
V. I. Bogachev. Measure Theory. Springer-Verlag, 2007.
h60; 75; 334; 404; 492i
[Bor94a]
F. Borceux. Handbook of Categorical Algebra 1: Basic
Category Theory, volume 50 of Encyclopedia of Mathe-
matics and Its Applications. Cambridge University Press,
Cambridge, UK, 1994. h197i
[Bor94b]
F. Borceux. Handbook of Categorical Algebra 2: Cate-
gories and Structures, volume 51 of Encyclopedia of Math-
ematics and Its Applications. Cambridge University Press,
Cambridge, UK, 1994. h197i
[Bou89]
N. Bourbaki. General Topology. Elements of Mathemat-
ics. Springer-Verlag, Berlin, Heidelberg, New York, 1989.
h249; 303; 306i
[Bro08]
T. J. Bromwich. In Introduction to the Theory of Inﬁnite
Series. MacMillan and Co., London, 1908. h75i
[BW99]
M. Barr and C. Wells. Category Theory for Computing Sci-
ence. Les Publications CRM, Montreal, 1999. h118; 197i

BIBLIOGRAPHY
699
[CFO89]
D. Cantone, A. Ferro, and E. G. Omodeo. Computable Set
Theory, volume 6 of International Series of Monographs
on Computer Science. Oxford University Press, Oxford,
1989. h1i
[CGP99]
E. M. Clarke, O. Grumberg, and D. A. Peled. Model Check-
ing. The MIT Press, Cambridge, MA, 1999. h195i
[CH67]
R. Courant and D. Hilbert.
Methoden der Mathematis-
chen Physik I, volume 30 of Heidelberger Taschenb¨ucher.
Springer-Verlag, third edition, 1967. h286i
[Che89]
B. F. Chellas. Modal Logic. Cambridge University Press,
Cambridge, UK, 1989. h146i
[Chr64]
G. Chrystal. Textbook of Algebra I/II. Chelsea Publishing
Company (Reprint), New York, 1964. h75i
[CK90]
C. C. Chang and H. J. Keisler. Model Theory, volume 73
of Studies in Logic and the Foundations of Mathematics.
Elsevier, Amsterdam, 1990. h266; 270; 271; 306i
[CLR92]
T. H. Cormen, C. E. Leiserson, and R. L. Rivest. An In-
troduction to Algorithms. The MIT Press, Cambridge MA,
1992. h25i
[COP01]
D. Cantone, E. G. Omodeo, and A. Policriti.
Set The-
ory for Computing. Springer-Verlag, Berlin, Heidelberg,
New York, 2001. h1; 75i
[CV77]
C. Castaing and M. Valadier. Convex Analysis and Mea-
surable Multifunctions. Number 580 in Lect. Notes Math.
Springer-Verlag, Berlin, Heidelberg, New York, 1977.
h259i
[Dav00]
M. Davis. Engines of Logic - Mathematics and the Origin
of the Computer. W. W. Norton, New York, London, 2000.
h75i
[DEP02]
J. Desharnais, A. Edalat, and P. Panangaden. Bisimulation
of labelled Markov processes. Information and Computa-
tion, 179(2):163–193, 2002. h459i

700
BIBLIOGRAPHY
[DF89]
E.-E. Doberkat and D. Fox.
Software Prototyping mit
SETL.
Leitf¨aden und Monographien der Informatik.
Teubner-Verlag, Stuttgart, 1989. h1i
[Dob89]
E.-E. Doberkat.
Topological completeness in an ideal
model for recursive polymorphic types. SIAM J. Comput-
ing, 18(5):977 – 991, 1989. h306i
[Dob03]
E.-E. Doberkat. Pipelines: Modelling a software architec-
ture through relations. Acta Informatica, 40:37–79, 2003.
h79; 197i
[Dob07]
E.-E. Doberkat.
The Hennessy-Milner equivalence for
continuous-times stochastic logic with mu-operator.
J.
Appl. Logic, 35:519–544, 2007. h195; 492i
[Dob09]
E.-E. Doberkat.
Stochastic Coalgebraic Logic.
EATCS
Monographs in Theoretical Computer Science. Springer-
Verlag, Berlin, 2009. h197; 434i
[Dob10]
E.-E. Doberkat. A note on the coalgebraic interpretation
of game logic.
Rendiconti Ist. di Mat. Univ. di Trieste,
42:191 – 204, 2010. h197i
[Dob12a]
E.-E. Doberkat. Haskell f¨ur Objektorientierte. Oldenbourg-
Verlag, M¨unchen, 2012. h197; 307i
[Dob12b]
E.-E. Doberkat. A stochastic interpretation of propositional
dynamic logic: Expressivity. J. Symb. Logic, 77(2):687–
716, 2012. h387; 492i
[Dob14]
E.-E. Doberkat. Algebraic properties of stochastic effectiv-
ity functions. J. Logic and Algebraic Progr., 83:339–358,
2014. h320i
[Doo94]
J. L. Doob. Measure Theory. Number 143 in Graduate
Texts in Mathematics. Springer Verlag, 1994. h492i
[DP02]
B.A. Davey and H. A. Priestley. Introduction to Lattices
and Order. Cambridge University Press, Cambridge, UK,
2002. h75i

BIBLIOGRAPHY
701
[DP03]
J. Desharnais and P. Panangaden.
Continuous stochas-
tic logic characterizes bisimulation of continuous-time
Markov processes. J. Log. Alg. Programming, 56(1-2):99–
115, 2003. h492i
[DPP09]
A. Doxiadis, C. Papadimitriou, and A. Papadatos. Logi-
comix: An Epic Search for Truth. Bloomsbury, London,
2009. h76i
[DS57]
N. Dunford and J. T. Schwartz. Linear Operators, volume I.
Interscience Publishers, 1957. h486; 492i
[DS65]
L. E. Dubins and L. J. Savage.
How to Gamble if you
Must: Inequalities for Stochastic Processes. McGraw-Hill,
New York, 1965. h321i
[DS11]
E.-E. Doberkat and Ch. Schubert. Coalgebraic logic over
general measurable spaces - a survey. Math. Struct. Comp.
Science, 21:175–234, 2011. Special issue on coalgebraic
logic. h193; 197i
[DT41]
E.-E. Doberkat and P. S`anchez Terraf. Stochastic nondeter-
minism and effectivity functions. J. Logic and Computa-
tion, in print, 2015 (arxiv: 1405.7141). h320i
[Eda99]
A. Edalat.
Semi-pullbacks and bisimulations in cate-
gories of Markov processes. Math. Struct. Comp. Science,
9(5):523–543, 1999. h459i
[Edg98]
G. A. Edgar. Integral, Probability, and Fractal Measures.
Springer-Verlag, New York, 1998. h448; 492i
[Els99]
J. Elstrodt.
Maß- und Integrationstheorie.
Springer-
Verlag, Berlin-Heidelberg-New York, 2 edition, 1999.
h62; 75; 399; 486; 492i
[Eng89]
R.
Engelking.
General
Topology,
volume
6
of
Sigma Series
in Pure Mathematics.
Heldermann-
Verlag, Berlin, revised and completed edition, 1989.
h225; 228; 241; 249; 259; 303; 306i
[Fia05]
J. L. Fiadeiro.
Categories for Software Engineering.
Springer-Verlag, Berlin, Heidelberg, 2005. h79i

702
BIBLIOGRAPHY
[Fic64]
G. M. Fichtenholz. Differential- und Integralrechnung I-III.
VEB Deutscher Verlag der Wissenschaften, Berlin, 1964.
h41; 480i
[Fre08]
D. H. Fremlin. Measure Theory, volume 1–5. Torres Frem-
lin, Colchester, 2000–2008. h492i
[GHKC03] G. Gierz, K. H. Hofmann, K. Keimel, J. D. Lawson, M. W.
Mislove, and D. S. Scott.
Continuous Lattices and Do-
mains. Number 93 in Encyclopaedia of Mathematics and
its Applications. Cambridge University Press, Cambridge,
UK, 2003. h279; 280; 282; 306i
[Gir81]
M. Giry. A categorical approach to probability theory. In
Categorical Aspects of Topology and Analysis, number 915
in Lect. Notes Math., pages 68–85, Berlin, 1981. Springer-
Verlag. h197i
[GKP89]
R. E. Graham, D. E. Knuth, and O. Patashnik.
Con-
crete Mathematics: A Foundation for Computer Science.
Addison-Wesley, Reading, MA, 1989. hixi
[Gol96]
D. Goldrei. Classic Set Theory. Chapman and Hall/CRC,
Boca Raton, 1996. h75i
[Gol06]
R. Goldblatt. Topoi — The Categorical Analysis of Logic.
Dover Publications, New York, 2006. h306i
[Gol10]
R. Goldblatt.
Deduction systems for coalgebras over
measurable spaces.
Journal of Logic and Computation,
20(5):1069–1100, 2010. h325; 326i
[Gol12]
R. Goldblatt. Topological proofs of some Rasiowa-Sikorski
lemmas. Studia Logica, 100:1–18, 2012. h45i
[Hal50]
P. R. Halmos. Measure Theory. Van Nostrand Reinhold,
New York, 1950. h483; 492i
[Her06]
H. Herrlich. Axiom of Choice. Number 1876 in Lect. Notes
Math. Springer-Verlag, Berlin, Heidelberg, New York,
2006. h6; 11; 75; 76; 224; 225; 306; 459i
[HS65]
E. Hewitt and K. R. Stromberg. Real and Abstract Analy-
sis. Springer-Verlag, Berlin, Heidelberg, New York, 1965.
h44; 480; 485; 486i

BIBLIOGRAPHY
703
[Isb64]
J. R. Isbell. Uniform Spaces. Number 12 in Mathematical
Surveys and Monographs. American Mathematical Society,
Providence, RI, 1964. h306i
[Jam87]
I. M. James. Topological and Uniform Spaces. Undergrad-
uate Texts in Mathematics. Springer-Verlag, New York,
Berlin, Heidelberg, 1987. h306i
[Jec73]
T. Jech.
The Axiom of Choice, volume 75 of Studies in
Logic and the Foundations of Mathematics. North-Holland
Publishing Company, New York, 1973. h75i
[Jec06]
T. Jech.
Set Theory.
Springer-Verlag (The Third Mil-
lennium Edition), Berlin, Heidelberg, New York, 2006.
h37; 53; 69; 75i
[Joh82]
P. T. Johnstone. Stone Spaces. Cambridge University Press,
Cambridge, UK, 1982. h306i
[JR02]
J. E. Jayne and C. A. Rogers. Selectors. Princeton Univer-
sity Press, Princeton, N. J., 2002. h259i
[Kec94]
A. S. Kechris. Classical Descriptive Set Theory. Graduate
Texts in Mathematics. Springer-Verlag, Berlin, Heidelberg,
New York, 1994. h265; 306; 324; 368i
[Kee93]
J. P. Keener. The Perron-Frobenius theorem and the rank-
ing of football teams. SIAM Review, 35(1):80–93, 1993.
h254; 255i
[Kel55]
J. L. Kelley. General Topology. Number 27 in Graduate
Texts in Mathematics. Springer Verlag, New York, Berlin,
Heidelberg, 1955. h208; 225; 238; 249; 262; 305; 306i
[Kel72]
H. G. Kellerer. Topologische Maßtheorie. Lecture notes,
Mathematisches Institut, Ruhr-Universit¨at Bochum, Som-
mersemester 1972. h492i
[KM76]
K. Kuratowski and A. Mostowski. Set Theory, volume 86
of Studies in Logic and the Foundations of Mathematics.
North-Holland and PWN, Polish Scientiﬁc Publishers, Am-
sterdam and Warzawa, 1976. h11; 15; 75; 368i

704
BIBLIOGRAPHY
[Knu73]
D. E. Knuth.
The Art of Computer Programming. Vol.
I, Fundamental Algorithms.
Addison-Wesley, Reading,
Mass., 2 edition, 1973. h25i
[Kop89]
S. Koppelberg. Handbook of Boolean Algebras, volume 1.
North Holland, Amsterdam, 1989. h271; 306i
[Koz85]
D. Kozen.
A probabilistic PDL.
J. Comp. Syst. Sci.,
30(2):162–178, 1985. h436i
[Kur66]
K. Kuratowski.
Topology, volume I.
PWN – Polish
Scientiﬁc Publishers and Academic Press, Warsaw and
New York, 1966. h229; 259; 306; 360i
[Lip11]
M. LipovaLca. Learn You a Haskell for Great Good!
no
starch press, San Francisco, 2011. h197i
[LM05]
A. M. Langville and C. D. Mayer. A survey of eigenvec-
tor methods for Web information retrieval. SIAM Review,
47(1):135–161, 2005. h254; 255i
[Loo53]
L. H. Loomis. An Introduction to Abstract Harmonic Anal-
ysis. D. van Nostrand Company, Princeton, N. J., 1953.
h492i
[Lub74]
A. Lubin. Extensions of measures and the von Neumann
selection theorem. Proc. Amer. Math. Soc., 43(1):118–122,
1974. h492i
[Mic51]
E. Michael. Topologies on spaces of subsets. Trans. Am.
Math. Soc., 71(2):152–182, 1951. h259i
[ML97]
S. Mac Lane. Categories for the Working Mathematician.
Graduate Texts in Mathematics. Springer-Verlag, Berlin,
1997. h115; 118; 197; 460i
[Mog89]
E. Moggi. An abstract view of programming languages.
Lecture Notes, Stanford University, June 1989. h120i
[Mog91]
E. Moggi. Notions of computation and monads. Informa-
tion and Computation, 93:55–92, 1991. h120; 197i
[Mos06]
Y. Moschovakis. Notes on Set Theory. Undergraduate Texts
in Mathematics. Springer Verlag, 2nd edition, 2006. h207i

BIBLIOGRAPHY
705
[MPS86]
D. MacQueen, G. Plotkin, and R. Sethi. An ideal model
for recursive polymorphic types. Information and Control,
71:95–130, 1986. h250i
[MS64]
J. Mycielski and S. Swierczkowski. On the Lebesgue mea-
surability and the axiom of determinateness. Fund. Math.,
54:67–71, 1964. h75i
[OGS09]
B. O’Sullivan, J. Goerzen, and D. Stewart.
Real World
Haskell. O’Reilly, Sebastopol, CA, 2009. h1; 197i
[Oxt80]
J. C. Oxtoby. Measure and Category. Number 2 in Grad-
uate Texts in Mathematics. Springer Verlag, New York,
Berlin, Heidelberg, 2nd edition, 1980. h306i
[Pan09]
P. Panangaden. Labelled Markov Processes. World Scien-
tiﬁc Pub Co, 2009. h434i
[Par67]
K. R. Parthasarathy.
Probability Measures on Metric
Spaces. Academic Press, New York, 1967. h492i
[Par85]
R. Parikh.
The logic of games and its applications.
In
M. Karpinski and J. van Leeuwen, editors, Topics in the
Theory of Computation, volume 24, pages 111–140. Else-
vier, 1985. h197; 321i
[Pat04]
D. Pattinson.
Expressive logics for coalgebras via ter-
minal sequence induction. Notre Dame J. Formal Logic,
45(1):19–33, 2004. h193; 197i
[Pau00]
M. Pauly. Game logic for game theorists. Technical Report
INS-R0017, CWI, Amsterdam, 2000. h321i
[PP03]
M. Pauly and R. Parikh. Game logic — an overview. Studia
Logica, 75:165–182, 2003. h175; 197i
[Pum99]
D. Pumpl¨un. Elemente der Kategorientheorie. Spektrum
Akademischer Verlag, Heidelberg, 1999. h112; 118; 197i
[Pum03]
D. Pumpl¨un.
Positively convex modules and ordered
normed linear spaces. J. Convex Analysis, 10(1):109–127,
2003. h141i
[Que01]
B.
v.
Querenburg.
Mengentheoretische
Topologie.
Springer -Lehrbuch. Springer-Verlag, Berlin, 3rd edition,
2001. h306i

706
BIBLIOGRAPHY
[Rou15]
Ch.
Rousseau.
How
Google
works.
www.kleinproject.org,
August 2010 (last vis-
ited January 10, 2015). h254i
[RR81]
K. P. S. Bhaskara Rao and B. V. Rao. Borel spaces. Disser-
tationes Mathematicae, 190:1–63, 1981. h375i
[RS50]
H. Rasiowa and R. Sikorski.
A proof of the complete-
ness theorem of G¨odel. Fund. Math., 37:193–200, 1950.
h240; 266; 306i
[RS63]
H. Rasiowa and R. Sikorski. The Mathematics of Meta-
mathematics, volume 41 of Monograﬁe Matematyczne.
PWN, Warsaw, 1963. h306i
[Rud74]
W. Rudin. Real and Complex Analysis. Tata McGraw-Hill,
2nd edition, 1974. h399; 465; 472; 477; 485; 492i
[Rut00]
J. J. M. M. Rutten. Universal coalgebra: a theory of sys-
tems. Theor. Comp. Sci., 249(1):3–80, 2000. Special issue
on modern algebra and its applications. h197i
[Sch70]
H. H. Schaefer.
Topological Vector Spaces.
Num-
ber 3 in Graduate Texts in Mathematics. Springer Verlag,
New York, Heidelberg, Berlin, 1970. h492i
[SDDS86]
J. T. Schwartz, R. B. K. Dewar, E. Dubinsky, and E. Schon-
berg. Programming with Sets — An Introduction to SETL.
Springer-Verlag, New York, Berlin, Heidelberg, Tokyo,
1986. h1i
[SH10]
A. K. Seda and P. Hitzler. Generalized distance functions
in the theory of computations.
The Computer Journal,
53(4):443–464, 2010. h306i
[Sho67]
J. R. Shoenﬁeld. Mathematical Logic. Addison-Wesley,
Reading, MA, 1967. h266i
[Smy92]
M.
B.
Smyth.
Topology.
In
S.
Abramsky,
D. M. Gabbay, and T. S. E. Maibaum, editors, Hand-
book of Logic in Computer Science,
volume 1 —
Background:
Mathematical Structures, pages 641–761.
Oxford University Press, Oxford, 1992. h207i

BIBLIOGRAPHY
707
[Sok05]
A. Sokolova. Coalgebraic Analysis of Probabilistic Sys-
tems. PhD thesis, Department of Computer Science, Uni-
versity of Eindhoven, 2005. h197i
[Sri98]
S. M. Srivastava.
A Course on Borel Sets.
Gradu-
ate Texts in Mathematics. Springer-Verlag, Berlin, 1998.
h366; 368; 492i
[Sri08]
S. M. Srivastava. A Course on Mathematical Logic. Uni-
versitext. Springer Verlag, 2008. h266; 268; 306i
[ST11]
P. S´anchez Terraf.
Unprovability of the logical charac-
terization of bisimulation. Information and Computation,
209(7):1048–1056, 2011. h459i
[Sta97]
R. Stanley. Enumerative Combinatorics, volume 1 of Cam-
bridge Studies in Advanced Mathematics. Cambridge Uni-
versity Press, Cambridge, UK, 1997. h75i
[Str81]
K. R. Stromberg. An Introduction to Classical Real Analy-
sis. Wadsworth International Group, Belmont, 1981. h399i
[Tay99]
P. Taylor.
Practical Foundations of Mathematics, vol-
ume 59 of Cambridge Studies in Advanced Mathematics.
Cambridge University Press, Cambridge, 1999. h75i
[Thi65]
C. Thiel. Sinn und Bedeutung in der Logik Gottlob Freges.
Verlag Anton Hain, Meisenheim am Glan, 1965. h4i
[vdHP07]
W. van der Hoek and M. Pauly. Modal logic for games
and information.
In P. Blackburn, J. van Benthem, and
F. Wolter, editors, Handbook of Modal Logic, volume 3
of Studies in Logic and Practical Reasoning, pages 1077–
1148. Elsevier, Amsterdam, 2007. h320i
[Ven07]
Y. Venema. Algebras and co-algebras.
In P. Blackburn,
J. van Benthem, and F. Wolter, editors, Handbook of Modal
Logic, volume 3 of Studies in Logic and Practical Reason-
ing, pages 331–426. Elsevier, Amsterdam, 2007. h71; 146i
[Vic89]
S. Vickers. Topology via Logic. Number 5 in Cambridge
Tracts in Theoretical Computer Science. Cambridge Uni-
versity Press, Cambridge, UK, 1989. h207; 306i

Index
Symbols
B.x; r/, 58, 333
H, 616
O.x/; OM .x/, 19
S.x; r/, 333
U Œx, 398
Ba./, 431
B./, 431
Meas, 117
Prob, 117
P, 113
Rel, 121
Top, 116
C.X/, 388
V.S/, 152
ŒŒ'M, 229
˙˙˙.A/, 452
ker .f /, 124
N, 93
P .S; A/, 118
S.X; A/, 152
E.S; A/, 442
a:e:
!, 474
˛-sequence, 27
Kop, 121
Set, 112
AbGroup, 274
-net, 350
I , 53
M; w ˆ ', 229
a:e:
!, 474
i:m:
!, 477
diam.A/, 345
-measurable, 80
-a.e., 472
i:m:
!, 477
!1, 27
--Theorem, 85
}}}.X; A/, 438
supp./, 464
T h.c/, 261
U.x/, 298
` ', 246
d=d, 655
dP .; /, 462
w ˆ ', 260
F ! x, 301
L.˚/, 224
L.L/, 260
L.; ˚/, 225
L1./, 472
22, 374
© Springer International Publishing Switzerland 2015
E.-E. Doberkat, Special Topics in Mathematics for Computer
Scientists, DOI 10.1007/978-3-319-22750-4
709

710
INDEX
A
Absolute continuity, 653
signed measure, 667
.AC/, 9
Accumulation point, 307
A-cover, 522
.AD/, 94
Additive, 73
Adjoint
left, 180
right, 180
Adjunction, 179
counit, 185
unit, 185
Algebra
Boolean, 50
Eilenberg–Moore, 189
ﬁnite–coﬁnite, 65
free, 189
Heyting, 107, 371
morphism, 372
Lindenbaum, 366
morphism, 189
structure morphism, 189
Analytic set, 500
Angel, 91, 226
Appending an element, 91
Atom, 488
, 461
Atomic harmony, 241
Automaton, 119
with output, 148
Axiom of Choice
.AC/, 9
.AD/, 94
.MI/, 50
.MP/, 31
.WO/, 19
.ZL/, 29
Axiom of Determinacy, 94
B
ˇˇˇA, 438
Baire sets, Ba./, 431
Banach decomposition, 105
Banach–Mazur game, 359
Base, 38
Bisimilar, 625
states, 242
Bisimulation, 202, 205, 207, 241
equivalence, 212
Boolean -algebra, 65
Borel measurability, 458
Borel sets, 66
B./, 431
Bound
lower, 15
upper, 15
Boundary, @M, 59
Bounded, 662
C
Cantor ternary set, 67
Cardinality, 10
Category
comma, 153
composition, 111
coproduct, injection, 134
discrete, 114
dual, 121
epimorphism, 123
split, 269
free, 114
monomorphism, 122
split, 269
morphism, 111
natural transformation, 154
natural transformation
component, 155
object, 111
product, 129

INDEX
711
projection, 129
pullback, 138
pushout, 143
slice, 121
small, 114
sum, 134
weak pullback, 138
Cauchy
ﬁlter, 410
sequence, 340
Chain, 29
Change of variables
calculus, 549
image measure, 548
Charlie Brown’s device, 343
Choice
angelic, 227
demonic, 227
function, 9
Clopen, 60
Closure
M a, 59
operator, 295
Coalgebra, 197
bisimilar, 202
carrier, 197
dynamics, 197
mediating, 202
morphism, 200
Cocone, 164
Colimit, 164
Compact
countably compact, 329
Lindel¨of space, 329
locally compact, 321
paracompact, 329
locally ﬁnite, 329
reﬁnement, 329
sequentially compact, 329,
350
Compactiﬁcation, 324
Alexandrov one point, 322
Stone– LCech, 325
Complement, 50
Complete
measure space, 524
strongly C, 249
weakly C, 249
Completion
M, 526
, 525
universal, 527
Conditional distribution, 670
regular, 670
Cone, 162
limit, 163
Congruence, 52, 219, 629
effectivity function, 454
Conjugate numbers, 648
Consistent
, 247
maximal , 250
Continuous, 288
uniformly, 355, 414
Contraction, 347
Convergence
almost everywhere, 474
ﬁlter, 301
in measure, 477
in measure, 478
net, 301
pointwise, 473
uniform, 474
Converse, 669
Convex, 644
Coproduct, 215
Countable, 11, 15
Countably additive, 73
Countably inﬁnite, 11
Countably subadditive, 73

712
INDEX
Covers, 106
CSL, 576
next operator, 577
path quantiﬁer, 577
steady-state, 577
until operator, 577
CTL*, 265
Currying, 180
Cut, Qx; Qy, 437
Cylinder sets, 569
D
Dcpo, 382
Demon, 91, 226
Dense set, 315
Density, 655
Diagram
chasing, 128
commutative, 119
Diameter, 345, 465
Dirac
effectivity function, 446
measure, 74
Disintegration, 675
Down set, 47
E
Effectivity function, 231
Eilenberg–Moore algebra, 189
morphism, 189
Element
largest, 15
maximal, 15
smallest, 15
Embedding, 323
Entourage, 398
Epi, 123
Epic, jointly, 272
Equalizer, 273
Equivalence
induced by C, 434
modal, 241
Equivalence relation
generated by sets, 434
invariant set, 452
smooth, 508
determining sequence, 509
tame, 452
Exception, 166
F
Factor algebra, 53
Filter, 42, 48
accumulation point, 307
base, 42
Cauchy, 410
maximal, 43
neighborhood, 297
Finite character, 31
First entrance trick, 84
Flyswatter, 351
Formula
globally true, 230
refutable, 230
satisﬁable, 230
Frame, 372
t, 232
accessibility relation, 228
game, 588
Kripke, 228
morphism, 239
neighborhood, 231
set of worlds, 228
Frames, class of, 249
Function
-essentially bounded, 472
indicator, 469
step, 469
Functional, linear, 39

INDEX
713
Functor, 145
constant, 146
contravariant, 147
covariant, 147
endofunctor, 146
forgetful, 147
identity, 146
power set, 146
probability, 119
subprobability, 152
upper closed sets, 152
G
Galois connection, 182
Game, 91
Banach–Mazur, 92
determined, 93, 237, 587
disjunctive, 238
frame, 588
interpretable, 594
logic, 227
strategy, 91
Giry
functor, 175
monad, 175
Godement product, 158
Google, 350
Graph
F.G/, 114
k-colorable, 105
free category, 114
path, 114
undirected, 105, 269
Group, topological, 299
H
H¨older’s inequality, 649
Hilbert cube, 495
Hilbert space, 644
Hit
-algebra, 432
measurable, 540
Homeomorphism, 294
Hutchinson metric, 616
I
Ideal, 48
Independence, linear, 37
Indicator function, 469
Induction
Noetherian, 20
transﬁnite, 20
well-founded, 20
Inequality
H¨older, 648, 649
Minkowski, 649
Schwarz, 641
Inﬁmum, 15
Initial segment, 19
Inner measure, 89
Inner product, 641
Interior, M o, 59
Invariant set, 452
Invariant subset, 221
Irreducible
closed set, 380
join, 106
J
Jordan decomposition, 665
K
Kernel
linear functional, 643
Markov, 439
transition, 439
Kleisli
category, 167
tripel, 166

714
INDEX
Kripke model, 228
stochastic, 602
Kronecker’s ı, 193
Kuratowski’s trap, 493
L
Lagrange’s Formula, 661
Lattice, 44
bounded, 45
Brouwerian, 107
complete, 107
distributive, 46
join, 44
meet, 44
pseudo-complement, 107
Lebesgue decomposition, 655
Left adjoint, 180
Leitmotif, 8
Limit, 163
Lindenbaum Lemma, 253
Linear functional, 662
positive, 662
Localization, 604
Logic
CSL, 576
closed
modus ponens, 245
uniform substitution, 245
coalgebraic
behavioral equivalence,
261
bridge operators, 268
logical equivalence, 261
predicate lifting, 256
continuous time stochastic,
576
modal, 246, 439
normal, 248
M
M.X; A/, 438
Mackey, 486
Map
afﬁne, 401
continuous, 116
factor, 53
kernel, 124
measurable, 117, 433
ﬁnal, 220
strong, 221
semicontinuous, 433
Markov property, 580
Maximal lower bound, 15
Measurable
rectangle, 436
relation, 538
selector, 538
set-valued map, 538
Measure, 73
-ﬁnite, 73
-regular, 464
complex, 667
Lebesgue, 76
projective limit, 572, 575
projective system, 572
tight, 614
Metric
discrete, 331
Hausdorff, 337
L´evy–Prohorov, 462
ultrametric, 333
.MI/, 50
Minimal upper bound, 15
Minkowski’s inequality, 649
Modal language
basic, 224
extended, 225
game logic, 227

INDEX
715
nabla, 225
PDL, 226
Modal logic, normal, 248
Model, 368, 369
t, 232
canonical, 253
game, 602
image ﬁnite, 243
Kripke, 228
morphism, 240
neighborhood, 232
Monad, 167
Haskell, 176
Manes, 190
multiplication, 168
unit, 168
Monic, jointly, 272
Mono, 122
Monoid, 126
Morphism
automaton, 120
bounded, 115, 201
codomain, 112
domain, 112
epi/mono factorization, 126
epimorphism, 123
frame, 239
game frame, 595
isomorphism, 127
measure spaces, 631
model, 240, 603
monomorphism, 122
neighborhood, 244
stochastic relations, 625
.MP/, 31
Mutual singular, 654
N
Nachbarschaft, 398
Naive set theory, 5
Natural transformation, 154
component, 155
Godement product, 158
horizontal composition, 157
vertical composition, 158
Neighborhood
frame, 231
model, 232
morphism, 244
open
point, 58
set, 311
Net, 301
Cauchy, 412
convergence, 301
Next operator, CSL, 577
Norm, 388
Nowhere dense, 358
Null set, 525
O
Open, Scott, 287, 383
Order
lexicographic, 18
linear, 15
strict, 15
Ordered, inductively, 29
Ordinal, 21
limit, 22
odd, even, 23
successor, 22
Orthogonal
complement, 643
vector, 643
Oscillation, 345
P
Partition, 399
Path quantiﬁer, CSL, 577

716
INDEX
PDL. See Propositional dynamic
logic (PDL)
Playing, 91
Portfolio, 443
Positive convexity, 193
afﬁne map, 194
morphism, 194
regular, 621
Predicate lifting, 256
Prime, 48
completely, 378
element, 378
Principal down sets, 47
Probability, discrete, 151
Probability functor
continuous, 173
continuous space, 152
discrete, 151, 172
Propositional dynamic logic (PDL),
226
fragment, 599
Propositional formula, 32
Propositional letters, 224
Pseudo-norm, 472
Pseudometric, 330
equivalent, 334
Pullback, 138
preserves weak pullbacks,
210
semi-pullback, 622
weak, 138
Q
Quotient object, 633
R
Radon–Nikodym derivative,
655, 658
Reduction system, 17
Relation
antisymmetric, 15
characteristic, 447
linear, 15
reﬂexive, 15
strict, 15
transitive, 15
Right adjoint, 180
S
-algebra, 65
complete, 88
countable-cocountable, 65, 484
countably generated, 482
ﬁnal, 435
initial, 435
product, 131, 436
separable, 485
sum, 437
trace, 435
weak, 118
-ideal, 72
.A/, 66
Satisﬁable, 33
Schwarz inequality, 641
Semicontinuous
lower, 422
upper, 422
Semi lattice, 190
Semi-pullback, 622
Semiring, 76
Sentence, 366
Separable, -algebra, 485
Separation
T0; T1, 310
T2, 309
T3; T3 1
2 ; T4, 311
Sequence, Cauchy, 340
Set
Gı, 346
-measurable, 89

INDEX
717
-null, 88
analytic, 500
clopen, 496
co-analytic, 500
cylinder, 436
directed, 301, 382, 464
saturated, 386
small, 410
Signed measure, 665
absolute continuity, 667
nullset, 667
positive set, 665
total variation, 667
Similar, 26
Somewhat natural numbers, 21
Sorgenfrey line, 309
Souslin scheme, 517
regular, 517
Space
T0; T1, 310
T3; T3 1
2 ; T4, 311
analytic, 506
Banach, 389
completely regular, 315
dual, 682
ﬁrst category, 358
Hausdorff, T2, 309
locally compact, 321
measurable, 117, 431
metric, 330
complete, 491
normal, 315
normed, 388
Polish, 491
probability, 117
pseudometric, 330
complete, 341
regular, 315
standard Borel, 517
topological, 58, 116
Baire sets, 431
Borel sets, 431
uniform, 397
complete, 411
separated, 406
topology, 403
State
behavioral equivalence, 261
logical equivalence, 261
theory, 261
Steady-state, CSL, 577
Stochastic relations, 439
category, 119
Strategy, winning, 91
Substitution, 245
Support, 151, 464
Supremum, 15
Symmetric difference, 52
T
t-measurable, 443
Terminal object, 273
Terminating, 17
Theorem
-, 85
Alexander’s Subbase, 62
Alexandrov, 495, 575
Baire
complete pseudometric,
357
locally compact, 327
Blackwell–Mackey, 513
Compactness, 34
Dini, 389
Egorov, 476
Fatou’s Lemma, 546
Hahn–Banach, 41
Heine–Borel, 57
Hennessy–Milner, 243

718
INDEX
Hofmann–Mislove, 386
Kuratowski and
Ryll-Nardzewski, 538
Kuratowski Isomorphism,
505
Lebesgue Dominated Conver-
gence, 547
Lubin, 531
Lusin, 503
Manes, 168
Prime Ideal, 51
Radon–Nikodym, 657
derivative, 658
Riesz Representation, 555
Schr¨oder–Bernstein, 10
Souslin, 504
Stone Duality, 61
Stone Representation, 55
Stone–Weierstraß, 391
Tarski Fixpoint, 107
Tihonov, 305
unique structure, 507
Urysohn’s Metrization, 340
von Neumann Selection, 530
Theory, 261
Top, 116
Topological sort, 35
Topological system, 373
c-morphism, 374
homeomorphism, 375
localic, 377
localization, 377
opens, 373
extension, 374
points, 373
spatialization, 375
Topology, 58
Alexandrov, 458
Baire sets, 431
base, 60, 283
Borel sets, 431
boundary, 59
closure, 59
compactiﬁcation, 324
discrete, indiscrete, 58
ﬁnal, 291
ﬁrst countable, 338
initial, 291
interior, 59
interval, 58
Priestley, 64
product, 292
quotient, 292
Scott, 287, 384
second countable, 338
separable, 338
sober, 381
subbase, 60
subspace, 58
sum, 292
topological group, 299
trace, 292
uniform, 403
uniform convergence, 389
Vietoris, 354
weak, 286, 608
Totally bounded, 350
Transition system, 115
behavioral equivalence, 263
bisimilar, 263
bisimulation, 202
labeled, 150
logical equivalence, 263
Tuckey’s Maximality Principle,
32
U
Ultraﬁlter, 43, 48
principal, 42
Ultrametric, 333

INDEX
719
Umgebung, 398
Uniformity, 397
p-adic, 400
additive, 399
discrete, 399
ﬁnite partitions, 400
indiscrete, 399
initial, 415
multiplicative, 399
product, 416
subspace, 416
Universal set, 493
Until operator, CSL, 577
Upper closed, 152
Urysohn’s Lemma, 315
V
Valuation, 33
Vector lattice, 550
Vitali’s equivalence relation, 90
W
Weak -algebra
}}}.A/, 118
ˇˇˇA.A; r/, 118
Weak topology, 608
Well-order, 16
O.x/; OM.x/, 19
.WO/, 19
World
behavioral equivalence, 261
logical equivalence, 261
theory, 261
Y
Yoneda isomorphism, 159
Z
Zermelo–Fraenkel System, 6
ZFC, 6
.ZL/, 29
Zorn’s Lemma, 32

