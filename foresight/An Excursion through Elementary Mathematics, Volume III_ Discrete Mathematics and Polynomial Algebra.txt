Problem Books in Mathematics
AntonioÂ CaminhaÂ MunizÂ Neto
An Excursion 
through Elementary 
Mathematics, 
Volume III
Discrete Mathematics and Polynomial 
Algebra

Problem Books in Mathematics
Series Editor:
Peter Winkler
Department of Mathematics
Dartmouth College
Hanover, NH
USA

More information about this series at http://www.springer.com/series/714

Antonio Caminha Muniz Neto
An Excursion through
Elementary Mathematics,
Volume III
Discrete Mathematics and Polynomial
Algebra
123

Antonio Caminha Muniz Neto
Universidade Federal do CearÃ¡
Fortaleza, CearÃ¡, Brazil
ISSN 0941-3502
ISSN 2197-8506
(electronic)
Problem Books in Mathematics
ISBN 978-3-319-77976-8
ISBN 978-3-319-77977-5
(eBook)
https://doi.org/10.1007/978-3-319-77977-5
Library of Congress Control Number: 2017933290
Â© Springer International Publishing AG, part of Springer Nature 2018
This work is subject to copyright. All rights are reserved by the Publisher, whether the whole or part of
the material is concerned, speciï¬cally the rights of translation, reprinting, reuse of illustrations, recitation,
broadcasting, reproduction on microï¬lms or in any other physical way, and transmission or information
storage and retrieval, electronic adaptation, computer software, or by similar or dissimilar methodology
now known or hereafter developed.
The use of general descriptive names, registered names, trademarks, service marks, etc. in this publication
does not imply, even in the absence of a speciï¬c statement, that such names are exempt from the relevant
protective laws and regulations and therefore free for general use.
The publisher, the authors and the editors are safe to assume that the advice and information in this book
are believed to be true and accurate at the date of publication. Neither the publisher nor the authors or
the editors give a warranty, express or implied, with respect to the material contained herein or for any
errors or omissions that may have been made. The publisher remains neutral with regard to jurisdictional
claims in published maps and institutional afï¬liations.
Printed on acid-free paper
This Springer imprint is published by the registered company Springer International Publishing AG part
of Springer Nature.
The registered company address is: Gewerbestrasse 11, 6330 Cham, Switzerland

E horas sem conta passo, mudo,
O olhar atento,
A trabalhar, longe de tudo
O pensamento.
Porque o escrever - tanta perÃ­cia,
Tanta requer,
Que ofÃ­cio tal.., nem hÃ¡ notÃ­cia
De outro qualquer.
Proï¬ssÃ£o de FÃ© (excerto) Olavo Bilac

Preface
This is the ï¬nal volume of a series of three volumes (the other ones being [9] and
[8]) devoted to the mathematics of mathematical olympiads. Generally speaking,
they are somewhat expanded versions of a collection of six volumes, ï¬rst published
in Portuguese by the Brazilian Mathematical Society in 2012 and currently in its
second edition.
The material collected here and in the other two volumes is based on course
notes that evolved over the years since 1991, when I ï¬rst began coaching students
of Fortaleza to the Brazilian Mathematical Olympiad and to the International Math-
ematical Olympiad. Some ten years ago, preliminary versions of the Portuguese
texts also served as textbooks for several editions of summer courses delivered at
UFC to math teachers of the Cape Verde Republic.
All volumes were carefully planned to be a balanced mixture of a smooth and
self-contained introduction to the fascinating world of mathematical competitions,
as well as to serve as textbooks for students and instructors involved with math clubs
for gifted high school students.
Upon writing the books, I have stuck myself to an invaluable advice of the
eminent Hungarian-American mathematician George PÃ³lya, who used to say that
one cannot learn mathematics without getting oneâ€™s hands dirty. Thatâ€™s why, in
several points throughout the text, I left to the reader the task of checking minor
aspects of more general developments. These appear either as small omitted details
in proofs or as subsidiary extensions of the theory. In this last case, I sometimes
refer the reader to speciï¬c problems along the book, which are marked with an *
and whose solutions are considered to be an essential part of the text. In general,
in each section I collect a list of problems, carefully chosen in the direction of
applying the material and ideas presented in the text. Dozens of them are taken from
former editions of mathematical competitions and range from the almost immediate
to real challenging ones. Regardless of their level of difï¬culty, generous hints, or
even complete solutions, are provided to virtually all of them.
As a quick look through the Contents pages readily shows, this time we con-
centrate on combinatorics, number theory, and polynomials. Although the chaptersâ€™
vii

viii
Preface
names quickly link them to one of these three major themes, whenever possible or
desirable later chapters revisit or complement material covered in earlier ones. We
now describe, a bit more speciï¬cally, what is covered within each major topic.
Chapters 1 through 5 are devoted to the study of basic combinatorial techniques
and structures. We start by reviewing the elementary counting strategies, emphasiz-
ing the construction of bijections and the use of recursive arguments throughout. We
then go through a bunch of more sophisticated tools, as the inclusion-exclusion prin-
ciple and double counting, the use of equivalence relations, metrics on ï¬nite sets,
and generating functions. Turning our attention to the existence of conï¬gurations,
the pigeonhole principle of Dirichlet and invariants associated with algorithmic
problems now play the central role. Our tour through combinatorics ï¬nishes by
studying some graph theory, all the way from the basic deï¬nitions to the classical
theorems of Euler (on Eulerian paths), Cayley (on the number of labeled trees), and
TurÃ¡n (on complete subgraphs of a given graph), to name just a few ones.
We then turn to elementary number theory, which is the object of Chaps. 6â€“12.
We begin, of course, by introducing the basic concepts and properties concerned
with the divisibility relation and exploring the notion of greatest common divisor
and prime numbers. Then we turn to diophantine equations, presenting Fermatâ€™s
descent method and solving the famous Pellâ€™s equation. Before driving through a
systematic study of congruences, we make an interlude to discuss the basics of
multiplicative arithmetic functions and the distribution of primes, these two chapters
being almost entirely independent of the rest of the book. From this point until
Chap. 12, we focus on the congruence relation and its consequences, from the very
beginnings to the ï¬nite ï¬eld Zp, primitive roots, Gaussâ€™ quadratic reciprocity law,
and Fermatâ€™s characterization of integers that can be written as the sum of two
squares. All of the above material is, here more than anywhere else in the book,
illustrated with lots of interesting and challenging examples and problems taken
from several math competitions around the world.
The last nine chapters are devoted to the study of complex numbers and
polynomials. Apart from what is usually present in high school classesâ€”as the
basics of complex numbers and the notion of degree, the division algorithm, and
the concept of root for polynomialsâ€”we discuss several nonstandard topics. We
begin by highlighting the use of complex numbers and polynomials as tags in
certain combinatorial problems and presenting a complete proof of the fundamental
theorem of algebra, accompanied with several applications. Then, we study the
famous theorem of Newton on symmetric polynomials and the equally famous
Newtonâ€™s inequalities. The next theme concerns interpolation of polynomials, when
particular attention is placed on Lagrangeâ€™s interpolation theorem. Such a result
is used to solve linear systems of Vandermonde with no linear algebra, which in
turn allows us to, later, analyze an important particular class of linear recurrence
relations. The book continues with the study of factorization of polynomials over Q,
Z, and Zp, together with several interesting problems on irreducibility. Algebraic
and transcendental numbers then make their appearance; among other topics, we
present a simple proof of the fact that the set of algebraic numbers forms a ï¬eld
and discuss the rudiments of cyclotomic polynomials and transcendental numbers.

Preface
ix
The ï¬nal chapter develops the most basic aspects of complex power series, which
are then used, disguised as complex generating functions, to solve general linear
recurrence relations.
Several people and institutions contributed throughout the years for my efforts
of turning a bunch of handwritten notes into these books. The State of CearÃ¡
Mathematical Olympiad, created by the Mathematics Department of the Federal
University of CearÃ¡ (UFC) back in 1980 and now in its 37th edition, has since
then motivated hundreds of youngsters of Fortaleza to deepen their studies of
mathematics. I was one such student in the late 1980s, and my involvement with this
competition and with the Brazilian Mathematical Olympiad a few years later had a
decisive inï¬‚uence on my choice of career. Throughout the 1990s, I had the honor
of coaching several brilliant students of Fortaleza to the Brazilian Mathematical
Olympiad. Some of them entered Brazilian teams to the IMO or other international
competitions, and their doubts, comments, and criticisms were of great help in
shaping my view on mathematical competitions. In this sense, sincere thanks go
to JoÃ£o Luiz de A. A. FalcÃ£o, Roney Rodger S. de Castro, Marcelo M. de Oliveira,
Marcondes C. FranÃ§a Jr., Marcelo C. de Souza, Eduardo C. Balreira, Breno de A. A.
FalcÃ£o, FabrÃ­cio S. Benevides, Rui F. Vigelis, Daniel P. Sobreira, Samuel B. Feitosa,
Davi MÃ¡ximo A. Nogueira, and Yuri G. Lima.
Professor JoÃ£o Lucas Barbosa, upon inviting me to write the textbooks to the
AmÃ­lcar Cabral Educational Cooperation Project with Cape Verde Republic, had
unconsciously provided me with the motivation to complete the Portuguese version
of these books. The continuous support of Professor HilÃ¡rio Alencar, president of
the Brazilian Mathematical Society when the Portuguese edition was ï¬rst published,
was also of great importance for me. Special thanks go to my colleaguesâ€”
professors Samuel B. Feitosa and Fernanda E. C. Camargoâ€”who read the entire
English version and helped me improve it in a number of ways. If it werenâ€™t for
my editor at Springer-Verlag, Mr. Robinson dos Santos, I almost surely would not
have had the courage to embrace the task of translating more that 1500 pages from
Portuguese into English. I acknowledge all the staff of Springer involved with this
project in his name.
Finally, and mostly, I would like to express my deepest gratitude to my parents
Antonio and Rosemary, my wife Monica, and our kids Gabriel and Isabela. From
early childhood, my parents have always called my attention to the importance of
a solid education, having done all they could for me and my brothers to attend the
best possible schools. My wife and kids fulï¬lled our home with the harmony and
softness I needed to get to endure on several months of work while translating this
book.
Fortaleza, Brazil
Antonio Caminha Muniz Neto
December 2017

Contents
1
Elementary Counting Techniques ........................................
1
2
More Counting Techniques ................................................
33
3
Generating Functions ......................................................
67
4
Existence of Conï¬gurations ...............................................
95
5
A Glimpse on Graph Theory .............................................. 125
6
Divisibility ................................................................... 157
7
Diophantine Equations..................................................... 193
8
Arithmetic Functions....................................................... 209
9
Calculus and Number Theory............................................. 221
10
The Relation of Congruence............................................... 243
11
Congruence Classes ........................................................ 269
12
Primitive Roots and Quadratic Residues ................................ 283
13
Complex Numbers.......................................................... 317
14
Polynomials.................................................................. 347
15
Roots of Polynomials ....................................................... 363
16
Relations Between Roots and Coefï¬cients ............................... 395
17
Polynomials Over R ........................................................ 417
18
Interpolation of Polynomials .............................................. 435
19
On the Factorisation of Polynomials ..................................... 451
xi

xii
Contents
20
Algebraic and Transcendental Numbers................................. 477
21
Linear Recurrence Relations .............................................. 505
22
Hints and Solutions......................................................... 529
Glossary ........................................................................... 635
Bibliography ...................................................................... 637
Index............................................................................... 639

Chapter 1
Elementary Counting Techniques
In this ï¬rst chapter, we develop the usual elementary tools for counting the number
of distinct conï¬gurations corresponding to a certain combinatorial situation, without
needing to list them one by one. As the reader will see, the essential ideas are the
construction of bijections and the use of recursive arguments.
Although we develop all material from scratch, the reader is expected to have
some previous experience with elementary counting techniques, and is warned that
the material collected here can be somewhat terse at places.
1.1
The Bijective Principle
In all that follows, we assume that the reader has a relative acquaintance with sets
and elementary operations on them. Given n âˆˆN, we let In denote the set
In = {j âˆˆN; 1 â‰¤j â‰¤n}
of natural numbers from 1 to n.
A set A is ï¬nite if A = âˆ…or if there exists a bijection f : In â†’A, for some
n âˆˆN. If A Ì¸= âˆ…is ï¬nite and f : In â†’A is a bijection, then letting aj = f (j) we
write A = {a1, . . . , an} and say that n is the number of elements of A (Problem 1
shows that this is a well deï¬ned notion). Also in this case, we write
|A| = n or #A = n
to mean that A has n elements. For the sake of completeness, we say that âˆ…has 0
elements and write |âˆ…| = 0.
Â© Springer International Publishing AG, part of Springer Nature 2018
A. Caminha Muniz Neto, An Excursion through Elementary Mathematics, Volume III,
Problem Books in Mathematics, https://doi.org/10.1007/978-3-319-77977-5_1
1

2
1
Elementary Counting Techniques
The elementary theory of counting (conï¬gurations) has its foundations in the
following simple proposition, to which we will systematically refer as the bijective
principle.
Proposition 1.1 If A and B are nonempty ï¬nite sets, then |A| = |B| if and only if
there exists a bijection f : A â†’B.
Proof First of all, assume that there exists a bijection f : A â†’B. If |A| = n, we
can take a bijection g : In â†’A, so that f â—¦g : In â†’B is also a bijection. Hence,
|B| = n.
Conversely, suppose that |A| = |B| = n, with bijections g : In â†’A and
h : In â†’B. Then h â—¦gâˆ’1 : A â†’B is a bijection from A to B.
âŠ“âŠ”
The following consequence of the bijective principle is sometimes referred to as
the additive principle of counting. Before we state it, we recall that two sets A and
B are said to be disjoint if A âˆ©B = âˆ….
Proposition 1.2 If A and B are ï¬nite disjoint sets, then
|A âˆªB| = |A| + |B|.
Proof Exercise (see Problem 2).
âŠ“âŠ”
A typical application of the former proposition consists in counting the number of
different ways of choosing exactly one object out of two possible distinct kinds, such
that there is a ï¬nite number of possibilities for each kind of object. In the statement
of the proposition, the kinds correspond to the disjoint sets A and B, whereas the
possibilities for each kind correspond to the elements of A and B.
An easy induction allows us to generalize the additive principle for n ï¬nite
pairwise disjoint sets. This is the content of the coming
Corollary 1.3 If A1, A2, . . . , An are ï¬nite pairwise disjoint sets, then
#
n

j=1
Aj =
n

j=1
|Aj|.
Proof Exercise (see Problem 3).
âŠ“âŠ”
For what comes next, given two sets A and B, we let A \ B denote the set
A \ B = {x âˆˆA; x /âˆˆB}
and say that A\B is the difference between A and B, in this order. If B âŠ‚A, and if
no danger of confusion arises, we shall sometimes refer to A\B as the complement
of B in A, in which case we denote it as Bc, instead of A \ B.
The simple formula of the next corollary, which counts the number of elements
of the complement of a subset of a ï¬nite set, is an additional consequence of the
additive principle.

1.1
The Bijective Principle
3
Corollary 1.4 If A is a ï¬nite set and B âŠ‚A, then
|B| = |A| âˆ’|A \ B|.
Proof Since A = B âˆª(A \ B), a disjoint union, the additive principle gives
|A| = |B âˆª(A \ B)| = |B| + |A \ B|.
âŠ“âŠ”
The general philosophy behind the use of the previous corollary in problems of
counting is this: suppose we wish to count the number of elements of a certain ï¬nite
set B, but do not know how to do it directly. An interesting strategy is to search for
a ï¬nite set A âŠƒB such that we know how to count both |A| and |A \ B|. Then, we
apply the formula of the corollary to compute the desired number of elements of B.
Some concrete examples of this situation will be found in what is to come.
Our next result generalizes Proposition 1.1 and Corollary 1.4, computing the
number of elements of a union of two ï¬nite sets. Formula (1.1) below is known as
the principle of inclusion-exclusion for two ï¬nite sets, and will be generalized in
Sect. 2.1 (cf. Theorem 2.1).
Proposition 1.5 If A and B are ï¬nite sets, then
|A âˆªB| = |A| + |B| âˆ’|A âˆ©B|.
(1.1)
Proof Since A and B \ A are ï¬nite, disjoint and such that A âˆªB = A âˆª(B \ A), the
additive principle gives
|A âˆªB| = |A âˆª(B \ A)| = |A| + |B \ A|.
On the other hand, we also have the disjoint union
B = (B \ A) âˆª(A âˆ©B),
so that, again from the additive principle, |B| = |B \ A| + |A âˆ©B|. Then, |B \ A| =
|B| âˆ’|A âˆ©B|, and once we plug this formula into the above relation for |A âˆªB|
we get
|A âˆªB| = |A| + (|B| âˆ’|A âˆ©B|).
âŠ“âŠ”
For what comes next, recall that the cartesian product of sets A and B is the
set A Ã— B whose elements are the ordered pairs (a, b) with a âˆˆA and b âˆˆB. In
mathematical symbols,
A Ã— B = {(a, b); a âˆˆA, b âˆˆB}.

4
1
Elementary Counting Techniques
It is also worth recalling that ordered pairs possess the following important property:
if (a, b), (c, d) âˆˆA Ã— B, then
(a, b) = (c, d) â‡”a = c and b = d.
In this respect, see Problem 5.
The coming result, together with its subsequent corollary, are known as the
multiplicative principle or as the fundamental principle of counting.
Proposition 1.6 If A and B are nonempty ï¬nite sets, then A Ã— B is also ï¬nite, with
|A Ã— B| = |A| Â· |B|.
Proof Writing B = {y1, . . . , ym} = m
j=1{yj}, it follows from Problem 6 that
A Ã— B = A Ã—
â›
â
m

j=1
{yj}
â
â =
m

j=1
(A Ã— {yj}),
a disjoint union. Hence, Corollary 1.3 gives
|A Ã— B| =
			
m

j=1
(A Ã— {yj})
			 =
m

j=1
|A Ã— {yj}|.
(1.2)
Now, since f : A â†’A Ã— {yj} given by f (x) = (x, yj) is a bijection (with
inverse g : AÃ—{yj} â†’A given by g(x, yj) = x), the bijective principle guarantees
that |A| = |A Ã— {yj}| for 1 â‰¤j â‰¤m. Hence, it follows from (1.2) that
|A Ã— B| =
m

j=1
|A| = |A| Â· m = |A| Â· |B|.
âŠ“âŠ”
In applications, we ought to invoke this version of the fundamental principle of
counting whenever we need to choose two objects simultaneously, such that one
of the objects is of one of two possible kinds and the other object is of the other
kind (and each kind comprises a ï¬nite number of possibilities). In the statement of
the proposition, the two possible kinds correspond to the sets A and B, whereas the
possibilities for each kind correspond to the elements of A and B.
It is time we look at a concrete example.
Example 1.7 How many natural numbers have two distinct nonzero algarisms, both
less that or equal to 5? How many of them are such that the ï¬rst algarism is smaller
that the second one?

1.1
The Bijective Principle
5
Solution Let A = {1, 2, 3, 4, 5}. The ï¬rst part of the problem is clearly equivalent
to counting how many ordered pairs (a, b) âˆˆA Ã— A are such that a Ì¸= b; the second
part requires that a < b.
Let us start counting the number of ordered pairs (a, b) âˆˆA Ã— A, without
additional restrictions. Since this is the same as counting the number of elements of
A Ã— A, the multiplicative principle gives 5 Ã— 5 = 25 possible pairs (a, b). In order
to count how many of them are such that a Ì¸= b, let us use Corollary 1.4: the number
of such pairs is obtained by discounting, from the total number of pairs, those for
which a = b. Since there are 5 pairs (a, a) with a âˆˆA, we conclude that there are
25 âˆ’5 = 20 pairs (a, b) with a Ì¸= b.
For what is left, note that (a, b) is an ordered pair such that a < b if and only
if (b, a) is an ordered pair for which b > a; in other words, the correspondence
(a, b) â†’(b, a) is a bijection between the set whose elements are the ordered pairs
(a, b) âˆˆAÃ—A such that a < b and that formed by the ordered pairs (aâ€², bâ€²) âˆˆAÃ—A
for which aâ€² > bâ€². Hence, these sets have the same number of elements (namely,
ordered pairs); since they are disjoint and their union equals the set of pairs (a, b) âˆˆ
A Ã— A such that a Ì¸= b, it follows from Proposition 1.2 that the desired number of
ordered pairs is 20
2 = 10.
âŠ“âŠ”
For the subsequent discussion, we need to extend the concept of cartesian product
to an arbitrary ï¬nite number of ï¬nite nonempty sets. To this end, given ï¬nite
nonempty sets A1, A2, . . . , An, letâ€™s deï¬ne their cartesian product A1 Ã— A2 Ã—
Â· Â· Â· Ã— An as the set of sequences (to which we shall sometimes refer to as n-tuples)
(a1, a2, . . . , an), such that a1 âˆˆA1, a2 âˆˆA2, . . . , an âˆˆAn.1
Corollary 1.8 If A1, A2, . . . , An are ï¬nite nonempty sets, then
|A1 Ã— A2 Ã— Â· Â· Â· Ã— An| =
n

j=1
|Aj|.
Proof Exercise (see Problem 7).
âŠ“âŠ”
The next corollary brings an important elaboration of the multiplicative principle.
Corollary 1.9 Let A1, A2, . . . , Ak be ï¬nite nonempty sets with |A1| = n1, |A2| =
n2, . . . , |Ak| = nk. Then, there are exactly n1n2 . . . nk sequences (a1, a2, . . . , ak)
with aj âˆˆAj for 1 â‰¤j â‰¤k.
1In view of this deï¬nition, in principle we have two distinct deï¬nitions for the elements of A Ã— B:
on the one hand, they consist of the ordered pairs (a, b) such that a âˆˆA and b âˆˆB; on the other,
they are sequences (a, b) for which a âˆˆA and b âˆˆB. Since the ordered pair (a, b) is deï¬ned
by (a, b) = {{a}, {a, b}} (cf. Problem 5) and the sequence (a, b) (with a âˆˆA and b âˆˆB) is the
function f : {1, 2} â†’A âˆªB such that f (1) := a âˆˆA and f (2) := b âˆˆB, we come to the
conclusion that, although we have been using the same notation, they are distinct mathematical
objects. However, for our purposes the identiï¬cation of the ordered pair (a, b) to the sequence
(a, b) is totally harmless and will be done, from now on, without further comments.

6
1
Elementary Counting Techniques
Proof As we have told above, a sequence (a1, a2, . . . , ak) such that a1 âˆˆA1, a2 âˆˆ
A2, . . . , ak âˆˆAk is nothing but an element of the cartesian product A1 Ã— A2 Ã— Â· Â· Â· Ã—
Ak. Hence, the number of such sequences equals the number of elements of A1 Ã—
A2 Ã— Â· Â· Â· Ã— Ak, which in turn equals, by the previous corollary, |A1||A2| . . . |Ak| =
n1n2 . . . nk.
âŠ“âŠ”
In words, the above corollary furnishes a method for counting in how many
(distinct) ways we can choose k objects in order but independently, with the ï¬rst
object being of type 1, the second being of type 2, . . . , the k-th being of type k and
having at our disposal one or more possibilities for the choice of each type of object.
Here again, the distinct types of objects correspond to the sets A1, . . . , Ak, whereas
the numbers of possibilities for each type of object correspond to the elements of
the sets under consideration.
As a special case of the situation of Corollary 1.9, we can count in how many
ways it is possible to choose, in order but independently, k elements out of a set
of n elements, with repeated choices being allowed. More precisely, we have the
following
Corollary 1.10 If |A| = n, then there are exactly nk sequences of k terms, all
chosen from the elements of A.
Proof Make A1 = Â· Â· Â· = Ak = A in Corollary 1.9.
âŠ“âŠ”
In other words, we say that the above corollary counts how many arrangements
with repetition of k objects, chosen out of a set with n objects, there exist.
Yet another way of looking at the result of Corollary 1.10 is to start by recalling
that a sequence of k terms, all belonging to In, is simply a function f : Ik â†’In;
hence, what we established in that corollary was the fact that the number of distinct
functions f : Ik â†’In is exactly nk. Later, we shall compute how many of such
functions are injective and how many are surjective.
The coming example applies the circle of ideas above to a concrete situation. For
its solution, the reader might ï¬nd it helpful to recall the criterion of divisibility by 3,
which will be derived in Problem 1, page 162: the remainder of a natural number n
upon division by 3 equals that of the sum of its algarisms.
Example 1.11 Compute the quantity of natural numbers n, of ten algarisms and
satisfying the following conditions:
(a) n does not end in 0.
(b) n is divisible by 3.
Solution If n = (a1a2 . . . a9a10) the decimal representation of n, then m =
(a1a2 . . . a9) is a natural number of nine algarisms and a10 âˆˆ{1, 2, 3, . . . , 9}.
Now, for a ï¬xed m = (a1a2 . . . a9), the criterion of divisibility by 3 assures
that each of the numbers (a1a2 . . . a91), (a1a2 . . . a94) and (a1a2 . . . a97) leave
the same remainder upon division by 3, the same happening with the numbers
(a1a2 . . . a92), (a1a2 . . . a95) and (a1a2 . . . a98), as well as with the numbers
(a1a2 . . . a93), (a1a2 . . . a96) and (a1a2 . . . a99). Moreover, letting r1, r2 and r3
denote such common remainders, then r1, r2 and r3 are pairwise distinct.

1.1
The Bijective Principle
7
Hence, for each natural number m = (a1a2 . . . a9) of nine algarisms, we have
exactly three natural numbers n = (a1a2 . . . a9a10) which are divisible by 3. Since
a1 âˆˆ{1, 2, . . . , 9} and a2, . . . , a9 âˆˆ{0, 1, 2, . . . , 9}, Corollary 1.9 guarantees that
the total of numbers we want to compute is 9 Ã— 108 Ã— 3 = 27 Ã— 108.
âŠ“âŠ”
Problems: Sect. 1.1
1. * Prove that the notion of number of elements of a nonempty ï¬nite set is a well
deï¬ned concept. More precisely, prove that there exists a bijection f : Im â†’In
if and only if m = n.
2. * Prove the additive principle of counting from the deï¬nition for the number of
elements of a ï¬nite set. More precisely, prove that if A and B are nonempty,
ï¬nite disjoint sets, with |A| = m and |B| = n, then there exists a bijection
f : Im+n â†’A âˆªB.
3. * Prove Corollary 1.3.
4. * Let A and B be nonempty ï¬nite sets, with |A| = |B|. Prove that a function
f : A â†’B is injective if and only if it is surjective.
5. * Given sets A and B and elements a âˆˆA, b âˆˆB, we formally deï¬ne the
ordered pair (a, b) by letting2
(a, b) = {{a}, {a, b}}.
Use this deï¬nition to show that, for a, c âˆˆA and b, d âˆˆB, one has (a, b) =
(c, d) â‡”a = c and b = d.
6. * Given nonempty sets A, B1, . . . , Bn, prove that
A Ã—

n

j=1
Bj

=
n

j=1
(A Ã— Bj).
Moreover, if B1, . . . , Bn are pairwise disjoint, prove that A Ã— B1, . . . , A Ã— Bn
are also pairwise disjoint.
7. * Prove Corollary 1.8.
For the next problem, we deï¬ne an ordered partition of a set A as a
sequence (A1, . . . , Ak) of subsets of A satisfying the following conditions: (i)
A = A1 âˆª. . . âˆªAk; (ii) A1, . . . , Ak are pairwise disjoint. In this case, we use
to say that A1, . . . , Ak (in this order) form an ordered partition of A into k of
its subsets.
8. Let n, k âˆˆN and A be a ï¬nite set with n elements. Show that there exist exactly
kn ordered partitions of A into k subsets A1, . . . , Ak.
2Such a deï¬nition is due to Kazimierz Kuratowski, Polish mathematician of the twentieth century.

8
1
Elementary Counting Techniques
9. In the cartesian plane, a pawn moves according to the following rule: being at
the point (a, b), he can go to one of the points (a + 1, b + 1), (a + 1, b âˆ’1),
(a âˆ’1, b + 1) or (a âˆ’1, b âˆ’1). If the pawn starts at the point (0, 0), how many
distinct positions can he occupy after his ï¬rst n moves?
10. (AIMEâ€”adapted) Given k, n âˆˆN, do the following items:
(a) For a given integer 1 â‰¤j â‰¤n, prove that there are exactly (n âˆ’j + 1)k
sequences formed by k elements of In (possibly with repetitions) such that
the smallest term of the sequence is greater than or equal to j.
(b) For a given integer 1 â‰¤j â‰¤n, prove that there are exactly (n âˆ’j + 1)k âˆ’
(n âˆ’j)k sequences formed by k elements of In (possibly with repetitions),
such that the smallest term of the sequence equals j.
(c) Prove that the sum of the smallest terms of all nk sequences of k elements
of In (possibly with repetitions) equals 1k + 2k + Â· Â· Â· + nk.
11. (France) Let k âˆˆN, A = {1, 2, 3, . . . , 2k} and X be a subset of A satisfying
the following condition: if x âˆˆX, then 2x /âˆˆX. Find, with proof, the greatest
possible number of elements of X.
1.2
More Bijections
In this section, with the elementary results of the previous section at our disposal, we
present some instances of deeper applications of the bijective principle to establish
the equality of the numbers of elements of two ï¬nite sets.
We start by computing, in two different ways, the number of subsets of a ï¬nite
set. If A is any set, we let P(A) denote the power set of A, i.e., the family3
P(A) = {B; B âŠ‚A}.
Given ï¬nite sets A and B, both with n elements, a bijection f : A â†’B naturally
induces a bijection Ëœf : P(A) â†’P(B), deï¬ned for C âŠ‚A by
Ëœf (C) = {f (x); x âˆˆC}.
In words, given a subset C of A, we let Ëœf (C) be the subset of B whose elements are
the images of the elements of C by f . In particular, note that
Ëœf (âˆ…) = {f (x); x âˆˆâˆ…} = âˆ…,
since it is impossible to choose x âˆˆâˆ….
3In Set Theory, a family is a set whose elements are also sets.

1.2
More Bijections
9
Hence, as a corollary to the bijective principle, if A and B are nonempty ï¬nite
disjoint sets, then
|A| = |B| â‡’|P(A)| = |P(B)|.
(1.3)
We shall also need another concept, which will be useful in future discussions.
Deï¬nition 1.12 Let A be a nonempty set. For B âŠ‚A, the characteristic function
of B (with respect to A) is the function Ï‡B : A â†’{0, 1}, deï¬ned by
Ï‡B(x) =
0, if x /âˆˆB
1, if x âˆˆB .
(1.4)
For example, if A = {a, b, c, d, e, f, g} and B = {c, f, g}, then Ï‡B is the
function from A to {0, 1} such that
Ï‡B(a) = Ï‡B(b) = Ï‡B(d) = Ï‡B(e) = 0 and Ï‡B(c) = Ï‡B(f ) = Ï‡B(g) = 1.
For what follows, if A = {a1, . . . , an} is a set with n elements, whenever
convenient we can associate to A the sequence (a1, . . . , an); whenever we do that,
we shall say that (a1, . . . , an) is an ordering of (the elements of) A or, sometimes,
the natural ordering of A.
If B âŠ‚A, a (combinatorially) more interesting way of looking at the char-
acteristic function Ï‡B of B with respect to A is to consider it as a sequence of
0â€™s and 1â€™s, with the positions of the 1â€™s (with respect to the natural ordering of
A) corresponding to the elements of B. For instance, let A = {a, b, c, d, e, f, g},
furnished with the ordering induced from the lexicographical (i.e., alphabetical)
order; if B = {c, f, g}, then the characteristic function of B corresponds to the
sequence (0, 0, 1, 0, 0, 1, 1).
More generally, let A = {a1, . . . , an}, furnished with the natural ordering. For
B âŠ‚A, the characteristic sequence of B in A is the sequence sB = (Î±1, . . . , Î±n),
such that
Î±j =
0, if aj /âˆˆB
1, if aj âˆˆB .
(1.5)
We can ï¬nally compute the number of subsets of a set with n elements.
Theorem 1.13 A set with n elements has exactly 2n subsets.
Proof Let A = {a1, . . . , an} be a set with n elements, furnished with its natural
ordering, and let S be the set of sequences of n terms, formed by the elements of the
set {0, 1}. By Corollary 1.10, we have |S| = 2n. We will show that |P(A)| = 2n,
and to this end it sufï¬ces to show that the function
f : P(A) âˆ’â†’S
B
âˆ’â†’sB

10
1
Elementary Counting Techniques
(i.e., the function which associates to each subset of A its characteristic sequence
with respect to A) is a bijection. For what is left to do, check that the function
g : S â†’P(A), given by
g(Î±1, . . . , Î±n) = {aj âˆˆA; Î±j = 1},
is the inverse of f .
âŠ“âŠ”
It is instructive to note that we can give another proof of the previous result, this
time relying more directly on the bijective principle. Indeed, by (1.3) it sufï¬ces to
show that the set A = {0, 1, . . . , n âˆ’1} has precisely 2n subsets. To this end, we let
f : P(A) â†’{0, 1, 2, . . . , 2n âˆ’1}
be given by f (âˆ…) = 0 and, for âˆ…Ì¸= B = {a1, . . . , ak} âŠ‚A, with 0 â‰¤a1 < Â· Â· Â· <
ak â‰¤n âˆ’1,
f (B) = 2a1 + Â· Â· Â· + 2ak.
Since
1 â‰¤2a1 + Â· Â· Â· + 2ak â‰¤20 + 21 + Â· Â· Â· + 2nâˆ’1 = 2n âˆ’1,
f is well deï¬ned. To conclude that it is a bijection, recall Example 4.12 of [8], which
shows that every integer 1 â‰¤m â‰¤2n âˆ’1 can be written, in a unique way up to the
order of the summands, as a sum of distinct powers of 2 (obviously, none of these
can be bigger that 2nâˆ’1); such a way of writing m is called its binary representation.
Thus, the uniqueness of the binary representation is equivalent to the injectivity of
f , whereas the existence of such a representation is equivalent to the surjectivity of
f .
Notice how the above proof highlights the strength of the bijective principle in
counting problems. Let us see two more examples.
Example 1.14 Let n be a natural number of the form 4k + 1 or 4k + 2, for some
nonnegative integer k. Prove that In contains exactly 2nâˆ’1 subsets with even sum of
elements (and under the convention that the sum of the elements of the empty set is
0).
Proof Let F0 and F1 be the families of the subsets of In with sum of elements
respectively even and odd. Since F0 and F1 are disjoint and such that F0 âˆªF1 =
P(A), it follows from the additive principle and Theorem 1.13 that
|F0| + |F1| = |P(A)| = 2n.
Thus, if we show that |F0| = |F1|, we will get |F0| = |F1| = 2nâˆ’1.

1.2
More Bijections
11
To what is left to do, letâ€™s construct a bijection between F0 and F1. To this end,
consider the function
f : P(A) âˆ’â†’P(A)
B
âˆ’â†’
Bc ,
where Bc = A\B denotes the complement of B in A. Since (Bc)c = A\(A\B) =
B, we have f (f (B)) = B for every B âŠ‚A; hence, f â—¦f = IdP(A), so that f is a
bijection (cf. Example 6.40 of [8]). Now, the idea is to show that, if n = 4k + 1 or
n = 4k + 2, then f induces a bijection between F0 and F1.
Given B âŠ‚A, we have

xâˆˆB
x +

xâˆˆBC
x =

xâˆˆA
x =
n

x=1
x = n(n + 1)
2
= (4k + 1)(2k + 1) or (2k + 1)(4k + 3),
according to whether n = 4k + 1 or n = 4k + 2. In any case,

xâˆˆB
x +

xâˆˆBC
x
is an odd number, so that the sums of the elements of B and of Bc have distinct
parities; in symbols,
B âˆˆF0 â‡”Bc âˆˆF1.
Therefore, the restriction g of f to F0 applies F0 into F1, whereas the restriction
h of f to F1 applies F1 into F0. However, since g and h are clearly inverses of
each other (for, f = f âˆ’1), it follows that g and h are also bijections, so that
|F0| = |F1|.
âŠ“âŠ”
The bijective principle is particularly useful to understand the properties of the
partitions of a natural number n. Here and in all that follows, a partition of the
natural number n is a way of writing n as a sum of (one or more) not necessarily
distinct natural summands. For example, the distinct partitions of 4 are
4 = 1 + 3 = 1 + 1 + 2 = 1 + 1 + 1 + 1 = 2 + 2.
The coming example is due to L. Euler.
Example 1.15 (Euler)
Prove that the number of partitions of a natural n in odd
summands equals the number of partitions of n in distinct summands.
Proof Letting In denote the set of partitions of n in odd summands and Dn the set
of partitions of n in distinct summands, it sufï¬ces to construct a bijection f : In â†’

12
1
Elementary Counting Techniques
Dn. To understand how to deï¬ne f , consider the following partition of 51 in odd
summands:
1 + 1 + 3 + 3 + 3 + 3 + 3 + 3 + 5 + 5 + 7 + 7 + 7.
Then, we can also write
51 = 2 Â· 1 + 6 Â· 3 + 2 Â· 5 + 3 Â· 7
= 21 Â· 1 + (22 + 21) Â· 3 + 21 Â· 5 + (21 + 20) Â· 7
= 21 Â· 1 + 22 Â· 3 + 21 Â· 3 + 21 Â· 5 + 21 Â· 7 + 20 Â· 7
= 2 + 12 + 6 + 10 + 14 + 7,
which is a partition of 51 in distinct summands. In what follows, we shall make the
above particular case into a general argument to get the desired bijection.
A partition P âˆˆIn is
n = 1 + Â· Â· Â· + 1



a1
+ 3 + Â· Â· Â· + 3



a3
+ 5 + Â· Â· Â· + 5



a5
+ 7 + Â· Â· Â· + 7



a7
+ Â· Â· Â· ,
where a1, a3, a5, . . . â‰¥0 and, from some natural number k on, the number a2k+1 of
summands equal to 2k + 1 is 0. Then, we can write
n = a1 Â· 1 + a3 Â· 3 + a5 Â· 5 + a7 Â· 7 + Â· Â· Â· .
From here, in order to get a partition f (P) of n into distinct summands, substitute
each positive coefï¬cient a2k+1 by its binary representation (cf. Example 4.12 de [8])
and, if 2l is one of the summands of such a representation, let 2l(2k + 1) be one of
the summands in f (P) (you can easily notice that this is exactly what we did in the
particular case of the partitions of 51).
By systematically proceeding this way, we claim that we get a partition of n into
distinct summands. Indeed, any two summands of f (P) can be written as
2l1(2k1 + 1) and 2l2(2k2 + 1);
if k1 Ì¸= k2, then such summands are clearly different from one another; if k1 =
k2, then we must have l1 Ì¸= l2, for 2l1 and 2l2 are two summands of the binary
representation of a2k1+1 = a2k2+1. In any case, f is well deï¬ned.
To prove that f is a bijection, letâ€™s deï¬ne a function g : Dn â†’In (which will be
the inverse of f ) in the following way: let Q be the partition
n = (m11 + m12 + Â· Â· Â· + m1t1) + (m31 + m32 + Â· Â· Â· + m3t3)
+ (m51 + m52 + Â· Â· Â· + m5t5) + Â· Â· Â·

1.2
More Bijections
13
of n into distinct summands, where we have grouped, within each pair of
parentheses, all summands with a single odd part. More precisely, what we are
saying is that m2k+1,i = 2li(2k + 1), for some nonnegative integer li. Then,
m2k+1,1 + Â· Â· Â· + m2k+1,tk = 2l1(2k + 1) + Â· Â· Â· + 2ltk (2k + 1)
= (2l1 + Â· Â· Â· + 2ltk )(2k + 1),
so that, letting a2k+1 = 2l1 + Â· Â· Â· + 2ltk , we get
n = a1 Â· 1 + a3 Â· 3 + a5 Â· 5 + a7 Â· 7 + Â· Â· Â· .
We thus deï¬ne g(Q) to be the partition
n = 1 + Â· Â· Â· + 1



a1
+ 3 + Â· Â· Â· + 3



a3
+ 5 + Â· Â· Â· + 5



a5
+ 7 + Â· Â· Â· + 7



a7
+ Â· Â· Â· ,
so that g(Q) âˆˆIn.
Finally, it is immediate to verify that f and g are inverses of each other.
âŠ“âŠ”
Problems: Sect. 1.2
1. Compute the number of subsets of the set In which contain n.
2. * (APMO) We are given a natural number n and a ï¬nite nonempty set A. Show
that there are exactly (2n âˆ’1)|A| sequences (A1, A2, . . . , An), formed by subsets
of A such that A = A1 âˆªA2 âˆª. . . âˆªAn.
3. (Soviet Union) We are given n straight lines in the plane, in general position, i.e.,
such that no two of them are parallel and no three of them pass through the same
point. Compute the number of regions into which these lines divide the plane.
For the next problem, we say that a family F of subsets of In is an intersecting
system if, for every distinct A, B âˆˆF, we have A âˆ©B Ì¸= âˆ….
4. (Bulgariaâ€”adapted) Let F be an intersecting system in In.
(a) Give an example of such an F in which |F| = 2nâˆ’1.
(b) Prove that |F| â‰¤2nâˆ’1, for any such F.
5. * Given n âˆˆN, let In be the family of subsets of In with odd numbers of
elements. If A = {x1, x2, . . . , x2k+1} âˆˆIn, with x1 < x2 < Â· Â· Â· < x2k+1,
we say that xk+1 is the central element of A, and write xk+1 = c(A). In this
respect, do the following items:
(a) For 1 â‰¤x1 < x2 < Â· Â· Â· < x2k+1 â‰¤n, show that the correspondence
{x1, x2, . . . , x2k+1} â†’{n + 1 âˆ’x2k+1, . . . , n + 1 âˆ’x2, n + 1 âˆ’x1}

14
1
Elementary Counting Techniques
establishes a bijection between the sets in In having central elements
respectively equal to i and n + 1 âˆ’i.
(b) In Problem 5, page 20, we will show that |In| = 2nâˆ’1. Use the result of item
(a), together with this fact, to show that

AâˆˆIn
c(A) = (n + 1) Â· 2nâˆ’2.
6. (TT) Given n âˆˆN, we deï¬ne the diversity of a partition of n as the number of
distinct summands in it. Also, let p(n) stand for the number of distinct partitions
of n and q(n) for the sum of the diversities of all of the p(n) partitions of n.
Prove that:
(a) q(n) = 1 + p(1) + p(2) + Â· Â· Â· + p(n âˆ’1).
(b) q(n) â‰¤
âˆš
2np(n).
1.3
Recursion
The general philosophy behind recursive counting is the following: we wish to count
the number an of elements of a set An, which is declared by means of some speciï¬c
rule(s) concerning the natural number n. We do this in a two-step process: ï¬rstly,
we use the declaration of An to get a recurrence relation for the sequence (an)nâ‰¥1,
i.e., a relation of the form
an = F(a1, . . . , anâˆ’1, n),
(1.6)
where F is some function of n variables; secondly, we use the recurrence relation,
together with algebraic and/or analytical arguments, to compute or estimate an in
terms of n.
In this section we concentrate our efforts in the ï¬rst step above, by examining
in detail some speciï¬c examples ranging in difï¬culty from almost trivial to real
challenging. As for the second step, for the time being we assume that the reader is
familiar with the solution of linear recurrence relations of order at most three and
with constant coefï¬cients, as presented in Chapter 3 of [8]. Chapters 3 and 21 will
develop more powerful tools for the treatment of more general recurrence relations.
We start with a recursive counting for the number os subsets of a ï¬nite set.
Example 1.16 If A is a set with n elements, then A has exactly 2n subsets.
Proof Let an be the number of subsets of A (here, we are implicitly using (1.3)
when we write |A| as a function of n). For a ï¬xed x âˆˆA, there are two kinds of
subsets of A: those which contain x and those which do not.

1.3
Recursion
15
If B is a subset of A containing x, then B \ {x} is a subset of A \ {x}; conversely,
if Bâ€² is a subset of A \ {x}, then Bâ€² âˆª{x} is a subset of A containing x. Since
such correspondences are clearly inverses of each other, we conclude that there are
as many subsets of A containing x as there are subsets of A \ {x}; however, since
|A \ {x}| = n âˆ’1, it follows that there are exactly anâˆ’1 of such subsets of A. On
the other hand, since the subsets of A not containing x are precisely the subsets of
A \ {x}, we have exactly anâˆ’1 subsets of this second kind.
The argument of the previous paragraph clearly gives an = 2anâˆ’1 for every
n > 1. Since we obviously have a1 = 2, the formula for the general term of a GP
gives
an = a1 Â· 2nâˆ’1 = 2n.
âŠ“âŠ”
Our next example provides a recursive approach to Problem 3, page 13.
Example 1.17 (Soviet Union) We are given n straight lines in the plane, in general
position, i.e., such that no two of them are parallel and no three of them pass through
the same point. Compute the number of regions into which these lines divide the
plane.
Solution Let ak be the number of regions into which the plane gets divided by some
k straight lines in general position. We trace out one more straight line, say r, such
that the k + 1 resulting lines are also in general position. Since r intersects the k
other lines in k distinct points, we conclude that r gets divided in k + 1 intervals by
these k points. In turn, each one of these k + 1 intervals corresponds to exactly one
region, from the ak regions we had, that r splits into two new regions. Therefore,
when we trace out line r we extinguish k + 1 older regions and generate 2(k + 1)
new regions. Thus, if ak+1 denotes the total number of regions we get after tracing
out line r, we conclude that
ak+1 = ak âˆ’(k + 1) + 2(k + 1) = ak + (k + 1).
Finally, since a1 = 2, the formula for telescoping sums (formula (3.15) of [8])
gives
an = a1 +
nâˆ’1

k=1
(ak+1 âˆ’ak) = 2 +
nâˆ’1

k=1
(k + 1)
= 1 +
n

k=1
k = 1 + n(n + 1)
2
.
âŠ“âŠ”

16
1
Elementary Counting Techniques
The coming example is perhaps the most celebrated of all elementary applica-
tions of recursive reasoning, being known as the Fibonacci problem.4
Example 1.18 A couple of rabbits starts generating descendants when is at least 2
months old. When this is so, it generates a new couple of baby rabbits per month.
If we start with a couple of just-born baby rabbits at month one, how many couples
will we have after 12 months?
Solution Let Fn denote the total number of couples of rabbits after n months, so
that F1 = 1 and F2 = 1 (the ï¬rst couple of descendants will be born only after 3
months, so will be counted just in F3).
Now, letâ€™s look at the Fk+2 couples of rabbits we will have after k + 2 months.
There are two possibilities for such a couple: either it already existed after k + 1
months, or else it was born at the (k + 2)-th month. The ï¬rst possibility amounts,
by deï¬nition, to a total of Fk+1 couples. As for the second one, note that the couple
of rabbits under consideration descends from one of the couples that already existed
after k months; conversely, each couple that already existed after k months generates
a new couple of descendants that will be born at the (k + 2)-th month, so that this
gives an additional number of Fk couples of rabbits after k + 2 months.
Hence, the total numbers of couples of rabbits after k, k + 1 and k + 2 months
are related by the recursive relation
Fk+2 = Fk+1 + Fk,
for every k â‰¥1. Thus,
F3 = F2 + F1 = 2, F4 = F3 + F2 = 3, . . . , F12 = 144.
âŠ“âŠ”
In the notations of the previous example, we recall that (Fn)nâ‰¥1 is known as the
Fibonacci sequence.
Example 1.19 Using the letters A, B and C, compute how many words of ten letters
(not necessarily with a meaning) one can form, so that there are no consecutive
consonants.
Solution For n â‰¥1, let an be the number of words of n letters A, B, C satisfying
the given condition on consonants. For k â‰¥3, a word of k letters can ï¬nish in A,
B or C. If it ï¬nishes in A, the k âˆ’1 remaining letters form any of the akâˆ’1 word
of k âˆ’1 letters and without consecutive consonants; if it ï¬nishes in B or C, then
4After Leonardo di Pisa, also known as Fibonacci, Italian mathematician of the eleventh century.
Apart from its own contributions to Mathematicsâ€”as the problem we are presently describingâ€”
one of the greatest merits of Fibonacci was to help revive, in Middle Age Europe, the Mathematics
of Classical Antiquity; in particular, Fibonacciâ€™s famous book Liber Abaci introduced, in Western
Civilization, the Hindu-Arabic algarisms and numbering system.

1.3
Recursion
17
the next to last letter must necessarily be an A (since we cannot have consecutive
consonants), and the k âˆ’2 initial letters form any of the akâˆ’2 words of k âˆ’2 letters
having no consecutive consonants.
The reasoning of the previous paragraph gives us the recurrence relation
ak = akâˆ’1 + 2akâˆ’2, âˆ€k â‰¥3.
Since a1 = 3 and a2 = 5 (the possible words of two letters and with no consecutive
consonants are AA, AB, AC, BA and CA), we successively compute a3 = 11,
a4 = 21, a5 = 43, a6 = 85, a7 = 171, a8 = 341, a9 = 683 and a10 = 1365.
âŠ“âŠ”
As the two last examples suggest, there are several combinatorial situations, of
distinctive recursive characters, that give rise to the algebraic problem of computing,
in terms of n âˆˆN, the n-th term of a sequence (an)nâ‰¥1 that satisï¬es a certain
recurrence relation. The coming example, of professor Emanuel Carneiro, generates
a third order linear recurrence relation. In this respect, perhaps the reader might ï¬nd
it helpful to pause for a moment and review the content of Section 3.3 of [8].
Alternatively, he/she can take a quick look at Problem 5, page 79, or at the material
of Chap. 21 (especially Theorem 21.22.)
Example 1.20 For each set A = {x1, x2, . . . , xm} of real numbers, with x1 < x2 <
Â· Â· Â· < xm, let
(A) =

kâ‰¤jâ‰¤m
xj âˆ’

1â‰¤j<k
xj,
where k = m+1
2 . Given an integer n > 1, show that

âˆ…Ì¸=AâŠ‚In
(A) = (n2 + n + 2) Â· 2nâˆ’3.
Solution Let dn = 
âˆ…Ì¸=AâŠ‚In (A). By examining some particular cases we easily
get d1 = 1, d2 = 4 and d3 = 14. In general,
dn+1 =

âˆ…Ì¸=AâŠ‚In+1
(A)
=

AâŠ‚In+1
n+1âˆˆA
(A) +

âˆ…Ì¸=AâŠ‚In
(A)
=

AâŠ‚In+1
n+1âˆˆA
(A) + dn.
(1.7)

18
1
Elementary Counting Techniques
To analyse the last sum above, let Aâ€² = A \ {n + 1} âŠ‚In, for each A âŠ‚In+1
such that n + 1 âˆˆA. Writing Pn and In for the families of subsets of In with even
and odd numbers of elements, respectively, we have

AâŠ‚In+1
n+1âˆˆA
(A) =

Aâ€²âˆˆPn
(Aâ€² âˆª{n + 1}) +

Aâ€²âˆˆIn
(Aâ€² âˆª{n + 1}).
(1.8)
In Problem 5 (see also Problem 7, page 29) we shall prove that |Pn| = |In| =
2nâˆ’1. Assuming this fact for the time being, letâ€™s separately consider the two sums
at the right hand side of (1.8):
(a) If Aâ€² âˆˆPn, it easily follows from the deï¬nition of (Â·) that
(Aâ€² âˆª{n + 1}) = (n + 1) + (Aâ€²),
where (âˆ…) = 0. However, since |Pn| = 2nâˆ’1, we get

Aâ€²âˆˆPn
(Aâ€² âˆª{n + 1}) =

âˆ…Ì¸=Aâ€²âˆˆPn
(Aâ€²) + 2nâˆ’1(n + 1).
(b) If Aâ€² âˆˆIn, say Aâ€² = {x1, x2, . . . , x2k+1}, with x1 < x2 < Â· Â· Â· < x2k+1, then
(Aâ€² âˆª{n + 1}) = ({x1, x2, . . . , x2k+1, n + 1})
= (xk+2 + Â· Â· Â· + x2k+1 + (n + 1))
âˆ’(x1 + x2 + Â· Â· Â· + xk+1)
= (n + 1) + (xk+1 + Â· Â· Â· + x2k+1)
âˆ’(x1 + Â· Â· Â· + xk) âˆ’2xk+1
= (n + 1) + (Aâ€²) âˆ’2xk+1.
Note that xk+1 âˆˆIn is the central element of Aâ€² âˆˆIn. Hence, letting c(Aâ€²)
denote the central element of Aâ€² âˆˆIn, we obtain

Aâ€²âˆˆIn
(Aâ€² âˆª{n + 1}) =

Aâ€²âˆˆIn
((n + 1) + (Aâ€²) âˆ’2c(Aâ€²))
= (n + 1) Â· 2nâˆ’1 +

Aâ€²âˆˆIn
(Aâ€²) âˆ’2

Aâ€²âˆˆIn
c(Aâ€²).
In Problem 5, page 13 (see also Problem 18, page 31), we saw that

Aâ€²âˆˆIn
c(Aâ€²) = (n + 1) Â· 2nâˆ’2.

1.3
Recursion
19
Therefore,

Aâ€²âˆˆIn
(Aâ€² âˆª{n + 1}) =

Aâ€²âˆˆIn
(Aâ€²).
Substituting the results of items (a) and (b) successively in (1.8) and (1.7),
we arrive at
dn+1 = dn +

AâŠ‚In+1
n+1âˆˆA
(A)
= dn + (n + 1) Â· 2nâˆ’1 +

âˆ…Ì¸=Aâ€²âˆˆPn
(Aâ€²) +

Aâ€²âˆˆIn
(Aâ€²)
= dn + (n + 1) Â· 2nâˆ’1 +

âˆ…Ì¸=Aâ€²âŠ‚In
(Aâ€²)
= 2dn + (n + 1) Â· 2nâˆ’1.
Now, since the sequence n â†’dn+1âˆ’2dn
2nâˆ’1
= n+1 is an arithmetic progression,
it follows that
dn+3 âˆ’2dn+2
2n+1
+ dn+1 âˆ’2dn
2nâˆ’1
= 2 Â· dn+2 âˆ’2dn+1
2n+1
.
After clearing out denominators, such an equality gives us the linear recurrence
relation
dn+3 âˆ’6dn+2 + 12dn+1 âˆ’8dn = 0.
Finally, upon solving such a linear recurrence (cf. Problems 6 and 7,
page 393â€”see also Example 3.20 of [8]) we get
dn = (n2 + n + 2) Â· 2nâˆ’3.
âŠ“âŠ”
Problems: Sect. 1.3
1. For each n âˆˆN, let an be the number of distinct ways of writing n as a sum of
summands equal to 1, 3 or 4. Prove that an+4 = an+3 + an+1 + an, for every
n â‰¥1.
2. Show that every convex n-gon has exactly n(nâˆ’3)
2
diagonals.

20
1
Elementary Counting Techniques
Fig. 1.1 The tower of Hanoi
game
3. A 2 Ã— n checkerboard must be tiled with dominoes (each of which is supposed
to have the shape of a 1Ã—2 rectangle). If an denotes the number of such distinct
tilings, do the following items:
(a) Prove that ak+2 = ak+1 + ak, for every integer k â‰¥1.
(b) Compute an as a function of n.
4. Let n > 1 distinct circles be given in the plane, such that any two of them have
a common chord and no three of them pass through a single point. Compute, as
a function of n, the number of regions into which the plane gets divided by the
circles.
5. * We are given n âˆˆN and a set A with n elements.
(a) Let an and bn respectively denote the totals of subsets of A with even and
odd numbers of elements. Use a recursive argument to show that an =
anâˆ’1 + bnâˆ’1 = bn.
(b) Conclude that A has exactly 2nâˆ’1 subsets with an even number of elements
and 2nâˆ’1 subsets with an odd number of elements.
The coming problem is a particular case of Kaplanskyâ€™s ï¬rst lemma, which
will be dealt with, in general form, in Example 1.28.
6. Three nonconsecutive chairs are to be chosen out of a row of ten chairs. How
many are the ways of doing this?
7. The Tower of Hanoi game consists of three parallel equal rods, vertically
attached to the surface of a table, together with a pile of n disks of pairwise
unequal sizes, all having a hole in the center through which they can slide along
the rods. Figure 1.1 shows the initial conï¬guration of the game for n = 5, with
all of the disks piled at the leftmost rod, from the smallest disk at the top to the
largest at the bottom of the pile. The purpose of the game is to move all disks
to the rightmost rod, possibly with the help of the central rod and subjected to
the following rule: at no moment a disk can be placed above a smaller one, in
any rod. For general n, let an denote the last number of movements needed to
ï¬nish the game. Show that:
(a) ak+1 = 2ak + 1, for every k âˆˆN.
(b) an = 2n âˆ’1, for every n âˆˆN.
8. * Given k, n âˆˆN, the Stirling number of second kind5 S(n, k) is deï¬ned
as the number of ways of partitioning a set of n elements into k nonempty,
pairwise disjoint subsets. For example, S(3, 2) = 3, since
5After James Stirling, Scottish mathematician of the eighteenth century. With respect to Stirling
numbers of second kind, see also Problem 4, page 57.

1.3
Recursion
21
{1, 2} âˆª{3}, {1, 3} âˆª{2} and {2, 3} âˆª{1}
are the only ways of partitioning {1, 2, 3} into two nonempty disjoint subsets.
(a) Verify that S(n, 1) = S(n, n) = 1 and S(n, k) = 0 if n < k.
(b) Prove that, for 1 â‰¤k < n, one has the recurrence relation
S(n + 1, k + 1) = S(n, k) + (k + 1)S(n, k + 1).
(c) Use items (a) and (b) to compute the number of ways of distributing 7
distinct coins into three equal 3 boxes, such that no box stays empty.
The coming problem will be posed two other times along these notes: one in
Problem 8 and the other in Problem 8, page 92.
9. Compute, in terms of n âˆˆN, the number of sequences of n terms, all of which
equal to 0, 1, 2 or 3 and having an even number of 0â€™s.
10. A ï¬‚ag with n strips consists of n consecutive horizontal strips, each of which is
colored red, white or blue and such that any two adjacent strips have different
colors.
(a) Calculate how many are the distinct ï¬‚ags with n strips.
(b) If an denotes the total number of ï¬‚ags with n strips and such that the ï¬rst
and last strips have different colors, show that an+1 + an = 3 Â· 2n for every
n â‰¥1.
(c) Compute an as a function of n, for every n â‰¥1.
11. (Bulgaria) A ï¬nite nonempty set A of positive integers is said to be selï¬sh if
|A| âˆˆA. A selï¬sh set A is minimal if A does not contain a selï¬sh set different
from itself. Do the following items:
(a) Prove that the number of minimal selï¬sh subsets of In that do not contain
n coincides with the number of minimal selï¬sh subsets of Inâˆ’1.
(b) Given m âˆˆZ and X âŠ‚Z, let X+m denote the set X+m = {x+m; x âˆˆX}.
Show that, for every integer n > 2, the correspondences
A â†’(A \ {n}) âˆ’1 and B â†’(B + 1) âˆª{n}
are inverse bijections between the family of minimal selï¬sh subsets of In
that do not contain n and that of minimal selï¬sh subsets of Inâˆ’2.
(c) Show that In has exactly Fn minimal selï¬sh subsets of In, where Fn denotes
the n-th Fibonacci number.
For the next two problems, given a nonempty ï¬nite set A of real numbers, we
let Ïƒ(A) and Ï€(A) respectively denote the sum and the product of the elements
of A, with the convention that Ïƒ(A) = Ï€(A) = a if A = {a}.

22
1
Elementary Counting Techniques
12. Given a nonempty ï¬nite set X âŠ‚N, let aX denote the sum
aX =

âˆ…Ì¸=AâŠ‚X
1
Ï€(A).
Do the following items:
(a) If m âˆˆN \ X and Y = X âˆª{m}, show that aY =

m+1
m

aX + 1
m.
(b) Given n âˆˆN, write an to denote aIn. Show that
an+1 =
n + 2
n + 1

an +
1
n + 1.
(c) Show that an = n for every n âˆˆN.
13. (USAâ€”adapted) For a nonempty ï¬nite set X âŠ‚N, let bX denote the sum
bX =

âˆ…Ì¸=AâŠ‚X
Ïƒ(A)
Ï€(A).
(a) If m âˆˆN \ X and Y = X âˆª{m}, show that
bY = bX +

âˆ…Ì¸=AâŠ‚X
m + Ïƒ(A)
mÏ€(A)
+ 1 =
m + 1
m

bX + aX + 1,
where aX is the sum deï¬ned in the previous problem.
(b) Given n âˆˆN, write bn instead of bIn. Show that
bn+1 =
n + 2
n + 1

bn + (n + 1).
(c) Deduce that, for n âˆˆN, one has
bn = (n + 1)2 âˆ’(n + 1)

1 + 1
2 + Â· Â· Â· + 1
n

âˆ’1.
14. (Franceâ€”adapted) We say that a set X of natural numbers is good provided
it satisï¬es the following property: for every natural number x, if x âˆˆX then
2x /âˆˆX. For each natural k, let Ak = {1, 2, 3, . . . , 2k} and bk be the greatest
number of elements which a good subset of Ak can have.
(a) Show that bk = bkâˆ’2 + 2kâˆ’1 for every k â‰¥2.
(b) For each natural n, compute bn as a function of n.

1.4
Arrangements, Combinations and Permutations
23
1.4
Arrangements, Combinations and Permutations
As an application of the ideas of the previous section, we use recursive arguments
to solve three speciï¬c, though very important, counting problems, namely, those of
counting the number of arrangements without repetitions, of permutations and of
combinations. For what follows, we recall that In = {1, 2, . . . , n} for every n âˆˆN.
We start by counting, in the coming result, the number of injective functions
between two nonempty ï¬nite sets.
Proposition 1.21 Let n, k âˆˆN. If A is a set with n elements, then there are exactly
n(n âˆ’1) . . . (n âˆ’k + 1) injective functions f : Ik â†’A.
Proof Let B be a set with m elements and let akm denote the number of injective
functions f : Ik â†’B.
Evidently, a1n = n (since there are exactly n possible choices for f (1) âˆˆA) and,
in this case, the formula in the statement of the proposition is true.
From now on, assume that k > 1. For a ï¬xed x âˆˆA, if f : Ik â†’A is an injective
function such that f (k) = x, then the restriction of f to Ikâˆ’1 is an injective function
Ëœf : Ikâˆ’1 â†’A \ {x}. Conversely, given an injective function Ëœf : Ikâˆ’1 â†’A \ {x},
we extend Ëœf to an injective function f : Ik â†’A by letting f (k) = x.
Since such operations of restriction and extension of injective functions are
clearly inverses of each other, we conclude that there are as many injective functions
f : Ik â†’A with f (k) = x as there are injective functions Ëœf : Ikâˆ’1 â†’A \ {x}.
Thus, the number of such functions is exactly akâˆ’1,nâˆ’1. However, since there are n
possible choices for x âˆˆA (for, |A| = n), we get the recurrence relation
akn = nakâˆ’1,nâˆ’1,
(1.9)
which is valid for every natural n > 1.
Now, observe that ak1 = 0 for every k > 1 (for, if |A| = 1, there is no way of
choosing distinct f (1) and f (2) in A). By induction, assume that akn = 0 whenever
k > n and 1 â‰¤n < m, where m > 1 is a natural number. Given k, m âˆˆN such that
k > m, we have k âˆ’1 > m âˆ’1, so that, by induction hypothesis, akâˆ’1,mâˆ’1 = 0.
But then, (1.9) gives akm = makâˆ’1,mâˆ’1 = 0. Therefore, it follows by induction that
akn = 0 for every k, n âˆˆN such that k > n. Yet in this case we have nâˆ’k+1 â‰¤0, so
that n(nâˆ’1) . . . (nâˆ’k +1) = 0 and the formula of the statement of the proposition
is valid.
Suppose, from now on, that k â‰¤n. Then, again from (1.9), we have
akn = nakâˆ’1,nâˆ’1 = n(n âˆ’1)akâˆ’2,nâˆ’2
= Â· Â· Â·
= n(n âˆ’1) . . . (n âˆ’k + 2)a1,nâˆ’k+1
= n(n âˆ’1) . . . (n âˆ’k + 2)(n âˆ’k + 1).
âŠ“âŠ”

24
1
Elementary Counting Techniques
Since an injective function f : Ik â†’A is simply a sequence of k pairwise
distinct terms, all chosen from the elements of A, we can rephrase the above
proposition according to the following
Corollary 1.22 If |A| = n, then there are exactly n(nâˆ’1) . . . (nâˆ’k+1) sequences
formed by k pairwise distinct elements of A.
We can apply this corollary to a given combinatorial situation whenever it asks us
to count how many are the ordered choices of k pairwise distinct elements of a given
set A. For this reason, from now on we shall say that the previous corollary counts
the number of arrangements without repetition of k pairwise distinct elements,
chosen from a given set of n elements.
Example 1.23 How many are the natural numbers of three pairwise distinct
algarisms?
Solution To choose a natural number with three pairwise distinct algarisms is the
same as to choose a sequence (a, b, c) such that a, b, c âˆˆ{0, 1, 2, . . . , 9} are
pairwise distinct and a Ì¸= 0. Corollary 1.4 assures that, in order to count the number
of possible such sequences, it sufï¬ces to count the number of sequences (a, b, c),
with pairwise distinct a, b, c âˆˆ{0, 1, 2, . . . , 9}, and then to discount the number of
such sequences of the form (0, b, c).
By the previous corollary, the number of sequences (a, b, c) with a, b, c âˆˆ
{0, 1, 2, . . . , 9} pairwise distinct but without the restriction a Ì¸= 0 is 10 Ã— 9 Ã— 8 =
720. On the other hand, the number of such sequences of the form (0, b, c) is
9 Ã— 8 = 72. Hence, the desired result is 720 âˆ’72 = 648.
âŠ“âŠ”
The counting of arrangements without repetition has a very important conse-
quence, based on the following
Deï¬nition 1.24 A permutation of the elements of a nonempty set A is a bijection
f : A â†’A.
If A is ï¬nite and nonempty, it is not difï¬cult to prove (see Problem 4, page 7)
that a function f : A â†’A is bijective if and only if it is injective. Hence, letting
k = n in the formula of Proposition 1.21, we immediately get our next result.
Corollary 1.25 If |A| = n, then there are exactly n! permutations of the elements
of A.
Given a ï¬nite set A with n elements and a natural number k such that 0 â‰¤k â‰¤n,
the coming result uses a recursive argument to compute the number of subsets of A
with k elements each. In order to properly state it, recall (cf. Section 4.2 of [8]) that,
for nonnegative integers n and k with 0 â‰¤k â‰¤n, one deï¬nes the binomial number
n
k

by letting
n
k

=
n!
k!(n âˆ’k)!.

1.4
Arrangements, Combinations and Permutations
25
Moreover, for 1 â‰¤k â‰¤n such numbers satisfy the recurrence relation
n
k

=
n âˆ’1
k

+
n âˆ’1
k âˆ’1

,
which is known as Stifelâ€™s relation and allows us to prove that
n
k

âˆˆN for every n
and k as above.
Proposition 1.26 If A is a ï¬nite set with n elements and 0 â‰¤k â‰¤n, then A
possesses exactly
n
k

subsets of k elements.
Proof If k = 0 there is nothing to do, for âˆ…is the only subset of A having 0 elements
and
n
0

= 1. Thus, let 1 â‰¤k â‰¤n and Cn
k be the number of subsets of A with k
elements.
For a ï¬xed x âˆˆA, there are two kinds of subsets of A with k elements: those
which do not contain x and those which do contain x. The former ones are precisely
the k-element subsets of A \ {x}; since |A \ {x}| = n âˆ’1, there are exactly Cnâˆ’1
k
of
these subsets of k elements of A.
On the other hand, if B âŠ‚A has k elements and x âˆˆB, then B \ {x} âŠ‚A \ {x}
has kâˆ’1 elements; conversely, if Bâ€² âŠ‚A\{x} has kâˆ’1 elements, then Bâ€²âˆª{x} âŠ‚A
has k elements, one of which is x. Since such correspondences are clearly inverses
of each other, we conclude that there are as many k-element subsets of A containing
x, as there are k âˆ’1 element subsets of A \ {x}; thus, there are exactly Cnâˆ’1
kâˆ’1 such
k-element subsets of A.
Taking these two contributions into account, we obtain for 1 â‰¤k â‰¤n the
recurrence relation
Cn
k = Cnâˆ’1
k
+ Cnâˆ’1
kâˆ’1,
which is identical to Stifelâ€™s relation for the binomial numbers
n
k

. Finally, since
Cn
0 = 1 =
n
0

and Cn
1 = n =
n
1

(for A has exactly n subsets of 1 element eachâ€”
the sets {x}, with x âˆˆA), an easy induction gives Cn
k =
n
k

for 0 â‰¤k â‰¤n.
âŠ“âŠ”
In words, the previous proposition computes how many are the unordered choices
of k distinct elements of a set having n elements; one uses to say that such choices
are the combinations of n objects, taking k at a time. Also thanks to the former
proposition, one uses to refer to the binomial number
n
k

as â€œn chooses kâ€.
Example 1.27 When all diagonals of a certain convex octagon have been drawn,
one noticed that there were no three of them passing through a single interior point
of the octagon. How many points in the interior of the octagon are intersection points
of two of its diagonals?
Solution Firstly, note that the condition on the diagonals of the octagon guarantees
that each one of the points of intersection we wish to count is determined by a
single pair of diagonals. Hence, it sufï¬ces to count how many pairs of diagonals of
the octagon intersect in its interior. To this end, note that each 4-element subset of

26
1
Elementary Counting Techniques
the set of vertices of the octagon determines exactly two diagonals which intersect
in the interior of it; conversely, if two diagonals of the octagon do intersect in its
interior, then the set of their endpoints is a 4-element subset of the set of vertices of
the octagon. Therefore, the bijective principle assures that there are as many pairs of
diagonals intersecting in the interior of the octagon as there are 4-element subsets
of its set of vertices. By Proposition 1.26, then, the number of points of intersection
we wish to count equals
8
4

= 70.
âŠ“âŠ”
Our next example brings a beautiful application of combinations, due to the
American mathematician of the twentieth century Irving Kaplansky and known as
Kaplanskyâ€™s ï¬rst lemma.6
Example 1.28 (Kaplansky) Given n, k âˆˆN, with n â‰¥2k âˆ’1, show that the number
k-element subsets of In without consecutive elements equals
nâˆ’k+1
k

.
Proof We ï¬rst note that if A âŠ‚In has k elements, no two of which being
consecutive, then n â‰¥2k âˆ’1, for between any two elements of A there is at least
one element of In not belonging to A. Hence, the assumption n â‰¥2k âˆ’1 made
in the statement is natural and gives n âˆ’k + 1 â‰¥k, so that the binomial number
nâˆ’k+1
k

is well deï¬ned.
Now, recall that the characteristic function of A in In is a sequence of n terms,
with exactly k of them being equal to 1 and the other n âˆ’k being equal to 0;
moreover, our assumption on A assures that any two 1â€™s in such a sequence are
nonconsecutive. Since the characteristic function determines A, it sufï¬ces to count
the number of such sequences.
To what is left to do, letâ€™s ï¬rst consider a sequence of 2(n âˆ’k) + 1 terms, in
which the n âˆ’k terms with even indices are equal to 0:
( , 0, , 0, , . . . , , 0,



2(nâˆ’k)+1
).
If we are to have exactly k terms equal to 1, no two of which being consecutive, it is
necessary and sufï¬cient to choose, from the set of nâˆ’k +1 positions corresponding
to odd indices, the k positions in which we want to put the 1â€™s (as we previously
pointed out, this is possible because n âˆ’k + 1 â‰¥k). According to Proposition 1.26,
there are precisely
nâˆ’k+1
k

possible choices for such positions. Finally, once we
erase the not chosen positions, we are left with the characteristic sequence of a set
satisfying the conditions of the problem. Conversely, it is immediate that every such
characteristic sequence can be obtained as above, so that the answer to our problem
is
nâˆ’k+1
k

.
âŠ“âŠ”
Now, we are given natural numbers k and n and nonnegative integers n1, . . . , nk
satisfying n = n1+Â· Â· Â·+nk. We also have k distinct types of objects, say a1, . . . , ak,
6There is also a Kaplanskyâ€™s second lemma, which will be the object of Problem 12. Kaplansky
devised these two results in order to solve Lucasâ€™ problemâ€”cf. Problem 10, page 41.

1.4
Arrangements, Combinations and Permutations
27
and would like to count how many sequences of n terms have exactly n1 terms equal
to a1, . . . , nk terms equal to ak. Yet in another way, we say that such a sequence is
a permutation with repeated elements of n objects, each of which being of one of
the types a1, . . . , ak and with n1 objects of type a1, . . . , nk objects of type ak. Letâ€™s
now look at an equivalent problem.
If f : In â†’{a1, . . . , ak} is a sequence satisfying the conditions of the previous
paragraph (i.e., with n1 terms equal to a1, . . . , nk terms equal to ak), then, taking
inverse images, we obtain
In = f âˆ’1(a1) âˆª. . . âˆªf âˆ’1(ak).
At the right hand side above, the sets f âˆ’1(aj), 1 â‰¤j â‰¤k, are pairwise disjoint and
such that |f âˆ’1(aj)| = nj for 1 â‰¤j â‰¤k; we say that the union at the right hand side
is the partition of In induced by f . Conversely, associated to a partition of In of
the form In = A1 âˆª. . . âˆªAk, with |Aj| = nj for 1 â‰¤j â‰¤k, we have the sequence
f : In â†’{a1, . . . , ak} such that f (Aj) = {aj} for 1 â‰¤j â‰¤k. Therefore, the
bijective principle guarantees that a problem equivalent to the one of the previous
paragraph is that of counting the number of distinct partitions of a set of n elements
into k pairwise disjoint subsets A1, . . . , Ak, under the restriction that |A1| = n1, . . . ,
|Ak| = nk.
This being said, the coming result solves both counting problems described
above.
Proposition 1.29 Let n, k âˆˆN and n = n1 +Â· Â· Â·+nk be a partition of n in positive
integers. If A is a set with n elements and

n
n1,...,nk

denotes the number of partitions
of A into sets A1, . . . , Ak, with |Aj| = nj for 1 â‰¤j â‰¤k, then

n
n1, . . . , nk

=
n!
n1! . . . nk!.
(1.10)
Proof We shall make induction on k âˆˆN. Firstly, the case k = 1 is trivial, for in
this case n1 = n and the only subset of A with n elements is A itself. As induction
hypothesis, let l â‰¥2 be a natural number and assume that (1.10) is true for 1 â‰¤k < l
and every partition of n into k positive integers n1, . . . , nk. Then, ï¬x a partition
n = n1 + Â· Â· Â· + nl of n in positive integers.
The bijective principle assures that, for each subset Al of A, with |Al| = nl,
there are as many partitions of A as in the statement of the proposition as there are
partitions
A \ Al = A1 âˆª. . . âˆªAlâˆ’1,
of A \ Al into l âˆ’1 subsets A1, . . . , Alâˆ’1, with |Aj| = nj for 1 â‰¤j â‰¤l âˆ’1.
Since |A \ Al| = n âˆ’nl, the total number of such partitions of A \ Al is,
by deï¬nition, equal to

nâˆ’nl
n1,...,nlâˆ’1

; however, since there are exactly
 n
nl

ways of

28
1
Elementary Counting Techniques
choosing the subset Al of A, the fundamental principle of counting gives the
recurrence relation

n
n1, . . . , nl

=

n âˆ’nl
n1, . . . , nlâˆ’1
n
nl

.
Finally, by applying the induction hypothesis to

nâˆ’nl
n1,...,nlâˆ’1

, we conclude that

n
n1, . . . , nl

=
(n âˆ’nl)!
n1! . . . nlâˆ’1! Â·
n
nl

=
n!
n1! . . . nlâˆ’1!nl!.
âŠ“âŠ”
Remark 1.30 In the notations of the proposition above, it is worth noting that

n
k, n âˆ’k

=
n
k

,
where the right hand side denotes the usual binomial number. Such and equality
reï¬‚ects the fact that choosing a k-element subset out of a set with n elements is the
same as partitioning such a set into two subsets, one with k elements and the other
with n âˆ’k elements.
Problems: Sect. 1.4
1. If n âˆˆN and A is a set with n elements, prove that there are exactly nk âˆ’n(n âˆ’
1) . . . (n âˆ’k + 1) sequences of k terms, all taken out of A but not pairwise
distinct.
2. * Do the following items:
(a) Use a combinatorial argument to prove the formula for binomial expansion:
(x + y)n =
n

k=0
n
k

xnâˆ’kyk.
(1.11)
(b) Generalize item (a), proving combinatorially the multinomial expansion
formula:
(x1 + Â· Â· Â· + xk)n =

n1,...,nkâˆˆZ+
n1+Â·Â·Â·+nk=n

n
n1, . . . , nk

xn1
1 . . . xnk
k ,
(1.12)
where, for n1, . . . , nk âˆˆZ+ such that n = n1 + Â· Â· Â· + nk, the number

n
n1,...,nk

is deï¬ned as in (1.10).

1.4
Arrangements, Combinations and Permutations
29
3. Given n, k âˆˆN, use the result of Proposition 1.29, together with item (b) of the
previous problem, to compute the number of ordered partitions of a set A, with
|A| = n, into k subsets A1, . . . , Ak (cf. Problem 8, page 7).
4. Prove that the Stirling number of second kind S(n, k) (cf. Problem 8, page 20)
can be computed with the aid of the following formula:
S(n, k) = 1
k!

n1,...,nkâˆˆN
n1+Â·Â·Â·+nk=n

n
n1, . . . , nk

.
5. (IMOâ€”shortlist) Given a permutation (a1, a2, . . . , an) of In, we say that aj is
a local maximum if aj is greater than its neighbors (for j = 1, this means that
a1 > a2; for j = n, that an > anâˆ’1). Compute the number of permutations of
In having exactly one local maximum.
6. (OCM) We are given n â‰¥6 points on a circle , and draw all
n
2

chords joining
two of them. We further assume that no three of such chords pass through a
single point of the corresponding open disk D bounded by . Compute the
number of distinct triangles satisfying the two following properties:
i. their vertices belong to D.
ii. their sides lie on three of the
n
2

drawn chords.
7. * Use combinations to show that a set with n elements has exactly 2nâˆ’1 subsets
with an even number of elements and 2nâˆ’1 subsets with an odd number of
elements.
8. Compute, in terms of n âˆˆN, the number of sequences of n terms, all of which
equal to 0, 1, 2 or 3 and having an even number of 0â€™s.
9. * Given n, k âˆˆN, show that the equation x1 +Â· Â· Â·+xk = n has exactly
n+kâˆ’1
kâˆ’1

nonnegative integer solutions.
10. * Given n, k âˆˆN, show that the equation x1 + Â· Â· Â· + xk = n has exactly
nâˆ’1
kâˆ’1

positive integer solutions.
11. The purpose of this problem is to give another proof of Kaplanskyâ€™s ï¬rst lemma
(cf. Example 1.28). To this end, do the following items:
(a) If A = {a1, . . . , ak} âŠ‚In is a set without consecutive elements, let x1 =
a1 âˆ’1, xk+1 = n âˆ’ak and xj = aj âˆ’ajâˆ’1 âˆ’2 for 2 â‰¤j â‰¤k. Show that
x1, . . . , xk+1 solves, in nonnegative integers, equation x1 + Â· Â· Â· + xk+1 =
n âˆ’2k + 1.
(b) If x1, . . . , xk+1 is a solution of equation x1 + Â· Â· Â· + xk+1 = n âˆ’2k + 1 in
nonnegative integers, show how to use it to get a set A = {a1, . . . , ak} âŠ‚In
without consecutive elements.
(c) Obtain Kaplanskyâ€™s ï¬rst lemma from the results of items (a) and (b) and
from Problem 9.
12. * Prove Kaplanskyâ€™s second lemma: given n, k âˆˆN, with n â‰¥2k, the number
of k-element subsets of In without consecutive elements, and considering 1 and
n to be consecutive, is equal to

30
1
Elementary Counting Techniques
n
n âˆ’k
n âˆ’k
k

.
For the coming problem, we deï¬ne a multiset as an ordered pair (A, f ),
where A is a set and f is a function from A into N. If x âˆˆA, we say that x is
an element of multiset (A, f ); in such a case, f (x) âˆˆN is the frequency of x as
an element of (A, f ). A multiset (A, f ) is ï¬nite if A is a ï¬nite set. In this case,
the number of elements of the multiset is deï¬ned as the sum of the frequencies
of the elements of A, seen as elements of (A, f ); in symbols,
|(A, f )| =

xâˆˆA
f (x).
(1.13)
Informally, we denote a multiset (A, f ) simply by Af (or even A, whenever
f is understood and there is no danger of confusion with the set A itself); we
declare Af between double curly braces, instead of simple ones (which are
reserved for declaring sets), with each x âˆˆA being repeated exactly f (x) times;
for instance, if A = {a, b, c} and f : A â†’N is given by f (a) = 2, f (b) = 3
and f (c) = 1, we declare the multiset Af by writing
Af = {{a, a, b, b, b, c}}.
13. Let n, k âˆˆN be given, with n â‰¥k, and let A be a set with k elements. Compute
the number of multisets (A, f ) of n elements.
14. For each integer n > 1, prove that there are exactly
2n
n

subsets of I2n with
equal quantities of even and odd elements.
15. We are given natural numbers m and n, with m > n. If
F = {(A1, . . . , An); A1, . . . , An âŠ‚Im},
compute, in terms of m and n, the value of the sum

(A1,...,An)âˆˆF
|A1 âˆª. . . âˆªAn|.
16. To each permutation Ïƒ = (a1, a2, . . . , an) of In, let
SÏƒ = (a1 âˆ’a2)2 + (a2 âˆ’a3)2 + Â· Â· Â· + (anâˆ’1 âˆ’an)2.
Show that
1
n!

Ïƒ
SÏƒ =
n + 1
3

,
where, in the left hand side above, Ïƒ varies over all n! permutations of In.

1.4
Arrangements, Combinations and Permutations
31
17. (Saint Petersburgâ€”adapted) We are give 2n + 1 points on a circle, such that
no two of them are the endpoints of a diameter. Prove that, among all triangles
having three of the given points as their vertices, at most
1
6n(n + 1)(2n + 1)
of them are acute.7
18. * The purpose of this problem is to use the material of this section to present
another solution to Problem 5, page 13. To this end, do the following items:
(a) Fixed 1 â‰¤i â‰¤n, show that i is the central element of exactly

j
i âˆ’1
j
n âˆ’i
j

=
n âˆ’1
i âˆ’1

sets A âˆˆIn, where the above sum extends to all indices j satisfying 0 â‰¤
j â‰¤min{i âˆ’1, n âˆ’i}.
(b) Conclude that

AâˆˆIn
c(A) =
n

i=1
n âˆ’1
i âˆ’1

i = (n + 1) Â· 2nâˆ’2.
19. (IMO shortlistâ€”adapted) Let8 n âˆˆN and f : In â†’In be such that f (f (x)) =
x for every x âˆˆIn.
(a) Show that f is a bijection and that, if f has exactly k ï¬xed points, then
n âˆ’k must be even.
(b) Conversely, given 0 â‰¤k â‰¤n such that n âˆ’k is even, show that
for each choice of elements x1, . . . , xk
âˆˆIn and for each partition
{{a1, b1}, . . . , {al, bl}} of the remaining n âˆ’k elements of In in subsets
of two elements each, there exists a single f : In â†’In having x1, . . . , xk
as its ï¬xed points and satisfying f (ai) = bi for 1 â‰¤i â‰¤l and f (f (x)) = x
for each x âˆˆIn.
(c) Conclude that the number of functions f : In â†’In such that f (f (x)) = x
for each x âˆˆIn is given by

0â‰¤kâ‰¤n
nâˆ’k even
n
k

Â·
 n âˆ’k
2, . . . , 2
  
(nâˆ’k)/2

=

0â‰¤kâ‰¤n
nâˆ’k even
n!
k! Â· 2
nâˆ’k
2
.
7For another proof to this problem, see Example 4.18.
8For a generalization of this problem, see Problem 8, page 58.

32
1
Elementary Counting Techniques
20. * (BMOâ€”adapted)9 Let n > 2 be an integer and F be a family of 3-element
subsets of In, such that, if A, B âˆˆF and A Ì¸= B, then |A âˆ©B| â‰¤1. Prove that
|F| â‰¤1
6(n2 âˆ’n).
21. (Romania) Let k, m âˆˆN be given, with m â‰¥k, and let A be a set of m elements.
Choose pairwise distinct subsets A1, A2, . . . , An of A, such that |Ai| â‰¥k for
1 â‰¤i â‰¤n and |Ai âˆ©Aj| â‰¤k âˆ’1 for 1 â‰¤i < j â‰¤n. Prove that n â‰¤
m
k

.
22. Let A = {a1, a2, . . . , an}, and let P1, P2, . . . , Pn be pairwise distinct 2-element
subsets of A, such that
Pi âˆ©Pj Ì¸= âˆ…â‡”âˆƒ1 â‰¤k â‰¤n; Pk = {ai, aj}.
Prove that each element of A belongs to exactly two of the sets P1, P2, . . . , Pn.
9For the other half of the original problem, see Example 2.29.

Chapter 2
More Counting Techniques
In this chapter we study a few more elaborate counting techniques. We start by
discussing the inclusion-exclusion principle, which, roughly speaking, is a formula
for counting the number of elements of a ï¬nite union of ï¬nite sets. The presentation
continues with the notion of double counting for, counting a certain number of
conï¬gurations in two distinct ways, to infer some hidden result. Then, a brief
discussion of equivalence relations and their role in counting problems follows.
Among other interesting results, we illustrate it by proving a famous theorem of
B. BollobÃ¡s, on extremal set theory. The chapter ends with a glimpse on the use of
the language of metric spaces in certain speciï¬c counting problems.
2.1
The Inclusion-Exclusion Principle
In this section we extend the formula of Proposition 1.5 for the number of elements
of the union of two ï¬nite sets. The following result is known as the inclusion-
exclusion principle, and is usually attributed to the French mathematician of the
eighteenth century Abraham de Moivre.
Theorem 2.1 (de Moivre) If A1, A2, . . . , An are ï¬nite sets, then
|A1 âˆªA2 âˆª. . . âˆªAn| =
n

k=1
(âˆ’1)kâˆ’1

i1<Â·Â·Â·<ik
|Ai1 âˆ©. . . âˆ©Aik|,
(2.1)
with the last sum above extending over all sequences (i1, i2, . . . , ik) of integers such
that 1 â‰¤i1 < i2 < Â· Â· Â· < ik â‰¤n.
Proof Fix an x âˆˆA1 âˆªA2 âˆª. . . âˆªAn and suppose that x belongs to exactly l of
the sets A1, A2, . . . , An. We shall show that the expression at the right hand side
of (2.1) counts x exactly once.
Â© Springer International Publishing AG, part of Springer Nature 2018
A. Caminha Muniz Neto, An Excursion through Elementary Mathematics, Volume III,
Problem Books in Mathematics, https://doi.org/10.1007/978-3-319-77977-5_2
33

34
2
More Counting Techniques
Note that, for a ï¬xed 1 â‰¤k â‰¤n, x is counted in the sum

i1<Â·Â·Â·<ik
|Ai1 âˆ©. . . âˆ©Aik|
as many times as the number of sequences (i1, . . . , ik) such that 1 â‰¤i1 < Â· Â· Â· <
ik â‰¤n and x âˆˆAi1 âˆ©. . . âˆ©Aik.
Since x belongs to exactly l of the given sets, we can restrict ourselves to the case
in which k â‰¤l; indeed, if k > l, then x will not belong to at least one of the sets
Ai1, . . . , Aik, so that x /âˆˆAi1 âˆ©. . . âˆ©Aik.
For k â‰¤l, the number of sequences (i1, . . . , ik) as above equals the number of
ways of choosing k of the l sets containing x. Therefore, there are exactly
l
k

such
sequences, and we conclude that x is counted at the right hand side of (2.1) exactly
l
k=1
(âˆ’1)kâˆ’1
l
k

times. However, with the aid of the binomial expansion we get
l
k=1
(âˆ’1)kâˆ’1
l
k

=
l
0

âˆ’
l
k=0
(âˆ’1)k
l
k

= 1 âˆ’(1 âˆ’1)l = 1,
as wished.
âŠ“âŠ”
Example 2.2 Let n â‰¥3 be a natural number. Show that there does not exist sets A1,
A2, . . . , An, with n elements each and satisfying the following conditions:
(a) Any two of the Aiâ€™s have exactly two elements in common.
(b) Any three of the Aiâ€™s have no elements in common.
Solution By the sake of contradiction, assume that there does exist sets A1, A2, . . . ,
An satisfying the stated conditions. If we show that |A1 âˆªA2 âˆª. . . âˆªAn| = n, we
would have Ai âŠ‚A1 âˆªA2 âˆª. . .âˆªAn and |Ai| = |A1 âˆªA2 âˆª. . .âˆªAn| for 1 â‰¤i â‰¤n,
so that Ai = A1 âˆªA2 âˆª. . . âˆªAn for 1 â‰¤i â‰¤n. In particular, this would give
A1 = A2 = Â· Â· Â· = An, and item (b) will give us a contradiction.
To what is left, letâ€™s compute the number of elements of A1 âˆªA2 âˆª. . . âˆªAn with
the aid of the inclusion-exclusion principle:
|A1 âˆª. . . âˆªAn| =
n

k=1
(âˆ’1)kâˆ’1

i1<Â·Â·Â·<ik
|Ai1 âˆ©. . . âˆ©Aik|
=

i1
|Ai1| âˆ’

i1<i2
|Ai1 âˆ©Ai2|,

2.1
The Inclusion-Exclusion Principle
35
where, in the last equality above, we used the fact that Ai1 âˆ©Ai2 âˆ©Ai3 = âˆ…for
1 â‰¤i1 < i2 < i3 â‰¤n. Now, note that

i1
|Ai1| =
n

i=1
|Ai| =
n

i=1
n = n2
and

i1<i2
|Ai1 âˆ©Ai2| =

i1<i2
2 = 2
n
2

= n(n âˆ’1),
for, there are exactly
n
2

= n(nâˆ’1)
2
possible choices of indices i1 and i2 satisfying
1 â‰¤i1 < i2 â‰¤n. Hence, A1 âˆªA2 âˆª. . . âˆªAn has exactly n2 âˆ’n(n âˆ’1) = n
elements.
âŠ“âŠ”
Another proof of the inclusion-exclusion principle can be given by using
characteristic functions of sets (cf. Deï¬nition 1.12). To this end, we shall need two
preliminary results on such functions.
Lemma 2.3 Let A be a nonempty set. If B and C are subsets of A, then:
(a) Ï‡B = Ï‡C â‡”B = C.
(b) Ï‡Bâˆ©C = Ï‡BÏ‡C.
(c) Ï‡Bc = 1 âˆ’Ï‡B.
(d) Ï‡BâˆªC = Ï‡B + Ï‡C âˆ’Ï‡BÏ‡C.
Proof Exercise (see Problem 1).
âŠ“âŠ”
Proposition 2.4 Let A be a ï¬nite set and A1, A2, . . . , An be subsets of A. If Ï‡, Ï‡j :
A â†’{0, 1} respectively denote the characteristic functions of A1 âˆª. . . âˆªAn and
Aj in A, then
Ï‡(x) = 1 âˆ’
n

j=1
(1 âˆ’Ï‡j(x))
(2.2)
for every x âˆˆA.
Proof For x âˆˆA, we have
Ï‡(x) = 1 â‡”x âˆˆA1 âˆª. . . âˆªAn
â‡”âˆƒ1 â‰¤j â‰¤n; x âˆˆAj
â‡”âˆƒ1 â‰¤j â‰¤n; Ï‡j(x) = 1
â‡”
n

j=1
(1 âˆ’Ï‡j(x)) = 0
â‡”1 âˆ’
n

j=1
(1 âˆ’Ï‡j(x)) = 1.
Therefore, both sides of (2.2) coincide at every x âˆˆA, as wished.
âŠ“âŠ”

36
2
More Counting Techniques
Now, observe that if B âŠ‚A is ï¬nite, then
|B| =

xâˆˆA
Ï‡B(x).
(2.3)
On the other hand, in the notations of the former proposition, we have
Ï‡(x) = 1 âˆ’
n

j=1
(1 âˆ’Ï‡j(x))
= 1 âˆ’
â›
â1 +

1â‰¤kâ‰¤n

i1<Â·Â·Â·<ik
(âˆ’1)kÏ‡i1(x) . . . Ï‡ik(x)
â
â 
=

1â‰¤kâ‰¤n

i1<Â·Â·Â·<ik
(âˆ’1)kâˆ’1Ï‡i1...ik(x),
where Ï‡i1...ik denotes the characteristic function of Ai1 âˆ©. . . âˆ©Aik and we used item
(b) of Lemma 2.3 in the last equality. Hence, the above and (2.3) give
|A1 âˆª. . . âˆªAn| =

xâˆˆA
Ï‡(x)
=

xâˆˆA

1â‰¤kâ‰¤n

i1<Â·Â·Â·<ik
(âˆ’1)kâˆ’1Ï‡i1...ik(x)
=

1â‰¤kâ‰¤n

i1<Â·Â·Â·<ik
(âˆ’1)kâˆ’1 
xâˆˆA
Ï‡i1...ik(x)
=

1â‰¤kâ‰¤n

i1<Â·Â·Â·<ik
(âˆ’1)kâˆ’1|Ai1 âˆ©. . . âˆ©Aik|.
We now present two classical applications of the inclusion-exclusion principle.
For the ï¬rst one, we say that a permutation (a1, a2, . . . , an) of In is a derangement
if ai Ì¸= i for 1 â‰¤i â‰¤n. This is the same as saying that the function f : In â†’In,
such that f (i) = ai for 1 â‰¤i â‰¤n, has no ï¬xed points. The coming example
computes how many are these permutations of In (in this respect, see also Problem 6,
page 79).
Example 2.5 Given an integer n > 1, there are precisely
dn = n!
n

j=0
(âˆ’1)j
j!
(2.4)
derangements of In.

2.1
The Inclusion-Exclusion Principle
37
Proof Let Dn be the set of derangements of In and, for 1 â‰¤i â‰¤n, let Ci be the set
of those permutations (a1, . . . , an) of In for which ai = i. Letting Pn denote the set
of all permutations of In, we clearly have
Pn \ Dn = C1 âˆªC2 âˆª. . . âˆªCn.
Hence, the inclusion-exclusion principle gives
|Pn \ Dn| = |C1 âˆª. . . âˆªCn|
=
n

k=1
(âˆ’1)kâˆ’1

i1<Â·Â·Â·<ik
|Ci1 âˆ©. . . âˆ©Cik|.
(2.5)
Since dn = |Dn|, we have
|Pn \ Dn| = |Pn| âˆ’|Dn| = n! âˆ’dn.
On the other hand, since
(a1, . . . , an) âˆˆCi1 âˆ©. . . âˆ©Cik â‡”ai1 = i1, . . . , aik = ik,
in order to count how many permutations (a1, . . . , an) of In belong to Ci1 âˆ©. . .âˆ©Cik,
it sufï¬ces to count how many are the permutations of In \ {i1, . . . , ik}. Since this is
a set of n âˆ’k elements, it follows that
|Ci1 âˆ©. . . âˆ©Cik| = |Pnâˆ’k| = (n âˆ’k)!.
Substituting both these equalities in (2.5), we get
n! âˆ’dn =
n

k=1
(âˆ’1)kâˆ’1

i1<Â·Â·Â·<ik
(n âˆ’k)!
=
n

k=1
(âˆ’1)kâˆ’1
n
k

(n âˆ’k)!
= n!
n

k=1
(âˆ’1)kâˆ’1
k!
,
where, in the next to last equality, we used the fact that there are exactly
n
k

ways of
choosing integers 1 â‰¤i1 < Â· Â· Â· < ik â‰¤n. Therefore,
dn = n! âˆ’n!
n

k=1
(âˆ’1)kâˆ’1
k!
= n!
n

k=0
(âˆ’1)k
k!
.
âŠ“âŠ”

38
2
More Counting Techniques
Example 2.6 We are given m, n âˆˆN and ï¬nite sets A and B, such that |A| = m
and |B| = n. Prove that the number of surjective functions f : A â†’B equals
n

k=0
(âˆ’1)k
n
k

(n âˆ’k)m.
Proof Let Fm,n denote the set of functions f : A â†’B, and Sm,n the subset of Fm,n
consisting of the surjective ones. Also, let B = {b1, . . . , bn} and, for 1 â‰¤i â‰¤n, Fi
be the set of functions f : A â†’B such that bi /âˆˆIm (f ). Then,
Fm,n \ Sm,n = F1 âˆª. . . âˆªFn,
and the inclusion-exclusion principle gives
|Fm,n \ Sm,n| = |F1 âˆª. . . âˆªFn|
=
n

k=1
(âˆ’1)kâˆ’1

i1<Â·Â·Â·<ik
|Fi1 âˆ©. . . âˆ©Fik|.
(2.6)
Letting sm,n = |Sm,n|, we have
|Fm,n \ Sm,n| = |Fm,n| âˆ’|Sm,n| = nm âˆ’sm,n,
where in the last equality we used the discussion in the last paragraph of Sect. 1.1.
On the other hand, for a given function f : A â†’B, we obviously have
f âˆˆFi1 âˆ©. . . âˆ©Fik â‡”bi1, . . . , bik /âˆˆIm (f );
in turn, this is equivalent to the fact that f can be seen as a function from A into
B \ {bi1, . . . , bik}. However, since |B \ {bi1, . . . , bik}| = n âˆ’k (and invoking once
more the discussion in the last paragraph of Sect. 1.1), we get
|Fi1 âˆ©. . . âˆ©Fik| = |Fm,nâˆ’k| = (n âˆ’k)m.
Substituting these relations in (2.6), we obtain
nm âˆ’sm,n =
n

k=1
(âˆ’1)kâˆ’1

i1<Â·Â·Â·<ik
(n âˆ’k)m
=
n

k=1
(âˆ’1)kâˆ’1
n
k

(n âˆ’k)m,

2.1
The Inclusion-Exclusion Principle
39
where, in the last equality, we used the fact that there are
n
k

ways of choosing
integers 1 â‰¤i1 < Â· Â· Â· < ik â‰¤n. Hence,
sm,n = nm âˆ’
n

k=1
(âˆ’1)kâˆ’1
n
k

(n âˆ’k)m =
n

k=0
(âˆ’1)k
n
k

(n âˆ’k)m.
âŠ“âŠ”
We shall reobtain the results of the two examples above, by other means, in
Chap. 3 (cf. Problem 7, page 91, and Problem 9, page 92).
Example 2.7 (Romania) Compute the number of ways of coloring the vertices of
a regular dodecagon using two colors, in such a way that no monochromatic set of
vertices is the set of vertices of a regular polygon.
Solution A regular polygon having its vertices among those of the dodecagon is
either an equilateral triangle, a square, a regular hexagon or the regular dodecagon
itself. Since alternating vertices of a regular hexagon form an equilateral triangle,
we conclude that it sufï¬ces to avoid equilateral triangles and squares. Let red (R)
and blue (B) be the used colors.
There are four equilateral triangles whose vertices are among those of the
given regular dodecagon, and such equilateral triangles have pairwise disjoint sets
of vertices. Since each one of them can be colored in exactly six distinct and
non monochromatic ways, the number of distinct colorings of the vertices of the
dodecagon without monochromatic equilateral triangles equals 64 = 1296.
Letâ€™s calculate how many of these 1296 colorings contain at least one monochro-
matic square. To this end assume, without loss of generality, that such a coloring
contains a red square. Each one of its vertices is a vertex of exactly one of the
four possible equilateral triangles. Since such a vertex is red, the other two vertices
of the corresponding equilateral triangle could be colored BB, BR or RB. By the
fundamental principle of counting, exactly 2 Â· 3 Â· 34 = 486 (2 colors, 3 squares and
3 possible colorings for the other two vertices of each one of the four equilateral
triangles) of the 1296 colorings without monochromatic equilateral triangles contain
a monochromatic square.
Letâ€™s now compute how many of the 1296 colorings without monochromatic
equilateral triangles contain at least two monochromatic squares. We do this
considering two separate cases, according to whether the two monochromatic
squares have equal or different colors. For each equilateral triangle, exactly one
of its vertices is not a vertex of any of the two monochromatic squares. Assuming
(without loss of generality) them to be red, we conclude that there is exactly one
possible color (blue) for the third vertex. Assuming them to be one red and the other
one blue, we conclude that there are two possible colors (either red or blue) for the
third vertex. Since there are
3
2

= 3 ways of choosing two of the three squares, the
number of colorings with at least two monochromatic squares equals

40
2
More Counting Techniques
3
2

Â·

2 Â· 14 + 2 Â· 24
= 102
(note that if both squares have the same color, then there are two possibilities:
they are both blue or both red; if they have different colors, there are also two
possibilities: BR ou RB).
Finally, letâ€™s calculate how many of the 1296 colorings without monochro-
matic equilateral triangles have three monochromatic squares. The nonexistence of
monochromatic equilateral triangles forbids the three squares to have a single color.
Hence, there are six possible distinct colorings for their sets of vertices: BBR, BRB,
RBB, RRB, RBR and BRR.
Therefore, by the inclusion-exclusion principle, the number of colorings we wish
to count is
1296 âˆ’486 + 102 âˆ’6 = 906.
âŠ“âŠ”
Problems: Sect. 2.1
1. * Prove Lemma 2.3.
2. How many natural numbers from 1 to 1000 have a prime factor less than 10?
3. * Given m, n âˆˆN, with m < n, prove that
nâˆ’1

k=0
(âˆ’1)k
n
k

(n âˆ’k)m = 0.
4. Given n âˆˆN, compute the number of ways of forming a line with n couples, in
such a way that no wife is a neighbor of her husband and vice-versa.
5. (England) How many are the permutations (a1, a2, . . . , a6) of I6 such that, for
1 â‰¤j â‰¤5, the sequence (a1, . . . , aj) is not a permutation of Ij? Explain your
answer.
The next two problems admit from the reader a certain degree of acquain-
tance with the decomposition of a natural number n > 1 as a product of powers
of distinct primes, as well as with the notion of greatest common divisor of
two nonzero integers. Speciï¬cally for Problem 7, the reader may ï¬nd it useful
to recall the following fact: if n > 1 is natural but not prime, then n admits
a prime divisor which is less than or equal to âˆšn. The necessary material is
collected in Chap. 6. Alternatively, the reader can safely skip these problems
without loss of continuity.
6. Let n > 1 be a natural number and n = pÎ±1
1 . . . pÎ±k
k its factorisation as a product
of powers of distinct primes p1 < Â· Â· Â· < pk. Prove that there are exactly

2.1
The Inclusion-Exclusion Principle
41
n

1 âˆ’1
p1

Â· Â· Â·

1 âˆ’1
pk

(2.7)
integers 1 â‰¤m â‰¤n such that gcd(m, n) = 1.
For the next problem, we let âŒŠxâŒ‹stand for the integer part of x âˆˆR, i.e., the
greatest integer which is less than or equal to x. Thus, we have (for instance)
âŒŠ1âŒ‹= 1, âŒŠ
âˆš
2âŒ‹= 1 and âŒŠÏ€âŒ‹= 3.
7. Let n > 1 be natural and p1 < p2 < Â· Â· Â· < pk be the prime numbers less than
or equal to âˆšn. Prove that the quantity of prime numbers less than or equal to
n is given by the formula
n âˆ’
k

j=1
(âˆ’1)jâˆ’1

1â‰¤i1<Â·Â·Â·<ij â‰¤k

n
pi1 . . . pij

.
8. For n âˆˆN, we let p(n) denote the number of distinct partitions of n in naturals
summands. Also, for 1 â‰¤k â‰¤n we write pk(n) to denote the number of
partitions of n into exactly k distinct natural summands. Prove that
p(n) =

1â‰¤k<
âˆš
2n
(âˆ’1)kâˆ’1 
k2
2 <l<n
pk(l)p(n âˆ’l).
9. (Mongolia) Given k, m, n âˆˆN, let p = min

n,
m
k+1

. Show that equation
x1 + x2 + Â· Â· Â· + xn = m has exactly
p

j=0
(âˆ’1)j
n
j
m âˆ’j(k + 1) + n âˆ’1
n âˆ’1

solutions (x1, x2, . . . , xn) with xt âˆˆZ and 0 â‰¤xt â‰¤k, for 1 â‰¤t â‰¤n.
10. Lucasâ€™ problem1 aims at counting the number of ways in which n couples
can sit in 2n chairs around a circle, such that no wife sits beside her husband
and no two people of the same sex sit on adjacent chairs. The purpose of this
problem is to present I. Kaplanskyâ€™s solution to this problem. To this end, do
the following items:
(a) Conclude that there are 2(n!) ways of choosing the chairs of the hus-
bands. Once we are done with (a), conclude that the number of desired
conï¬gurations is equal to 2(n!)an, where an counts the number of ways of
distributing the wives in the n left chairs, in such a way that no wife sits
beside her husband.
1After Ã‰douard Lucas, French mathematician of the nineteenth century.

42
2
More Counting Techniques
(b) Label the chairs of the husbands, counterclockwisely, as h1, h2, . . . , hn,
and those to be occupied by the wives (in some allowed order) as 1, 2, . . . ,
n, with chair 1 situated between h1 and h2, chair 2 situated between h2 and
h3, and so on. For 1 â‰¤i â‰¤n, let wi denote the wife of hi, and A2iâˆ’1 (resp.
A2i) denote the set of ways of distributing the wives such that wi sits in
chair i âˆ’1 (resp. chair i. Here, chair 0 is the same as chair n). Conclude
that
an = n! âˆ’|A1 âˆªA2 âˆªA3 âˆªA4 âˆª. . . âˆªA2nâˆ’1 âˆªA2n|.
(c) If {i1, i2, . . . , ik} âŠ‚{1, 2, . . . , 2n} has two consecutive elements (with 2n
and 1 seen as consecutive), show that Ai1 âˆ©Ai2 âˆ©. . . âˆ©Aik = âˆ….
(d) If {i1 < i2 < . . . < ik} âŠ‚{1, 2, . . . , 2n} has no consecutive elements (also
with 2n and 1 seen as consecutive), show that
|Ai1 âˆ©Ai2 âˆ©. . . âˆ©Aik| = (n âˆ’k)!.
(e) Apply Kaplanskyâ€™s second lemma (cf. Problem 12, page 29) to conclude
that there are exactly
2n
2n âˆ’k
2n âˆ’k
k

ways of composing an intersection of the form Ai1 âˆ©Ai2 âˆ©. . . âˆ©Aik, with
{i1 < i2 < . . . < ik} âŠ‚{1, 2, . . . , 2n} having no consecutive elements (and
2n and 1 seen as consecutive).
(f) Conclude that
an =
n

k=0
(âˆ’1)k
2n
2n âˆ’k
2n âˆ’k
k

(n âˆ’k)!.
2.2
Double Counting
Double counting is nothing but the bijective principle in action once again, albeit
under a different perspective. The central idea is that, if we count a certain number
of conï¬gurations in two different ways and without making mistakes, then the
two results thus obtained must coincide. Sometimes this naive approach generates
interesting conclusions.
The best way to master double counting is by looking at some examples, and we
start with one that allows us to reobtain an important result, already derived by other
means.

2.2
Double Counting
43
Example 2.8 If n and k are integers such that 0 â‰¤k â‰¤n, then every set with n
elements has exactly
n
k

subsets with k elements.
Proof Note ï¬rst that it sufï¬ces to consider the case 1 â‰¤k â‰¤n.
Under this assumption, ï¬x a set A with n elements and consider the problem of
counting how many sequences of k terms, chosen from the elements of A, can be
formed. By Corollary 1.22, the answer is n(n âˆ’1) . . . (n âˆ’k + 1).
On the other hand, by permuting the elements of each k-element subset of A we
generate k! different sequences of k terms; moreover, it is immediate to see that the
sequences we get this way are all sequences of k terms chosen from A, and they
are all distinct. Hence, if (as in the previous chapter) Cn
k denotes the number of k-
element subsets of A, we conclude that there are exactly k!Cn
k sequences of k terms,
all chosen from the elements of A.
Now, since n(n âˆ’1) . . . (n âˆ’k + 1) and k!Cn
k are answers to the same counting
problem, we conclude that
k!Cn
k = n(n âˆ’1) . . . (n âˆ’k + 1)
or, which is the same,
Cn
k = n(n âˆ’1) . . . (n âˆ’k + 1)
k!
= n(n âˆ’1) . . . (n âˆ’k + 1) Â· (n âˆ’k)!
k!(n âˆ’k)!
=
n
k

.
âŠ“âŠ”
The result of the next example is known as Lagrangeâ€™s identity, after the French
mathematician of the eighteenth century Joseph L. Lagrange.
Example 2.9 Prove that, for every natural number n, one has
2n
n

=
n
0
2
+
n
1
2
+
n
2
2
+ Â· Â· Â· +
n
n
2
.
Proof Consider a group of 2n people, composed by n men and n women. We shall
compute the number of ways of choosing exactly n of the 2n people, by using two
different approaches.
On the one hand, the answer obviously is
2n
n

. On the other, for 0 â‰¤k â‰¤n, the
fundamental principle of counting guarantees that we can choose k men and n âˆ’k
women in exactly
n
k
 n
nâˆ’k

different ways; adding such possibilities as k varies from
0 to n and using the fact that
n
k

=
 n
nâˆ’k

, we get the sum

44
2
More Counting Techniques
n

k=0
n
k

n
n âˆ’k

=
n

k=0
n
k
2
as another answer to the posed problem. Hence, the stated equality actually take
place.
âŠ“âŠ”
Yet concerning the previous example, a nontrivial difï¬culty in the implementa-
tion of the double counting argument relied in looking at both sides of the desired
equality as different ways of counting the number of conï¬gurations relative to a
single combinatorial situation. There is no general rule on how to ï¬nd out such a
counting problem; just experience and careful thinking will help. Therefore, letâ€™s go
on and discuss another (and tougher) example.
Example 2.10 Let m and n be positive integers. Prove that

j
m
j
n
j

2j =

k
m
k
n + k
m

,
with the above sums ranging over all possible integer values of the indices j and k.
Proof Let A and B be disjoint sets, with |A| = m and |B| = n. Letâ€™s calculate the
number of ordered pairs (X, Y), with X âŠ‚A and Y âŠ‚B âˆªX such that |Y| = m.
If |X| = k, there are
m
k

ways of choosing X; for each of them, the disjointness
of A and B gives |B âˆªX| = n + k, so that there are
n+k
m

ways of choosing Y.
Therefore, by successively applying the multiplicative and additive principles, we
conclude that the number of such ordered pairs is

k
m
k
n + k
m

.
We now choose Y ï¬rst. More precisely, we compute how many ordered pairs
(X, Y) satisfy the given conditions and are such that |Y âˆ©B| = j. There are
n
j

ways of choosing j elements from B to put in Y; once they are chosen, we are left
to choosing m âˆ’j elements for Y, which ought to be elements of A. Then, there
are
 m
mâˆ’j

=
m
j

ways of choosing these m âˆ’j elements of A, and the condition
Y âŠ‚B âˆªX forces such elements to belong to X. Apart from these m âˆ’j elements,
the remaining elements of X can form an arbitrary subset of the set formed by
the remaining j elements of A, so that we can choose such a subset in exactly 2j
different ways. Hence, the number of pairs (X, Y) is given by

j
n
j
m
j

2j.

2.2
Double Counting
45
Finally, since both of the above countings solve the same problem, the only
possibility is to have the stated equality.
âŠ“âŠ”
The coming example illustrates how one can use double counting arguments to
get inequalities.
Example 2.11 (IMO) Let n and k be positive integers and S be a set of n points in
the plane satisfying the following conditions:
(a) no three points of S are collinear.
(b) For every point P âˆˆS, there are at least other k points of S equidistant from P.
Prove that k < 1
2 +
âˆš
2n.
Proof Let
F = {(A, B, C); A, B, C âˆˆS and AB = AC}.
We shall count |F| in two different ways.
Firstly, for each A âˆˆS there are at least k points of S equidistant from A and
such points generate at least k(k âˆ’1) pairs (B, C) such that (A, B, C) âˆˆF. Since
there are n possible choices for A âˆˆS, we conclude that
|F| â‰¥nk(k âˆ’1).
Now, for ï¬xed B, C âˆˆS, we claim that there are at most two points A in S
such that (A, B, C) âˆˆF. Indeed, since any such A belongs to the perpendicular
bisector of BC, and condition (a) gives at most two of them. However, since there
are n(n âˆ’1) possible choices for (B, C), we conclude that
|F| â‰¤2n(n âˆ’1).
Thus,
nk(k âˆ’1) â‰¤2n(n âˆ’1)
and, hence,
k â‰¤1 +
âˆš
8n âˆ’7
2
< 1 +
âˆš
8n
2
= 1
2 +
âˆš
2n.
âŠ“âŠ”
We ï¬nish this section by showing how to use a double counting argument to
obtain formula (2.4) for the number of derangements of In. Prior to that, however,
we need to establish the following auxiliary result, which will also be useful in
Sect. 18.1.

46
2
More Counting Techniques
Lemma 2.12 If a0, a1, . . . , an and b0, b1, . . . , bn are real numbers such that ak =
k
j=0
k
j

bj for 0 â‰¤k â‰¤n, then
bk =
k

j=0
(âˆ’1)k+j
k
j

aj
(2.8)
for 0 â‰¤k â‰¤n.
Proof Letâ€™s make induction on 0 â‰¤k â‰¤n, noting that the result is obvious if
k = 0. As induction hypothesis, assume (2.8) to be true when k = l âˆ’1, for some
1 â‰¤l â‰¤n. For k = l, we get
al =
l
j=0
l
j

bj =
lâˆ’1

j=0
l
j

bj + bl,
so that, by applying the induction hypothesis and the result of Problem 1, we obtain
bl = al âˆ’
lâˆ’1

j=0
l
j

bj
= al âˆ’
lâˆ’1

j=0
l
j

j

i=0
(âˆ’1)j+i
j
i

ai
= al âˆ’
lâˆ’1

j=0
j

i=0
(âˆ’1)j+i
l
j
j
i

ai
= al âˆ’
lâˆ’1

i=0
lâˆ’1

j=i
(âˆ’1)j+i
l
j
j
i

ai.
If we now observe that
l
j
j
i

=
l
i
l âˆ’i
l âˆ’j

,
the above computations give
bl = al âˆ’
lâˆ’1

i=0
lâˆ’1

j=i
(âˆ’1)j+i
l
i
l âˆ’i
l âˆ’j

ai
= al âˆ’
lâˆ’1

i=0
(âˆ’1)i
l
i

ai
lâˆ’1

j=i
(âˆ’1)j
l âˆ’i
l âˆ’j

= al âˆ’
lâˆ’1

i=0
(âˆ’1)i
l
i

ai
lâˆ’i

t=1
(âˆ’1)lâˆ’t
l âˆ’i
t

.

2.2
Double Counting
47
Finally, since
lâˆ’i

t=1
(âˆ’1)t
l âˆ’i
t

=
lâˆ’i

t=0
(âˆ’1)t
l âˆ’i
t

âˆ’1 = (1 âˆ’1)lâˆ’i âˆ’1 = âˆ’1,
we get
bl = al +
lâˆ’1

i=0
(âˆ’1)l+i
l
i

ai =
l
i=0
(âˆ’1)l+i
l
i

ai.
âŠ“âŠ”
We present the promised example next.
Example 2.13 If dn stands for the number of derangements of In, then
k! =
k

j=0
k
j

dj.
(2.9)
In particular, dk = k! k
j=0
(âˆ’1)j
j! .
Proof As in Example 2.5, let Pk denote the set of all permutations of Ik and letâ€™s
count |Pk| in two different ways.
Firstly, Corollary 1.25 gives |Pk| = k!.
Secondly, for 0 â‰¤j â‰¤k, let Fj denote the subset of Pk formed by those
permutations of Ik having exactly j ï¬xed points. Then,
Pk = F0 âˆªF1 âˆª. . . âˆªFk;
however, since the union at the right hand side above is disjoint, we obtain
|Pk| = |F0| + |F1| + Â· Â· Â· + |Fk|.
(2.10)
Now, for f âˆˆFj, we can choose its j ï¬xed points in exactly
k
j

ways; on the
other hand, the restriction of f to the subset of Ik formed by the other k âˆ’j points
clearly forms a derangement of Ikâˆ’j. Hence, the fundamental principle of counting
gives
|Fj| =
k
j

dkâˆ’j =

k
k âˆ’j

dkâˆ’j.

48
2
More Counting Techniques
It then follows from (2.10) that
|Pk| =
k

j=0
|Fj| =
k

j=0

k
k âˆ’j

dkâˆ’j =
k

j=0
k
j

dj,
and it sufï¬ces to compare both expressions above for |Pk| to get (2.9).
For what is left, we apply the previous lemma to (2.9) (with ak = k! and bk = dk)
to get
dk =
k

j=0
(âˆ’1)k+j
k
j

j! =
k

j=0
(âˆ’1)k+j
k!
(k âˆ’j)!
= k!
k

j=0
(âˆ’1)kâˆ’j
(k âˆ’j)! = k!
k

j=0
(âˆ’1)j
j!
.
âŠ“âŠ”
Problems: Sect. 2.2
1. * We are given n âˆˆN and, for 0 â‰¤i, j â‰¤n, a real number aij. Show that
n

j=0
j

i=0
aij =
n

i=0
n

j=i
aij.
2. Use double counting to prove that, for each natural number n, one has
n
0

+
n
1

+
n
2

+ Â· Â· Â· +
n
n

= 2n.
3. Prove Vandermondeâ€™s identity2: given m, n, p âˆˆN, one has

k
m
k

n
p âˆ’k

=
m + n
p

,
with the sum at the left hand side above ranging through all possible nonnega-
tive integer values of k.
2After Alexandre-TheÃ³phile Vandermonde, French mathematician of the eighteenth century. For
another proof of Vandermondeâ€™s identity, see Problem 3, page 355.

2.3
Equivalence Relations and Counting
49
4. For each integer n > 1, prove that the number of subsets of I2n with equal
quantities of odd and even elements is equal to
2n
n

.
5. A battalion commander asked volunteers to compose 11 patrols, all of which
formed by the same number of men. If each man entered exactly two patrols
and each two patrols had exactly one man in common, compute the numbers of
volunteers and of members of each patrol.3
6. (IMO) Given n, k âˆˆN, let pn(k) denote the number of permutations of In
having exactly k ï¬xed points. Prove that n
k=0 kpn(k) = n!.
7. (TT) The set of natural numbers is partitioned into m inï¬nite and nonconstant
arithmetic progressions, of common ratios d1, d2, . . . , dm. Prove that
1
d1
+ 1
d2
+ Â· Â· Â· + 1
dm
= 1.
The result of the coming problem is known as Spernerâ€™s lemma, after the
German mathematician of the twentieth century Emanuel Sperner.
8. A triangle ABC is partitioned into a ï¬nite number of smaller triangles, in such
a way that any two of them are either disjoint, have exactly a common vertex or
exactly a common side. Such a partition generates a certain number of points
lying in the interior or on the sides of ABC and which are vertices of smaller
triangles. We call them vertices of the partition. Randomly label the points lying
on side AB (and different from A or B) as â€œAâ€ or â€œBâ€; accordingly, randomly
label the points lying on side AC (and different from A or C) as â€œAâ€ or â€œCâ€,
and those lying on side BC (also different from B or C) as â€œBâ€ or â€œCâ€. Then,
label each of the remaining vertices of the partition (all lying in the interior
of ABC) as A, B or C, also randomly. Prove that at least one of the smaller
triangles will be labelled as ABC.
9. (Russia) A senate has 30 senators, any two of which are either friends or
enemies. It is also known that each senator has exactly six enemies. If each
three senators form a commission, compute the number of those commissions
such that its members are either pairwise friends or pairwise enemies.
10. We are given a convex n-gon in the plane. Prove that it is possible to choose
nâˆ’2 points in the plane such that every triangle formed by three vertices of the
given n-gon has exactly one of the chosen points in its interior.
2.3
Equivalence Relations and Counting
Let A be a ï¬xed nonempty set, and recall that a relation in A is a subset of the
cartesian product A Ã— A.
3For another approach to this problem, see Problem 21, page 134.

50
2
More Counting Techniques
We say that a relation R in A is reï¬‚exive if aRa for every a âˆˆA; symmetric if,
whenever a, b âˆˆA, we have that aRb â‡’bRa; transitive if, whenever a, b, c âˆˆA,
we have that aRb and bRc imply aRc. Finally, an equivalence relation in A is
a relation R in A which is simultaneously reï¬‚exive, symmetric and transitive. In
Mathematics, equivalence relations are customarily denoted by âˆ¼, instead of R (i.e.,
by writing a âˆ¼b instead of aRb); from now on, we shall stick to this usage without
further comments.
Examples 2.14
(a) Let F be a partition of a nonempty set A. The relation âˆ¼in A, deï¬ned by
a âˆ¼b â‡”âˆƒB âˆˆF; a, b âˆˆB,
is of equivalence. We say that such an equivalence relation is the one induced
by the partition F.
(b) Let A and B be nonempty sets and f : A â†’B be a given function. Relation âˆ¼
in A, deï¬ned by
a âˆ¼b â‡”f (a) = f (b)
is of equivalence. We say that such a relation is induced by f .
The following deï¬nition is central to all that follows.
Deï¬nition 2.15 Let A be a nonempty set and âˆ¼be an equivalence relation in A.
For a âˆˆA, the equivalence class of a is the subset a of A deï¬ned by
a = {x âˆˆA; x âˆ¼a}.
(2.11)
If âˆ¼is an equivalence relation in a nonempty set A and a âˆˆA, then the
equivalence class of a is clearly nonempty, for a âˆˆa. Our ï¬rst result analyses
the equivalence classes of a generic equivalence relation.
Proposition 2.16 Let âˆ¼be an equivalence relation in a nonempty set A. For a, b âˆˆ
A, one has
a âˆ¼b â‡”a âˆ©b Ì¸= âˆ…â‡”a = b.
In particular, the equivalence classes of âˆ¼form a partition of A.
Proof We shall show that a âˆ¼b â‡’a âˆ©b Ì¸= âˆ…â‡’a = b â‡’a âˆ¼b:
â€¢
If a âˆ¼b, then a âˆˆb and, hence, a âˆˆa âˆ©b; therefore, a âˆ©b Ì¸= âˆ….
â€¢
If c âˆˆa âˆ©b (i.e., if a âˆ©b Ì¸= âˆ…), then c âˆ¼a and c âˆ¼b; hence, the symmetry of âˆ¼
guarantees that a âˆ¼c and c âˆ¼b and, thus, its transitivity implies a âˆ¼b. We shall
now show that a âŠ‚b (the converse inclusion being totally analogous): if x âˆˆa,
then x âˆ¼a; however, since a âˆ¼b, it follows once more from the transitivity of
âˆ¼that x âˆ¼b, i.e., x âˆˆb.

2.3
Equivalence Relations and Counting
51
â€¢
If a = b, then a âˆˆa implies a âˆˆb. But this is the same as saying that a âˆ¼b.
âŠ“âŠ”
If âˆ¼is an equivalence relation in a nonempty set A, it follows immediately from
the previous proposition that the family A/ âˆ¼, deï¬ned by
A/ âˆ¼= {a; a âˆˆA}
(2.12)
(i.e., the family of the equivalence classes of the elements of A with respect to âˆ¼), is
a partition of A. Such a family is called the quotient set of A by âˆ¼, and the function
Ï€ : A âˆ’â†’A/ âˆ¼
a âˆ’â†’
a
(2.13)
is the projection function of A on A/ âˆ¼.
Given an equivalence relation âˆ¼in a nonempty set A, a subset B of A is said to
be a system of distinct representatives (we abbreviate SDR) for âˆ¼if the following
conditions are satisï¬ed:
(a) For all a, b âˆˆB, either a = b or a Ì¸âˆ¼b.
(b) For every a âˆˆA, there exists b âˆˆB such that a âˆ¼b.
In words, a SDR for an equivalence relation âˆ¼in A is a subset of A formed by
pairwise nonrelated elements such that every element of A is related to exactly one
of them. Yet in another way, if B is a SDR for the equivalence relation âˆ¼in A, then
A/ âˆ¼= {x; x âˆˆB}.
(2.14)
The following proposition provides an effective way of constructing SDR for
equivalence relations.
Proposition 2.17 Let âˆ¼be an equivalence relation in a nonempty set A. If f :
A/ âˆ¼â†’A is a function such that f (a) âˆˆa for every a âˆˆA, then Im (f ) is a SDR
for âˆ¼.
Proof Let B = Im f . If a, b âˆˆB, say a = f (Î±) and b = f (Î²), with Î±, Î² âˆˆA,
then the hypothesis on f assures that a âˆˆÎ± and b âˆˆÎ². If a âˆ¼b, then, since Î± âˆ¼a
and b âˆ¼Î², we have by transitivity that Î± âˆ¼Î²; thus, Î± = Î² and, hence,
a = f (Î±) = f (Î²) = b.
In order to verify the validity of the second condition in the deï¬nition of a SDR,
take a âˆˆA and let b = f (a). Then b âˆˆIm (f ) and the deï¬nition of f gives b âˆˆa,
i.e., a âˆ¼b.
âŠ“âŠ”

52
2
More Counting Techniques
In the notations of the previous proposition, we say that f is a choice function
for the equivalence relation âˆ¼. In words, the role of f is to choose one element out
of each equivalence class in A/ âˆ¼.
Concerning the role of equivalence relations in counting problems, we have
ï¬nally arrived at the result we are interested in.
Proposition 2.18 Let âˆ¼be an equivalence relation in a ï¬nite nonempty set A. If
all of the equivalence classes of A with respect to âˆ¼have the same number k of
elements, then there are exactly |A|/k distinct equivalence classes.
Proof If {a1, . . . , am} is a SDR with respect to âˆ¼, then A = m
j=1 aj, a disjoint
union. Hence,
|A| =
m

j=1
|aj| =
m

j=1
k = km,
so that m = |A|/k.
âŠ“âŠ”
As a ï¬rst example of application of the previous proposition, we shall now
reobtain the formula for the number of k-element subsets of a given set A, of n
elements (the following reasoning is a slight variation of that in Example 2.8, the
major change being in the adopted viewpoint). To this end, let 1 â‰¤k â‰¤n and Sk(A)
be the set of sequences of k distinct terms, all belonging to A. We already know that
|Sk(A)| = n(n âˆ’1) . . . (n âˆ’k + 1) =
n!
(n âˆ’k)!.
Let âˆ¼be deï¬ned in Sk(A) by
(a1, . . . , ak) âˆ¼(b1, . . . , bk) â‡”{a1, . . . , ak} = {b1, . . . , bk}.
(2.15)
Itâ€™s immediate to check that âˆ¼is of equivalence, and such that the equivalence
class of a sequence (a1, . . . , ak) is the set of all of its permutations. Hence, such an
equivalence class has precisely k! elements, and Proposition 2.18 assures that the
number of distinct equivalence relations is equal to
|Sk(A)|
k!
=
n!
k!(n âˆ’k)! =
n
k

.
Finally, note that (2.15) allows us to identify the equivalence classes with the k-
element subsets of A, so that there are exactly
n
k

of such subsets.
Another interesting situation is the following: in the set S(A) of the permutations
of a ï¬nite nonempty set A, we deï¬ne an equivalence relation âˆ¼in the following
way:
(a1, . . . , an) âˆ¼(b1, . . . , bn)

2.3
Equivalence Relations and Counting
53
â‡•
(2.16)
âˆƒ1 â‰¤k â‰¤n; bj =
aj+k,
if 1 â‰¤j â‰¤n âˆ’k
aj+kâˆ’n, if n âˆ’k < j â‰¤n .
In other words, (a1, . . . , an) âˆ¼(b1, . . . , bn) means that, for some 1 â‰¤k â‰¤n, one
has
(b1, . . . , bn) = (ak+1, ak+2, . . . , anâˆ’1, an, a1, . . . , ak).
Itâ€™s immediate to verify that âˆ¼is actually of equivalence in S(A). Moreover,
for each sequence (a1, . . . , an) âˆˆS(A), its equivalence class (a1, . . . , an) contains
exactly n sequences; more precisely,
(a1, . . . , an) = {(a1, a2 . . . , anâˆ’1, an), (a2, a3, . . . , an, a1)
(a3, . . . , an, a1, a2), . . . , (an, a1, a2, . . . , anâˆ’1)}.
With respect to the equivalence relation just described, the equivalence class of
a sequence (a1, . . . , an) is said to be the circular permutation of the sequence
(a1, . . . , an). In particular, it follows from the general discussion on equivalence
relations that all of the sequences
(a1, a2 . . . , anâˆ’1, an), (a2, a3, . . . , an, a1), . . . , (an, a1, a2, . . . , anâˆ’1)
deï¬ne the same circular permutation.
With the concept of circular permutation at our disposal, we now have the
following result.
Proposition 2.19 The number of distinct circular permutations of a set of n
elements is (n âˆ’1)!.
Proof If A is a set having n elements, we wish to count the number of equivalence
classes of S(A) with respect to the equivalence relation just described. Since
|S(A)| = n! and each equivalence class has exactly n elements, it follows from
Proposition 2.18 that there are precisely n!
n = (n âˆ’1)! distinct equivalence classes
(i.e., circular permutations).
âŠ“âŠ”
For what comes next, we say that two sets A and B are incomparable with
respect to inclusion4 if A Ì¸âŠ‚B and B Ì¸âŠ‚A. The result below brings a deeper
application of the ideas of this section, and is due to the Hungarian mathematician
BÃ©la BollobÃ¡s. Our discussion follows [25].
4This terminology comes from the fact that the inclusion relation is a partial order in the family of
all subsets of a given set. In this respect, see the discussion at Sect. 4.3.

54
2
More Counting Techniques
Theorem 2.20 (BollobÃ¡s)
If F is a family of subsets of In, pairwise incomparable
with respect to inclusion, then

AâˆˆF
 n
|A|
âˆ’1
â‰¤1.
Proof Let P be the set of permutations (a1, . . . , an) of In such that, for some 1 â‰¤
k â‰¤n, we have {a1, . . . , ak} âˆˆF. Being a set of permutations of In, it is immediate
that |P| â‰¤n!.
We consider in P the relation âˆ¼, given by
(a1, . . . , an) âˆ¼(b1, . . . , bn) â‡”{a1, . . . , ak} = {b1, . . . , bk} âˆˆF,
for some integer 1 â‰¤k â‰¤n. We claim that âˆ¼is of equivalence. Indeed, it is clear
that âˆ¼is reï¬‚exive and symmetric. In order to show that it is transitive, take a third
permutation (c1, . . . , cn) in P and assume that {a1, . . . , ak} = {b1, . . . , bk} âˆˆF
and {b1, . . . , bl} = {c1, . . . , cl} âˆˆF, for some integers 1 â‰¤k, l â‰¤n. Without loss
of generality, we can also assume that k â‰¤l. However, if k < l, then
{a1, . . . , ak} = {b1, . . . , bk} âŠ‚{b1, . . . , bl} = {c1, . . . , cl} âˆˆF,
a strict inclusion; this would contradict the fact that the sets in F are pairwise
incomparable with respect to inclusion. Therefore, k = l and, thus,
{a1, . . . , ak} = {b1, . . . , bk} = {c1, . . . , ck} âˆˆF,
i.e., (a1, . . . , an) âˆ¼(c1, . . . , cn).
We now ï¬x a permutation (a1, . . . , an) âˆˆP, with {a1, . . . , ak} = A âˆˆF. Then,
(b1, . . . , bn) âˆ¼(a1, . . . , an) if and only if {b1, . . . , bk} = A, i.e., if and only if
(b1, . . . , bk) is a permutation of the elements of A (and, hence, (bk+1, . . . , bn) is a
permutation of the elements of In \ A); since we can permute the elements of A and
of In \A in exactly |A|! and (nâˆ’|A|)! ways, respectively, we conclude that there are
exactly |A|!(n âˆ’|A|)! permutations (b1, . . . , bn) which are equivalent to the ï¬xed
permutation (a1, . . . , an) âˆˆP. Yet in another way, if A is the set in F associated to
(a1, . . . , an) âˆˆP, then the equivalence class of (a1, . . . , an) in P contains exactly
|A|!(n âˆ’|A|)! permutations.
Finally, by Proposition 2.16, the quotient set P/ âˆ¼of equivalence classes of
P with respect to âˆ¼forms a partition of P. However, since distinct equivalence
classes are associated to distinct sets A âˆˆF and every set A âˆˆF gives rise to an
equivalence class, it follows that
n! â‰¥|P| =

(a1,...,an)âˆˆP/âˆ¼
# (a1, . . . , an) =

AâˆˆF
|A|!(n âˆ’|A|!).

2.3
Equivalence Relations and Counting
55
This is the same as

AâˆˆF
|A|!(n âˆ’|A|!)
n!
â‰¤1,
which in turn is equivalent to the desired inequality.
âŠ“âŠ”
For our next example we ï¬rst need to recall some simple facts concerning the
notion of divisibility of integers. Further details can be found in Chap. 6.
Given a, b âˆˆZ, with b Ì¸= 0, we say that b divides a, or that a is a multiple of
b, if a
b is an integer. Letting a
b = c, this is the same as saying that a = bc, with
c âˆˆZ. For instance, 7 divides 28, for 28
7 = 4 âˆˆZ. If b divides a, we write b | a;
otherwise, we write b âˆ¤a and say that b does not divide a. If a is not a multiple of
b, the division algorithm5 shows that there exist unique integers q and r such that
a = bq + r and 0 â‰¤r < |b|.
We now introduce a whole class of equivalence relations in Z, which will reveal
itself to be of paramount importance to the material of Chaps. 10â€“20.
For a given integer n > 1, we say that two integers a and b are congruent modulo
n if n divides a âˆ’b. If a and b are congruent modulo n, we write a â‰¡b (mod n);
otherwise, we write a Ì¸â‰¡b (mod n). For instance, we have 1 â‰¡âˆ’5 (mod 3), since
3 | (1 âˆ’(âˆ’5)), but âˆ’3 Ì¸â‰¡7 (mod 4), since 4 âˆ¤(âˆ’3 âˆ’7). Note that if a = nq + r,
with 0 â‰¤r < n, then n | (a âˆ’r), so that a â‰¡r (mod n). Therefore, every integer is
congruent, modulo n, to precisely one of 0, 1, . . . , n âˆ’1.
Example 2.21 Let n > 1 be a given integer. The relation âˆ¼, deï¬ned in Z by
a âˆ¼b â‡”a â‰¡b (mod n),
is an equivalence relation in Z, which is known as the relation of congruence
modulo n.
Proof Reï¬‚exivity of âˆ¼follows from
a âˆ¼a â‡”a â‰¡a (mod n) â‡”n | (a âˆ’a),
which is clearly true. On the other hand, since
a âˆ¼b â‡”a â‰¡b (mod n) â‡”n | (a âˆ’b),
and n | (a âˆ’b) â‡”n | (b âˆ’a), we have that
a âˆ¼b â‡’n | (b âˆ’a) â‡’n | (b âˆ’a)
â‡’b â‰¡a (mod n) â‡’b âˆ¼a.
5For a formal deï¬nition of an algorithm, see the footnote at page 116.

56
2
More Counting Techniques
Finally, for the transitivity of âˆ¼, if a âˆ¼b and b âˆ¼c, then n | (a âˆ’b) and
n | (b âˆ’c), i.e., aâˆ’b
n
and bâˆ’c
n
are both integers; hence, the number
a âˆ’c
n
= a âˆ’b
n
+ b âˆ’c
n
is also an integer, which in turn guarantees that n | (a âˆ’c). But this is the same as
saying that a â‰¡c (mod n), so that a âˆ¼c.
âŠ“âŠ”
For the coming example, given an integer m > 1, a set A âŠ‚Im and another
integer 0 â‰¤r â‰¤m âˆ’1, we let A + r denote the set
A + r = {a + r (mod m); a âˆˆA}.
Thus,
A + r = {x + r; x âˆˆA and 1 â‰¤x â‰¤m âˆ’r}âˆª
âˆª{x + r âˆ’m; x âˆˆA and m âˆ’r < x â‰¤m}.
For instance, if m = 7, A = {1, 3, 5} and r = 4, then
A + r = {1 + 4, 3 + 4, 5 + 4 (mod 7)} = {5, 7, 2}.
Example 2.22 (Austrian-Polish) Let k and n be given natural numbers, such that
3 âˆ¤k and 1 â‰¤k â‰¤3n. Prove that the set I3n has exactly 1
3
3n
k

subsets of k elements,
such that the sum of its elements is a multiple of 3.
Solution Let F be the family of k-element subsets of I3n. Consider a relation âˆ¼
in F be deï¬ning A âˆ¼B if and only if there exists an integer 0 â‰¤j â‰¤2 such
that B = A + j modulo 3. It is immediate to check (cf. Problem 2) that âˆ¼is an
equivalence relation, and that the equivalence class of a subset A of In contains
exactly the three sets A, A + 1 and A + 2 (these last two modulo 3).
On the other hand, letting S = 
xâˆˆA x, we obviously have

xâˆˆA+1
x â‰¡S + k (mod 3) and

xâˆˆA+2
x â‰¡S + 2k (mod 3).
However, since 3 âˆ¤k, we conclude that the three numbers S, S + k and S + 2k are
pairwise incongruent modulo 3. But since every integer is congruent to precisely
one of the integers 0, 1 or 2, modulo 3, we conclude that exactly one of S, S + k
and S + 2k is divisible by 3. This is the same as saying that exactly one of the sets
A, A + 1 and A + 2 has sum of elements equal to a multiple of 3. Hence, there are
as many k-element subsets of I3n whose sum of elements is divisible by 3 as there
are equivalence classes of F with respect to âˆ¼. But since each such equivalence
class contains three elements, Proposition 2.18 assures that the number of distinct
equivalence classes is precisely 1
3
3n
k

.
âŠ“âŠ”

2.3
Equivalence Relations and Counting
57
Problems: Sect. 2.3
1. In each of the items of Example 2.14, prove that the given relations are, indeed,
of equivalence. Also, identify the corresponding equivalence classes.
2. * Given k, m âˆˆN, deï¬ne a relation âˆ¼in the family of k-element subsets of Im
by letting A âˆ¼B if and only if there exists 0 â‰¤j â‰¤2 for which B = A + j
modulo 3. Prove that âˆ¼is an equivalence relation.
3. Show that the number of distinct ways of partitioning a set of ab elements into a
sets of b elements each is equal to
(ab)!
a!(b!)a .
4. Given n, k âˆˆN, with 1 â‰¤k â‰¤n, let S(n, k) denote the corresponding Stirling
number of second kind (cf. Problem 8, page 20) and let A be a ï¬nite set with n
elements. Do the following items:
(a) Show that every equivalence relation on A, with exactly k equivalence
classes, can be obtained from a surjective function f : A â†’B, with |B| = k,
as prescribed by item (b) of Example 2.14.
(b) Show that the number of equivalence relations on A having exactly k
equivalence classes is equal to S(n, k).
(c) Conclude, from the previous items, that
S(n, k) = 1
k!
k

j=0
(âˆ’1)j
k
j

(k âˆ’j)n.
For the next problem, recall that a natural number p > 1 is said to be prime if
1 and p are the only positive divisors of p. We also recall (see Sects. 6.2 and 6.3
for details) that if a, b âˆˆN are such that p | (ab) but p âˆ¤a, then p | b.
5. We are given a prime number p and m pairwise distinct colors. Prove that there
are exactly mpâˆ’m
p
+m distinct necklaces, each of which formed by p beads, each
bead being of one of the m given colors (there may well be beads of repeated
colors). Then, use this counting to establish Fermatâ€™s little theorem6: if p is
prime and m is a natural number which is not divisible by p, then mpâˆ’1 â‰¡
1 (mod p).
6. (IMO shortlist) Given n âˆˆN, we say that a sequence (x1, x2, . . . , xn), with xj âˆˆ
{0, 1} for 1 â‰¤j â‰¤n, is aperiodic if there does not exist a positive divisor d
of n such that the sequence is formed by the juxtaposition of n
d copies of the
subsequence (x1, . . . , xd). If an denotes the number of aperiodic sequences of
size n, prove that n | an.
7. Prove the following theorem of Sperner: if F is a family of subsets of In, pairwise
uncomparable with respect to inclusion, then
6After Pierre S. de Fermat, French mathematician of the seventeenth century. For a different proof
of this result, see Sect. 10.2.

58
2
More Counting Techniques
|F| â‰¤

n
âŒŠn/2âŒ‹

,
with equality if F = {A âŠ‚In; |A| = âŒŠn/2âŒ‹}.
8. This problem generalizes Problem 19, page 31. To this end, let n âˆˆN, p be prime
and f : In â†’In be such that f (p) = Id, with f (p) standing for the composition
of f with itself, p times.
(a) Show that f is a bijection and, if âˆ¼is the relation deï¬ned in In by
a âˆ¼b â‡”b = f (j)(a), âˆƒj âˆˆZ,
then âˆ¼is an equivalence relation.
(b) Each equivalence class of In with respect to âˆ¼has either 1 or p elements. In
particular, if f has exactly k ï¬xed points, then p | (n âˆ’k).
(c) Conversely, given 0 â‰¤k â‰¤n such that n âˆ’k = pl, with l âˆˆZ+, show that
for each choice of elements x1, . . . , xk âˆˆIn and for each partition
In \ {x1, . . . , xk} = A1 âˆª. . . âˆªAl
of In \ {x1, . . . , xk} into pairwise disjoint p-element sets, there are exactly

(p âˆ’1)!
l functions f as in the statement, having precisely x1, . . . , xk as
their ï¬xed points and satisfying f (Ai) = Ai for 1 â‰¤i â‰¤l.
(d) Conclude that the number of functions f : In â†’In such that f (p) = Id is
given by

0â‰¤kâ‰¤n
p|(nâˆ’k)
n
k

Â·
 n âˆ’k
p, . . . , p



(nâˆ’k)/p

(p âˆ’1)!
 nâˆ’k
p
=

0â‰¤kâ‰¤n
p|(nâˆ’k)
n!
k! Â· p
nâˆ’k
p
.
For the coming problem, recall that a family F of subsets of In is an
intersecting system of In if, for all A, B âˆˆF, we have A âˆ©B Ì¸= âˆ….
9. The purpose of this problem is to prove the famous ErdÃ¶s-Ko-Rado theorem7:
for positive integers k and n, with 1 â‰¤k â‰¤n, if F is an intersecting system
formed by k-element subsets of In, then
|F| â‰¤
 n
k

, if k > n/2
nâˆ’1
kâˆ’1

, if k â‰¤n/2 .
To this end, do the following items:
7After the Hungarian, Chinese and German twentieth century mathematicians Paul ErdÃ¶s, Chao
Ko and Richard Rado, respectively.

2.4
Counting with Metrics
59
(a) If k > n
2, show that |F| â‰¤
n
k

.
(b) If k â‰¤
n
2, give an example of an intersecting system F of In, formed by
k-element subsets of In and such that |F| =
nâˆ’1
kâˆ’1

.
(c) Also in the case k â‰¤n
2, ï¬x an arbitrary intersecting system F of In, formed
by k-element subsets of In. Let Sn denote the set of permutations Ïƒ : In â†’
In, and Cn denote the set of circular permutations of In, so that |Sn| = n!,
|Cn| = (n âˆ’1)! and, for Ïƒ âˆˆSn, we have Ïƒ âˆˆCn, with |Ïƒ| = n (here,
and as in the text, Ïƒ stands for the equivalence class of Ïƒ with respect to the
equivalence relation deï¬ning circular permutations). Deï¬ne A âˆˆF and Ïƒ âˆˆ
Cn as being compatible provided A = {a1, . . . , ak}, for some permutation
(a1, . . . , ak, ak+1, . . . , an) âˆˆÏƒ.
i. For Ïƒ âˆˆSn, show that at most k sets in F are compatible with Ïƒ. Then,
conclude that there are at most (nâˆ’1)!k pairs (A, Ïƒ) with A âˆˆF, Ïƒ âˆˆSn
and A and Ïƒ compatible to each other.
ii. For a ï¬xed A âˆˆF, show that there are exactly k!(n âˆ’k)! elements
Ïƒ âˆˆCn such that A and Ïƒ are compatible. From this, conclude that there
are exactly k!(n âˆ’k)!|F| pairs (A, Ïƒ) such that A âˆˆF, Ïƒ âˆˆSn and A
and Ïƒ are compatible.
iii. Complete the proof of ErdÃ¶s-Ko-Rado theorem.
2.4
Counting with Metrics
In this section, we present a counting technique with a distinguished geometric
ï¬‚avor. To this end, we shall need the following important deï¬nition, which is
actually a concept pervasive to all of Mathematics.
Deï¬nition 2.23 If X is a nonempty set, a metric in X is a function d : X Ã—X â†’R
satisfying, for all x, y, z âˆˆX, the following conditions:
(a) d(x, y) = d(y, x).
(b) d(x, y) â‰¥0 and d(x, y) = 0 â‡”x = y.
(c) d(x, z) â‰¤d(x, y) + d(y, z).
The prototype of metric is the distance function in Euclidean space. More
precisely, letting E3 denote the three dimensional Euclidean space and d : E3 Ã—
E3 â†’R be given by
d(P, Q) = PQ, âˆ€P, Q âˆˆE3,
then conditions (a), (b) and (c) above are clearly satisï¬ed, condition (c) following
from the triangle inequality.
Thanks to the geometric example of the previous paragraph, from now on we
shall refer ourselves to condition (c) of Deï¬nition 2.23 as the triangle inequality.

60
2
More Counting Techniques
Another piece of terminology borrowed from that example is isolated in the next
deï¬nition.
Deï¬nition 2.24 Let d be a metric in the nonempty set X. Given x âˆˆX and r > 0,
the ball8 of center x and radius r is the subset B(x; r) of X, given by
B(x; r) = {y âˆˆX; d(y, x) â‰¤r}.
Back to the former example of metric, given P âˆˆE3 and r > 0 we have
B(P; r) = {Q âˆˆE3; PQ â‰¤r}
= solid sphere of center P and radius r.
Thus, at least at a heuristic level, this example justiï¬es the geometric intuition
attached to the name ball.
In what concerns Combinatorics, our primary interest relies in metrics deï¬ned
on ï¬nite nonempty sets. To understand why this is so, let us assume that X is such
a set and d is a metric on it. Further, suppose that x1, . . . , xk âˆˆX are such that the
union of the balls centered at those points and with some positive radius r cover X,
i.e., that
B(x1; r) âˆª. . . âˆªB(xk; r) = X.
(2.17)
If we have an upper bound on the number of elements of any ball of radius r in
X, say
|B(x; r)| â‰¤c(r), âˆ€x âˆˆX,
with c(r) > 0 depending only on r (and not on the chosen x âˆˆX), then (2.17)
gives us
|X| = |B(x1; r) âˆª. . . âˆªB(xk; r)|
â‰¤|B(x1; r)| + Â· Â· Â· + |B(xk; r)|
â‰¤k Â· c(r).
Therefore,
k â‰¥
1
c(r)|X|.
(2.18)
8The reader with previous acquaintance with the theory of Metric Spaces will notice that what we
call a ball is generally known in the literature as a closed ball. Nevertheless, in order to ease the
writing we will stick to this slightly different terminology. We believe that, as far as these notes are
concerned, this will be a harmless practice.

2.4
Counting with Metrics
61
Thus, an upper bound on the number of elements of any ball of radius r
automatically gives a lower bound on the number of balls of radius r needed to
cover X.
With such a general reasoning at our disposal, let us take a look at a ï¬rst relevant
example.
Example 2.25 Given n âˆˆN, let Sn be the set of sequences of n terms, all of which
equal to 0 or 1, i.e.,
Sn = {a = (a1, a2, . . . , an); ai = 0 or 1, âˆ€1 â‰¤i â‰¤n}.
Let d : Sn Ã— Sn â†’R be the function given, for a = (a1, . . . , an) and b =
(b1, . . . , bn) in Sn, by
d(a, b) = #{1 â‰¤i â‰¤n; ai Ì¸= bi}.
Then, d is a metric on Sn, called the Hamming metric9 on Sn.
Proof We clearly have d(a, b) â‰¥0 and d(a, b) = 0 if and only if a = b. It is also
clear that d(a, b) = d(b, a). In order to verify the triangle inequality, note that if
a, b âˆˆSn, then
d(a, b) =
n

i=1
|ai âˆ’bi|.
Therefore, for a, b, c âˆˆSn, the triangle inequality for real numbers gives
d(a, c) =
n

i=1
|ai âˆ’ci| â‰¤
n

i=1
(|ai âˆ’bi| + |bi âˆ’ci|)
=
n

i=1
|ai âˆ’bi| +
n

i=1
|bi âˆ’ci|
= d(a, b) + d(b, c).
âŠ“âŠ”
In the notations of the previous example, given a âˆˆSn and k âˆˆN, we have
B(a; k) = {b âˆˆSn; d(a, b) â‰¤k}
= {b âˆˆSn; ai Ì¸= bi for at most k indices 1 â‰¤i â‰¤n}.
9After the American mathematician of the twentieth century Richard Hamming, who used such
a concept to study coding problems in Computer Science and Telecommunications Engineering.
The famous Hamming codes were also named after him.

62
2
More Counting Techniques
However, since there are exactly
n
j

ways of choosing j indices 1 â‰¤i â‰¤n in which
the sequences a and b are to differ, we conclude that
|B(a; k)| =
n
0

+
n
1

+ Â· Â· Â· +
n
k

.
(2.19)
The above being said, the discussion that precedes the former example will give
the coming one.
Example 2.26 Let n âˆˆN and Sn be the set of sequences of n terms, all of which
equal to 0 or 1. Show that if we choose less than
2n
n
0

+
n
1

+ Â· Â· Â· +
n
k

sequences in Sn, then there will always be at least one sequence in Sn which differs
from each of the chosen ones in at least k + 1 distinct positions.
Proof Choose l distinct sequences in Sn, say x1, . . . , xl, with
l <
2n
n
0

+
n
1

+ Â· Â· Â· +
n
k
.
Then, (2.19) and computations analogous to those which led to (2.18) furnish
|B(x1; k) âˆª. . . âˆªB(xl; k)| â‰¤|B(x1; k)| + Â· Â· Â· + |B(xl; k)|
=
n
0

+
n
1

+ Â· Â· Â· +
n
k

l < 2n.
Now, the fundamental principle of counting gives |Sn| = 2n. Therefore, we
conclude from the last inequality above that the union of balls B(x1; k) âˆª. . . âˆª
B(xl; k) does not cover Sn. Hence, there exists at least one sequence x âˆˆSn such
that x /âˆˆB(xi; k), for 1 â‰¤i â‰¤l. But this is the same as saying that
d(x, xi) > k, âˆ€1 â‰¤i â‰¤l,
and the rest follows from the deï¬nition of the Hamming metric.
âŠ“âŠ”
Prior to presenting another relevant example, recall that, given sets X and Y, one
deï¬nes their symmetric difference as the set XY, given by
XY = (X âˆªY) \ (X âˆ©Y).
In words, XY is the set formed by the elements which belong to exactly one of the
sets X and Y.

2.4
Counting with Metrics
63
It follows promptly from the deï¬nition that Xâˆ…= X and XY = YX;
moreover, the reader can easily verify that
XY = (X \ Y) âˆª(Y \ X),
for all sets X and Y.
The following lemma gathers together other properties of the symmetric differ-
ence which will be of our interest.
Lemma 2.27 If X, Y and Z are any sets, then:
(a) XY = âˆ…â‡”X = Y.
(b) (XY)Z = X(YZ).
(c) XY = Z â‡”X = YZ.
Proof
(a) Since we clearly have XX = âˆ…, it sufï¬ces to show that XY = âˆ…â‡’X = Y.
To this end, observe that XY = âˆ…â‡’X âˆªY = X âˆ©Y and, hence,
X âŠ‚X âˆªY = X âˆ©Y âŠ‚Y;
similarly, Y âŠ‚X.
(b) It is not difï¬cult to verify that
(XY)Z = (X âˆªY âˆªZ) \ ((X âˆ©Y) âˆª(X âˆ©Z) âˆª(Y âˆ©Z)),
and analogously to X(YZ). We leave as an exercise to the reader the task
of checking the details.
(c) Let us show one implication, the other being completely analogous. If XY =
Z, it follows from item (b) that
X = âˆ…X = (YY)X = Y(YX) = YZ.
âŠ“âŠ”
With the above results at our disposal, we can ï¬nally present another important
example of metric in a family of ï¬nite sets, known as the metric of symmetric
difference.
Example 2.28 If F is a nonempty family of ï¬nite sets, then the function d : F Ã—
F â†’R, given by d(X, Y) = |XY|, is a metric in F.
Proof Since XY = YX, we have
d(X, Y) = |XY| = |YX| = d(Y, X)

64
2
More Counting Techniques
for all X, Y âˆˆF. It is also clear that d(X, Y) â‰¥0 and d(X, Y) = 0 if and only
if XY = âˆ…; however, by item (a) of the previous lemma, this last equality takes
place if and only if X = Y.
We are left to showing that d(X, Y) â‰¤d(X, Z) + d(Z, Y) for all X, Y, Z âˆˆF,
or, which is the same, that |XY| â‰¤|XZ| + |ZY|. To this end, since |A âˆªB| â‰¤
|A| + |B| for ï¬nite sets A and B, it is enough that we establish the inclusion
XY âŠ‚(XZ) âˆª(ZY).
In turn, such an inclusion follows at once from the equality
(XZ) âˆª(ZY) = (X âˆªY âˆªZ) \ (X âˆ©Y âˆ©Z),
whose proof we leave as an exercise to the reader.
âŠ“âŠ”
Fix m âˆˆN and consider the metric of symmetric difference in F = P(m), the
family of subsets of Im. If X âŠ‚Im is given, let us compute the number of subsets of
Im in the ball B(X; k), where k â‰¥0 is a given integer. To this end, start by noticing
that
Y âˆˆB(X; k) â‡”|XY| â‰¤k;
therefore, in order to count the number of elements in B(X; k), it sufï¬ces to count
how many are the subsets Y âŠ‚Im for which |XY| â‰¤k. For a ï¬xed Z âŠ‚Im, item
(c) of Lemma 2.27 guarantees the existence of a single Y âŠ‚Im such that Z = XY.
Hence,
{Y âˆˆP(m); |XY| â‰¤k} = {Z âˆˆP(m); |Z| â‰¤k}.
Finally, since for each 0 â‰¤j â‰¤k there are exactly
m
j

ways of choosing Z âŠ‚Im
such that |Z| = j, it follows from the equality of families above that
|B(X; k)| = #{Z âˆˆP(m); |Z| â‰¤k}
=
m
0

+
m
1

+ Â· Â· Â· +
m
k

.
(2.20)
For the coming example, let Pk(n) be the family of k-element subsets of In and
d be the metric of symmetric difference in Pk(n). For distinct X, Y âˆˆPk(n), we
have
d(X, Y) = |XY| = |X âˆªY| âˆ’|X âˆ©Y|
= |X| + |Y| âˆ’2|X âˆ©Y|
= 2(k âˆ’|X âˆ©Y|),
(2.21)
an even number.

2.4
Counting with Metrics
65
Example 2.29 (BMOâ€”Adapted) Let n > 2 be a given integer and F be a maximal
family of 3-element subsets of In satisfying the following condition: for any A, B âˆˆ
F, with A Ì¸= B, we have |A âˆ©B| â‰¤1. Prove that
|F| > 1
18(n2 âˆ’n).
Proof Let d be the metric of symmetric difference in P3(n). It follows from (2.21)
that, for X, Y âˆˆF,
|X âˆ©Y| â‰¤1 â‡”d(X, Y) â‰¥4.
We now claim that if F = {A1, . . . , Ak}, then
P3(n) = B(A1; 2) âˆª. . . âˆªB(Ak; 2).
(2.22)
Indeed, if this was not the case, then there would exist A âˆˆP3(n) \ (B(A1; 2) âˆª
. . . âˆªB(Ak; 2)), i.e., such that d(A; Ai) â‰¥4 for 1 â‰¤i â‰¤k. By what we did above,
this would be the same as having |A âˆ©Ai| â‰¤1 for 1 â‰¤i â‰¤k. In turn, this would
assure that Fâ€² = {A, A1, . . . , Ak} would be a family strictly containing F and also
satisfying the stated conditions. This contradicts the maximality of F.
Thus, it follows from (2.22) that
n
3

= |P3(n)| = |B(A1; 2) âˆª. . . âˆªB(Ak; 2)|
â‰¤|B(A1; 2)| + Â· Â· Â· + |B(Ak; 2)|.
(2.23)
Now, given A = {a, b, c} âˆˆP3(n), let us compute the number of sets in
B(A; 2) âŠ‚P3(n): recall that, for Aâ€² âˆˆP3(n), the distance d(Aâ€², A) is even;
therefore, (2.21) gives
d(Aâ€², A) â‰¤2 â‡”d(Aâ€², A) = 0 or 2
â‡”Aâ€² = A or |Aâ€² âˆ©A| = 2
â‡”Aâ€² = {a, b, c}, {a, b, x}, {a, c, x} or {b, c, x},
for some x âˆˆIn \ {a, b, c}. We then conclude that
|B(A; 2)| = 1 + 3(n âˆ’3) = 3n âˆ’8.
We ï¬nish by using (2.23) and the last computation above to obtain
k â‰¥
1
3n âˆ’8
n
3

= n(n âˆ’1)(n âˆ’2)
6(3n âˆ’8)
> n(n âˆ’1)(n âˆ’2)
6(3n âˆ’6)
= n(n âˆ’1)
18
.
âŠ“âŠ”

66
2
More Counting Techniques
Problems: Sect. 2.4
1. Prove that the Hamming metric is a particular case of the metric of symmetric
difference.
2. (Ireland) Let n â‰¥11 be an odd integer and T be the set of n-tuples (x1, . . . , xn)
such that xi âˆˆ{0, 1} for 1 â‰¤i â‰¤n. Given x = (x1, . . . , xn) and y =
(y1, . . . , yn) in T , let
f (x, y) = #{1 â‰¤i â‰¤n; xi Ì¸= yi}.
Suppose that there exists S âŠ‚T satisfying the following conditions:
(a) |S| = 2
n+1
2 .
(b) For each x âˆˆT , there exists a single y âˆˆS for which f (x, y) â‰¤3.
Prove that n = 23.
3. * Given an integer n > 3, let f (n) be the largest possible number of 4-element
subsets of In, such that any two of them have at most two elements in common.
Prove that
1
16
n
3

< f (n) â‰¤1
3
n
3

.
4. * Let n â‰¥2 be an integer and A1, . . . , Ak âŠ‚In be such that, for 1 â‰¤i < j â‰¤k,
we have |AiAj| â‰¥2r + 1, where r is a given positive integer. Prove that
k â‰¤
2n
n
0

+
n
1

+ Â· Â· Â· +
n
r
.
5. (India) Out of a committee of n members, 1997 distinct subcommittees are
composed. It is known that, for any two of these subcommittees, there are at
least ï¬ve people participating of exactly one of them. Prove that n â‰¥19.
6. (Brazil) During a summer camp, Arnold and Beatrice talked to each other using
smoke clouds, sometimes big ones, sometimes small ones. Every day before
breakfast, Arnold sent to Beatrice a sequence of 24 clouds. As Beatrice not
always manages to distinguish a small cloud from a big one, they composed a
dictionary before entering the camp. This dictionary collected n sequences of 24
sizes of clouds (for instance, one such sequence could be SBSBSBSBSBSBBS-
BSBSBSBSBS, where B stands for big and S stands for small). For each of the
n sequences, the dictionary indicated its meaning. Moreover, in order to prevent
misinterpretation, Arnold and Beatrice avoided including similar sequences in
the dictionary; more precisely, each two sequences in the dictionary always
differed in at least 8 of their 24 positions. Show that n â‰¤4096.

Chapter 3
Generating Functions
In this chapter we brieï¬‚y discuss the powerful method of generating functions, i.e.,
the use of power series in the analysis of counting problems that are inaccessible by
the more elementary techniques presented so far.
Unlike other approaches to this subject (e.g., that of the classic [41]), the material
collected here makes heavy use of the methods of Differential and Integral Calculus,
in the level of [3] or [8], for instance. Although working with convergent power
series apparently requires far more background than using formal power series, it
is actually much more complicated to rigorously justify the correctedness of some
algebraic manipulations with this last type of series. Furthermore, we believe that, in
a ï¬rst acquaintance with generating functions, the reader with some Calculus back-
ground feels much more comfortable in working in the realm of convergent power
series. Anyhow, for the readerâ€™s convenience Sect. 3.2 brieï¬‚y reviews the basic facts
on the convergence of power series needed for our subsequent discussions.
For a comprehensive exposition on the uses of generating functions in Combi-
natorics, we refer the interested reader to the above mentioned wonderful book of
professor H. Wilf.
3.1
Introduction
By deï¬nition, the (ordinary) generating function of a sequence (an)nâ‰¥0 of real
numbers1 is the power series

nâ‰¥0
anxn.
1We shall sometimes refer to the generating function of a sequence (an)nâ‰¥1 of real numbers, but
this should be no source of confusion.
Â© Springer International Publishing AG, part of Springer Nature 2018
A. Caminha Muniz Neto, An Excursion through Elementary Mathematics, Volume III,
Problem Books in Mathematics, https://doi.org/10.1007/978-3-319-77977-5_3
67

68
3
Generating Functions
Among all generating functions, one of the simplest ones is, in a certain sense,
that of the (sequence formed by the) nonnegative integers: 
nâ‰¥0 xn. As the reader
probably knows from earlier studies (cf. Section 7.4 of [8], for instance), such a
power series converges to
1
1âˆ’x when |x| < 1. Thus, for |x| < 1, we have
1
1 âˆ’x =

nâ‰¥0
xn,
(3.1)
and say that the series at the right hand side is a geometric series.
In order to illustrate the kind of use we have in mind for generating functions, we
consider in this section two preliminary examples. Their role is to give the reader an
easy glimpse on how the method works.
The ï¬rst example revisits Problem 7, page 49, and employs some elementary
facts on continuous functions, which can be reviewed in Chapter 8 of [8], for
instance.
Example 3.1 (TT) The set of natural numbers is partitioned into m inï¬nite and
nonconstant arithmetic progressions, of common differences d1, d2, . . . , dm. Prove
that
1
d1
+ 1
d2
+ Â· Â· Â· + 1
dm
= 1.
Proof Let f (x) = 
nâ‰¥1 xn be the generating function of the natural numbers.
Letting ai be the initial term of the arithmetic progression of common difference di,
the stated condition assures that, for |x| < 1, we have
f (x) =
m

i=1
(xai + xai+di + xai+2di + Â· Â· Â· ).
Hence, for |x| < 1, it follows from (3.1) (with xdi in place of x, in each series in the
sum at the right hand side above) that
x
1 âˆ’x =
m

i=1
xai
1 âˆ’xdi .
Multiplying both sides of this last equality by 1 âˆ’x and doing some algebra at the
right hand side, we get
x =
m

i=1
xai
1 + x + x2 + Â· Â· Â· + xdiâˆ’1 .
(3.2)

3.1
Introduction
69
Now, note that both sides of the equality above deï¬ne continuous functions in the
closed interval [0, 1], and our reasoning so far assures that such functions coincide
in the half-open interval [0, 1). Therefore (and it is precisely here where we use the
basic theory of continuous functions), they coincide also for x = 1, and evaluation
of (3.2) at x = 1 gives
1 =
m

i=1
1
di
.
âŠ“âŠ”
Our next example uses generating functions to obtain a positional formula for the
n-th Fibonacci number.
Example 3.2 Let (Fn)nâ‰¥1 be the Fibonacci sequence and f (x) = 
nâ‰¥1 Fnxn be its
generating function. For the time being, assume that the series deï¬ning f converges
on an open interval of the form (âˆ’r, r), for some real number r > 0 (we shall see,
in the paragraph following Proposition 3.7, that this is indeed the case). Then, we
can write
f (x) = F1x + F2x2 +

nâ‰¥3
Fnxn
= x + x2 +

nâ‰¥3
(Fnâˆ’1 + Fnâˆ’2)xn
= x + x2 + x

nâ‰¥3
Fnâˆ’1xnâˆ’1 + x2 
nâ‰¥3
Fnâˆ’2xnâˆ’2
= x + x2 + x(f (x) âˆ’F1x) + x2f (x)
= x + (x + x2)f (x),
thus getting
f (x) =
x
1 âˆ’x âˆ’x2
for x âˆˆ(âˆ’r, r).
Now, writing 1âˆ’x âˆ’x2 = (1âˆ’Î±x)(1âˆ’Î²x), with Î±, Î² âˆˆR, we have Î± +Î² = 1,
Î±Î² = âˆ’1 and
f (x) =
x
1 âˆ’x âˆ’x2 =
x
(1 âˆ’Î±x)(1 âˆ’Î²x).

70
3
Generating Functions
By imposing, without loss of generality, that Î± > Î², we get Î± = 1+
âˆš
5
2
and Î² =
1âˆ’
âˆš
5
2
, so that Î± âˆ’Î² =
âˆš
5. Thus,
f (x) =
1
âˆš
5

1
1 âˆ’Î±x âˆ’
1
1 âˆ’Î²x

.
By applying (3.1) (with Î±x and Î²x in place of x) to expand the right hand side
in power series, we get
f (x) =
1
âˆš
5
â§
â¨
â©

nâ‰¥0
(Î±x)n âˆ’

nâ‰¥0
(Î²x)n
â«
â¬
â­
=

nâ‰¥1
Î±n âˆ’Î²n
âˆš
5

xn.
It is important to point out that the discussion at the beginning of this section
guarantees that the geometric series involved in the above computations converge
for every x âˆˆR for which |Î±x|, |Î²x| < 1, i.e., for |x| <
1
|Î±|. Hence, letting s =
min

r, 1
|Î±|

> 0, it follows that

nâ‰¥1
Fnxn =

nâ‰¥1
Î±n âˆ’Î²n
âˆš
5

xn
(3.3)
for |x| < s. This way, if the power series representing f is unique, there will be no
alternative than to infer, from the last equality above, that
Fn = Î±n âˆ’Î²n
âˆš
5
(3.4)
for every n â‰¥1.
Finally, the uniqueness result we hinted to above is indeed true, and will be
explicitly stated in Corollary 3.6. This validates the last step above and shows
that (3.4) does hold.
Problems: Sect. 3.1
1. In the notations of Example 3.1, if a1, a2, . . . , am are the initial terms of the
progressions, prove that
a1
d1
+ a2
d2
+ Â· Â· Â· + am
dm
= m + 1
2
.

3.2
Power Series
71
2. The Lucas sequence (Ln)nâ‰¥1 is deï¬ned by L1 = 1, L2 = 3 and Lk+2 = Lk+1 +
Lk, for every integer n â‰¥1. Prove that:
(a) Ln = Î±n + Î²n for every n âˆˆN, where Î± = 1+
âˆš
5
2
and Î² = 1âˆ’
âˆš
5
2
.
(b) L2n = L2
n + 2(âˆ’1)nâˆ’1 for every n âˆˆN.
(c) L2
n âˆ’5F 2
n = 4(âˆ’1)n for every n âˆˆN, where (Fn)nâ‰¥1 denotes the Fibonacci
sequence.
3.2
Power Series
In order to justify and extend arguments like those of the two examples of the
previous section to more general situations, we shall review in this section some
facts on the convergence of general real power series. Since a thorough exposition
of the theory of real power series belongs more properly to the realm of basic real
analysis, we have chosen to be somewhat sketchy, referring the interested reader
to Chapter 11 of [8] for a more detailed account of the theory. Later, in Chap. 21,
extensions to complex power series will be discussed and applied.
Let r > 0 be a real number. We say that a function f : (âˆ’r, r) â†’R admits the
(power series) expansion
f (x) =

nâ‰¥0
anxn
in the interval (âˆ’r, r), or that the power series 
nâ‰¥0 anxn converges to f in the
interval (âˆ’r, r), if
f (x) =
lim
mâ†’+âˆ
m

n=0
anxn
for every x âˆˆ(âˆ’r, r).
A relevant example is that of the geometric series (3.1). As a corollary we note
that, for a given Î± Ì¸= 0, we have
1
1 âˆ’Î±x =

nâ‰¥0
Î±nxn
(3.5)
when |x| <
1
|Î±|. Indeed, if |x| <
1
|Î±|, then |Î±x| < 1, so that it sufï¬ces to apply (3.1)
to Î±x in place of x.

72
3
Generating Functions
We shall frequently need to combine the power series expansions of two given
functions to obtain that of another function, obtained from those by means of the
arithmetic operations of addition, subtraction or multiplication of functions. In this
respect, the very deï¬nition of convergence of power series assures that, if f (x) =

nâ‰¥0 anxn and g(x) = 
nâ‰¥0 bnxn along (âˆ’r, r), then
(f Â± g)(x) =

nâ‰¥0
(an Â± bn)xn
in (âˆ’r, r). Concerning multiplication, we have the following result.
Proposition 3.3 If the functions f, g : (âˆ’r, r) â†’R have power series expansions
f (x) = 
kâ‰¥0 akxk and g(x) = 
lâ‰¥0 blxl, then the function fg : (âˆ’r, r) â†’R
has power series expansion (fg)(x) = 
nâ‰¥0 cnxn, with
cn =

k+l=n
akbl =
n

k=0
akbnâˆ’k.
(3.6)
Thus, for |x| < 1 and letting ak = 1 for every k â‰¥0, we get from (3.1) that
1
(1 âˆ’x)2 =
1
1 âˆ’x Â·
1
1 âˆ’x =
â›
â
kâ‰¥0
akxk
â
â 
â›
â
lâ‰¥0
alxl
â
â 
=

nâ‰¥0
" n

k=0
akanâˆ’k
#
xn =

nâ‰¥0
" n

k=0
1
#
xn
=

nâ‰¥0
(n + 1)xn.
Moreover, such a reasoning can be easily generalized to give the power series
expansion for the function x â†’
1
(1âˆ’x)k , for |x| < 1 (cf. Problems 1 and 2, page 78).
For the purposes we have in mind, the main result on power series is the one
collected in the coming theorem.
Theorem 3.4 Let r > 0 be such that the power series 
nâ‰¥0 anxn converges at
every x âˆˆ(âˆ’r, r). If f : (âˆ’r, r) â†’R is given by f (x) = 
nâ‰¥0 anxn, then f is
differentiable, with f â€²(x) = 
nâ‰¥1 nanxnâˆ’1 for every x âˆˆ(âˆ’r, r).
In words, the previous theorem guarantees that we can termwise differentiate a
convergent power series, obtaining, as result, the power series corresponding to the
derivative of the function deï¬ned by the original series.

3.2
Power Series
73
Example 3.5 This example shows how to use the previous result to reobtain, for
|x| < 1, the power series expansion of the function x â†’
1
(1âˆ’x)2 . Since
1
1âˆ’x =

nâ‰¥0 xn for |x| < 1, differentiating both sides of such an equality we get
1
(1 âˆ’x)2 =

nâ‰¥1
nxnâˆ’1 =

nâ‰¥0
(n + 1)xn,
and this is also valid for x âˆˆ(âˆ’1, 1).
A very important corollary of Theorem 3.4 is the uniqueness of the power series
representing a certain function.
Corollary 3.6 If f
: (âˆ’r, r) â†’R admits a power series representation in
the interval (âˆ’r, r), then f is inï¬nitely differentiable. Moreover, its power series
representation is unique and is given by
f (x) =

nâ‰¥0
anxn,
with an = 1
n!f (n)(0), where f (n)(0) denotes the value of the n-th derivative of f at
0.
Proof Firstly, note that f (0) = a0. Now, the previous theorem gives us f â€²(x) =

nâ‰¥1 nanxnâˆ’1 in (âˆ’r, r); in particular, this gives f â€²(0) = a1. Again by the former
result, f â€² is differentiable and we get f â€²â€²(x) = 
nâ‰¥2 n(n âˆ’1)anxnâˆ’2, so that
f â€²â€²(0) = 2a2. Proceeding inductively this way, we easily ï¬nish the proof.
âŠ“âŠ”
The actual importance of Theorem 3.4 will completely reveal itself only if we
have at our disposal some criterion which allows one to establish the convergence
of a given power series 
nâ‰¥0 anxn in some open interval centered at 0. For our
purposes, the coming result, which is a particular case of the comparison test for
series, will sufï¬ce.
Proposition 3.7 Let (an)nâ‰¥0 be a sequence of real numbers. If there exist positive
reals c and M such that |an| â‰¤cMn for every n â‰¥0, then the power series

nâ‰¥0 anxn converges on the interval

âˆ’1
M , 1
M

.
Proof Since
|anxn| = |an||x|n â‰¤cMn|x|n = c|Mx|n
and (cf. (3.5)) the geometric series 
nâ‰¥0 |Mx|n converges when |x| <
1
M , the
comparison test for series assures that 
nâ‰¥0 anxn converges when |x| < 1
M .
âŠ“âŠ”
With the above proposition at hand, we are in position to complete the analysis
of Example 3.2. Indeed, letting (Fn)nâ‰¥1 denote the Fibonacci sequence, an easy
induction shows that Fn â‰¤2n for every n â‰¥1. Hence, by the previous result, the

74
3
Generating Functions
corresponding generating function, 
nâ‰¥1 Fnxn, converges whenever x âˆˆ

âˆ’1
2, 1
2

.
In turn, this assures that all computations made at that example are actually valid
whenever |x| < min

1
2, 1
|Î±|

=
1
2. In particular, we can use Corollary 3.6 to
conclude, from (3.3), that (3.4) does hold.
As Problem 5 will show, generating functions can be used to solve more general
second order linear recurrence relations. Actually, when we have complex
numbers at our disposal, we will completely analyse a much more general version
of this result, in Chap. 21.
Example 3.8 As a relevant application of the previous proposition in conjunction
with Theorem 3.4, let us show that
ex =

nâ‰¥0
1
n!xn
(3.7)
for every x âˆˆR.
We ï¬rst claim that, given A > 0, there exist Î± > 0 and n0 âˆˆN such that
n! > Î±An for every n > n0. Indeed, ï¬xed a natural number n0 > A we have, for
n > n0 also natural,
n! = n0! (n0 + 1) . . . (n âˆ’1)n



nâˆ’n0
> n0!Anâˆ’n0 = n0!
An0 An.
It thus sufï¬ces to take Î± = n0!
An0 .
Now, given A > 0, take Î± > 0 and n0 âˆˆN as above. Letting an = 1
n!, c = 1
Î± and
M = 1
A, we conclude that 0 < an < cMn for every natural number n > n0, and the
previous proposition assures that the power series

nâ‰¥0
1
n!xn =
n0

n=0
1
n!xn +

n>n0
1
n!xn
deï¬nes a function f : (âˆ’A, A) â†’R (note that 1
M = A).
However, since A > 0 was arbitrarily chosen, we conclude that f (x) =

nâ‰¥0
1
n!xn is actually deï¬ned in the whole real line R. Moreover, Theorem 3.4
guarantees that f is differentiable and such that
f â€²(x) =

nâ‰¥1
n Â· 1
n!xnâˆ’1 =

nâ‰¥0
1
n!xn = f (x)
for every x âˆˆR. In turn, this gives
d
dx

eâˆ’xf (x)

= 0, so that x â†’eâˆ’xf (x) is
constant in R. Evaluating at x = 0 then yields f (x) = ex for every x âˆˆR.

3.2
Power Series
75
For future use, we notice that changing x by ax in the equality of the previous
example, we get
eax =

nâ‰¥0
an
n! xn
(3.8)
for every x âˆˆR.
A variation of the argument used in Example 3.8 allows us to expand f (x) =
(1 + x)Î± in power series when |x| < 1 (and for a ï¬xed real number Î± Ì¸= 0).
To this end, given Î± âˆˆR and n âˆˆZ \ {0}, we begin by deï¬ning the generalized
binomial number
Î±
n

by letting
Î±
0

= 1 and, for n â‰¥1,
Î±
n

= Î±(Î± âˆ’1)(Î± âˆ’2) . . . (Î± âˆ’n + 1)
n!
.
(3.9)
Lemma 3.9 Given Î± âˆˆR and n âˆˆN, we have:
(a)
Î±
n

=
Î±âˆ’1
n

+
Î±âˆ’1
nâˆ’1

.
(b)
n
Î±
Î±
n

=
Î±âˆ’1
nâˆ’1

, for every Î± Ì¸= 0.
(c)
		Î±
n
		 â‰¤1 whenever |Î±| â‰¤1.
Proof
(a) Is an easy computation:
Î±
n

âˆ’
Î± âˆ’1
n

= 1
n!Î±(Î± âˆ’1)(Î± âˆ’2) . . . (Î± âˆ’n + 1)
âˆ’1
n!(Î± âˆ’1)(Î± âˆ’2) . . . (Î± âˆ’n)
= 1
n!(Î± âˆ’1)(Î± âˆ’2) . . . (Î± âˆ’n + 1)(Î± âˆ’(Î± âˆ’n))
=
1
(n âˆ’1)!(Î± âˆ’1)(Î± âˆ’2) . . . (Î± âˆ’n + 1)
=
Î± âˆ’1
n âˆ’1

.
(b) Follows immediately from (3.9).
(c) If |Î±| â‰¤1, it follows from (3.9) and the triangle inequality that
				
Î±
n
				 â‰¤|Î±|(|Î±| + 1)(|Î±| + 2) . . . (|Î±| + n âˆ’1)
n!
â‰¤1 Â· 2 Â· . . . Â· n
n!
= 1.
âŠ“âŠ”

76
3
Generating Functions
The coming result is usually referred to as the binomial series expansion or
Newtonâ€™s binomial theorem, and is due to Sir Isaac Newton.2
Theorem 3.10 (Newton)
For Î± Ì¸= 0 and |x| < 1, we have
(1 + x)Î± =

nâ‰¥0
Î±
n

xn.
(3.10)
Proof Let us ï¬rstly consider the case 0 < |Î±| â‰¤1. Since
		Î±
n

xn		 â‰¤|x|n (by item
(c) of the previous lemma) and 
nâ‰¥0 |x|n converges when |x| < 1, Proposition 3.7
assures that 
nâ‰¥0
Î±
n

xn converges when |x| < 1. Hence, thanks to Theorem 3.4
the function f : (âˆ’1, 1) â†’R, given by f (x) = 
nâ‰¥0
Î±
n

xn, is differentiable, with
f â€²(x) =

nâ‰¥1
n
Î±
n

xnâˆ’1 =

nâ‰¥1
Î±
Î± âˆ’1
n âˆ’1

xnâˆ’1
(3.11)
(note that we have used item (c) of the previous lemma in the last equality above).
The above expression for f â€²(x), together with item (a) of the referred lemma, gives
(1 + x)f â€²(x) = Î±(1 + x)

nâ‰¥1
Î± âˆ’1
n âˆ’1

xnâˆ’1
= Î±
â›
â
nâ‰¥1
Î± âˆ’1
n âˆ’1

xnâˆ’1 +

nâ‰¥1
Î± âˆ’1
n âˆ’1

xn
â
â 
= Î±
â›
â1 +

nâ‰¥2
Î± âˆ’1
n âˆ’1

xnâˆ’1 +

nâ‰¥2
Î± âˆ’1
n âˆ’2

xnâˆ’1
â
â 
= Î±
â›
â1 +

nâ‰¥2

Î±
n âˆ’1

xnâˆ’1
â
â 
= Î±

nâ‰¥0
Î±
n

xn = Î±f (x).
Therefore, letting g(x) = (1 + x)âˆ’Î±f (x), we get for |x| < 1 that
gâ€²(x) = âˆ’Î±(1 + x)âˆ’Î±âˆ’1f (x) + (1 + x)âˆ’Î±f â€²(x)
= (1 + x)âˆ’Î±âˆ’1{âˆ’Î±f (x) + (1 + x)f â€²(x)} = 0.
2As quoted in [8], Newton is considered to be one of the greatest scientists ever, being difï¬cult to
properly address the scope of his contributions to the development of science.

3.2
Power Series
77
In turn, this means that g is constant in the interval (âˆ’1, 1). However, since g(0) =
1, we get (1 + x)âˆ’Î±f (x) = 1 for |x| < 1, as wished.
For the general case, assume that (1 + x)Î± = 
nâ‰¥0
Î±
n

xn for some Î± Ì¸= 0 and
every x âˆˆ(âˆ’1, 1). We shall show that analogous formulas hold for Î± âˆ’1 and Î± + 1
(and every |x| < 1):
(a) For Î± âˆ’1: Theorem 3.4 gives, for |x| < 1,
(1 + x)Î±âˆ’1 = 1
Î± Â· d
dx (1 + x)Î± = 1
Î±

nâ‰¥1
n
Î±
n

xnâˆ’1
=

nâ‰¥1
Î± âˆ’1
n âˆ’1

xnâˆ’1 =

nâ‰¥0
Î± âˆ’1
n

xn.
(b) For Î± + 1: we have
(1 + x)Î±+1 = (1 + x)

nâ‰¥0
Î±
n

xn =

nâ‰¥0
Î±
n

xn +

nâ‰¥0
Î±
n

xn+1
= 1 +

nâ‰¥1
Î±
n

+

Î±
n âˆ’1

xn = 1 +

nâ‰¥1
Î± + 1
n

xn
=

nâ‰¥0
Î± + 1
n

xn.
A straightforward inductive argument now shows that (3.10) holds for every
Î± Ì¸= 0 and every |x| < 1.
âŠ“âŠ”
Corollary 3.11 For Î±, Î² Ì¸= 0, we have
(1 + Î²x)Î± =

nâ‰¥0
Î±
n

(Î²x)n,
for every x âˆˆR satisfying |x| <
1
|Î²|.
Proof It sufï¬ces to apply (3.10) for Î²x in place of x, observing that |Î²x| < 1 â‡”
|x| <
1
|Î²|.
âŠ“âŠ”
As an example of application of the former corollary, for |x| < 1
2 we have
(1 âˆ’2x)âˆ’1/2 =

nâ‰¥0
âˆ’1/2
n

(âˆ’2x)n,

78
3
Generating Functions
with
âˆ’1/2
n

= 1
n!

âˆ’1
2
 
âˆ’1
2 âˆ’1

. . .

âˆ’1
2 âˆ’n + 1

= (âˆ’1)n
n!
Â· 1
2 Â· 3
2 Â· 5
2 Â· Â· Â· 2n âˆ’1
2
= (âˆ’1)n
n!
Â·
(2n)!
2n Â· 2 Â· 4 Â· Â· Â· (2n)
= (âˆ’1)n
n!
(2n)!
2n Â· 2nn!
= (âˆ’1)n
4n
2n
n

.
Hence, for |x| < 1
2 we get
(1 âˆ’2x)âˆ’1/2 =

nâ‰¥0
1
2n
2n
n

xn,
(3.12)
an equality that will be quite useful in the analysis of Example 3.14.
Problems: Sect. 3.2
1. * Generalize the result of Proposition 3.3, showing that if f : (âˆ’r, r) â†’R has
power series expansion f (x) = 
nâ‰¥0 anxn, then, for k âˆˆN, we have f (x)k =

nâ‰¥0 cnxn, where
cn =

ai1ai2 . . . aik
and the sum extends over all k-tuples (i1, . . . , ik) of nonnegative integers
satisfying i1 + Â· Â· Â· + ik = n.
2. * Given k âˆˆN and |x| < 1, prove that
1
(1 âˆ’x)k =

nâ‰¥0
k + n âˆ’1
n

xn.
3. * The purpose of this problem is to show that the function f : (âˆ’1, 1) â†’R,
given by f (x) = log(1 + x), admits a power series expansion, as well as to get
such an expansion. To this end, do the following items:

3.2
Power Series
79
(a) If f (x) = 
nâ‰¥0 anxn, use Corollary 3.6 to conclude that a0 = 0 and an =
(âˆ’1)nâˆ’1
n
for n â‰¥1.
(b) Use Proposition 3.7, in conjunction with Theorem 3.4, to conclude that the
power series 
nâ‰¥1
(âˆ’1)nâˆ’1
n
xn deï¬nes a differentiable function g : (âˆ’1, 1) â†’
R.
(c) Show that gâ€²(x) =
1
1+x for every x âˆˆ(âˆ’1, 1); then, conclude that f (x) =
g(x) for every x âˆˆ(âˆ’1, 1).
4. * Let (an)nâ‰¥0 be a sequence of real numbers such that |an| â‰¤cMn, for some
c, M > 0 and every n â‰¥0.
(a) Use Proposition 3.7 to show that, for every x âˆˆ

âˆ’1
M , 1
M

, the power series

nâ‰¥0
an
n+1xn+1 converges.
(b) If f, F :

âˆ’1
M , 1
M

â†’R are given by f (x) = 
nâ‰¥0 anxn and F(x) =

nâ‰¥0
an
n+1xn+1, Theorem 3.4 assures that F â€² = f . Use this fact, together
with the Fundamental Theorem of Calculus, to show that
$ x
0

nâ‰¥0
antndt =

nâ‰¥0
an
n + 1xn+1,
i.e., that we can compute the integral of a function deï¬ned by a power series
by termwise integrating the corresponding series.
5. Given u, v âˆˆR, with v Ì¸= 0, let (an)nâ‰¥1 be such that ak+2 = uak+1 + vak for
every k â‰¥1. Moreover, assume that the equation x2 âˆ’ux âˆ’v = 0 has real roots3
Î± and Î².
(a) If Î± Ì¸= Î², show that an = AÎ±nâˆ’1 + BÎ²nâˆ’1 for every n â‰¥1, where A and B
are the solutions of the linear system
 A + B = a1
Î±A + Î²B = a2
.
(b) If Î± = Î², show that an = (A + Bn)Î±nâˆ’1 for n â‰¥1, where A and B are the
solutions of the linear system
A + B = a1
(A + 2B)Î± = a2
.
6. * For x âˆˆR \ Z, we deï¬ne the integer closest to x, denoted [x], as the single
integer n such that |x âˆ’n| < 1
2. In symbols,
n = [x] â‡”|x âˆ’n| < 1
2.
If n > 1 is an integer and dn denotes the number of derangements of In, prove
that dn =
%
n!
e
&
.
3Actually, as will be seen in Chap. 21â€”cf. also Problem 6, page 393â€”such a restriction is
unnecessary.

80
3
Generating Functions
3.3
More Examples
In this section, we look at some recursive problems through the eyes of generating
functions. Such examples were chosen with a twofold purpose: on the one hand, to
illustrate the diversity of situations to which the method developed in the previous
two sections can be applied; on the other, to work out some techniques which are
themselves applicable to other relevant settings.
Example 3.12 Compute, with the aid of generating functions, the number of
nonnegative integer solutions to the equation
a1 + a2 + Â· Â· Â· + ak = m,
where k and m are given natural numbers.
Solution Note that a1 + a2 + Â· Â· Â· + ak = m if and only if xa1xa2 . . . xak = xm.
Therefore, there are as many nonnegative integer solutions (a1, a2, . . . , ak) of the
given equation as there are ways of getting a summand xm in the product
f (x) = (1 + x + x2 + Â· Â· Â· )(1 + x + x2 + Â· Â· Â· ) . . . (1 + x + x2 + Â· Â· Â· )



k
(yet in another way, taking xa1 in the ï¬rst factor, xa2 in the second, . . . , xak in the
k-th factor, we get xm in the product). However, for |x| < 1 we have
f (x) =

1
1 âˆ’x
k
=
1
(1 âˆ’x)k =

nâ‰¥0
k + n âˆ’1
n

xn,
where, in the last equality, we applied the result of Problem 2 of the previous section.
Hence, the answer to our problem is the coefï¬cient of xm in the above series, i.e.,
k+mâˆ’1
m

(in turn, note that this agrees with the result of Problem 9, page 29.
âŠ“âŠ”
The method of generating functions is particularly useful in the study of
sequences (an)nâ‰¥0 satisfying recurrence relations more general than those treated
in the previous section. This is the case, for instance, for the sequence (an)nâ‰¥0
such that a0 = 1, a1 = âˆ’1 and an = âˆ’anâˆ’1
n
+ 2anâˆ’2 for n â‰¥2, since the
coefï¬cients of the recurrence relation are not constant. In this case, the idea is to
consider the corresponding generating function, say f (x) = 
nâ‰¥0 anxn, and to
follow the sequence of steps delineated below:
I. To use the initial values and the satisï¬ed recurrence relation to conclude that
the generating function converges on some interval of the form (âˆ’r, r), with
r > 0.
II. Again with the aid of the initial values and the given recurrence relation, to
perform appropriate operations with the series expansion of f in order to get a
closed form (i.e., a formula) for f (x).

3.3
More Examples
81
III. To expand in power series the formula for f (x) obtained in the previous step.
IV. To use the uniqueness of power series representation, given by Corollary 3.6, to
conclude that an is equal to the coefï¬cient of xn in the power series expansion
of step III.
Note that the steps just described are precisely those which were followed in
Example 3.2, the ï¬rst having been concluded right after Proposition 3.7. We shall
run through them once more, this time to solve the next example.
Example 3.13 Let (an)nâ‰¥0 be the sequence given by a0 = 1, a1 = âˆ’1 and
an = âˆ’anâˆ’1
n
+ 2anâˆ’2,
for every n â‰¥2. Compute an as a function of n.
Solution Let f (x) = 
nâ‰¥0 anxn be the generating function corresponding to the
given sequence.
Step I:
we shall try to apply the comparison test for power series, as given by
Proposition 3.7. More precisely, assuming that |anâˆ’2| â‰¤Î±nâˆ’2 and |anâˆ’1| â‰¤
Î±nâˆ’1, it comes from the triangle inequality, together with the given recurrence
relation, that
|an| â‰¤|anâˆ’1|
n
+ 2|anâˆ’2| â‰¤Î±nâˆ’1
n
+ 2Î±nâˆ’2.
Therefore, we shall have |an| â‰¤Î±n provided Î±nâˆ’1
n
+ 2Î±nâˆ’2 â‰¤Î±n, or, which is
the same,
Î±
n + 2 â‰¤Î±2.
Since this last inequality is true for Î± = 2 and every n â‰¥2, and since |a0| â‰¤20
and |a1| â‰¤21, it follows by induction that |an| â‰¤2n for every n â‰¥1. Hence,
Proposition 3.7 guarantees that f is deï¬ned and is differentiable in the open
interval

âˆ’1
2, 1
2

.
Step II:
writing the given recurrence relation as nan = âˆ’anâˆ’1+2nanâˆ’2 for n â‰¥2,
we have

82
3
Generating Functions
f â€²(x) =

nâ‰¥1
nanxnâˆ’1 = a1 +

nâ‰¥2
nanxnâˆ’1
= a1 +

nâ‰¥2
(âˆ’anâˆ’1 + 2nanâˆ’2)xnâˆ’1
= a1 âˆ’

nâ‰¥2
anâˆ’1xnâˆ’1 + 2x

nâ‰¥2
nanâˆ’2xnâˆ’2
= a1 âˆ’(f (x) âˆ’a0) + 2x
â›
â
nâ‰¥2
(n âˆ’2)anâˆ’2xnâˆ’2 + 2

nâ‰¥2
anâˆ’2xnâˆ’2
â
â 
= a1 + a0 âˆ’f (x) + 2x(f â€²(x) + 2f (x)).
However, since a1 + a0 = 0, we get f â€²(x) = (4x âˆ’1)f (x) + 2xf â€²(x) or, yet,
(2x âˆ’1)f â€²(x) = âˆ’(4x âˆ’1)f (x).
In order to integrate (i.e., to ï¬nd the solutions of) the above differential equation,
note ï¬rst that f is positive in some interval (âˆ’r, r), for some 0 < r â‰¤1
2 (this
comes from the fact that f (0) = a0 = 1 > 0 and f , being differentiable, is
continuous, hence has the same sign as f (0) in a suitable neighborhood of 0).
Thus, for |x| < r we can write
f â€²(x)
f (x) = âˆ’4x âˆ’1
2x âˆ’1 = âˆ’2 âˆ’
1
2x âˆ’1
and then, for |x| < r â‰¤1
2,
log f (x) = log f (t)
			
x
0 =
$ x
0
f â€²(t)
f (t) dt
= âˆ’
$ x
0

2 +
1
2t âˆ’1

dt
= âˆ’2x âˆ’1
2 log(1 âˆ’2x).
Hence, for |x| < r â‰¤1
2 we have
f (x) = eâˆ’2x(1 âˆ’2x)âˆ’1/2.
(3.13)
Step III:
ï¬rstly, recall that the power series expansion of eâˆ’2x is given by letting
a = âˆ’2 in (3.8), and is valid in the whole real line:
eâˆ’2x =

kâ‰¥0
(âˆ’2)k
k!
xk.

3.3
More Examples
83
Therefore, for f given as in (3.13) and |x| < r â‰¤1
2, it follows from (3.12) and
Proposition 3.3 that
f (x) =
â›
â
kâ‰¥0
(âˆ’2)k
k!
xk
â
â 
â›
â
lâ‰¥0
1
2l
2l
l

xl
â
â 
=

nâ‰¥0
" 
k+l=n
(âˆ’2)k
k!
Â· 1
2l
2l
l
#
xn
=

nâ‰¥0
" n

l=0
(âˆ’2)nâˆ’l
(n âˆ’l)! Â· 1
2l
2l
l
#
xn
=

nâ‰¥0
"
2n
n

l=0
(âˆ’1)nâˆ’l
4l(n âˆ’l)!
2l
l
#
xn.
Step IV:
comparing the previous expansion with f (x) = 
nâ‰¥0 anxn, we get
an = 2n
n

l=0
(âˆ’1)nâˆ’l
4l(n âˆ’l)!
2l
l

.
âŠ“âŠ”
In order to apply the circle of ideas discussed so far to counting problems of
recursive character, apart from the four steps previously listed one has to execute a
further one, namely: given a combinatorial problem in which one wants to compute,
as a function of n âˆˆN, the total number an of possible conï¬gurations, one has
to compute the initial values an and to get a recurrence relation satisï¬ed by the
sequence (an)nâ‰¥1. Let us carefully examine a relevant example.
Example 3.14 Compute, as a function of n â‰¥3, the number of distinct ways
of partitioning a convex n-gon into triangles, by drawing diagonals which do not
intersect in the interior of the polygon.
Solution Letting an be the number of partitions we wish to compute, it is clear that
a3 = 1. To obtain a recurrence relation valid for n â‰¥4, label the vertices of the
n-gon as A1, A2, . . . , An, consecutively and in the counterclockwise sense. There
are two possibilities:
(i) No diagonal departs from A1: hence, diagonal A2An must be drawn, so that we
are left to partitioning the convex (n âˆ’1)-gon A2A3 . . . An, with no diagonals
intersecting in its interior. The number of such partitions is, of course, anâˆ’1.
(ii) Diagonal A1Ak is drawn, for some 3 â‰¤k â‰¤n âˆ’1, but no diagonal A1Aj,
with j < k, is drawn: then, the partition of A1A2 . . . An induces partitions with
the stated property in the convex polygons A1A2 . . . Ak and A1AkAk+1 . . . An;
moreover, in the partition of A1A2 . . . Ak, no diagonal departs from A1.

84
3
Generating Functions
Conversely, given any partition of A1A2 . . . An with no diagonals intersecting in
its interior but some diagonal departing from A1, there exists a unique 3 â‰¤k â‰¤nâˆ’1
such that the partition under consideration comes from exactly one pair of partitions
of A1A2 . . . Ak and A1AkAk+1 . . . An as in the previous paragraph.
Now, if k = 3, there is exactly 1 way of partitioning A1A2A3; if 3 < k â‰¤
n âˆ’1, then arguing as in item (i) we conclude that there are exactly akâˆ’1 ways
of partitioning A1A2 . . . Ak with no diagonal departing from A1. A simple way of
unifying these possibilities is to set a2 = 1, and we shall make this convention
henceforth.
Since there are anâˆ’k+2 ways of partitioning A1AkAk+1 . . . An as desired,
success applications of the multiplicative and additive principles give exactly
nâˆ’1
k=3 akâˆ’1anâˆ’k+2 partitions of type (ii) for A1A2 . . . An.
Finally, taking both cases above into account (and recalling that a2 = 2), we
obtain the following recurrence relation for an, with n â‰¥4:
an = anâˆ’1 +
nâˆ’1

k=3
akâˆ’1anâˆ’k+2
=
n

k=3
akâˆ’1anâˆ’k+2
=
nâˆ’1

k=2
akanâˆ’k+1.
For what is to come, it is worth noting that the last expression above also makes
sense for n = 3, and that if we set a1 = 0 we can write it as
an =
n

k=1
akanâˆ’k+1, âˆ€n â‰¥3.
(3.14)
As far as we know, there is no simple way to establish the convergence, in some
open interval centered at 0, of the generating function 
nâ‰¥1 anxn corresponding
to the sequence (an)nâ‰¥1. Nevertheless, it is not difï¬cult for the reader to convince
himself/herself that the fulï¬llment of this step is unnecessary if we obtain, in the
end, a positional formula for an for which 
nâ‰¥1 anxn does converge in some open
interval centered at 0. We shall have more to say on this in a little while.
Back to the analysis of (3.14), note that the right hand side pretty much resembles
formula (3.6) for the coefï¬cients of the product of two convergent power series.
Therefore, setting f (x) = 
nâ‰¥1 anxn, we are led to compute f (x)2:
f (x)2 =
â›
â
kâ‰¥1
akxk
â
â 
â›
â
lâ‰¥1
alxl
â
â =

nâ‰¥2
" 
k+l=n
akal
#
xn
=

nâ‰¥2
"nâˆ’1

k=1
akanâˆ’k
#
xn =

nâ‰¥4
"nâˆ’1

k=1
akanâˆ’k
#
xn.

3.3
More Examples
85
Now, (3.14) gives anâˆ’1 = nâˆ’1
k=1 akanâˆ’k, so that the computations above give
f (x)2 =

nâ‰¥4
anâˆ’1xn = x

nâ‰¥3
anxn = x

f (x) âˆ’x2).
Putting g(x) = 
nâ‰¥0 an+2xn, we get f (x) = x2g(x), and it follows from the
equality above that
x4g(x)2 = x(x2g(x) âˆ’x2) = x3(g(x) âˆ’1),
i.e., xg(x)2 âˆ’g(x) + 1 = 0. Thus,
g(x) = 1 Â±
âˆš
1 âˆ’4x
2x
=
2
1 âˆ“
âˆš
1 âˆ’4x
,
and the fact that g(0) = a3 = 1 gives
g(x) = 1 âˆ’
âˆš
1 âˆ’4x
2x
=
2
1 +
âˆš
1 âˆ’4x
.
(Recall that we are assuming that the power series deï¬ning f â€”and, hence, gâ€”
converges in some open interval of the form (âˆ’r, r), for a certain r
>
0;
therefore, for the square roots above to represent real numbers we may assumeâ€”by
diminishing r, if necessaryâ€”that r < 1
4.)
Finally, we get from (3.12) and Lemma 3.9 that
g(x) = 1
2x
â›
â1 âˆ’

nâ‰¥0
1/2
n

(âˆ’4x)n
â
â 
= âˆ’1
2x

nâ‰¥1
1
2n
âˆ’1/2
n âˆ’1

(âˆ’4x)n
= âˆ’

nâ‰¥1
1
4n Â· (âˆ’1)nâˆ’1
4nâˆ’1
2(n âˆ’1)
n âˆ’1

(âˆ’4)nxnâˆ’1
=

nâ‰¥1
1
n
2(n âˆ’1)
n âˆ’1

xnâˆ’1 =

nâ‰¥0
1
n + 1
2n
n

xn.
Hence, letting Cn =
1
n+1
2n
n

for n â‰¥0, it follows from x2g(x) = f (x) =

nâ‰¥1 anxn that
an =
1
n âˆ’1
2(n âˆ’2)
n âˆ’2

= Cnâˆ’2
for n â‰¥3.

86
3
Generating Functions
At this point, rigorously speaking we do not know whether or not the above
formula does solve the problem under consideration, for, in order to obtain
it, we assumed the convergence of the power series 
nâ‰¥1 anxn in some open
interval centered at 0. Yet in another way, since we cannot guarantee a priori the
convergence of 
nâ‰¥1 anxn in some interval of the form (âˆ’r, r), with r > 0, the
whole process above is nothing but a heuristic reasoning that made us infer that
Cnâˆ’2 is, most likely, the correct value for an. Nevertheless, in order to conclude it
sufï¬ces to show that, letting a1 = 0, a2 = 1 and an = Cnâˆ’2 for n â‰¥3, we have
an = n
k=1 akanâˆ’k+1 for every n â‰¥3.
For what is left to do, let us start by showing that the power series 
nâ‰¥0 Cnxn
converges in some open interval centered at 0, which is quite easy: since
1
n + 1
2n
n

â‰¤
2n
n

â‰¤22n = 4n
for n â‰¥0, it sufï¬ces to apply Proposition 3.7 to conclude that the series converges
in the interval

âˆ’1
4, 1
4

. Thus, letting
g(x) =

nâ‰¥0
Cnxn =

nâ‰¥0
1
n + 1
2n
n

xn
and reverting the previous steps, we conclude that
g(x) = 1 âˆ’
âˆš
1 âˆ’4x
2x
and, hence, that xg(x)2 âˆ’g(x) + 1 = 0. Therefore, letting f (x) = x2g(x), we get
f (x) =

nâ‰¥2
Cn+2xn =

nâ‰¥1
anxn
and f (x)2 = x(f (x) âˆ’x2). Hence,
 
nâ‰¥1
anxn2
= x
 
nâ‰¥1
anxn âˆ’x2
,
an equality that, once expanded, furnishes for n â‰¥3 the desired recurrence relation,
an =
n

k=1
akanâˆ’k+1.
Thus, this shows that the sequence (an)nâ‰¥1 such that an = Cnâˆ’2 for n â‰¥3 is,
indeed, the only solution to our problem.
âŠ“âŠ”

3.3
More Examples
87
Yet with respect to the previous example, we say that
Cn =
1
n + 1
2n
n

,
(3.15)
n â‰¥0, is the n-th Catalan number.4 Since an = Cnâˆ’2, n â‰¥3, satisï¬es the
recurrence relation (3.14), it is immediate to verify that the sequence (Cn)nâ‰¥0
satisï¬es the recurrence relation
Cn =
nâˆ’1

k=0
CkCnâˆ’kâˆ’1,
(3.16)
which is then known as Catalanâ€™s recurrence relation. Problem 5 brings another
combinatorial situation modeled by Catalanâ€™s recurrence.
We close this chapter by using generating functions to present an alternative
proof to Example 5.27 of [8]. In order to do so, we shall need to recall two analytical
facts, collected below.
Lemma 3.15 The series 
nâ‰¥1
1
n2 and 
nâ‰¥1
(âˆ’1)nâˆ’1
n2
converge. Moreover,

nâ‰¥1
(âˆ’1)nâˆ’1
n2
= 1
2

nâ‰¥1
1
n2 .
Proof The convergence of the series is quite standard, and can be found in most
Calculus or Introductory Analysis texts (see, for instance, Example 7.39 and
Proposition 7.48 of
[8]). For what is left to do, it sufï¬ces to observe that, if
s = 
nâ‰¥1
1
n2 , then

nâ‰¥1
(âˆ’1)nâˆ’1
n2
=

nâ‰¥1
1
n2 âˆ’2

kâ‰¥1
1
(2k)2 = s âˆ’1
2

kâ‰¥1
1
k2 = s âˆ’s
2 = s
2.
âŠ“âŠ”
The proof of the second result we shall need is considerably more reï¬ned than
those of the other Calculus results used so far. Therefore, we shall limit ourselves
to state it, referring the interested reader to Theorem 8.2 of [33] or (for a guided
approach) to problem 7 of Section 11.3 of [8].
Lemma 3.16 Assume that the power series 
nâ‰¥0 anxn converges on the interval
(âˆ’1, 1). If the number series 
nâ‰¥0 an also converges, then
4After EugÃ¨ne Catalan, Belgian mathematician of the nineteenth century.

88
3
Generating Functions
lim
xâ†’1âˆ’

nâ‰¥0
anxn =

nâ‰¥0
an.
We can ï¬nally present the promised example. Apart from some details, we follow
Chapter 17 of [23].
Example 3.17 Let n > 1 be an integer and A = {a1, a2, . . . , an} be a set of n
positive integers, such that the sums of the elements of any two of its nonempty
subsets are distinct. Prove that
1
a1
+ 1
a2
+ Â· Â· Â· + 1
an
< 2.
Proof We ï¬rst claim that it is enough to prove that n
i=1
1
ai â‰¤2. Indeed, this being
the case, let Aâ€² = A âˆª{2N}, with 2N > a1 + Â· Â· Â· + an. The choice of N guarantees
that any two nonempty subsets of Aâ€² also have distinct sums of elements, so that
n

i=1
1
ai
<
n

i=1
1
ai
+ 1
2N â‰¤2.
For what is left to do, if 0 < x < 1, then, in the notations of the paragraph that
precedes Problem 12, page 22, the stated conditions assure that
k
i=1
(1 + xai) = 1 +

âˆ…Ì¸=SâŠ‚A
xÏƒ(S) â‰¤1 +

jâ‰¥1
xj =
1
1 âˆ’x .
Taking natural logarithms and invoking the result of Problem 3, page 78, we
successively get
k

i=1
log(1 + xai) â‰¤âˆ’log(1 âˆ’x)
and
k

i=1

xai âˆ’x2ai
2
+ x3ai
3
âˆ’Â· Â· Â·

â‰¤x + x2
2 + x3
3 + Â· Â· Â· ,
for 0 < x < 1. Dividing both sides above by x, we get the inequality
k

i=1

xaiâˆ’1 âˆ’x2aiâˆ’1
2
+ x3aiâˆ’1
3
âˆ’Â· Â· Â·

â‰¤1 + x
2 + x2
3 + Â· Â· Â· ,
which is valid on all of [0, 1).

3.3
More Examples
89
Now, ï¬x x âˆˆ(0, 1) and integrate the last inequality above on the interval (0, x)
to get
k

i=1
$ x
0

taiâˆ’1 âˆ’t2aiâˆ’1
2
+ t3aiâˆ’1
3
âˆ’Â· Â· Â·

dt â‰¤
$ x
0

1 + t
2 + t2
3 + Â· Â· Â·

dt
or, according to Problem 4, page 79,
k

i=1
1
ai

x âˆ’x2ai
22 + x3ai
32 âˆ’Â· Â· Â·

â‰¤x + x2
22 + x3
32 + Â· Â· Â· .
At this point, the simultaneous application of the ï¬rst part of Lemma 3.15 and
of Lemma 3.16 guarantee that, as x â†’1âˆ’, the limits of both left and right hand
sides above do exist and can be computed termwise. Hence, by taking those limits,
we conclude that
k

i=1
1
ai

1 âˆ’1
22 + 1
32 âˆ’Â· Â· Â·

â‰¤1 + 1
22 + 1
32 + Â· Â· Â· .
Finally, the second part of Lemma 3.15 furnishes
k

i=1
1
ai
â‰¤

jâ‰¥1
1
j2

jâ‰¥1
(âˆ’1)jâˆ’1
j2
= 2.
âŠ“âŠ”
Problems: Sect. 3.3
1. Use generating functions to solve the recurrence a1 = 2 and ak+1 = ak +(k+1),
for k â‰¥1.
2. The sequence (an)nâ‰¥0 is given by a0 = 1 and an+1 = 2an +n for n â‰¥0. In order
to compute an in terms of n, do the following items:
(a) Assuming that an â‰¤Î±n, conclude that an+1 â‰¤Î±n+1, provided Î±n(Î± âˆ’2) â‰¥
n. Then, show that an â‰¤3n for every n â‰¥0.
(b) Show that the generating function of (an)nâ‰¥0 converges in the interval

âˆ’1
3, 1
3

and is given by f (x) =
1âˆ’2x+2x2
(1âˆ’x)2(1âˆ’2x).
(c) Find real constants A, B and C such that

90
3
Generating Functions
1 âˆ’2x + 2x2
(1 âˆ’x)2(1 âˆ’2x) =
A
(1 âˆ’x)2 +
B
1 âˆ’x +
C
1 âˆ’2x .
(d) Expand each summand of the right hand side above as a power series to
conclude that an = 2n+1 âˆ’(n + 1) for n â‰¥0.
3. Given k, m âˆˆN, use generating functions to compute the number of integer
solutions of the equation a1 +a2 +Â· Â· Â·+ak = m, such that ai â‰¥1 for 1 â‰¤i â‰¤k.
4. Use generating functions to compute the number of nonnegative integer solutions
of the equation a1 + a2 + a3 + a4 = 20, satisfying a1 â‰¥2 and a3 â‰¤7.
5. A particle moves on the cartesian plane in such a way that from point (a, b) it can
go to either (a +1, b) or (a, b +1). Given n âˆˆN, let an be the number of distinct
ways the particle has to go from A0(0, 0) to An(n, n), without ever touching a
point (x, y) situated above the bisector of odd quadrants (i.e., one such point for
which y > x). In this respect, do the following items:
(a) Let Ak(k, k), with 0 â‰¤k < n. Prove that there are exactly akanâˆ’1âˆ’k distinct
trajectories for the particle in which Ak is the last point (before An) on the
line y = x.
(b) Conclude that an = nâˆ’1
k=0 akanâˆ’1âˆ’k and, hence, that an = Cn for n â‰¥1,
where Cn is the n-th Catalan number.
For the coming problem, the reader may ï¬nd it convenient to read again the
paragraph that precedes Example 1.15.
6. For n âˆˆN, we let an denote the number of partitions of n in natural summands,
none of which exceeds 3. The purpose of this problem is to compute an as a
function of n, and to this end do the following items:
(a) Show that, for |x| < 1, one has

nâ‰¥1
anxn =
1
(1 âˆ’x)(1 âˆ’x2)(1 âˆ’x3).
(b) Find a, b, c, d âˆˆR for which
1
(1 âˆ’x)(1 âˆ’x2)(1 âˆ’x3) =
a
(1 âˆ’x)3 +
b
(1 âˆ’x)2 +
c
1 âˆ’x2 +
d
1 âˆ’x3 .
(c) Conclude that
an =
â§
âªâªâªâªâªâªâ¨
âªâªâªâªâªâªâ©
1
6
n+2
2

+ 1
4(n + 1) + 7
12, if 6 | n
1
6
n+2
2

+ 1
4(n + 1) + 1
4, if 2 | n but 3 âˆ¤n
1
6
n+2
2

+ 1
4(n + 1) + 1
3, if 2 âˆ¤n but 3 | n
1
6
n+2
2

+ 1
4(n + 1), if 2, 3 âˆ¤n
.

3.3
More Examples
91
Let an count a certain number of conï¬gurations in terms of n âˆˆN. Up to
this point, we have tried to explicitly compute an with the aid of the ordinary
generating function 
nâ‰¥0 anxn of the sequence (an)nâ‰¥0. Nevertheless, there are
some instances in which is more adequate to invoke the exponential generating
function of (an)nâ‰¥0, i.e., the power series

nâ‰¥0
an
n! xn.
The remaining problems present a few such situations.
7. As in Example 2.5, let dn denote the number of distinct derangements of In.
The purpose of this problem is to use the exponential generating functions

nâ‰¥2
dn
n! xn to compute dn as a function of n. To this end, do the following
items:
(a) Given integers n â‰¥3 and 1 â‰¤k â‰¤n âˆ’1, let (a1, . . . , an) be a derangement
of {1, 2, . . . , n} for which an = k.
i. If ak = n, prove that there are exactly dnâˆ’2 such permutations.
ii. If ak Ì¸= n, prove that there are exactly dnâˆ’1 such permutations.
(b) Conclude from (a) that dn = (n âˆ’1)(dnâˆ’1 + dnâˆ’2) for n â‰¥3.
(c) Imposing that dk â‰¤k!Î±k for every k < n and some Î± > 0, show that dn â‰¤
n!Î±n if Î± â‰¥2. Then, conclude that the series 
nâ‰¥2
dn
n! xn converges on the
interval (âˆ’1
2, 1
2) and, hence, deï¬nes a differentiable function f : (âˆ’1
2, 1
2) â†’
R.
(d) Use the result of (b) to show that (1 âˆ’x)f â€²(x) = x(f (x) + 1).
(e) Since f (0) = 1
2, by taking an adequate real number 0 < r < 1
2, if needed,
we can assume that f (x) > 0 in (âˆ’r, r). Conclude that, in (âˆ’r, r), one has
d
dx log(f (x) + 1) = âˆ’1 +
1
1 âˆ’x .
(f) Deduce from (e) that f (x) = âˆ’1 +
1
1âˆ’x Â· eâˆ’x.
(g) Use (3.1), (3.8) and Proposition 3.3 to obtain
f (x) =

nâ‰¥1

n

l=0
(âˆ’1)l
l!

xn.
(h) Finally, compute dn as a function of n with the aid of (g) and Corollary 3.6.
In the previous problem, the convenience of the use of the exponential
generating function of (dn)nâ‰¥2 was mostly due (cf. item (c)) to the fact that

nâ‰¥2
dn
n! xn converges at some interval centered at 0, whereas 
nâ‰¥2 dnxn does
not. Nevertheless, in the coming two problems, the involved combinatorics will
compel us to use exponential, instead of ordinary, generating functions.

92
3
Generating Functions
8. We want to compute, in terms of n âˆˆN, the number sn of sequences of n terms,
all of which equal to 0, 1, 2 or 3 and having an even number of 0â€™s. To this end,
do the following items:
(a) Show that
sn =

n!
(2a0)!a1!a2!a3!,
the sum extending over all nonnegative values of a0, a1, a2, a3 such that
2a0 + a1 + a2 + a3 = n.
(b) Set s0 = 1 and conclude that 
nâ‰¥0
sn
n!xn is the exponential generating
function of
f (x) =

1 + x2
2! + x4
4! + Â· Â· Â·

1 + x
1! + x2
2! + Â· Â· Â·
3
.
(c) Show that f (x) = 1
2

e4x + e2x
, and hence that sn = 1
2

4n + 2n
.
9. One can also use exponential generating functions to compute the number of
surjective functions between two ï¬nite sets (cf. Example 2.6). To this end, given
m, n âˆˆN and ï¬nite sets A and B such that |A| = m and |B| = n, do the
following items:
(a) Show that the number of surjections f : A â†’B is equal to the number of
ways of distributing m distinct objects among n distinct boxes, in such a way
that no box remains empty.
(b) Conclude that the number of surjections f : A â†’B is given by

m!
a1!a2! . . . an!,
the above sum extending over all n-tuples (a1, . . . , an) of positive integers
such that a1 + Â· Â· Â· + an = m.
(c) If g(x) =

x + x2
2! + x3
3! + Â· Â· Â·
n
, use the result of Problem 1, page 78, to
show that the term corresponding to xm in the expansion of g is given by
 xa1
a1! Â· xa2
a2! Â· Â· Â· xan
an! ,
the above sum extending over all n-tuples (a1, . . . , an) of positive integers
such that a1 + Â· Â· Â· + an = m. Conclude that the number of desired surjective
functions is equal to the coefï¬cient of xm
m! in the expansion of g.
(d) Use (3.8) to show that
g(x) = (ex âˆ’1)n =
n

k=0
n
k

(âˆ’1)ke(nâˆ’k)x.

3.3
More Examples
93
Then, expanding e(nâˆ’k)x in power series with the aid of (3.8), conclude from
item (c) that the number of surjections we want to compute is equal to
n

k=0
(âˆ’1)k
n
k

(n âˆ’k)m.

Chapter 4
Existence of Conï¬gurations
Generally speaking, Combinatorics deals with two different kinds of problems:
those in which we want to count the number of distinct ways of making a certain
choice and those in which we want to make sure that some conï¬guration does
appear. In order to solve a problem of the ï¬rst kind above, we employ, among
others, the counting techniques discussed in the previous chapters. For the second
kind of problem, up to this moment we have not developed any idea that could be
systematically used. It is our purpose in this chapter to remedy this state of things. To
this end, we start by discussing the famous pigeonholeâ€™s principle of Dirichlet, along
with several interesting examples. Then we move on to some applications of the
principle of mathematical induction to the existence of conï¬gurations. The chapter
continues with the study of partial order relations, exploring Mirskyâ€™s theorem on
the relation between chains and anti-chains. We close the chapter by explaining how,
in some situations, the search for an adequate invariant or a semi-invariant can give
the ï¬nal outcome of certain seemingly random algorithms.
4.1
Pigeonholeâ€™s Principle
In its simplest version, pigeonholeâ€™s principle, also known as Dirichletâ€™s princi-
ple,1 can be stated as follows.
Proposition 4.1 (Pigeonholeâ€™s Principle I) If we distribute n pigeons into n âˆ’1
cages (the pigeonholes), then at least one cage will necessarily contain at least two
pigeons.
1After the German mathematician of the nineteenth century Gustav L. Dirichlet. Actually, we
shall have to wait until Sect. 7.2 (cf. Lemma 7.7) to appreciate the original problem that motivated
Dirichlet to introduce the pigeonhole principle.
Â© Springer International Publishing AG, part of Springer Nature 2018
A. Caminha Muniz Neto, An Excursion through Elementary Mathematics, Volume III,
Problem Books in Mathematics, https://doi.org/10.1007/978-3-319-77977-5_4
95

96
4
Existence of Conï¬gurations
Proof By contraposition, if each one of the n âˆ’1 cages was to contain at most one
pigeon, then we would have at most n âˆ’1 pigeons.
âŠ“âŠ”
As naive as it seems, the pigeonhole principle allows us to establish astonishing
consequences, as shown by the coming examples. In all that follows, we shall always
assume that the relation of getting acquainted to someone else is symmetric, i.e., if
A knows B, then B also knows A.
Example 4.2 There are n guests in a party. Show that we can always ï¬nd two of
them who, within the party, are acquainted with the same number of people.
Proof Firstly, note that each of the n guests is acquainted with at least 0 and at most
n âˆ’1 other ones within the party. Therefore, there are two cases to consider:
(i) Each guest knows at least one other person in the party: take n âˆ’1 rooms,
numbered from 1 to n âˆ’1, and put in room i all of the guests (if any) who
know exactly i other guests. Since we have n âˆ’1 rooms (the pigeonholes)
and n guests (the pigeons), Dirichletâ€™s principle assures that at least one room
will contain at least two people. By the way we have allocated the guests in
the rooms, these two guests know, within the party, the same number of other
people.
(ii) There exists at least one â€œguestâ€ who, actually, has no acquaintances within the
party: then, no guest knows all of the other n âˆ’1 people, so that, in this case,
we can number the rooms from 0 to n âˆ’2 and reason as in (i). Once more,
pigeonholeâ€™s principle guarantees that at least one of the rooms will contain at
least two people. Also as in (i), these two people know, within the party, the
same number of other people.
âŠ“âŠ”
Example 4.3 (IMO Shortlist) Each subset of the set {1, 2, . . . , 10} is painted with
one, our of n possible colors. Find the greatest possible value of n for which one
can always ï¬nd two distinct and nonempty sets A, B âŠ‚{1, 2, . . . , 10}, such that A,
B and A âˆªB are all painted with the same color.
Solution Let X = {1, 2, . . . , 10}. Given ten colors C1, C2, . . ., C10, let us paint the
k-element subsets of X with color Ck, for 1 â‰¤k â‰¤10. This way, given two distinct
and nonempty subsets A and B of X, there are two possibilities: either A and B
have different numbers of elements, and hence were painted with different colors,
or A and B have the same number of elements; in this second case, A âˆªB has more
elements than A and B, and thus was painted with a color different from that of A
and B. Therefore, we conclude that n â‰¤9.
Now, take only nine colors, and let Ai = {1, . . . , i} for 1 â‰¤i â‰¤10. Since
A1 âŠ‚A2 âŠ‚Â· Â· Â· âŠ‚A10
is a chain of ten distinct and nonempty subsets of X (the pigeons) but we have
only nine colors (the pigeonholes), Dirichletâ€™s principle assures the existence of

4.1
Pigeonholeâ€™s Principle
97
indices 1 â‰¤i < j â‰¤10 such that Ai and Aj are painted with a single color. Since
Ai âˆªAj = Aj, it sufï¬ces to let Ai = A and Aj = B to fulï¬ll the stated conditions.
Thus, the largest possible value of n is 9.
âŠ“âŠ”
There are several interesting generalizations of the pigeonhole principle, and the
coming result collects the one who is probably the most important of them. For what
is to come, recall (cf. the paragraph preceding Problem 7, page 41) that the integer
part of a real number x, denoted âŒŠxâŒ‹, is the greatest integer which is less than or
equal to x. Thus, if âŒŠxâŒ‹= n âˆˆZ, then n â‰¤x < n + 1. It is frequently useful to
write down such inequalities as
âŒŠxâŒ‹â‰¤x < âŒŠxâŒ‹+ 1.
(4.1)
Proposition 4.4 (Pigeonholeâ€™s Principle II) If n pigeons are distributed among k
different cages, then at least one cage will contain at least

nâˆ’1
k

+ 1 pigeons.
Proof Arguing once more by contraposition, let us suppose that each of the k cages
contains at most

nâˆ’1
k

pigeons. Then, altogether we have at most k

nâˆ’1
k

pigeons,
and it sufï¬ces to note that, by the left inequality in (4.1),
k
(n âˆ’1
k
)
â‰¤k
n âˆ’1
k

= n âˆ’1 < n.
âŠ“âŠ”
Let us examine a few other examples.
Example 4.5 Prove that, in any group of twenty people, at least three of them were
born in the same day of the week.
Proof Let the twenty people be the pigeons and the 7 days of the week be the cages.
Then, associate a person to a day of the week if he/she was born in that day. The
second version of the pigeonhole principle guarantees that at least one cage will
contain at least

20âˆ’1
7

+ 1 = 3 people. Thus, these three people were born in the
same day of the week.
âŠ“âŠ”
Example 4.6 (Leningrad2) Each 1 Ã— 1 square of a 5 Ã— 41 chessboard is painted
either red or blue. Prove that it is possible to choose three lines and three columns
of the chessboard so that the nine 1Ã—1 squares into which they intersect are painted
with the same color.
Proof Since we have used only two colors, the second version of the pigeonhole
principle implies that, in each column (of ï¬ve 1 Ã— 1 squares), one of the two colors
must occur at least âŒŠ5âˆ’1
2 âŒ‹+ 1 = 3 times. Call such a color dominant and, for each
2Former name of the Russian city of Saint Petersburg.

98
4
Existence of Conï¬gurations
of the 41 columns, take note of its dominant color. Since one out of the two colors
dominates in each of the 41 columns, by invoking once more the second version of
the pigeonhole principle we conclude that one of the two colors is the dominant one
in at least âŒŠ41âˆ’1
2 âŒ‹+ 1 = 21 columns. Assume, without loss of generality, that such
a color is red, and call a column as red if red is its dominant color. Then, choose 21
red columns and, in each of them, choose three 1 Ã— 1 red squares.
Notice that there are exactly
5
2

= 10 possible ways of choosing three of the
ï¬ve 1 Ã— 1 squares of each column. Therefore, out of the 21 red columns (and once
again from the second version of the pigeonhole principle), the three 1 Ã— 1 chosen
red squares occupy exactly the same positions in at least

21âˆ’1
10

+ 1 = 3 columns.
In other words, we have at least three columns having 1 Ã— 1 red squares in the
same set of three lines, and this is exactly what we were asked to prove.
âŠ“âŠ”
The next example uses an obvious generalization of the pigeonhole principle
for the case in which we have a ï¬nite number of cages and an inï¬nite number of
pigeons.
Example 4.7 (Bosnia) A set A of natural numbers is said to be good if, for some
n âˆˆN, the equation x âˆ’y = n has inï¬nitely many solutions (x, y) with x, y âˆˆA.
If N = A1 âˆªA2 âˆªÂ· Â· Â· âˆªA100, prove that at least one of the sets Ai is good.
Proof By the ï¬rst version of Dirichletâ€™s principle, out of each set of 101 natural
numbers (the pigeons), at least two will belong to a single one of the 100 sets A1,
A2, . . . , A100 (the cages). In particular, for each k âˆˆN, at least two of the 101 natural
numbers 101(k âˆ’1) + 1, 101(k âˆ’1) + 2, . . . , 101k, which we shall call xk and yk,
belong to a single one of the 100 sets A1, A2, . . . , A100.
Assume, without loss of generality, that xk > yk for each k. This way, we
obtain inï¬nitely many pairs x1 > y1, x2 > y2, . . . of natural numbers satisfying
the following conditions:
(i) the two numbers in each pair are in one of the sets A1, A2, . . . , A100;
(ii) 1 â‰¤xk âˆ’yk â‰¤100 for each k â‰¥1;
(iii) i > j â‡’xi > yi > xj > yj.
Looking at the integers k â‰¥1 as the pigeons and at the 100 sets A1, A2, . . . , A100
as the cages, we conclude (by the obvious generalization of the pigeonhole principle
alluded to above) that there exist an index 1 â‰¤m â‰¤100 and an inï¬nite set B âŠ‚N
such that
i âˆˆB â‡’xi, yi âˆˆAm.
We claim that Am is a good set. Indeed, since xi âˆ’yi âˆˆ{1, 2, 3, . . . , 100} for
each i âˆˆB, a further application of the obvious generalization of the pigeonhole
principle guarantees the existence of an integer 1 â‰¤n â‰¤100 and an inï¬nite set
C âŠ‚B such that
i âˆˆC â‡’xi âˆ’yi = n.

4.1
Pigeonholeâ€™s Principle
99
However, since i âˆˆC â‡’xi, yi âˆˆAm, we conclude from (iii) that the equation
x âˆ’y = n admits inï¬nitely many solutions in Am.
âŠ“âŠ”
As our next application of Dirichletâ€™s principle, we shall prove a particular case
of a famous result of the Hungarian mathematicians Paul ErdÃ¶s and Esther Szekeres
(cf. [15]), which is known in mathematical literature as ErdÃ¶s-Szekeres theorem
(for another proof of it, see Sect. 4.3).
Example 4.8 (ErdÃ¶s-Szekeres) Out of any sequence of n2 +1 distinct real numbers,
one can always ï¬nd a monotone subsequence of at least n + 1 terms.
Proof Let A = {x1, x2, . . . , xn2+1} be the set whose elements are the n2 + 1
terms of the given sequence, and assume that the given sequence does not possess
any increasing subsequence with at least n + 1 terms. Then, every increasing
subsequence starting at a certain x âˆˆA has at most n terms. Deï¬ne
f : A â†’{1, 2, . . . , n}
by letting f (x) = size of the largest increasing subsequence of the given sequence,
starting at x. Since A has n2 + 1 elements, the pigeonhole principle guarantees that
we should have at least
((n2 + 1) âˆ’1
n
)
+ 1 = n + 1
elements of A with the same image, say xi1, xi2, . . . , xin+1, with i1 < i2 < Â· Â· Â· <
in+1. If xij < xil for some 1 â‰¤j < l â‰¤n + 1, we would have f (xij ) > f (xil), for
we could enlarge an increasing sequence starting at xil by placing xij before it. But
since f (xij ) > f (xil) is impossible, we conclude that
xi1 > xi2 > Â· Â· Â· > xin+1.
Thus, we have found a decreasing subsequence of n + 1 terms.
âŠ“âŠ”
We end this section by presenting four additional examples which illustrate the
wide versatility of applications of Dirichletâ€™s principle.
Example 4.9 (South Korea) For each positive integer m, prove that there exist
integers a and b such that |a|, |b| â‰¤m and
0 < a + b
âˆš
2 â‰¤1 +
âˆš
2
m + 2 .
Proof Let A be the set of positive reals of the form a+b
âˆš
2, with 0 â‰¤a, b â‰¤m and
a and b not both equal to 0. Since x1 + y1
âˆš
2 = x2 + y2
âˆš
2, with x1, x2, y1, y2 âˆˆZ,
implies x1 = x2 and y1 = y2, we conclude, with the aid of the fundamental principle
of counting, that A has exactly (m + 1)2 âˆ’1 = m2 + 2m elements, the largest one
being m(1 +
âˆš
2).

100
4
Existence of Conï¬gurations
Let Î± = 1+
âˆš
2
m+2 , and Ij = ((j âˆ’1)Î±, jÎ±], with 1 â‰¤j â‰¤m2 + 2m. The union of
the Ijâ€™s is the interval (0, m(1 +
âˆš
2)], which contains A. If one of the elements of
A belongs to I1, there is nothing left to do. Otherwise, there will be left m2 +2mâˆ’1
intervals to contain all m2 + 2m elements of A, and the Dirichlet principle assures
that at least one of these intervals, say Ik, contains at least two elements of A, say
x1 + y1
âˆš
2 and x2 + y2
âˆš
2, with x1 + y1
âˆš
2 < x2 + y2
âˆš
2. Now, since Ik has length
Î±, we get
0 < (x2 âˆ’x1) + (y2 âˆ’y1)
âˆš
2 = (x2 + y2
âˆš
2) âˆ’(x1 + y1
âˆš
2) < Î±.
Finally, noticing that |x2 âˆ’x1|, |y2 âˆ’y1| â‰¤m, we conclude that it sufï¬ces to let
a = x2 âˆ’x1 and b = y2 âˆ’y1.
âŠ“âŠ”
The next example uses the existence part of the Fundamental Theorem of
Arithmetic (Theorem 6.43), together with the notation of congruence modulo 2
(cf. Example 2.21).
Example 4.10 (IMO) Let A be a set of 1985 positive integers, none of which has
a prime divisor larger than 26. Show that it is possible to ï¬nd four elements of A
whose product is a fourth perfect power.
Proof The given conditions assure that every x
âˆˆ
A is of the form x
=
2Î±1x3Î±2x . . . 23Î±9x, with Î±1, Î±2, . . . , Î±9 âˆˆZ+. Modulo 2, the number of distinct
9-tuples (Î±1, . . . , Î±9) is equal to 29 = 512 (for each exponent Î±ix is either odd or
even). Since 1985 > 512, pigeonholeâ€™s principle assures that we can choose x1, y1 âˆˆ
A such that Î±ix1 â‰¡Î±iy1(mod 2) for 1 â‰¤i â‰¤9. Hence, Î±ix1 + Î±iy1 â‰¡0(mod 2) for
1 â‰¤i â‰¤9, so that x1y1 = z2
1, for some z1 âˆˆN. Since 1985 âˆ’2 > 512, by
invoking Dirichletâ€™s principle once more, we can choose x2, y2 âˆˆA \ {x1, y1} such
that x2y2 = z2
2, for some z2 âˆˆN. Continuing this way, we obtain pairwise distinct
elements x1, y1, x2, y2, . . . , x513, y513 âˆˆA, with xjyj = z2
j for some zj âˆˆN and
every 1 â‰¤i â‰¤513.
Now, since the prime factorisations of z1, z2, . . . , z513 also contain only primes
less than 26 and 513 > 512, an additional application of the pigeonhole principle
guarantees the existence of indices 1 â‰¤k < l â‰¤513 such that zkzl = w2, for some
w âˆˆN. Hence,
xkykxlyl = z2
kz2
l = (zkzl)2 = (w2)2 = w4.
âŠ“âŠ”
Example 4.11 (IMO) Let x1, x2, . . . , xn be real numbers for which x2
1 + x2
2 + Â· Â· Â· +
x2
n = 1. Prove that, for every integer k â‰¥2, there exist integers a1, a2, . . . , an such
that at least one of which is nonzero, |ai| â‰¤k âˆ’1 for 1 â‰¤i â‰¤n and
|a1x1 + a2x2 + Â· Â· Â· + anxn| â‰¤(k âˆ’1)âˆšn
kn âˆ’1
.

4.1
Pigeonholeâ€™s Principle
101
Proof Firstly, if (a1, a2, . . . , an) is one of the kn sequences of integers satisfying
0 â‰¤ai â‰¤k âˆ’1 for 1 â‰¤i â‰¤n, then Cauchyâ€™s inequality (cf. Section 5.2 of [8], for
instance) gives
			
n

j=1
ajxj
			 â‰¤

n

j=1
a2
j
1/2
n

j=1
x2
j
1/2
â‰¤(k âˆ’1)âˆšn.
Now, subdivide interval [0, (k âˆ’1)âˆšn] into kn âˆ’1 disjoint subintervals,
each of which having length
(kâˆ’1)âˆšn
knâˆ’1 . Since there exist kn distinct sequences
(a1, a2, . . . , an) of integers, pigeonholeâ€™s principle guarantees that at least two of
such sequences, say (b1, b2, . . . , bn) and (c1, c2, . . . , cn), are such that both of the
sums n
i=1 bixi and n
i=1 cixi belong to a single one of those kn âˆ’1 subintervals.
Hence,
			
n

j=1
(bj âˆ’cj)xj
			 =
			
n

j=1
bjxj âˆ’
n

j=1
cjxj
			 â‰¤(k âˆ’1)âˆšn
kn âˆ’1
,
and it sufï¬ces to let ai = bi âˆ’ci for 1 â‰¤i â‰¤n.
âŠ“âŠ”
Our ï¬nal example is a problem with two parts, in which only the easiest one
makes use of Dirichletâ€™s principle. Nevertheless, insight from such a use gives a
valuable clue for an effective approach to the second part.
Example 4.12 (EKMC) Let k â‰¥3 and n be integers such that n >
k
3

. Prove that if
ai, bi, ci (1 â‰¤i â‰¤n) are 3n distinct real numbers, then one can ï¬nd at least k + 1
distinct numbers among the 3n sums ai + bi, ai + ci, bi + ci. Show also that this
claim is not necessarily true if n =
k
3

.
Proof By contradiction, assume that we have at most k distinct numbers among the
3n sums ai + bi, ai + ci, bi + ci, say x1, x2, . . . , xk.
Since ai + bi, ai + ci and bi + ci are pairwise distinct,
k
3

is the number of
3-element subsets of {x1, x2, . . . , xk} and n >
k
3

, we conclude that there exist
1 â‰¤i < j â‰¤n for which
{ai + bi, ai + ci, bi + ci} = {aj + bj, aj + cj, bj + cj}.
But it is not difï¬cult to verify that such an equality would imply that at least one
element of {ai, bi, ci} would be equal to at least one element of {aj, bj, cj}, which
is an absurd.
For a counterexample when n =
k
3

, we want to have only k distinct numbers
among the 3n numbers ai + bi, ai + ci, bi + ci, even though the 3n numbers ai,
bi, ci are still pairwise distinct. To this end, ï¬rst note that, by arbitrarily choosing k

102
4
Existence of Conï¬gurations
distinct real numbers x1, x2, . . . , xk, we can form n =
k
3

subsets of {x1, x2, . . . , xk},
of three elements each, and choose an arbitrary bijection between the sets

ai + bi, ai + ci, bi + ci; 1 â‰¤i â‰¤n =
k
3

and
{xr + xs + xt; 1 â‰¤r < s < t â‰¤k}.
Once we have done that, we would have, for 1 â‰¤i < j â‰¤n,
ai + bi = xÎ±i, ai + ci = xÎ²i, bi + ci = xÎ³i
and
aj + bj = xÎ±j , aj + cj = xÎ²j , bj + cj = xÎ³j ,
where 1 â‰¤Î±i, Î±j, Î²i, Î²j, Î³i, Î³j â‰¤k are such that Î±i, Î²i, Î³i are pairwise distinct,
the same happening with Î±j, Î²j, Î³j.
Facing each of the two 3-tuples of equalities above as a linear system of
equations, we can compute ai, bi, ci (resp. aj, bj, cj) in terms of xÎ±i, xÎ²i, xÎ³i (resp.
xÎ±j , xÎ²j , xÎ³j ), getting three distinct numbers in each case (for xÎ±i, xÎ²i, xÎ³iâ€”resp.
xÎ±j , xÎ²j , xÎ³j â€”are pairwise distinct).
Therefore, the central point to the construction of a counterexample is that we
ought to have
{ai, bi, ci} âˆ©{aj, bj, cj} = âˆ…
or, which is the same,
{xÎ±i + xÎ²i âˆ’xÎ³i, xÎ±i + xÎ³i âˆ’xÎ²i, xÎ²i + xÎ³i âˆ’xÎ±i}
and
{xÎ±j + xÎ²j âˆ’xÎ³j , xÎ±j + xÎ³j âˆ’xÎ²j , xÎ²j + xÎ³j âˆ’xÎ±j }
to be disjoint.
It is thus enough to show that it is possible to choose x1, x2, . . . , xk in such a way
that
xr + xs âˆ’xt Ì¸= xu + xv âˆ’xw

4.1
Pigeonholeâ€™s Principle
103
whenever r, s, t and u, v, w are two 3-tuples of distinct integers of the interval [1, k],
with {r, s, t} Ì¸= {u, v, w}. Since we may have t âˆˆ{u, v} or w âˆˆ{r, s}, a possible
choice is to take
x1 = 21, x2 = 23, x3 = 25, . . . , xk = 22kâˆ’1.
The uniqueness of binary representation of naturals (cf. Section 4.1 of [8], for
instance) assures that the above conditions will be satisï¬ed, even if we have
t âˆˆ{u, v} or w âˆˆ{r, s}.
âŠ“âŠ”
Problems: Sect. 4.1
1. We mark at random ï¬ve points inside a square of side length 2. Show that it is
always possible to ï¬nd two of these ï¬ve points whose distance from one another
is at most
âˆš
2.
2. Show that if we choose 800 points inside a cube of edge length 10, at least one
of the line segments determined by two of these points will have length less
than 2.
3. Let x âˆˆR and n be an integer greater than 1. Show that, among the numbers x,
2x, . . ., (n âˆ’1)x, there is at least one whose distance from an integer is at most
1
n.
The coming problem brings yet another useful version of the pigeonhole
principle. In words, it says that at least one of a number of given pigeonholes
will contain at least as much pigeons as their average value.
4. * We are given n pigeonholes and a positive integer m. We place a1 pigeons in
the ï¬rst pigeonhole, a2 pigeons in the second, . . . , an pigeons in the n-th. If
a1 + a2 + Â· Â· Â· + an
n
â‰¥(resp. >) m,
prove that at least one of the pigeonholes will contain at least, m (resp. m + 1)
pigeons.
5. The natural numbers from 1 to 15 are distributed around a circle. Show that it
is always possible to ï¬nd ï¬ve consecutive numbers whose sum is greater than
or equal to 40.
6. We are given two equal disks A and B, each of which is divided into 200 equal
sectors, which, in turn, are painted either black or white. In disk A, there are
100 white sectors and 100 black sectors, in an unknown order. In disk B, we do
not know how many sectors are white. Prove that it is possible to place disk A
directly above disk B in such a way that at least 100 sectors of disk A lie above
sectors of disk B, whose colors match theirs.

104
4
Existence of Conï¬gurations
The next eight problems use elementary facts on the notion of divisibility of
integers. Before trying to solve them, the reader might ï¬nd it convenient to run
through the statements of the deï¬nitions and results of Chap. 6.
7. Prove that in any set of 52 integers, there exist at least two whose sum or
difference is a multiple of 100.
8. Prove that every natural number has a nonzero multiple whose decimal
representation contains solely the digits 0 and 1.
9. (TT) Prove that every natural number has a multiple whose sum of digits is odd.
10. Show3 that, if a and n are relatively prime natural numbers, then at least one of
the numbers a, a2, . . ., anâˆ’1 leaves remainder 1 upon division by n.
11. We are given a set A = {a1, a2, . . . , an}, of n > 1 positive integers. Prove
that there exist natural numbers k and l such that 1 â‰¤k â‰¤l â‰¤n and the sum
ak + ak+1 + Â· Â· Â· + al is a multiple of n.
12. Show that, by arbitrarily choosing n+1 elements from I2n, we shall necessarily
choose two such that one divides the other.
13. (Iran) Let A be a set of 33 natural numbers, each of which has all of its prime
factors among the prime numbers 2, 3, 5, 7, 11. Prove that there exist two
distinct elements of A whose product is a perfect square.
14. (Russia) We have chosen 15 pairwise relatively prime elements from the set
{1, 2, . . . , 1998}. Prove that at least one of the 15 chosen elements is necessarily
a prime number.
15. Given a set A of ten positive integers of two digits each, prove that it is always
possible to obtain two nonempty disjoint subsets of A having the same sum of
elements.
16. (India) A set of real numbers is free of sums provided no two of its elements
(not necessarily distinct) are such that their sum equals another element of the
set. Find the greatest number of elements that a free of sums set may have,
knowing that it is a subset of A = {1, 2, 3, . . . , 2n + 1}.
17. Show that, by choosing n + 1 elements from the set {1, 2, . . . , 3n}, we have
necessarily chosen two elements x and y such that xy + 1 or 4xy + 1 is a
perfect square.
18. For each positive integer n, ï¬nd the least positive integer f (n) such that, for
every partition of the set {1, 2, . . . , f (n)} into n sets, there exist integers a â‰¥0
and 1 â‰¤x â‰¤y for which a + x, a + y and a + x + y all belong to a single one
of the n sets of the partition.
19. (USA)
(a) Each 1 Ã— 1 square of a 3 Ã— 7 chessboard is painted either white or black.
Prove that, independently of the way we have painted the squares, there
will always be four squares of the same color, which are the corner squares
of a rectangle with sides parallel to those of the chessboard.
3Let Ï•(n) denote expression (2.7), deduced at Problem 6, page 40, and let a âˆˆZ be relatively
prime with n. In Sect. 10.2, we shall prove a theorem of L. Euler which assures that aÏ•(n) always
leave remainder 1 upon division by n (in the language of Sect. 2.3, aÏ•(n) â‰¡1(mod n)).

4.2
Induction and Existence of Conï¬gurations
105
(b) Exhibit a way of painting the squares of a 4 Ã— 6 chessboard so that the
condition of item (a) is never satisï¬ed.
20. (IMO) Seventeen people discuss one of three possible subjects by letter. More
precisely, each two of the seventeen people exchange a letter in which exactly
one of the three possible subjects is touched upon. Prove that there are three of
them who exchange letters on the same subject.
4.2
Induction and Existence of Conï¬gurations
In this section, we examine some examples that illustrate how mathematical
induction can be used, in combinatorial situations, to establish the existence of
conï¬gurations possessing certain properties. We assume from the reader a thorough
acquaintance with the principle of induction, referring to Section 4.1 of [8] for
an elementary exposition of the necessary background. In particular, most often
we shall not write formal inductive proofs, i.e., sometimes initial cases will not be
checked and induction hypotheses will not be explicitly stated.
Example 4.13 (Germany) Given n âˆˆN, prove that one can assemble a square of
side length 2n by using one square piece of side length 1 and several L-triminoes,
i.e., pieces of the shape below, where each small square has side length equal to 1:
Proof We shall use induction on n to show that each square of side length 2n can be
assembled as required, with the square piece of side length 1 occupying a corner of
the 2n Ã— 2n square.
For n = 1, the assembling is immediate, as shown in the ï¬gure below:
By induction hypothesis, assume that every square of side length 2k can be
assembled as prescribed. For the inductive step, take a 2k+1 Ã— 2k+1 square and
divide it into four squares of side length 2k, as shown in the ï¬gure below. Then,
place an L-trimino in the center of the larger square, so that it occupies one square

106
4
Existence of Conï¬gurations
of side length 1 in three of the four squares of side length 2k. Finally, place the 1Ã—1
square piece in the corner of the 2k+1 Ã— 2k+1 square that belongs to the square of
side length 2k which was not intersected by the L-trimino already placed.
2k+1
2k+1
The placement of these two pieces has the effect of letting each of the four
squares of side length 2k with exactly one corner occupied by a square piece of
side length 1. Hence, induction hypothesis assures that we can ï¬nish the assembling
of each one of these four squares by using L-triminoes only, and taking these lets us
conclude that the same is true for the 2k+1 Ã— 2k+1 square (with the square piece of
side length 1 placed in one of its corners).
âŠ“âŠ”
As one should expect, the coming example shows that, sometimes, strong
induction is in force.
Example 4.14 (Leningrad) List all nonempty subsets of the set {1, 2, . . . , n} which
do not contain consecutive elements. For each one of them, compute the square of
the product of its elements. Prove that the sum of all of these numbers is equal to
(n + 1)! âˆ’1.
Proof As was anticipated above, we shall make strong induction on n â‰¥1.
If n = 1, the only nonempty subset of {1} is itself, so that the required sum is
1 = 2! âˆ’1.
By induction hypothesis, suppose that, for 1 â‰¤n â‰¤k, the desired sum is equal
to (n + 1)! âˆ’1. Now, notice that the nonempty subsets of {1, 2, . . . , k + 1} without
consecutive elements can be divided in two categories:
(i) the nonempty subsets of {1, 2, . . . , k} without consecutive elements;
(ii) the sets of the form Aâˆª{k +1}, where A is a subset of {1, 2, . . . , k âˆ’1} without
consecutive elements.
The induction hypothesis guarantees that the sum of the squares of the products
of the elements of the sets of type (i) equals (k + 1)! âˆ’1, while that of the sets of
type (ii) equals (k + 1)2(k! âˆ’1) + (k + 1)2 (the summand (k + 1)2 corresponding
to the set {k + 1} = âˆ…âˆª{k + 1}).

4.2
Induction and Existence of Conï¬gurations
107
Hence, the sum of the squares of the products of the elements of all desired
subsets of {1, 2, . . . , k + 1} equals
(k + 1)! âˆ’1 + (k + 1)2(k! âˆ’1) + (k + 1)2 =
= (k + 1)! âˆ’1 + (k + 1)2 Â· k!
= (k + 1)! âˆ’1 + (k + 1)!(k + 1)
= (k + 1)!(k + 2) âˆ’1
= (k + 2)! âˆ’1.
âŠ“âŠ”
We now give two examples that show that an inductive argument can compose
just part of the analysis of a certain combinatorial situation.
Example 4.15 (Russia) Let n > 1 be an odd integer. In open ï¬eld, n children are so
positioned that, for each one of them, the distances to the other n âˆ’1 children are
pairwise distinct. Each child has a water pistol and, at the sound of a whistle, ï¬res
at the child closest to him/her. Show that at least one child will remain dry.
Proof Firstly, let us look at the case n = 3. Let A, B and C be the children and
assume, without loss of generality, that AB < BC < AC. Then, A ï¬res at B and B
at A, so that C remains dry.
Now, assume that whenever 2k âˆ’1 children (k > 1) are positioned in open ï¬eld
as prescribed in the statement of the problem, at least one of them remains dry. We
then consider 2k + 1 children, also positioned as required by the problem. Since the
distances between pairs of children are pairwise distinct, there exist two children,
say A and B, such that the distance between them is the smallest one of all distances
between two of the given children. Thus, A ï¬res at B and vice-versa. Discarding A
and B, we are left with 2k âˆ’1 children, and there are two distinct possibilities:
(i) One of these 2k âˆ’1 children ï¬res at A or B: in this case, at most 2k âˆ’2 shots
are ï¬red towards some of the remaining 2k âˆ’1 children (except A and B). By
the pigeonhole principle, at least one of them remains dry.
(ii) None of the remaining 2k âˆ’1 children ï¬res at A or B: by induction hypothesis,
at least one of these 2k âˆ’1 children remains dry.
âŠ“âŠ”
Example 4.16 (IMO Shortlist) We wish to write one of the numbers 0, 1 or 2 in
each entry of a table of 19 lines and 86 columns, in such a way that the following
conditions are satisï¬ed:
(a) Each column has exactly k zeros.
(b) For any two chosen columns, there exists a line such that the two entries of this
line situated at the chosen columns are, in some order, equal to 1 and 2.
Find all values of k for which this is possible.

108
4
Existence of Conï¬gurations
Solution We say that a set of m lines distinguishes n columns if, for any choice of
two of these n columns, it is possible to choose one of the m lines in such a way that
the entries of this line situated in the two chosen columns are equal to 1 and 2, in
some order.
We claim that m lines distinguish at most 2m columns. Indeed, it is clear that
a single line can distinguish at most two columns. Now, assume that j lines
distinguish at most 2j columns. Then, since a single line distinguishes at most
two columns, j + 1 lines will distinguish at most two groups of 2j columns (the
distinction made by the (j + 1)-th line between the two groups of 2j columns is a
permutation of the pattern
11 . . . 1
  
2j
22 . . . 2
  
2j
.
Hence, j + 1 lines will distinguish at most 2j + 2j = 2j+1 columns.
Back to the given table, since 86 > 26, the above claim assures that we need
at least 7 lines to distinguish all of the 86 columns. On the other hand, 7 lines will
sufï¬ce, for 86 < 27. Actually, it sufï¬ces to choose 86 distinct sequences of 7 terms,
each of which equal to 1 or 2, and fulï¬ll the ï¬rst 7 lines with the terms of these 86
sequences. The remaining lines can be randomly fulï¬lled.
Therefore, we must have 0 â‰¤k â‰¤19 âˆ’7 = 12.
âŠ“âŠ”
For the coming example, recall that, given n âˆˆN, we let In = {1, 2, . . . , n}. Also
recall that, given sets A and B, their symmetric difference AB is given by
AB = (A âˆªB) \ (A âˆ©B).
Example 4.17 (Argentina) Given n âˆˆN, let Pn be the family of all subsets of In. If
f : Pn â†’In is any function, show that there exist distinct A, B âˆˆPn and such that
f (A) = f (B) = max(AB).
Proof For n = 1, we have f : {âˆ…, {1}} â†’{1} and âˆ…{1} = {1}, so that
f (âˆ…) = f ({1}) = 1 = max({1}).
Suppose that the statement is true for n = k, and take a function f : Pk+1 â†’
Ik+1. There are two cases to consider:
(i) f maps all sets in Pk to elements of Ik: in this case, it sufï¬ces to apply the
induction hypothesis to the restriction of f to Ik.
(ii) There exists A âˆˆPk such that f (A) = k + 1: let F âŠ‚Pk+1 be the family of
the elements of Pk+1 containing k + 1, i.e.,
F = {X âˆª{k + 1}; X âˆˆPk}.

4.2
Induction and Existence of Conï¬gurations
109
We look at two subcases:
â€¢
there exists B âˆˆF such that f (B) = k + 1: then, k + 1 âˆˆB \ A, so that
A Ì¸= B, k + 1 âˆˆAB and
f (A) = f (B) = k + 1 = max(AB).
â€¢
f maps F into Ik: let g : Pk â†’Ik be given by setting g(X) = f (Xâˆª{k+1}),
for every X âˆˆPk. By induction hypothesis, there exist distinct Aâ€², Bâ€² âˆˆPk,
such that
g(Aâ€²) = g(Bâ€²) = max(Aâ€²Bâ€²).
Since (Aâ€²âˆª{k+1})(Bâ€²âˆª{k+1}) = Aâ€²Bâ€², we conclude that f (Aâ€²âˆª{k+1})
and f (Bâ€² âˆª{k + 1}) are both equal to max

(Aâ€² âˆª{k + 1})(Bâ€² âˆª{k + 1})

,
with Aâ€² âˆª{k + 1} Ì¸= Bâ€² âˆª{k + 1}.
âŠ“âŠ”
We ï¬nish this section by revisiting Problem 17, page 31, this time with the aid of
mathematical induction.
Example 4.18 (Saint Petersburgâ€”Adapted) We are given 2n + 1 points on a circle,
such that no two of them are the endpoints of a diameter. Prove that, among all
triangles having three of the given points as their vertices, at most
1
6n(n + 1)(2n + 1)
of them are acute.
Proof For n = 1 there is nothing to do, since three points on a circle determine
exactly one triangle.
By induction hypothesis, assume that the problem is true when n = k âˆ’1, for
some integer k â‰¥2. Then, let n = k, so that we have 2k + 1 points on the circle.
Out of them, take all pairs of points such that the chord joining them leaves k points
in one arc and k âˆ’1 points in the other arc of the circle. Among all such pairs of
points, let A and B be two such that AB is at minimum distance from the center O
of the circle (if there is more than one pair of points with this property, choose any
one of them).
Now, there are three kinds of acute triangles having vertices at three of the 2k +1
given points:
(i) Those having A and B as two of their vertices: since O must belong to the
interior of such a triangle, and AB leaves k points at one side and k âˆ’1 points
at the other side, there are at most k such triangles.
(ii) Those having A or B, but not both of them, as one of their vertices: let C and
D be the other two vertices of such an acute triangle (so that the third one is
either A or B). We consider two subcases:

110
4
Existence of Conï¬gurations
â€¢
C and D are at the same side of AB: if ACD was to be acute, then AC or
AD would leave B and O at different half-planes. In turn, this would assure
that the distance from AC or AD to O would be less than the distance of
AB to O, thus contradicting our choice of A and B. Therefore, ACD is not
acute and, accordingly, the same is true of BCD.
â€¢
C and D are in opposite sides with respect to AB: since ACBD is convex,
at most one of the triangles ACD or BCD contains the center O, and hence
at most one of such triangles is acute. On the other hand, by the choice of A
and B the set {C, D} can be chosen in exactly k(k âˆ’1) ways, and this is the
largest possible number of acute triangles of this kind.
(iii) Those having neither A nor B as one of their vertices: by induction hypothesis,
there are at most 1
6(k âˆ’1)k(2k âˆ’1) such triangles.
Adding the contributions of the three cases above, we conclude that the number
of acute triangles having its vertices at three of the 2k + 1 given points is at most
k + k(k âˆ’1) + 1
6(k âˆ’1)k(2k âˆ’1) = 1
6k(k + 1)(2k + 1).
âŠ“âŠ”
Problems: Sect. 4.2
1. (India) Prove that, for every n â‰¥6, every square can be partitioned into n other
squares.
2. (Brazil) Given a natural number n > 1, we write a real number of modulus less
than 1 in each cell of an n Ã— n chessboard, in such a way that the sum of the
numbers written in the four cells of any 2 Ã— 2 square is equal to 0. If n is odd,
show that the sum of the numbers written in the n2 cells is less than n.
3. (TT) Point O is situated in the interior of the convex polygon A1A2 . . . An.
Consider all of the angles Ì¸ AiOAj, with distinct 1 â‰¤i, j â‰¤n. Prove that at
least n âˆ’1 of them are not acute.
4. (TT) In a convex polygon P some diagonals were drawn, such that no two of
them intersect in the interior of P. Show that there are at least two vertices of P
such that none of the traced diagonals is incident to none of these two vertices.
5. (Hungary) In an n Ã— n chessboard we have a certain number of towers (at most
one tower for each 1Ã—1 square). A tower can move from one square to another
if and only if these two squares belong to a single line or column of the board
and there are no other towers in between. On the other hand, if two towers
belong to a single line or column and there are no other towers in between, then
we say that any of these towers can attack the other. Prove that one can paint the
towers with one of three colors in such a way that no tower can attack another
tower of the same color.

4.3
Partially Ordered Sets
111
6. We are given n distinct lines in the plane. Prove that it is possible to paint the
regions into which these lines divide the plane of black or white, so that if two
regions share a common edge, then they have distinct colors.
7. (TT) Each square of a chessboard is painted either red or blue. Prove that the
squares of one of these two colors are such that a chess queen can move through
all of them (possibly passing more than once through one or more of the 1 Ã— 1
squares of this color), without visiting a single square of the other color. We
recall that a chess queen can move an arbitrary number of squares along any
line, column or diagonal of the chessboard.
8. We are given n points in the plane, not all of which being collinear. Prove that:
(a) There exists at least one line that passes through exactly two of these n
points.
(b) The n points determine at least n distinct lines.
The result of item (a) is known as the Sylvester-Gallai theorem,4 while that of
item (b) is due to ErdÃ¶s and de Bruijn.5
9. In the plane we are given 2n points in general position, i.e., such that no three
of them are collinear. If n of the given points are blue and the other n are red,
prove that it always possible to draw n line segments satisfying the following
conditions:
(a) Each line segment joins a blue point to a red point.
(b) They do not intersect each other.
10. (OCS) Prove that, given a positive integer n, there exists another positive integer
kn with the following property: given any set of kn points in space, no four of
them being coplanar, and associating an integer number from 1 to n to each line
segment joining two of these kn points, one necessarily gets a triangle having
vertices at three of the kn points and such that the numbers associated to its
sides are all equal.
4.3
Partially Ordered Sets
This short section discusses a few facts on partially ordered sets, focusing on the
theorems of Mirsky6 (cf. [30]) and Dilworth7 (cf. [14]). As a corollary of Mirskyâ€™s
theorem, we obtain another proof of ErdÃ¶s-Szekeres theorem. Dilworthâ€™s theorem,
in turn, will be applied to Graph Theory in Problem 25, page 134.
4James Sylvester, English mathematician, and Tibor Gallai, Hungarian mathematician, both of the
twentieth century.
5Nicolaas de Bruijn, Dutch mathematician of the twentieth century.
6After Leon Mirsky, Russian mathematician of the twentieth century.
7After Robert Dilworth, American mathematician of the twentieth century.

112
4
Existence of Conï¬gurations
We start by presenting the concept of partially ordered set, together with some
examples. In the coming deï¬nition, âª¯denotes a relation on the set A, i.e., a subset
of the cartesian product A Ã— A.
Deï¬nition 4.19 We say that a nonempty set A is partially ordered by âª¯, or that
(A, âª¯) is a partially ordered set, if the following conditions are satisï¬ed, for all
a, b âˆˆA:
(a) (Reï¬‚exivity) a âª¯a.
(b) (Antisymmetry) a âª¯b and b âª¯a â‡’a = b.
(c) (Transitivity) a âª¯b and b âª¯c â‡’a âª¯c.
In this case, we also say that âª¯is a partial order relation in A.
In the notations of the previous deï¬nition, âª¯must be thought of as a way of
comparing elements of A. This being said, note that we are not demanding that âª¯
provides a way of comparing any two elements of A; in other words, it may well
happen that there exist a, b âˆˆA such that a Ì¸âª¯b and b Ì¸âª¯a (i.e., such that a âª¯b
and b âª¯a are both false). If this is so, then we say that a and b are incomparable
(via âª¯); otherwise, a and b are said to be comparable.
If âª¯is a partial order relation on A for which any two elements of A are
comparable, we say that âª¯is a total order relation, or simply a total order. We
also say that (A, âª¯) is a totally ordered set.
It is time that we take a look at a few relevant examples of order relations. We
refer to Problem 1 for details.
Example 4.20
(a) The set of real numbers is totally ordered by the order relation âª¯, deï¬ned by
a âª¯b â‡”a â‰¤b. In this case, we say that â‰¤is the usual order in R.
(b) Let X be a nonempty set and F = P(X) be the family of all subsets of X. For
Y, Z âˆˆF (i.e., Y, Z âŠ‚X), we deï¬ne Y âª¯Z â‡”Y âŠ‚Z. It is immediate to
verify that (F, âª¯) is a partially ordered set, which is usually denoted simply by
writing (P(X), âŠ‚). In this case, we say that âŠ‚is the inclusion relation in X.
(c) Given a, b âˆˆN, recall that a | b (one reads â€œa divides bâ€) if there exists c âˆˆN
such that b = ac. Letting âª¯be deï¬ned on N by a âª¯b â‡”a | b, it is also
straightforward that (N, âª¯) is a partially ordered set. In view of this example,
one frequently says that N is partially ordered by the divisibility relation.
(d) Let A be a nonempty set partially ordered by âª¯. If B âŠ‚A is nonempty, the
restriction of âª¯to elements of B turns it into another partially ordered set. In
this case, we say that B is partially ordered by the order relation induced from
A.
If (A, âª¯) is a partially ordered set and a, b âˆˆA, we write a â‰ºb to mean that
a âª¯b and a Ì¸= b. As we indicated before, we write a Ì¸âª¯b to mean that a âª¯b is
false. For what we have in mind, the coming deï¬nition is central.

4.3
Partially Ordered Sets
113
Deï¬nition 4.21 Let A be a nonempty set ordered by âª¯. With respect to âª¯, a
nonempty subset B of A is:
(a) A chain if, for every a, b âˆˆB, we have either a âª¯b or b âª¯a.
(b) An antichain if, for every a, b âˆˆB, we have a Ì¸âª¯b and b Ì¸âª¯a.
In words (and in the above notations), B is a chain if, furnished with the order
relation induced from A, is a totally ordered set. On the other hand, B is an antichain
if any two of its elements are incomparable by âª¯.
Example 4.22 Let N be partially ordered by the divisibility relation. Letting P =
{2, 3, 5, 7, 11, . . .} denote the set of prime numbers, it will be proved in Sect. 6.3
that P is inï¬nite. Thus, P is an inï¬nite antichain on N, whereas {2, 2Â·3, 2Â·3Â·5, . . .}
is an inï¬nite chain.
Example 4.23 If X = {a1, a2, . . . , am} is a set with m elements, then, ordering
F = P(X) with respect to inclusion, the family
G = {âˆ…, {a1}, {a1, a2}, {a1, a2, a3} . . . , {a1, a2, . . . , am}}
is a chain. Actually, F does not contain longer chains. In order to prove this assume,
by the sake of contradiction, that
C = {A1 âŠ‚A2 âŠ‚. . . âŠ‚Am+2}
is a chain on F, formed by m + 2 distinct subsets of X. Then, since |Ai| âˆˆ
{0, 1, 2, . . . , m} for 1 â‰¤i â‰¤m + 2, the pigeonhole principle assures that there
exist 1 â‰¤i < j â‰¤m + 2 for which |Ai| = |Aj|. In turn, together with Ai âŠ‚Aj,
this gives Ai = Aj, which is an absurd.
On the other hand, it is immediate to verify that, for each integer 0 â‰¤k â‰¤m, the
family
Fk = {Y âŠ‚X; |Y| = k}
is an antichain in F (note that F0 = {âˆ…}). Furthermore, note that
F = F0 âˆªF1 âˆª. . . âˆªFm.
We are ï¬nally in position to state and prove Mirskyâ€™s theorem, which is a direct
generalization of the situation described in the above example. For the proof of it,
if (A, âª¯) is a partially ordered set and B = {a1 âª¯a2 âª¯. . . âª¯am} is a chain in
A formed by m distinct elements, then we say that B has length m and am is its
maximum element.
Theorem 4.24 (Mirsky)
Let (A, âª¯) be a partially ordered set. If A does not
possess chains of length n + 1, then A can be written as the union of at most n
antichains.

114
4
Existence of Conï¬gurations
Proof Let us make induction on n, noticing ï¬rstly that, if A does not possess chains
of length 2, then A is itself an antichain, and the theorem is trivially true. By
induction hypothesis, suppose that each partially ordered set which does not posses
chains of length k can be written as a union of at most k âˆ’1 antichains.
Let (A, âª¯) be a partially ordered set which does not possess chains of length
k + 1. Deï¬ne B as the subset of A formed by the maximum elements of the chains
of maximum length in A. We ï¬rst claim that B is an antichain with respect to âª¯. By
contradiction, suppose that there existed x, y âˆˆB such that x â‰ºy. Since x âˆˆB, we
can ï¬nd a chain C in A, of maximum length and whose maximum element is x; but
then, C âˆª{y} would be a chain in A, with maximum element y and longer than C,
which is an absurd.
Now, note that (A \ B, âª¯) does not have chains of length k. Indeed, if C was
such a chain in (A\B, âª¯), then, since A does not possess chains of length k +1, the
chain C would be one of maximum length in A. Therefore, the maximum element
of C would belong to B, which is a contradiction.
By applying the induction hypothesis to A\B, we conclude that it can be written
as the union of at most k âˆ’1 antichains. Finally, adjoining B to such a collection of
antichains, we write A as the union of at most (k âˆ’1) + 1 = k antichains.
âŠ“âŠ”
As we mentioned before, we now obtain the ErdÃ¶s-Szekeres theorem as a
corollary of Mirskyâ€™s theorem. Actually, the following version generalizes that of
Example 4.8.
Theorem 4.25 (ErdÃ¶s-Szekeres)
If a, b âˆˆN and n = ab+1, then every sequence
(x1, . . . , xn), of distinct real numbers, either possess an increasing subsequence of
a + 1 terms or a decreasing subsequence of b + 1 terms.
Proof Deï¬ne A = {(i, xi); 1 â‰¤i â‰¤n} and let âª¯be the relation in A given by
(i, xi) âª¯(j, xj) â‡”(i = j) or (i < j and xi < xj).
It is immediate to verify that âª¯is a partial order in A, and that
(i1, xi1) â‰º(i2, xi2) â‰ºÂ· Â· Â· â‰º(ik, xik)
is a chain in A if and only if (xi1, . . . , xik) an increasing subsequence of
(x1, . . . , xn). Accordingly, for 1 â‰¤i1 < i2 < Â· Â· Â· < ik â‰¤n,
{(i1, xi1), (i2, xi2), . . . , (ik, xik)}
is an antichain in A if and only if (xi1, . . . , xik) is a decreasing subsequence in
(x1, . . . , xn). Indeed, since ir < is for 1 â‰¤r < s â‰¤k and all of the xiâ€™s are distinct,
we get
(ir, xir) Ì¸âª¯(is, xis) â‡”xir < xis is false â‡”xir > xis.

4.3
Partially Ordered Sets
115
Now, assume that (x1, . . . , xn) does not contain an increasing sequence of a + 1
terms. Then, A does not have chains of length a+1, so that Mirskyâ€™s theorem assures
that A can be written as the union of l â‰¤a antichains, say A1, . . . , Al. However,
since
ab + 1 = n = |A| =
			
l
i=1
Ai
			 â‰¤
l
i=1
|Ai|,
it follows from the pigeonhole principle that, for some index 1 â‰¤i â‰¤l, we must
have
|Ai| â‰¥
(ab
l
)
+ 1 â‰¥b + 1.
âŠ“âŠ”
Problems: Sect. 4.3
1. * Check that all of the relations deï¬ned in Example 4.20 are, indeed, order
relations.
2. Let A be a set of n2 + 1 positive integers. Prove that there exists a subset B of A,
with n + 1 elements and satisfying one of the following conditions:
(a) For all a, b âˆˆB, either a | b or b | a.
(b) For all a, b âˆˆB, one has a âˆ¤b and b âˆ¤a.
3. State and prove a generalization of the ErdÃ¶s-Szekeres theorem for a partially
ordered ï¬nite set.
4. Let be given m, n âˆˆN and an m Ã—

n2m + 1

table of pairwise distinct real
numbers. Show that it is possible to choose n + 1 columns of the table such that
the m Ã— (n + 1) table composed by the chosen columns satisï¬es the following
condition: the numbers of each line, written from left to right, form an increasing
or decreasing sequence.
5. In a ï¬nite partially ordered set, let A and B be two chains having the greatest
possible lengths. If A âˆ©B Ì¸= âˆ…, prove that A and B have equal lengths.
For the next problem, if (A, âª¯) is a partially ordered set, we say that a âˆˆA is
a maximal element of A if the following condition is satisï¬ed:
a âª¯x, x âˆˆA â‡’a = x.
6. * The purpose of this problem is to Dilworthâ€™s theorem on partially ordered
sets: if a ï¬nite partially ordered set (A, âª¯) does not contain antichains of n + 1
elements, then A can be written as the union of n pairwise disjoint chains. To this
end, and arguing by induction on |A|, do the following items (cf. [19]):

116
4
Existence of Conï¬gurations
(a) Let a be a maximal element of A and assume, by induction hypothesis, that
A \ {a} contains an antichain B0 of k elements and can be written as the
union of k pairwise disjoint chains A1, . . . , Ak. Conclude that Ai âˆ©B0 Ì¸= âˆ…
for 1 â‰¤i â‰¤k.
(b) For 1 â‰¤i â‰¤k, let xi âˆˆAi be the maximum element of Ai belonging to an
antichain of k elements in A \ {a}. If B = {x1, x2, . . . , xk}, show that B is
an antichain.
(c) Assume that xi âª¯a for some 1 â‰¤i â‰¤k.
i. Let C = {a} âˆª{y âˆˆAi; y âª¯xi}. Show that A \ C contains an antichain
of k âˆ’1 elements but does not contain an antichain of k elements.
ii. Apply the induction hypothesis to A \ C and, then, conclude that A can
be written as the union of k pairwise disjoint chains.
(d) Assume that xi Ì¸âª¯a for every 1 â‰¤i â‰¤k. Show that:
i. B âˆª{a} is an antichain of k + 1 elements.
ii. A can be written as the union of k + 1 pairwise disjoint chains.
4.4
Invariants
In the combinatorial situations we discuss here, we generally consider algorithms8
involving somewhat random choices of entries, and try to study the set of possible
outcomes after a certain number of iterations. In this sense, a frequently fruitful
approach consists in trying to associate an invariant to the algorithm, i.e., a
mathematical object that behaves in a predictable way along each iteration of it,
independently of the chosen inputs.
Since there are no general rules that teach us which invariant should be associated
to each particular algorithmic situation, we shall limit ourselves here to examine
some interesting examples, in order to help the reader to grasp the general idea and
to prepare him/her for the posed problems.
Example 4.26 There are several + and âˆ’signs written on a blackboard. At each
second we can replace two signs by a single one, according to the following rule:
if the two erased signs are equal, we replace them by a + sign, whereas if they are
different, we replace them by a âˆ’sign. Show that, when just one sign is left on the
blackboard, it will not depend on the order we made the replacements.
8Formally, an algorithm is a ï¬nite sequence of well deï¬ned operations that, once performed on
some (more or less) arbitrary set of data (called the input of the algorithm), furnish a deï¬nite result,
called the outcome or output of the algorithm. On the other hand, each such performance of the
algorithm is generally referred to as an iteration of it. We shall encounter algorithms several times
along these notes.

4.4
Invariants
117
Solution By the sign rule for products, the product of the signs written on the
blackboard is an invariant for the described replacement algorithm. Thus, the ï¬nal
sign on the blackboard will be equal to the result of the multiplication of all of the
+ and âˆ’signs initially written and, hence, does not depend on the order of the
replacements.
âŠ“âŠ”
Example 4.27 (Bulgaria) There are 2000 white balls in a box. Also, there is a
sufï¬cient supply of white, green and red balls outside the box. The following
replacement operations are allowed with the balls lying inside the box:
(a) Two white balls by a green one.
(b) Two red balls by a green one.
(c) Two green balls by a white and a red ones.
(d) One white ball and one green ball by a red one.
(e) One green ball and one red ball by a white one.
After a ï¬nite number of these replacement operations, only three balls were left in
the box. Prove that at least one of them is green. Does there exist a ï¬nite number of
operations leaving just one ball in the box?
Solution Assume that, in a certain moment, we have x white balls, y green balls
and z red balls in the box. Let us look at how the quantity x +2y +3z behaves when
performing one of the allowed operations:
â€¢
(a): x + 2y + 3z does not change;
â€¢
(b): x + 2y + 3z changes to x + 2(y + 1) + 3(z âˆ’2) = x + 2y + 3z âˆ’4;
â€¢
(c): x + 2y + 3z changes to (x + 1) + 2(y âˆ’2) + 3(z + 1) = x + 2y + 3z;
â€¢
(d): x + 2y + 3z changes to (x âˆ’1) + 2(y âˆ’1) + 3(z + 1) = x + 2y + 3z;
â€¢
(e): x + 2y + 3z changes to (x + 1) + 2(y âˆ’1) + 3(z âˆ’1) = x + 2y + 3z âˆ’4.
According to the analysis above, the remainder of the division of x + 2y + 3z
by 4 is an invariant for the described replacement algorithm. Since we began with
x = 2000 and y = z = 0, we conclude that x + 2y + 3z is always a multiple of 4.
Now, note that with only three balls in the box, we have x + y + z = 3 and
x + 2y + 3z = 4k, for some k âˆˆN. If y = 0, then x + z = 3 and x + 3z = 4k; but,
then, 4k = x + 3z = x + 3(3 âˆ’x) = 9 âˆ’2x, which is an absurd. Therefore, we
must have y â‰¥1, so that there will be at least one green ball in the box.
On the other hand, if at some moment we had only one ball in the box, we should
have x +y +z = 1 and x +2y +3z = 4k. The ï¬rst equation shows that exactly one
of x, y and z is equal 1, while the other two are equal to 0; but these possibilities
are clearly inconsistent with the second equation. Therefore, we will never reach a
situation in which just one ball is left in the box.
âŠ“âŠ”
In the following, we analyse more sophisticated examples.
Example 4.28 (Soviet Union) At ï¬rst, we have n > 1 real numbers written in a
blackboard. An allowed operation is to erase two of them, say a and b, and to write
a+b
4
in their place. Thus, after each operation, the total quantity of numbers written
in the blackboard is one less than it was before the operation has been executed.

118
4
Existence of Conï¬gurations
If all of the n initial numbers were equal to 1, prove that, when just one number is
left on the blackboard, it will necessarily be greater than or equal to 1
n.
Proof Suppose that, at some moment, we have the numbers x1, x2, . . . , xk+1 written
on the blackboard. At this moment, associate the number
f (x1, . . . , xk+1) = 1
x1
+ 1
x2
+ Â· Â· Â· +
1
xk+1
to the blackboard. Without loss of generality, assume that we erase xk and xk+1,
writing xâ€²
k = xk+xk+1
4
in place of them. Since
4
xk + xk+1
â‰¤1
xk
+
1
xk+1
(cf. Example 5.1 (b) of [8], for instance) it is clear that
f (x1, . . . , xkâˆ’1, xâ€²
k) â‰¤f (x1, . . . , xk, xk+1).
Hence, f (x1, . . . , xk) is a semi-invariant for our problem (i.e., the order relation
between the values of f (x1, . . . , xk), computed before and after each operation,
is an invariant for the problemâ€”in our case, such values for a nonincreasing
sequence). Thus, when a single number x will be written on the blackboard, we
ought to have
n = f (1, 1, . . . , 1) â‰¥f (x) = 1
x .
In turn, this is the same as having x â‰¥1
n.
âŠ“âŠ”
Example 4.29 (Putnam) Let A be the total number of distinct sequences (a1, a2,
. . . , a10) of positive integers such that
1
a1
+ 1
a2
+ Â· Â· Â· + 1
a10
= 1.
Decide whether A is even or odd. Justify your answer.
Solution Firstly, let us prove that the equation
1
x1
+ 1
x2
+ Â· Â· Â· + 1
x10
= 1
has an even number of solutions x1 = a1, . . . , x10 = a10 in positive integers,
satisfying the additional condition a1 Ì¸= a2. Indeed, if x1 = a1, x2 = a2, x3 = a3,
. . . , x10 = a10 is such a solution, then x1 = a2, x2 = a1, x3 = a3, . . . , x10 = a10 is
another one, and vice-versa. Therefore, we can group the above solutions in pairs,
so that there is an even number of them.

4.4
Invariants
119
Thanks to the above argument, in order to compute the parity of the number of
solutions of the given equation in positive integers, it sufï¬ces to compute the parity
of the number of such solutions satisfying the additional condition a1 = a2 (here is
where the idea of invariance plays a role: the parity of the number of solutions in
positive integers does not vary if we impose that a1 = a2).
Analogously, it sufï¬ces to compute the parity of the number of solutions in
positive integers satisfying the conditions a3 = a4, a5 = a6, a7 = a8 and a9 = a10.
In turn, this being the case, we get
1
a1
+ 1
a3
+ 1
a5
+ 1
a7
+ 1
a9
= 1
2.
(4.2)
Following the same reasoning as above, we conclude that there is an even number
of solutions of (4.2) in positive integers and such that a1 Ì¸= a3, as well as an even
number of such solutions in which a5 Ì¸= a7. Therefore, in order to compute the
parity of the total number of solutions in positive integers, we can assume that a1 =
a3 and a5 = a7. The given equation now reduces to
2
a1
+ 2
a5
+ 1
a9
= 1
2.
(4.3)
By repeating the same reasoning once more, we conclude that the parity of the
total number of solutions is the same as that of the total number of solutions of (4.3)
in which a1 = a5, i.e., the parity of the total number of solutions of
4
a1
+ 1
a9
= 1
2.
The last equation above is equivalent to
a9 =
2a1
a1 âˆ’8 = 2 +
16
a1 âˆ’8,
(4.4)
so that a1 âˆ’8 = 1, 2, 4, 8 or 16.
Hence, we have exactly ï¬ve positive integer solutions for (4.4), and the invariance
of parity assures that A is odd.
âŠ“âŠ”
Example 4.30 (Belarus) A cube lies on an inï¬nite grid of 1 Ã— 1 squares in such a
way that one of its faces (say F) is situated exactly above one of the squares of the
grid. The cube begins to roll on the grid, passing from one position to the next by
rotating over one of its edges. At some moment, the cube stops exactly on the same
1 Ã— 1 square where it began to move. Then, one notices that the face of the cube in
contact with the grid is F again. Is it possible that, this time, F is rotated by 90â—¦
with respect to its initial orientation?
Proof It is not possible! In order to prove this, let us paint the vertices of the grid
alternately black and white, as in ordinary chessboard. When the cube is about to

120
4
Existence of Conï¬gurations
start rolling, F has two black and two white vertices; then, paint the remaining four
vertices of the cube also black and white, in such a way that each of its edges joins
two vertices of distinct colors. It is easy to check that, as the cube rolls on the grid
from one position to the next, black (resp. white) vertices of it are always in contact
with black (resp. white) vertices of the grid. (Here is the invariance!) However, if
at some future moment F revisits its original position rotated by 90â—¦with respect
to the initial orientation, then we would have two black vertices of F exactly above
two white vertices of the grid. This contradiction proves our initial claim.
âŠ“âŠ”
Our last example uses a semi-invariant reasoning to construct an optimal
conï¬guration.
Example 4.31 (IMO Shortlist) 155 birds are standing on a circle of center O. Two
birds A and B are said to be mutually visible if and only if A *
OB â‰¤10â—¦. Assume
that more than one bird can stand on a single point. Compute the smallest possible
number of pairs of mutually visible birds.
Solution Assume that at least one bird stands at a point A, and at least another
one stands at a point B, where A and B are distinct points of the circle such that
A *
OB â‰¤10â—¦. Suppose, further, that h birds are visible from A but not from B,
whereas k birds are visible from B but not from A. If h â‰¤k and we let all birds in B
to ï¬‚y to A, then the total number of pairs of mutually visible birds (obviously) does
not increase. By repeating such an operation several times, we obtain at the end a
conï¬guration in which two birds are mutually visible if and only if they are placed
at a single point. Moreover, since the total number of pairs of mutually visible birds
did not increase along the performed operations (here we have the semi-invariant!),
in order to minimize this number, it sufï¬ces to consider such conï¬gurations. Also,
since 1
36 Â· 360â—¦= 10â—¦, a further consequence of this reasoning and the pigeonhole
principle is that we ought to have birds in at most 35 distinct points of the circle.
Now, take 35 points along the circle, labelled 1, 2, 3, . . . , 35, and place xi â‰¥0
birds at the point i. Our problem reduces to minimizing
35

i=1
xi
2

= 1
2
35

i=1
xi(xi âˆ’1),
under the constraint 35
i=1 xi = 155. It thus sufï¬ces to minimize 35
i=1 x2
i , under
the condition 35
i=1 xi = 155. To this end, ï¬rst note that if 1 â‰¤i < j â‰¤35 are such
that xi âˆ’xj > 1, then
(x2
i + x2
j ) âˆ’((xi âˆ’1)2 + (xj + 1)2) = 2(xi âˆ’xj âˆ’1) > 0.
Therefore, a minimizing placement of the birds must be such that the values of the
xiâ€™s must differ by at most 1, from where we can let x1 = . . . = xk = a and
xk+1 = . . . = x35 = a + 1. This way, we get

4.4
Invariants
121
35

i=1
x2
i = ka2 + (35 âˆ’k)(a + 1)2 = 35(a + 1)2 âˆ’(2a + 1)k.
Finally, since ka + (35 âˆ’k)(a + 1) = 155 or, which is the same, 35a âˆ’k = 120,
it is immediate to check that the minimum possible value of 35
i=1 x2
i is obtained for
a = 4 and k = 20. Hence, the above discussion assures that the minimum possible
value of mutually visible birds is
5
2

Â· 15 +
4
2

Â· 20 = 270.
âŠ“âŠ”
Remark 4.32 Yet with respect to the solution above, let n âˆˆN be given and x1, . . . ,
xn be nonnegative integer variables. The argument just presented, of minimizing
n
i=1 x2
i subjected to the constraint n
i=1 xi = m, is an example of discrete
optimization and is quite important in Combinatorics. It will make its appearance
again, in disguised form, in Problems 26 and 27, page 135, as well as in Problem 3,
page 142.
Problems: Sect. 4.4
1. (OCM) One has six equal bottles, ï¬ve of them containing 2l of water each and
the sixth one containing 1l. At any time, an allowed operation is to choose two
bottles and split the total amount of water they contain into two equal parts (by
pouring water from one bottle to the other). Is it possible to reach the situation
in which every bottle has the same amount of water?
2. (Soviet Union) At the beginning of a class, a teacher writes a second degree
trinomial on the blackboard. At later moments, an allowed operation with the
trinomial written on the blackboard, say ax2+bx+c, consists in replacing it by
cx2 +bx +a (if c Ì¸= 0) or by any trinomial of the form a(x +t)2 +b(x +t)+c,
with t âˆˆR chosen at random. If the trinomial initially written was x2 âˆ’x âˆ’1, is
there any sequence of allowed operations that makes the trinomial x2 + 3x âˆ’1
appear in the blackboard?
3. We cut out two 1Ã—1 squares situated in opposite corners of an 8Ã—8 chessboard.
Is it possible to cover the 62 remaining squares with 31 rectangles 2Ã—1? Justify
your answer!
4. (Argentina) Firstly, numbers 1, 2, 3, . . . , 1998 are written on a blackboard.
An allowed operation is to replace two of the numbers written, say a and b, by
|aâˆ’b|. After 1997 operation, there is just one number written on the blackboard.
Prove that, regardless of the order in which the replacements have been made,
this last number will always be odd.

122
4
Existence of Conï¬gurations
5. A Mathematics teacher posed the following activity to his students: one of them
would write on the blackboard a list of six integer numbers; then, a second
student would choose three of these six numbers, say x, y and z, replacing
them respectively by x âˆ’y âˆ’z, 3x âˆ’3y âˆ’2z and 4x âˆ’2y + 4z (thus getting,
immediately below the former oneâ€”and by repeating the three numbers that
have not been chosenâ€”a new list of six integer numbers on the blackboard).
Such a procedure would, then, be repeated with this new list of six numbers
and another student. After the class, the blackboard was partially erased, there
remaining only two lists os numbers:
1 2 3 4 5 6 and 3 7 2 15 8 8
(we donâ€™t know how many lists there were between these two left ones). Prove
that, at some replacement, a student made a mistake.
6. (TT) Ten coins are placed around a circle, all of them showing heads (so that
tails cannot be seen at the beginning). Two moves are allowed:
(a) To turn down four consecutively placed coins.
(b) To turn down four coins placed as in XXOXX (here, X represents a coin to
be turned down, whereas O represents one that should stay as it is).
Is it possible to have all ten coins showing tails after a ï¬nite sequence of moves?
7. (Brazil) In the parliament of Terra Brasilis, each member has at most three
enemies. Prove that the parliament can be divided into two houses, in such a
way that, within his/her house, each member has at most one enemy.
8. (Leningrad) To begin with, numbers 1, 2, 3, . . . , n are written on a blackboard.
At any subsequent time, if there are at least two numbers on the blackboard,
an allowed operation consists of erasing two of them, say a and b, and writing
a + b + ab instead (so that, after the operation is performed, we have one less
number on the blackboard). After such an operation is carried out n âˆ’1 times,
we shall have only one number written on the blackboard. Prove that it will not
depend on the order the operations were executed.
9. At each vertex of a square we have a certain quantity of cards (possibly none).
An allowed operation is to remove a certain quantity of cards from one vertex
and to put twice this quantity of cards in one of the two vertices adjacent to
that one (to this end, there is a sufï¬ciently large supply of cards outside the
square, all of them ready to be used). Assume that we begin with just one card
in one vertex, the other three vertices being empty. Is it possible, after a certain
number of steps, to have exactly 1, 9, 8 and 9 cards in the vertices of the square,
in clockwise order?
The next problem revisits Problem 9, page 111, with the aid of invariants.
10. In the plane we are given 2n points in general position, i.e., such that no three
of them are collinear. If n of these points are blue and the other n are red,
prove that it is always possible to draw n line segments satisfying the following
conditions:

4.4
Invariants
123
(a) Each line segment joins a blue point to a red point.
(b) They do not intersect each other.
11. A cube of edge length n is partitioned into n3 unit cubes. Two unit cubes are
said to be adjacent if they share a common face. Students A and B play the
following game on the bigger cube: A starts in a unit cube of his/her choice,
then moving to an adjacent unit cube. Then B, departing from this last unit
cube, moves to a third one, adjacent to the one he departed from, and so on. A
and B play alternately, without ever revisiting a unit cube visited before. If the
ï¬rst who cannot play loses the game, and if A and B play with the best possible
strategies, who will be the winner?
12. (IMO shortlist)
(a) Decide whether or not it is possible to number the unit squares of an 8 Ã— 8
chessboard from 1 to 64 in such a way that, for every set of four unit squares
of one of the shapes below, the sum of the numbers written on them is a
multiple of 4:
(b) Do the same for the sets of four unit squares of one of the following shapes:
13. (Leningrad) All 120 faces of twenty equal cubes are painted black or white,
with three faces of each color per cube. Prove that the cubes can be placed on
an opaque table in such a way that the faces touching it form the board of a
6 Ã— 6 square and the number of black visible faces equals the number of white
visible ones.
For the coming problem the reader will ï¬nd it useful to recall the following
fact, to be proved later (cf. Proposition 6.33), on the greatest common divisor
and least common multiple of two natural numbers: given a, b âˆˆN, one has
ab = gcd(a, b) lcm (a, b).
14. (TT) Several positive integers are written on a blackboard. An allowed oper-
ation is to erase two distinct numbers and to write, in their places, their gcd
and lcm . Prove that, after we have repeated such an operation a certain ï¬nite
number of times the numbers written on the blackboard do not change any
more, no matter which additional operations we perform.

Chapter 5
A Glimpse on Graph Theory
We begin this chapter by considering the following three combinatorial problems:
Problem 1 in a party with 100 guests, there is always an even number of people
who know, within the party, an odd number of other people.
Problem 2 a country has 10 cities and 37 two-way roads, such that each road
connects two distinct cities and each pair of cities is connected by at most one road.
Under such conditions, is it always possible to use the roads to travel from one city
to another (perhaps passing through at least one other city)?
Problem 3 a regular polygon of 100 sides is drawn on the plane, together with all
of its diagonals. Suppose we choose at random 2501 of its sides or diagonals, and
paint them red. Is it necessarily true that a red triangle, having vertices at three of
the vertices of the polygon, will be formed?
In spite of the seemingly lack of correlation between the above problems, in all
of them we have certain sets of â€œobjectsâ€ (guests, cities, vertices), together with
relations between them (knowing each other, being connected by a road, being
connected by a red segment, according to the case). These common features will
allow us to analyse the three problems within the same abstract context, namely,
Graph Theory. There, we concentrate on the fact that two objects may or may
not be related, without paying actual attention to the particular kinds of objects or
relationships between them.
It is the purpose of this chapter to develop the most basic aspects of Graph
Theory, together with some interesting applications. Along the way, among others
we shall prove Eulerâ€™s theorem on the characterization of the existence of Eulerian
paths, Cayleyâ€™s theorem on the number of labelled trees and TurÃ¡nâ€™s extremal
theorem on the existence of cliques. Since we will barely touch the surface of Graph
Theory, we refer the interested reader to [13, 22] or [40] for more comprehensive
introductions to this subject.
Â© Springer International Publishing AG, part of Springer Nature 2018
A. Caminha Muniz Neto, An Excursion through Elementary Mathematics, Volume III,
Problem Books in Mathematics, https://doi.org/10.1007/978-3-319-77977-5_5
125

126
5
A Glimpse on Graph Theory
5.1
Basic Concepts
In this chapter, unless stated otherwise, all sets under consideration will be ï¬nite.
Given a nonempty set A, we shall denote by P2(A) the family of the subsets of A
having two elements:
P2(A) = {B âŠ‚A; |B| = 2}.
In particular,
#P2(A) =
|A|
2

.
Deï¬nition 5.1 A (simple) graph is a pair G = (V ; E), where V is a ï¬nite
nonempty set and E âŠ‚P2(V ). The elements of the set V are called the vertices
of the graph G, whereas the elements of the family E are called the edges of G.
If there is any possibility of confusion, we may write V (G) and E(G) to denote
the sets of vertices and edges of a graph G.
If G = (V ; E) is a graph and u and v are two of its vertices, we shall say that u
and v are adjacent (or neighbors) provided {u, v} âˆˆE; in this case, we shall also
say that the edge {u, v} is incident to the vertices u and v. Whenever there is no
danger of confusion, we shall denote the edge {u, v} simply by uv or vu. If u and v
are not adjacent, we shall say that they are non adjacent vertices of G.
For most purposes, it is quite convenient to represent a graph G = (V ; E) by
means of a diagram in which the elements of V are depicted as points or tiny circles
in the plane and the edges of G as arcs joining the corresponding vertices. Well
understood, the diagram thus obtained has no geometric meaning, and its purpose
is nothing but to schematically represent the adjacency relations between pairs of
vertices of G. For instance, if
G = ({a, b, c, d}; {{a, b}, {a, c}, {a, d}, {b, c}}),
then G may be represented by any one of the two diagrams shown in Fig. 5.1, for
both of them embody the same adjacency relations.
We shall have more to say on this when we study the notion of isomorphism for
graphs.
Fig. 5.1 Two representations
of a graph
a
b
c
d
d
c
b
a

5.1
Basic Concepts
127
Example 5.2 Given a set V with n elements and a graph G = (V ; E), Deï¬nition 5.1
allows two extreme cases, namely, those in which E = âˆ…or E = P2(V ). In the ï¬rst
case, we say that G = (V ; âˆ…) is the trivial graph on n vertices, which can be
represented by a set of n points in the plane, with no arcs. In the second case, G is
the complete graph (or a clique) on n vertices, which can also be represented by a
set of n points in the plane, with any two of them being adjacent. From now on, we
shall denote a complete graph on n vertices by Kn; in particular, note that Kn has
exactly
n
2

edges.
Back to the notion of adjacency, ï¬xed a vertex u of G = (V ; E), we shall denote
by NG(u) the set of vertices adjacent to u:
NG(u) = {v âˆˆV ; uv âˆˆE}.
The following deï¬nition is central to all that follows.
Deï¬nition 5.3 Let G = (V ; E) be a graph. For u âˆˆV , the degree of u, denoted
dG(u) is the number of vertices of G which are adjacent to u:
dG(u) =
		NG(u)
		.
Remark 5.4 Whenever the graph G = (V ; E) is understood, for u âˆˆV we shall
denote the degree of u and the set of neighbors of u simply by d(u) and N(u),
respectively.
We are ï¬nally in position to state and prove the most basic result of Graph Theory,
which is due to Euler.1
Theorem 5.5 (Euler)
In every graph G = (V ; E), the sum of the degrees of the
vertices is equal to twice the number of edges. In symbols:
2|E| =

uâˆˆV
dG(u).
(5.1)
Proof We use double counting. It sufï¬ces to observe that, if Ïµ = {u, v} is an edge
of G, then Ïµ is counted exactly twice in the right hand side of (5.1): once in the
summand dG(u) and another time in the summand dG(v). Hence, the right hand
side of (5.1) has to be equal to 2|E|, since this number also counts each edge of G
exactly twice.
âŠ“âŠ”
The coming corollary, also due to Euler, is the most important consequence of
the previous theorem.
Corollary 5.6 (Euler) In any graph, the number of vertices of odd degree is even.
1Actually, as we shall see later, Euler is usually credited as being the founder of Graph Theory.

128
5
A Glimpse on Graph Theory
Proof Let G = (V ; E) be a graph and, for an integer k â‰¥0, let vk(G) denote the
number of vertices of G with degree k. Since the sum at the right hand side of (5.1)
has exactly vk(G) summands equal to k, we have (again by double counting) the
equality

uâˆˆV
dG(u) =

kâ‰¥0
kvk(G).
(5.2)
It thus follows from Eulerâ€™s theorem that
2|E| =

uâˆˆV
dG(u) =

kâ‰¥0
kvk(G)
=

jâ‰¥0
(2j + 1)v2j+1(G) +

jâ‰¥1
2jv2j(G)
=

jâ‰¥0
v2j+1(G) +

jâ‰¥1
2j(v2j(G) + v2j+1(G)).
Therefore,

jâ‰¥0
v2j+1(G) = 2|E| âˆ’

jâ‰¥1
2j(v2j(G) + v2j+1(G)),
which is an even number.
âŠ“âŠ”
Example 5.7 Prior to a committeeâ€™s reunion, some of its ten members shook hands.
Is it possible that the numbers of handshakes have been, in some order, equal to 1,
1, 1, 3, 3, 3, 4, 6, 7 and 8?
Proof Look at the committeeâ€™s members as the vertices of a graph, with two vertices
being adjacent if the corresponding people shook hands. Then, if the situation just
described could have occurred, the degrees of the vertices of the graph would have
been, in some order, equal to 1, 1, 1, 3, 3, 3, 4, 6, 7 and 8. But this would contradict
the previous corollary, since we would have an odd number of vertices of odd
degree. Therefore, such a situation cannot have occurred.
âŠ“âŠ”
The following deï¬nition brings the appropriate notion of equivalence for graphs.
Deï¬nition 5.8 Graphs G = (V1; E1) and H = (V2; E2) are said to be isomorphic
if there exists a bijection f : V1 â†’V2 which preserves incidence, i.e., such that,
for every two distinct vertices u and v of G, we have
{u, v} âˆˆE1 â‡”{f (u), f (v)} âˆˆE2.
In this case, we denote G1 â‰ƒG2.

5.1
Basic Concepts
129
It is clear from the previous deï¬nition that two isomorphic graphs have equal
numbers of vertices. On the other hand, Problem 4 guarantees that, for each n âˆˆN,
the notion of isomorphism of graphs induces an equivalence relation (cf. Sect. 2.3)
in the set of graphs of n vertices.
The coming proposition gives other necessary conditions for two graphs to be
isomorphic.
Proposition 5.9 Two isomorphic graphs have equal numbers of vertices of a
certain degree. In particular, they have equal numbers of edges.
Proof Let G = (V1; E1) and H = (V2; E2) be isomorphic graphs and f : V1 â†’V2
be an incidence-preserving bijection. If u is a vertex of G having degree k > 0,
such that NG(u) = {u1, . . . , uk}, then it is immediate to see that NH(f (u)) =
{f (u1), . . . , f (uk)}. In particular, f (u) is a vertex of H having degree k. An
analogous reasoning assures that if u has degree 0, then the same holds for f (u).
Since the argument of the last paragraph is symmetric with respect to G and
H (here we are using the fact that the notion of isomorphism of graphs is an
equivalence relation), we conclude that G and H have, for every integer k â‰¥0,
equal quantities of vertices of degree k.
For what is left, we apply Eulerâ€™s theorem twice: since dG(u) = dH(f (u)) for
every u âˆˆV1 and f is a bijection between the sets of vertices of G and H, we obtain
2|E1| =

uâˆˆV1
dG(u) =

uâˆˆV1
dH(f (u)) =

f (u)âˆˆV2
dH(f (u)) = 2|E2|.
Therefore, |E1| = |E2|.
âŠ“âŠ”
Example 5.10 If G = (V ; E) is a graph of n vertices we can assume, whenever
needed, that V = In. Indeed, since |V | = n, we can choose a bijection f : V â†’In
and let H = (In; F) be deï¬ned by setting, for i Ì¸= j in In,
{i, j} âˆˆF â‡”{f âˆ’1(i), f âˆ’1(j)} âˆˆE.
The previous example allows us to introduce a quite useful algebraic representa-
tion of a graph, namely, its adjacency matrix. In this respect, we assume the reader
is acquainted with the most basic concepts on matrices, which can be revisited at
Chapter 2 of [4], for instance.
Deï¬nition 5.11 Given a graph G = (V ; E), with |V | = n, assume, according to
the previous example, that V = In. The adjacency matrix of G is the n Ã— n matrix
Adj(G) = (aij) such that
aij =
1, if i Ì¸= j and {i, j} âˆˆE
0, else
.

130
5
A Glimpse on Graph Theory
Lemma 5.12 The adjacency matrix of a graph is symmetric, with zeros in the main
diagonal.
Proof In the notations of the previous deï¬nition we have, for i Ì¸= j in In, that
aij = 1 â‡”{i, j} âˆˆE â‡”{j, i} âˆˆE â‡”aji = 1;
hence, Adj(G) is symmetric. The rest is immediate from the deï¬nition.
âŠ“âŠ”
Remark 5.13 Given a graph G = (V ; E), we shall sometimes say that G is
labelled, an allusion to the fact that its vertices have names, or labels. The notion
of isomorphism of graphs allows us to introduce the concept of unlabelled graph.
More precisely, if V is a set with n elements and G is the set of graphs having
V as set of vertices, then the restriction of the relation of graph isomorphism to
G induces an equivalence relation in G. A unlabelled graph with n vertices is
an equivalence class in G, with respect to the isomorphism relation. Unless we
explicitly say otherwise, in these notes we shall consider only labelled graphs,
generally omitting the adjective â€œlabelledâ€.
We ï¬nish this section by examining the important notion of subgraph of a graph.
Deï¬nition 5.14 A graph H is a subgraph of a graph G if V (H) âŠ‚V (G) and
E(H) âŠ‚E(G). The graph H is a spanning subgraph of G if H is a subgraph of
G for which V (H) = V (G).
We now show how to build two fundamental examples of subgraphs of a given
graph.
Example 5.15 Given a graph G = (V ; E) and Ïµ âˆˆE, the subgraph of G obtained
by the edge excision of Ïµ is the graph H = (V ; E\Ïµ). From now on, we shall denote
such a subgraph of G simply by G âˆ’Ïµ. In words, G âˆ’Ïµ is the subgraph obtained
from G by erasing the edge Ïµ. Note, further, that G âˆ’Ïµ is a spanning subgraph of
G.
Example 5.16 Given a graph G = (V ; E) and u âˆˆV , the subgraph of G obtained
by vertex excision of u is the graph H = (V \ {u}; Eâ€²), where
Eâ€² = E \ {Ïµ âˆˆE; Ïµ is incident with u}.
From now on, we shall denote such a subgraph of G simply by G âˆ’u. In words,
G âˆ’u is the subgraph of G obtained by erasing vertex u, together with all of the
edges of G incident to it. Note, further, that G âˆ’u has one vertex less and dG(u)
edges less than G.
Corollary 5.6 gave a necessary condition for a list of nonnegative integers
to be the list of degrees of some simple graph. Although there is no simple

5.1
Basic Concepts
131
sufï¬cient condition to decide whether this is so, we ï¬nish this section by presenting
Havel-Hakimiâ€™s2 simple algorithm, that allows one to quickly decide it for any given
list of nonnegative integers. We follow [22].
Theorem 5.17 (Havel-Hakimi) If s is a positive integer, then the nonnegative
integers
s â‰¥t1 â‰¥t2 â‰¥. . . â‰¥ts â‰¥d1 â‰¥. . . â‰¥dn
are the degrees of the vertices of some simple graph if and only if so are
t1 âˆ’1, t2 âˆ’1, . . . , ts âˆ’1, d1, . . . , dn.
Proof Let G be a graph whose vertices have degrees s â‰¥t1 â‰¥t2 â‰¥. . . â‰¥ts â‰¥d1 â‰¥
. . . â‰¥dn. Since s is positive and the vertex u of degree s has exactly s neighbors,
we conclude that t1, t2, . . . , ts â‰¥1 (note that this follows from the fact that we have
listed the degrees in descending order). For 1 â‰¤i â‰¤s, let vi be the vertex of degree
ti and, for 1 â‰¤j â‰¤n, let wj be the vertex of degree dj. We distinguish two cases:
(i) NG(u) = {v1, . . . , vs}: then the vertices of H := G âˆ’u have degrees t1 âˆ’
1, t2 âˆ’1, . . . , ts âˆ’1, d1, . . . , dn.
(ii) NG(u) Ì¸= {v1, . . . , vs}: then, for some 1 â‰¤i â‰¤s and some 1 â‰¤j â‰¤n, we have
u nonadjacent to vi and adjacent to wj. In particular, ti â‰¥dj, and we consider
two subcases (make some drawings to follow the reasoning):
â€¢
ti = dj: let Gâ€² be the graph obtained from G by exchanging vi and wj.
â€¢
ti > dj: then vi has a neighbor x which is not a neighbor of wj. Let Gâ€² be
the graph obtained from G by erasing the edges {u, wj}, {vi, x} and adding
the edges {u, vi}, {wj, x}.
After having performed either i. or ii., we are left with a graph Gâ€² whose
list of degrees is equal to that of G, and such that NGâ€²(u) âˆ©{v1, . . . , vs}
strictly contains NG(u) âˆ©{v1, . . . , vs}. If NGâ€²(u) = {v1, . . . , vs}, we return
to i. Otherwise, we repeat ii. until we reach such a situation. In the end of
this process, we will ï¬nd a graph H having degrees t1 âˆ’1, t2 âˆ’1, . . . , ts âˆ’
1, d1, . . . , dn.
Conversely, assume that (t1 âˆ’1, t2 âˆ’1, . . . , ts âˆ’1, d1, . . . , dn) is the sequence of
degrees of some simple graph H, and let ui be a vertex in H with degree ti âˆ’1. Form
a graph G by adding a vertex to H and making it adjacent to u1, . . . , us. Then, the
sequence of degrees of the vertices of G is precisely (s, t1, t2, . . . , ts, d1, . . . , dn).
âŠ“âŠ”
2After VÃ¡clav J. Havel, Czech mathematician, and Seifollah L. Hakimi, Iranian-American mathe-
matician, both of the twentieth century.

132
5
A Glimpse on Graph Theory
Problems: Sect. 5.1
1. Solve Problem 1 at the beginning of this chapter.
2. Prove that every graph has at least two vertices with the same degree.
3. Given graphs G1 = (V1; E1) and G2 = (V2; E2), with |V1| = |V2|, prove
that G1 and G2 are isomorphic if and only if Adj(G2) can be obtained from
Adj(G1) by means of a permutation of rows.
4. * Prove that graph isomorphism is an equivalence relation in the family of
graphs.
5. Compute the number of (labelled) graphs with vertices u1, . . . , un.
6. Prove that there does not exist a graph of seven vertices, with degrees 1, 1, 2, 3,
4, 5 and 6, in some order.
7. Give an example of a graph of eight vertices, of degrees 1, 1, 2, 3, 4, 4, 5 and 6
in some order.
8. Given n âˆˆN, show that there exists a simple graph of 2n vertices, whose
degrees are n, n, n âˆ’1, n âˆ’1, . . . , 3, 3, 2, 2, 1, 1.
9. * If G = (V ; E) is a graph, its complement is the graph G = (V ; Ec), where
Ec denotes the complement of E in P2(V ). If |V | = n, prove that:
(a) dG(u) + dG(u) = n âˆ’1, for every u âˆˆV .
(b) |E| + |Ec| =
n
2

.
10. A graph is self-complementary if it is isomorphic to its complement. If G is a
self-complementary graph with n vertices, prove that n leaves remainder 0 or 1
upon division by 4.
11. * Generalize Examples 5.15 and 5.16. More precisely, given a graph G =
(V ; E) and âˆ…Ì¸= B âŠŠV , âˆ…Ì¸= A âŠ‚E, deï¬ne the subgraphs G âˆ’B and
G âˆ’A of G, respectively obtained by the excision of the vertices in B and of
the edges in A.
12. * Given a graph G and a subset A of V (G), the subgraph of G induced by A
is the graph G|A = (A; Eâ€²), where
Eâ€² = {{u, v} âˆˆE; u, v âˆˆA}.
Prove that:
(a) For u âˆˆV (G), one has G âˆ’u = G|V (G)\{u}.
(b) G|A = G âˆ’Ac, where Ac denotes the complement of A in V (G) and
G âˆ’Ac is deï¬ned as in the previous problem.
13. Let G = (V ; E) be a graph. We choose two nonadjacent vertices, say u and v,
and add edge {u, v} to E, thus obtaining a new graph H = (V ; F). Prove that
the difference between the numbers of odd degree vertices in H and in G is âˆ’2,
0 or 2. Then, use this fact to give another proof of Corollary 5.6.
For the coming problem, the reader may ï¬nd it convenient to recall the
discussion on congruence modulo n, in Sect. 2.3.

5.1
Basic Concepts
133
14. * Given integers 1 â‰¤n < m, let G(m, n) = G(Im; E) be the graph such that,
for 1 â‰¤i, j â‰¤m,
{i, j} âˆˆE â‡”j â‰¡i Â± n(mod m).
(a) Represent G(m, n) when m = 6 and n varies from 1 to 5.
(b) If m = 2n, prove that each vertex has degree 1 and |E| = n. Then, represent
the graph thus obtained.
(c) If m Ì¸= 2n, prove that each vertex has degree 2 and |E| = m.
(d) Prove that G(m, n) â‰ƒG(m, m âˆ’n).
15. * In the notations of the previous problem, represent the graph obtained from
G(5, 1) and G(5, 2) by joining, for 1 â‰¤i â‰¤5, vertex i of G(5, 1) to vertex 2i
of G(5, 2). The graph thus obtained is known as Petersen graph.3
For the next problem, one says that a nonempty subset A of the set of vertices
of a graph G is independent if any two vertices in A are nonadjacent in G.
16. * A graph G = (V ; E) is bipartite if one can write V = V1 âˆªV2, with V1
and V2 being disjoint, nonempty and independent sets of vertices. Prove that
|E| â‰¤|V1| Â· |V2|, with equality if and only if each vertex of V1 is adjacent to
some vertex of V2, and vice-versa.
17. * In the notations of the previous problem, a bipartite graph G = (V1 âˆªV2; E)
is said to be complete if |E| = |V1| Â· |V2|. If H = (W1 âˆªW2; F) is another
complete bipartite graph, prove that
G â‰ƒH â‡”|V1| = |W1| and |V2| = |W2|, or vice-versa.
Thanks to such a result, if |V1| = m and |V2| = n, we write simply Km,n to
denote the complete bipartite graph G = (V1 âˆªV2; E).
18. * In the notations of Problem 16, let V1 = {1, . . . , m} and V2 = {m+1, . . . , m+
n}. Prove that the adjacency matrix of G has the form
Adj(G) =
+ 0 A
AâŠ¤0
,
,
where A is an m Ã— n matrix and AâŠ¤denotes the transpose of A.
19. A bipartite graph G = (V1 âˆªV2; E), with independent sets of vertices V1 and
V2, has 16 vertices of degree 5 and some (at least one) vertices of degree 8. If all
of the vertices of degree 8 belong to V1, compute how many vertices of degree
8 the graph G can have.
20. * A graph G is r-regular if all vertices of G have degree r.
3After Julius P. C. Petersen, Danish mathematician of the nineteenth century.

134
5
A Glimpse on Graph Theory
(a) If G is an r-regular graph with n vertices, prove that 2 | nr and that G has
exactly nr
2 edges.
(b) Given natural numbers n and r, such that r < n and nr is even, show how
to construct an r-regular graph with n vertices.
21. A battalion commander asked volunteers to compose 11 patrols, all of which
formed by the same number of men. If each men entered exactly two patrols
and each two patrols had exactly one men in common, compute the numbers of
volunteers and of members of each patrol.4
22. Let G = (V1 âˆªV2; E) be a bipartite graph, with |V1| = m and |V2| = n. It is
known that all vertices in V1 have degree g, all vertices in V2 have degree 2 and
|N(u) âˆ©N(v)| = 1, for all distinct vertices u, v âˆˆV1.
(a) Compute g and n in terms of m.
(b) For the values of g and n computed as in (a), show that there is a bipartite
graph satisfying the stated conditions.
23. (Japan) A total of x students entered a Mathematics competition in which 2y
problems were proposed. It is known that each student solved y problems and
each problem was solved by the same number of students; moreover, each two
students solved exactly three problems in common. Compute the values of all
possible pairs (x, y) and, for each such pair, exhibit a conï¬guration showing
which problems were solved by each student.
24. (Hungary) Prove that it is impossible to place the numbers 1, 2, 3, . . . , 13 around
a circle so that, for any two neighboring numbers x and y, we have 3 â‰¤|xâˆ’y| â‰¤
5.
25. Let G = (V ; E) be a graph. A subset V â€² of V is a vertex cover of G if every
edge of G is incident to least one vertex in V â€²; a vertex cover V â€² is minimal if
G has no vertex cover with less elements than V â€². A matching in G is a subset
Eâ€² of E formed by pairwise disjoint edges; a matching Eâ€² is maximal if G
has no matching with more edges than Eâ€². The purpose of this problem is to
prove KÃ¶nigâ€™s theorem5: in every bipartite graph, the number of vertices in a
minimal vertex cover is equal to the number of edges in a maximal matching.
To this end, let G = (V1 âˆªV2; E) be bipartite, with independent sets of vertices
V1 and V2, and do the following items:
(a) Let âª¯be the relation on V1 âˆªV2 given by u âª¯v â‡”u âˆˆV1, v âˆˆV2. Show
that âª¯is a partial order on V1 âˆªV2.
(b) With respect to âª¯, show that:
i. An antichain is the same as the complement of a vertex cover in G.
ii. A collection of disjoint chains of lengths greater than 1 is the same as a
matching in G.
4For another approach to this problem, see Problem 5, page 49.
5After DÃ©nes KÃ¶nig, Hungarian mathematician of the twentieth century.

5.1
Basic Concepts
135
Fig. 5.2 A transitive (left) or
cyclic (right) K3
(c) Apply Dilworthâ€™s theorem (cf. Problem 6, page 115) to prove KÃ¶nigâ€™s
theorem.
For the coming problem, we deï¬ne a directed graph, or digraph as a graph
G such that we associate an orientation to each one of its edges. Informally, this
can be thought of as an arrow along the edge; formally, each edge of a digraph
is an ordered pair (instead of a set) (u, v), for some distinct u, v âˆˆV (G), such
that if (u, v) is an edge then (v, u) is not. Given a vertex u of a digraph G,
we deï¬ne the out degree d+
G(u) of u as the number of arrows departing from
u; analogously, the in degree of u, denoted dâˆ’
G(u), is the number of arrows
arriving at u. Hence,
dG(u) = d+
G(u) + dâˆ’
G(u)
is the degree of u in G, thought of as an ordinary graph (i.e., the graph obtained
by removing the orientations of the edges of the digraph).
If a digraph contains a K3, then such a K3 is said to be transitive or
cyclic, provided it satisï¬es the situation depicted at left or right, respectively, in
Fig. 5.2. A digraph G is complete, or a tournament if it is a complete graph
when we remove the orientations of its edges.
26. * If G is a complete digraph of n vertices, prove that:
(a) 
uâˆˆV d+(u) =
n
2

, where V is the set of vertices of G and we write d+(u)
in place of d+
G(u).
(b) The average out degree of G is d+ = nâˆ’1
2 .
(c) The number of transitive K3â€™s in G is 
uâˆˆV
d+(u)
2

.
(d) The number of cyclic K3â€™s in G is given by
n
3

+ 1
2
n
2

âˆ’1
2

uâˆˆV
d+(u)2.
(e) The number of cyclic K3â€™s in G is also given by
n(n2 âˆ’1)
24
âˆ’

uâˆˆV
(d+(u) âˆ’d+)2.
Then, conclude that this is at most
n(n2 âˆ’1)/24, if n is odd
n(n2 âˆ’4)/24, if n is even .

136
5
A Glimpse on Graph Theory
27. (Japan) Fourteen people dispute a chess tournament in which each two players
have a match and there are no ties. Compute the largest possible number of sets
of three players such that, in the three matches involving two of them, each
player wins one match and loses another one.
5.2
Paths, Walks and Cycles
In this section we study the problem of deciding whether a graph is connected, i.e.,
has only one piece. As a byproduct, we introduce the concepts that name the section
and prove several important results related to them. In particular, we give a necessary
and sufï¬cient condition for the existence of an Eulerian walk in a connected graph,
and characterize bipartite graphs in terms of cycles.
Deï¬nition 5.18 A walk of length k â‰¥1 in a graph G is a sequence
P = (u0, u1, . . . , uk)
(5.3)
of (not necessarily distinct) vertices of G, such that uiâˆ’1 is adjacent to ui, for 1 â‰¤
i â‰¤k. A walk P as above is said to be closed if u0 = uk.
The graphs we wish to qualify are those for which there is a walk between any
two vertices. Since these graphs are quite important for our subsequent discussion,
we isolate them in the coming
Deï¬nition 5.19 A graph is connected if there exists a walk between any two of its
vertices. A non connected graph is said to be disconnected.
The coming proposition furnishes a simple (sufï¬cient, albeit obviously not
necessary) criterion for a graph to be connected. For its statement, we need to
introduce a concept which will also be useful in other future context: given a graph
G = (V ; E), its minimum degree is the nonnegative integer Î´(G) given by
Î´(G) = min{dG(u); u âˆˆV (G)}.
(5.4)
Proposition 5.20 If G is a graph of n vertices for which Î´(G) â‰¥âŒŠn
2âŒ‹, then G is
connected.
Proof If n = 1, there is nothing to do. If n = 2, then Î´(G) = 1 and, hence, the two
vertices of G are adjacent. Suppose, then, that n > 2, and let u and v be distinct
vertices of G; we shall show that there is a walk between them. If u and v are
adjacent, there is nothing to do. Otherwise, since

5.2
Paths, Walks and Cycles
137
dG(u) + dG(v) â‰¥2âŒŠn/2âŒ‹> n âˆ’2 = #(V (G) \ {u, v}),
the pigeonhole principle guarantees the existence of a vertex w Ì¸= u, v, adjacent to
both u and v. Therefore, the walk (u, w, v) joins u and v.
âŠ“âŠ”
For a ï¬xed graph G, it is immediate to verify that the relation âˆ¼in V (G), deï¬ned
by letting
u âˆ¼v â‡”u = v or there exists a walk in G joining u and v,
(5.5)
is of equivalence. Also, note that an equivalence class of V (G) with respect to such
a relation is, in particular, a set of vertices of G.
For the next deï¬nition, the reader may ï¬nd it convenient to review the notion of
subgraph induced by a set of vertices, in Problem 12, page 132.
Deï¬nition 5.21 The connected components of a graph G are the subgraphs G|A
of G, induced by the equivalence classes A of V (G) with respect to the equivalence
relation (5.5).
If A is an equivalence class of vertices of G with respect to (5.5), then, in
particular, there is a walk between any two distinct vertices in A, so that G|A is
a connected graph. On the other hand, if H is a connected subgraph of G containing
G|A, then H = G|A. Indeed, if u âˆˆV (H) and v âˆˆA âŠ‚V (H), then the
connectedness of H assures the existence of a walk in H (and hence in G) joining
u and v; therefore, u âˆˆA, since A is an equivalence class of vertices of G with
respect to the existence of walks. Thus, we have A âŠ‚V (H) âŠ‚A, from where it
follows that H = G|A. The above argument allows us to assert that the connected
components of a graph are precisely its maximal connected subgraphs.
Back to the analysis of the walks in a graph, we collect yet another relevant piece
of terminology, which goes back to Euler. In this sense, if P is a walk in a graph G
as in (5.3), we say that {uiâˆ’1, ui}, for 1 â‰¤i â‰¤k, are the edges of G traversed by P.
Deï¬nition 5.22 An Eulerian walk in a connected graph is a closed walk which
traverses each edge of the graph exactly once. A connected graph is Eulerian if it
contains an Eulerian walk.
Let G be an Eulerian graph and P be an Eulerian walk in G, as in (5.3). For an
arbitrary vertex u of G, if k â‰¥1 is the number of occurrences of u in P, we claim
that dG(u) = 2k, an even number. This is obvious if all such occurrences of u are of
the form u = ui, with 1 â‰¤i < k (for in this case uiâˆ’1 and ui+1 are distinct vertices
of G, both adjacent to u); on the other hand, if u0 = u, note that uk = u too, for P is
closed. Therefore, a necessary condition for a connected graph G to be Eulerian is
that all vertices of G are of even degree. Theorem 5.24 below guarantees that such
condition is also sufï¬cient for the existence of an Eulerian walk. Before we discuss
it, we need an important auxiliary result.

138
5
A Glimpse on Graph Theory
Lemma 5.23 If G is a connected and nontrivial graph in which every vertex has
even degree, then G contains a closed walk which does not traverse the same edge
twice.
Proof Choose a vertex u0 of G and, starting at u0, construct a walk in G by
performing the following operation as many times as possible: being at a vertex
ukâˆ’1 of G, with k â‰¥1, choose a vertex uk of G, adjacent to ukâˆ’1 and such that the
edge {ukâˆ’1, uk} has not been chosen yet.
In order to show that the algorithm described above does generate a closed walk
in G, assume that, after a certain number of (at least one) operations, we ï¬nd
ourselves in a vertex uk of G. There are two possibilities:
(i) uk = u0: there is nothing to do, for the closed walk is (u0, u1, . . . , uk).
(ii) uk Ì¸= u0: suppose that the vertex uk has appeared (with smaller indices) other
l times along the performed operations; this used exactly 2l + 1 of the edges
incident to uk (two edges for each of the l previous occurrence of uk, and an
extra edge to reach uk from ukâˆ’1). However, since uk has even degree, there
exists at least one edge incident to uk and which has not been used yet; hence,
the algorithm does not stop at uk.
Finally, since the number of edges in G is ï¬nite, the above discussion assures that
the algorithm stops at u0 and, when it does so, we have succeeded in constructing a
closed walk in G which does not traverse the same edge twice.
âŠ“âŠ”
We are now in position to prove the result of Euler alluded to above.
Theorem 5.24 (Euler)
A connected and nontrivial graph G is Eulerian if and only
if all of its vertices have even degree.
Proof We have already seen, in the paragraph preceding Lemma 5.23, that the
condition that all vertices of G have even degree is indeed necessary for the
existence of an Eulerian walk. In order to establish the sufï¬ciency, let us make
induction on the number of edges of G.
Since G is nontrivial, if all of its vertices have even degree, then it has at least
three edges; moreover, if G has exactly three edges, then it is immediate to prove
that it is isomorphic to K3, which is clearly Eulerian.
Now, assume that G has n > 3 edges, and that the theorem is true for all
connected graphs with less than n edges and such that all vertices have even degree.
By the previous lemma, we can take in G a closed walk P = (u0, u1, . . . , ukâˆ’1, u0),
that does not traverse the same edge twice. Let A be the set of edges in P, and
H1,. . . , Hl be the nontrivial connected components of G âˆ’A (cf. Problem 11,
page 132). If a vertex u of Hi occurs j â‰¥0 times in P, then
dG(u) = dHi(u) + 2j,
so that dHi(u) is even. Since this is true for all indices 1 â‰¤i â‰¤l and all vertices
u âˆˆV (Hi), we conclude that H1, . . . , Hl do satisfy the hypotheses of the theorem.

5.2
Paths, Walks and Cycles
139
Since each Hi has less edges than G, the induction hypothesis guarantees the
existence of an Eulerian walk Pi for Hi, for 1 â‰¤i â‰¤l. At this point, the idea is
to glue the Eulerian walks P1, . . . , Pl to P one by one, in a way to get an Eulerian
walk for G. To this end, note that P and P1 have at least one vertex in common,
say u. We may assume, without loss of generality, that P and P1 start and end at
u (it sufï¬ces to change the starting points of both these closed walks, if necessary).
Hence, following P and subsequently P1, we obtain a closed walk Pâ€²
1 in G, which
encompasses all of the edges of P and P1 and does not traverse one of them twice.
It now sufï¬ces to repeat the above argument more l âˆ’1 times, gluing P2 to Pâ€²
1 to get
a closed walk Pâ€²
2, and so on. The closed walk Pâ€²
l, obtained at the end of this process
will be an Eulerian walk in G.
âŠ“âŠ”
The above result, proved by L. Euler in 1735, marks the birth of Graph Theory.
Euler came to it after having been inquired on the possibility of performing a walk
along the streets of the prussian city of KÃ¶nigsberg (nowadays the Russian city of
Kaliningrad), traversing exactly once each of the seven bridges the city had, at that
time, over the Pregel river.
Taking into account that these bridges join two islands of the Pregel to the
remaining parts of the city, Euler modelled the problem posed to him as the search
for ï¬nding, in the graph of Fig. 5.3, a walk of the type we refer today as being
Eulerian. Although such a graph is not simple (notice the multiple edges joining
two vertices, a situation that, by the sake of simplicity, we did not allow in our
presentation of the theory), a momentâ€™s reï¬‚ection will easily convince the reader
that the previous theorem remains true for non simple connected graphs. Therefore,
this result (actually, the adaptation of the argument for the proof of the necessity
part of it, given at the paragraph preceding Lemma 5.23) guarantees that the graph
of Fig. 5.3 does not contain an Eulerian walk, for all of its vertices have odd degree.
Back to the general development of the theory, we ï¬nish this section by studying
the concepts of paths and cycles in graphs, as well as looking at some relevant
applications of them.
Deï¬nition 5.25 A path in a graph is a walk with distinct vertices.
Fig. 5.3 Graph representing
the bridges of KÃ¶nigsberg
a
b
c
d

140
5
A Glimpse on Graph Theory
Even though every path is a walk, it is clear that the converse is not true in
general, namely, that there are walks which are not paths. Nevertheless, it is not
difï¬cult to convince ourselves (cf. Problem 7) that, if a graph contains a walk
between two of its vertices, then it also contains a path between them.
Deï¬nition 5.26 A k-cycle in a graph G is a closed walk
(u0, u1, . . . , ukâˆ’1, u0)
in G, of length k â‰¥3 and such that (u0, u1, . . . , ukâˆ’1) is a path.
The coming result uses the concept of cycle to characterize bipartite graphs (cf.
Problem 16, page 133).
Proposition 5.27 A graph G is bipartite if and only if every cycle in G has even
length.
Proof Firstly, let us assume that G is bipartite, with independent sets of vertices V1
and V2. If C = (u0, u1, u2, . . . , ukâˆ’1, u0) is a cycle in G, then the independence of
the sets V1 and V2 guarantees that vertices ui and ui+1 alternate between the sets V1
and V2, for 0 â‰¤i â‰¤k âˆ’1 (with uk = u0). In particular, the path (u0, u1, . . . , ukâˆ’1)
alternates k âˆ’1 times between V1 and V2 for, starting from u0, arrive at ukâˆ’1.
However, since ukâˆ’1 and u0 are adjacent, they cannot belong to a single one of
the sets V1 or V2 and, hence, k âˆ’1 must be odd. Therefore, the length k of C must
be even.
Conversely, assume that every cycle in G has even length. We use induction on
the number of edges to show that G is bipartite. If G contains some cycle C, erase
an edge Ïµ = {u, v} of C. Since no further cycles are created, all of the cycles of
G âˆ’Ïµ are also of even length. Hence, by induction hypothesis, G âˆ’Ïµ is bipartite,
with independent sets of vertices V1 and V2, say. We shall show that V1 and V2 are
also independent in G. To this end, note that the path C âˆ’Ïµ in Gâˆ’Ïµ joins u to v and
has odd length; since its vertices alternate between V1 and V2, it follows that u âˆˆV1
and v âˆˆV2, or vice-versa. Therefore, V1 and V2 are also independent in G, so that
G is bipartite too.
âŠ“âŠ”
The coming deï¬nition, due to the nineteenth century Irish astronomer, math-
ematician and physicist William R. Hamilton, is, in a certain sense, dual to the
deï¬nition of Eulerian walk.
Deï¬nition 5.28 A hamiltonian cycle in a graph is a cycle that passes through
all of the vertices of the graph. A connected graph is hamiltonian if it contains
a hamiltonian cycle.
Not every connected graph is hamiltonian; for instance, any graph without cycles
is not hamiltonian (for not-so-trivial examples, see Example 5.30 or Problem 21).
The question of the existence or not of hamiltonian cycles in graphs is much
more difï¬cult than the corresponding problem for Eulerian walks. Actually, up to
now there does not exist a set of simple necessary and sufï¬cient conditions for a

5.2
Paths, Walks and Cycles
141
graph to be hamiltonian. On the other hand, the coming result, due to the Hungarian
mathematician of the twentieth century Gabriel Dirac, provides a simple sufï¬cient
condition for the existence of hamiltonian cycles in a graph. For its statement, the
reader may ï¬nd it helpful to review the deï¬nition of minimum degree of a graph,
in (5.4).
Theorem 5.29 (Dirac)
If G is a graph with n â‰¥3 vertices and such that Î´(G) â‰¥
n
2, then G is hamiltonian.
Proof Proposition 5.20 gives the connectedness of G. Now, let P = (u0, . . . , uk) be
a maximal path in G (i.e., one for which there is no other of greater length). If v is a
neighbor of u0 not belonging to P, we can change P by P1 = (v, u0, . . . , uk), thus
obtaining a path in G bigger than P, which is a contradiction. Hence, P includes
all of the neighbors of u0 and, analogously, all of the neighbors of uk. In turn, this
assures that the length of P is at least n
2.
We ï¬rst claim that there exists an index 0 â‰¤i â‰¤k âˆ’1 such that u0 is adjacent to
ui+1 and ui is adjacent to uk. In order to show this, let A = {0 â‰¤i â‰¤k âˆ’1; ui+1 âˆˆ
NG(u0)} and B = {0 â‰¤i â‰¤k âˆ’1; ui âˆˆNG(uk)}. Since all of the vertices in
NG(u0) and all of the vertices in NG(uk) are in P, it follows that |A|, |B| â‰¥n
2.
Since |A âˆªB| â‰¤k, we then get
|A âˆ©B| = |A| + |B| âˆ’|A âˆªB| â‰¥n âˆ’k > 0,
for P is a path in G with k + 1 vertices, so that k + 1 â‰¤n.
Now, choose 0 â‰¤i â‰¤k âˆ’1 as in the above claim, and consider the cycle
C = (u0, ui+1, ui+2, . . . , ukâˆ’1, uk, ui, uiâˆ’1, . . . u1, u0).
We claim that C is hamiltonian. By contradiction, suppose that some vertex of G,
say v, is not in C. Since C has more than n
2 vertices and v has at least n
2 neighbors,
pigeonholeâ€™s principle (applied as in the proof of Proposition 5.20) guarantees the
existence of a vertex w in C such that w is adjacent to v. Renaming the vertices of
C, we can assume that
C = (v0, v1, . . . , vk, v0),
with v0 = w. But then, P1 = (v, v0, v1, . . . , vk) would be a path in G bigger than
P, which is impossible.
âŠ“âŠ”
The lower bound on Î´(G) asked by Diracâ€™s theorem is the best possible one, in
the sense of the following example.
Example 5.30 Let n > 1 be odd and let G be the graph of n vertices formed by the
union of two copies of K(n+1)/2 with a single common vertex, say u (i.e., take two
disjoint copies of K(n+1)/2, choose one vertex out of each of them and make these
two vertices coincide). One clearly has Î´(G) = nâˆ’1
2
< n
2. Nevertheless, G does
not contain a hamiltonian cycle, for every cycle in G containing u must be entirely

142
5
A Glimpse on Graph Theory
contained in one of the copies of K(n+1)/2 which originated G. Indeed, if C is such
a cycle, then C âˆ’u is a connected subgraph of G âˆ’u, which, in turn is the disjoint
union of two copies of K(nâˆ’1)/2; therefore, C âˆ’u is contained in a single one of
these two copies and, hence, is also contained in a single one of the two copied of
K(n+1)/2 from which we formed G.
Problems: Sect. 5.2
1. For this problem, recall that if A = (aij)mÃ—n and B = (bjk)nÃ—p are m Ã— n and
n Ã— p matrices with entries aij and bjk, then the product matrix of A and B (in
this order) is AB = (cik)mÃ—p such that, for 1 â‰¤i â‰¤m and 1 â‰¤k â‰¤p, one has
cik =
n

j=1
aijbjk.
(5.6)
This being said, do the following items:
(a) If M is the adjacency matrix of a graph G of vertices v1, . . . , vn, use the
above formula to prove that, for i Ì¸= j, entry (i, j) of M2 equals the number
of distinct paths of length 2 in G, joining vertices vi and vj.
(b) Generalize (5.6), showing that if A1, . . . , Ak are nÃ—n, with Al = (al
ij)nÃ—n,
then the product matrix of A1, . . . , Ak (in this order) is A1 . . . Ak =
(bij)nÃ—n, such that
bij =

l1,...,lk
a1
il1a2
l1l2 . . . akâˆ’1
lkâˆ’2lkâˆ’1ak
lkâˆ’1j,
with the indices l1, . . . , lk in the above sum varying over all possibilities
1 â‰¤l1, . . . , lk â‰¤n.
(c) Generalize item (a) in the following way: if M is the adjacency matrix of
a graph G of vertices v1, . . . , vn and k â‰¥1 is an integer, show that entry
(i, j) of the matrix Mk equals the number of distinct walks of length k in
G, joining vertices vi and vj.
2. Given a graph G and a vertex u of G, let H = (V ; E), where V is the set of the
vertices of all paths in G departing from u and E is the set formed by the edges
of these paths. Prove that H is the connected component of G containing u.
3. Prove that every graph with n vertices and at least
nâˆ’1
2

+1 edges is connected.
Give an example of a graph with n vertices and
nâˆ’1
2

edges which is not
connected.
4. Solve Problem 2, posed at the beginning of this chapter.

5.2
Paths, Walks and Cycles
143
For the coming problem, you shall need the following fact, to be established
in Proposition 6.26: given nonzero integers m, n and c, there exist integers x
and y such that c = mx + ny if and only if gcd(m, n) divides c.
5. Let m and n be given naturals and d = gcd(m, n). Prove that the graph G(m, n),
described in Problem 14, page 132, has exactly gcd(m, n) = d connected
components.
6. Show that if a graph G is disconnected, then its complement G (cf. Problem 9,
page 132) contains a complete bipartite graph with the same set of vertices of
G. In particular, conclude that either G or G is connected.
7. * If there is a walk between two vertices of a graph, prove that there is also a
path between them.
8. Find an Eulerian walk in the graph depicted below:
e
d
b
a
g
f
c
h
9. A semi-Eulerian walk in a connected graph G is a walk that starts and ends in
distinct vertices of G and traverses each edge of G exactly once. Prove that G
has a semi-Eulerian walk if and only if it has exactly two odd degree vertices.
10. Prove that, in every connected graph, two paths whose lengths are the largest
possible ones have at least one common vertex.
11. A graph G has n + 2 vertices, u1, u2, . . . , un, v, w, and satisï¬es the following
conditions: v and w are both adjacent to u1, . . . , un, but not to one another; u1,
. . . , un are pairwise adjacent. For a ï¬xed integer 2 â‰¤k â‰¤n + 1, compute the
number of paths of length k in G, joining v to w.
12. If all vertices of a graph have degrees at least 2, prove that the graph contains a
cycle.
13. Prove that every 2-regular graph (cf. Problem 20, page 133) is a cycle.
14. (TT) During a meeting, each one of ï¬ve mathematicians slept exactly twice.
It is also known that, for each two of those ï¬ve mathematicians, there was a
moment in which both were sleeping. Prove that, at some moment, three of
them were sleeping.
15. (IMO) Let G be a connected graph with n edges. Prove that it is possible to label
the edges of G with the integers 1 to n, in such a way that the labels attributed
to the edges incident at each vertex of degree greater than 1 are relatively prime.
16. * An edge Ïµ of a graph G is said to be a cutting edge provided G âˆ’Ïµ has more
connected components than G. If G is a connected graph and Ïµ is a cutting edge
of G, prove that G âˆ’Ïµ has exactly two connected components.

144
5
A Glimpse on Graph Theory
For the coming problem, given a digraph G (cf. Problem 26, page 135) and
two of its vertices, say u and v, we deï¬ne an (oriented) walk in G, from u to
v, to be a sequence (u0, . . . , uk) of vertices of G such that u0 = u, uk = v
and the edge joining ui and ui+1 is oriented from ui to ui+1, for 0 â‰¤i < k. In
this case, we say that k is the length of the walk. A path is a walk with distinct
vertices. Finally, recall that a complete digraph or tournament is a digraph that
turns into a complete graph when we remove the orientation of its edges.
17. In a tournament G, show that there exists a vertex from which one can reach
any other vertex with a path of length at most 2.
18. (TT) In Shvambrania there are n cities, each two of them connected by a road.
These roads do not intersect; if necessary, viaducts are used for some of them to
overpass others. An evil wizard wants to establish one way directions in each of
the roads, so that, if someone leaves a certain city, he/she can no longer return.
Prove that:
(a) The wizard can actually establish such rules.
(b) Whatever the way the wizard chooses to set his rules, there will always be a
city from which one can reach any other, and a city from which one cannot
leave.
(c) The wizard can execute his intent in exactly n! distinct ways.
19. (Brazil) Consider an nÃ—n chessboard (n > 1 integer), and choose one of its n2
unit squares, say c0. A path6 in the chessboard is a sequence (c0, c1, . . . , cm)
of distinct unit squares of the chessboard such that, for each 0 â‰¤j < m,
squares cj and cj+1 share a common edge. Such a path is said to be optimal if
it contains all of the n2 unit squares of the chessboard. Moreover, we say that a
path as above contains an U if, for some 0 â‰¤j â‰¤m âˆ’3, the unit squares cj
and cj+3 share a common edge. Show that every optimal path contains an U.
20. (Tchecoslovaquia) Prove that, in every connected graph, there exists a vertex
such that the average degree of its neighbors is greater than or equal to the
average degree of all vertices of the graph.
21. The purpose of this problem is to prove that Petersenâ€™s graph (cf. Problem 15,
page 133) is not hamiltonian. To this end assume, by contradiction, that such
a graph possesses a hamiltonian cycle C. In the notations of Fig. 5.4, do the
following items:
(a) Prove that C contains either two or four of the edges {a, aâ€²}, {b, bâ€²}, {c, câ€²},
{d, dâ€²} and {e, eâ€²}.
(b) If four of the edges in (a) belong to C suppose, without loss of generality,
that {b, bâ€²} is the one not belonging to C. Conclude that {aâ€², bâ€²}, {bâ€², câ€²},
{b, e} and {b, d} are in C and use this to reach a contradiction.
(c) If two of the edges of (a) are in C assume, without loss of generality, that
{a, aâ€²} is one of them. Conclude that exactly one of the edges {a, c} or
6Note that, in principle, this deï¬nition of path does not coincide with the one given in the text.
Nevertheless, we have chosen to translate it according to the original.

5.3
Trees
145
Fig. 5.4 Petersenâ€™s graph
c
d
e
a
b
c
d
e
a
b
{a, d} is in the cycle, say {a, c}. If {a, c} is in C, conclude that the other
edge of (a) which is in C is {d, dâ€²}, and reach a contradiction.
22. Let k and n be integers such that 2 < k < n. If f (n, k) denotes the largest
possible number of Kkâ€™s in Kn, such that any two of these Kkâ€™s have at most
k âˆ’2 vertices in common, prove that
1
k2

n
k âˆ’1

< f (n, k) â‰¤1
k
n
k

.
23. (Vietnam) Find the least positive integer k for which there exists a graph of 25
vertices such that each one of them is adjacent to exactly k others, and each two
nonadjacent vertices are both adjacent to a third vertex.
24. (Austrian-Polish) A rectangular building is formed by two rows of ï¬fteen
square rooms (situated as the unit squares of two adjacent rows of an ordinary
chessboard). Each room has one, two or three doors, that lead respectively to
one, two or three adjacent rooms. It is known that the doors are distributed in
such a way that it is always possible to go from one room to another without
leaving the building. Compute how many are the distinct ways of distributing
the doors along the building.
5.3
Trees
In this section we study connected graphs which do not have cycles, also said to be
acyclic. The relevant deï¬nition is the one below.
Deï¬nition 5.31 A tree is a connected and acyclic graph.
If T is a tree, a leaf of T is a vertex of degree 1, whereas a node of T is a vertex
of degree greater than 1. It is an important fact that every tree has leaves, as we now
establish.
Lemma 5.32 Every tree with more than one vertex has at least two leaves.

146
5
A Glimpse on Graph Theory
Proof Let T be a tree with at least two vertices and consider, in T , a path C with
the largest possible length. If C = (u1, u2, . . . , un), we claim that u1 and un are
leaves. Indeed, if it was dT (u1) â‰¥2, then u1 would be adjacent to u2 and to some
other vertex, say u0. Since trees do not have cycles, we must have u0 Ì¸= u3, . . . , un.
Therefore, (u0, u1, u2 . . . , un) would be a path in T with length greater than that of
C, which is an absurd. Hence, dT (u1) = 1 and, analogously, dT (un) = 1.
âŠ“âŠ”
The previous lemma allows us to prove the coming proposition, which gives a
necessary condition for a connected graph to be a tree. Soon hereafter we will show
that such a condition will be also sufï¬cient.
Proposition 5.33 If T = (V ; E) is a tree, then |E| = |V | âˆ’1.
Proof We make induction on |V |. Firstly, it is clear that every tree with two vertices
has exactly one edge. Assume, by induction hypothesis, that every tree with n > 1
vertices has exactly n âˆ’1 edges, and consider a tree T with n + 1 vertices. By the
lemma, T has a leaf u; hence, T âˆ’u is a tree with n vertices, and the induction
hypothesis assures that T âˆ’u has n âˆ’1 edges. However, since T has exactly one
edge more than T âˆ’u, it follows that T has exactly n edges.
âŠ“âŠ”
Corollary 5.34 If G = (V ; E) is a connected graph, then G contains at least one
cycle if and only if |E| â‰¥|V |.
Proof Suppose ï¬rst that G contains at least one cycle. We shall show that |E| â‰¥|V |
by induction on |E|. If Ïµ is the edge of a cycle in G, then G âˆ’Ïµ is also connected
and has |V | vertices and |E| âˆ’1 edges. Then, there are two possibilities:
â€¢
G âˆ’Ïµ contains a cycle: it follows from the induction hypothesis that |E| âˆ’1 â‰¥
|V |;
â€¢
Gâˆ’Ïµ is acyclic: since it is still connected, Gâˆ’Ïµ is a tree. Therefore, the previous
proposition guarantees that |V | = (|E| âˆ’1) + 1 = |E|.
In any case, we concluded that |E| â‰¥|V |.
Conversely, if G is acyclic, then G is a tree, so that (again from the previous
result) |E| = |V | âˆ’1 < |V |.
âŠ“âŠ”
Corollary 5.35 Let T = (V ; E) be a connected graph. If |E| = |V | âˆ’1, then T is
a tree.
Proof If T has at least one cycle, it would follow from the previous corollary that
|E| â‰¥|V |, which is a contradiction. Thus, T is connected and acyclic, hence, a
tree.
âŠ“âŠ”
For what comes next, given a connected graph G, associate to each edge Ïµ of G
a weight, i.e., a positive real number w(Ïµ) (to motivate this concept, think of the
vertices of the graph as several cities of some region and of the weights as measures
of travel expenses between adjacent cities). This way, G becomes a weighted graph
and the weight w(G) of G is deï¬ned by setting

5.3
Trees
147
w(G) =

ÏµâˆˆE
w(Ïµ),
with E = E(G).
Given a connected graph G, a spanning tree of G is a spanning subgraph of G
(cf. Deï¬nition 5.14) which is a tree. An interesting problem in the elementary theory
of trees is the following one: given a weighted graph, ï¬nd a spanning tree of least
possible weight, said to be a minimal spanning tree.
We deal with this problem in the coming proposition, due to the American
mathematician of the twentieth century Joseph Kruskal. Well understood, since the
set of spanning trees of a graph is ï¬nite (and nonempty, as we shall see), there always
exist minimal spanning trees in weighted graphs. The point of Kruskalâ€™s theorem is
that the proof of it actually furnishes an algorithm for ï¬nding a minimal spanning
tree. Such an algorithm is known in Computer Science as Kruskalâ€™s algorithm or
greedy algorithm.
Proposition 5.36 (Kruskal) If G is a weighted graph, then G has minimal span-
ning trees.
Proof Form a subgraph T of G according to the following algorithm:
(i) Choose an edge of G with least possible weight and put it in T .
(ii) After having chosen a certain number of edges of G for T , take, among the
edges not chosen yet, one of minimum weight and whose inclusion in T does
not generate cycles.
(iii) Repeat step (ii) as long as possible.
Firstly, note that the steps above give, as result, a spanning tree T of G. Indeed,
T is certainly acyclic; it is also connected (and thus a tree), for otherwise we could,
due to the connectedness of G, execute the algorithm one further time. Moreover,
if T was not spanning, there would exist in G a vertex u not belonging to T but
adjacent to some vertex v of T . Without loss of generality, we may assume that u
and v are such that w({u, v}) is minimal, among all possible choices of u and v as
above. Hence, the algorithm would continue with the inclusion of the edge {u, v} in
T , which is an absurd.
Now, we let S be another spanning tree of G, and will show that w(T ) â‰¤w(S).
Since S and T have the same number of edges (cf. Problem 3), there exists an
edge Ïµ of T such that Ïµ does not belong to S. Again by Problem 3, the inclusion of Ïµ
in S generates a cycle C; but since T is a tree, there exists some edge Ïµâ€² in C, distinct
from Ïµ and not belonging to T . In particular, Ïµâ€² is in S.
We claim that w(Ïµ) â‰¤w(Ïµâ€²). Indeed, if w(Ïµ) > w(Ïµâ€²), then, upon executing
Kruskalâ€™s algorithm, at the step we chose Ïµ we would have chosen Ïµâ€², for it would
have a smaller weight. However, since Ïµâ€² is not in T , this gives a contradiction.
Since w(Ïµ) â‰¤w(Ïµâ€²), changing Ïµâ€² by Ïµ in S, we obtain a new generating tree S1,
such that w(S1) â‰¤w(S) and S1 and T have one more edge in common than S and
T do. If T has k edges not belonging to S, then, repeating the above reasoning more
k âˆ’1 times, we obtain a sequence S1, S2, . . . , Sk of spanning trees such that Sk = T

148
5
A Glimpse on Graph Theory
and
w(Sk) â‰¤Â· Â· Â· â‰¤w(S1) â‰¤w(S).
Thus, w(T ) â‰¤w(S).
âŠ“âŠ”
We ï¬nish this section by counting the number of labelled trees (cf. Remark 5.13)
with a given number of vertices and a given set of labels. This result is due to
the nineteenth century English mathematician Arthur Cayley and, for the sake of
simplicity, we omit the set of labels from its statement.
Theorem 5.37 (Cayley)
There are exactly nnâˆ’2 labelled trees of n vertices.
Proof The given formula is trivially true for n = 1 and n = 2. Assume n > 2 and,
without loss of generality, that the vertices of the trees will be labelled 1, 2, . . . , n.
Let an be the total number of such trees and, for 1 â‰¤i â‰¤n, let Ai stands for the set
of them such that the vertex with label i is a leaf. Since it is impossible that all of
the n vertices are leaves, the inclusion-exclusion principle (cf. Theorem 2.1) gives
an = |A1 âˆª. . . âˆªAn|
=
nâˆ’1

k=1

1â‰¤i1<Â·Â·Â·<ikâ‰¤n
(âˆ’1)kâˆ’1|Ai1 âˆ©. . . âˆ©Aik|.
(5.7)
Now, given integers 1 â‰¤k â‰¤n and 1 â‰¤i1 < Â· Â· Â· < ik â‰¤n, note that Ai1 âˆ©. . . âˆ©
Aik is the set of trees in which vertices i1, i2, . . . , ik are leaves. If T stands for one
such tree, then
Ti1i2...ik := T âˆ’{i1, i2, . . . , ik}
is a tree with nâˆ’k vertices, with labels in In\{i1, i2, . . . , ik}. The key to count |Ai1 âˆ©
. . .âˆ©Aik| is to look at how T can be reconstructed from Ti1i2...ik. To understand this,
note that for a ï¬xed 1 â‰¤j â‰¤k vertex ij must be joined to one of the n âˆ’k vertices
of Ti1i2...ik; since the involved choices are independent, we conclude that there are
exactly (n âˆ’k)k possible ways of choosing the vertices of Ti1i2...ik to which vertices
i1, i2,. . . , ik will link themselves. Since there are anâˆ’k possibilities for Ti1i2...ik, we
therefore conclude that
|Ai1 âˆ©. . . âˆ©Aik| = (n âˆ’k)kanâˆ’k.
(5.8)
In the above formula, note that the right hand side depends solely on k, but not
on i1, i2, . . . , ik. Since there are exactly
n
k

ways of choosing integers 1 â‰¤i1 <
Â· Â· Â· < ik â‰¤n, Eqs. (5.7) and (5.8) give us

5.3
Trees
149
an =
nâˆ’1

k=1
(âˆ’1)kâˆ’1
n
k

(n âˆ’k)kanâˆ’k.
Now assume, by induction hypothesis, that al = llâˆ’2 for 1 â‰¤l < n. Then, the
recurrence relation above gives
an =
nâˆ’1

k=1
(âˆ’1)kâˆ’1
n
k

(n âˆ’k)nâˆ’2.
We ï¬nish the proof by applying the formula of Problem 3, page 40, with m = n âˆ’2
to get an = nnâˆ’2.
âŠ“âŠ”
Problems: Sect. 5.3
1. * Prove that the following claims on a graph G are equivalent:
(a) G is a tree.
(b) Given arbitrarily two vertices of G, there is a single path in G connecting
them.
(c) G is connected and every edge of G is a cutting edge (cf. Problem 16,
page 143).
Then, conclude that, in a tree with n vertices, there are exactly
n
2

distinct paths.
2. Let T be a tree with a node of degree k. Prove that T has at least k leaves.
3. * Let G be a connected graph.
(a) Prove that any two spanning trees of G have the same number of edges.
(b) If T is a spanning tree of G and Ïµ is an edge of G that is not in T , prove that
T âˆª{Ïµ} contains cycles.
(c) If G has a single spanning tree, prove that G is a tree.
(d) If T is a spanning tree of G and G has k edges not belonging to T , prove that
G contains at least k distinct cycles.
4. Prove that the following algorithm also constructs minimal spanning trees of
weighted graphs:
i. Choose a vertex and, among all edges incident to it, the one with least
possible weight.
ii. After having chosen a certain number of vertices and edges, choose the edge
of least weight, among all edges not yet chosen and that join an already
chosen vertex to a not chosen yet one.
iii. Repeat the previous item as many times as possible.

150
5
A Glimpse on Graph Theory
The above algorithm is due to the Dutch mathematician of the twentieth century
Edsger Dijkstra, being known as Dijkstraâ€™s algorithm.
ab
ac
ad
ae
af
ag
bc
bg
cd
de
ef
fg
6
3
2
4
3
7
6
6
2
3
1
8
5. Let G be a graph with set of vertices {a, b, c, d, e, f, g} and with edge weights
given as in the following table: Find all possible spanning trees of minimal
weight.
For the coming problem, we shall use the fact, established in Problem 1, that
a tree with n vertices contains exactly
n
2

distinct paths.
6. Let T be a tree with n vertices and satisfying the following condition: it is
possible to associate to each one of the n âˆ’1 edges of T a natural weight, so
that the
n
2

distinct paths in T have, in some order, weights equal to 1, 2, . . . ,
n
2

.
The purpose of this problem is to show that, in this case, either n or n âˆ’2 must
be a perfect square. To this end, do the following items:
(a) Show that the number of paths in T having odd weight is equal to:
â§
â¨
â©
1
2
n
2

, if
n
2

is even
1
2
n
2

+ 1

, if
n
2

is odd
.
(b) Show that it is possible to paint the vertices of T either blue or red, in such
a way that two adjacent vertices have distinct colors if and only if the edge
joining them has odd weight.
(c) If the coloring of item (b) generates x blue vertices and y red ones, show that
the number of paths in T with odd weight is equal to xy.
(d) If
n
2

is even, show that n = (x âˆ’y)2; if
n
2

is odd, conclude that n âˆ’2 =
(x âˆ’y)2.
5.4
Independent Sets and Cliques
This last section on graphs is devoted to a somewhat more detailed study of complete
subgraphs of a given graph, and is partially based on the classnotes [16]. I kindly
acknowledge professor Samuel B. Feitosa for having allowed me to use them.
Given a graph G, recall that a nonempty subset A of V (G) is said to be
independent if any two vertices in A are nonadjacent. If G has n vertices, we can
partition V (G) in n sets (each set consisting of a single vertex) such that each one of
them is independent. Then, there exists a least natural number k such that V (G) can
be partitioned into k independent sets. We name such a natural number according to
the following

5.4
Independent Sets and Cliques
151
Deï¬nition 5.38 Given a graph G, its chromatic number, denoted X(G), is the
least natural number k such that the set of vertices of G can be partitioned into k
independent sets.
The reason for the word chromatic in the above deï¬nition is due to the fact that,
if X(G) = k and V (G) = A1 âˆª. . . âˆªAk, with A1, . . . , Ak independent sets, then,
painting the vertices in Ai with a color ci (where c1, . . . , ck are distinct colors),
we obtain a coloring of the vertices of G in which any two adjacent vertices have
distinct colors; conversely, if k is the least possible number of distinct colors for
which there exists a coloring of the vertices of G with k distinct colors and with
no adjacent vertices of the same color, then the sets formed by the vertices of each
color are k independent sets that partition V (G).
Examples 5.39
(a) If G is a bipartite graph (cf. Problem 16, page 133) with at least one edge, it is
immediate to see that X(G) = 2.
(b) If G is a 2-cycle with n vertices, then it is clear that X(G) = 2 if n is even
(for we can color the vertices by alternating two colors along the cycle), but
X(G) = 3 if n is odd (for in this case we need a third color for the last vertex
of the cycle).
Generalizing item (b) of the above example, the proof of the coming proposition
describes a rather simple algorithm which guarantees that if no vertex of a graph has
degree greater than k, then its chromatic number is at most k +1. In all that follows,
given a graph G we let
(G) = max{dG(u); u âˆˆV (G)}
and say that (G) is the maximum degree in G.
Proposition 5.40 In every graph G, we have X(G) â‰¤(G) + 1.
Proof Let (G) = n and ï¬x n + 1 distinct colors. Start by painting an arbitrary
vertex of G with one of the colors. Then, assume that, at some moment, k < n
vertices of G have been painted with the n + 1 given colors and in such a way that
adjacent vertices have distinct colors. Choose a vertex u that has not been painted
yet. Since dG(u) â‰¤(G) = n, at most n of the given colors were used to paint
vertices adjacent to u; hence, we are left with at least one of the n+1 colors to paint
u, so that it has a color distinct from those of all of its neighbors.
âŠ“âŠ”
The following deï¬nition furnishes a lower bound for the chromatic number of a
graph.

152
5
A Glimpse on Graph Theory
Deï¬nition 5.41 An n-clique in a graph G is a subgraph of G which is isomorphic
to Kn. The clique number of G, denoted Ï‰(G), is the greatest integer n â‰¥0 such
that G contains an n-clique.7
Since one needs n distinct colors to color the vertices of Kn in such a way that
no two adjacent vertices have the same color, we have
X(G) â‰¥Ï‰(G),
for every graph G. On the other hand, we can estimate Ï‰(G) upon the intuition that,
if a graph has lots of edges (when compared to its number of vertices), then Ï‰(G)
must be large. Let us take a look at a relevant
Example 5.42 Let G be a connected graph with n > 1 vertices. If G has more than
âŒŠn2
4 âŒ‹edges, then Ï‰(G) â‰¥3.
Proof By contraposition, assume that G does not contain a K3.
Let u be a vertex of G with maximum degree, say k. We can assume that k > 1,
for, otherwise, Eulerâ€™s Theorem 5.5 would give us at most n
2 edges in G, and this
would contradict the fact that n
2 < âŒŠn2
4 âŒ‹+ 1 for n > 1.
Since G has no K3, the k vertices of G adjacent to u form an independent set.
Therefore, every edge of G which is not incident to u is incident to some of the
n âˆ’k âˆ’1 vertices of G not belonging to NG(u) âˆª{u}. However, since each one of
these n âˆ’k âˆ’1 vertices has degree less than or equal to k, we conclude that G has
at most
k + (n âˆ’1 âˆ’k)k = âˆ’k2 + nk
edges.
In order to ï¬nish the proof, it sufï¬ces to note that
Z âˆ‹âˆ’k2 + nk â‰¤n2
4 ,
so that we must have âˆ’k2 + nk â‰¤âŒŠn2
4 âŒ‹.
âŠ“âŠ”
The coming problem brings an interesting application of the previous one.
Example 5.43 (China) Given distinct real numbers x1, x2, . . . , xn, prove that there
exists at most âŒŠn2
4 âŒ‹ordered pairs (xi, xj) such that 1 < |xi âˆ’xj| < 2.
7We call the readerâ€™s attention for not confusing notations w(G) for the weight of a weighted graph
and Ï‰(G) for the clique number of a graph; the ï¬rst uses the Latin letter w, whereas the second
uses the Greek letter Ï‰ ( omega).

5.4
Independent Sets and Cliques
153
Proof Construct a graph G having the xiâ€™s as vertices, with xi adjacent to xj if and
only if 1 < |xi âˆ’xj| < 2. We claim that G does not contain K3â€™s. Indeed, if xi, xj
and xk were the vertices of a K3 in G, with xi < xj < xk, say, then
xk âˆ’xi = (xk âˆ’xj) + (xj âˆ’xi) > 1 + 1 = 2,
which is a contradiction. Therefore, by the previous example we conclude that G
has at most âŒŠn2
4 âŒ‹edges.
âŠ“âŠ”
In order to generalize the reasoning of Example 5.42 from K3â€™s to Klâ€™s, let us
ï¬rstly construct a generic example of a graph with n vertices and without Klâ€™s. To
this end, we start by assuming that l â‰¤n, for otherwise there is nothing to do; then,
we use the division algorithm (cf. Proposition 6.7) to write
n = (l âˆ’1)q + r,
with 0 â‰¤r < lâˆ’1. Then, partition the set of n vertices into lâˆ’1 subsets A1, A2,. . . ,
Alâˆ’1, such that
|A1| = . . . = |Ar| = q + 1 and |Ar+1| = . . . = |Alâˆ’1| = q;
that it is possible to get such a partition follows from the equality r(q +1)+(l âˆ’r âˆ’
1)q = (l âˆ’1)q +r = n. Continuing, impose that each Ai be an independent set, and
also that each vertex of Ai is adjacent to each vertex of Aj, for all 1 â‰¤i, j â‰¤l âˆ’1,
with i Ì¸= j. The graph G thus obtained is called a TurÃ¡n graph, after the Hungarian
mathematician of the twentieth century Paul TurÃ¡n, to whom we owe part of the
material of this section.
The TurÃ¡n graph just constructed does not contain any Kl, since a Kl contains
l-cycles, whereas G does not contain any such cycle. On the other hand, by counting
how many edges of Kn are not present in G, we conclude that it has exactly
T (n; l) :=
n
2

âˆ’r
q + 1
2

âˆ’(l âˆ’r âˆ’1)
q
2

edges. Substituting q = nâˆ’r
lâˆ’1 and doing some elementary algebra, we get
T (n; l) = n2(l âˆ’2) âˆ’r(l âˆ’1 âˆ’r)
2(l âˆ’1)
,
(5.9)
even though Ï‰(G) < l.
The coming result (cf. [39]) assures that, if G is a graph with n vertices and such
that Ï‰(G) < l, then G must have at most T (n; l) edges.
Theorem 5.44 (TurÃ¡n)
If a graph G of n vertices has more than T (n; l) edges,
then Ï‰(G) â‰¥l.

154
5
A Glimpse on Graph Theory
Proof In the notations of the preceding discussion, let us make a proof by induction
on q, assuming that r and l are ï¬xed. If q = 0, then n = r and it follows from (5.9)
that
T (n; l) = n2(l âˆ’2) âˆ’n(l âˆ’1 âˆ’n)
2(l âˆ’1)
= n2(l âˆ’1) âˆ’n(l âˆ’1)
2(l âˆ’1)
= n2 âˆ’n
2
=
n
2

.
Since a graph with n vertices cannot have more that
n
2

edges, the statement of the
theorem is vacuously true.8
Now, consider a graph G with n vertices, without Klâ€™s and with the largest
possible number of edges. Clearly, G contains a Klâˆ’1, for otherwise we could add
at least one more edge to G and it would still contain no Kl. Let H be a Klâˆ’1 in G,
and A be the set of the remaining n âˆ’l + 1 vertices of G (i.e., those not belonging
to H). There are three kinds of edges in G:
â€¢
The edges of H: overall,
lâˆ’1
2

edges.
â€¢
The edges joining vertices in A to vertices in H: since G contains no Klâ€™s, each
vertex in A is adjacent to at most l âˆ’2 vertices in H. This gives us at most
(n âˆ’l + 1)(l âˆ’2) edges of this kind.
â€¢
The edges of the induced subgraph G|A (cf. Problem 12, page 132): since G|A
does not contain Klâ€™s too, and n âˆ’l + 1 = (q âˆ’1)(l âˆ’1) + r, we can apply the
induction hypothesis to G|A, so that G|A has at most T (n âˆ’l + 1; l) edges.
Therefore, the graph G has at most
T (n âˆ’l + 1; l) + (n âˆ’l + 1)(l âˆ’2) +
l âˆ’1
2

edges.
Finally, substituting the formula for T (n âˆ’l + 1; l) (obtained from (5.9)) and
performing some elementary algebra once more, we get
T (n âˆ’l + 1; l) + (n âˆ’l + 1)(l âˆ’2) +
l âˆ’1
2

= T (n; l),
so that G has at most T (n; l) edges.
âŠ“âŠ”
8In terms of Logic, an implication is true whenever it premise is false. See Chapter 1 of [34], for
instance.

5.4
Independent Sets and Cliques
155
A nice way of grasping the details of the proof of TurÃ¡nâ€™s theorem is to rework it
in the particular case (l âˆ’1) | n. In this respect, we refer the reader to Problems 2
and 5.
We ï¬nish this section by examining yet another invariant of a graph G, one which
is closely related to Ï‰(G).
Deï¬nition 5.45 Given a graph G, its independence number, denoted Î±(G), is the
number of elements of a maximal independent set of vertices of G.
For the coming proposition, the reader may ï¬nd it useful to recall the concept of
complementary graph (cf. Problem 9, page 132).
Proposition 5.46 Let a graph G and a nonempty subset A of the set of vertices of
G be given. The subgraph of G induced by A is a clique in G if and only if A is an
independent set in G. In particular,
Ï‰(G) = Î±(G) and Ï‰(G) = Î±(G).
Proof The ï¬rst part follows immediately from the deï¬nitions. For the second part,
it sufï¬ces to use the fact that G = G.
âŠ“âŠ”
Example 5.47 Let G be a graph with nine vertices. Suppose that, given any ï¬ve of
the vertices of G, there exist at least two edges with both endpoints among them.
Compute the least possible number of edges G can have.
Proof We consider two cases separately:
(a) Ï‰(G) â‰¥4: ï¬x a K4 in G and let A be the set formed by the vertices of this K4.
Then, A is independent in G and, if u is one of the ï¬ve remaining vertices, the
stated condition assures that u is adjacent to at least two of the vertices in A.
Thus, we conclude that G has at least 5 Â· 2 = 10 edges.
(b) Ï‰(G) â‰¤3: by TurÃ¡nâ€™s theorem, G has at most T (9; 4) = 27 edges and, hence
G has at least
9
2

âˆ’27 = 9 edges.
For an example of such a G with 9 edges, take the union of three pairwise disjoint
K3â€™s. Given ï¬ve vertices in G, there are two possibilities: either three of these ï¬ve
vertices form one of the K3â€™s of G, or we choose the ï¬ve vertices by taking two
vertices of two of the K3â€™s of G, together with one vertex of the third K3. In any
case, there are at least two edges of G having both of its endpoints among the ï¬ve
vertices.
âŠ“âŠ”
Problems: Sect. 5.4
1. If G is a graph with at least six vertices, prove that Ï‰(G) â‰¥3 or Ï‰(G) â‰¥3.
2. The purpose of this problem is to provide a slightly different proof of the result
of Example 5.42 when G is a graph of 2q vertices, q > 1, and at least q2 + 1

156
5
A Glimpse on Graph Theory
edges. To this end, ï¬x two adjacent vertices u and v of G and do the following
items:
(a) If at least 2q âˆ’1 edges depart from u or v to the remaining 2q âˆ’2 vertices,
use the pigeonhole principle to guarantee that G has a K3 of the form uvw.
(b) If at most 2q âˆ’2 edges depart from u or v to the remaining 2q âˆ’2 vertices,
apply an appropriate induction hypothesis to G âˆ’{u, v} (cf. Problem 11,
page 132) to conclude that such a graph (and, hence, also G) contains a K3.
3. Solve Problem 3 at the beginning of this chapter.
4. Let G be a graph with 10 vertices and 26 edges. Show that G must contain at
least ï¬ve K3â€™s.
5. Let l â‰¥3 and q be natural numbers, and G be a graph of (l âˆ’1)q vertices, with
at least 1
2(l âˆ’1)(l âˆ’2)q2 edges.9 Argue along the same lines of Problem 2 to
show that G contains a Kl.
6. (TT) Twenty teams entered a soccer tournament. Find the minimum number of
matches such a tournament must have so that, among any three teams, at least
two have played against each other.
7. In a given a set of n people, it is known that out of any group of three of them
at least two are acquainted with each other, whereas out of any group of four
at least two are not acquainted with each other. Compute the largest possible
value of n.
8. (TT) We are given 21 points on a circle. Prove that there exist at least 100 arcs,
each of which having two of the given points as endpoints and whose measures
are less than or equal to 120â—¦.
9. (Poland) Let n points on a circle with radius 1 be given. Show that there is at
most n2
3 line segments joining pairs of these points and having lengths greater
than
âˆš
2.
10. (USA) In a certain society, each pair of people is classiï¬ed either as amicable
or hostile. Members of amicable pairs are said to be friends and members of
hostile pairs are said to be enemies. Suppose that the society has n people, q
amicable pairs and that, among any three people, at least two form an hostile
pair. Prove that there exists at least one member of the society whose set of
enemies contains, at most, no more than q

1 âˆ’4q
n2

amicable pairs.
11. Let G be a graph with n vertices, such that Ï‰(G) < k, where k â‰¥2. Prove that
G contains at least âŒŠn
kâˆ’1âŒ‹vertices with degrees less than or equal to âŒŠ(kâˆ’2)n
kâˆ’1 âŒ‹.
12. A set of 1001 people is such that each subset of 11 people contains at least two
who know each other. Show that there exist at least 101 people in the set such
that each one of them knows at least 100 other people within the set.
13. (China) Let A be a subset of S = {1, 2, 3, . . . , 106} having 101 elements. Prove
that there exist x1, x2, . . . , x100 in S such that, for 1 â‰¤j â‰¤100, the sets
Aj := {x + xj; x âˆˆA} are pairwise disjoint.
9Note that this is precisely TurÃ¡nâ€™s number T (n; l) when n = (l âˆ’1)q.

Chapter 6
Divisibility
This chapter is devoted to the elementary properties concerning the relation of
divisibility in the set of integers, with a particular emphasis on the division
algorithm, on the notion of greatest common divisor and the fundamental role
played by prime numbers. In spite of the elementary character of the arguments
we shall use, we will meet several interesting problems and results along the way,
like BÃ©zoutâ€™s theorem on the characterization of the greatest common divisor of two
integers and Euclidâ€™s theorem on the inï¬nitude of primes.
6.1
The Division Algorithm
We start by isolating our central object of study, namely, the relation of divisibility
between two integers.
Deï¬nition 6.1 Given a, b âˆˆZ, with b Ì¸= 0, we say that b divides a, and write b | a,
if there exists c âˆˆZ such that a = bc. In case b doesnâ€™t divide a, we write b âˆ¤a.
Let b be a nonzero integer. If b divides a, we also say that b is a divisor of a,
that a is divisible by b or that a is a multiple of b. If b | a and b > 0, then b is a
positive divisor of a. Note that every nonzero integer is a divisor of itself and of 0.
Also, Â±1 divide every integer.
The coming example starts by formalizing two concepts we are certainly familiar
with.
Example 6.2 An integer n is even provided it is a multiple of 2; otherwise, n is said
to be odd. According to Deï¬nition 6.1, the even integers are precisely those which
can be written in the form 2k, for some k âˆˆZ, i.e., the integers
. . . , âˆ’6, âˆ’4, âˆ’2, 0, 2, 4, 6, . . . .
Â© Springer International Publishing AG, part of Springer Nature 2018
A. Caminha Muniz Neto, An Excursion through Elementary Mathematics, Volume III,
Problem Books in Mathematics, https://doi.org/10.1007/978-3-319-77977-5_6
157

158
6
Divisibility
The remaining integers, namely,
. . . , âˆ’5, âˆ’3, âˆ’1, 1, 3, 5, . . . ,
are the odd ones. Thus, every odd integer is one plus an even integer, so that can be
generically denoted by writing 2k + 1, where k âˆˆZ.
The next example isolates an application of a simple algebraic identity which
will be quite useful for us.
Example 6.3 Let a and b be two given integers and k be a natural number.
(a) If a Ì¸= b, then (a âˆ’b) | (ak âˆ’bk).
(b) If a Ì¸= âˆ’b and k is odd, then (a + b) | (ak + bk).
Proof Standard basic algebra (cf. problem 2.1.18 of [8], for instance) gives
ak âˆ’bk = (a âˆ’b)(akâˆ’1 + akâˆ’2b + Â· Â· Â· + abkâˆ’2 + bkâˆ’1)
and, for odd k,
ak + bk = (a + b)(akâˆ’1 âˆ’akâˆ’2b + Â· Â· Â· âˆ’abkâˆ’2 + bkâˆ’1).
Since both akâˆ’1+akâˆ’2b+Â· Â· Â·+abkâˆ’2 +bkâˆ’1 and akâˆ’1 âˆ’akâˆ’2b+Â· Â· Â·âˆ’abkâˆ’2 +
bkâˆ’1 are integers, it sufï¬ces to recall Deï¬nition 6.1.
âŠ“âŠ”
Example 6.4 Prove that, for every k natural, 10k âˆ’1 is divisible by 9.
Proof It sufï¬ces to apply item (a) of the previous example: 10k âˆ’1 = 10k âˆ’1k is
divisible by 10 âˆ’1 = 9. Alternatively, note that
10k âˆ’1 = 99 . . . 9
  
k digits
= 9 Â· 11 . . . 1
  
k digits
,
which is clearly a multiple of 9, or write, with the aid of the binomial formula,
10k âˆ’1 = (9 + 1)k âˆ’1 =
k

j=0
k
j

9kâˆ’j âˆ’1 = 9
kâˆ’1

j=0
k
j

9kâˆ’1âˆ’j,
again a multiple of 9.
âŠ“âŠ”
The following proposition establishes some basic properties of the relation of
divisibility. The reader should make an effort to keep them in mind for future use.
Proposition 6.5 Let a, b, c be nonzero integers and x, y be any integers.
(a) If b | a and a | b, then a = Â±b.
(b) If c | b and b | a, then c | a.

6.1
The Division Algorithm
159
(c) If c | a and c | b, then c | (ax + by).
(d) If b | a, then |b| â‰¤|a|.
(e) If c | b, then c | ab.
(f) If b | a, then bc | ac.
Proof
(a) If aâ€² and bâ€² are integers such that a = baâ€² and b = abâ€², then a = (abâ€²)aâ€² =
a(aâ€²bâ€²), so that aâ€²bâ€² = 1. Therefore, aâ€² = Â±1, and it follows that a = Â±b.
(b) If a = baâ€² and b = cbâ€², with aâ€², bâ€² âˆˆZ, then a = (cbâ€²)aâ€² = c(aâ€²bâ€²), with
aâ€²bâ€² âˆˆZ. Thus, c | a.
(c) Let a = caâ€² and b = cbâ€², with aâ€², bâ€² âˆˆZ. Then ax + by = caâ€²x + cbâ€²y =
c(aâ€²x + bâ€²y), with aâ€²x + bâ€²y âˆˆZ. We conclude that c | (ax + by).
(d) Let a = baâ€², with aâ€² âˆˆZ. Then, a Ì¸= 0 â‡’aâ€² Ì¸= 0, and hence |aâ€²| â‰¥1. This
gives |a| = |baâ€²| = |b||aâ€²| â‰¥|b|.
(e) If b = cbâ€², with bâ€² âˆˆZ, then ab = c(abâ€²), with abâ€² âˆˆZ. Therefore, c | ab.
(f) If a = baâ€², with aâ€² âˆˆZ, then ac = (bc)aâ€², and hence bc | ac.
âŠ“âŠ”
Remarks 6.6
i. As a particular case of item (c) of the previous proposition, if c | a and c | b,
then c | (a Â± b). We shall use this remark several times in what follows.
ii. Item (c) of the previous proposition can be easily generalized to prove that, if
c | a1, . . . , an, then c | (a1x1 + Â· Â· Â· + anxn) for all x1, . . . , xn âˆˆZ.
iii. It follows from item (d) above that every nonzero integer has only a ï¬nite
number of divisors.
We continue by recalling that the integer part âŒŠxâŒ‹of x âˆˆR is deï¬ned by
âŒŠxâŒ‹= max{n âˆˆZ; n â‰¤x}.
(6.1)
In other words, given n âˆˆZ,
âŒŠxâŒ‹= n â‡”n â‰¤x < n + 1.
(6.2)
For instance, since 1 <
âˆš
2 < 2 we have âŒŠ
âˆš
2âŒ‹= 1; on the other hand, since
âˆ’3 < âˆ’2.3 < âˆ’2, then âŒŠâˆ’2.3âŒ‹= âˆ’3.
Our next result is usually referred to as the division algorithm1 for integers, and
is one of the cornerstones of the basic theory of divisibility.
Proposition 6.7 Given a, b âˆˆZ, with b Ì¸= 0, there exist unique q, r âˆˆZ such that
a = bq + r and 0 â‰¤r < |b|. Moreover, if b > 0, then
1At this point, the reader may wish to take another look at the deï¬nition of algorithm, at the
footnote of page 116.

160
6
Divisibility
q =
a
b

and r = a âˆ’
a
b

b.
(6.3)
Such integers q and r are respectively called the quotient and the remainder upon
division of a by b.
Proof Suppose ï¬rst that b > 0, and let q be the greatest integer such that bq â‰¤a.
Then bq â‰¤a < b(q+1), so that 0 â‰¤aâˆ’bq < b and it sufï¬ces to deï¬ne r = aâˆ’bq.
Note also that, since
q â‰¤a
b < q + 1,
such an integer q is precisely
- a
b
.
.
If b < 0, then âˆ’b > 0, so that there exist q, r âˆˆZ for which a = (âˆ’b)qâ€² + r,
with 0 â‰¤r < âˆ’b. Hence, a = b(âˆ’qâ€²)+r, with 0 â‰¤r < âˆ’b = |b|. Make q = âˆ’qâ€².
Now, suppose that a = bq+r = bqâ€²+râ€², with q, qâ€², r, râ€² âˆˆZ and 0 â‰¤r, râ€² < |b|.
Then,
|râ€² âˆ’r| < |b| and b(q âˆ’qâ€²) = râ€² âˆ’r.
If q Ì¸= qâ€², then |q âˆ’qâ€²| â‰¥1, so that
|b| â‰¤|b| Â· |q âˆ’qâ€²| = |râ€² âˆ’r| < |b|,
a contradiction. Therefore, q = qâ€² and hence r = râ€².
âŠ“âŠ”
The proof of the following corollary illustrates a typical application of the
division algorithm. For its statement, recall that a nonnegative integer m is a perfect
square provided m = n2, for some nonnegative integer n.
Corollary 6.8 Every perfect square leaves remainder:
(a) 0 or 1 upon division by 3.
(b) 0 or 1 upon division by 4.
(c) 0, 1 or 4 upon division by 8.
Proof Let n be a natural number.
(a) By the division algorithm, n leaves remainder 0, 1 or 2 upon division by 3, so
that n = 3q, 3q + 1 or 3q + 2, for some q âˆˆZ. Now, letâ€™s consider these three
possibilities:
â€¢
If n = 3q, then n2 = 3 Â· 3q2.
â€¢
If n = 3q + 1, then n2 = 3(3q2 + 2q) + 1.
â€¢
If n = 3q + 2, then n2 = 3(3q2 + 4q + 1) + 1.
Since 3q2 âˆˆZ, the uniqueness part of the division algorithm assures that, in
the ï¬rst case above, n2 leaves remainder 0 upon division by 3. By the same
argument, in the other two cases n2 leaves remainder 1 upon division by 3.

6.1
The Division Algorithm
161
(b) By the division algorithm, the remainder upon division of n by 4 is 0, 1, 2 or
3, so that n = 4q,4q + 1, 4q + 2 or 4q + 3, for some q âˆˆZ. Hence, we can
certainly give to this item a proof that parallels that of (a). Nevertheless, letâ€™s
see a simpler one: again by invoking the division algorithm (or Example 6.2),
we can write n = 2q or 2q + 1, for some q âˆˆZ.
â€¢
If n = 2q, then n2 = 4q2.
â€¢
If n = 2q + 1, then n2 = 4(q2 + q) + 1.
Hence, upon division by 4, in the ï¬rst case n2 leaves remainder 0, whereas in
the second it leaves remainder 1.
(c) Once more, we could give a proof of this fact as a direct application of the
division algorithm, by writing n = 8q + r for some q âˆˆZ and some r âˆˆ
{0, 1, 2, . . . , 7}. However, in order to avoid having to consider eight different
cases, we proceed as in the proof of item (b):
â€¢
If n = 2q, then n2 = 4q2. Now, there are two possibilities:
â€“ If q2 is even, say q2 = 2k for some k âˆˆN, then n2 = 8k.
â€“ If q2 is odd, say q2 = 2k + 1 for some k âˆˆN, then n2 = 8k + 4.
â€¢
If n = 2q + 1, then n2 = 4q(q + 1) + 1. However, since one of the integers
q and q + 1 is even, in any case the product q(q + 1) is even, so that we can
write q(q + 1) = 2k for some k âˆˆN. Then, n2 = 4 Â· 2k + 1 = 8k + 1.
Finally, as in the proof of the previous items, the expressions for n2 obtained
above guarantee that its possible remainders upon division by 8 are exactly 0, 1
or 4.
âŠ“âŠ”
The following elaboration of the division algorithm with play an important role
in subsequent discussions.
Corollary 6.9 Let a1, a2 and b be given integers, with b being nonzero. Then, b |
(a1 âˆ’a2) if and only if a1 and a2 leave equal remainders upon division by b.
Proof Suppose ï¬rst that a1 = bq1 + r and a2 = bq2 + r, with q1, q2, r âˆˆZ. Then,
a1 âˆ’a2 = b(q1 âˆ’q2), i.e., b | (a1 âˆ’a2).
Conversely, assume that b | (a1 âˆ’a2) and let a1 = bq1 + r1 and a2 = bq2 + r2,
with q1, q2, r1, r2 âˆˆZ and 0 â‰¤r1, r2 < |b|. Then,
a1 âˆ’a2 = (q1 âˆ’q2)b + (r1 âˆ’r2)
and, since b | (a1 âˆ’a2) and b | (q1 âˆ’q2)b, item (c) of Proposition 6.5 guarantees
that b divides r1 âˆ’r2 = (a1 âˆ’a2) âˆ’(q1 âˆ’q2)b. On the other hand, inequalities
0 â‰¤r1, r2 < |b| give |r1 âˆ’r2| < |b|, so that the only possibility for b dividing
r1 âˆ’r2 is having |r1 âˆ’r2| = 0 or, which is the same, r1 = r2.
âŠ“âŠ”
As an application of the previous result, the coming example computes the
possible values of the last digit of a perfect square.

162
6
Divisibility
Example 6.10 Every perfect square ends in 0, 1, 4, 5, 6 or 9.
Proof First of all, notice that the remainder of a natural number upon division by 10
coincides with its last digit (i.e., the rightmost one, in the decimal representation of
the number). Indeed, let m = 10mâ€² + a0, with mâ€² âˆˆZ+ and 0 â‰¤a0 â‰¤9; since 10mâ€²
ends in 0, it follows that the decimal representation of the sum 10mâ€² + a0 (which
equals m) has a0 as rightmost digit.
Now, let n âˆˆN and q, r âˆˆZ be such that n = 10q + r, with 0 â‰¤r â‰¤9. Then,
n2 = (10q + r)2 = 100q2 + 20qr + r2
= 10(10k2 + 2kr) + r2,
so that 10 | (n2 âˆ’r2), and Corollary 6.9 guarantees that n2 and r2 leave equal
remainders upon division by 10. Hence, our initial remark assures that the last digit
of n2 equals that of r2.
In order to ï¬nish the proof, it sufï¬ces to check which are the possible values of
the last digit of r2 when r varies from 0 to 9: 02 = 0; 12 and 92 end in 1; 22 and
82 end in 4; 32 and 72 end in 9; 42 and 62 end in 6; 52 ends in 5. Thus, the possible
values of the last digit of n2 are 0, 1, 4, 5, 6 or 9.
âŠ“âŠ”
Example 6.11 Let n > 1 be an integer. Show that any sequence of n consecutive
integers contains exactly one multiple of n.
Proof Let a + 1, a + 2, . . . , a + n be a sequence of n consecutive integers, with
a = nq + r, 0 â‰¤r < n. Then, 0 < n âˆ’r â‰¤n, so that a + (n âˆ’r) is one of the
numbers of our sequence. Now, note that
a + (n âˆ’r) = (nq + r) + (n âˆ’r) = n(q + 1),
which is a multiple of n.
To what is left to do, we shall apply again the result of Corollary 6.9: the numbers
a + 1, a + 2, . . . , a + n leave pairwise disjoint remainders upon division by n, since
the modulus of the difference between any two of them is at least 1 and at most
n âˆ’1. Therefore, our sequence contains at most one multiple of n.
âŠ“âŠ”
Problems: Sect. 6.1
1. Prove the divisibility criteria by 3 and by 9: the remainder of the division of
a natural number by 3 (resp. by 9) equals the remainder of the division by 3
(resp. by 9) of the sum of the digits of its decimal representation. In particular,
a natural number is a multiple of 3 (resp. of 9) if and only if the sum of its digits
is so.
2. Find the remainder of the division of 10k by 11.

6.1
The Division Algorithm
163
3. Prove the criterion of divisibility by 11: if the natural number n has decimal
representation n = (akakâˆ’1 . . . a1a0)10, then its remainder upon division by 11
equals that of the alternating sum
a0 âˆ’a1 + a2 âˆ’. . . + (âˆ’1)kâˆ’1akâˆ’1 + (âˆ’1)kak
upon division by 11. In particular, 11 | n if and only if 11 divides the alternating
sum of the digits of n.
4. (IMO) Find all natural numbers n of three digits, such that 11 | n and
n
11 is
equal to the sum of the squares of the digits of n.
5. (IMO) Find all n âˆˆN such that the product of the digits of the decimal
representation of n is equal to a n2 âˆ’10n âˆ’22.
6. * Given a natural number n, prove that the product of any n consecutive integers
is always divisible by n!.
7. (Hungary) For n âˆˆN, prove that 8n âˆ’3n âˆ’6n + 1n is a multiple of 10.
8. (Hungary) Prove that 5 divides 199 + 299 + 399 + 499 + 599.
For the next problem, given m âˆˆZ we shall let Zm denote the set
nZ = {nq; q âˆˆZ} = {0, Â±n, Â±2n, Â±3n, . . .}.
9. Let S be a set of integers containing 0 and satisfying the following condition:
x, y âˆˆS, x Ì¸= y â‡’x âˆ’y âˆˆS.
If S Ì¸= {0}, prove that:
(a) S âˆ©N Ì¸= âˆ….
(b) If x, y âˆˆS, then x + y âˆˆS.
(c) If n = min(S âˆ©N), then S = nZ.
10. * Compute the remainder of the division of 264 + 1 by 232 + 1. More generally,
given integers a, m and n, all greater than 1 and such that m > n, compute the
remainder of the division of a2m + 1 by a2n + 1.
The coming problem generalizes the binary representation of natural num-
bers, established in Example 4.12 of [8].
11. * Let m, a
âˆˆ
N, with a
>
1. Show that there exist unique integers
k, m0, m1, . . . , mk, with k â‰¥0, 0 â‰¤mj â‰¤a âˆ’1 for 0 â‰¤j â‰¤k, mk > 0
and
m = mkak + mkâˆ’1akâˆ’1 + Â· Â· Â· + m1a + m0.
The above expression for m is known as its representation in base a.
12. * For x âˆˆR, prove the following items:
(a) x âˆ’1 < âŒŠxâŒ‹â‰¤x.
(b) âŒŠx + 1âŒ‹= âŒŠxâŒ‹+ 1.

164
6
Divisibility
(c) âŒŠxâŒ‹+ âŒŠâˆ’xâŒ‹=

0, if x âˆˆZ
âˆ’1, if x /âˆˆZ .
13. * Let x, y âˆˆR and m, n âˆˆZ, with n > 0. Prove the following items:
(a) x â‰¤y â‡’âŒŠxâŒ‹â‰¤âŒŠyâŒ‹.
(b) âŒŠnxâŒ‹â‰¥nâŒŠxâŒ‹.
(c)

m+1
n

â‰¤
- m
n
.
+ 1.
(d)

âŒŠxâŒ‹
n

=
- x
n
.
.
(e) âŒŠxâŒ‹+ âŒŠyâŒ‹â‰¤âŒŠx + yâŒ‹â‰¤âŒŠxâŒ‹+ âŒŠyâŒ‹+ 1.
(f) âŒŠx + yâŒ‹+ âŒŠxâŒ‹+ âŒŠyâŒ‹â‰¤âŒŠ2xâŒ‹+ âŒŠ2yâŒ‹.
14. For x âˆˆR, prove that its closest integer is given by

x + 1
2

.
15. (ORM) Find all a, b âˆˆN such that
a2
b

+
b2
a

+ 1 =
a2 + b2
ab

+ ab.
16. (Hungary) Prove that there are no odd integers x, y and z such that
(x + y)2 + (y + z)2 = (x + z)2.
17. Let x, y and z be integers such that x2 + y2 = z2. Prove that 6 | xy.
For the coming problem, recall that a perfect cube is an integer of the form
q3, for some q âˆˆZ.
18. (Brazilâ€”adapted)
(a) Find all possible remainders upon the division of a perfect cube by 7.
(b) If x, y, z are integers such that x3 + y3 âˆ’z3 is a multiple of 7, prove that at
least one of x, y, z is a multiple of 7.
19. (Brazil) Find all natural numbers x, y, z, n such that nx + ny = nz.
20. (Soviet Union) For n > 3 integer, show that 1! + 2! + 3! + Â· Â· Â· + n! is never a
perfect square.
21. (Brazil) Prove that there doesnâ€™t exist integers x and y such that 15x2âˆ’7y2 = 9.
22. (Franceâ€”adapted) For k, m, n âˆˆN, with k > 2, let Fm = 22m + 1 be the m-th
Fermatâ€™s number2 and Gn = n(nâˆ’1)
2
(k âˆ’2)+n. For a ï¬xed k, we want to ï¬nd
(if any) all m, n âˆˆN such that Fm = Gn. To this end, do the following items:
(a) Prove that, if there exists such a pair (m, n), then there also exists a
nonnegative integer r such that n = 2r + 1.
2After Pierre S. de Fermat, French mathematician of the seventeenth century. As the perseverant
reader will testify, along the rest of this book we shall have a lot more to say on the enormous
legacy of Fermat to elementary Number Theory.

6.2
GCD and LCM
165
(b) Conclude from (a) that k âˆ’1 = 2rt1 for some t1 âˆˆN, so that 22m + 1 =
22r(2rt1 + t1 âˆ’1).
(c) Use induction on l âˆˆN to show that if we had 22m+1 = 2(l+1)r(2rtl+tlâˆ“1)
for some tl âˆˆN, then 22m + 1 = 2(l+2)r(2rtl+1 + tl+1 Â± 1).
(d) Conclude on the existence or not of such a pair (m, n).
23. (Russia) For each positive integer m, let s(m) denote the sum of the digits of
the decimal representation of m. Prove that there exist inï¬nitely many natural
numbers n for which s(3n) â‰¥s(3n+1).
6.2
GCD and LCM
We say that a nonzero integer d is a common divisor of given nonzero integers
a1, . . . , an if d | a1, . . . , d | an. Note that a1, . . . , an always have common divisors:
1, for instance. Moreover, since every nonzero integer has only a ï¬nite number
of divisors, a1, . . . , an have only a ï¬nite number of common divisors. Thus, the
following deï¬nition makes sense.
Deï¬nition 6.12 The greatest common divisor of the nonzero integers a1, a2, . . . ,
an, denoted gcd(a1, a2, . . . , an), is (as its name says) the greatest one of the common
divisors of a1, a2, . . . , an. Nonzero integers a1, a2, . . . , an are said to be pairwise
coprime or relatively prime, if gcd(a1, a2, . . . , an) = 1.
The coming result is due to the French mathematician Ã‰tienne BÃ©zout.3 For its
statement, given n âˆˆZ we let nZ denote the set of integer multiples of n, namely,
nZ = {nx; x âˆˆZ} = {0, Â±n, Â±2n, Â±3n, . . .}.
Theorem 6.13 (BÃ©zout)
Let a1, a2, . . . , an be nonzero integers. If
S =

n

i=1
aixi; xi âˆˆZ, âˆ€1 â‰¤i â‰¤n

,
then S = dZ, with d = gcd(a1, a2, . . . , an). In particular, there exist u1, u2, . . . ,
un âˆˆZ such that
gcd(a1, a2, . . . , an) = a1u1 + a2u2 + Â· Â· Â· + anun.
(6.4)
3French mathematician of the eighteenth century, BÃ©zout is one of the precursors of the area of
Mathematics known today as Algebraic Geometry. In spite of the coming result, his most famous
theorem is probably the one which states that, if f and g are real polynomials in two indeterminates
X, Y, with no common factors and with degrees respectively equal to m and n, then the number of
points of intersection of the curves f (x, y) = 0 and g(x, y) = 0 in the cartesian plane is at most
mnâ€”for example, two distinct ellipses have at most 2Â·2 = 4 points in common. For an elementary
exposition, we recommend [18] or [31].

166
6
Divisibility
Proof Itâ€™s immediate to see that every multiple of an element of S belongs to S, i.e.,
u âˆˆS â‡’uZ âŠ‚S.
(6.5)
On the other hand, since d divides a1x1+a2x2+Â· Â· Â·+anxn for all x1, x2, . . . , xn âˆˆZ,
we certainly have S âŠ‚dZ.
In order to establish the opposite inclusion, note ï¬rst that S does contain positive
integers; indeed, by choosing x1 = a1 and x2 = Â· Â· Â· = xn = 0, for instance, we
conclude that
a2
1 = a1x1 + a2x2 + Â· Â· Â· + anxn âˆˆS.
Since S contains positive integers, there exists a least positive integer dâ€² in S. If
we show that dâ€² = d, we will get d âˆˆS, and (6.5) (with d in place of u) will give
dZ âŠ‚S.
We ï¬rst claim that dâ€² | a1, . . . , an. Indeed, since dâ€² âˆˆS, there exist u1, u2, . . . ,
un âˆˆZ such that dâ€² = a1u1 + a2u2 + Â· Â· Â· + anun. Now, let a1 = dâ€²q + r, with
q, r âˆˆZ and 0 â‰¤r < dâ€². Then,
r = a1 âˆ’dâ€²q
= a1 âˆ’(a1u1 + a2u2 + Â· Â· Â· + anun)q
= a1(1 âˆ’u1q) + a2(âˆ’u2q) + Â· Â· Â· + an(âˆ’unq),
so that r âˆˆS. If 0 < r < dâ€², we would get a contradiction to the fact that dâ€²
is the least positive integer in S. Therefore, r = 0 and dâ€² | a1. Analogously, dâ€² |
a2, . . . , an.
Finally, since dâ€² is a common divisor of a1, a2, . . . , an, in order to get dâ€² = d is
sufï¬ces to show that dâ€² â‰¥d. To this end, if a1 = dq1, a2 = dq2, . . . , an = dqn,
with q1, q2, . . . , qn âˆˆZ, then
dâ€² = a1u1 + a2u2 + Â· Â· Â· + anun
= dq1u1 + dq2u2 + Â· Â· Â· + dqnun
= d(q1u1 + q2u2 + Â· Â· Â· + qnun),
so that 0 < d | dâ€². Thus, d â‰¤dâ€².
âŠ“âŠ”
Remark 6.14 In the notations of BÃ©zoutâ€™s theorem, one uses to say, thanks to (6.4),
that gcd(a1, a2, . . . , an) is a linear combination of a1, a2, . . . , an, with integer
coefï¬cients. For the time being, we shall concentrate on the existence of such
a way of representing gcd(a1, a2, . . . , an). However, an actual way of getting
u1, u2, . . . , un âˆˆZ as in (6.4) will be an easy consequence of Euclidâ€™s algorithm
(cf. Proposition 6.27), together with item (b) of Corollary 6.23.

6.2
GCD and LCM
167
In what follows, we collect several useful consequences of the previous theorem.
Corollary 6.15 Let a1, a2, . . . , an be nonzero integers with gcd equal to d. If dâ€² âˆˆ
N, then dâ€² | a1, a2, . . . , an if and only if dâ€² | d.
Proof Take integers u1, u2, . . . , un such that d = a1u1 + a2u2 + Â· Â· Â· + anun. Since
dâ€² | a1, a2, . . . , an, item i. of Remarks 6.6 guarantees that dâ€² | d. The converse is
immediate.
âŠ“âŠ”
Corollary 6.16 Let a1, a2, . . . , an be nonzero given integers with gcd equal to d.
(a) d = 1 if and only if there exist integers u1, u2, . . . , un such that a1u1 + a2u2 +
Â· Â· Â· + anun = 1.
(b) gcd
 a1
d , a2
d , . . . , an
d

= 1.
Proof
(a) If d = 1, the existence of such integers u1, u2, . . . , un follows from BÃ©zoutâ€™s
theorem. Conversely, let u1, u2, . . . , un be a set of integers satisfying the stated
conditions. Since d | a1, a2, . . . , an, it follows once more from item i. of
Remarks 6.6 that d | (a1u1 + Â· Â· Â· + anun), i.e., d | 1. Thus, d = 1.
(b) Letting d = a1u1 + a2u2 + Â· Â· Â· + anun, we have
 a1
d

u1 + Â· Â· Â· +
 an
d

un = 1.
Therefore, the desired result follows directly from item (a).
âŠ“âŠ”
Example 6.17 (China) Let a, b, c and d be nonzero integers, such that c + d Ì¸= 0
and ad âˆ’bc = 1. Prove that a+b
c+d is an irreducible fraction.
Proof We wish to prove that gcd(a + b, c + d) = 1. To this end, and according to
the previous corollary, it sufï¬ces to ï¬nd integers u and v such that
(a + b)u + (c + d)v = 1.
Since ad âˆ’bc = 1, one readily notices that u = d and v = âˆ’b is a possible choice.
âŠ“âŠ”
Remark 6.18 Let a1, a2, . . . , an be nonzero integers with gcd equal to d. Letting
ui = ai
d for 1 â‰¤i â‰¤n, item (b) of the previous corollary assures that u1, u2, . . . , un
are relatively prime integers, for which a1 = du1, a2 = du2, . . . , an = dun.
The above remark gives a way of writing nonzero integers a1, a2, . . . , an which
will reveal itself to be useful in a number of situations. The two coming examples
stress this point.
Example 6.19 Every nonzero rational number can be written as an irreducible
fraction, i.e., has a fractional representation of the form a
b, where a and b are
nonzero relatively prime integers. Indeed, let r be a nonzero rational number and
r = m
n be a fractional representation of it. Then, m and n are nonzero integers and,
letting d = gcd(m, n), we get m = da and n = db, with gcd(a, b) = 1. This gives

168
6
Divisibility
r = m
n = da
db = a
b ,
which gives the desired fractional representation of r.
Example 6.20 (Russia) Let a and b be natural numbers such that a+1
b
+ b+1
a
âˆˆN.
Prove that
gcd(a, b) â‰¤
âˆš
a + b.
Proof Let d = gcd(a, b), so that there exist integers u and v such that a = du,
b = dv and gcd(u, v) = 1. Then,
a + 1
b
+ b + 1
a
= du + 1
dv
+ dv + 1
du
= u(du + 1) + v(dv + 1)
duv
= d(u2 + v2) + (u + v)
duv
âˆˆN.
In turn, this assures that
uv Â· d(u2 + v2) + (u + v)
duv
= (u2 + v2) + u + v
d
is also a natural number. Hence, d | (u + v), so that d â‰¤u + v. But this gives
d2 â‰¤du + dv = a + b.
âŠ“âŠ”
Corollary 6.21 Given nonzero integers a1, a2, . . . , an, k, we have:
(a) gcd(ka1, ka2, . . . , kan) = |k| gcd(a1, a2, . . . , an).
(b) gcd(a1, a2, . . . , an) = gcd(gcd(a1, a2, . . . , anâˆ’1), an).
Proof
(a) Let d = gcd(a1, . . . , an) and dâ€² = gcd(ka1, . . . , kan). Since d divides all of
a1, . . . , an, we conclude that |k|d divides all of ka1, . . . , kan, so that |k|d is a
positive common divisor of ka1, . . . , kan. However, since dâ€² is the largest of
such common divisors, it follows that |k|d â‰¤dâ€². Conversely, since k divides
dâ€² and dâ€² divides all of ka1, . . . , kan, we get that dâ€²
|k| is a positive integer which
divides all of a1, . . . , an. This gives dâ€²
|k| â‰¤d or, which is the same, dâ€² â‰¤|k|d.
Therefore, dâ€² = |k|d.

6.2
GCD and LCM
169
(b) Let d = gcd(a1, . . . , an) and dâ€² = gcd(gcd(a1, a2, . . . , anâˆ’1), an). Since d |
a1, . . . , anâˆ’1, we get from Corollary 6.15 that d | gcd(a1, . . . , anâˆ’1). Then, d
divides both gcd(a1, . . . , anâˆ’1) and an, so that (once again from Corollary 6.15)
d divides the gcd of these two numbers, that is, d | dâ€². A similar reasoning shows
that dâ€² | d, thus ï¬nishing the proof.
âŠ“âŠ”
We specialize our discussion to the greatest common divisor of two nonzero
integers. Given a, b âˆˆZ \ {0}, with d = gcd(a, b), BÃ©zoutâ€™s theorem guarantees
the existence of integer u and v such that d = au + bv. It is important to note that
such a way of writing gcd(a, b) is not unique; actually, if t âˆˆZ, then we also have
d = a(uâˆ’tb)+b(v+ta). We shall have more to say about this in Proposition 6.26.
Later, we will establish a quite important and useful algorithm for effectively
ï¬nding the gcd of two nonzero given integers, namely, Euclidâ€™s algorithm. We start
by studying some properties of the gcd of two nonzero integers.
Proposition 6.22 For any nonzero integers a, b and c, we have that:
(a) If c | ab and gcd(b, c) = 1, then c | a.
(b) If a + bc Ì¸= 0, then gcd(a + bc, b) = gcd(a, b).
(c) If gcd(a, c) = 1, then gcd(a, bc) = gcd(a, b).
(d) If c | b and gcd(a, b) = 1, then gcd(a, c) = 1.
(e) If gcd(b, c) = 1, then gcd(a, bc) = gcd(a, b) gcd(a, c). In particular, if b and
c are relatively prime and divide a, then bc divides a.
Proof
(a) Let u, v âˆˆZ be such that bu+cv = 1. Multiplying both sides of this equality by
a, we get (ab)u + c(av) = a. Finally, since c | (ab), item (c) of Proposition 6.5
shows that c | a.
(b) Let d = gcd(a + bc, b) and dâ€² = gcd(a, b). Since dâ€² | a, b, we have that
dâ€² | a, a + bc. Hence, by Corollary 6.15 we get dâ€² | d. Conversely, since
d | (a + bc) and d | b, we conclude that d | [(a + bc) âˆ’bc], i.e., d | a and
d | b. Again by Corollary 6.15, we obtain d | dâ€² and, thus, d = dâ€².
(c) Set d = gcd(a, b) and dâ€² = gcd(a, bc). From d | b it follows that d | bc.
Therefore, d | a and d | bc, so that d | gcd(a, bc) = dâ€². In order to ï¬nish,
let us show that dâ€² | d: since gcd(a, c) = 1, BÃ©zoutâ€™s theorem guarantees the
existence of u, v âˆˆZ such that au + cv = 1. This way, a(bu) + (bc)v = b, and
such an equality, together with the fact that dâ€² | a and dâ€² | bc, proves that dâ€² | b.
Then, dâ€² | a and dâ€² | b, so that dâ€² | gcd(a, b) = d.
(d) Let d âˆˆZ be such that b = cd, and choose u, v âˆˆZ for which au + bv = 1.
Then, au + c(dv) = 1, and item (a) of Corollary 6.16 gives gcd(a, c) = 1.
(e) Once more, set d = gcd(a, b) and write a = du and b = dv, with u, v âˆˆZ
relatively prime. By successively applying Corollary 6.23 and the result of item
(c), we obtain
gcd(a, bc) = gcd(du, dvc) = d gcd(u, vc) = d gcd(u, c).

170
6
Divisibility
However, d | b and gcd(b, c) = 1 imply (cf. item (d)) gcd(d, c) = 1. Hence,
one further application of item (c) gives us
gcd(a, c) = gcd(du, c) = gcd(u, c).
Finally, taking together both relations above, we get
gcd(a, bc) = d Â· gcd(u, c) = gcd(a, b) gcd(a, c).
The rest is immediate.
âŠ“âŠ”
Corollary 6.23 Let a and b be nonzero integers and k, m and n be natural
numbers.
(a) If gcd(a, b) = 1, then gcd(am, bn) = 1.
(b) If gcd(a, b) = 1 and ab = kn, then there exist u, v âˆˆZ such that a = un,
b = vn.
Proof
(a) Item (c) of the previous proposition, with bnâˆ’1 in place of b and b in place of c,
gives
gcd(a, bn) = gcd(a, bnâˆ’1 Â· b) = gcd(a, bnâˆ’1).
It follows by induction on n that gcd(a, bn) = gcd(a, b) = 1. Analogously,
gcd(am, bn) = gcd(amâˆ’1 Â· a, bn) = gcd(amâˆ’1, bn)
and, by induction on m, we get gcd(am, bn) = gcd(a, bn) = 1.
Alternatively, since gcd(a, b) = 1, BÃ©zoutâ€™s theorem guarantees the exis-
tence of x, y âˆˆZ such that ax + by = 1. Hence, the formula for binomial
expansion gives
1 = (ax + by)n =
nâˆ’1

k=0
n
k

(ax)nâˆ’k(by)k + (by)n = aq + bnyn,
with q = nâˆ’1
k=0
n
k

anâˆ’kâˆ’1xnâˆ’k(by)k. Hence, item (a) of Corollary 6.16 shows
that gcd(a, bn) = 1. Starting from this last relation and arguing in an entirely
analogous way, we conclude that gcd(am, bn) = 1.
(b) Set u = gcd(a, k) and v = gcd(b, k). Since gcd(a, b) = 1, from item (d) of the
previous proposition we obtain
k = gcd(kn, k) = gcd(ab, k) = gcd(a, k) Â· gcd(b, k) = uv,

6.2
GCD and LCM
171
so that
ab = kn = unvn.
Now, u | a and gcd(a, b) = 1 give us (cf. item (d) of the former Proposition)
gcd(u, b) = 1; analogously, gcd(v, a) = 1. It thus follows from item (a) that
gcd(un, b) = 1 and gcd(vn, a) = 1.
Finally,
 un | ab and gcd(un, b) = 1 â‡’un | a â‡’un â‰¤a
vn | ab and gcd(vn, a) = 1 â‡’vn | b â‡’vn â‰¤b .
However, since ab = unvn, un â‰¤a and vn â‰¤b, the only possibility is to have
a = un and b = vn.
âŠ“âŠ”
We are now in position to prove a result which was already used in [8]. We
present it as the coming
Example 6.24 Given natural numbers n and k, with k > 1, either there exists m âˆˆN
such that n = mk or
kâˆšn is an irrational number.
Proof Assume that
kâˆšn
=
m
p , with m and p relatively prime naturals (cf.
Example 6.19). Then, pkn = mk, and condition gcd(m, p) = 1, together with
the results of the previous corollary, gives gcd(mk, pk) = 1. On the other hand,
pkn = mk assures that pk | mk. Therefore, the only way of pk and mk being
relatively prime is that pk = 1. However, since k > 1, we must then have p = 1, so
that n = mk.
âŠ“âŠ”
Roughly speaking (for now, any attempt of giving a more precise deï¬nition
would be useless), an equation in (more than one) integer variables is said to be
a diophantine equation.4 The analysis of general diophantine equation equations
is generally a very difï¬cult task, demanding quite sophisticated arguments to be
accomplished. We shall meet (and solve) several important examples of Diophantine
equations along the way. For the time being, let us take a look at a simple example.
Example 6.25 Prove that there does not exist x, y âˆˆN such that x3+3 = 4y(y+1).
Proof On the contrary, assume that x3 + 3 = 4y(y + 1) for some x, y âˆˆN. Then,
x3 + 4 = 4y(y + 1) + 1 = (2y + 1)2
4After Diophantus of Alexandria, Greek mathematician of the third century BC, who is considered
to be one of the founding fathers of Algebra and Number Theory. In his famous book Aritmetica,
Diophantus tried to systematically study integer solutions of certain particular kinds of polynomial
equations. These, in turn, passed to be deservedly known as diophantine.

172
6
Divisibility
and, hence,
x3 = (2y + 1)2 âˆ’22 = (2y âˆ’1)(2y + 3).
Now, if d = gcd(2y âˆ’1, 2y +3), then d is odd and divides (2y +3)âˆ’(2y âˆ’1) = 4,
so that d = 1. Therefore, the product of the relatively prime integers 2y âˆ’1 and
2y + 3 is a perfect cube, and Corollary 6.23 assures that 2y âˆ’1 and 2y + 3 must
themselves be perfect cubes. However, one cannot ï¬nd two perfect cubes whose
difference is equal to 4, so that we have reached a contradiction.
âŠ“âŠ”
In spite of the ad hoc character of the solution of the previous example, the theory
we have developed so far, on the gcd of two integers, allows us to completely solve
the diophantine linear equation in two variables ax + by = c. Here, x and y are
integer unknowns and a, b and c are given nonzero integer parameters.
Proposition 6.26 Let a, b and c be nonzero given integers. The equation ax +by =
c admits integer solutions if and only if gcd(a, b) | c. Moreover, if this is so and
d = gcd(a, b) and x = x0, y = y0 is some integer solution, then the formulas
x = x0 + b
d t, y = y0 âˆ’a
d t,
(6.6)
t âˆˆZ, give all possible integer solutions. In particular, if ab > 0 and x, y âˆˆZ is an
integer solution, then we can assume that x > 0 > y or x < 0 < y.
Proof Firstly, suppose that there exist x, y âˆˆZ for which ax + by = c. Since d | a
and d | b, it follows that d | (ax + by), i.e., d | c. Conversely, let c = de, with
e âˆˆZ, and (by BÃ©zoutâ€™s theorem) u and v be integers such that d = au + bv. Then,
c = a Â· eu + b Â· ev, so that the given equation admits the integer solution x0 = eu,
y0 = ev.
For the second part, assume again that d | c, and let x = x0, y = y0 be some
integer solution of the given equation. If x = x1, y = y1 is another integer solution,
we must have a(x1 âˆ’x0) = b(y0 âˆ’y1); cancelling d out of both sides of such an
equality, we obtain
a
d (x1 âˆ’x0) = b
d (y0 âˆ’y1).
Thus, b
d | a
d (x1 âˆ’x0) and, since gcd
 a
d , b
d

= 1, item (a) of the previous proposition
guarantees that b
d | (x1 âˆ’x0). Letting x1 âˆ’x0 = b
d t, we get y0 âˆ’y1 = a
d t, and
the stated formulas easily follow. Conversely, it is immediate to verify that such
formulas do provide integer solutions to the given equation.
For what is left, assume that a, b > 0 (the remaining case a, b < 0 can be dealt
with in an analogous way), so that
x0 + b
d t > 0 â‡”t > âˆ’dx0
b
and y0 âˆ’a
d t < 0 â‡”t > dy0
a .

6.2
GCD and LCM
173
Therefore, by choosing t âˆˆZ such that t > âˆ’dx0
b , dy0
a , and letting x1 = x0 + b
d t
and y1 = y0 âˆ’a
d t, we have x1 > 0, y1 < 0 and ax1 + by1 = c. Analogously,
one can show that we can take an integer solution x, y of the given equation with
x < 0 < y.
âŠ“âŠ”
Up to this moment, we only know that one can write the gcd of two nonzero
integers a and b as a linear combination au + bv, for some u, v âˆˆZ. However, we
still do not have at our disposal a method of effectively doing this. To remedy such a
situation, we consider the following algorithm, usually attributed to Euclid himself.
Euclidâ€™s Algorithm
Step 1
: a
= bq1 + r1
0 < r1 < b
Step 2
: b
= r1q2 + r2
0 < r2 < r1
Step 3
: r1
= r2q3 + r3
0 < r3 < r2
Â· Â· Â·
Â· Â· Â·
Step j
: rjâˆ’2 = rjâˆ’1qj + rj
0 < rj < rjâˆ’1
Step j + 1 : rjâˆ’1 = rjqj+1 + 0
Note that the execution of the above algorithm actually stops after a ï¬nite number
of steps, for, since r1, r2, . . . are integers satisfying b > r1 > r2 > Â· Â· Â· â‰¥0, there
must exist a least index j such that rj is the last nonzero remainder in the sequence
of divisions above.
The importance of Euclidâ€™s algorithm relies upon the following result.
Proposition 6.27 In the notations above, we have gcd(a, b) = rj.
Proof Several applications of item (b) of Proposition 6.22 give
gcd(a, b) = gcd(a âˆ’bq1, b) = gcd(r1, b)
= gcd(r1, b âˆ’r1q2) = gcd(r1, r2)
= gcd(r1 âˆ’r2q3, r2) = gcd(r3, r2)
Â· Â· Â·
= gcd(rjâˆ’1, rj) = rj,
where, in the last equality above, we used the fact that rj | rjâˆ’1.
âŠ“âŠ”
Euclidâ€™s algorithm provides a method for effectively ï¬nding a pair of integers u
and v whose existence is assured by BÃ©zoutâ€™s theorem, i.e., such that gcd(a, b) =
au + bv. Let us see how to do this by looking at a numerical
Example 6.28 Use Euclidâ€™s algorithm to show that gcd(120, 84) = 12. Then, solve
the linear diophantine equation 120x + 84y = 12.

174
6
Divisibility
Solution We start by executing Euclidâ€™s algorithm:
120 = 84 Â· 1 + 36
84 = 36 Â· 2 + 12
36 = 12 Â· 3.
Since 12 is the last nonzero remainder, it follows from Proposition 6.27 that
gcd(120, 84) = 12.
We can now ï¬nd integers u and v such that 12 = 120u + 84v by working
backwards with the successive divisions that led us to the gcd:
12 = 84 Â· 1 âˆ’36 Â· 2
= 84 Â· 1 âˆ’(120 âˆ’84 Â· 1) Â· 2
= 84 Â· 1 âˆ’120 Â· 2 + 84 Â· 2
= 84 Â· 3 + 120(âˆ’2).
Finally, with the solution x0 = âˆ’2, y0 = 3 of 120x + 84y = 12 in our hands, we
can get all solutions by applying formulas (6.6):
x = âˆ’2 + (84/12)t = âˆ’2 + 7t;
y = 3 âˆ’(120/12)t = 3 âˆ’10t.
âŠ“âŠ”
Euclidâ€™s algorithm and the proof of its correctedness (i.e., Proposition 6.27) are
also useful for theoretical purposes, as shown by the coming example.
Example 6.29 Let a, m and n be given natural numbers, with a > 1. If q, r âˆˆZ are
such that m = nq + r, with 0 â‰¤r < n, prove that
gcd(am âˆ’1, an âˆ’1) = agcd(m,n) âˆ’1.
Proof Let us start by showing that, if r = 0, then (an âˆ’1) | (am âˆ’1). To this end,
it sufï¬ces to observe that am âˆ’1 = (an)q âˆ’1, and to recall that we already know,
from Example 6.3, that an âˆ’1 divides (an)q âˆ’1.
We now prove that, if r > 0, then gcd(am âˆ’1, an âˆ’1) = gcd(an âˆ’1, ar âˆ’1).
Indeed, letting an = b whenever convenient, we get
am âˆ’1 = anq+r âˆ’1 = (anq âˆ’1)ar + (ar âˆ’1)
= ((an)q âˆ’1)ar + (ar âˆ’1)
= (an âˆ’1)(bqâˆ’1 + Â· Â· Â· + b + 1)ar + (ar âˆ’1).

6.2
GCD and LCM
175
Letting
c = (bqâˆ’1 + bqâˆ’2 + Â· Â· Â· + b + 1)ar
d = gcd(am âˆ’1, an âˆ’1)
dâ€² = gcd(an âˆ’1, ar âˆ’1)
we get
am âˆ’1 = (an âˆ’1)c + (ar âˆ’1).
Hence, item (b) of Proposition 6.22 gives
gcd(am âˆ’1, an âˆ’1) = gcd((an âˆ’1)c + (ar âˆ’1), an âˆ’1)
= gcd(ar âˆ’1, an âˆ’1).
For what is left to do, assume, without loss of generality, that m â‰¥n. If m = n,
we are done. Assume, then, that m > n, and consider Euclidâ€™s algorithm for m
and n:
m
= nq1 + r1
0 < r1 < n;
n
= r1q2 + r2
0 < r2 < r1;
r1
= r2q3 + r3
0 < r3 < r2;
Â· Â· Â·
Â· Â· Â·
rjâˆ’2 = rjâˆ’1qj + rj
0 < rj < rjâˆ’1;
rjâˆ’1 = rjqj+1 + 0.
Our previous discussion guarantee that
gcd(m, n) = gcd(n, r1) = gcd(r1, r2) = Â· Â· Â· = gcd(rjâˆ’1, rj) = rj.
Therefore, by applying the above reasoning several times, we get
gcd(am âˆ’1, an âˆ’1) = gcd(an âˆ’1, ar1 âˆ’1)
= gcd(ar1 âˆ’1, ar2 âˆ’1)
Â· Â· Â·
= gcd(arjâˆ’1 âˆ’1, arj âˆ’1)
= arj âˆ’1 = agcd(m,n)âˆ’1.
âŠ“âŠ”
We ï¬nish this section by studying the least common multiple of a ï¬nite set
of nonzero integers. Given nonzero integers a1, a2, . . . , an, the positive integer

176
6
Divisibility
|a1a2 . . . an| is a common multiple of a1, a2, . . . , an. Therefore, there exists a least
positive integer which is a common multiple of a1, a2, . . . , an, and this gives sense
to the following
Deï¬nition 6.30 Given nonzero integers a1, a2, . . . , an, the least common multiple
of a1, a2, . . . , an, denoted lcm (a1, a2, . . . , an), is the smallest positive integer which
is a common multiple of all of a1, a2, . . . , an.
The coming results establish the basic properties of the lcm .
Proposition 6.31 Let a1, a2, . . . , an be nonzero integers with lcm equal to m. An
integer M is a common multiple of a1, a2, . . . , an if and only if m | M.
Proof Let M be a common multiple of a1, a2, . . . , an and write M = mq + r, with
q, r âˆˆZ and 0 â‰¤r < m. Since a1 | m and a1 | M, it follows from Proposition 6.5
that a1 | (M âˆ’mq), i.e., a1 | r; analogously, a2, . . . , an | r, so that 0 â‰¤r < m is a
common multiple of a1, a2, . . . , an. However, since m is the least (positive) common
multiple of a1, a2, . . . , an, the only left possibility is that r = 0. Hence, m | M.
âŠ“âŠ”
Lemma 6.32 Let a1, a2, . . . , an be nonzero integers and k
âˆˆ
N. Then,
lcm (ka1, ka2, . . . , kan) = k Â· lcm (a1, a2, . . . , an).
Proof If M = lcm (ka1, ka2, . . . , kan) and m = lcm (a1, a2, . . . , an), then km is a
positive common multiple of ka1, ka2,. . . , kan, so that km â‰¥M. On the other hand,
since M is a (positive) common multiple of ka1, ka2,. . . , kan, it follows that k | M
and M/k is a positive common multiple of a1, a2, . . . , an; therefore, M/k â‰¥m or,
which is the same, M â‰¥km. We conclude that M = km, as desired.
âŠ“âŠ”
Our next result relates the gcd and the lcm of two nonzero integers.
Proposition 6.33 If a and b are nonzero integers, then
gcd(a, b) Â· lcm (a, b) = |ab|.
Proof We shall begin by showing that gcd(a, b) = 1 â‡’lcm (a, b) = |ab|. To this
end, let m be a positive common multiple of a and b. Since gcd(a, b) = 1, item
(e) of Proposition 6.22 guarantees that ab | m. Hence, m â‰¥|ab|, so that |ab| is the
smallest positive common multiple of a and b, i.e., |ab| = lcm (a, b).
For the general case, ï¬rst note that lcm (a, âˆ’b) = lcm (a, b); since we already
have gcd(a, âˆ’b) = gcd(a, b), we can assume, without loss of generality, that a, b >
0. Let d = gcd(a, b) and write a = du and b = dv, so that u and v are positive and
relatively prime integers. We wish to show that lcm (du, dv)d = d2uv or, by the
previous lemma, that lcm (u, v) = uv. But this is exactly what we have done in the
paragraph above.
âŠ“âŠ”
Example 6.34 (Japan) Find all pairs (a, b) of positive integers such that a â‰¥b and
lcm (a, b) + gcd(a, b) + a + b = ab.

6.2
GCD and LCM
177
Solution Set d = gcd(a, b), and let u, v âˆˆN be such that a = du and b = dv.
Then, a â‰¥b â‡’u â‰¥v and
d Â· lcm (a, b) = gcd(a, b) Â· lcm (a, b) = ab = d2uv,
so that lcm (a, b) = duv. Substituting these expressions in the original equation,
we conclude that it is equivalent to
u(v + 1) + (v + 1) = duv,
(6.7)
so that u | (v + 1). Thus, u â‰¤v + 1 and, therefore, u = v or u = v + 1. If u = v,
it follows from gcd(u, v) = 1 that u = v = 1, so that d = 4 and a = b = 4. If
u = v + 1, it follows from (6.7) that
d = u(v + 1) + (v + 1)
uv
= (v + 1)2 + (v + 1)
(v + 1)v
= v2 + 3v + 2
v2 + v
= 1 + 2
v ,
which in turn implies v = 1 or v = 2. By separately examining each of these cases,
we arrive at the remaining solutions: a = 6, b = 3 or a = 6, b = 4.
âŠ“âŠ”
Problems: Sect. 6.2
1. (IMO) For n âˆˆN, prove that gcd(21n + 4, 14n + 3) = 1.
2. (OIM) Find all positive integers m and n such that 2m + 1 = n2.
3. Consider two inï¬nite and nonconstant arithmetic progressions whose terms are
positive integers. Prove that there exist inï¬nitely many naturals which are terms
of both of these sequences if and only if the gcd of their common differences
divides the difference of their ï¬rst terms.
4. * Given a, m, n âˆˆN, with m Ì¸= n, prove that gcd(a2n + 1, a2m + 1) = 1 or 2.
5. (Japan) Prove that gcd(n! + 1, (n + 1)! + 1) = 1, for every n âˆˆN.
6. (TT) If a and b are natural numbers for which ab | (a2 + b2), show that a = b.
7. (Brazil) We partition an a Ã— b rectangle (a, b âˆˆN) into ab squares 1 Ã— 1.
Prove that each diagonal of the rectangle crosses the interior of exactly a + b âˆ’
gcd(a, b) squares 1 Ã— 1.
8. Let n and k be positive integers, with n â‰¥k. Prove that the gcd of the binomial
numbers
n
k

,
n + 1
k

, . . . ,
n + k
k

equals 1.

178
6
Divisibility
9. (MiklÃ³s-Schweitzer) Let n > 1 be a given integer and 2k be the greatest power
of 2 that divides it. Prove that the gcd of the binomial numbers
2n
1

,
2n
3

,
2n
5

, . . . ,

2n
2n âˆ’1

is equal to 2k+1.
10. (USAâ€”adapted) For a ï¬xed k âˆˆN, show that
max{gcd(n2 + k, (n + 1)2 + k); n âˆˆN} = 4k + 1.
11. (Hungary) If a, b and c are positive integers such that 1
a + 1
b = 1
c, prove that
there exist positive integers q, u and v for which gcd(u, v) = 1 and a = qu(u+
v), b = qv(u + v) and c = quv.
12. (England) Let x and y be natural numbers such that 2xy divides x2 + y2 âˆ’x.
Prove that x is a perfect square.
13. (USA) Of any set of ten consecutive natural numbers, show that one can always
choose at least one element which is relatively prime to all of the nine remaining
ones.
14. Let a, b and m be given naturals, with gcd(a, m) = 1. Show that
mâˆ’1

j=0
(aj + b
m
)
= 1
2(a âˆ’1)(m âˆ’1) + b.
For the coming problem, recall (cf. [8], for instance) that the fractionary
part of x âˆˆR is the real number {x} such that {x} = xâˆ’âŒŠxâŒ‹. Thus, {x} âˆˆ[0, 1)
and {x} = 0 â‡”x âˆˆZ.
15. (Japan) Let n, r âˆˆN be such that n > 1 and n âˆ¤r. If d = gcd(n, r), prove that
nâˆ’1

i=1
ri
n
/
= 1
2(n âˆ’d).
16. (Putnam) Given m, n âˆˆN, with m â‰¥n, prove that
gcd(m, n)
m
m
n

âˆˆN.
17. (Bulgaria) Let (an)nâ‰¥1 be the sequence of positive integers deï¬ned by a1 = 2
and an+1 = a2
n âˆ’an + 1 for n âˆˆN. Show that any two terms of this sequence
are relatively prime.
18. * As usual, let (Fn)nâ‰¥1 be the Fibonacci sequence, i.e., the sequence given by
F1 = F2 = 1 and Fk+2 = Fk+1 + Fk for every k âˆˆN. Do the following
items:

6.2
GCD and LCM
179
(a) Prove that gcd(Fn, Fn+1) = 1 for every n âˆˆN.
(b) Prove that, for all n, k âˆˆN, with n > 1, one has Fn+k = Fnâˆ’1Fk+FnFk+1.
(c) Use item (b) to successively conclude that, for all n, q, r âˆˆN:
(i) gcd(Fnq, Fn) = Fn.
(ii) gcd(Fnqâˆ’1, Fn) = 1.
(iii) gcd(Fnq+r, Fn) = gcd(Fr, Fn).
(d) Show that gcd(Fn, Fm) = Fgcd(m,n) for all m, n âˆˆN.
19. (Croatia) Let (an)nâ‰¥1 be a sequence of integers such that a1 = 1 and an+2 =
a2an+1 + an for every n âˆˆN. Prove that gcd(am, an) = agcd(m,n).
20. Given relatively prime natural numbers a and b, establish the following
results:
(a) Every natural number n > ab can be written as n = ax+by, with x, y âˆˆN.
(b) The natural number ab cannot be written as in (a).
(c) Every integer n > ab âˆ’a âˆ’b can be written in the form n = ax + by, for
some nonnegative integers x and y.
(d) The integer ab âˆ’a âˆ’b cannot be written as in (c).
(e) There are exactly 1
2(a âˆ’1)(b âˆ’1) nonnegative integers which cannot be
written in the form ax + by, for some nonnegative integers x and y.
21. (IMOâ€”adapted) Let a, b and c be pairwise relatively prime natural numbers.
(a) Show that there do not exist x, y, z âˆˆZ+ such that 2abc âˆ’ab âˆ’bc âˆ’ca =
xbc + yac + zab.
(b) If n âˆˆN satisï¬es n > abc âˆ’a âˆ’bc, use the result of the previous problem
to establish the existence of x, t âˆˆZ+ such that n = xbc + ta, with 0 â‰¤
x â‰¤a âˆ’1.
(c) Show that the integer t of item (b) is greater than bc âˆ’b âˆ’c, and use
the result of the previous problem once again to establish the existence of
y, z âˆˆZ+ for which t = bz + cy.
(d) If n âˆˆN satisï¬es n > 2abc âˆ’ab âˆ’bc âˆ’ca, use the results of items (b) and
(c) to show that there exist x, y, z âˆˆZ+ such that n = xbc + yac + zab.
22. (IMOâ€”shortlist) Generalize the result of the previous problem in the following
way: if a1, a2, . . . , an are pairwise relatively prime natural numbers and
A =
â§
â¨
â©
n

j=1
xja1 . . .*aj . . . an; x1, . . . , xn âˆˆZ+
â«
â¬
â­
(here, *aj indicates that aj is not present in the product xja1 . . .*aj . . . an), then
"
n âˆ’1 âˆ’
n

i=1
1
ai
# n

i=1
ai
is the greatest natural number which does not belong to A.

180
6
Divisibility
23. It is interesting to ask how efï¬cient Euclidâ€™s algorithm is, upon computing the
gcd of two nonzero integers. The purpose of this problem is to shed light on this
question, by proving a result of LamÃ©.5 To this end, do the following items:
(a) If Fk is the k-th Fibonacci number and n âˆˆN, prove that Fn+5 > 10Fn.
Then, deduce that F5n+2 > 10n, so that the decimal representation of F5n+2
has at least n + 1 digits.
(b) Given natural numbers a > b, assume that Euclidâ€™s algorithm takes n steps
to compute gcd(a, b). Prove that b â‰¥Fnâˆ’1.
(c) Prove LamÃ©â€™s theorem: given natural numbers a > b, the number of steps
needed in Euclidâ€™s algorithm to compute gcd(a, b) is at most ï¬ve times the
number of decimal digits of b.
24. (Brazil) Let n > 1 be an integer. Prove that
1 + 1
2 + 1
3 + Â· Â· Â· + 1
n
is never an integer.
6.3
Prime Numbers
An integer p > 1 is prime if its only positive divisors are 1 and p. An integer
a > 1 which is not prime is said to be composite. We shall prove in a few moments
(cf. Theorem 6.38) that the set of primes is inï¬nite. For the time being, and for the
readerâ€™s convenience, we list below all prime numbers less than 50; their primalities
can be checked directly and without difï¬culty (see, also, the discussion below on the
Eratosthenesâ€™ sieve):
2, 3, 5, 7, 11, 13, 17, 19, 23, 29, 31, 37, 41, 43, 47.
Our purpose in this section is to study the elementary properties of prime
numbers, paying special attention to their relation to composite numbers. We start
with the following auxiliary result, which is known as Euclidâ€™s lemma.
Lemma 6.35 (Euclid) Every integer n > 1 can be written as a product of ï¬nitely
many primes, not necessarily distinct.6
Proof Let us make induction on n. For n = 2 there is nothing to do, for 2 is prime.
Now, let m > 2 be a given integer and assume that every integer n such that 2 â‰¤
5After Gabriel LamÃ©, French mathematician of the nineteenth century.
6Here, for the sake of simplifying the writing, we say that a prime is a product of one prime. This
is in accordance with the general deï¬nition of 0n
j=1 aj, for which 01
j=1 aj = a1.

6.3
Prime Numbers
181
n < m can be written as a product of ï¬nitely many primes; we shall prove that the
same is true for m itself, and to this end we distinguish two distinct cases:
(i) if m is prime, there is nothing to do.
(ii) If m is not prime, there exist integers a and b such that m = ab, with 1 <
a, b < m. By induction hypothesis, each of a and b can be written as a product
of ï¬nitely many primes, say a = p1 . . . pk and b = q1 Â· Â· Â· ql, with k, l â‰¥1 and
p1, . . . , pk, q1, . . . , ql primes. Therefore,
m = ab = p1 . . . pkq1 Â· Â· Â· ql,
so that m is also a product of ï¬nitely many primes.
âŠ“âŠ”
A useful consequence of the previous lemma is the following criterion for
searching prime divisors of a composite numbers, due to the Greek mathematician
of the third century BC Eratosthenes of Cyrene.7
Corollary 6.36 (Eratosthenes)
If an integer n > 1 is composite, then n has a
prime divisor p such that p â‰¤âˆšn.
Proof Since n is composite, we can write n = ab, with a and b integers such that
1 < a â‰¤b. Letting p be a prime divisor of a (which exists, by Euclidâ€™s lemma), it
follows that p | n and
p2 â‰¤a2 â‰¤ab = n.
Therefore, p â‰¤âˆšn.
âŠ“âŠ”
The previous corollary can be successfully used to establish the primality of a
small natural number, as shown by the coming example. The method involved is
known in mathematical literature as Eratosthenesâ€™ sieve, and consists in dividing
the natural number at scrutiny by each of the primes which are less that its square
root. According to Eratosthenesâ€™ theorem, if none of such divisions is exact, then
the number is prime.
Example 6.37 Use the previous result to prove that 641 is prime.
Proof Firstly, note that 25 <
âˆš
641 < 26. Hence, if 641 is composite, then
Eratosthenes theorem guarantees that 641 must possess a prime divisor p â‰¤25,
so that
p âˆˆ{2, 3, 5, 7, 11, 13, 17, 19, 23}.
7Apart from his work in Number Theory, another important achievement of Eratosthenes was an
indirect measurement of the Earthâ€™s diameter, with an impressive degree of accuracy for his time.

182
6
Divisibility
Nevertheless, it is immediate to verify that, upon dividing 641 by each of the primes
above, no division is exact (i.e., leaves zero remainder). Therefore, 641 is indeed a
prime number.
âŠ“âŠ”
A slight modiï¬cation of the procedure above can be used to ï¬nd prime numbers
recursively. For example, imagine one wants to ï¬nd all prime numbers less than or
equal to 150. One starts by erasing, from the list of odd numbers from 3 to 150, those
which are multiples of 3. After that, the least number greater than 3 and not erased
is 5, which is then prime; thus, we perform a second step, by erasing all multiples of
5. This step leaves 7 as the least number not erased, so that 7 is prime; in the third
step, we then erase all multiples of 7. Continuing to proceed this way, we get the
following list as result:
3
5
7
9
11 13 

15 17
19 

21
23 

25 
27
29
31 
33 

35 37 

39 41
43 

45
47 

49 
51
53 
55 

57
59
61 

63 
65
67 
69
71 73 

75 

77
79 

81
83 

85


87
89 

91 
93 

95 97 

99 101 103 
105 107 109 
111 113

115 
117 
119 
121 
123 
125 127 
129 131 
133 
135 137 139 
141

143 
145 
147 149 151 
153 
155 157 
159 
161 163 
165 167 
169
The numbers which were not erased are prime.
In spite of the above, the importance of Eratosthenesâ€™ sieve lies on a theoretical,
rather than practical, level. For instance, in order to decide whether or not 999997 is
prime, we would have to divide it by all prime numbers less than
âˆš
999997 âˆ¼= 1000,
which is not feasible without the aid of computer programming.8
Back to Euclidâ€™s Lemma 6.35, if we gather together equal primes we conclude
that every integer n > 1 can be write in the form n = pÎ±1
1 . . . pÎ±k
k , with p1, . . . , pk
pairwise distinct primes and Î±1, . . . , Î±k âˆˆN. We shall see in Theorem 6.43 that, up
to a permutation of factors, such a way of writing n is unique. However, before we
do that, let us prove another result of Euclid, which shows that the set of primes is
inï¬nite.
Theorem 6.38 (Euclid)
The set of prime numbers is inï¬nite.
Proof By induction on n, let us prove that if N contains n primes, then it contains
n + 1 primes. Suppose, then, that p1, . . . , pn are pairwise distinct primes, and let
m = p1 . . . pn + 1.
8Actually, the situation here is even more dramatic. With a little more work, it is possible to
show that Eratosthenesâ€™ sieve is not a polynomial algorithm. This means that the quantity of
arithmetic operations one needs to perform in order to compute the n-th prime with the aid of it
grows exponentially with n. Thus, even with the aid of a powerful computer, Eratosthenesâ€™ sieve
is not a feasible primality algorithm for large numbers.

6.3
Prime Numbers
183
By Euclidâ€™s Lemma 6.35, there exists a prime p such that p | m. If p = pi for
some 1 â‰¤i â‰¤n, then p | p1 . . . pn. It follows from Proposition 6.5 that p divides
the difference m âˆ’p1 . . . pn, i.e., p | 1, which is an absurd. Therefore, p is a prime
number distinct from all of the piâ€™s, so that we have at least n + 1 primes in N.
âŠ“âŠ”
Remark 6.39 In spite of the above result, there are arbitrarily large gaps in the
sequence of primes. Indeed, given an integer k â‰¥3, for all of the consecutive and
positive integers a + 2, a + 3, . . . , a + k to be composite it sufï¬ces that a be a
common multiple of 2, 3, . . . , k. We shall have more to say on the distribution of
primes along N in Chap. 9.
As the next example shows, small variations of the argument used in the proof
of Euclidâ€™s theorem allow us to prove that several arithmetic progressions contain
inï¬nitely many primes among their terms.9
Example 6.40 Prove that there are inï¬nitely many primes of the form 4k âˆ’1.
Proof Assume that there is only a ï¬nite number of primes of the form 4k âˆ’1, say
p1 = 3, p2 = 7, p3 = 11, . . . , pt, and consider the number
m = 4p1p2 . . . pt âˆ’1.
Then, m > 1 and, letting mâ€² = p1p2 . . . pt, we have m = 4mâ€² âˆ’1.
On the other hand, Lemma 6.35 guarantees the existence of odd primes q1, . . . , ql
such that m = q1 . . . ql. Now, observe that every odd prime is of one of the forms
4qâ€² âˆ’1 or 4qâ€² + 1, for some qâ€² âˆˆZ. If qi = 4qâ€²
i + 1 for 1 â‰¤i â‰¤t, we would get
m = q1 . . . ql = (4qâ€²
1 + 1) . . . (4qâ€²
l + 1) = 4q + 1,
for some q âˆˆN. But this would contradict the fact that m = 4mâ€² âˆ’1. Hence, there
exists at least one index 1 â‰¤i â‰¤l such that qi = 4qâ€²
i âˆ’1.
Finally, since p1, p2, . . . , pt are all primes of the form 4k âˆ’1, we must have
qi = pj for some 1 â‰¤j â‰¤t. However, since qi | m, we conclude that pj should be
a divisor of m = 4p1p2 . . . pt âˆ’1, which is a contradiction.
âŠ“âŠ”
For the proof of Theorem 6.43 we shall need the following auxiliary result, which
is important in itself.
Lemma 6.41 If a1, . . . , an âˆˆN and p is a prime such that p | a1a2 . . . an, then
there exists 1 â‰¤i â‰¤n such that p | ai. In particular, if a1, . . . , an are also primes,
then there exists 1 â‰¤i â‰¤n such that p = ai.
9Actually, it is possible to prove a much more general result, due to the Dirichlet, which states that
every inï¬nite and nonconstant arithmetic progression of naturals contains inï¬nitely many primes,
provided its ï¬rst term and its common difference are relatively prime. We shall see a relevant
particular case of Dirichletâ€™s theorem at Sect. 20.2.

184
6
Divisibility
Proof We shall prove the case n = 2, the general case being totally analogous.
Assume that p | (ab) but p âˆ¤a, and let d = gcd(a, p). Since d | p, we have d = 1
or d = p; however, since p âˆ¤a and d | a, we conclude that d Ì¸= p, and hence d = 1.
Thus, since p | (ab) and gcd(a, p) = 1, it follows from item (a) of Proposition 6.22
that p | b.
The particular case follows at once from the ï¬rst part, together with the very
deï¬nition of prime number.
âŠ“âŠ”
Example 6.42 If p is a prime number, then p divides each of the binomial numbers
p
k

, for every integer 1 â‰¤k â‰¤p âˆ’1.
Proof We can restrict to the case of an odd p. Since
p
k

=
p!
k!(p âˆ’k)! = (k + 1) . . . (p âˆ’1)p
(p âˆ’k)!
is an integer, we have that (p âˆ’k)! divides (k + 1) . . . (p âˆ’1)p. Now, since p is
prime and p âˆ¤1, 2, . . . , p âˆ’k, the previous lemma guarantees that p âˆ¤(p âˆ’k)!,
and hence gcd(p, (p âˆ’k)!) = 1. Therefore, item (a) of Proposition 6.22 shows that
(p âˆ’k)! must divide (k + 1) . . . (p âˆ’1). In turn, this fact allows us to write
p
k

= (k + 1) . . . (p âˆ’1)
(p âˆ’k)!



âˆˆN
Â·p,
so that
p
k

is a multiple of p.
âŠ“âŠ”
The coming result is the cornerstone of elementary Number Theory, and is
known as the Fundamental Theorem of Arithmetic. Whenever convenient, we
shall abbreviate it as FTA.
Theorem 6.43 Every integer n > 1 can be written as a product of powers of
distinct primes. Moreover, such a decomposition of n is unique in the following
sense: if n = pÎ±1
1 . . . pÎ±k
k
= qÎ²1
1 . . . qÎ²l
l , with p1 < Â· Â· Â· < pk and q1 < Â· Â· Â· < ql
being primes and Î±i, Î²j â‰¥1 being integers, then k = l and pi = qi, Î±i = Î²i for
1 â‰¤i â‰¤k.
Proof The existence was established in the paragraph preceding Theorem 6.38.
For the uniqueness, let the integer n > 1 have two decompositions as in the
statement. Since p1 | n, we have that p1 | qÎ²1
1 . . . qÎ²l
l , and the previous lemma
guarantees the existence of an index 1 â‰¤j â‰¤l such that p1 = qj. On the other
hand, since q1 | n, we have that q1 | pÎ±1
1 . . . pÎ±k
k ; again by the previous lemma, there
exists an index 1 â‰¤i â‰¤k such that q1 = pi. Thus, p1 = qj â‰¥q1 = pi â‰¥p1, from
where we get p1 = q1 and, hence,
n = pÎ±1
1 pÎ±2
2 . . . pÎ±k
k = pÎ²1
1 qÎ²2
2 . . . qÎ²l
l .

6.3
Prime Numbers
185
We shall now prove that Î±1 = Î²1. By contradiction, assume that Î±1 Ì¸= Î²1. We have
two different cases to consider:
(i) Î±1 < Î²1: then pÎ±2
2 . . . pÎ±k
k
= pÎ²1âˆ’Î±1
1
qÎ²2
2 . . . qÎ²l
l , so that p1 | pÎ±2
2 . . . pÎ±k
k .
Arguing as above, there would exist an index 2 â‰¤i â‰¤k such that p1 = pi,
which is an absurd.
(ii) Î±1 > Î²1: then pÎ±1âˆ’Î²1
1
pÎ±2
2 . . . pÎ±k
k
= qÎ²2
2 . . . qÎ²l
l . Again as above, we would get
p1 = qj for some index 2 â‰¤j â‰¤l, and this would give us the contradiction
p1 = qj > q1 = p1.
Thus, Î±1 = Î²1, and it follows that pÎ±2
2 . . . pÎ±k
k = qÎ²2
2 . . . qÎ²l
l .
Repeating the above reasoning several times (there is an induction here, which
shall not be formalized for the sake of clearness), we successively conclude that
p2 = q2 and Î±2 = Î²2, p3 = q3 and Î±3 = Î²3, etc. At the end, if k < l we would get
1 = qÎ²k+1
k+1 . . . qÎ²l
l , which is clearly impossible. Likewise, k > l is also impossible,
so that k = l and there is nothing left to do.
âŠ“âŠ”
The FTA will be almost omnipresent along these notes. However, it is instructive
to the reader that we pause for a moment to illustrate how one can proï¬tably use
such a result in concrete situations.
Example 6.44 The natural numbers x and y are such that 3x2 +x = 4y2 +y. Prove
that x âˆ’y is a perfect square.
Proof Let p be a prime number and pa, pb and pc be the greatest powers of p
dividing x, y and x âˆ’y, respectively (here we are already invoking the FTA). Let us
momentarily assume that a â‰¤b. Then, p2a | x2, y2, and it follows from item (c) of
Proposition 6.5 that p2a | (4y2 âˆ’3x2). Since x âˆ’y = 4y2 âˆ’3x2, we then have that
p2a | (x âˆ’y), and the uniqueness part of the FTA gives c â‰¥2a. On the other hand,
writing
x2 = (x âˆ’y) âˆ’4(y2 âˆ’x2) = (x âˆ’y)[1 + 4(y + x)]
and recalling the way we chose c, we conclude that pc | x2. Therefore, once more
from the uniqueness part of the FTA, we obtain c â‰¤2a. Hence, c = 2a, which is an
even number. If a â‰¥b we conclude, quite similarly, that c = 2b. Finally, since the
prime p was arbitrarily chosen, the FTA presents x âˆ’y as the product of powers of
primes with even exponents. Therefore, x âˆ’y is a perfect square.
âŠ“âŠ”
The presentation of an integer n > 1 as the product of powers of distinct primes
is said to be its canonical factorisation or decomposition in prime powers. The
following corollaries collect some useful consequences of the existence of such a
factorisation.
Corollary 6.45 Let a, b, m and n be natural numbers for which am = bn. If
gcd(m, n) = 1, then there exists c âˆˆN such that a = cn and b = cm.

186
6
Divisibility
Proof It is clear that a and b are divisible by exactly the same primes, say p1 <
. . . < pk. Let a = pÎ±1
1 . . . pÎ±k
k
and b = pÎ²1
1 . . . pÎ²k
k , with Î±i, Î²i â‰¥1, be the
canonical decompositions of a and b. Then,
pmÎ±1
1
. . . pmÎ±k
k
= am = bn = pnÎ²1
1
. . . pnÎ²k
k
,
and the uniqueness part of the FTA gives
mÎ±i = nÎ²i, âˆ€1 â‰¤i â‰¤k.
(6.8)
Thus, m | nÎ²i and, since m and n are relatively prime, item (a) of Proposition 6.22
allows us to conclude that m | Î²i. Letting ui âˆˆN be such that Î²i = mui, (6.8) gives
Î±i = nui. Therefore, letting c = pu1
1 . . . puk
k , we obtain
a = pnu1
1
. . . pnuk
k
= cn and b = pmu1
1
. . . pmuk
k
= cm.
âŠ“âŠ”
Let us now learn how to obtain the canonical decompositions of the positive
divisors of an integer greater than 1 and the gcd and lcm of two nonzero integers.
Corollary 6.46 If n = pÎ²1
1 . . . pÎ²k
k
is the canonical decomposition of the integer
n > 1, then the positive divisors of n are the natural numbers of the form
pÎ±1
1 . . . pÎ±k
k , with 0 â‰¤Î±i â‰¤Î²i for 1 â‰¤i â‰¤k. In particular, letting d(n) denote
the number of positive divisors of n, then
d(n) =
k
i=1
(Î²i + 1).
(6.9)
Proof If d > 1 is a divisor of n and p is a prime that divides d, then p also divides
n, so that p is equal to one of the primes p1, . . . , pk. However, since this is valid
for every prime divisor of d, it follows that d = pÎ±1
1 . . . pÎ±k
k , with Î±i â‰¥0 for every
i (we not necessarily have Î±i â‰¥1, for it may well happen that pi âˆ¤d for one or
more values of i). Now, if dâ€² âˆˆN is such that n = ddâ€², then, as above, we get
dâ€² = p
Î±â€²
1
1 . . . p
Î±â€²
k
k , with Î±â€²
i â‰¥0 for every i. Therefore,
p
Î±1+Î±â€²
1
1
. . . p
Î±k+Î±â€²
k
k
= ddâ€² = n = pÎ²1
1 . . . pÎ²k
k ,
and the uniqueness part of the FTA gives Î±i + Î±â€²
i = Î²i for every i. In particular,
Î±i â‰¤Î²i for every i.
Conversely, it is immediate to show that every natural number d of the form
pÎ±1
1 . . . pÎ±k
k , with 0 â‰¤Î±i â‰¤Î²i for 1 â‰¤i â‰¤k, is a positive divisor of n.
For what is left to do, what we did above, again in conjunction with the
uniqueness part of the FTA, assures that the number of positive divisors of n

6.3
Prime Numbers
187
coincides with the number of sequences (Î±1, . . . , Î±k) of integers such that 0 â‰¤Î±i â‰¤
Î²i for 1 â‰¤i â‰¤k. Since there are Î²i + 1 possibilities for Î±i, formula (6.9) follows at
once from the fundamental principle of counting (cf. Corollary 1.9).
âŠ“âŠ”
The following example presents a simple application of the former result.
Example 6.47 Prove that the natural number n is a perfect square if and only if d(n)
is odd.
Proof Firstly, since 1 = 12 and d(1) = 1 is odd, we can assume that n > 1. Then,
let n > 1 be an integer and n = pÎ²1
1 . . . pÎ²k
k be its canonical factorisation into prime
powers.
If n is a perfect square, say n = m2, with m âˆˆN, then m | n, so that m =
pÎ±1
1 . . . pÎ±k
k , with 0 â‰¤Î±i â‰¤Î²i for 1 â‰¤i â‰¤k. Therefore,
pÎ²1
1 . . . pÎ²k
k = n = m2 = p2Î±1
1
. . . p2Î±k
k
,
and the uniqueness part of the FTA gives Î²i = 2Î±i for 1 â‰¤i â‰¤k. Thus, the previous
corollary gives
d(n) = (Î²1 + 1) . . . (Î²k + 1) = (2Î±1 + 1) . . . (2Î±k + 1),
which is and odd number.
Conversely, let d(n) = (Î²1 + 1) . . . (Î²k + 1) be odd. Then, Î²i + 1 is odd for
1 â‰¤i â‰¤k, which in turn gives Î²i even for 1 â‰¤i â‰¤k. Writing Î²i = 2Î±i, we get
n = p2Î±1
1
. . . p2Î±k
k
=

pÎ±1
1 . . . pÎ±k
k
2 = m2,
with m = pÎ±1
1 . . . pÎ±k
k .
âŠ“âŠ”
For the next corollary, it is useful to extend the canonical decomposition of an
integer greater than 1 by allowing exponents equal to 0. For instance, we can write
48 = 24 Â· 3 and 270 = 2 Â· 33 Â· 5 by using the prime numbers 2, 3 and 5 in both cases,
so that
48 = 24 Â· 3 Â· 50 and 270 = 2 Â· 33 Â· 5.
Corollary 6.48 Let a, b > 1 be natural numbers such that a = pÎ±1
1 . . . pÎ±k
k
and
b = pÎ²1
1 . . . pÎ²k
k , with p1 < Â· Â· Â· < pk prime numbers and Î±i, Î²i â‰¥0 for 1 â‰¤i â‰¤k.
Then,
gcd(a, b) =
k
i=1
pmin{Î±i,Î²i}
i
and lcm (a, b) =
k
i=1
pmax{Î±i,Î²i}
i
.

188
6
Divisibility
Proof Let us do the proof for the gcd of a and b (that for the lcm of a and b is totally
analogous). Since min{Î±i, Î²i} â‰¤Î±i, Î²i for every i, the number d = 0k
i=1 pmin{Î±i,Î²i}
i
divides both a and b. Now, let dâ€² be a common positive divisor of a and b.
Corollary 6.46 gives dâ€² = pÎ³1
1 . . . pÎ³k
k , with Î³i â‰¥0 for every i; moreover, since,
dâ€² | a, b, it also gives Î³i â‰¤Î±i, Î²i for every i. Hence, we have Î³i â‰¤min {Î±i, Î²i} for
every i, so that (once more from Corollary 6.46) dâ€² | d. Therefore, d = gcd(a, b).
âŠ“âŠ”
Back to the last paragraph before the statement of the above corollary, we can
now readily compute
gcd(48, 270) = 2 Â· 3 = 6 and lcm (48, 270) = 24 Â· 33 Â· 5 = 2160.
For what comes next, if a natural number n and a prime number p are such
that p â‰¤n, then we obviously have that p | n!. The following result, due to
A-M. Legendre,10 teaches us how to compute the exponent of p in the canonical
decomposition of n!. Accordingly, (6.10) is known as Legendreâ€™s formula.
Proposition 6.49 Let n > 1 be natural and p be prime. If ep(n) denotes the
exponent of p in the canonical factorisation of n!, then
ep(n) =

kâ‰¥1
( n
pk
)
.
(6.10)
Proof Firstly, note that the above sum is actually ï¬nite, for âŒŠn
pk âŒ‹= 0 whenever
pk > n. Now, if k âˆˆN and pk, 2pk, . . . , mpk are the multiples of pk which are less
than or equal to n, then mpk â‰¤n < (m + 1)pk or, equivalently, m â‰¤
n
pk < m + 1.
Hence, m is the greatest integer which is less than or equal to n
pk , i.e., m = âŒŠn
pk âŒ‹. In
turn, this shows that for each integer k â‰¥1 there are exactly
( n
pk
)
âˆ’
(
n
pk+1
)
natural numbers which are less than or equal to n and are multiples of pk but not of
pk+1. Each of these naturals contributes with exactly k factors p to ep(n), so that
ep(n) =

kâ‰¥1
k
( n
pk
)
âˆ’
(
n
pk+1
)
=

kâ‰¥1
( n
pk
)
.
âŠ“âŠ”
The two coming examples bring interesting applications of Legendreâ€™s formula.
10After Adrien-Marie Legendre, French mathematician of the eighteenth and nineteenth centuries.

6.3
Prime Numbers
189
Example 6.50 (Soviet Union) In how many zeros does 1000! end?
Proof We have to ï¬nd the greatest power of 10 that divides 1000!. To this end, and
writing 1000! = 2e2(1000) Â· 5e5(1000)m, with m âˆˆN, it is enough to compute the
smallest of e2(1000) and e5(1000). It is clear that the smallest of these is e5(1000),
which can be promptly computed with the aid of Legendreâ€™s formula (and taking
into account that 55 > 1000):
e5(1000) =
4

j=1
(1000
5j
)
= 200 + 40 + 8 + 1 = 249.
Therefore, 1000! ends in 249 zeros.
âŠ“âŠ”
Example 6.51 (Yugoslavia) Prove that 2n âˆ¤n!, for each n âˆˆN.
Proof The result is clearly true for n = 1. For n > 1, Legendreâ€™s theorem assures
that the greatest power of 2 dividing n! has exponent k = 
jâ‰¥1

n
2j

. However,
âŒŠxâŒ‹â‰¤x for every x and

n
2j

= 0 for every sufï¬ciently large j; therefore, by means
of the formula for the sum of the terms of a geometric series (cf. Proposition 7.38
of [8], for instance), we get
k =

jâ‰¥1
 n
2j

<

jâ‰¥1
n
2j = n.
Hence, k < n, so that 2n âˆ¤n!.
âŠ“âŠ”
Problems: Sect. 6.3
1. Let p and q be two consecutive odd primes. Prove that there exist integers
a, b, c > 1, not necessarily distinct, such that p + q = abc.
2. (IMOâ€”adapted) Let k âˆˆN be such that p = 3k + 2 is prime. If m and n are
natural numbers such that
m
n = 1 âˆ’1
2 + 1
3 âˆ’1
4 + Â· Â· Â· âˆ’1
2k +
1
2k + 1,
prove that p | m.
3. (Hungary) Given an odd prime p, ï¬nd all x, y âˆˆN such that 2
p = 1
x + 1
y .
4. (IMO) Find all n âˆˆN such that n(n+1)(n+2)(n+3) has exactly three distinct
prime divisors.
5. (Russia) Let (an)nâ‰¥1 be a sequence of natural numbers such that gcd(ai, aj) =
gcd(i, j) whenever i Ì¸= j. Prove that an = n for every n â‰¥1.

190
6
Divisibility
6. * We say that a natural n is square free if n = 1 or n = p1 . . . pk, where
p1 < Â· Â· Â· < pk are prime numbers. In this respect, do the following items:
(a) Prove that every integer n > 1 can be uniquely written in the form n = ab2,
with a, b âˆˆN and a being square free.
(b) Use item (a) to show that, if there were exactly k prime numbers, then there
would exist exactly 2k square free integers and that the number of positive
integers less than or equal to n would be at most 2kâˆšn.
(c) Use item (b) to give another proof of the fact that there are inï¬nitely many
primes.
7. Show that there are inï¬nitely many primes of each of the forms 3k + 2 and
6k + 5.
8. (Yugoslavia) For each n âˆˆN, prove that the number 22n âˆ’1 has at least n
distinct prime factors.
9. If p is an odd prime, prove11 that p divides
2p
p

âˆ’2.
10. * Let a and n be positive integers, with a > 1. Do the following items:
(a) If an + 1 is prime, show that n is a power of 2 (we shall see in Problem 7,
page 252, that the converse is not true).12
(b) If n > 1 and an âˆ’1 is prime, show that n is itself prime and a = 2 (the
converse is not true, as shown by the example 211 âˆ’1 = 23 Â· 89).
11. (IMO) Find all naturals n > 6 for which the natural numbers less than n and
relatively prime with n form an arithmetic progression.
12. (IMO.) Let k, m and n be naturals such that m+k+1 is a prime number greater
than n + 1. If cs = s(s + 1) for each s âˆˆN, prove that
(cm+1 âˆ’ck)(cm+2 âˆ’ck) . . . (cm+n âˆ’ck)
is divisible by c1c2 Â· Â· Â· cn.
13. (Hungary) Let n be a given natural. Show that there are exactly d(n2) ordered
pairs (u, v) with u, v âˆˆN and such that lcm (u, v) = n.
14. (IMO) Find all natural numbers a and b such that ab2 = ba.
15. (BMO) Find all n âˆˆN such that n = d2
1 + d2
2 + d2
3 + d2
4, where 1 = d1 < d2 <
d3 < d4 are the smallest positive divisors of n.
16. (OIM) For each n âˆˆN, let 1 = d1 < Â· Â· Â· < dk = n be the positive divisors of
n. Find all n satisfying the following conditions:
(a) k â‰¥15.
(b) n = d13 + d14 + d15.
(c) (d5 + 1)3 = d15 + 1.
11For a stronger version of this result, see Problem 15, page 310.
12Prime numbers of the form 22n + 1 are called Fermat primes. They enter decisively into Gaussâ€™
description of which regular polygons can be constructed with straightedge and compass (cf. [20],
for instance).

6.3
Prime Numbers
191
17. (Japan)13 For each integer n > 1, let I(n) be the sum of the greatest odd
divisors of the numbers 1, 2, . . . , n and T (n) = 1+2+Â· Â· Â·+n. Prove that there
exist inï¬nitely many values of n for which 3I(n) = 2T (n).
18. (Australia) Find all naturals n for which d(n) = n
3, where d(n) stands for the
number of positive divisors of n.
19. (IMO) Let m and n be arbitrary nonnegative integers. Prove that
(2m)!(2n)!
m!n!(m + n)!
is always an integer.
20. For each positive integer n, let an =
2n
n

.
(a) Show that the binomial number an is always even.
(b) Prove that 4 | an if and only if n is not a power of 2.
21. (ORM) We say that a positive divisor d of a natural number n is special if
d < âˆšn and there are no perfect squares between d and n
d . Prove that every
natural n has at most one special divisor.
22. (Romania) Let n be a natural number whose binary representation has exactly
k digits 1. Prove that 2nâˆ’k divides n!.
23. Find all natural numbers a, b and k such that a and b are relatively prime and
(a + kb)(b + ka) is a power of a prime.
24. (Brazil) Show that there exists a set A of positive integers satisfying the
following conditions:
(a) A has 1000 elements.
(b) The sum on any number of distinct elements of A (at least one such
element) is not a perfect power of exponent greater than 1.
25. (Brazilâ€”adapted) For each integer n > 1, let p(n) be the greatest prime divisor
of n. Do the following items:
(a) If q is an odd prime, show that we cannot have p(q2k) > p(q2k + 1) for
every integer k â‰¥0.
(b) If p(q2k) < p(q2k + 1) and k is minimum with such a property, show that
p(q2k âˆ’1) < p(q2k).
(c) Show that there exist inï¬nitely many naturals n satisfying p(n âˆ’1) <
p(n) < p(n + 1).
26. Let p1 = 2, p2 = 3, p3 = 5, . . . be the sequence of prime numbers. For each
k âˆˆN, let xk = p1p2 . . . pk +1 and A = {x1, x2, . . .}. For a ï¬xed m âˆˆN, prove
that one can choose a subset B of A satisfying the following properties:
(a) |B| = m.
(b) Any two elements of B are relatively prime.
(c) The sum of the elements of any subset of B having more than one element
is not prime.
13For the converse to this problem, see Problem 5, page 226.

Chapter 7
Diophantine Equations
Our purpose in this chapter is to study some elementary diophantine equations.
Among these we highlight Pythagorasâ€™ and Pellâ€™s equation, for which we charac-
terize all solutions. We also present to the reader the important Fermatâ€™s descent
method, which provides a frequently useful tool for showing that certain diophantine
equations do not possess nontrivial solutions, in a way to be made precise.
The aforementioned method is one of the major legacies of Pierre Simon de Fermat
to Number Theory,1 and will be frequently used hereafter.
7.1
Pythagorean Triples and Fermatâ€™s Descent
Let us start by studying the nonzero integer solutions of the equation x2 + y2 =
z2, which, thanks to Pythagorasâ€™ theorem of Euclidean Geometry, is known as
Pythagorasâ€™ equation. After we ï¬nd all such solutions, we shall see how to use
that information to solve other interesting diophantine equations. The fundamental
result is as follows.
Proposition 7.1 The 3-tuples (x, y, z) of nonzero integers such that x2 + y2 = z2
are given by:
â§
â¨
â©
x = 2uvd
y = (u2 âˆ’v2)d
z = (u2 + v2)d
or
â§
â¨
â©
x = (u2 âˆ’v2)d
y = 2uvd
z = (u2 + v2)d,
,
(7.1)
where d, u and v are nonzero integers, with u and v of distinct parities and relatively
prime.
1Other remarkable ones are Fermatâ€™s little theorem, which has already appeared in Problem 5,
page 57, and will be proved by other methods in Sect. 10.2, and Fermatâ€™s theorem on sums of two
squares, which will be the object of Sect. 12.4.
Â© Springer International Publishing AG, part of Springer Nature 2018
A. Caminha Muniz Neto, An Excursion through Elementary Mathematics, Volume III,
Problem Books in Mathematics, https://doi.org/10.1007/978-3-319-77977-5_7
193

194
7
Diophantine Equations
Proof We can assume, without loss of generality, that x, y, z > 0. If d = gcd(x, y),
then d2 | (x2 + y2), so that d2 | z2; therefore, d | z. Hence, there exist nonzero
integers a, b and c for which gcd(a, b) = 1 and (x, y, z) = (da, db, dc). Moreover,
since
x2 + y2 = z2 â‡”a2 + b2 = c2,
we conclude that it sufï¬ces to ï¬nd all nonzero integer solutions a, b, c of the above
equation, subjected to the additional condition gcd(a, b) = 1.
The requirement that a2 + b2 = c2 and gcd(a, b) = 1 easily give us (prove
this!) gcd(a, c) = gcd(b, c) = 1. Now, recall (cf. Corollary 6.8) that the square of
an integer t leaves remainder 0 or 1 upon division by 4, according to whether t is
respectively even or odd. Therefore, if a and b are both odd, then c2 = a2 + b2 will
leave remainder 2 upon division by 4, which is a contradiction.
Since gcd(a, b) = 1, we are left with two cases to consider: a is odd and b is
even, or vice-versa. Let us look at the ï¬rst case, the analysis of the second one being
entirely analogous. Since a is odd, b is even and c2 = a2 + b2, we conclude that c
is also odd. Now, write
b2 = (c âˆ’a)(c + a).
(7.2)
If dâ€² = gcd(c âˆ’a, c + a), then dâ€² divides both
(c + a) + (c âˆ’a) = 2c and (c + a) âˆ’(c âˆ’a) = 2a
so that dâ€² | gcd(2a, 2c) = 2. However, since c âˆ’a and c + a are both even, we
conclude that dâ€² = 2, and we can write (7.2) as
b
2
2
=
c âˆ’a
2
 c + a
2

,
with gcd
 câˆ’a
2 , c+a
2

= 1. Thus, item (b) of Corollary 6.23 assures the existence of
relatively prime naturals u and v for which c + a = 2u2 and c âˆ’a = 2v2, so that
a = u2 âˆ’v2, b = 2uv, c = u2 + v2.
Furthermore, since c = u2 + v2 is odd, we see that u and v must have distinct
parities.
Finally, direct substitution on the original equation shows that all 3-tuples as
above are indeed solutions of Pythagorasâ€™ equation, and there is nothing left to do.
âŠ“âŠ”
A 3-tuple (x, y, z) of positive integers such that x2 + y2 = z2 is said to be
a pythagorean triple, in allusion to the Greek mathematician and philosopher

7.1
Pythagorean Triples and Fermatâ€™s Descent
195
Pythagoras of Samos and his famous theorem on right triangles. Indeed, and as
we have already mentioned, such a triple (x, y, z) determines,2 up to congruence, a
single right triangle of legs of lengths x and y and hypotenuse of length z.
The coming example uses the previous result to ï¬nd all integer solutions of
another diophantine equation.
Example 7.2 Find all nonzero integer solutions of the equation x2 +y2 = 2z2, with
x Ì¸= Â±y.
Solution In any such solution, x and y must be both even or both odd, for otherwise
x2+y2 would be odd, hence different from 2z2. Thus, taking a = x+y
2
and b = xâˆ’y
2 ,
we have a, b âˆˆZ \ {0} (since x Ì¸= Â±y) and x = a + b, y = a âˆ’b. Substituting such
expressions for x and y in the original equation, we conclude that
x2 + y2 = 2z2 â‡”a2 + b2 = z2.
Since this last equation is that of Pythagoras, our previous result guarantees the
existence of nonzero integers d, u and v, with u and v relatively prime and of distinct
parities, such that
a = 2uvd, b = (u2 âˆ’v2)d, z = (u2 + v2)d
or
a = (u2 âˆ’v2)d, b = 2uvd, z = (u2 + v2)d.
Hence, the solutions (x, y, z) of the given equation, with x Ì¸= Â±y, are of one of
the forms below, where d, u and v satisfy the conditions prescribed above:
x = (u2 âˆ’v2 + 2uv)d, y = (âˆ’u2 + v2 + 2uv)d, z = (u2 + v2)d
or
x = (u2 âˆ’v2 + 2uv)d, y = (u2 âˆ’v2 âˆ’2uv)d, z = (u2 + v2)d.
âŠ“âŠ”
The equations we have analysed up to this point are, in a certain sense, privileged,
for they possess inï¬nitely many nonzero integer solutions. Our next example will
display a diophantine equation in x, y and z having x = y = z = 0 as its
only integer solution. The proof we shall present is an application of Fermatâ€™s
descent method, which can sometimes be proï¬tably used to show that a diophantine
equation does not have nonzero integer solutions.
2For two different proofs of this fact, see chapters 4 and 5 of [9], for instance.

196
7
Diophantine Equations
Schematically, Fermatâ€™s method consists of the fulï¬llment of the following
stages:
i Assume that the given equation has a solution in nonzero integers.
ii. From such an assumption, infer that it has a solution in nonzero integers which,
in a certain sense (which will depend on the problem at hand) is minimal.
iii. Deduce the existence of yet another solution in nonzero integers which is
smaller than the minimal one of item ii., thus arriving at a contradiction.
Example 7.3 Prove that the equation 3x2 +y2 = 2z2 does not have nonzero integer
solutions.
Proof Firstly, observe that we cannot have exactly one of the integers x, y, z equal to
0. Hence, assume that the given equation possess a solution (x, y, z) with x, y, z âˆˆ
N (for, if (x, y, z) is a solution, then so is (Â±x, Â±y, Â±z)). Among all such solutions
(x, y, z), there must exist one for which z has the least possible value, say x = a,
y = b, z = c. Let us work this solution.
If 3 âˆ¤b, it follows from 3a2 + b2 = 2c2 that 3 âˆ¤c. But then, Corollary 6.8
guarantees that b2 and c2 leave remainder 1 upon division by 3, and hence equality
3a2 + b2 = 2c2 gives us a contradiction. Therefore, 3 | b, say b = 3b1 for some
b1 âˆˆN, and it follows from
2c2 = 3a2 + b2 = 3(a2 + 3b2
1)
that 3 | c. Letting c = 3c1, for some c1 âˆˆN, the last equality above furnishes
6c2
1 = a2 + 3b2
1,
so that 3 | a, say a = 3a1, with a1 âˆˆN. Now, plugging a = 3a1 in the last equality
above, we get
2c2
1 = 3a2
1 + b2
1,
so that (a1, b1, c1) is another solution, in natural numbers, of the original equation.
However, the relation 0 < c1 = c
3 < c is a contradiction, for we departed from
a solution in natural numbers (a, b, c) for which the (natural) value c of z was the
least possible one.
Since our original assumption (namely, that the given equation has some solution)
leads to a contradiction, we are forced to conclude that the equation has no solution
at all.
âŠ“âŠ”
Back to Pythagorasâ€™ equation, a natural generalization of it, posed by Fermat,
would be to study the more general diophantine equation below:
xn + yn = zn.
(7.3)

7.1
Pythagorean Triples and Fermatâ€™s Descent
197
Fermat himself claimed to have succeeded in using his descent method to prove
that (7.3) has no nonzero integer solutions when n > 2, and for this reason such
a result has eventually come to be known as Fermatâ€™s last theorem. Nevertheless,
since his reasoning was never written down, some of the most brilliant minds of
Mathematics tried to reproduce it, year after year. As astonishing as it may seen,
apart from particular cases, all such attempts resulted unsuccessful, and this state of
things forged the general perception that Fermat had probably made some mistake.
It took mankind almost 350 years to settle the issue. Indeed, it was only in the
last decade of the twentieth century that the English mathematician Andrew Wiles
entered History as the one to establish Fermatâ€™s conjecture. Wiles accomplishment
came after several years of hard work and through two long and deep papers, the
second of which in collaboration with his former student Richard Taylor. As is
almost always the case with such profound results in modern Mathematics, Wiles
and Taylor built on equally deep works of other prominent mathematicians, among
the most notable of them we should mention the Japanese Yutaka Taniyama and
Goro Shimura, and the German Gerhard Frey.3
Surprisingly enough, the descent method can be used to successfully approach
the case 4 | n in Fermatâ€™s equation (7.3). We do this next.
Example 7.4 If the natural number n is a multiple of 4, then there does not exist
nonzero integers x, y and z such that xn + yn = zn.
Proof Let n = 4k, with k âˆˆN. From xn + yn = zn, with x, y, z âˆˆZ \ {0}, we get
(xk)4 + (yk)4 = (z2k)2,
so that (xk, yk, z2k) is a solution of equation a4+b4 = c2 in nonzero integers. Thus,
it sufï¬ces to show that this last equation does not admit nonzero integer solutions.
By the sake of contradiction, let us assume that there exist a, b, c âˆˆN such that
a4 + b4 = c2. We can also suppose that a, b and c are chosen in such a way that
there is no other solution (Î±, Î², Î³ ), with Î±, Î², Î³ âˆˆN and Î³ < c (as the reader
surely expects, this is precisely the assumption that will give us a contradiction via
the descent method).
Since (a2, b2, c) solves Pythagorasâ€™ equation, Proposition 7.1, together with the
minimality of c, guarantees that gcd(a2, b2) = 1, as well as that there exist relatively
prime natural numbers u and v, of distinct parities and such that
a2 = u2 âˆ’v2, b2 = 2uv, c = u2 + v2
or
a2 = 2uv, b2 = u2 âˆ’v2, c = u2 + v2.
3For the reader interested in knowing a little more on this epic endeavor, we recommend ï¬rst to run
through the best seller of Singh [35], and then to turn to the marvelous book of professors Stewart
and Tall [37].

198
7
Diophantine Equations
Let us look at the ï¬rst case above, the other one being totally analogous. In
that case, a is odd and a2 + v2 = u2. Therefore, by invoking once more the
characterization of pythagorean triples (and the fact that gcd(u, v) = 1) we conclude
by the existence of relatively prime natural numbers p and q, of distinct parities and
such that
a = p2 âˆ’q2, v = 2pq, u = p2 + q2.
Then,
b2 = 2uv = 4pq(p2 + q2),
and since gcd(p, q) = 1, it follows that both p and q are also relatively prime with
p2 + q2. Hence, in order that 4pq(p2 + q2) is a perfect square, the only possibility
is that all of p, q and p2 + q2 are also perfect squares, say
p = Î±2, q = Î²2, p2 + q2 = Î³ 2,
with Î±, Î², Î³ âˆˆN. In turn, this ï¬nally gives
Î±4 + Î²4 = p2 + q2 = Î³ 2,
with
c = u2 + v2 > u = p2 + q2 = Î³ 2 â‰¥Î³,
thus contradicting the minimality of c.
Therefore, there are no nonzero solutions of xn + yn = zn when 4 | n.
âŠ“âŠ”
The next section shall bring a nontrivial (and important) application of Fermatâ€™s
descent. For the time being, let us close this section with a beautiful application of
the characterization of pythagorean triples to a problem in Euclidean Geometry.
Example 7.5 (Cruxâ€”Adapted) Given a positive integer r, we want to compute
the number of pairwise incongruent right triangles ABC, satisfying the following
conditions:
(a) The radius of the circle inscribed in ABC equals r.
(b) The lengths of the sides of ABC are relatively prime integers.
Show that there are exactly 2l such triangles, where l is the number of distinct prime
factors of r.
Proof Let b and c be the legs and a be the hypotenuse of a right triangle whose
inscribed circle has radius r. It is an easy exercise of Euclidean Geometry (which
we leave to the reader) to show that r = b+câˆ’a
2
.

7.1
Pythagorean Triples and Fermatâ€™s Descent
199
Since a, b and c are relatively prime and b2 + c2 = a2, the characterization of
pythagorean triples gives relatively prime integers u > v > 0, of distinct parities,
for which
b = u2 âˆ’v2, c = 2uv, a = u2 + v2.
Thus, to count the number of triangles satisfying the given conditions is the same
as to count the number of ordered paired (u, v) satisfying the above conditions. To
this end, note that
r = b + c âˆ’a
2
= v(u âˆ’v)
and that gcd(u, v) = 1 â‡”gcd(v, u âˆ’v) = 1.
Letting r = pÎ±1
1 pÎ±2
2 Â· Â· Â· pÎ±l
l , with p1 < p2 < Â· Â· Â· < pl primes, we conclude that
there are exactly 2l distinct possibilities for v:
v = 1 or v = p
Î±i1
i1 Â· Â· Â· p
Î±ik
ik ,
where {i1, . . . , ik} is a subset of {1, 2, . . . , l}. For each such v, note that u = v + r
v
is completely determined and that u = v + r
v > v. We now have to check that u and
v have distinct parities. To this end, assume, without loss of generality, that r is even
(the analysis of the case of an odd r is quite similar). Then, v contains either all or
none of the factors 2 of r. If v has all factors 2 of r, then r
v is odd, and it follows
that u = v + r
v is also odd; if v is itself odd, then r
v is even and u = v + r
v is odd.
In any event, u and v have, indeed, distinct parities.
In order to conclude that the number of right triangles we wish to count
is precisely 2l, it now sufï¬ces to show that, if (u1, v1) and (u2, v2) are two
distinct choices for (u, v) as above, then the corresponding triangles are actually
incongruent. To this end, assuming that v1 Ì¸= v2 (the case u1 Ì¸= u2 being totally
analogous), we are going to show that the two corresponding right triangles have
distinct hypotenuses. But this is straightforward:
u2
1 + v2
1 = u2
2 + v2
2 â‡”
 r
v1
+ v1
2
+ v2
1 =
 r
v2
+ v2
2
+ v2
2
â‡”r2
v2
1
+ 2v2
1 = r2
v2
2
+ 2v2
2
â‡”r2
"
v2
2 âˆ’v2
1
v2
1v2
2
#
= 2(v2
2 âˆ’v2
1)
â‡”
r
v1v2
=
âˆš
2,
which is an absurd.
âŠ“âŠ”

200
7
Diophantine Equations
Problems: Sect. 7.1
1. (Brazilâ€”adapted) Given n, k âˆˆN, prove that the equation xn + kyn = zn+1
has inï¬nitely many solutions in positive integers x, y and z.
2. Find all solutions, in positive integers, of the equation
(x + y)2 + (y + z)2 = (x + z)2.
3. Show that the nonzero integer solutions of the equation x2 + 2y2 = z2 are
given by
x = Â±(u2 âˆ’2v2)d, y = Â±2uvd, z = Â±(u2 + 2v2)d,
where d, u and v are nonzero integers, with gcd(u, 2v) = 1.
4. Show that none of the following equations have nonzero integer solutions:
(a) x4 + 4y4 = z2.
(b) x4 + 2y4 = z2.
(c) x2 + y2 = 3z2.
(d) x3 + 5y3 = 9z3.
5. Do the following items:
(a) (Hungary) Show that there do not exist x, y âˆˆQ such that x2+xy+y2 = 2.
(b) Find all x, y âˆˆQ for which x2 + xy + y2 = 1.
6. Prove the following theorem of Euler: there does not exist nonzero integers w,
x, y and z for which w2 + x2 + y2 = 7z2.
7. (Bulgaria) Prove that there does not exist rationals x, y and z such that
x2 + y2 + z2 + 3(x + y + z) + 5 = 0.
8. Given4 a, b, c âˆˆQ such that a + b
3âˆš
2 + c
3âˆš
4 Ì¸= 0, show that there exist
x, y, z âˆˆQ for which
1
a + b
3âˆš
2 + c
3âˆš
4
= x + y
3âˆš
2 + z
3âˆš
4.
9. (IMO) Given n âˆˆN and a circle of radius 1, show that we can choose n points
A1, A2, . . . , An on it such that AiAj is rational, for any 1 â‰¤i < j â‰¤n.
10. (IMO) Let a, b, c and d be integers such that a > b > c > d > 0. If
ac + bd = (b + d + a âˆ’c)(b + d âˆ’a + c),
prove that ab + cd is not a prime number.
4For another approach to this problem, see Problem 9, page 486.

7.2
Pellâ€™s Equation
201
7.2
Pellâ€™s Equation
Recall (cf. Problem 6, page 190) that an integer greater than 1 is said to be square
free if it is not divisible by the square of a prime number. In this section, we examine
the integer solutions of equations of the form
x2 âˆ’dy2 = m,
(7.4)
where d > 1 is square free and m is a given integer. Such an equation is known as
Pellâ€™s equation.5
Since d is a product of distinct primes, Example 6.24 guarantees that
âˆš
d is
irrational. In particular, we conclude that the above equation has no nonzero integer
solutions when m = 0. Indeed, if this was not the case, then we would have x, y Ì¸= 0
and, hence,
âˆš
d = x
y âˆˆQ. On the other hand, if d, m < 0, then Pellâ€™s equation
obviously has no solutions, whereas if d < 0 < m, then (7.4) has at most a ï¬nite
number of solutions. We also notice that, even if d, m > 0, (7.4) may have no
solution at all, as Problem 1 shows.
From now on, we shall assume that m = 1. (The general case is partially dealt
with at Problem 4; in this respect, see also [27]). Before we dive into a general
analysis, let us give a simple example showing that, in this case, Pellâ€™s equation
may have inï¬nitely many solutions.
Example 7.6 Show that the equation x2 âˆ’2y2 = 1 has inï¬nitely many positive
integer solutions.
Proof Note that x = 3, y = 2 is a solution. On the other hand, we can generate
inï¬nitely many integer solutions of this equation from one nonzero integer solution
(a, b) in the following way: starting from a2 âˆ’2b2 = 1, we write
(a + b
âˆš
2)(a âˆ’b
âˆš
2) = 1
and, hence,
(a + b
âˆš
2)2(a âˆ’b
âˆš
2)2 = 1.
Expanding both binomials, we arrive at
(a2 + 2b2 + 2ab
âˆš
2)(a2 + 2b2 âˆ’2ab
âˆš
2) = 1
or, which is the same, at
(a2 + 2b2)2 âˆ’2(2ab)2 = 1.
5After John Pell, English mathematician of the seventeenth century.

202
7
Diophantine Equations
Therefore, (a2 + 2b2, 2ab) is also an integer solution and, letting a, b âˆˆN, we have
a < a2 + 2b2. Iterating the above argument, we obtain inï¬nitely many solutions for
the given equation.
âŠ“âŠ”
The method used in the previous example can be easily generalized to show that
the general Pellâ€™s equation x2 âˆ’dy2 = 1 admits inï¬nitely many nonzero integer
solutions, provided it admits at least one such solution. Moreover, as illustrated by
Problems 4 and 7, for instance, small modiï¬cations in that approach also allow us
to treat more general equations.
Even tough we can easily ï¬nd inï¬nitely many integer solutions of (7.4) in some
particular cases, for the time being we do not know whether or not there are other
integer solutions, not to say how to ï¬nd all of them. In order to answer these
questions, we shall need a preliminary result, due to Dirichlet, on approximation of
irrational numbers by rational ones. For what comes next, recall (cf. the discussion
preceding Problem 15, page 178) that, for x âˆˆR, the fractionary part of x is the
real number {x} âˆˆ[0, 1), given by {x} = x âˆ’âŒŠxâŒ‹.
Lemma 7.7 (Dirichlet)
If Î± is an irrational number, then there exist inï¬nitely
many rationals x
y , with x and y nonzero, relatively prime integers such that
				Î± âˆ’x
y
				 < 1
y2 .
(7.5)
Proof Let n > 1 be any integer and consider the n + 1 real numbers {jÎ±} âˆˆ[0, 1),
with j = 0, 1, . . . , n. Since
[0, 1) =
+
0, 1
n

âˆª
+1
n, 2
n

âˆªÂ· Â· Â· âˆª
+n âˆ’1
n
, 1

,
a union of n disjoint half-open intervals, pigeonholeâ€™s principle guarantees the
existence of indices 0 â‰¤k < j â‰¤n such that {jÎ±} and {kÎ±} belong to a single
of these n half-open intervals.
Then, |{jÎ±} âˆ’{kÎ±}| < 1
n or, which is the same,
|(j âˆ’k)Î± âˆ’(âŒŠjÎ±âŒ‹âˆ’âŒŠkÎ±âŒ‹)| < 1
n.
It thus follows that
				Î± âˆ’âŒŠjÎ±âŒ‹âˆ’âŒŠkÎ±âŒ‹
j âˆ’k
				 <
1
(j âˆ’k)n â‰¤
1
(j âˆ’k)2 ,
(7.6)
and letting x = âŒŠjÎ±âŒ‹âˆ’âŒŠkÎ±âŒ‹and y = j âˆ’k, we have 0 < y â‰¤n and
			 x
y âˆ’Î±
			 < 1
y2 .
On the other hand, if d = gcd(x, y) and x = dx1, y = dy1, then

7.2
Pellâ€™s Equation
203
				
x1
y1
âˆ’Î±
				 < 1
y2 â‰¤1
y2
1
,
and we can assume that gcd(x, y) = 1.
In order to guarantee the existence of inï¬nitely many such pairs, let x and y be
nonzero, relatively prime integers such that
			 x
y âˆ’Î±
			 <
1
y2 . By choosing a natural
number n1 for which
			 x
y âˆ’Î±
			 >
1
n1 , and repeating the argument that led to (7.6)
with n1 in place of n, we obtain nonzero, relatively prime integers x1 and y1 such
that 0 < y1 â‰¤n1 and
				
x1
y1
âˆ’Î±
				 <
1
n1y1
â‰¤1
y2
1
.
Moreover, since
				
x1
y1
âˆ’Î±
				 <
1
n1y1
â‰¤1
n1
<
				
x
y âˆ’Î±
				 ,
we conclude that x1
y1 Ì¸= x
y .
Finally, by iterating the above reasoning we obtain inï¬nitely many (x, y) of
nonzero, relatively prime integers satisfying (7.5).
âŠ“âŠ”
As we shall now see, Dirichletâ€™s lemma allows us to show that, for a ï¬xed square
free natural number d > 1, there exists at least one integer value of m for which (7.4)
admits inï¬nitely many integer solutions.
Lemma 7.8 If d > 1 is a square free natural number, then there exists m âˆˆZ \ {0}
such that equation x2 âˆ’dy2 = m has inï¬nitely many integer solutions.
Proof Since
âˆš
d /âˆˆQ, Dirichletâ€™s lemma assures that the set S of ordered pairs
(x, y) of nonzero, relatively prime integers x, y satisfying
			 x
y âˆ’
âˆš
d
			 < 1
y2 is inï¬nite.
However, if (x, y) is such a pair, then |x âˆ’y
âˆš
d| <
1
|y|, and triangle inequality
gives us
|x2 âˆ’dy2| = |x âˆ’y
âˆš
d||x + y
âˆš
d| < 1
|y|

|x âˆ’y
âˆš
d| + 2|y|
âˆš
d

= 1
|y|
 1
|y| + 2|y|
âˆš
d

< 2
âˆš
d + 1.
Thus, for each (x, y) âˆˆS, the set of integers x2 âˆ’dy2 is contained in the set of
the nonzero integers of the interval

âˆ’(2
âˆš
d + 1), 2
âˆš
d + 1

. But since this is a
ï¬nite set, there exists an integer m Ì¸= 0, situated between âˆ’(2
âˆš
d +1) and 2
âˆš
d +1,
that repeats itself an inï¬nitely number of times among the values of x2 âˆ’dy2, for
(x, y) âˆˆS. Of course, this is the same as saying that, for this value of m, equation
x2 âˆ’dy2 = m admits inï¬nitely many integer solutions.
âŠ“âŠ”

204
7
Diophantine Equations
We are ï¬nally in position to characterize all integer solutions of (7.4) when m =
1; the key ingredients will be the previous lemma and Fermatâ€™s method of descent.
We start by establishing the existence of solutions.
Proposition 7.9 If d > 1 is a square free natural number, then equation x2âˆ’dy2 =
1 admits at least one solution in positive integers x and y.
Proof Take, by the previous lemma, m âˆˆZ\{0} for which the equation x2 âˆ’dy2 =
m has inï¬nitely many integer solutions. Since there are only ï¬nitely many different
remainders upon division by m, we can choose two such solution, say (x1, y1) and
(x2, y2), such that |x1| Ì¸= |x2| and m divides x2 âˆ’x1, y2 âˆ’y1. Then,
(x1 + y1
âˆš
d)(x2 âˆ’y2
âˆš
d) = (x1x2 âˆ’dy1y2) + (x2y1 âˆ’x1y2)
âˆš
d
(7.7)
and, by writing x2 âˆ’x1 = mr and y2 âˆ’y1 = ms, with r, s âˆˆZ, we get
x1x2 âˆ’dy1y2 = x1(x2 âˆ’x1) + (x2
1 âˆ’dy2
1) + (y1 âˆ’y2)dy1
= m(rx1 + 1 âˆ’sdy1)
and
x2y1 âˆ’x1y2 = (x2 âˆ’x1)y1 + x1(y1 âˆ’y2) = m(r âˆ’s).
For the sake of simplicity, let x1x2 âˆ’dy1y2 = mu and x2y1 âˆ’x1y2 = mv, with
u, v âˆˆZ. It follows from (7.7) that
(x1 + y1
âˆš
d)(x2 âˆ’y2
âˆš
d) = m(u + v
âˆš
d)
(7.8)
and, hence,
(x1 âˆ’y1
âˆš
d)(x2 + y2
âˆš
d) = m(u âˆ’v
âˆš
d).
By multiplying the left and right hand sides of these two relations, we arrive at
m2 = (x2
1 âˆ’dy2
1)(x2
2 âˆ’dy2
2) = m2(u2 âˆ’dv2),
so that u2 âˆ’dv2 = 1.
We are left to showing that u, v Ì¸= 0. If u = 0, we would have âˆ’dv2 = 1, which
is clearly impossible. If v = 0 we would get u = Â±1, and it would follow from (7.8)
that
(x1 + y1
âˆš
d)(x2 âˆ’y2
âˆš
d) = Â±m = Â±(x2
2 âˆ’dy2
2);
therefore,

7.2
Pellâ€™s Equation
205
x1 + y1
âˆš
d = Â±(x2 + y2
âˆš
d),
which in turn implies |x1| = |x2|, for
âˆš
d /âˆˆQ. But this conclusion contradicts our
choices of x1 and x2, and we are done.
âŠ“âŠ”
We are ï¬nally able to state and prove the result we have been seeking, on the
characterization of all integer solutions of Pellâ€™s equation x2 âˆ’dy2 = 1, for a square
free integer d > 1. Observe that the previous proposition guarantees that it has at
least one solution.
Theorem 7.10 If d > 1 is a square free integer, then the equation x2 âˆ’dy2 = 1
admits inï¬nitely many solutions in positive integers x, y. More precisely, if x = x1,
y = y1 is the solution in positive integers for which the sum x + y
âˆš
d is as small
as possible, then the other positive integer solutions of the equation are given by the
natural numbers xn, yn satisfying the equality
xn + yn
âˆš
d = (x1 + y1
âˆš
d)n,
where n âˆˆN.
Proof Let Î± = x1 + y1
âˆš
d, with x1, y1 âˆˆN being chosen as in the statement of the
theorem.
Given n âˆˆN, the binomial expansion formula readily gives xn, yn âˆˆN such that
(x1 Â± y1
âˆš
d)n = xn Â± yn
âˆš
d.
Thus,
1 = (x2
1 âˆ’dy2
1)n = (x1 + y1
âˆš
d)n(x1 âˆ’y1
âˆš
d)n
= (xn + yn
âˆš
d)(xn âˆ’yn
âˆš
d) = x2
n âˆ’dy2
n,
so that all of the ordered pairs (xn, yn) built as in the statement of the theorem are
indeed solutions of the given equation.
Now, if (x, y) is any solution in positive integers, it sufï¬ces to show that there
exists n âˆˆN for which x + y
âˆš
d = Î±n. For the sake of contradiction, assume that
the converse is true. Since Î± > 1, we have limnâ†’+âˆÎ±n = +âˆ, so that there exists
n âˆˆN for which
Î±n < x + y
âˆš
d < Î±n+1
or, which is the same,
1 < x + y
âˆš
d
Î±n
< Î±.
(7.9)

206
7
Diophantine Equations
However, relations Î±n = xn + yn
âˆš
d and x2
n âˆ’dy2
n = 1, would give us
x + y
âˆš
d
Î±n
=
x + y
âˆš
d
xn + yn
âˆš
d
= (xn âˆ’yn
âˆš
d)(x + y
âˆš
d)
= (xxn âˆ’dyyn) + (xny âˆ’ynx)
âˆš
d,
with
(xxn âˆ’dyyn)2 âˆ’d(xny âˆ’ynx)2 = (x2
n âˆ’dy2
n)(x2 âˆ’dy2) = 1.
Hence, (xxn âˆ’dyyn, xny âˆ’ynx) is an integer solution such that (by (7.9))
1 < (xxn âˆ’dyyn) + (xny âˆ’ynx)
âˆš
d = x + y
âˆš
d
Î±n
< Î±.
Thus, if we show that xxnâˆ’dyyn, xnyâˆ’ynx > 0, we would arrive at a contradiction
to the minimality of Î± (note that, here, we are invoking Fermatâ€™s descent method).
For what is left to do, letting a = xxn âˆ’dyyn and b = xny âˆ’ynx, we have
a + b
âˆš
d = x + y
âˆš
d
Î±n
> 1 and a2 âˆ’db2 = 1,
so that
a âˆ’b
âˆš
d =
1
a + b
âˆš
d
> 0.
Then, on the one hand,
2a = (a âˆ’b
âˆš
d) + (a + b
âˆš
d) > 0;
on the other,
a âˆ’b
âˆš
d =
1
a + b
âˆš
d
< 1
gives us b
âˆš
d > a âˆ’1 â‰¥0, so that b > 0.
âŠ“âŠ”
Example 7.11 Find all positive integer solutions of equation x2 âˆ’2y2 = 1.
Solution Letting (x1, y1) be the solution in positive integers for which x1+y1
âˆš
2 is
as small as possible, the previous result teaches us that the positive integer solutions
of this equation are of the form (xn, yn), where xn and yn are such that
xn + yn
âˆš
2 = (x1 + y1
âˆš
2)n,
for n âˆˆN.

7.2
Pellâ€™s Equation
207
Since the ordered pairs (1, 1), (1, 2), (2, 1), (2, 2), (3, 1), (1, 3), (2, 3) and (4, 1)
are not solutions of the given equation but (3, 2) is a solution, it is immediate to
check that x1 = 3 and y1 = 2. Hence, the remaining solutions in positive integers
are the ordered pairs (xn, yn) given by the equality
xn + yn
âˆš
2 = (3 + 2
âˆš
2)n.
âŠ“âŠ”
Problems: Sect. 7.2
1. * If d and m leave remainder 3 upon division by 4, show that (7.4) does not
possess any integer solutions.
2. With respect to Example 7.11, prove that the positive integer solutions (xn, yn)
of x2 âˆ’2y2 = 1 are recursively deï¬ned by x1 = 3, y1 = 2 and, for an integer
n â‰¥1,
xn+1 = 3xn + 4yn, and yn+1 = 2xn + 3yn.
3. Prove that the equation x2 âˆ’2y2 = âˆ’1 has inï¬nitely many integer solutions.
4. * Let d, m âˆˆN, with d > 1 being square free. If equation x2 âˆ’dy2 = m
has a solution (x0, y0) in positive integers, prove that it has inï¬nitely many such
solutions.
5. (Hungary) Show that there are inï¬nitely many positive integers n for which n2 +
(n + 1)2 is a perfect square.
6. (Turkey) Find inï¬nitely many solutions, in positive integers, of the equation
y2 + 1 = x(x + y).
7. Generalize the result of the previous problem in the following way: let a, b, c âˆˆZ
be such that  = b2 âˆ’4ac is greater than 1 and square free. If n âˆˆZ is such that
the equation
x2 âˆ’y2 = 4an
has at least one integer solution (x0, y0) for which 2a | (x0 âˆ’by0), show that the
equation
ax2 + bxy + cy2 = n
has inï¬nitely many integer solutions.

Chapter 8
Arithmetic Functions
This short chapter introduces an important class of functions, called arithmetic
multiplicative functions, which play a prominent role in the elementary theory of
numbers. Among the many arithmetic multiplicative functions we shall encounter
here, two deserve all spotlights: the Euler function Ï•, which will reveal itself to
be an indispensable tool for basically all further theoretical developments, and the
MÃ¶bius function Î¼, which is essential to getting the celebrated MÃ¶bius inversion
formula and its subsequent application to the Euler function.
In all that follows, we shall refer ourselves to a given function f : N â†’R as an
arithmetic function.
Deï¬nition 8.1 An arithmetic function f : N â†’R is said to be multiplicative if,
for all relatively prime m, n âˆˆN, one has f (mn) = f (m)f (n).
Since 1 is relatively prime with itself, if f
: N â†’R is an arithmetic
multiplicative function, then f (1) = f (1)2, so that f (1) = 0 or 1. In case f (1) = 0,
we get
f (n) = f (n Â· 1) = f (n)f (1) = 0, âˆ€n âˆˆN,
i.e., f vanishes identically. Hence, from now on we shall implicitly assume that if
f : N â†’R is an arithmetic multiplicative function, then f (1) = 1.
Note also that if f : N â†’R is an arithmetic multiplicative function and n > 1 is
an integer with canonical decomposition n = pÎ±1
1 . . . pÎ±k
k , then several applications
of the deï¬nition give us
f (n) = f (pÎ±1
1 ) . . . f (pÎ±k
k ).
(8.1)
In words, the above inequality says that, in order to compute the values f (n), with
n âˆˆN, it sufï¬ces to know how to compute the values f (pÎ±), with p prime and
Î± âˆˆN.
Â© Springer International Publishing AG, part of Springer Nature 2018
A. Caminha Muniz Neto, An Excursion through Elementary Mathematics, Volume III,
Problem Books in Mathematics, https://doi.org/10.1007/978-3-319-77977-5_8
209

210
8
Arithmetic Functions
Finally, if f : N â†’R is an arithmetic function such that f (1) = 1, then the
equality f (mn) = f (m)f (n) is always true when m = 1 or n = 1; therefore, in
order to prove that such an f is multiplicative, we just have to consider the case of
m, n > 1.
We shall repeatedly use the above remarks without further notice.
Example 8.2 We saw at Corollary 6.46 that if n = pÎ±1
1 . . . pÎ±k
k
is the canonical
decomposition of a natural number n > 1 in primes, then
d(n) = (Î±1 + 1) . . . (Î±k + 1)
is the number of positive divisors of n. We claim that the function d : N â†’R thus
obtained is multiplicative. Indeed, if m, n > 1 are relatively prime integers with
canonical decompositions n = pÎ±1
1 . . . pÎ±k
k
and m = qÎ²1
1 . . . qÎ²l
l , then pi Ì¸= qj for
all 1 â‰¤i â‰¤k, 1 â‰¤j â‰¤l. Therefore, the canonical decomposition of mn in primes
is
mn = pÎ±1
1 . . . pÎ±k
k qÎ²1
1 . . . qÎ²l
l .
so that
d(mn) = (Î±1 + 1) . . . (Î±k + 1)(Î²1 + 1) . . . (Î²l + 1) = d(m)d(n).
For what comes next, given n âˆˆN we shall write D(n) to denote the set of
positive divisors of n, so that d(n) = |D(n)|.
Lemma 8.3 If m and n are relatively prime naturals, then the map
f : D(m) Ã— D(n) âˆ’â†’D(mn)
(x, y)
âˆ’â†’
xy
is a bijection.
Proof It follows from Example 8.2 and the fundamental principle of counting that
|D(mn)| = d(mn) = d(m)d(n) = |D(m)| Â· |D(n)| = |D(m) Ã— D(n)|.
Hence, the domain and codomain of f have equal quantities of elements. Thus, in
order to prove that f is a bijection, it sufï¬ces to establish its surjectivity. To this end,
let us apply item (d) of Proposition 6.22: if k | mn, then the condition gcd(m, n) = 1
guarantees that
k = gcd(k, mn) = gcd(k, m) Â· gcd(k, n).
Therefore, if we let a = gcd(k, m) and b = gcd(k, n), we get a âˆˆD(m), b âˆˆD(n)
and f ((a, b)) = ab = k, so that k belongs to the image of f . But since k âˆˆD(mn)
was arbitrarily chosen, we conclude that f is surjective.
âŠ“âŠ”

8
Arithmetic Functions
211
Along the rest of this chapter, we shall write 
0<d|n f (d) to denote the sum of
the values f (d), when d varies in D(n). Although such an use of the letter d is
conï¬‚ictant with the notation for the function d of the previous example, this will be
harmless in context.
The coming proposition establishes one of the most important properties of
arithmetic multiplicative functions.
Proposition 8.4 If f : N â†’R is an arithmetic multiplicative function, then so is
the function F : N â†’R, given by
F(n) =

0<d|n
f (d).
Proof If m, n âˆˆN are such that gcd(m, n) = 1, then the previous lemma, together
with the multiplicative character of f , gives
F(mn) =

0<d|mn
f (d) =

0<d1|m
0<d2|n
f (d1d2) =

0<d1|m

0<d2|n
f (d1)f (d2)
=
â›
â
0<d1|m
f (d1)
â
â 
â›
â
0<d2|n
f (d2)
â
â 
= F(m)F(n).
âŠ“âŠ”
Example 8.5 The function f : N â†’R such that f (n) = n for every n âˆˆN
is obviously multiplicative. Hence, the previous proposition assures that so is the
function s : N â†’R, given by
s(n) =

0<d|n
f (d) =

0<d|n
d.
Since s(n) adds the positive divisors of n, given a prime number p and Î± âˆˆN, it
follows from Corollary 6.46 that
s(pÎ±) =

0<d|pÎ±
d =
Î±

j=0
pj = pÎ±+1 âˆ’1
p âˆ’1
.
Thus, if n = pÎ±1
1 . . . pÎ±k
k , with primes p1 < Â· Â· Â· < pk and natural numbers
Î±1, . . . , Î±k, relation (8.1) and the above computations give
s(n) =
k
j=1
s(p
Î±j
j ) =
k
j=1
â›
âp
Î±j +1
j
âˆ’1
pj âˆ’1
â
â .
(8.2)

212
8
Arithmetic Functions
For our next example, we recall (cf. Problem 6, page 190) that an integer n > 1
is square free if n = p1 . . . pk, with p1 < Â· Â· Â· < pk being primes; equivalently, n is
square free if there does not exist an integer q > 1 such that q2 | n.
The coming deï¬nition presents one of the most important arithmetic multiplica-
tive functions multiplicativas, the MÃ¶bius function.
Deï¬nition 8.6 The MÃ¶bius function1 is the function Î¼ : N â†’R given by
Î¼(n) =
â§
â¨
â©
1, if n = 1
0, if q2 | n, para algum inteiro q > 1
(âˆ’1)k, if n = p1 . . . pk, com p1, . . . , pk distinct primes
.
In order to check that the MÃ¶bius function is indeed multiplicative, let m, n > 1
be relatively prime integers. Then, mn will be divisible by a perfect square greater
than 1 if and only if either m or n do satisfy such a property; this being the case, it
is immediate to see that
f (mn) = 0 = f (m)f (n).
On the other hand, if m and n are square free, say n = p1 . . . pk and m =
q1 . . . ql, with p1 < Â· Â· Â· < pk and q1 < Â· Â· Â· < ql being prime numbers, the condition
gcd(m, n) = 1 assures that pi Ì¸= qj for all i and j. Hence, mn = p1 . . . pkq1 . . . ql
is the canonical decomposition of mn in primes, so that
Î¼(mn) = (âˆ’1)k+l = (âˆ’1)k(âˆ’1)l = Î¼(m)Î¼(n).
The coming result brings a very important property of the MÃ¶bius function.
Proposition 8.7 If Î¼ : N â†’R is the MÃ¶bius function, then

0<d|n
Î¼(d) =
1, if n = 1
0, if n > 1 .
Proof Let F : N â†’R be the function given by
F(n) =

0<d|n
Î¼(d).
Proposition 8.4 guarantees that F is multiplicative, and we wish to show that F(1) =
1 and F(n) = 0 for n > 1. We consider three cases separately:
(i) n = 1: we have F(1) = 
0<d|1 Î¼(d) = Î¼(1) = 1.
1After the German mathematician of the nineteenth century August MÃ¶bius.

8
Arithmetic Functions
213
(ii) n = pk, with p prime and k â‰¥1 integer: then
F(pk) =

0<d|pk
Î¼(d) =
k

j=0
Î¼(pj) = Î¼(1) + Î¼(p) = 0.
(iii) n = pÎ±1
1 . . . pÎ±k
k , with p1 < Â· Â· Â· < pk being primes: since F is multiplicative,
it follows from (8.1) and item (ii) that
F(n) = F(pÎ±1
1 ) . . . F(pÎ±k
k ) = 0.
âŠ“âŠ”
Theorem 8.8 is the reason behind the central role of MÃ¶bius function in the theory
of arithmetic multiplicative functions. For its proof, notice that the function
f : D(n) âˆ’â†’D(n)
d
âˆ’â†’n/d
(8.3)
is a bijection; indeed, this follows at once from the fact that f â—¦f = IdD(n), as the
reader can promptly check.
In the notations of Proposition 8.4, formula (8.4) below, known as the MÃ¶bius
inversion formula, teaches us how to recover function f from F (even if f is not
multiplicative).
Theorem 8.8 (MÃ¶bius) Let f : N â†’R be an arithmetic function (not necessarily
multiplicative). If F : N â†’R is given by F(n) = 
0<d|n f (d), then
f (n) =

0<d|n
F
n
d

Î¼(d) =

0<d|n
F(d)Î¼
n
d

.
(8.4)
Proof The second equality in (8.4) follows from the bijectivity of the function
in (8.3). For the ï¬rst equality, note ï¬rst that

0<d|n
F
n
d

Î¼(d) =

0<d|n
â›
âÎ¼(d)

0<dâ€²| n
d
f (dâ€²)
â
â =

0<d|n

0<dâ€²| n
d
Î¼(d)f (dâ€²).
However, since d | n and dâ€² | n
d if and only if dâ€² | n and d | n
dâ€² , it follows from the
above computations that

0<d|n
F
n
d

Î¼(d) =

0<dâ€²|n

0<d| n
dâ€²
Î¼(d)f (dâ€²) =

0<dâ€²|n
â›
âœâf (dâ€²)

0<d| n
dâ€²
Î¼(d)
â
âŸâ .

214
8
Arithmetic Functions
Now, if n
dâ€² > 1 (i.e., if dâ€² < n), then Proposition 8.7 furnishes

0<d| n
dâ€²
Î¼(d) = 0.
Therefore, the next to last sum above reduces to the summand corresponding to
dâ€² = n, so that

0<dâ€²|n
â›
âœâf (dâ€²)

0<d| n
dâ€²
Î¼(d)
â
âŸâ = f (n)

0<d|1
Î¼(d) = f (n)Î¼(1) = f (n).
âŠ“âŠ”
Before we proceed with the development of the theory, we present an example
which shows how MÃ¶bius inversion formula can be a useful tool in counting
problems.
Example 8.9 Let n âˆˆN be given. We say that a sequence (x1, x2, . . . , xn), with
xj âˆˆ{0, 1} for 1 â‰¤j â‰¤n, is aperiodic if there does not exist a divisor 0 < d <
n of n such that the sequence is formed by the juxtaposition of n
d copies of the
subsequence (x1, . . . , xd). Compute, in terms of n, the total number of aperiodic
sequences of n terms.
Proof First of all, the fundamental principle of counting assures that there exist
exactly 2n sequences (x1, x2, . . . , xn) with xj âˆˆ{0, 1} for 1 â‰¤j â‰¤n.
On the other hand, for such a sequence (x1, x2, . . . , xn), we deï¬ne its period as
the least positive divisor d of n for which the sequence is formed by the juxtaposition
of n/d copies of the subsequence (x1, . . . , xd). In particular, an aperiodic sequence
(x1, x2, . . . , xn) has period n.
More generally, if the sequence (x1, x2, . . . , xn) has period d, then (x1, . . . , xd)
is necessarily aperiodic, and conversely. Hence, if ak denotes the number of
aperiodic sequences of k terms, we get

0<d|n
ad = 2n.
If we now apply the MÃ¶bius inversion formula, we obtain
an =

0<d|n
Î¼
n
d

2d,
as wished.
âŠ“âŠ”
The theory developed so far allows us to introduce and study the main properties
of another quite important arithmetic function, according to the following

8
Arithmetic Functions
215
Deï¬nition 8.10 Eulerâ€™s Ï• function is the function Ï• : N â†’N given by
Ï•(n) = #{1 â‰¤k â‰¤n; gcd(k, n) = 1}.
In words, Ï•(n) counts how many integers from 1 to n are relatively prime with
n. In what comes next, among other properties we shall show that the function Ï• is
multiplicative. We shall also use this result to compute Ï•(n) in terms of the canonical
decomposition of n in prime factors.2 We start with a result which will be useful in
other circumstances.
Proposition 8.11 With respect to Eulerâ€™s function Ï• : N â†’N, we have

0<d|n
Ï•(d) =

0<d|n
Ï•
n
d

= n.
Proof The ï¬rst equality comes from the bijectivity of function f in (8.3). For the
second one, let D(n) = {1 = a1 < a2 < Â· Â· Â· < at = n}. If 1 â‰¤k â‰¤n, then
gcd(k, n) âˆˆD(n), i.e., gcd(k, n) = ai for some 1 â‰¤i â‰¤t. Therefore, letting
Ai = {1 â‰¤k â‰¤n; gcd(k, n) = ai}, we get
In = A1 âˆª. . . âˆªAt,
a disjoint union. Hence, n = t
i=1 |Ai|. Now, note that
Ai = {1 â‰¤k â‰¤n; gcd(k, n) = ai}
= {1 â‰¤k/ai â‰¤n/ai; k/ai âˆˆN and gcd (k/ai, n/ai) = 1}
= {1 â‰¤l â‰¤n/ai; gcd (l, n/ai) = 1},
so that |Ai| = Ï•

n
ai

. Thus,
n =
t
i=1
|Ai| =
t
i=1
Ï•
 n
ai

=

0<d|n
Ï•
n
d

.
âŠ“âŠ”
For the coming result, also due to Euler, we shall need the fact, left as an exercise
to the reader (see Problem 1), that the product of two arithmetic multiplicative
functions yields yet another such function.
Theorem 8.12 (Euler)
The Euler function Ï• : N â†’N is multiplicative.
2Another approach was the object of Problem 6, page 40.

216
8
Arithmetic Functions
Proof Letting G(n) = n, the previous proposition gives us 
0<d|n Ï•(d) = G(n).
Therefore, it follows from MÃ¶bius inversion formula that
Ï•(n) =

0<d|n
Î¼(d)G
n
d

=

0<d|n
Î¼(d) Â· n
d = n

0<d|n
Î¼(d)
d
.
(8.5)
However, since f (d) =
Î¼(d)
d
is a multiplicative function (verify this assertion!),
Proposition 8.4 shows that function F : N â†’R, deï¬ned by
F(n) =

0<d|n
Î¼(d)
d
,
is also multiplicative. Hence, Problem 1 assures that Ï•(n) = nF(n) is multiplica-
tive, too.
âŠ“âŠ”
As we have promised before, the coming corollary relates Ï•(n) with the
canonical decomposition of an integer n > 1 in prime factors.
Corollary 8.13 (Euler)
If the canonical decomposition of an integer n > 1 in
primes is given by n = pÎ±1
1 . . . pÎ±k
k , then
Ï•(n) = n

1 âˆ’1
p1

. . .

1 âˆ’1
pk

.
(8.6)
Proof We shall ï¬rstly compute the value of Ï•(pÎ±), with p prime and Î± â‰¥1 integer:
Ï•(pÎ±) = #{1 â‰¤k â‰¤pÎ±; gcd(k, pÎ±) = 1}
= #{1 â‰¤k â‰¤pÎ±; gcd(k, p) = 1}
= #

{1, 2, 3, . . . , pÎ±} \ {p, 2p, 3p, . . . , pÎ±âˆ’1p}

= pÎ± âˆ’pÎ±âˆ’1
= pÎ±

1 âˆ’1
p

.
Now, since Ï• is multiplicative, it follows from (8.1) that
Ï•(n) = Ï•(pÎ±1
1 ) . . . Ï•(pÎ±k
k )
= pÎ±1
1

1 âˆ’1
p1

. . . pÎ±k
k

1 âˆ’1
pk

= pÎ±1
1 . . . pÎ±k
k

1 âˆ’1
p1

. . .

1 âˆ’1
pk

= n

1 âˆ’1
p1

. . .

1 âˆ’1
pk

.
âŠ“âŠ”

8
Arithmetic Functions
217
The formula of the previous corollary allows us to deduce many interesting (and
useful) properties of the Euler function. The coming example presents such a result.
Example 8.14 Given m âˆˆN, show that the equation Ï•(n) = m has at most a ï¬nite
number of solutions n âˆˆN.
Proof Firstly, if n = pÎ±r, with Î± â‰¥1, p prime and gcd(p, r) = 1, then the
multiplicative character of the function Ï• gives
m = Ï•(n) = Ï•(pÎ±)Ï•(r) = pÎ±âˆ’1(p âˆ’1)Ï•(r) â‰¥2Î±âˆ’1,
for Ï•(r) â‰¥1 and p â‰¥2. Hence, taking logarithms at base 2, we obtain
Î± â‰¤1 + log2 m.
Moreover, analogous computations furnish
m = pÎ±âˆ’1(p âˆ’1)Ï•(r) â‰¥p âˆ’1,
whence p â‰¤m + 1.
Now, if n = pÎ±1
1 . . . pÎ±k
k is the canonical decomposition of n in primes and Î± =
max{Î±1, . . . , Î±k}, it follows from what we did above that Î± â‰¤1+log2 n and, hence,
n â‰¤(p1 . . . pk)Î± â‰¤
 
pâ‰¤m+1
p prime
p
1+log2 m
.
âŠ“âŠ”
Problems: Chap. 8
1. * Prove that the product of two arithmetic multiplicative functions is also an
arithmetic multiplicative function.
2. Prove that, for every n âˆˆN, we have 0
0<d|n d = nd(n)/2.
3. Prove that s(n)
d(n) â‰¥âˆšn, for every n âˆˆN.
4. (OCM) A teacher chose a positive integer n and, then, posed the following
problems to two of his students: the ï¬rst one should compute the number of
ordered pairs (x, y) of positive integers satisfying the equation 1
x + 1
y = 1
n; the
second should do the same regarding the equation 1
x âˆ’1
y = 1
n. Knowing that
the sum of the answers found by the students was 78, show that at least one of
them made a mistake.
5. (Hungaryâ€”adapted) For n âˆˆN and 0 â‰¤r â‰¤3, let Dr(n) be the set of positive
divisors of n leaving remainder r upon division by 4.

218
8
Arithmetic Functions
(a) If gcd(m, n) = 1, prove that there exists a natural bijection
(D1(m) Ã— D1(n)) âˆª(D3(m) Ã— D3(n)) âˆ’â†’D1(mn).
Do the same with respect to (D1(m) Ã— D3(n)) âˆª(D3(m) Ã— D1(n)) and
D3(mn).
(b) Prove that |D1(n)| â‰¥|D3(n)|.
6. A natural number n > 1 is said to be perfect if s(n) = 2n, where s(n) denotes
the sum of the positive divisors of n. Prove that:
(a) If n > 1 is perfect, then 
0<d|n
1
d = 2.
(b) If p is a prime number for which 2p âˆ’1 is also prime, then 2pâˆ’1(2p âˆ’1)
is perfect.
7. The purpose of this problem is to establish the converse of the previous
problem, thus proving the following theorem of Euler: if n is an even perfect
number,3 then there exists a prime number p such that 2p âˆ’1 is prime and
n = 2pâˆ’1(2p âˆ’1). To this end, let n = 2kq be an even perfect number, with
k, q âˆˆN and q being odd. Do the following items:
(a) Conclude that (2k+1 âˆ’1)s(q) = 2k+1q. Then, show that there exists a âˆˆN
for which q = (2k+1 âˆ’1)a and s(q) = 2k+1a.
(b) If a = 1, show that 2k+1 âˆ’1 is prime, whence k + 1 = p, a prime number.
(c) If a = 2k+1 âˆ’1, show that s(q) â‰¥1 + a + a2 > (a + 1)a = 2k+1a, which
is a contradiction.
(d) If a > 1 and a Ì¸= 2k+1âˆ’1, then q has at least four distinct positive divisors:
1, 2k+1âˆ’1, a and (2k+1âˆ’1)a. Use this fact to conclude that s(q) > 2k+1a,
thus arriving at a new contradiction.
8. A natural number n is abundant if s(n) > 2n, where s(n) denotes the sum of
the positive divisors of n. If a âˆˆN is abundant, show that ab is also abundant,
regardless of the value of b âˆˆN.
9. Let f : N â†’R be deï¬ned by f (1) = 1 and, for n > 1,
f (n) =
(âˆ’1)k
p1p2 . . . pk
,
where p1, p2, . . . , pk are the distinct prime divisors of n. Find all n âˆˆN for
which 
0<d|n f (d) = 0.
10. If f : N â†’R is an arithmetic multiplicative function, prove that

0<d|n
Î¼(d)f (d) =

p prime
p|n
(1 âˆ’f (p)).
Then, use the above result to establish the following items:
3Up to this day, no one knows whether or not there exist odd perfect numbers.

8
Arithmetic Functions
219
(a) 
0<d|n dÎ¼(d) = 0
p prime
p|n
(1 âˆ’p).
(b) 
0<d|n Î¼(d)2 = 2k, where k is the number of distinct prime divisors of n
(note that k = 0 if n = 1).
11. Prove Liouvilleâ€™s theorem4: for each n âˆˆN, one has
 
0<j|n
d(j)
2
=

0<j|n
d(j)3.
12. * Let f : N â†’R be any function and F : N â†’R be given by F(n) =

0<d|n f (d). Prove that
n

k=1
F(k) =
n

j=1
(n
j
)
f (j).
13. Let f : N â†’{âˆ’1, 1} be given by f (1) = 1 and f (n) = (âˆ’1)Î±1+Â·Â·Â·+Î±k, where
n = pÎ±1
1 . . . pÎ±k
k is the canonical decomposition of an integer n > 1 in primes.
Prove that, for every integer n â‰¥1, one has
n

j=1
(n
j
)
f (j) = âŒŠâˆšnâŒ‹.
14. (Brazil) Prove that, for every natural number n > 1, we have
n
1
2 + 1
3 + Â· Â· Â· + 1
n

<
n

k=1
d(k) â‰¤n

1 + 1
2 + 1
3 + Â· Â· Â· + 1
n

.
15. Let F be an arithmetic multiplicative function and f : N â†’R be implicitly
deï¬ned by the equality F(n) = 
0<d|n f (d), for every n âˆˆN. Prove that f is
also multiplicative.
16. The purpose of this problem is to give another proof of the multiplicative
character of Eulerâ€™s function Ï•. To this end, given relatively prime integers
m, n > 1, arrange all natural numbers from 1 to mn as shown in the table
1
2 . . .
k . . .
m
m + 1
m + 2 . . .
m + k . . . 2m
2m + 1
2m + 2 . . .
2m + k . . . 3m
. . .
. . .
(n âˆ’1)m + 1 (n âˆ’1)m + 2 . . . (n âˆ’1)m + k . . . mn
and do the following items:
4After Joseph Liouville, French mathematician of the nineteenth century. As we shall see in
Sect. 20.4â€”cf. Theorem 20.31â€”Liouville was the one to give the very ï¬rst example of a
transcendental number.

220
8
Arithmetic Functions
(a) Prove that an entry of the table is relatively prime with mn if and only if it
is relatively prime with both m and n.
(b) Show that, in any column, either all elements are prime with m or none of
them satisï¬es such a property.
(c) Prove that there are exactly Ï•(m) columns formed by integers relatively
prime to m; moreover, each one of these columns contains precisely Ï•(n)
entries relatively prime with n.
(d) Conclude that Ï•(mn) = Ï•(m)Ï•(n).
17. If F(n) = 
0<d|n
Ï•(d)
d , compute F(n) in terms of the canonical decomposition
of n.
18. (OIM shortlist) For each m âˆˆN, let Am be the set of ordered pairs (d, n) of
integers such that d is a positive divisor of m, 1 â‰¤n â‰¤m and gcd(d, n) = 1.
Find all m âˆˆN for which |Am| = 1993.
19. * For an integer n > 2, prove the following items:
(a) If Pn = {1 â‰¤k â‰¤n; gcd(k, n) = 1}, then the correspondence k â†’n âˆ’k
is a bijection of Pn.
(b) Ï•(n) = 2l, where l is the number of elements of Pn which are less than or
equal to nâˆ’1
2 ; in particular, Ï•(n) is even.
20. Given m, n âˆˆN, with n > 2, let 1 = a1 < Â· Â· Â· < ak = n âˆ’1 be the positive
integers prime with n and less than or equal to n, and Sm(n) = k
i=1 am
i be the
sum of their m-th powers. Establish the following:
(a) If k = 2l, then Sm(n) = l
i=1(am
i + (n âˆ’ai)m). Then, use this relation to
conclude that Sm(n) is even whenever n is itself even.
(b) Sm(n) = m
j=0(âˆ’1)jm
j

nmâˆ’jSj(n).
(c) If m is odd, then 2Sm(n) = n mâˆ’1
j=0 (âˆ’1)jm
j

nmâˆ’1âˆ’jSj(n). Then, show
that n | Sm(n) if m is odd.
21. In the notations of the statement of the previous problem, show that:
(a) Every 1 â‰¤m â‰¤n can be uniquely written as m = n
d Â·a, with a, d âˆˆN such
that d | n and gcd(a, d) = 1.
(b) 
0<d|n
Sk(d)
dk
= 1k+2k+Â·Â·Â·+nk
nk
.
(c) Sk(n) = nk 
0<d|n Î¼
 n
d
 
1k+2k+Â·Â·Â·+dk
dk

.
(d) S1(n) = 1
2nÏ•(n).
(e) S2(n) = 1
3n2Ï•(n) + 1
6n 0
p prime
p|n
(1 âˆ’p).

Chapter 9
Calculus and Number Theory
In this chapter, we assume that the reader is conversant with the rudiments
of Calculus. More precisely, we shall assume from the reader familiarity with
convergent sequences and series, as well as with the notions of limits and derivatives
of functions. In this sense, the material of [8] covers all of what is necessary.
Here, we shall present some basic examples and results on the distribution of prime
numbers, having the classic book of professor G. Andrews [2] as guideline. We shall
also discuss a rather interesting asymptotic result of CesÃ ro, on pairs of relatively
prime natural numbers, following [29].
9.1
On the Distribution of Prime Numbers
One of the ï¬rst results on prime numbers we have learned in this book was Euclidâ€™s
theorem, which asserts that the set of primes is inï¬nite. Nevertheless, as was already
pointed out in Remark 6.39, there is an distinctive lack of uniformity on the way
these numbers distribute along the naturals. It is, therefore, quite astonishing that a
result such as Hadamardâ€™s Prime Number Theorem, quoted below, actually holds
true. Before we state it, let us set some notation: for each positive real x, we shall
write Ï€(x) to denote the number of prime numbers less than or equal to x.
Theorem 9.1 (Hadamard1)
In the above notations, one has
lim
xâ†’+âˆ
Ï€(x)
x/ log x = 1,
(9.1)
where log : (0, +âˆ) â†’R stands for the natural logarithm function.
1Jacques Hadamard, French mathematician of the nineteenth century.
Â© Springer International Publishing AG, part of Springer Nature 2018
A. Caminha Muniz Neto, An Excursion through Elementary Mathematics, Volume III,
Problem Books in Mathematics, https://doi.org/10.1007/978-3-319-77977-5_9
221

222
9
Calculus and Number Theory
Although a proof of the above theorem is well beyond the scope of these notes,
we refer the interested reader to the marvelous book of professor T. Apostol [5] for
a self-contained approach. However, we stress that Hadamardâ€™s theorem assures that
the functions Ï€(x) and
x
log x are asymptotically equal, in the sense that limit (9.1)
holds true.
A few years earlier than Hadamard, the Russian mathematician P. Chebyshev
obtained a much simpler (yet rather interesting) result on prime distribution,
guaranteeing the existence of positive constants c and C such that
c
x
log x â‰¤Ï€(x) â‰¤C
x
log x ,
for every real x â‰¥2.
A proof of the second one of the above inequalities will be the object of
Problem 4; for a proof of the ï¬rst one, we recommend to the reader the book of
professor Andrews, already quoted above. On the other hand, it readily follows from
the second one of the above inequalities that
Ï€(x)
x
â‰¤
C
log x
for every real x â‰¥2; in particular, one has
lim
xâ†’+âˆ
Ï€(x)
x
= 0.
(9.2)
In words, (9.2) says that the total quantity of prime numbers less than or equal
to x is an inï¬nitesimal with respect to x (i.e., grows much slower than x itself) as
x â†’+âˆ. In what follows, we shall give a direct prove of the validity of such a
result. We start with the following preliminary
Proposition 9.2 If k is a natural number, then
Ï€(x)
x
< Ï•(k)
k
+ 2k
x ,
where Ï• denotes Eulerâ€™s function.
Proof For a real number x > 0, let q, r âˆˆZ be such that âŒŠxâŒ‹= kq + r, with
0 â‰¤r < k. Note that
{1, 2, . . . , âŒŠxâŒ‹} =
 qâˆ’1

j=0
{kj + 1, kj + 2, . . . , k(j + 1)}

âˆª
âˆª{kq + 1, kq + 2, . . . , kq + r}.
(9.3)

9.1
On the Distribution of Prime Numbers
223
From 1 to k there is at most k prime numbers. On the other hand, if j â‰¥1, then,
for an element of {kj + 1, kj + 2, . . . , k(j + 1)} to be prime, it must necessarily be
relatively prime with k. Hence, such a set contains at most Ï•(k) prime numbers.
Now, since q =
- x
k
.
, (9.3) allows us to write down the following upper estimate
for Ï€(x):
Ï€(x) â‰¤k + (q âˆ’1)Ï•(k) + r < 2k +
x
k

Ï•(k) â‰¤2k + x
k Ï•(k).
Finally, in order to get the stated result, it sufï¬ces to divide both sides of the last
inequality above by x.
âŠ“âŠ”
We shall also need the following technical
Lemma 9.3 If m > 1 is an integer and p1, p2, . . . , pn are the prime numbers less
than or equal to m, then
m

j=1
1
j <
+
1 âˆ’1
p1
 
1 âˆ’1
p2

. . .

1 âˆ’1
pn
,âˆ’1
.
Proof Formula (3.1) for the sum of a convergent geometric series gives
+
1 âˆ’1
p1
 
1 âˆ’1
p2

. . .

1 âˆ’1
pn
,âˆ’1
=
n

i=1
"
1 + 1
pi
+ 1
p2
i
+ Â· Â· Â·
#
.
On the other hand, the choice of p1, p2, . . . , pn, together with the fundamental
theorem of arithmetic, guarantees the validity of the inclusion

1, 1
2, . . . , 1
m
/
âŠ‚

1
pj1
1 pj2
2 . . . pjn
n
; j1, j2, . . . , jn â‰¥0
3
.
Therefore,
m

j=1
1
j <

j1,j2,...,jnâ‰¥0
1
pj1
1 pj2
2 . . . pjn
n
=
n

i=1
"
1 + 1
pi
+ 1
p2
i
+ Â· Â· Â·
#
,
and the desired result promptly follows.
âŠ“âŠ”
The previous lemma, together with the divergence of the harmonic series (cf.
Example 7.37 of [8], for instance), gives
lim
nâ†’+âˆ
+
1 âˆ’1
p1

. . .

1 âˆ’1
pn
,âˆ’1
= +âˆ,
where pj stands for the j-th prime. Therefore,

224
9
Calculus and Number Theory
lim
nâ†’+âˆ

1 âˆ’1
p1

. . .

1 âˆ’1
pn

= 0.
(9.4)
With the previous results at our disposal, we are ï¬nally in position to prove the
promised weak version of Hadamardâ€™s theorem.
Theorem 9.4 limxâ†’+âˆÏ€(x)
x
= 0.
Proof We have to prove that, given Ïµ > 0, there exists x0 > 0 such that x >
x0 â‡’Ï€(x)
x
< Ïµ. To this end, let p1, p2, . . . , pn be the ï¬rst n prime numbers, and
k = p1p2 . . . pn. Proposition 9.2, together with the formula for Ï•(k), gives us
Ï€(x)
x
<

1 âˆ’1
p1
 
1 âˆ’1
p2

. . .

1 âˆ’1
pn

+ 2p1p2 . . . pn
x
.
(9.5)
Now, (9.4) allows us to choose a natural number n such that

1 âˆ’1
p1
 
1 âˆ’1
p2

. . .

1 âˆ’1
pn

< Ïµ
2.
If we let x0 = 4p1p2...pn
Ïµ
, then, for x > x0, it follows from (9.5) that
Ï€(x)
x
< Ïµ
2 + 2p1p2 . . . pn
x
< Ïµ
2 + 2p1p2 . . . pn
x0
= Ïµ,
as wished.
âŠ“âŠ”
The arguments that led to (9.4) used the fact that the harmonic series diverges:

nâ‰¥1
1
n = +âˆ. Heuristically, we can say that this is due to the fact that the
sequence of naturals has too many naturals (actually, all of them). On the other
hand, already in Lemma 3.15 we used the fact that the series of the inverses of
perfect squares converges: 
nâ‰¥1
1
n2 < +âˆ. This time, and also from a heuristic
point of view, we can attribute the convergence of the series to the fact that the
sequence of perfect squares contains too few naturals.
In view of the above, a natural question poses itself in the context of prime
numbers: if pn stands for the n-th prime number, does the series 
nâ‰¥1
1
pn have
too many or too few naturals, in the above sense? Theorem 9.4 would encourage us
to say that it does possess too few naturals.
At this point our intuition fails, for we shall prove below another theorem of the
great L. Euler,2 asserting the divergence of the series of the inverses of primes. To
this end, we shall need the inequality below, which readily follows from (3.7):
ex > 1 + x, âˆ€x > 0.
(9.6)
2For a slightly different proof of such a result, see the problems of Section 10.9 of [8].

9.1
On the Distribution of Prime Numbers
225
Theorem 9.5 (Euler)
If pk denotes the k-th prime, then the series 
kâ‰¥1
1
pk
diverges.
Proof If m âˆˆN and p1, p2, . . . , pk are the prime numbers less than or equal to m,
it is immediate to see that
â›
â

1â‰¤j<âˆšm
1
j2
â
â 
â›
â1 +

1â‰¤iâ‰¤k

1â‰¤j1<Â·Â·Â·<jiâ‰¤k
1
pj1pj2 . . . pji
â
â â‰¥
m

j=1
1
j .
Now, observe that the second factor at the left hand side of the previous inequality
is nothing but the sum of the inverses of the square free natural numbers less than or
equal to m. Letting 
1â‰¤jâ‰¤m
j sf
1
j denote this sum, we can write the above inequality as


1â‰¤j<âˆšm
1
j2
 
1â‰¤jâ‰¤m
j sf
1
j

â‰¥
m

j=1
1
j .
Since 
jâ‰¥1
1
j diverges and 
jâ‰¥1
1
j2 converges, we conclude that

jâ‰¥1
j sf
1
j
diverges. Finally, by the sake of contradiction, assume that the series of the inverses
of primes converges to a certain real number a. Then, for every n âˆˆN, we get
from (9.6) that
ea > exp
 
p<n
p prime
1
p

=

p<n
p prime
exp
 1
p

>

p<n
p prime

1 + 1
p

=

1â‰¤j<n
j sf
1
j ,
where exp : R â†’R denotes the exponential function of basis e. But this is indeed
a contradiction, for we already know that the sum of the inverses of the square free
natural numbers diverges.
âŠ“âŠ”
Problems: Sect. 9.1
1. Prove that there exists a positive real x0 for which Ï€(x) > log x
2x for x > x0.
2. For each integer k â‰¥1, let ak be the k-th natural number which is not a perfect
square. Decide whether the series 
kâ‰¥1
1
ak converges.

226
9
Calculus and Number Theory
3. For each integer k â‰¥1, let ak be the k-th composite natural number. Decide
whether the series 
kâ‰¥1
1
ak converges.
4. The purpose of this problem is to show that
Ï€(x) â‰¤(30 log 2)
x
log x ,
(9.7)
for every real x â‰¥8, where log : (0, +âˆ) â†’R denotes the natural logarithm
function. To this end, do the following items:
(a) For every n âˆˆN, prove that
2n
n

is divisible by all prime numbers p
satisfying n < p â‰¤2n. Moreover, show that
2n
n

< 22n.
(b) Prove that, for a natural n â‰¥2, one has Ï€(2n) < Ï€(n) + (2 log 2)
n
log n.
(c) If f : (0, +âˆ) â†’R is given by f (x) =
x
log x , show that f is increasing in
(e, +âˆ) and that f

x+2
2

< 15
6 f (x) for x â‰¥8.
(d) Use items (b) and (c) to conclude that Ï€(2n) < (32 log 2)
n
log n for every
integer n â‰¥2.
(e) Deduce that (9.7) holds for every real x â‰¥8.
5. The purpose of this problem is to establish the converse of Problem 17, page 191.
To this end, given n âˆˆN, let I(n) denote the sum of the greatest odd divisors of
the numbers 1, 2, . . . , n and do the following items:
(a) For n âˆˆN, let Ï„(n) be the greatest odd divisor of n and i(n) the greatest odd
integer less than or equal to n. Prove that
I(n) = (Ï„(1) + Ï„(3) + Â· Â· Â· + Ï„(i(n)))
+ (Ï„(2) + Ï„(4) + Â· Â· Â· + Ï„ (2âŒŠn/2âŒ‹))
= 1
4(i(n) + 1)2 + I âŒŠn/2âŒ‹) .
(b) In the notations of (a), show that
I(n) = 1
4
t
k=0
(i(qk) + 1)2,
where 2t is the greatest power of 2 which is less than or equal to n and, for
0 â‰¤k â‰¤t, qk is the quotient one gets upon dividing n by 2k.
(c) Use the fact that i(qk) â‰¤n
2k to get the estimate
I(n) â‰¤1
4
n2
3

4 âˆ’1
4t

+ n

4 âˆ’
1
2tâˆ’1

+ t + 1

.
(d) Use the fact that t = âŒŠlog2 nâŒ‹â‰¤n to get the estimate

9.2
Chebyshevâ€™s Theorem
227
I(n) â‰¤4n2 + 15n + 3
12
.
(e) Use inequalities âŒŠlog2 nâŒ‹â‰¥0, 2âŒŠlog2 nâŒ‹â‰¥2log2 nâˆ’1 = n
2 and
Ï„(qk) â‰¥qk âˆ’1 =
 n
2k

âˆ’1 â‰¥n
2k âˆ’2
to show, in an analogous way, that
I(n) â‰¥4n2 âˆ’12n âˆ’1
12
.
(f) If T (n) = 1 + 2 + Â· Â· Â· + n, conclude that
4n2 âˆ’12n âˆ’1
6n2 + 6n
â‰¤I(n)
T (n) â‰¤4n2 + 15n + 3
6n2 + 6n
.
Then, show that if r âˆˆQ \ { 2
3}, then I(n)
T (n) = r for at most a ï¬nite number of
integer values of n.
9.2
Chebyshevâ€™s Theorem
The Prime Number Theorem guarantees that the difference Ï€(2x) âˆ’Ï€(x) is
asymptotically equal to
2x
log(2x) âˆ’
x
log x =
x
log x

2 log x
log 2 + log x âˆ’1

=
x
log x
log x âˆ’log 2
log x + log 2

.
However, since
lim
xâ†’+âˆ
log x âˆ’log 2
log x + log 2 = 1,
we conclude that Ï€(2x) âˆ’Ï€(x) is asymptotically equal to
x
log x . It happens (for
instance by Lâ€™HÃ´pitalâ€™s rule) that
lim
xâ†’+âˆ
x
log x = +âˆ,
so that the above reasoning assures that the number of primes between x and 2x
grows unboundedly as x â†’+âˆ.

228
9
Calculus and Number Theory
In this section we give a complete proof of a much weaker result, also due to
Chebyshev, which shows that there is at least one prime number between n and 2n,
for every integer n > 1. For the proof of it, we shall need the two following auxiliary
results.
Lemma 9.6 Let n, p âˆˆN, with p prime, and let Î¼p be the exponent of p in the
factorisation of
2n
n

. Then,
Î¼p =

jâ‰¥1
( 2n
pj
)
âˆ’2
( n
pj
)
.
Moreover, if Î½p is the only integer such that pÎ½p â‰¤2n < pÎ½p+1, then Î¼p â‰¤Î½p.
Proof For the ï¬rst part, since
2n
n

= (2n)!
(n!)2 , we readily conclude that Î¼p is given
by pÎ¼p =
pep(2n)
p2ep(n) , where ep(2n) and ep(n) are as in Legendreâ€™s formula (cf.
Proposition 6.10). Hence,
Î¼p = ep(2n) âˆ’2ep(n),
and it sufï¬ces to use (6.10) to get the stated formula for Î¼p.
For the second part, it follows from the deï¬nition of Î½p that
j > Î½p â‡’pj > 2n â‡’
( 2n
pj
)
âˆ’2
( n
pj
)
= 0.
On the other hand, for j â‰¥1 we have
( 2n
pj
)
âˆ’2
( n
pj
)
< 2n
pj âˆ’2
 n
pj âˆ’1

= 2,
so that

2n
pj

âˆ’2

n
pj

â‰¤1. Therefore, gathering together the two pieces of
information above, we obtain
Î¼p =

jâ‰¥1
( 2n
pj
)
âˆ’2
( n
pj
)
=
Î½p

j=1
( 2n
pj
)
âˆ’2
( n
pj
)
â‰¤
Î½p

j=1
1 = Î½p.
âŠ“âŠ”
Lemma 9.7 If x â‰¥2 is a real number, then

pâ‰¤x
p prime
p < 4x.

9.2
Chebyshevâ€™s Theorem
229
Proof The lemma is clearly true for 2 â‰¤x â‰¤3. On the other hand, if it is valid for
x = n, where n â‰¥3 is an odd integer, then it will also be valid for n â‰¤y < n + 2;
indeed, in such a case n + 1 is even, so that

pâ‰¤y
p prime
p =

pâ‰¤n
p prime
p < 4n â‰¤4y.
It then sufï¬ces to show that the lemma is true for x = n, where n â‰¥3 is an odd
integer. To this end, we make induction on n â‰¥3 odd, noticing that we already have
the validity of the result for n = 3. By induction hypothesis, assume that it is also
true for all odd integers less than a certain odd integer n â‰¥5. Let k = nÂ±1
2 , with the
sign chosen in such a way that k is odd. Then, k â‰¥3 and n âˆ’k is even and such that
n âˆ’k = 2k âˆ“1 âˆ’k â‰¤k + 1.
Hence, if p is a prime number for which k < p â‰¤n, then p is odd, p | n!, p âˆ¤k!
and p âˆ¤(n âˆ’k)! (it cannot happen that n âˆ’k = k + 1 = p, since n âˆ’k is even).
Thus, we conclude that the product of all such primes divides
n
k

=
n!
k!(n âˆ’k)!,
so that

k<pâ‰¤n
p prime
p â‰¤
n
k

.
(9.8)
Now, our choice of k assures that k and n âˆ’k are distinct. However, since
n
k

=
 n
nâˆ’k

and such binomial numbers are summands in the binomial expansion of 2n =
(1 + 1)n, we get
n
k

â‰¤2nâˆ’1, and (9.8) furnishes

k<pâ‰¤n
p prime
p â‰¤2nâˆ’1.
(9.9)
Therefore, the induction hypothesis and (9.9) give

pâ‰¤n
p prime
p =
 
pâ‰¤k
p prime
p
 
k<pâ‰¤n
p prime
p

< 4k Â· 2nâˆ’1 = 22k+nâˆ’1 â‰¤22n = 4n.
âŠ“âŠ”

230
9
Calculus and Number Theory
We have ï¬nally arrived at the desired result, which is known as Chebyshevâ€™s
theorem.3
Theorem 9.8 (Chebyshev)
For each integer n > 1, there is at least one prime
number between n and 2n.
Proof A general argument will prove the result when n â‰¥128. For n < 128 take
p = 3 if n = 2, p = 5 if n = 3 and:
p = 7 if 4 â‰¤n â‰¤6;
p = 13 if 7 â‰¤n â‰¤12;
p = 23 if 13 â‰¤n â‰¤22;
p = 43 if 23 â‰¤n â‰¤42;
p = 83 if 43 â‰¤n â‰¤82;
p = 131 if 83 â‰¤n â‰¤127.
Now, assume the result is false for some integer n â‰¥128. In the notations of
Lemma 9.6, such a supposition guarantees that
2n
n

=

pâ‰¤2n
p prime
pÎ¼p =

pâ‰¤n
p prime
pÎ¼p.
However, for any prime p such that 2n
3 < p â‰¤n, we have
p â‰¥3, p2 > 2
3np, 1 â‰¤n
p < 3
2, and 2 â‰¤2n
p < 3,
so that 2n
p2 < 3
p â‰¤1; it thus follows that
Î¼p =

jâ‰¥1
( 2n
pj
)
âˆ’2
( n
pj
)
=
(2n
p
)
âˆ’2
( n
p
)
= 2 âˆ’2 = 0.
On the other hand, for any prime p such that
âˆš
2n < p â‰¤2n
3 , we have p2 > 2n,
and Lemma 9.6 gives 1 â‰¤Î¼p â‰¤Î½p = 1. Finally, for primes p such that p â‰¤
âˆš
2n,
we have, again by Lemma 9.6, that pÎ¼p â‰¤pÎ½p â‰¤2n.
3Pafnuty Chebyshev, Russian mathematician of the nineteenth century.

9.2
Chebyshevâ€™s Theorem
231
The estimates above give us (in what follows, p denotes a prime number)
2n
n

=
â›
â
pâ‰¤
âˆš
2n
pÎ¼p
â
â 
â›
âœâ

âˆš
2n<pâ‰¤2n
3
pÎ¼p
â
âŸâ 
â›
âœâ

2n
3 <pâ‰¤n
pÎ¼p
â
âŸâ 
=
â›
â
pâ‰¤
âˆš
2n
2n
â
â 
â›
âœâ

âˆš
2n<pâ‰¤2n
3
p
â
âŸâ 
< 4
2n
3
â›
â
pâ‰¤
âˆš
2n
2n
â
â ,
where we used Lemma 9.7 in the inequality above.
Since 9 and the even integers greater than 2 are not primes, the condition n â‰¥128
(â‡”
âˆš
2n â‰¥16) assures that
Ï€
âˆš
2n

â‰¤
âˆš
2n âˆ’1
2
âˆ’1.
Substituting this last estimate into (9.10), we arrive at
2n
n

< 4
2n
3 (2n)Ï€(
âˆš
2n) < 4
2n
3 (2n)
âˆšn
2 âˆ’1.
(9.10)
Finally, note that
2n
n

is the largest among all of the 2n + 1 summands in the
binomial expansion of 4n = (1 + 1)2n. Since the ï¬rst and last of these summands
are both equal to 1, we get 2n
2n
n

> 4n or, which is the same,
2n
n

> 4n
2n. In turn,
such an estimate, combined with (9.10), furnishes
4n
2n < 4
2n
3 (2n)
âˆšn
2 âˆ’1,
which yields
2
2n
3 < (2n)
âˆšn
2 .
Taking natural logarithms an dividing both sides by
âˆš
2n
6 , we conclude that the above
inequality can be rewritten as
âˆš
8n log 2 âˆ’3 log(2n) < 0.
(9.11)

232
9
Calculus and Number Theory
Letting f (x) =
âˆš
8x log 2 âˆ’3 log(2x), we have f (128) = 8 log 2 > 0 and
f â€²(x) =
âˆš
2x log 2 âˆ’3
x
> 0
for x â‰¥128. Thus, f is increasing for x â‰¥128 and (9.11) is false, which gives us
the desired contradiction.
âŠ“âŠ”
The famous Goldbach conjecture4 claims that every even number greater than
2 can be written as the sum of two (not necessarily distinct) primes. Although a
serious account on the state of the art on Goldbachâ€™s conjecture is far beyond the
scope of these notes, Chebyshevâ€™s theorem allows us to present a simple example
on the possibility of writing natural numbers as sums of distinct primes.
Example 9.9 Let P stand for the set of prime numbers. Show that every natural
number can be written as a sum of distinct elements of the set {1} âˆªP.
Proof Let n > 1 be a natural number and p be the greatest prime number less than
or equal to n. If n â‰¥2p, then Chebyshevâ€™s theorem would give a prime q between
p and 2p, which would contradict the maximality of p. Therefore, p â‰¤n < 2p
and, hence, 0 â‰¤n âˆ’p < p. Arguing by induction, we conclude that n âˆ’p can be
written as a sum of distinct elements of the set {1}âˆªP, and writing n = (nâˆ’p)+p
we conclude that the same is true of n.
âŠ“âŠ”
Problems: Sect. 9.2
1. If pn is the n-th prime, prove that pn+1 < 2pn.
2. * Prove that, for every integer n > 1, there exists a prime p whose exponent in
the canonical decomposition of n! is equal to 1.
3. (TT) Prove that, for every integer n > 1, the number 1!2! Â· Â· Â· n! is not a perfect
square.
4. Find all natural numbers m, n, x and y such that m, n > 1 and (m!)x = (n!)y.
For the two coming problems, the reader will ï¬nd it convenient to use the
following stronger version of Chebyschevâ€™s theorem: for every integer n â‰¥6,
there are at least two primes between n and 2n.
5. (OCS) Find all m, n âˆˆN such that (n âˆ’1)!n! = m!.
6. Find all natural numbers n > 1 such that every natural 1 < m < n which is
relatively prime with n is indeed a prime number.
4After Christian Goldbach, German mathematician of the eighteenth century.

9.3
CÃ¨saroâ€™s Theorem
233
9.3
CÃ¨saroâ€™s Theorem
In 1881, E. CesÃ ro5 proved that the odds that two randomly chosen natural numbers
be relatively prime is equal to 6
Ï€2 . We ï¬nish this chapter by presenting an elementary
proof of this fact. Our exposition follows a nonpublished manuscript of prof. Hudson
N. Lima (cf. [29]). We start by recalling a few rather simple facts on the calculus of
probabilities.
Let E be a ï¬nite nonempty set, said to be the sampling space, and P be a
probability distribution in E, i.e., a function P : E â†’[0, 1] such that

xâˆˆE
P(x) = 1.
For each x âˆˆE, we call P(x) the probability of x; also, we say that the elements
of E are equiprobable provided
P(x) =
1
|E|, âˆ€x âˆˆE.
More generally, an event in E is a subset X of E, and we let its probability be
deï¬ned by
P(X) =

xâˆˆX
P(x).
Back to the problem we wish to analyse, let6 E = In Ã— In and assume that the
elements of E are equiprobable, so that the probability of each one of them equals
1
n2 . Given n âˆˆN, let Pn be the probability that a randomly chosen ordered pair
(a, b) âˆˆE have relatively prime entries a and b. We want to show that
lim
nâ†’âˆPn = 6
Ï€2 .
We shall ï¬rst of all ï¬nd an adequate expression for Pn, and to this end we begin by
observing that Pn = |X|
n2 , where
X = {(a, b) âˆˆIn Ã— In; gcd(a, b) = 1}
is the event subjacent to Pn.
5Ernesto CesÃ ro, Italian mathematician of the nineteenth century.
6As in previous chapters, we set In = {1, 2, . . . , n}.

234
9
Calculus and Number Theory
Elementary counting gives
|X| = 2#{(a, b) âˆˆIn Ã— In; gcd(a, b) = 1 and a â‰¤b}
âˆ’#{(a, a) âˆˆIn Ã— In; gcd(a, a) = 1}
= 2
n

b=1
#{a âˆˆIn; gcd(a, b) = 1 and a â‰¤b} âˆ’1
= 2
n

b=1
Ï•(b) âˆ’1,
where Ï• denotes Eulerâ€™s function. Hence,
Pn =
2
n

b=1
Ï•(b) âˆ’1
n2
.
(9.12)
We now need the following auxiliary result.
Lemma 9.10 If f : N â†’R is any function, then for n âˆˆN we have:
(a) n
k=1

0<d|k f (d) = n
k=1 f (k)
- n
k
.
.
(b) n
k=1 k 
0<d|k f (d) = 1
2
n
k=1 kf (k)
- n
k
.
(
- n
k
.
+ 1).
Proof Item (a) is the content of Problem 12, page 219. Concerning (b), note ï¬rstly
that the set of ordered pairs (d, k) of integers such that 1 â‰¤k â‰¤n and 0 < d | k
coincides with the set of ordered pairs (d, k) of integers such that 1 â‰¤d â‰¤n and
k = ld, for some integer 1 â‰¤l â‰¤n/d. Hence, we can change the order of the
involved sums, thus getting
n

k=1
k

0<d|k
f (d) =
n

d=1

k=ld
1â‰¤lâ‰¤n
d
kf (d)
=
n

d=1
f (d)

d + 2d + Â· Â· Â· +
n
d

d

= 1
2
n

d=1
df (d)
n
d
 n
d

+ 1

.
âŠ“âŠ”
Now, recall that, according to (8.5),
Ï•(n) = n

0<d|n
Î¼(d)
d
,

9.3
CÃ¨saroâ€™s Theorem
235
where Î¼ : N â†’R stands for the MÃ¶bius function. Therefore, item (b) of the
previous lemma furnishes
2
n

k=1
Ï•(k) = 2
n

k=1
k

0<d|k
Î¼(d)
d
=
n

k=1
Î¼(k)
n
k
 n
k

+ 1

=
n

k=1
Î¼(k)
n
k
2
+
n

k=1
Î¼(k)
n
k

.
(9.13)
The second summand in the last sum above can be computed with the aid of item
(a) of the previous lemma, together with the result of Proposition 8.7. Indeed, we
have
n

k=1
Î¼(k)
n
k

=
n

k=1

0<d|k
Î¼(d) = 1,
since 
0<d|k Î¼(d) does not vanish only for k = 1. It follows from (9.12) and (9.13)
that
Pn = 1
n2
n

k=1
Î¼(k)
n
k
2
.
(9.14)
With the last formula above at our disposal, we can state and prove the coming
proposition, which assures that the limit limnâ†’âˆPn does exist and expresses it as
another limit which, as we shall see, can be effectively computed. We begin by
noticing that, since |Î¼(k)| â‰¤1 for every k âˆˆN and 
kâ‰¥1
1
k2 is convergent, the
series

kâ‰¥1
Î¼(k)
k2
is absolutely convergent, hence convergent.
Proposition 9.11 If Pn is as in (9.14), then limnâ†’âˆPn exists and is such that
lim
nâ†’âˆPn =

kâ‰¥1
Î¼(k)
k2 .

236
9
Calculus and Number Theory
Proof Firstly, from (9.14) we get
					Pn âˆ’
n

k=1
Î¼(k)
k2
					 =
					
n

k=1
Î¼(k)
 1
n2
n
k
2
âˆ’1
k2
					
â‰¤
n

k=1
				
1
k2 âˆ’1
n2
n
k
2				 .
(9.15)
In order to estimate the last sum above, we claim that, given natural numbers n
and k such that 1 â‰¤k â‰¤n, we have
				
1
k2 âˆ’1
n2
n
k
2				< 2
nk âˆ’1
n2 .
Indeed,
n
k âˆ’1 <
n
k

â‰¤n
k â‡’n2
k2 âˆ’2n
k + 1 <
n
k
2
â‰¤n2
k2
â‡’1
k2 âˆ’2
kn + 1
n2 < 1
n2
n
k
2
â‰¤1
k2
â‡’0 â‰¤1
k2 âˆ’1
n2
n
k
2
< 2
kn âˆ’1
n2 ,
as wished.
Back to (9.15), we obtain from the above estimates that
					Pn âˆ’
n

k=1
Î¼(k)
k2
					 <
n

k=1
 2
nk âˆ’1
n2

= 2
n
n

k=1
1
k âˆ’1
n.
Now, from Lâ€™HÃ´pitalâ€™s rule we get
2
n
n

k=1
1
k < 2
n

1 +
$ n
1
1
t dt

= 2
n(log n + 1) â†’0
as n â†’+âˆ. Hence,
lim
nâ†’+âˆ
"
2
n
n

k=1
1
k âˆ’1
n
#
= 0,
and our previous estimates assure that

9.3
CÃ¨saroâ€™s Theorem
237
lim
nâ†’+âˆ
"
Pn âˆ’
n

k=1
Î¼(k)
k2
#
= 0.
Finally, it follows from the above that
lim
nâ†’âˆPn = lim
nâ†’âˆ
"
Pn âˆ’
n

k=1
Î¼(k)
k2
#
+

kâ‰¥1
Î¼(k)
k2
=

kâ‰¥1
Î¼(k)
k2 .
âŠ“âŠ”
The former result reduced the proof of CesÃ roâ€™s theorem to showing that

kâ‰¥1
Î¼(k)
k2
= 6
Ï€2 .
To this end, we ï¬rst need to show the coming result.
Theorem 9.12

kâ‰¥1
1
k2 = Ï€2
6 .
The proof we present is due to professors A. Yaglom and I. Yaglom (cf. Chapter 8
of [1]) and relies on some elementary results on complex numbers and roots of
polynomials; Chaps. 13 and 16 cover all that is necessary. The classical alternative
proof, relying upon the theory of Fourier Series, is delineated in problems 11 and 12
of Section 11.2 of [8] (alternatively, see Chapter 8 of [33] or Chapter 2 of [36]).
Proof The ï¬rst of de Moivreâ€™s formulas (cf. Proposition 13.9) gives us
sin(nÎ¸) = Im((cos Î¸ + i sin Î¸)n)
= Im
â§
â¨
â©
n

j=0
n
j

ij(cos Î¸)nâˆ’j (sin Î¸)j
â«
â¬
â­
=
âŒŠnâˆ’1
2 âŒ‹

k=0
(âˆ’1)k

n
2k + 1

(cos Î¸)(nâˆ’2kâˆ’1) (sin Î¸)(2k+1).
Therefore,
sin(nÎ¸)
(sin Î¸)n =
âŒŠnâˆ’1
2 âŒ‹

k=0
(âˆ’1)k

n
2k + 1

(cot Î¸)(nâˆ’2kâˆ’1),
whenever sin Î¸ Ì¸= 0.

238
9
Calculus and Number Theory
For n = 2m + 1, we have
sin((2m + 1)Î¸)
(sin Î¸)(2m+1)
=
m

k=0
(âˆ’1)k
2m + 1
2k + 1

(cot Î¸)(2mâˆ’2k).
Thus, letting
f (x) =
m

k=0
(âˆ’1)k
2m + 1
2k + 1

xmâˆ’k,
we have shown that
f ((cot Î¸)2) = sin((2m + 1)Î¸)
(sin Î¸)(2m+1) .
(9.16)
Setting Î¸k = (
k
2m+1)Ï€ for k = 1, 2, . . . , m, it is immediate from (9.16) that
(cot Î¸1)2, (cot Î¸2)2, . . . , (cot Î¸m)2 are m distinct roots of f . However, since f has
degree m, we conclude that those are all of its complex roots. Now, the Girard-ViÃ¨te
relations between coefï¬cients and roots of a polynomial (cf. Proposition 16.6) give
(cot Î¸1)2 + (cot Î¸2)2 + Â· Â· Â· + (cot Î¸m)2 =
2m+1
3

2m+1
1
 = m(2m âˆ’1)
3
.
From this, basic Trigonometry allows us to compute
(csc Î¸1)2 + Â· Â· Â· + (csc Î¸m)2 = (1 + (cot Î¸1)2) + Â· Â· Â· + (1 + (cot Î¸m)2)
= m + ((cot Î¸1)2 + Â· Â· Â· + (cot Î¸m)2)
= m + m(2m âˆ’1)
3
= 2m(m + 1)
3
.
Finally, since Î¸j âˆˆ(0, Ï€
2 ) for 1 â‰¤j â‰¤m, we have for 1 â‰¤j â‰¤m the inequalities
sin Î¸j â‰¤Î¸j â‰¤tan Î¸j
or, which is the same,
(cot Î¸j)2 â‰¤1
Î¸2
j
â‰¤(csc Î¸j)2.

9.3
CÃ¨saroâ€™s Theorem
239
Therefore,
m(2m âˆ’1)
3
=
m

j=1
(cot Î¸j)2 â‰¤
m

j=1
1
Î¸2
j
â‰¤
m

j=1
(csc Î¸j)2 = 2m(m + 1)
3
and, taking the deï¬nition of the Î¸j into account,
m(2m âˆ’1)
3
â‰¤
m

j=1
(2m + 1)2
Ï€2j2
â‰¤2m(m + 1)
3
.
Multiplying the last inequalities above by
Ï€2
(2m+1)2 , letting m â†’+âˆand noticing
that
lim
mâ†’âˆ
m(2m âˆ’1)
3(2m + 1)2 = lim
mâ†’âˆ
2m(m + 1)
3(2m + 1)2 = 1
6,
the squeezing principle for limits of sequences gives us the desired result.
âŠ“âŠ”
Theorem 9.13 If pn stands for the n-th prime number, then
lim
nâ†’âˆ
n

k=1
"
1 âˆ’1
p2
k
#âˆ’1
=

kâ‰¥1
1
k2 .
Proof Since pn > n for every n âˆˆN, the fundamental theorem of arithmetic gives
(upon expanding the right hand side below)
n

k=1
1
k2 â‰¤
"
1 + 1
p2
1
+ Â· Â· Â· + 1
p2l
1
#
. . .

1 + 1
p2n
+ Â· Â· Â· + 1
p2l
n

for every integer l â‰¥1. Moreover, also for every integer l â‰¥1, we have
"
1 + 1
p2
1
+ Â· Â· Â· + 1
p2l
1
#
. . .

1 + 1
p2n
+ Â· Â· Â· + 1
p2l
n

â‰¤
pl
1...pl
n

k=1
1
k2 ,
once more from the fundamental theorem of arithmetic, together with the fact that
each summand obtained from the expansion of the products at the left hand side is
also present at the right hand side.
Since
pl
1...pl
n

k=1
1
k2 â‰¤

kâ‰¥1
1
k2 ,

240
9
Calculus and Number Theory
we obtain the set of inequalities
n

k=1
1
k2 â‰¤
"
1 + 1
p2
1
+ Â· Â· Â· + 1
p2l
1
#
. . .

1 + 1
p2n
+ Â· Â· Â· + 1
p2l
n

â‰¤

kâ‰¥1
1
k2 .
Letting l â†’+âˆand observing that
lim
lâ†’âˆ
"
1 + 1
p2
i
+ Â· Â· Â· + 1
p2l
i
#
=

jâ‰¥0
1
p2j
i
=
"
1 âˆ’1
p2
i
#âˆ’1
,
we get
n

k=1
1
k2 â‰¤
"
1 âˆ’1
p2
1
#âˆ’1
Â· Â· Â·

1 âˆ’1
p2n
âˆ’1
â‰¤

kâ‰¥1
1
k2
ou, which is the same,
n

k=1
1
k2 â‰¤
n

k=1
"
1 âˆ’1
p2
k
#âˆ’1
â‰¤

kâ‰¥1
1
k2 .
Finally, it now sufï¬ces to let n â†’+âˆand invoke the squeezing theorem.
âŠ“âŠ”
Theorem 9.14 If pn denotes the n-th prime number, then
lim
nâ†’âˆ
n

k=1
"
1 âˆ’1
p2
k
#
=

kâ‰¥1
Î¼(k)
k2 .
Proof In all that follows, we make the following convention on indices: l < m â‡’
il < im. Given n âˆˆN, let:
â€¢
An be the set of natural numbers of the form pi1pi2 . . . pi2s, with s âˆˆN and pi1,
pi2, . . . , pi2s being prime numbers such that pi1pi2 . . . pi2s â‰¤n;
â€¢
ËœAn be the set of natural numbers of the form pi1pi2 . . . pi2s, with s âˆˆN, pi1 and
pi2, . . . , pi2s being primes such that i1, i2, . . . , i2s â‰¤n;
â€¢
Bn be the set of naturals of the form pi1pi2 . . . pi2s+1, with s âˆˆN and pi1, pi2,
. . . , pi2s+1 being prime numbers such that pi1pi2 . . . pi2s+1 â‰¤n;
â€¢
ËœBn be the set of naturals of the form pi1pi2 . . . pi2s+1, with s âˆˆN and pi1, pi2,
. . . , pi2s+1 being prime numbers such that i1, i2, . . . , i2s+1 â‰¤n;

9.3
CÃ¨saroâ€™s Theorem
241
Let also
an = 1 +

xâˆˆAn
1
x2 , Ëœan = 1 +

xâˆˆËœAn
1
x2 , bn =

xâˆˆBn
1
x2 and Ëœbn =

xâˆˆËœBn
1
x2 .
It is immediate to verify that
an âˆ’bn =
n

k=1
Î¼(k)
k2
and Ëœan âˆ’Ëœbn =
n

k=1
"
1 âˆ’1
p2
k
#
.
Moreover, the limits lim an, lim bn, lim Ëœan and lim Ëœbn all exist, for the corresponding
sequences are nondecreasing and bounded above by âˆ
k=1
1
k2 . In particular, this
reasoning assures the existence of the limit
lim
nâ†’âˆ
n

k=1
"
1 âˆ’1
p2
k
#
.
Since pn > n for every n âˆˆN, we have An âŠ‚ËœAn âŠ‚Ap1p2...pn and Bn âŠ‚ËœBn âŠ‚
Bp1p2...pn. Therefore, the following inequalities are valid:
an â‰¤Ëœan â‰¤ap1p2...pn and bn â‰¤Ëœbn â‰¤bp1p2...pn.
Hence, once more from the squeezing theorem, we get
lim
nâ†’âˆan = lim
nâ†’âˆËœan and
lim
nâ†’âˆbn = lim
nâ†’âˆ
Ëœbn,
so that
lim
nâ†’âˆ
n

k=1
"
1 âˆ’1
p2
k
#
= lim
nâ†’âˆËœan âˆ’lim
nâ†’âˆ
Ëœbn = lim
nâ†’âˆan âˆ’lim
nâ†’âˆbn
= lim
nâ†’âˆ
n

k=1
Î¼(k)
k2
=

kâ‰¥1
Î¼(k)
k2 ,
as wished.
âŠ“âŠ”

242
9
Calculus and Number Theory
We can ï¬nally gather together the results above to compute
lim
nâ†’âˆPn =

kâ‰¥1
Î¼(k)
k2
= lim
nâ†’âˆ
n

k=1
"
1 âˆ’1
p2
k
#
=
â¡
â£lim
nâ†’âˆ
n

k=1
"
1 âˆ’1
p2
k
#âˆ’1â¤
â¦
âˆ’1
=
â¡
â£
kâ‰¥1
1
k2
â¤
â¦
âˆ’1
= 6
Ï€2 .

Chapter 10
The Relation of Congruence
In this chapter, we deï¬ne and explore the most basic properties of the important
relation of congruence modulo n > 1. Our central goal is to prove the famous
Fermatâ€™s little theorem, as well as its generalization, due to Euler. The pervasiveness
of these two results in elementary Number Theory owes a great deal to the fact that
they form the starting point for a systematic study of the behavior of the remainders
of powers of a natural number a upon division by a given natural number n >
1, relatively prime with a. We also present the no less famous Chinese remainder
theorem, along with some interesting applications.
10.1
Basic Deï¬nitions and Properties
The central object of study in this section is the relation on Z deï¬ned as follows.
Deï¬nition 10.1 Let a, b and n be given integers, with n > 1. We say that a is
congruent to b, modulo n, and denote a â‰¡b (mod n), provided n | (a âˆ’b). If a is
not congruent to b modulo n, we write a Ì¸â‰¡b (mod n).
Examples 10.2 According to the above deï¬nition, we can write:
(a) 3 â‰¡5 (mod 2), for 2 | (3 âˆ’5).
(b) âˆ’1 â‰¡11 (mod 12), for 12 | (âˆ’1 âˆ’11).
(c) 2 â‰¡âˆ’1 (mod 3), for 3 | (2 âˆ’(âˆ’1)).
(d) x â‰¡âˆ’x (mod 2), for 2 | (x âˆ’(âˆ’x)).
(e) 1 Ì¸â‰¡2 (mod 3), for 3 âˆ¤(1 âˆ’2).
(f) 20 Ì¸â‰¡15 (mod 7), for 7 âˆ¤(20 âˆ’15).
What are we really looking at when we consider congruences modulo n? In order
to answer such a question, let us observe what happens with the integers modulo 4,
for instance:
Â© Springer International Publishing AG, part of Springer Nature 2018
A. Caminha Muniz Neto, An Excursion through Elementary Mathematics, Volume III,
Problem Books in Mathematics, https://doi.org/10.1007/978-3-319-77977-5_10
243

244
10
The Relation of Congruence
4k â‰¡0 (mod 4), 4k + 1 â‰¡1 (mod 4),
4k + 2 â‰¡2 (mod 4) and 4k + 3 â‰¡3 (mod 4).
Thus, the list . . . , âˆ’5, âˆ’4, âˆ’3, âˆ’2, âˆ’1, 0, 1, 2, 3, 4, 5, . . . of integers is equal,
modulo 4, to
. . . , 3, 0, 1, 2, 3, 0, 1, 2, 3, 0, 1, . . .
(with 0 corresponding to 0, of course), and we readily see that every integer is
congruent, modulo 4, to its remainder upon division by 4. This result still holds
true in general, as shown by the following result.
Proposition 10.3 Let a and n be given integers, with n > 1.
(a) If a leaves remainder r upon division by n, then a â‰¡r (mod n). In particular,
every integer is congruent, modulo n, to exactly one of the numbers 0, 1, 2, . . .,
n âˆ’2, n âˆ’1.
(b) a â‰¡b (mod n) â‡”a and b leave equal remainders when divided by n.
Proof
(a) Assume that a leaves remainder r upon division by n. Then, the division
algorithm gives a = qn + r, for some integer q, and this gives that n | (a âˆ’r).
But this is the same as writing a â‰¡r (mod n). The rest is immediate.
(b) If a â‰¡b (mod n), then n | (a âˆ’b) and Corollary 6.9 (with a and b in place of
a1 and a2, and n in place of b) shows that a and b leave equal remainders when
divided by n. Conversely, if a and b leave the same remainder r upon division
by n, we can write a = nq1 + r and b = nq2 + r, with q1, q2 âˆˆZ. Therefore,
a âˆ’b = n(q1 âˆ’q2), so that n | (a âˆ’b). Hence, a â‰¡b (mod n).
âŠ“âŠ”
Remark 10.4 The deï¬nition of congruence modulo n excludes modulus n = 1 for,
otherwise, a â‰¡b (mod 1) would be a synonym of 1 | (a âˆ’b), which is always
true. Hence, any two integers would be indistinguishable modulo 1, so that such a
relation would be useless, as far as divisibility is concerned.
Since congruence modulo n only sees remainders upon division by n, the reader
may well be asking himself/herself what advantage(s) (if any) do we have in using
it. As we shall see in a while, the ï¬rst proï¬t is computational in nature. Indeed, in
the two coming propositions we prove some elementary properties of congruences
that will allow us, for instance, to mechanically compute the remainder we get upon
dividing 172002 by 13. Such a task is not so easy to accomplish by using the methods
we developed so far.
Proposition 10.5 Given integers a, b, c and n, with n > 1, we have:
(a) a â‰¡a (mod n).
(b) a â‰¡b (mod n) â‡’b â‰¡a (mod n).
(c) a â‰¡b (mod n) and b â‰¡c (mod n) â‡’a â‰¡c (mod n).

10.1
Basic Deï¬nitions and Properties
245
Proof Items (a) and (b) are immediate. Concerning (c), if a â‰¡b (mod n) and b â‰¡
c (mod n), then n | (a âˆ’b) and n | (b âˆ’c), and item i. of Remark 6.6 assures that n
also divides a âˆ’c = (a âˆ’b)+(bâˆ’c). But this is the same as having a â‰¡c (mod n).
âŠ“âŠ”
Proposition 10.6 Let a, b, c, d, m and n be given integers, with m, n > 1.
(a) If a â‰¡b (mod n) and c â‰¡d (mod n), then a + c â‰¡b + d (mod n) and ac â‰¡
bd (mod n). In particular, ac â‰¡bc (mod n).
(b) If a â‰¡b (mod n), then ak â‰¡bk (mod n) for every k âˆˆN.
(c) If c0, c1, . . . , cm âˆˆZ and f (x) = cmxm + Â· Â· Â· + c1x + c0 is a polynomial
function, then
a â‰¡b (mod n) â‡’f (a) â‰¡f (b) (mod n).
(d) If a â‰¡b (mod n), then gcd(a, n) = gcd(b, n).
(e) If a + c â‰¡b + c (mod n), then a â‰¡b (mod n).
(f) If ac â‰¡bc (mod n) and gcd(c, n) = d, then a â‰¡b (mod n
d ). In particular, if
gcd(c, n) = 1, then a â‰¡b (mod n).
(g) If a â‰¡b (mod mn), then a â‰¡b (mod m) and a â‰¡b (mod n).
(h) If a â‰¡b (mod n) and a â‰¡b (mod m), with gcd(m, n) = 1, then a â‰¡
b (mod mn).
Proof
(a) Since (a + c) âˆ’(b + d) = (a âˆ’b) + (c âˆ’d), ac âˆ’bd = a(c âˆ’d) + (a âˆ’b)d
and n | (a âˆ’b), n | (c âˆ’d), it follows from item (c) of Proposition 6.5 (see also
item i. of Remark 6.6) that n | [(a + c) âˆ’(b + d)] and n | (ac âˆ’bd). But this
is the same as having a + c â‰¡b + d (mod n) and ac â‰¡bd (mod n). Finally, the
particular case follows from c â‰¡c (mod n).
(b) Letting c = a and d = b in the second part of item (a), we get a2 â‰¡b2 (mod n).
On the other hand, had we already shown that al â‰¡bl (mod n) for some l âˆˆN,
then, once more from the second part of (a) (this time with c = al and d = bl),
we obtain
al+1 = a Â· al â‰¡b Â· bl = bl+1 (mod n).
Item (b) follows, then, by induction on k.
(c) If a â‰¡b (mod n), then we get from items (a) and (b) that ckak â‰¡ckbk (mod n),
for 0 â‰¤k â‰¤m. Hence, it follows from Problem 1 that
f (a) =
m

k=0
ckak â‰¡
m

k=0
ckbk = f (b) (mod n).

246
10
The Relation of Congruence
(d) Since a â‰¡b (mod n), there exists q âˆˆZ such that a = b + nq. We then wish to
show that
gcd(b + nq, n) = gcd(b, n).
But this is immediate from item (b) of Proposition 6.22.
(e) If a + c â‰¡b + c (mod n), then n divides (a + c) âˆ’(b + c) = a âˆ’b, which is
the same as a â‰¡b (mod n).
(f) Let n = dnâ€² and c = dcâ€², with câ€² and nâ€² being relatively prime integers. From
ac â‰¡bc (mod n) we get (dnâ€²) | [dcâ€²(aâˆ’b)] or, which is the same, nâ€² | câ€²(aâˆ’b).
However, since gcd(nâ€², câ€²) = 1, item (a) of Proposition 6.22 gives nâ€² | (a âˆ’b).
Since nâ€² = n
d , this is the same as a â‰¡b (mod n
d ). The rest is immediate.
(g) If a â‰¡b (mod mn), then mn | (a âˆ’b), so that m | (a âˆ’b). This last relation is
equivalent to a â‰¡b (mod m). Analogously, a â‰¡b (mod n).
(h) Since m, n | (a âˆ’b) and gcd(m, n) = 1, it follows from item (d) of
Proposition 6.22 that mn | (a âˆ’b), which is exactly what we wanted to prove.
âŠ“âŠ”
We are now in position to solve the example below.
Example 10.7 Compute the remainder we get upon dividing 172002 by 13.
Solution Since 17 â‰¡4 (mod 13) and 16 â‰¡3 (mod 13), item (b) of the previous
proposition gives
172002 â‰¡42002 = 161001 â‰¡31001 (mod 13).
Now, observing that 33 â‰¡1 (mod 13) and applying items (a) and (b) of the same
proposition, we obtain
31001 = 32 Â· 3999 = 9 Â· (33)333 â‰¡9 Â· 1333 = 9 (mod 13).
Then, Proposition 10.3 guarantees that 172002 leaves remainder 9 when divided
by 13.
âŠ“âŠ”
The elementary properties of congruence deduced in Proposition 10.6 allow us
to establish the criterion of divisibility by 9 in a much simpler way that that hinted
to in Problem 1, page 162. This is our next
Example 10.8 A natural number n and the sum of the algarisms of its decimal
representation leave equal remainders upon division by 9.
Proof Letting n = (akakâˆ’1 . . . a1a0)10 be the decimal representation of the natural
number n, we have
n = ak10k + akâˆ’110kâˆ’1 + Â· Â· Â· + a110 + a0.

10.1
Basic Deï¬nitions and Properties
247
Since 10 â‰¡1 (mod 9), item (c) of Proposition 10.6 (with f (x) = akxk+akâˆ’1xkâˆ’1+
Â· Â· Â· + a1x + a0) gives
n = f (10) â‰¡f (1) = ak + akâˆ’1 + Â· Â· Â· + a1 + a0 (mod 9).
The rest follows from item (b) of Proposition 10.3.
âŠ“âŠ”
As an additional example of the computational simpliï¬cation the congruence
relation brings (and for future reference), we shall prove once again the results
of Corollary 6.8 and Example 6.10. Before that, however, it is time we make the
following simple remark.
As we already know, every integer is congruent to 0, 1, 2, 3, 4, 5 or 6, modulo 7;
also, since
4 â‰¡âˆ’3(mod 7), 5 â‰¡âˆ’2(mod 7) and 6 â‰¡âˆ’1(mod 7),
we conclude that every integer is congruent, modulo 7, to one of 0, Â±1, Â±2 or Â±3.
On the other hand, every integer is congruent to 0, 1, 2, 3, 4, 5, 6 or 7, modulo 8;
however, since
5 â‰¡âˆ’3(mod 8), 6 â‰¡âˆ’2(mod 8) and 7 â‰¡âˆ’1(mod 8),
it follows that every integer is congruent, modulo 8, to 0, Â±1, Â±2, Â±3 or 4. The
advantage of replacing, modulo 7, the integers from 0 to 6 by 0, Â±1, Â±2, Â±3 lies
on the fact that, if in some context one needs to raise the remainders upon division
by 7 to some exponent k, then one is likely to have much less work by using 0, Â±1,
Â±2, Â±3 in place of 0, 1, 2, 3, 4, 5, 6, for (âˆ’x)k = Â±xk. By the same token, it is
sometimes advantageous to replace, modulo 8, the usual remainders 0, 1, 2, 3, 4, 5,
6, 7 by 0, Â±1, Â±2, Â±3, 4.
Generalizing the discussion of the previous paragraph, it is not hard to verify
that:
i. If n = 2k, then every integer is congruent, modulo n, to one of
0, Â±1, Â±2, . . . , Â±(k âˆ’1), k.
ii. If n = 2k + 1, then every integer is congruent, modulo n, to one of
0, Â±1, Â±2, . . . , Â±k.
We shall go one step further in formalizing the above discussion when we study
the concept of
complete residue systems, in Sect. 11.1. For the time being, we
establish the above mentioned results.

248
10
The Relation of Congruence
Proposition 10.9 For every a âˆˆZ, one has:
(a) a2 â‰¡0, 1, 4, 5, 6 or 9 (mod 10).
(b) a2 â‰¡0 or 1 (mod 3).
(c) a2 â‰¡0 or 1 (mod 4).
(d) a2 â‰¡0, 1 or 4 (mod 8).
(e) a4 â‰¡0 or 1 (mod 16).
Proof
(a) Modulo 10, we have a â‰¡0, Â±1, Â±2, Â±3, Â±4 or 5, so that
a2 â‰¡02, (Â±1)2, (Â±2)2, (Â±3)2, (Â±4)2 or 52 (mod 10)
or, which is the same, a2 â‰¡0, 1, 4, 9, 6 or 5 (mod 10). However, since the last
digit of a natural number is equal to the remainder we get upon dividing it by
10, it follows that the last digit of a2 is equal to one of 0, 1, 4, 5, 6 or 9.
(b) We know that a â‰¡0 or Â±1 (mod 3), so that a2 â‰¡02 or (Â±1)2 (mod 3). Hence,
a2 â‰¡0 or 1 (mod 3).
(c) Since a â‰¡0, Â±1 or 2 (mod 4), we get a2 â‰¡02, (Â±1)2 or 22 (mod 4). Since
22 â‰¡0 (mod 4), it follows that a2 â‰¡0 or 1 (mod 4).
(d) As in the previous items, we have a â‰¡0, Â±1, Â±2, Â±3 or 4 (mod 8), and then
a2 â‰¡02, (Â±1)2, (Â±2)2, (Â±3)2 or 42 (mod 8).
Now, 32 = 9 â‰¡1 and 42 = 16 â‰¡0 (mod 8), so that a2 â‰¡0, 1 or 4 (mod 8).
(e) By item (d), we have a2 = 8q + r, with q âˆˆN and r = 0, 1 or 4. Hence,
a4 = (8q + r)2 = 16(4q2 + qr) + r2 = 16qâ€² + 0 or 16qâ€² + 1,
with qâ€² âˆˆN.
âŠ“âŠ”
The coming examples show how we can use what we have learned up to this
point about congruences to solve various interesting problems. Generally speaking,
the solutions we shall present will be a mixture of a judicious use of one or
more congruence relations, together with other ideas, each of which adapted to
the situation at hand. The reader should make an effort to perceive exactly how
each used tool helps in paving the way to the ï¬nal solution, for this attitude will be
of great help in preparing him/her to tackle the problems posed at the end of the
section.
Example 10.10 (Italy) Find all x, y âˆˆN for which x2 + 615 = 2y.
Solution Looking at the given equation modulo 3, we obtain
x2 + 0 â‰¡(âˆ’1)y (mod 3).

10.1
Basic Deï¬nitions and Properties
249
Now, by item (b) of Proposition 10.9, we have x2 â‰¡0 or 1 (mod 3), so that the
congruence above gives us the following possibilities:
0 â‰¡(âˆ’1)y (mod 3) or 1 â‰¡(âˆ’1)y (mod 3).
The ï¬rst one clearly never occurs. In what concerns the second, if y is odd, we get
1 â‰¡âˆ’1 (mod 3), which never happens too. Hence, y must be even, say y = 2z,
with z âˆˆN. The stated equation can then be written as
615 = 22z âˆ’x2 = (2z âˆ’x)(2z + x).
Finally, since 2z + x > 2z âˆ’x and 615 = 3 Â· 5 Â· 41, we are left to analysing the
linear systems below:
2z + x = 615
2z âˆ’x = 1
,
 2z + x = 205
2z âˆ’x = 3
,
2z + x = 123
2z âˆ’x = 5
or
2z + x = 41
2z âˆ’x = 15 .
To this end, in each case we add both equations to obtain 2z+1 = 616, 208, 128
or 56, respectively. However, since 2z+1 is a power of 2, the only allowed possibility
is 2z+1 = 128, so that
2z + x = 123
2z âˆ’x = 5
.
Then, z = 6 and x = 59, and the only solution to the original equation is x = 59
and y = 2z = 12.
âŠ“âŠ”
Example 10.11 (OIM) Find all m, n âˆˆN such that 2m + 1 = 3n.
Solution If m = 1, then clearly n = 1. If m â‰¥2, then 2m â‰¡0 (mod 4) and, looking
at the equation modulo 4, we obtain
1 â‰¡(âˆ’1)n (mod 4).
It follows that n must be even, say n = 2u, with u âˆˆN. Substituting this into the
given equation, we get 2m + 1 = 32u or, which is the same,
2m = (3u âˆ’1)(3u + 1).
In view of the Fundamental Theorem of Arithmetic, the equality above assures
that both 3u âˆ’1 and 3u + 1 must be powers of 2. To get further information, let
d = gcd(3u âˆ’1, 3u + 1) and observe that
d | [(3u + 1) âˆ’(3u âˆ’1)],

250
10
The Relation of Congruence
i.e., d | 2; however, since 3u âˆ’1 and 3u + 1 are both even numbers, we have d = 2.
Now, the only way the gcd of two powers of 2 can be equal to 2 is when the smallest
one is itself equal to 2, so that the only possibility is to have
 3u âˆ’1 = 2
3u + 1 = 2mâˆ’1 .
Thus, u = 1, m = 3 and, hence, n = 2.
âŠ“âŠ”
Example 10.12 (OCM) Do the following items:
(a) Prove that there does exist x, y, z âˆˆN such that 13x4 + 3y4 âˆ’z4 = 2013.
(b) Prove that there does not exist x, y, z âˆˆN such that 13x4 + 3y4 âˆ’z4 = 2014.
Proof
(a) Letting z = 2x, we get y4âˆ’x4 = 671 or, which is the same, (y2âˆ’x2)(y2+x2) =
11Â·61. Hence, the Fundamental Theorem of Arithmetic gives us the possibilities
y2 âˆ’x2 = 1
y2 + x2 = 471
and
y2 âˆ’x2 = 11
y2 + x2 = 61 ,
so that x = 5, y = 6 and z = 2x = 10.
(b) By the sake of contradiction, assume that a solution does exist. Item (e) of
Proposition 10.9 gives a4 â‰¡0 or 1 (mod 8), for every a âˆˆZ. Therefore,
13x4 + 3y4 âˆ’z4 â‰¡0, 2, 4, 5 or 7 (mod 8). However, since 2014 â‰¡6 (mod 8),
we have reached a contradiction.
âŠ“âŠ”
The reader will probably notice that the solutions of our last two examples are
somewhat more terse than those of the previous ones. An effective training for the
proposed problems is to fulï¬ll the omitted details.
Example 10.13 (Romania) Let m, n, p âˆˆN, where p is an odd prime. If 7m+pÂ·2n
7mâˆ’pÂ·2n âˆˆ
N, prove that such a number is itself prime.
Proof Let a = 7m+pÂ·2n
7mâˆ’pÂ·2n . Since
a = 1 +
p Â· 2n+1
7m âˆ’p Â· 2n = âˆ’1 +
2 Â· 7m
7m âˆ’p Â· 2n ,
it follows that (7mâˆ’pÂ·2n) | gcd(pÂ·2n+1, 2Â·7m). Now, there are two possibilities:
(i) p = 7: in this case,
(7m âˆ’7 Â· 2n) | gcd(7 Â· 2n+1, 2 Â· 7m) = 14,
which gives 7mâˆ’1 âˆ’2n = 1. Analysing such an equation modulo 3, we reach a
contradiction.

10.1
Basic Deï¬nitions and Properties
251
(ii) p Ì¸= 7: in this case, we get gcd(pÂ·2n+1, 2Â·7m) = 2 and, hence, (7mâˆ’pÂ·2n) | 2.
Again, this implies 7m âˆ’p Â· 2n = 1 and, looking at such last equality also
modulo 3, we obtain 1m âˆ’p Â· 2n â‰¡1 (mod 3), so that p = 3. It follows that
7m âˆ’3 Â· 2n = 1 and a = 7m + 3 Â· 2n.
If m = 1, then n = 1 and, hence a = 13, a prime number. If m > 1, then
n > 1 and
2nâˆ’1 = 7m âˆ’1
6
= 7mâˆ’1 + Â· Â· Â· + 7 + 1.
It follows that m is even, say m = 2k. Thus, we get 49k âˆ’1 = 3 Â· 2n and
distinguish two subcases:
â€¢
If k = 1, then m = 2, n = 4 and a = 97, once more a prime number.
â€¢
If k > 1 then, factoring 49k âˆ’1, we get
49kâˆ’1 + Â· Â· Â· + 49 + 1 = 2nâˆ’3.
Such an equality gives k even and, writing k = 2l, we obtain
3 Â· 2n = 492l âˆ’1 â‰¡(âˆ’1)2l âˆ’1 â‰¡0 (mod 5),
which is an absurd.
âŠ“âŠ”
Example 10.14 (BMO) Let (an)nâ‰¥1 be the sequence deï¬ned for n â‰¥1 by an =
2n + 49. Find all integers n â‰¥1 for which an = pq and an+1 = rs, where p, q, r,
s are primes such that p < q, r < s and q âˆ’p = s âˆ’r.
Solution Let n be a natural number for which an and an+1 satisfy the stated
conditions. If p, r > 3, then we get p, q, r, s â‰¡1 or 5 (mod 6). However, since
52 â‰¡1 (mod 6), in any case we obtain pq, rs â‰¡1 or 5 (mod 6). On the other
hand, if k denotes the odd element of {n, n + 1}, then 2k â‰¡2 (mod 6), whence
2k + 49 â‰¡2 + 1 = 3 (mod 6), which, in turn, is an absurd. Thus, we must have
p â‰¤3 or r â‰¤3, so that at least one of p, r must be equal to 3 (for an and an+1 are
both odd).
If p â‰¥r, then q = s + p âˆ’r â‰¥s, implying that an = pq â‰¥rs = an+1, a
contradiction. Therefore, p < r, and hence p = 3 and q = 3 + s âˆ’r. We thus get
an = pq = 3(3 + s âˆ’r). On the other hand, we also have
2an = 2n+1 + 98 = (2n+1 + 49) + 49 = an+1 + 49 = rs + 49,
so that 6(3 + s âˆ’r) = rs + 49. This gives r = 6 âˆ’
67
s+6, and hence s = 61, r = 5,
q = 59. Then,
3 Â· 59 = an = 2n + 49 â‡’2n = 128 â‡’n = 7.
âŠ“âŠ”

252
10
The Relation of Congruence
Problems: Sect. 10.1
1. * Generalize item (a) of Proposition 10.6, showing that if m, n > 1 are natural
numbers and a1, . . . , am, b1, . . . , bm are integers such that ak â‰¡bk (mod n) for
1 â‰¤k â‰¤m, then
m

k=1
ak â‰¡
m

k=1
bk (mod n) and
m

k=1
ak â‰¡
m

k=1
bk (mod n).
2. Let n = (akakâˆ’1 . . . a1a0)10 be the decimal representation of the natural
number. Prove that the remainder of n upon division by 11 is equal to that of
a0 âˆ’a1 + a2 âˆ’a3 + Â· Â· Â· + (âˆ’1)kâˆ’1akâˆ’1 + (âˆ’1)kak.
3. Find the remainder of the division of 100055 + 551000 by 7.
4. Show that 8100 + 32001 is not a perfect square.
5. Find the remainder upon division of 7310 by 5.
6. Let n âˆˆN be such that n â‰¡âˆ’1 (mod 4). Prove that there exists a prime p such
that p | n and p â‰¡âˆ’1 (mod 4).
7. * Use the fact that 24 + 54 = 641 = 27 Â· 5 + 1 to show that 225 + 1 is not a
prime number.
8. (IMO) Find the smallest natural number n satisfying the two following
conditions:
(i) The last digit of the decimal representation of n is 6.
(ii) If we erase this last digit 6 and write it immediately to the left of the ï¬rst
digit of n, we obtain the number 4n.
9. Find all positive integers n such that 7 | (2n + 3n).
10. Find all prime numbers p and q for which p2 + 3pq + q2 is a perfect square.
The coming three problems are concerned with the Fibonacci and Lucas
sequences, so the reader may ï¬nd it convenient to start by recalling (cf.
Sects. 1.3 and 3.1) that the Fibonacci sequence (Fn)nâ‰¥1 is given by F1 = F2 =
1 and Fk+2 = Fk+1 + Fk, whereas the Lucas sequence (Ln)nâ‰¥1 is deï¬ned by
L1 = 1, L2 = 3 and Lk+2 = Lk+1 + Lk, for every integer n â‰¥1.
11. Prove the following properties of the Fibonacci and Lucas sequences:
(a) 2 | Fn â‡”3 | n and 4 | Fn â‡”6 | n.
(b) 2 | Ln â‡”3 | n and 4 | Ln â‡”n â‰¡3(mod 6).
(c) 3 | Ln â‡”n â‰¡2 (mod 4).
(d) Ln â‰¡3(mod 4) if 2 | n and 3 âˆ¤n.
(e) Ln+12 â‰¡Ln(mod 8), for every n âˆˆN.
12. Also concerning the Fibonacci and Lucas sequences, prove that
gcd(Fn, Ln) =
1, if 3 âˆ¤n
2, if 3 | n .

10.1
Basic Deï¬nitions and Properties
253
13. Prove the following properties of the Fibonacci and Lucas sequence, for every
m, n, k âˆˆN such that 2 | k and 3 âˆ¤k.
(a) 2Fm+n = FmLn + FnLm.
(b) 2Lm+n = 5FmFn + LmLn.
(c) Fm+2kt â‰¡(âˆ’1)tFm (mod Lk), for every t âˆˆN.
(d) Lm+2k â‰¡(âˆ’1)tLm (mod Lk), for every t âˆˆN.
14. (USA) Prove that the equation x4
1 + x4
2 + x4
3 + Â· Â· Â· + x4
14 = 15,999 does not
have any integer solutions.
15. (Romania) Find all natural numbers m, n, k such that 2m + 3n = k2.
16. (Soviet Union) Find all solutions in integers m, n, p > 1 of the equation
1! + 2! + Â· Â· Â· + n! = mp.
17. (Bulgaria) Find all positive integers x, y and z for which 3x + 4y = 5z.
18. (Tchecoslovaquia) Find all positive integers x, y and p such that p is prime and
px âˆ’y3 = 1.
19. Find all a, b, c âˆˆN such that a and b are even and ab + ba = 2c.
20. (Hungary) Let a and b be given naturals and n be a nonnegative integer such
that an | b. Prove that an+1 divides (a + 1)b âˆ’1.
21. (Brazil) Find all positive integer solutions of the equation x2 + 15a = 2b.
22. (France) Compute the digit of units of the integer part of 101992
1083+7? Justify your
answer.
23. (Chinaâ€”adapted) The objective of this problem is to solve equation 7xâˆ’3y = 4
in natural numbers, showing that x = y = 1 is its only solution. To this end, do
the following items:
(a) Use modulo 8 to conclude that there are no solutions if x is even.
(b) If x is odd and y > 1, look at the equation modulo 9 to show that x â‰¡
2 (mod 3) and, hence, that x â‰¡5 (mod 6).
(c) Writing x = 6q + 5, with q âˆˆN, conclude that 7x â‰¡Â±2 (mod 13).
(d) Show that every power of 3 is congruent to 1, 3 or 9, modulo 13.
(e) Assuming that y > 1, use items (c) and (d) to reach a contradiction.
24. (Bulgariaâ€”adapted) The purpose of this problem is to show that the only
solution of the equation 5x7y + 4 = 3z in nonnegative integers x, y and z
is x = 1, y = 0 and z = 2. To this end, do the following items:
(a) If x = 0, the equation reduces to 7y + 4 = 3z, so that z â‰¥2. Use modulo 9
to show that, in this case, there are no solutions.
(b) From now on, assume x â‰¥1. Use modulo 5 to conclude that z = 2t, for
some t âˆˆN.
(c) Show that gcd(3t âˆ’2, 3t + 2) = 1. Then, conclude that: (i) 3t âˆ’2 = 1 and
3t + 2 = 5x7y, (ii) 3t âˆ’2 = 5x and 3t + 2 = 7y or (iii) 3t âˆ’2 = 7y and
3t + 2 = 5x.
(d) In case (ii), use modulo 3 to show that there are no solutions.

254
10
The Relation of Congruence
(e) In case (iii), we have 5x âˆ’7y = 4. From this, use modulo 4 to conclude
that y is even. Finally, if x â‰¥2, use modulo 25 to get a contradiction.
25. (MiklÃ³s-Schweitzerâ€”adapted) In order to solve equation (x + 1)y âˆ’xz = 1 in
integers x, y, z > 1, do the following items:
(a) Look at the equation modulo x + 1 to conclude that z is odd.
(b) Write (x+1)y = xz+1 and factor the right hand side to show that x is even.
Then, write xzâˆ’1 = (x+1)yâˆ’1
x
and factor the right hand side to conclude that
y is also even.
(c) If x = 2s and y = 2t, with s, t âˆˆN, show that (x +1)t âˆ’1 and (x +1)t +1
have gcd equal to 2. From this, use modulo x to show that (x+1)t âˆ’1 = 2sz
and (x + 1)t + 1 = 2zâˆ’1.
(d) Use inequality 2sz < 2zâˆ’1 to show that s = 1. Then, successively get
x = 2, t = 1, y = 2 and z = 3.
10.2
The Theorems of Euler and Fermat
The effective use of congruences to compute remainders is considerably simpliï¬ed
if we ï¬nd exponents which make a certain power congruent to 1. For instance,
knowing that 73 â‰¡1 (mod 9) it rests much easier to compute the remainder of
251001 upon division by 9: since 25 â‰¡7 (mod 9), we have
251001 â‰¡71001 = (73)333 Â· 72 â‰¡1333 Â· 49 â‰¡4 (mod 9).
In this direction, given relatively prime integers a and n, with n > 1, the purpose
of this section is to ï¬nd an exponent k âˆˆN for which
ak â‰¡1 (mod n).
To this end, we shall ï¬rst look at the case in which n is prime, thus proving one of
the most important results of the elementary theory of congruences: Fermatâ€™s little
theorem.1
Theorem 10.15 (Fermat) Given a, p âˆˆZ, with p prime, we have ap â‰¡a (mod p).
In particular, if gcd(a, p) = 1, then
apâˆ’1 â‰¡1 (mod p).
(10.1)
Proof If ap â‰¡a (mod p), then p divides ap âˆ’a = a(apâˆ’1 âˆ’1). Hence, if
gcd(a, p) = 1, then (10.1) follows from item (a) of Proposition 6.22.
1A combinatorial proof of Fermatâ€™s little theorem was the object of Problem 5, page 57.

10.2
The Theorems of Euler and Fermat
255
It thus sufï¬ces to show that ap â‰¡a (mod p), for every a âˆˆZ. If p = 2, there is
nothing to do, for a2 âˆ’a = a(a âˆ’1), being the product of two consecutive integers,
is always even. Let us now assume that p > 2 and prove the desired result, ï¬rstly for
a > 0, by induction on a. For a = 1, there is nothing to do. Assume, by induction
hypothesis, that the theorem holds for a certain natural value of a, i.e., assume that
kp â‰¡k (mod p), for some k âˆˆN. For a = k + 1, we have
(k + 1)p âˆ’(k + 1) = (kp âˆ’k) +
pâˆ’1

j=1
p
j

kpâˆ’j.
However, since p | (kpâˆ’k) (by induction hypothesis) and p |
p
j

for 1 â‰¤j â‰¤pâˆ’1
(by Example 6.42), it follows that p divides (k + 1)p âˆ’(k + 1), so that (k + 1)p â‰¡
(k + 1) (mod p).
Let us now look at the case a â‰¤0 and p odd. If a = 0, once more there is nothing
to do. If a < 0, then, since p is odd, what we did above gives
ap = âˆ’(âˆ’a)p â‰¡âˆ’(âˆ’a) = a (mod p).
âŠ“âŠ”
Before we extend Fermatâ€™s little theorem to a composite modulo, we collect a
few examples that illustrate some applications of it.
Example 10.16 If p and q are distinct primes, prove that pq divides pqâˆ’1+qpâˆ’1âˆ’1.
Proof Since p and q are distinct primes, we have gcd(p, q) = 1. Hence, by
Fermatâ€™s little theorem, q divides pqâˆ’1 âˆ’1. However, since q obviously divides
qpâˆ’1, we conclude that q divides qqâˆ’1 + (pqâˆ’1 âˆ’1) as well. Analogously, p
divides pqâˆ’1 + (qpâˆ’1 âˆ’1). Finally, since p and q both divide pqâˆ’1 + qpâˆ’1 âˆ’1
and are relatively prime, item (d) of Proposition 6.22 guarantees that pq divides
pqâˆ’1 + qpâˆ’1 âˆ’1 too.
âŠ“âŠ”
Example 10.17 (Romania) Let p and q be prime numbers, with q Ì¸= 5. If q | (2p +
3p), prove that q > p.
Proof Since q | (2p + 3p), we clearly have q Ì¸= 2, 3; since q Ì¸= 5 by hypothesis,
we thus have q > 5. Hence, we can assume that p > 3. If q â‰¤p, then q âˆ’
1 < p, so that q âˆ’1 and p are relatively prime. In such a case, BÃ©zoutâ€™s theorem
assures the existence of x, y âˆˆN such that px = (q âˆ’1)y + 1. Therefore, from
2p â‰¡âˆ’3p(mod q) we successively get (2p)x â‰¡(âˆ’3p)x(mod q) and (since âˆ’3p =
(âˆ’3)p)
2(qâˆ’1)y+1 â‰¡(âˆ’3)(qâˆ’1)y+1(mod q).

256
10
The Relation of Congruence
Finally, since q Ì¸= 2, 3, Fermatâ€™s little theorem gives 2qâˆ’1, (âˆ’3)qâˆ’1 â‰¡1 (mod q);
then, the above congruence reduces to 2 â‰¡âˆ’3(mod q), so that q = 5. Finally, such
a conclusion is obviously a contradiction.
âŠ“âŠ”
Example 10.18 (BMO) Let p > 2 be a prime number such that 3 | (p âˆ’2), and let
S = {y2 âˆ’x3 âˆ’1; 0 â‰¤x, y < p and x, y âˆˆZ}.
Prove that S contains at most p âˆ’1 multiples of p.
Proof If 0 â‰¤u, v â‰¤p âˆ’1 and u3 â‰¡v3 (mod p), we claim that u = v. To this
end, start by noticing that u3 â‰¡v3 â‰¡0 (mod p) if and only if u = v = 0; on the
other hand, for 1 â‰¤u, v â‰¤p âˆ’1, Fermatâ€™s little theorem, together with the fact that
p âˆ’1 = 3k + 1, give
u3k+1 â‰¡v3k+1 (mod p).
(10.2)
Now,
u3 â‰¡v3 (mod p) â‡’u3k â‰¡v3k (mod p),
and it comes from (10.2) that
u3ku â‰¡v3kv â‰¡u3kv (mod p).
Finally, cancelling out u3 from the above congruence, we obtain u â‰¡v (mod p);
condition 1 â‰¤u, v â‰¤p âˆ’1 thus implies that u = v.
The above discussion guarantees that
{x3; 0 â‰¤x â‰¤p âˆ’1} = {0, 1, . . . , p âˆ’1}.
(10.3)
On the other hand, y2 âˆ’x3 âˆ’1 âˆˆS is a multiple of p if and only if y2 â‰¡x3 âˆ’
1 (mod p). Hence, it follows from (10.3) that, for each 0 â‰¤y â‰¤p âˆ’1, there exists
a single 0 â‰¤x â‰¤p âˆ’1 for which p divides y2 âˆ’x3 âˆ’1.
The above reasoning would provide us with at most p multiples of p in S.
Nevertheless, note that 0 = 12 âˆ’03 âˆ’1 = 33 âˆ’23 âˆ’1 is represented twice in
S, so that S actually contains no more that p âˆ’1 multiples of p.
âŠ“âŠ”
We generalize Fermatâ€™s little theorem with the following result of L. Euler, which
brings Eulerâ€™s function Ï• into prominence. For its statement, notice that if ak â‰¡
1 (mod n), then item (d) of Proposition 10.6 assures that gcd(ak, n) = gcd(1, n) =
1; in particular, gcd(a, n) = 1.
Theorem 10.19 (Euler)
If a and n are relatively prime integers, with n > 1, then
aÏ•(n) â‰¡1 (mod n).
(10.4)

10.2
The Theorems of Euler and Fermat
257
Proof Let p be a prime factor of n and k be a natural number. We start by making
induction on k to show that
aÏ•(pk) â‰¡1 (mod pk).
(10.5)
Case k
= 1 reduces to Fermatâ€™s little theorem. Now, assume, by induction
hypothesis, that aÏ•(pl) â‰¡1 (mod pl), for some natural l. Then, aÏ•(pl) = plq + 1 for
some integer q, and we have
aÏ•(pl+1) âˆ’1 = apÂ·Ï•(pl) âˆ’1 = (aÏ•(pl))p âˆ’1
= (plq + 1)p âˆ’1 =
p

j=0
p
j

(plq)j âˆ’1
=
p
1

plq +
p

j=2
p
j

pjlqj
= pl+1q + p2l
p

j=2
p
j

p(jâˆ’2)lqj.
â‰¡0 (mod pl+1),
since 2l â‰¥l + 1 for every integer l â‰¥1.
In order to ï¬nish the proof, let n = pÎ±1
1 pÎ±2
2 . . . pÎ±k
k be the canonical decomposi-
tion of n into powers of distinct primes, so that (cf. Theorem 8.12)
Ï•(n) = Ï•(pÎ±1
1 )Ï•(pÎ±2
2 ) . . . Ï•(pÎ±k
k ).
Letting mj = Ï•(pÎ±1
1 ) . . . 
Ï•(p
Î±j
j ) . . . Ï•(pÎ±k
k ) (where the * above a factor means that
it is omitted from the corresponding product) we have Ï•(n) = Ï•(p
Î±j
j )mj, and it
follows from (10.5) that
aÏ•(n) =

aÏ•(p
Î±j
j )
mj
â‰¡1mj â‰¡1 (mod p
Î±j
j ).
However, since the powers p
Î±j
j
are pairwise relatively prime, item (h) of Proposi-
tion 10.6 guarantees that aÏ•(n) â‰¡1 (mod n).
âŠ“âŠ”
As in the case of Fermatâ€™s little theorem, we pause to see, in a few examples,
some interesting applications of Eulerâ€™s theorem.
Example 10.20 (Brazil) Prove that there exists an integer k > 2 such that the
number 1 99 . . . 9
  
k
1 is a multiple of 1991.

258
10
The Relation of Congruence
Proof Notice ï¬rstly that
1 99 . . . 9
  
k
1 = 2 Â· 10k+1 âˆ’9.
Hence, we want to ï¬nd an integer k > 2 such that
2 Â· 10k+1 â‰¡9 (mod 1991).
To this end, since 2 Â· 103 â‰¡9 (mod 1991), we have
2 Â· 10k+1 â‰¡9 (mod 1991) â‡”2 Â· 10k+1 â‰¡2 Â· 103 (mod 1991)
â‡”10kâˆ’2 â‰¡1 (mod 1991).
For what is left to do, note that 1991 = 11Â·181 and 181 is prime (by Eratostenesâ€™
sieve, for instance). Hence, Ï•(1991) = Ï•(11) Â· Ï•(181) = 10 Â· 180 = 1800, and
Eulerâ€™s theorem gives 101800 â‰¡1 (mod 1991). Therefore, it sufï¬ces to take k âˆ’2 =
1800.
âŠ“âŠ”
Example 10.21 (Romania) Let a and n be given natural numbers. Show that we can
choose n pairwise relatively prime elements from the set
A = {a2 + a âˆ’1, a3 + a2 âˆ’1, a4 + a3 âˆ’1, . . .}.
Proof By induction, let k âˆˆN and assume that we have already established the
existence of a subset Bk âŠ‚A such that |Bk| = k and the elements of Bk are pairwise
relatively prime. Let
m =

xâˆˆBk
x.
Since m â‰¡1 (mod a), we have gcd(a, m) = 1. Therefore, Eulerâ€™s theorem gives
aÏ•(m) â‰¡1 (mod m).
If y = aÏ•(m)+1 + aÏ•(m) âˆ’1, then y âˆˆA. We claim that gcd(y, x) = 1 for every
x âˆˆBk. To this end, it sufï¬ces to show that gcd(y, m) = 1. However, again from
Eulerâ€™s theorem, we get
y = aÏ•(m)+1 + aÏ•(m) âˆ’1 â‰¡a + 1 âˆ’1 = a (mod m),
and item (d) of Proposition 10.6 guarantees that
gcd(y, m) = gcd(a, m) = 1.
Hence, the set Bk+1 = Bk âˆª{y} is formed by k + 1 pairwise relatively prime
elements of A, thus completing the induction step.
âŠ“âŠ”

10.2
The Theorems of Euler and Fermat
259
For the next example, note that if a, k âˆˆN, then the decimal representation of ak
has exactly âŒŠk log10 aâŒ‹+ 1 digits. Indeed, letting m denote the number of algarisms
of ak, we have 10mâˆ’1 â‰¤ak < 10m and, then,
m âˆ’1 â‰¤log10 ak < m;
hence, m âˆ’1 = âŒŠlog10 akâŒ‹= âŒŠk log10 aâŒ‹, as wished.
Example 10.22 Prove that there exists a power of 2 with 1000 consecutive zeros in
its decimal representation.
Proof We wish to ï¬nd m âˆˆN such that the decimal representation of 2m is of the
form
2m = (âˆ—âˆ—. . . âˆ—00 . . . 0
  
1000
âˆ—âˆ—. . . âˆ—)10.
Alternatively, letting A and B denote the natural numbers formed by the portions of
the decimal expansion of 2m situated respectively to the right and to the left of the
sequence of the 1000 consecutive zeros, we want to ï¬nd m âˆˆN such that
2m = B Â· 101000+a + A,
with the decimal representation of A having at most a digits.
To this end, if we let k = 1000 + a and A = 2k, we will have
2m = B Â· 101000+a + A
if and only if the decimal representation of 2k has at most k âˆ’1000 algarisms and
(dividing both sides of the last equality displayed above by 2k) 2mâˆ’k = B Â· 5k + 1.
In turn, this last condition will hold if and only if 2mâˆ’k â‰¡1 (mod 5k).
We then have to show that it is possible to obtain k, m âˆˆN such that: (i) m > k;
(ii) the decimal representation of 2k has at most k âˆ’1000 algarisms; (iii) 2mâˆ’k â‰¡
1 (mod 5k). Let us start by analysing conditions (i) and (iii).
By Eulerâ€™s theorem, we have 2Ï•(5k) â‰¡1 (mod 5k). Now, since Ï•(5k) = 4 Â· 5kâˆ’1,
there must exist q âˆˆN such that 24Â·5kâˆ’1 = 5kq + 1. Letting m = k + 4 Â· 5kâˆ’1, we
have m > k and 2mâˆ’k â‰¡1 (mod 5k).
We are then left to showing that it is possible to ï¬nd k âˆˆN such that the
decimal representation of 2k has at most k âˆ’1000 digits. To this end, the discussion
preceding the statement of this example assures that the decimal representation of
2k has exactly âŒŠk log10 2âŒ‹+ 1, so that it sufï¬ces to ask that the following inequality
holds:
âŒŠk log10 2âŒ‹+ 1 â‰¤k âˆ’1000.

260
10
The Relation of Congruence
However, since
k âˆ’âŒŠk log10 2âŒ‹> k âˆ’k log10 2 = k log10 5,
it is enough to start by taking a natural number k for which k log10 5 > 1001. This
is surely possible.
âŠ“âŠ”
Problems: Sect. 10.2
1. (Slovenia) We are given several integers whose sum equals 1496. Is it possible
that the sum of their seventh powers equals 1999?
2. (Australia) If p is a prime number, prove that
11 . . . 11



p
22 . . . 22



p
. . . 99 . . . 9
  
p
âˆ’123456789
is divisible by p.
3. Given a sequence (x1, x2, x3, . . . , x2nâˆ’2, x2nâˆ’1, x2n) of reals, an allowed oper-
ation is to replace it by the sequence
(xn+1, x1, xn+2, x2, . . . , x2nâˆ’1, xnâˆ’1, x2n, xn).
Assume that we start with the sequence (1, 2, 3, . . . , 2nâˆ’2, 2nâˆ’1, 2n), where
2n + 1 is a prime number. Show that, after performing 2n allowed operations,
all of the numbers will be back to their original positions.
4. (BMO) Prove that the equation y2 = x5 âˆ’4 has no integer solutions.
5. (USA) Given a prime p, prove that there are inï¬nitely many naturals n for
which p divides 2n âˆ’n.
6. (Romania) Prove that there does not exist an integer n > 1 such that n divides
3n âˆ’2n.
7. (Bulgariaâ€”adapted) Given prime numbers p and q, do the following items:
(a) If p | (5p âˆ’2p), prove that p = 3.
(b) If p â‰¥q and q | (5p âˆ’2p), prove that q = 3.
(c) Find all such p and q for which pq | (5p âˆ’2p)(5q âˆ’2q).
8. (BMO) Prove that, for every given natural number n, there exists a natural
number m > n such that the decimal representation of 5m is obtained from
that of 5n by adding a string of algarisms to the left of it.
9. (IMO) Prove that, for every integer n > 1, there exist pairwise distinct integers
k1, k2, . . . , kn > 1 such that each two of the numbers 2k1 âˆ’3, 2k2 âˆ’3, . . .,
2kn âˆ’3 are relatively prime.

10.2
The Theorems of Euler and Fermat
261
10. Let (an)nâ‰¥1 be the sequence of positive integers implicitly deï¬ned by the
equality

0<d|n
ad = 2n,
which is valid for every n âˆˆN. Prove that n | an for every n âˆˆN.
11. (Iranâ€”adapted) Eulerâ€™s theorem guarantees that, for every integer n > 2, each
prime factor of n is also a prime factor of 2Ï•(n) âˆ’1. Nevertheless, the converse
claim is not true in general, namely, if n > 3 is odd, then 2Ï•(n) âˆ’1 always has
prime factors which are not prime factors of n. In order to prove this, do the
following items:
(a) Let p1, . . . , pk be pairwise distinct odd primes, such that k > 1 or p1 Ì¸= 3.
Show that there does not exist integers Î±1, . . . , Î±k â‰¥0, not all zero, such
that
2(p1âˆ’1)...(pkâˆ’1) âˆ’1 = pÎ±1
1 . . . pÎ±k
k .
(b) Conclude that if n Ì¸= 1, 3k is and odd positive integer, then there exists a
prime p such that p âˆ¤n but p | (2Ï•(n) âˆ’1).
(c) If n = 3k, with k â‰¥2, show that 2Ï•(n) âˆ’1 â‰¡0 (mod 7).
12. The purpose of this problem is to prove the following result, which is known as
Sophie Germainâ€™s theorem2: if p is a prime number such that 2p + 1 = q is
also prime, and if x, y and z are integers for which xp + yp + zp = 0, then p
divides at least one of x, y and z. To this end, show the items below:
(a) We can assume that x, y and z are pairwise relatively prime and that p > 2.
(b) If xp + yp + zp = 0, then p | (x + y + z).
(c) By contradiction, assume from now on that p âˆ¤x, y, z. If r Ì¸= p is a prime
divisor of y + z, then
ypâˆ’1 âˆ’ypâˆ’2z + Â· Â· Â· âˆ’yzpâˆ’2 + zpâˆ’1 â‰¡pypâˆ’1 (mod r).
(d) Conclude from (c) that r âˆ¤(ypâˆ’1 âˆ’ypâˆ’2z + Â· Â· Â· âˆ’yzpâˆ’2 + zpâˆ’1) and,
hence, that gcd(y + z, ypâˆ’1 âˆ’ypâˆ’2z + Â· Â· Â· âˆ’yzpâˆ’2 + zpâˆ’1) = 1.
(e) Show that there exist a, b, c, d âˆˆZ such that y + z = ap, z + x = bp,
x + y = cp and ypâˆ’1 âˆ’ypâˆ’2z + Â· Â· Â· âˆ’yzpâˆ’2 + zpâˆ’1 = dp.
(e) Since p = qâˆ’1
2 , we have x
qâˆ’1
2
+ y
qâˆ’1
2
+ z
qâˆ’1
2
= 0. Now, apply Fermatâ€™s
little theorem to show that q | xyz.
2After Marie-Sophie Germain, French mathematician of the eighteenth and nineteenth centuries.

262
10
The Relation of Congruence
(f) If q | x, deduce that bp + cp âˆ’ap â‰¡0 (mod q). Then, substitute
p = qâˆ’1
2
and use Fermatâ€™s little theorem once again to show that q | abc.
Subsequently:
i. If q | b or q | c, conclude that q | x, y or q | x, z, thus contradicting
item (a). Therefore, q | a = (y + z).
ii. It follows from (c) that dp â‰¡pypâˆ’1 â‰¡pcp(pâˆ’1) (mod q). Substitute
p = qâˆ’1
2
and apply Fermatâ€™s little theorem yet another time to show
that Â±1 â‰¡p (mod q), thus reaching a new contradiction.
13. (Indiaâ€”adapted) For each x âˆˆN, let S(x) denote the set
S(x) = {y âˆˆN; Ï•(k)(y) = x, for some k âˆˆN},
where Ï• stands for the Euler function, Ï•(1) = Ï• and, for each k > 1 natural,
Ï•(k) is the composite of Ï• with itself, k times. Let also
T = {2a Â· 3b; a, b âˆˆZ+, a â‰¥1}.
Do the items below to show that
x âˆˆT â‡”S(x) is inï¬nite.
(a) Prove that x âˆˆT â‡’S(x) is inï¬nite.
(b) For each x âˆˆN, let u(x) denote the exponent of the greatest power of 2
that divides x. Show that u(Ï•(x)) â‰¥u(x).
(c) If x /âˆˆT , prove that u(Ï•(x)) = u(x) if and only if x = 2mpa, where m âˆˆN
and p â‰¥7 is a prime such that p â‰¡3 (mod 4).
(d) If x /âˆˆT is such that u(Ï•(2)(x)) = u(Ï•(x)) = u(x), prove that the natural
number a if item (c) is equal to 1.
(e) Assuming that S(x) is inï¬nite, prove that there exist a1, a2, a3, . . . âˆˆN
such that
x = a1, a1 = Ï•(a2), a2 = Ï•(a3), a3 = Ï•(a4), . . .
(f) Continue assuming S(x) to be inï¬nite. Use the result of item (b) to prove
that there exists n âˆˆN for which
u(an) = u(an+1) = u(an+2) = Â· Â· Â· .
(g) Conclude from item (d) that, with respect to the integer n of item (f), if
i â‰¥n + 2 then there exists a prime pi â‰¥7 such that pi â‰¡3 (mod 4) and
mi âˆˆN such that ai = 2mipi. Then, prove that mn+2 = mn+3 = Â· Â· Â· and,
for every i > 1, pi = 2piâˆ’1 + 1.

10.3
Linear Congruences and the Chinese Remainder Theorem
263
(h) Prove that there is no inï¬nite sequence q1, q2, q3, . . . of primes such that
qi = 2qiâˆ’1 + 1 for every i > 1.
(i) Conclude that S(x) inï¬nite â‡’x âˆˆT .
10.3
Linear Congruences and the Chinese Remainder
Theorem
In this section, we study linear equations and systems of equations involving
congruences.
We ï¬rst consider linear congruences, i.e., congruences of the form
ax â‰¡b (mod n),
(10.6)
with a, b and n being given integers, such that a Ì¸= 0 and n > 1, and we search for
the solutions (or roots) x âˆˆZ of the equation, i.e., the integers x for which (10.6)
holds true.
As a particular case of the above situation, we say that a is invertible modulo n
if the linear congruence (10.6) has a solution when b = 1, i.e., if there exists x âˆˆZ
such that
ax â‰¡1 (mod n).
If this is so, then such an integer x is said to be an inverse of a, modulo n. In this
respect, we have the following important
Proposition 10.23 An integer a is invertible modulo n if and only if gcd(a, n) = 1.
In this case, any two inverses of a, modulo n, are congruent modulo n.
Proof If a is invertible modulo n, then there exists x âˆˆZ such that ax â‰¡1 (mod n).
Then, there exists y âˆˆZ for which ax = ny+1 or, which is the same, xa+(âˆ’y)n =
1. In view of such an equality, we know from Corollary 6.16 that gcd(a, n) = 1.
Conversely, recall that BÃ©zoutâ€™s theorem guarantees that the gcd of any two inte-
gers can always be written as a linear combination of them. Hence, if gcd(a, n) = 1
then there exist x, y âˆˆZ such that ax + ny = 1, and it immediately follows from
this that ax â‰¡1 (mod n).
Finally, let both x and y be inverses of a, modulo n. Then
ax â‰¡1 â‰¡ay (mod n),
so that ax â‰¡ay (mod n). However, since gcd(a, n) = 1, Proposition 10.6 gives
x â‰¡y (mod n). Thus, a has, modulo n, a single inverse.
âŠ“âŠ”
Corollary 10.24 If a, p âˆˆZ, with p prime, then a is invertible modulo p if and
only if p âˆ¤a. Moreover, in this case the inverse of a modulo p is unique.

264
10
The Relation of Congruence
Proof Immediate from the fact that gcd(a, p) = 1 â‡”p âˆ¤a.
âŠ“âŠ”
Corollary 10.25 Let a, b, n âˆˆZ, with n > 1. If a is invertible modulo n, then the
linear congruence ax â‰¡b (mod n) always has a single solution modulo n, namely,
x â‰¡aÏ•(n)âˆ’1b (mod n).
In particular, every inverse of a, modulo n, is congruent to aÏ•(n)âˆ’1, modulo n.
Proof If a is invertible modulo n, then gcd(a, n) = 1. Hence, successively applying
item (f) of Proposition 10.6 and Eulerâ€™s theorem, we get
ax â‰¡b (mod n) â‡”aÏ•(n)x â‰¡aÏ•(n)âˆ’1b (mod n) â‡”x â‰¡aÏ•(n)âˆ’1b (mod n).
âŠ“âŠ”
Since any two inverses of a modulo n are always congruent modulo n, from now
on we shall say that a has a single inverse modulo n. Such an inverse will be denoted
by aâˆ’1, whenever there is no danger of confusion with the usual inverse 1
a of a with
respect to the multiplication in Q.
As an application of the notion of inversion modulo n, we shall now prove the
famous primality criterion known as Wilsonâ€™s theorem.3
Theorem 10.26 (Wilson) A natural number p is prime if and only if
(p âˆ’1)! â‰¡âˆ’1 (mod p).
Proof If p = mn, with m and n integers and 1 < n < p, then (p âˆ’1)! â‰¡
âˆ’1 (mod p) implies (p âˆ’1)! â‰¡âˆ’1 (mod n). On the other hand, since 1 < n â‰¤
p âˆ’1, we also have that n | (p âˆ’1)!, i.e., (p âˆ’1)! â‰¡0 (mod n). Therefore,
0 â‰¡(p âˆ’1)! â‰¡âˆ’1 (mod n), and hence n | 1, which is a contradiction.
Conversely, let p be prime and consider the function
f : {1, 2, . . . , p âˆ’1} â†’{1, 2, . . . , p âˆ’1},
that associates to each a âˆˆ{1, 2, . . . , p âˆ’1} its inverse aâˆ’1 âˆˆ{1, 2, . . . , p âˆ’1},
modulo p. Corollary 10.25 assures that f Ã© uma bijeÃ§Ã£o, with f (a) = b â‡”f (b) =
a. Moreover,
3After John Wilson, English mathematician of the seventeenth century. Although it is a primality
test, in practice Wilsonâ€™s theorem is not so useful, for, according to Stirlingâ€™s formula (cf. [8], for
instance), n! grows exponentially as n â†’+âˆ.

10.3
Linear Congruences and the Chinese Remainder Theorem
265
f (a) = a â‡”a2 â‰¡1 (mod p)
â‡”p | (a2 âˆ’1)
â‡”p | (a âˆ’1) or p | (a + 1)
â‡”a = 1 or p âˆ’1.
Hence, there exist a1, . . . , a pâˆ’3
2
âˆˆ{1, 2, . . . , p âˆ’1} such that
{1, 2, . . . , p âˆ’1} = {1, p âˆ’1} âˆª
pâˆ’3
2
i=1
{ai, aâˆ’1
i
}.
Finally, it follows from this, together with the fact that aiaâˆ’1
i
â‰¡1 (mod p) for
1 â‰¤i â‰¤pâˆ’3
2 , that
(p âˆ’1)! = (p âˆ’1)
pâˆ’3
2
i=1
(aiaâˆ’1
i
) â‰¡âˆ’1 (mod p).
âŠ“âŠ”
Back to equations involving congruences, a natural generalization of the linear
congruence (10.6) is obtained by considering solutions of a system of linear
congruences. In this sense, the following result, known as the Chinese remainder
theorem, examines the existence of solutions for such systems.
Theorem 10.27 Let m1, m2, . . . , mk be pairwise relatively prime naturals, all
greater than 1. For arbitrarily given integers a1, a2, . . . , ak, the system of linear
congruences
â§
âªâªâ¨
âªâªâ©
x â‰¡a1 (mod m1)
x â‰¡a2 (mod m2)
. . .
x â‰¡ak (mod mk)
(10.7)
admits a unique solution, modulo m1m2 . . . mk. Yet in another way, there exists a
single integer 0 â‰¤y < m1m2 . . . mk such that x âˆˆZ satisï¬es the system above if
and only if
x â‰¡y (mod m1m2 . . . mk).
Proof Note ï¬rst that if x1 and x2 are any two solutions of the above system, then
x1 â‰¡ai â‰¡x2 (mod mi), âˆ€1 â‰¤i â‰¤k.

266
10
The Relation of Congruence
However, since m1, . . . , mk are pairwise relatively prime, it follows from
Proposition 10.6 that
x1 â‰¡x2 (mod m1m2 . . . mk).
Hence, if the system (10.7) has a solution at all, this will be unique, modulo
m1m2 . . . mk.
For the existence of a solution, for 1 â‰¤j â‰¤k let
yj =

1â‰¤iâ‰¤k
iÌ¸=j
mi,
so that gcd(yj, mj) = 1. Let also bj be the inverse of yj modulo mj and x =
k
j=1 ajbjyj. For a ï¬xed 1 â‰¤l â‰¤k, we have yj â‰¡0 (mod ml) whenever j Ì¸= l;
hence, modulo ml we get
x â‰¡alblyl â‰¡al Â· 1 â‰¡al (mod ml).
âŠ“âŠ”
Problem 5 offers an alternative proof for the existence of solutions for the system
of linear congruences (10.7). In order to ï¬nish this section, let us see an example
who shows how it is possible to apply the Chinese remainder theorem to obtain
interesting results.4
Example 10.28 Given an integer n > 1, show that there exist n consecutive and
composite natural numbers.
Proof Choose n distinct primes p1, p2, . . . , pn and consider the system of linear
congruences
â§
âªâªâ¨
âªâªâ©
x â‰¡âˆ’1 (mod p2
1)
x â‰¡âˆ’2 (mod p2
2)
. . .
x â‰¡âˆ’n (mod p2
n)
.
Since p1, p2, . . . , pn are pairwise relatively prime, the Chinese remainder theorem
assures the existence of m âˆˆN satisfying the above system. Hence, p2
j | (m+j) for
1 â‰¤j â‰¤n, so that m + 1, m + 2, . . . , m + n are all composite natural numbers.
âŠ“âŠ”
4In this respect, see also Problems 12, page 309, and 4, page 314.

10.3
Linear Congruences and the Chinese Remainder Theorem
267
Problems: Sect. 10.3
1. Let a, b and n be given integers, with n > 1. With respect to the linear
congruence ax â‰¡b (mod n), prove that:
(a) There is a solution if and only if gcd(a, n) | b.
(b) If gcd(a, n) | b, then the linear congruence has exactly gcd(a, n) pairwise
incongruent solutions, modulo n.
2. Let a1, a2, . . . , ak, b and n be given integers, with n > 1. Prove that the
congruence
a1x1 + a2x2 + Â· Â· Â· + akxk â‰¡b (mod n)
has solutions if and only if gcd(a1, a2, . . . , ak, n) | b.
3. A group of soldiers was arranged as to form a rectangular array, with several
rows. The commander observed that by placing 12 soldiers in each row, 7 soldiers
would be left, while by placing 13 in each row, 5 would be left. Knowing that the
total number of soldiers ranged between 600 and 700, ï¬nd out how many were
them.
4. In the hypotheses of Theorem 10.27, do the following items:
(a) Show that solving (10.7) for k = 2 is equivalent to solving, in u, v âˆˆZ, the
linear diophantine equation
m1u âˆ’m2v = a2 âˆ’a1.
(b) Show that solving (10.7) is equivalent to ï¬nding out all y âˆˆZ that solve the
system of linear congruences
â§
âªâªâ¨
âªâªâ©
m1y â‰¡a2 âˆ’a1 (mod m2)
m1y â‰¡a3 âˆ’a1 (mod m3)
. . .
m1y â‰¡ak âˆ’a1 (mod mk)
.
(c) Apply the procedure delineated along items (a) and (b) to ï¬nd out all integer
solutions of the system of congruences
â§
â¨
â©
x â‰¡2 (mod 5)
x â‰¡4 (mod 11)
x â‰¡9 (mod 13)
.
5. In the notations of Theorem 10.27, if yj = 0
1â‰¤iâ‰¤k
iÌ¸=j
mi for 1 â‰¤j â‰¤k, prove that
x = k
j=1 ajy
Ï•(mj )
j
solves the system of linear congruences (10.7).

268
10
The Relation of Congruence
6. Let p1 = 2, p2 = 3, p3 = 5, . . . be the sequence of primes. Show that there exists
a natural number which leaves remainder 2pkâˆ’1 âˆ’1 upon division by 2pk âˆ’1, for
2 â‰¤k â‰¤100.
7. Prove that there are arbitrarily long sequences of consecutive natural numbers
such that none of them is a perfect power of exponent greater than 1.
8. Let m = pÎ±1
1 . . . pÎ±k
k
be the canonical decomposition of the integer m > 1
in powers of distinct primes, and f be a polynomial function with integer
coefï¬cients.
(a) Prove that the congruence f (x) â‰¡0 (mod m) has an integer solution if and
only if each one of the congruences f (x) â‰¡0 (mod pÎ±i
i ), for 1 â‰¤i â‰¤k, has
itself an integer solution.5
(b) Given t âˆˆN, let N(t) denote the number of integer solutions, pairwise
incongruent modulo t, for the congruence f (x) â‰¡0 (mod t). Show that
N(m) = N(pÎ±1
1 ) . . . N(pÎ±k
k ).
9. (IMO shortlist) Let be given a nonconstant arithmetic progression of natural
numbers, whose initial term and common difference are relatively prime. If it
contains a perfect square and a perfect cube among its terms, show that it also
contains a perfect sixth power.6
5If p is prime and Î± âˆˆN, a sufï¬cient condition for the solvability of a congruence of the form
f (x) â‰¡0 (mod pÎ±) will be presented in Problem 11, page 394.
6The hypotheses that the arithmetic progression is nonconstant and has relatively prime initial term
and common ratio are actually unnecessary. They were assumed just to simplify the solution of the
problem.

Chapter 11
Congruence Classes
In this chapter, we return to the point of view of Example 2.21, looking at
congruence modulo n as an equivalence relation. As a byproduct of our discussion, a
number of interesting applications will be presented, among which is an alternative,
simpler proof of Eulerâ€™s theorem. We will also introduce the quotient set Zn and
show that it can be furnished with operations of addition and multiplication quite
similar to those of Z. In particular, the case of Zp, with p prime, will be crucial to
our future discussion of polynomials.
11.1
Systems of Residues
Given an integer n > 1, Proposition 10.5 assures that the relation âˆ¼in Z, deï¬ned by
a âˆ¼b â‡”a â‰¡b (mod n),
is an equivalence relation, called the congruence relation modulo n.
For a âˆˆZ, we let the congruence class of a, modulo n, be deï¬ned as the
equivalence class a of a with respect to the relation of congruence modulo n:
a = {x âˆˆZ; x â‰¡a (mod n)}
= {x âˆˆZ; x = a + nq, âˆƒq âˆˆZ}
= {. . . , âˆ’2n + a, âˆ’n + a, a, n + a, 2n + a, . . .}.
(11.1)
Given a âˆˆZ, we know that there exists a single integer 0 â‰¤r < n (the remainder
of the division of a by n) such that a â‰¡r (mod n). Therefore, {0, 1, . . . , n âˆ’1} is
Â© Springer International Publishing AG, part of Springer Nature 2018
A. Caminha Muniz Neto, An Excursion through Elementary Mathematics, Volume III,
Problem Books in Mathematics, https://doi.org/10.1007/978-3-319-77977-5_11
269

270
11
Congruence Classes
a system of distinct representatives for the relation of congruence modulo n, and
Proposition 2.16 together with (2.12) furnish the partition
Z = 0 âˆª1 âˆªÂ· Â· Â· âˆªn âˆ’1
(11.2)
of Z. More generally, we have the following important
Deï¬nition 11.1 A complete residue system modulo n, (abbreviated CRS) is a
system of distinct representatives for the congruence relation modulo n.
It follows from (11.2) and (11.1) that every CRS modulo n is a set {a0, a1,
. . . , anâˆ’1} of integers, such that ar â‰¡r (mod n) for 0 â‰¤r â‰¤n âˆ’1. Alternatively,
since 0 = n, we can view a CRS modulo n a set {a1, a2, . . . , an} of integers, such
that ar â‰¡r (mod n) for 1 â‰¤r â‰¤n. Yet in another way, a set of n integers is a CRS
modulo n if and only if its elements are pairwise incongruent modulo n.
Example 11.2 Given an integer n > 1, the sets {0, 1, 2, . . . , nâˆ’1} and {1, 2, . . . , n}
are obviously CRS modulo n. Another example is furnished by the set

x âˆˆZ; âˆ’n
2 â‰¤x < n
2

.
Indeed, note ï¬rst that if âˆ’n
2 â‰¤x < y < n
2, then x Ì¸â‰¡y (mod n), for 0 < y âˆ’x < n.
Now, it sufï¬ces to separately consider the cases n even and n odd, in order to show
that the set displayed above has exactly n elements.
The coming proposition provides a useful way of constructing new CRS out of
given ones.
Proposition 11.3
(a) Let a, b and n be given integers, with n > 1 and a and n relatively prime.
If the set {x0, x1, . . . , xnâˆ’1} is a CRS modulo n, then the set {ax0 + b, ax1 +
b, . . . , axnâˆ’1 + b} is also a CRS modulo n.
(b) Let m and n be integers greater than 1 and relatively prime. If the sets
{x0, x1, . . . , xmâˆ’1} and {y0, y1, . . . , ynâˆ’1} are CRS modulo m and n, respec-
tively, then the set
{nxi + myj; 0 â‰¤i < m, 0 â‰¤j < n}
is a CRS modulo mn.
Proof
(a) Since every CRS modulo n has n elements, it sufï¬ces to show that if 0 â‰¤i,
j < n and
axi + b â‰¡axj + b (mod n),

11.1
Systems of Residues
271
then i = j. To this end, it follows from the above congruence that axi â‰¡
axj (mod n). Now, since gcd(a, n) = 1, item (f) of Proposition 10.6 guarantees
that xi â‰¡xj (mod n). Finally, since {x0, x1, . . . , xnâˆ’1} is a CRS modulo n, this
last congruence gives us i = j.
(b) Analogously to the proof of item (a), it sufï¬ces to show that if 0 â‰¤i, j < m,
0 â‰¤k, l < n and
nxi + myk â‰¡nxj + myl (mod mn),
then i = j and k = l. Assuming the validity of the above congruence, we have
from item (g) of Proposition 10.6 that
nxi + myk â‰¡nxj + myl (mod m) and nxi + myk â‰¡nxj + myl (mod n).
In turn, the last two congruences above readily give
nxi â‰¡nxj (mod m) and myk â‰¡myl (mod n).
However, since m and n are relatively prime, by applying again item (f) of
Proposition 10.6 we obtain
xi â‰¡xj (mod m) and yk â‰¡yl (mod n).
Finally, since {x0, x1, . . . , xmâˆ’1} and {y0, y1, . . . , ynâˆ’1} are CRS modulo m and
n, respectively, we get i = j and k = l.
âŠ“âŠ”
The previous proposition furnishes a proof of a particular case of the chinese
remainder theorem which sheds light in the proof of the general case presented in
the last section. In this respect, see also Problems 2 and 3.
Example 11.4 Let m1 and m2 be relatively prime naturals greater than 1, and a1 and
a2 be arbitrarily given integers. We will show that the system of linear congruences
x â‰¡a1 (mod m1)
x â‰¡a2 (mod m2)
(11.3)
has a single solution, modulo m1m2.
To this end, item (b) of the previous proposition assures that
{m1u1 + m2u2; xi âˆˆZ and 1 â‰¤ui â‰¤mi for i = 1, 2}
is a CRS modulo m1m2. If we set x = m1u1 + m2u2, for some such u1 and u2, then
x â‰¡m2u2 (mod m1) and x â‰¡m1u1 (mod m2).

272
11
Congruence Classes
Therefore, by the transitivity of congruences, x will solve (11.3) if and only if
we can choose 1 â‰¤u1 â‰¤m1 and 1 â‰¤u2 â‰¤m2 such that
m2u2 â‰¡a1 (mod m1) and m1u1 â‰¡a2 (mod m2).
Although Corollary 10.25 assures we can uniquely choose such u1 and u2, this
is also an immediate consequence of item (a) of the previous proposition. Indeed,
since gcd(m1, m2) = 1, that item guarantees that
{m2x2; 1 â‰¤x2 â‰¤m1}
is a CRS modulo m1; hence, there is a single 1 â‰¤u2 â‰¤m1 such that m2u2 â‰¡
a1 (mod m1). By the same token, there is a single 1 â‰¤u1 â‰¤m2 such that m1u1 â‰¡
a2 (mod m2).
The coming example brings a beautiful combinatorial application of the concept
of complete residue system, which appeared as the last problem of the 1995 IMO.1
For what is to come, recall that for Z âŠ‚R and r âˆˆR we write Z + r to denote the
set Z + r = {z + r; z âˆˆZ}.
Example 11.5 (IMO) Let p be an odd prime. Compute the number of subsets of p
elements of the set {1, 2, . . . , 2p} such that the sum of the elements of each such
subset is divisible by p.
Solution Let F be the family of the
2p
p

âˆ’2 subsets of p elements of the set
{1, 2, . . . , 2p}, different from X = {1, 2, . . . , p} and Y = {p + 1, p + 2, . . . , 2p}
(notice that these two sets have sums of elements equal to multiples of p).
Let âˆ¼be the relation deï¬ned in F by setting A âˆ¼B if and only if the following
conditions are satisï¬ed:
(i) There exists 0 â‰¤r â‰¤p âˆ’1 such that (A âˆ©X) + r = B âˆ©X (mod p).
(ii) A âˆ©Y = B âˆ©Y.
(Here, according to the paragraph that immediately precedes Example 2.22, for
r âˆˆR and Z âŠ‚R we let Z + r = {z + r; z âˆˆZ}.)
It is immediate to verify that âˆ¼is an equivalence relation in F. On the other
hand, given A âˆˆF and B âˆˆA (the equivalence class of A in F), we have
B = (B âˆ©X) âˆª(B âˆ©Y) = [(A âˆ©X) + r] âˆª(A âˆ©Y).
Therefore, the equivalence class A will have as many sets as its elements as there
are distinct sets of the form (A âˆ©X) + r, when r âˆˆZ varies from 0 to p âˆ’1.
1For another approach to this example, see Example 20.7.

11.1
Systems of Residues
273
In order to address this counting problem, let Aâ€² = A âˆ©X and Sâ€² = 
xâˆˆAâ€² x.
Since A Ì¸= X, Y, we have âˆ…Ì¸= Aâ€² Ì¸= X, so that 1 â‰¤|Aâ€²| â‰¤p âˆ’1. Hence,

xâˆˆAâ€²+r
x =

xâˆˆAâ€²
x + r|Aâ€²| = Sâ€² + r|Aâ€²|.
On the other hand, since gcd(|Aâ€²|, p) = 1, item (a) of Proposition 11.3 guarantees
that, as r âˆˆZ varies from 0 to p âˆ’1, the numbers Sâ€² + r|Aâ€²| thus obtained form
a CRS modulo p. In particular, the sums 
xâˆˆAâ€²+r x are pairwise distinct, so that
the sets Aâ€², Aâ€² + 1, . . . , Aâ€² + (p âˆ’1) are themselves pairwise distinct. Therefore,
the class A has exactly p sets, and it follows from Proposition 2.18 that there are
exactly
1
p
2p
2

âˆ’2

distinct equivalence classes.
If we now show that in each of the classes above there is exactly one set whose
sum of elements is a multiple of p, it will follow that the number of sets we wish to
count is precisely
1
p
2p
2

âˆ’2

+ 2.
(Recall that we cannot forget X and Y!)
For what is left to do, ï¬x A âˆˆF (and, hence, the class A) and let Aâ€²â€² = A âˆ©Y.
We wish to count how many are the integers 0 â‰¤r â‰¤p âˆ’1 such that the sum of the
p elements of the set
B = [(A âˆ©X) + r] âˆª(A âˆ©Y) = (Aâ€² + r) âˆªAâ€²â€²
is a multiple of p (remember that the set B above is a generic element of the class
A). However, for such a B, it follows from what we did above that

xâˆˆB
x =

xâˆˆAâ€²+r
x +

xâˆˆAâ€²â€²
x
=

xâˆˆAâ€²
x + r|Aâ€²| +

xâˆˆAâ€²â€²
x
=

xâˆˆA
x + r|Aâ€²| = S + r|Aâ€²|,

274
11
Congruence Classes
where S = 
xâˆˆA x. Thus, such a sum will be congruent to 0 modulo p if and only
if
|Aâ€²|r â‰¡âˆ’S (mod p).
But since gcd(|Aâ€²|, p) = 1, we know from Corollary 10.24 (or from item (a) of
Proposition 11.3, with b = 0 and |Aâ€²| in place of a) that there exists a single 0 â‰¤
r â‰¤p âˆ’1 such that the congruence displayed above is satisï¬ed.
âŠ“âŠ”
Back to the development of the theory, given q, r âˆˆZ, with 0 â‰¤r < n, recall
that gcd(nq + r, n) = gcd(r, n). Thus, we can deï¬ne the gcd between n and a
congruence class modulo n by letting
gcd(r, n) = gcd(x, n), for x âˆˆr;
(11.4)
in particular,
gcd(r, n) = gcd(r, n).
Note that, by Proposition 10.23, the congruence classes r for which gcd(r, n) =
1 are precisely those formed by the integers invertible modulo n. Therefore, we have
the following
Deï¬nition 11.6 A reduced residue system (we abbreviate RRS) modulo n is a set
I of integers such that
|I âˆ©r| =
1, if gcd(r, n) = 1
0, if gcd(r, n) Ì¸= 1 ,
for every congruence class r, modulo n.
For a ï¬xed integer n > 1, the most important example of RRS modulo n is the
set
{x âˆˆZ; gcd(x, n) = 1 and 1 â‰¤x â‰¤n}.
More generally, if I is a RRS modulo n, then (11.4) easily assures that |I| = Ï•(n),
where Ï• stands for the Euler function. On the other hand, it is clear that every RRS
I modulo n can be enlarged to a CRS modulo n, as well as that every CRS modulo
n contains a RRS modulo n.
The coming result teaches us how to construct new RRS out of known ones.
Proposition 11.7 Let m, n > 1 be given integers.
(a) If an integer a is relatively prime with n and {x1, x2, . . . , xÏ•(n)} is a RRS modulo
n, then {ax1, ax2, . . . , axÏ•(n)} is also a RRS modulo n.

11.1
Systems of Residues
275
(b) If {x1, x2, . . . , xÏ•(m)} and {y1, y2, . . . , yÏ•(n)} are RRS modulo m and modulo n,
respectively, then
{nxi + myj; 1 â‰¤i â‰¤Ï•(m), 1 â‰¤j â‰¤Ï•(n)}
(11.5)
is a RRS modulo mn.
Proof
(a) Since every RRS modulo n is part of a CRS, it follows from item (a) of
Proposition 11.3 that
axi Ì¸â‰¡axj (mod n), âˆ€1 â‰¤i < j â‰¤Ï•(n).
It now sufï¬ces to show that gcd(axi, n) = 1, which follows immediately from
item (c) of Proposition 6.22.
(b) By invoking again the fact that every RRS modulo n is part of a CRS, item (b) of
Proposition 11.3 assures that the set in (11.5) has exactly Ï•(m)Ï•(n) elements,
which are pairwise incongruent modulo mn. However, since Ï•(m)Ï•(n) =
Ï•(mn) (recall that gcd(m, n) = 1), we conclude that such a set has Ï•(mn)
elements. Hence, in order to show that it is indeed a RRS modulo mn, we are
left to showing that
gcd(nxi + myj, mn) = 1
for all 1 â‰¤i â‰¤Ï•(m), 1 â‰¤j â‰¤Ï•(n). To this end, items (b) and (c) of
Proposition 6.22 give
gcd(nxi + myj, m) = gcd(nxi, m) = gcd(xi, m) = 1
and, analogously, gcd(nxi + myj, n) = 1; therefore, by applying one further
time item (c) of that result, we obtain gcd(nxi + myj, mn) = 1.
âŠ“âŠ”
With the concept of RRS and item (a) of the former proposition at our disposal,
we can give another, conceptually clearer, proof of Eulerâ€™s theorem.
Theorem 11.8 (Euler)
If a and n are relatively prime integers, with n > 1, then
aÏ•(n) â‰¡1 (mod n).
(11.6)
Proof Let k = Ï•(n) and {x1, x2, . . . , xk} be a RRS modulo n. Item (a) of the
previous proposition assures that {ax1, ax2, . . . , axk} is also a RRS modulo n;
hence, modulo n the integers ax1, ax2, . . . , axk are, in some order, congruent to
x1, x2, . . . , xk. Termwise multiplication of the corresponding congruences gives
akx1x2 . . . xk = ax1 Â· ax2 . . . Â· axk â‰¡x1x2 . . . xk (mod n).

276
11
Congruence Classes
Finally, since gcd(x1x2 . . . xk, n) = 1, we can invoke item (f) of Proposition 10.6 to
cancel x1x2 . . . xk out of the congruence above to obtain ak â‰¡1 (mod n).
âŠ“âŠ”
Problems: Sect. 11.1
1. Let n > 1 be an integer and {a1, a2, . . . , an} be a CRS modulo n. Show that,
modulo n, we have
a1 + a2 + Â· Â· Â· + an â‰¡
0, if n is odd
n
2, if n is even .
The following problem generalizes item (b) of Proposition 11.3. The subse-
quent one generalizes the argument of Example 11.4.
2. Let m1, m2, . . . , mk be pairwise relatively prime naturals, all greater than 1, and
yj = 0
1â‰¤iâ‰¤k
iÌ¸=j
mi for 1 â‰¤j â‰¤k. Show that
{u1y1 + u2m2 + Â· Â· Â· + ukmk; 1 â‰¤ui â‰¤mi for 1 â‰¤i â‰¤k}
is a CRS modulo m1m2 . . . mk.
3. Use the result of the previous problem to prove the general version of the chinese
remainder theorem.
11.2
The Quotient Set Zn
Let us now examine the quotient set
Zn = {0, 1, . . . , n âˆ’1},
(11.7)
of Z with respect to the relation of congruence modulo n. Proposition 10.6 allows
us to introduce in Zn two operations, to which we shall also refer to as addition and
multiplication and which share properties analogous to those of the usual operations
of addition and multiplication of integers. Actually, we have the following important
result.
Proposition 11.9 In Zn, the operations
a âŠ•b = a + b and a âŠ™b = a Â· b,
(11.8)

11.2
The Quotient Set Zn
277
are well deï¬ned operations, commutative and associative. Moreover, âŠ™is distribu-
tive with respect to âŠ•, and 0 and 1 are identities (also called neutral elements) for
âŠ•and âŠ™, respectively, in the sense that
a âŠ•0 = a and a âŠ™1 = a,
for every a âˆˆZn.
Proof Firstly, we have to show that the operations given by (11.8) are indeed
well deï¬ned, in the sense that a âŠ•b and a âŠ™b are independent of the chosen
representatives for the congruence classes a and b.
To this end, if a = c and b = d, then a â‰¡c (mod n) and b â‰¡d (mod n), and it
follows from Proposition 10.6 that
a + b â‰¡c + d (mod n) and a Â· b â‰¡c Â· d (mod n).
However, this is the same as
a + b = c + d and a Â· b = c Â· d,
so that
a âŠ•b = c âŠ•d and a âŠ™b = c âŠ™d.
What is left to do is simpler. For instance, for the commutativity of âŠ•, we get
from the commutativity of the addition of integers that
a âŠ•b = a + b = b + a = b âŠ•a;
analogously, we prove that âŠ™is commutative and that âŠ•and âŠ™are associative, i.e.,
that
a âŠ•(b âŠ•c) = (a âŠ•b) âŠ•c
and
a âŠ™(b âŠ™c) = (a âŠ™b) âŠ™c.
The checking of the distributivity of âŠ™with respect to âŠ•will be left as an exercise
to the reader (cf. Problem 2). Finally,
a âŠ•0 = a + 0 = a and a âŠ™1 = a Â· 1 = a,
as we wished to show.
âŠ“âŠ”

278
11
Congruence Classes
For the sake of exemplifying, we show below the addition and multiplication
tables of Z6:
Addition Table for Z6
âŠ•
0
1
2
3
4
5
0
0
1
2
3
4
5
1
1
2
3
4
5
0
2
2
3
4
5
0
1
3
3
4
5
0
1
2
4
4
5
0
1
2
3
5
5
0
1
2
3
4
Multiplication Table for Z6
âŠ™
0
1
2
3
4
5
0
0
0
0
0
0
0
1
0
1
2
3
4
5
2
0
2
4
0
2
4
3
0
3
0
3
0
3
4
0
4
2
0
4
2
5
0
5
4
3
2
1
Whenever there is no danger of confusion, we shall write simply + and Â·,
instead of âŠ•and âŠ™, to denote the operations of addition and multiplication in Zn,
respectively. Proceeding this way, we call the readerâ€™s attention to the fact that,
whenever we write
a + b = a + b and a Â· b = a Â· b,
each of the + and Â· signs stand for two different operations. For instance, the ï¬rst
+ sign denotes the addition operation in Zn, whereas the second + sign denotes the
usual addition of integers. Moreover, an analogous remark holds for both Â· signs.
The associativity of the addition of Zn immediately gives the cancellation law
a + b = a + c â‡’b = c.
Indeed, if a + b = a + c, then
âˆ’a + (a + b) = âˆ’a + (a + c)

11.2
The Quotient Set Zn
279
and, hence,
(âˆ’a + a) + b = (âˆ’a + a) + c.
Now, since âˆ’a + a = âˆ’a + a = 0 and 0 is the neutral element for the addition of
Zn, the equality above gives b = c.
A cancellation law for the multiplication of Zn is somewhat more complicated.
In order to examine it, we ï¬rst have the following
Deï¬nition 11.10 An element a âˆˆZn is a unit if there exists b âˆˆZn such that
a Â· b = 1.
As it happens within the ordinary number system of integers, the classes Â±1 are
units in Zn, for Â±1 Â· Â±1 = 1. On the other hand, the news is that there might be
other units; for instance, in Z9 the classes 4 and 7 are units, since
4 Â· 7 = 4 Â· 7 = 1 = 7 Â· 4.
If a âˆˆZn is a unit, then we do have the following cancellation law with respect
to multiplication:
a Â· c = a Â· d â‡’c = d.
Indeed, taking b âˆˆZn such that a Â· b = 1 (and, hence, also b Â· a = 1), it follows
from a Â· c = a Â· d that
b Â· (a Â· c) = b Â· (a Â· d).
Then, the associativity of multiplication furnishes
(b Â· a) Â· c = (b Â· a) Â· d
or, which is the same, 1 Â· c = 1 Â· d. This last equality amounts to c = d, as wished.
In particular, if a âˆˆZn is a unit, then the element b âˆˆZn whose existence is
guaranteed by Deï¬nition 11.10 is unique, for if
a Â· b = 1 = a Â· c,
then the cancellation law for multiplication gives b = c. From now on, we shall say
that such a b âˆˆZn is the multiplicative inverse of a in Zn.
The coming proposition characterizes all of the units of Zn.
Proposition 11.11 A congruence class a âˆˆZn is a unit in Zn if and only if
gcd(a, n) = 1. In particular, Zn has exactly Ï•(n) distinct units.

280
11
Congruence Classes
Proof By deï¬nition, a âˆˆZn is a unit if and only if there exists b âˆˆZn such that
a Â· b = 1, i.e., ab = 1 or, which is the same,
ab â‰¡1 (mod n).
Hence, a is a unit in Zn if and only if a âˆˆZ is invertible modulo n. However, by
Proposition 10.23, this is the same as asking that gcd(a, n) = 1.
For what is left to do, it sufï¬ces to note that, since Zn = {1, 2, . . . , n}, the set
of the units of Zn coincides with the set of the classes a such that 1 â‰¤a â‰¤n and
gcd(a, n) = 1. Since such a set has Ï•(n) elements, we are done.
âŠ“âŠ”
We have now arrived at the most important case.
Corollary 11.12 If p is prime, then every element of Zp \ {0} is a unit of Zp.
Proof By the previous proposition, it sufï¬ces to show that, if a Ì¸= 0 in Zp, then
gcd(a, p) = 1. However, a Ì¸= 0 is the same as a Ì¸â‰¡0 (mod p), or p âˆ¤a; moreover,
the proof of Lemma 6.41 assures that p âˆ¤a if and only if gcd(a, p) = 1.
âŠ“âŠ”
As far as the arithmetic operations of addition, subtraction, multiplication and
division are concerned, the previous corollary allows us to put Zp, with p prime, on
an equal footing with respect to Q and R (and, after Chap. 13, also with respect to
the set C of complex numbers). All of these number systems are examples of what
algebraists call ï¬elds.
More precisely, in Zn (for every n > 1, not only n prime) we can deï¬ne an
operation âˆ’, called subtraction, which is analogous to the ordinary subtraction of
real numbers. We do so by setting (cf. Problem 3)
a âˆ’b = a âˆ’b.
We now restrict to the case in which n = p, a prime number. Writing aâˆ’1 to denote
the multiplicative inverse of a âˆˆZp \ {0} (i.e., letting aâˆ’1 denote the congruence
class b âˆˆZp whose existence is assured by Deï¬nition 11.10), we have
a Â· aâˆ’1 = 1;
moreover, if a Â· b = c, with a, b, c âˆˆZp and b Ì¸= 0, then it is immediate to verify
that
a = c Â· bâˆ’1.
Hence, we can introduce in Zp a notion of division which is also similar to the usual
division of rational (or real, or complex) numbers, by letting
a Ã· b = a Â· bâˆ’1,
for a âˆˆZp and b âˆˆZp \ {0}.

11.2
The Quotient Set Zn
281
Problems: Sect. 11.2
1. Write the addition and multiplication tables of Z5 and Z7.
2. * Prove that, in Zn, the multiplication is distributive with respect to addition.
More precisely, show that
a Â· (b + c) = (a Â· b) + (a Â· c),
for every a, b, c âˆˆZn.
3. * Prove that the operation of subtraction in Zn is well deï¬ned.
4. Show that, in Z12, all units are equal to their multiplicative inverses.
5. For integers m and n, with n > 1, let the operation of multiplication by m in
Zn be given by m Â· a = m Â· a. Show that it is well deï¬ned and such that
m Â· (a + b) = m Â· a + m Â· b and (m1 + m2) Â· a = m1 Â· a + m2 Â· a,
for every m, m1, m2 âˆˆZ and a, b âˆˆZn.
6. If an integer n > 1 is not prime, show that Zn has zero divisors, i.e., that there
exist a, b âˆˆZn \ {0} such that a Â· b = 0. Also, show that if p is a prime number,
then Zp does not possess zero divisors.
7. Let a and n be given integers, with n > 1. In Zn, show that the equation a Â·x = b
has a solution for every b âˆˆZn if and only if a is a unit in Zn. In this case, show
that the solution x âˆˆZn is unique, being given by x = aâˆ’1 Â· b.

Chapter 12
Primitive Roots and Quadratic Residues
In this last chapter devoted to Number Theory, we return to the analysis of the
congruence
ak â‰¡1 (mod n),
(12.1)
concentrating ourselves in two distinct problems, brieï¬‚y discussed below.
As a ï¬rst problem, we know from Eulerâ€™s theorem that, if gcd(a, n) = 1,
then (12.1) is always satisï¬ed for k = Ï•(n), where Ï• stands for the Euler function.
However, for a ï¬xed a âˆˆZ relatively prime to n, we do not know if such a natural
value of k is the least possible one. In this respect, one of the core results of this
chapter is the characterization of the integers n > 1 for which there exists some
integer a, relatively prime with n and such that the least possible natural exponent k
in (12.1) is k = Ï•(n); such an a will be called a primitive root modulo n.
A second problem we want to address here requires an important change of point
of view towards (12.1). Instead of ï¬xing the basis a, prime with n, and looking for
the values of k âˆˆN for which that congruence has a solution, we ï¬x k âˆˆN and look
for the integer value of a which solve it. Note that this amounts to ï¬nding the roots
of the equation xk = 1 in Zn. However, due to the elementary character of these
notes, we restrict ourselves to the case k = 2, when the desired roots a âˆˆZ will be
the quadratic residues modulo n.
Along our way through the analysis of the two problems above, several inter-
esting applications will be presented. Among them, we would like to highlight yet
another famous theorem of P. de Fermat, characterizing the natural numbers that can
be written as the sum of the squares of two integers.
Â© Springer International Publishing AG, part of Springer Nature 2018
A. Caminha Muniz Neto, An Excursion through Elementary Mathematics, Volume III,
Problem Books in Mathematics, https://doi.org/10.1007/978-3-319-77977-5_12
283

284
12
Primitive Roots and Quadratic Residues
12.1
The Concept of Order Modulo n
Let a and n be integers such that n > 1 and gcd(a, n) = 1. We know from
Eulerâ€™s Theorem 10.19 that there always exists a (at least one) natural number k
for which ak â‰¡1 (mod n), namely, k = Ï•(n). However, nothing we have done so
far guarantees that Ï•(n) is the least such k; for instance 23 â‰¡1 (mod 7), even though
Ï•(7) = 6. These considerations motivate the following
Deï¬nition 12.1 Given relatively prime integers a and n, with n > 1, the order of
a, modulo n, denoted ordn(a), is the least possible h âˆˆN for which
ah â‰¡1 (mod n).
We obviously have
ordn(a) â‰¤Ï•(n).
On the other hand, the coming result establishes the most elementary properties of
the concept of order modulo n.
Proposition 12.2 Let a, n âˆˆZ, with n > 1 and gcd(a, n) = 1.
(a) If ordn(a) = h, then the integers 1, a, a2, . . . , ahâˆ’1 are pairwise incongruent,
modulo n. In particular, if ordn(a) = Ï•(n), then the set {1, a, a2, . . . , aÏ•(n)âˆ’1}
is a RRS modulo n.
(b) ak â‰¡1 (mod n) â‡”ordn(a) | k. In particular, ordn(a) | Ï•(n).
Proof
(a) If there existed 0 â‰¤k < l < h such that al â‰¡ak (mod n), item (f) of
Proposition 10.6 would give us alâˆ’k â‰¡1 (mod n), with 0 < l âˆ’k < h. But
this would contradict the minimality of h.
For what is left to do, it sufï¬ces to see that, if ordn(a) = Ï•(n), then the set
{1, a, a2, . . . , aÏ•(n)âˆ’1} has Ï•(n) integers relatively prime with n and pairwise
incongruent modulo n. Thus, such a set is a RRS modulo n.
(b) Let ordn(a) = h, so that, in particular, ah â‰¡1 (mod n). If k = hl, then
ak = ahl = (ah)l â‰¡1l = 1 (mod n).
Conversely, let k be a natural number satisfying ak â‰¡1 (mod n). The division
algorithm assures the existence of integers q and r, with 0 â‰¤r < h, such that
k = qh + r. Thus, we have
1 â‰¡ak = aqh+r = (ah)q Â· ar â‰¡1q Â· ar â‰¡ar (mod n).

12.1
The Concept of Order Modulo n
285
Now, if r > 0, then r would be a natural exponent less than h and such that ar â‰¡
1 (mod n); in turn, this would contradict the minimality of h. Therefore, r = 0 and
hence h | k, i.e., ordn(a) | k.
Finally, ordn(a) | Ï•(n) follows from the ï¬rst part of item (b), together with
Eulerâ€™s Theorem 10.19.
âŠ“âŠ”
Example 12.3 Compute the orders of 2 modulo 17 and of 7 modulo 10.
Solution If h = ord17(2), then h | Ï•(17) = 16, so that h = 1, 2, 4, 8 or 16. It is
evident that h Ì¸= 1, 2; also, 24 â‰¡âˆ’1 (mod 17), and hence h Ì¸= 4. On the other hand,
28 = (24)2 â‰¡(âˆ’1)2 â‰¡1 (mod 17), so that h = 8.
If h = ord10(7), then h | Ï•(10) = 4, so that h = 1, 2 or 4. Obviously, h Ì¸= 1;
however, since 72 â‰¡âˆ’1 (mod 10), we also have h Ì¸= 2. Thus, h = 4.
âŠ“âŠ”
Let us now see how Proposition 12.2 can be applied to an interesting problem.
Example 12.4 If p is an odd prime, prove that all prime factors of 2p âˆ’1 are of the
form 2kp + 1, for some k âˆˆN.
Proof If q is a prime factor of 2p âˆ’1, then q is odd and 2p â‰¡1 (mod q). It follows
from item (b) of the previous proposition that ordq(2) | p and, hence, ordq(2) = 1 or
p. However, if ordq(2) = 1, then q = 1, which is an absurd; therefore, ordq(2) = p.
On the other hand, it follows from Fermatâ€™s little theorem that 2qâˆ’1 â‰¡1 (mod q).
Then, again by item (b) of the previous proposition, we have
p = ordq(2) | (q âˆ’1).
However, since q is odd, there must exist k âˆˆN such that q âˆ’1 = 2kp.
âŠ“âŠ”
The coming result establishes other useful properties of the concept of order
modulo n, which will be of paramount importance for further developments.
Proposition 12.5 Let a and n be relatively prime integers, with n > 1.
(a) ordn(a) = ordn(a + n).
(b) If m > 1 is a natural number such that m | n, then ordm(a) | ordn(a).
(c) If ordn(a) = h and k âˆˆN, then ordn(ak) =
h
gcd(h,k).
(d) If k âˆˆN, then ordn(ak) = ordn(a) â‡”gcd(ordn(a), k) = 1.
(e) If ordn(a) = h, then the set {a, a2, . . . , ah} has exactly Ï•(h) elements of order
h modulo n.
Proof
(a) It follows from a â‰¡a +n (mod n) that ak â‰¡(a +n)k (mod n), for every k âˆˆN.
In particular, ak â‰¡1 (mod n) if and only if (a + n)k â‰¡1 (mod n), and hence a
and a + n have equal orders modulo n.

286
12
Primitive Roots and Quadratic Residues
(b) Since m | n, item (g) of Proposition 10.6 yields that if ak â‰¡1 (mod n), then
ak â‰¡1 (mod m). In particular, since ak â‰¡1 (mod n) when k = ordn(a), we
have
aordn(a) â‰¡1 (mod m).
Item (b) of Proposition 12.2 now furnishes ordm(a) | ordn(a).
(c) Let d = gcd(h, k). By item (b) of Proposition 12.2, we have
(ak)j â‰¡1 (mod n) â‡”akj â‰¡1 (mod n) â‡”h | kj
â‡”h
d | k
d Â· j â‡”h
d | j,
where in the last equivalence we have applied item (a) of Proposition 6.22,
together with the fact that gcd
 h
d , k
d

= 1. From this, we immediately get
ordn(ak) = h
d =
h
gcd(h, k).
(d) This obviously follows from (c).
(e) By item (d), the number of exponents 1 â‰¤k â‰¤h such that ak has order h
modulo n equals the number of exponents 1 â‰¤k â‰¤h which are relatively
prime with h. Therefore, it is equal to Ï•(h).
âŠ“âŠ”
Problems: Sect. 12.1
1. Compute ord7(2), ord11(2) and ord15(7).
2. Prove that, for every positive integer n, the number 23n + 1 is not a multiple of
17.
3. Let a and n be relatively prime integers, with n > 2. If there exists a natural k
such that ak â‰¡âˆ’1(mod n), prove that ord n(a) is even.
4. (Putnam) Find all n âˆˆN for which n | (2n âˆ’1).
5. (Turkey) For each n âˆˆN, prove that n! divides the product
nâˆ’1

j=0
(2n âˆ’2j).
6. Given a natural n > 2, we label the vertices of a regular 2n-gon P as 1, 2, 3,
. . . , n, âˆ’n, âˆ’(n âˆ’1), . . . , âˆ’3, âˆ’2, âˆ’1, successively and in the clockwise sense.
Then, we choose vertices of P in the following way: at the ï¬rst round, we choose
vertex 1; on the other hand, if vertex ki was chosen at the i-th round, then at the

12.2
Primitive Roots
287
(i + 1)-th round we choose the vertex situated |ki| vertices away from vertex ki,
in the clockwise sense if ki > 0 and in the counterclockwise sense if ki < 0.
Such a procedure continues until we choose a vertex which was already chosen
in a former round. At the end of this process, let f (n) be the number of non
chosen vertices.
(a) If f (n) = 0, prove that 2n + 1 is an odd prime.
(b) Compute f (1997).
7. (IMOâ€”adapted) Given a prime number p, we want to show that there exists
a prime number q such that q âˆ¤(np âˆ’p), for all n âˆˆN. To this end, do the
following items1:
(a) Show that it sufï¬ces to ï¬nd a prime q for which ordq(p) = p and q Ì¸â‰¡
1 (mod p2).
(b) Letting a = ppâˆ’1
pâˆ’1 , show that a has at least one prime factor q for which
q Ì¸â‰¡1 (mod p2), and that ordq(p) = p.
12.2
Primitive Roots
Given integers a and n such that n > 1 and gcd(a, n) = 1, in this section we will
be particularly interested in the case in which ordn(a) = Ï•(n). Such a case is so
important that is worth the following
Deï¬nition 12.6 Let a and n be integers such that n > 1 and gcd(a, n) = 1. We say
that a is a primitive root modulo n if ordn(a) = Ï•(n).
Let us take a look at a couple of examples.
Examples 12.7
(a) Since 21 â‰¡2 (mod 3) and Ï•(3) = 2, it follows that ord3(2) = 2 = Ï•(3),
i.e., 2 is a primitive root modulo 3. Similar computations show that 2 is also a
primitive root modulo 5.
(b) Modulo 7 we have 21 â‰¡2, 22 â‰¡4 and 23 â‰¡1. Hence, ord7(2) = 3 < 6 = Ï•(7)
and it follows that 2 is not a primitive root modulo 7.
The main result of this section is the characterization of all integer values n > 1
for which primitive roots modulo n do exist. More precisely, we shall show that an
integer n > 1 has a primitive root if and only if n = 2, 4, pk or 2pk, for some
odd prime p. We start this path by computing the number of pairwise incongruent
primitive roots modulo n, provided such a root does exist.
1The coming items are based on the solution of Professor Samuel B. Feitosa.

288
12
Primitive Roots and Quadratic Residues
Proposition 12.8 If an integer n > 1 has a primitive root, say a, then every
primitive root modulo n is congruent to one of the elements of the set
{ak; 1 â‰¤k â‰¤Ï•(n) and gcd(Ï•(n), k) = 1}.
In particular, n has exactly Ï•(Ï•(n)) pairwise incongruent primitive roots.
Proof The second part follows immediately from the ï¬rst, by the very deï¬nition of
Eulerâ€™s function: the number of exponents 1 â‰¤k â‰¤Ï•(n) such that k is relatively
prime with Ï•(n) is exactly Ï•(Ï•(n)).
For the ï¬rst part, letting a be a primitive root modulo n, we have that ordn(a) =
Ï•(n) and A = {a, a2 . . . , aÏ•(n)} is a RRS modulo n. Hence, any primitive root
modulo n is congruent, modulo n, to one of the elements of A, so that it sufï¬ces to
see which elements of A have order (modulo n) equal to Ï•(n). However, by item (d)
of Proposition 12.5, for 1 â‰¤k â‰¤Ï•(n) we have
ordn(ak) = Ï•(n) â‡”gcd(Ï•(n), k) = 1.
âŠ“âŠ”
Example 12.9 Example 12.7 assures that 2 is a primitive root modulo 5. Since
Ï•(5) = 4, the previous propositions teaches us that a set of pairwise incongruent
primitive roots modulo 5 is
{2k; 1 â‰¤k â‰¤4 and gcd(4, k) = 1} = {2, 23}.
Hence, the pairwise incongruent primitive roots modulo 5 are 2 and 3 (for 23 = 8 â‰¡
3 (mod 5)).
We now go towards characterizing the integers which do possess primitive roots,
starting with a necessary condition.
Theorem 12.10 If and integer n > 1 has primitive roots, then n = 2, 4, pk or 2pk,
where p is an odd prime and k is a natural number.
Proof Firstly, note that the integers n > 1 which differ from those at the statement
of the theorem are either of the form n = bc, with b, c > 2 being relatively prime
integers, or of the form n = 2k, for some integer k > 2. It thus sufï¬ces to show
that such integer values of n do not have primitive roots, and we shall do this by
showing that every integer a relatively prime with n satisï¬es ordn(a) < Ï•(n). We
look separately at the two possibilities above:
(i) n = bc, with b, c > 2 relatively prime integers: since gcd(b, c) = 1, we have
Ï•(n) = Ï•(bc) = Ï•(b)Ï•(c). On the other hand, condition b, c > 2 assures (cf.

12.2
Primitive Roots
289
Problem 19, page 220) that Ï•(b) and Ï•(c) are both even. If a âˆˆZ is prime with
n, then a is prime with b and c and, from Eulerâ€™s theorem, we get
aÏ•(n)/2 =

aÏ•(b)Ï•(c)/2
â‰¡1Ï•(c)/2 â‰¡1 (mod b)
and
aÏ•(n)/2 =

aÏ•(c)Ï•(b)/2
â‰¡1Ï•(b)/2 â‰¡1 (mod c).
Therefore, item (h) of Proposition 10.6 gives aÏ•(n)/2 â‰¡1 (mod n); in particular,
ordn(a) â‰¤Ï•(n)
2
< Ï•(n)
and, hence, a is not a primitive root modulo n.
(ii) n = 2k, for some integer k > 2: let a be an odd integer (i.e., prime with 2). If
we show that
a2kâˆ’2 â‰¡1 (mod 2k),
we will have
ord2k(a) â‰¤2kâˆ’2 < 2kâˆ’1 = Ï•(2k)
and a will not be a primitive root modulo 2k. For what is left to do, let us
make induction on k: the initial case k = 3 follows from Proposition 10.9,
since a2 â‰¡1 (mod 8) for odd a. Assume we had already proved that, for some
integer k â‰¥3, there exists q âˆˆN such that a2kâˆ’2 = 2kq + 1. Then,
a2kâˆ’1 =

a2kâˆ’22
= (2kq + 1)2 = 22kq2 + 2k+1q + 1
= 2k+1(2kâˆ’1q2 + q) + 1 â‰¡1 (mod 2k+1),
as wished.
âŠ“âŠ”
We are left to establishing the converse of the previous theorem, namely, that all
numbers of one of the forms 2, 4, pk and 2pk, for some odd prime p and some
k âˆˆN, have primitive roots. It is clear that 1 is a primitive root modulo 2 and 3 is
a primitive root modulo 4. The rest of this section is devoted to the analysis of the
two remaining cases.

290
12
Primitive Roots and Quadratic Residues
The coming result shows that it sufï¬ces to worry about the numbers of the
form pk.
Proposition 12.11 If p is an odd prime and a âˆˆZ is a primitive root modulo pk,
then a or a + pk is a primitive root modulo 2pk.
Proof Let h = ord2pk(a). If a is odd, then a is relatively prime with 2pk. Then, by
using item (b) of Proposition 12.5, together with the fact that ordpk(a) = Ï•(pk), we
obtain
Ï•(pk) = ordpk(a) | h = ord2pk(a) | Ï•(2pk) = Ï•(pk),
where, in the last equality above, we used the fact that p is odd. Therefore,
ord2pk(a) = Ï•(2pk) and a is a primitive root modulo 2pk.
If a is even, change a by a + pk from the beginning and argue as above.
âŠ“âŠ”
We shall complete the proof of the converse of Theorem 12.10 (i.e., the analysis
of the case pk), in two steps. Nevertheless, before that we need an auxiliary result.
Lemma 12.12 Let p be an odd prime. If a is a primitive root modulo p2, then, for
every integer k â‰¥1, we have aÏ•(pk) = bkpk + 1, for some bk âˆˆZ such that p âˆ¤bk.
Proof Let us make induction on k â‰¥1. Fermatâ€™s little theorem gives apâˆ’1 = b1p +
1, for some b1 âˆˆZ. If p | b1, we would have apâˆ’1 â‰¡1 (mod p2) and, hence,
ordp2(a) â‰¤p âˆ’1 < Ï•(p2); this would contradict the fact that a is a primitive root
modulo p2.
Assume that, for some integer k â‰¥1, we have aÏ•(pk) = bkpk + 1, with bk âˆˆZ
such that p âˆ¤bk. Then, Newtonâ€™s binomial formula gives
aÏ•(pk+1) =

aÏ•(pk)p
= (1 + bkpk)p
= 1 + bkpk+1 +
pâˆ’1

j=2
p
j

bj
kpjk + bp
k ppk.
Now, for 1 â‰¤j â‰¤p âˆ’1 Example 6.42 assures the existence of ck âˆˆN such that
p
j

= pck. Therefore, the last expression above furnishes
aÏ•(pk+1) = 1 + bkpk+1 +
pâˆ’1

j=2
ckbj
kpjk+1 + bp
k ppk
= 1 + bkpk+1 +
 pâˆ’1

j=2
ckbj
kp(jâˆ’1)kâˆ’1 + bp
k p(pâˆ’1)kâˆ’2
pk+2.

12.2
Primitive Roots
291
Letting t denote the expression within parentheses and noticing that t âˆˆZ, we
ï¬nally get
aÏ•(pk+1) = 1 + bkpk+1 + tpk+2 = 1 + (bk + tp)pk+1.
However, since p âˆ¤bk, it sufï¬ces to let bk+1 = bk + tp to obtain aÏ•(pk+1) =
bk+1pk+1 + 1, with p âˆ¤bk+1.
âŠ“âŠ”
We can ï¬nally execute the ï¬rst of the two steps needed to ï¬nish the proof of the
existence of primitive roots modulo pk, for an odd prime p.
Theorem 12.13 Let p be an odd prime and a be relatively prime with p.
(a) If a is a primitive root modulo p, then a or a + p is a primitive root modulo p2.
(b) If a is a primitive root modulo p and modulo p2, then a is a primitive root
modulo pk, for every integer k â‰¥1.
Proof
(a) It follows from item (a) of Proposition 12.5 and from our hypotheses that
ordp(a+p) = ordp(a) = pâˆ’1. On the other hand, item (b) of Proposition 12.2
assures that
ordp2(a + p), ordp2(a) | Ï•(p2) = p(p âˆ’1),
whereas item (b) of Proposition 12.5 gives
p âˆ’1 = ordp(a) | ordp2(a) and p âˆ’1 = ordp(a + p) | ordp2(a + p).
Hence, ordp2(a) = pâˆ’1 or p(pâˆ’1), the same being valid for ordp2(a+p);
thus, we are left to showing that
ordp2(a) = p âˆ’1 â‡’ordp2(a + p) Ì¸= p âˆ’1.
To this end, if apâˆ’1 â‰¡1 (mod p2), then modulo p2 we have
(a + p)pâˆ’1 = apâˆ’1 + (p âˆ’1)papâˆ’2 +
pâˆ’1

j=2
p âˆ’1
j

pjapâˆ’1âˆ’j
â‰¡apâˆ’1 + (p âˆ’1)papâˆ’2
â‰¡1 âˆ’papâˆ’2 Ì¸â‰¡1,
for p âˆ¤a.
(b) Suppose that a is a primitive root modulo p and modulo p2. We shall use
induction on k to prove that a is a primitive root modulo pk, for every k âˆˆN.

292
12
Primitive Roots and Quadratic Residues
The cases k = 1 and k = 2 are our hypotheses. Assume, then, that we have
already proved that a is a primitive root modulo pk, for some integer k â‰¥2.
Items (b) of Propositions 12.2 and 12.5 give us
Ï•(pk) = ordpk(a) | ordpk+1(a) | Ï•(pk+1) = pÏ•(pk),
so that
ordpk+1(a) = Ï•(pk) or Ï•(pk+1).
On the other hand, since a is a primitive root modulo p2, the previous lemma
furnishes aÏ•(pk) = bkpk + 1, for some bk âˆˆZ such that p âˆ¤bk. In particular,
aÏ•(pk) Ì¸â‰¡1 (mod pk+1),
so that ordpk+1(a) Ì¸= Ï•(pk).
âŠ“âŠ”
Theorem 12.13 puts us in quite a nice position. Indeed, if we show that an odd
prime p has a primitive root, say a, then a + p will also be such a root (by item (a)
of Proposition 12.5); hence, item (a) of the previous theorem allows us to assume
that a is a primitive root modulo p and modulo p2, and after that item (b) of that
same result assures that a is a primitive root modulo pk, for every k âˆˆN.
We are then left to showing that odd primes have primitive roots. Unfortunately,
at this point such a proof is beyond the scope of the material we have at our disposal,
and will have to wait until Sect. 19.3 (cf. Theorem 19.20) to be presented. Thus, for
the time being we assume the existence of primitive roots modulo p, taking the
opportunity to present some instructive examples.
Example 12.14 Prove that 2 is a primitive root modulo 3k and modulo 5k, for every
k âˆˆN.
Proof From Example 12.7 and the previous theorem, it sufï¬ces to show that 2 is
a primitive root modulo 9 and modulo 25. Let us check that 2 is a primitive root
modulo 9, the case of modulo 25 being entirely analogous: since Ï•(9) = 6, we
have ord9(2) | 6; however, since none of 21, 22 or 23 is a multiple of 9, we get
ord9(2) = 6 = Ï•(9).
âŠ“âŠ”
The next two examples show how powerful the information on the existence of
primitive roots can be.
Example 12.15 If p is prime and n âˆˆN, prove that
1n + 2n + Â· Â· Â· + (p âˆ’1)n â‰¡

0 (mod p), if (p âˆ’1) âˆ¤n
âˆ’1 (mod p), if (p âˆ’1) | n .

12.2
Primitive Roots
293
Proof If (p âˆ’1) | n, say n = (p âˆ’1)k, then Fermatâ€™s little theorem gives, for
1 â‰¤a â‰¤p âˆ’1,
an = a(pâˆ’1)k â‰¡1k = 1 (mod p).
Therefore,
1n + 2n + Â· Â· Â· + (p âˆ’1)n â‰¡1 + 1 + Â· Â· Â· + 1



pâˆ’1
â‰¡âˆ’1 (mod p).
If (p âˆ’1) âˆ¤n, let a be a primitive root modulo p. Since {a, a2, . . . , apâˆ’1} is a
RRS modulo p, we conclude that the numbers a, a2, . . . , apâˆ’1 are, modulo p and
in some order, congruent to 1, 2, . . . , p âˆ’1. Hence (also modulo p),
1n + 2n + Â· Â· Â· + (p âˆ’1)n â‰¡an + a2n + Â· Â· Â· + a(pâˆ’1)n = apn âˆ’an
an âˆ’1 .
Now, by invoking Fermatâ€™s little theorem once more, we get
apn âˆ’an = (ap)n âˆ’an â‰¡an âˆ’an â‰¡0 (mod p).
On the other hand, since ordp(a) = p âˆ’1 and (p âˆ’1) âˆ¤n, item (b) of
Proposition 12.2 guarantees that p âˆ¤(an âˆ’1). Therefore, p | apnâˆ’an
anâˆ’1 , as we wished
to show.
âŠ“âŠ”
Example 12.16 (IMO) Find all n âˆˆN for which n2 divides 2n + 1.
Solution It is clear that such an n must be odd and that n = 1 is a possible value.
Then, let n > 1 be a natural number satisfying the given conditions and write n =
pkq, where p is the least prime divisor of n and k âˆˆN is the exponent of p in the
canonical decomposition of n in prime powers. Then, gcd(p, q) = 1 and
2n + 1
n2
âˆˆN â‡’2n + 1
p2k
âˆˆN.
By Fermatâ€™s little theorem, we have 2p â‰¡2 (mod p), from where an easy
induction gives 2pk â‰¡2 (mod p). Thus, modulo p we obtain
0 â‰¡2n + 1 = 2pkq + 1 â‰¡2q + 1,
so that 22q â‰¡1 (mod p). Letting t = ordp(2), it follows that t | 2q and (again
by Fermatâ€™s little theorem) t | (p âˆ’1); therefore, t | gcd(2q, p âˆ’1). However,

294
12
Primitive Roots and Quadratic Residues
since the prime divisors of q are greater than p, this forces us to have t = 2 and,
consequently, p = 3. Hence,
2n + 1
n2
= 23kq + 1
32kq2
âˆˆN,
(12.2)
which successively implies 23kq â‰¡âˆ’1 (mod 32k) and
22Â·3kq â‰¡1 (mod 32k).
Since we have already shown (cf. Example 12.14) that 2 is a primitive root
modulo 32k, the above congruence gives
2 Â· 32kâˆ’1 = Ï•(32k) = ord32k(2) | 2 Â· 3kq,
so that 3kâˆ’1 | q. However, since p = 3 and gcd(3, q) = 1, we must have k = 1.
Therefore, n = 3q and we conclude from (12.2) that
8q + 1
q2
âˆˆN.
By the sake of contradiction, assume that q > 1 and let w be the least prime
divisor of q, say q = wlv, where v âˆˆN and l is the exponent of w in the canonical
decomposition of q as a product of prime powers. Once more from Fermatâ€™s little
theorem, we have 8wl â‰¡8 (mod w) and, hence,
0 â‰¡8q + 1 = 8wlv + 1 â‰¡8v + 1 (mod w),
(12.3)
so that 82v â‰¡1 (mod w). Letting t = ordw(8), it follows that t | 2v and (one more
time from Fermat) t | (w âˆ’1). However, since the prime factors of v (if they exist)
are all greater than w, we conclude that t = 1 or 2, and this gives w | (81 âˆ’1)
or w | (82 âˆ’1). In any case, it follows from w > p = 3 that w = 7, and (12.3)
furnishes
0 â‰¡8v + 1 â‰¡1v + 1 â‰¡2 (mod 7),
which is an absurd. We ï¬nally conclude that q = 1 and n = 3kq = 3.
âŠ“âŠ”
Problems: Sect. 12.2
1. Show that 2 is a primitive root modulo 29.
2. Let m, n âˆˆN be such that m | n, and let a âˆˆZ be a primitive root modulo n.
Prove that a is also a primitive root modulo m.

12.2
Primitive Roots
295
3. Prove the following generalization of Wilsonâ€™s theorem: if n âˆˆN has primitive
roots and 1 = a1 < a2 < Â· Â· Â· < aÏ•(n) = n âˆ’1 are the integers from 1 to n and
relatively prime with n, then
n | (a1a2 . . . aÏ•(n) + 1).
4. (Vietnam) Show that, for every integer n â‰¥1, there exists an integer kn â‰¥1
such that 19kn âˆ’97 is a multiple of 2n.
5. (IMO shortlist) Given k âˆˆN, prove that there are inï¬nitely many natural
numbers n for which n Â· 2k âˆ’7 is a perfect square.
6. (Romania) Find all prime numbers p and q, distinct from 2 and 3 and such that
3pq | (a3pqâˆ’1 âˆ’1), for every natural number a relatively prime with 3pq.
7. (Brazilâ€”adapted) Let p > 5 be a prime number for which pâˆ’1
2
is also prime,
and let f : Z+ â†’R be given by f (xy) = f (x)f (y) and f (x + p) = f (x),
for all x, y âˆˆZ+.
(a) Show that f (0), f (1) âˆˆ{0, 1} and that f is constant if f (0) = 1 or f (1) =
0.
(b) From now on, assume that f (0) = 0 and f (1) = 1. Use Fermatâ€™s little
theorem to conclude that f (a) âˆˆ{âˆ’1, 1} for every a âˆˆN such that p âˆ¤a.
(c) If there exists a primitive root a modulo p such that f (a) = 1, then
f (x) =
0, if p | x
1, if p âˆ¤x .
(d) If f (a) = âˆ’1 for every primitive root a modulo p, then
f (x) =
0, if p | x
xpâˆ’1 Â· (âˆ’1)ordp(x)+1 (mod p), if p âˆ¤x .
8. (Turkey) Prove that the two following claims on n âˆˆN are actually equiva-
lent:
(a) n is square free2 and, if p is one of its prime divisors n, then (pâˆ’1) | (nâˆ’1).
(b) For every a âˆˆN, we have that n | (an âˆ’a).
9. (Indiaâ€”adapted) For n âˆˆN, let sn = 1 + n
k=1 knâˆ’1. The purpose of this
problem is to characterize all n âˆˆN such that n | sn. To this end, do the
following items:
(a) If p is prime and q âˆˆN, show that p | pqâˆ’1
j=0
pâˆ’1
l=0 (pj + l)nâˆ’1.
(b) Conclude that, if n | sn, then n is square free.
2Cf. Problem 6, page 190.

296
12
Primitive Roots and Quadratic Residues
(c) Let n = p1 . . . pt, with p1 < Â· Â· Â· < pt being prime numbers, and qi =
n
pi .
i. Show that sn â‰¡1 + qi
piâˆ’1
l=1 lnâˆ’1 (mod pi).
ii. If a is a primitive root modulo pi, show that
sn â‰¡1 + qi
"
api(nâˆ’1) âˆ’anâˆ’1
anâˆ’1 âˆ’1
#
(mod pi).
iii. From ii., successively conclude that, if n | sn, then pi | (anâˆ’1 âˆ’1),
(pi âˆ’1) | (n âˆ’1) and (pi âˆ’1) | (qi âˆ’1).
iv. If n | sn, use the results of items i. and iii. to conclude that pi | (qi âˆ’1).
v. Use the result of the two previous items to prove that n | sn if and only
if pi(pi âˆ’1) | (qi âˆ’1) for 1 â‰¤i â‰¤t.
10. (Brazilâ€”adapted) Let p be an odd prime, k Ì¸= p, 2p be a natural number such
that 1 â‰¤k < 2(p + 1) and n = 2pk + 1.
(a) If n is prime and a is a primitive root modulo n, prove that
gcd(ak + 1, n) = 1.
(b) Assume that there exists an integer 2 â‰¤a < n such that akp â‰¡âˆ’1 (mod n)
and gcd(ak + 1, n) = 1.
i. If d = ordn(a), show that d | (n âˆ’1) and d âˆ¤2k. Conclude that p | d
and, hence, that p | Ï•(2kp + 1).
ii. Use the formula for Ï•(2kp + 1) to infer that there exists an integer
l > 1 for which lp + 1 is a prime divisor of n.
iii. Use n = 2kp + 1 to prove that n = (lp + 1)(hp + 1) for some integer
h âˆˆ{0, 1}. Then, conclude that we cannot have h = 1, so that n is
composite.
11. Show that there exists n âˆˆN such that the last 1000 digits in the decimal
representation of 2n are all equal to 1 or 2.
The result of the coming problem is due to the French mathematician of
the twentieth century Claude Chevalley, thus being known as Chevalleyâ€™s
theorem.
12. If p is an odd prime, we wish to show that, modulo p, the number of distinct
solutions of the congruence
x4
1 + x4
2 + x4
3 + x4
4 + x4
5 â‰¡0 (mod p)
is a multiple of p. (Here, two solutions (a1, . . . , a5) and (b1, . . . , b5) are
considered to be distinct if there exists 1 â‰¤i â‰¤5 such that ai Ì¸â‰¡bi (mod p).)
To this end, do the following items:

12.3
Quadratic Residues
297
(a) If f (x1, . . . , x5) = 1 âˆ’(x4
1 + x4
2 + Â· Â· Â· + x4
5)pâˆ’1 and m is the number of
distinct solutions of the given congruence, then
m â‰¡

x1,...,x5âˆˆA
f (x1, . . . , x5) (mod p),
where A = {1, 2, . . . , p âˆ’1}.
(b) Modulo p, one has
m â‰¡p5 âˆ’

Î±1+Â·Â·Â·+Î±5=pâˆ’1

x1,...,x5âˆˆA
x4Î±1
1
. . . x4Î±5
5
â‰¡âˆ’

Î±1+Â·Â·Â·+Î±5=pâˆ’1
 
x1âˆˆA
x4Î±1
1

. . .
 
x5âˆˆA
x4Î±5
5

.
(c) If Î±1 + Â· Â· Â· + Î±5 = p âˆ’1, with Î±i â‰¥0 for 1 â‰¤i â‰¤5, then there exists
1 â‰¤i â‰¤5 such that Î±i = 0 or (p âˆ’1) âˆ¤4Î±i.
(d) If (p âˆ’1) âˆ¤4Î±, use a primitive root a modulo p to conclude that

xâˆˆA
x4Î± =
pâˆ’1

j=1
a4jÎ± = a4pÎ± âˆ’a4Î±
a4Î± âˆ’1
â‰¡0 (mod p).
(e) Finish the proof, showing that m â‰¡0 (mod p).
12.3
Quadratic Residues
In this section, we study algebraic congruences of the form
x2 â‰¡a (mod n).
To this end, we shall need the following
Deï¬nition 12.17 Let a, n âˆˆZ, with n > 1 and gcd(a, n) = 1. We say that a is a
quadratic residue modulo n if the congruence
x2 â‰¡a (mod n)
has at least one integer solution x. Otherwise, a is said to be a quadratic nonresidue
modulo n.

298
12
Primitive Roots and Quadratic Residues
With respect to the above deï¬nition, our main task in this section will be to
obtain necessary and sufï¬cient conditions for an integer a to be a quadratic residue
modulo n. In the text we shall concentrate ourselves in the case of a prime n, leaving
the general case for the problems posed at the end of the section.
Proposition 12.18 Let p be an odd prime.
(a) If a is a quadratic residue modulo p, then the congruent x2 â‰¡a (mod p) has
exactly two incongruent solutions modulo p.
(b) Among the integers 1, 2, . . . , p âˆ’1 there are exactly pâˆ’1
2
quadratic residues
and pâˆ’1
2
quadratic nonresidues modulo p.
Proof
(a) If x1, x2 âˆˆZ are such that x2
1 â‰¡a (mod p) and x2
2 â‰¡a (mod p), then
x2
1 â‰¡x2
2 (mod p), so that p | (x2
1 âˆ’x2
2). However, since p is prime, we conclude
that p | (x1 âˆ’x2) or p | (x1 + x2). Hence, the congruence stated in item (a)
has at most two incongruent solutions modulo p, namely, x1 and âˆ’x1 (they are
incongruent since p is odd and gcd(a, p) = 1 â‡’gcd(x1, p) = 1. On the other
hand, letting a be a quadratic residue modulo p, we know that there exists a
solution x0 âˆˆZ for the congruence x2 â‰¡a (mod p). It immediately follows
that âˆ’x0 is also a solution of such a congruence, with âˆ’x0 Ì¸â‰¡x0 (mod p).
(b) Since {1, 2, . . . , p âˆ’1} is a RRS modulo p, in order to count how many of its
elements are quadratic residues modulo p, it sufï¬ces to compute how many of
the numbers 12, 22, . . . , (p âˆ’1)2 are pairwise incongruent modulo p. To this
end, note that if 1 â‰¤i â‰¤pâˆ’1
2 , then
i2 â‰¡(p âˆ’i)2 (mod p);
on the other hand, if 1 â‰¤i < j â‰¤pâˆ’1
2 , then
i2 Ì¸â‰¡j2 (mod p),
since j2 âˆ’i2 = (j âˆ’i)(j + i) and 0 < j âˆ’i < j + i < p.
Therefore, there are exactly pâˆ’1
2
quadratic residues modulo p and, hence,
exactly (p âˆ’1) âˆ’

pâˆ’1
2

= pâˆ’1
2
quadratic nonresidues modulo p.
âŠ“âŠ”
The coming proposition is due to Euler, being known in mathematical literature
as Eulerâ€™s criterion for quadratic residues.
Proposition 12.19 (Euler)
If p is an odd prime and a âˆˆZ, then a is a quadratic
residue modulo p if and only if
a
pâˆ’1
2
â‰¡1 (mod p).

12.3
Quadratic Residues
299
Proof Assume ï¬rst that a is a quadratic residue modulo p. Then, gcd(a, p) = 1 and
there exists x0 âˆˆZ such that x2
0 â‰¡a (mod p). In particular, x0 is also prime with p,
and Fermatâ€™s little theorem furnishes
a
pâˆ’1
2
â‰¡(x2
0)
pâˆ’1
2
= xpâˆ’1
0
â‰¡1 (mod p).
Conversely, suppose a
pâˆ’1
2
â‰¡1 (mod p), so that in particular gcd(a, p) = 1.
Then, letting Î± be a primitive root modulo p, we have that {Î±, Î±2, . . . , Î±pâˆ’1} is
a RRS modulo p. Therefore, there exists an integer 1 â‰¤k â‰¤p âˆ’1 for which
Î±k â‰¡a (mod p). Hence,
Î±
k
 pâˆ’1
2

â‰¡a
pâˆ’1
2
â‰¡1 (mod p),
and it follows from ordp(Î±) = p âˆ’1 that (p âˆ’1) | k

pâˆ’1
2

. We conclude that k is
even, say k = 2l, and letting x0 = Î±l we get
x2
0 = Î±2l = Î±k â‰¡a (mod p).
Thus, a is a quadratic residue modulo p.
âŠ“âŠ”
Corollary 12.20 If p is an odd prime, then an integer a, relatively prime with p, is
a quadratic nonresidue modulo p if and only if
a
pâˆ’1
2
â‰¡âˆ’1 (mod p).
Proof Fermatâ€™s little theorem gives
(a
pâˆ’1
2
âˆ’1)(a
pâˆ’1
2
+ 1) = apâˆ’1 âˆ’1 â‰¡0 (mod p).
However, since p is prime, we get
a
pâˆ’1
2
âˆ’1 â‰¡0 (mod p) or a
pâˆ’1
2
+ 1 â‰¡0 (mod p).
On the other hand, it follows from Eulerâ€™s criterion that a is a quadratic
nonresidue modulo p if and only if the ï¬rst of the two congruences above does
not hold, i.e., if and only if a
pâˆ’1
2
+ 1 â‰¡0 (mod p).
âŠ“âŠ”
Remark 12.21 It is possible to prove (cf. Problem 7, page 493) that if a âˆˆZ is not
a perfect square, then there exist inï¬nitely many primes p such that a is a quadratic
nonresidue modulo p.
In order to ease computations with quadratic residues and nonresidues, we shall
need the following notation, introduced by A-M. Legendre.

300
12
Primitive Roots and Quadratic Residues
Deï¬nition 12.22 For integers a and p, with p prime, we let the Legendre symbol

a
p

be given by:
 a
p

=
â§
â¨
â©
1, if a is a quadratic residue modulo p
âˆ’1, if a is a quadratic nonresidue modulo p
0, if p | a
.
The convenience of Legendreâ€™s symbol is explained by the next two results.
Proposition 12.23 If p is an odd prime and a, b âˆˆZ, then:
(a) a â‰¡b (mod p) â‡’

a
p

=

b
p

.
(b) If p âˆ¤a, then

a2
p

= 1.
(c)

a
p

â‰¡a
pâˆ’1
2 (mod p).
(d)

a
p
 
b
p

=

ab
p

.
Proof Since the proofs of items (a) and (b) are immediate, let us start by proving
item (c): if p | a, then
 a
p

= 0 â‰¡a
pâˆ’1
2 (mod p);
otherwise, Proposition 12.19 and Corollary 12.20 assure that, modulo p,
a
pâˆ’1
2
â‰¡
1 if a is a quadratic residue modulo p
âˆ’1 if a is a quadratic nonresidue modulo p =
 a
p

.
In what concerns (d), we ï¬rst note that if p | ab, then p | a or p | b and, hence,
 a
p
  b
p

= 0 =
ab
p

.
If p âˆ¤ab, then p âˆ¤a and p âˆ¤b, and it follows from item (c) that
 a
p
  b
p

â‰¡a
pâˆ’1
2
Â· b
pâˆ’1
2
= (ab)
pâˆ’1
2
â‰¡
ab
p

(mod p).
Therefore, p divides the difference

a
p
 
b
p

âˆ’

ab
p

, which assumes an integer
value ranging from âˆ’2 to 2. However, since p is odd, we conclude that one must
have

a
p
 
b
p

âˆ’

ab
p

= 0.
âŠ“âŠ”
The two coming examples bring interesting applications of quadratic residues. In
both of them, we shall use the fact that if an integer n satisï¬es n â‰¡3 (mod 4), then

12.3
Quadratic Residues
301
n has a prime divisor p such that p â‰¡3 (mod 4). An argument for the validity of
this (easy) fact can be found along the proof of Example 6.40.
Example 12.24 Prove that there does not exist integers x and y for which y2 =
x3 + 7.
Solution By the sake of contradiction, assume that such a pair of integers does
exist. Then x is odd, for otherwise we would have y2 = x3 + 7 â‰¡3(mod 4), which
in turn contradicts item (c) of Proposition 10.9. Now,
y2 + 1 = x3 + 8 = (x + 2)[(x âˆ’1)2 + 3]
(12.4)
and, since (x âˆ’1)2 + 3 â‰¡3(mod 4) (recall that x âˆ’1 is even), there exists a prime
p such that p â‰¡3 (mod 4) and p | [(x âˆ’1)2 + 3].
Back to (12.4), we conclude that y2 + 1 â‰¡0 (mod p), and âˆ’1 is a quadratic
residue modulo p. It then follows from the deï¬nition of Legendreâ€™s symbol, together
with item (c) of the previous proposition, that
1 =
âˆ’1
p

â‰¡(âˆ’1)
pâˆ’1
2
= (âˆ’1)2k+1 = âˆ’1 (mod p).
This contradicts the fact that p is odd.
âŠ“âŠ”
For the next example, we extend the original Fibonacci and Lucas sequences (cf.
Problem 2, page 71) to homonymous sequences (Fn)nâˆˆZ and (Ln)nâˆˆZ, by imposing
that the extended sequences satisfy the same recurrence relations as the original
ones, namely, F1 = F2 = 1 and Fj+2 = Fj+1 + Fj for every j âˆˆZ, and L1 = 1,
L2 = 3 and Lj+2 = Lj+1 + Lj, for every integer j âˆˆZ (so that, for instance,
F0 = 0, Fâˆ’1 = 1, etc, and L0 = 2, Lâˆ’1 = âˆ’1, etc.). This way, it is a trivial task to
prove that Fâˆ’n = (âˆ’1)nâˆ’1Fn and Lâˆ’n = (âˆ’1)nLn for every n âˆˆN, as well as that
the extended sequences continue to satisfy all of the properties listed in Problem 2,
page 71, and in Problems 11â€“13, page 252 (of course, with indices m, n and k now
ranging in Z, instead of in N).
Example 12.25 Let (Ln)nâˆˆZ be the extended Lucas sequence. Prove3 that Ln is a
perfect square if and only if n = 1 or 3.
Proof We consider three separate cases:
(i) n = 2m, with m âˆˆZ: item (b) of Problem 2, page 71 (with m in place of n),
gives
Ln = L2m = L2
m + 2(âˆ’1)mâˆ’1.
3The result of this example and those of Problems 6 and 7, as well as their proofs, are due Cohn
[10].

302
12
Primitive Roots and Quadratic Residues
Therefore, Ln differs from a perfect square by âˆ’2 or 2, so that it cannot be a
perfect square itself.
(ii) n â‰¡1 (mod 4): if n = 1, then Ln = L1 = 12. Otherwise, write n = 1+2Â·3l Â·k,
with l âˆˆZ+ and k âˆˆZ such that 2 | k but 3 âˆ¤k. Item (d) of Problem 11,
page 252 (with k in place of n) guarantees that Lk â‰¡3 (mod 4). Therefore, we
can choose a prime p â‰¡3 (mod 4) such that p | Lk. On the other hand, by
applying item (d) of Problem 13, page 253, with t = 3l, we get
Ln â‰¡âˆ’L1 = âˆ’1 (mod Lk),
so that Ln â‰¡âˆ’1 (mod p). Finally, using the fact (already established before)
that âˆ’1 is not a quadratic residue modulo p, we conclude that Ln cannot be a
perfect square.
(iii) n â‰¡3 (mod 4): if n = 3, then L3 = 22, a perfect square. If n â‰¡3 (mod 4) and
n Ì¸= 3, write n = 3 + 2 Â· 3l Â· k, with l âˆˆZ+ and k âˆˆZ such that 2 | k but 3 âˆ¤k.
Arguing exactly as above, we get
Ln â‰¡âˆ’L3 = âˆ’4 (mod p),
for some prime divisor p of Lk such that p
â‰¡
3 (mod 4). This time,
Proposition 12.23, together with the fact that âˆ’1 is not a quadratic residue
modulo p, give
âˆ’4
p

=
 4
p
 âˆ’1
p

= âˆ’1,
and âˆ’4 is not a quadratic residue modulo p either. Hence, also as above, Ln is
not a perfect square.
âŠ“âŠ”
Back to the development of the theory, the next result, due to K. F. Gauss4 and
known as Gaussâ€™ lemma, furnishes a much simpler procedure than that provided
by Eulerâ€™s criterion to decide whether a certain integer is a quadratic residue or
nonresidue modulo p, with p being a given odd prime.
Proposition 12.26 (Gauss)
If p is an odd prime and a âˆˆZ is prime with p, then

a
p

= (âˆ’1)m, where m is the number of elements of the set

1 â‰¤j â‰¤p âˆ’1
2
; ja â‰¡âˆ’1, âˆ’2, . . . or âˆ’
p âˆ’1
2

(mod p)
/
.
(12.5)
4After Johann Carl Friedrich Gauss, German mathematician of the eighteenth and nineteenth
centuries. Gauss is generally considered to be the greatest mathematician of all times. In the
several different areas of Mathematics and Physics in which he worked, like Algebra, Analysis,
Differential Geometry, Electromagnetism and Number Theory, there are always very important
and deep results or methods that bear his name. We refer the reader to [38] for an interesting
biography of Gauss.

12.3
Quadratic Residues
303
Proof For 1 â‰¤j â‰¤pâˆ’1
2 , let âˆ’pâˆ’1
2
â‰¤tj â‰¤pâˆ’1
2
be the only integer such that
ja â‰¡tj (mod p).
Let us ï¬rst prove that
1 â‰¤i < j â‰¤p âˆ’1
2
â‡’|ti| Ì¸= |tj|.
To this end, it sufï¬ces to see that, since gcd(a, p) = 1, we have
|ti| = |tj| â‡’|ia| â‰¡|ja| (mod p) â‡’|i| â‰¡|j| (mod p)
â‡’i Â± j â‰¡0 (mod p),
which is impossible.
It now follows from what we did above that the numbers |t1|, . . . , |t pâˆ’1
2 | form,
in some order, a permutation of 1, 2, . . . , pâˆ’1
2
(note that none of them equals 0, for
gcd(a, p) = 1). Therefore, recalling that m denotes the quantity of indices j for
which tj < 0, we get modulo p that
(âˆ’1)ma
pâˆ’1
2
p âˆ’1
2

! â‰¡(âˆ’1)mt1 . . . t pâˆ’1
2
= |t1| . . . |t pâˆ’1
2 | =
p âˆ’1
2

!.
Hence,
a
pâˆ’1
2
â‰¡(âˆ’1)m (mod p),
and the rest follows from item (c) of Proposition 12.23.
âŠ“âŠ”
As an application of Gaussâ€™ lemma, we next show that 2 is a quadratic residue
modulo p (an odd prime) if and only if p â‰¡0, 1, 2 or 7 (mod 8).
Example 12.27 If p is an odd prime, then
 2
p

= (âˆ’1)âŒŠp+1
4 âŒ‹= (âˆ’1)
p2âˆ’1
8 .
Proof By Gaussâ€™ lemma, we have

2
p

= (âˆ’1)m, where
m = #

1 â‰¤k â‰¤p âˆ’1
2
; 2k â‰¡âˆ’1, âˆ’2, . . . or âˆ’
p âˆ’1
2

(mod p)
/
.

304
12
Primitive Roots and Quadratic Residues
If 1 â‰¤k â‰¤âŒŠpâˆ’1
4 âŒ‹, then 2 â‰¤2k â‰¤2âŒŠpâˆ’1
4 âŒ‹â‰¤pâˆ’1
2
and, hence,
2k Ì¸â‰¡âˆ’1, âˆ’2, . . . , âˆ’
p âˆ’1
2

(mod p).
If âŒŠpâˆ’1
4 âŒ‹+ 1 â‰¤k â‰¤pâˆ’1
2 , then
p âˆ’1 â‰¥2k â‰¥2
(p âˆ’1
4
)
+ 1

> 2
p âˆ’1
4
âˆ’1

+ 2 = p âˆ’1
2
;
in particular, 2k Ì¸â‰¡1, 2, . . . , pâˆ’1
2
(mod p) or, which is the same,
2k â‰¡âˆ’1, âˆ’2, . . . or âˆ’
p âˆ’1
2

(mod p).
Hence,
m = p âˆ’1
2
âˆ’
(p âˆ’1
4
)
+ 1

+ 1 = p âˆ’1
2
âˆ’
(p âˆ’1
4
)
=
(p + 1
4
)
,
where in the last equality above we separately considered the cases p = 4k + 1 and
p = 4k + 3.
As for the second equality, it is enough to show that
(p + 1
4
)
â‰¡p2 âˆ’1
8
(mod 2).
In turn, to this end it sufï¬ces to look at the cases p = 8k+1, p = 8k+3, p = 8k+5
and p = 8k + 7.
âŠ“âŠ”
Continuing our study of quadratic residues, we are going to prove one of the
most famous theorems of Gauss, which establishes a simple relationship between
the Legendre symbols

p
q

and

q
p

, whenever p and q are distinct odd primes. Let
us start by rewriting Gaussâ€™ lemma in a suitable way.
Lemma 12.28 If p is an odd prime and a âˆˆZ is relatively prime with p and also
odd, then

a
p

= (âˆ’1)M, with
M =
pâˆ’1
2

j=1
(ja
p
)
.

12.3
Quadratic Residues
305
Proof For 1 â‰¤j â‰¤pâˆ’1
2 , let 0 < rj < p be the remainder upon division of ja by
p, so that (cf. Proposition 6.7)
ja =
(ja
p
)
p + rj.
(12.6)
It is immediate that
ja â‰¡âˆ’1, âˆ’2, . . . , âˆ’
p âˆ’1
2

(mod p) â‡”p + 1
2
â‰¤rj < p.
Hence, in the notations of Gaussâ€™ lemma, there are exactly m indices 1 â‰¤j â‰¤pâˆ’1
2
for which p+1
2
â‰¤rj < p, and it sufï¬ces to show that the parity of the number of
such indices equals that of  pâˆ’1
2
j=1

ja
p

.
Write s1, s2, . . . , sm (after some reordering, if needed) to denote the remainders
rj such that p+1
2
â‰¤rj < p, and t1, . . . , tn (also after some reordering, if needed)
the remainders rj for which 1 â‰¤rj â‰¤pâˆ’1
2 . Then m+n = pâˆ’1
2 , and (as in the proof
of Gaussâ€™ lemma) for 1 â‰¤i < j â‰¤pâˆ’1
2
we have ri Ì¸= rj, p âˆ’rj. Therefore,

1, 2, . . . , p âˆ’1
2
/
= {p âˆ’s1, p âˆ’s2, . . . , p âˆ’sm} âˆª{t1, t2, . . . , tn},
a disjoint union, so that
p2 âˆ’1
8
=
pâˆ’1
2

j=1
j = mp âˆ’
m

j=1
sj +
n

j=1
tj.
On the other hand, adding equalities (12.6) over 1 â‰¤j â‰¤pâˆ’1
2 , we obtain
a
p2 âˆ’1
8

= p
pâˆ’1
2

j=1
(ja
p
)
+
m

j=1
sj +
n

j=1
tj.
Subtracting both relations above, it then follows that
(a âˆ’1)
p2 âˆ’1
8

= p
pâˆ’1
2

j=1
(ja
p
)
âˆ’mp + 2
m

j=1
sj.

306
12
Primitive Roots and Quadratic Residues
Finally, recalling that a and p are both odd and looking at the last equality above
modulo 2, we get
0 â‰¡
pâˆ’1
2

j=1
(ja
p
)
âˆ’m,
as wished.
âŠ“âŠ”
The coming result is known in mathematical literature as the Quadratic Reci-
procity Law of Gauss. The proof we present is due to the German mathematician
of the nineteenth century Ferdinand Eisenstein.
Theorem 12.29 (Gauss)
If p and q are distinct odd primes, then
p
q
  q
p

= (âˆ’1)
 pâˆ’1
2
 qâˆ’1
2

.
Proof By the previous lemma, we have
p
q
  q
p

= (âˆ’1)m(âˆ’1)n,
with
m =
qâˆ’1
2

j=1
(jp
q
)
and n =
pâˆ’1
2

j=1
(jq
p
)
.
It then sufï¬ces to show that
pâˆ’1
2

j=1
(jq
p
)
+
qâˆ’1
2

j=1
(jp
q
)
=
p âˆ’1
2
 q âˆ’1
2

,
(12.7)
for which we use the following double counting argument: since the right hand side
of the desired equality counts the number of points of integer coordinates within the
closed rectangle
R =

(x, y) âˆˆR2; 1 â‰¤x â‰¤p âˆ’1
2
and 1 â‰¤y â‰¤q âˆ’1
2
/
,
it is enough to count the number of those points in some other way, thus obtaining
the left hand side of (12.7).
For what is left to do assume, without any loss of generality, that p > q, and
consider the straight line y = q
px (cf. Fig. 12.1). For each j â‰¥1, the nonnegative

12.3
Quadratic Residues
307
Fig. 12.1 Counting the
number of points of R âˆ©Z2
x
y
1
pâˆ’1
2
j
j, jq
p
pâˆ’1
2 , (pâˆ’1)q
2p
(j,1)
pâˆ’1
2 ,1
q
p
qâˆ’1
2
I
II
integer

jq
p

counts the number of positive integers less than or equal to jq
p ; on the
other hand, for 1 â‰¤j â‰¤pâˆ’1
2
we have jq
p
/âˆˆZ, so that

jq
p

counts the number
of points of integer coordinates situated on the straight line x = j, below the line
y = q
px and above the line y = 0. However, since
(jq
p
)
â‰¤
((p âˆ’1)q
2p
)
=
(q
2 âˆ’q
2p
)
â‰¤
q
2

= q âˆ’1
2
,
all of the points we are counting actually belong the closed rectangle R. Hence, in
the notations of Fig. 12.1, we have
pâˆ’1
2

j=1
(jq
p
)
= # points of integer coordinates within region I of R.
Analogously,
qâˆ’1
2

j=1
(jp
q
)
= # points of integer coordinates within region II of R,
and there is nothing left to do.
âŠ“âŠ”
We ï¬nish this section by applying the quadratic reciprocity law to the establish
the existence of certain prime numbers.5
Example 12.30 Prove that there are inï¬nitely many primes of the form 3k +1, with
k âˆˆN.
5For a more general result, see Theorem 20.19.

308
12
Primitive Roots and Quadratic Residues
Proof By the sake of contradiction, suppose that there were only a ï¬nite number
of primes of the form 3k + 1, say p1, p2, . . . , pn, and let x = (2p1 . . . pn)2 + 3.
If p is a prime divisor of x, then we clearly have p Ì¸= 2, 3, p1, . . . , pn, so that
p â‰¡âˆ’1 (mod 3). Moreover, since
(2p1 . . . pn)2 â‰¡âˆ’3 (mod p),
we conclude that âˆ’3 is a quadratic residue modulo p. We must then have

âˆ’3
p

= 1.
However,
âˆ’3
p

=
âˆ’1
p
  3
p

,
âˆ’1
p

= (âˆ’1)
pâˆ’1
2
and, by the quadratic reciprocity law,
 3
p
p
3

= (âˆ’1)
 pâˆ’1
2

3âˆ’1
2

= (âˆ’1)
pâˆ’1
2 .
Thus,
âˆ’3
p

= (âˆ’1)
pâˆ’1
2
p
3
âˆ’1
(âˆ’1)
pâˆ’1
2
=
p
3

.
Finally, p â‰¡âˆ’1 (mod 3) implies, by item (a) of Proposition 12.23, that
 p
3

=

âˆ’1
3

= âˆ’1; in turn, such an equality contradicts the fact that âˆ’3 is a quadratic
residue modulo p.
âŠ“âŠ”
Problems: Sect. 12.3
1. If p is an odd prime, prove that âˆ’1 is a quadratic residue modulo p if and only
if p â‰¡1 (mod 4).
2. Prove that there are inï¬nitely many integer values of k for which the equation
x2 = y3 + k does not admit any integer solutions x, y.
3. Let a, b and c be given integers, not all of which equal to zero, and n be a
natural number. If there exist integers x and y, relatively prime with n and such
that ax2 + bxy + cy2 = n, prove that b2 âˆ’4ac is a quadratic residue modulo n.
4. (Putnam) Prove that there does not exist x, y âˆˆZ for which x2 + 3xy âˆ’2y2 =
122.
5. Given a, b âˆˆZ, show that:
(a) 2b2 + 3 has a prime divisor p such that p â‰¡Â±3 (mod 8).
(b) (2b2 + 3) âˆ¤(a2 âˆ’2).

12.3
Quadratic Residues
309
The two coming problems are also concerned with the extended Fibonacci
and Lucas sequences (Fn)nâˆˆZ and (Ln)nâˆˆZ, as deï¬ned in the paragraph
immediately before Example 12.25.
6. Let (Ln)nâˆˆZ be the extended Lucas sequence. Prove that Ln is twice a perfect
square if and only if n = 0 or Â±6.
7. Let (Fn)nâˆˆZ be the extended Fibonacci sequence. Prove that Fn is a perfect
square if and only if n = 0, Â±1, 2 or 12.
8. If p Ì¸= 3 is an odd prime, show that
 3
p

=

1, if p â‰¡Â±1 (mod 12)
âˆ’1, if p â‰¡Â±5 (mod 12) .
9. Let m and n be odd naturals, with n > 1. Prove that:
(a) 2n âˆ’1 has a prime divisor p such that p â‰¡Â±5 (mod 12).
(b) (2n âˆ’1) âˆ¤(3m âˆ’1).
10. If n > 1 is a natural number for which p = 2n + 1 is prime, do the following
items:
(a) Show that 3 is a quadratic nonresidue modulo p.
(b) Conclude that 3 is a primitive root modulo p.
11. With respect to quadratic residues modulo a prime power, do the following
items:
(a) Let a and k be given integers, with a being odd. Prove that the congruence
x2 â‰¡a (mod 2k) has an integer solution for every k > 2 if and only if the
congruence x2 â‰¡a (mod 8) has an integer solution.
(b) Let p be an odd prime and a âˆˆZ be relatively prime with p. Prove that the
congruence x2 â‰¡a (mod pk) has an integer solution for every k â‰¥1 if and
only if the congruence x2 â‰¡a (mod p) has an integer solution.
12. * Let a and n be relatively prime integers, with n > 1, and n = 2kpk1
1 . . . pkt
t be
the canonical factorization of n into prime powers. Prove that the congruence
x2 â‰¡a (mod n) has an integer solution if and only if the following conditions
are satisï¬ed:
(i) a â‰¡1 (mod 2) if k = 1, a â‰¡1 (mod 4) if k = 2 or a â‰¡1 (mod 8) if k â‰¥3.
(ii) a
piâˆ’1
2
â‰¡1 (mod pi), for 1 â‰¤i â‰¤t.
13. (APMO) A teacher gathered his n students around a circle. Then, he chose one
of them, gave him/her a candy and, proceeding in the counterclockwise sense,
distributed candies to the students according to the following rule: he jumped
one student and gave a candy to the third one, then jumped two students and
gave a candy to the sixth one, jumped three students and gave a candy to the
tenth one, and so on, always jumping one student more than the previous time

310
12
Primitive Roots and Quadratic Residues
and giving a candy to the next one. Find all values of n for which every student
will have received at least one candy after a ï¬nite number of turns of the teacher
around the circle.
14. Given a prime p and relatively prime integers a and n, with n > 1, we say that
a is a n-th residue modulo p if the congruence xn â‰¡a (mod p) has an integer
solution. Generalize Eulerâ€™s criterion for quadratic residues in the following
way: if d = gcd(n, p âˆ’1), then
a is an n-th residue modulo p â‡”a
pâˆ’1
d
â‰¡1 (mod p).
For the coming problem, the reader will need to use some basic facts on the
elementary symmetric sums of the roots of a polynomial, for which we refer to
Sect. 16.2.
15. (Bulgariaâ€”adapted) The purpose of this problem is to show that, if p > 5
is prime and k > 1 is integer, then p3 divides
kp
p

âˆ’k. To this end, do the
following items:
(a) Until item (f), assume that k is odd. Conclude that
kp
p

âˆ’k =
k
(p âˆ’1)!(f (Î±) âˆ’f (âˆ’Î±)),
where f (X) = 0pâˆ’1
j=1

X + (kâˆ’1)p
2
+ j

, is a polynomial with integer
coefï¬cients and Î± = (kâˆ’1)p
2
.
(b) If f (X) = Xpâˆ’1 + apâˆ’2Xpâˆ’2 + apâˆ’3Xpâˆ’3 + Â· Â· Â· + a1X + a0, show that
f (Î±) âˆ’f (âˆ’Î±) â‰¡2a1Î± (mod p3) and, then, deduce that it sufï¬ces to show
that a1 â‰¡0 (mod p2).
(c) Use Girardâ€™s relation (cf. Proposition 16.6) to show that condition a1 â‰¡
0 (mod p2) is equivalent to the congruence  pâˆ’1
2
j=1 rj â‰¡0 (mod p), where
rj = 0
1â‰¤iâ‰¤pâˆ’1
2
iÌ¸=j,pâˆ’j
(Î± + i).
(d) Show that, modulo p, equality (Î±+j)(Î±+pâˆ’j)rj = 0 pâˆ’1
2
i=1 (Î±+i) implies
the congruence j2rj â‰¡âˆ’(p âˆ’1)! (mod p), for 1 â‰¤j â‰¤pâˆ’1
2 .
(e) Conclude from item (d) that rj is a quadratic residue modulo p and ri Ì¸â‰¡
rj (mod p), for all 1 â‰¤i < j â‰¤pâˆ’1
2 .
(f) Deduce that, modulo p, we have
8
r1, r2, . . . , r pâˆ’1
2
9
=

12, 22, . . . ,
p âˆ’1
2
2
.
Then, ï¬nish the proof for odd k.

12.4
Sums of Two Squares
311
(g) If k is even, adapt the steps delineated from items (a) to (f), arguing from
the beginning with the polynomial f (X) = 0pâˆ’1
j=1

X + kp
2 âˆ’j

.
12.4
Sums of Two Squares
As an application of the ideas developed so far, in this section we characterize the
natural numbers which can be written as the sum of two perfect squares. We start
by looking at the case of prime numbers, with the following result of P. de Fermat.
Theorem 12.31 (Fermat)
The following conditions on an odd prime p are
equivalent:
(a) p â‰¡1 (mod 4).
(b) âˆ’1 is a quadratic residue modulo p.
(c) p can be written as the sum of two perfect squares.
Proof
(a) â‡’(b): letting p = 4k + 1, it follows from item (c) of Proposition 12.23 that
âˆ’1
p

â‰¡(âˆ’1)
pâˆ’1
2
â‰¡(âˆ’1)2k â‰¡1 (mod p)
and thus âˆ’1 is a quadratic residue modulo p.
(b) â‡’(c): let h âˆˆZ be such that h2 + 1 â‰¡0 (mod p), and
A = {(x, y); x, y âˆˆZ, 0 â‰¤x, y < âˆšp}.
By the fundamental principle of counting (cf. Sect. 1.1), we have |A|
=

âŒŠâˆšpâŒ‹+ 1
2. Now, since

âŒŠâˆšpâŒ‹+ 1
2 > âˆšp2 = p
and there are only p possible distinct remainders upon division by p, the
pigeonhole principle (cf. Sect. 4.1) implies the existence of distinct ordered pairs
(x1, y1), (x2, y2) âˆˆA for which
hx1 + y1 â‰¡hx2 + y2 (mod p).
Letting a = |x1 âˆ’x2| and b = |y1 âˆ’y2|, we have that both a and b are nonzero and,
hence,
0 < a2 + b2 = |x1 âˆ’x2|2 + |y1 âˆ’y2|2 < âˆšp2 + âˆšp2 = 2p.

312
12
Primitive Roots and Quadratic Residues
However, since
a2 + b2 = |x1 âˆ’x2|2 + |y1 âˆ’y2|2
â‰¡(x1 âˆ’x2)2 + (hx1 âˆ’hx2)2 (mod p)
= (h2 + 1)(x1 âˆ’x2)2 â‰¡0 (mod p),
the only possibility is that a2 + b2 = p.
(c) â‡’(a): let p = a2 + b2, with a, b âˆˆZ. Since p is odd, we have a even and b
odd, or conversely. Assume, without loss of generality, that a is even and b is odd.
Then, Proposition 10.9 gives
p = a2 + b2 â‰¡0 + 1 â‰¡1 (mod 4).
âŠ“âŠ”
Before we can proceed, we need an elementary auxiliary result, usually attributed
to Euler and known as Eulerâ€™s identity.
Lemma 12.32 Let m and n be natural numbers, both of which can be written as a
sum of two perfect squares. Then, mn can also be written as a sum of two perfect
squares.
Proof Writing m = a2 + b2 and n = c2 + d2, we have
mn = (a2 + b2)(c2 + d2)
= ((ac)2 + (bd)2) + ((ad)2 + (bc)2)
= (ac + bd)2 + (ad âˆ’bc)2.
(12.8)
âŠ“âŠ”
The coming result also credited to Fermat, provides a necessary and sufï¬cient
condition for a natural number to be written as a sum of two perfect squares.
Theorem 12.33 (Fermat)
A natural number n > 1 can be written as a sum of two
perfect squares if and only if the following condition is satisï¬ed: for each prime p
such that p â‰¡3 (mod 4), the greatest power of p that divides n has even exponent.
Proof In what follows, write
n = 2apa1
1 . . . pak
k qb1
1 . . . qbl
l
with a, ai, bj âˆˆZ+ and pi, qj prime numbers such that pi â‰¡1 (mod 4) and qj â‰¡
3 (mod 4), for all 1 â‰¤i â‰¤k and 1 â‰¤j â‰¤l.
(i) If each bj is even, then n can be written as a sum of two perfect squares: to prove
this, ï¬rst note that, by Theorem 12.31, each pi can be written as such; on the

12.4
Sums of Two Squares
313
other hand, we have 2a = (2a/2)2+02 if a is even 2a = (2(aâˆ’1)/2)2+(2(aâˆ’1)/2)2
if a is odd; also, writing bj = 2cj, with cj âˆˆZ for 1 â‰¤j â‰¤l, we have
q
bj
j
= (q
cj
j )2 + 02. Therefore, repeated applications of Lemma 12.32 allow us
to conclude that n can be written as a sum of two squares.
(ii) If n can be written as a sum of two perfect squares, then each bj is even: it
sufï¬ces to prove that if n can be written as a sum of two squares and bj â‰¥1,
then bj â‰¥2 and n
q2
j can also be written as a sum of two squares. To this end, if
n = c2 +d2, with c, d âˆˆZ, then c2 +d2 â‰¡0 (mod qj). If d â‰¡0 (mod qj), then
c â‰¡0 (mod qj) and hence n = c2 + d2 â‰¡0 (mod q2
j ); therefore, bj â‰¥2 and
n
q2
j
=
 c
qj
2
+
 d
qj
2
.
By the sake of contradiction, assume that d Ì¸â‰¡0 (mod qj). Then gcd(d, qj) = 1,
so that d is invertible modulo qj. Letting f denote its inverse modulo qj, we
obtain
(cf )2 + 1 â‰¡0 (mod qj).
This contradicts Theorem 12.31, for qj â‰¡3 (mod 4).
âŠ“âŠ”
We ï¬nish this section by showing that there is essentially only one way of writing
a prime congruent to 1 modulo 4 as a sum of two perfect squares.
Proposition 12.34 If p is a prime number of the form 4k+1, then there exist unique
x, y âˆˆN such that x < y and x2 + y2 = p.
Proof We already know that there exists at least one pair of natural numbers x and
y such that x2 + y2 = p. Assume that a, b is another such pair and note that a, b, x
and y are all relatively prime with p and less than âˆšp. We may then choose integers
1 â‰¤c, z < p such that xz â‰¡y and ac â‰¡b (mod p).
We ï¬rst claim that either c = z or c + z = p. Indeed, we have
0 â‰¡x2 + y2 â‰¡x2 + (xz)2 = x2(z2 + 1) (mod p),
so that z2 â‰¡âˆ’1 (mod p). Analogously, c2 â‰¡âˆ’1 (mod p), and hence p divides
z2 âˆ’c2 = (z âˆ’c)(z + c), which in turn is the same as saying that p divides either
zâˆ’c or z+c. However, since 1 â‰¤c, z < p, it follows that âˆ’p < zâˆ’c < z+c < 2p,
and this (together with the fact that p | (z âˆ’c) or p | (z + c)) gives z âˆ’c = 0 or
z + c = p.
Now, assume that c = z. Then, the choices of c and z guarantee that
bxz â‰¡acy â‰¡ayz (mod p),
(12.9)

314
12
Primitive Roots and Quadratic Residues
and cancelling z we obtain bx â‰¡ay (mod p). However, since 0 < a, b, x, y < âˆšp,
we have 0 < bx, ay < p, and then bx = ay. Therefore,
p = x2 + y2 =
ay
b
2
+ y2 =
y
b
2
(a2 + b2) =
y
b
2
p,
which gives y = b and x = a.
If z + c = p, then, arguing as in (12.9), we arrive at bx â‰¡âˆ’ay (mod p) and,
hence, at bx + ay = p. Thus, (12.8) furnishes
p2 = (a2 + b2)(x2 + y2) = (bx + ay)2 + (by âˆ’ax)2 = p2 + (by âˆ’ax)2,
from which by = ax. We now obviously get x = b and y = a.
âŠ“âŠ”
Problems: Sect. 12.4
1. The purpose of this problem is to show that there are inï¬nitely many natural
numbers that cannot be written as a sum of three squares. More precisely, prove
the following result of Euler: there does not exist integers k, l, x, y, z such that
l â‰¥0 and
x2 + y2 + z2 = 4l(8k + 7).
2. If a, b, c âˆˆN are such that a(a âˆ’1) = b2 + c2, show that a + b is odd.
3. (BMO) Find all pairs of distinct natural numbers x and y such that x2+y2
xâˆ’y
is an
integer which divides 1995.
4. Given a natural n, prove that there exist n consecutive naturals such that none of
them can be written as the sum of two perfect squares.
5. The purpose of this problem is to prove a theorem, due to Lagrange, which asserts
that every natural number can be written as a sum of four perfect squares. To
this end, we ï¬rst observe that the following generalization of Eulerâ€™s identity
holds: if two given naturals m and n can be written as sums of four squares,
then mn can also be written this way. Indeed, if m = a2 + b2 + c2 + d2 and
n = w2 + x2 + y2 + z2, then a simple (though surely tedious) veriï¬cation shows
that6
mn = (aw âˆ’bx âˆ’cy âˆ’dz)2 + (ax + bw + cz âˆ’dy)2
+ (ay âˆ’bz + cw + dx)2 + (az + by âˆ’cx + dw)2.
(12.10)
6For a natural proof of such an identity, we refer the reader to item (f) of Problem 10, page 327.

12.4
Sums of Two Squares
315
Given such a result, do the following items7:
(a) Let p be prime, S = {x2; x âˆˆZp} and Sâ€² = {âˆ’1 âˆ’y; y âˆˆS}. Prove that
S âˆ©Sâ€² Ì¸= âˆ….
(b) Conclude that, if p is prime, then there exist x, y, m âˆˆZ such that 1 â‰¤m <
p and x2 + y2 + 1 = mp.
(c) Let p be prime and 1 < m < p be such that mp = x2
1 + x2
2 + x2
3 + x2
4,
with x1, x2, x3, x4 âˆˆZ. If âˆ’m
2 < yi <
m
2 is chosen in such a way that
xi â‰¡yi (mod m), prove that there exists 1 â‰¤r < m for which rp = y2
1 +
y2
2 + y2
3 + y2
4.
(d) Complete the proof of Lagrangeâ€™s theorem, showing that every natural
number can written as the sum of four perfect squares.
6. (IMO shortlistâ€”adapted) The purpose of this problem is to ï¬nd out all n âˆˆN for
which there exists some m âˆˆN such that 2n âˆ’1 divides m2 + 9. To this end, do
the two coming items:
(a) By contradiction, show that if 2n âˆ’1 divides m2 + 9 for some m âˆˆN, then
n is a power of 2.
(b) If n = 2k, make induction on k to show that there exists mk âˆˆN such that
22k âˆ’1 divides m2
k + 9.
7We follow the steps delineated in problem XI.14 of the marvelous book [32].

Chapter 13
Complex Numbers
It is an obvious fact that the set of reals is too small to provide a complete description
of the set of roots of polynomial functions; for instance, the function x â†’x2 + 1,
with x âˆˆR, does not have any real root. Historically, the search for such roots
strongly motivated the birth of complex numbers and the ï¬‚owering of complex
function theory. In this respect, a major ï¬rst crowning was the proof, by Gauss, of
the famous Fundamental Theorem of Algebra, which asserts that every polynomial
function with complex coefï¬cients has a complex root.
In this chapter, we concentrate ourselves in the construction and discussion of
the elementary properties of the set of complex numbers, postponing to Sect. 15.1
the presentation of one simple proof of the aforementioned theorem of Gauss.
13.1
Basic Deï¬nitions and Properties
As was seen in Chapter 1 of [8], one generally looks at the set R of real numbers as
the number line: one starts with a straight line (geometric entity), choosing a point
in it to correspond to 0; then, one chooses a standard length to correspond to the unit
of measure, and two distinct rules to operate with two points along the line (such
operations being called addition and multiplication of real numbers), so that one
gets a third point as the result of operating (i.e., adding or multiplying) two given
points. We then call the points along the line as real numbers, assume that they fulï¬ll
the whole line and check that the operations of addition and multiplication satisfy
the usual properties of commutativity, associativity etc.
Â© Springer International Publishing AG, part of Springer Nature 2018
A. Caminha Muniz Neto, An Excursion through Elementary Mathematics, Volume III,
Problem Books in Mathematics, https://doi.org/10.1007/978-3-319-77977-5_13
317

318
13
Complex Numbers
The discussion at the former paragraph hints to the following natural question:
would there be some way of deï¬ning two operations with the points of an Euclidean
plane in a way similar to the ordinary addition and multiplication of real numbers?
The answer to this question is yes and the resulting set, which we are about to
describe, is that of complex numbers.
Look at the cartesian plane as the set R Ã— R of ordered pairs (a, b) of reals. Let
âŠ•and âŠ™be the operations with the points of such a plane deï¬ned by
(a, b)âŠ•(c, d) = (a+c, b+d) and (a, b)âŠ™(c, d) = (acâˆ’bd, ad+bc),
(13.1)
where + and Â· respectively denote the ordinary addition and multiplication of real
numbers.
One can straightforwardly verify that âŠ•and âŠ™are associative and commu-
tative operations, and that âŠ™is distributive with respect to âŠ•, i.e., that for all
a, b, c, d, e, f âˆˆR, the following properties hold:
i. Associativity of âŠ•and âŠ—: (a, b)âŠ•((c, d)âŠ•(e, f )) = ((a, b)âŠ•(c, d))âŠ•(e, f )
and (a, b) âŠ™((c, d) âŠ™(e, f )) = ((a, b) âŠ™(c, d)) âŠ™(e, f ).
ii. Commutativity of âŠ•and âŠ—: (a, b) âŠ•(c, d) = (c, d) âŠ•(a, b) and (a, b) âŠ™
(c, d) = (c, d) âŠ™(a, b).
iii. Distributivity of âŠ—with respect to âŠ•: (a, b) âŠ™((c, d) âŠ•(e, f )) = ((a, b) âŠ™
(c, d)) âŠ•((a, b) âŠ™(e, f ))
It is also pretty clear (check it!) that (0, 0) and (1, 0) are identities for âŠ•and âŠ™,
respectivamente, i.e., that
(a, b) âŠ•(0, 0) = (a, b) and (a, b) âŠ™(1, 0) = (a, b),
for all a, b âˆˆR. Below, we prove a further important arithmetic property of âŠ™,
which is known as the cancellation law.
Lemma 13.1 The following cancellation law holds for âŠ™:
(a, b) âŠ™(c, d) = (0, 0) â‡’(a, b) = (0, 0) or (c, d) = (0, 0).
Proof Since (a, b)âŠ™(c, d) = (acâˆ’bd, ad+bc), we get acâˆ’bd = 0 and ad+bc =
0. Therefore, arguing as in the proof of Eulerâ€™s identity (cf. Lemma 12.32), we get
0 = (ac âˆ’bd)2 + (ad + bc)2 = (a2 + b2)(c2 + d2).
Hence, either a2 + b2 = 0 or c2 + d2 = 0, which is the same as saying that either
(a, b) = 0 or (c, d) = 0.
âŠ“âŠ”
Now, let us look at the real line as the horizontal axis of the cartesian plane,
which is equivalent to identifying each real number x with the ordered pair (x, 0).
We have to check whether such an identiï¬cation is good, in the sense that the results
of performing âŠ•and âŠ™with such ordered pairs give (up to identiï¬cation) the same

13.1
Basic Deï¬nitions and Properties
319
results we would get if we ï¬rst performed the usual operations of addition and
multiplication of real numbers. This reduces to verifying that
(x, 0) âŠ•(y, 0) = (x + y, 0) and (x, 0) âŠ™(y, 0) = (xy, 0),
(13.2)
which is totally immediate.
Thanks to the above computations, together with the fact that x â†’(x, 0) is
injective, we can safely consider R, furnished with its usual operations of addition
and multiplication, as a subset of R Ã— R, furnished with the operations âŠ•and âŠ™
deï¬ned as in (13.1). This also allows us to call the points of the cartesian plane as
numbers, more precisely as the complex numbers. From now on, we shall denote
the set of complex numbers by C.
In what follows, we shall derive an easier way to represent the set of complex
numbers and its operations. To this end, let us henceforth denote by i the complex
number (0, 1), calling it the imaginary unit.1
Letting â‰ˆdenote the identiï¬cation of the points along the horizontal axis with
real numbers, and taking into account the deï¬nition of âŠ™, we are led to conclude
that
i2 = (0, 1) âŠ™(0, 1) = (0 Â· 0 âˆ’1 Â· 1, 0 Â· 1 + 1 Â· 0) = (âˆ’1, 0) â‰ˆâˆ’1.
(13.3)
Note also that
(a, b) = (a, 0) âŠ•(0, b) = (a, 0) âŠ•((b, 0) âŠ™(0, 1)) â‰ˆa + bi,
(13.4)
which is said to be the algebraic form.
From now on, we shall write simply + and Â· to respectively denote the operations
âŠ•and âŠ™, and shall write a + bi to denote the complex number (a, b). We shall
also omit the identiï¬cations involved, for, as we shall see in a few moments, there
is no danger that such a usage induces wrong arithmetic inside C. It thus follows
from (13.4) that
a + bi = 0 â‡”(a, b) = (0, 0) â‡”a = b = 0.
According to (13.3), in the set C of complex numbers the equation
x2 + 1 = 0
1The names complex and imaginary are rooted in the historical development of complex numbers.
More precisely, when mathematicians started using complex numbers, even without having a
precise deï¬nition of what they should be, they called them complex or imaginary, in allusion to the
oddness of guessing the existence of â€œnumbersâ€ whose squares could be negative.

320
13
Complex Numbers
has i as a root. As we shall see along this chapter and Chap. 15, this is the core fact
related to the importance of complex numbers.
As we anticipated above, a good reason for writing (a, b) âˆˆC in the algebraic
form a + bi is that, upon doing it, we can operate with complex numbers exactly as
we do with reals; one just has to take into account that i2 = âˆ’1. Indeed, we check
below that the computations performed this way lead to the same results as those
done by directly using the deï¬nitions of + and Â· (i.e., âŠ•and âŠ™) in C:
â€¢
Computation of (a, b) + (c, d): by deï¬nition, we have (a, b) + (c, d) = (a +
c, b + d). On the other hand, operating as we would do with reals, we obtain
(a + bi) + (c + di) = (a + c) + (b + d)i.
However, since we are writing (a + c, b + d) = (a + c) + (b + d)i, both results
do coincide.
â€¢
Computation of (a, b) Â· (c, d): by deï¬nition, we have (a, b) Â· (c, d) = (ac âˆ’
bd, ad + bc). Operating once more as with real numbers, we get
(a + bi)(c + di) = ac + adi + bci + bdi2 = (ac âˆ’bd) + (ad + bc)i,
since i2 = âˆ’1. Here again we are writing (ac âˆ’bd, ad + bc) = (ac âˆ’bd) +
(ad + bc)i, so that both results also coincide.
Thanks to the above identiï¬cations, we can surely write R âŠ‚C, with x âˆˆR
written in algebraic form as x + 0i. Moreover, by analogy with the addition and
multiplication of reals, we shall also call the + and Â· operations on complex numbers
as the addition and multiplication, respectively.
Proceeding with the development of the theory, let us introduce in C other two
operations, this time extending the subtraction and division of real numbers. Before
we go on, we remark that it is common usage to write z, w etc to refer to general
complex numbers, so that each one of them has its own algebraic form.
Given z, w âˆˆC, subtracting w of z means obtaining a complex number z âˆ’w
(the difference between z and w) such that z = (zâˆ’w)+w. Writing z = a +bi and
w = c + di and operating as with reals, we easily see that the only possible way of
deï¬ning z âˆ’w is by letting
z âˆ’w = (a + bi) âˆ’(c + di) = (a âˆ’c) + (b âˆ’d)i.
Formally, for z = a + bi and w = c + di, the complex number z âˆ’w is deï¬ned by
z âˆ’w = (a âˆ’c) + (b âˆ’d)i,
(13.5)
being called the difference between z and w, in this order.
Also for z, w âˆˆC, with w Ì¸= 0, dividing z by w means obtaining a complex
number z/w (the quotient between z and w) such that z = (z/w) Â· w. Letting

13.1
Basic Deï¬nitions and Properties
321
z = a + bi and w = c + di, and operating as we do upon rationalising real number,
we immediately get
z
w = a + bi
c + di = (a + bi)(c âˆ’di)
(c + di)(c âˆ’di)
= (ac + bd) + (bc âˆ’ad)i
c2 + d2
= ac + bd
c2 + d2 + bc âˆ’ad
c2 + d2 i.
as the only possibility for z/w.
Formally, for z = a + bi and w = c + di, with w Ì¸= 0, the complex number z/w
is deï¬ned by
z
w = ac + bd
c2 + d2 + bc âˆ’ad
c2 + d2 i,
(13.6)
being called the quotient between z and w, in this order.
The particular case of dividing 1 by a nonzero complex number leads us to
conclude that every complex number z Ì¸= 0 possess an inverse with respect to
multiplication. Writing z = a + ib Ì¸= 0, it follows from (13.6) that such an inverse,
which we shall denote by zâˆ’1 or 1/z, is given by
zâˆ’1 =
a
a2 + b2 âˆ’
b
a2 + b2 i.
Once again, note that we need not worry about memorizing the above formulas. It
just sufï¬ces to operate as we do with real numbers.
In order to simplify lots of forthcoming computations, we now introduce the
following notation: for z = a + bi âˆˆC, we write z to denote the complex number
z = a âˆ’bi, and call it the conjugate of z. In particular, we have z = z.
Note also that, upon multiplying z by z, we get as result the real number a2 + b2,
for
z Â· z = (a + bi)(a âˆ’bi) = a2 âˆ’(bi)2 = a2 + b2.
We write |z| =
âˆš
a2 + b2 and call |z| the modulus of z. When z âˆˆR, it is
immediate to note that the notion of modulus of a complex number, as deï¬ned
above, coincides with the usual notion of the modulus of a real number (cf. [8],
for instance). In short,
z = a + bi â‡’|z|2 = zz = a2 + b2.
(13.7)

322
13
Complex Numbers
Fig. 13.1 Conjugation of
complex numbers in the
complex plane
Re
Im
z
z
b
âˆ’b
a
0
|z|
|z|
Yet another simple fact concerning the modulus of a complex number is that
|z| = |z|. This will become geometrically apparent quite soon (cf. Fig. 13.1),
provided we go back to the very deï¬nition of C, looking at complex numbers as the
points of the cartesian plane. Upon doing this, we obtain a geometric representation
of C, which is known as the complex plane.2
In the complex plane, the horizontal and vertical axes are respectively called
the real and imaginary. The real axis is this formed by the complex numbers
which are actually real numbers (i.e., by the ordered pairs (x, 0) â‰ˆx), whereas the
complex numbers along the imaginary axis are those of the form yi, with y âˆˆR
(this corresponds to the ordered pairs (0, y) = (y, 0) Â· (0, 1) â‰ˆyi); such complex
numbers are called pure imaginary (so that i is one of them).
Also with respect to the complex plane, since z = a +bi = (a, b), it follows that
z and z = a âˆ’bi are symmetric with respect to the real axis (cf. Fig. 13.1); hence,
|z| = |z|. On the other hand, the real numbers a and b are respectively called the
real and imaginary parts of z, and are denoted
a = Re(z), b = Im(z).
Thus, z = Re(z) + i Im(z), so that z = Re(z) âˆ’i Im(z) and, hence,
Re(z) = z + z
2
and Im(z) = z âˆ’z
2i
.
(13.8)
2Also called the Argand-Gauss plane, in honor of the amateur Swiss mathematician of the
eighteenth century Jean-Robert Argand, and of the great J. C. F. Gauss.

13.1
Basic Deï¬nitions and Properties
323
The following lemma collects further useful properties of the conjugation of
complex numbers. In order to properly state it, we observe that the associativity
of the multiplication of complex numbers guarantees the well deï¬niteness of the
nâˆ’th power zn, for z âˆˆC and n âˆˆN, as z1 = z and
zn = z Â· . . . Â· z



n times
,
for n > 1. Moreover, such a deï¬nition can be easily extended to integer exponents
n by setting, for z âˆˆC \ {0}, z0 = 1 and, for an integer n < 0,
zn = (zâˆ’n)âˆ’1 =
1
zâˆ’n .
Then, easy inductive arguments allow us to show that the usual arithmetic rules
for powers remain valid, namely:
(zm)n = zmn and (zw)n = znwn
(13.9)
for all z, w âˆˆC \ {0} and m, n âˆˆZ.
We also take the opportunity to point out (although this would not be needed in
the coming lemma) that the usual binomial formula,
(z + w)n =
n

k=0
n
k

znâˆ’kwk
(for all z, w âˆˆC \ {0} such that z + w Ì¸= 0, and every n âˆˆN), also holds true in
C, since its proof only depends on properties of addition and multiplication of real
numbers that also hold true in C.
We can ï¬nally state and prove the aforementioned result.
Lemma 13.2 If z and w are nonzero complex numbers, then:
(a) z âˆˆR â‡”Re(z) = 0 â‡”z = z.
(b) z + w = z + w, zw = z Â· w and z/w = z/w.
(c) zn = (z)n, for every n âˆˆZ.
(d) |z| = 1 â‡”z = 1/z.
Proof
(a) Letting z = a + bi, we have
z âˆˆR â‡”b = 0 â‡”a + bi = a âˆ’bi â‡”z = z.

324
13
Complex Numbers
(b) Writing z = a + bi and w = c + di, we compute
z + w = (a âˆ’bi) + (c âˆ’di)
= (a + c) âˆ’(b + d)i
= z + w
and
zw = (ac âˆ’bd) + (ad + bc)i
= (ac âˆ’bd) âˆ’(ad + bc)i
= (a âˆ’bi)(c âˆ’di) = z Â· w.
From this last one, it follows that
z/w Â· w = z/w Â· w = z
and, hence,
z/w = z/w.
(c) For n = 0, the result is immediate and, for n âˆˆN, it easily follows by induction
from (b). For an integer n < 0, ï¬rst note that, by item (b), we have
1 = 1 = zzâˆ’1 = z Â· zâˆ’1,
so that zâˆ’1 = (z)âˆ’1; hence, letting u = zâˆ’1, the ï¬rst part above, together
with (13.9), furnishes
zn = uâˆ’n = (u)âˆ’n = ((z)âˆ’1)âˆ’n = (z)(âˆ’1)(âˆ’n) = (z)n.
(d) Since (cf. (13.7)) z Â· z = |z|2, we conclude that
|z| = 1 â‡”z Â· z = 1 â‡”z = 1/z.
âŠ“âŠ”
Example 13.3 (Spain) If z and w are complex numbers of modulus 1 and such that
zw Ì¸= âˆ’1, show that z+w
1+zw is real.
Proof Letting a = z+w
1+zw, item (a) of the previous lemma guarantees that it is enough
to show that a = a. To this end, note that, by applying items (b) and (d) of that same
result, we get

13.1
Basic Deï¬nitions and Properties
325
a = z + w
1 + zw
=
z + w
1 + z Â· w
= zâˆ’1 + wâˆ’1
1 + zâˆ’1wâˆ’1 = w + z
zw + 1 = a.
âŠ“âŠ”
Our next result gives quite a useful geometric interpretation of the modulus of
the difference of two complex numbers.
Proposition 13.4 Given z, w âˆˆC, the real number |z âˆ’w| equals the Euclidean
distance from z to w in the cartesian plane subjacent to the corresponding complex
plane.
Proof If z = a + bi and w = c + di, then
|z âˆ’w| = |(a âˆ’c) + (b âˆ’d)i| =
:
(a âˆ’c)2 + (b âˆ’d)2.
On the other hand (cf. Fig. 13.2), basic Analytic Geometry (cf. Chapter 6 of [9])
assures that the distance from z to w is also given by
:
(a âˆ’c)2 + (b âˆ’d)2.
âŠ“âŠ”
The coming inequality (13.10) is known as the triangle inequality for complex
numbers.
Corollary 13.5 If u, v and z are any complex numbers, then
|u âˆ’v| â‰¤|u âˆ’z| + |z âˆ’v|.
(13.10)
Proof According to Proposition 13.4, the corollary only says that the length of any
side of a (possibly degenerate) triangle does not exceed the sum of the lengths of
its other two sides. However, we already know this to be true (cf. Theorem 2.26 of
[9]).
âŠ“âŠ”
Fig. 13.2 Modulus of the
difference between two
complex numbers
Re
Im
z
w
|a âˆ’ c |
|b âˆ’d|
bi
di
a
c

326
13
Complex Numbers
Problems: Sect. 13.1
1. With respect to the operations of addition and multiplication of complex
numbers, check that they are associative and commutative, as well as that
multiplication is distributive with respect to addition. Check also that (0, 0)
and (1, 0) are unit elements for the addition and multiplication, respectively.
2. * Given z, w âˆˆC, prove that:
(a) |zw| = |z| Â· |w| and (if w Ì¸= 0) |z/w| = |z|/|w|.
(b) |z + w|2 = |z|2 + 2Re(zw) + |w|2.
3. * Use item (b) of the previous problem to establish, for all z, w âˆˆC \ {0}, the
validity of the inequality |z+w| â‰¤|z|+|w|, with equality if and only if z = Î»w,
for some Î» > 0. This inequality is also known as the triangle inequality for
complex numbers. Use it to:
(a) Deduce the validity of (13.10).
(b) Prove that ||z| âˆ’|w|| â‰¤|z âˆ’w|, for all z, w âˆˆC.
4. For a given z âˆˆC, show that |z| = 1 if and only if there exists x âˆˆR for which
z = 1âˆ’ix
1+ix .
5. (OCM) Let a and z be complex numbers such that |a| < 1 and az Ì¸= 1. If
				
z âˆ’a
1 âˆ’a z
				 < 1,
prove that |z| < 1.
6. Let a âˆˆC and R > 0 be such that |a| Ì¸= R. Let  be the circle of center a and
radius R in the complex plane (so that 0 /âˆˆ), and Ëœ =

1
z; z âˆˆ

. Show that
Ëœ is the circle of center
a
|a|2âˆ’R2 and radius
R
||a|2âˆ’R2|.
For the coming problem, we deï¬ne a sequence of complex numbers as
a function f : N â†’C. As in our discussion of sequences of real numbers,
performed in [8], given a sequence f : N â†’C we write zn = f (n) and refer
to the sequence f simply by (zn)nâ‰¥1.
7. (Netherlands) The sequence (zk)kâ‰¥1 of complex numbers is deï¬ned, for k âˆˆN,
by
zk =
k
j=1

1 +
i
âˆšj

,
with i representing the imaginary unit. Find all n âˆˆN for which
n

k=1
|zk+1 âˆ’zk| = 1000.

13.1
Basic Deï¬nitions and Properties
327
8. Given z, w âˆˆC, let u and v be the vectors starting at 0 and having z and w
as endpoints, respectively. Prove that the complex numbers z + w and z âˆ’w
are the endpoints of the vectors u + v and u âˆ’v, respectively, both of which
starting at 0.
For the coming problem, recall (cf. Sect. 4.3) that a (partial) order relation
in a nonempty set X is a relation âª¯in X which is reï¬‚exive, transitive and
antisymmetric; moreover, if we have x âª¯y or y âª¯x for all x, y âˆˆX, then the
order relation âª¯is said to be a total ordering of X.
9. Prove that the set of complex numbers cannot be totally ordered. More
precisely, prove that there does not exist, on C, a total ordering âª¯, which
extends the usual order relation in R and satisï¬es the conditions
0 âª¯z, w â‡’0 âª¯z + w, zw.
The coming problem generalizes the construction of C, presenting the set H
of Hamiltonâ€™s3 quaternions (also called quaternionic numbers).
10. * In H = {(a, b, c, d); a, b, c, d, âˆˆR}, let âŠ•and âŠ™be the operations deï¬ned,
for Î± = (a, b, c, d) and Î² = (w, x, y, z), by
Î± âŠ•Î² = (a + w, b + x, c + y, d + z)
and
Î± âŠ™Î² = (aw âˆ’bx âˆ’cy âˆ’dz, ax + bw + cz âˆ’dy,
ay âˆ’bz + cw + dx, az + by âˆ’cx + dw),
where + and Â· respectively denote the usual operations of addition and
multiplication of real numbers. Such operations are called the addition and
multiplication of H. With respect to them, do the following items:
(a) Show that the function Î¹ : R â†’H, given by Î¹(x) = (x, 0, 0, 0) preserves
operations, in the sense that
Î¹(x) âŠ•Î¹(y) = Î¹(x + y) and Î¹(x) âŠ™Î¹(y) = Î¹(x + y),
for all x, y âˆˆR.
(b) Show that the functions Î¹1, Î¹2, Î¹3 : C â†’H, given by Î¹1(x + yi) =
(x, y, 0, 0), Î¹2(x +yi) = (x, 0, y, 0) and Î¹3(x +yi) = (x, 0, 0, y), preserve
operations, in the sense that
Î¹j(z) âŠ•Î¹j(w) = Î¹j(z + w) and Î¹j(z) âŠ™Î¹j(w) = Î¹j(z + w),
for all z, w âˆˆC and 1 â‰¤j â‰¤3.
3After William R. Hamilton, Irish astronomer, mathematician and physicist of the nineteenth cen-
tury. Quaternions have many important applications in Mathematics and Physics, but unfortunately
they lie far beyond the scope of these notes.

328
13
Complex Numbers
(c) In view of items (a) and (b), we hereafter write simply + and Â· to denote
âŠ•and âŠ™, respectively, x to denote (x, 0, 0, 0) and i = (0, 1, 0, 0), j =
(0, 0, 1, 0) and k = (0, 0, 0, 1). Under these conventions, show that
i2 = j2 = k2 = âˆ’1
ij = âˆ’ji = k, jk = âˆ’kj = i, ki = âˆ’ik = j
(13.11)
and
(a, b, c, d) = a + bi + cj + dk.
(d) Show that the results of (a + bi + cj + dk) + (w + xi + yj + zk) and
(a + bi + cj + dk) Â· (w + xi + yj + zk) are the same we would have
obtained by using the usual operations of addition and multiplication of
real numbers, together with (13.11). From this, conclude that:
i. The addition of quaternions is commutative, associative and has 0 as
identity.
ii. The multiplication of quaternions is associative, distributive with
respect to + and has 1 as identity; nevertheless, it is not commutative.
(e) For Î± = a + bi + cj + dk âˆˆH, let Î± = a âˆ’bi âˆ’cj âˆ’dj be the conjugate
of Î±. For Î±, Î² âˆˆH, show that Î±Î² = Î±Î².
(f) For Î± = a +bi +cj +dk âˆˆH, let |Î±| =
âˆš
a2 + b2 + c2 + d2 be the norm
of Î±. Show that Î±Î± = |Î±|2 and |Î±Î²| = |Î±||Î²|, for all Î±, Î² âˆˆH.
(g) Use the result of the previous item to deduce identity (12.10).
(h) Conclude that, given Î± âˆˆH \ {0}, there exists a single Î² âˆˆH for which
Î±Î² = 1. Then, show that the following cancellation law holds in H: if
Î±, Î² âˆˆH are such that Î±Î² = 0, then Î± = 0 or Î² = 0.
11. (Japan) Let P be a convex pentagon whose sides and diagonals have, in some
order, lengths equal to l1, l2, . . . , l10. If all of the numbers l2
1, l2
2, . . . , l2
9 are
rational, prove that l2
10 is also rational.
13.2
The Polar Form of a Complex Number
Given z = a + bi âˆˆC \ {0}, let Î± âˆˆ[0, 2Ï€) be the least value, in radians, of the
trigonometric angle measured from the positive real axis to the half line joining 0 to
z (cf. Fig. 13.3).
Writing
z = |z|

a
âˆš
a2 + b2 +
b
âˆš
a2 + b2 i

,

13.2
The Polar Form of a Complex Number
329
Fig. 13.3 The polar form of
a complex number
Re
Im
z
b
a
Î±
0
we easily get
cos Î± =
a
âˆš
a2 + b2 and sin Î± =
b
âˆš
a2 + b2 ,
so that
z = |z|(cos Î± + i sin Î±).
(13.12)
Since sin(Î± + 2kÏ€) = sin Î± and cos(Î± + 2kÏ€) = cos Î± for every k âˆˆZ,
equality (13.12) continues to hold with Î± + 2kÏ€ in place of Î±. For this reason,
from now on we say that the real numbers of the form Î± + 2kÏ€, with k âˆˆZ,
are the arguments of the nonzero complex numbers z, and that Î± is its principal
argument.
Letting Î± be any argument of z âˆˆC \ {0}, we shall call (13.12) the polar, or
trigonometric, form of z. Note that
| cos Î± + i sin Î±| = 1,
(13.13)
for every Î± âˆˆR. Hereafter, we shall denote the complex number cos Î± + i sin Î±
simply by cis Î±. Thus, letting Î± be an argument of z âˆˆC \ {0}, it follows
from (13.12) that
z = |z| cis Î±.
The coming example presents an interesting, albeit elementary, use of the notion
of argument of a nonzero complex number.
Example 13.6 Among all complex numbers z for which |z âˆ’25i| â‰¤15, ï¬nd the
one having smallest principal argument.
Solution The complex numbers satisfying the given condition are those situated on
the closed disk bounded by the circle of center 25i and radius 15. Among these, the

330
13
Complex Numbers
one with smallest principal argument, say z, is easily seen to be such that the half
line starting at 0 and passing through z is tangent to the aforementioned circle in the
ï¬rst quadrant of the cartesian plane (see the ï¬gure below).
Re
Im
0
25i
z
Since the radius of the circle is 15, Pythagorasâ€™ Theorem applied to the right
triangle with vertices 25i, z and 0 gives |z| = 20. Now, letting z = a + bi, we have
that a equals the height of such a right triangle relative to its hypotenuse. Therefore,
the usual metric relations on right triangles (cf. Chapter 4 of [9], for instance) give
25a = 15 Â· 20, so that a = 12. From |z| = 20 we get
202 = |z|2 = a2 + b2 = 122 + b2
and, since z belongs to the ï¬rst quadrant, b = 16. Hence, z = 12 + 16i.
âŠ“âŠ”
Back to the development of the theory, we now present the computational
advantages of the polar form of nonzero complex numbers. We start with a simple,
albeit very important result.
Proposition 13.7 Given Î±, Î² âˆˆR, we have
cis Î± Â· cis Î² = cis (Î± + Î²).
(13.14)
Proof It is enough to compute
cis Î± Â· cis Î² = (cos Î± + i sin Î±)(cos Î² + i sin Î²)
= (cos Î± cos Î² âˆ’sin Î± sin Î²) + i(cos Î± sin Î² + cos Î² sin Î±)
= cos(Î± + Î²) + i sin(Î± + Î²)
= cis (Î± + Î²),
where in the third equality above we applied the usual addition formulas of
Trigonometry (cf. Chapter 7 of [9], for instance).
âŠ“âŠ”

13.2
The Polar Form of a Complex Number
331
Fig. 13.4 Geometric
interpretation of the
multiplication by cis Î±
Re
Im
z
z Â· cis Î±
Î¸
Î±
u
The coming corollary provides the usual geometric interpretation for the multi-
plication of complex numbers, one of which of modulus 1. For the general case, we
refer the reader to Problem 1.
Corollary 13.8 Let Î± be a given real number and z âˆˆC \ {0}. If u is the vector
that goes from 0 to z, then the point of the complex plane representing (cis Î±) Â· z is
the endpoint of the vector obtained from u by means of a trigonometric rotation4 of
center 0 and angle Î± (cf. Fig. 13.4).
Proof Letting z = |z| cis Î¸, we have from (13.14) that
z Â· cis Î± = |z| cis Î¸ Â· cis Î± = |z| cis (Î¸ + Î±).
Now, the description of the polar form assures that this last complex number is
precisely the endpoint of the vector obtained from u by means of a trigonometric
rotation of Î± radians.
âŠ“âŠ”
Formula (13.15) below, known as the ï¬rst de Moivreâ€™s formula, gives further
insight on the computational advantages of the polar representation of nonzero
complex numbers.
Proposition 13.9 (de Moivre) If z = |z| cis Î± is a nonzero complex number and
n âˆˆZ, then
zn = |z|n cis (nÎ±).
(13.15)
Proof The case n = 0 is trivial. For the time being, assuming we have proved the
formula for n > 0, let us show how to set its validity also for n < 0. To this end,
4Recall that this means we rotate u through an angle of Î± radians, in the counterclockwise sense if
Î± > 0 and in the clockwise sense if Î± < 0.

332
13
Complex Numbers
let n = âˆ’m, with m âˆˆN. Given Î¸ âˆˆR, it follows from item (d) of Lemma 13.2,
together with |cis Î¸| = 1, that
(cis Î¸)âˆ’1 = cis Î¸ = cos Î¸ + i sin Î¸ = cos Î¸ âˆ’i sin Î¸
= cos(âˆ’Î¸) + i sin(âˆ’Î¸) = cis (âˆ’Î¸).
(13.16)
Therefore, since we are assuming the validity of (13.15) with m in place of n, we
get
zn = zâˆ’m = (|z| cis Î±)âˆ’m = |z|âˆ’m( cis (mÎ±))âˆ’1
= |z|n cis (âˆ’mÎ±) = |z|n cis (nÎ±).
For n > 0, let us make induction on n, the case n = 1 being trivial. Assuming
that the result holds true for some n âˆˆN and invoking (13.14), we obtain
zn+1 = z Â· zn = |z| cis Î± Â· |z|n cis (nÎ±)
= |z|n+1 cis Î± Â· cis (nÎ±)
= |z|n+1 cis (n + 1)Î±.
âŠ“âŠ”
Let us now compute the arguments of the product and the quotient of two nonzero
complex numbers.
Corollary 13.10 If z = |z| cis Î± and w = |w| cis Î² are nonzero complex numbers,
then
zw = |zw|cis (Î± + Î²) and z
w = |z|
|w| Â· cis (Î± âˆ’Î²).
In particular, Î± + Î² (resp. Î± âˆ’Î²) is the measure, in radians of an argument for zw
(resp. for z/w).
Proof Let us do the proof for z
w, the other case being entirely analogous. To this
end, it sufï¬ces to successively apply (13.16) and (13.14) to get
z
w = |z| cis Î± Â· |w|âˆ’1 cis (âˆ’Î²) = |z|
|w| Â· cis (Î± âˆ’Î²).
âŠ“âŠ”
Given n âˆˆN and z âˆˆC \ {0}, we say that a complex number w is an n-th root
of z provided wn = z. In contrast with what happens with real numbers, we shall
see next that the number of n-th roots of each nonzero complex number is exactly n.
Nevertheless, whenever there is no danger of confusion, we shall write simply
nâˆšz
to denote any such root. In any case, formula (13.17) below, known as the second
de Moivreâ€™s formula, teaches us how to compute all of them.

13.2
The Polar Form of a Complex Number
333
Proposition 13.11 (de Moivre) If z = |z| cis Î± is a nonzero complex number and
n âˆˆN, then there are exactly n distinct complex values for the n-th root of z.
Moreover, such values are given by
n:
|z| Â· cis
Î± + 2kÏ€
n

; 0 â‰¤k < n, k âˆˆN,
(13.17)
where
nâˆš|z| stands for the usual positive real root of |z|.
Proof Writing w = r cis Î¸, we have
wn = z â‡”(r cis Î¸)n = |z| cis Î±
â‡”rn cis (nÎ¸) = |z| cis Î±
â‡”rn = |z| and nÎ¸ = Î± + 2kÏ€, âˆƒk âˆˆZ.
In turn, these last two equalities take place if and only if r =
nâˆš|z| and Î¸ = Î±+2kÏ€
n
,
for some k âˆˆZ. Hence, there will be as many distinct n-th roots of z as there are
distinct complex numbers of the form cis

Î±+2kÏ€
n

. Now, it is easy to see that
cis
Î± + 2kÏ€
n

= cis
Î± + 2(k + n)Ï€
n

and
cis
Î± + 2kÏ€
n

Ì¸= cis
Î± + 2lÏ€
n

for 0 â‰¤k < l < n, so that is sufï¬ces to consider the integers k such that 0 â‰¤k < n.
âŠ“âŠ”
In spite of the above formula, it is worth noticing (and will be clear in a few
moments) that its major role is theoretical; in other words, it is not always the best
way of actually computing the roots of a given complex number. This is due to the
fact that not always the polar form of a nonzero complex number is actually useful
in computations, as shown by the coming
Example 13.12 Compute the square roots of 7 + 24i.
Solution If we try to use the second de Moivreâ€™s formula, we ought to start by
writing 7+24i = 25 cis Î±, with Î± = arctan 24
7 . Then, we invoke (13.17) to compute
âˆš
7 + 24i as being equal to either
5 cis
Î±
2

or 5 cis
Î± + 2Ï€
2

.

334
13
Complex Numbers
We now get to the point: since Î± = arctan 24
7 , we shall have to compute cos
 Î±
2

and sin
 Î±
2

by knowing tan Î± = 24
7 . Although this can be done with the adequate
trigonometric formulas, it is much simpler to take an alternative path, which we
shall now describe.
Write 7 + 24i = (a + bi)2, with a, b âˆˆR, so that a + bi is a square root of
7 + 24i. Expanding (a + bi)2 and equating real and imaginary parts in both sides of
the equality thus obtained, we get the system of equations
 a2 âˆ’b2 = 7
ab = 12
.
Squaring the second equation and substituting a2 = b2 +7 in the result, we arrive at
the biquadratic equation (b2+7)b2 = 144, so that b2 = 9. Now, since ab = 12 > 0,
we conclude that a and b must have equal signs, so that the possible ordered pairs
(a, b) are (a, b) = (3, 4) or (âˆ’3, âˆ’4). Therefore, the square roots we are looking
for are Â±(3 + 4i).
âŠ“âŠ”
We now present an interesting (and useful) geometric interpretation of the n-th
roots of a nonzero complex number.
Proposition 13.13 If z is a nonzero complex number and n > 2 is natural, then, in
the complex plane, the n-th roots of z are the vertices of a regular n-gon with center
at the origin.
Proof Letting Î± be an argument of z, it follows from the second formula of de
Moivre that the n-th roots of z are the complex numbers z0, z1, . . . , znâˆ’1 such that
zk =
n:
|z| Â· cis
Î± + 2kÏ€
n

,
for 0 â‰¤k < n.
From (13.13), we obtain
|zk| =
n:
|z|
			 cis
Î± + 2kÏ€
n
			 =
n:
|z|,
so that all of the points zk lie on the circle of the complex plane centered at 0 and
having radius
nâˆš|z|.
On the other hand, it follows from Corollary 13.10 that
zk+1
zk
= cis
2Ï€
n

,
for 0 â‰¤k < n. Therefore, letting uk denote the vector that goes from 0 to zk,
Corollary 13.8 assures that the angle between uk and uk+1, in radians and in the
counterclockwise sense, is equal to 2Ï€
n .
The result follows immediately from these two facts.
âŠ“âŠ”

13.2
The Polar Form of a Complex Number
335
Fig. 13.5 Geometric
conï¬guration of the fourth
roots of âˆ’1
Re
Im
z1
z2
z3
z4
Example 13.14 Figure 13.5 represents the fourth roots of âˆ’1. Observe that z1 =
âˆš| âˆ’1|cis Ï€
4 = 1+i
âˆš
2 .
As an important particular case of the discussion of roots of complex numbers,
we say that the complex number Ï‰ is a root of unity if there exists a natural number
n such that Ï‰n = 1. In this case, Ï‰ is said to be an n-th root of unity.
Since 1 = cis 0, the second formula of de Moivre teaches us that the n-th roots
of unity are the n complex numbers given by
Ï‰k = cis
2kÏ€
n

; 0 â‰¤k < n, k âˆˆZ.
(13.18)
Writing Ï‰ = cis 2Ï€
n , it follows from the ï¬rst formula of de Moivre that
cis
2kÏ€
n

= cis
2Ï€
n
k
= Ï‰k.
Therefore, the n-th roots of unity are the complex numbers
1, Ï‰, . . . , Ï‰nâˆ’1.
(13.19)
As we shall see along the rest of this book, roots of unity are quite useful in a
number of situations, both algebraic and combinatorial. For the time being, a clue of
why this is so is provided by the following consequence of the previous proposition.
In order to properly state it, from now on we shall refer to the circle of the complex
plane with center 0 and radius 1 simply as the unit circle.
Corollary 13.15 If n > 2 is a natural number, then the n-th roots of unity are the
vertices of the regular n-gon inscribed in the unit circle and having 1 as one of its
vertices.

336
13
Complex Numbers
Fig. 13.6 Sixth roots of unity
Re
Im
1
Ï‰
Ï‰2
Ï‰3
Ï‰4
Ï‰5
Proof Apply Proposition 13.13 to z = 1, noticing that 1 is also one of the roots we
are looking at.
âŠ“âŠ”
Example 13.16 In the notations of Fig. 13.6 we have Ï‰ = cis 2Ï€
6 = 1+i
âˆš
3
2
, so that
the complex numbers 1, Ï‰, . . . , Ï‰5 are the sixth roots of unity. Note also that 1, Ï‰2
and Ï‰4 are the cubic roots of unity, whereas Ï‰, Ï‰3 = âˆ’1 and Ï‰5 are the cubic roots
of âˆ’1.
We ï¬nish this section by presenting two examples involving roots of unity and
which are somewhat more algebraic in nature.
Example 13.17 Given n âˆˆN, ï¬nd all of the solutions of equation (z âˆ’1)n = zn.
Solution Since z = 0 is not a solution, the given equation is equivalent to

1 âˆ’1
z
n
= 1. Hence, letting Ï‰ = cis 2Ï€
n , the above discussion assures that 1 âˆ’1
z
is an n-th root of unity, thus being equal to one of the numbers 1, Ï‰, Ï‰2, . . . , Ï‰nâˆ’1.
Now, observe that 1 âˆ’1
z = 1 has no solutions. On the other hand, for 1 â‰¤k â‰¤
n âˆ’1 we have Ï‰k Ì¸= 1, so that 1 âˆ’1
z = Ï‰k if and only if z =
1
1âˆ’Ï‰k . Thus, the
solutions of the given equation are the n âˆ’1 complex numbers
1
1 âˆ’Ï‰,
1
1 âˆ’Ï‰2 , . . . ,
1
1 âˆ’Ï‰nâˆ’1 .
âŠ“âŠ”
For the next example, recall (cf. discussion preceding Problem 7, page 326) that
a sequence of complex numbers is a function f : N â†’C, which, most often, will
be simply denoted by (zn)nâ‰¥1, where zn = f (n). This being said, we observe that
the proof of the formula for the sum of the ï¬rst n terms of an arithmetic progression
with common ratio different from 0 and 1 (cf. item (b) of Proposition 3.12 of [8], for
instance) still holds, ipsis literis, for a geometric progression of complex numbers,

13.2
The Polar Form of a Complex Number
337
i.e., a sequence (zn)nâ‰¥1 in C such that zk+1 = qzk for every k â‰¥1, with q âˆˆ
C \ {0, 1}. Hence, we can safely skip the proof of the following auxiliary result.
Lemma 13.18 For z âˆˆC \ {0, 1}, we have
1 + z + z2 + Â· Â· Â· + znâˆ’1 = zn âˆ’1
z âˆ’1 .
As a direct corollary of such a result, we note that if Ï‰ Ì¸= 1 is an n-th root of
unity, then Ï‰n = 1 and, hence,
1 + Ï‰ + Ï‰2 + Â· Â· Â· + Ï‰nâˆ’1 = Ï‰n âˆ’1
Ï‰ âˆ’1 = 0.
(13.20)
We shall use this formula several times along this text.
Example 13.19 (IMO) Prove that
cos Ï€
7 âˆ’cos 2Ï€
7 + cos 3Ï€
7 = 1
2.
Proof Letting Ï‰ = cis 2Ï€
7 be a seventh root of unity, we get
Re(Ï‰ + Ï‰2 + Ï‰3) = cos 2Ï€
7 + cos 4Ï€
7 + cos 6Ï€
7
= cos 2Ï€
7 âˆ’cos 3Ï€
7 âˆ’cos Ï€
7 .
On the other hand, since Ï‰k Â· Ï‰7âˆ’k = 1 and |Ï‰k| = 1, item (d) of Lemma 13.2
furnishes
Ï‰7âˆ’k = (Ï‰k)âˆ’1 = Ï‰k.
Therefore, Ï‰ + Ï‰2 + Ï‰3 = Ï‰6 + Ï‰5 + Ï‰4 and, hence,
Re(Ï‰ + Ï‰2 + Ï‰3) = Re(Ï‰6 + Ï‰5 + Ï‰4).
(13.21)
Now, (13.20) gives
Ï‰ + Ï‰2 + Â· Â· Â· + Ï‰6 = âˆ’1.
Taking real parts and using (13.21), we obtain
2Re(Ï‰ + Ï‰2 + Ï‰3) = Re(Ï‰ + Ï‰2 + Ï‰3) + Re(Ï‰6 + Ï‰5 + Ï‰4) = âˆ’1.

338
13
Complex Numbers
Thus, it follows from (13.21) that
cos Ï€
7 âˆ’cos 2Ï€
7 + cos 3Ï€
7 = âˆ’Re(Ï‰ + Ï‰2 + Ï‰3) = 1
2.
âŠ“âŠ”
Problems: Sect. 13.2
1. For r âˆˆR\{0}, we deï¬ne the homothety of center 0 and ratio r as the function
Hr : C â†’C such that Hr(z) = rz for every z âˆˆC. For Î¸ âˆˆR \ {0}, we deï¬ne
the rotation of center 0 and angle Î¸ as the function RÎ¸ : C \ {0} â†’C \ {0}
given by RÎ¸(z) = (cis Î¸)z, for every z âˆˆC \ {0}.
(a) Let u be the vector starting at 0 and having z as its endpoint. If w = Hr(z),
prove that ru is the vector starting at 0 and having endpoint w.
(b) If w = r cis Î¸ is a nonzero complex number, prove that for every z âˆˆC\{0}
we have
wz = Hr â—¦RÎ¸(z).
2. (OCM) Let Ï‰ be a complex number satisfying Ï‰2 + Ï‰ + 1 = 0. Compute the
value of the product
27

k=1

Ï‰k + 1
Ï‰k

.
3. Let n âˆˆN be a multiple of 3. Compute the value of (1 +
âˆš
3i)n âˆ’(1 âˆ’
âˆš
3i)n.
4. Solve, in C, the system of equations
â§
â¨
â©
|z1| = |z2| = |z3| = 1
z1 + z2 + z3 = 0
z1z2z3 = 1
.
5. Let n âˆˆN and a âˆˆC \ {0} be given, with |a| > 1. Show that all of the roots
of the equation (z âˆ’1)n = a(z + 1)n lie on the circle of the complex plane
centered at 1+R2
1âˆ’R2 and having radius
2R
R2âˆ’1, where R =
nâˆš|a|.
6. (Ireland) For each n âˆˆN, let an = n2 + n + 1. Given k âˆˆN, prove that there
exists m âˆˆN such that akâˆ’1ak = am.
7. (Romania) Let p, q âˆˆC, with q Ì¸= 0, be such that the second degree equation
x2 + px + q2 = 0 has complex roots of equal modulus. Prove that p
q âˆˆR.

13.3
More on Roots of Unity
339
8. Let z1, z2 and z3 be three given complex numbers, not all zero. Prove that z1,
z2 and z3 are the vertices of an equilateral triangle in the complex plane if and
only if
z2
1 + z2
2 + z2
3 = z1z2 + z2z3 + z3z1.
9. Given an integer n > 2, use complex numbers to prove that
nâˆ’1

k=0
cos 2kÏ€
n
=
nâˆ’1

k=0
sin 2kÏ€
n
= 0.
10. Given an integer n > 2 and Î± âˆˆR, use complex numbers to compute each of
the sums below in terms of n and Î±:
(a) sin Î± + sin (2Î±) + sin (3Î±) + Â· Â· Â· + sin (nÎ±).
(b) sin2 Î± + sin2(2Î±) + sin2(3Î±) + Â· Â· Â· + sin2(nÎ±).
11. (IMOâ€”shortlist) Let g : C â†’C be a given function and Ï‰ = cis 2Ï€
3 . For each
given complex number a, show that there exists only one function f : C â†’C
such that
f (z) + f (Ï‰z + a) = g(z), âˆ€z âˆˆC.
12. We are given a regular polygon A1A2 . . . A2n and a point P in the plane. Show
that
n

k=1
A2kP 2 =
n

k=1
A2kâˆ’1P 2.
13.3
More on Roots of Unity
We begin this section by illustrating the role of roots of unity as a counting tool.
Although several applications of algebraic arguments in Combinatorics will appear
along the rest of these notes, this is a much broader subject than we will be able to
present here. For a more comprehensive introduction we refer the interested reader
to the excellent classical book of Van Lint and Wilson [40].
We start by examining, in the coming example, how to use complex numbers as
tags.
Example 13.20 We put n > 1 equally spaced lamps around a circle. At ï¬rst, exactly
one of then is ON. An allowed operation on the states of the lamps is to choose a
positive divisor d of n, with d < n, and change the status of n
d equally spaced lamps

340
13
Complex Numbers
(i.e., from ON to OFF or vice-versa), provided all of them have the same status. Does
there exist a sequence of allowed operations that leaves all of the n lamps ON?
Solution No! By contradiction, assume, without loss of generality, that the circle is
the unit circle in the complex plane and the lamps are positioned at the points 1, Ï‰,
. . . , Ï‰nâˆ’1, where Ï‰ = cis 2Ï€
n . Assume also (again with no loss of generality) that
the lamp which is initially ON is the one standing at 1.
For every integer k â‰¥0, let ak denote the sum of the complex numbers associated
to the lamps which are ON immediately before the (k+1)-th operation is performed,
so that a0 = 1. Along the (k + 1)-th operation, we choose lamps positioned at
Ï‰l, Ï‰l+d, Ï‰l+2d, . . . , Ï‰l+( n
d âˆ’1)d,
for some pair (l, d) of integers such that 0 â‰¤l < d and d | n, with d < n. Since
Ï‰n = 1, we have
ak+1 = ak Â± (Ï‰l + Ï‰l+d + Ï‰l+2d + Â· Â· Â· + Ï‰l+( n
d âˆ’1)d)
= ak Â± Ï‰l+( n
d âˆ’1)d Â· Ï‰d âˆ’Ï‰l
Ï‰d âˆ’1
= ak,
and it follows that ak = 1 for every k â‰¥0.
On the other hand, if after m operations all lamps were ON, then we would have
am = 1 + Ï‰ + Â· Â· Â· + Ï‰n = 0,
which is a contradiction.
âŠ“âŠ”
Now, given m, n, p âˆˆN, let us consider the problem of assembling an m Ã— n
rectangle by using rectangular pieces 1 Ã— p. Counting 1 Ã— 1 squares, we obtain
an obvious necessary condition for the proposed assembling to be possible: p must
divide mn. On the other hand, it is clear that if p divides either m or n, then the
assembling is always possible: letting, for instance, m = pk, with k âˆˆN, it sufï¬ces
to juxtapose k rectangles p Ã— n, each of which assembled by piling n pieces 1 Ã— p,
one on the top of the other. The interesting fact here is that the converse of the
above discussion holds true, namely: one can assemble the desired rectangle only
if p divides m or n. This is the content of the coming theorem, which is due to the
American mathematician David Klarner.5
Theorem 13.21 (Klarner) Let m, n and p be given naturals. If we can assemble
an m Ã— n rectangle by using pieces 1 Ã— p, then p | m or p | n.
5Cf. Klarner and GÃ¶bel [24]. Nevertheless, the proof we present here is different from the original
one.

13.3
More on Roots of Unity
341
Proof Assume we can perform such a task, and note ï¬rst that p â‰¤max{m, n}. Now,
partition the rectangle into m rows 1 Ã— n and n columns m Ã— 1, numbering the rows
from 1 to m from top to bottom, and the columns from 1 to n from left to right (as
is usual in an m Ã— n matrix). Then, inside the 1 Ã— 1 square of intersection of row i
and column j, write the complex number Ï‰i+j, where Ï‰ = cis 2Ï€
p .
Let us now compute the sum of all of the numbers written in the 1 Ã— 1 squares in
two different ways (here we have a double counting!). On the one hand, such a sum
is clearly equal to
(Ï‰ + Ï‰2 + Â· Â· Â· + Ï‰n)(Ï‰ + Ï‰2 + Â· Â· Â· + Ï‰m) = Ï‰2(Ï‰n âˆ’1)(Ï‰m âˆ’1)
(Ï‰ âˆ’1)2
,
(13.22)
where we have used Lemma 13.18 in the equality above; on the other, since we
are assuming that it is possible to assemble the rectangle as wished, the numbers
written on it can be grouped together in sets of p numbers each, corresponding to
the p horizontal or vertical 1 Ã— 1 squares forming each one of the 1 Ã— p rectangles
used. Such sets of p complex numbers give rise to sums of one of the following
types:
Ï‰i+j + Ï‰i+(j+1) + Â· Â· Â· + Ï‰i+(j+pâˆ’1)
or
Ï‰i+j + Ï‰(i+1)+j + Â· Â· Â· + Ï‰(i+pâˆ’1)+j,
according to whether the 1 Ã— p rectangle is horizontally or vertically positioned,
respectively. Again by Lemma 13.18, together with the ï¬rst de Moivreâ€™s formula,
each of such sums equals
Ï‰i+j(1 + Ï‰ + Â· Â· Â· + Ï‰pâˆ’1) = Ï‰i+j Â· Ï‰p âˆ’1
Ï‰ âˆ’1 = 0.
Hence, the sum of all of the mn numbers written in the rectangle must also vanish.
Therefore, it follows from (13.22) that (Ï‰n âˆ’1)(Ï‰m âˆ’1) = 0 or, which is the same,
that
cis 2nÏ€
p
= 1 or cis 2mÏ€
p
= 1.
Finally, it is clear from these equalities that p | n or p | m.
âŠ“âŠ”
We devote the rest of this section to take a closer look at the structure of the set
of n-th roots of unity. We start by letting Un(C) denote it, so that
Un(C) = {z âˆˆC; zn = 1} = {Ï‰k
n; 1 â‰¤k â‰¤n},
where Ï‰n = cis 2Ï€
n .

342
13
Complex Numbers
We begin by showing that the intersection of Um(C) and Un(C) is again a set of
roots of unity.
Proposition 13.22 Given m, n âˆˆN, one has
Um(C) âˆ©Un(C) = Ud(C),
where d = gcd(m, n). In particular, if m and n are relatively prime, then Um(C) âˆ©
Un(C) = {1}.
Proof The second part follows immediately from the ï¬rst. For the ï¬rst part, if z âˆˆ
Ud(C), then zd = 1 and, hence, zm = (zd)m/d = 1. Analogously, zn = 1, so
that z âˆˆUm(C) âˆ©Un(C). This reasoning shows that Ud(C) âŠ‚Um(C) âˆ©Un(C).
Conversely, let z âˆˆUm(C) âˆ©Un(C). BÃ©zoutâ€™s theorem assures the existence of
x, y âˆˆZ such that mx + ny = d. Therefore, since zm = zn = 1, we get
zd = zmx+ny = (zm)x(zn)y = 1,
so that z âˆˆUd(C). Hence, Um(C) âˆ©Un(C) âŠ‚Ud(C), and we are done.
âŠ“âŠ”
We now specialize to a particular type of root of unity, according to the deï¬nition
below.
Deï¬nition 13.23 A complex number z âˆˆUn(C) is a primitive n-th root of unity
if
Un(C) = {zm; m âˆˆN}.
It follows immediately from the deï¬nition that Ï‰n is a primitive n-th root of unity.
On the other hand, the following result completely characterizes all of such special
roots.
Theorem 13.24 Given z âˆˆUn(C), the following are equivalent:
(a) z is primitive.
(b) There exists an integer 1 â‰¤k â‰¤n such that gcd(k, n) = 1 and z = Ï‰k
n.
(c) min{l âˆˆN; zl = 1} = n.
In particular, there are exactly Ï•(n) primitive n-th roots of unity, where Ï• : N â†’N
stands for the Euler function.
Proof
(a) â‡’(b):
let z = Ï‰k
n, for some integer 1 â‰¤k â‰¤n. If gcd(k, n) = d > 1, then
n = dnâ€² and k = dkâ€², for some kâ€², nâ€² âˆˆN. Also,
{zj; j âˆˆN} = {Ï‰k
n, Ï‰2k
n , Ï‰3k
n , . . .}.

13.3
More on Roots of Unity
343
Letting m = nâ€²q + r, with q, r âˆˆZ and 0 â‰¤r < nâ€², we have
Ï‰mk
n
= Ï‰(nâ€²q+r)dkâ€²
n
= Ï‰nqkâ€²
n
Â· Ï‰rk
n = Ï‰rk
n âˆˆ{1, Ï‰k
n, . . . , Ï‰(nâ€²âˆ’1)k
n
}.
Therefore,
#{zj; j âˆˆN} â‰¤nâ€² = n
d < n.
(b) â‡’(c):
let z = Ï‰k
n, where 1 â‰¤k â‰¤n is an integer relatively prime with n.
Take l âˆˆN for which zl = 1. Then, Ï‰kl
n = 1 and, thus, n | kl. However, since
gcd(k, n) = 1, item (a) of Proposition 6.22 assures that n | l; in turn, this gives
l â‰¥n. On the other hand, since zn = (Ï‰k
n)n = (Ï‰n
n)k = 1, we conclude that
min{l âˆˆN; zl = 1} = n.
(c) â‡’(a):
assuming that min{l âˆˆN; zl = 1} = n, we ï¬rst show that, for integers
1 â‰¤r < s â‰¤n, we have zr Ì¸= zs. Indeed, if we had zr = zs, then we would have
zsâˆ’r = 1, with 1 â‰¤s âˆ’r < n; but this would contradict the assumed minimality
of n. It follows from this claim that z, z2, . . . , zn are pairwise distinct n-th roots
of unity, so that {zj; j âˆˆN} = Un(C). Then, z is primitive.
âŠ“âŠ”
In the sequel, we show that primitive roots of unity provide another way to
establish the multiplicative character of the Euler function. To this end, we need
a preliminary result which is interesting in itself.
Theorem 13.25 Let z and w be primitive roots of unity, of orders m and n,
respectively. If gcd(m, n) = 1, then zw is a primitive root of unity of order mn.
Proof Since zm = wn = 1, we have (zw)mn = (zm)n(wn)m = 1, so that zw âˆˆ
Umn(C). Now, take l âˆˆN such that (zw)l = 1. Then,
zl = (wâˆ’1)l âˆˆUm(C) âˆ©Un(C) = {1},
where we used Proposition 13.22 in the last passage above. Therefore, zl
=
(wâˆ’1)l = 1.
Now, the previous theorem, together with the fact that z and wâˆ’1 = wnâˆ’1 are
primitive roots of unity of orders m and n, respectively, guarantees that l | m and
l | n. However, since gcd(m, n) = 1, item (e) of Proposition 6.22 gives mn | l.
Hence, l â‰¥mn, so that the equivalences of the previous theorem imply that zw is a
primitive root of unity of order mn.
âŠ“âŠ”
For our ï¬nal result, we let Un(C)Ã— denote the subset of Un(C) formed by the
primitive roots of unity of order n:
Un(C)Ã— = {Ï‰k
n; 1 â‰¤k â‰¤n and gcd(k, n) = 1}.

344
13
Complex Numbers
Theorem 13.26 If m and n are relatively prime natural numbers, then the map
Um(C)Ã— Ã— Un(C)Ã— âˆ’â†’Umn(C)Ã—
(z, w)
âˆ’â†’
zw
is a well deï¬ned bijection. In particular, Ï•(mn) = Ï•(m)Ï•(n), where Ï• : N â†’N
stands for the Euler function.
Proof The well deï¬niteness of the given map follows immediately from the
previous result. On the other hand, if we show that it is a bijection, then two
applications of the last part of Theorem 13.24 will furnish
Ï•(mn) =
		Umn(C)Ã—		 =
		Um(C)Ã— Ã— Un(C)Ã—		
=
		Um(C)Ã—		 Â·
		Un(C)Ã—		 = Ï•(m)Ï•(n).
We now show what is left, in two steps:
(i) The map is injective: take z1, z2 âˆˆUm(C)Ã— and w1, w2 âˆˆUn(C)Ã— such that
z1w1 = z2w2. Since gcd(m, n) = 1, we have
zâˆ’1
2 z1 = w2wâˆ’1
1
âˆˆUm(C) âˆ©Un(C) = {1}.
Therefore, zâˆ’1
2 z1 = w2wâˆ’1
1
= 1, which is the same as z1 = z2 and w1 = w2.
(ii) The map is surjective: let 1 â‰¤k â‰¤mn be an integer such that gcd(k, mn) = 1.
We wish to ï¬nd nonzero integers x and y such that gcd(x, n) = gcd(y, m) = 1
and, letting z = Ï‰y
m, w = Ï‰x
n, we have zw = Ï‰k
mn (why does this sufï¬ce?). To
this end, we must have
cis 2(mx + ny)Ï€
mn
= cis 2kÏ€
mn ,
which happens if mx+ny = k. However, since gcd(m, n) = 1, Proposition 6.26
assures that such integers x and y do exist.
âŠ“âŠ”
We shall have more to say on the combinatorial and algebraic aspects of roots of
unity in Sects. 14.1 and 20.2, respectively.
Problems: Sect. 13.3
1. Give an example of an inï¬nite set T âŠ‚C satisfying the following conditions:
(a) For each z âˆˆT , there exists n âˆˆN such that zn = 1.
(b) For all z, w âˆˆT , we have zw âˆˆT .

13.3
More on Roots of Unity
345
2. (Croatia) Let n be a given natural number and A be a set of n nonzero
complex numbers having the following property: if any two of its elements (not
necessarily distinct) are multiplied, we obtain another element of it as result. Find
all such possible sets A.
3. * Show that, if n > 2, then the product of the primitive n-th roots of unity is
equal to 1.
4. A rectangle is assembled by using a combination of pieces 1Ã—m or 1Ã—n, where
m and n are given natural numbers.
(a) If d = gcd(m, n), prove that d divides at least one of the dimensions of the
rectangle.
(b) Prove that there exist arbitrarily large rectangles that not necessarily can be
assembled by using only pieces 1 Ã— m or only pieces 1 Ã— n.
5. We cover an 8 Ã— 8 chessboard using twenty two pieces, with twenty one of them
being 1 Ã— 3 rectangles and one being an 1 Ã— 1 square. Find all possible positions
of the 1 Ã— 1 square.
6. Prove the following extension of Klarnerâ€™s theorem: given natural numbers m,
n, p and q such that 1 < q â‰¤min{m, n, p}, we can assemble an m Ã— n Ã— p
parallelepiped by using pieces 1 Ã— 1 Ã— q if and only if q divides m, n or p.
7. We can further generalize Klarnerâ€™s theorem as follows: given m1, . . . , mn âˆˆN,
let
A = Im1 Ã— Â· Â· Â· Ã— Imn,
be the set of all sequences (x1, . . . , xn) of positive integers such that 1 â‰¤xk â‰¤
mk for 1 â‰¤k â‰¤n. A (1, . . . , 1, p)-block in A is a subset of A formed by p
sequences (x11, . . . , x1n), . . . , (xp1, . . . , xpn) satisfying the following condition:
there exists an integer 1 â‰¤k â‰¤n such that:
(a) x1j = x2j = Â· Â· Â· = xpj for every 1 â‰¤j â‰¤n, j Ì¸= k.
(b) (x1k, x2k, . . . , xpk) is a sequence of p consecutive integers.
We say that A can be partitioned into (1, . . . , 1, p)-blocks if A can be written
as the disjoint union of such blocks. Prove that this is possible if and only if p
divides one of the numbers m1, . . . , mn.
8. (Russia) We wish to partition the set of four-digit natural numbers into subsets of
four numbers each, in such a way that the following property is satisï¬ed: the four
number that compose each subset have the same digits in some three decimal
places, whereas, in the fourth place, their digits are consecutive (for instance, a
possibility for the four numbers of a subset could be 1265, 1275, 1285 and 1295).
Prove that there does not exist such a partition.

Chapter 14
Polynomials
From a more algebraic point of view, real polynomial functions can be seen as
polynomials with real coefï¬cients. As we shall see from this chapter on, such a
change of perspective turns out to be quite fruitful, so much that we shall not restrict
ourselves to polynomials with real, or even complex, coefï¬cients; later chapters will
deal with the case of polynomials with coefï¬cients in Zp, for some prime number
p. As a result of such generality, we will be able to prove several results on Number
Theory which would otherwise remain unaccessible. Our purpose in this chapter
is, thus, to start this journey by developing the most elementary algebraic concepts
and results on polynomials. To this end, along all that follows we shall write K to
denote one of Q, R or C, whenever a speciï¬c choice of one of these number sets is
immaterial.
14.1
Basic Deï¬nitions and Properties
In this section we collect the basic deï¬nitions and notations on polynomials which
will be needed to the further developments of the theory.
Deï¬nition 14.1 A sequence (a0, a1, a2, . . .) of elements of K is said to vanish
almost everywhere if there exists an integer n â‰¥âˆ’1 such that
an+1 = an+2 = an+3 = Â· Â· Â· = 0.
In words, the sequence (a0, a1, a2, . . .) vanishes almost everywhere if all of its
terms, from a certain index on, are all equal to zero. For instance, both sequences
(0, 0, 0, 0, 0, 0, . . .) and (1, 2, 3, . . . , n, 0, 0, 0, . . .)
Â© Springer International Publishing AG, part of Springer Nature 2018
A. Caminha Muniz Neto, An Excursion through Elementary Mathematics, Volume III,
Problem Books in Mathematics, https://doi.org/10.1007/978-3-319-77977-5_14
347

348
14
Polynomials
vanish almost everywhere; on the other hand, the sequence (1, 0, 1, 0, 1, . . .), with
1â€™s and 0â€™s indeï¬nitely alternating themselves, obviously does not vanish almost
everywhere.
Deï¬nition 14.2 A polynomial on (or with coefï¬cients in) K is a formal sum
f (X) = a0 + a1X + a2X2 + a3X3 + Â· Â· Â· :=

kâ‰¥0
akXk,
(14.1)
where (a0, a1, a2, . . .) is a sequence of elements of K vanishing almost everywhere
and we make the convention that X0 = 1 and X1 = X in the above sum. Whenever
there is no danger of confusion, we shall simply write f , instead of f (X).
Yet with respect to the above deï¬nition, it is worth noticing that the choice
of X is completely immaterial; in particular, it does not represent a variable, and
could have been substituted by whichever symbol we wanted, say â–¡, for instance.
Also, the correct interpretation of the word formal is that two polynomials f (X) =

kâ‰¥0 akXk and g(X) = 
kâ‰¥0 bkXk on K are equal if and only if ak = bk for
every k â‰¥0.
Given a polynomial f (X) = a0 + a1X + a2X2 + a3X3 + Â· Â· Â· on K, we shall
adopt the following conventions:
i. The elements ai âˆˆK are called the coefï¬cients of f .
ii. If ai = 0, we shall omit the term aiXi whenever convenient. In particular,
since the sequence (a0, a1, a2, . . .) vanishes almost everywhere, there exists an
integer n â‰¥0 such that we can write
f (X) =
n

k=0
akXk.
iii. If ai = Â±1, we shall write Â±Xi in place of (Â±1)Xi, for the corresponding term
of f .
iv. The polynomial 0+0X+0X2+Â· Â· Â· is said to be the identically zero polynomial
on K. We shall also sometimes say that such a polynomial vanishes identically.
Furthermore, whenever there is no danger of confusion with 0 âˆˆK, we shall
write 0 to denote the identically zero polynomial on K.
v. More generally (and in consonance with items ii. and iv.), given Î± âˆˆK we shall
denote the polynomial Î± + 0X + 0X2 + Â· Â· Â· simply by Î±, and say that it is the
constant polynomial Î±. In each case, we shall always rely on the context to
make it clear whether we are referring to the constant polynomial Î± or to the
element Î± âˆˆK.
We let K[X] denote the set of all polynomials on K. In particular, in view of item
v. above, we also make the convention that
K âŠ‚K[X].

14.1
Basic Deï¬nitions and Properties
349
On the other hand, the inclusions Q âŠ‚R âŠ‚C furnish the corresponding inclusions
Q[X] âŠ‚R[X] âŠ‚C[X].
Example 14.3 If f (X) = 1 + X âˆ’X3 +
âˆš
2X7, then f /âˆˆQ[X] (for
âˆš
2 /âˆˆQ) but
f âˆˆR[X]. On the other hand, the formal sum g = 1+X+X2+X3+X4+Â· Â· Â· does
not represent a polynomial, for the sequence (1, 1, 1, . . .) does not vanish almost
everywhere.
In what follows, we shall use the ordinary operations of addition and multiplica-
tion on K to deï¬ne on K[X] operations
âŠ•: K[X] Ã— K[X] â†’K[X] and âŠ™: K[X] Ã— K[X] â†’K[X],
also called addition and multiplication, respectively. To this end, we ï¬rst need the
following auxiliary result.
Lemma 14.4 If (ak)kâ‰¥0 and (bk)kâ‰¥0 are sequences of elements of K that vanish
almost everywhere, then so do the sequences (ak Â± bk)kâ‰¥0 and (ck)kâ‰¥0, where
ck =

i+j=k
i,jâ‰¥0
aibj =
k

i=0
aibkâˆ’i.
Proof We show that the sequence (ck)kâ‰¥0 vanishes almost everywhere, leaving the
other case as an exercise for the reader (cf. Problem 1). Let m, n âˆˆZ+ be such that
ai = 0 for i > n and bj = 0 for j > m. If k > m + n and i + j = k, with i, j â‰¥0,
then either i > n or j > m, for otherwise we would have k = i +j â‰¤n+m, which
is not the case. However, since i > n â‡’ai = 0 and j > m â‡’bj = 0, in any event
we have aibj = 0, so that
ck =

i+j=k
i,jâ‰¥0
aibj = 0.
âŠ“âŠ”
With the previous lemma at our disposal, we can ï¬nally formulate the deï¬nitions
of addition and multiplication for polynomials.
Deï¬nition 14.5 Given in K[X] polynomials
f (X) =

kâ‰¥0
akXk and g(X) =

kâ‰¥0
bkXk,

350
14
Polynomials
the sum and product of f and g, respectively denoted by f âŠ•g and f âŠ™g, are the
polynomials
(f âŠ•g)(X) =

kâ‰¥0
(ak + bk)Xk
and
(f âŠ™g)(X) =

kâ‰¥0
ckXk,
with ck = 
i+j=k
i,jâ‰¥0
aibj.
Even though the deï¬nition of the product of two polynomials may not seen to be
a natural one at a ï¬rst glance, this is not the case. More precisely, the formula for
the coefï¬cient ck of f âŠ™g is the correct one if we wish âŠ™to be distributive with
respect to âŠ•, as well as the usual rule for powers, Xm âŠ™Xn = Xm+n, to be valid.
Indeed, if such properties hold, then computing the product
(a0 + a1X + a2X2 + Â· Â· Â· ) âŠ™(b0 + b1X + b2X2 + Â· Â· Â· )
distributively, we obtain
a0b0 =

i+j=0
i,jâ‰¥0
aibj
for the coefï¬cient of X0,
a0b1 + a1b0 =

i+j=1
i,jâ‰¥0
aibj
for the coefï¬cient of X,
a0b2 + a1b1 + a2b0 =

i+j=2
i,jâ‰¥0
aibj
for the coefï¬cient of X2 and so on.
Actually, it is not difï¬cult to convince ourselves (cf. Problem 4) that, as
deï¬ned, the operations of addition and multiplication of polynomials on K have
the following properties:
i. commutativity: f âŠ•g = g âŠ•f and f âŠ™g = g âŠ™f ;
ii. associativity: (f âŠ•g) âŠ•h = f âŠ•(g âŠ•h) and (f âŠ™g) âŠ™h = f âŠ™(g âŠ™h);
iii. distributivity: f âŠ™(g âŠ•h) = (f âŠ™g) âŠ•(f âŠ™h),
for all f, g, h âˆˆK[X].

14.1
Basic Deï¬nitions and Properties
351
Example 14.6 Consider the polynomials with real coefï¬cients f (X) = 1 + X âˆ’
âˆš
2X2 âˆ’4X3 and g(X) = X + X2, where, according to our previous conventions,
we omit terms with vanishing coefï¬cients. Then,
(f âŠ•g)(X) = 1 + 2X + (1 âˆ’
âˆš
2)X2 âˆ’4X3
and
(f âŠ™g)(X) = (1 + X âˆ’
âˆš
2X2 âˆ’4X3) âŠ™(X + X2)
= [1 âŠ™(X + X2)] âŠ•[X âŠ™(X + X2)]âŠ•
âŠ•[âˆ’
âˆš
2X2 âŠ™(X + X2)] âŠ•[âˆ’4X3 âŠ™(X + X2)]
= (X + X2) âŠ•(X2 + X3) âŠ•(âˆ’
âˆš
2X3 âˆ’
âˆš
2X4)âŠ•
âŠ•(âˆ’4X4 âˆ’4X5)
= X + 2X2 + (1 âˆ’
âˆš
2)X3 âˆ’(
âˆš
2 + 4)X4 âˆ’4X5.
Our discussion up to this point makes it clear that we can relax notations,
henceforth writing simply + and Â· to denote the operations of addition and
multiplication of polynomials. Thus, whenever we add two polynomials, the reader
must be aware of the fact that the involved + signs stand for two distinct operations:
addition of elements of K, performed on the coefï¬cients of the polynomials, and
addition of elements of K[X]. Nevertheless, this will cause no confusion, for the
context will always make it clear which operation the + sign refers to. Moreover, an
analogous comment holds for the Â· sign and the two operations of multiplication.
Remark 14.7 All of the above deï¬nitions and remarks can be extended, in an
obvious way, to polynomials with integer coefï¬cients. From now on, whenever
necessary, we shall denote the set of such polynomials by Z[X].
Letting 0 be the identically vanishing polynomial, we have f + 0 = 0 + f = 0
for every f âˆˆK[X], i.e, 0 is the identity for addition of polynomials. On the
other hand, given f âˆˆK[X], there exists a single g âˆˆK[X] for which f + g =
g + f = 0; indeed, letting f (X) = a0 + a1X + a2X2 + Â· Â· Â· , it is immediate that
g(X) = âˆ’a0 âˆ’a1X âˆ’a2X2 âˆ’Â· Â· Â· is such polynomial, which will henceforth be
denoted by âˆ’f . Thus,
(âˆ’f )(X) = âˆ’a0 âˆ’a1X âˆ’a2X2 âˆ’Â· Â· Â·
and, for f, g âˆˆK[X], we can deï¬ne the difference f âˆ’g between f and g by
f âˆ’g = f + (âˆ’g).

352
14
Polynomials
For Î± âˆˆK and g(X) = b0 +b1X +b2X2 +Â· Â· Â· âˆˆK[X], it is immediate to verify
that
Î± Â· g = Î±b0 + Î±b1X + Î±b2X2 + Â· Â· Â· ;
in particular, we have 1 Â· g = g for every g âˆˆK[X], so that the constant polynomial
1 is the identity for multiplication of polynomials.
From now on, whenever there is no danger of confusion, we shall write simply
fg, instead of f Â· g, to denote the product of f, g âˆˆK[X]. In particular, if Î± âˆˆK,
then Î±f will stand for the product of Î±, seen as a constant polynomial, and f .
The coming deï¬nition will play a major role along the rest of the book.
Deï¬nition 14.8 Given f (X) = a0 +a1X +Â· Â· Â· +anXn âˆˆK[X] \ {0}, with an Ì¸= 0,
the nonnegative integer n is said to be the degree of f , and we will write âˆ‚f = n
to denote this.
According to the above deï¬nition, the notion of degree only applies to nonva-
nishing polynomials. On the other hand, âˆ‚f = 0 for every constant polynomial
f (X) = Î±, with Î± âˆˆK \ {0}. From now on, whenever we refer to f âˆˆK[X] \ {0}
by writing
f (X) = anXn + Â· Â· Â· + a1X + a0,
unless explicitly stated otherwise we shall tacitly assume that an Ì¸= 0. In such a
case, an will be called the leading coefï¬cient of f . Also, f âˆˆK[X] \ {0} is said to
be monic if it has leading coefï¬cient equal to 1. Finally, in the above notations a0 is
said to be the constant term of f .
The coming proposition establishes two very important properties of the notion
of degree of polynomials.
Proposition 14.9 For f, g âˆˆK[X] \ {0}, we have:
(a) âˆ‚(f + g) â‰¤max{âˆ‚f, âˆ‚g} if f + g Ì¸= 0.
(b) fg Ì¸= 0 and âˆ‚(fg) = âˆ‚f + âˆ‚g.
Proof Let âˆ‚f = n and âˆ‚g = m, with
f (X) = a0 + a1X + Â· Â· Â· + anXn and g(X) = b0 + b1X + Â· Â· Â· + bmXm.
(a) If m Ì¸= n, we can assume, without any loss of generality, that m > n. Then
(f + g)(X) = (a0 + b0) + Â· Â· Â· + (an + bn)Xn + bn+1Xn+1 + Â· Â· Â· + bmXm,
so that âˆ‚(f + g) = m = max{âˆ‚f, âˆ‚g}. If m = n but f + g Ì¸= 0, then
(f + g)(X) = (a0 + b0) + Â· Â· Â· + (an + bn)Xn,

14.1
Basic Deï¬nitions and Properties
353
and there are two possibilities: an + bn = 0 or an + bn Ì¸= 0. In the ï¬rst case,
âˆ‚(f + g) < n = max{âˆ‚f, âˆ‚g}. In the second, âˆ‚(f + g) = n = max{âˆ‚f, âˆ‚g}. In
any case, we have âˆ‚(f + g) â‰¤max{âˆ‚f, âˆ‚g}.
(b) Let fg = c0 + c1X + c2X2 + Â· Â· Â· . If k > m + n, we saw in the proof of
Lemma 14.4 that ck = 0. Hence, if we show that cm+n Ì¸= 0, we will conclude
that fg Ì¸= 0 and âˆ‚(fg) = m+n = âˆ‚f +âˆ‚g. For what is left to do, since ai = 0
for i > n and bj = 0 for j > m, it is immediate that
cm+n =

i+j=m+n
i,jâ‰¥0
aibj = anbm Ì¸= 0.
âŠ“âŠ”
In spite of the fact that the material developed so far is rather elementary, it is
enough to present yet another use of roots of unity as tags (cf. Sect. 13.3). To this
end, given f (X) = anXn + Â· Â· Â· + a1X + a0 âˆˆC[X] and z âˆˆC, it is convenient that
we write f (z) to denote the complex number
f (z) = anzn + Â· Â· Â· + a1z + a0.
(14.2)
(We shall have more to say on this substitution of X by z in Sect. 15.1â€”cf.
Deï¬nition 15.1.)
Formula (14.3) below is known in mathematical literature as the multisection
formula.
Theorem 14.10 For f âˆˆC[X] \ {0}, let ak denote the coefï¬cient of Xk in f . If n is
a natural number, Ï‰ = cis 2Ï€
n and z âˆˆC, then

n|k
akzk = 1
n(f (z) + f (Ï‰z) + Â· Â· Â· + f (Ï‰nâˆ’1z)).
(14.3)
Proof Since f (X) = 
kâ‰¥0 akXk, we have
nâˆ’1

j=0
f (Ï‰jz) =
nâˆ’1

j=0

kâ‰¥0
akÏ‰jkzk =

kâ‰¥0
nâˆ’1

j=0
akÏ‰jkzk
=

kâ‰¥0

akzk
nâˆ’1

j=0
Ï‰jk
.
(14.4)
Now, note that if n | k then Ï‰jk = 1 for every j âˆˆZ, so that nâˆ’1
j=0 Ï‰jk = n. On
the other hand, if n âˆ¤k, then Ï‰k Ì¸= 1 and, hence,
nâˆ’1

j=0
Ï‰jk = 1 + Ï‰k + Â· Â· Â· + Ï‰(nâˆ’1)k = Ï‰nk âˆ’1
Ï‰k âˆ’1 = 0.

354
14
Polynomials
Therefore, (14.4) reduces to
nâˆ’1

j=0
f (Ï‰jz) =

n|k
nakzk.
âŠ“âŠ”
The coming example relies on the fact that, given a, b âˆˆK, the binomial formula
can be used to expand (aX + b)n âˆˆK[X] in monomials. The reader is invited to
check this.
Example 14.11 (Poland) For each n âˆˆN, compute, in terms of n, the value of the
sum

3|k
n
k

.
Solution Let
f (X) = (X + 1)n =
n

k=0
n
k

Xk.
If Ï‰ = cis 2Ï€
3 , then Ï‰ is a cubic root of unity and 1 + Ï‰ + Ï‰2 = 0. By applying the
multisection formula to f , we get

3|k
n
k

= 1
3

f (1) + f (Ï‰) + f (Ï‰2)

= 1
3

2n + (Ï‰ + 1)n + (Ï‰2 + 1)n
= 1
3

2n + (âˆ’Ï‰2)n + (âˆ’Ï‰)n
= 1
3

2n + (âˆ’1)n(Ï‰2n + Ï‰n)

.
Now, note that if 3 | n, then Ï‰n = 1 and, hence, Ï‰2n + Ï‰n = 2; if 3 âˆ¤n, then
Ï‰n = Ï‰ or Ï‰2, so that Ï‰2n + Ï‰n = Ï‰2 + Ï‰ = âˆ’1. Therefore,

3|k
n
k

=
 (2n + 2(âˆ’1)n)/3, if 3 | n
(2n + (âˆ’1)n+1)/3, if 3 âˆ¤n .
âŠ“âŠ”

14.1
Basic Deï¬nitions and Properties
355
Problems: Sect. 14.1
1. * If (ak)kâ‰¥0 and (bk)kâ‰¥0 are almost everywhere vanishing sequences of
elements of K, show that the sequences (ak Â± bk)kâ‰¥0 also vanish almost
everywhere.
2. * Given n âˆˆN and a âˆˆK, perform the following products of polynomials:
(a) (X âˆ’a)(Xnâˆ’1 + aXnâˆ’2 + Â· Â· Â· + anâˆ’2X + anâˆ’1).
(b) (X + a)(Xnâˆ’1 âˆ’aXnâˆ’2 + Â· Â· Â· âˆ’anâˆ’2X + anâˆ’1), if n is odd.
(c) (X + 1)(X2 + 1)(X4 + 1) . . . (X2n + 1).
3. Compute the coefï¬cient of Xp on both sides of (X+1)m(X+1)n = (X+1)m+n
to give another proof of Vandermondeâ€™s identity1 (cf. Problem 3, page 48):

k
m
k

n
p âˆ’k

=
m + n
p

,
with the sum at the left hand side above ranging through all possible nonnega-
tive integer values of k.
4. * Show that the operations of addition and multiplication of polynomials are
commutative and associative, and that multiplication is distributive with respect
to addition.
5. * Show that K[X] does not possess any zero divisors. More precisely, show that
if f, g âˆˆK[X] are such that fg = 0, then f = 0 or g = 0.
6. (TT) Find at least one polynomial f , of degree 2001, such that f (X) + f (1 âˆ’
X) = 1.
7. Let n âˆˆN and, for 0 â‰¤k â‰¤2n, let ak be the coefï¬cient of Xk in the expansion
of f (X) = (1 + X + X2)n. Compute, in terms of n, the value of the sum
a3 + a6 + a9 + Â· Â· Â· .
8. * Generalize the multisection formula in the following way2: given f âˆˆC[X]\
{0}, a natural number n > 1 and an integer 0 â‰¤r â‰¤n âˆ’1, if Ï‰ = cis 2Ï€
n and
z âˆˆC, then

kâ‰¡r (mod n)
akzk = 1
n
nâˆ’1

j=0
Ï‰âˆ’rjf (Ï‰jz),
where ak denotes the coefï¬cient of Xk in f .
1Alexandre-TheÃ³phile Vandermonde, French mathematician of the eighteenth century.
2For another proof of this result, see Example 18.7.

356
14
Polynomials
9. Compute, as a function of m âˆˆN, the value of the sum
m
1

+ 4
m
5

+ 16
m
9

+ 64
m
13

+ Â· Â· Â· .
For the coming problem, given f (X) = anXn+anâˆ’1Xnâˆ’1+Â· Â· Â·+a1X+a0 âˆˆ
K[X] and m âˆˆN, we write f (Xm) to denote the polynomial in K[X] deï¬ned
by
anXmn + anâˆ’1Xm(nâˆ’1) + Â· Â· Â· + a1Xm + a0,
i.e., obtained by writing Xm in place of X in the expression of f .
10. (MiklÃ³s-Schweitzer) A polynomial with real coefï¬cients is called positively
reducible if it can be written as the product of two nonconstant polynomials
whose nonvanishing coefï¬cients are positive. Let f âˆˆR[X] have nonvanishing
constant term. If f (Xm) is positively reducible for some natural number m,
prove that f itself is positively reducible.
14.2
The Division Algorithm
We have already seen that it is possible to add, subtract and multiply polynomials,
the result being another polynomial. And what about the possibility of dividing one
polynomial for another? Well, it will not always be possible to do so; in other words,
given polynomials f, g âˆˆK[X] \ {0}, there will not always exist h âˆˆK[X] such
that f = gh; for instance, if âˆ‚f < âˆ‚g, then such a polynomial h does not exist, for
otherwise we would have
âˆ‚f = âˆ‚(gh) = âˆ‚g + âˆ‚h â‰¥âˆ‚g,
which is an absurd.
In spite of the above discussion, the following analogue of the division algorithm
for integers, called the division algorithm for polynomials, still holds.
Theorem 14.12 If f, g âˆˆK[X], with g Ì¸= 0, then there exist unique q, r âˆˆK[X]
such that
f = gq + r, with r = 0 or âˆ‚r < âˆ‚g.
(14.5)
Proof Let us ï¬rst show that there exists at most one pair of polynomials q, r âˆˆK[X]
satisfying the stated conditions. To this end, let q1, q2, r1, r2 âˆˆK[X] be such that
f = gq1 + r1 = gq2 + r2,

14.2
The Division Algorithm
357
with ri = 0 or 0 â‰¤âˆ‚ri < âˆ‚g, for i = 1, 2. Then, g(q1âˆ’q2) = r2âˆ’r1 and, if q1 Ì¸= q2,
Problem 5, page 355, would guarantee that r1 Ì¸= r2. However, Proposition 14.9
would then give
âˆ‚g â‰¤âˆ‚g + âˆ‚(q1 âˆ’q2) = âˆ‚(g(q1 âˆ’q2))
= âˆ‚(r1 âˆ’r2) â‰¤max{âˆ‚r1, âˆ‚r2} < âˆ‚g,
which is an absurd. Hence, q1 = q2 and, then, r1 = r2.
Let us now establish the existence of polynomials q and r satisfying the stated
conditions. To this end, we consider two cases separately:
(i) If f = 0, take q = r = 0; if g is (a nonzero) constant, say c, take q = câˆ’1f
and r = 0.
(ii) If f Ì¸= 0 and g is nonconstant, we shall make induction on âˆ‚f â‰¥0.
As initial case, if âˆ‚f < âˆ‚g (such an f does exist, for âˆ‚g â‰¥1), take q = 0 and
r = f . By induction hypothesis, let m â‰¥âˆ‚g be an integer and assume that the
existence of q and r has been established for any polynomial of degree less than m
in place of f . In order to establish the induction step, take f âˆˆK[X] \ {0} of degree
m, and let b Ì¸= 0 denote the leading coefï¬cient and n the degree of g. If a stands for
the leading coefï¬cient of f , there are two distinct possibilities:
â€¢
f (X) = abâˆ’1Xmâˆ’ng(X): in this case, q(X) = abâˆ’1Xmâˆ’n and r(X) = 0.
â€¢
f (X) Ì¸= abâˆ’1Xmâˆ’ng(X): letting h(X) = f (X) âˆ’abâˆ’1Xmâˆ’ng(X), we have
h Ì¸= 0 and
h(X) = (aXm + Â· Â· Â· ) âˆ’abâˆ’1Xmâˆ’n(bXn + Â· Â· Â· ),
so that âˆ‚h < m. Therefore, by induction hypothesis, there exists q1, r1 âˆˆK[X]
such that h = gq1 + r1, with r1 = 0 or âˆ‚r1 < âˆ‚g. Thus,
f (X) = h(X) + abâˆ’1Xmâˆ’ng(X)
= g(X)q1(X) + r1(X) + abâˆ’1Xmâˆ’ng(X)
= g(X)(q1(X) + abâˆ’1Xmâˆ’n) + r1(X),
and it sufï¬ces to take q(X) = q1(X) + abâˆ’1Xmâˆ’n and r(X) = r1(X).
âŠ“âŠ”
In the notations of the division algorithm for polynomials (and by analogy with
the division algorithm for integers), we say that q is the quotient and r is the
remainder of the division of f by g. Moreover, when r = 0 we say that f is
divisible by g, or that g divides f ; in this case, as with integers we denote g | f .
Remark 14.13 As the reader can easily verify by checking the previous proof,
the division algorithm still holds for polynomials in Z[X], provided the leading

358
14
Polynomials
coefï¬cient of g is equal to Â±1. More precisely, if f, g âˆˆZ[X], with g Ì¸= 0 having
leading coefï¬cient equal to Â±1, then there exists unique polynomials q, r âˆˆZ[X]
such that
f = gq + r, with r = 0 or âˆ‚r < âˆ‚g.
In all that follows, we shall use this without further comments.
In spite of the name division algorithm, the existence part of the presented proof
for Theorem 14.12 is actually not algorithmic, i.e., it does not provide an actual
algorithm for ï¬nding q and r out of f and g. In order to remedy this, we now revisit
the existence part of the proof in a more algorithmic way:
Division Algorithm for Polynomials
1. DO
â€¢
r â†f ; m â†âˆ‚f ; q â†0;
â€¢
a â†LEADING COEFFICIENT OF r;
2. WHILE r Ì¸= 0 OR âˆ‚r â‰¥âˆ‚g DO
â€¢
r(X) â†r(X) âˆ’abâˆ’1Xmâˆ’ng(X);
â€¢
q(X) â†q(X) + abâˆ’1Xmâˆ’n;
â€¢
m â†âˆ‚r
â€¢
a â†LEADING COEFFICIENT OF r;
3. READ THE FINAL VALUES OF r AND q.
Let us prove that the above algorithm does stop after a ï¬nite number of repetitions
of the loop WHILE and give us, at the end, polynomials q and r as wished.
If r Ì¸= 0 or âˆ‚r â‰¥âˆ‚g, then the instruction of the WHILE loop substitutes r(X) by
the polynomial r(X) âˆ’abâˆ’1Xmâˆ’ng(X). Such a polynomial, if it is not identically
zero, has degree less than that of r, for the polynomial abâˆ’1Xmâˆ’ng(X) has degree m
(which is precisely the degree of r immediately before the execution of the loop) and
leading coefï¬cient a (which is the leading coefï¬cient of r right before the execution
of the loop). Thus, the algorithm stops after a ï¬nite number of steps.
After the ï¬rst attribution, we have
f (X) = g(X)q(X) + r(X),
for, at the beginning, q(X) = 0 and r(X) = f (X). Assume, by induction
hypothesis, that after a certain execution of the WHILE loop we have f (X) =
g(X)q(X) + r(X) and that, at this moment, r(X) Ì¸= 0 and âˆ‚r â‰¥âˆ‚g. Then, the
next step does take place and replaces r(X) by r(X) âˆ’abâˆ’1Xmâˆ’ng(X), and q(X)
by q(X) + abâˆ’1Xmâˆ’n. Now, since
g(X)

q(X) + abâˆ’1Xmâˆ’n
+

r(X) âˆ’abâˆ’1Xmâˆ’ng(X)

(14.6)

14.2
The Division Algorithm
359
equals g(X)q(X) + r(X), it follows from induction hypothesis that, after such
additional execution, we will also have (14.6) equal to f (X).
Example 14.14 Follow the algorithm presented above to obtain the quotient and the
remainder upon dividing f (X) = X4 âˆ’2X2 +5X +7 by g(X) = 3X2 +1 in Q[X].
Solution Following the notations of the previous discussion, we start by storing
b = 3 and n = 2. Then, we have the following steps:
1. We make the attributions r(X) = X4 âˆ’2X2 +5X +7; m = 4; q(X) = 0; a = 1.
2. Since neither r(X) = 0 nor m = 4 < n = 2, we substitute r(X) by
r(X) âˆ’abâˆ’1Xmâˆ’ng(X) =
= X4 âˆ’2X2 + 5X + 7 âˆ’1
3X4âˆ’2(3X2 + 1)
= âˆ’7
3X2 + 5X + 7,
m by 2, q(X) by
q(X) + abâˆ’1Xmâˆ’n = 0 + 1
3X4âˆ’2 = 1
3X2
and a by âˆ’7
3.
3. Since we still do not have r(X) = 0 or m = 2 < n = 2, we replace r(X) by
r(X) âˆ’abâˆ’1Xmâˆ’ng(X) =
= âˆ’7
3X2 + 5X + 7 + 7/3
3 X2âˆ’2(3X2 + 1)
= 5X + 70
9 ,
m by 1, q(X) by
q(X) + abâˆ’1Xmâˆ’n = 1
3X2 + âˆ’7/3
3
X2âˆ’2 = 1
3X2 âˆ’7
9
and a by 1
3.
4. Now, although r(X) Ì¸= 0, we have m = 1 < n = 2, so that we do not return to
the beginning of the loop. Instead, we simply read
r(X) = 5X + 70
9
and q(X) = 1
3X2 âˆ’7
9.
âŠ“âŠ”

360
14
Polynomials
The table below looks at the solution of the previous example schematically. In
order to help the reader in grasping how steps 1. to 4. actually took place, we suggest
that he/she tries to identify each of those steps within the table.
Division Algorithm for Polynomials
X4
âˆ’2X2 +5X
+7 3X2 + 1
âˆ’X4 âˆ’1/3X2
1/3X2
âˆ’7/3X2 +5X
+7 1/3X2 âˆ’7/9
7/3X2
+7/9
5X +70/9
In the coming example, given f (X) = anXn+Â· Â· Â·+a1X+a0 âˆˆK[X] and z âˆˆK,
we stick to the convention set in (14.2), of writing f (Î±) to denote the element
f (Î±) = anÎ±n + Â· Â· Â· + a1Î± + a0 âˆˆK.
As already quoted there, we refer to Sect. 15.1 for more on such substitution of X
by Î±.
Example 14.15 Given f (X) = anXn + Â· Â· Â· + a1X + a0 âˆˆK[X] and Î± âˆˆK, show
that the remainder upon division of f (X) by X âˆ’Î± is precisely f (Î±).
Proof We want to show that there exists q âˆˆK[X] such that
f (X) = (X âˆ’Î±)q(X) + f (Î±).
Since this is the same as having f (X) âˆ’f (Î±) = (X âˆ’Î±)q(X), we only need to
show that X âˆ’Î± divides f (X) âˆ’f (Î±). We do this by invoking the result of item (a)
of Problem 2, page 355, according to which
Xk âˆ’Î±k = (X âˆ’Î±)(Xkâˆ’1 + Î±Xkâˆ’2 + Â· Â· Â· + Î±kâˆ’2X + Î±kâˆ’1),
for every k âˆˆN. Thus,
f (X) âˆ’f (Î±) =
n

k=0
akXk âˆ’
n

k=0
akÎ±k =
n

k=0
ak(Xk âˆ’Î±k)
=
n

k=0
ak(X âˆ’Î±)(Xkâˆ’1 + Î±Xkâˆ’2 + Â· Â· Â· + Î±kâˆ’2X + Î±kâˆ’1)
= (X âˆ’Î±)
n

k=0
ak(Xkâˆ’1 + Î±Xkâˆ’2 + Â· Â· Â· + Î±kâˆ’2X + Î±kâˆ’1).
âŠ“âŠ”

14.2
The Division Algorithm
361
Problems: Sect. 14.2
1. Given n âˆˆN, ï¬nd the remainder upon division of (X2 + X + 1)n by X2 âˆ’X + 1.
2. We are given natural numbers m and n, such that n is a divisor of m. Find the
remainder upon division of Xm + 1 by Xn âˆ’1.
3. Given natural numbers m and n, with m > n, ï¬nd the remainder of the division
of X2m + 1 by X2n + 1.
4. Let a, b âˆˆK be given, with a Ì¸= 0. For f âˆˆK[X] \ {0}, prove that the remainder
of the division of f by aX + b is equal to f

âˆ’b
a

.
5. Upon dividing f âˆˆQ[X] by X + 2, we obtain âˆ’1 as remainder; upon dividing it
by X âˆ’2, the remainder is 3. Find the remainder of the division of f by X2 âˆ’4.
6. A polynomial f âˆˆR[X] leaves remainders 4 when divided by X +1 and 2X +3
when divided by X2+1. Find the remainder of the division of f by (X+1)(X2+
1).
7. Let m and n be given natural numbers such that m = nq + r, with q, r âˆˆZ and
0 â‰¤r < n. Find the quotient and the remainder upon dividing Xm +1 by Xn +1.

Chapter 15
Roots of Polynomials
In all we have done so far concerning polynomials, at no moment we had any intent
of substituting X by an element of K. Even in Theorem 14.10 and Example 14.15,
the notation f (z), used to denote the complex number obtained by formally
substituting X by z in the expression of f âˆˆC[X], was a mere convention. This
is no surprise, for we are looking at polynomials as formal expressions, rather than
as functions. In this sense, the indeterminate X is a symbol with no arithmetic
meaning, and we have even stressed before that we could have used the symbol â–¡,
instead.
We remedy this state of things in this chapter, where we introduce the concept
of polynomial function associated to a polynomial, as well as that of root of
a polynomial. Among the various important results presented, we highlight the
presentation of a complete proof of the Fundamental Theorem of Algebra, as well
as the searching criterion for rational roots of polynomials with integer coefï¬cients,
along with several interesting applications.
15.1
Roots of Polynomials
In order to proceed with our study of polynomials, it is convenient to consider the
polynomial function associated to a polynomial, according to the following
Deï¬nition 15.1 For f (X) = anXn + Â· Â· Â· + a1X + a0 âˆˆK[X], the polynomial
function associated to f is the function Ëœf : K â†’K, given for x âˆˆK by
Ëœf (x) = anxn + Â· Â· Â· + a1x + a0.
Â© Springer International Publishing AG, part of Springer Nature 2018
A. Caminha Muniz Neto, An Excursion through Elementary Mathematics, Volume III,
Problem Books in Mathematics, https://doi.org/10.1007/978-3-319-77977-5_15
363

364
15
Roots of Polynomials
When f (X) = c, note that the associated polynomial function Ëœf will be the constant
function Ëœf (x) = c for every x âˆˆK, thus justifying the nomenclature constant
attributed to a polynomial which is either identically zero or of degree zero.
Deï¬nition 15.2 Let f âˆˆK[X] be a given polynomial, with associated polynomial
function Ëœf : K â†’K. An element Î± âˆˆK is a root of f if Ëœf (Î±) = 0.
For instance, if f (X) = X2 + 1 âˆˆC[X], it is easy to see that z = Â±i are the
only roots of f in C. Indeed, the polynomial function associated to f is
Ëœf : C âˆ’â†’C
z âˆ’â†’z2 + 1 ,
so that
Ëœf (z) = 0 â‡”z2 = âˆ’1 â‡”z = Â±i.
The coming proposition is known as the root test. Note that item (a) revisits
Example 14.15 in a slightly different way.
Proposition 15.3 If f âˆˆK[X] \ {0} and Î± âˆˆK, then:
(a) Î± is a root of f if and only if (X âˆ’Î±) | f (X) in K[X].
(b) If Î± is a root of f , then there exists a greatest natural number m such that
(Xâˆ’Î±)m divides f . Moreover, writing f (X) = (Xâˆ’Î±)mq(X), with q âˆˆK[X],
one has Ëœq(Î±) Ì¸= 0, where Ëœq : K â†’K stands for the polynomial function
associated to q.
(c) If Î±1, . . . , Î±k âˆˆK are pairwise distinct roots of f , then f (X) is divisible by
(X âˆ’Î±1) . . . (X âˆ’Î±k) in K[X].
Proof
(a) The division algorithm assures the existence of polynomials q, r âˆˆK[X] such
that
f (X) = (X âˆ’Î±)q(X) + r(X),
with r = 0 or 0 â‰¤âˆ‚r < âˆ‚(Xâˆ’Î±) = 1. Hence, r(X) = c, a constant polynomial.
On the other hand, letting Ëœf and Ëœq be the polynomial functions respectively
associated to f and q, it follows from the equality above that
Ëœf (Î±) = (Î± âˆ’Î±)Ëœq(Î±) + c = c,

15.1
Roots of Polynomials
365
i.e., f (X) = (X âˆ’Î±)q(X) + Ëœf (Î±). Thus,
Î± is a root of f â‡”Ëœf (Î±) = 0 â‡”f (X) = (X âˆ’Î±)q(X).
(b) If m > âˆ‚f , then (X âˆ’Î±)m âˆ¤f (X), for âˆ‚(X âˆ’Î±)m = m > âˆ‚f . Therefore, item
(a) guarantees the existence of a greatest positive integer m for which (Xâˆ’Î±)m |
f (X), say f (X) = (X âˆ’Î±)mq(X), with q âˆˆK[X]. In the level of polynomial
functions, we thus obtain
Ëœf (x) = (x âˆ’Î±)m Ëœq(x), âˆ€x âˆˆK.
Now, if Ëœq(Î±) = 0, it would follow from (a) that q(X) = (X âˆ’Î±)q1(X), for
some q1 âˆˆK[X]. However, we would then have
f (X) = (X âˆ’Î±)m+1q1(X),
a contradiction to the maximality of m.
(c) For the sake of simplicity, let us establish the result of this item for k = 2 (the
proof in the general case following by a straightforward inductive argument).
Since Î±1 is a root of f , item (a) once more assures the existence of g âˆˆK[X]
such that f (X) = (X âˆ’Î±1)g(X). Let Ëœg denote the corresponding polynomial
function. Since Î±1 Ì¸= Î±2 and Î±2 is also a root of f , the last equality above gives
0 = Ëœf (Î±2) = (Î±2 âˆ’Î±1) Ëœg(Î±2),
so that Î±2 is also a root of g. Thus, by applying (a) yet another time, we conclude
that there exists h âˆˆK[X] for which g(X) = (X âˆ’Î±2)h(X). In turn, this gives
f (X) = (X âˆ’Î±1)(X âˆ’Î±2)h(X).
âŠ“âŠ”
The coming example is an interesting application of the root test.
Example 15.4 (Soviet Union) Label the rows and columns of an n Ã— n chessboard
from 1 to n, respectively from top to bottom and from left to right. Given 2n real
numbers a1, . . . , an, b1, . . . , bn, with b1, . . . , bn being pairwise distinct, write ai +bj
inside the unit square situated in row i and column j, for 1 â‰¤i, j â‰¤n. If the
products of the numbers written in the unit squares of each column of the chessboard
are all equal, prove that the products of the numbers written in the unit squares of
each row are all equal too.

366
15
Roots of Polynomials
Proof Consider the polynomial
f (X) = (X + a1)(X + a2) . . . (X + an) âˆˆR[X].
Letting Ëœf be the polynomial function associated to f , it follows from the statement
of the problem the existence of Î± âˆˆR such that Ëœf (b1) = Ëœf (b2) = . . . = Ëœf (bn) = Î±.
Then, Ëœf (bi) âˆ’Î± = 0 for 1 â‰¤i â‰¤n and, since b1, . . . , bn are pairwise distinct, item
(c) of the root test gives
f (X) âˆ’Î± = (X âˆ’b1)(X âˆ’b2) . . . (X âˆ’bn)
(note that both f (X) âˆ’Î± and the polynomial at the right hand side of the equality
above are monic and have degree n). Hence,
âˆ’Î± = f (âˆ’ai) âˆ’Î± = (âˆ’1)n(ai + b1)(ai + b2) . . . (ai + bn),
and this is the same as saying that the products of the numbers written in the unit
squares of each row are all equal to (âˆ’1)nâˆ’1Î±.
âŠ“âŠ”
As a consequence of the root test, we now describe a rather simple algorithm for
ï¬nding the quotient of the division of a monic polynomial f âˆˆK[X] by Xâˆ’Î±, with
Î± âˆˆK being a root of f . Such an algorithm is known in mathematical literature as
the Horner-Ruï¬nni algorithm,1 and is based on the following homonymous result.
Proposition 15.5 (Horner-Ruï¬nni) Let
f (X) = Xn + anâˆ’1Xnâˆ’1 + Â· Â· Â· + a1X + a0
be a monic polynomial on K. If Î± âˆˆK is a root of f and
g(X) = Xnâˆ’1 + bnâˆ’2Xnâˆ’2 + Â· Â· Â· + b0 âˆˆK[X]
is the quotient upon dividing f (X) by X âˆ’Î±, then
â§
âªâªâªâªâªâªâªâ¨
âªâªâªâªâªâªâªâ©
bnâˆ’2
= Î± + anâˆ’1
bnâˆ’3
= Î±bnâˆ’2 + anâˆ’2
Â· Â· Â·
Â· Â· Â·
bnâˆ’iâˆ’1 = Î±bnâˆ’i + anâˆ’i
Â· Â· Â·
Â· Â· Â·
b0
= Î±b1 + a1
.
(15.1)
1Paolo Rufï¬ni, Italian mathematician, and William G. Horner, English mathematician, both of the
eighteenth and nineteenth centuries.

15.1
Roots of Polynomials
367
Proof By the sake of notational convenience, let bnâˆ’1 = 1. Firstly, note that
f (X) = (X âˆ’Î±)g(X)
= (X âˆ’Î±)
nâˆ’1

i=0
bnâˆ’1âˆ’iXnâˆ’1âˆ’i
=
nâˆ’1

i=0
bnâˆ’1âˆ’iXnâˆ’i âˆ’
nâˆ’1

i=0
Î±bnâˆ’1âˆ’iXnâˆ’1âˆ’i
= bnâˆ’1Xn +
nâˆ’1

i=1
bnâˆ’1âˆ’iXnâˆ’i âˆ’
nâˆ’2

i=0
Î±bnâˆ’1âˆ’iXnâˆ’1âˆ’i âˆ’Î±b0
= Xn +
nâˆ’1

i=1
bnâˆ’1âˆ’iXnâˆ’i âˆ’
nâˆ’1

i=1
Î±bnâˆ’iXnâˆ’i âˆ’Î±b0
= Xn +
nâˆ’1

i=1
(bnâˆ’1âˆ’i âˆ’Î±bnâˆ’i)Xnâˆ’i âˆ’Î±b0.
By comparing the last expression for f with that in the statement of the
proposition, we conclude that
bnâˆ’1âˆ’i âˆ’Î±bnâˆ’i = anâˆ’i
for 1 â‰¤i â‰¤n âˆ’1. This way, we obtain the linear system of equations
â§
âªâªâªâªâªâªâªâªâªâªâªâ¨
âªâªâªâªâªâªâªâªâªâªâªâ©
bnâˆ’1 = 1
bnâˆ’2 âˆ’Î±bnâˆ’1 = anâˆ’1
bnâˆ’3 âˆ’Î±bnâˆ’2 = anâˆ’2
Â· Â· Â·
Â· Â· Â·
bnâˆ’iâˆ’1 âˆ’Î±bnâˆ’i = anâˆ’i
Â· Â· Â·
Â· Â· Â·
b0 âˆ’Î±b1 = a1
âˆ’Î±b0 = a0.
,
which, in turn, is readily seen to be equivalent to the equalities in (15.1) (note that
the last equation of the system can be neglected, for it only represents the necessary
compatibility condition for Î± to be a root of f ).
âŠ“âŠ”
The table below, which can be seen as the actual execution of Horner-Rufï¬niâ€™s
algorithm, resumes the above discussion. Note that we put all of coefï¬cients of f
but the leading one (which equals 1) along the ï¬rst row; then, in the second row
we successively compute, from left to right, the coefï¬cients of g, starting with the

368
15
Roots of Polynomials
leading coefï¬cient bnâˆ’1 = 1. Note that, starting with bnâˆ’2, each coefï¬cient of g is
equal to the product of the previously computed coefï¬cient (i.e., the one at its left)
by Î±, added to the coefï¬cient of f situated right above this one.
The Horner-Ruï¬nni Algorithm
anâˆ’1
anâˆ’2
anâˆ’3
Â· Â· Â·
a1
a0
bnâˆ’1 = 1 Î± Â· 1 + anâˆ’1



bnâˆ’2
Î± Â· bnâˆ’2 + anâˆ’2



bnâˆ’3
Â· Â· Â· Î± Â· b2 + a2



b1
Î± Â· b1 + a1



b0
The coming example shows the Horner-Rufï¬ni algorithm in action. It also shows
that the algorithm can be used to check whether some given element of K is actually
a root of a given polynomial in K[X].
Example 15.6 Check that
âˆš
2 is a root of f (X) = X5âˆ’5X4+X3âˆ’5X2âˆ’6X+30 âˆˆ
R[X], and use the Horner-Rufï¬ni algorithm to compute the quotient of the division
of f by X âˆ’
âˆš
2.
Solution We begin assembling the numerical table corresponding to Horner-
Ruï¬nniâ€™s algorithm by setting n = 5 and writing a4 = âˆ’5, a3 = 1, a2 = âˆ’5,
a1 = âˆ’6, a0 = 30 along the ï¬rst row:
âˆ’5 1 âˆ’5 âˆ’6 30
Now starting with b4 = 1 in the leftmost entry of second row, we successively
obtain b3 =
âˆš
2 Â· 1 âˆ’5, b2 =
âˆš
2b3 + 1 = 3 âˆ’5
âˆš
2, b1 =
âˆš
2b2 âˆ’5 = âˆ’15 + 3
âˆš
2
and b0 =
âˆš
2b1 âˆ’6 = âˆ’15
âˆš
2:
âˆ’5
1
âˆ’5
âˆ’6
30
1
âˆš
2 Â· 1 âˆ’5 3 âˆ’5
âˆš
2 âˆ’15 + 3
âˆš
2 âˆ’15
âˆš
2
Finally, since âˆ’Î±b0 = âˆ’
âˆš
2(âˆ’15
âˆš
2) = 30 = a0, it follows that
âˆš
2 is actually
a root of f , and the quotient upon dividing f by X âˆ’
âˆš
2 is X4 + (
âˆš
2 âˆ’5)X3 +
(3 âˆ’5
âˆš
2)X2 + (âˆ’15 + 3
âˆš
2)X âˆ’15
âˆš
2.
âŠ“âŠ”
Back to the development of the theory and in the notations of the root test, if
f (X) = (X âˆ’Î±)mq(X), with Ëœq(Î±) Ì¸= 0, we say that m is the multiplicity of Î± as a
root of f . In particular, Î± is a simple root of f if m = 1, and a multiple root of f
if m > 1.
Example 15.7 Let f (X) = X3 âˆ’7X2 + 16X âˆ’12 be a polynomial with real
coefï¬cients. It is immediate to check that f (X) = (X âˆ’2)2(X âˆ’3). Therefore,
2 is a double root, whereas 3 is a simple one.

15.1
Roots of Polynomials
369
Later in this chapter we shall study in detail the problem of ï¬nding whether a
given polynomial f âˆˆK[X] has multiple roots. For the time being, we only need
to know what such a root is. Nevertheless, we shall observe that we already have a
way of deciding whether an element Î± âˆˆK is a multiple root of f âˆˆK[X] \ {0}:
it sufï¬ces to check if f (Î±) = 0 and, if this is so, to divide f (X) by (X âˆ’Î±)2
(which can be done by means of two successive applications of Horner-Ruï¬nniâ€™s
algorithm), verifying whether or not such a division is exact. We shall have more to
say about this in a while.
Another interesting consequence of the division algorithm is the fact, due to
Lagrange, that the number of roots of a nonzero polynomial cannot exceed its
degree. In the coming result, note that we allow multiple roots.
Corollary 15.8 (Lagrange) If f âˆˆK[X] \ {0}, then f has at most âˆ‚f roots in K,
counted according to their multiplicities.
Proof Let us make induction on the degree of f . If âˆ‚f = 0, then there exists c âˆˆ
K \ {0} such that f (X) = c. Hence, the polynomial function Ëœf associated to f is
the constant function x â†’c, so that f has 0 = âˆ‚f roots.
Now, let f be a polynomial of positive degree, and assume that the result is
true for every polynomial in K[X] \ {0} whose degree is less than that of f . If f
has no roots in K, there is nothing left to do. Otherwise, let Î± âˆˆK be a root of
f and (according to the root test) let m be the greatest natural number such that
f (X) = (X âˆ’Î±)mq(X), for some q âˆˆK[X] such that Ëœq(Î±) Ì¸= 0. Since
âˆ‚q = âˆ‚f âˆ’m < âˆ‚f,
the induction hypothesis assures that q has at most âˆ‚q roots in K, counted with their
multiplicities.
In order to ï¬nish the argument, note that if Î² Ì¸= Î± is a root of f , then
0 = Ëœf (Î²) = (Î² âˆ’Î±)m Ëœq(Î²)
and, hence, Î² is a root of q. Therefore, the number of roots of f (with multiplicities)
equals m (the multiplicity of Î±) plus that of q. Thus, the induction hypothesis shows
that f has at most
m + âˆ‚q = âˆ‚f
roots in K.
âŠ“âŠ”
The previous corollary will be frequently used in one of the two forms below.
Corollary 15.9 If f (X) = anXn + Â· Â· Â· + a1X + a0 âˆˆK[X] admits at least n + 1
distinct roots in K, then f vanishes identically, i.e., an = . . . = a0 = 0.

370
15
Roots of Polynomials
Proof If f âˆˆK[X] \ {0}, then the former corollary assures it has at most n roots
in K.
âŠ“âŠ”
Corollary 15.10 Let f (X) = anXn + Â· Â· Â· + a1X + a0 and g(X) = bmXm + Â· Â· Â· +
b1X + b0 be polynomials in K[X], with m â‰¥n. If Ëœf (x) = Ëœg(x) for at least m + 1
distinct values of x âˆˆK, then f = g, i.e, m = n and ai = bi for 0 â‰¤i â‰¤n.
Proof It sufï¬ces to apply the previous corollary to the polynomial f âˆ’g, noticing
that the associated polynomial function is Ëœf âˆ’Ëœg.
âŠ“âŠ”
If FK stands for the set of functions from K to itself, then, since K is inï¬nite, the
last result above guarantees that the mapping
K[X] âˆ’â†’FK
f
âˆ’â†’Ëœf
,
(15.2)
that associates to each f âˆˆK[X] its polynomial function Ëœf âˆˆFK, is injective. In
other words, it says that two polynomials on K will have equal polynomial functions
if they are themselves equal polynomials.2 Indeed, if f, g âˆˆK[X] are such that
Ëœf = Ëœg, then Ëœf (x) = Ëœg(x) for inï¬nitely many values of x, and the previous corollary
assures that f = g.
Thanks to the injectivity of the above map, from now one we shall write f to
denote both an element of K[X] (i.e., a polynomial with coefï¬cients in K) as its
associated polynomial function. In particular, whenever we write f (X), we shall
be referring ourselves to the polynomial f ; whenever we write f (x), we shall be
looking at the element of K, image of x âˆˆK through the polynomial function
associated to f . Moreover, the context will always clear any possible doubts on this
point.
Remark 15.11 Corollary 15.10 assures that, thanks to the fact that K is inï¬nite, the
coefï¬cients of f âˆˆK[X] are completely determined by the values f (x), with x âˆˆ
K. Later, in Chap. 18, we shall study in detail the problem of getting a polynomial
in K[X] that assumes prescribed values at prescribed elements of K.
The two coming examples illustrate typical uses of Corollaries 15.9 and 15.10.
Example 15.12 (Moldavia) Find all polynomials f âˆˆR[X] such that f (0) = 0 and
f (x2 + 1) = f (x)2 + 1, âˆ€x âˆˆR.
2As we shall see in Sect. 19.3, upon studying polynomials over Zp, for some prime number p, the
fact that K is inï¬nite here is actually indispensable for the injectivity of (15.2).

15.1
Roots of Polynomials
371
Solution Let the sequence (un)nâ‰¥0 be deï¬ned by u0 = 0 and un+1 = u2
n + 1, for
n â‰¥1. If g(X) = X, then f (u0) = 0 = g(u0) and, by assuming f (uk) = g(uk),
we get
f (uk+1) = f (u2
k + 1) = f (uk)2 + 1
= g(uk)2 + 1 = u2
k + 1 = g(uk+1).
Therefore, we conclude by induction that f (un) = g(un) for every nonnegative
integer n. However, since the values of the terms un are pairwise distinct, we
conclude that f (x) and g(x) coincide for an inï¬nite number of distinct values of
x. It thus follows from Corollary 15.10 that f = g, i.e., f (X) = X.
âŠ“âŠ”
Example 15.13 (Hong Kong) Let g(X) = X5 + X4 + X3 + X2 + X + 1. Compute
the remainder of the division of g(X12) by g(X).
Solution The division algorithm assures the existence of q, r âˆˆR[X] such that
g(X12) = g(X)q(X) + r(X),
with r = 0 or 0 â‰¤âˆ‚r â‰¤4. Letting Ï‰ = cis 2Ï€
6 and taking x = Ï‰k in the
corresponding polynomial functions, with 1 â‰¤k â‰¤5, we obtain
g(Ï‰12k) = g(Ï‰k)q(Ï‰k) + r(Ï‰k)
(15.3)
for 1 â‰¤k â‰¤5.
Now, since Ï‰12k = cis (4kÏ€) = 1, we get g(Ï‰12k) = g(1) = 6. On the other
hand, for 1 â‰¤k â‰¤5, Lemma 13.18 furnishes
g(Ï‰k) = Ï‰5k + Ï‰4k + Ï‰3k + Ï‰2k + Ï‰k + 1 = Ï‰6k âˆ’1
Ï‰k âˆ’1 = 0.
Thus, (15.3) reduces to r(Ï‰k) = 6 for 1 â‰¤k â‰¤5, so that the polynomial r âˆ’6 has
at least ï¬ve distinct roots. However, since r âˆ’6 = 0 or âˆ‚(r âˆ’6) â‰¤4, Corollary 15.8
gives r âˆ’6 = 0.
âŠ“âŠ”
The coming further consequence of Lagrangeâ€™s theorem (Corollary 15.8) guar-
antees that the image of the polynomial function associated to a nonconstant
polynomial on K is an inï¬nite set.
Corollary 15.14 If f âˆˆK[X]\K, then the image Im (f ) of the polynomial function
associated to f is an inï¬nite subset of K.
Proof Assume the contrary, i.e., that Im (f ) = {Î±1, . . . , Î±k} âŠ‚K. Then, for every
x âˆˆK we have f (x) âˆˆ{Î±1, . . . , Î±k}. However, since K is an inï¬nite set, there exists
1 â‰¤i â‰¤k and pairwise distinct elements x1, x2, . . . âˆˆK such that
f (x1) = f (x2) = . . . = Î±i.

372
15
Roots of Polynomials
Hence, f (X) âˆ’Î±i is a nonvanishing polynomial (for f is nonconstant) with an
inï¬nite number of distinct roots, which is a contradiction.
âŠ“âŠ”
Example 15.15 (Canada) Find all nonconstant polynomials f âˆˆQ[X] such that
f (f (X)) = f (X)k for some given natural number k.
Solution It is easy to see (cf. Problem 1) that for every x âˆˆQ we have f (f (x)) =
f (x)k. Yet in another way, we have f (y) = yk for every y âˆˆIm (f ). Now, the
previous result assures that Im (f ) is an inï¬nite subset of Q, so that Corollary 15.10
gives f (X) = Xk.
âŠ“âŠ”
Problems: Sect. 15.1
1. * Show that the usual deï¬nition of composite function, when applied to
polynomials f, g âˆˆK[X] \ {0} of degrees m e n, respectively, produces a
polynomial in K[X]\{0} of degree mn. Letting f â—¦g denote such a polynomial,
show that its associated polynomial function coincides with the composite
function Ëœf â—¦Ëœg, where Ëœf and Ëœg denote the polynomial functions associated to f
and g, respectively.
2. * Let a, b and r be rational numbers, with r > 0 being such that âˆšr is irrational.
Do the following items:
(a) For a ï¬xed k âˆˆN, show that there exist ak, bk âˆˆQ such that (a Â± bâˆšr)k =
ak Â± bk
âˆšr.
(b) If f âˆˆQ[X] \ {0}, prove that f (a + bâˆšr) = 0 â‡”f (a âˆ’bâˆšr) = 0.
3. One of the roots of the polynomial X4 + aX3 + X2 + bX âˆ’2 is 1 âˆ’
âˆš
2. Find
the remaining roots, knowing that a and b are both rational numbers.
4. Let a, b âˆˆK be given, with a Ì¸= 0. For f âˆˆK[X]\{0}, prove that the remainder
of the division of f by aX + b is equal to f

âˆ’b
a

.
5. Does there exist a polynomial f âˆˆR[X] such that f (sin x) = cos x for every
x? Justify your answer.
6. Let Î± Ì¸= kÏ€ be a complex number. Prove that, in R[X], the polynomial X2 + 1
divides the polynomial
f (X) = (cos Î± + X sin Î±)n âˆ’cos(nÎ±) âˆ’sin(nÎ±)X.
7. Find all n âˆˆN for which Xn+1 âˆ’Xn + 1 is divisible by X2 âˆ’X + 1.
8. (BMO) For m âˆˆZ, prove that the polynomial
X4 âˆ’1994X3 + (1993 + m)X2 âˆ’11X + m
does not possess two distinct integer roots.
9. (AIME) Find all real numbers a and b such that X2 âˆ’X âˆ’1 divides aX17 +
bX16 + 1.

15.2
Rational Roots of Polynomials in Z[X]
373
10. (Moldavia) Let n > 4 be a given natural number and p be a monic polynomial
of degree n, having n distinct integer roots, one of which is 0. Compute the
number of distinct integer roots of the polynomial p(p(X)).
11. (Austrian-Polish) Let f (x) = ax3 +bx2 +cx +d be a polynomial with integer
coefï¬cients and degree 3. Prove that it is not possible to ï¬nd four distinct primes
p1, p2, p3 and p4 such that
|f (p1)| = |f (p2)| = |f (p3)| = |f (p4)| = 3.
12. (Canada) Let p(X) = Xn + anâˆ’1Xnâˆ’1 + Â· Â· Â· + a1X + a0 be a polynomial with
integer coefï¬cients, and assume that there exist distinct integers a, b, c and d
for which p(a) = p(b) = p(c) = p(d) = 5. Prove that there exists no integer
m such that p(m) = 8.
13. (IMO shortlist) Find all values of k âˆˆN such that X2 + X + 1 divides X2k +
1 + (X + 1)2k.
For the coming example, recall (cf. paragraph that precedes Problem 13,
page 30) that a multiset is a collection {{a1, a2, . . . , an}} of not necessarily
distinct elements, with {{a1, a2, . . . , an}} = {{b1, b2, . . . , bm}} if and only if
m = n and each element appears the same number of times in each multiset.
14. Let {{a1, a2, . . . , an}} and {{b1, b2, . . . , bn}} be two distinct multisets, each of
which formed by positive integers. If
{{ai + aj; 1 â‰¤i < j â‰¤n}} = {{bi + bj; 1 â‰¤i < j â‰¤n}},
prove that n is a power of 2.
15.2
Rational Roots of Polynomials in Z[X]
This short section studies the problem of ï¬nding rational roots of polynomials
with integer coefï¬cients, presenting several interesting applications. Item (a) of
the coming proposition brings the central result, which is known in mathematical
literature as the rational roots test for polynomials with integer coefï¬cients.
Proposition 15.16 Let n > 1 be an integer, f (X) = anXn + Â· Â· Â· + a1X + a0 be
a nonzero polynomial with integer coefï¬cients and p and q be nonzero, relatively
prime integers. If f
 p
q

= 0, then:
(a) p | a0 and q | an.
(b) If f is monic, then the possible rational roots of f are integers.
(c) (p âˆ’mq) | f (m) for every m âˆˆZ. In particular, (p âˆ’q) | f (1) and (p + q) |
f (âˆ’1).

374
15
Roots of Polynomials
Proof
(a) Starting from f ( p
q ) = 0, we readily obtain
anpn + anâˆ’1pnâˆ’1q + Â· Â· Â· + a1pqnâˆ’1 + a0qn = 0
and, hence,
a0qn = p(âˆ’anpnâˆ’1 âˆ’Â· Â· Â· âˆ’a1qnâˆ’1)
anpn = q(âˆ’anâˆ’1pnâˆ’1 âˆ’Â· Â· Â· âˆ’a0qnâˆ’1) .
Therefore, p | a0qn and q | anpn. However, since p and q are relatively prime,
item (a) of Proposition 6.22 assures that p | a0 and q | an, as we wished to
show.
(b) This follows immediately from (a).
(c) Since f
 p
q

= 0, we have f (m) = f (m) âˆ’f ( p
q ) or, which is the same,
f (m) = (anmn + Â· Â· Â· + a1m + a0) âˆ’1
qn (anpn + Â· Â· Â· + a1pqnâˆ’1 + a0qn).
Hence,
qnf (m) = qn(anmn + Â· Â· Â· + a1m + a0) âˆ’(anpn + Â· Â· Â· + a1pqnâˆ’1 + a0qn)
= an((mq)n âˆ’pn) + Â· Â· Â· + a1qnâˆ’1(mq âˆ’p)
= (mq âˆ’p)r
for some r âˆˆZ, where we used item (a) of Example 6.3 in the last equality. The
above computations show that (mq âˆ’p) | qnf (m). Thus, in order to conclude
that (mq âˆ’p) | f (m), it sufï¬ces to show (again by item (a) of Proposition 6.22)
that gcd(mq âˆ’p, qn) = 1. To this end, by successively applying item (b) of that
result, together with Corollary 6.23, we get
gcd(p, q) = 1 â‡’gcd(mq âˆ’p, q) = 1 â‡’gcd(mq âˆ’p, qn) = 1.
The rest follows at once.
âŠ“âŠ”
The previous result can sometimes be applied to establish the irrationality of
certain real numbers. We shall now see a couple of examples in this direction.

15.2
Rational Roots of Polynomials in Z[X]
375
Example 15.17 Prove that
;
2 +
:
2 +
âˆš
2 is irrational.
Proof Letting Î± =
;
2 +
:
2 +
âˆš
2, we have Î±2 âˆ’2 =
:
2 +
âˆš
2 and, then, (Î±2 âˆ’
2)2 = 2 +
âˆš
2. Therefore, ((Î±2 âˆ’2)2 âˆ’2)2 = 2, so that Î± is a root of the monic
polynomial with integer coefï¬cients
f (X) = ((X2 âˆ’2)2 âˆ’2)2 âˆ’2
= (X4 âˆ’4X2 + 2)2 âˆ’2.
Thus, if Î± âˆˆQ, items (a) and (b) or the former proposition assure that Î± âˆˆN and
Î± | f (0) = 2, so that Î± = 1 ou 2. However, since
1 < Î± =
<
2 +
;
2 +
âˆš
2 <
;
2 +
âˆš
2 + 2 = 2,
we have reached a contradiction.
âŠ“âŠ”
Example 15.18 Prove that tan 10â—¦is irrational.
Proof We let Î± = tan 10â—¦. Applying standard trigonometric formulas (cf. Chapter 7
of [9], for instance), we successively obtain
tan 30â—¦=
tan 20â—¦+ tan 10â—¦
1 âˆ’tan 20â—¦Â· tan 10â—¦=
2 tan 10â—¦
1âˆ’tan2 10â—¦+ tan 10â—¦
1 âˆ’2 tan2 10â—¦
1âˆ’tan2 10â—¦
=
2Î±
1âˆ’Î±2 + Î±
1 âˆ’
2Î±2
1âˆ’Î±2
= 3Î± âˆ’Î±3
1 âˆ’3Î±2
However, since tan 30â—¦=
1
âˆš
3, we get
(3Î± âˆ’Î±3)2
(1 âˆ’3Î±2)2 = 1
3
or, which is the same,
3Î±6 âˆ’27Î±4 + 33Î±2 âˆ’1 = 0.

376
15
Roots of Polynomials
Hence, tan 10â—¦is a root of the polynomial with integer coefï¬cients f (X) =
3X6 âˆ’27X4 +33X2 âˆ’1, and it sufï¬ces to show that it does not possess any rational
roots. For what is left to do, ï¬rst note that, by Proposition 15.16, the possible rational
roots of f are Â±1 or Â± 1
3; nevertheless, direct computations show that f (Â±1) and
f (Â± 1
3) are all nonzero, as wished.
âŠ“âŠ”
Example 15.19 (Yugoslavia) Find all positive rationals a â‰¤b â‰¤c for which all of
the numbers
a + b + c, 1
a + 1
b + 1
c , abc
are integers.
Solution Letting f (X) = (X âˆ’a)(X âˆ’b)(X âˆ’c), we conclude that a, b and c are
the roots of f ; moreover, they are all rational. On the other hand,
f (X) = X3 âˆ’(a + b + c)X2 + (ab + bc + ca)X âˆ’abc,
with
ab + bc + ca = abc
1
a + 1
b + 1
c

âˆˆN.
It thus follows that f âˆˆZ[X]. However, since f is monic, the rational roots test
applied to f assures that all of a, b, c must be integers.
Finally, since a, b and c are positive, we conclude that it sufï¬ces to ï¬nd all
natural numbers a â‰¤b â‰¤c for which 1
a + 1
b + 1
c is also natural. In order to solve
this problem, start by noticing that
1 â‰¤1
a + 1
b + 1
c â‰¤3
a ,
so that a â‰¤3. Then, by separately considering the cases a = 1, 2 or 3 and iterating
the above reasoning, one easily ï¬nds
(a, b, c) = (1, 1, 1), (1, 2, 2), (2, 4, 4), (2, 3, 6) or (3, 3, 3).
(For instance, if a = 3, then b, c â‰¥3, and hence
1 â‰¤1
a + 1
b + 1
c â‰¤1
3 + 1
3 + 1
3 = 1,
so that a = b = c = 3.)
âŠ“âŠ”

15.2
Rational Roots of Polynomials in Z[X]
377
We ï¬nish this section by presenting an interesting application of item (b) of
Proposition 15.16. More precisely we shall characterize all rational numbers Î± for
which cos(Î±Ï€) is also rational. To this end, we ï¬rst need to introduce a special class
of polynomials.
Let (fn)nâ‰¥1 be the sequence of polynomials with real coefï¬cients given by
f1(X) = X, f2(X) = X2 âˆ’2 and, for an integer k â‰¥1,
fk+2(X) = Xfk+1(X) âˆ’fk(X).
(15.4)
The polynomial fn is called the n-th Bernstein polynomial, after the Russian
mathematician of the twentieth century Sergei N. Bernstein. The next proposition
unfolds some of its properties.
Proposition 15.20 If (fn)nâ‰¥1 is the sequence of Bernsteinâ€™s polynomials, then:
(a) fn(2 cos Î¸) = 2 cos(nÎ¸), for every Î¸ âˆˆR.
(b) fn is monic, has integer coefï¬cients and degree n.
Proof For item (a), it is obvious that f1(2 cos Î¸) = 2 cos Î¸, whereas the formula for
cos(2Î¸) in terms of cos Î¸ gives
f2(2 cos Î¸) = (2 cos Î¸)2 âˆ’2 = 2(2 cos2 Î¸ âˆ’1) = 2 cos(2Î¸).
Now, let k
â‰¥1 be an integer and assume, by induction hypothesis, that
fj(2 cos Î¸) = 2 cos(jÎ¸) for 1 â‰¤j â‰¤k + 1 and every Î¸ âˆˆR. The product formula
cos Î± + cos Î² = 2 cos
 Î±+Î²
2

cos
 Î±âˆ’Î²
2

gives
2 cos Î¸ Â· 2 cos(k + 1)Î¸ âˆ’2 cos(kÎ¸) = 2 cos(k + 2)Î¸.
Therefore, it follows from (15.4) and the induction hypothesis that
fk+2(2 cos Î¸) = 2 cos Î¸ Â· fk+1(2 cos Î¸) âˆ’fk(2 cos Î¸)
= 2 cos Î¸ Â· 2 cos(k + 1)Î¸ âˆ’2 cos(kÎ¸)
= 2 cos(k + 2)Î¸
for every Î¸ âˆˆR.
Item (b) is trivially true for f1 and f2. Arguing once more by induction, if fk
and fk+1 are monic, with integer coefï¬cients and degrees k and k + 1, respectively,
then the recurrence relation (15.4) readily assures that the same properties hold for
fk+2.
âŠ“âŠ”
We are ï¬nally in position to present the promised result.

378
15
Roots of Polynomials
Theorem 15.21 If Î± âˆˆQ is such that cos(Î±Ï€) âˆˆQ, then cos(Î±Ï€) = Â±1, Â± 1
2 or 0.
Proof Let m, n, p, q âˆˆZ such that n, q Ì¸= 0 and cos( m
n Ï€) = p
q . For Î± = m
n , item
(a) of the previous proposition gives
fn
2p
q

= fn

2 cos(Î±Ï€)

= 2 cos(nÎ±Ï€) = 2 cos(mÏ€) = 2(âˆ’1)m.
Now, item (b) of that result shows that 2p
q is a root of the monic polynomial with
integer coefï¬cients fn(X) âˆ’2(âˆ’1)m. Hence, item (b) of Proposition 15.16 gives
2p
q âˆˆZ. On the other hand, since
2p
q = 2 cos
m
n Ï€

âˆˆ[âˆ’2, 2],
we get 2p
q = Â±2, Â±1 or 0. Therefore, p
q = Â±1, Â± 1
2 or 0.
âŠ“âŠ”
Problems: Sect. 15.2
1. (Canada) Let f be a nonzero polynomial with integer coefï¬cients. If f (0) and
f (1) are odd, prove that f does not have any integer roots.
2. (OCM) Prove that there does not exist nonzero integers x, y and z in arithmetic
progression, such that x5 + y5 = z5.
3. Show that if (fn)nâ‰¥1 is a sequence of polynomials of real coefï¬cients such
that fn(2 cos Î¸) = 2 cos(nÎ¸) for every Î¸ âˆˆR, then fn is the n-th Bernstein
polynomial.
4. For n âˆˆN, let fn be the n-th Bernstein polynomial. Show that
zn + 1
zn = fn

z + 1
z

,
for every z âˆˆC \ {0}.
5. Find the roots of the polynomial 2(2X2 âˆ’1)2 âˆ’X âˆ’1 by calling one of them x
and:
(a) Letting y = 2x2 âˆ’1.
(b) Imposing that x = cos Î¸.
Then, use the previous items to compute cos Ï€
10.

15.3
The Fundamental Theorem of Algebra
379
6. Let a, b âˆˆZ be such that
3:
a +
âˆš
b +
3:
a âˆ’
âˆš
b âˆˆQ.
(a) Prove that it must be an integer and a divisor of 8a3.
(b) Assuming that a2 âˆ’b is a perfect cube, do the following items:
i. Prove that the given number is a divisor of 2a.
ii. Characterize all such pairs of integers a and b.
7. (Ireland) Prove that (2 + i)n Ì¸= (2 âˆ’i)n for every n âˆˆN.
The next problem partially generalizes Example 6.24.
8. (OCM) Do the following items:
(a) If none of the natural numbers a1, a2, . . . , an is a perfect square, show that
âˆša1 + âˆša2 + Â· Â· Â· + âˆšan is a root of a monic polynomial fn âˆˆZ[X], of
degree 2n.
(b) Show that
âˆš
2 +
âˆš
3 +
âˆš
5 +
âˆš
7 +
âˆš
11 is irrational.
9. (IMOâ€”shortlist) Given a, b âˆˆQ, can the polynomials X5 âˆ’X âˆ’1 and X2 +
aX + b have a common complex root?
15.3
The Fundamental Theorem of Algebra
As a particular case of Corollary 15.9, every polynomial of complex coefï¬cients and
degree n has at most n complex roots. On the other hand, the polynomial f (X) =
X2 âˆ’2 âˆˆQ[X] has rational coefï¬cients but does not admit any rational roots;
accordingly, g(X) = X2 + 1 âˆˆR[X] has real coefï¬cients but no real roots. In
both cases, the fact that such polynomials do not admit roots in Q or R is due to
deï¬ciencies of such number sets, in the sense that, in them, one cannot perform
certain root extractions.
On the other hand, Bhaskaraâ€™s formula shows (cf. Problem 1) that every second
degree polynomial with complex coefï¬cients has two (possibly equal complex
roots), and the coming example looks at the third degree case. The reasoning
presented below is essentially the one developed by the Italian mathematicians of
the sixteenth century Scipioni del Ferro, Gerolamo Cardano and NiccolÃ² Fontana,
known as Tartaglia (in this respect, see also Problem 2).
Example 15.22 A third degree polynomial f (X) = a3X3 + a2X2 + a1X + a0 with
complex coefï¬cients has a complex root.
Proof We can obviously assume that a3 = 1. Also, for a given Î± âˆˆC, we have that
z âˆˆC is a root of f (X) if and only if z âˆ’Î± is a root of f (X + Î±); since
f (X + Î±) = (X + Î±)3 + a2(X + Î±)2 + a1(X + Î±) + a0
= X3 + (3Î± + a2)X2 + (3Î±2 + 2a2Î± + a1)X + f (Î±),

380
15
Roots of Polynomials
by choosing Î± = âˆ’a2
3 we can assume further that a2 = 0.
We are thus left to showing that a third degree polynomial f (X) = X3 +aX+b,
with a, b âˆˆC, has complex roots. To this end, we substitute z = u + v to get
f (z) = (u + v)3 + a(u + v) + b
= u3 + v3 + 3uv(u + v) + a(u + v) + b
= (u3 + v3 + b) + 3(u + v)(uv + a).
Since we are trying to ï¬nd some complex root for f , we try to impose that u3+v3 =
âˆ’b and uv = âˆ’a, thus getting the system of equations
u3 + v3 = âˆ’b
uv = âˆ’a
.
In turn, such a system can easily be solved, for u3 and v3 are the roots of the second
degree equation X2 + bX âˆ’a3 = 0
âŠ“âŠ”
At this point, we could turn to fourth degree polynomials with complex coefï¬-
cients and, by performing even trickier computations, show that they have complex
roots too. Instead, we turn to the general case, which was settled by Gauss in his
doctor thesis, in 1799 (nevertheless, see Problem 3 and the subsequent paragraph).
This is the content of the coming result, which is know in mathematical literature as
the Fundamental Theorem of Algebra (we abbreviate FTA). The proof we present
is due to the French mathematician of the eighteenth century J-B. le R. dâ€™Alembert.
Theorem 15.23 (Gauss)
Every polynomial f âˆˆC[X]\C has at least one complex
root.
Proof By the sake of notation, write f (z) = anzn + Â· Â· Â· + a1z + a0 to denote the
polynomial function associated to f . Without any loss of generality, we can assume
that a0 Ì¸= 0.
For z Ì¸= 0, the triangle inequality for complex numbers (cf. Problem 3, page 326)
gives
|f (z)| = |z|n
				an + anâˆ’1
z
+ anâˆ’2
z2
+ Â· Â· Â· + a0
zn
				
â‰¥|z|n

|an| âˆ’|anâˆ’1|
|z|
âˆ’|anâˆ’2|
|z|2
âˆ’Â· Â· Â· âˆ’|a0|
|z|n

.
Therefore, letting
|z| > max
2n|anâˆ’1|
|an|
,
âˆš2n|anâˆ’2|
âˆš|an|
, . . . ,
nâˆš2n|a0|
nâˆš|an|
/
,
(15.5)

15.3
The Fundamental Theorem of Algebra
381
we have |anâˆ’k|
|z|k
< |an|
2n , so that
|f (z)| > |z|n

|an| âˆ’n|an|
2n

= |an|
2 |z|n.
However, since |z| >
n;
2n|a0|
|an| , we have |an||z|n > 2n|a0| and, hence, |f (z)| >
n|a0| â‰¥|a0|.
In short, letting R denote the right hand side of (15.5), we get
|z| > R â‡’|f (z)| > |a0| = |f (0)|.
Now, in Sect. 21.2 we will show (cf. Corollary 21.21) that there exists z0 âˆˆC such
that |z0| â‰¤R and
|f (z0)| = min{|f (z)|; z âˆˆC, |z| â‰¤R}.
Hence, what we did above assures that
|f (z0)| = min{|f (z)|; z âˆˆC}.
By contradiction, let us suppose that f (z0) Ì¸= 0, and show that there exists h âˆˆC
for which |f (z0 + h)| < |f (z0)|. To this end, we start by noticing that there exist
complex numbers c0, c1, . . . , cn, independent of h and such that
f (z0 + h) = a0 + a1(z0 + h) + Â· Â· Â· + an(z0 + h)n
= c0 + c1h + Â· Â· Â· + cnhn;
moreover, c0 = f (z0) Ì¸= 0 and cn = an Ì¸= 0. Take the least 1 â‰¤k â‰¤n such that
ck Ì¸= 0. Then, letting dj = cj
c0 for 0 â‰¤j â‰¤n, we obtain
|f (z0 + h)|
|f (z0)|
= |1 + dkhk + dk+1hk+1 + Â· Â· Â· + dnhn|
â‰¤|1 + dkhk| + |dk+1hk+1 + Â· Â· Â· + dnhn|
= |1 + dkhk| + |dkhk|
				
dk+1
dk
h + Â· Â· Â· + dn
dk
hnâˆ’k
				 .
Now, estimates analogous to those we did with the aid of (15.5) allow us to choose
r > 0 such that |h| â‰¤r â‡’
			 dk+1
dk h + Â· Â· Â· + dn
dk hnâˆ’k			 < 1
2. Then,
|h| â‰¤r â‡’|f (z0 + h)|
|f (z0)|
â‰¤|1 + dkhk| + 1
2|dkhk|.

382
15
Roots of Polynomials
Let dk = s cis Î± and h = r cis Î¸. The ï¬rst de Moivre formula gives us
|f (z0 + h)|
|f (z0)|
â‰¤|1 + srk cis (Î± + kÎ¸)| + 1
2srk;
therefore, choosing Î¸ âˆˆR in such a way that Î± + kÎ¸ = Ï€ (i.e., taking Î¸ = Ï€âˆ’Î±
k ),
we get
|f (z0 + h)|
|f (z0)|
â‰¤|1 + srk cis Ï€| + 1
2srk
= |1 âˆ’srk| + 1
2srk
= 1 âˆ’1
2srk < 1,
whenever srk < 1, i.e., 0 < r <
k;
1
s . With such an r (and with the corresponding
h), we have |f (z0 + h)| < |f (z0)|.
âŠ“âŠ”
An immediate consequence of the FTA is collected in the coming
Corollary 15.24 If f (X) = anXn + Â· Â· Â· + a1X + a0 is a polynomial with complex
coefï¬cients and degree n â‰¥1, then there exist complex numbers z1, . . . , zn such
that
f (X) = an(X âˆ’z1) . . . (X âˆ’zn).
(15.6)
The right hand side above is the factorised form of f .
Proof We prove the corollary by induction on n, the case n = 1 being immediate.
Take an integer n > 1, and assume that the corollary is valid for every polynomial
with complex coefï¬cients and degree n âˆ’1.
If z1 âˆˆC is a root of f (whose existence is guaranteed by the FTA), the root
test assures the existence of a polynomial g with complex coefï¬cients, such that
f (X) = (X âˆ’z1)g(X). Note that g has degree n âˆ’1 and leading coefï¬cient an;
hence, by induction hypothesis, there exist z2, . . . , zn âˆˆC such that g(X) = an(Xâˆ’
z2) . . . (X âˆ’zn). Therefore,
f (X) = (X âˆ’z1)g(X) = an(X âˆ’z1)(X âˆ’z2) . . . (X âˆ’zn)
and there is nothing left to do.
âŠ“âŠ”
A useful variation of the previous corollary is the one given by the next result.
Corollary 15.25 If f (X) = anXn + Â· Â· Â· + a1X + a0 is a polynomial with complex
coefï¬cients and degree n â‰¥1, then, given Î± âˆˆC, there exist z1, . . . , zn âˆˆC such
that f (zk) = Î± for 1 â‰¤k â‰¤n.

15.3
The Fundamental Theorem of Algebra
383
Proof Apply the former corollary to g(X) = f (X) âˆ’Î±.
âŠ“âŠ”
Back to the general case, let f (X) = anXn + Â· Â· Â· + a1X + a0 be a nonzero
polynomial with coefï¬cients in K. If there exist elements Î±1, . . . , Î±n âˆˆK for which
f (X) = an(X âˆ’Î±1) . . . (X âˆ’Î±n),
we shall also say that the expression at the right hand side is the factorised form of
f over K.
Since some of the Î±jâ€™s may appear several times in the factorised form, if we
look only at the distinct ones we conclude, possibly after renumbering them, that
there exist 1 â‰¤m â‰¤n and positive integers k1, . . . , km such that
f (X) = an(X âˆ’Î±1)k1 Â· Â· Â· (X âˆ’Î±m)km,
with k1 + Â· Â· Â· + km = n and Î±1, . . . , Î±m pairwise distinct elements of K.
The two coming examples give interesting applications of the factorised form of
polynomials.
Example 15.26 Given a natural number n > 1, do the following items:
(a) Obtain the factorised form of f (X) = Xnâˆ’1 + Xnâˆ’2 + Â· Â· Â· + X + 1.
(b) Let A1A2 . . . An be a regular polygon with n sides, inscribed in a circle with
radius 1. Compute the value of A1A2 Â· A1A3 Â· . . . Â· A1An.
Solution
(a) Since
(X âˆ’1)f (X) = (X âˆ’1)(Xnâˆ’1 + Xnâˆ’2 + Â· Â· Â· + X + 1) = Xn âˆ’1,
the complex roots of f are precisely the n-th roots of unity distinct from 1.
By (13.19), such roots are the complex numbers Ï‰, Ï‰2, . . . , Ï‰nâˆ’1, with Ï‰ =
cis 2Ï€
n . Therefore, the factorised form of f is
f (X) = (X âˆ’Ï‰)(X âˆ’Ï‰2) . . . (X âˆ’Ï‰nâˆ’1).
(15.7)
(b) Assume, without any loss of generality, that the circle of radius 1 circumscribing
A1A2 . . . An is the unit circle centered at the origin of the complex plane, as well
as that A1 = 1 and A2 = Ï‰, with Ï‰ = cis 2Ï€
n . Then, Aj = Ï‰jâˆ’1 for 1 â‰¤j â‰¤n,
so that
A1A2 Â· A1A3 Â· . . . Â· A1An = |1 âˆ’Ï‰||1 âˆ’Ï‰2| . . . |1 âˆ’Ï‰nâˆ’1|
= |(1 âˆ’Ï‰)(1 âˆ’Ï‰2) . . . (1 âˆ’Ï‰nâˆ’1)|
= |f (1)| = n.
âŠ“âŠ”

384
15
Roots of Polynomials
The next example is concerned with Bernstein polynomials, so that the reader
may ï¬nd it convenient to recall their deï¬nition, in the paragraph that precedes
Proposition 15.20.
Example 15.27 For n âˆˆN, let fn be the n-th Bernstein polynomial. Show that
fn(X) =
n

k=1

X âˆ’2 cos (2k âˆ’1)Ï€
2n

.
Proof Item (a) of Proposition 15.20 gives fn(2 cos Î¸) = 0 if cos(nÎ¸) = 0. However,
cos(nÎ¸) = 0 â‡”nÎ¸ = Ï€
2 + kÏ€, âˆƒk âˆˆZ
â‡”Î¸ = Ï€
2n + kÏ€
n , âˆƒk âˆˆZ.
Now, for k = 0, 1, . . . , nâˆ’1, we get Î¸ respectively equal to Ï€
2n, 3Ï€
2n , . . . , (2nâˆ’1)Ï€
2n
, and
all these values of Î¸ give distinct values for cos Î¸. Therefore, 2 cos
 Ï€
2n

, 2 cos
 3Ï€
2n

,
. . . , 2 cos
 (2nâˆ’1)Ï€
2n

are n distinct roots for fn. Since fn it is monic and has degree
n, the rest follows from Corollary 15.24.
âŠ“âŠ”
Problems: Sect. 15.3
1. Prove that the formula giving the roots of a second degree equation still holds
to compute the complex roots of aX2 + bX + c, with a, b, c âˆˆC and a Ì¸= 0.
2. Let a, b âˆˆC, with a Ì¸= 0. In the notations of the discussion of Example 15.22,
if u0 âˆˆC is such that u3
0 is a complex root of X2 + bX âˆ’a3, show that the
roots of X3 + aX + b are given by u0 + v0, u0Ï‰ + v0Ï‰2 and u0Ï‰2 + v0Ï‰,
with v0 = âˆ’a
u0 and Ï‰ = cis 2Ï€
3 . Moreover, show that such are distinct roots if
4a3 + b2 Ì¸= 0.
3. The purpose of this problem is to delineate the steps followed by the Italian
mathematician of the sixteenth century Lodovico Ferrari to ï¬nd the roots of a
fourth degree polynomial X4 + aX3 + bX2 + cX + d, with a, b, c, d âˆˆC:
(a) If z âˆˆC is any complex number, check that
z4 + az3 + bz2 + cz + d =

z2 + az
2
2
+

b âˆ’a2
4

z2 + cz + d.

15.3
The Fundamental Theorem of Algebra
385
(b) If z âˆˆC is a root of the given polynomial and w is any complex number,
check that

z2 + az
2 + w
2
=

2w âˆ’b + a2
4

z2 + (wa âˆ’c)z + w2 âˆ’d.
(c) Show that if w is a root of the third degree equation
(wa âˆ’c)2 = 4(w2 âˆ’d)

2w âˆ’b + a2
4

,
then the equality of item (b) reduces to
z2 + az
2 + w = Â±
â›
â
=
2w âˆ’b + a2
4 z +
:
w2 âˆ’d
â
â ,
where
;
2w âˆ’b + a2
4 and
âˆš
w2 âˆ’d stand for any complex square roots of
2w âˆ’b + a2
4 and w2 âˆ’d.
(d) Show, without resorting to the Fundamental Theorem of Algebra, that the
given fourth degree polynomial has a complex root.
The reader who went through Example 15.22 may have noticed that we
reduced the task of ï¬nding a complex root for a third degree polynomial to
that of ï¬nding a complex root for an associated second degree polynomial;
subsequently, in the problem above we reduced the task of ï¬nding a complex
root for a fourth degree polynomial to that of ï¬nding a complex root for an
associated third degree polynomial. One is thus naturally tempted to guess
whether it would be possible to extend such a recursive reasoning, thus reducing
the task of ï¬nding a complex root for a general polynomial of degree n > 1
to that of ï¬nding a complex root for an appropriately associated polynomial
of degree n âˆ’1. Attempts to implement such a strategy were unsuccessfully
pursued by several mathematicians along the sixteenth, seventeenth and eigh-
teenth centuries, until a general consensus started to form around the idea that
this would perhaps not be possible. Actually, in the dawn of the nineteenth
century, the Norwegian mathematician Niels H. Abel proved that there is no
general formula for ï¬nding the roots of a ï¬fth degree polynomial in terms of
their coefï¬cients; a few years later, the French mathematician Ã‰variste Galois
extended such a result for all polynomial of degree n â‰¥5, obtaining the
ï¬rst major achievement of what is known today as Galois Theory. A gentle
introduction to the involved ideas, with complete proofs, is the object of the
marvelous book [20].

386
15
Roots of Polynomials
4. * If f âˆˆR[X] \ {0} and z âˆˆC \ R, prove that f (z) = 0 â‡”f (z) = 0. Then,
conclude that every nonconstant polynomial with real coefï¬cients has an even
number of nonreal complex roots, counted with multiplicities.
5. * Prove that every polynomial with real coefï¬cients and odd degree has an odd
number of real roots. In particular, such a polynomial always has at least one
real root.
6. If f âˆˆR[X] \ R is monic and has no real roots, show that there exist g, h âˆˆ
R[X] such that f = g2 + h2.
7. * Let f âˆˆQ[X] \ Q be a polynomial of degree n âˆˆN, and Î± Ì¸= 0 be a complex
root of f . Given m âˆˆZ, prove that there exist b0, b1, . . . , bnâˆ’1 âˆˆQ such that
Î±m = b0 + b1Î± + Â· Â· Â· + bnâˆ’1Î±nâˆ’1.
(15.8)
8. Let f (X) = anXn +anâˆ’1Xnâˆ’1 +Â· Â· Â·+a1X+a0 be a polynomial with complex
coefï¬cients and degree n â‰¥1. If z âˆˆC is one of its roots f , prove that
|z| â‰¤max

1, nA
|an|
/
,
where A = max{|a0|, |a1|, . . . , |anâˆ’1|}.
9. * Let f (X) = anXn+anâˆ’1Xnâˆ’1+Â· Â· Â·+a1X+a0 be a polynomial with integer
coefï¬cients, such that an â‰¥1, and k > 2 be an integer for which |ai| â‰¤k for
0 â‰¤i < n. If z is a complex root of f , prove that Re(z) < 1 + k
2.
10. A polynomial f over C of the form f (X) = aX4 + bX3 + cX2 + bX + a,
with a Ì¸= 0, is said to be a reciprocal of degree 4 grau. Compute its roots and,
then, formulate and solve the analogous problem for reciprocal polynomials of
degree 6.
11. (Singapore)3 Let f be a polynomial with real coefï¬cients and degree n, such
that f (k) =
k
k+1 for every integer 0 â‰¤k â‰¤n. Compute the possible values of
f (n + 1).
12. Given an integer n > 2, prove that
sin Ï€
n sin 2Ï€
n sin 3Ï€
n . . . sin (n âˆ’1)Ï€
n
=
n
2nâˆ’1 .
13. For m âˆˆN, show that:
(a) sin Ï€
2m sin 2Ï€
2m . . . sin (mâˆ’1)Ï€
2m
=
âˆšm
2mâˆ’1 .
(b) sin
Ï€
2m+1 sin
2Ï€
2m+1 . . . sin
mÏ€
2m+1 =
âˆš
2m+1
2m
.
14. (Romania) Find all nonconstant polynomials p âˆˆR[X] such that p(X2) =
p(X)p(X âˆ’1).
3For other approaches to this problem, see Problem 4, page 444, and Problem 3, page 450.

15.4
Multiple Roots
387
15.4
Multiple Roots
In this section, given f âˆˆC[X] \ C and z âˆˆC, we derive a useful necessary
condition to be satisï¬ed for z to be a multiple root of f . To this end, it is convenient
to make the convention of saying that z âˆˆC a root of f of multiplicity zero if z is
actually not a root of f . We shall also need the coming
Deï¬nition 15.28 Given a polynomial f (X) = anXn + Â· Â· Â· + a1X + a0 âˆˆC[X], we
deï¬ne its derivative4 f â€² âˆˆC[X] of f as the polynomial
f â€²(X) = nanXnâˆ’1 + (n âˆ’1)anâˆ’2Xnâˆ’2 + Â· Â· Â· + 2a2X + a1
if âˆ‚f > 0. Otherwise, we let f â€² = 0.
The rule for getting the derivative of a polynomial is rather simple: the derivative
of a constant polynomial is the identically zero one, whereas the derivative of a
polynomial of degree n â‰¥1 is obtained by erasing its constant term and performing,
for 1 â‰¤k â‰¤n, the monomial exchange
akXk â†’kakXkâˆ’1.
The coming proposition establishes the main properties of derivatives of polyno-
mials.
Proposition 15.29 For f1, . . . , fk âˆˆC[X] and a1, . . . , ak âˆˆC, we have:
(a)
k
i=1 aifi
â€²
= k
i=1 aif â€²
i .
(b)
0k
i=1 fi
â€²
= k
i=1 f1 . . . f â€²
i . . . fk.
Proof
(a) This item follows immediately by induction on k â‰¥1. Note that the initial cases
are k = 1 and k = 2.
(b) Firstly, let
f (X) = anXn + Â· Â· Â· + a1X + a0 and g(X) = bmXm + Â· Â· Â· + b1X + b0.
4The reader acquainted with Calculus has certainly noticed that the deï¬nition of f â€² matches the
one presented in Calculus courses by computing limits of Newtonâ€™s quotients. The point of the
present deï¬nition and the subsequent proposition is that they will equally apply to polynomials
over Zp, in Chap. 19.

388
15
Roots of Polynomials
By omitting X whenever convenient, it follows from (a) that
(fg)â€² =
%
n

j=0
ajXj
g
&â€²
=

n

j=0
ajXjg
â€²
=
n

j=0
(ajXjg)â€².
On the other hand,
(ajXjg)â€² =

ajXj
m

i=0
biXiâ€²
=
 m

i=0
ajbiXj+iâ€²
=
m

i=0
(ajbiXj+i)â€²
=
m

i=0
(j + i)ajbiXj+iâˆ’1
=
m

i=0
jajbiXj+iâˆ’1 +
m

i=0
iajbiXj+iâˆ’1
= jajXjâˆ’1
m

i=0
biXi + ajXj
m

i=1
ibiXiâˆ’1
= (ajXj)â€²g + (ajXj)gâ€².
Hence, going back to the previous expression for (fg)â€², we obtain
(fg)â€² =
n

j=0

(ajXj)â€²g + ajXjgâ€²
=

n

j=0
(ajXj)â€²
g +

n

j=0
ajXj
gâ€²
=

n

j=0
ajXjâ€²
g + fgâ€²
= f â€²g + fgâ€²,
where we used item (a) once more in the next to last equality.
Finally, the extension to k polynomials f1, . . . , fk âˆˆC[X] easily follows by
induction.
âŠ“âŠ”
Corollary 15.30 Given g âˆˆC[X] and n âˆˆN, if f (X) = g(X)n then f â€²(X) =
ng(X)nâˆ’1gâ€²(X). In particular, if f (X) = (X âˆ’a)n, then f â€²(X) = n(X âˆ’a)nâˆ’1.

15.4
Multiple Roots
389
Proof Letting k = n and f1 = Â· Â· Â· = fn = g in item (b) of the previous proposition,
we obtain
f â€²(X) =
n

i=1
g(X)nâˆ’1gâ€²(X) = ng(X)nâˆ’1gâ€²(X).
The particular case follows from this formula, letting g(X) = X âˆ’a.
âŠ“âŠ”
The coming result relates the multiplicity of a root of a polynomial to its
derivative.
Proposition 15.31 Let f âˆˆC[X] \ {0} and z âˆˆC.
(a) If z is a root of multiplicity m â‰¥1 of f , then z is a root of multiplicity m âˆ’1 of
f â€².
(b) If z is a root of f and is a root of multiplicity m âˆ’1 of f â€², then z is a root of
multiplicity m of f .
Proof
(a) The root test allows us to write f (X) = (X âˆ’z)mg(X), with g(z) Ì¸= 0. On the
other hand, item (b) of the previous proposition, together with its corollary, give
f â€²(X) = m(X âˆ’z)mâˆ’1g(X) + (X âˆ’z)mgâ€²(X)
= (X âˆ’z)mâˆ’1[mg(X) + (X âˆ’z)gâ€²(X)].
Hence, letting h(X) = mg(X)+(X âˆ’z)gâ€²(X), we have h(z) = mg(z) Ì¸= 0 and
f â€²(X) = (X âˆ’z)mâˆ’1h(X). By the very deï¬nition of multiplicity, we conclude
that z is a root of f â€² of multiplicity m âˆ’1.
(b) Again by the root test, we can write f (X) = (X âˆ’z)kg(X), for some integer
k â‰¥1 and g âˆˆC[X] such that g(z) Ì¸= 0. Then, item (a) assures that the
multiplicity of Î± as a root of f â€² is k âˆ’1, so that k âˆ’1 = m âˆ’1 and, hence,
k = m.
âŠ“âŠ”
Corollary 15.32 If z âˆˆC and f âˆˆC[X] \ {0}, then z is a multiple root of f if and
only if f (z) = f â€²(z) = 0.
Proof If z is a multiple root of f , this means that it is a root of f with multiplicity
is at least 2. Therefore, item (a) of the previous proposition implies that z is a root
of f â€².
Conversely, if z is a root of both f and f â€², then item (b) of the previous
proposition shows that the multiplicity of z as a root of f is at least 2. In turn,
this is the same as saying that z is a multiple root of f .
âŠ“âŠ”

390
15
Roots of Polynomials
Example 15.33 (Sweden) Prove that, for every n âˆˆN, the polynomial
1 + X + 1
2!X2 + Â· Â· Â· + 1
n!Xn
has no multiple roots.
Proof Let f (X) = 1 + X + 1
2!X2 + Â· Â· Â· + 1
n!Xn, and assume that it has a multiple
root z. Then, by the former corollary we have f (z) = f â€²(z) = 0. Now, since
f (X) = f â€²(X) + 1
n!Xn, it would follow that
0 = f (z) = f â€²(z) + zn
n! ,
i.e., z = 0. However, since f (0) = 1 Ì¸= 0, we have reached a contradiction.
âŠ“âŠ”
In order to reï¬ne the conclusion of the previous corollary, we ï¬rst need to
generalize Deï¬nition 15.28. We do this now.
Deï¬nition 15.34 For f âˆˆC[X] \ {0}, we deï¬ne the k-th derivative of f , denoted
f (k), by
f (k) =
f,
if k = 0

f (kâˆ’1)â€² , if k â‰¥1 .
It readily follows from this deï¬nition that f (1) = (f (0))â€² = f â€²; thus, f (2) =
(f (1))â€² = (f â€²)â€², so that we denote f (2) = f â€²â€². Accordingly, whenever convenient
we write f (3) = f â€²â€²â€² etc.
If âˆ‚f = n and 0 â‰¤k â‰¤n, an easy induction guarantees that âˆ‚f (k) â‰¤n âˆ’k; in
particular, âˆ‚f (n) = 0 and, hence, f (n+1) = f (n+2) = Â· Â· Â· = 0.
Corollary 15.35 If z âˆˆC and f âˆˆC[X]\{0}, then z is a root of multiplicity m â‰¥1
of f if and only if
f (z) = . . . = f (mâˆ’1)(z) = 0 and f (m)(z) Ì¸= 0.
Proof Suppose ï¬rst that z is a root of multiplicity m of f . Several applications of
item (a) of Proposition 15.31 give us, on the one hand,
f (z) = Â· Â· Â· = f (mâˆ’1)(z) = 0
and, on the other, that z is a root of multiplicity zero of f (m), i.e., that f (m)(z) Ì¸= 0.
Conversely, assume that the stated condition holds and let k âˆˆN and g âˆˆC[X]
be such that f (X) = (X âˆ’z)kg(X), with g(z) Ì¸= 0. A straightforward inductive

15.4
Multiple Roots
391
argument (using again item (a) of Proposition 15.31) assures that z is a root of
multiplicity k âˆ’j of f (j), for 0 â‰¤j â‰¤k. In particular,
f (z) = . . . = f (kâˆ’1)(z) = 0 and f (k)(z) Ì¸= 0.
Now
f (z) = . . . = f (mâˆ’1)(z) = 0 â‡’k â‰¥m
and
f (m)(z) Ì¸= 0 â‡’k â‰¤m.
âŠ“âŠ”
In the rest of this section, our purpose is to show that, if f âˆˆC[X] \ {0} has
degree n and z âˆˆC, then f is completely determined by the values f (k)(z), for
0 â‰¤k â‰¤n. However, before we can do that, we need two further consequences of
Proposition 15.31.
Corollary 15.36 Let f âˆˆC[X] be such that f = 0 or âˆ‚f â‰¤n. If z âˆˆC satisï¬es
f (z) = Â· Â· Â· = f (n)(z) = 0, then f = 0.
Proof If f Ì¸= 0, then the previous corollary, together with the stated conditions,
assure that the multiplicity of z as a root of f is at least n + 1. However, this would
imply that (Xâˆ’z)n+1 would divide f , which in turn contradicts the fact that âˆ‚f â‰¤n.
âŠ“âŠ”
Corollary 15.37 Let f, g âˆˆC[X] \ {0}, with âˆ‚f, âˆ‚g â‰¤n. If there exists z âˆˆC such
that
f (z) = g(z), . . . , f (n)(z) = g(n)(z),
then f = g.
Proof An easy induction on k â‰¥1, with the help of Deï¬nition 15.34 and item (a)
of Proposition 15.29, assures that
(f âˆ’g)(k)(X) = f (k)(X) âˆ’g(k)(X),
for every integer k â‰¥0. In particular, the stated conditions give
(f âˆ’g)(k)(z) = f (k)(z) âˆ’g(k)(z) = 0,
for 0 â‰¤k â‰¤n.
Finally, since f âˆ’g = 0 or âˆ‚(f âˆ’g) â‰¤max{âˆ‚f, âˆ‚g} â‰¤n, the previous corollary,
applied to f âˆ’g, assures that such a polynomial vanishes identically.
âŠ“âŠ”

392
15
Roots of Polynomials
The coming result is known in mathematical literature as the Taylor formula5
for polynomials, and is a direct consequence of the last corollary above.
Theorem 15.38 If z âˆˆC and f âˆˆC[X] \ {0} is of degree n, then
f (X) = f (z) + f (1)(z)
1!
(X âˆ’z) + Â· Â· Â· + f (n)(z)
n!
(X âˆ’z)n.
(15.9)
Proof Let
g(X) = f (z) + f â€²(z)
1!
(X âˆ’z) + Â· Â· Â· + f (n)(z)
n!
(X âˆ’z)n.
Since f Ì¸= 0, it follows from Corollary 15.36 that at least one of the numbers f (z),
f â€²(z), . . . , f (n)(z) is nonzero; therefore, g Ì¸= 0. On the other hand, it is immediate
to check that, for 0 â‰¤k â‰¤n, we have
g(k)(X) =
n

j=k
f (j)(z)
(j âˆ’k)!(X âˆ’z)jâˆ’k
and, hence,
f (z) = g(z), f â€²(z) = gâ€²(z), . . . , f (n)(z) = g(n)(z).
However, since f and g both have degrees less than or equal to n, the previous
corollary assures that f = g.
âŠ“âŠ”
Example 15.39 Let f âˆˆR[X]\{0} and a âˆˆR be such that f (a) = 0 and f (k)(a) â‰¥
0 for every k â‰¥1. Prove that f has no roots along the interval (a, +âˆ).
Proof Letting n = âˆ‚f , Taylorâ€™s formula gives
f (X) = f â€²(a)
1!
(X âˆ’a) + Â· Â· Â· + f (n)(a)
n!
(X âˆ’a)n.
Since f
Ì¸= 0, at least one of the derivatives f (k)(a), say f (j)(a), is positive.
Obviously, 1 â‰¤j â‰¤n. Therefore, for a real number x > a, we have
f (x) = f â€²(a)
1!
(x âˆ’a) + Â· Â· Â· + f (n)(a)
n!
(x âˆ’a)n
â‰¥f (j)(a)
j!
(x âˆ’a)j > 0.
âŠ“âŠ”
5Brook Taylor, English mathematician of the eighteenth century.

15.4
Multiple Roots
393
Problems: Sect. 15.4
1. Find all integer values of a for which f (X) = X3 âˆ’aX2 +5X âˆ’2 has multiple
roots.
2. * Establish the following partial generalization of item (a) of Proposition 15.31:
if f, g âˆˆC[X] \ {0} are such that g(X)2 | f (X), then g(X) | f â€²(X).
3. * For z1, . . . , zn âˆˆC, let f (X) = (X âˆ’z1) . . . (X âˆ’zn). Prove that, for z âˆˆ
C \ {z1, . . . , zn}, we have
f â€²(z)
f (z) =
n

j=1
1
z âˆ’zj
.
4. * Generalize the previous problem proving that, if f1, . . . , fk âˆˆC[X] \ {0},
f = f1 . . . fk and z âˆˆC is not a root of f , then
f â€²(z)
f (z) = f â€²
1(z)
f1(z) + Â· Â· Â· + f â€²
k(z)
fk(z).
5. * Let n > 1 be an integer and Ï‰ = cis 2Ï€
n .
(a) Show that, for every integer 1 â‰¤j â‰¤n, one has
(Ï‰j âˆ’1) . . . (Ï‰j âˆ’Ï‰jâˆ’1)(Ï‰j âˆ’Ï‰j+1) . . . (Ï‰j âˆ’Ï‰nâˆ’1) = nÏ‰(nâˆ’1)j.
(b) Compute, in terms of n, the value of P = 0
0â‰¤k<j<n(Ï‰j âˆ’Ï‰k)2.
6. Given u, v, w âˆˆC, with w Ì¸= 0, let (an)nâ‰¥1 be such that ak+3 = uak+2 +
vak+1 + wak for every k â‰¥1. Also, let Î±, Î² and Î³ be the complex roots of the
polynomial X3 âˆ’uX2 âˆ’vX âˆ’w.
(a) If Î±, Î² and Î³ are pairwise distinct, show that an = AÎ±nâˆ’1+BÎ²nâˆ’1+CÎ³ nâˆ’1
for every n â‰¥1, where A, B and C are the solutions of the linear system
â§
â¨
â©
A + B + C = a1
Î±A + Î²B + Î³ C = a2
Î±2A + Î²2B + Î³ 2C = a3
.
(b) If Î± = Î² Ì¸= Î³ , show that an = (A + Bn)Î±nâˆ’1 + CÎ³ nâˆ’1 for n â‰¥1, where
A, B and C are the solutions of the linear system
â§
â¨
â©
A + B + C = a1
Î±(A + 2B) + Î³ C = a2
Î±2(A + 3B) + Î³ 2C = a3
.

394
15
Roots of Polynomials
(c) If Î± = Î² = Î³ , show that an = (A + Bn + Cn2)Î±nâˆ’1 for n â‰¥1, where A,
B and C are the solutions of the linear system
â§
â¨
â©
A + B + C = a1
Î±(A + 2B + 4C) = a2
Î±2(A + 3B + 9C) = a3
7. * Solve the linear recurrence relation
dn+3 âˆ’6dn+2 + 12dn+1 âˆ’8dn = 0,
knowing that d1 = 1, d2 = 4 and d3 = 14.
We now revisit Problem 13, page 22, with the methods we developed in this
section.
8. (USA) For each nonempty ï¬nite set S of real numbers, let Ïƒ(S) and Ï€(S)
respectively denote the sum and product of its elements. Prove that

âˆ…Ì¸= S âŠ‚In
Ïƒ(S)
Ï€(S) = n2 + 2n âˆ’

1 + 1
2 + Â· Â· Â· + 1
n

(n + 1).
9. Prove the following theorem of Gauss: if f (X) = anXn + Â· Â· Â· + a1X + a0 is
a polynomial of degree greater than 1 and with complex coefï¬cients, then the
roots of f â€² are contained in the smallest convex polygon (possibly degenerated)
of the complex plane having the roots of f as vertices.
10. * Let f be a nonzero polynomial with integer coefï¬cients and degree n, and
a âˆˆZ. Prove that f (j)(a)
j!
âˆˆZ for 0 â‰¤j â‰¤n.
11. Let f be a nonzero polynomial with integer coefï¬cients and p be a prime that
does not divide its leading coefï¬cient. If m âˆˆN is such that
f (m) â‰¡0 (mod p) and f â€²(m) Ì¸â‰¡0 (mod p),
prove that, for every k âˆˆN, there exists mk âˆˆN for which
f (mk) â‰¡0 (mod pk).
12. (IMOâ€”shortlist) The real numbers a, b and c are such that there exists exactly
one square6 whose vertices lie on the graph of the polynomial function f (x) =
x3 + ax2 + bx + c. Prove that the length of the sides of such a square is
4âˆš
72.
6One can show (cf. Problem 5, page 444) that, given a simple n-sided polygon, one can always
ï¬nd a polynomial function of degree at most n âˆ’1 and whose graph contains the set of vertices of
the polygon.

Chapter 16
Relations Between Roots and Coefï¬cients
This chapter is devoted to the proof of some important relations between the
coefï¬cients of a polynomial and their complex roots; such results are generically
known as the relations between roots and coefï¬cients of a polynomial. We also
discuss an important theorem of Newton on symmetric polynomials, which will
reveal itself to be of central importance for the material of Chap. 20.
In all that follows, recall that K stands for Q, R or C.
16.1
Polynomials on Several Indeterminates
For a given n âˆˆN, a polynomial f in n indeterminates over K is a sum of
monomials of the form
ai1...inXi1
1 . . . Xinn ,
where ai1...in âˆˆK and i1, . . . , in vary in Z+, with ai1...in = 0 for almost every (i.e.,
for all but a ï¬nite number of) sequence (i1, . . . , in) of nonnegative integers. In this
case, we write
f = f (X1, X2, . . . , Xn) =

i1,...,inâ‰¥0
ai1...inXi1
1 . . . Xinn .
The degree of a polynomial f as above is the greatest possible value of the sum
i1 + Â· Â· Â· + in, such that ai1...in Ì¸= 0.
We let K[X1, . . . , Xn] denote the set of polynomials in n indeterminates over K.
On such a set we deï¬ne, in an obvious way, operations
+ : K[X1, . . . , Xn] Ã— K[X1, . . . , Xn] â†’K[X1, . . . , Xn]
Â© Springer International Publishing AG, part of Springer Nature 2018
A. Caminha Muniz Neto, An Excursion through Elementary Mathematics, Volume III,
Problem Books in Mathematics, https://doi.org/10.1007/978-3-319-77977-5_16
395

396
16
Relations Between Roots and Coefï¬cients
and
Â· : K[X1, . . . , Xn] Ã— K[X1, . . . , Xn] â†’K[X1, . . . , Xn],
respectively denoted addition and multiplication, which extend the homonymous
operations on K[X] and continue to be commutative, associative etc. For instance,
if f (X1, X2) = X2
1 + X1X2 + X3
2 and g(X1, X2) = X3
1 âˆ’
âˆš
2X1X2, then
f (X1, X2) + g(X1, X2) = X2
1 + (1 âˆ’
âˆš
2)X1X2 + X3
1 + X3
2
and
f (X1, X2) Â· g(X1, X2) = X5
1 âˆ’
âˆš
2X3
1X2 + X4
1X2 âˆ’
âˆš
2X2
1X2
2
+ X3
1X3
2 âˆ’
âˆš
2X1X4
2.
Given f
âˆˆK[X1, . . . , Xn], we can look at it as a polynomial in Xi, with
coefï¬cients in K[X1, . . . , *
Xi, . . . , Xn], where we have put the hat âˆ§over Xi to
indicate that all of the indeterminates, except for Xi, are present. For example, let
f (X1, X2, X3) = X3
1X2X4
3 âˆ’X3
1 âˆ’5X1X2 + 10X1X5
2X2
3,
be a polynomial in K[X1, X2, X3]; writing
f (X1, X2, X3) = X3
1X2 Â· X4
3 + 10X1X5
2 Â· X2
3 âˆ’(X3
1 + 5X1X2),
we consider f as a polynomial in X3, with coefï¬cients in K[X1, X2].
If f, g âˆˆK[X1, . . . , Xn] are given by
f (X1, X2, . . . , Xn) =

i1,...,inâ‰¥0
ai1...inXi1
1 . . . Xinn
and
g(X1, X2, . . . , Xn) =

i1,...,inâ‰¥0
bi1...inXi1
1 . . . Xinn ,
we say that f and g are equal provided ai1...in = bi1...in for all possible choices of
indices i1, . . . , in âˆˆZ+.
For ï¬xed x1, x2 . . . , xn âˆˆK, we write f (x1, x2, . . . , xn) to denote the element
of K given by
f (x1, x2, . . . , xn) =

i1,...,in
ai1...inxi1
1 xi2
2 . . . xin
n .
The coming proposition establishes an important relation between such elements of
K and the notion of equality of polynomials in several indeterminates.

16.1
Polynomials on Several Indeterminates
397
Proposition 16.1 Let f, g âˆˆK[X1, . . . , Xn]. If A1, . . . , An âŠ‚K are inï¬nite sets,
then
f = g â‡”f (x1, x2, . . . , xn) = g(x1, x2, . . . , xn),
for all x1 âˆˆA1, x2 âˆˆA2, . . . , xn âˆˆAn.
Proof If f = g, then it is clear that f (x1, x2, . . . , xn) = g(x1, x2, . . . , xn) for all
x1, x2, . . . , xn âˆˆK and, in particular, for x1 âˆˆA1, x2 âˆˆA2, . . . , xn âˆˆAn.
Conversely, suppose that this last condition is satisï¬ed, and let us prove that
f = g by using induction on the number n of indeterminates. Corollary 15.10
already gives the validity of this claim for n = 1. Assume, by induction hypothesis,
that the result holds true for polynomials over K in n âˆ’1 indeterminates, and write

f (X1, X2, . . . , Xn) = m
j=0 fj(X2, . . . , Xn)Xj
1
g(X1, X2, . . . , Xn) = p
j=0 gj(X2, . . . , Xn)Xj
1
,
(16.1)
with fi, gj âˆˆK[X2, . . . , Xn] for all 0 â‰¤i â‰¤m, 0 â‰¤j â‰¤p.
For arbitrarily ï¬xed x2 âˆˆA2, . . . , xn âˆˆAn, the hypothesis gives
f (x1, x2, . . . , xn) = g(x1, x2, . . . , xn)
for all x1 âˆˆA1, i.e.,
m

j=0
fj(x2, . . . , xn)xj
1 =
p

j=0
gj(x2, . . . , xn)xj
1,
for all x1 âˆˆA1. Since A1 is an inï¬nite set, applying Corollary 15.10 to the
polynomials in X1
f (X1, x2, . . . , xn) =
m

j=0
fj(x2, . . . , xn)Xj
1
and
g(X1, x2, . . . , xn) =
p

j=0
gj(x2, . . . , xn)Xj
1,
we conclude that m = p and
fj(x2, . . . , xn) = gj(x2, . . . , xn)
(16.2)
for 0 â‰¤j â‰¤m. However, since x2 âˆˆA2, . . . , xn âˆˆAn were arbitrarily chosen,
we conclude that (16.2) holds for all x2 âˆˆA2, . . . , xn âˆˆAn. Hence, our induction
hypothesis guarantees that fj = gj for 0 â‰¤j â‰¤m, so that (16.1) gives f = g.
âŠ“âŠ”

398
16
Relations Between Roots and Coefï¬cients
Remark 16.2 From now on, whenever we deal with polynomials f over K in
two indeterminates, we will generally write f (X, Y) instead of f (X1, X2). An
analogous remark holds for polynomials f over K in three indeterminates, which
will be generally denoted by f (X, Y, Z), instead of f (X1, X2, X3).
Example 16.3 Write (X + Y + Z)3 âˆ’(X3 + Y 3 + Z3) as a product of polynomials
of degree 1.
Solution Choose arbitrary y, z âˆˆRâˆ—, with y Ì¸= z, and consider the polynomial in X
g(X) = f (X, y, z) = (X + y + z)3 âˆ’X3 âˆ’(y3 + z3).
Since
f (âˆ’y, y, z) = (âˆ’y + y + z)3 âˆ’((âˆ’y)3 + y3 + z3) = 0,
the root test assures that the polynomial (in X) f (X, y, z) is divisible by Xâˆ’(âˆ’y) =
X + y. Analogously, f is also divisible by X + z and, since âˆ‚g = 2, item (c) of
Proposition 15.3 guarantees that
f (X, y, z) = Î±(X + y)(X + z),
for some Î± âˆˆR to be found. By evaluating the equality above at 0, we obtain
Î±yz = f (0, y, z) = (y + z)3 âˆ’(y3 + z3) = 3yz(y + z),
so that Î± = 3(y + z). Therefore,
f (X, y, z) = 3(y + z)(X + y)(X + z)
and, then, f (x, y, z) = 3(y + z)(x + y)(x + z) for all x âˆˆR and y, z âˆˆRâˆ—, with
y Ì¸= z. Proposition 16.1 now gives
f (X, Y, Z) = 3(Y + Z)(X + Y)(X + Z).
âŠ“âŠ”
Problems: Sect. 16.1
1. * If f âˆˆK[X1, . . . , Xn] does not vanish identically, prove that there exist inï¬nite
sets A1, . . . , An âŠ‚K such that f (x1, . . . , xn) Ì¸= 0 for all x1 âˆˆA1, . . . , xn âˆˆAn.
2. Do the following items:
(a) Prove that the polynomial (X âˆ’Y)5 + (Y âˆ’Z)5 + (Z âˆ’X)5 is divisible by
(X âˆ’Y)(Y âˆ’Z)(Z âˆ’X).
(b) Write the polynomial (X âˆ’Y)5 +(Y âˆ’Z)5 +(Z âˆ’X)5 as a product of three
polynomials of degree 1 and one polynomial of degree 2.

16.2
Symmetric Polynomials
399
3. Write the polynomial (X + Y + Z)5 âˆ’X5 âˆ’Y 5 âˆ’Z5 as a product of three
polynomials of degree 1 and one polynomial of degree 2.
16.2
Symmetric Polynomials
For what follows, given n âˆˆN we recall that In = {1, 2, . . . , n}; also, a function
Ïƒ : In â†’In is said to be a permutation of In if it is a bijection from In into itself.
The object of study along this section is isolated in the coming deï¬nition.
Deï¬nition 16.4 A polynomial f âˆˆK[X1, . . . , Xn] is symmetric if
f (X1, X2, . . . , Xn) = f (XÏƒ(1), XÏƒ(2), . . . , XÏƒ(n)),
for every permutation Ïƒ of In.
For a better understanding of the above deï¬nition, let us look at the polynomials
f, g âˆˆK[X, Y] given by
f (X, Y) = X2 + Y 2 âˆ’XY + X + Y and g(X, Y) = X3 + Y 3 âˆ’X.
The ï¬rst is symmetric, whereas the second one is not, for
f (Y, X) = Y 2 + X2 âˆ’YX + Y + X = f (X, Y),
and
g(Y, X) = Y 3 + X3 âˆ’Y Ì¸= g(X, Y).
A particular set of symmetric polynomials, called elementary, deserves special
attention, and this is the object of the coming deï¬nition.
Deï¬nition 16.5 For 0 â‰¤j â‰¤n, the j-th elementary symmetric polynomial in
X1, . . . , Xn, denoted sj = sj(X1, . . . , Xn), is deï¬ned by
sj(X1, . . . , Xn) =

1,
if j = 0

1â‰¤i1<Â·Â·Â·<ij â‰¤n Xi1Xi2 . . . Xij , if 1 â‰¤j â‰¤n .
In the case n = 3, for example, we have
s0 = 1, s1 = X + Y + Z, s2 = XY + YZ + XZ, s3 = XYZ.
For an arbitrary natural number n, it is not difï¬cult to prove that sj is indeed
symmetric. On the other hand, the actual importance of the elementary symmetric
polynomials lies in the next proposition, which establishes Girard-ViÃ¨te formulas1
between the coefï¬cients and roots of a given polynomial.
1FranÃ§ois ViÃ¨te and Albert Girard, French mathematicians of the sixteenth and seventeenth
centuries, respectively.

400
16
Relations Between Roots and Coefï¬cients
Proposition 16.6 (Girard-ViÃ¨te) Let f (X) = anXn +Â· Â· Â·+a1X +a0 âˆˆK[X]\K
have roots Î±1, . . . , Î±n âˆˆK, repeated according to their multiplicities. For 1 â‰¤j â‰¤
n, one has
sj(Î±1, . . . , Î±n) = (âˆ’1)j anâˆ’j
an
.
(16.3)
Proof By the sake of simplicity, we shall write sj(Î±i) to denote sj(Î±1, . . . , Î±n).
According to our hypotheses, the factorised form of the polynomial f is f (X) =
an(X âˆ’Î±1)(X âˆ’Î±2) . . . (X âˆ’Î±n). Expanding the products, we obtain
f (X) = anXn âˆ’ans1(Î±i)Xnâˆ’1 + ans2(Î±i)Xnâˆ’2 âˆ’Â· Â· Â· + an(âˆ’1)nsn(Î±i).
It now sufï¬ces to compare such an expression for f with that given in the
statement of the proposition to obtain
âˆ’ans1(Î±i) = anâˆ’1, ans2(Î±i) = anâˆ’2, . . . , an(âˆ’1)nsn(Î±i) = a0.
âŠ“âŠ”
In order to get the right feeling on what the previous proposition says and what
it does not say, let Î±, Î² and Î³ be the complex roots of the polynomial f (X) =
X3 âˆ’2X2 + 1. Girard-ViÃ¨te relations give
Î± + Î² + Î³ = 2, Î±Î² + Î±Î³ + Î²Î³ = 0 and Î±Î²Î³ = âˆ’1.
However, it is worth noticing that such relations do not bring enough information
for us to compute the values of Î±, Î² and Î³ ; indeed, if we try to solve the system of
equations formed by them, we will simply obtain the polynomial equations f (Î±) =
0, f (Î²) = 0 and f (Î³ ) = 0. Actually, by multiplying both sides of the second
equation by Î±, we get
Î±2(Î² + Î³ ) + Î±Î²Î³ = 0;
in turn, substituting Î² +Î³ by 2âˆ’Î± and Î±Î²Î³ by âˆ’1 in this last equality, we arrive at
Î±2(2 âˆ’Î±) âˆ’1 = 0.
In the notations of the former proposition, we shall refer to sj(Î±1, . . . , Î±n) âˆˆK
as the j-th elementary symmetric sum of the roots of f . Whenever Î±1, . . . , Î±n
are understood and there is no danger of confusion with the elementary symmetric
polynomial sj = sj(X1, . . . , Xn), we shall write simply sj to denote such a sum.
We now present a series of examples that illustrate a variety of different situations
to which one can proï¬tably apply Girard-ViÃ¨te relations.

16.2
Symmetric Polynomials
401
Example 16.7 Let f (X) = Xn + anâˆ’1Xnâˆ’1 + anâˆ’2Xnâˆ’2 + Â· Â· Â· + a1X + a0 be a
polynomial of real coefï¬cients, such that a2
nâˆ’1 < 2anâˆ’2. Prove that f has at least
two complex, nonreal roots.
Proof By contradiction, assume that a2
nâˆ’1 < 2anâˆ’2 but at least n âˆ’1 of the roots
of f are real, say Î±1, . . . , Î±nâˆ’1 âˆˆR. Since f and g(X) = (X âˆ’Î±1) . . . (X âˆ’Î±nâˆ’1)
have real coefï¬cients, we get from the division algorithm that
f (X) = g(X)(X âˆ’Î±n),
for some Î±n âˆˆR. Therefore, all roots of f are real.
Now, by applying Girard-ViÃ¨te relations, we obtain
n

i=1
Î±i = âˆ’anâˆ’1 and

i<j
Î±iÎ±j = anâˆ’2.
Hence
0 â‰¤
n

i=1
Î±2
i =
" n

i=1
Î±i
#2
âˆ’2

i<j
Î±iÎ±j = a2
nâˆ’1 âˆ’2anâˆ’2 < 0,
which gives us the desired contradiction.
âŠ“âŠ”
Example 16.8 (Croatia) Let a, b and c be nonzero real numbers satisfying a + b +
c = 0. Prove that
a5 + b5 + c5
5
=
a3 + b3 + c3
3
 a2 + b2 + c2
2

.
Proof If f (X) = (X âˆ’a)(X âˆ’b)(X âˆ’c), then condition a + b + c = 0 gives
f (X) = X3 + sX âˆ’t, with s = ab + ac + bc and t = abc. Now, since f (a) = 0,
we obtain a3 = âˆ’sa + t and, analogously, b3 = âˆ’sb + t and c3 = âˆ’sc + t. By
termwise addition of these relations and using condition a + b + c = 0 once more,
we get
a3 + b3 + c3 = âˆ’s(a + b + c) + 3t = 3t.
In order to deal with the sum a5 + b5 + c5, we start by multiplying both sides of
the equalities a3 = âˆ’sa + t, b3 = âˆ’sb + t and c3 = âˆ’sc + t respectively by a2,
b2 and c2; we then add them termwisely to obtain
a5 + b5 + c5 = âˆ’s(a3 + b3 + c3) + t(a2 + b2 + c2).
In the right hand side of the above expression, substitute a3 + b3 + c3 = 3t and

402
16
Relations Between Roots and Coefï¬cients
a2 + b2 + c2 = (a + b + c)2 âˆ’2(ab + ac + bc) = âˆ’2s
to obtain
a5 + b5 + c5 = âˆ’s Â· 3t + t(âˆ’2s) = âˆ’5st.
The stated equality is, now, obvious.
âŠ“âŠ”
Example 16.9 (OCM) The roots of the polynomial f (X) = X3 âˆ’7X2 + 14X âˆ’6
are the lengths of the sides of a triangle. Compute the value of its area.
Solution Let a, b and c be the roots of f and A be the area of the triangle with
sides a, b and c. Heronâ€™s formula for the area of a triangle (cf. Chapter 7 of [9], for
instance) gives
A2 = p(p âˆ’a)(p âˆ’b)(p âˆ’c),
where p is the semi-perimeter of the triangle. On the other hand, by Girard-ViÃ¨te
relations, we get
p = 1
2(a + b + c) = 1
2s1(a, b, c) = 7
2,
so that
A2 = 7
2
7
2 âˆ’a
7
2 âˆ’b
7
2 âˆ’c

.
Now, the factorised form of f gives
f (X) = (X âˆ’a)(X âˆ’b)(X âˆ’c) = X3 âˆ’7X2 + 14X âˆ’6
and, hence,
f
7
2

=
7
2 âˆ’a
7
2 âˆ’b
7
2 âˆ’c

=
7
2
3
âˆ’7
7
2
2
+ 14
7
2

âˆ’6 = 1
8.
Thus,
A2 = 7
2 Â· f
7
2

= 7
2 Â· 1
8 = 7
16,
whence A =
âˆš
7
4 .
âŠ“âŠ”

16.2
Symmetric Polynomials
403
Example 16.10 (Romania) Let a, b, c and d be real numbers such that
a =
;
4 âˆ’
âˆš
5 âˆ’a, b =
;
4 +
âˆš
5 âˆ’b,
c =
;
4 âˆ’
âˆš
5 + c and d =
;
4 +
âˆš
5 + d.
Compute all possible values of the product abcd.
Solution Note that a2 = 4 âˆ’
âˆš
5 âˆ’a and, then, (a2 âˆ’4)2 = 5 âˆ’a or, which is the
same, a4 âˆ’8a2 + a + 11 = 0. Analogously, we have b4 âˆ’8b2 + b + 11 = 0, so that
a and b are roots of the polynomial
f (X) = X4 âˆ’8X2 + X + 11.
Likewise, we conclude that c and d are roots of the polynomial X4 âˆ’8X2 âˆ’X +11,
so that âˆ’c and âˆ’d are also roots of f .
Therefore, all of a, b, âˆ’c and âˆ’d are roots of f , and if we know that they are
pairwise distinct, we shall conclude that they are all of the roots of the polynomial
f ; in turn, Girard-ViÃ¨te relations will give
abcd = ab(âˆ’c)(âˆ’d) = 11.
For what is left to do, assume we had a = b. This would give
:
4 âˆ’
âˆš
5 âˆ’a =
:
4 +
âˆš
5 âˆ’a and, hence, a = 5. However, since 5 Ì¸=
:
4 âˆ’
âˆš
5 âˆ’5, we actually
have a Ì¸= b. Similarly, we prove that c Ì¸= d. Finally, since âˆ’c, âˆ’d < 0 < a, b, we
are ï¬nished.
âŠ“âŠ”
Example 16.11 (Romania) If x1, x2, . . . , xn are positive real numbers for which
x1x2 . . . xn = 1, prove that
n

j=1
1
n âˆ’1 + xj
â‰¤1.
Proof Let p(X) = (X + x1) . . . (X + xn). Problem 3, page 393, gives
pâ€²(x)
p(x) =
n

i=1
1
x + xi
for x Ì¸= âˆ’x1, . . . , âˆ’xn. Hence, we want to show that
pâ€²(n âˆ’1)
p(n âˆ’1) â‰¤1.

404
16
Relations Between Roots and Coefï¬cients
For what is left to do, for 1 â‰¤i â‰¤n let ai = si(x1, . . . , xn) be the i-th symmetric
elementary sum of x1, . . . , xn, and set a0 = 1. Then, we have
p(X) =
n

j=0
ajXnâˆ’j and p(X) =
nâˆ’1

j=0
(n âˆ’j)ajXnâˆ’jâˆ’1,
so that it sufï¬ces to show the inequality
n

j=0
aj(n âˆ’1)nâˆ’j â‰¥
nâˆ’1

j=0
(n âˆ’j)aj(n âˆ’1)nâˆ’jâˆ’1
or, which is the same,
nâˆ’1

j=1
aj(j âˆ’1)(n âˆ’1)nâˆ’jâˆ’1 + an â‰¥na0(n âˆ’1)nâˆ’1 âˆ’a0(n âˆ’1)n.
Finally, we want to prove that
n

j=1
aj(j âˆ’1)(n âˆ’1)nâˆ’jâˆ’1 â‰¥(n âˆ’1)nâˆ’1.
To this end, the inequality between the arithmetic and geometric means (cf. [8], for
instance) furnishes
aj =

i1<Â·Â·Â·<ij
xi1 . . . xij â‰¥
n
j

(n
j)
=

i1<Â·Â·Â·<ij
xi1 . . . xij =
n
j

.
Therefore, it is enough to show that
n

j=1
n
j

(j âˆ’1)(n âˆ’1)nâˆ’jâˆ’1 â‰¥(n âˆ’1)nâˆ’1.
We claim that this last inequality is actually an equality. Indeed, the equality
Xn = (X âˆ’1 + 1)n =
n

k=0
n
k

(X âˆ’1)nâˆ’k
give us, upon differentiation,
nXnâˆ’1 =
nâˆ’1

k=0
(n âˆ’k)
n
k

(X âˆ’1)nâˆ’kâˆ’1.

16.2
Symmetric Polynomials
405
Now, by evaluating the corresponding polynomial functions at x = n, it comes that
nn =
nâˆ’1

k=0
(n âˆ’k)
n
k

(n âˆ’1)nâˆ’kâˆ’1
=
nâˆ’1

k=0
[(n âˆ’1) âˆ’(k âˆ’1)]
n
k

(n âˆ’1)nâˆ’kâˆ’1
=
nâˆ’1

k=0
n
k

(n âˆ’1)nâˆ’k âˆ’
nâˆ’1

k=0
(k âˆ’1)
n
k

(n âˆ’1)nâˆ’kâˆ’1.
On the other hand,
nn = (n âˆ’1 + 1)n =
n

k=0
n
k

(n âˆ’1)nâˆ’k,
so that
n

k=0
n
k

(n âˆ’1)nâˆ’k =
nâˆ’1

k=0
n
k

(n âˆ’1)nâˆ’k âˆ’
nâˆ’1

k=0
(k âˆ’1)
n
k

(n âˆ’1)nâˆ’kâˆ’1.
After performing the obvious cancellations, we arrive at the equality
n
n

(n âˆ’1)nâˆ’n +
nâˆ’1

k=0
(k âˆ’1)
n
k

(n âˆ’1)nâˆ’kâˆ’1 = 0,
which is the same as
n

k=0
(k âˆ’1)
n
k

(n âˆ’1)nâˆ’kâˆ’1 = 0.
At last, from the above we can write
(0 âˆ’1)
n
0

(n âˆ’1)nâˆ’0âˆ’1 +
n

k=1
(k âˆ’1)
n
k

(n âˆ’1)nâˆ’kâˆ’1 = 0,
which is precisely the desired equality.
âŠ“âŠ”

406
16
Relations Between Roots and Coefï¬cients
Problems: Sect. 16.2
1. Let f , g and h be nonzero polynomials in K[X1, . . . , Xn], such that f and g
are symmetric and f = gh. Prove that h is also symmetric.
2. * A polynomial f âˆˆK[X1, . . . , Xn] is said to be homogeneous of degree k if
f (tX1, . . . , tXn) = tkf (X1, . . . , Xn)
for every t âˆˆK. Find, up to multiplication by a constant, all symmetric and
homogeneous polynomials of degree 2 in R[X, Y, Z].
For the next two problems, Sn stands for the set of all permutations of In
3. In R[X1, . . . , Xn], n > 1, let be given a nonzero polynomial
f (X1, . . . , Xn) =

i1,...,in
ai1...aiXi1
1 . . . Xinn .
For Ïƒ âˆˆSn, deï¬ne f Ïƒ âˆˆR[X1, . . . , Xn] by
f Ïƒ(X1, . . . , Xn) = f (XÏƒ(1), . . . , XÏƒ(n)) =

i1,...,in
ai1...aiXi1
Ïƒ(1) . . . Xin
Ïƒ(n).
In this respect, do the following items:
(a) Prove that f Ïƒâ—¦Ï„ = (f Ïƒ)Ï„, for all Ïƒ, Ï„ âˆˆSn.
(b) If f (X1, . . . , Xn) = 0
1â‰¤i<jâ‰¤n(Xi âˆ’Xj), then f Ïƒ = Â±f for every Ïƒ âˆˆ
Sn.
(c) For f as in (b), write f Ïƒ = sgn (Ïƒ)f , with sgn (Ïƒ) âˆˆ{Â±1}. Show that
sgn (Ïƒ â—¦Ï„) = sgn (Ïƒ) sgn (Ï„), for all Ïƒ, Ï„ âˆˆSn.
(d) Let An = {Ïƒ âˆˆSn; sgn (Ïƒ) = 1} (we call the elements of An even
permutations). For Ïƒ, Ï„ âˆˆAn, show that Ïƒ â—¦Ï„ and Ïƒ âˆ’1 also belong to
An.
(e) Given 1 â‰¤k < l â‰¤n, we let Ï„kl denote the transposition corresponding
to k and l, i.e., the permutation of In such that
Ï„kl(i) =
â§
â¨
â©
i, if i Ì¸= k, l
l, if i = k
k, if i = l
.
Prove that sgn (Ï„kl) = âˆ’1, for all 1 â‰¤k < l â‰¤n.
(f) Show that |An| = n!
2 .
4. For f âˆˆK[X1, . . . , Xn], let g âˆˆK[X1, . . . , Xn] be deï¬ned by
g = 1
n!

ÏƒâˆˆSn
f Ïƒ,

16.2
Symmetric Polynomials
407
where f Ïƒ is given as in the previous problem. Prove that g is a symmetric
polynomial, called the symmetrization of f , and that g = f if f is itself
symmetric.
5. (Brazil) It is known that the polynomial f (X) = X3+pX+q has three distinct
real roots. Prove that p < 0.
6. (Croatia) Let a, b and c are pairwise distinct real numbers satisfying the system
of equations
â§
â¨
â©
a3 = 3b2 + 3c2 âˆ’25
b3 = 3c2 + 3a2 âˆ’25
c3 = 3a2 + 3b2 âˆ’25
,
Compute all possible values of the product abc.
7. Given a, b, c âˆˆC ï¬nd, as a function of a, b and c, the coefï¬cients of a monic
polynomial of degree 3 whose complex roots are the cubes of those of X3 +
aX2 + bX + c.
8. Let p, q, r âˆˆR and assume that the complex roots of the polynomial X3 +
pX2 + qX + r are three distinct and positive real numbers. Show that such
roots are the lengths of the sides of a triangle if and only if p3 âˆ’4pq + 8r > 0.
9. (Romania) Let a, b and c be nonzero complex numbers, such that
a + b + c = 1
a + 1
b + 1
c = 0.
If n is a positive integer, show that an + bn + cn = 0 if and only if 3 âˆ¤n.
10. (Hong Kong) Let a3, a4, . . . , a100 be real numbers, with a100 Ì¸= 0. Prove that
the polynomial
f (X) = a100X100 + a99X99 + Â· Â· Â· + a3X3 + 3X2 + 2X + 1
has at least one nonreal root.
11. Consider all straight lines that meet the graph of the polynomial function
f (x) = 2x4 + 7x3 + 3x âˆ’5 in four distinct points (xi, yi), for 1 â‰¤i â‰¤4.
Prove that the number 1
4(x1 +x2 +x3 +x4) does not depend on the chosen line,
and compute its value.
12. (Moldavia) In the cartesian plane, a circle intersects the hyperbola of equation
xy = 1 in four distinct points. Prove that the product of the abscissas of the
intersection point is always equal to 1.
13. (Canadaâ€”adapted) The complex numbers a, b and c are the roots of X3âˆ’X2âˆ’
X âˆ’1.
(a) Prove that a, b and c are pairwise distinct.
(b) If, for each n âˆˆN, we set
Sn = an âˆ’bn
a âˆ’b
+ bn âˆ’cn
b âˆ’c
+ cn âˆ’an
c âˆ’a ,
show that Sk+3 = Sk+2 + Sk+1 + Sk for every k âˆˆN.
(c) Conclude that Sn âˆˆZ, for every n âˆˆN.

408
16
Relations Between Roots and Coefï¬cients
14. (BMOâ€”adapted) For real numbers x and y such that xy Ì¸= âˆ’1, deï¬ne
x âˆ—y = 1 + x + y
1 + xy
.
(a) Given n â‰¥2 positive reals x1, x2, . . . , xn, show that
x1 âˆ—(x2 âˆ—(Â· Â· Â· âˆ—xn) Â· Â· Â· ) =
s1 + s3 + Â· Â· Â· + si
1 + s2 + s4 + Â· Â· Â· + sp
,
where i and p stand for the largest odd and even natural numbers less than
or equal to n, respectively, and sj denotes the j-th elementary symmetric
sum of x1, x2, . . . , xn.
(b) If f (X) = (X + x1)(X + x2) . . . (X + xn), show that
x1 âˆ—(x2 âˆ—(Â· Â· Â· âˆ—xn) Â· Â· Â· ) = f (1) + (âˆ’1)n+1f (âˆ’1)
f (1) + (âˆ’1)nf (âˆ’1) .
15. Given an integer n > 1, ï¬nd all real solutions of the system of equations
â§
âªâªâªâªâ¨
âªâªâªâªâ©
x1 + x2 + Â· Â· Â· + xn = n
x2
1 + x2
2 + Â· Â· Â· + x2
n = n
Â· Â· Â·
xn
1 + xn
2 + Â· Â· Â· + xn
n = n
.
16. (IMOâ€”shortlist) Let f (X) = Xn+anâˆ’1Xnâˆ’1+Â· Â· Â·+a1X+1 be a polynomial
of nonnegative real coefï¬cients and real roots. Prove that f (x) â‰¥(x + 1)n for
every real number x â‰¥0.
17. (Ireland) Find all polynomials f (X) = anXn + Â· Â· Â· + a1X + a0 satisfying the
following conditions:
(a) aj âˆˆ{âˆ’1, 1} for 0 â‰¤j â‰¤n.
(b) All roots of f are real.
16.3
Newtonâ€™s Theorem
Yet with respect to symmetric polynomials, note that f (X, Y, Z) = X4 + Y 4 + Z4
is symmetric, albeit not one of the symmetric polynomials in X, Y, Z which we
called elementary. Nevertheless, letting s1 = s1(X, Y, Z), s2 = s2(X, Y, Z) and
s3 = s3(X, Y, Z), we can write

16.3
Newtonâ€™s Theorem
409
f (X, Y, Z) = (X2 + Y 2 + Z2)2 âˆ’2(X2Y 2 + X2Z2 + Y 2Z2)
=
%
(X + Y + Z)2 âˆ’2(XY + XZ + YZ)
&2
âˆ’2
%
(XY + XZ + YZ)2 âˆ’2XYZ(X + Y + Z)
&
= (s2
1 âˆ’2s2)2 âˆ’2(s2
2 âˆ’2s1s3)
= s4
1 âˆ’4s2
1s2 + 2s2
2 + 4s1s3
= g (s1, s2, s3) ,
where
g(X, Y, Z) = X4 âˆ’4X2Y + 2Y 2 + 4XZ.
Thus, at least in this particular case, we were capable of expressing the symmetric
polynomial f (X, Y, Z) = X4 + Y 4 + Z4 as a polynomial in the elementary
symmetric polynomials in X, Y, Z.
Actually, the coming result, usually attributed to Newton and known in math-
ematical literature as the
fundamental theorem on symmetric polynomials,
assures that this was no accident. In what follows, K includes the possibility K = Z.
Theorem 16.12 (Newton)
If f = f (X1, . . . , Xn) âˆˆK[X1, . . . , Xn] is symmetric,
then there exists g âˆˆK[X1, . . . , Xn] such that
f (X1, . . . , Xn) = g(s1, . . . , sn),
where s1, . . . , sn âˆˆK[X1, . . . , Xn] are the elementary symmetric polynomials in
X1, . . . , Xn.
For the proof of this theorem, we shall need to introduce some preliminary
concepts. Firstly, let us order the monomials in K[X1, . . . , Xn] in the following
way: given two distinct n-tuples (i1, . . . , in) and (j1, . . . , jn) of nonnegative
integers, and monomials a(i)Xi1
1 . . . Xinn and b(j)Xj1
1 . . . Xjn
n in K[X1, . . . , Xn], we
deï¬ne
a(i)Xi1
1 . . . Xinn â‰ºb(j)Xj1
1 . . . Xjn
n
â‡•
âˆƒ1 â‰¤k â‰¤n;
 il = jl if l < k
ik < jk
.
(16.4)
In this case, we say that b(j)Xj1
1 . . . Xjn
n is greater that a(i)Xi1
1 . . . Xinn .
In general, we shall refer to the ordering above as the lexicographic order in
the monomials of K[X1, . . . , Xn]. In particular, for f âˆˆK[X1, . . . , Xn] \ {0}, we
deï¬ne its leading term as the maximum monomial with respect to the lexicographic

410
16
Relations Between Roots and Coefï¬cients
order. Note also that in K[X] one has 1 â‰ºX â‰ºX2 â‰ºÂ· Â· Â· , so that the above notion
of leading term of a polynomial in several indeterminates coincides with the usual
notion in one indeterminate, which is given by the degree of the monomial.
Example 16.13 If f = sk1
1 . . . skn
n , with si âˆˆK[X1, . . . , Xn] standing for the i-th
elementary symmetric polynomial, then f has leading term
Xk1+k2+Â·Â·Â·+kn
1
Xk2+Â·Â·Â·+kn
2
. . . Xknâˆ’1+kn
nâˆ’1
Xkn
n .
(16.5)
Indeed, since
f =
 
i
Xi
k1 
i<j
XiXj
k2 . . .

X1 . . . Xn
kn,
the deï¬nition of lexicographic order guarantees that its leading term is
Xk1
1 (X1X2)k2(X1X2X3)k3 . . . (X1 . . . Xn)kn,
which is exactly (16.5).
With the concept of lexicographic order at our disposal, the key to the proof of
Newtonâ€™s theorem lies in the coming auxiliary result.
Lemma 16.14 If f
âˆˆK[X1, . . . , Xn] is symmetric and a(Î±)XÎ±1
1 . . . XÎ±n
n
is its
leading term, then
Î±1 â‰¥Â· Â· Â· â‰¥Î±n.
Proof If Î±1 is the largest exponent appearing in some monomial of f , then, since f
is symmetric, it contains a monomial with XÎ±1
1 . If a(i)Xi1
1 . . . Xinn is a monomial in
f such that i1 < Î±1, it follows from the deï¬nition of lexicographic order that such
a monomial is not the leading one. Hence, the leading term of f must contain XÎ±1
1 .
Now, among all of the monomials in f containing XÎ±1
1 , choose one with
maximum exponent in one of the indeterminates X2, . . . , Xn, say exponent Î±2.
By invoking again the symmetry of f , there exists such a monomial contain-
ing XÎ±1
1 XÎ±2
2 ; moreover, from the choice of Î±1 we have Î±1 â‰¥Î±2. In turn, if
a(i)XÎ±1
1 Xi2
2 . . . Xinn is a monomial in f such that i2 < Î±2, then (again from the
deï¬nition of lexicographic order) such a monomial is not the leading one, which
shows that the leading term contains XÎ±1
1 XÎ±2
2 . Finally, by repeating the above
argument more n âˆ’2 times, we obtain the desired result.
âŠ“âŠ”
We can ï¬nally present the proof of Newtonâ€™s theorem.
Proof of Theorem 16.12 Take f âˆˆK[X1, . . . , Xn] symmetric, with leading term
a(Î±)XÎ±1
1 . . . XÎ±n
n . By the previous lemma, we have Î±1 â‰¥Â· Â· Â· â‰¥Î±n. On the other
hand, Example 16.13 guarantees that the symmetric polynomial

16.3
Newtonâ€™s Theorem
411
g(X1, . . . , Xn) = a(Î±)sÎ±1âˆ’Î±2
1
sÎ±2âˆ’Î±3
2
. . . sÎ±nâˆ’1âˆ’Î±n
nâˆ’1
sÎ±n
n
also has a(Î±)XÎ±1
1 . . . XÎ±n
n
as its leading term, so that the symmetric polynomial
f âˆ’g has leading term a(Î²)XÎ²1
1 . . . XÎ²n
n , with a(Î²)XÎ²1
1 . . . XÎ²n
n
â‰ºa(Î±)XÎ±1
1 . . . XÎ±n
n
in the lexicographic order. However, since K[X1, . . . , Xn] contains only a ï¬nite
number of monomials which are less than a(Î±)XÎ±1
1 . . . XÎ±n
n
with respect to the
lexicographic order, a ï¬nite number of repetitions of the algorithm above gives us
f âˆ’g = l(s1, . . . , sn), for some polynomial l âˆˆK[X1, . . . , Xn]. Thus, the same
happens with f .
âŠ“âŠ”
It is worth noticing that Newtonâ€™s theorem is mainly an existence result. Indeed, it
is possible to prove that, for generic symmetric polynomials, the algorithm described
in the proof of Theorem 16.12 does not ï¬nish in polynomial time (i.e., even with the
aid of a good computer, we will not be able to use the algorithm to actually express,
in ï¬nite time, a generic symmetric polynomial in n indeterminates as a polynomial
in the corresponding elementary symmetric polynomials). Nevertheless, the coming
example shows that the mere existence guaranteed by Newtonâ€™s theorem can be
quite useful. For another interesting application, see Sect. 20.1.
Example 16.15 (MiklÃ³s Schweitzer) Let f âˆˆZ[X] be a nonconstant polynomial
and Ï‰ = cis 2Ï€
n , where n > 1 is an integer. Prove that
f (Ï‰)f (Ï‰2) . . . f (Ï‰nâˆ’1) âˆˆZ.
Proof Consider the polynomial g âˆˆZ[X1, . . . , Xnâˆ’1] given by
g(X1, . . . , Xnâˆ’1) = f (X1)f (X2) . . . f (Xnâˆ’1).
If Ïƒ is a permutation of Inâˆ’1, then
{Ïƒ(1), Ïƒ(2), . . . , Ïƒ(n âˆ’1)} = {1, 2, . . . , n âˆ’1},
so that
g(XÏƒ(1), . . . , XÏƒ(nâˆ’1)) = f (XÏƒ(1))f (XÏƒ(2)) . . . f (XÏƒ(nâˆ’1))
= f (X1)f (X2) . . . f (Xnâˆ’1)
= g(X1, . . . , Xnâˆ’1).
Thus, g is symmetric and Newtonâ€™s theorem assures the existence of a polynomial
h âˆˆZ[X1, . . . , Xnâˆ’1] such that g(X1, . . . , Xnâˆ’1) = h(s1, . . . , snâˆ’1), i.e.,
f (X1)f (X2) . . . f (Xnâˆ’1) = h(s1, . . . , snâˆ’1),
with sj standing for the j-th elementary symmetric polynomial in X1, . . . , Xnâˆ’1.

412
16
Relations Between Roots and Coefï¬cients
Substituting Xj by Ï‰j in the equality above, we obtain
f (Ï‰)f (Ï‰2) . . . f (Ï‰nâˆ’1) = h(s1(Ï‰, . . . , Ï‰nâˆ’1), . . . , snâˆ’1(Ï‰, . . . , Ï‰nâˆ’1)).
Therefore, in order to show that f (Ï‰)f (Ï‰2) . . . f (Ï‰nâˆ’1) âˆˆZ, it sufï¬ces to show
that sj(Ï‰, . . . , Ï‰nâˆ’1) âˆˆZ for 1 â‰¤j â‰¤n âˆ’1.
For what is left to do, just note that
Xn âˆ’1 = (X âˆ’1)(X âˆ’Ï‰)(X âˆ’Ï‰2) . . . (X âˆ’Ï‰nâˆ’1)
= (X âˆ’1)(Xnâˆ’1 + Xnâˆ’2 + Â· Â· Â· + X + 1),
so that
Xnâˆ’1 + Xnâˆ’2 + Â· Â· Â· + X + 1 = (X âˆ’Ï‰)(X âˆ’Ï‰2) . . . (X âˆ’Ï‰nâˆ’1)
=
nâˆ’1

j=0
(âˆ’1)jsj(Ï‰, Ï‰2, . . . , Ï‰nâˆ’1)Xnâˆ’1âˆ’j.
Hence, we have
sj(Ï‰, Ï‰2, . . . , Ï‰nâˆ’1) = (âˆ’1)j âˆˆZ,
as wished.
âŠ“âŠ”
The discussion preceding the former example hints to the following fact: if we
wish to effectively express a given symmetric polynomial as a polynomial in the
elementary symmetric polynomials in the same number of indeterminates, we shall
usually have to rely on ad hoc arguments. In this sense, we end this section by
discussing a relevant example, for which we shall need the following consequence of
Horner-Ruï¬nniâ€™s algorithm. Identities (16.6) below are known as Horner-Rufï¬niâ€™s
identities.
Lemma 16.16 (Horner-Ruï¬nni) Let
f (X) = Xn âˆ’s1Xnâˆ’1 + Â· Â· Â· + (âˆ’1)nâˆ’1snâˆ’1X + (âˆ’1)nsn
be a nonconstant polynomial over C. If z is a complex root of f and
g(X) = Xnâˆ’1 + b1Xnâˆ’2 + Â· Â· Â· + bnâˆ’1
is the quotient upon division of f (X) by X âˆ’z, then

16.3
Newtonâ€™s Theorem
413
â§
âªâªâªâªâªâªâªâªâªâ¨
âªâªâªâªâªâªâªâªâªâ©
b1 = z âˆ’s1
b2 = z2 âˆ’s1z + s2
Â· Â· Â·
Â· Â· Â·
bk+1 = zk+1 âˆ’s1zk + Â· Â· Â· + (âˆ’1)k+1sk+1
Â· Â· Â·
Â· Â· Â·
bnâˆ’1 = znâˆ’1 âˆ’s1znâˆ’2 + Â· Â· Â· + (âˆ’1)nâˆ’1snâˆ’1
.
(16.6)
Proof In the stated notations, the recurrence formulas (15.1) can be written as
â§
âªâªâªâªâªâªâªâªâªâ¨
âªâªâªâªâªâªâªâªâªâ©
b1 = z âˆ’s1
b2 = zb1 + s2
Â· Â· Â·
Â· Â· Â·
bk+1 = zbk + (âˆ’1)k+1sk+1
Â· Â· Â·
Â· Â· Â·
bnâˆ’1 = zbnâˆ’2 + (âˆ’1)nâˆ’1snâˆ’1
.
By solving the linear system above successively for b2, . . . , bnâˆ’1, we obtain, one by
one, the stated relations.
âŠ“âŠ”
The relations contained in the coming result will give us recurrences that express
the symmetric polynomial
Ïƒk(X1, X2, . . . , Xn) = Xk
1 + Xk
2 + Â· Â· Â· + Xk
n
as a polynomial in the elementary symmetric polynomials in X1, X2, . . . , Xn.
The formulas of items (a) and (b) will be respectively referred to as the ï¬rst and
second Jacobiâ€™s identities.2 For a proof of them using generating functions, see
Example 21.19.
Proposition 16.17 (Jacobi)
For z1, . . . , zn âˆˆC, if si = si(z1, . . . , zn) denotes the
i-th elementary symmetric sum of z1, . . . , zn and Ïƒk = zk
1 + Â· Â· Â· + zk
n, then:
(a) Ïƒn+k = n
j=1(âˆ’1)jâˆ’1sjÏƒn+kâˆ’j for k â‰¥1.
(b) sk+1 =
1
k+1
k+1
j=1(âˆ’1)jâˆ’1sk+1âˆ’jÏƒj for 1 â‰¤k â‰¤n âˆ’1.
Proof
(a) Let
f (X) = (X âˆ’z1) Â· Â· Â· (X âˆ’zn) = Xn âˆ’s1Xnâˆ’1 + Â· Â· Â· + (âˆ’1)nsn.
(16.7)
2Carl Gustav Jakob Jacobi, German mathematician of the nineteenth century.

414
16
Relations Between Roots and Coefï¬cients
Since zi is a root of f , we have
zn
i âˆ’s1znâˆ’1
i
+ Â· Â· Â· + (âˆ’1)nâˆ’1snâˆ’1zi + (âˆ’1)nsn = 0
for 1 â‰¤i â‰¤n, and thus
zk+n
i
âˆ’s1zk+nâˆ’1
i
+ Â· Â· Â· + (âˆ’1)nâˆ’1snâˆ’1zk+1
i
+ (âˆ’1)nsnzk
i = 0.
By adding the equalities above for 1 â‰¤i â‰¤n, we obtain
Ïƒn+k âˆ’s1Ïƒn+kâˆ’1 + Â· Â· Â· + (âˆ’1)nâˆ’1snâˆ’1Ïƒk+1 + (âˆ’1)nsnÏƒk = 0,
an equality that is equivalent to the stated one.
(b) It follows from (16.7) that
f â€²(X) = nXnâˆ’1 âˆ’(n âˆ’1)s1Xnâˆ’2 + Â· Â· Â· + (âˆ’1)nâˆ’1snâˆ’1.
(16.8)
On the other hand, for z âˆˆC \ {z1, . . . , zn}, Problem 3, page 393 gives
f â€²(z) = f (z)
z âˆ’z1
+ Â· Â· Â· + f (z)
z âˆ’zn
.
If fj âˆˆC[X] is such that f (X) = (X âˆ’zj)fj(X), say
fj(X) = Xnâˆ’1 + b1jXnâˆ’2 + Â· Â· Â· + bnâˆ’1,j,
we get
f â€²(z) =
n

j=1
fj(z) =
n

j=1
(znâˆ’1 + b1jznâˆ’2 + Â· Â· Â· + bnâˆ’1,j)
= nznâˆ’1 +

n

j=1
b1j

znâˆ’2 + Â· Â· Â· +

n

j=1
bnâˆ’1,j

.
However, since the equality above is true for every z
âˆˆ
C \ {z1, . . . , zn},
Corollary 15.10 gives
f â€²(X) = nXnâˆ’1 +

n

j=1
b1j

Xnâˆ’2 + Â· Â· Â· +

n

j=1
bnâˆ’1,j

.
(16.9)
Finally, by equating the corresponding coefï¬cients in (16.8) and (16.9) and
substituting identities (16.6), we obtain

16.3
Newtonâ€™s Theorem
415
(âˆ’1)k+1(n âˆ’k âˆ’1)sk+1 =
n

j=1
bk+1,j
=
n

j=1
(zk+1
j
âˆ’s1zk
j + Â· Â· Â· + (âˆ’1)k+1sk+1)
= Ïƒk+1 âˆ’s1Ïƒk + Â· Â· Â· + (âˆ’1)k+1nsk+1,
so that
(k + 1)sk+1 = skÏƒ1 âˆ’skâˆ’1Ïƒ2 + Â· Â· Â· + (âˆ’1)ks0Ïƒk+1.
âŠ“âŠ”
The coming result is also due to Jacobi.
Corollary 16.18 (Jacobi) For each integer k â‰¥1, let sk denote the k-th elementary
symmetric polynomial in X1, . . . , Xn, and Ïƒk = Xk
1 + Â· Â· Â· + Xk
n. Then:
(a) Ïƒn+k = n
j=1(âˆ’1)jâˆ’1sjÏƒn+kâˆ’j for k â‰¥1.
(b) sk+1 =
1
k+1
k+1
j=1(âˆ’1)jâˆ’1sk+1âˆ’jÏƒj for 1 â‰¤k â‰¤n âˆ’1.
Proof The previous proposition assures that both sides of (a) and (b) are equal upon
evaluation in arbitrary z1, . . . , zn âˆˆC. Since C is an inï¬nite set, Proposition 16.1
guarantees the equality of the corresponding polynomials.
âŠ“âŠ”
Problems: Sect. 16.3
1. If f
âˆˆZ[X] is a monic polynomial of degree n â‰¥1 and complex roots
z1, . . . , zn, prove that zk
1 + Â· Â· Â· + zk
n âˆˆZ for every integer k â‰¥1.
2. If a1, . . . , an, b1, . . . , bn are complex numbers such that
ak
1 + Â· Â· Â· + ak
n = bk
1 + Â· Â· Â· + bk
n
for 1 â‰¤k â‰¤n, show that {a1, . . . , an} = {b1, . . . , bn}.
3. (Japanâ€”adapted) Let n, k âˆˆN, with 2 â‰¤k â‰¤n, and a1, . . . , ak real numbers
such that
â§
âªâªâ¨
âªâªâ©
a1 + Â· Â· Â· + ak = n
a2
1 + Â· Â· Â· + a2
k = n
. . .
ak
1 + Â· Â· Â· + ak
k = n
.
If p(X) = (X + a1) . . . (X + ak), prove that p(X) = k
j=0
n
j

Xkâˆ’j.

416
16
Relations Between Roots and Coefï¬cients
4. Let m âˆˆN, Ï‰ = cos 2Ï€
m + i sin 2Ï€
m and z1, . . . , zn be complex numbers such that
f (X) = (X âˆ’z1)(X âˆ’z2) . . . (X âˆ’zn) âˆˆZ[X].
(a) If g(X) = 0mâˆ’1
j=0 f (Ï‰jX), prove that
g(X) = (Xm âˆ’zm
1 ) . . . (Xm âˆ’zm
n ).
(b) Show that the polynomial g also has integer coefï¬cients.
(c) Conclude that if z âˆˆC is a root of a nonzero polynomial with integer
coefï¬cients, then so is zm, for every m âˆˆN.
5. (Brazilâ€”adapted)
(a) Given n âˆˆN, prove that there is at most a ï¬nite number of monic
polynomials of degree n and integer coefï¬cients, such that all of their
complex roots have modulus 1.
(b) Let f âˆˆZ[X] \ Z be a monic polynomial all of whose complex roots have
modulus 1. Prove that all of them are roots of unity.

Chapter 17
Polynomials Over R
This chapter revisits, for real polynomials and departing from the fundamen-
tal theorem of Algebra, some classical theorems of Calculus. As applications
of them, we shall prove Newtonâ€™s inequalities, which generalizes the classical
inequality between the arithmetic and geometric means of n positive real num-
bers, and Descartesâ€™ rule, which relates the number of positive roots of a real
polynomial with the number of changes of sign in the sequence of its nonzero
coefï¬cients.
17.1
Some Calculus Theorems
In this section we establish, for real polynomials, some classical results on continu-
ity and differentiability. For a more general approach, we refer the reader to [3] or
[8], for instance.
Our ï¬rst result provides a sufï¬cient way for the existence of real roots in a given
interval. For the proof of it, we shall need the following auxiliary result, which
appeared as Problem 6, page 386. Nevertheless, this time we give a different proof.
Lemma 17.1 If f âˆˆR[X] \ {0} is monic and has no real roots, then there exist
polynomials g, h âˆˆR[X] such that f = g2 + h2. In particular, f (x) > 0 for every
x âˆˆR.
Proof Problem 4, page 386, assures the existence of complex nonreal numbers
z1, . . . , zk such that
f (X) =
k
j=1
(X âˆ’zj)(X âˆ’zj).
Â© Springer International Publishing AG, part of Springer Nature 2018
A. Caminha Muniz Neto, An Excursion through Elementary Mathematics, Volume III,
Problem Books in Mathematics, https://doi.org/10.1007/978-3-319-77977-5_17
417

418
17
Polynomials Over R
Now, if zj = aj + ibj, with aj, bj âˆˆR, then
(X âˆ’zj)(X âˆ’zj) = (X âˆ’aj âˆ’ibj)(X âˆ’aj + ibj)
= (X âˆ’aj)2 âˆ’(ibj)2
= (X âˆ’aj)2 + b2
j,
the sum of the squares of two real polynomials (one of them being constant).
It now sufï¬ces to apply several times the analogous of Eulerâ€™s identity (12.8) for
polynomials: for g1, g2, h1, h2 âˆˆR[X], we have
(g2
1 + h2
1)(g2
2 + h2
2) = (g1g2 + h1h2)2 + (g1h2 âˆ’g2h1)2.
For what is left to do, it follows from the ï¬rst part that
f (x) = g(x)2 + h(x)2 â‰¥0,
for every x âˆˆR. However, since f has no real roots, the inequality above must be
strict, for every x âˆˆR.
âŠ“âŠ”
The coming result is nothing but the intermediate value theorem for polynomials,
being known in mathematical literature as Bolzanoâ€™s theorem.1
Theorem 17.2 (Bolzano) If f âˆˆR[X] and a < b are real numbers such that
f (a)f (b) < 0, then there exists c âˆˆ(a, b) for which f (c) = 0.
Proof Assuming, without loss of generality, that f is monic and f (a) < 0 < f (b),
the last part of the previous lemma assures that f has at least one real root. Let
a1 â‰¤Â· Â· Â· â‰¤ak be the real roots of f , repeated according to their multiplicities. If
g âˆˆR[X] is such that
f (X) = g(X)(X âˆ’a1) . . . (X âˆ’ak),
then g is monic and has no real roots, so that (again by the previous lemma) g(x) >
0 for every x âˆˆR.
By contradiction, suppose that no real root of f belongs to the interval (a, b),
and separately consider the three following cases:
(i) ak < a: we have
f (a) = g(a)(a âˆ’a1) . . . (a âˆ’ak) > 0,
which is a contradiction.
1Bernhard Bolzano, German mathematician of the nineteenth century.

17.1
Some Calculus Theorems
419
(ii) b < a1: it follows from f (b) > 0 that
g(b)(b âˆ’a1) . . . (b âˆ’ak) > 0
and, hence, k is even (for g(b) > 0 and b âˆ’ai < 0 for 1 â‰¤i â‰¤k). On the
other hand, since f (a) < 0, we get
g(a)(a âˆ’a1) . . . (a âˆ’ak) < 0,
so that k is odd (for g(a) > 0 and a âˆ’ai < 0 for 1 â‰¤i â‰¤k). We have, thus,
reached a contradiction.
(iii) al < a < b < al+1, for some 1 â‰¤l < k: we can arrive at a contradiction in a
way similar to that of item (ii). For instance,
0 < f (a) = g(a)

>0
(a âˆ’a1) . . . (a âˆ’al)



>0
(a âˆ’al+1) . . . (a âˆ’ak)



<0
implies k âˆ’l even.
âŠ“âŠ”
Example 17.3 (Moldavia) Let f, g âˆˆR[X] be two given polynomials, each of
which possessing at least one real root.
(a) Prove that there exists a âˆˆR such that f (a)2 = g(a)2.
(b) If f (1 + X + g(X)2) = g(1 + X + f (X)2), show that f = g.
Proof
(a) Let Î± and Î² be real roots of f and g, respectively. We can assume, without any
loss of generality, that Î± â‰¤Î². If g(Î±) = 0 or f (Î²) = 0, there is nothing to do.
Otherwise,
f (Î±)2 âˆ’g(Î±)2 = âˆ’g(Î±)2 < 0 and f (Î²)2 âˆ’g(Î²)2 = f (Î²)2 > 0,
so that Bolzanoâ€™s theorem, applied to the polynomial f (X)2 âˆ’g(X)2, guaran-
tees the existence of a âˆˆ(Î±, Î²) such that f (a)2 âˆ’g(a)2 = 0.
(b) Choose a âˆˆR as in item (a) and deï¬ne a sequence (un)nâ‰¥1 by letting u0 = a
and, for each integer n â‰¥1, un+1 = 1 + un + g(un)2. It follows from (a) that
f (u1) = g(u1). Now assume, as induction hypothesis, that f (uk) = g(uk) for
some integer k â‰¥1. Then,
f (uk+1) = f (1 + uk + g(uk)2)
= g(1 + uk + f (uk)2)
= g(1 + uk + g(uk)2) = g(uk+1).

420
17
Polynomials Over R
Thus, we have f (un) = g(un) for every integer n â‰¥1, with
un+1 = 1 + un + g(un)2 â‰¥1 + un > un
for each such n â‰¥1. Therefore, Corollary 15.10 gives f = g.
âŠ“âŠ”
In what comes next, we establish, for polynomials, Lagrangeâ€™s mean value
theorem.
Theorem 17.4 (Lagrange) Let f âˆˆR[X] \ {0} and a < b be given real numbers.
Then, there exists a < c < b such that
f â€²(c) = f (b) âˆ’f (a)
b âˆ’a
.
Proof We may assume that f Ì¸= 0, and ï¬rst show that if f (a) = f (b) = 0, then
there exists a < c < b for which f â€²(c) = 0. Without any loss of generality, we
can assume that f has no other roots in the interval (a, b). Indeed, since f Ì¸= 0,
Corollary 15.9 assures that f has at most a ï¬nite number of roots in (a, b); then, if
these are a1 < a2 < Â· Â· Â· < ak, it sufï¬ces to consider a1 in place of b.
If there exist a < c < d < b such that f (c)f (d) < 0, Bolzanoâ€™s theorem
guarantees the existence of a root of f in the interval (a, b) which is an absurd.
Hence, f has constant sign along the interval (a, b). Assume, without loss of
generality, that f (x) > 0 for x âˆˆ(a, b), and let k and l be the multiplicities of
a and b as roots of f , respectively. Then, there exists g âˆˆR[X] such that
f (X) = (X âˆ’a)k(X âˆ’b)lg(X),
with g(a), g(b) Ì¸= 0. Now,
a < c < b â‡’f (c) > 0 â‡’(c âˆ’a)k(c âˆ’b)lg(c) > 0 â‡’(âˆ’1)lg(c) > 0.
We look at the case of an even l (that of odd l can be dealt with in an analogous
way), so that g(c) > 0 for every c âˆˆ(a, b). If g(a) < 0, then Bolzanoâ€™s theorem
would assure the existence of a < d < a+b
2
such that g(d) = 0; in turn, this would
give f (d) = 0, which is impossible. Therefore, g(a) > 0 and, likewise, g(b) > 0.
We then have
f â€²(X) = k(X âˆ’a)kâˆ’1(X âˆ’b)lg(X) + l(X âˆ’a)k(X âˆ’b)lâˆ’1g(X)
+ (X âˆ’a)k(X âˆ’b)lgâ€²(X)
= (X âˆ’a)kâˆ’1(X âˆ’b)lâˆ’1h(X),

17.1
Some Calculus Theorems
421
with
h(X) = (k(X âˆ’b) + l(X âˆ’a))g(X) + (X âˆ’a)(X âˆ’b)gâ€²(X).
It now sufï¬ces to show that there exists c âˆˆ(a, b) such that h(c) = 0. However,
since
h(a)h(b) = âˆ’kl(a âˆ’b)2g(a)g(b) < 0,
an application of Bolzanoâ€™s theorem does the job.
For the general case, let
f1(X) = f (X) âˆ’f (a) âˆ’
f (b) âˆ’f (a)
b âˆ’a

(X âˆ’a),
which is also a polynomial. Since f1(a) = f1(b) = 0, what we did above guarantees
the existence of c âˆˆ(a, b) such that f â€²
1(c) = 0. Finally, it is enough to note that
f â€²
1(X) = f â€²(X) âˆ’
f (b) âˆ’f (a)
b âˆ’a

.
âŠ“âŠ”
The case f (a) = f (b) = 0 in the previous result preceded the general version
due to Lagrange. For this reason, it is usually referred to as RÃ´lleâ€™s theorem, in
honor of his discoverer, the French mathematician of the seventeenth century Michel
RÃ´lle.
Corollary 17.5 (RÃ´lle) If f âˆˆR[X] and a < b are real numbers such that f (a) =
f (b) = 0, then there exists a < c < b for which f â€²(c) = 0.
The coming example illustrates a typical use of RÃ´lleâ€™s theorem.
Example 17.6 Let f (X) = a0+a1X+Â· Â· Â·+anâˆ’1Xnâˆ’1+anXn be a real polynomial
such that
a0
1 + a1
2 + Â· Â· Â· + anâˆ’1
n
+
an
n + 1 = 0.
Prove that f has at least one root in the open interval (0, 1).
Proof It is clear that f = gâ€², where g is the real polynomial
g(X) = a0X + a1
2 X2 + Â· Â· Â· + anâˆ’1
n
Xn +
an
n + 1Xn+1.
Since g(0) = g(1) = 0, RÃ´lleâ€™s theorem assures the existence of a âˆˆ(0, 1) such
that f (a) = gâ€²(a) = 0.
âŠ“âŠ”

422
17
Polynomials Over R
An important consequence of Lagrangeâ€™s mean value theorem is the study of the
ï¬rst variation (i.e., of the growth or decay) of real polynomials. This is the subject
of the coming corollary.
Corollary 17.7 Let f âˆˆR[X] \ {0} and I âŠ‚R be an interval.
(a) If f â€²(x) > 0 for every x âˆˆI, then f increases in I.
(b) If f â€²(x) < 0 for every x âˆˆI, then f decreases in I.
Proof Let us prove item (a), the proof of (b) being entirely analogous. For a < b in
I, the mean value theorem furnishes c âˆˆ(a, b) (and, hence, c âˆˆI) such that
f (b) âˆ’f (a)
b âˆ’a
= f â€²(c) > 0.
In particular, f (b) > f (a).
âŠ“âŠ”
The coming example uses a little more Calculus than we discussed above. As
before, we refer the reader to [3] or [8] for the necessary background.
Example 17.8 (Sweden) Prove that, for every natural number n, the real polynomial
1 + X + 1
2!X2 + Â· Â· Â· + 1
n!Xn
has at most one real root.
Proof Letting fn = 1 + X + X2
2! + Â· Â· Â· + Xn
n! , we shall show that (i) fn has no real
roots if n is even, and (ii) fn has exactly one real root if n is odd.
(i) Assuming n even, we have lim|x|â†’+âˆfn(x) = +âˆ. Hence, Weierstrassâ€™
theorem (Theorem 8.26 of [8]) assures the existence of x0 âˆˆR such that fn
assumes its minimum value at x0. Suppose, for the sake of contradiction, that
fn(x0) â‰¤0. Then, Problem 3 gives f â€²
n(x0) = 0, and then
0 â‰¥fn(x0) = f â€²
n(x0) + xn
0
n! = xn
0
n! .
Since n is even, the inequality above successively gives x0 = 0 and fn(0) = 0,
which is an absurd.
(ii) Assuming n odd, Problem 5, page 386, gives an odd number of real roots for
fn. On the other hand, since f â€²
n = fnâˆ’1 > 0 (for n âˆ’1 is even), Example 15.33
shows that fn has no multiple roots. By the sake of contradiction, suppose that
fn has at least two distinct real roots, say a < b. Then, RÃ´lleâ€™s theorem gives
Î± âˆˆ(a, b) such that f â€²
n(Î±) = 0. This way, fnâˆ’1(Î±) = 0, and this contradicts
(i), for n âˆ’1 is even.
âŠ“âŠ”

17.1
Some Calculus Theorems
423
Problems: Sect. 17.1
1. If f âˆˆZ[X] \ Z and m âˆˆN is such that m > 1 + Re(z), for every complex root
z of f , prove that |f (m)| > 1.
2. * Prove, for real polynomials and with the methods of this section, the sign
preserving lemma: if f âˆˆR[X] is such that f (a) > 0 for some a âˆˆR, then
there exists r > 0 such that f (x) > 0 for every x âˆˆ(a âˆ’r, a + r).
3. * Given f âˆˆR[X] \ R, let a âˆˆR and r > 0 be such that
f (a) = min{f (x); x âˆˆ(a âˆ’r, a + r)}.
Prove that f â€²(a) = 0.
4. Let f (X) = X5 âˆ’2X4 + 2. Prove that f has exactly three real roots.
5. We are given a real nonconstant polynomial f with positive leading coefï¬cient.
Prove that there exists n0 âˆˆN for which
u > v > n0 â‡’f (u) > f (v) > 0.
6. Prove that there does not exist a polynomial f âˆˆZ[X] such that f (n) is prime
for every nonnegative integer n.
7. (Leningrad) Decide whether there exist four distinct real numbers a, b, c and d
such that, for any two of them, say x and y, we have
x10 + x9y + Â· Â· Â· + xy9 + y10 = 1.
8. The positive reals a1, a2, a3, a4 are such that a1 â‰¤a2 â‰¤a3 â‰¤a4 and
a1a2a3a4 = 1. If Î» is a real root of
X3 âˆ’

4

i=1
ai

X2 +


1â‰¤i<jâ‰¤4
aiaj

X âˆ’

4

i=1
1
ai

,
prove that Î» > a2.
9. (Leningrad) Let a, b, c, d and e be real numbers such that the polynomial aX2+
(c âˆ’b)X +(e âˆ’d) = 0 has a real root greater than 1. Prove that the polynomial
aX4 + bX3 + cX2 + dX + e = 0 has at least one real root.
10. (Austrian-Polish) Given any real numbers a1, . . . , an, prove that
n

i,j=1
aiaj
i + j â‰¥0,
with equality if and only if a1 = Â· Â· Â· = an = 0.
11. Let f (X) = X3 âˆ’3X + 1. Compute the number of distinct real roots of the
polynomial f (f (X)).

424
17
Polynomials Over R
12. (Sweden) Let f âˆˆR[X] be a polynomial of degree n. If f (x) â‰¥0 for every
x âˆˆR, show that
f (x) + f â€²(x) + f â€²â€²(x) + Â· Â· Â· + f (n)(x) â‰¥0,
also for every x âˆˆR.
13. (Soviet Union) Two mathematicians A and B play the following game: it is
given a polynomial of even degree greater than 4,
f (X) = X2n + a2nâˆ’1X2nâˆ’1 + Â· Â· Â· + a1X + 1,
with a1, . . . , a2nâˆ’1 real numbers to be chosen. The players, starting from A,
alternate themselves in choosing the coefï¬cients of f , until it is completely
determined. At the end, A wins if none of the roots of f is real, and B wins
otherwise. Find a winning strategy for B.
14. At the beginning of a class, the teacher wrote a third degree real polynomial in
the blackboard. Then, the students alternated themselves, each one performing
one of the following operations with the polynomial written in the blackboard
(which was then substituted by a new one):
(a) Add, to the written polynomial, its derivative.
(b) Subtract, to the written polynomial, its derivative.
At the end of the class, the polynomial initially written by the teacher
reappeared in the blackboard. Prove that at least one of the students made a
mistake.
15. (OIM, IMOâ€”adapted) We are given real numbers a1, a2, . . . , an, with 0 <
a1 < a2 < Â· Â· Â· < an. If f : R \ {âˆ’a1, . . . , âˆ’an} â†’R is given by
f (x) =
n

j=1
aj
x + aj
,
prove that the set {x âˆˆR; f (x) â‰¥1} consists of the union of n bounded,
pairwise disjoint intervals, with sum of lengths equal to a1 + a2 + Â· Â· Â· + an.
17.2
Newtonâ€™s Inequalities
In this section, we present a set of inequalities that reï¬ne the inequality between
the arithmetic and geometric means of a ï¬nite set of positive real numbers (cf.
Section 5.1 of [8], for instanceâ€”actually, there we give four different proofs of
such an inequality). To this end, we ï¬rst need the following auxiliary result.

17.2
Newtonâ€™s Inequalities
425
Lemma 17.9 If f âˆˆR[X] \ {0} has k real roots, counted with multiplicities, then
f â€² has at least k âˆ’1 real roots, also counted with multiplicities. In particular, if all
roots of f are real, then so are all of the roots of f â€².
Proof For the ï¬rst part, we can assume that k > 1. Let a1 < Â· Â· Â· < al be the
distinct real roots of f , with multiplicities respectively equal to m1, . . . , ml, so that
m1 + Â· Â· Â· + ml = k. We have already seen, in Proposition 15.31 that ai is a root of
f â€² with multiplicity mi âˆ’1. On the other hand, RÃ´lleâ€™s theorem assures that f â€² has
at least one additional root between ai and ai+1; since there are l âˆ’1 intervals of
the form (ai, ai+1), we thus count at least
(m1 âˆ’1) + Â· Â· Â· + (ml âˆ’1) + (l âˆ’1) = k âˆ’1
real roots for f â€².
For the second part, assume that f has degree n and n real roots, counted with
multiplicities. Then, f â€² has degree n âˆ’1 and, by the ï¬rst part, at least n âˆ’1 real
roots, also counted with multiplicities. Therefore, all roots of f â€² are real too.
âŠ“âŠ”
For what comes next, given n > 1 real numbers a1, a2, . . . , an and an index
1 â‰¤j â‰¤n, we shall write Sj(ak) to denote the j-th elementary symmetric sum
of a1, . . . , an, and Hj(ak) to denote the arithmetic mean of the
n
j

summands that
compose Sj(ak), i.e.,
Hj(ak) = Sj(ak)
n
j

= 1
n
j


i1<...<ij
ai1 . . . aij .
The coming result is usually credited to Newton, and inequalities (17.1) are
usually referred to as Newtonâ€™s inequalities. For the sake of notation, we let
H0 = 1.
Theorem 17.10 (Newton) Let n > 1 be an integer and a1, a2, . . . , an be given real
numbers. If H1(ak), H2(ak), . . . , Hj+1(ak) Ì¸= 0 for some 1 â‰¤j < n, then
Hj(ak)2 â‰¥Hjâˆ’1(ak)Hj+1(ak),
(17.1)
with equality if and only if a1 = a2 = . . . = an.
Proof Let us make induction on n. For n = 2, we want to show that H 2
1 (a1, a2) â‰¥
H0(a1, a2)H2(a1, a2) or, which is the same,
 a1+a2
2
2 â‰¥a1a2. But this is equivalent
to (a1 âˆ’a2)2 â‰¥0, which turns into an equality if and only if a1 = a2.
Assume, by induction hypothesis, that for any n âˆ’1 given real numbers b1, . . . ,
bnâˆ’1 such that H1(bk), H2(bk), . . . , Hj+1(bk) Ì¸= 0 for some 1 â‰¤j < n âˆ’1, we
have Hj(bk)2 â‰¥Hjâˆ’1(bk)Hj+1(bk), with equality if and only if b1 = . . . = bnâˆ’1.
We now consider n â‰¥3 real numbers a1, a2, . . . , an, and let
f (X) = (X + a1) . . . (X + an).

426
17
Polynomials Over R
The previous lemma assures the existence of n âˆ’1 real numbers b1, . . . , bnâˆ’1 such
that bk âˆˆ(ak, ak+1) for 1 â‰¤k < n and
f â€²(X) = n(X + b1) . . . (X + bnâˆ’1).
In particular,
1
nf â€²(X) = Xnâˆ’1 +
n âˆ’1
1

H1(bk)Xnâˆ’2 + Â· Â· Â· +
n âˆ’1
n âˆ’1

Hnâˆ’1(bk).
(17.2)
On the other hand, the equality
f (X) =
n

j=0
n
j

Hj(ak)Xnâˆ’j
furnishes
f â€²(X) =
nâˆ’1

j=0
(n âˆ’j)
n
j

Hj(ak)Xnâˆ’jâˆ’1
= n
nâˆ’1

j=0
n âˆ’1
j

Hj(ak)Xnâˆ’1âˆ’j,
and comparing coefï¬cients with (17.2) we obtain, for 0 â‰¤j â‰¤n âˆ’1,
Hj(a1, . . . , an) = Hj(b1, . . . , bnâˆ’1).
Now, assume that H1(ak), H2(ak), . . . , Hj+1(ak) Ì¸= 0 for some 1 â‰¤j â‰¤n âˆ’2.
Then, H1(bk), H2(bk), . . . , Hj+1(bk) Ì¸= 0 and, by induction hypothesis, for 1 â‰¤
j â‰¤n âˆ’2 we have
H 2
j (ak) = H 2
j (bk) â‰¥Hjâˆ’1(bk)Hj+1(bk) = Hjâˆ’1(ak)Hj+1(ak).
(17.3)
For the equality, if H 2
j (ak) = Hjâˆ’1(ak)Hj+1(ak) for some 1 â‰¤j â‰¤n âˆ’2,
then (17.3) gives H 2
j (bk) = Hjâˆ’1(bk)Hj+1(bk). Therefore, the condition for
equality in the induction hypothesis furnishes b1 = . . . = bnâˆ’1, and from this it
is almost immediate (cf. Problem 1) to show that a1 = . . . = an.
We are left to proving that, if H1(ak), H2(ak), . . . , Hn(ak) Ì¸= 0, then
H 2
nâˆ’1(ak) â‰¥Hnâˆ’2(ak)Hn(ak),
with equality if and only if a1 = . . . = an. We shall prove that this is true provided
we merely have Hn(ak) Ì¸= 0. Indeed, in what concerns the desired inequality, it is

17.2
Newtonâ€™s Inequalities
427
the same as proving that
>
n
n âˆ’1
âˆ’1
n

i=1
a1 . . .*ai . . . an
?2
â‰¥
â‰¥
â¡
â£

n
n âˆ’2
âˆ’1
n

i<j
a1 . . .*ai . . .*aj . . . an
â¤
â¦
>n
n
âˆ’1
a1 . . . an
?
.
Letting P = a1 . . . an, we observe that to prove the above inequality is the same as
to establish that
"
1
n
n

i=1
P
ai
#2
â‰¥
2P
n(n âˆ’1)

i<j
P
aiaj
,
or
(n âˆ’1)
" n

i=1
1
ai
#2
â‰¥2n

i<j
1
aiaj
.
If we set Î±i = 1
ai , we wish to show that
(n âˆ’1)
" n

i=1
Î±i
#2
â‰¥2n

i<j
Î±iÎ±j.
Denoting S = (n âˆ’1)
n
i=1 Î±i
2 âˆ’2n 
i<j Î±iÎ±j, we compute
S = (n âˆ’1)
n

i=1
Î±2
i + 2(n âˆ’1)

i<j
Î±iÎ±j âˆ’2n

i<j
Î±iÎ±j
= (n âˆ’1)
n

i=1
Î±2
i âˆ’2

i<j
Î±iÎ±j
=

i<j
(Î±i âˆ’Î±j)2 â‰¥0.
Now, it is clear that equality holds if and only if Î±1 = . . . = Î±n, i.e., if and only if
a1 = . . . = an.
âŠ“âŠ”
The coming corollary, due to the Scottish mathematician of the eighteenth
century Colin McLaurin, embodies the promised reï¬nement of the inequality
between the arithmetic and geometric means. Inequalities (17.4) are then known
as McLaurin inequalities.

428
17
Polynomials Over R
Corollary 17.11 (McLaurin) For n > 1 positive real numbers a1, a2, . . . , an, we
have
H1(ak) â‰¥
:
H2(ak) â‰¥
3:
H3(ak) â‰¥. . . â‰¥
n:
Hn(ak),
(17.4)
with equality at each of the above inequalities if and only if a1 = . . . = an.
Proof For the sake of simplicity, write Hj in place of Hj(ak). Newtonâ€™s inequalities
give us
H 2
1 â‰¥H0H2 = H2 and H 2
2 â‰¥H1H3.
Therefore, H 4
1 â‰¥H 2
2 â‰¥H1H3, so that H 3
1 â‰¥H3. In turn, this last inequality,
together with the second inequality above, gives
H 2
2 â‰¥H1H3 â‰¥H 1/3
3
H3 = H 4/3
3
and, thus,
H1 â‰¥H 1/2
2
â‰¥H 1/3
3
.
Assume we had already proved that
H1 â‰¥H 1/2
2
â‰¥Â· Â· Â· â‰¥H 1/(kâˆ’1)
kâˆ’1
â‰¥H 1/k
k
for some positive integer k < n. It follows from Newtonâ€™s inequalities, together
with the last inequality above, that
H 2
k â‰¥Hkâˆ’1Hk+1 â‰¥H
kâˆ’1
k
k
Hk+1,
(17.5)
which in turn gives us H
2âˆ’

kâˆ’1
k

k
â‰¥Hk+1 or, which is the same, H 1/k
k
â‰¥H 1/(k+1)
k+1
.
For the equality, suppose we have H 1/k
k
= H 1/(k+1)
k+1
. Then, H 2
k = H
kâˆ’1
k
k
Hk+1,
and (17.5) shows that H 2
k = Hkâˆ’1Hk+1. Therefore, it comes from the condition for
equality in Newtonâ€™s inequalities that a1 = . . . = an.
âŠ“âŠ”
Problems: Sect. 17.2
1. * Let f âˆˆR[X]\{0} be a polynomial of degree n with n real roots, counted with
their multiplicities. If f â€² has n âˆ’1 equal roots, show that f has n equal roots.
2. We are given nonzero real numbers a, b, c, d such that 4b2 < 9ac. Show that the
polynomial X4 + aX3 + bX2 + cX + d has at least two nonreal roots.

17.3
Descartesâ€™ Rule
429
3. Let a, b, c, d be positive real numbers. Prove that
2(a + b + c + d)(ab + ac + ad + bc + bd + cd) â‰¥3(abc + abd + acd + bcd),
with equality if and only if a = b = c = d.
17.3
Descartesâ€™ Rule
The main result of this section relates the number of positive roots of a real
polynomial to the number of changes of sign along the sequence of its nonvanishing
coefï¬cients. Among the results proved so far in this chapter, it depends only on the
Bolzano theorem, so that we could have discussed it right after that. Up to details,
our presentation follows [26].
We start with the following combinatorial lemma, which can be easily established
by induction, for example.
Lemma 17.12 For each ï¬nite sequence Î½ of + and âˆ’signs, let V (Î½) denote the
number of pairs of distinct consecutive signs in Î½. If A stands for the set of those
sequences with initial and ï¬nal distinct signs, and B for the set of those sequences
with initial and ï¬nal equal signs, then:
(a) Î½ âˆˆA â‡’V (Î½) â‰¡1(mod 2).
(b) Î½ âˆˆB â‡’V (Î½) â‰¡0(mod 2).
Now, we shall need the following deï¬nition.
Deï¬nition 17.13 Let
f (X) = anXkn + anâˆ’1Xknâˆ’1 + Â· Â· Â· + a1Xk1 + a0Xk0
be a nonconstant real polynomial, with kn > knâˆ’1 > . . . > k1 > k0 â‰¥0 and aj Ì¸= 0
for 0 â‰¤j â‰¤n. Deï¬ne the sequence Î½f = (Î±n, Î±nâˆ’1, . . . , Î±1, Î±0) by setting, for
each integer 0 â‰¤j â‰¤n,
Î±j =
+, if aj > 0
âˆ’, if aj < 0 .
The variation of f , denoted V (f ), is the number of pairs of distinct consecutive
signs in Î½f .
For our purposes, the following one is a crucial result.
Lemma 17.14 Let g be a nonconstant real polynomial and c > 0 be a given real
number. If f (X) = (X âˆ’c)g(X), then V (f ) âˆ’V (g) is an odd positive integer.
Proof We make induction on âˆ‚g â‰¥1.

430
17
Polynomials Over R
(a) âˆ‚g = 1: we can surely suppose that g is monic. If g(X) = X, then f (X) =
X2 âˆ’cX, so that V (f ) âˆ’V (g) = 1. Now, assume that g(X) = X âˆ’Î±, with
Î± > 0. Then, f (X) = X2 âˆ’(Î± + c)X + cÎ±, so that V (f ) âˆ’V (g) = 2 âˆ’1 = 1.
The case g(X) = X + Î±, with Î± > 0, is equally easy: f (X) = X2 + (Î± âˆ’
c)X âˆ’cÎ± and, since âˆ’cÎ± < 0, Lemma 17.12 assures that V (f ) is odd; hence,
V (f ) âˆ’V (g) = V (f ), an odd positive integer.
(b) Assume that the result is valid for every nonconstant real polynomial g such that
âˆ‚g < n, with n > 1 being an integer, and take another such polynomial g, this
time of degree n. For the sake of notation, for a given nonconstant real polyno-
mial h, whenever necessary we shall denote by Î±h and Î²h, respectively, the lead-
ing coefï¬cient and the coefï¬cient of the term of lowest degree in h. In particular,
h(X) = Î±hXr + Â· Â· Â· + Î²hXs,
with r â‰¥s. We distinguish three cases:
(i) All coefï¬cients of g are positive: once again assume (without loss of
generality) that g monic, say g(X) = Xn + Â· Â· Â· + Î²Xl, with l < n. Then,
f (X) = (X âˆ’c)g(X) = Xn+1 + Â· Â· Â· âˆ’cÎ²Xl,
with cÎ² < 0, and Lemma 17.12 shows that V (f ) is odd and, hence
V (f ) âˆ’V (g) = V (f ) is an odd positive integer.
(ii) There exist nonconstant polynomials u and v such that g = u + v,
u(X) = Î±uXr + Â· Â· Â· + Î²uXs, and v(X) = Î±vXp + Â· Â· Â· + Î²vXq,
with n = r â‰¥s, p â‰¥q and p + 1 < s. Then,
(X âˆ’c)g(X) = (X âˆ’c)u(X) + (X âˆ’c)v(X)
= (Î±uXr+1 + Â· Â· Â· âˆ’cÎ²uXs)
+ (Î±vXp+1 + Â· Â· Â· âˆ’cÎ²vXq),
(17.6)
since p + 1 < s. Let us now look at two distinct subcases: Î±vÎ²u > 0 and
Î±vÎ²u < 0.
â€¢
Î±vÎ²u > 0: we obviously have V (g) = V (u) + V (v). However, since
(âˆ’cÎ²u)Î±v < 0, the second equality in (17.6) shows that
V (f ) = V ((X âˆ’c)g) = V ((X âˆ’c)u) + V ((X âˆ’c)v) + 1.
By the induction hypothesis (in principle, u has degree r
=
n;
nevertheless, s > 1 implies that we can apply the induction hypothesis
to w(X) = Î±uXrâˆ’s + Â· Â· Â· + Î²u, since u(X) = Xsw(X)), we obtain
V (f ) â‰¥(1 + V (u)) + (1 + V (v)) + 1 > V (g) + 1

17.3
Descartesâ€™ Rule
431
and, modulo 2,
V (f ) â‰¡(1 + V (u)) + (1 + V (v)) + 1 â‰¡V (g) + 1.
â€¢
Î±vÎ²u < 0: since Î±vÎ²u < 0, we have
V (g) = V (u) + V (v) + 1
and, by (17.6),
V (f ) = V ((X âˆ’c)g) = V ((X âˆ’c)u) + V ((X âˆ’c)v).
Once again from the induction hypothesis, we get
V (f ) â‰¥(1 + V (u)) + (1 + V (v)) = V (g) + 1
and, modulo 2,
V (f ) â‰¡(1 + V (u)) + (1 + V (v)) â‰¡V (g) + 1.
(iii) g(X) = anXn + anâˆ’1Xnâˆ’1 + Â· Â· Â· + akXk, with an, . . . , ak Ì¸= 0 and not
all of an, anâˆ’1, . . . , ak positive. Assume, without loss of generality, that
an > 0, and write
g = g0 âˆ’g1 + Â· Â· Â· + (âˆ’1)tgt,
such that each gi = Î±iXki + Â· Â· Â· + Î²iXli (ki â‰¥li) has only positive
coefï¬cients and li = ki+1 + 1 for i < t. Then, V (g) = t and
(X âˆ’c)g = (X âˆ’c)g0 âˆ’(X âˆ’c)g1 + Â· Â· Â· + (âˆ’1)t(X âˆ’c)gt
= (X âˆ’c)(Î±0Xk0 + Â· Â· Â· + Î²0Xl0)
âˆ’(X âˆ’c)(Î±1Xk1 + Â· Â· Â· + Î²1Xl1) + Â· Â· Â·
+ (âˆ’1)t(X âˆ’c)(Î±tXkt + Â· Â· Â· + Î²tXlt )
= Î±0Xk0+1 + Â· Â· Â· âˆ’(Î±1 + cÎ²0)Xl0 + Â· Â· Â· + (Î±2 + cÎ²1)Xl1
+ Â· Â· Â· âˆ’(Î±3 + cÎ²2)Xl2 + Â· Â· Â· + (âˆ’1)t(Î±t + cÎ²tâˆ’1)Xltâˆ’1
+ Â· Â· Â· + (âˆ’1)t+1cÎ²tXlt .
Since Î±0, Î±1 + cÎ²0, Î±2 + cÎ²1, . . . , Î±t + cÎ²tâˆ’1 and cÎ²t are all positive,
Lemma 17.12 assures that there is an odd number of changes of sign (and,
hence, at least one) of consecutive pairs of coefï¬cients in each of the t + 1
dotted intervals above. This gives
V (f ) = V ((X âˆ’c)g) â‰¥t + 1 = V (g) + 1.

432
17
Polynomials Over R
It also follows from the above that, modulo 2,
V (f ) = V ((X âˆ’c)g) â‰¡t + 1 = V (g) + 1.
âŠ“âŠ”
We can ï¬nally state and prove the following result, which is known in Mathe-
matics as Descartesâ€™ rule2 for polynomials with real coefï¬cients.
Theorem 17.15 (Descartes) Let f be a nonconstant real polynomial. If P(f )
denotes the number of positive roots of f , then V (f ) âˆ’P(f ) is a nonnegative
even integer.
Proof We make induction on the degree of f .
If âˆ‚f = 1, assume, without loss of generality, that f is monic. If f (X) = X or
f (X) = X + Î±, with Î± > 0, then V (f ) âˆ’P(f ) = 0 âˆ’0 = 0. If f (X) = X âˆ’Î±,
with Î± > 0, then V (f ) âˆ’P(f ) = 1 âˆ’1 = 0.
Now, let n > 1 be a given integer and suppose that the theorem holds true for
each nonconstant real polynomial of degree less than n. If
f (X) = anXn + anâˆ’1Xnâˆ’1 + Â· Â· Â· + a1X + a0
is a real polynomial of degree, we have two different cases:
â€¢
P(f ) = 0: in this case, it sufï¬ces to show that V (f ) is even. Since f (0) = a0
and f (x) has the same sign as an for every sufï¬ciently large real number x (for
limxâ†’+âˆ
f (x)
xn
= an), the fact that P(f ) = 0 assures, via Bolzanoâ€™s theorem,
that ana0 > 0. Hence, Lemma 17.12 guarantees that V (f ) is even.
â€¢
P(f ) > 0: by taking a positive root c of f , there exists a nonconstant polynomial
g such that f (X) = (X âˆ’c)g(X). Lemma 17.14 guarantees the existence of an
odd positive integer I for which
V (f ) âˆ’P(f ) = (V (g) + I) âˆ’(P(g) + 1)
= (V (g) âˆ’P(g)) + (I âˆ’1).
Since, by induction hypothesis, V (g) âˆ’P(g) is nonnegative and even, we
conclude that the same holds for V (f ) âˆ’P(f ).
âŠ“âŠ”
2RenÃ© Descartes, French mathematician, philosopher and scientist of the seventeenth century.
Descartesâ€™ legacy to Mathematics and science is a huge one, and came mainly from his
landmarking book Discours de la MÃ©thode (Discourse on the Method) and its three corresponding
appendices. This book marks a turning point on the way of doing science, for, along it, Descartes
strongly rejected the scholastic tradition of using speculation, instead of deduction, as the central
strategy for the investigation of natural phenomena. On the other hand, its appendix La GÃ©omÃ©trie
layed down the foundations of Analytic Geometry, and nowadays every student is acquainted with
cartesian coordinate systems.

17.3
Descartesâ€™ Rule
433
The coming corollary examines the case of negative roots.
Corollary 17.16 If f is a nonconstant real polynomial and N(f ) is the number of
its negative roots, then V (f (âˆ’X)) âˆ’N(f ) is nonnegative and even.
Proof Immediate from Descartesâ€™ rule, together with the fact that Î± âˆˆN(f ) if and
only if âˆ’Î± âˆˆP(f ).
âŠ“âŠ”
As a direct consequence of Descartesâ€™ rule, if f is a nonconstant real polynomial
such that V (f ) is odd, then has at least one positive root. More particularly, if
V (f ) = 1, then f has exactly one positive root. The coming example takes
advantage of this fact.
Example 17.17 Let a0, a1, . . . , anâˆ’1 be nonnegative real numbers, at least one of
which being nonzero. Compute the number of positive roots of the real polynomial
Xn âˆ’anâˆ’1Xnâˆ’1 âˆ’Â· Â· Â· âˆ’a1X âˆ’a0.
Solution Denoting by f the given polynomial, Theorem 17.15 assures that V (f )âˆ’
P(f ) is nonnegative and even. However, since V (f ) = 1, it is clear that P(f ) = 1.
âŠ“âŠ”
Problems: Sect. 17.3
1. Let g âˆˆR[X] \ R be a polynomial of degree n and f (X) = g(X2). If f has
exactly n positive roots and n negative roots, show that V (f ) = n.
2. For each n âˆˆN, show that the real polynomial Xn âˆ’Xnâˆ’1 âˆ’Xnâˆ’2 âˆ’Â· Â· Â·âˆ’X âˆ’1
has a positive root an satisfying
2 âˆ’
1
2nâˆ’1 â‰¤an â‰¤2 âˆ’1
2n .
3. (Leningrad) The third degree real polynomial aX3 + bX2 + cX + d has three
distinct real roots. Compute the number of real roots of the polynomial
4(aX3 + bX2 + cX + d)(3aX + b) âˆ’(3aX2 + 2bX + c)2.

Chapter 18
Interpolation of Polynomials
Corollary 15.10 assures that there is at most one polynomial of degree n and
assuming preassigned values in n + 1 given complex numbers. What we still do not
know is whether such a polynomial actually exists. For instance, does there exists a
polynomial f with rational coefï¬cients, degree 3 and such that f (0) = 1, f (1) = 2,
f (2) = 3 and f (3) = 0? In this chapter we study a bunch of techniques that allow us
to answer this and alike questions, and which are generically referred to as interpola-
tion of polynomials. In particular, we shall study in detail the class of Lagrange inter-
polating polynomials, which will then be used to solve Vandermondeâ€™ linear systems
with no Linear Algebra. In turn, the knowledge of the solutions of such linear
systems will allow us to study, in Sect. 21.1, an important particular class of linear
recurrence relations, thus partially extending the methods of Section 3.2 of [8].
18.1
Bases for Polynomials
For what follows, recall that K stands for any of the number sets Q, R or C. We
shall ï¬rstly need to establish a quite useful notation.
Deï¬nition 18.1 For n âˆˆN and 1 â‰¤i, j â‰¤n, we let the Kronecker delta1 Î´ij be
deï¬ned by
Î´ij =
1, if i = j
0, if i Ì¸= j .
The advantage of Kroneckerâ€™s notation comes from the fact that we can use it as
a tag, in the following sense: given n âˆˆN and a sequence (b1, . . . , bn) in K, we
have
1Leopold Kronecker, German mathematician of the nineteenth century.
Â© Springer International Publishing AG, part of Springer Nature 2018
A. Caminha Muniz Neto, An Excursion through Elementary Mathematics, Volume III,
Problem Books in Mathematics, https://doi.org/10.1007/978-3-319-77977-5_18
435

436
18
Interpolation of Polynomials
n

j=1
Î´ijbj = bi
(18.1)
for 1 â‰¤i â‰¤n.
Now, let be given n âˆˆN and pairwise distinct elements a1, a2, . . . , an in K. For
1 â‰¤i â‰¤n, we deï¬ne Li âˆˆK[X] by
Li(X) =

1â‰¤jâ‰¤n
jÌ¸=i
X âˆ’aj
ai âˆ’aj
=
X âˆ’a1
ai âˆ’a1

. . .

X âˆ’ai
ai âˆ’ai

. . .
X âˆ’an
ai âˆ’an

,
with the hat  over a certain factor meaning that it is actually missing from the
product. Such polynomials Li are called the Lagrange interpolating polynomials
for the set {a1, . . . , an}.
It is immediate to verify that
Li(aj) = Î´ij
for all 1 â‰¤i, j â‰¤n. In turn, as we shall see in the coming result, this property
allows us to build polynomials attaining preassigned values at a set of pairwise
distinct given elements of K. Such a result is usually referred to as the Lagrange
interpolating theorem.
Theorem 18.2 (Lagrange) Given n âˆˆN and a1, . . . , an, b1, . . . , bn âˆˆK, with
a1, . . . , an being pairwise distinct, there exists exactly one polynomial f âˆˆK[X],
of degree less than n and such that f (ai) = bi for 1 â‰¤i â‰¤n. More precisely, such
a polynomial is
f (X) =
n

j=1
bjLj(X),
(18.2)
with the Lj standing for the Lagrange interpolating polynomials for the set
{a1, . . . , an}.
Proof Uniqueness follows from Corollary 15.10. On the other hand, taking f as
in (18.2), it sufï¬ces to show that âˆ‚f < n and f (ai) = bi for 1 â‰¤i â‰¤n.
Since âˆ‚Lj = n âˆ’1 for 1 â‰¤j â‰¤n and the degree of a sum of polynomials,
whenever deï¬ned, does not surpass the greatest degree of the summands, it is pretty
clear that âˆ‚f < n. For what is left to do, just note that
f (ai) =
n

j=1
bjLj(ai) =
n

j=1
bjÎ´ji = bi,
where we have used (18.1) in the last equality above.
âŠ“âŠ”

18.1
Bases for Polynomials
437
The following corollary provides an equivalent way of formulating the previous
result.
Corollary 18.3 Let n âˆˆN and a1, . . . , an be pairwise distinct elements of K. If
f âˆˆK[X] \ {0} satisï¬es âˆ‚f < n, then
f (X) =
n

i=1
f (ai)Li(X).
Proof Indeed, by letting
g(X) =
n

i=1
f (ai)Li(X),
we have âˆ‚f, âˆ‚g < n and, by the proof of Lagrangeâ€™s theorem, g(ai) = f (ai) for
1 â‰¤i â‰¤n. Therefore, by invoking Corollary 15.10 once more, we get g = f .
âŠ“âŠ”
We now collect some interesting applications of Lagrangeâ€™s interpolation, begin-
ning with the operational aspects involved.
Example 18.4 Find a polynomial f âˆˆQ[X] such that f (1) = 12, f (2) = 2,
f (3) = 1, f (4) = âˆ’6 and f (5) = 4.
Solution Firstly, let us explicitly write Lagrangeâ€™s interpolating polynomials for the
set {1, 2, 3, 4, 5}:
L1(X) =

1â‰¤jâ‰¤5
jÌ¸=1
X âˆ’j
1 âˆ’j =
X âˆ’2
1 âˆ’2
 X âˆ’3
1 âˆ’3
 X âˆ’4
1 âˆ’4
 X âˆ’5
1 âˆ’5

= 1
24(X4 âˆ’14X3 + 71X2 âˆ’154X + 120),
L2(X) =

1â‰¤jâ‰¤5
jÌ¸=2
X âˆ’j
2 âˆ’j =
X âˆ’1
2 âˆ’1
 X âˆ’3
2 âˆ’3
 X âˆ’4
2 âˆ’4
 X âˆ’5
2 âˆ’5

= âˆ’1
6(X4 âˆ’13X3 + 59X2 âˆ’107X + 60),
L3(X) =

1â‰¤jâ‰¤5
jÌ¸=3
X âˆ’j
3 âˆ’j =
X âˆ’1
3 âˆ’1
 X âˆ’2
3 âˆ’2
 X âˆ’4
3 âˆ’4
 X âˆ’5
3 âˆ’5

= 1
4(X4 âˆ’12X3 + 49X2 âˆ’78X + 40),

438
18
Interpolation of Polynomials
L4(X) =

1â‰¤jâ‰¤5
jÌ¸=4
X âˆ’j
4 âˆ’j =
X âˆ’1
4 âˆ’1
 X âˆ’2
4 âˆ’2
 X âˆ’3
4 âˆ’3
 X âˆ’5
4 âˆ’5

= âˆ’1
6(X4 âˆ’11X3 + 41X2 âˆ’61X + 30)
and
L5(X) =

1â‰¤jâ‰¤5
jÌ¸=5
X âˆ’j
5 âˆ’j =
X âˆ’1
5 âˆ’1
 X âˆ’2
5 âˆ’2
 X âˆ’3
5 âˆ’3
 X âˆ’4
5 âˆ’4

= 1
24(X4 âˆ’10X3 + 35X2 âˆ’50X + 24).
Hence, according to previous corollary we can take
f (X) = 12L1(X) + 2L2(X) + L3(X) âˆ’6L4(X) + 4L5(X)
= 19
12X4 âˆ’55
3 X3 + 233
4 X2 âˆ’775
6 X + 86.
âŠ“âŠ”
Example 18.5 (IMO Shortlist) Let f be a monic polynomial of real coefï¬cients and
degree n, and let x1, x2, . . . , xn+1 be pairwise distinct integers. Show that there exists
an index 1 â‰¤k â‰¤n + 1 for which |f (xk)| â‰¥n!
2n .
Proof Lagrangeâ€™s interpolation formula gives
f (x) =
n+1

j=1
f (xj)

iÌ¸=j
x âˆ’xi
xj âˆ’xi
.
Therefore, by comparing the leading coefï¬cients on both sides of the equality above,
we obtain
1 =
n+1

j=1
f (xj)
0
iÌ¸=j(xj âˆ’xi).
Now, if M = max{|f (xk)|; 1 â‰¤k â‰¤n + 1} and pj = 0
iÌ¸=j(xj âˆ’xi), we have
1 =
						
n+1

j=1
f (xj)
pj
						
â‰¤
n+1

j=1
|f (xj)|
|pj|
â‰¤M
n+1

j=1
1
|pj|.

18.1
Bases for Polynomials
439
However, since n+1
j=1
1
|pj | is symmetric with respect to x1, x2,. . . , xn+1, we can
assume (after reordering the xiâ€™s, if needed) that x1 < x2 < Â· Â· Â· < xn+1. This way,
|pj| = (xj âˆ’x1) . . . (xj âˆ’xjâˆ’1)(xj+1 âˆ’xj) . . . (xn+1 âˆ’xj)
â‰¥[(j âˆ’1) . . . 2 Â· 1][1 Â· 2 . . . (n + 1 âˆ’j)]
= (j âˆ’1)!(n + 1 âˆ’j)! =
n!
 n
jâˆ’1
.
In view of the estimates above, we ï¬nally get
1 â‰¤M
n+1

j=1
1
|pj| â‰¤M
n+1

j=1
1
n!

n
j âˆ’1

= 2nM
n!
or, which is the same, M â‰¥n!
2n .
âŠ“âŠ”
We now show how to use Lagrangeâ€™s interpolating polynomials to solve certain
types of linear systems of equations, known as Vandermonde systems. Apart from
Example 18.7, Vandermonde systems will also play a role in the discussion of some
special linear recurrence relations, in Sect. 21.1.
Proposition 18.6 (Vandermonde) Given elements a1, a2, . . . , an, Î±1, Î±2, . . . , Î±n
of K, with a1, a2, . . . , an being pairwise distinct, the linear system of equations
â§
âªâªâªâªâªâ¨
âªâªâªâªâªâ©
x1 + x2 + Â· Â· Â· + xn
= Î±1
a1x1 + a2x2 + Â· Â· Â· + anxn
= Î±2
a2
1x1 + a2
2x2 + Â· Â· Â· + a2
nxn
= Î±3
Â· Â· Â·
anâˆ’1
1
x1 + anâˆ’1
2
x2 + Â· Â· Â· + anâˆ’1
n
xn = Î±n
(18.3)
admits a unique solution in K. In particular, if Î±1 = Â· Â· Â· = Î±n = 0, then x1 = Â· Â· Â· =
xn = 0.
Proof If f (X) = c0 + c1X + Â· Â· Â· + cnâˆ’1Xnâˆ’1 âˆˆK[X], then, by respectively
multiplying the equations of the linear system by c0, c1, . . . , cnâˆ’1 and adding the
results, we obtain
f (a1)x1 + Â· Â· Â· + f (an)xn = c0Î±1 + c1Î±2 + Â· Â· Â· + cnâˆ’1Î±n.
Now, if we let f = Li, where Li is the i-th Lagrange interpolating polynomial
for {a1, a2, . . . , an}, then the left hand side of the equality above reduces to xi, so
that
xi = c0Î±1 + c1Î±2 + Â· Â· Â· + cnâˆ’1Î±n âˆˆK.
(18.4)
âŠ“âŠ”

440
18
Interpolation of Polynomials
The coming example shows how to use the previous proposition to give an
alternative proof for the generalized multisection formula (cf. Problem 8, page 355).
Example 18.7 Let f âˆˆC[X] \ {0}, n > 1 be a natural number and 0 â‰¤r â‰¤n âˆ’1
be an integer. If Ï‰ = cis 2Ï€
n and z âˆˆC, show that

kâ‰¡r (mod n)
akzk = 1
n
nâˆ’1

j=0
Ï‰âˆ’rjf (Ï‰jz),
with ak denoting the coefï¬cient of Xk in f .
Proof Writing
f (X) = u0(Xn) + Xu1(Xn) + Â· Â· Â· + Xnâˆ’1unâˆ’1(Xn),
with u0, u1, . . . , unâˆ’1 âˆˆC[X], and taking into account that Ï‰n = 1, we obtain
â§
âªâªâªâªâªâ¨
âªâªâªâªâªâ©
u0(zn) + zu1(zn) + Â· Â· Â· + znâˆ’1unâˆ’1(zn)
= f (z)
u0(zn) + Ï‰zu1(zn) + Â· Â· Â· + (Ï‰z)nâˆ’1unâˆ’1(zn)
= f (Ï‰z)
u0(zn) + (Ï‰2z)u1(zn) + Â· Â· Â· + (Ï‰2z)nâˆ’1unâˆ’1(zn)
= f (Ï‰2z)
Â· Â· Â·
u0(zn) + (Ï‰nâˆ’1z)u1(zn) + Â· Â· Â· + (Ï‰nâˆ’1z)nâˆ’1unâˆ’1(zn) = f (Ï‰nâˆ’1z)
.
This is a Vandermonde system in u0(zn), zu1(zn), . . . , znâˆ’1unâˆ’1(zn), with
zrur(zn) =

kâ‰¡r (mod n)
akzk.
(18.5)
According to (18.4), we have
zrur(zn) = c0f (z) + c1f (Ï‰z) + Â· Â· Â· + cnâˆ’1f (Ï‰nâˆ’1z),
(18.6)
where cj stands for the coefï¬cient of Xj in the r-th Lagrange interpolating
polynomial Lr relative to {1, Ï‰, Ï‰2, . . . , Ï‰nâˆ’1}. However,
Lr(X) =
(X âˆ’1) . . .

(X âˆ’Ï‰r) . . . (X âˆ’Ï‰nâˆ’1)
(Ï‰r âˆ’1) . . .

(Ï‰r âˆ’Ï‰r) . . . (Ï‰r âˆ’Ï‰nâˆ’1)
,
(18.7)
with numerator equal to
Xn âˆ’1
X âˆ’Ï‰r = Xn âˆ’(Ï‰r)n
X âˆ’Ï‰r
= Xnâˆ’1 + Ï‰rXnâˆ’2 + Â· Â· Â· + Ï‰(nâˆ’2)rX + Ï‰(nâˆ’1)r.

18.1
Bases for Polynomials
441
On the other hand, item (a) of Problem 5, page 393, computes the denominator
of (18.7) as being equal to nÏ‰(nâˆ’1)r, so that
cj = Ï‰(nâˆ’1âˆ’j)r
nÏ‰(nâˆ’1)r = 1
nÏ‰âˆ’jr.
It ï¬nally follows from (18.5), (18.6) and the above expression for cj that

kâ‰¡r (mod n)
akzk =
nâˆ’1

j=0
cjf (Ï‰jz) = 1
n
nâˆ’1

j=0
Ï‰âˆ’jrf (Ï‰jz).
âŠ“âŠ”
A limitation of Lagrange interpolation lies in the fact that it only generates the
set of nonzero polynomials having degrees less than or equal to some ï¬xed natural
number. We remedy such a situation with the following more general deï¬nition.
Deï¬nition 18.8 A basis for K[X] is a sequence (f0, f1, f2, . . .) of elements of
K[X] satisfying the following condition: for every f âˆˆK[X], there exist unique
n âˆˆZ+ and a0, . . . , an âˆˆK such that
f (X) = a0f0(X) + Â· Â· Â· + anfn(X).
Example 18.9 A simple way of constructing a basis for K[X] is to take a sequence
(f0, f1, f2, . . .) in K[X] such that âˆ‚fj = j for every j â‰¥0.
In order to show that such a sequence is indeed a basis for K[X], we have to
establish the following two claims:
(i) If n âˆˆN and a0, a1, . . . , an and b0, b1, . . . , bn are elements of K such that
a0f0(X) + a1f1(X) + Â· Â· Â· + anfn(X) = b0f0(X) + b1f1(X) + Â· Â· Â· + bnfn(X),
then ai = bi for 0 â‰¤i â‰¤n.
(ii) For every f âˆˆK[X], there exist n âˆˆN and a0, a1, . . . , an âˆˆK such that
f (X) = a0f0(X) + a1f1(X) + Â· Â· Â· + anfn(X).
We leave these checkings for the reader (cf. Problem 1).
As a particular case of the previous example, note that the sequence
(1, X, X2, X3, . . .)
is a basis for K[X] (as we already knew).
In what follows, inspired by the binomial numbers, we construct a quite useful
basis for K[X].

442
18
Interpolation of Polynomials
Deï¬nition 18.10 For k âˆˆZ+, we deï¬ne the k-th binomial polynomial
X
k

by
setting
X
0

= 1,
X
1

= X and, for an integer k > 1,
X
k

= 1
k!X(X âˆ’1) . . . (X âˆ’k + 1).
Since âˆ‚
X
k

= k, para todo k âˆˆZ+, a direct application of Example 18.9
guarantees that the sequence of binomial polynomials is a basis for K[X], called
the binomial basis.
In spite of this, for future use we shall give a direct proof of the validity of
condition (ii) of that example. More precisely, let us make induction on n â‰¥0
to show that there exist a0, a1, . . . , an âˆˆK for which
Xn = a0
X
0

+ a1
X
1

+ Â· Â· Â· + an
X
n

.
(18.8)
For n = 0 and n = 1, (18.8) holds due to the very deï¬nition of
X
0

and
X
1

. Now,
assume that for some k âˆˆN there exist a0, a1, . . . , ak âˆˆK satisfying (18.8) when
n = k. Then,
a0
X
0

X + a1
X
1

X + Â· Â· Â· + ak
X
k

X = Xk+1
(18.9)
with
X
j

X = 1
j!X(X âˆ’1) . . . (X âˆ’j + 1)(X âˆ’j + j)
= 1
j!X(X âˆ’1) . . . (X âˆ’j + 1)(X âˆ’j)
+ j
j!X(X âˆ’1) . . . (X âˆ’j + 1)
= (j + 1)
 X
j + 1

+ j
X
j

.
Therefore, substituting this expression for
X
j

X (for 0 â‰¤j â‰¤k) into (18.9), we
conclude that (18.8) is valid for n = k + 1.
Even though the concept of basis for K[X], as formulated above, does not apply
directly to polynomials over Z, when dealing with the binomial basis we have the
following result.
Proposition 18.11 If f âˆˆC[X] \ {0} is a polynomial of degree n such that f (0),
f (1), . . . , f (n) are all integers, then there exist unique a0, a1, . . . , an âˆˆZ such that
f (X) = a0
X
0

+ a1
X
1

+ Â· Â· Â· + an
X
n

.
(18.10)
In particular, f (x) âˆˆZ for every x âˆˆZ.

18.1
Bases for Polynomials
443
Proof Since the binomial polynomials for a basis for C[X], there exist unique
a0, a1, . . . , an âˆˆC such that f can be written as in the statement of the proposition.
Thus, it sufï¬ces to prove that a0, a1, . . . , an are integers.
Arguing once more by induction, start by noticing that Z âˆ‹f (0) = a0. Now,
assume that we have already proved that a0, . . . , akâˆ’1 âˆˆZ, for some integer 1 â‰¤
k â‰¤n. Then, (18.10) gives
f (k) âˆ’
kâˆ’1

j=0
aj
X
j

(k) =
n

j=k
aj
X
j

(k).
(18.11)
For 0 â‰¤j â‰¤k, the evaluation
X
j

(k) coincides with the ordinary binomial number
k
j

. On the other hand, for k + 1 â‰¤j â‰¤n, we have
X
j

(k) = 1
j!k(k âˆ’1) . . . (k âˆ’j + 1) = 0
Therefore, (18.11) reduces to
f (k) âˆ’
kâˆ’1

j=0
aj
k
j

= ak,
(18.12)
and the fact that a0, a1, . . . , akâˆ’1 âˆˆZ, together with f (k) âˆˆZ, gives ak âˆˆZ.
For the last part, since
X
k

(x) âˆˆZ for every x âˆˆZ (cf. Problem 2), it follows
from (18.10) that f (x) âˆˆZ for every x âˆˆZ.
âŠ“âŠ”
Also with respect to the proof of the proposition above, (18.12) can be written as
f (k) =
k

j=0
k
j

aj
Therefore, a direct application of Lemma 2.12 furnishes
ak =
k

j=0
(âˆ’1)k+j
k
j

f (j) âˆˆZ
for 0 â‰¤k â‰¤n and with no inductive argument.
Problems: Sect. 18.1
1. * Complete the discussion of Example 18.9.
2. * Given k âˆˆZ+, prove that
X
k

(x) âˆˆZ for every x âˆˆZ.

444
18
Interpolation of Polynomials
3. (USA)2 Let f be a polynomial of degree n, such that f (k) =
n+1
k
âˆ’1 for 0 â‰¤
k â‰¤n. Compute all possible values of f (n + 1) in terms of n.
4. (Singapore)3 We are given a polynomial f of degree n, such that f (k) =
k
k+1
for every integer 0 â‰¤k â‰¤n. Compute all possible values of f (n + 1) in terms
of n.
5. Given an n-sided simple polygon P, show that there exists a polynomial f âˆˆ
R[X], of degree at most n âˆ’1 and such that the graph of f contains the set of
vertices of P.
6. Given pairwise distinct real numbers a, b, c and d, solve the linear system of
equations
â§
âªâªâ¨
âªâªâ©
ax1 + a2x2 + a3x3 + a4x4 = 1
bx1 + b2x2 + b3x3 + b4x4 = 1
cx1 + c2x2 + c3x3 + c4x4 = 1
dx1 + d2x2 + d3x3 + d4x4 = 1
.
7. (USA) Let n > 3 be an integer and p, p0, p1, . . . , pnâˆ’2 be polynomials over R
for which
nâˆ’2

j=0
Xjpj(Xn) = (Xnâˆ’1 + Xnâˆ’2 + Â· Â· Â· + X + 1)p(X).
Prove that X âˆ’1 divides pj(X), for 0 â‰¤i â‰¤n âˆ’2.
8. Let n > 1 be a given natural number.
(a) Factorise the polynomial
f (X) =
n

j=0
(âˆ’1)j
n
j

X(X + 1) . . . 
(X + j) . . . (X + n) âˆ’n!.
(b) Conclude that for each k âˆˆN one has
n

j=0
(âˆ’1)j
n
j

1
k + j =
n!
k(k + 1) . . . (k + n).
(c) Compute, in terms of n, the sum of the series

kâ‰¥1
1
k(k + 1) . . . (k + n).
2For another approach to this problem, see Problem 4, page 450.
3For other approaches to this problem, see Problem 11, page 386, and Problem 3, page 450.

18.2
Finite Differences
445
9. (Leningrad) A ï¬nite sequence a1, a2, . . . , an is said to be p-balanced if, for k =
1, 2, . . . , p, all sums of the form
ak + ak+p + ak+2p + Â· Â· Â·
are equal. Prove that if n = 50 and the sequence (aj)1â‰¤jâ‰¤50 is p-balanced for
p = 3, 5, 7, 11, 13 and 17, then all of its terms are equal to 0.
18.2
Finite Differences
Another useful, though a little more elaborate, interpolation technique is that of
ï¬nite differences. We shall sketch the rudiments of it along this section.
Deï¬nition 18.12 Let h be a real number and f : R â†’R be a given function.
For an integer k â‰¥0, we deï¬ne the k-th ï¬nite difference of f with step h as the
function k
hf : R â†’R, given by:
(a) 0
hf = f .
(b) (1
hf )(x) = (hf )(x) = f (x + h) âˆ’f (x) for each x âˆˆR.
(c) k
hf = h(kâˆ’1
h
f ) for k â‰¥2.
For such a deï¬nition to be useful, we need the properties of k
hf collected in the
coming result.
Proposition 18.13 In the notations of the previous deï¬nition, given h âˆˆR and
functions f, g : R â†’R, we have that:
(a) If f is constant, then hf = 0.
(b) If a and b are real constants, then h(af + bg) = ahf + bhg.
(c) h(fg) = (hf )(g + hg) + f hg.
(d) k
hf = kâˆ’1
h
(hf ), for every k âˆˆN.
(e) If k â‰¥0 and x âˆˆR, then
(k
hf )(x) =
k

j=0
(âˆ’1)j
k
j

f (x + (k âˆ’j)h).
Proof
(a) For x âˆˆR, we have hf (x) = f (x + h) âˆ’f (x) = 0, since f is constant.
(b) For x âˆˆR, we can write
(h(af + bg))(x) = (af + bg)(x + h) âˆ’(af + bg)(x)
= a(f (x + h) âˆ’f (x)) + b(g(x + h) âˆ’g(x))
= a(hf )(x) + b(hg)(x).

446
18
Interpolation of Polynomials
(c) Exercise (see Problem 1).
(d) Let us make induction on k â‰¥1, the case k = 1 following directly from
Deï¬nition 18.12. By induction hypothesis, assume that the result is true when
k = l â‰¥1. For k = l + 1, successively applying item (c) of Deï¬nition 18.12,
the induction hypothesis and once more item (c) of Deï¬nition 18.12 (but this
time to hf in place of f ), we obtain
l+1
h
f = h(l
hf ) = h(lâˆ’1
h
(hf )) = l
h(hf ).
(e) Let us make induction on k â‰¥0, noticing that if k = 0 and x âˆˆR, then
0

j=0
(âˆ’1)j
0
j

f (x) = (âˆ’1)0
0
0

f (x) = f (x) = (0
hf )(x).
Now, assume that the formula holds when k = l â‰¥0, and let us prove its
validity for k = l + 1. Given x âˆˆR, write  = (l+1f )(x). By successively
applying item (c) of Deï¬nition 18.12, the induction hypothesis and Stifelâ€™s
relation, we obtain
 = h(l
hf )(x) = (l
hf )(x + h) âˆ’(l
hf )(x)
=
l
j=0
(âˆ’1)j
l
j

f (x + h + (l âˆ’j)h) âˆ’
l
j=0
(âˆ’1)j
l
j

f (x + (l âˆ’j)h)
=f (x + (l + 1)h)+
l
j=1
(âˆ’1)j
l + 1
j

âˆ’

l
j âˆ’1

f (x + (l + 1 âˆ’j)h)
âˆ’
l
j=0
(âˆ’1)j
l
j

f (x + (l âˆ’j)h)
=
l
j=0
(âˆ’1)j
l + 1
j

f (x + (l + 1 âˆ’j)h)
âˆ’
l
j=1
(âˆ’1)j

l
j âˆ’1

f (x+(l+1 âˆ’j)h)âˆ’
l
j=0
(âˆ’1)j
l
j

f (x + (lâˆ’j)h),

18.2
Finite Differences
447
Hence,
(l+1f )(x) =
l+1

j=0
(âˆ’1)j
l + 1
j

f (x + (l + 1 âˆ’j)h) âˆ’(âˆ’1)l+1f (x)
+
lâˆ’1

j=0
(âˆ’1)j
l
j

f (x+(lâˆ’j)h)âˆ’
l
j=0
(âˆ’1)j
l
j

f (x+(lâˆ’j)h)
=
l+1

j=0
(âˆ’1)j
l + 1
j

f (x + (l + 1 âˆ’j)h)
+
l
j=0
(âˆ’1)j
l
j

f (x+(lâˆ’j)h)âˆ’
l
j=0
(âˆ’1)j
l
j

f (x+(lâˆ’j)h)
=
l+1

j=0
(âˆ’1)j
l + 1
j

f (x + (l + 1 âˆ’j)h).
âŠ“âŠ”
Among the properties of ï¬nite differences listed in the previous proposition, the
one which is more frequently used in interpolation problems is that of item (e),
mostly when combined with the coming simple result. Note that the proposition
above refers to ï¬nite differences of general real functions, whereas the next one is
speciï¬cally related to ï¬nite differences of polynomials.
We start by extending Deï¬nition 18.12 to polynomials, in the obvious way: for
ï¬xed h âˆˆR and f âˆˆR[X], given an integer k â‰¥0 we deï¬ne the k-th ï¬nite
difference of f with step h as the polynomial k
hf âˆˆR[X] given by:
(i) 0
hf = f .
(ii) (1
hf )(X) = (hf )(X) = f (X + h) âˆ’f (X).
(iii) k
hf = h(kâˆ’1
h
f ), for k â‰¥2.
In view of the above deï¬nition, it is now immediate to check that items from (a) to
(d) of the previous proposition still hold for ï¬nite differences of polynomials.
Proposition 18.14 Let f
âˆˆR[X] be a polynomial of degree n â‰¥1. For an
arbitrary ï¬xed step h âˆˆR \ {0}, the n-th ï¬nite differences of f all equal, whereas
the l-th ones, for any l > n, vanish identically.
Proof Start by observing that, if f (X) = anXn + Â· Â· Â· + a1X + a0, then
(hf )(X) = an(X + h)n + Â· Â· Â· + a1(X + h) + a0
âˆ’(anXn + Â· Â· Â· + a1X + a0)
= nanhXnâˆ’1 + g(X),

448
18
Interpolation of Polynomials
with either g â‰¡0 or âˆ‚g â‰¤n âˆ’2. Since h Ì¸= 0, we conclude that hf has degree
n âˆ’1. Therefore, arguing by induction on the degree of a polynomial, item (d) of
the (extension, for polynomials, of the) previous proposition guarantees that n
hf =
nâˆ’1
h
(hf ) has degree 0, so that it is constant. Hence, l
hf (X) = 0 for l > k.
âŠ“âŠ”
As will be clear from the two coming examples, the main usefulness of the
material on ï¬nite differences discussed above lies on the fact that, if the interpolation
points form an arithmetic progression, then the method of ï¬nite differences allow
us to compute the value of the corresponding polynomial at any point of such a
progression.
Example 18.15 Let f âˆˆR[X] be a polynomial of degree m â‰¥1, such that f (j) =
rj for 0 â‰¤j â‰¤m, with r being a given positive real number. Compute all possible
values of f (m + 1).
Solution Set h = 1 and write kf to denote k
1f (either the polynomial or its
corresponding polynomial function). Item (e) of Proposition 18.13 gives
kf (x) =
k

j=0
(âˆ’1)j
k
j

f (x + k âˆ’j)
for every x âˆˆR. However, since âˆ‚f = m, the previous proposition then gives
0 = m+1f (0) =
m+1

j=0
(âˆ’1)j
m + 1
j

f (m + 1 âˆ’j).
Therefore,
f (m + 1) =
m+1

j=1
(âˆ’1)j+1
m + 1
j

f (m + 1 âˆ’j)
=
m+1

j=1
(âˆ’1)j+1
m + 1
j

rm+1âˆ’j
= rm+1 âˆ’
m+1

j=0
(âˆ’1)j
m + 1
j

rm+1âˆ’j
= rm+1 âˆ’(r âˆ’1)m+1,
where we used the binomial expansion of (r âˆ’1)m+1 in the last equality above.
âŠ“âŠ”
Example 18.16 Let f be a polynomial of degree 1992, such that f (j) = 2j for
1 â‰¤i â‰¤1993. Compute the remainder upon division of f (1994) by 1994.

18.2
Finite Differences
449
Solution Combining item (e) of Proposition 18.13 with Proposition 18.14, and
writing again kf to denote k
1f , we have
0 = 1993f (1) =
1993

j=0
(âˆ’1)j
1993
j

f (1994 âˆ’j).
Hence,
f (1994) =
1993

j=1
(âˆ’1)j+1
1993
j

21994âˆ’j
=
1993
0

21994 âˆ’2
1993

j=0
(âˆ’1)j
1993
j

21993âˆ’j
= 21994 âˆ’2(2 âˆ’1)1993 = 21994 âˆ’2.
For what is left to do, note ï¬rst that 997 is prime (this can be easily checked with
the aid of Eratosthenes sieve, exactly as we did in Example 6.37 to show that 641 is
prime). Hence, Fermatâ€™s Little Theorem 10.15 assures that 2996 â‰¡1 (mod 997), so
that
21992 = (2996)2 â‰¡1 (mod 997).
From this, it is immediate to get
f (1994) = 21994 âˆ’2 â‰¡22 âˆ’2 â‰¡2 (mod 997).
We are then left with the system of linear congruences
f (1994) â‰¡0 (mod 2)
f (1994) â‰¡2 (mod 997) ,
which has, by the Chinese Remainder Theorem 10.27, a single solution modulus
2 Â· 997 = 1994. However, since 2 is clearly a solution, we obtain
f (1994) â‰¡2 (mod 1994).
âŠ“âŠ”
Problems: Sect. 18.2
1. * Complete the proof of Proposition 18.13.
2. Prove that, for each real function f : R â†’R, we have
f (x + kh) =
k

j=0
k
j

(kâˆ’j
h
f )(x),
for all h, x âˆˆR and every integer k â‰¥0.

450
18
Interpolation of Polynomials
3. (Singapore)4 Let f be a polynomial of degree n, such that f (k) =
k
k+1 for every
integer 0 â‰¤k â‰¤n. Compute f (n + 1).
4. (USA)5 Let f be a real polynomial of degree n, such that f (k) =
n+1
k
âˆ’1 for
0 â‰¤k â‰¤n. Compute all possible values of f (n + 1).
5. (IMOâ€”shortlist) A polynomial f , of degree 990, is such that f (k) = Fk for
992 â‰¤k â‰¤1982, where Fk stands for the k-th Fibonacci number. Prove that
f (1983) = F1983 âˆ’1.
6. (IMOâ€”shortlist) Let f be a real polynomial such that
(a) f (1) > f (0) > 0.
(b) f (2) > 2f (1) âˆ’f (0).
(c) f (3) > 3f (2) âˆ’3f (1) + f (0).
(d) f (n + 4) > 4f (n + 3) âˆ’6f (n + 2) + 4f (n + 1) âˆ’f (n) for every n âˆˆN.
Prove that f (n) > 0 for every n âˆˆN.
4For other approaches to this problem, see Problem 11, page 386, and Problem 4, page 444.
5For another approach to this problem, see Problem 3, page 444.

Chapter 19
On the Factorisation of Polynomials
The division algorithm for polynomials provides a notion of divisibility in K[X]
when K = Q, R ou C, and such a notion enjoys properties analogous to those of
the corresponding concept in Z. It is then natural to ask whether there exists some
notion of primality in K[X], which furnishes some sort of unique factorisation with
properties similar to the unique factorisation of integers. Our purpose in this chapter
is to give precise answers to these questions, which shall encompass polynomials
with coefï¬cients in Zp, for some prime integer p.
19.1
Unique Factorisation in Q[X]
Along this section, K denotes any of Q, R or C.
We say that f, g âˆˆK[X]\{0} are associated (in K[X]) if there exists a âˆˆK\{0}
such that f = ag. For instance, the real polynomials
f (X) = 4X2 âˆ’2X + 1 and g(X) = 2
âˆš
2X2 âˆ’
âˆš
2X + 1
âˆš
2
are associated in R[X], for f =
âˆš
2g and
âˆš
2 âˆˆR \ {0}.
Given f, g âˆˆK[X] \ {0}, we say that a polynomial p âˆˆK[X] \ {0} is a common
divisor of f and g if p | f, g. Note that f and g always have common divisors: the
constant nonzero polynomials over K, for example.
Deï¬nition 19.1 Given f, g âˆˆK[X] \ {0}, we say that d âˆˆK[X] \ {0} is a greatest
common divisor of f and g, and denote d = gcd(f, g), if the two following
conditions are satisï¬ed:
(a) d | f, g in K[X].
(b) If dâ€² âˆˆK[X] \ {0} divides f and g in K[X], then dâ€² | d in K[X].
Â© Springer International Publishing AG, part of Springer Nature 2018
A. Caminha Muniz Neto, An Excursion through Elementary Mathematics, Volume III,
Problem Books in Mathematics, https://doi.org/10.1007/978-3-319-77977-5_19
451

452
19
On the Factorisation of Polynomials
The coming result is the analogue, for polynomials, of Theorem 6.13. For this
reason, it is also known as BÃ©zoutâ€™s theorem. In order to properly state it, given
f âˆˆK[X] we let f K[X], or simply (f ), if there is no danger of confusion, denote
the subset of K[X] formed by the multiples of f , i.e.,
(f ) = f K[X] = {af ; a âˆˆK[X]}.
Theorem 19.2 (BÃ©zout)
Let f, g âˆˆK[X] \ {0}. If
S = {af + bg; a, b âˆˆK[X]},
then there exists a polynomial d âˆˆK[X]\{0} satisfying the following conditions:
(a) S = (d). In particular, d | f, g in K[X].
(b) Every polynomial in K[X] \ {0} that divides f and g also divides d.
Moreover, such a polynomial d is unique, up to association.
Proof
(a) Let d âˆˆS \ {0} be such that
âˆ‚d = min{âˆ‚h; h âˆˆS \ {0}}.
We ï¬rst claim that S = (d). Indeed, letting d = a0f +b0g, with a0, b0 âˆˆK[X],
and c âˆˆK[X], we have
cd = (ca0)f + (cb0)g âˆˆS,
i.e., (d) âŠ‚S. Conversely, take h âˆˆS, say h = af + bg, with a, b âˆˆK[X]. By
the division algorithm, we have h = dq + r, with q, r âˆˆK[X] and r = 0 or
0 â‰¤âˆ‚r < âˆ‚d. However, if r Ì¸= 0, then âˆ‚r < âˆ‚d and
r = h âˆ’dq
= (af + bg) âˆ’(a0f + b0g)q
= (a âˆ’a0q)f + (b âˆ’b0q)g âˆˆS,
a contradiction to the minimality of the degree of d in S. Therefore, r = 0 and,
hence, h = dq âˆˆ(d).
For the second part of item (a), it sufï¬ces to see that f, g âˆˆS = (d), so that,
in particular, f and g are multiples of d in K[X].
(b) Let dâ€² âˆˆK[X] \ {0} be a polynomial dividing f and g in K[X], say f = dâ€²f1
and g = dâ€²g1, with f1, g1 âˆˆK[X]. If a, b âˆˆK[X], then
af + bg = (af1 + bg1)dâ€² âˆˆdâ€² K[X].

19.1
Unique Factorisation in Q[X]
453
However, since af + bg is a generic element of S, it follows that
d âˆˆ(d) = S âŠ‚(dâ€²);
in particular, d is a multiple of dâ€², as we wished to show.
The last claim is left as an exercise for the reader (cf. Problem 1).
âŠ“âŠ”
In the notations of the statement of BÃ©zoutâ€™s theorem, given f, g âˆˆK[X] \ {0}
and letting d âˆˆK[X] \ {0} be such that d K[X] = S, from now on we say that d is
a greatest common divisor of f and g, and write
d = gcd(f, g).
Although a gcd of two nonzero polynomials is not unique, thanks to the last
part of BÃ©zoutâ€™s theorem any two gcdâ€™s of them are associated. Thus, whenever
convenient we can take d to be monic, and we shall adopt such a usage from now
on without further notice.
BÃ©zoutâ€™s theorem assures that if d = gcd(f, g), then there exists a, b âˆˆK[X]
such that
d = af + bg.
Nevertheless, the proof of that result gave no clue on how to effectively compute
such polynomials a and b. This issue will be dealt with in Problem 3, when we
show that Euclidâ€™s algorithm remains true for polynomials.
Keeping with the parallelism to the notion of gcd in Z, we say that polynomials
f, g âˆˆK[X]\{0} are relatively prime if gcd(f, g) = 1. We then have the following
important consequence of BÃ©zoutâ€™s theorem.
Corollary 19.3 If f, g âˆˆK[X] \ {0}, then f and g are relatively prime if and only
if there exist polynomials a, b âˆˆK[X] for which af + bg = 1.
Proof If gcd(f, g) = 1, then the existence of a, b âˆˆK[X] as stated above follows
directly from BÃ©zoutâ€™s theorem.
Conversely, if d = gcd(f, g) and there exist a, b âˆˆK[X] such that af + bg = 1,
then, again from BÃ©zoutâ€™s theorem, we have 1 âˆˆS = d K[X], i.e., d is a divisor of
the constant polynomial 1. Therefore, d = 1 up to association, so that 1 is a gcd of
f and g.
âŠ“âŠ”
Corollary 19.4 Let f, g âˆˆK[X] \ {0} be relatively prime and h âˆˆK[X] \ {0} be
such that âˆ‚h < âˆ‚(fg). Then, there exist a, b âˆˆK[X] such that a = 0 or âˆ‚a < âˆ‚g,
b = 0 or âˆ‚b < âˆ‚f and af + bg = h.
Proof By the previous corollary, there exist a1, b1 âˆˆK[X] such that a1f +b1g = 1.
Then, letting a2 = a1h and b2 = b1h, we have a2f + b2g = h. Now, the division
algorithm gives a2 = gq + a, with a = 0 or 0 â‰¤âˆ‚a < âˆ‚g. Thus,
h = (gq + a)f + b2g = af + (qf + b2)g

454
19
On the Factorisation of Polynomials
and, letting b = qf + b2, we have h = af + bg, with a = 0 or âˆ‚a < âˆ‚g. Finally,
since bg = h âˆ’af , if b Ì¸= 0 we can compute
âˆ‚b + âˆ‚g = âˆ‚(bg) = âˆ‚(h âˆ’af ) â‰¤âˆ‚h < âˆ‚(fg) = âˆ‚f + âˆ‚g,
so that âˆ‚b < âˆ‚f .
âŠ“âŠ”
The coming deï¬nition is absolutely central for the rest of this chapter.
Deï¬nition 19.5 A polynomial p âˆˆK[X] \ K is irreducible over K if p cannot
be written as the product of two nonconstant polynomials in K[X]. A polynomial
p âˆˆK[X] \ K that is not irreducible is said to be reducible over K.
In general, it is useful to rephrase the irreducibility condition contrapositively.
This way, a polynomial p âˆˆK[X] \ K is irreducible if and only if the following
condition is satisï¬ed:
p = gh, with g, h âˆˆK[X] â‡’g âˆˆK or h âˆˆK.
(19.1)
Let us now take a look at two simple examples.
Example 19.6 It follows immediately from (19.1) that every polynomial p âˆˆ
K[X] of degree 1 is irreducible. Indeed, letting p = gh, with g, h âˆˆK[X],
Proposition 14.9 assures that âˆ‚g + âˆ‚h = âˆ‚p = 1 and, hence, âˆ‚g = 0 or âˆ‚h = 0, i.e.,
g or h is constant. On the other hand, the Fundamental Theorem of Algebra 15.23
guarantees that the irreducible polynomials in C[X] are precisely those of degree 1.
Example 19.7 If p âˆˆR[X] is irreducible over R, then âˆ‚p = 1 or 2. Indeed,
according to Problem 4, page 386, a complex number z is a root of p if and only if
so is z; then, let us consider two cases:
(a) âˆ‚p â‰¥3 and p has at least one real root, say Î±: the root test (cf. Proposition 15.3)
allows us to write p(X) = (X âˆ’Î±)h(X), for some h âˆˆR[X] of degree greater
than or equal to 2, and p is reducible over R.
(b) âˆ‚p â‰¥3 and p has two complex nonreal conjugate roots, say z and z: by invoking
the root test again, we have p(X) = (X âˆ’z)(X âˆ’z)h(X), for some h âˆˆC[X]
of degree at least 1. However, if z = a + bi and g(X) = (X âˆ’z)(X âˆ’z), then
g(X) = (X âˆ’a âˆ’bi)(X âˆ’a + bi) = (X âˆ’a)2 + b2 âˆˆR[X].
Hence, upon dividing p by g, the division algorithm assures that h âˆˆR[X].
Therefore, p = gh, with g, h âˆˆR[X] \ R, and p is reducible over R.
Thanks to the last example above, from now on we shall restrict our attention
to the irreducibility of polynomials over Q. In this sense, an argument analogous
to that of item (a) of the last example (cf. Problem 5) allows us to conclude that if
p âˆˆQ[X] has degree 2 or 3, then p is irreducible over Q if and only if it does not
have a rational root.

19.1
Unique Factorisation in Q[X]
455
Back to the general concept of irreducible polynomial, note that if p âˆˆQ[X] \ Q
is irreducible, then the only divisors of p in Q[X] are the constant polynomials and
those associated with p. This being said, we have the following important auxiliary
result, which is the analogue of Lemma 6.41 for polynomials.
Lemma 19.8 Let p âˆˆQ[X]\Q be irreducible. If f1, . . . , fk âˆˆQ[X]\{0} are such
that p | f1 . . . fk, then there exists 1 â‰¤i â‰¤k such that p | fi.
Proof By induction on k, it sufï¬ces to show that if p | fg, with f, g âˆˆQ[X] \ {0},
then p | f or p | g. If p âˆ¤f , we ï¬rst claim that gcd(f, p) = 1; indeed, if d =
gcd(f, p), then d | p, so that either d âˆˆQ or d is associated with p in Q[X].
However, if this last possibility holds, it follows from d | f that p | f too, which
is a contradiction. Therefore, d âˆˆQ and, up to association, we can suppose that
d = 1.
Now, Corollary 19.3 guarantees the existence of polynomials a, b âˆˆQ[X] such
that af + bp = 1, and hence
a(fg) + (bg)p = g.
Since p | (fg), it follows from the equality above and Problem 6 that p | g, as
wished.
âŠ“âŠ”
We shall now establish an analogue of the Fundamental Theorem of Arithmetic
for polynomials over Q, thus showing that every polynomial f âˆˆQ[X] \ Q can be
uniquely written, up to association, as a product of a ï¬nite number of irreducible
polynomials.
Theorem 19.9 Every polynomial f âˆˆQ[X] \ Q can be written as a product of a
ï¬nite number of irreducible polynomials over Q. Moreover, such a decomposition
of f is unique in the following sense: if p1, . . . , pk, q1, . . . , ql âˆˆQ[X] \ Q are
irreducible and such that p1 . . . pk = q1 . . . ql, then k = l and, up to reordering, pi
and qi are associated in Q[X].
Proof For the existence part, let us make induction on âˆ‚f , the case âˆ‚f = 1 being
immediate (for we have already seen that, in this case, f is irreducible). As induction
hypothesis, assume that the result is true for every nonconstant polynomial with
rational coefï¬cients and degree less than n, and take f âˆˆQ[X]\Q such that âˆ‚f = n.
If f is irreducible, there is nothing left to do. Otherwise, we can write f = gh, with
g, h âˆˆQ[X] \ Q. Thus, âˆ‚g, âˆ‚h < n, and the induction hypotheses guarantees
that each of g and h can be written as a product of a ï¬nite number of irreducible
polynomials with rational coefï¬cients, say g = p1 . . . pj and h = pj+1 . . . pk.
Then, f = gh = p1 . . . pjpj+1 . . . pk, a product of a ï¬nite number of irreducible
polynomials over Q.
For the uniqueness part, let p1 . . . pk = q1 . . . ql, with p1, . . . , pk, q1, . . . , ql âˆˆ
Q[X] \ Q being irreducible over Q. If k = 1, we have p1 = q1 . . . ql, and the
irreducibility of p1 assures that l = 1. Similarly, l = 1 â‡’k = 1. Then, suppose
that k, l > 1; since pk | q1 . . . ql, Lemma 19.8 guarantees the existence of an index

456
19
On the Factorisation of Polynomials
1 â‰¤j â‰¤l such that pk | qj. Assume, without loss of generality, that j = l. Since ql
is irreducible over Q and pk /âˆˆQ, the only possibility is that pk and ql be associated
in Q[X], say pk = uql, for some u âˆˆQ \ {0}. Then,
p1 . . . pkâˆ’1 = q1 . . . qlâˆ’2uqlâˆ’1 = qâ€²
1 . . . qâ€²
lâˆ’1,
with qâ€²
i = qi for 1 â‰¤i < l âˆ’2 and qâ€²
lâˆ’1 = uqlâˆ’1, all irreducible over Q.
Arguing by induction on max{k, l}, the induction hypothesis gives k âˆ’1 = l âˆ’1
and, up to reordering, pi associated to qâ€²
i for 1 â‰¤i â‰¤l âˆ’1. Hence, up to reordering
pi and qi are also associated over Q, for 1 â‰¤i â‰¤k.
âŠ“âŠ”
We can summarize the previous result by saying that one has unique factorisation
in Q[X]. As within Z, if f âˆˆQ[X] \ Q is factorised as
f = p1 . . . pk,
with p1, . . . , pk âˆˆQ[X] \ Q irreducible, then, by gathering together the irreducible
factors pi which are equal up to association, we obtain
f = qÎ±1
1 . . . qÎ±1
l ,
(19.2)
with q1, . . . , ql âˆˆQ[X] \ Q irreducible and pairwise non associated, and Î±1, . . . ,
Î±l âˆˆN. Expression (19.2) (which is also unique up to association and reordering)
is the canonical factorisation of f in Q[X], and q1, . . . , ql are the irreducible
factors of f in Q[X].
Problems: Sect. 19.1
1. * Complete the proof of Theorem 19.2.
2. Let f, g âˆˆQ[X] \ Q be polynomials with canonical factorisations
f = pÎ±1
1 . . . pÎ±k
k q
Î±â€²
1
1 . . . q
Î±â€²
l
l
and g = pÎ²1
1 . . . pÎ²k
k r
Î²â€²
1
1 . . . rÎ²â€²
m
m ,
with p1, . . . , pk, q1, . . . , ql and r1, . . . , rm being monic, irreducible and pairwise
non associated, and Î±i, Î±â€²
i, Î²j, Î²â€²
j âˆˆN. Prove that
gcd(f, g) = pÎ³1
1 . . . pÎ³k
k ,
with Î³i = min{Î±i, Î²i} for 1 â‰¤i â‰¤k.
3. * Prove the following version of Euclidâ€™s algorithm for polynomials: given f, g âˆˆ
K[X] \ {0}, with âˆ‚f â‰¥âˆ‚g, the division algorithm in K[X] gives

19.1
Unique Factorisation in Q[X]
457
Step 1
: f
= gq1 + r1
0 â‰¤âˆ‚r1 < âˆ‚g
Step 2
: g
= r1q2 + r2
0 â‰¤âˆ‚r2 < âˆ‚r1
Step 3
: r1
= r2q3 + r3
0 â‰¤âˆ‚r3 < âˆ‚r2
Â· Â· Â·
Â· Â· Â·
Step j
: rjâˆ’2 = rjâˆ’1qj + rj
0 â‰¤âˆ‚rj < âˆ‚rjâˆ’1
Step j + 1 : rjâˆ’1 = rjqj+1 + 0
As in Z, note that the execution of the algorithm actually stops after a ï¬nite
number of steps. Indeed, since r1, r2, . . . âˆˆK[X] satisfy âˆ‚g > âˆ‚r1 > âˆ‚r2 >
. . . â‰¥0, there must exist a least index j such that rj Ì¸= 0. Show that rj =
gcd(f, g).
4. Compute gcd(X4 âˆ’X3 âˆ’3X2 + 2X + 3, X5 âˆ’X3 + 4X2 âˆ’6X âˆ’12).
5. * If p âˆˆQ[X] is a polynomial of degree 2 or 3, prove that p is irreducible over
Q if and only if p has no roots in Q.
6. * If f, g, h âˆˆQ[X] \ {0} are such that f | g, h, prove that f divides ag + bh, for
all a, b âˆˆQ[X].
7. If f âˆˆR[X] \ R has degree greater than 1, prove that f can be written, uniquely
up to association, as a product of a ï¬nite number of irreducible polynomials over
R.
8. Prove Fermatâ€™s last theorem for polynomials: if f, g, h âˆˆR[X] \ R have no
nontrivial common factors, and are such that
f (X)n + g(X)n = h(X)n,
then n = 1 or 2.
9. The purpose of this problem is to prove the partial fractions decomposition
theorem. To this end, let K = Q, R or C, let f, g âˆˆK[X] \ {0} be given and
think of f
g as the rational function that sends each x âˆˆK \ gâˆ’1(0) to f (x)
g(x) .
(a) If âˆ‚f < âˆ‚g and g = gÎ±1
1 . . . gÎ±k
k
is the canonical decomposition of g in
irreducible polynomials in K[X] (established in the previous problem if K =
R), prove that there exist f1, . . . , fk âˆˆK[X], with fj = 0 or âˆ‚fj < âˆ‚(g
Î±j
j )
for 1 â‰¤j â‰¤k, and
f
g =
k

j=1
fj
g
Î±j
j
.
(b) If g is irreducible over K and k â‰¥1 is an integer, prove that there exist
polynomials q, r1, . . . , rk âˆˆK[X], with rj = 0 or âˆ‚rj < âˆ‚g for 1 â‰¤j â‰¤k,
and
f
gk = q +
k

j=1
rj
gj .

458
19
On the Factorisation of Polynomials
19.2
Unique Factorisation in Z[X]
In the previous section, we studied the problem of unique factorisation for poly-
nomials with rational coefï¬cients. In this section, we extend the analysis of this
problem to polynomials with integer coefï¬cients. In this respect, the coming
deï¬nition will be crucial for all that follows.
Deï¬nition 19.10 The content of f âˆˆZ[X] \ {0}, denoted c(f ), is the gcd of
the nonvanishing coefï¬cients of f . If c(f ) = 1, we say that f is a primitive
polynomial in Z[X].
For the sake of notation, if f = anXn + Â· Â· Â· + a1X + a0 âˆˆZ[X] \ {0}, we shall
write
c(f ) = gcd(a0, . . . , an).
The coming lemma, whose proof we leave to the reader as an exercise (cf.
Problem 1), establishes two useful, albeit simple, properties of the content of
polynomials with integer coefï¬cients.
Lemma 19.11
(a) If f âˆˆZ[X] \ {0} and a âˆˆZ \ {0}, then c(af ) = |a| Â· c(f ). In particular, there
exists a primitive g âˆˆZ[X] \ {0} such that f = c(f )g.
(b) If f âˆˆQ[X]\{0}, then, up to multiplication by âˆ’1, there exist unique relatively
prime nonzero integers a, b and g âˆˆZ[X] primitive such that f = (a/b)g.
The importance of the concept of content for polynomials in Z[X] lies in the key
role it plays on the study of irreducibility of polynomials over Z, as we shall now
deï¬ne.
Deï¬nition 19.12 A polynomial p âˆˆZ[X] \ Z is
irreducible1 over Z if p is
primitive and cannot be written as the product of two nonconstant polynomials of
Z[X]. A primitive polynomial p âˆˆZ[X] \ Z which is not irreducible is said to be
reducible over Z.
As in the previous section, it is useful to rephrase the irreducibility condition
for integer coefï¬cient nonconstant polynomials contrapositively, so that a primitive
polynomial p âˆˆZ[X] \ Z is irreducible if and only if the following condition is
satisï¬ed:
p = gh, with g, h âˆˆZ[X] â‡’g = Â±1 or h = Â±1.
(19.3)
The coming result is known in mathematical literature as Gaussâ€™ lemma.
1Although this deï¬nition is slightly more restrictive than that usually found in most textbooks, it
will be sufï¬cient for our purposes.

19.2
Unique Factorisation in Z[X]
459
Proposition 19.13 (Gauss)
For f, g âˆˆZ[X] \ Z, we have:
(a) c(fg) = c(f )c(g). In particular, fg is primitive if and only if2 so are f and g.
(b) If f is primitive, then f is irreducible in Z[X] if and only if it is irreducible in
Q[X].
(c) If f and g are primitive and associated in Q[X], then f = Â±g.
Proof
(a) Lemma 19.11 shows that if f = c(f )f1 and g = c(g)g1, then f1, g1 âˆˆZ[X]
are primitive and fg = c(f )c(g)f1g1, so that c(fg) = c(f )c(g)c(f1g1).
Hence, it sufï¬ces to show that f1g1 is primitive, or, which is the same, that
f, g primitive â‡”fg primitive.
If f is not primitive, then there exists a prime p âˆˆZ such that p divides all
of the coefï¬cient of f . Then, p divides all of the coefï¬cients of fg, and fg is
not primitive. Analogously, if g is not primitive, then fg is not primitive too.
Conversely, assume that f (X) = amXm + Â· Â· Â· + a1X + a0 and g(X) =
bnXn + Â· Â· Â· + b1X + b0 are both primitive, but fg is not. Take a prime p âˆˆZ
such that p divides all of the coefï¬cients of fg, and let k, l â‰¥0 be the smallest
indices such that p âˆ¤ak, bl (such k and l do exist, for otherwise f or g would
not be primitive). Letting ck+l denote the coefï¬cient of Xk+l in fg, we have
ck+l = Â· Â· Â· + akâˆ’2bl+2 + akâˆ’1bl+1 + akbl + ak+1blâˆ’1 + ak+2blâˆ’2 + Â· Â· Â· .
Now, since p | ck+l and p | a0, . . . , akâˆ’1, b0, . . . , blâˆ’1, the above equality
guarantees that p | akbl, which is a contradiction.
(b) Implication â‡) is clear. For the converse, take f âˆˆZ[X] \ Z primitive and
suppose that f is reducible in Q[X], say f = gh, with g, h âˆˆQ[X] \ Q.
Lemma 19.11 assures that we can take a, b, c, d âˆˆZ\{0} such that g = (a/b)g1
and h = (c/d)h1, with g1, h1 âˆˆZ[X] primitive. Then,
bdf = bg Â· dh = ag1 Â· ch1 = acg1h1.
However, since g1h1 is primitive by (a), taking contents in both sides of the
equality above we obtain |bd| Â· c(f ) = |ac|. Therefore, ac
bd = Â±c(f ) âˆˆZ and,
once again from the equality above, f = Â±c(f )g1h1, i.e., f is reducible in
Z[X].
(c) If f = (a/b)g, with a, b âˆˆZ \ {0}, then bf = ag, and taking contents we get
|b| Â· c(f ) = |a| Â· c(g). However, since c(f ) = 1 and c(g) = 1, it comes that
|a| = |b|, and hence a/b = Â±1.
âŠ“âŠ”
2For another proof of this item, see Problem 6, page 469.

460
19
On the Factorisation of Polynomials
We can ï¬nally state and prove another theorem of Gauss, which for integer
coefï¬cient polynomials is the analogue of Theorem 19.9.
Theorem 19.14 (Gauss) Every primitive polynomial f âˆˆZ[X] \ Z can be written
as a product of a ï¬nite number of irreducible polynomials in Z[X]. Moreover, such
a way of writing f is unique up to a reordering of the factors and multiplication of
some of them by âˆ’1.
Proof Let us start by establishing the existence of a factorisation of f as a product
of irreducible polynomials. To this end, looking at f as a polynomial in Q[X],
Theorem 19.9 assures the existence of irreducible polynomials p1, . . . , pk âˆˆQ[X]\
Q such that f = p1 . . . pk. Write pi = (ai/bi)qi, with ai, bi âˆˆZ \ {0} relatively
prime and qi âˆˆZ[X] \ Z primitive. Since qi is obviously also irreducible in Q[X],
item (b) of Gaussâ€™ lemma guarantees that qi is irreducible in Z[X]. Letting a =
a1 . . . ak and b = b1 . . . bk, we then have
f = (a/b)q1 . . . qk.
However, since q1, . . . , qk are all primitive, item (a) of Gaussâ€™ lemma guarantees
that q1 . . . qk is primitive too. Thus, taking contents in the last equality above, we
get
|b| = |b| Â· c(f ) = |a| Â· c(q1 . . . qk) = |a|.
It comes that a/b = Â±1, and hence f
= q1 . . . qk, a product of irreducible
polynomials in Z[X].
The proof of the uniqueness part of the statement parallels that of Theorem 19.9,
once we show the following claim: if p, f, g âˆˆZ[X]\Z are such that p is irreducible
and p | fg in Z[X], then p | f or p | g in Z[X]. To this end, note ï¬rstly (from
item (b) of Gaussâ€™ lemma) that p is also irreducible in Q[X]. In turn, this being so,
we already know that p | f or p | g in Q[X]. If p | f in Q[X] (the other case is
analogous), there exists f1 âˆˆQ[X] such that f = f1p. Choosing a, b âˆˆZ such
that f1 = (a/b)f2, with f2 âˆˆZ[X] \ Z primitive, we have
bf = bf1p = af2p.
Now, p and f2 primitive implies (once more from item (a) of Gaussâ€™ lemma) f2p
primitive; taking contents in the equality above, we obtain |b|Â·c(f ) = |a|Â·c(f2p) =
|a|. Hence, a/b = Â±c(f ) âˆˆZ, so that f1 âˆˆZ[X] and p | f in Z[X].
âŠ“âŠ”
Gaussâ€™ theorem allows us to deï¬ne the greatest common divisor of two polyno-
mials f, g âˆˆZ[X] \ Z. To this end, given f âˆˆZ[X] \ Z, start using Gaussâ€™ theorem
to write
f = Â±c(f )f n1
1 . . . f nk
k ,

19.3
Polynomials Over Zp
461
with n1, . . . , nk âˆˆN and f1, . . . , fk âˆˆZ[X] being irreducible, pairwise non asso-
ciated and having positive leading coefï¬cients. This is the canonical factorisation
of f in Z[X].
Now, let g âˆˆZ[X] \ Z have canonical factorisation g = Â±c(g)gm1
1
. . . gml
l . If
h âˆˆZ[X]\Z is irreducible, has positive leading coefï¬cient and is such that h | f, g,
then there exists 1 â‰¤i â‰¤k and 1 â‰¤j â‰¤l for which h = fi and h = gj, so that
fi = gj. In turn, this means that, up to a change of notation, we can write
f = Â±c(f )hn1
1 . . . hnk
k f p1
1
. . . f pl
r
and g = Â±c(g)hm1
1 . . . hmk
k gq1
1 . . . gqs
s ,
with h1, . . . , hk, f1, . . . , fr, g1, . . . , gs âˆˆZ[X] \ Z irreducible, with positive lead-
ing coefï¬cients and pairwise non associated and n1, . . . , nk, p1, . . . , pl, q1, . . . , qs âˆˆ
Z+. We thus let, in Z[X],
gcd(f, g) = gcd(c(f ), c(g))ha1
1 . . . hak
k ,
with ai = min{ni, mi}, for 1 â‰¤i â‰¤k.
Problems: Sect. 19.2
1. * Prove Lemma 19.11.
2. * Let f âˆˆZ[X] be a monic and nonconstant polynomial. If f is reducible over
Q, prove that there exist monic and nonconstant polynomials g, h âˆˆZ[X] such
that f = gh.
3. Let f, g âˆˆZ[X] \ Z be primitive. For a given common divisor d âˆˆZ[X] of f
and g, show that the following are equivalent:
(a) d = gcd(f, g).
(b) If dâ€² âˆˆZ[X] divides f and g in Z[X], then dâ€² | d.
19.3
Polynomials Over Zp
We saw in Sect. 11.2 that, for a prime p âˆˆZ, the set Zp of congruence classes
modulo p can be furnished with operations of addition, subtraction, multiplication
and division quite similar to those of C. In turn, thanks to such a resemblance,
essentially all of the concepts and results on polynomials studied so far remain true
within the set Zp[X] of polynomials with coefï¬cients in Zp.
Our purpose here is to make explicit comments on some similarities and
differences between polynomials over Zp and over K, with K = Q, R or C. In
this sense, we shall leave to the reader the task of checking that all of the other
deï¬nitions and results presented for K[X] (except those of Sects. 15.3 and 18.2 and

462
19
On the Factorisation of Polynomials
of Chap. 17) remain valid, ipsis literis, for Zp[X]. We also take the opportunity to
deduce, with the aid of polynomials over Zp, some results on Number Theory and
Combinatorics inaccessible by other means. In particular, we complete the proof
of the existence of primitive roots modulo p, thus completing the discussion of
Sect. 12.2.
Given f (X) = anXn + Â· Â· Â· + a1X + a0 âˆˆZ[X], we deï¬ne Zp[X] to be the set
of formal expressions f of the form
f (X) = anXn + Â· Â· Â· + a1X + a0,
(19.4)
where a0, a1, . . . , an respectively denote the congruence classes of a0, a1, . . . , an
modulo p. As before, such an f is called a polynomial over Zp.
The correspondence f â†’f deï¬nes a map
Ï€p : Z[X] âˆ’â†’Zp[X]
f
âˆ’â†’
f
which is obviously surjective and is called the canonical projection of Z[X] onto
Zp[X]. For f, g âˆˆZ[X], it is immediate to verify that
f (X) = g(X) in Zp[X]
â‡•
âˆƒh âˆˆZ[X]; f (X) = g(X) + ph(X) in Z[X].
Equivalently, letting
p Z[X] = {ph; h âˆˆZ[X]},
we have
f = 0 â‡”f âˆˆpZ[X].
We extend the operations of addition and multiplication in Zp to homonymous
operations +, Â· : Zp[X] Ã— Zp[X] â†’Zp[X] by setting, for f, g âˆˆZ[X],
f + g = f + g and f Â· g = fg.
We leave to the reader the task of verifying the well deï¬niteness of these operations
in Zp[X], which can be done in a way entirely analogous to the well deï¬niteness of
the operations of Zp (cf. Sect. 11.2; see, also, Problem 1).
As in Z[X], we say that a polynomial f âˆˆZp[X] \ {0} as in (19.4) has degree
n if an Ì¸= 0, i.e., if p âˆ¤an. More generally, if f âˆˆZ[X] \ pZ[X], then f Ì¸= 0 and
âˆ‚f â‰¤âˆ‚f .

19.3
Polynomials Over Zp
463
The two coming examples use the multiplication of Zp[X] to establish interesting
properties of binomial numbers.
Example 19.15 If p âˆˆZ is a prime number and k âˆˆN, prove that
pk
j

is a multiple
of p, for every integer 1 â‰¤j < pk.
Proof Example 6.42 shows that (X+1)p = Xp+1 in Zp[X]. Assume, by induction
hypothesis, that (X + 1)pl = Xpl + 1 in Zp[X] and for some l âˆˆN. Then, by
successively applying the initial case and the inductive hypothesis, we obtain
(X + 1)pl+1 =

(X + 1)ppl
= (Xp + 1)pl = (Xp)pl + 1 = Xpl+1 + 1.
Thus,
(X + 1)pk = Xpk + 1
for every k âˆˆN.
On the other hand, we also have
(X + 1)pk = Xpk +

pk
pk âˆ’1

Xpkâˆ’1 + Â· Â· Â· +
pk
1

X + 1,
so that
pk
j

= 0 for every integer 1 â‰¤j < pk. In other words, p divides
pk
j

.
âŠ“âŠ”
The next example makes use of the binary representation of natural numbers (cf.
Example 4.12 of [8] or Problem 11, page 163). For a generalization, see Problem 11.
Example 19.16 (Romania) Prove that the number of odd binomial coefï¬cients in
the n-th line of Pascalâ€™s triangle is a power of 2.
Proof Let
n = 2ak + 2akâˆ’1 + Â· Â· Â· + 2a1 + 2a0
be the binary representation of n, with 0 â‰¤a0 < a1 < . . . < ak. The previous
example allows us to write, in Z2[X],
(X + 1)n = (X + 1)2ak (X + 1)2akâˆ’1 . . . (X + 1)2a0
= (X2ak + 1)(X2akâˆ’1 + 1) . . . (X2a0 + 1).
(19.5)
Let S denote the set of natural numbers which can be written as a sum of (at
least one of) distinct powers of 2, chosen from 2ak, 2akâˆ’1, . . . , 2a1 and 2a0. By the
fundamental principle of counting and the uniqueness of binary representation of
naturals, we have |S| = 2k+1 âˆ’1. On the other hand, by expanding the products of
the last expression in (19.5), we get

464
19
On the Factorisation of Polynomials
(X + 1)n =

mâˆˆS
Xm + 1
(19.6)
a sum with exactly 2k+1 summands. Now, by invoking once more the formula of
binomial expansion, we have
(X + 1)n = Xn +
n
1

Xnâˆ’1 + Â· Â· Â· +

n
n âˆ’1

X + 1.
(19.7)
Therefore, by comparing (19.6) and (19.7), we conclude that exactly 2k+1 of the
binomial numbers of the form
n
j

(which compose the n-th line of Pascalâ€™s triangle)
satisfy
n
j

Ì¸= 0, i.e., are odd.
âŠ“âŠ”
In order to deï¬ne the polynomial function associated to a polynomial f âˆˆZp[X],
we have to take some care. Firstly, note that if f âˆˆZ[X] and a, b âˆˆZ satisfy
a â‰¡b (mod p), then item (c) of Proposition 10.6 guarantees that
f (a) â‰¡f (b) (mod p);
on the other hand, if f = g in Zp[X], we saw above that there exists h âˆˆZ[X] such
that f (X) = g(X) + ph(X). Hence, for a âˆˆZ we have
f (a) = g(a) + ph(a) â‰¡g(a) (mod p).
Given f âˆˆZp[X], the above comments allow us to deï¬ne the polynomial
function Ëœf : Zp â†’Zp by setting, for a âˆˆZ,
Ëœf (a) = g(a),
(19.8)
where g âˆˆZ[X] is any polynomial for which f = g. Obviously, the image of Ëœf
is a ï¬nite set, for Zp is itself ï¬nite. From now on, whenever there is no danger of
confusion, we shall write (19.8) simply as
f (a) = f (a).
The coming example shows that, contrary to what happens with polynomials
over Q, R or C, the polynomial function associated to a nonzero polynomial over
Zp[X] can vanish identically. In other words, it is no longer valid that two distinct
polynomials over Zp have distinct polynomial functions.
Example 19.17 The polynomial f (X) = Xp âˆ’X âˆˆZp[X] is clearly a nonzero
element of Zp[X]. On the other hand, letting f : Zp â†’Zp denote its associated
polynomial function, Fermatâ€™s little theorem gives

19.3
Polynomials Over Zp
465
f (a) = ap âˆ’a = ap âˆ’a = 0
for every a âˆˆZp. Thus, f vanishes identically.
Let f âˆˆZ[X] and a âˆˆZ be given. As in Sect. 15.1, we say that a âˆˆZp is a root
of f provided f (a) = 0. An easy review of the proof of the root test shows that
it continues to hold in Zp[X]. In particular, from the above example we obtain the
following important result.
Proposition 19.18 In Zp[X], we have
Xpâˆ’1 âˆ’1 = (X âˆ’1)(X âˆ’2) . . . (X âˆ’(p âˆ’1)).
Proof Since 1, 2, . . . , p âˆ’1 are roots of Xpâˆ’1 âˆ’1 in Zp (from the last example),
item (c) of Proposition 15.3 assures that the polynomial Xpâˆ’1 âˆ’1 is divisible by
(X âˆ’1)(X âˆ’2) . . . (X âˆ’(p âˆ’1)) in Zp[X]. However, since both such polynomials
are monic and have degree p âˆ’1, they are actually equal.
âŠ“âŠ”
In Zp[X], all of the deï¬nitions and results of Sect. 19.1 remain true. In particular,
we can state the following theorem, whose proof is entirely analogous to that of
Theorem 19.9.
Theorem 19.19 If p âˆˆZ is prime, then every polynomial f âˆˆZp[X] \ Zp can
be written as a product of a ï¬nite number of irreducible polynomials over Zp.
Moreover, such a decomposition of f is unique up to association and reordering
of the irreducible factors.
As a ï¬rst application of the previous result, we shall now prove the existence of
primitive roots modulo p. For the statement and proof of the coming result, perhaps
the reader might want to review the material of Sect. 12.2.
Theorem 19.20 If p âˆˆZ is an odd prime and d is a positive divisor of p âˆ’1, then
the algebraic congruence
xpâˆ’1 âˆ’1 â‰¡0 (mod p)
(19.9)
has exactly Ï•(d) roots of order d, pairwise incongruent modulo p. In particular, p
has exactly Ï•(p âˆ’1) primitive roots pairwise incongruent modulo p.
Proof For a positive divisor d of p âˆ’1, let N(d) denote the number of roots of
the algebraic congruence (19.9) which are pairwise incongruent modulo p and have
order d. Since the roots of (19.9) are the integers 1, 2, . . . , p âˆ’1, and since by
Proposition 12.2 each of these numbers has order equal to a divisor of p âˆ’1, we
conclude that

0<d|(pâˆ’1)
N(d) = p âˆ’1.

466
19
On the Factorisation of Polynomials
If we show that N(d) â‰¤Ï•(d), Proposition 8.11 will give
p âˆ’1 =

0<d|(pâˆ’1)
N(d) â‰¤

0<d|(pâˆ’1)
Ï•(d) = p âˆ’1.
Therefore, we will obtain N(d) = Ï•(d) for every positive divisor d of p âˆ’1.
Then, let d be a positive divisor of p âˆ’1. If N(d) = 0, it is clear that N(d) â‰¤
Ï•(d). Otherwise, let a be an integer of order d modulo p; then, the congruence
classes 1, a, . . . , adâˆ’1 âˆˆZp are pairwise distinct roots of Xd âˆ’1 âˆˆZp[X]. On the
other hand, Corollary 15.8 guarantees that such a polynomial has at most d distinct
roots in Zp, so that its roots are exactly 1, a, . . . , adâˆ’1. Therefore, if Î± âˆˆZ is
a root of order d of (19.9), then Î± âˆˆZp is a root of Xd âˆ’1 âˆˆZp[X], so that
Î± âˆˆ{1, a, . . . , adâˆ’1}. We conclude that the roots of order d of (19.9) are precisely
the elements of order d of the set {1, a, . . . , adâˆ’1} and, hence,
N(d) = #{0 â‰¤k â‰¤d âˆ’1; ordp(ak) = d}.
Item (c) of Proposition 12.5 counts the number of elements of the set in the right
hand side above: since ordp(a) = d, we have
ordp(ak) = d â‡”
d
gcd(d, k) = d â‡”gcd(d, k) = 1.
Therefore,
#{0 â‰¤k â‰¤d âˆ’1; ordp(ak) = d} = #{0 â‰¤k â‰¤d âˆ’1; gcd(d, k) = 1}
= Ï•(d).
The above argument has shown that either N(d) = 0 or Ï•(d), so that, in any
case, we have N(d) â‰¤Ï•(d), as wished.
For what is left to do, it sufï¬ces to note that N(p âˆ’1) = Ï•(p âˆ’1), so that
there are exactly Ï•(p âˆ’1) integers, pairwise incongruent modulo p and with order
p âˆ’1 = Ï•(p) modulo p. In other words, there are precisely Ï•(p âˆ’1) pairwise
incongruent primitive roots modulo p. (For the sake of completeness, it is worth
noticing that this result agrees with that of Proposition 12.8.)
âŠ“âŠ”
We ï¬nish this section by exhibiting yet another beautiful application of the theory
of polynomials over Zp to Number Theory.
Example 19.21 (MiklÃ³s-Schweitzer) If p > 3 is a prime number satisfying p â‰¡
3 (mod 4), prove that

1â‰¤xÌ¸=yâ‰¤pâˆ’1
2
(x2 + y2) â‰¡1 (mod p).

19.3
Polynomials Over Zp
467
Proof In all that follows, without further mention, indices in products will vary from
1 to pâˆ’1
2 .
If P stands for the product at the left hand side, then
P =

xÌ¸=1
(x2 + 12) Â·

xÌ¸=2
(x2 + 22) Â· . . . Â·

xÌ¸= pâˆ’1
2

x2 +
p âˆ’1
2
2
=

(x2 + 12) Â·

(x2 + 22) Â· . . . Â·

 
x2 +
p âˆ’1
2
2
2
pâˆ’1
2
Â· 12 Â· 22 Â· . . . Â·

pâˆ’1
2
2
.
Now, for each integer 1 â‰¤k â‰¤pâˆ’1
2 , let ck denote its inverse modulo p. Then,
modulo p we get

(x2 + k2) â‰¡k2 
((ckx)2 + 1) â‰¡k2 
(x2 + 1).
Indeed, the ï¬rst congruence is immediate and, for the second one, it sufï¬ces to
observe that {(ckx)2; 1 â‰¤x â‰¤pâˆ’1
2 } is a set of pâˆ’1
2
pairwise incongruent quadratic
residues modulo p; hence, also modulo p, we have
{(ckx)2; 1 â‰¤x â‰¤p âˆ’1
2
} = {x2; 1 â‰¤x â‰¤p âˆ’1
2
}.
It then follows that, modulo p,
2
pâˆ’1
2
Â· 12 Â· 22 Â· . . . Â·
p âˆ’1
2
2
P â‰¡12 Â· 22 Â· . . . Â·
p âˆ’1
2
2 
(x2 + 1)
 pâˆ’1
2
or, which is the same,
2
pâˆ’1
2 P â‰¡

(x2 + 1)
 pâˆ’1
2 .
Let Î± be a primitive root modulo p and Q = 0(x2 + 1). Since {Î±2k; 1 â‰¤k â‰¤
pâˆ’1
2 } is a set of pâˆ’1
2
pairwise incongruent quadratic residues modulo p, we have
{Î±2k; 1 â‰¤k â‰¤pâˆ’1
2 } = {x2; 1 â‰¤x â‰¤pâˆ’1
2 } modulo p, so that
Q =

(Î±2k + 1) and 2
pâˆ’1
2 P â‰¡Q
pâˆ’1
2 (mod p).
(19.10)
In order to compute the residue of Q, modulo p, let f âˆˆZ[X] be deï¬ned by
f (X) = (X âˆ’Î±2)(X âˆ’Î±4) . . . (X âˆ’Î±pâˆ’1),

468
19
On the Factorisation of Polynomials
so that
Q â‰¡(âˆ’1)
pâˆ’1
2 f (âˆ’1) â‰¡âˆ’f (âˆ’1) (mod p).
(Here we have used the fact that p â‰¡3 (mod 4) in the second congruence above.)
Now, observe that
f (X2) = (X âˆ’Î±)(X âˆ’Î±2) . . . (X âˆ’Î±
pâˆ’1
2 )(X + Î±)(X + Î±2) . . . (X + Î±
pâˆ’1
2 ).
For 1 â‰¤i, j â‰¤pâˆ’1
2 , if Î±i â‰¡âˆ’Î±j (mod p), then Î±2i â‰¡Î±2j (mod p) and, since Î±
is a primitive root modulo p, we obtain 2i = 2j, thus i = j; however this being
the case, we would have Î±i â‰¡âˆ’Î±i (mod p), which is an absurd. Then, the set
{Â±Î±, Â±Î±2, . . . , Â±Î±
pâˆ’1
2 } is a RRS modulo p, so that it coincides, modulo p, with
{1, 2, . . . , p âˆ’1}. Therefore, letting f âˆˆZp[X] denote the image of f by the
projection of Z[X] onto Zp[X] and invoking the result of Proposition 19.18, we
arrive at
f (X2) = (X âˆ’1)(X âˆ’2) . . . (X âˆ’p âˆ’1) = Xpâˆ’1 âˆ’1
and, hence, at
f (X) = X
pâˆ’1
2
âˆ’1.
However, since p â‰¡3 (mod 4), this gives
Q = âˆ’f (âˆ’1) = âˆ’(âˆ’1)
pâˆ’1
2
+ 1 = 2,
i.e., Q â‰¡2 (mod p).
Finally, substituting this information in (19.10), we get the congruence 2
pâˆ’1
2 P â‰¡
2
pâˆ’1
2 (mod p), and hence P â‰¡1 (mod p).
âŠ“âŠ”
Problems: Sect. 19.3
1. * Given a prime number p, check the well deï¬niteness of the operations of
addition and multiplication in Zp[X]. Also, show that such operations are
associative and commutative, have identities respectively equal to the constant
polynomials 0 and 1, and that multiplication is distributive with respect to
addition.
2. Let p > 2 be a given prime. Find, if any, the roots of Xpâˆ’1 + 1 âˆˆZp[X].

19.3
Polynomials Over Zp
469
3. * Given f âˆˆZ[X] and an integer root a of f , prove that a âˆˆZp is a root of
f âˆˆZp[X]. In particular, conclude that if a1, . . . , ak âˆˆZp are the roots of f ,
then there exists 1 â‰¤j â‰¤k such that a â‰¡aj (mod p).
4. Show that f (X) = X3 âˆ’15X2 + 10X âˆ’84 âˆˆZ[X] has no rational roots.
5. * If p âˆˆZ is prime and f âˆˆZ[X], prove that f (Xp) = f (X)p.
6. * Use the projection Ï€ : Z â†’Zp to prove that if f, g âˆˆZ[X] \ Z are primitive
polynomials (cf. Deï¬nition 19.10), then so is fg.
7. Let p > 2 be a prime number and 1 â‰¤d â‰¤p âˆ’1 be an integer.
(a) If d âˆ¤(p âˆ’1), show that Xd âˆ’1 has no roots in Zp[X].
(b) If d | (p âˆ’1), factorise Xd âˆ’1 in Zp[X].
8. * Let p â‰¥3 be a prime number and, for 1 â‰¤j â‰¤p âˆ’1, let sj(1, 2, . . . , p âˆ’1)
denote the j-th elementary symmetric sum of the natural numbers 1, 2, . . . , pâˆ’
1. Prove that3:
(a) For 1 â‰¤j â‰¤p âˆ’2, we have sj(1, 2, . . . , p âˆ’1) â‰¡0 (mod p).
(b) spâˆ’1(1, 2, . . . , p âˆ’1) â‰¡âˆ’1 (mod p).
9. * If a, b and c are the complex roots of the polynomial X3 âˆ’3X2 + 1, show
that an +bn +cn âˆˆZ for every n âˆˆN, and that such a sum is always congruent
to 1 modulo 17.
10. (France) For a given n âˆˆN, let In denote the number of odd coefï¬cients of the
polynomial (X2 + X + 1)n.
(a) Compute I2m, for m âˆˆZ+.
(b) Show that, for m âˆˆN, we have
I2mâˆ’1 = 2m+1 + (âˆ’1)m+1
3
.
For the coming problem, the reader may ï¬nd it useful to review the statement
of Problem 11, page 163.
11. Prove Lucasâ€™ theorem: given natural numbers m â‰¥n and a prime number p,
if
m =
k

j=0
mjpj and
k

j=0
njpj
are the representations of m and n in base p, then
m
n

â‰¡
k
j=0
mj
nj

(mod p).
3Note that item (b) provides another proof of part of Wilsonâ€™s Theorem 10.26.

470
19
On the Factorisation of Polynomials
In particular, conclude that:
(a) p |
m
n

if and only if mj < nj for some 0 â‰¤j â‰¤k.
(b) Exactly (m0 + 1)(m1 + 1) . . . (mk + 1) binomial numbers of the form
m
n

are not divisible by p.
(c) No binomial number of the form
pk+1âˆ’1
n

is divisible by p.
12. Let p be a prime number and k âˆˆN. Prove that
pk(p âˆ’1)
l

â‰¡
(âˆ’1)q (mod p), if l = pkq; 0 â‰¤q â‰¤p âˆ’1, q âˆˆZ
0 (mod p), otherwise.
.
19.4
More on Irreducible Polynomials
Up to this moment, we do not have at our disposal any method for establishing
the irreducibility of a given polynomial. Obviously, in particular cases one can
sometimes use the direct method, which consists in writing the given polynomial
f (say, in Z[X]) as a product of two other polynomials g, h âˆˆZ[X], and then
of solving the resulting system of equations in the coefï¬cients of g and h, thus
obtaining a nontrivial factorisation for f or reaching a contradiction. We illustrate
such a procedure in the coming example (see, also, Problems 1 and 2).
Example 19.22 Prove that f (X) = X4 + 10X3 + 5X + 1993 is irreducible over Q.
Proof By Gaussâ€™ lemma (cf. Proposition 19.13), it sufï¬ces to show that f cannot
be written as a product of two nonconstant polynomials with integer coefï¬cients.
We now observe that 1993 is prime, a fact that can be easily established with the
aid of Eratosthenesâ€™ sieve, for example. Hence, the rational roots test implies that
the possible integer roots of f are Â±1 or Â±1993, and direct checking shows that
none of these is actually a root.
We are left to discarding the possibility of f having a factorisation of the form
f (X) = (X2 + aX + b)(X2 + cX + d),
with a, b, c, d âˆˆZ. If such happens, then, by expanding the products at the right
hand side and comparing coefï¬cients, we obtain the following system of equations:
â§
âªâªâ¨
âªâªâ©
a + c = 10
ac + b + d = 0
ad + bc = 5
bd = 1993
.
The fourth equation, together with the primality of 1993 and the symmetry of
the factorisation (two factors of degree 2) give (b, d) = (1, 1993) or (âˆ’1, âˆ’1993)

19.4
More on Irreducible Polynomials
471
as the only essentially distinct possibilities. From them, the ï¬rst and third equations
furnish the systems of equations
a + c = 10
a + 1993c = 5
or
a + c = 10
a + 1993c = âˆ’5 .
Finally, it is immediate to check that none of them has integer solutions.
âŠ“âŠ”
As testiï¬ed by the calculations performed in the example above, the use of the
direct method to check that a given polynomial f âˆˆQ[X] is irreducible over
Q is likely to face considerable computational difï¬culties, even in the case of f
having integer coefï¬cients and small degree. Therefore, it would be quite nice to
develop a few techniques that could be effectively applied to the investigation of the
irreducibility of polynomials. In this sense, we start with the following result.
Proposition 19.23 Let f âˆˆZ[X] be monic, and p âˆˆZ be prime.
(a) If f âˆˆZp[X] is irreducible in Zp[X], then f is irreducible in Z[X].
(b) If f (X) = (X âˆ’a)g(X), with g âˆˆZp[X] irreducible, then either f is
irreducible in Z[X] or it has a root Î± âˆˆZ such that Î± â‰¡a (mod p).
Proof
(a) By contraposition, suppose f (X) = g(X)h(X), with g, h âˆˆZ[X] \ Z monic
polynomials. Then, f (X) = g(X)h(X), with âˆ‚g = âˆ‚g and âˆ‚h = âˆ‚h.
(b) Suppose f to be reducible, say f (X) = h(X)l(X), with h, l âˆˆZ[X] \ Z being
monic. Then, âˆ‚h = âˆ‚h, âˆ‚l = âˆ‚l and
(X âˆ’a)g(X) = h(X)l(X).
However, since g is irreducible in Zp[X], Theorem 19.19 assures that either h
or l must be associated to X âˆ’a, so that âˆ‚h = 1 or âˆ‚l = 1.
Assume, without loss of generality, that âˆ‚h = 1. Then, h(X) = X âˆ’Î±, for
some Î± âˆˆZ, so that Î± is an integer root of f . Finally, since h(X) = X âˆ’a (for
h is monic and associated to X âˆ’a), it comes that Î± = a.
âŠ“âŠ”
Example 19.24 Let p âˆˆZ be prime, with p â‰¡5(mod 6), and k âˆˆN be such that
kp + 1 is also prime. Prove that f (X) = X3 + pX2 + pX + kp + 1 is irreducible
in Z[X].
Proof Projecting f into Zp[X], we obtain
f (X) = X3 + 1 = (X + 1)(X2 âˆ’X + 1).
We now claim that âˆ’1 is the only root of f in Zp. Indeed, if f (a) = 0, then
a3 = âˆ’1, so that a3 â‰¡âˆ’1 (mod p). Thus, a6 â‰¡1 (mod p), and hence (by Fermatâ€™s
little theorem, together with item (b) of Proposition 12.2)
ord p(a) | gcd(6, p âˆ’1) = 2.

472
19
On the Factorisation of Polynomials
Therefore, ord p(a) = 1 or 2. Since ord p(a) = 1 â‡’a = 1, which is not a root of
f , we must have ord p(a) = 2. Then, a2 â‰¡1 (mod p) and a Ì¸â‰¡1 (mod p), so that
a â‰¡âˆ’1 (mod p) or, which is the same, a = âˆ’1.
Since 3 Ì¸= 0 in Zp, the above claim guarantees that X2 âˆ’X + 1 has no roots in
Zp[X]; thus, it is irreducible in Zp[X]. The previous proposition then assures that
either f is irreducible in Z[X] or it has a root Î± âˆˆZ such that Î± â‰¡âˆ’1 (mod p).
However, the searching criterion for rational roots assures that an integer root Î± of f
must be a divisor of kp +1, which is prime. Then, either Î± = âˆ’1 or Î± = âˆ’(kp +1),
and testing these possibilities we conclude that none of them is actually a root of f .
Thus, f is irreducible.
âŠ“âŠ”
Remark 19.25 For a given p âˆˆN, we shall prove in Sect. 20.2 that there exist
inï¬nitely many k âˆˆZ for which kp + 1 is prime.
The corollary of the coming result of F. Eisenstein, known in mathematical
literature as Eisensteinâ€™s criterion, will show to be a powerful ally in establishing
the irreducibility of certain polynomials of integer coefï¬cients.
Theorem 19.26 (Eisenstein) Let f (X) = anXn + Â· Â· Â· + a1X + a0 be a polynomial
with integer coefï¬cients and degree n â‰¥1. Let also p âˆˆZ be prime and 1 â‰¤k < n
be an integer such that:
(a) p | a0, a1, . . . , ak.
(b) p2 âˆ¤a0 and p âˆ¤an.
If f = gh, with g, h âˆˆZ[X], then max{âˆ‚g, âˆ‚h} â‰¥k + 1.
Proof Letting g(X) = brXr + Â· Â· Â· + b0 and h(X) = csXs + Â· Â· Â· + c0, we have
an = brcs and a0 = b0c0. Therefore,
p âˆ¤an â‡’p âˆ¤brcs â‡’p âˆ¤br and p âˆ¤cs,
so that, in Zp[X], we have f (X) = g(X)h(X), with âˆ‚g = âˆ‚g = r and âˆ‚h = âˆ‚h = s.
If X | g(X) and X | h(X) in Zp[X], then p | b0 and p | c0 in Z, so that
p2 | b0c0 = a0, which is not the case; hence, in Zp[X], the polynomial X divides
at most one of g or h.
Assume, without loss of generality, that X does not divide h. Since (by
hypothesis (b))
g(X)h(X) = f (X) = anXn + Â· Â· Â· + ak+1Xk+1
= (anXnâˆ’kâˆ’1 + Â· Â· Â· + ak+1)Xk+1,
we thus conclude that Xk+1 | g(X). Thus, r â‰¥k + 1.
âŠ“âŠ”

19.4
More on Irreducible Polynomials
473
Corollary 19.27 (Eisenstein) Let f (X) = anXn +Â· Â· Â·+a1X+a0 be a polynomial
with integer coefï¬cients and degree n â‰¥1. If there exists p âˆˆZ prime such that
p | a0, a1, . . . , anâˆ’1, p2 âˆ¤a0 and p âˆ¤an, then f is irreducible in Q[X].
Proof By Eisensteinâ€™s theorem, if f (X) = g(X)h(X), with g, h âˆˆZ[X], then
either âˆ‚g â‰¥n or âˆ‚h â‰¥n, i.e., either g or h is constant. Thus, f cannot be written
as a product of two nonconstant polynomials with integer coefï¬cients, and Gaussâ€™
lemma guarantees that f is irreducible in Q[X].
âŠ“âŠ”
The coming example brings a classical application of Eisensteinâ€™s criterion,
which will be obtained by other means in Sect. 20.2.
Example 19.28 If p âˆˆZ is prime and f âˆˆZ[X] is given by
f (X) = Xpâˆ’1 + Xpâˆ’2 + Â· Â· Â· + X + 1,
(19.11)
then f is irreducible in Q.
Proof We start by noticing that f (X) = g(X)h(X) if and only if f (X + 1) =
g(X + 1)h(X + 1), with g(X) and g(X + 1) (as well as h(X) and h(X + 1)) having
equal degrees. Thus, it sufï¬ces to show that f (X + 1) is irreducible in Q[X].
Since (X âˆ’1)f (X) = Xp âˆ’1, we obtain
Xf (X + 1) = (X + 1)p âˆ’1 = Xp +
p
1

Xpâˆ’1 + Â· Â· Â· +

p
p âˆ’1

X,
and hence
f (X + 1) = Xpâˆ’1 +
p
1

Xpâˆ’2 + Â· Â· Â· +

p
p âˆ’1

.
Now, note that
 p
pâˆ’1

= p and recall, from Example 6.42, that p |
p
k

for 1 â‰¤
k â‰¤p âˆ’1. Hence, we can apply Eisensteinâ€™s criterion with the prime p to conclude
that f (X + 1) is irreducible in Q[X].
âŠ“âŠ”
Our second example uses the full force of Eisensteinâ€™s theorem.
Example 19.29 (IMO) Given a natural number n > 1, prove that the polynomial
Xn + 5Xnâˆ’1 + 3 is irreducible in Z[X].
Proof Let Xn + 5Xnâˆ’1 + 3 = g(X)h(X), with g, h âˆˆZ[X] monic. With p = 3 in
Eiseinsteinâ€™s theorem, we conclude that
max{âˆ‚g, âˆ‚h} â‰¥n âˆ’1,
so that either f is irreducible or it has an integer root.

474
19
On the Factorisation of Polynomials
On the other hand, if this last possibility takes place, then the searching criterion
for rational roots assures that such a root is Â±1 or Â±3. However, direct computation
shows that none of these four numbers is a root of the given polynomial.
âŠ“âŠ”
In spite of the theory developed above, we frequently establish the irreducibility
of a given polynomial by invoking ad hoc methods. Let us take a look at two such
examples.
Example 19.30 (Romania) Let f âˆˆZ[X] be a monic polynomial of degree n â‰¥1
and such that f (0) = 1. If f has at least n âˆ’1 complex roots of modulus less than
1, prove that f is irreducible in Q[X].
Proof By Gaussâ€™ lemma, it sufï¬ces to show that f is irreducible in Z[X]. To this
end, and for the sake of contradiction, assume that f = gh, with g, h âˆˆZ[X] \ Z.
Without any loss of generality, we can take g and h to be monic; moreover, from
g(0)h(0) = 1 we get g(0), h(0) = Â±1. On the other hand, Girard-ViÃ¨te relations
(cf. Proposition 16.6) assure that the modulus of the product of the complex roots of
f is equal to 1, so that the hypotheses of the example guarantee that f has exactly
one complex root of modulus greater than 1. Hence, one of the polynomials g or h,
say g, has only complex roots of modulus less than 1. However, since g is monic and
|g(0)| = 1, by invoking Girard-ViÃ¨te relations again, we conclude that the modulus
of the product of the complex roots of g is equal to 1, which is a contradiction.
âŠ“âŠ”
Remark 19.31 Some complex analysis assures that polynomials f âˆˆZ[X] satisfy-
ing the hypotheses of the previous example can be easily constructed. For instance,
let f (X) = anXn + anâˆ’1Xnâˆ’1 + Â· Â· Â· + a1X + a0 âˆˆZ[X] be such that
|anâˆ’1| > |an| + |anâˆ’2| + |anâˆ’3| + Â· Â· Â· + |a0|.
(19.12)
If |z| = 1, then the triangle inequality for complex numbers gives
|f (z) âˆ’anâˆ’1znâˆ’1| = |anzn + anâˆ’2znâˆ’2 + Â· Â· Â· + a1z + a0|
â‰¤|an| + |anâˆ’2| + Â· Â· Â· + |a1| + |a0|
< |anâˆ’1| = |anâˆ’1znâˆ’1|.
In particular, f does not vanish on the unit circle |z| = 1 of the complex plane, and
RouchÃ©â€™s theorem (cf. [11], page 125) assures that f has exactly n âˆ’1 complex
roots of modulus less than 1. Of course, the extra requirement that an = a0 = 1
does not preclude the validity of (19.12).
Example 19.32 (IMO Shortlist) Let n > 1 be an odd integer and a1, . . . , an be
pairwise distinct given integers. Show that
f (X) = (X âˆ’a1)(X âˆ’a2) . . . (X âˆ’an) âˆ’1
is irreducible in Q[X].

19.4
More on Irreducible Polynomials
475
Proof Once more Gaussâ€™ lemma reduces the problem to showing that f cannot be
written as the product of two nonconstant polynomials with integer coefï¬cients. By
contradiction, assume we have f = gh, with g and h being nonconstant, monic
polynomials with integer coefï¬cients. Since
g(ai)h(ai) = f (ai) = âˆ’1
and g(ai), h(ai) âˆˆZ, we must have g(ai) = 1 and h(ai) = âˆ’1, or vice-versa; in
any event, it happens that g(ai) + h(ai) = 0. Now, let f1 = g + h. Since g and h
are monic, f1 does not vanish identically. Therefore,
âˆ‚f1 â‰¤max{âˆ‚g, âˆ‚h} < âˆ‚f = n,
so that f1 has at most âˆ‚f1 < n complex roots, counted according with their
multiplicities. However, since f1(ai) = 0 for 1 â‰¤i â‰¤n and a1, . . . , an are pairwise
distinct, we have arrived at a contradiction.
âŠ“âŠ”
Problems: Sect. 19.4
1. Use the direct method described in the beginning of this section (and applied in
Example 19.22) to prove that X4 âˆ’X2 + 1 is irreducible in Z[X].
2. * Also with the aid of the direct method, show that f (X) = X5 âˆ’X4 âˆ’4X3 +
4X2 + 2 is irreducible over Q.
3. A real polynomial is said to be positively reducible if it can be expressed as a
product of two nonconstant real polynomials with nonnegative coefï¬cients. Let
f be a real polynomial such that, for some n âˆˆN, the polynomial f (Xn) is
positively reducible. Show that f is also positively reducible.
4. (IMO shortlist) Let n > 1 be an integer and a1, . . . , an be pairwise distinct
positive integers. Prove that
f (X) = (X âˆ’a1)(X âˆ’a2) . . . (X âˆ’an) + 1
is reducible in Q[X] only in the following cases:
i. n = 2 and f (X) = (X âˆ’a)(X âˆ’a âˆ’2) + 1.
ii. n = 4 and f (X) = (X âˆ’a)(X âˆ’a âˆ’1)(X âˆ’a âˆ’2)(X âˆ’a âˆ’3) + 1.
5. Let p be an odd prime, f (X) = 2Xpâˆ’1âˆ’1 and g(X) = (Xâˆ’1)(Xâˆ’2) . . . (Xâˆ’
p+1). Prove that at least one of f (X)âˆ’g(X) or f (X)âˆ’g(X)+p is irreducible
in Z[X].
6. Let p âˆˆZ be a prime number and f (X) = a2n+1X2n+1 + Â· Â· Â· + anXn + Â· Â· Â· +
a1X + a0 be a polynomial with integer coefï¬cients and satisfying the following
conditions:

476
19
On the Factorisation of Polynomials
(a) p2 | a0, a1, . . . , an.
(b) p | an+1, an+2, . . . , a2n.
(c) p3 | a0 and p âˆ¤a2n+1.
Show that f cannot be written as the product of two nonconstant polynomials
with integer coefï¬cients.
7. Let p be a prime number and k âˆˆN. Prove that4
f (X) = Xpkâˆ’1(pâˆ’1) + Xpkâˆ’1(pâˆ’2) + Â· Â· Â· + Xpkâˆ’1 + 1
is irreducible over Q.
8. (Romania) Let p âˆˆZ be a prime number. If f (X) = anXn +anâˆ’1Xnâˆ’1 +Â· Â· Â·+
a1X + a0 âˆˆZ[X] is such that |a0| = p and |an| + |anâˆ’1| + Â· Â· Â· + |a1| < p,
prove that f is irreducible over Q.
9. (Romania) Let f (X) = anXn + Â· Â· Â· + a1X + a0 be a nonconstant polynomial
with integer coefï¬cients. If |a0| > |a1|+|a2|+Â· Â· Â·+|an| and âˆš|a0| < âˆš|an|+1,
prove that f cannot be written as the product of two nonconstant polynomials
with integer coefï¬cients.
10. (Romania) Let N = A1âˆªA2âˆª. . .âˆªAk be a partition of the set of natural numbers
into k nonempty sets. Given m âˆˆN, prove that there exists 1 â‰¤j â‰¤k for
which we can construct inï¬nitely many polynomials f satisfying the following
conditions:
i. âˆ‚f = m.
ii. All of the coefï¬cients of f belong to Aj.
iii. f cannot be written as the product of two nonconstant polynomials with
integer coefï¬cients.
11. Let f be a polynomial with integer coefï¬cients and degree n â‰¥1, and z1, . . . ,
zn be the complex roots of f .
(a) If Re(zj) < 0 for 1 â‰¤j â‰¤n, prove that all of the coefï¬cient of f have a
single sign.
(b) Prove PÃ³lya-SzegÃ¶â€™s theorem5: assume that there exists m âˆˆZ such that
f (m) is prime, f (mâˆ’1) Ì¸= 0 and m > 1
2 +Re(zj), for 1 â‰¤j â‰¤n. Then, f
cannot be written as a product of two nonconstant polynomials with integer
coefï¬cients.
12. (BMO) If the coefï¬cients of a prime number are taken as the coefï¬cients of
a polynomial f âˆˆZ[X], prove that f is irreducible over Z. More precisely,
let n > 1 be an integer and a0, a1, . . . , anâˆ’1, an be natural numbers such that
an Ì¸= 0 and 0 â‰¤ai â‰¤9 for 0 â‰¤i â‰¤n. If f (10) is prime, prove that f is
irreducible over Z.
4As Problem 1, page 492, will show, the result of this problem is a particular case of Theo-
rem 20.18.
5George PÃ³lya and GÃ¡bor SzegÃ¶, Hungarian mathematicians of the twentieth century.

Chapter 20
Algebraic and Transcendental Numbers
We start this chapter by inverting the viewpoint of Chap. 15. More precisely, we
ï¬x a complex number z and examine the set of polynomials f âˆˆC[X] for which
f (z) = 0. As a byproduct of our discussion, we give a (hopefully) more natural
proof of the closedness, with respect to the usual arithmetic operations, of the set of
complex numbers which are roots of nonzero polynomials of rational coefï¬cients.
We then proceed to investigate the special case of roots of unity, which leads us to
the study of cyclotomic polynomials and allows us to give a partial proof of a famous
theorem of Dirichlet on the inï¬nitude of primes on certain arithmetic progressions.
The chapter closes with a few remarks on the set of real numbers which are not roots
of nonzero polynomials with rational coefï¬cients.
20.1
Algebraic Numbers Over Q
A complex number Î± is said to be algebraic over Q if there exists a polynomial
f âˆˆQ[X] \ {0} such that f (Î±) = 0. A complex number which is not algebraic over
Q is said to be transcendental over Q. In this section and the next one we stick to
the case of algebraic numbers, leaving a few word on transcendental numbers to be
said in Sect. 20.4.
Obviously, every rational number r, being a root of the polynomial X âˆ’r âˆˆ
Q[X] \ {0}, is algebraic over Q. In turn, the coming example collects less trivial
instances of algebraic numbers over Q.
Example 20.1 Let r âˆˆQâˆ—
+ and n âˆˆN. If Ï‰ is an n-th root of unity, then
nâˆšrÏ‰
is algebraic over Q, for such a number is a root of the nonzero polynomial with
rational coefï¬cients Xn âˆ’r.
We could have also deï¬ned, in an obvious way, what one means by a complex
number Î± to be algebraic over R. Nevertheless, such a concept would not be
Â© Springer International Publishing AG, part of Springer Nature 2018
A. Caminha Muniz Neto, An Excursion through Elementary Mathematics, Volume III,
Problem Books in Mathematics, https://doi.org/10.1007/978-3-319-77977-5_20
477

478
20
Algebraic and Transcendental Numbers
interesting, for every complex number is algebraic over R. Indeed, give a nonreal
complex number Î± = a + ib, we have that Î± is a root of the nonzero polynomial
f (X) = (X âˆ’(a + bi))(X âˆ’(a âˆ’bi))
= X2 âˆ’2aX + (a2 + b2) âˆˆR[X].
For this reason, whenever we consider an algebraic number over Q, we shall simply
refer to it as an algebraic number.1
If a complex number Î± is algebraic, the set
AÎ± = {f âˆˆQ[X] \ {0}; f (Î±) = 0}
is nonempty by deï¬nition. Then, it is also nonempty the set of nonnegative integers
{âˆ‚f ; f âˆˆAÎ±}, so that there exists pÎ± âˆˆAÎ±, monic and of minimum degree. We
thus have the following
Deï¬nition 20.2 Given a complex number Î± algebraic over Q, a polynomial pÎ± âˆˆ
Q[X] \ {0}, monic, of minimum degree and having Î± as a root is called a minimal
polynomial for Î±.
The coming proposition and its corollaries collect the most important properties
of minimal polynomials of algebraic numbers.
Proposition 20.3 If Î± âˆˆC is algebraic over Q and pÎ± is a minimal polynomial of
Î±, then:
(a) pÎ± is irreducible over Q.
(b) If f âˆˆQ[X] is such that f (Î±) = 0, then pÎ± | f in Q[X].
In particular, pÎ± is uniquely determined by Î±.
Proof
(a) If we had pÎ± = fg, with f and g being nonconstant and of rational coefï¬cients,
then the degrees of f and g would be less than that of pÎ± and at least one of
them would have Î± as a root. In turn, this would contradict the minimality of
the degree of pÎ±. Therefore, pÎ± is irreducible over Q.
(b) By the division algorithm, there exist polynomials q, r âˆˆQ[X] such that
f (X) = pÎ±(X)q(X) + r(X),
with r = 0 or 0 â‰¤âˆ‚r < âˆ‚pÎ±. If r Ì¸= 0, then
r(Î±) = f (Î±) âˆ’pÎ±(Î±)q(Î±) = 0,
with âˆ‚r < âˆ‚pÎ±, and this would again be a contradiction to the minimality of the
degree of pÎ±. Thus, r = 0 and, hence, pÎ± | f in Q[X].
1Nevertheless, we shall brieï¬‚y consider algebraic numbers over Zp in Sect. 20.3.

20.1
Algebraic Numbers Over Q
479
Finally, if pÎ± and qÎ± were minimal polynomials for Î±, then item (b) would
give pÎ± | qÎ± in Q[X]. However, since pÎ± and qÎ± are both monic and of the same
degree, it would come that pÎ± = qÎ±.
âŠ“âŠ”
Thanks to the former proposition, given Î± âˆˆC algebraic, we can refer to pÎ± as
being the minimal polynomial of Î±.
Corollary 20.4 If Î± âˆˆC is algebraic and f âˆˆQ[X] \ {0} is a monic, irreducible
polynomial such that f (Î±) = 0, then f = pÎ±.
Proof By the previous result, pÎ± divides f in Q[X]. However, since f is irreducible,
there must exist a nonzero rational number c such that f = cpÎ±. Finally, since f
and pÎ± are both monic, we must have c = 1.
âŠ“âŠ”
Corollary 20.5 If f âˆˆQ[X] \ Q is irreducible, then f has no multiple roots.
Proof We can assume, without any loss of generality, that f is monic. If some Î± âˆˆ
C is a multiple root of f , then Proposition 15.31 would guarantee that Î± is also
a root of the derivative f â€² of f . However, since f âˆˆQ[X] \ {0} is monic and
irreducible, Corollary 20.4 assures that it is the minimal polynomial of Î±. Therefore,
Proposition 20.3 gives f | f â€² in Q[X], which is a contradiction to the inequality
âˆ‚f > âˆ‚f â€².
âŠ“âŠ”
We now collect some interesting applications of Proposition 20.3 and its
corollaries.
Example 20.6 (IMO Shortlist) Let f be a nonconstant polynomial of rational
coefï¬cients and Î± a real number such that Î±3 âˆ’3Î± = f (Î±)3 âˆ’3f (Î±) = âˆ’1.
Prove that, for every positive integer n, one has
f (n)(Î±)3 âˆ’3f (n)(Î±) = âˆ’1,
where f (n) stands for the composite of f with itself, n times.
Proof If g(X) = X3 âˆ’3X + 1, then âˆ‚g = 3 and, searching rational roots (cf.
Proposition 15.16), we conclude that g has none. Hence, Problem 5, page 457,
guarantees that g is irreducible over Q, and Corollary 20.4 assures that g is the
minimal polynomial of Î±.
On the other hand, since we are assuming that the polynomial g â—¦f also has Î±
as a root, Proposition 20.3 show that g divides g â—¦f in Q[X], say (g â—¦f )(X) =
g(X)u(X), for some u(X) âˆˆQ[X].
Finally, note that we have g(f (Î±)) = 0 by assumption. Hence, if we have proved
that g(f (k)(Î±)) = 0 for some k â‰¥1, then
g(f k+1(Î±)) = (g â—¦f )(f k(Î±)) = g(f k(Î±))u(f k(Î±)) = 0,
and there is nothing left to do.
âŠ“âŠ”

480
20
Algebraic and Transcendental Numbers
Example 19.28, in conjunction with Corollary 20.4, immediately assures that if
p is prime and Ï‰ = cis 2Ï€
p , then the minimal polynomial of Ï‰ is
pÏ‰(X) = Xpâˆ’1 + Xpâˆ’2 + Â· Â· Â· + X + 1.
The coming example uses this fact to give a beautiful alternative proof of Exam-
ple 11.5, due to the Bulgarian mathematician N. Nikolov.
Example 20.7 (IMO) Let p be an odd prime. Compute how many are the p-element
subsets of the set {1, 2, . . . , 2p} such that the sum of its elements is divisible by p.
Solution If Ï‰ = cis 2Ï€
p , then Ï‰p = 1 and, hence,
(Xp âˆ’1)2 =
p

j=1
(X âˆ’Ï‰j)
p

j=1
(X âˆ’Ï‰j)
=
p

j=1
(X âˆ’Ï‰j)
2p

j=p+1
(X âˆ’Ï‰j)
=
2p

j=1
(X âˆ’Ï‰j).
Computing the coefï¬cient of Xp at both sides of the equality above and recalling
that p is odd, we conclude that
2 =

{j1,...,jp}âŠ‚I2p
Ï‰j1+Â·Â·Â·+jp,
(20.1)
with the above sum ranging through all p-element subsets {j1, . . . , jp} of I2p =
{1, 2, . . . , 2p}.
On the other hand, if for 0 â‰¤k â‰¤p âˆ’1 we let ck denote the number of p-
element subsets {j1, . . . , jp} âŠ‚I2p for which j1 + Â· Â· Â· + jp â‰¡k (mod p), then
Ï‰p = 1 assures that the right hand side of (20.1) can be written as pâˆ’1
k=0 ckÏ‰k, so
that
pâˆ’1

k=0
ckÏ‰k = 2.
It follows from what we did above that Ï‰ is a root of the polynomial with integer
coefï¬cients f (X) = pâˆ’1
k=0 ckXk âˆ’2. Note also that, since

1, p âˆ’1, 2, p âˆ’2, 3, p âˆ’3, . . . , p âˆ’1
2
, p + 1
2
, 2p âˆ’1


20.1
Algebraic Numbers Over Q
481
has p elements and sum of elements congruent to p âˆ’1 modulo p, we have cpâˆ’1 Ì¸=
0. Hence, âˆ‚f = p âˆ’1.
Now, since the minimal polynomial of Ï‰ is pÏ‰(X) = Xpâˆ’1 + Â· Â· Â· + X + 1, item
(b) of Proposition 20.3 guarantees that f is an integer multiple of pÏ‰, say f = cpÏ‰,
for some c âˆˆN. In particular, by comparing coefï¬cients on both sides of such an
equality, we conclude that
c0 âˆ’2 = c1 = Â· Â· Â· = cpâˆ’1 = c.
Finally, in order to compute the value of c, note that c0 +c1 +Â· Â· Â·+cpâˆ’1 is equal
to the total number of p-element subsets of I2p, so that
pc + 2 = c0 + c1 + Â· Â· Â· + cpâˆ’1 =
2p
p

.
Therefore,
c0 = c + 2 = 1
p
2p
p

âˆ’2

+ 2.
âŠ“âŠ”
Example 20.8 (Romania) Let f âˆˆZ[X] be a monic polynomial, of odd degree
greater than 1 and irreducible over Q. Suppose also that:
(a) f (0) is square-free.
(b) The complex roots of f have modulus greater than or equal to 1.
Prove that the polynomial F âˆˆZ[X], given by F(X) = f (X3), is also irreducible
over Q.
Proof By contradiction, assume that F is reducible over Q. Then, it follows from
Problem 2, page 461, that there exist monic and nonconstant polynomials g, h âˆˆ
Z[X] such that F = gh. Since âˆ‚F = 3âˆ‚f and âˆ‚f is odd, we conclude that âˆ‚F is
also odd. Hence, Problem 5, page 386, guarantees that F has at least one real root Î±.
We can assume, without loss of generality, that Î± is a root of g and that g is
irreducible over Q. Indeed, if Î± is a root of g but g is reducible over Q, it sufï¬ces
to take the monic irreducible factor of g having Î± as a root, and then to use the
result of Problem 2, page 461 to conclude that such an irreducible factor has integer
coefï¬cients.
In the conditions of the previous paragraph, we know that g is the minimal
polynomial of Î±. Now, if Ï‰ Ì¸= 1 is a cubic root of 1, then
0 = F(Î±) = f (Î±3) = f ((Î±Ï‰)3) = F(Î±Ï‰) = g(Î±Ï‰)h(Î±Ï‰).

482
20
Algebraic and Transcendental Numbers
We therefore distinguish two cases:
(i) g(Î±Ï‰) = 0:
since (cf. Problem 4, page 386) the nonreal roots of a real
polynomial come in pairs complex-complex conjugate, we have that Î±Ï‰ = Î±Ï‰2
is also a root of g. Now, by grouping together in the expression of g all
monomials with exponents of each one of the forms 3k, 3k + 1 and 3k + 2,
we can write
g(X) = a(X3) + Xb(X3) + X2c(X3),
(20.2)
with a, b, c âˆˆZ[X]. Therefore,
a(Î±3) + Î±b(Î±3) + Î±2c(Î±3) = g(Î±) = 0,
a(Î±3) + Î±Ï‰b(Î±3) + Î±2Ï‰2c(Î±3) = g(Î±Ï‰) = 0
and
a(Î±3) + Î±Ï‰2b(Î±3) + Î±2Ï‰c(Î±3) = g(Î±Ï‰2) = 0.
Since the three equalities above for a Vandermond system of equations in a(Î±3),
b(Î±3) and c(Î±3), we conclude from Proposition 18.6 (or by direct computation)
that a(Î±3) = b(Î±3) = c(Î±3) = 0. Thus, letting p denote the minimal polynomial
of Î±3, it follows from Proposition 20.3 that p divides a, b and c in Q[X] and,
hence (again from Problem 4, page 386), in Z[X]. It follows from (20.2) that
p(X3) divides g(X). However, since g is monic and irreducible, we conclude
that g(X) = p(X3).
Now, with g being a polynomial in X3, it follows once more from (20.2) that
b, c = 0 and, hence, that
f (X3) = F(X) = g(X)h(X) = a(X3)h(X).
Such an equality, in turn, implies that h must also be a polynomial in X3, say
h(X) = l(X3), for some l âˆˆZ[X].
Finally, we have f (X3) = a(X3)l(X3) and, hence, f = gl, with âˆ‚g, âˆ‚l â‰¥1. But
this contradicts the irreducibility of f .
(ii) h(Î±Ï‰) = 0:
as in item (i), we conclude that h(Î±Ï‰2) = 0. Let, also as above,
h(X) = a(X3) + Xb(X3) + X2c(X3),
with a, b, c âˆˆZ[X]. Then,
a(Î±3) + Î±Ï‰b(Î±3) + Î±2Ï‰2c(Î±3) = h(Î±Ï‰) = 0
and
a(Î±3) + Î±Ï‰2b(Î±3) + Î±2Ï‰c(Î±3) = h(Î±Ï‰2) = 0.
Multiplying the ï¬rst of the equalities above by Ï‰ and subtracting the second from
the result, we obtain
a(Î±3) âˆ’Î±2c(Î±3) = 0.

20.1
Algebraic Numbers Over Q
483
However, since g is the minimal polynomial of Î±, by invoking Proposition 20.3
once again we conclude that g divides a(X3) âˆ’X2c(X3) in Q[X] and, hence, in
Z[X] (by Remark 14.13, for g âˆˆZ[X] and is monic).
Substituting X by 0, we conclude that g(0) must divide a(0) in Z. Letting a(0) =
g(0)m, with m âˆˆZ, it comes that
f (0) = g(0)h(0) = g(0)a(0) = g(0)2m.
Since f (0) is square-free, it follows that g(0) = Â±1. Hence, letting z1, . . . , zk be
the complex roots of g, the relations of Girard-ViÃ¨te give
1 = |g(0)| = |z1| . . . |zk|.
(20.3)
On the other hand, since
f (z3
j) = F(zj) = g(zj)h(zj) = 0,
hypothesis (b) gives |z3
j| â‰¥1, so that |zj| â‰¥1 for 1 â‰¤j â‰¤k. In turn, such
an information, together with (20.3), allows us to conclude that |zj| = 1 for
1 â‰¤j â‰¤k. In particular, |Î±| = 1 and, being a real number, we must have
Î± = Â±1. Thus, Î±3 = Â±1 and, since f is irreducible over Q with f (Î±3) = 0, we
should have f (X) = X Â± 1, a contradiction to the fact that âˆ‚f > 1.
âŠ“âŠ”
The rest of this section is devoted to showing that the set of algebraic numbers is a
subï¬eld of C, i.e., that it is a nonempty subset of C which is closed for the operations
of addition, subtraction, multiplication and division (by a nonzero algebraic number,
of course). We follow [7], and start with the following result.
Theorem 20.9 If Î±, Î² âˆˆC \ {0} are algebraic, then so is Î± + Î².
Proof Let Î± = Î±1, . . . , Î±m be the complex roots of pÎ± and Î² = Î²1, . . . , Î²n be those
of pÎ², so that
pÎ±(X) =
m

i=1
(X âˆ’Î±i) and pÎ²(X) =
n

j=1
(X âˆ’Î²j).
Deï¬ne
f (X, X1, . . . , Xm) =
m

i=1
n

j=1
(X âˆ’Xi âˆ’Î²j) =
m

i=1
pÎ²(X âˆ’Xi)
= Xmn +
mnâˆ’1

k=0
fk(X1, . . . , Xm)Xk,
(20.4)
for certain polynomials f0, . . . , fmnâˆ’1 âˆˆQ[X1, . . . , Xm] (since pÎ² âˆˆQ[X]).

484
20
Algebraic and Transcendental Numbers
If Ïƒ is a permutation of Im, then
f (X, XÏƒ(1), . . . , XÏƒ(m)) =
m

i=1
pÎ²(X âˆ’XÏƒ(i)) =
m

i=1
pÎ²(X âˆ’Xi)
= f (X, X1, . . . , Xm)
so that (20.4) furnishes
Xmn +
mnâˆ’1

k=0
fk(XÏƒ(1), . . . , XÏƒ(m))Xk = Xmn +
mnâˆ’1

k=0
fk(X1, . . . , Xm)Xk.
Therefore, we have
fk(XÏƒ(1), . . . , XÏƒ(m)) = fk(X1, . . . , Xm)
for all 0 â‰¤k â‰¤mn âˆ’1 and Ïƒ, and we conclude that fk is a symmetric polynomial
in X1, . . . , Xm, for 0 â‰¤k â‰¤mn âˆ’1.
Newtonâ€™s Theorem 16.12 then assures the existence of polynomials gk
âˆˆ
Q[X1, . . . , Xm] for which
fk(X1, . . . , Xm) = gk(s1, . . . , sm),
with s1, . . . , sm âˆˆQ[X1, . . . , Xm] standing for the elementary symmetric polyno-
mials in X1, . . . , Xm. In particular,
fk(Î±1, . . . , Î±m) = gk(s1(Î±i), . . . , sm(Î±i)) âˆˆQ,
for
pÎ±(X) = Xm âˆ’s1(Î±i)Xmâˆ’1 + Â· Â· Â· + (âˆ’1)msm(Î±i) âˆˆQ[X].
Thus, if h(X) = f (X, Î±1, . . . , Î±m) then, on the one hand,
h(X) = Xmn +
mnâˆ’1

k=0
fk(Î±1, . . . , Î±m)Xk âˆˆQ[X]
while, on the other,
h(X) =
m

i=1
pÎ²(X âˆ’Î±i) =
m

i=1
n

j=1
(X âˆ’Î±i âˆ’Î²j).

20.1
Algebraic Numbers Over Q
485
Therefore, h is a nonzero polynomial with rational coefï¬cients and such that h(Î± +
Î²) = 0, which guarantees that Î± + Î² is algebraic.
âŠ“âŠ”
Remark 20.10 Suppose that pÎ±, pÎ² âˆˆZ[X]. Then, in the notations of the above
proof, we have s1(Î±i), . . . , sm(Î±i) âˆˆZ and fk âˆˆZ[X1, . . . , Xm] for 0 â‰¤k â‰¤
mn âˆ’1. Therefore, once more from Newtonâ€™s theorem, gk âˆˆZ[X1, . . . , Xm] and,
hence,
fk(Î±1, . . . , Î±m) = gk(s1(Î±i), . . . , sm(Î±i)) âˆˆZ
for 0 â‰¤k â‰¤mn âˆ’1. We thus conclude that h âˆˆZ[X], and Problem 4 shows that
pÎ±+Î² âˆˆZ[X].
In order to show that the set of algebraic numbers is closed for products and
quotients, we need the following particular case of Problem 4, page 416, for which
we present a simpler proof.
Lemma 20.11 If Î± Ì¸= 0 is algebraic, then so are Î±âˆ’1 and Î±2.
Proof Let f (X) = anXn + anâˆ’1Xnâˆ’1 + Â· Â· Â· + a1X + a0 âˆˆQ[X] \ Q be such that
a0 Ì¸= 0 and f (Î±) = 0. Then, g(X) = a0Xn + a1Xnâˆ’1 + Â· Â· Â· + anâˆ’1X + an is a
nonconstant polynomial with rational coefï¬cients, and it is immediate to check that
g(Î±âˆ’1) = 0.
For Î±2, notice that there exist u, v âˆˆQ[X], at least one of which nonzero and
such that
f (X) = u(X2) + Xv(X2).
Letting h(X) = u(X)2 âˆ’Xv(X)2, we have h âˆˆQ[X] \ {0} and
h(Î±2) = u(Î±2)2 âˆ’Î±2v(Î±2)2
= (u(Î±2) âˆ’Î±v(Î±2))(u(Î±2) + Î±v(Î±2))
= (u(Î±2) âˆ’Î±v(Î±2))f (Î±) = 0.
âŠ“âŠ”
Theorem 20.12 If Î±, Î² âˆˆC \ {0} are algebraic, then so are Î±Î² and Î±
Î² .
Proof By the previous lemma, Î±2 and Î²2 are algebraic. However, since we already
know that Î± + Î² is algebraic, it follows once more from the previous lemma that
(Î± + Î²)2 is algebraic too. Now, since
Î±Î² = 1
2((Î± + Î²)2 âˆ’Î±2 âˆ’Î²2),
two applications of Theorem 20.9, together with the result of Problem 1, assure that
Î±Î² is also algebraic.

486
20
Algebraic and Transcendental Numbers
For what is left to do, note that Î±
Î² = Î± Â· 1
Î² , with 1
Î² being algebraic by the previous
lemma. Hence, the ï¬rst part above guarantees that Î±
Î² is algebraic.
âŠ“âŠ”
Problems: Sect. 20.1
1. * If r is a nonzero rational and Î± âˆˆC \ {0} is algebraic, prove directly (i.e.,
without resorting to Theorem 20.12) that rÎ± is also algebraic.
2. Given k, n âˆˆN, prove that cos 2kÏ€
n
and sin 2kÏ€
n
are algebraic.
3. Let p be a prime number and n âˆˆN. Prove that the minimal polynomial of
nâˆšp
is f (X) = Xn âˆ’p.
4. * Let Î± âˆˆC be algebraic. If there exists f âˆˆZ[X] \ Z monic and such that
f (Î±) = 0, prove that pÎ± âˆˆZ[X].
5. Let a1, a2, . . . , an be natural numbers, and Î± = âˆša1 +âˆša2 +Â· Â· Â·+âˆšan. Prove
that:
(a) Î± is a root of a monic polynomial with integer coefï¬cients.
(b) If Î± /âˆˆZ, then Î± is irrational.
6. (Brazil) Prove that the polynomial f (X) = X5 âˆ’X4 âˆ’4X3 + 4X2 + 2 does
not admit any roots of the form
nâˆšr, with r âˆˆQ and n âˆˆN, n > 1.
7. Give a proof analogous to that of Theorem 20.9 to show that Î±Î² is algebraic
whenever so are Î± and Î².
8. Let Î± âˆˆC be algebraic, with âˆ‚pÎ± = n, and deï¬ne
Q(Î±) = {a0 + a1Î± + Â· Â· Â· + anâˆ’1Î±nâˆ’1; a0, a1, . . . , anâˆ’1 âˆˆQ}
= {f (Î±); f âˆˆQ[X], with f = 0 or âˆ‚f â‰¤n âˆ’1}.
The purpose of this problem is to show that Q(Î±) is a subï¬eld of C.2 To this
end, do the following items:
(a) Show that Q(Î±) is closed for addition, subtraction and multiplication.
(b) Given Î² âˆˆQ(Î±), show that there exists a single f âˆˆQ[X] such that
Î² = f (Î±), with f = 0 or âˆ‚f â‰¤n âˆ’1.
(c) For Î² = f (Î±) âˆˆQ(Î±) \ {0}, with f âˆˆQ[X] such that âˆ‚f â‰¤n âˆ’1, show
that gcd(f, pÎ±) = 1. Then, conclude that 1
Î² âˆˆQ(Î±).
9. Given a, b, c âˆˆQ such that a +b
3âˆš
2+c
3âˆš
4 Ì¸= 0, show that there exist x, y, z âˆˆ
Q for which
1
a + b
3âˆš
2 + c
3âˆš
4
= x + y
3âˆš
2 + z
3âˆš
4.
Then, ï¬nd x, y and z if a = b = 1, c = 2.
2For a converse, see Problem 4, page 503.

20.2
Cyclotomic Polynomials
487
10. Let Î± âˆˆC be algebraic, with âˆ‚pÎ± = n, and Q(Î±) be as in Problem 8. Find
all functions Ï† : Q(Î±) â†’C satisfying the following conditions, for all u, v âˆˆ
Q(Î±):
(i) Ï†(u + v) = Ï†(u) + Ï†(v).
(ii) Ï†(uv) = Ï†(u)Ï†(v).
20.2
Cyclotomic Polynomials
The theory of polynomials over Zp, p prime, allows us to present some of the most
elementary properties of the so-called cyclotomic polynomials; in particular, we will
show that such polynomials are precisely the minimal polynomials of the complex
roots of unity. As a byproduct of our study, we will use cyclotomic polynomials to
prove a particular case of Dirichletâ€™s theorem on primes in arithmetic progressions.
Given n âˆˆN, recall from Deï¬nition 13.23 that the primitive n-th roots of unity
are the complex numbers of the form Ï‰k
n, with Ï‰n = cis 2Ï€
n and 1 â‰¤k â‰¤n being
relatively prime with n. In particular, there are exactly Ï•(n) primitive n-th roots of
unity, where Ï• : N â†’N stands for the Euler function. Given m, n âˆˆN, whenever
there is no danger of confusion we shall write simply (m, n) to denote the gcd of m
and n.
Deï¬nition 20.13 For n âˆˆN, the n-th cyclotomic polynomial is the polynomial
n(X) =

1â‰¤kâ‰¤n
(k,n)=1
(X âˆ’Ï‰k
n).
(20.5)
It follows from the above deï¬nition that n is monic with degree âˆ‚n = Ï•(n).
The coming proposition collects other elementary properties of n.
Proposition 20.14 For n âˆˆN, we have:
(a) Xn âˆ’1 = 0
0<d|n d(X).
(b) n âˆˆZ[X].
(c) n(0) = 1 for n > 1.
Proof
(a) First of all, we have

0<d|n
d(X) =

0<d|n
n/d(X) =

0<d|n

1â‰¤kâ‰¤n/d
(k,n/d)=1
(X âˆ’Ï‰k
n/d)
=

0<d|n

1â‰¤kâ‰¤n/d
(k,n/d)=1
(X âˆ’Ï‰dk
n ).

488
20
Algebraic and Transcendental Numbers
Now, note that each integer 1 â‰¤m â‰¤n can be uniquely written as m = dk,
with d, k âˆˆN such that 0 < d | n and

k, n
d

= 1 (d is exactly d = gcd(m, n)).
Therefore, the last sum above is clearly equal to
n

j=1
(X âˆ’Ï‰j
n) = Xn âˆ’1.
(b) Let us make induction on n âˆˆN, beginning with 1(X) = Xâˆ’1 âˆˆZ[X]. Given
a natural number n > 1, assume, by induction hypothesis, that m âˆˆZ[X] for
every integer 1 â‰¤m < n. Then, if
g(X) =

1â‰¤d<n
d|n
d(X),
we have g âˆˆZ[X] and, by (a), Xn âˆ’1 = n(X)g(X). Since g is monic
(for we already know that each m is monic), Remark 14.13 guarantees that
n âˆˆZ[X].
(c) For n = 2 this is a direct computation; for n > 2, apply the result of Problem 3,
page 345. Alternatively, arguing once more by induction, start by noticing that
X2 âˆ’1 = 1(X)2(X) = (X âˆ’1)2(X);
hence, 2(X) = X + 1 and 2(0) = 1. Let n > 2 and suppose, as induction
hypothesis, that m(0) = 1 for every integer 2 â‰¤m < n. Then, in the notations
of the proof of (b), we have
g(0) = 1(0)

1<d<n
d|n
d(0) = (âˆ’1)

1<d<n
d|n
d(0) = âˆ’1,
and it follows from Xn âˆ’1 = n(X)g(X) that
âˆ’1 = n(0)g(0) = âˆ’n(0),
as wished.
âŠ“âŠ”
Corollary 20.15 If p âˆˆZ is prime, then
p(X) = Xpâˆ’1 + Xpâˆ’2 + Â· Â· Â· + X + 1.
Proof Item (a) of the previous proposition gives
Xp âˆ’1 = 1(X)p(X) = (X âˆ’1)p(X),

20.2
Cyclotomic Polynomials
489
so that
p(X) = Xpâˆ’1 + Xpâˆ’2 + Â· Â· Â· + X + 1.
âŠ“âŠ”
Example 19.28 has shown that p is irreducible over Q, so that p is the
minimal polynomial of Ï‰p. Theorem 20.18 generalizes this fact by proving that,
for every n âˆˆN, the minimal polynomial of Ï‰n coincides with the n-th cyclotomic
polynomial n. We ï¬rst need to establish a simple auxiliary result.
Lemma 20.16 Let f, g âˆˆZ[X] and p âˆˆZ be a prime number. If g âˆˆZp[X] \ Zp
and g2 | f in Zp[X], then g | f â€² in Zp[X].
Proof If h âˆˆZ[X] is such that f = g2h in Zp[X], we know that there exists a
polynomial l âˆˆZ[X] such that
f (X) = g(X)2h(X) + pl(X)
in Z[X]. Computing derivatives at both sides of this equality, we obtain
f â€²(X) = 2g(X)gâ€²(X)h(X) + g(X)2hâ€²(X) + plâ€²(X)
in Z[X], and hence
f â€²(X) = g(X)

2 gâ€²(X)h(X) + g(X)hâ€²(X)

in Zp[X]. Therefore, g | f â€² in Zp[X].
âŠ“âŠ”
For our next result, recall that if Ï‰ is an n-th root of unity, then Proposition 20.3
guarantees that its minimal polynomial pÏ‰ divides Xnâˆ’1 in Q[X]. Then, Problem 4,
page 486, assures that pÏ‰ âˆˆZ[X].
Proposition 20.17 Let n, p âˆˆN be such that p is prime and p âˆ¤n. If Ï‰ is an n-th
root of unity, then pÏ‰(X) = pÏ‰p(X).
Proof Let Î¶
= Ï‰p. Since both Ï‰ and Î¶ are roots of Xn âˆ’1, item (b) of
Proposition 20.3 shows that both pÏ‰ and pÎ¶ divide Xnâˆ’1. By contradiction, assume
that pÏ‰ Ì¸= pÎ¶. Then, the irreducibility of these polynomials assures, via Gaussâ€™
Theorem 19.14, that pÏ‰pÎ¶ divides Xn âˆ’1 in Z[X], say
Xn âˆ’1 = pÏ‰(X)pÎ¶(X)u(X)
(20.6)
for some u âˆˆZ[X].
If g(X) = pÎ¶(Xp), then
g(w) = pÎ¶(Ï‰p) = pÎ¶(Î¶) = 0

490
20
Algebraic and Transcendental Numbers
so that (once more by Proposition 20.3) pÏ‰ divides g in Z[X]. Let v âˆˆZ[X] be such
that pÏ‰v = g. In Zp[X], Problem 5, page 469 gives
pÏ‰(X)v(X) = g(X) = pÎ¶(Xp) =

pÎ¶(X)
p ,
and Theorem 19.19 guarantees the existence of a monic and irreducible polynomial
h âˆˆZp[X] such that h | pÏ‰, pÎ¶ in Zp[X]. It follows from (20.6) that h(X)2 |
(Xn âˆ’1) in Zp[X], and the previous lemma gives that h(X) | nXnâˆ’1 in Zp[X].
However, since h is monic and n Ì¸= 0, by applying once again Theorem 19.19 we
obtain 1 â‰¤l â‰¤n âˆ’1 such that h(X) = Xl in Zp[X]. Hence, h(X) âˆ¤(Xn âˆ’1) in
Zp[X], which is a contradiction.
âŠ“âŠ”
We can ï¬nally state and prove the desired result.
Theorem 20.18 If Ï‰n = cis 2Ï€
n , then pÏ‰n = n. In particular, n âˆˆZ[X] is
irreducible in Q[X].
Proof Take k âˆˆN such that k > 1 and gcd(k, n) = 1, and let k = p1 . . . pl,
with p1, . . . , pl being primes not dividing n. Repeated applications of the previous
proposition give us
pÏ‰n = pÏ‰p1
n = pÏ‰p1p2
n
= Â· Â· Â· = pÏ‰p1...pl
n
= pÏ‰kn.
In particular, the Ï•(n) complex numbers Ï‰k
n, with 1 â‰¤k â‰¤n and gcd(k, n) = 1, are
distinct roots of pÏ‰n, so that
âˆ‚pÏ‰n â‰¥Ï•(n) = âˆ‚n.
However, since n is monic, has integer (thus rational) coefï¬cients and Ï‰n as a root,
the deï¬nition of minimal polynomial assures that pÏ‰n = n.
âŠ“âŠ”
We ï¬nish this section by proving a particular case of the famous Dirichletâ€™s
theorem on primes in arithmetic progressions. This theorem states that an inï¬nite
nonconstant arithmetic progression of natural numbers contains inï¬nitely many
prime numbers, provided its ï¬rst term and common difference are relatively prime.
Although Dirichletâ€™s theorem is a natural generalization of Euclidâ€™s Theorem 6.38,
its known proofs are far beyond the scope of most undergraduate curricula in
Mathematics. Nevertheless, the fragments of the theory of cyclotomic polynomials
developed so far allow us to present an elementary proof of Dirichletâ€™s theorem, in
the particular case of an arithmetic progression whose ï¬rst term is equal to 1.
Theorem 20.19 (Dirichlet)
If n âˆˆN, then the arithmetic progression 1, 1+n, 1+
2n, . . . contains inï¬nitely many primes.
Proof Let p1, . . . , pk be any primes and n denote the n-th cyclotomic poly-
nomial. Since n is monic, choosing a sufï¬ciently large integer y we have
n(ynp1 . . . pk) > 1. Therefore, letting a = ynp1 . . . pk, we have modulo a that
n(a) â‰¡n(0) = 1 (mod a).

20.2
Cyclotomic Polynomials
491
Hence, n(a) = aq + 1 = ynp1 . . . pkq + 1, for some q âˆˆN. If p is a prime
factor of n(a), then p Ì¸= p1, . . . , pk and gcd(p, n) = 1. Therefore, if we prove
that p â‰¡1 (mod n), it will follow that p is a prime in our arithmetic progression,
distinct from p1, . . . , pk.
For what is left to do, note that gcd(p, a) = 1, and let t := ord p(a). Since
p | n(a) and n(a) | (an âˆ’1) (for n(X) | (Xn âˆ’1) in Z[X]), we conclude that
an â‰¡1 (mod p); thus, item (c) of Proposition 12.2 shows that t | n. If we prove
that t = n then, again from item (c) of Proposition 12.2, together with apâˆ’1 â‰¡
1 (mod p), we obtain n | (p âˆ’1) or, which is the same, p â‰¡1 (mod n).
For c âˆˆ{a, a + p}, it follows from at â‰¡1 (mod p) that ct â‰¡1 (mod p). By the
sake of contradiction, assume that t < n. Proposition 20.14, together with the fact
that t | n, furnishes
cn âˆ’1 =

0<d|n
d(c) = n(c)

0<d<n
d|n
d(c)
= n(c)h(c)

0<d|t
d(c)
= n(c)h(c)(ct âˆ’1),
for some appropriate polynomial h âˆˆZ[X]. However, since c â‰¡a (mod p), item
(c) of Proposition 10.6 gives
n(c) â‰¡n(a) â‰¡0 (mod p),
so that
cn âˆ’1 = n(c)h(c)(ct âˆ’1) â‰¡0 (mod p2).
On the other hand,
(a + p)n âˆ’1 = an âˆ’1 +
nâˆ’1

j=1
n
j

anâˆ’jpj
and (by the computations above) both (a + p)n âˆ’1 and an âˆ’1 are multiples of p2.
Thus, looking at the last equality above modulo p2, we conclude that
nanâˆ’1p â‰¡0 (mod p2),
which is a contradiction.
âŠ“âŠ”
For a self-contained discussion of the general case of Dirichletâ€™s theorem, we
refer the interested reader to [27] or [36]. As far as the special case above is

492
20
Algebraic and Transcendental Numbers
concerned, the coming example shows a nontrivial application. At this point, the
reader may ï¬nd it helpful to recall the material of Sects. 12.2 and 12.3.
Example 20.20 For each prime number p, let g(p) âˆˆN denote the least positive
primitive root modulo p. Then, the function p â†’g(p) is unbounded.
Proof Recall that if a is a primitive root modulo p then a
pâˆ’1
2
â‰¡âˆ’1 (mod p), and
Eulerâ€™s criterion (cf. Proposition 12.19) assures that a is a quadratic nonresidue
modulo p. In turn, given a natural number n â‰¥2, we need to show that there exists
a prime number p such that none of 1, 2, . . . , n is a primitive root modulo p. Then,
it sufï¬ces to ï¬nd p such that all of 1, 2, . . . , n are quadratic residues modulo p.
We ï¬rst claim that it is enough that every prime q satisfying 1 < q â‰¤n is a
quadratic residue modulo p. Indeed, if this is so and 1 < m â‰¤n is not a perfect
square, then m can be written as m = k2q1 . . . ql, with q1, . . . , ql being pairwise
distinct prime numbers. Letting qj â‰¡a2
j (mod p), we get
m = k2q1 . . . ql â‰¡k2a2
1 . . . a2
l = (ka1 . . . al)2 (mod p).
Now, Dirichletâ€™s theorem assures the existence of a prime number p of the form
p = 1 + 2tn!, for some t âˆˆN. We claim that such a p works for us. Indeed, if
1 < q â‰¤n is prime, then the Quadratic Reciprocity Law gives
p
q
  q
p

= (âˆ’1)
 pâˆ’1
2
 qâˆ’1
2

= (âˆ’1)
tn!
 qâˆ’1
2

= 1,
for n! is even. However, since q | n!, we have p â‰¡1 (mod q), and the properties of
Legendreâ€™s symbol (cf. item (a) of Proposition 12.23) give
p
q

=
 1
q

= 1.
Hence,

q
p

= 1, and q is a quadratic residue modulo p.
âŠ“âŠ”
Problems: Sect. 20.2
1. Let p, k âˆˆN be given, with p being prime. Compute pk explicitly.
2. If n > 1 is an even integer, show that 2n(X) = 2n(âˆ’X).
3. If m and n are distinct naturals, prove that m and n have no nonconstant
common factors in C[X]. In particular, m Ì¸= n.
4. Let n > 1 be a natural number and d be the product of the distinct prime factors
of n. Show that n(X) = d

Xn/d
.
5. (England) The set

1, 1
2, 1
3, 1
4, . . .

contains several arithmetic progressions.
Given an integer k > 2, prove that it contains an arithmetic progression of k
terms which is not contained in any arithmetic progression of k + 1 terms of the
same set.

20.3
Algebraic Numbers Over Zp
493
6. Let a, n âˆˆN, with a > 1 and n odd. Prove that the algebraic congruence xn â‰¡
a (mod p) has a solution for inï¬nitely many primes p.
7. Let a be a natural number which is not a perfect square. Prove that there
are inï¬nitely many prime numbers p for which a is a non-quadratic residue
modulo p.
8. Let a, b âˆˆZ be such that for each n âˆˆN there exists c âˆˆZ for which n |
(c2 + ac + b). Prove that the equation x2 + ax + b = 0 has integer roots.
20.3
Algebraic Numbers Over Zp
This section is somewhat more abstract than the previous ones, for we extend the
concept of algebraic number to consider algebraic numbers over Zp, for some prime
number p. However, the payoff will be worth the effort, for, given n âˆˆN, we will
be able to compute the exact number of irreducible polynomials over Zp and having
degree n.
We depart from a naive though proï¬table idea, namely, that there exists a number
set p containing Zp that plays, for Zp, the same role as C plays for Q. We start by
formalizing the concept of ï¬eld.
Deï¬nition 20.21 A ï¬eld is a nonempty set K, furnished with operations +, Â· : K Ã—
K â†’K having the following properties:
(a) + and Â· are commutative and associative, and Â· is distributive with respect to +.
(b) There exist elements 0, 1 âˆˆK, with 0 Ì¸= 1, such that a + 0 = a and a Â· 1 = a,
for every a âˆˆK.
(c) For every a âˆˆK, there exists an element âˆ’a âˆˆK such that a + (âˆ’a) = 0.
(d) For every a âˆˆK \ {0}, there exists an element aâˆ’1 âˆˆK such that a Â· aâˆ’1 = 1.
The reader has certainly realized what we mean by commutative, associative and
distributive from his/her previous experience. Nevertheless, let us explain all that
from ï¬rst principles. Commutativity in item (a) means that
a + b = b + a and a Â· b = b Â· a,
whereas associativity stands for
(a + b) + c = a + (b + c) and (a Â· b) Â· c = a Â· (b Â· c),
for all a, b, c âˆˆK. In turn, the distributivity of Â· with respect to + is exactly what
one expects:
a Â· (b + c) = a Â· b + a Â· c,
with the right hand side being a shorthand for the more precise (though somewhat
cumbersome) expression (a Â· b) + (a Â· c).

494
20
Algebraic and Transcendental Numbers
Thus, we surely have that Q, R and C are ï¬elds, and Problem 8, page 486 shows
that so is Q(Î±), for every Î± âˆˆC algebraic over C. Moreover, in all of these cases, the
elements 0 and 1 of item (b) in the above deï¬nition are the usual complex numbers
0 and 1, and this is the reason why, for a general ï¬eld K, we also denote them by
0 and 1. A similar remark holds for âˆ’a and aâˆ’1, i.e., we are simply adopting the
same notation we use for the additive (resp. multiplicative) inverses of elements of
C (resp. of C \ {0}).
Another class of examples of ï¬elds we have been dealing with is that of the ï¬nite
ï¬elds Zp, with p âˆˆZ prime. In this case, however, we shall stick to the usage of
writing 0 and 1 whenever convenient, in order to avoid any possibility of confusion
with 0, 1 âˆˆZ.
Back to a general ï¬eld K, the cancellation laws for addition and multiplication
hold:
a + c = b + c â‡’a = b and a Â· c = b Â· c, c Ì¸= 0 â‡’a = b.
Indeed,
a + c = b + c â‡’(a + c) + (âˆ’c) = (b + c) + (âˆ’c)
â‡’a + (c + (âˆ’c)) = b + (c + (âˆ’c))
â‡’a + 0 = b + 0 â‡’a = b,
and likewise for the multiplication (see Problem 1).
As it happens within C, whenever there is no danger of confusion we shall write
ab, instead of a Â· b, to denote the product of elements a and b of a general ï¬eld K.
We could have developed most of the theory of polynomials by considering the
set K[X] of polynomials over (or with coefï¬cients in) an arbitrary ï¬eld K, with
operations +, Â· : K[X] Ã— K[X] â†’K[X] extending those of K. Taking for granted
the (harmless) assumption that we have done that, we now have at our disposal the
following concepts and facts, whose validities the reader can easily check:
1. If f, g âˆˆK[X] are such that fg = 0 (the identically zero polynomial), then
f = 0 or g = 0.
2. The notions of degree (for nonzero polynomials) and roots for polynomials over
K remain true, unchanged. Likewise, âˆ‚(fg) = âˆ‚f + âˆ‚g if f, g Ì¸= 0 and âˆ‚(f +
g) â‰¤max{âˆ‚f, âˆ‚g} if f + g Ì¸= 0.
3. The division algorithm, the root test and Lagrangeâ€™s theorem on the number
of distinct roots of a nonzero polynomial also continue to hold, with identical
proofs.
4. The concept of greatest common divisor for nonzero polynomials over K is a
direct extension of that for polynomials over Q, and BÃ©zoutâ€™s Theorem 19.2 is
also true, with exactly the same proof.

20.3
Algebraic Numbers Over Zp
495
5. Another concept that extends in a likewise manner from Q[X] is that of
irreducible polynomial f
âˆˆK[X]. Now, note that we have a version of
Theorem 19.9 at our disposal too, again with the same proof.
A major gap on extending the theory for polynomials over arbitrary ï¬elds is
fulï¬lled by the coming result, which will be assumed without proof (we refer the
interested reader to [6] or [20]).
Theorem 20.22 Given an arbitrary ï¬eld K, there exists another ï¬eld  containing
K, whose operations extend those of K and such that every f âˆˆ[X] has at least
one root in .
The attentive reader has certainly noticed that  plays the role of C for K. We
refer to the property of Theorem 20.22 by saying that  is an algebraically closed
ï¬eld containing K. Also as with C, one now proves that if f âˆˆK[X]\{0} has degree
n, then there exists a âˆˆK (the leading coefï¬cient of f ) and Î±1, . . . , Î±n âˆˆ such
that
f (X) = a(X âˆ’Î±1)(X âˆ’Î±2) . . . (X âˆ’Î±n).
The equality above is the factorised form of f over .
We can now deï¬ne, exactly as was done in Sect. 20.1, what one means for an
element Î± âˆˆ to be algebraic over K, and consider its minimal polynomial pÎ± âˆˆ
K[X] \ {0} as was done for Î± âˆˆC algebraic over Q. This way, Proposition 20.3 and
Corollary 20.4 remain true, unchanged.
We now restrict our attention to K = Zp, and write p to denote the ï¬eld  of
Theorem 20.22. We ï¬rst recall the result of Problem 5, page 469, which we write in
the following form:
f (Xp) = f (X)p, âˆ€f âˆˆZp[X].
(20.7)
We shall also need the following auxiliary result.
Lemma 20.23 Let f âˆˆp[X] \ {0} be given. If Î± âˆˆp is a root of f , then:
(a) Î±p is also a root of f .
(b) There exists a natural number m â‰¤âˆ‚f such that Î± is a root of Xpm âˆ’X.
Proof
(a) It follows from (20.7) that f (Î±p) = f (Î±)p = 0
p = 0.
(b) Iterating the result of (a), we conclude that Î±, Î±p, Î±p2, . . . are roots of f . Since
it has at most âˆ‚f distinct roots, we conclude that there exist integers 0 â‰¤k <
l â‰¤âˆ‚f for which Î±pk = Î±pl. Therefore,
0 = Î±pl âˆ’Î±pk =

Î±plâˆ’kpk
âˆ’Î±pk =

Î±plâˆ’k âˆ’Î±
pk
,

496
20
Algebraic and Transcendental Numbers
where we have used the result of Example 19.15 in the last equality above. It
comes that Î±plâˆ’k âˆ’Î± = 0, and Î± is a root of Xpm âˆ’X, with m = l âˆ’k â‰¤âˆ‚f .
âŠ“âŠ”
We are now in position to prove the following
Proposition 20.24 Let p be prime and Î± âˆˆp be algebraic over Zp. If âˆ‚pÎ± = n,
then:
(a) Î± is a root of Xpn âˆ’X.
(b) Î± is not a root of Xpm âˆ’X, for any positive integer m < n.
Proof We already know, from the previous lemma, that Î± is a root of Xpm âˆ’X, for
some positive integer m â‰¤n. Now, let
 : Zp Ã— Zp Ã— . . . Ã— Zp



n times
âˆ’â†’p
be deï¬ned by
(a0, a1, . . . , anâˆ’1) = a0 + a1Î± + Â· Â· Â· + anâˆ’1Î±nâˆ’1.
We claim that  is injective and each Î² âˆˆIm() is a root of Xpm âˆ’X. Indeed,
if
(a0, a1, . . . , anâˆ’1) = (b0, b1, . . . , bnâˆ’1),
for distinct n-tuples (a0, a1, . . . , anâˆ’1) and (b0, b1, . . . , bnâˆ’1) in the domain of ,
then
(a0 âˆ’b0) + (a1 âˆ’b1)Î± + Â· Â· Â· + (anâˆ’1 âˆ’bnâˆ’1)Î±nâˆ’1 = 0,
so that Î± would be a root of the nonzero polynomial (a0 âˆ’b0)+(a1 âˆ’b1)X +Â· Â· Â·+
(anâˆ’1 âˆ’bnâˆ’1)Xnâˆ’1 of Zp[X]. Since âˆ‚pÎ± = n, this is a contradiction.
For the second part, let Î² = a0 + a1Î± + Â· Â· Â· + anâˆ’1Î±nâˆ’1. The result of
Example 19.15, together with Fermatâ€™s little theorem and Î±pm = Î±, gives
Î²pm =

a0 + a1Î± + Â· Â· Â· + anâˆ’1Î±nâˆ’1pm
= apm
0
+ apm
1 Î±pm + Â· Â· Â· + apm
nâˆ’1Î±(nâˆ’1)pm
= a0 + a1Î± + Â· Â· Â· + anâˆ’1Î±nâˆ’1
= Î²

20.3
Algebraic Numbers Over Zp
497
Let Rm stand for the set of roots of Xpm âˆ’X in p. The above claims then assure
that |Rm| â‰¥pn, so that pm â‰¥pn and, hence, m â‰¥n. Since m â‰¤n, we then get
m = n, and items (a) and (b) follow at once.
âŠ“âŠ”
A direct consequence of this proposition is the coming
Corollary 20.25 Let p be prime and Î± âˆˆp be algebraic over Zp. If âˆ‚pÎ± = n,
then pÎ± |

Xpn âˆ’X

in Zp[X].
Proof This follows from the previous result, together with the analogue of Proposi-
tion 20.3 in our setting.
âŠ“âŠ”
Another consequence is collected as the next result.
Lemma 20.26 Let f âˆˆZp[X]\Zp be irreducible and of degree d. If f | (Xpnâˆ’X),
then d | n.
Proof If Î± âˆˆp is a root of f , then f = pÎ±, and the previous corollary guarantees
that f | (Xpd âˆ’X) and f âˆ¤(Xpk âˆ’X), for every positive integer k < d. Since
f | (Xpn âˆ’X), we conclude that d â‰¤n.
Now, let n = d + t and write
Xpn âˆ’X = Xpd+t âˆ’X =

Xpdpt
âˆ’Xpt + Xpt âˆ’X
=

Xpd âˆ’X
pt
+ Xpt âˆ’X.
It readily follows from this equality that
gcd

Xpn âˆ’X, Xpd âˆ’X

= gcd

Xpt âˆ’X, Xpd âˆ’X

.
Assume that n = dq + r, with 0 < r < d. Iterating the gcd equality above, we
get
gcd

Xpn âˆ’X, Xpd âˆ’X

= gcd

Xpr âˆ’X, Xpd âˆ’X

.
(20.8)
Since f divides the left hand side, it also divides the right hand side. In particular,
f | (Xpr âˆ’X), which is a contradiction.
âŠ“âŠ”
We can ï¬nally state and prove our main result, for which we let
an = #{monic, pairwise distinct irreducible polynomials of degree n in Zp[X]}.
Also, if an > 0, we write fn1, fn2, . . . , fnan to denote such polynomials.
Theorem 20.27 Let p be prime and n âˆˆN. Then,
Xpn âˆ’X =

0<d|n
fd1(X) . . . fdad(X),
(20.9)
with the product fd1 . . . fdad taken as 1 if ad = 0.

498
20
Algebraic and Transcendental Numbers
Proof The analogue of Theorem 19.9 for Zp[X] assures that Xpn âˆ’X is the product
of ï¬nitely many irreducible polynomials, which can all be assumed to be monic.
If f is one such polynomial, with âˆ‚f = d, the previous lemma shows that d | n,
so that f is one of the polynomials in the right hand side of (20.9). Conversely, if 0 <
d | n, 1 â‰¤j â‰¤ad and Î± âˆˆp is a root of fdj, then fdj = pÎ±, and Corollary 20.25
guarantees that fdj |

Xpd âˆ’X

in Zp[X]. However, since d | n, the argument in the
proof of the previous lemma leading to (20.8) shows that

Xpd âˆ’X

|

Xpn âˆ’X

in Zp[X]. Therefore, fdj |

Xpn âˆ’X

in Zp[X].
âŠ“âŠ”
Corollary 20.28 If p is prime and n âˆˆN, then
an = 1
n

0<d|n
Î¼
n
d

pd > 0,
(20.10)
where Î¼ is the MÃ¶bius function.
Proof Computing degrees in (20.9), we obtain
pn =

0<d|n
dad.
Applying MÃ¶bius inversion formula (8.4), we obtain the given expression for an. For
what is left to do, just note that, since Im(Î¼) âŠ‚{âˆ’1, 0, 1}, we get
nan = pn +

0<d<n
d|n
Î¼
n
d

pd â‰¥pn âˆ’

0<d<n
d|n
pd
â‰¥pn âˆ’
nâˆ’1

d=1
pd = pn âˆ’pn âˆ’p
p âˆ’1 > 0.
âŠ“âŠ”
Corollary 20.29 Let p be prime and n âˆˆN. If 0 < d | n, then Xpn âˆ’X has an
irreducible factor of degree d.
Proof This follows from (20.9), together with the previous corollary.
âŠ“âŠ”
Problems: Sect. 20.3
1. * Prove the cancellation law for the multiplication in a ï¬eld.
2. Let p be prime and, for n âˆˆN, let Rn denote the set of roots of Xpn âˆ’X in p.
Show that Rn is a subï¬eld of p containing Zp.
3. In the notations of the statement of Theorem 20.27, show that a2 =
p
2

and
f21(X) . . . f2a2(X) = (Xp âˆ’X)pâˆ’1 + 1.
4. Let K be any ï¬eld. Prove that K[X] has inï¬nitely many irreducible polynomials.

20.4
Transcendental Numbers
499
20.4
Transcendental Numbers
As was said at the beginning of Sect. 20.1, transcendental numbers are precisely
the complex numbers which are not roots of nonzero polynomials with rational
coefï¬cients. Nevertheless, up to this point we donâ€™t even know whether such
numbers do exist.
One possible way of establishing the existence of (real) transcendental numbers
is to start by showing that the set A of (real) algebraic numbers is countably
inï¬nite, i.e., that its elements can be put into a sequence (xn)nâ‰¥1, so that A =
{x1, x2, x3, . . .}; then, one proceeds to showing that R is uncountable, so that R \ A
is necessarily nonempty. Up to standard facts on countable and uncountable sets, we
follow this path in the coming theorem, referring the reader to [8] or [33] for the
necessary background.
Theorem 20.30 The set of real algebraic numbers is countably inï¬nite, whereas
that of real transcendental numbers is uncountable.
Proof Let An denote the set of real numbers which are roots of nonconstant
polynomials with rational coefï¬cients and degree n. If we show that each An is
countably inï¬nite, so will be the union
A =

nâ‰¥1
An.
However, such a union is precisely the set of real algebraic numbers.
For what is left to do, for each n âˆˆN let Pn denote the set of polynomials with
rational coefï¬cients and degree n. Since the function
F : Qâˆ—Ã— Q Ã— Â· Â· Â· Ã— Q



nâˆ’1
âˆ’â†’Pn(Q)
given by
F(an, anâˆ’1, . . . , a0) = anXn + anâˆ’1Xnâˆ’1 + Â· Â· Â· + a1X + a0
is a bijection with countably inï¬nite domain, we conclude that Pn is countably
inï¬nite. Now, let Rf denote the set of real roots of f âˆˆQ[X] \ {0}. Since each
f âˆˆPn has a ï¬nite number of real roots, it follows that
An =

f âˆˆPn
Rf
is a countably inï¬nite union of ï¬nite sets, hence countably inï¬nite (for it con-
tains Q).
Finally, since R is uncountable and A âŠ‚R is countably inï¬nite, we conclude
that R \ A is uncountable.
âŠ“âŠ”

500
20
Algebraic and Transcendental Numbers
We now present the classical, explicit construction of the ï¬rst transcendental
number, due to Liouville. Up to details, our discussion follows the marvelous [12].
In the following, we say that an algebraic number Î± has degree n if its minimal
polynomial pÎ± has degree n; in particular, if n > 1, then itâ€™s clear that Î± is irrational.
We shall also need another piece of terminology: we say that a property P(k),
depending on a natural number k, is true for all sufï¬ciently large k if there exists
k0 âˆˆN such that P(k) is true whenever k > k0; moreover, if a speciï¬c value for
k0 is irrelevant in the context under discussion, we only say that P(k) is true for all
k â‰«1.
We are ï¬nally in position to state and prove Liouvilleâ€™s theorem. For the sake of
comparison, at this point you might want to take a look at the statement of Dirichletâ€™s
Lemma 7.7.
Theorem 20.31 (Liouville)
Let Î± âˆˆC be an algebraic number of degree n > 1. If
(pk)kâ‰¥1 and (qk)kâ‰¥1 are sequences of nonzero integers such that limkâ†’+âˆ
pk
qk = Î±,
then
				Î± âˆ’pk
qk
				 >
1
qn+1
k
,
(20.11)
for all k â‰«1.
Proof Let Î±k =
pk
qk . Since Î±k
k
âˆ’â†’Î±, it follows that qk
k
âˆ’â†’+âˆ. Since Î± is
algebraic of degree n > 1, there exists f âˆˆZ[X] \ {0} of degree n and such that
f (Î±) = 0, say,
f (X) = anXn + Â· Â· Â· + a1X + a0,
with a0, a1, . . . , an âˆˆZ.
We now observe that
				
f (Î±k)
Î±k âˆ’Î±
				 =
1
|Î±k âˆ’Î±| Â· |f (Î±k) âˆ’f (Î±)|
=
1
|Î±k âˆ’Î±| Â·
						
n

j=1
aj

Î±j
k âˆ’Î±j
						
â‰¤
1
|Î±k âˆ’Î±| Â·
n

j=1
|aj| Â·
		Î±j
k âˆ’Î±j		,
where we used the triangle inequality in the last passage above. Since Î±k
k
âˆ’â†’Î±, we
have |Î±k âˆ’Î±| < 1 for all k â‰«1. Under this assumption, we continue to estimate the
last expression above by using some elementary algebra, together with the triangle
inequality again, to obtain

20.4
Transcendental Numbers
501
				
f (Î±k)
Î±k âˆ’Î±
				 â‰¤
n

j=1
|aj| Â·
		Î±j
k âˆ’Î±j		
|Î±k âˆ’Î±|
=
n

j=1
|aj| Â·
		Î±jâˆ’1
k
+ Î±jâˆ’2
k
Î± + Â· Â· Â· + Î±jâˆ’1		
â‰¤
n

j=1
|aj|

|Î±kâˆ’Î±|+|Î±|
jâˆ’1+

|Î±k âˆ’Î±|+|Î±|
jâˆ’2|Î±|+Â· Â· Â·+|Î±|jâˆ’1
â‰¤
n

j=1
|aj|

1 + |Î±|
jâˆ’1 +

1 + |Î±|
jâˆ’2|Î±| + Â· Â· Â· + |Î±|jâˆ’1
<
n

j=1
j|aj|(

1 + |Î±|
jâˆ’1 := C,
where C depends only on Î±, and not on k.
Then, for all k â‰«1 (chosen in such a way that |Î±k âˆ’Î±| < 1), we have
				Î± âˆ’pk
qk
				 = |Î±k âˆ’Î±| > 1
C |f (Î±k)|.
Now, since qk
k
âˆ’â†’+âˆ, we have |Î±k âˆ’Î±| < 1 and qk > C for all k â‰«1, so that
1
C > 1
qk and, hence,
				Î± âˆ’pk
qk
				 > 1
qk
|f (Î±k)|,
for all k â‰«1.
As our ï¬nal step, notice that if f (Î±k) = 0, then we would have f (X) = (X âˆ’
Î±k)g(X), for some g âˆˆZ[X]\{0} of degree nâˆ’1. Since Î± Ì¸= Î±k (for, Î± is irrational),
we conclude that Î± would be a root of g, which contradicts the fact that the minimal
polynomial of Î± has degree n. Therefore, f (Î±k) Ì¸= 0 and, hence,
|f (Î±k)| = an
pk
qk
n
+ Â· Â· Â· + a1
pk
qk

+ a0
= 1
qn
k
		anpn
k + Â· Â· Â· + a1pkqnâˆ’1
k
+ a0qn
k
		
â‰¥1
qn
k
.
Finally, combining this inequality with the previous one, we get (20.11).
âŠ“âŠ”

502
20
Algebraic and Transcendental Numbers
The coming example brings a clever application of Liouvilleâ€™s theorem to the
construction of transcendental numbers. Along its discussion, we shall need some
acquaintance with the arithmetic of convergent series, for which we refer the reader
to Section 10.3 of [8].
Example 20.32 (Liouville) If a1, a2, a3, . . . âˆˆ{1, 2, 3, . . . , 9}, then the real number
Î± = a1
101! + a2
102! + a3
103! + Â· Â· Â· .
is transcendental.
Proof Suppose that Î± were algebraic, of degree n > 1 (it is clearly irrationalâ€”see
Problem 1). For k â‰¥1, let
Î±k =
k

j=1
aj
10j! = pk
10k! ,
where pk âˆˆN. Then, on the one hand, it follows from Liouvilleâ€™s theorem that
|Î± âˆ’Î±k| >
1

10k!n+1 ,
for all k â‰«1. On the other,
|Î± âˆ’Î±k| =
						

j>k
aj
10j!
						
<
1
10(k+1)! Â· 9, 999 . . . =
1
10(k+1)!âˆ’1 .
Therefore, for k â‰«1, we should have
1
10(k+1)!âˆ’1 >
1

10k!n+1
and, hence, (k + 1)! âˆ’1 < k!(n + 1). However, this last inequality is equivalent to
k!(k âˆ’n) < 1,
which is false for all k â‰¥n + 1.
Finally, since the assumption that Î± is algebraic leads to a contradiction, we have
no alternative but to conclude that Î± is transcendental.
âŠ“âŠ”
We ï¬nish this section by observing that the methods of real Analysis allow one
to prove that e and Ï€ are transcendental numbers. Both these facts were established
already in the nineteenth century, due to the works of the French mathematician

20.4
Transcendental Numbers
503
C. Hermite and the German mathematician F. Lindemann, respectively. Proofs are
beyond the scope of these notes, and we refer the interested reader to [17] or [28].
Example 20.33 Once we admit the transcendences of e and Ï€, Theorems 20.9
and 20.12 can be applied to establish the transcendence of several other numbers.
More generally, if Î± âˆˆR is algebraic and Î² is transcendental, then Î± + Î² is
transcendental. Indeed, if it algebraic we would have
Î² = (Î± + Î²) âˆ’Î±,
also algebraic. A similar argument shows that if Î± âˆˆR \ {0} is algebraic and Î² is
transcendental, then Î±Î² is transcendental.
Problems: Sect. 20.4
1. Prove that the number Î± of Example 20.32 is irrational.
2. Let Î± âˆˆC be algebraic and Î² âˆˆC be transcendental. Prove directly (i.e., without
resorting to Theorem 20.9) that Î± + Î² is irrational.
3. If Î± âˆˆC is transcendental and n âˆˆN, prove that
nâˆšÎ± and Î±n are also
transcendental.
4. * Let Î± âˆˆC be transcendental, and deï¬ne
Q[Î±] = {a0 + a1Î± + Â· Â· Â· + anÎ±n; n âˆˆN and a0, a1, . . . , an âˆˆQ}.
Prove that Q[Î±] is closed with respect to addition, subtraction and multiplication
but is not a subï¬eld of C.
For the coming problem you might want to use the following fact, which will
be stated without proof: if Î± âˆˆC is a root of a polynomial
f (X) = anXn + anâˆ’1Xnâˆ’1 + Â· Â· Â· + a1X + a0,
with a0, a1, . . . , an algebraic and an Ì¸= 0, then Î± is also algebraic. A proof of this
fact can be found in any standard text on Field Theory, for instance [6] or [20].
5. (OBMU) In the cartesian plane, let S be the set of circles whose centers have
rational coordinates and whose radii have rational lengths. Show that there exists
a regular 2016-gon, all of whose vertices do not belong to S.

Chapter 21
Linear Recurrence Relations
In this chapter we complete the work initiated in Section 3.2 of
[8] (see also
Problems 5, page 79, and 6, page 393), showing how to solve a linear recurrence
relation with constant coefï¬cients and arbitrary order. We ï¬rst need to properly
deï¬ne the objects involved, and we do this now.
Deï¬nition 21.1 A sequence (an)nâ‰¥1 is said to be linear recurrent if there exist a
positive integer k and complex numbers u0, . . . , ukâˆ’1, not all equal to zero, such
that
an+k = ukâˆ’1an+kâˆ’1 + Â· Â· Â· + u0an
(21.1)
for every n â‰¥1.
In the above notations, we sometimes also say that (21.1) is a linear recurrence
relation; the natural number k is thus said to be the order of the linear recurrence
relation (21.1).
Given Î±1, . . . , Î±k âˆˆC, it is immediate to verify (by induction, for instance)
that there is exactly one linear recurrent sequence (an)nâ‰¥1 satisfying (21.1) and
such that aj = Î±j for 1 â‰¤j â‰¤k. Hence, a linear recurrent sequence of order k
falls completely determined upon knowing the linear recurrence relation it satisï¬es,
together with the values of its ï¬rst k terms.
Deï¬nition 21.2 Let (an)nâ‰¥1 be a linear recurrent sequence such that
an+k = ukâˆ’1an+kâˆ’1 + Â· Â· Â· + u0an
for every n â‰¥1, with u0, . . . , ukâˆ’1 being given complex numbers, at least one
of which is nonzero. The characteristic polynomial of (an)nâ‰¥1 is the polynomial
f âˆˆC[X] given by
f (X) = Xk âˆ’ukâˆ’1Xkâˆ’1 âˆ’Â· Â· Â· âˆ’u1X âˆ’u0.
(21.2)
Â© Springer International Publishing AG, part of Springer Nature 2018
A. Caminha Muniz Neto, An Excursion through Elementary Mathematics, Volume III,
Problem Books in Mathematics, https://doi.org/10.1007/978-3-319-77977-5_21
505

506
21
Linear Recurrence Relations
21.1
An Important Particular Case
In this section, we shall discuss how to solve a linear recurrence relation for which
the corresponding characteristic polynomial has pairwise distinct complex roots. In
spite of such a limitation, this case is much simpler to be dealt with than the general
one and ï¬nds several interesting applications. The result we are interested in is the
content of the coming
Theorem 21.3 Let (an)nâ‰¥1 be a sequence satisfying, for every n â‰¥1, the linear
recurrence relation
an+k = ukâˆ’1an+kâˆ’1 + Â· Â· Â· + u0an,
with u0, . . . , ukâˆ’1 being given complex numbers, not all equal to zero. If the complex
roots z1, z2, . . . , zk of the characteristic polynomial of (an)nâ‰¥1 are pairwise distinct
and aj = Î±j for 1 â‰¤j â‰¤k, then
an = znâˆ’1
1
x1 + znâˆ’1
2
x2 + Â· Â· Â· + znâˆ’1
k
xk âˆ€n â‰¥1,
where x1, . . . , xk is the solution of the Vandermonde system of equations
â§
âªâªâªâªâªâªâªâ¨
âªâªâªâªâªâªâªâ©
x1 + x2 + Â· Â· Â· + xk
= Î±1
z1x1 + z2x2 + Â· Â· Â· + zkxk
= Î±2
z2
1x1 + z2
2x2 + Â· Â· Â· + z2
kxk
= Î±3
Â· Â· Â·
znâˆ’1
1
x1 + znâˆ’1
2
x2 + Â· Â· Â· + zkâˆ’1
k
xk = Î±k
.
(21.3)
Proof Since z1, z2, . . . , zk are pairwise distinct, Proposition 18.6 assures the exis-
tence of a unique solution x1, x2, . . . , xk for the system of equations (21.3). We can
thus let (bn)nâ‰¥1 be deï¬ned by setting
bn = znâˆ’1
1
x1 + znâˆ’1
2
x2 + Â· Â· Â· + znâˆ’1
k
xk, âˆ€n â‰¥1.
This way, for 1 â‰¤j â‰¤k, system (21.3) furnishes
bj = zjâˆ’1
1
x1 + znâˆ’1
2
x2 + Â· Â· Â· + zjâˆ’1
k
xk = Î±j = aj.
On the other hand, since f is the characteristic polynomial of (an)nâ‰¥1, it follows
from the deï¬nition of the bjâ€™s that

21.1
An Important Particular Case
507
bn+k âˆ’ukâˆ’1bn+kâˆ’1 âˆ’Â· Â· Â· âˆ’u0bn =
=
k

j=1
zn+kâˆ’1
j
xj âˆ’ukâˆ’1
k

j=1
zn+kâˆ’2
j
xj âˆ’Â· Â· Â· âˆ’u0
k

j=1
znâˆ’1
j
xj
=
k

j=1
znâˆ’1
j
xj(zk
j âˆ’ukâˆ’1zkâˆ’1
j
âˆ’Â· Â· Â· âˆ’u0)
=
k

j=1
znâˆ’1
j
xjf (zj) = 0.
It follows from the above that (bn)nâ‰¥1 satisï¬es the same linear recurrence relation
that (an)nâ‰¥1, and its ï¬rst k terms respectively match the ï¬rst k terms of (an)nâ‰¥1.
Therefore, a straightforward inductive argument guarantees that an = bn for every
n â‰¥1, as we wished to show.
âŠ“âŠ”
The coming example shows that we not necessarily need to actually know the
roots of the characteristic polynomial of a linear recurrence relation, in order to
apply the result of the previous theorem to obtain interesting information concerning
its behavior.
Example 21.4 (Crux) Let A1A2A3A4 be the square of vertices A1 = (0, 1), A2 =
(1, 1), A3 = (1, 0) and A4 = (0, 0). For each integer n â‰¥1, let An+4 be the
midpoint of the line segment AnAn+1. Prove that, when n â†’+âˆ, the sequence of
points An converges to some ï¬xed point A, and compute the coordinates of such a
point.
Proof For each n â‰¥1, let An(xn, yn). The stated condition, together with the
formula for the coordinates of the midpoint of a line segment (cf. Section 6.2 of
[9]), gives
2xn+4 = xn+1 + xn âˆ€n â‰¥1,
an analogous recurrence relation being valid for the sequence (yn)nâ‰¥1.
The characteristic polynomial of the above recurrence relation is
f (X) = 2X4 âˆ’X âˆ’1 = (X âˆ’1)g(X),
with g(X) = 2X3 + 2X2 + 2X + 1. If a, b and c are the complex roots of g, then
Girard-ViÃ¨te relations give
a + b + c = âˆ’1 and ab + ac + bc = 1.
(21.4)
Hence,
a2 + b2 + c2 = (a + b + c)2 âˆ’2(ab + ac + bc) = (âˆ’1)2 âˆ’2 Â· 1 = âˆ’1 < 0,

508
21
Linear Recurrence Relations
so that, thanks to Problem 4, page 386, we can assume that a is real and b and c are
nonreal complex conjugates. In particular, a, b and c are pairwise distinct and, since
1 is not a root of g, Theorem 21.3 guarantees the existence of complex constants A,
B, C and D for which
xn = Aanâˆ’1 + Bbnâˆ’1 + Ccnâˆ’1 + D, âˆ€n â‰¥1.
(21.5)
For us to know what happens when n â†’+âˆ, note ï¬rstly that g(âˆ’1)g(0) =
âˆ’1 < 0 and, thus, Bolzanoâ€™s Theorem 17.2 assures that âˆ’1 < a < 0. Therefore,
relations (21.4) give
1 = a(b + c) + bc = a(âˆ’1 âˆ’a) + bb,
so that |b|2 = a(a+1)+1 < 1. However, since |b| = |c|, it comes that |b| = |c| < 1.
Then, relation (21.5), together with the result of Example 21.8, gives
lim
nâ†’+âˆxn = D.
In order to compute the value of D, recall that x1 = x4 = 0 and x2 = x3 = 1.
Hence, by successively letting n = 1, 2, 3 and 4 in (21.5), we obtain the linear
system of equations
â§
âªâªâ¨
âªâªâ©
A + B + C + D
= 1
Aa + Bb + Cc + Dd
= 0
Aa2 + Bb2 + Cc2 + Dd2 = 0
Aa3 + Bb3 + Cc3 + Dd3 = 1
.
Multiplying the last three equations by 2 and termwise adding the four equalities
thus obtained, we arrive at
Ag(a) + Bg(b) + Cg(c) + 7D = 3.
However, since a, b and c are roots of g, we conclude that 7D = 3, and D = 3
7.
In an analogous way, we prove that limnâ†’+âˆyn = 4
7. Thus,
lim
nâ†’+âˆAn =
3
7, 4
7

.
âŠ“âŠ”
Problems: Sect. 21.1
1. (OBMU) If f (x) = eâˆ’x sin x and f (n) denotes the n-th derivative of f , compute
f (2001)(0).
2. Let A1(a1, b1), A2(a2, b2), . . . , Ak(ak, bk) be k â‰¥2 given points in the cartesian
plane. For each n âˆˆN, let An+k be the center of mass of An, An+1, . . . , An+kâˆ’1,
i.e.,

21.2
Sequences, Series and Continuity in C
509
An+k = 1
k

An+kâˆ’1 + Â· Â· Â· + An+1 + An

.
If Am(xm, ym) for m > k, show that
xm
m
âˆ’â†’kak + (k âˆ’1)akâˆ’1 + Â· Â· Â· + 2a2 + a1
k + (k âˆ’1) + Â· Â· Â· + 2 + 1
and
ym
m
âˆ’â†’kbk + (k âˆ’1)bkâˆ’1 + Â· Â· Â· + 2b2 + b1
k + (k âˆ’1) + Â· Â· Â· + 2 + 1
.
3. (IMO shortlist) If a is the largest positive root of the polynomial X3 âˆ’3X2 + 1,
show that âŒŠa1788âŒ‹and âŒŠa1988âŒ‹are both multiples of 17.
21.2
Sequences, Series and Continuity in C
In this section we partially extend the basic facts on convergence of real sequences
and series (cf. Chapters 7 and 11 of [8], for instance) to functions with complex
values. We observe that the material collected here (more precisely, Theorem 21.20)
was used in the proof of the Fundamental Theorem of Algebra, in Sect. 15.3, and
will be of fundamental importance for Sect. 21.3. We also show that it can be used
to extend the method of generating functions to complex power series.
Given a âˆˆC and R > 0, we denote by D(a; R) the open disk of center a and
radius R, i.e., the subset of C given by
D(a; R) = {z âˆˆC; |z âˆ’a| < R}.
Analogously, the closed disk of center a and radius R is the subset D(a; R) of C,
given by
D(a; R) = {z âˆˆC; |z âˆ’a| â‰¤R}.
A set U âŠ‚C is open if, for every a âˆˆU, there exists R > 0 such that D(a; R) âŠ‚
U. A set F âŠ‚C is closed if F c = C \ F is open. It is immediate to see that âˆ…and
C are open (in the case of âˆ…, there is no way for the openness condition not to be
satisï¬ed, since there exists no z âˆˆâˆ…). Hence, C = C \ âˆ…and âˆ…= C \ C are also
closed. We now collect less trivial examples of open and closed sets.
Example 21.5 For all a âˆˆC and R > 0, the open disk D(a; R) is an open set,
whereas the closed disk D(a; R) is a closed set.

510
21
Linear Recurrence Relations
Fig. 21.1 Every open disk is
an open set
a
z
R
r
Proof Let z âˆˆD(a; R) be arbitrarily chosen and r = R âˆ’|z âˆ’a|. Then, r > 0 and
we claim that D(z; r) âŠ‚D(a; R) (cf. Fig. 21.1), which will be enough to guarantee
that D(a; R) is open.
For what is left to do, take w âˆˆD(z; r). Triangle inequality gives
|w âˆ’a| = |(w âˆ’z) + (z âˆ’a)| â‰¤|w âˆ’z| + |z âˆ’a|
â‰¤r + |z âˆ’a| = R,
so that w âˆˆD(a; R). However, since this holds with every w âˆˆD(z; r), we
conclude that D(z; r) âŠ‚D(a; R), as wished.
For the second part, it is enough to show that U = C \ D(a; R) is open. To this
end, take z âˆˆU and let r = |z âˆ’a| âˆ’R. Then, r > 0 and, as in the ï¬rst part,
we easily show that w âˆˆD(z; r) â‡’w âˆˆU, which is the same as D(z; r) âŠ‚U.
Therefore, U is indeed open.
âŠ“âŠ”
We now turn our attention to sequences of complex numbers, extending to them
the concept of convergence.
Deï¬nition 21.6 A sequence (zn)nâ‰¥1 in C converges for a limit z âˆˆC, and write
zn â†’z or limnâ†’+âˆzn = z, provided the following condition is satisï¬ed:
âˆ€Ïµ > 0, âˆƒn0 âˆˆN; n > n0 â‡’|zn âˆ’z| < Ïµ.
Heuristically, the fulï¬lment of the condition above means that, as n â†’+âˆ, the
terms zn come closer and closer to z. Indeed, the deï¬nition of convergence stipulates
that (zn)nâ‰¥1 converges to z âˆˆC if, for an arbitrarily given radius Ïµ > 0, there exists
an index n0 âˆˆN such that, for n > n0, all of the terms zn belong to the open disk
D(z; Ïµ).
As in the real case, a subsequence (znk)kâ‰¥1 of a sequence (zn)nâ‰¥1 is the
restriction of (zn)nâ‰¥1 to an inï¬nite subset {n1 < n2 < n3 < Â· Â· Â· } of indices; from a
rigorous standpoint, (znk)kâ‰¥1 is the sequence f â—¦g : N â†’C, with f : N â†’C and
g : N â†’N given by f (n) = zn for every n âˆˆN and g(k) = nk for every k âˆˆN.
The coming result brings two fundamental properties of the concept of conver-
gence of sequences of complex numbers. In words, item (a) assures that the terms
of a convergent sequence cannot have two distinct limits, and item (b) that every
subsequence of a convergent sequence is also convergent and converges to the same
limit.

21.2
Sequences, Series and Continuity in C
511
Lemma 21.7 Let (zn)nâ‰¥1 be a sequence in C.
(a) If zn â†’z and zn â†’w, then z = w.
(b) If (znk)kâ‰¥1 is a subsequence of (zn)nâ‰¥1 and zn â†’z, then znk â†’z.
Proof
(a) If z Ì¸= w, then Ïµ = |z âˆ’w| > 0. However, since Ïµ
2 is also positive and zn â†’z
and zn â†’w, there exist natural numbers n1 and n2 such that |zn âˆ’z| < Ïµ
2 for
n > n1 and |zn âˆ’w| < Ïµ
2 for n > n2. Hence, taking an index n > n1, n2 and
applying triangle inequality, we obtain
|z âˆ’w| = |(z âˆ’zn) + (zn âˆ’w)|
â‰¤|z âˆ’zn| + |zn âˆ’w|
< Ïµ
2 + Ïµ
2 = Ïµ = |z âˆ’w|,
which is a contradiction. Therefore, z = w.
(b) Given Ïµ > 0, the convergence of (zn)nâ‰¥1 to z assures the existence of n0 âˆˆN
such that |zn âˆ’z| < Ïµ for n > n0. Now, since n1 < n2 < n3 < Â· Â· Â· , there
exists k0 âˆˆN with k > k0 â‡’nk > n0. Hence, for such values of k, we have
|znk âˆ’z| < Ïµ, so that (znk)kâ‰¥1 also converges to z.
âŠ“âŠ”
Thanks to item (a) of the previous lemma, if a sequence (zn)nâ‰¥1 in C converges
to z âˆˆC, we shall hereafter say that z is the limit of (zn)nâ‰¥1.
For the purposes of these notes, one of the most important examples of
convergent sequence is the one collected below. In this respect, see also Problem 2.
Example 21.8 If |z| < 1 and zn = zn for every n â‰¥1, then (zn)nâ‰¥1 converges to 0.
Proof Firstly, note that |zn âˆ’0| = |zn| = |z|n. Now, if (an)nâ‰¥1 is the sequence
of real numbers given for n â‰¥1 by an = |z|n, then (cf. Example 7.12 of [8], for
instance) an â†’0. Thus, given Ïµ > 0, there exists n0 âˆˆN such that 0 â‰¤an < Ïµ for
n > n0. Thus, for n > n0, we have |zn âˆ’0| = an < Ïµ, so that zn â†’0.
âŠ“âŠ”
Given a sequence (zn)nâ‰¥1 of complex numbers, we can write zn = xn + iyn for
every n â‰¥1, with xn, yn âˆˆR. Our next result relates the convergence of (zn)nâ‰¥1 in
C with those of (xn)nâ‰¥1 and (yn)nâ‰¥1 in R.
Lemma 21.9 Let (zn)nâ‰¥1 be a sequence of complex numbers, with zn = xn + iyn
and xn, yn âˆˆR for every n â‰¥1. Then, (zn)nâ‰¥1 converges in C if and only if (xn)nâ‰¥1
and (yn)nâ‰¥1 converge in R. Moreover, if xn â†’a and yn â†’b, then zn â†’z, with
z = a + ib.
Proof Firstly, suppose that zn â†’z, with z = a + ib, a, b âˆˆR, and let Ïµ > 0 be
given. Since
|xn âˆ’a|, |yn âˆ’b| â‰¤
;
|xn âˆ’a|2 + |yn âˆ’b|2 = |zn âˆ’z|,

512
21
Linear Recurrence Relations
we have |xn âˆ’a|, |yn âˆ’b| < Ïµ whenever |zn âˆ’z| < Ïµ. However, since zn â†’z,
there exists n0 âˆˆN such that n > n0 â‡’|zn âˆ’z| < Ïµ. Then, for each such natural
n, we do have |xn âˆ’a|, |yn âˆ’b| < Ïµ, hence establishing the desired convergences.
Conversely, assume that xn â†’a and yn â†’b, and let z = a + ib and Ïµ > 0 be
given. Since
|zn âˆ’z| =
;
|xn âˆ’a|2 + |yn âˆ’b|2 â‰¤|xn âˆ’a| + |yn âˆ’b|,
we have |zn âˆ’z| < Ïµ if |xn âˆ’a|, |yn âˆ’b| < Ïµ
2. However, since xn â†’a and yn â†’b,
there exist n1, n2 âˆˆN such that n > n1 â‡’|xnâˆ’a| < Ïµ
2 and n > n2 â‡’|ynâˆ’b| < Ïµ
2.
If n0 = max{n1, n2}, then, for n > n0, we have |xn âˆ’a|, |yn âˆ’b| < Ïµ
2 and, hence,
|zn âˆ’z| < Ïµ. This establishes the convergence of (zn)nâ‰¥1 to z.
âŠ“âŠ”
We now need to extend to complex sequences another concept related to the
convergence of real sequences.
Deï¬nition 21.10 A Cauchy sequence in C is a sequence (zn)nâ‰¥1 satisfying the
following condition: given Ïµ > 0, there exists n0 âˆˆN such that
m, n > n0 â‡’|zm âˆ’zn| < Ïµ.
If (zn)nâ‰¥1 is a convergent sequence in C, then (zn)nâ‰¥1 is a Cauchy sequence.
Indeed, if zn â†’z and Ïµ > 0 is given, then there exists n0 âˆˆN such that |znâˆ’z| < Ïµ
2
for every n > n0. Hence, for natural numbers m, n > n0, it follows from the triangle
inequality for complex numbers that
|zm âˆ’zn| â‰¤|zm âˆ’z| + |z âˆ’zn| â‰¤Ïµ
2 + Ïµ
2 = Ïµ.
Conversely, we have the following important result.
Proposition 21.11 C is complete. More precisely, if (zn)nâ‰¥1 is a Cauchy sequence
in C, then (zn)nâ‰¥1 converges.
Proof Let zn = xn + iyn, with (xn)nâ‰¥1 and (yn)nâ‰¥1 being sequences of real
numbers. Given Ïµ > 0, take n0 âˆˆN as in the deï¬nition of Cauchy sequence.
Since |xm âˆ’xn| â‰¤|zm âˆ’zn|, it follows that (xn)nâ‰¥1 is a Cauchy sequence in
R. Therefore, Theorem 7.27 of [8] guarantees that (xn)nâ‰¥1 is convergent, say for
x âˆˆR. Analogously, there exists y âˆˆR such that yn â†’y. Hence, letting z = x+iy,
Lemma 21.9 assures that zn â†’z.
âŠ“âŠ”
As in the real case (cf. [8]), given a sequence (zn)nâ‰¥1 of complex numbers, we
deï¬ne the series1 
kâ‰¥1 zk as the sequence (sn)nâ‰¥1, such that sn = n
k=1 zk for
every n âˆˆN. Also as in the real case, we say that sn is the n-th partial sum of
1The reader must pay attention to the fact that we shall sometimes consider sequences (zn)nâ‰¥0 of
complex numbers, so that the corresponding series will be denoted by 
kâ‰¥0 zk.

21.2
Sequences, Series and Continuity in C
513
the series, and that the series converges if there exists the limit s := limnâ†’+âˆsn;
moreover, in this case we shall say that s is the sum of the series. In symbols, we
write

kâ‰¥1
zk =
lim
nâ†’+âˆ
n

k=1
zk,
provided the limit at the right hand side does exist.
We now present an example of convergent series which will be of fundamental
importance in the next section.
Example 21.12 Given a âˆˆC \ {0}, show that for z âˆˆD(0; 1
|a|) we have
1
1 âˆ’az =

kâ‰¥0
akzk.
Proof Lemma 13.18 assures that the n-th partial sum of the series is
n

k=0
(az)k = 1 âˆ’(az)n+1
1 âˆ’az
=
1
1 âˆ’az âˆ’(az)n+1
1 âˆ’az .
Now, for z âˆˆD(0; 1
|a|) we have |az| < 1, so that Example 21.8 gives (az)n â†’0 as
n â†’+âˆ. Hence, it follows from the equality above that, for z âˆˆD(0; 1
|a|),

kâ‰¥0
(az)k =
lim
nâ†’+âˆ
n

k=0
(az)k =
1
1 âˆ’az âˆ’
lim
nâ†’+âˆ
(az)n+1
1 âˆ’az =
1
1 âˆ’az.
âŠ“âŠ”
Another concept of central importance is that of an absolutely convergent
series, i.e., a series 
kâ‰¥0 zk of complex numbers such that the real series 
kâ‰¥0 |zk|
converges. For n âˆˆN, let sn = n
k=1 zk and tn = n
k=1 |zk|, so that (tn)nâ‰¥1
converges. The triangle inequality for complex numbers furnishes, for integers
m > n,
|sm âˆ’sn| =
					
m

k=n+1
zk
					 â‰¤
m

k=n+1
|zk| = tm âˆ’tn.
Now, since (tn)nâ‰¥1 converges, it is a Cauchy sequence; hence, given Ïµ > 0, there
exists k0 âˆˆN such that m > n > k0 â‡’tm âˆ’tn < Ïµ. Therefore, we also have
|sm âˆ’sn| < Ïµ for m > n > k0, so that (sn)nâ‰¥0 is a Cauchy sequence too. Thus,
Proposition 21.11 assures its convergence, and we have proved the coming.
Proposition 21.13 In C, every absolutely convergent series is convergent.
Before we can go on, we need to extend the concept of continuity for functions
deï¬ned on a subset of C and assuming complex values.

514
21
Linear Recurrence Relations
Deï¬nition 21.14 Given a nonempty subset X of C, we say that a function f : X â†’
C is continuous if the following condition is satisï¬ed: for every sequence (zn)nâ‰¥1
of points of X, if zn â†’z, with z âˆˆX, then f (zn) â†’f (z).
Our next result will allow us to establish the continuity of complex polynomial
functions.
Proposition 21.15 If f, g : X â†’C are continuous functions, then so are f +
g, fg : X â†’C.
Proof Let a sequence (zn)nâ‰¥1 in X be given, such that zn â†’z, for some z âˆˆX.
Firstly, the triangle inequality for complex numbers gives
|(f + g)(zn) âˆ’(f + g)(z)| = |(f (zn) âˆ’f (z)) + (g(zn) âˆ’g(z)|
â‰¤|f (zn) âˆ’f (z)| + |g(zn) âˆ’g(z)|.
Now, given Ïµ > 0, since f (zn) â†’f (z) and g(zn) â†’g(z), there exists n0 âˆˆN
such that
n > n0 â‡’|f (zn) âˆ’f (z)|, |g(zn) âˆ’g(z)| < Ïµ
2.
Therefore, also for n > n0, the above estimates show that
|(f + g)(zn) âˆ’(f + g)(z)| â‰¤Ïµ
2 + Ïµ
2 = Ïµ
and, hence, that (f + g)(zn) â†’(f + g)(z).
For fg, and applying twice the triangle inequality, we obtain
|(fg)(zn) âˆ’(fg)(z)| = |f (zn)g(zn) âˆ’f (z)g(z)|
â‰¤|f (zn) âˆ’f (z)||g(zn)| + |f (z)||g(zn) âˆ’g(z)|
â‰¤|f (zn) âˆ’f (z)||g(zn) âˆ’g(z)|
+ |f (zn) âˆ’f (z)||g(z)| + |f (z)||g(zn) âˆ’g(z)|.
As before, given Ïµ > 0, we can take n0 âˆˆN such that n > n0 implies
|f (zn) âˆ’f (z)| < min
<Ïµ
3,
Ïµ
3(|g(z)| + 1)
/
and
|g(zn) âˆ’g(z)| < min
<Ïµ
3,
Ïµ
3(|f (z)| + 1)
/
.

21.2
Sequences, Series and Continuity in C
515
Then, for a natural number n > n0, it follows from the above that
|(fg)(zn) âˆ’(fg)(z)| â‰¤
<Ïµ
3 Â·
<Ïµ
3 +
Ïµ
3(|g(z)| + 1) Â· |g(z)|
+ |f (z)| Â·
Ïµ
3(|f (z)| + 1)
< Ïµ
3 + Ïµ
3 + Ïµ
3 = Ïµ,
so that (fg)(zn) â†’(fg)(z).
âŠ“âŠ”
Example 21.16 Given n âˆˆN and a0, a1, . . . , anâˆ’1, an âˆˆC, with an Ì¸= 0, the
complex polynomial function f : C â†’C, given for z âˆˆC by
f (z) = anzn + anâˆ’1znâˆ’1 + Â· Â· Â· + a1z + a0,
is continuous.
Proof Obviously, constant functions and the identity function z â†’z are continuous
(just apply the deï¬nition). Thus, by applying several times the second part of the
previous proposition, we conclude that, for an integer 0 â‰¤k â‰¤n, the function z â†’
akzk is also continuous. Now, applying several times the ï¬rst part of the previous
proposition, we conclude that the sum of such functions, when k varies from 0 to n,
is also continuous. However, such a sum is precisely the function f .
âŠ“âŠ”
We now turn to the discussion of power series in C, namely, a series of the form

kâ‰¥0 akzk, for some given sequence (an)nâ‰¥0 of complex numbers.
Assume that the sequence ( kâˆš|ak|)kâ‰¥0 is bounded, say with
kâˆš|ak| < A for
every k â‰¥0 and some A > 0. Then, |akzk| â‰¤(Az)k for every k â‰¥0, so that
Example 21.12 guarantees that the series 
kâ‰¥0 |akzk| converges in D(0; R), where
R =
1
A. In turn Proposition 21.13 then assures that the power series 
kâ‰¥0 akzk
converges in D(0; R). We abbreviate such a situation simply by saying that D(0; R)
is a convergence disk for the power series under consideration. The next result
assures that the function f : D(0; R) â†’C thus deï¬ned is continuous.2 By the sake
of notation, we make the convention that 
kâ‰¥0 akzk = a0 for z = 0.
Proposition 21.17 If D(0; R) is a convergence disk for the power series

kâ‰¥0 akzk, then the function f : D(0; R) â†’C, given for z âˆˆD(0; R) by
f (z) = 
kâ‰¥0 akzk, is continuous.
2Actually, one can show that f is an example of a holomorphic (i.e., complex differentiable)
function. However, since we shall not need this concept, and in order to maintain the elementary
character of these notes, we will only establish the continuity of functions deï¬ned by power series.
The interested reader can ï¬nd the relevant results and deï¬nitions in [11].

516
21
Linear Recurrence Relations
Proof For a ï¬xed z âˆˆD(0; R), take w âˆˆC such that |w âˆ’z| < 1
2(R âˆ’|z|). Then,
|w| < r, with r = 1
2(R + |z|) < R, and for k âˆˆN we have
|wk âˆ’zk| = |w âˆ’z||wkâˆ’1 + wkâˆ’2z + Â· Â· Â· + wzkâˆ’2 + zkâˆ’1|
â‰¤|w âˆ’z|(|w|kâˆ’1 + |w|kâˆ’2|z| + Â· Â· Â· + |w||z|kâˆ’2 + |z|kâˆ’1)
â‰¤|w âˆ’z|(rkâˆ’1 + rkâˆ’2 Â· r + Â· Â· Â· + r Â· rkâˆ’2 + rkâˆ’1)
= krkâˆ’1|w âˆ’z|.
Hence, under the above restriction on w, Problem 4 yields
|f (w) âˆ’f (z)| =
			

kâ‰¥0
akwk âˆ’

kâ‰¥0
akzk			 =
			

kâ‰¥0
ak(wk âˆ’zk)
			
=
			

kâ‰¥1
ak(wk âˆ’zk)
			 â‰¤

kâ‰¥1
|ak||wk âˆ’zk|
â‰¤1
r
 
kâ‰¥1
k|ak|rk
|w âˆ’z|.
Now, ï¬x a real number c such that 1 < c < R
r . Since
kâˆš|ak| <
1
R for k â‰¥0
and
kâˆš
k â†’1 (cf. Example 7.23 of [8], for instance), there exists k0 âˆˆN such that
kâˆšk|ak| < c
R for k > k0. Hence,

kâ‰¥k0
k|ak|rk <

kâ‰¥k0
cr
R
k
:= C < +âˆ,
for 0 < cr
R < 1. Finally, letting Câ€² = k0
k=1 k|ak|rk, it comes that
|f (w) âˆ’f (z)| â‰¤1
r
 k0

k=1
k|ak|rk
|w âˆ’z| + 1
r
 
k>k0
k|ak|rk
|w âˆ’z|
â‰¤Câ€²
r |w âˆ’z| + C
r |w âˆ’z|.
In short, we have shown that
|w âˆ’z| < 1
2(R âˆ’|z|) â‡’|f (w) âˆ’f (z)| < A|w âˆ’z|,
for some positive constant A. But this being the case, Problem 8 shows that zn â†’
z â‡’f (zn) â†’f (z), and the fact that z âˆˆD(0; R) was arbitrarily chosen guarantees
the continuity of f .
âŠ“âŠ”

21.2
Sequences, Series and Continuity in C
517
The coming corollary assures that if a function f : D(0; R) â†’C is given by a
power series, then such a series is uniquely determined.
Corollary 21.18 Let 
kâ‰¥0 akzk and 
kâ‰¥0 bkzk be convergent power series in the
open disk D(0; R). If 
kâ‰¥0 akzk = 
kâ‰¥0 bkzk for every z âˆˆD(0; R), then ak = bk
for every k â‰¥0.
Proof By evaluating equality 
kâ‰¥0 akzk = 
kâ‰¥0 bkzk at z = 0, we obtain
a0
=
b0. Then, cancelling out a0
=
b0 in both sides of 
kâ‰¥0 akzk
=

kâ‰¥0 bkzk, we get 
kâ‰¥1 akzk
= 
kâ‰¥1 bkzk for z âˆˆD(0; R) and, hence,

kâ‰¥1 akzkâˆ’1 = 
kâ‰¥1 bkzkâˆ’1 for z âˆˆD(0; R) \ {0}. However, since both sides
of this last equality deï¬ne continuous functions on D(0; R), we conclude that

kâ‰¥1 akzkâˆ’1 = 
kâ‰¥1 bkzkâˆ’1 for every z âˆˆD(0; R). Now, looking at such an
equality at z = 0, we obtain a1 = b1. By proceeding this way, an easy induction
gives ak = bk for every k â‰¥0.
âŠ“âŠ”
As a ï¬rst application of the ideas developed here, we now present a proof of the
identities of Proposition 16.17 with the aid of complex generating functions.
Example 21.19 For z1, . . . , zn
âˆˆC, if si
= si(z1, . . . , zn) denotes the i-th
elementary symmetric sum of z1, . . . , zn and Ïƒk = zk
1 + Â· Â· Â· + zk
n, then:
(a) Ïƒn+k = n
j=1(âˆ’1)jâˆ’1sjÏƒn+kâˆ’j for k â‰¥1.
(b) sk+1 =
1
k+1
k+1
j=1(âˆ’1)jâˆ’1sk+1âˆ’jÏƒj for 1 â‰¤k â‰¤n âˆ’1.
Proof Let
f (X) =
n

j=1
(1 + zjX) =
n

j=0
sjXj.
On the one hand, we have f â€²(X) = n
j=1 jsjXjâˆ’1; on the other, for z âˆˆD(0; R),
with
R = min{|zj|âˆ’1; 1 â‰¤j â‰¤n and zj Ì¸= 0} > 0,
Problem 3, page 393, gives
f â€²(z) =

n

i=1
zi(1 + ziz)âˆ’1
f (z) =
n

i=1
 
jâ‰¥0
(âˆ’1)jzj+1
i
zj
f (z)
=
 
jâ‰¥0
n

i=1
(âˆ’1)jzj+1
i
zj
f (z)
=
 
jâ‰¥0
(âˆ’1)jÏƒj+1zj
n

l=0
slzl
.
We now apply the previous corollary in both cases, looking at both expressions
for f â€²(z) as complex power series. In (a), computing the coefï¬cient of zkâˆ’1 in both
expressions for f â€²(z) we obtain

518
21
Linear Recurrence Relations
ksk =

j+l=kâˆ’1
(âˆ’1)jÏƒj+1sl =
kâˆ’1

l=0
(âˆ’1)kâˆ’lâˆ’1Ïƒkâˆ’lsl
so that
(âˆ’1)kksk âˆ’
kâˆ’1

l=0
(âˆ’1)l+1Ïƒkâˆ’lsl = 0.
Doing the same in (b), we get
0 =

j+l=kâˆ’1
(âˆ’1)jÏƒj+1sl =
n

l=0
(âˆ’1)kâˆ’1âˆ’lÏƒkâˆ’lsl
and, hence,
n

l=0
(âˆ’1)lÏƒkâˆ’lsl = 0.
âŠ“âŠ”
We ï¬nish this section by proving a result that extends, for continuous functions
f : D(a; R) â†’C, Theorem 8.26 of [8].
Theorem 21.20 (Weierstrass3)
If f : D(a; R) â†’C is a continuous function,
then there exist zm and zM in D(a; R) such that
|f (zm)| = min{|f (z)|; z âˆˆD(a; R)}
and
|f (zM)| = max{|f (z)|; z âˆˆD(a; R)}.
Proof Let (zn)nâ‰¥1 be a sequence in D(a; R) such that
f (zn) â†’sup{|f (z)|; z âˆˆD(a; R)}
(here, in principle we do not exclude the possibility that such a supremum could be
+âˆ). Write zn = xn + iyn, with xn, yn âˆˆR. Since |zn| â‰¤R for every n â‰¥1, we
have |xn|, |yn| â‰¤R for every n â‰¥1. Therefore, Theorem 7.25 of [8] guarantees the
existence of an inï¬nite set N1 âŠ‚N such that (xn)nâˆˆN1 converges to some x âˆˆR.
Hence, by the same result we can take a second inï¬nite set N2 âŠ‚N1 such that
(yn)nâˆˆN2 converges to some y âˆˆR. However, since (xn)nâˆˆN2 is a subsequence of
(xn)nâˆˆN1, we conclude that (xn)nâˆˆN2 still converges to x.
Letting zM = x + iy, it follows from Lemma 21.9 that (zn)nâˆˆN2 converges to
zM. Hence, Problem 1 gives |zM| â‰¤R, so that zM âˆˆD(a; R). Now, invoking the
3Karl Weierstrass, German mathematician of the nineteenth century.

21.2
Sequences, Series and Continuity in C
519
continuity of f , we have
f (zM) = lim
nâ†’+âˆ
nâˆˆN2
f (zn) = sup{|f (z)|; z âˆˆD(a; R)}.
In particular,
sup{|f (z)|; z âˆˆD(a; R)} = max{|f (z)|; z âˆˆD(a; R)}.
The proof of the ï¬rst part of the theorem is analogous and will be left as an
exercise to the reader.
âŠ“âŠ”
The result of the following corollary was used in the proof of the Fundamental
Theorem of Algebra.
Corollary 21.21 If f : C â†’C is a complex polynomial function, then, given
R > 0, there exist zm and zM in D(a; R) such that
|f (zm)| = min{|f (z)|; z âˆˆD(a; R)}
and
|f (zM)| = max{|f (z)|; z âˆˆD(a; R)}.
Proof Example 21.16 and Problem 7 guarantee that |f | : C â†’[0, +âˆ) is a
continuous function. Thus, so is the function |f | : D(a; R) â†’[0, +âˆ). It now
sufï¬ces to apply Weierstrassâ€™ theorem.
âŠ“âŠ”
Problems: Sect. 21.2
1. * Let (zn)nâ‰¥1 be a sequence in C, converging to z âˆˆC. Prove that (zn)nâ‰¥1 is
bounded, i.e., that there exists M > 0 such that |zn| < M for every n â‰¥1.
Moreover, if |zn| â‰¤R for every n â‰¥1, show that |z| â‰¤R.
For the next problem, we say that a sequence of complex numbers is divergent
if it is not convergent.
2. If |z| > 1 and zn = zn for every n â‰¥1, show that the sequence (zn)nâ‰¥1 is
divergent.
3. * Let (zn)nâ‰¥1 and (wn)nâ‰¥1 be sequences in C, converging to z and w, respec-
tively. Prove that:
(a) If a âˆˆC, then azn â†’az.
(b) zn Â± wn â†’z Â± w.
(c) znwn â†’zw.
(d) If wn, w Ì¸= 0, then zn/wn â†’z/w.

520
21
Linear Recurrence Relations
4. * If a, b âˆˆC and 
kâ‰¥1 zk and 
kâ‰¥1 wk are convergent series of complex
numbers, show that 
kâ‰¥1(azk + bwk) is also convergent, with

kâ‰¥1
(azk + bwk) = a

kâ‰¥1
zk + b

kâ‰¥1
wk.
5. * Extend the comparison test for series to series of complex numbers. More
precisely, let (an)nâ‰¥0 be a sequence of complex numbers. If there exist positive
reals c and M such that |an| â‰¤cMn for every n â‰¥0, then the power series

nâ‰¥0 anzn converges on the interval

âˆ’1
M , 1
M

.
6. * Let âˆ…Ì¸= X âŠ‚Y âŠ‚C and f : Y â†’C be a continuous function. Prove that
f|X : X â†’C is also continuous.
7. * Given âˆ…Ì¸= X âŠ‚C and a continuous function f : X â†’C, prove that |f | :
X â†’[0, +âˆ) is also continuous.
8. * Let âˆ…Ì¸= X âŠ‚C and f : X â†’C be a function satisfying the following
condition: given z âˆˆX, there exist A, B > 0 (at ï¬rst depending on z), such that
w âˆˆX, |w âˆ’z| < B â‡’|f (w) âˆ’f (z)| < A|w âˆ’z|.
Show that f is continuous.
9. * If a âˆˆC \ {0} and m âˆˆN, show that for z âˆˆD(0; 1
|a|) we have
1
(1 âˆ’az)m =

nâ‰¥0
n + m âˆ’1
m âˆ’1

anzn.
21.3
The General Case
With the material of the previous section at our disposal, we can ï¬nally face the
discussion of the general case of (21.1), i.e., that in which the complex roots of the
characteristic polynomial (21.2) are not necessarily distinct. To this end, we shall
use complex generating functions again. The fundamental result is given by the
coming
Theorem 21.22 Let (an)nâ‰¥1 be a sequence of complex numbers satisfying, for
every n â‰¥1, the linear recurrence relation
an+k = ukâˆ’1an+kâˆ’1 + Â· Â· Â· + u0an,
with u0, . . . , ukâˆ’1 being given complex numbers and u0 Ì¸= 0. Let z1, . . . , zl be
the pairwise distinct roots of the characteristic polynomial (21.2) of (an)nâ‰¥1, with
multiplicities respectively equal to m1, . . . , ml. Then, for every n â‰¥1, we have
an = p1(n âˆ’1)znâˆ’1
1
+ Â· Â· Â· + pl(n âˆ’1)znâˆ’1
l
,

21.3
The General Case
521
where p1, . . . , pl âˆˆC[X] are polynomials of degrees less than or equal to m1 âˆ’1,
. . . , ml âˆ’1, respectively, and totally determined by the values of a1, . . . , ak.
Proof We ï¬rst claim that there exists a constant R0 > 0 such that |an| â‰¤Rn for
every n â‰¥1 and R > R0. Indeed, if |an| â‰¤Rn for 1 â‰¤n < m, with m > k, then
|am| = |ukâˆ’1amâˆ’1 + Â· Â· Â· + u1amâˆ’k+1 + u0amâˆ’k|
â‰¤|ukâˆ’1||amâˆ’1| + Â· Â· Â· + |u1||amâˆ’k+1| + |u0||amâˆ’k|
â‰¤|ukâˆ’1|Rmâˆ’1 + Â· Â· Â· + |u1|Rmâˆ’k+1 + |u0|Rmâˆ’k
= Rmâˆ’k(|ukâˆ’1|Rkâˆ’1 + Â· Â· Â· + |u1|R + |u0|).
Hence, if g(X) = Xk âˆ’|ukâˆ’1|Xkâˆ’1 âˆ’Â· Â· Â· âˆ’|u1|X âˆ’|u0| and R0 > 0 is such that
g(R) > 0 for R > R0, then, for each one of such Râ€™s, the estimates above give
|am| â‰¤Rmâˆ’k(|ukâˆ’1|Rkâˆ’1 + Â· Â· Â· + |u1|R + |u0|)
â‰¤Rmâˆ’k Â· Rk = Rm.
It thus sufï¬ces to choose, from the very beginning, R0 > 0 such that |a1|, . . . , |ak| â‰¤
R0 and g(R) > 0 for every R > R0.
Now, ï¬x R > R0 and let
F(z) =

nâ‰¥1
anzn.
Since |an| â‰¤Rn for every n â‰¥1, the comparison test for series (cf. Problem 5,
page 520) guarantees the convergence of F in the open disk D(0; 1
R ) of the complex
plane. Let f (X) = Xkâˆ’ukâˆ’1Xkâˆ’1âˆ’Â· Â· Â·âˆ’u1Xâˆ’u0 be the characteristic polynomial
of (an)nâ‰¥1 and h(X) = âˆ’u0Xk âˆ’u1Xkâˆ’1 âˆ’Â· Â· Â·âˆ’ukâˆ’1X+1 its reciprocal (âˆ‚h = k,
since u0 Ì¸= 0). For z âˆˆD(0; 1
R ), we have
h(z)F(z) = âˆ’
 kâˆ’1

j=0
ujzkâˆ’j 
nâ‰¥1
anzn
+

nâ‰¥1
anzn
= âˆ’
kâˆ’1

j=0

nâ‰¥1
ujanzn+kâˆ’j +

nâ‰¥1
anzn
= âˆ’
kâˆ’1

j=0

nâ‰¥kâˆ’j+1
ujanâˆ’k+jzn +

nâ‰¥1
anzn.

522
21
Linear Recurrence Relations
For j â‰¥2, write

nâ‰¥kâˆ’j+1
ujanâˆ’k+jzn =
kâˆ’1

n=kâˆ’j+1
ujanâˆ’k+jzn +

nâ‰¥k
ujanâˆ’k+jzn
and analogously for 
nâ‰¥1 anzn. Then, we obtain
h(z)F(z) = âˆ’

nâ‰¥k+1
u0anâˆ’kzn âˆ’

nâ‰¥k
u1anâˆ’k+1zn
âˆ’
kâˆ’1

j=2

kâˆ’1

n=kâˆ’j+1
ujanâˆ’k+jzn +

nâ‰¥k
ujanâˆ’k+jzn
+
kâˆ’1

n=1
anzn +

nâ‰¥k
anzn
= âˆ’

nâ‰¥k+1
u0anâˆ’kzn âˆ’

nâ‰¥k
u1anâˆ’k+1zn
âˆ’
kâˆ’1

j=2

nâ‰¥k
ujanâˆ’k+jzn +

nâ‰¥k
anzn
âˆ’
kâˆ’1

j=2
kâˆ’1

n=kâˆ’j+1
ujanâˆ’k+jzn +
kâˆ’1

n=1
anzn.
However, since
kâˆ’1

j=2

nâ‰¥k
ujanâˆ’k+jzn =

nâ‰¥k
kâˆ’1

j=2
ujanâˆ’k+jzn,
it follows from (21.1) that
âˆ’
kâˆ’1

j=2

nâ‰¥k
ujanâˆ’k+jzn +

nâ‰¥k
anzn =

nâ‰¥k

âˆ’
kâˆ’1

j=2
ujanâˆ’k+j + an

zn
=

âˆ’
kâˆ’1

j=2
ujaj + ak

zk +

nâ‰¥k+1

âˆ’
kâˆ’1

j=2
ujanâˆ’k+j + an

zn
=

âˆ’
kâˆ’1

j=2
ujaj + ak

zk +

nâ‰¥k+1
(u0anâˆ’k + u1anâˆ’k+1) zn.

21.3
The General Case
523
Therefore,
h(z)F(z) = âˆ’

nâ‰¥k+1
u0anâˆ’kzn âˆ’

nâ‰¥k
u1anâˆ’k+1zn
+

âˆ’
kâˆ’1

j=2
ujaj + ak

zk +

nâ‰¥k+1
(u0anâˆ’k + u1anâˆ’k+1) zn
âˆ’
kâˆ’1

j=2
kâˆ’1

n=kâˆ’j+1
ujanâˆ’k+jzn +
kâˆ’1

n=1
anzn
=

ak âˆ’
kâˆ’1

j=1
ujaj

zk âˆ’
kâˆ’1

j=2
kâˆ’1

n=kâˆ’j+1
ujanâˆ’k+jzn +
kâˆ’1

n=1
anzn,
so that
h(z)F(z) = zp(z)
for z âˆˆD(0; 1
R ), with p âˆˆC[X] being a nonzero polynomial of degree âˆ‚p â‰¤k âˆ’1.
Since h(0) = 1 Ì¸= 0, by increasing R, if needed, we can assume that h(z) Ì¸= 0
for z âˆˆD(0; 1
R ). On the other hand, since
f (X) = (X âˆ’z1)m1 . . . (X âˆ’zl)ml,
we have
h(X) = (1 âˆ’z1X)m1 . . . (1 âˆ’zlX)ml,
so that
F(z) =
zp(z)
(1 âˆ’z1z)m1 . . . (1 âˆ’zlz)ml
(21.6)
for z âˆˆD(0; 1
R ).
Now, observe that
âˆ‚p < k = âˆ‚((1 âˆ’z1z)m1 . . . (1 âˆ’zlz)ml).
Hence, by applying to (21.6) the partial fractions decomposition formula (cf.
Problem 9, page 457), we conclude the existence, for 1 â‰¤j â‰¤l and 1 â‰¤nj â‰¤mj,
of constants djnj , uniquely determined by the coefï¬cients of p (and, thus, by a1, a2,
. . . , ak and u0, u1, . . . , ukâˆ’1), such that

524
21
Linear Recurrence Relations
F(z) = z
l
j=1
mj

nj =1
djnj
(1 âˆ’zjz)nj
(21.7)
for z âˆˆD(0; 1
R ).
However, if r = min{ 1
R ,
1
|z1|, . . . , 1
|zl|}, then the result of Problem 9, page 520,
assures that
1
(1 âˆ’zjz)nj =

nâ‰¥0
n + nj âˆ’1
nj âˆ’1

zn
jzn
for 1 â‰¤j â‰¤l, 1 â‰¤nj â‰¤mj and z âˆˆD(0; r). Hence, it follows from (21.7) that,
for |z| < r,
F(z) = z
l
j=1
mj

nj =1

nâ‰¥0
djnj
n + nj âˆ’1
nj âˆ’1

zn
jzn
=

nâ‰¥0
â›
â
l
j=1
mj

nj =1
djnj
n + nj âˆ’1
nj âˆ’1

zn
j
â
â zn+1
=

nâ‰¥1
â›
â
l
j=1
mj

nj =1
djnj
n + nj âˆ’2
nj âˆ’1

znâˆ’1
j
â
â zn.
Finally, since an is the coefï¬cient of zn in the deï¬ning series for F, the last
equality above, together with Corollary 21.18, gives
an =
l
j=1
mj

nj =1
djnj
n + nj âˆ’2
nj âˆ’1

znâˆ’1
j
=
l
j=1
mj

nj =1
djnj
(nj âˆ’1)!(n + nj âˆ’2)(n + nj âˆ’3) . . . (n + 1)nznâˆ’1
j
=
l
j=1
pj(n âˆ’1)znâˆ’1
j
,

21.3
The General Case
525
where
pj(X) =
mj

nj =1
djnj
(nj âˆ’1)!(X + nj âˆ’1)(X + nj âˆ’2) . . . (X + 1)znâˆ’1
j
= cj,mj âˆ’1Xmj âˆ’1 + Â· Â· Â· + cj1X + cj0
is a polynomial of degree at most mj âˆ’1.
âŠ“âŠ”
In order to present a relevant application of the previous result, we ï¬rst need a
deï¬nition. Throughout the rest of this section, AP stands for arithmetic progression.
Deï¬nition 21.23 Given an integer m > 1, we call a sequence (an)nâ‰¥1 an:
(a) AP of order 1 if it is an ordinary AP.
(b) AP of order m if the sequence (bn)nâ‰¥1, given for n â‰¥1 by bn = an+1 âˆ’an, is
an AP of order m âˆ’1.
The coming lemma characterizes APâ€™s of order m by means of a linear recurrence
relation that generalizes those satisï¬ed by APâ€™s of orders 1 and 2 (cf. Sections 3.1
and 3.3 of [8]).
Lemma 21.24 A sequence (an)nâ‰¥1 is an AP of order m if and only if
m + 1
0

an+m+1 âˆ’
m + 1
1

an+m + Â· Â· Â· + (âˆ’1)m+1
m + 1
m + 1

an = 0,
(21.8)
for every n â‰¥1.
Proof Firstly, let (an)nâ‰¥1 be an AP of order m. If m = 1, then (an)nâ‰¥1 is an ordinary
AP, and (21.8) reduces to an+2 âˆ’2an+1 + an = 0 for n â‰¥1, the linear recurrence
relation that characterizes ordinary APâ€™s.
By induction hypothesis, assume that (21.8) is valid for m = k âˆ’1. For m = k,
the sequence (bn)nâ‰¥1 given by bn = an+1 âˆ’an is, by deï¬nition, an AP of order
k âˆ’1. Therefore, the induction hypothesis gives
k
0

bn+k âˆ’
k
1

bn+kâˆ’1 + Â· Â· Â· + (âˆ’1)k
k
k

bn = 0
(21.9)
for every n â‰¥1, or
k
0

(an+k+1 âˆ’an+k) âˆ’
k
1

(an+k âˆ’an+kâˆ’1) + Â· Â· Â·
Â· Â· Â· + (âˆ’1)k
k
k

(an+1 âˆ’an) = 0
(21.10)

526
21
Linear Recurrence Relations
for every n â‰¥1; in turn, this is the same as
k
0

an+k+1 âˆ’
k
0

+
k
1

an+k +
k
1

+
k
2

an+kâˆ’1 âˆ’Â· Â· Â·
Â· Â· Â· + (âˆ’1)k

k
k âˆ’1

+
k
k

an+1 + (âˆ’1)k+1
k
k

an = 0.
(21.11)
By applying Stifelâ€™s relation, together with the facts that
k
0

=
k+1
0

and
k
k

=
k+1
k+1

, we get (21.8) for m = k.
Conversely, let (an)nâ‰¥1 be a sequence for which (21.8) holds. If m = 1, then
an+2 âˆ’2an+1 + an = 0 for n â‰¥1, and we already know that (an)nâ‰¥1 is an AP. By
induction hypothesis, suppose that the validity of (21.8) for m = k âˆ’1 implies that
(an)nâ‰¥1 is an AP of order kâˆ’1. Then, consider a sequence (an)nâ‰¥1 satisfying (21.8)
for m = k, i.e., such that
k + 1
0

an+k+1 âˆ’
k + 1
1

an+k + Â· Â· Â· + (âˆ’1)k+1
k + 1
k + 1

an = 0
for n â‰¥1. Using Stifelâ€™s relation to write
k+1
j

=
k
j

+
 k
jâˆ’1

for 1 â‰¤
j
â‰¤k, together with
k+1
0

=
k
0

and
k+1
k+1

=
k
k

, we successively reob-
tain (21.11), (21.10) and (21.9), for every n â‰¥1. Hence, the induction hypothesis
assures that (bn)nâ‰¥1 is an AP of order k âˆ’1, so that, by deï¬nition, (an)nâ‰¥1 is an AP
of order k.
âŠ“âŠ”
We are ï¬nally in position to present the promised application of Theorem 21.22.
Example 21.25 If (an)nâ‰¥1 is an AP of order m, then (21.8) holds for every n â‰¥1,
so that the characteristic polynomial of (an)nâ‰¥1 is
f (X) =
m + 1
0

Xm+1 âˆ’
m + 1
1

Xm + Â· Â· Â· + (âˆ’1)m+1
m + 1
m + 1

= (X âˆ’1)m+1.
Theorem 21.22 thus guarantees the existence of constants Î±0, Î±1, . . . , Î±m such that
an = Î±0 + Î±1(n âˆ’1) + Â· Â· Â· + Î±m(n âˆ’1)m
for every n â‰¥1. Evaluating the above relation for n = 1, we get Î±0 = a1; for n = 2,
. . . , m + 1, we obtain Î±1, . . . , Î±m as the solution to the linear system of equations
â§
âªâªâ¨
âªâªâ©
Î±1 + Î±2 + Â· Â· Â· + Î±m
= a2 âˆ’a1
2Î±1 + 22Î±2 + Â· Â· Â· + 2mÎ±m
= a3 âˆ’a1
Â· Â· Â·
Â· Â· Â·
mÎ±1 + m2Î±2 + Â· Â· Â· + mmÎ±m = am+1 âˆ’a1
.

21.3
The General Case
527
Notice that the fact that such a linear system always has a single solution is an
immediate consequence4 of the last part of the statement of Theorem 21.22.
Problems: Sect. 21.3
1. Let k be a given natural number and (an)nâ‰¥1 be a sequence of complex numbers
such that
an = 1
2(anâˆ’k + an+k),
for every natural number n > k. Show that
an =
k

j=1
(Aj + (n âˆ’1)Bj)Ï‰j(nâˆ’1)
for every n â‰¥1, where Ï‰ = cis 2Ï€
k and A1, . . . , Ak, B1, . . . , Bk are certain
complex constants.
2. Find all real sequences (an)nâ‰¥1 such that a1 = 1,
an+3 = 5an+2 âˆ’8an+1 + 4an
for every n â‰¥1 and an
2n
n
âˆ’â†’3.
4This also follows from basic Linear Algebra, for the transpose of the matrix of the coefï¬cients of
the linear system is a Vandermonde matrix of nonvanishing determinant.

Chapter 22
Hints and Solutions
Section 1.1
1. If there exists a bijection f : I1 â†’In, show that n = 1. Now, assume that
m, n > 1 and there exists a bijection f : Im â†’In. Letting k = f (m), show
that there exists a bijection g : In\{k} â†’Inâˆ’1, so that gâ—¦f|Imâˆ’1 : Imâˆ’1 â†’Inâˆ’1
is also a bijection. Then, use an inductive argument to deduce that mâˆ’1 = nâˆ’1.
2. If g : Im â†’A and h : In â†’B are bijections, deï¬ne f : Im+n â†’A âˆªB by
letting
f (k) =
g(k),
if 1 â‰¤k â‰¤m
h(k âˆ’m), if m + 1 â‰¤k â‰¤m + n .
Since g and h are surjective and m+1 â‰¤k â‰¤m+n if and only if 1 â‰¤kâˆ’m â‰¤n,
we conclude that f is also surjective. For the injectivity of f , suppose that
f (k) = f (l), with 1 â‰¤k, l â‰¤m + n. There are four cases to consider:
â€¢
1 â‰¤k, l â‰¤m: then f (k) = f (l) â‡’g(k) = g(l), and the injectivity of g
gives k = l.
â€¢
m + 1 â‰¤k, l â‰¤m + n: then f (k) = f (l) â‡’h(k âˆ’m) = h(l âˆ’m), and the
injectivity of h gives k âˆ’m = l âˆ’m, thus k = l.
â€¢
1 â‰¤k â‰¤m and m+1 â‰¤l â‰¤m+n: then f (k) = f (l) â‡’g(k) = h(lâˆ’m) âˆˆ
Aâˆ©B, a contradiction to the fact that A and B are disjoint. Therefore, in this
case it is always the case that f (k) Ì¸= f (l).
â€¢
m + 1 â‰¤k â‰¤m + n and 1 â‰¤l â‰¤m: as in the previous case, we always have
f (k) Ì¸= f (l).
Â© Springer International Publishing AG, part of Springer Nature 2018
A. Caminha Muniz Neto, An Excursion through Elementary Mathematics, Volume III,
Problem Books in Mathematics, https://doi.org/10.1007/978-3-319-77977-5_22
529

530
22
Hints and Solutions
3. By induction, if k < n and | âˆªk
j=1 Aj| = k
j=1 |Aj|, then
			âˆªk+1
j=1Aj
			 = |

âˆªk
j=1Aj

âˆªAk+1| =
			âˆªk
j=1Aj
			 + |Ak+1|
=
k

j=1
|Aj| + |Ak+1| =
k+1

j=1
|Aj|.
4. Letâ€™s make induction on |A| = |B|, the case |A| = |B| = 1 being trivial.
Suppose, by induction hypothesis, that the result is true when |A| = |B| = n,
for some n âˆˆN, and let A and B be such that |A| = |B| = n + 1. Given x âˆˆA
and a function f : A â†’B, let y = f (x). Then |A \ {x}| = |B \ {y}| = n and
f restricts to a function g : A \ {x} â†’B \ {y}. By the inductive hypothesis
g is injective if and only if itâ€™s surjective. However, since f is injective (resp.
surjective) if and only if g is injective (resp. surjective), it follows that f is
injective if and only if itâ€™s surjective.
5. If (a, b)
=
(c, d), then {{a}, {a, b}}
=
{{c}, {c, d}}. If a
=
b, then
{{a}, {a, b}} = {{a}, {a, a}} = {{a}, {a}} = {{a}}, so that {{c}, {c, d}} must
have just one element. Hence, c = d and {{a}} = {{c}}, so that a = c and then
a = b = c = d. The case a Ì¸= b can be treated analogously, and will be left to
the reader.
6. For the ï¬rst part, if B = B1 âˆª. . . âˆªBn, a âˆˆA and b âˆˆB, show that the ordered
pair (a, b) belongs to the left hand side if and only if it belongs to the right hand
side.
7. By induction, if k < n and |A1 Ã— Â· Â· Â· Ã— Ak| = 0k
j=1 |Aj|, then
|A1 Ã— Â· Â· Â· Ã— Ak Ã— Ak+1| = |(A1 Ã— Â· Â· Â· Ã— Ak) Ã— Ak+1|
= |A1 Ã— Â· Â· Â· Ã— Ak| Â· |Ak+1|
=
k
j=1
|Aj| Â· |Ak+1| =
k+1

j=1
|Aj|.
Now, observe that Proposition 1.6 deals with the initial case.
8. If A = {a1, . . . , an}, then, for a ï¬xed integer 1 â‰¤i â‰¤n, there are exactly
k possible choices for an index 1 â‰¤j â‰¤k such that ai âˆˆAj. Now, use the
fundamental principle of counting.
9. After n moves, the paws will be at a point (a, b) such that a = x1+x2+Â· Â· Â·+xn
and b = y1 + y2 + Â· Â· Â· + yn, where xi, yi âˆˆ{âˆ’1, 1} for 1 â‰¤i â‰¤n. Hence, we
have (i) âˆ’n â‰¤a, b â‰¤n and (ii) a and b have the same parity of n (this is, either
a and b are odd, if n is odd, or even, if n is even). Now, ï¬rst certify yourself
that any point (a, b) satisfying conditions (i) and (ii) can be a ï¬nal destination
of the pawn; then, use the fundamental principle of counting to show that there
are exactly (n + 1)2 of such points.

22
Hints and Solutions
531
10. For item (a), if (a1, . . . , ak) is such a sequence, then a1, . . . , ak âˆˆ{j, j +
1, . . . , n}, so that there are exactly nâˆ’j +1 possibilities for each ai; then, apply
the fundamental principle of counting. For item (b), observe that the set of the
wished sequences is the difference between the set of the sequences considered
in item (a) and the set of the sequences of k elements of In (possibly with
repetitions) such that the smallest term of the sequence is greater than or equal
to j + 1. Finally, by item (b) the sum of item (c) is equal to n
j=1 j((n âˆ’j +
1)k âˆ’(n âˆ’j)k); verify that such a sum equals 1k + 2k + Â· Â· Â· + nk.
11. For k â‰¥3, let I be an odd integer such that 1 â‰¤I â‰¤2kâˆ’1 âˆ’1. For each of
these Iâ€™s, let AI = {2tI âˆˆA}, so that
A =
2kâˆ’1âˆ’1

I=1
AI âˆª{2kâˆ’1 + 1, 2kâˆ’1 + 3, . . . , 2k âˆ’1},
with the index I varying over the set of odd integers from 1 to 2kâˆ’1 âˆ’1. From
this, conclude that if we wish a subset X âŠ‚A with the stated property to have
the greatest possible number of elements, then: (i) {2kâˆ’1+1, 2kâˆ’1+3, . . . , 2kâˆ’
1} âŠ‚X; (ii) for each odd integer 1 â‰¤I â‰¤2kâˆ’1 âˆ’1, at most half or âŒŠhalfâŒ‹+ 1
of the elements of AI can be in X. Then, reï¬ne the analysis in (ii), showing that
if a âˆˆN and I â‰¥3 is an odd integer satisfying 2a < I < 2a+1, then at most
âŒŠkâˆ’aâˆ’1
2
âŒ‹+ 1 elements of AI belong to X. From this, conclude that X has at
most
S = 2kâˆ’2 +
(k
2
)
+ 1 +
kâˆ’2

a=1
2aâˆ’1
(k âˆ’a âˆ’1
2
)
+ 1

elements. Finally, separately consider the cases k even and k odd to show that
S = 2k+1+(âˆ’1)k
3
.
Section 1.2
1. Exhibit a bijection from the family of the subsets of In containing n to the family
of subsets of Inâˆ’1.
2. For each x âˆˆA, show that there are 2n âˆ’1 ways of choosing the subsets Ai
which contain x.
3. The n straight lines pairwise intersect at
n
2

= n(nâˆ’1)
2
distinct points. Choose a
line r which is not parallel to any straight line passing through two of these
n
2

points. There are two kinds of regions: those which possess a highest point with
respect to râ€”which is necessarily one of the
n
2

points of intersection of two
of the n given linesâ€”and those which do not possess a highest point. Show that
there is a bijection between the regions of the ï¬rst kind and the set formed by the

532
22
Hints and Solutions
n
2

points; then, show that there are exactly n + 1 regions of the second kind, so
that the total number of regions is equal to n(nâˆ’1)
2
+ (n + 1).
4. For item (a), consider the family of subsets of In containing n. For item (b), let F
be an intersecting system in In and denote by Fc the family Fc = {Ac; A âˆˆF}.
Note that |Fc| = |F|, F âˆªFc = P(In) and show that F âˆ©Fc = âˆ….
5. For item (b), for 1 â‰¤i â‰¤n let ai be the number of sets in In which have i as
central element. Item (a) gives ai = an+1âˆ’i. Hence,
2

AâˆˆIn
c(A) =
n

i=1
iai +
n

i=1
(n + 1 âˆ’i)an+1âˆ’i
=
n

i=1
iai +
n

i=1
(n + 1 âˆ’i)ai
=
n

i=1
(n + 1)ai = (n + 1)
n

i=1
ai
= (n + 1)|In| = (n + 1) Â· 2nâˆ’1.
6. For item (a), start by showing that, for and integer 1 â‰¤k â‰¤n âˆ’1, there is
a bijection between the partitions of n having k as one of its summands and
the partitions of n âˆ’k. From this, conclude that the contribution of k to q(n)
equals p(n âˆ’k). For item (b), show that if k is the greatest possible diversity
of a partition, then n â‰¥1 + 2 + Â· Â· Â· + k, so that k <
âˆš
2n. Then, notice that
q(n) â‰¤kp(n).
Section 1.3
1. Show that there are exactly an+3 ways of writing n+4 as a sum of summands 1,
3 or 4, with at least one of these summands being equal to 1; make an analogous
reasoning to deal with an+1 and an.
2. For an integer n â‰¥3, let an be the number of diagonals of a convex n-gon, so
that a3 = 0. Let A1A2 . . . AkAk+1 be a convex (k+1)-gon, so that A1A2 . . . Ak
is a convex k-gon. Counting the number of diagonals of A1A2 . . . AkAk+1
departing from Ak+1, show that ak+1 = ak + k âˆ’1.
3. For item (a), consider a tiling of a 2 Ã— (k + 2) checkerboard, and look at the
possible ways of ï¬lling its upper right 1Ã—1 square with a domino. For item (b),
compute a1 = 1, a2 = 2 and, then, apply the results of Chapter 3 of [8].
4. Adapt, to the present case, the solution of Example 1.17.
5. For item (a), ï¬x an element x ofA and let Aâ€² = A\{x}. Start by showing that, if a
subset B of A has an even number of elements, then there are two possibilities:
(i) x /âˆˆB, so that B is a subset of Aâ€² with an even number of elements; (ii)

22
Hints and Solutions
533
x âˆˆB, so that B \ {x} is a subset of Aâ€² with an odd number of elements. Then,
show that the correspondence B â†’B \ {x} establishes a bijection between the
family of subsets of A which contain x and have an even (resp. odd) number of
elements and the family of subsets of Aâ€² with and odd (resp. even) number of
elements. For item (b), recall that an + bn = 2n.
6. More generally, let f (n, k) denote the number of ways of choosing k noncon-
secutive chairs out of a row of n chairs. Show that f (n, k) = f (n âˆ’2, k âˆ’1) +
f (n âˆ’1, k), then use such a recurrence to conclude that there are exactly 56
ways of choosing the three chairs.
7. For (a), assume we have k + 1 disks piled at the leftmost rod. We obviously
need at least ak movements to pile the k upper disks at the central rod; an extra
movement puts the larger disk at the rightmost rod; ï¬nally, at least more ak
movements move the k disks from the central to the leftmost rod. This amounts
to a total of at least 2ak + 1 movements, so that ak+1 = 2ak + 1. For (b), either
make induction on n or note that ak+1 +1 = 2(ak +1), taking into account that
a1 = 1.
8. For item (b), note that there are two kinds of partitions of In+1 into k + 1
nonempty, pairwise disjoint subsets: those in which {n + 1} is one of the sets
of the partitionâ€”there are exactly S(n, k) such partitionsâ€”and those in which
n + 1 belongs to a set of the partition having at least two elementsâ€”there are
exactly (k +1)S(n, k +1) such partitions. Note that item (c) asks us to compute
S(7, 3), for which we can use the recurrence relation of item (b), together with
the results of (a).
9. Let an denote the number of desired sequences, and bn the number of sequences
of n terms, all of which equal to 0, 1, 2 or 3 and having an odd number of 0â€™s.
Argue recursively to show that an = 3anâˆ’1 + bnâˆ’1 and bn = anâˆ’1 + 3bnâˆ’1 for
all n â‰¥2. Then conclude that ak+1 âˆ’6ak + 8akâˆ’1 = 0 for every k â‰¥2 and
compute a1 = 2, a2 = 1 + 32 = 10. Finally, apply the result of Problem 5,
page 79.
10. For item (a), use the fundamental principle of counting to show that there are
exactly 3 Â· 2nâˆ’1 ï¬‚ags with n strips, for every integer n â‰¥1. For item (b), start
by observing that a1 = 0 and a2 = 6; then, show that, for n â‰¥1, there is a
bijection between the set of ï¬‚ags with n + 1 strips in which the ï¬rst and last
strips have equal colors and the set of ï¬‚ags with n strips in which the ï¬rst and
last strips have distinct colors; ï¬nally, use the result of item (a). For item (c),
use the result of (b) to show that an+2 = an+1 + 2an for every n â‰¥1; then,
solve this recurrence relation.
11. For item (b), let A be a minimal selï¬sh subset of In containing n. Note that
1 /âˆˆA (for, otherwise, A wouldnâ€™t be minimal) and A Ì¸= {n}, In. We claim that
the set Aâ€² = (A\{n})âˆ’1 is a minimal selï¬sh subset of Inâˆ’2. To check this, note
ï¬rst that Aâ€² âŠ‚Inâˆ’2; on the other hand, |Aâ€²| = |A| âˆ’1 and, since |A| âˆˆA, we
have that |A| âˆ’1 âˆˆ(A âˆ’1) âŠ‚Aâ€². Thus, A is a selï¬sh subset of Inâˆ’2. In order
to show that Aâ€² is minimal, assume that there would exist Bâ€² âŠ‚Aâ€² such that
Bâ€² Ì¸= Aâ€² and Bâ€² was selï¬sh. Then, prove that B = (Bâ€² + 1) âˆª{n} âŠ‚A would
be a selï¬sh subset of In containing n. Use the minimality of A to conclude that

534
22
Hints and Solutions
B = A and, hence, that Bâ€² = Aâ€², which is an absurd. Analogously, given a
minimal selï¬sh subset B of Inâˆ’2, prove that (B + 1) âˆª{n} is a minimal selï¬sh
subset of In. For item (c), if an denotes the number of minimal selï¬sh subsets
of In, it follows from items (a) and (b) that an = anâˆ’1 + anâˆ’2 for every integer
n > 2. Now, verify that a1 = a2 = 1 and conclude that an = Fn for every
n â‰¥1.
12. For item (a), note that there are three distinct types of nonempty subsets of Y:
the nonempty subsets of X; the sets Aâˆª{m}, where A âŠ‚X is nonempty; the set
{m}. Then, write aY as a sum with three summands, each of them corresponding
to the subsets of one of these three types; while doing this, note that if A âŠ‚X
is nonempty, then Ï€(A âˆª{m}) = Ï€(A)m. Item (c) follows from (b), together
with a straightforward induction.
13. For item (a), adapt to the present case the hint given to the item (a) of the
previous problem. To this end, note that if âˆ…Ì¸= A âŠ‚X, then Ïƒ(A âˆª{m}) =
Ïƒ(A)+m and Ï€(Aâˆª{m}) = Ï€(A)m. Item (c) follows from item (b) by an easy
induction.
14. Let J0 = {1} and, for every natural k â‰¥1, let Jk = {2kâˆ’1 + 1, . . . , 2k}. Show
ï¬rst that, for every k, there exists a good set Bk âŠ‚{1, 2, 3, . . . , 2k} such that
|Bk| = bk and Jk âŠ‚Bk, i.e., Bk âˆ©Jk = Jk. Since Bk is good and Bk âˆ©Jk = Jk,
we must have Bk âˆ©Jkâˆ’1 = âˆ…. Now, let Xkâˆ’2 = Bk âˆ©{1, 2, 3, . . . , 2kâˆ’2}.
Clearly, every subset of a good set is also a good set; therefore, Xkâˆ’2 is good.
Conclude from this fact that bk â‰¤bkâˆ’2+2kâˆ’1. Then, taking a good subset Ykâˆ’2
of {1, 2, 3, . . . , 2kâˆ’2} and looking at Ykâˆ’2 âˆªJk, show that bk â‰¥bkâˆ’2 + 2kâˆ’1.
For item (b), use the recurrence relation of item (a), together with telescoping
sums (cf. Chapter 3 of [8]), to get bn = 2n+1+(âˆ’1)n
3
.
Section 1.4
2. For item (a), expand the products in (x + y)n = (x + y) . . . (x + y) (n factors
equal to x+y) and note that the monomial xnâˆ’kyk appears as many times as the
number of ways of choosing a subset of k elements from the set {1, 2, . . . , n}.
Then, generalize such an argument to get the result of item (b).
3. Let x1 = Â· Â· Â· = xk = 1 in (1.12).
4. Notice that each (nonordered) partition of a set A of n elements into k nonempty
subsets gives rise to k! ordered partitions of A into k nonempty subsets.
5. If aj is the only local maximum of a permutation (a1, a2, . . . , an) of In, then
aj = n. Now, show that a1 < Â· Â· Â· < ajâˆ’1 and aj+1 > Â· Â· Â· > an, so that it
sufï¬ces to choose the set {a1, . . . , ajâˆ’1}. Finally, observe that j may vary from
1 to n.
6. Show that each 6 of the n given points determine a single triangle satisfying the
given conditions.

22
Hints and Solutions
535
7. Firstly, show that the total number of subsets with an even number of elements
equals 
kâ‰¥0
 n
2k

. Then, use item (b) of Corollary 4.25 of [8].
8. If exactly 2k terms of the sequence are 0â€™s, show that there are exactly
 n
2k

3nâˆ’2k
sequences, so that the total number of them is 
kâ‰¥0
 n
2k

3nâˆ’2k. Now, note that

kâ‰¥0
 n
2k

3nâˆ’2k = 1
2

kâ‰¥0
 n
2k

3nâˆ’2k +

n
2k + 1

3nâˆ’2kâˆ’1
+ 1
2

kâ‰¥0
 n
2k

3nâˆ’2k âˆ’

n
2k + 1

3nâˆ’2kâˆ’1
= 1
2

(3 + 1)n + (3 âˆ’1)n
= 1
2

4n + 2n
.
9. Consider a sequence (a1, . . . , an+kâˆ’1) of n + k âˆ’1 terms, with k âˆ’1 of them
equal to 0 and the other n equal to 1, and let 1 â‰¤i1 < . . . < ikâˆ’1 â‰¤n âˆ’k + 1
be the indices of the former ones. There are x1 = i1 âˆ’1 â‰¥0 terms that come
before ai1 (which is the i-th one), x2 = i2 âˆ’i1 âˆ’1 â‰¥0 terms between ai1
and ai2, . . . , xk = (n âˆ’k + 1) âˆ’ikâˆ’1 â‰¥0 terms that come after aikâˆ’1. Since
all of these are equal to 1, and there are exactly n terms equal to 1, we get
x1 + Â· Â· Â· + xk = n. Thus, starting from a sequence (a1, . . . , an+kâˆ’1) as above,
we get a solution, in nonnegative integers, of the given equation. Conversely,
given a solution x1 = j1, . . . , xk = jk in nonnegative integers of the equation,
we can form a sequence (a1, . . . , an+kâˆ’1) as above, letting the terms of indices
j1 +1, j1 +j2 +2, j1 +j2 +Â· Â· Â·+jkâˆ’1 +(kâˆ’1) be equal to 0 and the remaining
ones be equal to 1. Therefore, by the bijective principle we only need to count
the total number of such sequences, which is rather simple: it sufï¬ces to choose
a subset of k âˆ’1 elements of the set of In+kâˆ’1 and, then, to impose that all the
terms corresponding to the chosen indices are equal to 0, while the remaining
ones are equal to 1. Proposition 1.26 gives
n+kâˆ’1
kâˆ’1

exactly different choices.
10. If yi = xi âˆ’1 for 1 â‰¤i â‰¤k, then yi â‰¥0 and y1 + Â· Â· Â· + yk = n âˆ’k. Now,
apply the result of the previous problem.
11. For item (a), if A = {a1, . . . , ak} âŠ‚In is a set without consecutive elements,
let x1 = a1 âˆ’1, xk+1 = n âˆ’ak and xj = aj âˆ’ajâˆ’1 âˆ’2 for 2 â‰¤j â‰¤k. Then,
xj â‰¥0 for 1 â‰¤j â‰¤k + 1, and
k+1

j=1
xj = (a1 âˆ’1) +
k

j=2
(aj âˆ’ajâˆ’1 âˆ’2) + (n âˆ’ak)
= (a1 âˆ’1) + (ak âˆ’a1 âˆ’2(k âˆ’1)) + n âˆ’ak
= n âˆ’2k + 1.

536
22
Hints and Solutions
For item (b), let a1 = x1 + 1 and aj = j
i=1 xi + 2(j âˆ’1) for 2 â‰¤j â‰¤k.
Then, a1 â‰¥1, aj âˆ’ajâˆ’1 â‰¥2 for 1 < j â‰¤k and
n âˆ’ak = n âˆ’
k

i=1
xi âˆ’2(k âˆ’1) = (n âˆ’2k + 1) âˆ’
k

i=1
xi + 1 = xk+1 + 1 â‰¥1;
hence, a solution of equation k+1
i=1 xi = nâˆ’2k+1 in nonnegative integers gives
rise to a k-element subset of In satisfying the conditions of Kaplanskyâ€™s ï¬rst
lemma. For item (c), the bijective principle, together with the results of items
(a) and (b), guarantees that it sufï¬ces to count how many are the nonnegative
integer solutions of equation x1 + Â· Â· Â· + xk+1 = n âˆ’2k + 1. This follows from
Problem 9, which shows that there are exactly
(nâˆ’2k+1)+k
k

=
nâˆ’k+1
k

such
solutions.
12. Letting A âŠ‚In be such a set, there are two possibilities: (i) 1 âˆˆA or (ii)
1 /âˆˆA. In case (i), A\{1} has k âˆ’1 elements, no consecutive elements and must
be contained in {3, 4, . . . , n âˆ’1}; apply Kaplanskyâ€™s ï¬rst lemma to conclude
that there are
nâˆ’kâˆ’1
kâˆ’1

such sets. In (ii), A can be any k-element subset of
{2, 3, . . . , n} without consecutive elements; apply Kaplanskyâ€™s ï¬rst lemma to
conclude that there are
nâˆ’k
k

such sets. Finally, add possibilities.
13. If A = {a1, . . . , ak} and f (aj) = xj, then (1.13) gives x1 +Â· Â· Â·+xk = n. Now,
apply the result of Problem 10.
14. Let A = {1, 3, 5, . . . , 2nâˆ’1} and B = {2, 4, 6, . . . , 2n}, so that I2n = AâˆªB, a
disjoint union. Let F be the family of subsets of I2n with equal numbers of even
and odd elements, and let P be the family of subsets of I2n with n elements.
Show that X â†’(X âˆ©A) âˆª(B \ X) establishes a bijection between F and P.
Then, conclude that |F| = |P| =
2n
n

.
15. For A âŠ‚Im, Problem 2, page 13, shows that there are (2n âˆ’1)|A| sequences
(A1, . . . , An) of subsets of Im such that A1âˆª. . .âˆªAn = A. Now, for 0 â‰¤k â‰¤m,
we know that Im has exactly
m
k

subsets A having k elements. Hence, letting S
denote the desired sum, we get
S =

AâŠ‚Im

A1âˆª...âˆªAn=A
|A1 âˆª. . . âˆªAn|
=

AâŠ‚Im
(2n âˆ’1)|A||A| =
m

k=0
m
k

(2n âˆ’1)kk
= m(2n âˆ’1)
m

k=1
m âˆ’1
k âˆ’1

(2n âˆ’1)kâˆ’1
= m(2n âˆ’1)[1 + (2n âˆ’1)]mâˆ’1
= m(2n âˆ’1)2n(mâˆ’1).

22
Hints and Solutions
537
16. Let (i, j) be an ordered pair of distinct integers chosen from 1, 2, . . . , n. Note
that there are (n âˆ’2)! permutations (a1, a2, . . . , an) of {1, 2, . . . , n} in which
a1 = i and a2 = j, and these contribute with (n âˆ’2)!(i âˆ’j)2 for the sum

Ïƒ SÏƒ. However, the same pair (i, j) gives this same contribution when ak =
i and ak+1 = j, for some k from 1 to n âˆ’1. Therefore, (i âˆ’j)2 appears
(n âˆ’1)(n âˆ’2)! = (n âˆ’1)! times in the sum 
Ïƒ SÏƒ. It thus follows that

Ïƒ
SÏƒ =

(i,j)
(n âˆ’1)!(i âˆ’j)2,
and the average value of SÏƒ equals
A = 1
n!

Ïƒ
SÏƒ = 1
n!

(i,j)
(n âˆ’1)!(i âˆ’j)2 = 1
n

(i,j)
(i âˆ’j)2.
In order to compute the last sum above, note that
1
n

(i,j)
(i âˆ’j)2 = 1
n
n

i=1
n

j=1
(i âˆ’j)2 = 1
n
n

i=1
n

j=1
(i2 + j2 âˆ’2ij)
= 1
n
â¡
â£
n

i=1
n

j=1
i2 +
n

i=1
n

j=1
j2 âˆ’2
n

i=1
n

j=1
ij
â¤
â¦
= 1
n
â¡
â£n
n

i=1
i2 + n
n

j=1
j2 âˆ’2
" n

i=1
i
# â›
â
n

j=1
j
â
â 
â¤
â¦
= 1
n
â¡
â£2n
n

i=1
i2 âˆ’2
" n

i=1
i
#2â¤
â¦
= 1
n
>
2nn(n + 1)(2n + 1)
6
âˆ’2
n(n + 1)
2
2?
= (n âˆ’1)n(n + 1)
6
=
n + 1
3

.
17. Fix one of the 2n + 1 given points, draw the diameter passing through it
and suppose that such a diameter leaves d of the remaining 2n points in one
semicircle, and the other 2n âˆ’d points in the other one. Use combinations to
conclude that the number of obtuse triangles having the ï¬xed point as one of
their vertices and an acute angle at this vertex equals d2 âˆ’2nd + 2n2 âˆ’n
(therefore, it is always greater than or equal to n(n âˆ’1)). Adding over the
2n + 1 given points, conclude that there are at least (2n + 1)
n
2

= 2n+1)n(nâˆ’1)
2

538
22
Hints and Solutions
obtuse triangles. Finally, deduce that the total number of acute triangles is at
most n(n+1)(2n+1)
6
.
18. Fixed 1 â‰¤i â‰¤n and 0 â‰¤j â‰¤min{i âˆ’1, n âˆ’i}, Proposition 1.26 gives exactly
iâˆ’1
j

ways of choosing j elements of In less than i and
nâˆ’i
j

ways of choosing
j elements of In greater than i. Hence, the additive and multiplicative principles
guarantee that i is the central element of

j
i âˆ’1
j
n âˆ’i
j

sets A âˆˆIn, with the above sum extending through all indices 0 â‰¤j â‰¤min{iâˆ’
1, n âˆ’i}. For the second equality of item (a), there are at least two possible
reasonings:
(i) Computing the coefï¬cient of xiâˆ’1 in both sides of the equality
(1 + x)iâˆ’1(1 + x)nâˆ’i = (1 + x)nâˆ’1
we get, with the aid of the binomial formula,

jâ‰¥0
i âˆ’1
j

n âˆ’i
n âˆ’i âˆ’j

=
n âˆ’1
i âˆ’1

.
(ii) If xk+1 = i and A = {x1, x2, . . . , x2k+1} is as above, write A = B âˆª
{xk+1} âˆªB, with B = {x1, . . . , xk} and B = {xk+2, . . . , x2k+1}; if Bâ€² =
{i + 1, i + 2, . . . , n âˆ’1, n} \ B, show that the correspondence
B âˆª{xk+1} âˆªB âˆ’â†’B âˆªBâ€²
establishes a bijection between In and the family of subsets of n âˆ’i
elements of In \ {i}. Since |In \ {i}| = n âˆ’1, use Proposition 1.26 to
conclude that i is the central element of
nâˆ’1
nâˆ’i

sets in In.
The rest of the proof follows immediately from the linesâ€™ theorem of Pascalâ€™s
triangle (cf. item (a) do Corollary 4.25 of [8]):

AâˆˆIn
c(A) =
n

i=1
n âˆ’1
i âˆ’1

i
= (n âˆ’1)
n

i=1
n âˆ’2
i âˆ’2

+
n

i=1
n âˆ’1
i âˆ’1

= (n âˆ’1) Â· 2nâˆ’2 + 2nâˆ’1 = (n + 1) Â· 2nâˆ’2.

22
Hints and Solutions
539
19. For item (a), if f does satisfy the given conditions, then it is clearly injective,
for f (x1) = f (x2) â‡’f (f (x1)) = f (f (x2)) â‡’x1 = x2. Now, it follows
from the result of Problem 4, page 7, that f is a bijection. Assume that f has k
ï¬xed points. Fix a âˆˆIn such that a is not one of them and let b = f (a). Then,
b Ì¸= a and f (b) = a. Thus, we can group the remaining n âˆ’k elements of In
(all but the ï¬xed points of f ) in pairs (a, b), with b = f (a) and a = f (b),
which implies that n âˆ’k must be even. For item (b), let 0 â‰¤k â‰¤n be such
that n âˆ’k is even. For each choice of k elements x1, . . . , xk âˆˆIn and for each
partition {{a1, b1}, . . . , {al, bl}} of the remaining n âˆ’k elements of In, there
obviously exists a single function f : In â†’In having x1, . . . , xk as its ï¬xed
points and satisfying f (ai) = bi and f (bi) = ai for 1 â‰¤i â‰¤l. Observe that
f (f (x)) = x for each x âˆˆIn. For item (c), once ï¬xed 0 â‰¤k â‰¤n such that
n âˆ’k is even, there are
n
k

ways of choosing k elements of In to be the ï¬xed
points of f . In turn, the number of ways of partitioning the remaining n âˆ’k
elements of In into disjoint 2-element sets is equal to
n âˆ’k âˆ’2
2

Â· Â· Â·
2
2

= (n âˆ’k)!
2(nâˆ’k)/2 .
Hence, the multiplicative and additive principles assure that the number of
functions we wish to count is equal to the given number.
20. Let |F| = k. To each A = {a, b, c} âˆˆF, associate its 2-element subsets {a, b},
{b, c} and {c, a}. The condition given in the statement of the problem assures
that each 2-element subset of In is associated to at most one of the sets A âˆˆF.
Thus, 3k â‰¤
n
2

, which gives us the desired inequality.
21. For each 1 â‰¤i â‰¤n, choose Bi âŠ‚Ai such that |Bi| = k. The assumption
|Ai âˆ©Aj| â‰¤k âˆ’1 for 1 â‰¤i < j â‰¤n guarantees that the correspondence
i â†’Bi is injective; indeed, if 1 â‰¤i < j â‰¤n are such that Bi = Bj = B,
then |Ai âˆ©Aj| â‰¥|B| â‰¥k. Now, {B1, . . . , Bn} is a family of pairwise distinct
m-element subsets of A, so that Proposition 1.26 gives n â‰¤
m
k

.
22. For 1 â‰¤k â‰¤n, we let mk denote the number of Piâ€™s which contain ak; conclude
that m1 + Â· Â· Â· + mn = 2n. If F is the family of sets {Pi, Pj} such that i Ì¸= j
and Pi âˆ©Pj Ì¸= âˆ…, use the given conditions to show that |F| = n
i=1
mi
2

.
Now, consider f : F â†’{P1, . . . , Pn} such that f = ({Pi, Pj}) = Pk, with
Pk = {ai, aj}; conclude that f is injective, so that
n

i=1
mi
2

â‰¤n
and, then m2
1 +Â· Â· Â·+m2
n â‰¤4n. Finally, use the inequality between the quadratic
and arithmetic means (cf. problem 5.2.3 of [8], for instance) to conclude that
m1 = Â· Â· Â· = mn = 2.

540
22
Hints and Solutions
Section 2.1
1. In each item through (a) to (d), evaluate the corresponding functions at x âˆˆA.
2. How many natural numbers from 1 to 1000 have a prime factor less than 10?
3. Use the result of Example 2.6, together with the fact that, since m < n, there is
no surjective function f : Im â†’In.
4. Let C1, . . . , Cn be the n couples, A be the set of distinct lines of 2n
people formed with the members of the given couples (and without further
restrictions), and Ai be the subset of A formed by those lines in which both
members of Ci occupy neighboring positions. We wish to count the number of
elements of A \ (A1 âˆª. . . âˆªAn). To this end, apply the inclusion-exclusion
principle, noting that |A| = (2n)! and |Ai1 âˆ©. . . âˆ©Aik| = (2n âˆ’k)!(2!)k for
1 â‰¤i1 < Â· Â· Â· < ik â‰¤n.
5. For 1 â‰¤j â‰¤5, let Pj be the set of permutations (a1, a2, . . . , a6) of I6 such that
(a1, . . . , aj) is a permutation of Ij. We wish to count |P \ 5
j=1 Pj|, where P
denotes the set of all permutations of I6. To this end, if 1 â‰¤i1 < Â· Â· Â· < ik â‰¤5,
conclude that
|Pi1 âˆ©. . . âˆ©Pik| = i1!(i2 âˆ’i1)! . . . (ik âˆ’ikâˆ’1)!(6 âˆ’ik)!
Finally, apply the inclusion-exclusion principle and compute the value of each
possible summand above.
6. Let A = {1 â‰¤m â‰¤n; gcd(m, n) = 1} and, for 1 â‰¤i â‰¤k, let Ai = {1 â‰¤m â‰¤
n; pi | m}. Then,In \ A = k
i=1 Ai and, in order to compute |A|, it sufï¬ces
to apply inclusion-exclusion. To this end, note that if 1 â‰¤i1 < Â· Â· Â· < ij â‰¤k
are integers, then m âˆˆAi1 âˆ©. . . âˆ©Aij if and only if pi1 . . . pij | m, so that
|Ai1 âˆ©. . . âˆ©Aij | =
m
pi1...pij .
7. Start by showing that, for q âˆˆN, the number of naturals less than or equal to
n and divisible by q equals
- n
q
.
. Then, let Aj = {a âˆˆN; a â‰¤n and pj |
a}, and notice that the number of primes less than or equal to n is given by
n âˆ’|A1 âˆª. . . âˆªAk|. Finally, apply inclusion-exclusion.
8. Let A denote the set of distinct partitions of n in natural summands and, for
1 â‰¤j â‰¤n, let Aj denote the subset of A formed by those partitions with at least
one summand equal to j. Then, p(n) = |A| and, for 1 â‰¤i1 < . . . < ik â‰¤n, it
is easily seen that |Ai1 âˆ©. . . âˆ©Aik| = p(n âˆ’l), where l = i1 + Â· Â· Â· + ik. Now,
note that A = A1 âˆª. . . âˆªAn and use inclusion-exclusion to get
p(n) =
n

k=1
(âˆ’1)kâˆ’1
n

l=1

1â‰¤i1<...<ikâ‰¤n
i1+Â·Â·Â·+ik=l
p(n âˆ’l).
Finally, on the one hand, the last summand has exactly pk(l) summands; on the
other, 1 â‰¤i1 < . . . < ik â‰¤n and i1 + Â· Â· Â· + ik = l imply

22
Hints and Solutions
541
n â‰¥l â‰¥1 + 2 + Â· Â· Â· + k = k(k + 1)
2
> k2
2
and, hence, k <
âˆš
2n and l > k2
2 .
9. Let A be the set of solutions (x1, . . . , xn) of the given equation, with xt âˆˆZ+
for 1 â‰¤t â‰¤n. For 1 â‰¤i â‰¤n, let Ai be the subset of A formed by those
solutions (x1, . . . , xn) in which xi > k. We wish to count |A\(A1 âˆª. . .âˆªAn)|;
to this end, apply inclusion-exclusion, recalling (cf. Problem 9, page 29) that
|A| =
m+nâˆ’1
nâˆ’1

and showing that
|Ai1 âˆ©. . . âˆ©Aij | =
m âˆ’j(k + 1) + n âˆ’1
n âˆ’1

for 1 â‰¤i1 < Â· Â· Â· < ij
â‰¤n. For this last computation, observe that
(x1, . . . , xn) âˆˆAi1 âˆ©. . . âˆ©Aij if and only if xi1, . . . , xij â‰¥k + 1; hence,
letting yt = xt for t Ì¸= i1, . . . , ij and yil = xil âˆ’(k +1) for 1 â‰¤l â‰¤j, we have
y1, . . . , yn â‰¥0 and y1 + Â· Â· Â· + yn = m âˆ’j(k + 1); now, apply once more the
result of Problem 9, page 29.
10. For the ï¬rst part of (a), note that there are 2 ways of choosing n pairwise
nonadjacent chairs, and after that there are n! ways of distributing the men
in them. For (c), note that if A2iâˆ’1 âˆ©A2i was not empty, then wi should
simultaneously sit in chairs i âˆ’1 and i; also, if A2i âˆ©A2i+1 was not empty,
then wi and wi+1 should both sit in chair i. Item (d) follows from the fact that,
for every intersection of the form Ai1 âˆ©Ai2 âˆ©. . .âˆ©Aik, exactly k of the n women
have their positions entirely determined, whereas the n âˆ’k remaining ones can
be permuted in any desired way. Finally, for (f) apply the inclusion-exclusion
principle.
Section 2.2
1. Explicitly write the summands at both sides.
2. Note that both sides count the number of subsets of a set having n elements.
3. Adapt, to the present case, the idea used in the proof of Example 2.9.
4. Start by choosing k odd elements and k even elements; then, use Lagrangeâ€™s
identity.
5. Let P1, P2, . . . , P11 be the patrols and h1, h2, . . . , hn be the volunteers. Deï¬ne
a function
f : {h1, . . . , hn} â†’{{Pi, Pj}; 1 â‰¤i < j â‰¤11}
by letting
f (hi) = {Pj, Pk} â‡”hi enters Pj and Pk.

542
22
Hints and Solutions
The conditions given immediately assure that f is a bijection, so that there are
as many volunteers as 2-element subsets of the set of the 11 patrols. Thus, there
are n =
11
2

= 55 volunteers. Now, let A be the set of ordered pairs (hi, Pj)
such that hi âˆˆPj. Since each of the 55 men enters exactly two patrols, A has
exactly 2 Â· 55 = 110 pairs. On the other hand, if k is the number of members in
each patrol, then Pj is the second entry of exactly k ordered pairs in A (those
whose ï¬rst entries are the k members of Pj); however, since there are precisely
11 patrols, it follows that A has 11k ordered pairs. Therefore, 11k = 110 and,
hence, k = 10.
6. Show that both sides of the desired equality count the total number of ï¬xed
points of all permutations of In.
7. Let a1, a2, . . . , am be the initial terms of the arithmetic progressions, and n >
a1, . . . , am a natural number. Letâ€™s count the number of elements of In in two
different ways, the obvious one being |In| = n. For the other one, assume that
the arithmetic progression of initial term ai and common ratio di has exactly ki
terms in In, so that m
i=1 di = n and ai + (ki âˆ’1)di â‰¤n < ai + kidi or, which
is the same,
n âˆ’ai
di
< ki < n âˆ’ai
di
+ 1.
Adding all such inequalities for 1 â‰¤i â‰¤m, we conclude that
m

i=1
n âˆ’ai
di
< n <
m

i=1
n âˆ’ai
di
+ m
or, which is the same,
m

i=1
1
di
âˆ’1
n
m

i=1
ai
di
< 1 <
m

i=1
1
di
âˆ’1
n
m

i=1
ai
di
+ m
n .
Finally, let n â†’+âˆto get m
i=1
1
di = 1.
8. Associate 0 or 1 to each line segment which is a side of a smaller triangle,
according to whether its vertices have equal or distinct labels, respectively;
then, associate to each smaller triangle the sum of the numbers associated to
its three sides. Now, observe that the number associated to any smaller triangle
is equal to 0, 2 or 3, being equal to 3 if and only if the corresponding triangle
is labelled as ABC. Finally, use double counting to show that the sum of the
numbers associated to the smaller triangles is always odd.
9. Let x denote the desired number of commissions and y the total number of the
remaining ones. Firstly, note that x + y = 4060. Now, ï¬x an arbitrary senator
and show that he/she enters exactly 268 commissions in which the other two
members are both his/her friends or enemies. Finally, use double counting to
conclude that 3x + y = 30 Â· 268.
10. Let A1A2 . . . An be the n-gon, AnA2 âˆ©A1A3 = {X} and A2A4 âˆ©A3A5 = {Y};
choose the following n âˆ’2 points: a point B in the interior of A1A2X, a point

22
Hints and Solutions
543
C in the interior of A3A4Y and, for 5 â‰¤j â‰¤n, a point in the interior of
A2A3Aj âˆ©Ajâˆ’1AjAj+1. With the aid of the fundamental principle of counting,
show that the total number of triangles formed by three vertices of the n-gon
and containing one of the chosen points is equal to
2(n âˆ’2) +
n

j=5
(j âˆ’3)(n âˆ’j + 2) =
n
3

.
Section 2.3
1. For item (a), we leave to the reader the task of showing that âˆ¼is symmetric. For
the reï¬‚exivity, let a âˆˆA be given; since F is a partition of A, there exists B âˆˆF
such that a âˆˆB. Therefore, a, a âˆˆB or, which is the same, a âˆ¼a. Now, let
a, b, c âˆˆA be such that a âˆ¼b and b âˆ¼c. There exist B, C âˆˆF such that
a, b âˆˆB and b, c âˆˆC. However, since F is a partition of A and B âˆ©C Ì¸= âˆ…(for,
b âˆˆB âˆ©C), we conclude that B = C; therefore, a âˆ¼c. Finally, for a âˆˆA, take
the set B âˆˆF for which a âˆˆB. Then,
a = {x âˆˆA; x âˆ¼a} = {x âˆˆA; x, a âˆˆC, âˆƒC âˆˆF}.
Invoking once more the fact that F is a partition of A, we conclude that B is the
only element of F to which a does belongs. Thus,
a = {x âˆˆA; x âˆˆB} = B.
The analysis of item (b) is quite similar to that of (a) and will also be left to the
reader; we notice that, in this case, if B is a ï¬nite set, then there are exactly |B|
distinct equivalence classes.
2. A âˆ¼A, for A = A + 0 modulo 3. If A âˆ¼B, with B = A + j modulo 3, then
B âˆ¼A, with A = B + (3 âˆ’j) modulo 3. Finally, if A âˆ¼B and B âˆ¼C, with
B = A + i modulo 3 and C = B + j modulo 3, show that C = A + k modulo
3, where 0 â‰¤k â‰¤2 is such that i + j â‰¡k (mod 3).
3. If the involved sets were to be chosen in a speciï¬c order, then there would be
exactly
 ab
b,...,b

= (ab)!
(b!)a distinct ways of partitioning the set as prescribed. Since
the choice is actually unordered, we have to divide by a!.
4. For item (b), use the result of (a), together with Proposition 2.16 and the
deï¬nition of Stirling numbers of second kind. For item (c), use the result of (b),
together with that of Example 2.6.
5. Firstly, note that there are exactly mp âˆ’m non monochromatic sequences of
p beads, each bead being of one of the m given colors. Apply the equivalence
relation (2.16) to such sequences (with p in place of n) to conclude that there are
exactly mpâˆ’m
p
distinct and non monochromatic necklaces. Since there are exactly

544
22
Hints and Solutions
m monochromatic necklaces, there is nothing left to do in order to establish the
ï¬rst part. For the second part, it follows from the ï¬rst that p divides mp âˆ’m =
m(mpâˆ’1 âˆ’1), for every m âˆˆN. It now sufï¬ces to assume that p âˆ¤m, using the
remarks that precede the statement of the problem to conclude that p | (mpâˆ’1 âˆ’
1).
6. In the set F of aperiodic sequences of size n, let âˆ¼be the relation deï¬ned
by setting (x1, x2, . . . , xn) âˆ¼(y1, y2, . . . , yn) if and only if there exists 0 â‰¤
k â‰¤n âˆ’1 such that yi = xi+k (mod n), for 1 â‰¤i â‰¤n. Show that âˆ¼is
an equivalence relation, with respect to which each equivalence class contains
exactly n sequences. Then, apply the result of Proposition 2.18.
7. Apply BollobÃ¡sâ€™ theorem, together with the fact that

n
âŒŠn/2âŒ‹

is the largest
binomial number with numerator equal to n.
8. For the ï¬rst part of (a), show more generally (by induction, for instance) that if
f (m) = Id for some m âˆˆN, then f is injective, hence bijective (thanks to the
result of Problem 4, page 7). The second part of (a) follows from the associativity
of composition, together with the fact that f (j) is a bijection for every j âˆˆZ (so
that a = f (j)(b) â‡’b =

f (j)âˆ’1(a) = f (âˆ’j)(a)). For the ï¬rst part of (b), let
a = {. . . , f (âˆ’2)(a), f (âˆ’1)(a), a, f (a), f (2)(a), . . .}
be an equivalence class of âˆ¼with more than one element, so that f (a) Ì¸= a. If
j > 1 is the smallest integer such that f (j)(a) = a (by assumption, f (p)(a) = a,
thus such a j does exist), write p = jq + r, with 0 â‰¤r < p, and use the
minimality of j to conclude that r = 0; then, show that j = p. Conclude
that a = {a, f (a), f (2)(a), . . . , f (pâˆ’1)(a)}. The second part of (b) now follows
from the ï¬rst part, together with the fact that the equivalence classes form a
partition of In. Item (c) follows from the fundamental principle of counting,
together with the fact that, given pairwise distinct elements a1, a2, . . . ap âˆˆIn,
there are exactly (p âˆ’1)! possibilities for the restriction of f to {a1, a2, . . . ap},
such that f ({a1, a2, . . . ap}) = {a1, a2, . . . ap} and none of a1, a2, . . . ap is a
ï¬xed point. Indeed, in this case there exists a âˆˆIn for which {a1, a2, . . . ap} =
{a, f (a), . . . , f (pâˆ’1)(a)}; however, since f (p)(a) = a, the number of desired
bijections from {a1, a2, . . . ap} to itself amounts to the number of circular
permutations of these numbers, i.e., (pâˆ’1)!. Finally, for (d), once ï¬xed an integer
0 â‰¤k â‰¤n such that p | (n âˆ’k), there are
n
k

ways of choosing k elements of
In to be the ï¬xed points of f . In turn, the number of ways of partitioning the
remaining n âˆ’k elements of In into disjoint p-element sets is equal to
n âˆ’k
p

Â·
n âˆ’k âˆ’p
p

Â· Â· Â·
p
p

= (n âˆ’k)!
p(nâˆ’k)/p .
Hence, the multiplicative and additive principles assure that the number of
functions we wish to count equals the given number.

22
Hints and Solutions
545
9. For item (a), show that if A, B âŠ‚In are distinct subsets with k > n
2 elements
each, then A âˆ©B Ì¸= âˆ…. For item (b), take F as the family of subsets of In formed
by the k-element subsets of In which contain n. For item i., ï¬x A âˆˆF compatible
with Ïƒ; we can assume, without loss of generality, that A = {a1, . . . , ak} and
Ïƒ = (a1, . . . , ak, ak+1, . . . , an). Group the remaining k-element subsets of In
which intersect A and are compatible with Ïƒ in appropriate pairs. Then, use the
fact that F is an intersecting family to conclude that there are at most other
k âˆ’1 sets in F which are still compatible with Ïƒ. For ii. assume, without loss
of generality, that A = {x1, . . . , xk} and Ïƒ = (a1, . . . , ak, ak+1, . . . , an), with
{x1, . . . , xk} = {a1, . . . , ak}. Finally, for iii. use double counting.
Section 2.4
1. Let Sn be the set of sequences a = (a1, . . . , an), with ai âˆˆ{0, 1} for 1 â‰¤i â‰¤n,
and P(n) be the family of parts of In. For a âˆˆSn, let f (a) âˆˆP(n) be given by
f (a) = {1 â‰¤i â‰¤n; ai = 1}. Now, check that the function f : Sn â†’P(n)
thus deï¬ned is a bijection that preserves metrics, in the following sense: if d is
the Hamming metric in Sn and dâ€² is the metric of symmetric difference in P(n),
then d(a, b) = dâ€²(f (a), f (b)) for all a, b âˆˆSn.
2. Use the hypotheses to show that T
= 
xâˆˆS B(x; 3), a disjoint union, and
|B(x; 3)| =
n
0

+
n
1

+
n
2

+
n
3

for every x âˆˆS. Then, conclude from
(b) that |B(x; 3) âˆ©S| = 1 for each x âˆˆT and, letting k =
n+1
2 , show that
3 Â· 2kâˆ’2 = k(2k2 âˆ’3k + 4). In order to solve such an equation, start by showing
that 3 | k; then, write k = 3l and conclude that l â‰¤4 and, hence, l = 4, k = 12
and n = 23.
3. Adapt, to the present case, the discussion of Example 2.29 and the hint given to
Problem 20, page 32.
4. Let P(n) be the family of subsets of In, furnished with the metric of symmetric
difference. Show that, for 1 â‰¤i â‰¤k, the balls B(Ai; r) are pairwise disjoint.
Then, use (2.20), together with the fact that B(A1; r) âˆª. . . âˆªB(Ak; r) âŠ‚P(n).
5. Firstly, if A and B are the sets of members of two of the 1997 subcommittees,
note that the set of people who participate of exactly one of these subcommittees
is AB, so that |AB| â‰¥5. Now, apply the result of the previous problem.
6. Let x1, . . . , xn be the sequences in the dictionary and d the Hamming metric
(with 0 standing for big and 1 standing for small). Show that
|B(x1; 4) âˆª. . . âˆªB(xn; 4)| = 224.
Moreover, for 1 â‰¤i < j â‰¤n, if x âˆˆB(xi; 4) âˆ©B(xj; 4), show that d(x; xi) =
d(x; xj) = 4 and d(xi; xj) = 8. Use this fact to show that x belongs to at most
six of the balls B(xi; 4) and, then, conclude that

546
22
Hints and Solutions
|B(x1; 4) âˆª. . . âˆªB(xn; 4)| â‰¤
24
0

+
24
1

+
24
2

+
24
3

+ 1
6
24
4

n
= 4096n.
Section 3.1
1. Termwise differentiate both sides of (3.2) and, then, substitute x = 1. Note that
Theorem 3.4 justiï¬es such a procedure.
2. For item (a), argue as was done for the Fibonacci sequence. For items (b) and (c),
apply the result of (a), together with (3.4).
Section 3.2
1. Make induction on k â‰¥2, the initial case k = 2 being given by Proposition 3.3.
2. Apply Theorem 3.4 k âˆ’1 times, starting from
1
1âˆ’x = 
nâ‰¥0 xn. Alternatively,
expand (1 âˆ’x)âˆ’k with the aid of the binomial series.
3. For item (c), it follows from (b) and from (3.5) that gâ€²(x) = 
nâ‰¥1(âˆ’x)nâˆ’1 =
1
1+x for |x| < 1. Hence, f â€²(x) = gâ€²(x) and f (0) = g(0), so that f (x) = g(x)
for |x| < 1.
4. For item (b), it follows from the Fundamental Theorem of Calculus that

nâ‰¥0
an
n + 1xn+1 = F(x) =
$ x
0
F â€²(t)dt
=
$ x
0
f (t)dt =
$ x
0

nâ‰¥0
antndt.
5. Start by showing that, if q > |a1|, âˆš|a2|, x0, where x0 = 1
2

|u| +
:
u2 + 4|v|

,
then |an|
â‰¤
qn for every n
â‰¥
1. Fix such a q and conclude that the
generating function 
kâ‰¥1 akxk converges in the interval

âˆ’1
q , 1
q

, thus deï¬ning
a differentiable function f :

âˆ’1
q , 1
q

â†’R by f (x) = 
kâ‰¥1 akxk. Use the
recurrence relation satisï¬ed by the sequence (ak)kâ‰¥0 to write
f (x) =

kâ‰¥1
akxk = a1x + a2x2 +

kâ‰¥3
akxk
= a1x + a2x2 +

kâ‰¥3
(uakâˆ’1 + vakâˆ’2)xk
= a1x + a2x2 + ux

kâ‰¥3
akâˆ’1xkâˆ’1 + vx2 
kâ‰¥3
akâˆ’2xkâˆ’2
= a1x + a2x2 + ux(f (x) âˆ’a1x) + vx2f (x).

22
Hints and Solutions
547
Conclude that
f (x) = a1x + (a2 âˆ’ua1)x2
(1 âˆ’Î±x)(1 âˆ’Î²x)
for |x| < min{ 1
q , 1
|Î±|, 1
|Î²|}, where Î± and Î² are the roots of x2 âˆ’ux âˆ’v = 0. If
Î± Ì¸= Î², show that there exist unique real constants A and B for which f (x) =
Ax
1âˆ’Î±x +
Bx
1âˆ’Î²x . Then, expand
1
1âˆ’Î±x and
1
1âˆ’Î²x in geometric series to get
f (x) =

kâ‰¥1
(AÎ±kâˆ’1 + BÎ²kâˆ’1)xk.
Finally, compare this last expression with the fact that f (x) = 
kâ‰¥1 akxk to
obtain ak = AÎ±kâˆ’1 + BÎ²kâˆ’1, for every k â‰¥1. If Î± = Î², argue similarly. This
problem is the content of Theorem 11.45 of [8]; further details can be found
there.
6. Use the formula for the number of derangements of In, together with (3.8) and
the triangle inequality to get
			dn âˆ’n!
e
			 = n!
			

k>n
(âˆ’1)k
k!
			 â‰¤n!

k>n
1
k!.
Then, estimate
			dn âˆ’n!
e
			 =
n!
(n + 1)!

1 +
1
n + 2 +
1
(n + 2)(n + 3) + Â· Â· Â·

<
1
n + 1

1 +
1
n + 2 +
1
(n + 2)2 + Â· Â· Â·

=
1
n + 1 Â· n + 2
n + 1 < 1
n.
Section 3.3
1. Letting f (x) = 
kâ‰¥1 akxk, we get
f (x) =

kâ‰¥1
akxk = x

kâ‰¥1
akxkâˆ’1 = x

kâ‰¥0
ak+1xk
= 2x + x

kâ‰¥1
(ak + (k + 1))xk
= 2x + xf (x) + x

kâ‰¥1
(k + 1)xk
= 2x + xf (x) + xgâ€²(x),

548
22
Hints and Solutions
with g(x) = 
kâ‰¥1 xk =
x
1âˆ’x for |x| < 1. Use such a relation to obtain a closed
expression for f (x), valid for |x| < 1, expand this expression as a power series
and obtain the desired formula for ak as a function of k.
2. For item (b), we have
f (x) = 1 +

nâ‰¥1
anxn = 1 +

nâ‰¥0
an+1xn+1
= 1 +

nâ‰¥0
(2an + n)xn+1
= 1 + 2xf (x) +

nâ‰¥0
(n + 2)xn+1 âˆ’2

nâ‰¥0
xn+1
= 1 + 2xf (x) + gâ€²(x) âˆ’2g(x),
with g(x) =
x
1âˆ’x . For (c), reduce the sum at the right hand side to a single
denominator and, then, compare the coefï¬cients of the numerators at both sides
to obtain a linear system of equations in A, B and C. Finally, for item (d), use
the result of Problem 2, page 78.
3. We want to compute the coefï¬cient of xm in the product
f (x) = (x + x2 + Â· Â· Â· ) . . . (x + x2 + Â· Â· Â· ),
with k factors x + x2 + Â· Â· Â· =
x
1âˆ’x (for |x| < 1).
4. We want to compute the coefï¬cient of x20 in the product
(1 + x + x2 + Â· Â· Â· )(x2 + x3 + Â· Â· Â· )(1 + x + x2 + Â· Â· Â· )(1 + x + x2 + Â· Â· Â· + x7).
Letting f (x), for |x| < 1, denote the above expression, we have
f (x) = x2(1 + x + x2 + Â· Â· Â· )3(1 + x + x2 + Â· Â· Â· + x7)
= (x2 + x3 + x4 + Â· Â· Â· + x9) Â·
1
(1 âˆ’x)3 .
Now, use the result of Problem (2), page 78.
5. For (a) and the ï¬rst part of (b), apply the multiplicative and additive principles.
For the coming problem, the reader may ï¬nd it convenient to read again the
paragraph that precedes Example 1.15.
6. For item (a), start by observing that if
n = 1 + 1 + Â· Â· Â· + 1



k summands
+ 2 + 2 + Â· Â· Â· + 2



l summands
+ 3 + 3 + Â· Â· Â· + 3



m summands
,

22
Hints and Solutions
549
then n = k + 2l + 3m; conversely, any such expression for n gives rise to a
partition of n in which no summand exceeds 3. Now, note that if n = k+2l+3m,
then xn = xk Â· x2l Â· x3m, and hence (setting a0 = 1)

nâ‰¥1
anxn =
 
kâ‰¥0
xk 
lâ‰¥0
x2l 
mâ‰¥0
x3m
=
1
1 âˆ’x Â·
1
1 âˆ’x2 Â·
1
1 âˆ’x3 .
if |x| < 1. Item (b) can be solved by multiplying both sides by (1âˆ’x)(1âˆ’x2)(1âˆ’
x3), expanding and comparing coefï¬cients of equal powers of x; the answers are
a = 1
6, b = c = 1
4 and d = 1
3. Finally, for item (c), insert the values of a, b,
c and d in the right hand side of the equality of item (b) and use (3.1), together
with the result of Problem 2, page 78, to get
1
1 âˆ’x2 =

kâ‰¥0
x2k,
1
1 âˆ’x3 =

kâ‰¥0
x3k,
1
(1 âˆ’x)3 =

nâ‰¥0
n + 2
2

xn, and
1
(1 âˆ’x)2 =

nâ‰¥0
(n + 1)xn.
Then, look separately at each of the cases 6 | n, 2 | n but 3 âˆ¤n, 2 âˆ¤n but 3 | n,
2 âˆ¤n and 3 âˆ¤n.
6. Letting d0 = d1 = 0, item (d) follows from
f â€²(x) =

nâ‰¥2
dn
(n âˆ’1)!xnâˆ’1
=

nâ‰¥2
(n âˆ’1)dnâˆ’1
(n âˆ’1)!
xnâˆ’1 +

nâ‰¥2
(n âˆ’1)dnâˆ’2
(n âˆ’1)!
xnâˆ’1
= x + x

nâ‰¥2
(n âˆ’1)dnâˆ’1
(n âˆ’1)!
xnâˆ’2 + x

nâ‰¥2
dnâˆ’2
(n âˆ’2)!xnâˆ’2
= x + xf â€²(x) + xf (x).
Item (e) follows the fact that
f â€²(x)
f (x)+1 =
d
dx log

f (x)+1

. Finally, for (f) integrate
the equality in (e).
8. For item (a), the number of ways of choosing the 2a0 positions of the 0â€™s, the a1
positions of the 1â€™s etc is equal to
 n
2a0
n âˆ’2a0
a1
n âˆ’2a0 âˆ’a1
a2
n âˆ’2a0 âˆ’a1 âˆ’a2
a3

=
n!
(2a0)!a1!a2!a3!.

550
22
Hints and Solutions
Item (b) amounts to noticing that

nâ‰¥0
sn
n!xn =

nâ‰¥1

1
(2a0)!a1!a2!a3! xn
=
 
a0â‰¥0
x2a0
(2a0)!
 
a1â‰¥0
xa1
a1!
 
a2â‰¥0
xa2
a2!
 
a3â‰¥0
xa3
a3!

=

1 + x2
2! + x4
4! + Â· Â· Â·

1 + x
1! + x2
2! + Â· Â· Â·
3
.
For (c), start by observing that
ex + eâˆ’x =

kâ‰¥0
xk
k! + (âˆ’x)k
k!

= 2

jâ‰¥0
x2j
(2j)!,
so that
f (x) = 1
2

ex + eâˆ’x
(ex)3 = 1
2

e4x + e2x
.
Finally, expand e4x and e2x in power series and compare the result with 
nâ‰¥0
sn
n!
to ï¬nish the problem.
Section 4.1
1. Divide the given square into four small squares of side 1 each, and let them
play the role of pigeonholes. Then, notice that the length of the diagonals of
each small square is precisely
âˆš
2.
2. Divide the cube into 93 = 729 small cubes, each of which having edge length
equal to 10
9 . Such small cubes will be the pigeonholes, and have diagonals of
length 10
âˆš
3
9
, with 10
âˆš
3
9
< 2.
3. Let the pigeonholes be the intervals
%
l
n, l+1
n

, with 0 â‰¤l < n, and the pigeons
be the fractionary parts1 of the numbers kx, with 1 â‰¤k â‰¤n âˆ’1. Note that if
{kx} âˆˆ[0, 1
n) âˆª[ nâˆ’1
n , 1), for some integer 1 â‰¤k â‰¤n âˆ’1, then there is nothing
left to do. Else, {kx} âˆˆnâˆ’2
l=1 [ l
n, l+1
n ) for 1 â‰¤k â‰¤n âˆ’1, and it sufï¬ces to
apply the pigeonhole principle.
1Recall that the fractionary part of x âˆˆR is the real number {x}, given by {x} = x âˆ’âŒŠxâŒ‹. In
particular, note that {x} âˆˆ[0, 1), with {x} = 0 if and only if x âˆˆZ.

22
Hints and Solutions
551
4. By contraposition, if a1 â‰¤m, a2 â‰¤m, . . . , an â‰¤m, then
a1 + a2 + Â· Â· Â· + an
n
â‰¤n Â· m
n
= m.
The other case is entirely analogous.
5. Let us argue as in the previous problem: since each number is a summand of
ï¬ve sums of ï¬ve consecutive numbers (around the circle), the total sum of all
possible sums of ï¬ve consecutive numbers equals
(1 + 15) Â· 15
2
Â· 5 = 40 Â· 15.
Since there are 15 sums of ï¬ve consecutive numbers, the average value of each
one of the is 40Â·15
15
= 40. Therefore, by the result of the previous problem, at
least one of these 15 sums is greater than or equal to 40.
6. Apply the result of Problem 4, counting the total number of color matchings of
corresponding sectors in disks A and B, in each of the 200 possible matching
positions.
7. Consider the 51 sets {0}, {1, 99}, {2, 98}, . . . , {49, 51}, {50}. Since there
are exactly 100 possible remainders upon division of an integer by 100 (the
remainder varies from 0 to 99), the pigeonhole principle guarantees that at least
two of the 52 given numbers have remainders belonging to a single one of these
51 sets. Therefore, either their sum or their difference leaves remainder 0 upon
division by 100.
8. Letting n be a given natural number, take as pigeons the n + 1 numbers 1, 11,
111, . . ., 11 . . . 1 (this last one with exactly n + 1 digits 1). Let the pigeonholes
be the remainders upon division by n, i.e., 0, 1, . . . , n âˆ’1.
9. Given a natural number n, adapt the hint given to the previous problem to show,
with the aid of the pigeonhole principle, that n has multiples of the forms a =
33 . . . 300 . . . 0 and b = 77 . . . 700 . . . 0. Then, show that it is possible to choose
m âˆˆN such that either a + 10mb or 10ma + b has odd sum of digits.
10. Condition gcd(a, n) = 1 assures that none of the given powers of a is divisible
by n. Thus, we can distribute them in boxes labelled from 1 to n âˆ’1, according
to their remainders upon division by n. If box 1 does contain at least one of the
given powers, there is nothing left to do; otherwise, the n âˆ’1 given powers of
a shall be allocated among n âˆ’2 boxes with labels varying from 2 to n âˆ’1. By
pigeonholeâ€™s principle, there exists 2 â‰¤k â‰¤n âˆ’1 such that the box labelled k
contains at least two distinct powers of a, say ai and aj, with 1 â‰¤i < j â‰¤nâˆ’1.
Then, we have ai = ns + k and aj = nt + k, for some s, t âˆˆZ, and it follows
that
ai(ajâˆ’i âˆ’1) = aj âˆ’ai = n(t âˆ’s).
Therefore, n | ai(ajâˆ’i âˆ’1) and, since gcd(n, ai) = 1, we conclude that n |
(ajâˆ’i âˆ’1).

552
22
Hints and Solutions
11. If one of the n sums a1, a1 + a2, a1 + a2 + a3, . . ., a1 + a2 + Â· Â· Â· + an leaves
remainder 0 when divided by n, there is nothing else to do. Otherwise, distribute
them into boxes numbered from 1 to n âˆ’1, according to their remainders upon
division by n. Since we have n sums and n âˆ’1 boxes, pigeonholeâ€™s principle
guarantees that at least two sums will be in a single box. Letting a1 + Â· Â· Â· + ak
and a1+Â· Â· Â·+ak +Â· Â· Â·+al be these two sums, conclude that ak +ak+1+Â· Â· Â·+al
is a multiple of n.
12. Notice that each element of I2n is of the form 2kq, with k â‰¥0 and q âˆˆ
{1, 3, 5, . . . , 2n âˆ’1}. Then, apply pigeonholeâ€™s principle, with the pigeonholes
being the n odd numbers 1, 3, 5, . . . , 2n âˆ’1 and the pigeons being the n + 1
selected elements of I2n.
13. Each element u
âˆˆ
A is of the form u
=
2Î±13Î±25Î±37Î±411Î±5. Take, as
pigeonholes, all possible sequences (ËœÎ±1, ËœÎ±2, ËœÎ±3, ËœÎ±4, ËœÎ±5), with ËœÎ±i = 0 or 1 for
1 â‰¤i â‰¤5. Then, place u âˆˆA into the pigeonhole (ËœÎ±1, ËœÎ±2, ËœÎ±3, ËœÎ±4, ËœÎ±5) if and
only if Î±i and ËœÎ±i have equal parities, for 1 â‰¤i â‰¤5.
14. By contraposition, assume that none of the 15 chosen elements is a prime. Then,
Corollary 6.36 guarantees that each one of these 15 numbers has a prime divisor
which is less than or equal to
âˆš
1998 â‰ˆ44, 69. Now, notice that there are
exactly 14 primes less than or equal to 44, namely: 2, 3, 5, 7, 11, 13, 17, 19,
23, 29, 31, 37, 41 and 43. Since we have chosen 15 numbers, the pigeonhole
principle assures that at least two of these will be divisible by a single one of
these 14 primes and, this way, will not be relatively prime.
15. On the one hand, A has 210âˆ’1 = 1023 nonempty subsets. On the other, the sum
of the elements of any such subset of A is at most 90+91+92+Â· Â· Â·+99 = 945.
Hence, by the pigeonhole principle, at least two nonempty subsets of A, say B
and C, have equal sums of elements. Thus, B \ (B âˆ©C) and C \ (B âˆ©C) are
the subsets of A we are looking for.
16. If A âŠ‚{1, 2, 3, . . . , 2n + 1} is free of sums, we claim that |A| â‰¤n + 1. Indeed,
letting A = {1, 3, 5, . . . , 2n+1}, we have |A| = n+1 and A is free of sums, for
the sum of any two (not necessarily distinct) elements of A is an even number,
while all elements of A are odd. Now, let B âŠ‚A be such that |B| = n + 2; we
will show that B is not free of sums. If B = {x1 < x2 < Â· Â· Â· < xn+2}, then
1 â‰¤xn+2 âˆ’xn+1 < Â· Â· Â· < xn+2 âˆ’x1 â‰¤2n.
If none of these n + 1 differences xn+2 âˆ’xi belongs to B, then all of it shall
belong to {1, 2, 3, . . . , 2n + 1} \ B. However, since this last set has only n
elements, pigeonholeâ€™s principle assures that at least two of the numbers xn+2âˆ’
xi are equal. This is a contradiction
17. We ï¬rst claim that, among the n+1 chosen numbers, there are necessarily two,
say x and y, such that |x âˆ’y| â‰¤2. In order to verify such a claim, it sufï¬ces to
apply the pigeonhole principle, distributing the n + 1 chosen elements among
the n sets {3kâˆ’2, 3kâˆ’1, 3k}, with 1 â‰¤k â‰¤n. Now, letting x and y be as above,
assume, without loss of generality, that y > x. If y âˆ’x = 1, then 4xy + 1 =
4x(x +1)+1 = (2x +1)2. If y âˆ’x = 2, then xy +1 = x(x +2)+1 = (x +1)2.

22
Hints and Solutions
553
18. We shall show that f (n) = 2n. To this end, let
{1, 2, . . . , 2n} = C1 âˆªC2 âˆªÂ· Â· Â· âˆªCn
be an arbitrary of If (n) into n sets. Since from n to 2n there are n + 1 integers,
the pigeonhole principle guarantees the existence of n â‰¤u < v â‰¤2n and
1 â‰¤i â‰¤n such that u, v âˆˆCi. Taking a = 2u âˆ’v â‰¥0 and x = y = v âˆ’u â‰¥1
we have
{a + x, a + y, a + x + y} = {u, v} âŠ‚Ci;
therefore, f (n) â‰¤2n. Now, consider the following partition of I2nâˆ’1 into n
sets:
{1, 2, . . . , 2n âˆ’1} =
nâˆ’1

k=1
{k, k + n} âˆª{n};
we shall show that the stated conditions are not fulï¬lled. Indeed, if
{a + x, a + y, a + x + y} = {u, v} âŠ‚Ck = {k, k + n},
then a + x = a + y = k and a + x + y = k + n, so that x = n and a =
k âˆ’x = k âˆ’n < 0, which is an absurd. Finally, it is enough to see that
{a + x, a + y, a + x + y} has at least two elements and, hence, cannot be equal
to {n}.
19. For item (a), assume that the 21 squares of the chessboard have been painted.
Call a column black if it has at least two black squares, and white if it has at
least two white squares. Since we have seven columns, the pigeonhole principle
assures that at least four of them are of the same color, say (without loss of
generality) black. We can also assume that these are the ï¬rst four columns
of the chessboard, from left to right. If any of these four columns has three
black squares, there is nothing left to do: it sufï¬ces to take two black squares of
another columns to get a rectangle with four black squares in the corners (see
Fig. 22.1).
Otherwise, in each of these four black columns there are exactly 2 black
squares. Since in a single column there are exactly three ways of choosing these
two black squares, the pigeonhole principle assures that at least two of the four
Fig. 22.1 The ï¬rst case of
item (a)

554
22
Hints and Solutions
Fig. 22.2 The second case of
item (a)
Fig. 22.3 A painting for item
(b)
columns will have two black squares in the same positions. These two pairs
of black squares in the two columns are the corner squares of a rectangle with
sides parallel to those of the chessboard (see Fig. 22.2).
For item (b), the total number of ways of choosing 2 out of 4 squares is
4
2

=
6. Thus, we have to paint black exactly two squares in each of the six columns,
choosing the two black squares at the columns in all six possible distinct ways
(for instance, squares 1 and 2 in the ï¬rst column, 1 and 3 in the second, 1 and
4 in the third, 2 and 3 in the fourth, 2 and 4 in the ï¬fth and 3 and 4 in the
sixthâ€”see Fig. 22.3).
20. Choose any person, say A; by the pigeonhole principle, A exchange letters on a
single subject with at least âŒŠ16âˆ’1
3 âŒ‹+ 1 = 6 other people. Now, looking at these
six people, there are two cases to consider: either there are two of them which
correspond on the same subject as that of the letters they received/wrote to Aâ€”
and in this case there is nothing left to doâ€”or any two of them correspond on
another one of the two left subjects. In this last case, repeat the above reasoning,
applying the pigeonhole principle to these six people, with any two of them
exchanging letters on one of two possible subjects.
Section 4.2
1. Start by observing that if a square can be partitioned into k other squares, then
it can also be partitioned into k + 3 squares. Then, show how to partitionate a
square into 6, 7 or 8 squares.
2. Label the rows and columns of the chessboard from top to bottom and from left
to right, from 1 to n, and let aij denote the number written in the (i, j)-cell (i.e.,
that situated in row i and column j). If Sk stands for the sum of the numbers
written in the k2 cells of a k Ã— k chessboard, show that

22
Hints and Solutions
555
Sn = Snâˆ’2 + ann âˆ’anâˆ’1,nâˆ’1.
Then, apply an inductive argument.
3. Give a convex polygon A1A2 . . . AkAk+1, its interior is equal to the union of
the interiors of the convex polygons A1A2 . . . *
Ai . . . AkAk+1, where the*over
Ai means that such a vertex is excluded. Hence, O belongs to one of these
convex k-gons, say A1A2 . . . Ak. Now, insert an induction hypothesis and show
directly that, for some 1 â‰¤i â‰¤k, at least one of the angles Ì¸ AiOAk+1 is not
acute.
4. Make complete induction on the number k of sides of the polygon. For the
induction step, consider a polygon P of n vertices, and draw some of its
diagonals in such a way that no two of them intersect in the interior of P.
Assume, without loss of generality, that these diagonals partitionate P into
triangles. Fix one of the traced diagonals, say AB, and let P1 and P2 be the
two polygons into which P gets divided by AB. Use the induction hypothesis
to show that P1 and P2 possess a vertex different from A and B, which is not
incident to none of the drawn diagonals.
5. By induction hypothesis, suppose we can paint k towers as described, for a
certain k < n2. Place k+1 towers in the chessboard, discard the left and upmost
tower and apply the induction hypothesis to the k remaining towers. Then, paint
the discarded tower with a color (out of the three given ones) distinct from the
color(s) used to paint the towers (if any) which are closest to and belong to the
same line or column of the discarded one.
6. Suppose that the given property is true for k lines, and draw the (k + 1)-th, say
r. Choose one of the semiplanes into which r divides the plane and maintain
the colors of all regions situated in this semiplane (even those resulting from a
division of a former region in two by r); then, change the colors of all regions
contained in the opposite semiplane (again, even those coming from a division
of a former region in two by r).
7. Make induction on the number of columns of the board (independently of the
total number of lines). To this end, say that the chessboard is Ã© blue (resp. red)
if the queen can visit all of its blue (resp. red) squares as prescribed in the
statement of the problem. For the induction step, apply the induction hypothesis
to the m Ã— n board obtained from an m Ã— (n + 1) one by the exclusion of
its rightmost column. Upon doing this, consider three separate cases: (i) the
smaller board is blue but nor red; (ii) the smaller board is red but not blue; (iii)
the smaller board is at the same time blue and red. In case (i), if the erased
column has any blue square, then at least one of the remaining squares of the
line of this blue square is also blue; show that, this being the case, the bigger
chessboard is also blue. In case (ii), argue in an analogous way. Finally, in case
(iii), start by observing that we can assume that if any square of the erased
column is blue (resp. red), then the remaining squares of the same line of
this blue (resp. red) square are all red (resp. blue). Let the queen walk along
a diagonal of the board to show that it still is blue and red.

556
22
Hints and Solutions
8. For item (a), let r be a line passing through two of the n given points, say A
and B, and which is at a minimum positive distance from one of the remaining
points, say C. Argue by contradiction to show that, from the n given points, A
and B are the only ones situated on r. For item (b), use induction. The initial
case is n = 3, while the induction step is taken care of by the result of (a).
9. Make complete induction on n. For the induction step, assume the desired
property to be true for 1 â‰¤n â‰¤k, with k âˆˆN, and consider 2k + 2
points satisfying the given hypotheses. Let P be the smallest convex polygon
containing such points (so that the vertices of P are some of these points).
Consider two cases separately:
(i) There are two consecutive vertices A and B of P such that A is blue and B
is red: draw AB and apply the induction hypothesis.
(ii) All vertices of P are monochromatic, say red: take an edge of P and call it
B1B2. Number the blue vertices A1, A2, . . . , Ak, Ak+1, such that
B2*
B1A1 < B2*
B1A2 < Â· Â· Â· < B2*
B1Ak+1.
Deï¬ne a function f : {1, 2, . . . , k + 1} â†’N by letting
f (i) = #(pontos vermelhos no interior de Ì¸ B2B1Ai) + 2,
so that
2 â‰¤f (1) â‰¤f (2) â‰¤Â· Â· Â· â‰¤f (k) â‰¤f (k + 1) â‰¤k
(note that the last inequality comes from the fact that P has at least three
vertices, at least one of which is not interior to Ì¸ B2B1Ak+1). Conclude
that there exists 2 â‰¤i â‰¤k such that f (i) = i, trace B1Ai and apply the
induction hypothesis.
10. Let us make induction on n. For n = 1 we can take k1 = 3. Suppose the
conclusion to be true for n = l, and consider a set of m points in the space,
no four of which being coplanar and each line segment joining two of them
having one of the numbers 1, 2, . . . , l, l + 1 associated to it. Fix one of these m
points, say A, and look at the m âˆ’1 line segments joining A to the remaining
m âˆ’1 points. Since each one of these m âˆ’1 segments has associated to it one
of l + 1 given numbers, the pigeonhole principle assures that, out of these l + 1
numbers, a certain number x is associated to at least
M :=
((m âˆ’1) âˆ’1
l + 1
)
âˆ’1
distinct segments. If M â‰¥kl, we can choose points A1, A2, . . . , Akl such that
the line segments AAi (1 â‰¤i â‰¤kl) have x associated to themselves. We now
look at the line segments joining two of the points A1, A2, . . . , Akl. If one

22
Hints and Solutions
557
of them, say AiAj, also has x associated to itself, there is nothing left to do:
AAiAj will be a triangle with x associated to all of its sides. Otherwise, points
A1, A2, . . . , Akl will be a set of kl points in space, no four of which being
coplanar and with one of the l numbers 1, . . . , x âˆ’1, x +1, . . . , l +1 associated
to each of the line segments joining two of them. By induction hypothesis, we
get the existence of a triangle having the desired properties. In order to ï¬nish,
it sufï¬ces to note that M â‰¥kl if m â‰¥(l + 1)(kl âˆ’1) + 2.
Section 4.3
1. In each item from (a) to (d) one has to check that the corresponding relation is
reï¬‚exive, antisymmetric and transitive. For item (a), we already know that a = a;
a â‰¤b and b â‰¤a imply a = b; a â‰¤b and b â‰¤c imply a â‰¤c. The veriï¬cation
for (b) is quite similar, and we just point out that if Y and Z are subsets of X
satisfying Y âŠ‚Z and Z âŠ‚Y, then Y = Z. We leave item (c) as an equally
easy exercise for the reader, referring to items (a) and (b) of Proposition 6.5
(if he/she ï¬nds it necessary) for complete arguments. Finally, for item (d), the
desired properties are inherited from those of âª¯in A.
2. Apply Mirskyâ€™s theorem to A, partially ordered by the divisibility relation.
3. If (A, âª¯) is a partially ordered set such that |A| = ab + 1, with a, b âˆˆN,
and c = min{a, b}, then A contains a chain of c + 1 elements. The proof is an
easy adaptation of the proof of Theorem 4.25. It starts by letting n = ab + 1,
A = {x1, . . . , xn} and ËœA = {(i, xi); 1 â‰¤i â‰¤n}, ordered by âª¯1, where
(i, xi) âª¯1 (j, xj) â‡”(i = j) or (i < j and xi âª¯xj).
The rest of the proof goes on almost unchanged.
4. Make induction on m, ï¬rst noticing that the case m = 1 corresponds to the case
a = b in the ErdÃ¶s-Szekeres theorem. For the induction step, write n2m + 1 as
(n2)2mâˆ’1 + 1 and apply the ErdÃ¶s-Szekeres theorem again.
5. Let x âˆˆA âˆ©B and assume, by the sake of contradiction, that A and B have
distinct lengths, with B being the longest. Let A1 = {y âˆˆA; y âª¯x}, A2 = {y âˆˆ
A; x âª¯y}, B1 = {z âˆˆB; z âª¯x}, B2 = {z âˆˆB; x âª¯z}. Show that A1 âˆªB2 and
A2 âˆªB1 are chains, and at least one of then is longer than A.
6. For item (a), assume that Ai âˆ©B0 = âˆ…for some index 1 â‰¤i â‰¤k, apply
the pigeonhole principle and arrive at a contradiction to the fact that B0 is
an antichain. For item (b), start by letting Bi be an antichain of k elements
containing xi. If j Ì¸= i, show that Aj âˆ©Bi Ì¸= âˆ…, take y âˆˆAj âˆ©Bi and
successively conclude that y âª¯xj and xj Ì¸âª¯xi. Now, reverse the roles of i
and j to show that xi Ì¸âª¯xj. For item (c), i., start by observing that Bi \ {xi} is
an antichain of k âˆ’1 elements in A \ C. On the other hand, if A \ C contained
an antichain B of k elements, then B would intersect {z âˆˆAi; xi â‰ºz}, which

558
22
Hints and Solutions
contradicts the deï¬nition of xi. For (c), ii., the induction hypothesis guarantees
that A \ C = C1 âˆª. . . âˆªCkâˆ’1, with C1, . . . , Ckâˆ’1 being pairwise disjoint chains;
since C is itself a chain, we thus obtain A = C1 âˆª. . . âˆªCkâˆ’1 âˆªC, a union of
k pairwise disjoint chains. Finally, for (d), i. follows from the hypothesis of (d),
together with the fact that a is a maximal element. Subitem ii. is straightforward:
A = {a} âˆªA1 âˆª. . . âˆªAk.
Section 4.4
1. No. On the one hand, one can easily prove that, after any number of operations,
each bottle will contain an amount of water expressed in liters by a fraction of
the form a
2k , with a, k âˆˆN. On the other hand, if one could reach the situation
in which every bottle has the same amount of water, then each one of them
would contain 11
6 l of water.
2. Show that the trinomialâ€™s discriminant is an invariant for the allowed operations.
3. No! To see why, ï¬rst look at the chessboard with its usual alternate black and
white painting. Since each 2 Ã— 1 rectangle covers exactly one black and one
white square, after we have distributed any number of rectangular pieces, these
will have covered equal numbers of black and white squares (this is the invariant
that will solve the problem). Nevertheless, when we cut out two opposite
squares, the remaining 62 squares of the chessboard comprise 32 squares of
one color and 30 of the other. Hence, the cut out chessboard cannot be covered
as asked.
4. If at some moment we replace a and b by |aâˆ’b|, then the difference between the
sums of the numbers written on the blackboard before and after the operation is
(a + b) âˆ’|a âˆ’b|, which is always even. Therefore, the parity of the sum of the
numbers written on the blackboard at any moment is an invariant with respect
to the allowed operations. Now, observe that 1 + 2 + Â· Â· Â· + 1997 = 999 Â· 1999,
which is odd.
5. If S and Sâ€² denote the sum of the numbers of two consecutive lists of six
numbers, check that Sâ€² â‰¡S (mod 7). Then, note that 1+2+3+4+5+6 = 21
and 3 + 7 + 2 + 15 + 8 + 8 = 43, but 21 Ì¸â‰¡43 (mod 7).
6. Label the coins consecutively from 1 to 10. Then, associate to each coin a
weight, which is 0 if the coin is showing head, or is equal to the label of the
coin, if it shows tail. Then, verify that each move does not change the parity of
the sum of the weights associated to the coins.
7. Firstly, distribute the members in the two houses at random, and let S denote
the sum of the numbers of enemies that each member has in the house he/she is
in. Now, choose a member and look at his/her number of enemies within his/her
present house; if this is 2, then move him/her to the other house and note that
this operation diminishes the value of S. Now, repeat this as long as possible.
8. Note that a + b + ab + 1 = (a + 1)(b + 1). Therefore, if at a certain moment
the numbers written on the blackboard are x1, x2, . . . , xk, then the value of the

22
Hints and Solutions
559
expression (x1 +1)(x2 +1) . . . (xk +1) does not change. In the beginning, such
a value was (1 + 1)(2 + 1) . . . (n + 1) = (n + 1)!. Hence, letting x denote
the number written on the blackboard after n âˆ’1 operations, we have x + 1 =
(n + 1)!, so that x = (n + 1)! âˆ’1.
9. No! In order to prove this, let a, b, c, d and aâ€², bâ€², câ€², dâ€², respectively, denote
the quantities of cards at the vertices of the square (in the clockwise sense),
immediately before and after some step. If f (w, x, y, z) = w âˆ’x + y âˆ’z, it is
immediate to check that f (aâ€², bâ€², câ€², dâ€²) âˆ’f (a, b, c, d) = Â±3k, where k is the
number of cards removed from one of the vertices at that step. In particular,
f (aâ€², bâ€², câ€², dâ€²) â‰¡f (a, b, c, d) (mod 3).
Thus, the remainder of f (w, x, y, z) upon division by 3 is an invariant asso-
ciated to the allowed operations. Now, if there were a sequence of operations
leading from the ï¬rst to the second conï¬guration, we should have
f (1, 9, 8, 9) â‰¡f (1, 0, 0, 0) or f (1, 9, 8, 9) â‰¡f (0, 1, 0, 0) (mod 3),
which is an absurd.
10. Start by drawing n line segments satisfying condition (a) and with distinct
endpoints. Then, let A1 and A2 be blue points and V1 and V2 be red ones, such
that A1V1 and A2V2 are two of the drawn line segments. If A1V1 âˆ©A2V2 Ì¸= âˆ…,
erase them and draw A1V2 and A2V1 instead. Now, use the (geometric) triangle
inequality to show that the sum of the lengths of the n drawn line segments
decreased. Finally, use the ï¬niteness of the set of points, together with the semi-
invariant consisting of the sum of the lengths of the n line segments, to show
that, at some moment, condition (b) will be satisï¬ed too.
11. A will do. To see why, let us paint the unit cubes black and white, so that
adjacent cubes have different colors and each player moves from a unit cube of
one color to another one of the other color. We consider two cases: â€¢ n is even:
group the unit cubes into n3/2 blocks 1 Ã— 1 Ã— 2 and make A start in a white
cube, always moving to the black cube of the same 1 Ã— 1 Ã— 2 block. â€¢ n is odd:
assume, without loss of generality, that the unit cubes placed at the corners of
the bigger one are black. Ignore one of these black unit cubes and group the
remaining n3 âˆ’1 ones into (n3 âˆ’1)/2 blocks 1 Ã— 1 Ã— 2; again, A should start
in the white cube of a block and follow the strategy of the ï¬rst case.
12. For item (a), number the unit squares of the chessboard, modulo 4, as shown
in the table below, noticing that there are 16 squares with each integer from 0
to 3. Any piece of one of the displayed shapes (and this is the invariant!) will
occupy four unit squares such that the sum of the numbers written on them is a
multiple of 4.

560
22
Hints and Solutions
1 0 3 2 1 0 3 2
2 3 0 1 2 3 0 1
3 2 1 0 3 2 1 0
0 1 2 3 0 1 2 3
1 0 3 2 1 0 3 2
2 3 0 1 2 3 0 1
3 2 1 0 3 2 1 0
0 1 2 3 0 1 2 3
For item (b), take ï¬ve unit squares of the chessboard, placed as shown in the
ï¬gure below:
a
b
c
d
e
If it was possible to number the squares as desired, we would have, modulo 4,
a + b + c + d â‰¡a + b + d + e â‰¡a + b + c + e â‰¡d + c + d + e.
Hence, it should be the case that a â‰¡c â‰¡d â‰¡e (mod 4). Check that this would
give 30 squares of the chessboard with numbers all congruent modulo 4, which
is impossible.
13. Whatever the way of placing the cubes such that the faces touching the table
form the board of a 6 Ã— 6 square, each cube will have 3 visible and 3 invisible
faces. For any such placement of the cubes, let vB and vW respectively denote
the numbers of black and white visible faces. Since
|vB âˆ’vW| â‰¡vB âˆ’vW â‰¡vB + vW = 60 â‰¡0 (mod 2),
we conclude that |vB âˆ’vW| is always even (here we have the invariant!).
Assume, without loss of generality, that vW > vB, and hence that vW â‰¥31
and vB â‰¤29. Show that there is at least one cube with more invisible than
visible black faces, and then that it is possible to change the position of this
cube in such a way that |vB âˆ’vW| decreases two units.
14. Note that, after any number of operations, the quantity, say n, of written
numbers does not change. On the other hand, thanks to the property we alluded
to before the statement of the problem, the product P of the written numbers
also does not change. Since there is just a ï¬nite number of ways of representing
P as a product of n positive integers, there is a largest positive integer m that
appears in the blackboard at some moment. We claim that such a number
is a multiple of all the other ones written at this moment. For the sake of
contradiction, assume that, at this moment, some number k written on the
blackboard does not divide m. Then lcm (m, k) > m, so that changing m and

22
Hints and Solutions
561
k by gcd(m, k) and lcm (m, k), we conclude that m is not the largest possible
number to appear on the blackboard. This is an absurd! Thus, by this claim,
when m appears on the blackboard, the written numbers are m1, m2, . . . , mnâˆ’1
and mn = m, with m1, m2, . . . , mnâˆ’1 dividing m. Now, show that m will always
be on the blackboard, so that, for all purposes, the subsequent operations go on
as if we were operating only with m1, . . . , mnâˆ’1. Then, we can use the same
argument as above with these nâˆ’1 numbers, thus concluding that, after a ï¬nite
number of operations, we shall reach a situation in which the written numbers
x1, x2, . . . , xn are such that x1 | x2 | Â· Â· Â· xn1 | xn. From this time on, nothing
changes on the blackboard.
Section 5.1
1. Consider a graph whose vertices are the 100 guests and in which two vertices
are adjacent if and only if the corresponding guests know each other. Then,
apply the result of Corollary 5.6.
2. Look at the possible degrees of a vertex of a graph with n vertices and, then,
apply the pigeonhole principle. You may ï¬nd it useful to review the discussion
of Example 4.2.
3. Assume, without loss of generality, that V1 = V2 = In, for some n âˆˆN. If
f : In â†’In is an isomorphism between G1 and G2, then f is a permutation
of In; show that, applying f to the rows of Adj(G1), we get Adj(G2). Argue
similarly for the converse.
4. Let G1 = (V1; E1), G2 = (V2; E2) and G3 = (V3; E3) be given graphs. If
f : V1 â†’V2 (resp. g : V2 â†’V3) is a graph isomorphism between G1 and G2
(resp. between G2 and G3), show that f âˆ’1 : V2 â†’V1 (resp. g â—¦f : V1 â†’V3)
is a graph isomorphism between G2 and G1 (resp. between G1 and G3). For
reï¬‚exivity, use the identity, Id : V1 â†’V1.
5. If V = {u1, . . . , un} and G = (V ; E) is a labelled graph, then E âŠ‚P2(V );
conversely, given E âŠ‚P2(V ), we obtain a labelled graph G = (V ; E). Hence,
it sufï¬ces to count the number of distinct subsets E of P2(V ), which is 2(n
2).
6. Assume that such a graph, say G, does exist, and let a and b be its vertices of
degree 1 and c its vertex of degree 6. Since the graph has seven vertices, c must
be adjacent to both a and b. Therefore, if H is the graph obtained from G by
the excision of a and b, then H has ï¬ve vertices, of degrees 2, 3, 4, 5 and 4
(recall that c has lost two of its edges). But this is an absurd, for in H we have a
vertex of degree 5 which can have at most four neighbors. Alternatively, apply
Havel-Hakimiâ€™s algorithm.
7. Try to build the graph by imposing that the vertex of degree 3 is not adjacent
to that of degree 6. Then, observe that the vertex of degree 6 must be adjacent
to those of degrees 1, 1, 2, 4, 4 and 5. Alternatively, apply Havel-Hakimiâ€™s
algorithm.

562
22
Hints and Solutions
8. Argue by induction on n. For the induction step, if G is a graph of vertices
u1, v1, . . . , ukâˆ’1, vkâˆ’1, with dG(ui) = dG(vi) = i for 1 â‰¤i â‰¤k âˆ’1, add a
vertex u to G and make it adjacent to u1, . . . , ukâˆ’1; then, add a vertex v and
make it adjacent to u.
9. Item (a) follows from the fact that, for given u, v âˆˆV , we have uv âˆˆE or
uv âˆˆEc; hence, NG(u) âˆ©NG(u) = âˆ…and NG(u) âˆªNG(u) = V \ {u}, so that
dG(u) + dG(u) = #(NG(u) âˆªNG(u)) = #(V \ {u}) = n âˆ’1.
For item (b), it sufï¬ces to observe that E âˆ©Ec = âˆ…and E âˆªEc = P2(V ), so
that
|E| + |Ec| = |E âˆªEc| = |P2(V )| =
n
2

.
10. Letting G = (V ; E) be a self-complementary graph, we have |E| = |Ec|.
Hence, item (b) of the previous problem gives
|E| = 1
2
n
2

= n(n âˆ’1)
4
,
so that 4 | n(n âˆ’1). The rest is immediate.
11. G âˆ’B = (V \ B; Eâ€²), where Eâ€² is the set of edges of G which are not incident
to any vertex in B. G âˆ’A = (V ; E \ A).
12. For item (a), note ï¬rstly that both G âˆ’u and G|V (G)\{u} have V (G) \ {u} as set
of vertices. Now, if Ïµ is an edge of G, then Ïµ is an edge of Gâˆ’u if and only if Ïµ
is not incident to u, which is the same as asking that Ïµ be an edge of G|V (G)\{u}.
Finally, the proof of (b) is analogous to that of (a), once w apply the discussion
of the previous problem.
13. The only vertices of G which change degree in H are u and v, and they do so
in such a way that dH(u) = dG(u) + 1 and dH(v) = dG(v) + 1. Now, there are
three essentially distinct possibilities: (i) u and v have odd degrees in G: then,
u and v have even degrees in H, so that H has two odd degree vertices less than
G; (ii) u and v have even degrees in G: then, u and v have odd degrees in H,
so that H has two vertices of odd degree more than G; (iii) u has even degree
and v has odd degree in G: then, u has odd degree and v has even degree in H,
so that H has exactly the same number of vertices of odd degree as G. For the
second part, let us start with a graph G = (V ; E), with E = {Ïµ1, . . . , Ïµm}. For
0 â‰¤k â‰¤m, let Gk = (V ; Ek), with Ek = {Ïµk+1, . . . , Ïµm} for 0 â‰¤k < m, and
Em = âˆ…. If vk denotes the number of vertices of odd degree in Gk, then vm = 0
and, hence,
v0 =
mâˆ’1

k=0
(vk âˆ’vk+1) + vm =
mâˆ’1

k=0
(vk âˆ’vk+1).

22
Hints and Solutions
563
However, by the ï¬rst part of the problem, we have vk âˆ’vk+1 = âˆ’2, 0 or 2, so
that vk âˆ’vk+1 is always even. Therefore, v0, as a sum of even summands, is
also even.
14. Item (a) will be left to the reader. For item (b), if m = 2n and 1 â‰¤i, j â‰¤2n,
then
{i, j} âˆˆE â‡”j â‰¡i Â± n(mod 2n).
From this, conclude that vertex i +n (modulo 2n) is the only neighbor of vertex
i; also, the edges of G(2n, n) are those joining vertices i and i + n, for 1 â‰¤
i â‰¤n, so that there are exactly n edges. For item (c), given 1 â‰¤i â‰¤m,
show that vertex i is adjacent to vertices i + n and i âˆ’n (modulo m) and that
i + n Ì¸= i âˆ’n (modulo m), thus giving d(i) = 2; for what is left to do, use
Eulerâ€™s theorem to conclude that |E| = m. Finally, in what concerns item (d),
show that Id : Im â†’Im is an isomorphism between G(m, n) and G(m, mâˆ’n).
15. Verify that the desired graph is the one depicted in Fig. 5.4.
16. Firstly, note that the very deï¬nition of bipartite graph assures that, for u, v âˆˆV ,
we have uv âˆˆE â‡’u âˆˆV1 and v âˆˆV2, or vice-versa. Hence, we can identify
E with a subset of V1 Ã— V2 through the injection uv â†’(u, v), if u âˆˆV1 and
v âˆˆV2. Therefore, |E| â‰¤|V1 Ã— V2| = |V1| Â· |V2|, with equality if and only if
E = V1 Ã— V2.
17. If |V1| = |W1| and |V2| = |W2|, take bijections f1 : V1 â†’W1 and f2 : V2 â†’
W2; then, let f : V1 âˆªV2 â†’W1 âˆªW2 be given by setting f|V1 = f1 and
f|V2 = f2, and show that f is an incidence-preserving bijection. Conversely,
let f : V1 âˆªV2 â†’W1 âˆªW2 be an incidence-preserving bijection. Since V1 is
an independent set, the same happens to f (V1). Hence, f (V1) cannot intersect
both W1 and W2, so that f (V1) âŠ‚W1 or f (V1) âŠ‚W2. Assume that f (V1) âŠ‚
W1 (the other case is entirely analogous). Since every vertex in V2 is adjacent to
every vertex in V1, we conclude that every vertex in f (V2) is adjacent to every
vertex in f (V1) âŠ‚W1; then, it follows from the fact that W1 is an independent
set that f (V2) does not intersect W1, i.e., f (V2) âŠ‚W2. Now,
|V1 âˆªV2| = |f (V1 âˆªV2)| = |f (V1)| + |f (V2)|
â‰¤|W1| + |W2| = |W1 âˆªW2| = |V2 âˆªV2|,
with the last equality coming from the fact that f is an isomorphism. Therefore,
|f (V1)| = |W1| and |f (V2)| = |W2|, so that f (V1) = W1 and f (V2) = W2.
Finally, this gives |V1| = |W1| and |V2| = |W2|.
19. Assume that G has l vertices of degree 5 in V1 and k vertices of degree 8, so that
|V1| = k + l and |V2| = 16 âˆ’l. Since the graph is bipartite, the edges departing
from V1 are incident to vertices in V2, and vice-versa. Hence, 8k+5l = 5(16âˆ’l)
or, which is the same, 4k + 5l = 40. It is now immediate to verify that the
nonnegative integer solutions of such an equation, with k > 0, are (k, l) =
(5, 4) or (10, 0). In each one of these cases, exhibit the corresponding bipartite
graph.

564
22
Hints and Solutions
20. For item (a), apply Eulerâ€™s theorem. For (b), start by letting the n vertices be
those of a regular n-gon, and consider the two following cases: (i) if r = 2m <
n, join each vertex to the 2m closest ones; (ii) if r = 2m + 1 < n (so that n is
even), join each vertex to the 2m closest ones, as well as to the vertex symmetric
with respect to the center of the polygon.
21. Let P1, P2, . . . , P11 be the patrols and h1, h2, . . . , hn be the volunteers, and join
hi to Pj if hi is a member of Pj. Also, let k be the number of members of each
patrol and Ai be the set of men in patrol Pj. Since we have n men altogether, it
follows that
n = |A1 âˆªA2 âˆªÂ· Â· Â· âˆªA11|.
Therefore, by inclusion-exclusion,
n = |A1 âˆªA2 âˆªÂ· Â· Â· âˆªA11|
=

i
|Ai| âˆ’

i<j
|Ai âˆ©Aj| +

i<j<k
|Ai âˆ©Aj âˆ©Ak| âˆ’Â· Â· Â· .
However, since no man belongs to three or more patrols, the only nonzero
summands in the last expression above are the two ï¬rst ones, so that
n =

i
|Ai| âˆ’

i<j
|Ai âˆ©Aj| = 11k âˆ’
11
2

= 11k âˆ’55.
Now, let us count the number of edges of our (bipartite) graph in two distinct
ways: on the one hand, since each man has degree 2, we have a total of 2n
edges; on the other hand, since each patrol has degree k, the number of edges
is equal to 11k. Thus, 2n = 11k. Finally, solving the linear system of equations
n = 11k âˆ’55
2n = 11k.
,
we get n = 55 and k = 10.
22. For item (a), adapt the reasoning used to solve the previous problem to get
g = m âˆ’1 and n =
m
2

. For (b), set V1 = {a1, a2, . . . , am}, V2 = {bj,k; 1 â‰¤
j < k â‰¤m} and let ai to be adjacent to bj,k if and only if i âˆˆ{j, k}.
23. Look at the posed situation as a bipartite graph G, with the elements of the
independent sets of vertices being the students and the problems, and such that a
student and a problem are adjacent if and only if the student solved the problem.
If each problem was solved by k students, apply double counting to conclude
that k = x
2. Now, let E be the set of students, e âˆˆE and P be the set of the y
problems solved by e. If H is the subgraph of G induced by (E \ {e}) âˆªP (cf.
Problem 12), then H is also bipartite; apply double counting to H to conclude

22
Hints and Solutions
565
that 3(x âˆ’1) = y
 x
2 âˆ’1

. Then, deduce that (x, y) = (4, 9) or (8, 7). Finally,
bipartite graphs corresponding to those possibilities can be easily constructed
from the respective adjacency matrices A, which we exhibit below:
(i) (x, y) = (4, 9):
A =
â¡
â¢â¢â£
1 1 1 1 1 1 1 1 1 0 0 0 0 0 0 0 0 0
0 0 0 0 0 0 1 1 1 1 1 1 1 1 1 0 0 0
0 0 0 1 1 1 0 0 0 1 1 1 0 0 0 1 1 1
1 1 1 0 0 0 0 0 0 0 0 0 1 1 1 1 1 1
â¤
â¥â¥â¦.
(ii) (x, y) = (8, 7):
A =
â¡
â¢â¢â¢â¢â¢â¢â¢â¢â¢â¢â¢â£
1 1 1 1 1 1 1 0 0 0 0 0 0 0
0 0 0 0 1 1 1 1 1 1 0 0 0 1
0 0 1 1 1 0 0 1 0 0 1 1 0 1
1 1 0 0 1 0 0 0 1 1 1 1 0 0
1 0 1 0 0 1 0 0 1 0 1 0 1 1
1 0 0 1 0 1 0 1 0 1 0 1 1 0
0 1 1 0 0 0 1 1 0 1 1 0 1 0
0 1 0 1 0 0 1 0 1 0 0 1 1 1
â¤
â¥â¥â¥â¥â¥â¥â¥â¥â¥â¥â¥â¦
.
24. By the sake of contradiction, assume that there is a way to place the given
numbers as stated, and consider the graph G = (V ; E) such that V
=
{1, 2, . . . , 13} and {x, y} âˆˆE if and only if x and y are neighbors in the circle.
Then, G has 13 vertices and 13 edges, and all vertices have degree 2. Now, look
at the sets of vertices A = {1, 2, 3, 4, 10, 11, 12, 13} and B = {5, 6, 7, 8, 9}; we
can have at most two edges joining pairs of elements of A: one joining 1 and 4
and another joining 10 and 13. Since we have 13 edges altogether, two of them
departing from each vertex, we conclude that at least 4 Â· 2 + 4 Â· 1 = 12 edges
join elements of A to elements of B. Since B has ï¬ve elements, the pigeonhole
principle guarantees that at least one of them must receive at least three edges,
which is an absurd.
25. Item (a) is immediate and (b) follows from the deï¬nitions of chain, antichain,
vertex cover and matching. For item (c), note that (from i.) a minimal vertex
cover corresponds to a maximal antichain, whereas (from ii.) a maximal match-
ing corresponds to a maximum collection of disjoint chains (thus containing all
vertices of degree 0) whose union is V1 âˆªV2.
26. For item (a), show that 
uâˆˆV d+(u) counts each subset of two vertices exactly
once. Item (b) follows directly from (a). For item (c), show that if (u, v) and
(u, w) are edges of G, then there is exactly one transitive K3 in G involving u,
v and w; then, conclude that the number of distinct transitive K3â€™s in which u
enters with out degree 2 is equal to
d+(u)
2

. For item (d), note that the number
of K3â€™s in G is exactly
n
3

; then, use the results of items (c) and (a). For item

566
22
Hints and Solutions
(e), substitute d+(u) = (d+(u) âˆ’d+) + d+ in the formula of (d) and expand,
using, whenever convenient, the result of (b).
27. Looking at the described situation in the language of the previous problem,
conclude that the number of sets one asks to maximize is at most 112. Then,
write down an explicit table of results for the
14
2

= 91 distinct matches,
showing that it is indeed possible that one has 112 sets of three players
satisfying the stated conditions.
Section 5.2
1.
bij =

l1,...,lk
a1
il1a2
l1l2 . . . akâˆ’1
lkâˆ’2lkâˆ’1ak
lkâˆ’1j,
For item (a), if M = (aij), use the deï¬nition of adjacency matrix to show that a
generic summand aikakj of the sum deï¬ning entry (i, j) of M2 is equal to 1 if
and only if vk is adjacent to both vi and vj. For item (b), make induction on k.
Finally, for item (c), use the result of (b) and adapt the argument given to item
(a).
2. Show that H coincides with the maximal connected subgraph of G containing
u.
3. For the ï¬rst part assume, by contraposition, that G has at least two connected
components, so that G is the union of two disjoint subgraphs H1 and H2,
respectively with k and l vertices. Use the fact that k + l = n, together with
discrete optimization (cf. Remark 4.32) to get
k
2

+
l
2

â‰¤
nâˆ’1
2

.
4. Use the result of the ï¬rst part of the previous problem.
5. Use the comments preceding the statement of the problem to prove that each
vertex of G(m, n) belongs to the connected component of one of the vertices 1,
2, . . . , d.
6. If G has two connected components H1 and H2, then each vertex of H1 is
adjacent to all vertices of H2 in G, so that G contains the complete bipartite
subgraph with independent sets of vertices V (H1) and V (H2). The rest is now
clear.
7. Create a walk reduction algorithm that, as ï¬nal result, gives a path between two
chosen vertices, provided there is a walk from one to the other. Basically, from
a given walk such an algorithm should eliminate each portion of it of the form
(v = v0, v1, . . . , vk = v).
8. Execute the algorithm delineated in the proof of Theorem 5.24.
9. Adapt, to the present case, the proof of Theorem 5.24.
10. Let C1 and C2 be two paths in G, of largest possible lengths. By the sake of
contradiction, suppose that C1 and C2 do not have common vertices. Take a

22
Hints and Solutions
567
path C in G, joining a vertex of C1 to a vertex of C2 and having the smallest
possible length. Show that C has only one vertex in common with C1 and only
another one in common with C2. Now, concatenate a portion of C1, C and a
portion of C2 to build a walk in G whose length is larger than that of C1 or of
C2.
11. There are
 n
kâˆ’1

ways of choosing k âˆ’1 vertices out of u1, . . . , un, and each of
such choices generates (k âˆ’1)! distinct paths with the stated properties. Now,
use the additive principle.
12. Adapt, to the present case, the proof of Theorem 5.24 in order to build a cycle
in the given graph.
13. Use the result of the previous problem.
14. Let A, B, C, D and E be the mathematicians and A1, A2, B1, B2, C1, C2,
D1, D2 and E1, E2, respectively, be the time intervals during which they slept.
Build a graph having these time intervals as vertices, with two such vertices
being adjacent if and only if the corresponding time intervals overlap. Then,
show that such a graph contains a cycle.
15. Start by attributing the labels 1, 2, . . . , k to a maximal walk (of length k) in G,
that does not runs through the same edge twice.
16. We ï¬rst claim that G âˆ’Ïµ has at most two connected components. In order to
prove this, let Ïµ = {u, v}, and let w Ì¸= u, v be another vertex of G. Since
G is connected, we have in G a path C joining w and u. Now, there are two
possibilities: (i) C does not pass through Ïµ: then, we have in Gâˆ’Ïµ a path joining
w and u; (ii) C passes through Ïµ: since the vertices of C are pairwise distinct and
u is the last one of them, the next to last must necessarily be v; hence, stopping
the path C in v, we obtain a path in G âˆ’Ïµ joining w to v. Anyhow, every vertex
of G âˆ’Ïµ can be joined to u or v by a path in G âˆ’Ïµ, so that G âˆ’Ïµ has at
most two connected components: one containing u and another containing v.
We now claim that G âˆ’Ïµ has at least two connected components. Indeed, if
G âˆ’Ïµ was connected, it would contain a path joining u and v, and such a path
would necessarily have length at least 2; adding edge Ïµ to such a path would
give us a cycle in G, which is an absurd.
17. Let u be the vertex of G with maximum outdegree. If the edge joining u to v is
oriented from u to v, there is nothing left to do; otherwise, prove that d+(u) +
dâˆ’(v) â‰¥n âˆ’1, and use this to conclude the existence of w âˆˆN+
G(u) âˆ©Nâˆ’
G(v).
18. For item (a), number the cities from 1 to n and orient the road joining i and j,
with i < j, from i to j. For item (b), suppose the wizard executed his intent
somehow and note that, if one could always leave every city, then he/she would
eventually return to a previously visited city, which is a contradiction. This way,
conclude that there exists a city from which one cannot leave, label it as city
n and exclude it from the subsequent analysis of the problem. Now, if it was
always possible to leave each of the remaining n âˆ’1 cities to another one of
them, reach an analogous contradiction. Then, conclude that there is one of
these remaining nâˆ’1 cities such that one cannot leave it to another one of them
(i.e., from there one can only reach city n). Label it as city n âˆ’1 and exclude
it from the subsequent analysis of the problem. Repeat this reasoning as long

568
22
Hints and Solutions
as there are cities to consider and conclude that, when just one city is left, then
one can go from there to any other city. Finally, for item (c), use the proof of
(b) to conclude that every possible way the wizard has to implement his rules
is equal, up to isomorphism, to the one described in (a). Then, show that there
are exactly n! distinct ways.
19. Given an optimal path C = (c0, c1, . . . , cn2âˆ’1), we say that an edge of a unit
square is traversed if it is a common edge of two consecutive unit squares ci
and ci+1 of the path. Consider the graph G having as its vertices all of the
(n+1)2 vertices of all of the n2 unit squares of the chessboard, and as its edges
the traversed edges of the unit squares. We classify the vertices of G in three
distinct types: (I) the four vertices at the corners of the chessboard; (II) the
remaining 4(n âˆ’1) vertices at the edges of the chess; (III) the (n âˆ’1)2 vertices
lying in the interior of the chessboard. Letting dv denote the degree of vertex v,
we have dv â‰¤3 for every v. Now, note that a path C contains an U if and only if
some vertex has degree 3. By the sake of contradiction, assume that an optimal
path C does not contain an U and conclude, with the aid of Eulerâ€™s theorem, that
the number m of traversed edges is at most n2 âˆ’1. Then, show that m = n2 âˆ’1
and conclude that the degree of each vertex of type (II) is 1, which is clearly
impossible.
20. Let u1, u2, . . . , un be the vertices of the graph and d1, d2, . . . , dn be their
respective degrees. Also, let di1, di2, . . . , didi be the degrees of the vertices
adjacent to ui. By the sake of contradiction, assume that
di1 + di2 + Â· Â· Â· + didi
di
< d1 + d2 + Â· Â· Â· + dn
n
.
Then,
n

i=1
(di1 + di2 + Â· Â· Â· + didi) < 1
n
" n

i=1
di
#
n

i=1
di
= (d1 + d2 + Â· Â· Â· + dn)2
n
.
However, since each summand dij at the left hand side is counted exactly dij
times (one time for each of the dij neighbors of the vertex having degree dij),
it follows that
d2
1 + d2
2 + Â· Â· Â· + d2
n < (d1 + d2 + Â· Â· Â· + dn)2
n
.
In turn, this contradict the inequality between the quadratic and arithmetic
means (cf. problem 5.2.3 of [8], for instance).

22
Hints and Solutions
569
22. Start by noticing that such a problem is a natural generalization of Problem 3.
Then, adapt to the present setting the discussion of Example 2.29 and the hint
given to Problem 20, page 32.
23. Let G be a graph satisfying the stated conditions, ï¬x a vertex u of G and count
its neighbors and the neighbors of their neighbors to conclude that k â‰¥5. If
k = 5, conclude that such a counting computed exactly one vertex of G twice,
and that such vertex is neither u nor a neighbor of u. Then, show that u belongs
to a single 4-cycle in G and, by the arbitrariness of u, that G can be partitioned
into 4-cycles, which is an absurd. If k = 6, construct a graph G of 25 vertices
in the following way:
â€¢
The set V of vertices of G is the disjoint union V = 5
i=1 Ai, where each Ai
is a set of ï¬ve vertices and the subgraph Gi of G induced by Ai is a 5-cycle.
â€¢
For 1 â‰¤i < j â‰¤5, establish a bijection Ï†ij : Ai â†’Aj such that, if
x, y âˆˆAi are adjacent in Gi, then Ï†ij(x) and Ï†ij(y) are nonadjacent in Gj.
Then, impose that x and Ï†ij(x) are adjacent in G, for all x, i and j as above.
Finally, show that the graph G thus constructed satisï¬es the stated condition.
24. Let us interpret the problem in the language of Graph Theory, in the following
way: associate a vertex to each room and put an edge between two vertices
if and only if there is a door between the corresponding rooms. For two rows
of n rooms each, the condition in the statement of the problem amounts to
the connectedness of the resulting graph Gn (of 2n vertices). Now, let an be
the number of connected graphs Gn satisfying the given conditions. Firstly,
check that a1 = 1 and a2 = 5. Then, use a recursive argument to show that
an+1 = 4an + bn, where bn is the number of graphs Gn having exactly two
connected components. Finally, show that bn = 1 + 2a1 + 2a2 + Â· Â· Â· + 2anâˆ’1
and conclude, from this last recurrence, that an+2 = 5an+1 âˆ’2an for every
n â‰¥1.
Section 5.3
1. For the ï¬rst part, prove that (a) â‡’(c) â‡’(b) â‡’(a). For the second, the
established equivalences assure that the number of distinct paths in a tree with n
vertices is equal to the number of distinct ways of choosing two of its vertices.
2. If u is a vertex of T with degree k, show that T âˆ’u has k connected components,
all of which are themselves trees. Then, apply the result of Lemma 5.32.
3. For item (a), use the result of Proposition 5.33. For (b), show that if T âˆª{Ïµ}
did not contain cycles, then T would not be a spanning tree of G. For item (c),
assume that G is not a tree and, hence, that it contains some cycle; show that G
has at least two spanning trees.
4. Adapt, to the present case, the proof of the correction of Kruskalâ€™s algorithm (cf.
proof of Proposition 5.36), showing that Dijkstraâ€™s algorithm builds a spanning

570
22
Hints and Solutions
tree for the given graph and that the weight of such a tree is less than or equal to
that of any other spanning tree.
5. Start by following Kruskalâ€™s or Dijkstraâ€™s algorithm to ï¬nd one spanning tree
with minimal weight.
6. Item (a) simply counts the number of odd integers in the list 1, 2, . . . ,
n
2

. For
item (b), start by painting a leaf of T , say in blue. Then, if some (but not all)
vertices of T have already been painted, choose a vertex v of T which has not
been painted yet and is adjacent to an already painted vertex u, and paint v with
the color distinct from that of u. Continue this way until there are no unpainted
vertices in T . For (c), show that a path has odd weight if and only if its endpoints
have distinct colors. Then, use the hint given to the second part of Problem 1.
Finally, for (d), use the results of (a) and (c), together with the fact that x+y = n.
Section 5.4
1. Given a vertex a of G and changing G by G, if necessary, we can assume that
dG(a) â‰¥3. Now, take vertices u, v and w in NG(a). If two of these vertices,
say u and v, are adjacent in G, then a, u and v are the vertices of a K3 in G.
Otherwise, u, v and w are the vertices of a K3 in G.
2. Under the assumptions of (a), the pigeonhole principle guarantees that at least
one of the remaining 2q âˆ’2 vertices will receive at least âŒŠ(2qâˆ’2)+1
2qâˆ’1
âŒ‹+ 1 = 2
edges from {u, v}; if w is such a vertex, then uvw is a K3 in G. If we are as in
(b), then G âˆ’{u, v} has 2q âˆ’2 = 2(q âˆ’1) vertices and at least (q2 + 1) âˆ’
((2q âˆ’2)+1) = (q âˆ’1)2 +1 edges. By induction hypothesis, Gâˆ’{u, v} (and,
hence, G) contains a K3.
3. Apply the result of the previous problem.
4. Adapt, to the present case, the solution to Problem 2. More precisely, start by
taking (from the result of that problem) a K3 in G, with vertices a, b and c.
Now, if one of the remaining seven vertices is adjacent to all of a, b and c, there
is nothing to do. Otherwise, assume that k of the remaining seven vertices are
adjacent to at least two of a, b and c, whereas the remaining 7 âˆ’k are adjacent
to at most one of a, b and c. Then, we have at least k + 1 K3â€™s and at least
26 âˆ’3 âˆ’(2k + (7 âˆ’k)) = 16 âˆ’k edges in G âˆ’{a, b, c}. If k â‰¥4, there is
nothing to do. Otherwise, k â‰¤3. Separately consider the cases k = 0, 1, 2 and
3, arguing in the same way as above.
5. Let u1, . . . , ulâˆ’1 be the vertices of a Klâˆ’1 in G. If u1, . . . , ulâˆ’1 are all adjacent
to at least one of the remaining n âˆ’(l âˆ’1) = (l âˆ’1)(q âˆ’1) vertices of G, then
we have a Kl in G. Otherwise, at most (lâˆ’2)(nâˆ’(lâˆ’1)) = (lâˆ’1)(lâˆ’2)(qâˆ’1)
edges depart from one of u1, . . . , ulâˆ’1 to the remaining vertices. Then, H :=
G âˆ’{u1, . . . , ulâˆ’1} has (l âˆ’1)(q âˆ’1) vertices and at least

22
Hints and Solutions
571
1
2(l âˆ’1)(l âˆ’2)q2 âˆ’(l âˆ’1)(l âˆ’2)(q âˆ’1)âˆ’
l âˆ’1
2

= 1
2(l âˆ’1)(l âˆ’2)(q âˆ’1)2
edges. By induction hypothesis, H contains a Kl.
6. Construct a graph G having the teams as vertices and such that two of them are
adjacent if they have played against each other. The stated conditions assure
that Î±(G) â‰¤2, and Proposition 5.46 that Ï‰(G) â‰¤2. Conclude that G has at
most 100 edges and, then, apply item (b) of Problem 9, page 132, to show that
the tournament must have at least 90 matches. In order to build an example
with exactly 90 matches, divide the teams in two groups of 10 and, within each
group, let each two teams have a match.
7. Model the given situation by means of a graph, having the given people as
vertices and with two people being adjacent if and only if they know each other.
Then, use the given conditions to obtain upper bounds for Î±(G) and Î±(G).
8. Let two of the given points, say A and B, be joined by an edge if and only if
Ì¸ AOB > 120â—¦. Elementary geometry guarantees that the resulting graph G
does not contain a K3â€™s. Therefore, TurÃ¡nâ€™s theorem assures that G has at most
T (21; 3) = 110 edges. Now, note that the number of arcs we wish to count is
equal to the number of edges of G, i.e.
21
2

âˆ’110 = 100.
9. Draw the line segment joining two points if and only if its length is greater than
âˆš
2. If G is the resulting graph, use Ptolemyâ€™s theorem on cyclic quadrilaterals
(cf. Chapter 7 of [9]) to show that G does not contain a K4. Then, apply TurÃ¡nâ€™s
theorem to get the desired upper estimate on the number of edges in G.
10. Consider the graph G having the n people as vertices and such that two people
are adjacent if and only if they are friends. Start by observing that G has q edges
and, by the stated conditions, does not contain K3â€™s. Show that, for each vertex
u of G, the number of amicable pairs that can be formed from the enemies of
u is equal to q âˆ’
vâˆˆN(u) d(v); from this, conclude that we wish to assure the
existence of a vertex u of G for which 
vâˆˆN(u) â‰¥4q2
n2 . To this end, note that

uâˆˆV (G)

vâˆˆN(u)
d(v) =

vâˆˆV (G)
d(v)2 â‰¥1
n
â›
â
vâˆˆV (G)
d(v)
â
â 
2
= 4q2
n ,
where the used inequality is that between the arithmetic and quadratic means
(cf. (cf. problem 5.2.3 of [8], for instance).
11. Let m = âŒŠn
kâˆ’1âŒ‹and p = âŒŠ(kâˆ’2)n
kâˆ’1 âŒ‹. Also, let A be the set formed by the vertices
u of G such that d(u) â‰¤p, and B = V (G) \ A, so that d(v) â‰¥p + 1 for every
v âˆˆB. Assume, by contradiction, that |A| < m and, hence, that |B| > n âˆ’m.
Use TurÃ¡nâ€™s theorem to show that G|B contains a Kk which is a contradiction.
12. Let G be the graph having the 1001 people as vertices and such that two people
are adjacent if and only if they know each other. Apply the result of the previous
problem to G.

572
22
Hints and Solutions
13. Let each element of S correspond to a vertex, and join vertices Î± and Î² if and
only if the sets A + Î± and A + Î² are disjoint (here, A + k := {x + k; x âˆˆ
A}). Thus, letting A = {a1, a2, . . . , a101}, we conclude that an edge joins two
elements Î± and Î² of S if |Î±âˆ’Î²| Ì¸= |ai âˆ’aj|, for all distinct 1 â‰¤i, j â‰¤101. Use
the fact that #{|ai âˆ’aj|; 1 â‰¤i < j â‰¤101} â‰¤101Â· 100
2 to show that each vertex
of the graph thus obtained has degree greater than or equal to 106 âˆ’101 Â· 100,
and note that the problem ends if we ï¬nd a K100 in our graph.
Section 6.1
1. If n = (akakâˆ’1 . . . a1a0)10 is the decimal representation of the natural number
n, then n = k
j=0 aj10j. Now, use the result of Example 6.4, together with
Corollary 6.9.
2. Write 10k = (11 âˆ’1)k and expand the right hand side with the aid of the
binomial formula.
3. Write n = k
j=0 aj10j and use the result of the previous problem, together
with Corollary 6.9.
4. If n = (abc)10 is the decimal representation of n, use the result of the previous
problem to conclude that a âˆ’b + c = 0 or 11. Then, analyse these two cases
separately.
5. If n has k algarisms, use the given conditions to show that 9k â‰¥102(kâˆ’1) âˆ’
10k âˆ’22 and, then, to conclude that k = 1 or 2.
6. For a âˆˆN, start by observing that (a + 1)(a + 2) . . . (a + n) = (a+n)!
a!
.
7. Start by showing that a natural number is a multiple of 10 if and only if it is
at the same time a multiple of 2 and 5. Thus, since the given number is clearly
even, it sufï¬ces to show that it is a multiple of 5; to this end, use the result of
Example 6.3.
8. Use the result of item (b) of Example 6.3.
9. In item (c), in order to show that S âŠ‚nZ, use the division algorithm and the
minimality of n.
10. Start by analysing the ï¬rst part of the problem. To this end, write 264 + 1 =
(264 âˆ’1) + 2 and factorise 264 âˆ’1.
11. Start by applying the existence part of the division algorithm to write m =
aq + m0, with 0 â‰¤m0 â‰¤a âˆ’1. Then, arguing by induction, write q =
mkakâˆ’1 + mkâˆ’1akâˆ’2 + Â· Â· Â· + m1, with 0 â‰¤mj â‰¤a âˆ’1 for 1 â‰¤j â‰¤k. Now, if
m = mkak+mkâˆ’1akâˆ’1+Â· Â· Â·+m1a+m0 = mâ€²
lal +mâ€²
lâˆ’1alâˆ’1+Â· Â· Â·+mâ€²
1a+mâ€²
0,
with 0 â‰¤mi, mâ€²
j â‰¤a âˆ’1 for all iâ€™s and jâ€™s, use the uniqueness part of the
division algorithm to conclude that m0 and mâ€²
0, being remainders upon division
of m by a, are equal. Arguing once more by induction, apply the induction
hypothesis to mâˆ’m0
a
to conclude that k = l and mj = mâ€²
j for 1 â‰¤j â‰¤k.

22
Hints and Solutions
573
13. For items from (a) to (e), it sufï¬ces to perform judicious applications of the
results of items (a) and (b) of the previous problem. Regarding item (f), start by
using the result of item (b).
14. Start by analysing the case in which x belongs to an interval of the form (n, n+
1
2), for some n âˆˆZ.
15. Start by showing that, under the given conditions, we have a2
b + b2
a + 1 >
a2+b2
ab
âˆ’1 + ab and, then, that 1 + (a + b âˆ’1)(a2 + b2 âˆ’ab) > a2b2. Finally,
conclude that a â‰¥b â‡’b = 1.
16. Expanding the given equality we obtain (x + y)(x + z) = 2xz. Conclude that
one of the sides of this last equality is a multiple of 4, while the other is not.
17. Apply items (a) and (b) of Corollary 6.8.
18. For item (b), use the result of (a); for (a), write n = 7q + r, with r =
0, 1, 2, 3, 4, 5 or 6, and compute n3.
19. We certainly have n > 1, and can assume x â‰¤y < z; if x = y, start by showing
that n = 2; if x < y, write 1 = nyâˆ’x(nzâˆ’y âˆ’1).
20. For k â‰¥5, show that k! end with 0; then, use the result of Example 6.10.
21. Use the result of Example 6.10.
22. For item (a), write n = 2rq, with r being a nonnegative integer and q an odd
natural number. Then, use the given condition to conclude that q = 1.
23. By the sake of contradiction, assume this is not the case, and let N âˆˆN be such
that
n â‰¥N â‡’s(3n+1) > s(3n).
Problem 1 assures that s(3k) is a multiple of 9 for k â‰¥2, so that
s(3n+1) â‰¥s(3n) + 9, âˆ€n â‰¥N.
Adding the above inequality for n = N, N + 1, . . . , M âˆ’1 to get s(3M) â‰¥
s(3N)+9(M âˆ’N) = 9(M âˆ’c),for some integer c < M, which doesnâ€™t depend
on the chosen M â‰¥N. Now, note that 3M < 10Mâˆ’c for all sufï¬ciently large M
(cf. Section 7.2 of [8], for instance); however, since the greatest possible value
for s(m) when m < 10Mâˆ’c is
s(10Mâˆ’c âˆ’1) = s(99 . . . 9
  
Mâˆ’c
) = 9(M âˆ’c),
we have arrived at a contradiction.
Section 6.2
1. Apply Euclidâ€™s algorithm to a = 21n + 4 and b = 14n + 3.
2. Firstly, write 2m = (n âˆ’1)(n + 1); secondly, compute all possible values of
gcd(n âˆ’1, n + 1) and, then, use item (b) of Corollary 6.23.

574
22
Hints and Solutions
3. First show that, if there exists a natural number which is a term of both
progressions, then there will exist inï¬nitely many such natural numbers.
Secondly, for the characterization of the existence of a natural number which is
a term of both progressions, use Proposition 6.26.
4. Revisit the hint given to Problem 10, page 163.
5. Start by showing that the gcd we wish to compute divides (n+1)!âˆ’n! = nÂ·n!.
6. Let d = gcd(a, b) and write a = du and b = dv, so that gcd(u, v) = 1.
Conclude that ab | (a2 + b2) if and only if uv | (u2 + v2). If this is so, since
u, v | uv, we have that u, v | (u2 + v2) and, hence, u | v2 and v | u2. Now,
use the fact that gcd(u, v) = 1 to obtain u = v = 1. Alternatively, write
a2 + b2 = abk, with k âˆˆN, and examine the discriminant of the second degree
equation x2 âˆ’(bk)x + b2 = 0, which has a as a natural root.
7. Firstly, analyse the case gcd(a, b) = 1. In this case, let the rectangle has vertices
(0, 0), (a, 0), (a, b) and (0, b). Start by showing that if one of its diagonals
has a point in common with an 1 Ã— 1 square, then it crosses the interior of
such a square. Subsequently, show that such a diagonal intersects the column
of 1 Ã— 1 squares bounded by the vertical lines x = j and x = j + 1 in exactly
âŒŠb
a (j + 1)âŒ‹+ 1 âˆ’âŒŠb
a jâŒ‹squares.
8. Let d be the desired gcd. It follows from the columnsâ€™ theorem of Pascal
triangle (cf. Section 4.2 of [8]) that d divides the sum
n+k+1
k+1

of the given
numbers. Therefore, d divides
n+k+1
k+1

âˆ’
n+k
k

=
n+k
k+1

. From this, and with
the aid of Stifelâ€™s relation (once more according to Section 4.2 of [8]), conclude
that d divides
n+1
k+1

,
n+2
k+1

, . . .
n+k
k+1

. Finally, argue inductively.
9. Let d be the gcd we wish to compute. Then, d divides the sum of the given
numbers, which (by the linesâ€™ theorem of the Pascal triangleâ€”cf. Section 4.2
of [8]) is equal to 22nâˆ’1. Thus, d is a power of 2. Write n = 2kq, with q âˆˆN
odd, and show that
 2n
2t âˆ’1

= 2k+1 Â·
(2n âˆ’1)q
(2t âˆ’1)(2n âˆ’2t + 1)
2n âˆ’2
2t âˆ’2

.
From this computation, conclude that 2k+1 divides all of the given binomial
numbers.
10. If d = gcd(n2 +k, (n+1)2 +k), then d | [((n+1)2 +k)âˆ’(n2 +k)]. Therefore,
d | [(2n+1)2âˆ’4(n2+k)], and from this it is easy to conclude that d | (4k+1),
and hence d â‰¤4k +1. Finally, exhibit a value of n for which the corresponding
gcd is equal to 4k + 1.
11. Start by writing a = du and b = dv, with d = gcd(a, b) and gcd(u, v) = 1;
then, conclude that u, v | c and, hence, that uv | c.
12. Let x2 + y2 âˆ’x = 2xym, with m âˆˆN. Then, by looking at such an equality as
a second degree equation in x, show that the fact that x is an integer guarantees
that the discriminant  = (2ym+1)2 âˆ’4y2 = (2ym+1âˆ’2y)(2ym+1+2y)
must be a perfect square. Finally, show that gcd(2ym+1âˆ’2y, 2ym+1+2y) =
1 and use the result of Corollary 6.23.

22
Hints and Solutions
575
13. Firstly, use the pigeonhole principle (cf. Sect. 4.1) to show that at least one of
the ï¬ve odd elements of our set is not a multiple of 3, 5 or 7. Now, let a be
such an element, and b be any other element of the given set. Use the fact that
gcd(a, b) | (a âˆ’b) to show that if gcd(a, b) > 1, then it is divisible by 2, 3, 5
or 7. Finally, conclude that a is the element we are looking for.
14. Write aj + b = mâŒŠaj+b
m âŒ‹+ rj, with 0 â‰¤rj < m; then, use the condition
gcd(a, m) = 1 to conclude that r0, r1, . . . , rmâˆ’1 are pairwise distinct.
15. Write r = du and n = dv, so that gcd(u, v) = 1; then, let
8 ui
v
9
= ui
v âˆ’âŒŠui
v âŒ‹
and use the result of the previous problem.
16. Use BÃ©zoutâ€™s theorem to substitute gcd(m, n) = mx + ny, with x, y âˆˆZ, and
develop the expression thus obtained.
17. Start by proving that an+1 = a1 . . . an + 1 (cf. item (a) of problem 15 of [8]).
18. Prove item (a) by induction on n and item (b) by induction on k. As for item
(c), for subitem (i) use (b) to show, also by induction, that Fn | Fnq; for subitem
(ii), use (i) and (a); for (iii), make induction on q â‰¥0, using (b) and (ii) to
perform the induction step. Finally, for item (d), adapt Euclidâ€™s algorithm to the
situation at hand, with the aid of the results of item (c).
19. Adapt, to the present case, the several items and hints given to the previous
problem.
20. For item (a), let u and v be natural numbers such that au âˆ’bv = 1. The fact
that n > ab gives us nau âˆ’nbv = n > ab and, hence, nu
b âˆ’nv
a > 1. Thus,
there exists an integer t such that nv
a < t < nu
b . Let x = nu âˆ’bt, y = at âˆ’nv
and obtain (b) arguing by contradiction; then, reduce (c) to (a) and (d) to (b).
Concerning (e), let S = ab âˆ’a âˆ’b and show that, for 0 â‰¤m â‰¤S, exactly one
of the numbers m and S âˆ’m can be written as prescribed.
21. For (a), arguing by contradiction, let x, y, z âˆˆZ+ such that 2abc âˆ’ab âˆ’bc âˆ’
ca = xbc + yac + zab. Then,
2abc = (x + 1)bc + (y + 1)ac + (z + 1)ab,
so that a | (x + 1)bc. Since gcd(a, bc) = 1, we conclude that a | (x + 1) and,
hence, that x + 1 â‰¥a. Similarly, y + 1 â‰¥b and z + 1 â‰¥c. But these give
(x + 1)bc + (y + 1)ac + (z + 1)ab â‰¥a Â· bc + b Â· ac + c Â· ab = 3abc,
which is a contradiction. For item (b), if n > 2abc âˆ’ab âˆ’bc âˆ’ca, then
n > a Â· bc âˆ’a âˆ’bc and the previous problem guarantees (since a and bc are
relatively prime) the existence of integers x, t âˆˆZ+ such that n = xbc + ta.
Without loss of generality, we can assume that 0 â‰¤x < a; indeed, if x â‰¥a,
write x = aq + xâ€², with 0 â‰¤xâ€² < a, thus obtaining n = xâ€²bc + (t + qbc)a.
For (c), letting x â‰¤a âˆ’1, we have
ta = n âˆ’xbc â‰¥(2abc âˆ’ab âˆ’bc âˆ’ca) âˆ’(a âˆ’1)bc = abc âˆ’ab âˆ’ac,

576
22
Hints and Solutions
whence t > bcâˆ’bâˆ’c. However, since b and c are relatively prime, by invoking
once more the result of the previous problem we conclude that there exist y, z âˆˆ
Z+ such that t = bz + cy. Finally, for item (d), in the notations of the previous
items we get
n = xbc + ta = xbc + (bz + cy)a = xbc + yac + zab.
22. Adapt the items and hints given to the previous problem and make induction on
n â‰¥2.
23. For the ï¬rst part of item (a), use induction. For item (b), show that if 0 < a1 <
a2 < a3 < Â· Â· Â· < anâˆ’1 are the remainders obtained in the execution of Euclidâ€™s
algorithm when a = an+1 and b = an, then aj â‰¥Fjâˆ’1 for 1 â‰¤j â‰¤n. Finally,
show that (c) follows from (a) and (b).
24. Let k be the only positive integer such that 2k â‰¤n < 2k+1, and let M =
lcm (1, 2, . . . , n). Show that 2k | M and
n

j=1
1
j = 1
M
n

j=1
M
j ,
with M
j being odd if and only if j = 2k.
Section 6.3
1. Firstly, p + q is even. Also, if p < q, then p < p+q
2
< q, so that (p + q)/2 is
not prime.
2. Start by writing m
n = 2k+1
j=1
1
j âˆ’2 k
j=1
1
2j = 2k+1
j=k+1
1
j . Then, group the
summands of this last sum in pairs to write it as a sum of fractions with all
numerators equal to 3k + 2 = p. Finally, use the fact that p is prime.
3. We can assume that x Ì¸= y. If x < y, prove that x < p < y and, hence, that
gcd(p, x) = 1. Write 2xy = p(x + y) to conclude that p | y. Let y = pz,
with z âˆˆN, to get z =
x
2xâˆ’p, thus showing that (2x âˆ’p) | x and, hence, that
(2x âˆ’p) | p. Finally, this gives 2x âˆ’p = 1.
4. Start by separately considering the cases n = 6k, 6k+1, . . . , 6k+5. For n = 6k,
for instance, use the fact that k, 2k +1, 3k +1 and 6k +1 are pairwise relatively
prime to conclude that k = 1.
5. Start by using the given condition to show that n | an. Then, if p is a prime
number which does not divide n, show that p âˆ¤an.
6. For item (a), use the FTA (for whose proof we did not use the inï¬niteness of
prime numbers. For the ï¬rst part of (b) use, beside the result of item (a), the
fundamental principle of counting. Finally, show that the result of (b) generates
the inequality n â‰¤2kâˆšn, which, in turn, generates a contradiction.

22
Hints and Solutions
577
7. In each case, adapt the idea of the proof of Example 6.40. To this end, observe
that every prime p Ì¸= 3 is of the form 3k Â± 1 and every prime p Ì¸= 2, 3 is of the
form 6k Â± 1.
8. Factorise 22n âˆ’1 and use the result of Problem 4, page 177.
9. Use Lagrangeâ€™s identityâ€”cf. Example 2.9â€”to write
2p
p

; then, use the result
of Example 6.42.
10. For item (a), show that if n is not a power of 2, then it is possible to factorise
an + 1. For item (b), argue similarly.
11. Consider the cases n even and n odd separately. In the case n = 4k, compute
gcd
 n
2 âˆ’1, n

; in the case n = 4k + 2, compute gcd
 n
2 âˆ’2, n

; ï¬nally, in the
case of an odd n, compute gcd

n, n+1
2

.
12. Factorise cm+j âˆ’ck and, then, apply the result of Problem 6, page 163.
13. If n = pÎ±1
1 . . . pÎ±k
k
is the canonical decomposition of n, write u = pÎ²1
1 . . . pÎ²k
k
and v = pÎ³1
1 . . . pÎ³k
k , with Î²i, Î³i
â‰¥0, and compute how many are the
ordered pairs (Î²i, Î³i) for which max{Î²i, Î³i} = Î±i. Then, apply the result of
Corollary 6.48.
14. Write a
b2 = c
d , with gcd(c, d) = 1, and deduce that b = xd and a = xc, for
some x âˆˆN. Then, conclude that x = 1 or cx2d = dxc. In the second case,
analyse the subcases c < 2d, c = 2d and c > 2d.
15. If n is odd, then there are no solutions, for the left and right hand sides of the
given equality have distinct parities. If n is even, then n = 5 + d2
3 + d2
4, with d3
and d4 having distinct parities. If n is a multiple of 4, show that n = p2 + 21,
where p is the smallest odd prime that divides n; then, show that p | 21 and
conclude that there are no solutions. If n is of the form 4k + 2, show that n =
5(p2 + 1), where, as above, p is the smallest odd prime divisor of n. Conclude
that p = 5 and, then, that n = 130.
16. Write n = d13q13 = d14q14 = d15q15, with q13, q14, q15 âˆˆN. Condition (b) is,
thus, equivalent to
1
q13 +
1
q14 +
1
q15 = 1. Therefore, start by getting all natural
numbers a < b < c for which 1
a + 1
b + 1
c = 1.
17. Examine the cases 1 â‰¤n â‰¤30 to conjecture that all naturals of the form 2k âˆ’2
satisfy the stated property. Then, prove this fact by writing, for n = 2k âˆ’2,
I(n) =
2kâˆ’1âˆ’1

j=1
d(2j âˆ’1) +
kâˆ’1

i=1

d(2i) + d(2i Â· 3) + Â· Â· Â· + d(2k âˆ’2i)

=

2kâˆ’1 âˆ’1
2
+
kâˆ’1

i=1

1 + 3 + 5 + Â· Â· Â· + (2kâˆ’i âˆ’1)

=

2kâˆ’1 âˆ’1
2
+
kâˆ’1

i=1
22kâˆ’2iâˆ’2
=

2kâˆ’1 âˆ’1
2
+ 22kâˆ’2 âˆ’1
3
= (2k âˆ’2)(2k âˆ’1)
3
.

578
22
Hints and Solutions
18. First note that 3 | n. Now, write n = 2Î± Â·3Î²pk1
1 Â· Â· Â· pkt
t , with 3 < p1 < Â· Â· Â· < pt
being primes and Î± â‰¥0, Î² â‰¥1 being integers. Then, note that the given relation
reduces to 3(Î± + 1)(Î² + 1)(k1 + 1) Â· Â· Â· (kt + 1) = 2Î±3Î²pk1
1 Â· Â· Â· pkt
t . Conclude
that Î² = 1 or 2 and n does not possess other prime factors apart from 2 or 3.
Finally, analyse these two cases separately.
19. For an arbitrary prime number p, it sufï¬ces to show that ep(2m) + ep(2n) â‰¥
ep(m)+ep(n)+ep(m+n). To this end, use Legendreâ€™s formula, together with
item (f) of Problem 13, page 164.
20. For item (a), use Legendreâ€™s formula to show that e2(2n) â‰¥2e2(n) + 1 for
every n âˆˆN. Alternatively, use Lagrangeâ€™s identityâ€”cf. Example 2.9â€”and
induction. For item (b), reï¬ne the computations of the ï¬rst hint to (a) to show
that e2(2n) â‰¥2e2(n) + 2 if and only if n is not a power of 2.
21. By contradiction, let d1 < d2 < âˆšn be divisors of n, so that d1 < d2 < n
d2 <
n
d1 . It sufï¬ces to show that there exists no perfect square between d1 and
n
d1 .
Letting d1 = a, d2 = a + u, n
d2 = a + v and n
d1 = a + w, with 0 < u < v < w,
we have a(a+w) = n = (a+u)(a+v). If k â‰¥1 is such that (kâˆ’1)2 â‰¤a < k2,
we claim that k2 < a + w. Indeed, since âˆša < k â‰¤âˆša + 1, it sufï¬ces to
show that (âˆša + 1)2 < a + w or which is the same, 2âˆša < w âˆ’1. From
a(a + w) = (a + u)(a + v) we obtain aw = au + av + uv, so that a | uv and
a â‰¤uv. It comes that aw = au+av+uv â‰¥au+av+a, whence w â‰¥u+v+1.
Then, w âˆ’1 â‰¥u + v â‰¥2âˆšuv â‰¥2âˆša. Finally, we cannot have equality in the
last inequality, for otherwise u = v â‡’a + u = a + v â‡’d2 =
n
d2 , which is
impossible.
22. Write n = a0 + a1 Â· 2 + a2 Â· 22 + Â· Â· Â· + am2m, with aj âˆˆ{0, 1} for 0 â‰¤j â‰¤m,
so that a0 + a1 + Â· Â· Â· + am = k. Then, compute
 n
2j

= aj + aj+1 Â· 2 + Â· Â· Â· + am Â· 2mâˆ’j
and, ï¬nally, use Legendreâ€™s formula to show that e2(n) = n âˆ’k.
23. Let p be prime and t âˆˆN be such that (a + kb)(b + ka) = pt. Assuming,
without loss of generality, that a â‰¤b, we have a + kb â‰¥b + ka > 1, so
that there exist r, s âˆˆZ for which 1 â‰¤r â‰¤s, r + s = t and a + kb = ps,
b+ka = pr. Conclude that (b+ka) | (a+kb) and, writing a+kb
b+ka = kâˆ’(k2âˆ’1)a
b+ka ,
that (b + ka) | (k2 âˆ’1). Now, consider two separate cases: (i) if p > 2, use the
fact that b+ka is a power of p and gcd(kâˆ’1, k+1) â‰¤2 to conclude that b+ka
divides k âˆ’1 or k + 1, so that b + ka â‰¤k + 1 and, hence, b = a = 1. Then,
show that the solutions are the 3-tuples (a, b, k) = (1, 1, pr âˆ’1), for every
integer r â‰¥1 and every prime p > 2. (ii) If p = 2, start by observing that at
least one of a and b is odd, so that k is also odd. Now, since (b + ka) | (k2 âˆ’1)
and b + ka = 2r, show that (b + ka) | 2(k + 1) or 2(k âˆ’1); in particular,
b + ka â‰¤2k + 2 and, hence, a = 1 or 2. If a = 2, arrive at a contradiction;
if a = 1, we have that (b + k) | 2(k + 1) or k âˆ’1, which splits the analysis
into that of two subcases: (b + k) | (2k + 2) or (b + k) | (2k âˆ’2). In the ï¬rst

22
Hints and Solutions
579
subcase, show that b = k + 2 or b = 1. If b = 1, conclude that k = 2r âˆ’1;
if b = k + 2, write s = 2u to get (a, b, k) = (1, 2u + 1, 2u âˆ’1), for some
u âˆˆN. In the second subcase, show that b = k âˆ’2 and, then, let s = 2u to get
(a, b, k) = (1, 2u âˆ’1, 2u + 1), for some u âˆˆN.
24. Choose a prime p greater than 1 + 2 + Â· Â· Â· + 1000 and show that the set A =
{p, 2p, 3p, . . . , 1000p} satisï¬es the required conditions.
25. For item (a), use the result of Problem 4, page 177, together with the fact that
p(q2k) = q for every k â‰¥0. For item (b), factorise q2k âˆ’1 and use the
minimality of k to conclude that one cannot have p(q2kâˆ’1 âˆ’1) > p(q2kâˆ’1).
26. If t is the product of all primes less than or equal to m, let y1 = xt1, where pt1 is
a prime greater than t. Letting p be the greatest prime divisor of y1 and r âˆˆN
be such that p = pr, deï¬ne y2 = xt2, with t2 > r, t1, and convince yourself that
gcd(y1, y2) = 1. Once you have chosen elements y1 = xt1 < Â· Â· Â· < yj = xtj
of A satisfying item (b), with j < m, let p be the greatest prime factor of yj
and r âˆˆN such that p = pr; deï¬ne yj+1 = xtj+1, with tj+1 > r, tj. Continue
in this way until j = m. Then, show that the set B thus obtained does satisfy
condition (c).
Section 7.1
1. If (x0, y0, z0) is a solution, then (x0an+1, y0an+1, z0an) is also a solution, for
any a âˆˆN. Now, get a solution by letting x = y = k + 1.
2. Use Proposition 7.1 to write x + y, y + z and x + z in terms of the parameters
u, v and d, as prescribed by that result.
3. Imitate the proof of Proposition 7.1. More precisely, if x, y, z > 0, start by
observing that z âˆ’x and z + x are both even and, if d = gcd
 zâˆ’x
2 , z+x
2

, the
equality
z âˆ’x
2d
 z + x
2d

= 2
y
d
2
guarantees the existence of u, v âˆˆZ such that zâˆ’x
2d = 2v2 and z+x
2d = u2. Now,
show that gcd(u, 2v) = 1.
4. In each case, use Fermatâ€™s descent method. Speciï¬cally for item (d), start by
showing that x and y leave equal remainders upon division by 3; then, by
computing (3k + r)3, conclude that if x and y are not divisible by 3, then
x3 + 5y3 is not divisible by 9.
5. Start by writing x = uâˆ’v and y = u+v, with u, v âˆˆQ, to get x2 +xy +y2 =
3u2 +v2. Then, let u = a
c and v = b
c , with a, b, c âˆˆZ and gcd(b, c) = 1, to get
3u2 + v2 = 3a2+b2
c2
. Now, for item (a) use the result of Example 7.3; for item
(b), adapt the proof of Proposition 7.1 to solve the equation 3a2 + b2 = c2.

580
22
Hints and Solutions
6. If z is odd, use the result of item (c) of Corollary 6.8 to show that there are no
solutions. If z is even, use item (b) of that same result to conclude that w, x and
y are also even; then, apply Fermatâ€™s descent method.
7. Multiply both sides of the given equality by 4, complete squares and write 2x +
3, 2y + 3 and 2z + 3 as fractions with a common denominator to reduce this
problem to the previous one.
8. Start by multiplying out to show that it sufï¬ces to obtain rational solutions to
the linear system of equations
â§
â¨
â©
ax + 2cy + 2bz = 1
bx + ay + 2cz = 0
cx + by + az = 0
.
Then, use Cramerâ€™s rule to reduce the problem to showing that the only solution
of the diophantine equation a3 + 2b3 + 4c3 = 6abc is a = b = c = 0. Finally,
for this last step, reduce to the case of a, b, c âˆˆZ and apply Fermatâ€™s descent
method.
9. Start by letting A1A2 be a diameter of the given circle. Then, use (7.1) to choose
points A3, . . . , An such that A1Ai and A2Ai are rationals, for 3 â‰¤i â‰¤n.
Finally, apply Ptolemyâ€™s theorem (cf. Theorem 4.18 of [9], for instance) to
show that AiAj is also rational.
10. The solution we present to this problem uses more the ideas presented along
this section that any speciï¬c result we have derived. Anyhow, since it is much
more difï¬cult than the previous ones, we present a complete solution: start by
simplifying the stated relation to get a2 + c2 âˆ’ac = b2 + d2 + bd or, which is
the same,
(2a âˆ’c)2 + 3c2 = (b + 2d)2 + 3b2.
(22.1)
By contradiction, assume that ab + cd = p, with p prime. Condition a > b >
c > d > 0 gives p = ab + cd â‰¥4 Â· 3 + 2 Â· 1 = 14, so that p â‰¥17. On the
other hand,
2p = 2ab + 2cd = (2a âˆ’c)b + (b + 2d)c
and, hence, gcd(2a âˆ’c, b+2d) divides 2p. For gcd(2a âˆ’c, b+2d) to be even,
we should have b and c both even, and this would give p = ab + cd also even,
which is impossible. Therefore,
gcd(2a âˆ’c, b + 2d) = 1 or p.
We claim that gcd(2a âˆ’c, b + 2d) = 1. On the contrary, suppose that
gcd(2a âˆ’c, b + 2d) = p. Then, (22.1) would give us p2 | 3(b2 âˆ’c2); in turn,
since p Ì¸= 3, this would assure that p2 | (b2 âˆ’c2). However, p = ab + cd > b
forces 0 < b2 âˆ’c2 < p2, which is an absurd.

22
Hints and Solutions
581
Now, let x = 2a âˆ’c and y = b + 2d. Then, gcd(x, y) = 1, and it follows
from (22.1) that x2 âˆ’y2 = 3(b2 âˆ’c2) or, which is the same,
(x âˆ’y)(x + y) = 3(b âˆ’c)(b + c).
We consider two cases separately:
(i) b and c have distinct parities: the fact that p = ab+cd gives gcd(b, c) = 1.
Since b + c and b âˆ’c are both odd, this implies gcd(b + c, b âˆ’c) = 1. An
analogous reasoning also gives gcd(x + y, x âˆ’y) = 1.
If 3 | (x + y), then
x âˆ’y = gcd(x âˆ’y, (b + c)(b âˆ’c)) = gcd(x âˆ’y, b + c) gcd(x âˆ’y, b âˆ’c)
and
x+y = 3 gcd(x+y, (b+c)(bâˆ’c)) = 3 gcd(x+y, b+c) gcd(x+y, bâˆ’c).
Writing Î± = gcd(xâˆ’y, bâˆ’c), Î² = gcd(xâˆ’y, b+c), Î³ = gcd(x+y, bâˆ’c)
and Î´ = gcd(x + y, b + c), we get x âˆ’y = Î±Î² and x + y = 3Î³ Î´. On the
other hand,
b âˆ’c = gcd(b âˆ’c, x âˆ’y) gcd(b âˆ’c, x + y) = Î±Î³
and, analogously, b + c = Î²Î´. Solving for a, b, c and d, we obtain
4a = Î±Î² + Î²Î´ + 3Î³ Î´ âˆ’Î±Î³, 2b = Î±Î³ + Î²Î´,
2c = âˆ’Î±Î³ + Î²Î´ and 4d = âˆ’Î±Î² âˆ’Î²Î´ + 3Î³ Î´ âˆ’Î±Î³.
Thus,
8p = 8(ab + cd) = Î²Î´(2Î±2 + 3Î´2).
However, since b + c is odd, we conclude that both Î² and Î´ are odd and,
hence, Î²Î´(2Î±2 + 3Î´2) is odd too, which is impossible.
If 3 | (x âˆ’y), we reach a contradiction in a likewise manner.
(ii) b and c have equal parities: in this case, b and c must both be odd, for,
otherwise, 2 would divide ab + cd = p. Thus, in the above notations, x
and y must also be odd. It follows that
gcd(b + c, b âˆ’c) = gcd(x + y, x âˆ’y) = 2,
for we already have gcd(x, y) = 1.

582
22
Hints and Solutions
If 3 | (x + y) (the other case is, once more, entirely analogous), then
writing
x âˆ’y
2
 x + y
2

= 3
b âˆ’c
2
 b + c
2

and letting
Î± = gcd
x âˆ’y
2
, b âˆ’c
2

, Î² = gcd
x âˆ’y
2
, b + c
2

,
Î³ = gcd
x + y
2
, b âˆ’c
2

, Î´ = gcd
x + y
2
, b + c
2

we arrive, as in the previous case, at 2a = Î±Î² + Î²Î´ + 3Î³ Î´ âˆ’Î±Î³ , b =
Î±Î³ + Î²Î´, c = âˆ’Î±Î³ + Î²Î´ and 2d = âˆ’Î±Î² âˆ’Î²Î´ + 3Î³ Î´ âˆ’Î±Î³ . Hence,
2p = 2(ab + cd) = Î²Î´(2Î±2 + 3Î´2).
Neither Î² nor Î´ are equal to p, for, otherwise, we would have b > p, which
contradicts the fact that ab + cd = p. Therefore, Î²Î´ â‰¤2, and this gives
0 < d < c â‰¤2 âˆ’Î±Î³ â‰¤1, which is an absurd.
Section 7.2
1. Substitute d = 4k + 3, m = 4l + 3 and use Corollary 6.8.
2. Just note that xn+1 + yn+1
âˆš
2 = (x1 + y1
âˆš
2)(xn + yn
âˆš
2).
3. Imitate the discussion of Example 7.6, observing that x = y = 1 is a solution of
the stated equation.
4. If x2 âˆ’dy2 = m and a2 âˆ’db2 = 1, with a, b âˆˆN, then
(a âˆ’b
âˆš
d)(x0 + y0
âˆš
d) Â· (a + b
âˆš
d)(x0 + y0
âˆš
d) = m
or, which is the same,
[(ax0 + bdy0) âˆ’(ay0 + bx0)
âˆš
d][(ax0 + bdy0) + (ay0 + bx0)
âˆš
d] = m.
Therefore, x1 = ax0 + bdy0 and y1 = ay0 + bx0 also solve the given equation.
Now, observe that
x2
1 + dy2
1 = (a2 + db2)(x2
0 + dy2
0) + 4abx0y0d > x2
0 + dy2
0,
so that (x1, y1) Ì¸= (x0, y0).

22
Hints and Solutions
583
5. Multiply the equality n2 + (n + 1)2 = m2 by 2, complete squares and apply the
result of the previous problem.
6. By completing squares, conclude that the given equation is equivalent to (2x +
y)2 âˆ’5y2 = 4. Now, use the result of Problem 4, noticing that x = y = 1 is a
solution of the stated equation.
7. By adapting the hint given to Problem 4, show that if u, v âˆˆN are such that
u2 âˆ’v2 = 1, then Î± := ux0 âˆ’vy0 and Î² := uy0 âˆ’vx0 are an integer solution
of x2 âˆ’y2 = 4an. Now, note that
ax2 + bxy + cy2 = n â‡’(2ax + by)2 âˆ’y2 = 4an,
so that, in order to generate an integer solution of equation ax2 +bxy +cy2 = n,
it sufï¬ces to show that it is possible to solve, in Z, the linear system of equations
2ax + by = Î±
y = Î²
.
In turn, such a task is equivalent to showing that 2a | (Î± âˆ’dÎ²), which can be
done by writing
Î± âˆ’dÎ² = (ux0 âˆ’vy0) âˆ’b(uy0 âˆ’vx0)
= u(x0 âˆ’by0) + bv(x0 âˆ’by0) + 4acvy0,
for the last expression is a sum of multiples of 2a.
Chapter 8
2. Prove ï¬rst that 0
0<d|n d = 0
0<d|n
n
d . Then, let P denote this product and use
such an equality to show that P 2 = nd(n).
3. For 0 < d | n, we have d + n
d â‰¥2âˆšn. Now, add all such inequalities over all
positive divisors of n.
4. For the second equation, show that an ordered pair (x, y) is a solution if and
only if x = n âˆ’
n2
n+y , so that n + y must be a divisor of n2 greater than n.
Now, use the result of Example 6.47 and (8.3) to conclude that there are exactly
1
2(d(n2)âˆ’1) distinct possibilities for y and, hence, for (x, y). In what concerns
the ï¬rst equation, adapt the hint given to the second one to conclude that there
are d(n2) distinct solutions. Finally, conclude that we ought to have 3d(n2) =
157, which is an absurd.
5. For item (a), use the result of Lemma 8.3. For item (b), if gcd(m, n) = 1, use
the result of item (a) to compute |D1(mn)| âˆ’|D3(mn)| in terms of |D1(m)| âˆ’
|D3(m)| and |D1(n)| âˆ’|D3(n)|; then, apply an inductive argument.

584
22
Hints and Solutions
6. For item (a), multiply both sides of the desired equality by n. For item (b), make
a direct computation for the sum of the positive divisors of 2pâˆ’1(2p âˆ’1).
7. The second part of item (b) uses item (b) of Problem 10, page 190.
8. Show that s(ab) â‰¥s(a)b, for all a, b âˆˆN. To this end, exhibit, in terms of
the positive divisors of a, a set of positive divisors of ab whose sum is equal to
s(a)b.
9. Apply the result of Proposition 8.4.
10. Apply the result of Proposition 8.4.
11. Use Proposition 8.4 and the result of Problem 1 to conclude that both sides of
the desired equality can be seen as arithmetic multiplicative functions, say F
and G. Then, if p is prime and Î± âˆˆN, show that F(pÎ±) = G(pÎ±).
12. Apply double countingâ€”cf. Sect. 2.2â€”ï¬rst showing that, for 1 â‰¤j â‰¤n, the
left hand side counts f (j) exactly âŒŠn
j âŒ‹times.
13. Start by applying the result of the previous problem; then, apply Proposition 8.4
to show that F(m) = 1 if m is a perfect square and F(m) = 0 otherwise.
14. If f (j) = 1 for every j âˆˆN and F(n) = 
0<d|n f (d), then F(n) = d(n) for
every n âˆˆN. Now, apply the result of Problem 12.
15. Use the MÃ¶bius inversion formula together with the result of Problem 1.
17. Use the result of Proposition 8.4.
18. Start by proving that, for a ï¬xed positive divisor d of m, there are exactly m
d Â·
Ï•(d) ordered pairs (d, n) as stated. Then, use the result of Corollary 8.13.
20. For item (a), use item (a) of Problem 19. For (b), write Sm(n) = k
i=1(nâˆ’ai)m
and expand the binomial (n âˆ’ai)m. For the ï¬rst part of (c), use (b); as for
the second part, separately consider the cases n even and n odd and apply the
conclusion of item (a) in the case of an even n.
21. For item (a), choose d in such a way that gcd(m, n) =
n
d and a such that
m = n
d Â· a; then, conclude that gcd(a, d) = 1. For item (b), use the result of (a)
to show that 
0<d|n
 n
d
k Sk(d) = 1k + 2k + Â· Â· Â· + nk. Item (c) follows from
MÃ¶bius inversion formula, applied to the result of (b). Finally, for items (d) and
(e), use the formula of (c).
Section 9.1
1. Use the Prime Number Theorem.
2. Use the divergence of the harmonic series (cf. Section 7.4 of [8], for instance),
in conjunction with Lemma 3.15.
3. Use again the divergence of the harmonic series, together with Theorem 9.5.
4. For the ï¬rst part of item (a) use the fact that, if p is prime and n < p â‰¤2n, then
gcd(n!, p) = 1; for the second part, use the binomial formula. For item (b), use
(a), together with the fact that the number of primes p satisfying n < p â‰¤2n is
exactly Ï€(2n) âˆ’Ï€(n). For the second part of item (c), use the fact that x
2 â‰¥x2/3

22
Hints and Solutions
585
and x + 2 â‰¤5x
4 for x â‰¥8. For item (d), make a direct checking of the cases
2 â‰¤n â‰¤8; then, prove the remaining cases by induction on n â‰¥8. Finally, for
item (e), use items (c) and (d), together with the (obvious!) inequality Ï€(x) â‰¤
2âŒŠx
2âŒ‹+ 2.
5. Note that
I(n) = (Ï„(1) + Ï„(3) + Â· Â· Â· + Ï„(i(n))) + (Ï„(2) + Ï„(4) + Â· Â· Â· + Ï„ (2âŒŠn/2âŒ‹))
= (1 + 3 + Â· Â· Â· + i(n)) + (Ï„(1) + Ï„(2) + Â· Â· Â· + Ï„ (âŒŠn/2âŒ‹))
= 1
4(i(n) + 1)2 + I âŒŠn/2âŒ‹) .
This gives (a), and iterating such a recurrence relation, we get (b). For (c), we
have
I(n) â‰¤1
4
t
k=0
 n
2k + 1
2
= 1
4
"
n2
t
k=0
1
4k + n
t
k=0
1
2kâˆ’1 + t + 1
#
= 1
4
n2
3

4 âˆ’1
4t

+ n

4 âˆ’
1
2tâˆ’1

+ t + 1

.
Now, since t = âŒŠlog2 nâŒ‹â‰¤n, we obtain (d) by estimating
I(n) â‰¤1
4
4n2
3
+ 4n + t + 1 âˆ’
n2
3 Â· 4âŒŠlog2 nâŒ‹âˆ’
2n
2âŒŠlog2 nâŒ‹

â‰¤1
4
4n2
3
+ 4n + t + 1

= 1
4
4n2
3
+ 4n +
-
log2 n
.
+ 1

â‰¤1
4
4n2
3
+ 4n + +n + 1

= 4n2 + 15n + 3
12
.
The estimates leading to (e) are quite analogous and will be left to the reader.
The ï¬rst part of (f) now follows immediately from (d) and (e), together with
T (n) = n(n+1)
2
. Hence,
4 âˆ’12
n âˆ’1
n2
6 + 6
n
â‰¤I(n)
T (n) â‰¤
4 + 15
n + 3
n2
6 + 6
n
for every n > 1, from where we get
lim
nâ†’+âˆ
I(n)
T (n) = 2
3. Thus, if r Ì¸= 2
3, then there
exists n0 âˆˆN such that
n > n0 â‡’
				
I(n)
T (n) âˆ’2
3
				 <
				r âˆ’2
3
				 .
In particular, n > n0 â‡’I(n)
T (n) Ì¸= 2
3.

586
22
Hints and Solutions
Section 9.2
1. From Chebyschevâ€™s theorem, there is at least one prime between pn and 2pn.
2. Letting p be the largest prime which does not exceed n, apply Chebyschevâ€™s
theorem to show that 2p > n.
3. If n = 2k, write 1!2! . . . n! = 2kk!(3!5! . . . , (2kâˆ’1)!)2 and, then, apply the result
of the previous problem. The case n = 2k + 1 can be dealt with in an analogous
way.
4. Let p and q denote the largest primes that do not exceed m and n, respectively.
Use the result of Problem 2 to compare the greatest powers of p and q in both
sides of the given equation.
5. Start by using the result of Problem 2 to show that n = p, a prime number; to this
end, follow a path analogous to the hint given to the previous problem. Then, if q
is the greatest integer which is less than or equal to p âˆ’1, conclude that m â‰¥2q.
Finally, use the remark that precedes the statement of this problem to conclude
that q â‰¤5 and, hence, that p âˆ’1 â‰¤6. To solutions are m = n = 2 or m = 10,
n = 7.
6. Let n > 1 be a natural number satisfying the stated conditions, and p < âˆšn
be a prime number. Then p | n, for otherwise we would have p2 < n and
gcd(n, p2) = 1. Thus, n is divisible by p1, . . . , pk, where p1 < Â· Â· Â· < pk are
those prime numbers less than âˆšn. Now, let l âˆˆN be such that 2l â‰¤âˆšn < 2l+1.
Since (invoking again the stronger version of Chebychevâ€™s theorem, alluded to
above) for every integer k > 1 we have at least two integers between 2k and
2k+1, we obtain
p1 . . . pk â‰¥2(22 . . . 2lâˆ’1)2 = 2l2.
This way,
2l2 â‰¤p1 . . . pk â‰¤n < 22l+2,
so that l â‰¤2. Hence, there are three cases to consider:
(i) l = 0: in this case, we have 1 â‰¤n < 4, and it is immediate to check that
n = 2 or 3 are the possible solutions.
(ii) l = 1: we have 4 â‰¤n < 16 and 2 | n, so that n âˆˆ{4, 6, 8, 10, 12, 14}. A
simple inspection show that the possible solutions are n = 4, 6, 8 or 12.
(iii) l = 2: in this last case we have that 16 â‰¤n < 64 and 2, 3 | n. Therefore,
n âˆˆ{18, 24, 30, 36, 42, 48, 54, 60} and, once more by inspection, we obtain
the solutions: n = 18, 24 or 30.

22
Hints and Solutions
587
Section 10.1
1. Make induction on m â‰¥2.
2. Use the elementary properties of congruences, together with the fact that 10 â‰¡
âˆ’1 (mod 11).
4. Use congruences to compute the remainder of the given number upon division
by 4. Then, apply the result of Proposition 10.9.
5. For k âˆˆZ+, show that 74k â‰¡1 (mod 10), 74k+1 â‰¡7 (mod 10), 74k+2 â‰¡
âˆ’1 (mod 10) and 74k+3 â‰¡3 (mod 10). Then, compute the remainder of the
division of 310 by 4.
6. If all prime divisors of n were congruent to 1, modulo 4, use the elementary
properties of congruences to conclude that we were to have n â‰¡1 (mod 4).
7. The ï¬rst equality gives us 232 + 228 Â· 54 â‰¡0 (mod 641); the second, 228 Â· 54 â‰¡
(âˆ’1)4 (mod 641).
8. Assume that the decimal representation of n has k + 1 digits, and let m be the
natural number formed by the ï¬rst k digits of n. Show that the stated condition
is equivalent to 6 Â· 10k + m = 4(10m + 6) or, also, to 3 Â· 10k = 13m + 12.
Then, conclude that it sufï¬ces to ï¬nd all natural numbers k for which 10k â‰¡
4(mod 13).
9. Start by observing that 2n +3n â‰¡0 (mod 7) if and only if 6n +9n â‰¡0 (mod 7),
which, in turn, is equivalent to (âˆ’1)n + 2n â‰¡0 (mod 7). Then, compute the
possible congruences of 2n, modulo 7.
10. Apply congruence modulo 3 to show that either p or q must be a multiple of 3,
hence equal to 3. Then, assuming q = 3, write p2 + 9p + 9 = n2 and solve
such an equality for p.
11. For item (a), start by reducing the terms of the Fibonacci sequence modulo
2 and modulo 4, and note that the two reduced sequences thus obtained are
periodic. Items (b), (c), (d) and (e) can be dealt with analogously.
12. Start by using the result of item (c) of Problem 2, page 71, to conclude that if
d = gcd(Fn, Ln), then d | 4. Now, distinguish the cases 3 âˆ¤n and 3 | n, and
apply the results of the previous problem.
13. For items (a) and (b), use induction on n âˆˆN. For item (c), start by using the
result of item (a) to write 2Fm+2k = FmL2k + F2kLm. Then use the result of
the item (b) of Problem 2, page 71, as well as (a) again, to get
2Fm+2k = Fm(L2
k + 2(âˆ’1)kâˆ’1) + FkLkLm â‰¡2(âˆ’1)kâˆ’1Fm (mod Lk).
Now, apply the result of item (b) of Problem 11, taking into account that 2 | k
and 3 âˆ¤k. For item (d), argue in an analogous way, writing
2Lm+2k = 5FmF2k+LmL2k = 5FmFkLk+Lm(L2
k+2(âˆ’1)kâˆ’1)â‰¡âˆ’2Lm (mod Lk)
and, hence, Lm+2k â‰¡âˆ’Lm (mod Lk).
14. Apply item (d) of Proposition 10.9.

588
22
Hints and Solutions
15. Look at the equation modulo 3 to conclude that m is even. Then, factorize k2 âˆ’
2m and argue as in Example 10.11.
16. If n â‰¥5, show that mp â‰¡3 (mod 10) and, hence, that p > 2. Then, use modulo
3 to conclude that 3 | m, so that 27 | mp. Finally, look at the equation modulo
27 to conclude that there is no solution when n â‰¥9.
17. Use modulo 3 to show that z is even, say z = 2t. Then, factor 52t âˆ’4y and
argue as in Example 10.11.
18. If y = 1, then p = 2 and x = 1. If y > 1, write px = (y + 1)(y2 âˆ’y + 1)
and show that, letting d = gcd(y + 1, y2 âˆ’y + 1), one has d = 1 or 3. Finally,
consider separately the cases d = 1 and d = 3.
19. Write a = 2kÎ± and b = 2lÎ², with k, l âˆˆN and Î±, Î² being odd naturals. From
this, show that kb = la and Î±b + Î²a = 2câˆ’kb. Then, use modulo 4 to conclude
that Î± = Î² = 1 and k
2k =
l
2l . Finally, analysing the function f (x) = x
2x , show
that, if k, l â‰¥4, then k = l.
20. Firstly, show that it sufï¬ces to consider the case b = an. Then, in order
to analyse it, make induction on n â‰¥0, using congruence modulo a at the
induction step.
21. Start by looking at the given equation modulo 3 to show that b is even. Then,
let b = 2c and conclude that 2c+1 = 15a + 1 or 2c+1 = 3a + 5a. Let d = c + 1
and, in the ï¬rst case, use modulo 3 to conclude that d is even and, hence, that
2d/2 âˆ’1 = 3a and 2d/2 + 1 = 5a. In the second case, use modulo 4 to show
that a is odd, so that, if c âˆ’2 > 0, we have
2câˆ’2 = 3aâˆ’1 âˆ’3aâˆ’2 Â· 5 + Â· Â· Â· + 5aâˆ’1 â‰¡a (mod 2).
Thus, conclude that c âˆ’2 = 0.
22. Using the fact that 1992 = 24 Â· 83, show that the division of 101992 by 1083 + 7
leaves remainder 724. Then, if q âˆˆN is such that 101992 = (1083 + 7)q + 724,
use congruence modulo 10 to compute the last digit of q.
23. For item (a), if x is even, say x = 2z, we get (7z âˆ’2)(7z + 2) = 3y. Conclude
that both 7z âˆ’2 and 7z + 2 must be powers of 3, and use the fact that (7z +
2) âˆ’(7z âˆ’2) = 4 to get a contradiction. For item (b), assuming that if y > 1,
show that 7x = 3y + 4 â‰¡4 (mod 9), and that this gives x â‰¡2 (mod 3). Hence,
deduce that x â‰¡2 (mod 3) and x â‰¡1 (mod 2) implies x â‰¡5 (mod 6). Item (c)
now follows from letting x = 6q + 5 and computing
7x = 76q+5 = (76)q Â· 75 â‰¡(âˆ’1)q Â· (âˆ’2) â‰¡Â±2 (mod 13).
Finally, for (d) and (e), compute 3y â‰¡1, 3 or 9 (mod 13) and, hence, 3y + 4 â‰¡
5, 7 or 0 (mod 13); then, show that this contradicts (c).
25. Looking at the equation modulo x + 1, we obtain (âˆ’1)z+1 â‰¡1 (mod x + 1).
Therefore, from x > 1 show that z is odd. Now, write
(x + 1)y = xz + 1 = (x + 1)(xzâˆ’1 âˆ’xzâˆ’2 + Â· Â· Â· âˆ’x + 1),

22
Hints and Solutions
589
to get (x + 1)yâˆ’1 = xzâˆ’1 âˆ’xzâˆ’2 + Â· Â· Â· âˆ’x + 1. If x is odd, show that both
sides of this last equation have different parities, which cannot occur. Now, use
the fact that x is odd, together with
xzâˆ’1 = (x + 1)y âˆ’1
x
= (x + 1)yâˆ’1 + Â· Â· Â· + (x + 1) + 1,
to show that y is also even. Then, letting x = 2s and y = 2t, we have
B
(x + 1)t âˆ’1
C B
(x + 1)t + 1
C
= (2s)z.
(22.2)
Note now that (x + 1)t âˆ’1 and (x + 1)t + 1 are consecutive even numbers, so
that they have gcd equal to 2. Use modulo x to get (x + 1)t âˆ’1 â‰¡0 (mod x)
and (x + 1)t + 1 â‰¡2 (mod x), so that the ï¬rst factor is a multiple of x, whereas
the second one is of the form xq + 2, with 2 being its only common factor with
x. Use this to conclude from (22.2) that
(x + 1)t âˆ’1 = 2sz
(x + 1)t + 1 = 2zâˆ’1 .
Then, ï¬nish the solution.
Section 10.2
1. Apply Fermatâ€™s little theorem with p = 7.
2. Start by considering the cases p = 2, 3, 5. If p Ì¸= 2, 3, 5, write the given
difference as
(a Â· 108p âˆ’108) + 2(a Â· 107p âˆ’107) + Â· Â· Â· + 9(a âˆ’1),
(22.3)
where a = 11 . . . 1
  
p
. Then, apply Fermatâ€™s little theorem to conclude that a â‰¡
1 (mod p) and to analyse the remainder of the division by p of each summand
of (22.3).
3. Show that, after performing k â‰¥1 operations, the j-th term of the sequence
goes to position 2kj (mod 2n + 1). Then, use Fermatâ€™s little theorem.
4. Firstly, use modulo 11 to conclude that there are no integer solutions such
that x â‰¡0 (mod 11). Then, if x Ì¸â‰¡0 (mod 11), use Fermatâ€™s little theorem
to conclude that 11 divides x5 + 1 or x5 âˆ’1 and, hence, that y2 â‰¡âˆ’5 or
âˆ’3 (mod 11). Finally, show that such congruences do not have any solutions.
5. We may assume p > 2. In this case, if n = pq + r, Fermatâ€™s little theorem
assures that it sufï¬ces to ï¬nd an integer 0 â‰¤r < p such that 2q+r â‰¡r (mod p)
for inï¬nitely many naturals q. For what is left to do, choose r = 1 and, then,
inï¬nitely many qâ€™s.

590
22
Hints and Solutions
6. For the sake of contradiction, assume that there exists an integer n > 1 such that
n | (3n âˆ’2n). If p is the smallest prime factor of n, with n = mp, use Fermatâ€™s
little theorem to conclude that 3m â‰¡2m (mod p). Then, use the minimality of
p to show that gcd(m, p âˆ’1) = 1. Finally, write mx = (p âˆ’1)y + 1, with
x, y âˆˆN, and use Fermatâ€™s little theorem once more to reach a contradiction.
7. For item (b), start by using the fact that gcd(p, q âˆ’1) = 1 to write px =
(q âˆ’1)y + 1, with x, y âˆˆN. Then, apply Fermatâ€™s little theorem.
8. If k stands for the number of digits of 5n, show that the problem is equivalent
to ï¬nding m > n for which 5m âˆ’5n â‰¡0 (mod 10k). Prove that n â‰¥k and
conclude that it sufï¬ces for us to have 5mâˆ’n â‰¡1 (mod 2k). Then, use Eulerâ€™s
theorem.
9. With the aid of Eulerâ€™s theorem, prove ï¬rst that if l is odd, then gcd(2Ï•(l)m âˆ’
3, l) = 1, for every m âˆˆN. Then, choose k1, . . . , kn inductively.
10. Use MÃ¶bius inversion formula to get an = 
0<d|n Î¼(d)2
n
d . Now, use Eulerâ€™s
theorem to show that, if p is prime and pÎ± is the greatest power of p that divides
n, then pÎ± | an. To this end, write n = pÎ±k, with gcd(k, p) = 1, and, from this,
an =

0<d|pÎ±k
Î¼(d)2
pÎ±k
d
=

0<d|k
Î¼(d)2
pÎ±k
d
+

0<d|k
Î¼(pd)2
pÎ±k
pd
=

0<d|k
Î¼(d)2
pÎ±k
d
âˆ’

0<d|k
Î¼(d)2
pÎ±âˆ’1k
d
=

0<d|k
Î¼(d)

2
pÎ±âˆ’1k
d
p
âˆ’2
pÎ±âˆ’1k
d
/
=

0<d|k
Î¼(d)2pÎ±âˆ’1Â· k
d

2
pÎ±âˆ’1(pâˆ’1)k
d
âˆ’1

=

0<d|k
Î¼(d)2pÎ±âˆ’1Â· k
d

2Ï•(pÎ±)Â· k
d âˆ’1

.
11. For item (a), argue by contradiction. More precisely, if a = (p1âˆ’1) . . . (pkâˆ’1),
with k â‰¥1 minimum as in (a), use the fact that gcd(2a/2 âˆ’1, 2a/2 + 1) = 1 to
conclude that there exist l < k primes among p1, . . . , pk, say p1, . . . , pl, such
that 2a/2 âˆ’1 = pÎ±1
1 . . . pÎ±l
l . Then, letting b = (p1 âˆ’1) . . . (pl âˆ’1), use the fact
that (2b âˆ’1) | (2a/2 âˆ’1) to contradict the minimality of k.
12. For item (b), use Fermatâ€™s little theorem. For (f), if q âˆ¤x, show that x(qâˆ’1)/2 â‰¡
Â±1 (mod q), and analogously for y(qâˆ’1)/2 and z(qâˆ’1)/2; then, use the equality
x(qâˆ’1)/2 + y(qâˆ’1)/2 + z(qâˆ’1)/2 = 0, together with q > 5, to get a contradiction.
Finally, for (g) ii., observe that if q | a and gcd(a, d) = 1, then q âˆ¤d.
13. For item (e), you will need to use the result of Example 8.14. For item (h), ï¬rst
show that qn = 2nâˆ’1q1+(2nâˆ’1âˆ’1), for every integer n â‰¥1; then, use Fermatâ€™s
little theorem to show that, if q1 is an odd prime, then it is possible to choose
n â‰¥2 such that q1 | qn.

22
Hints and Solutions
591
Section 10.3
1. We prove both items simultaneously. If x is an integer such that ax â‰¡b (mod n),
then we have ax = nq + b for some q âˆˆZ. Therefore, b = xa + (âˆ’q)n, a linear
combination of a and n, so that BÃ©zoutâ€™s theorem furnishes gcd(a, n) | b. Now,
let gcd(a, n) = d, with d | b. Then,
ax â‰¡b (mod n) â‡”a
d x â‰¡b
d

mod n
d

.
However, since gcd
 a
d , n
d

= 1, the existence of solution follows from Corol-
lary 10.25. For what is left to do, start by noticing that
ax â‰¡ax0 (mod n) â‡”x â‰¡x0

mod n
d

â‡”x = x0 + n
d t, âˆƒt âˆˆZ.
On the other hand, it is immediate that
x0 + n
d t1 â‰¡x0 + n
d t2 (mod n) â‡”t1 â‰¡t2 (mod d),
so that there are as many pairwise incongruent solutions for the original equation
as there are integer values for t pairwise incongruent modulo d. Thus, the original
equation has exactly d = gcd(a, n) pairwise incongruent solutions modulo n.
2. Assuming that the given congruence has any solution at all, use BÃ©zoutâ€™s
theorem, together with item (d) of Proposition 10.6, to show that the gcd between
gcd(a1, a2, . . . , ak) and n divides b. Then, observe that
gcd(gcd(a1, a2, . . . , ak), n) = gcd(a1, a2, . . . , ak, n).
(22.4)
For the converse, apply BÃ©zoutâ€™s theorem once more, together with (22.4).
3. Letting x denote the total of soldiers, show that it satisï¬es a system of two linear
congruences with relatively prime moduli. Then, use the proof of the Chinese
remainder theorem to show that
x â‰¡7 Â· 12 Â· 12 + 5 Â· 1 Â· 13 (mod 12 Â· 13)
and, hence, that x = 132q + 17 for some q âˆˆZ. Finally, use the fact that
600 < x < 700.
4. For item (a), start by observing that, if u, v is a solution of the linear diophantine
equation and x = m1u + a1 = m2v + a2, then x solves (10.7) for k = 2.
5. Apply Eulerâ€™s theorem.
6. If p and q are distinct primes, Example 6.29 assures that 2p âˆ’1 and 2q âˆ’1 are
relatively prime. In view of this fact, show that an integer x satisï¬es the stated
conditions if and only if it solves a certain system of linear congruences. Then,
apply the Chinese remainder theorem.

592
22
Hints and Solutions
7. Adapt, to the present case, the idea of the proof of Example 10.28.
8. For implication â‡of item (a), let ai âˆˆZ be an integer solution of f (x) â‰¡
0 (mod pÎ±i
i ). If x is any solution of the system of linear congruences
â§
âªâªâ¨
âªâªâ©
x â‰¡a1 (mod pÎ±1
1 )
x â‰¡a2 (mod pÎ±2
2 )
. . .
x â‰¡ak (mod pÎ±k
k )
whose existence is guaranteed by the Chinese remainder theorem, use item (c)
of Proposition refprop:propriedades da congruencia to conclude that f (x) â‰¡
0 (mod pÎ±i
i ) for 1 â‰¤i â‰¤k and, hence, that f (x) â‰¡0 (mod m). For item
(b), let S(t) be a set of N(t) pairwise incongruent solutions, modulo t, for the
congruence f (x) â‰¡0 (mod t). Use the result of (a) to infer the existence of a
bijection f : S(m) â†’S(pÎ±1
1 ) Ã— Â· Â· Â· Ã— S(pÎ±k
k ); then, apply the fundamental
principle of counting.
9. If a is the initial term and r the common ration of the progression, the given
hypotheses are equivalent to the existence of x, y âˆˆN such that x2 â‰¡a (mod r)
and y3 â‰¡a (mod r). By the same token, the thesis is equivalent to the existence
of z âˆˆN such that z6 â‰¡a (mod r). Make complete induction on r, the case
r = 1 being trivial. For the induction step, separately consider the cases r = pÎ±,
for some prime p and some Î± âˆˆN, and r = st, with s, t > 1 relatively prime.
In the ï¬rst case, if x and y are as above and yâ€² is the inverse of y modulo pÎ±,
show that z = xyâ€² solves the problem. In the second case, let u and v be terms of
the arithmetic progressions (a + ks)kâ‰¥0 and (a + kt)kâ‰¥0, respectively, such that
u6 â‰¡a (mod s) and v6 â‰¡a (mod t); use the Chinese remainder theorem to ï¬nd
z âˆˆN such that z6 â‰¡a (mod st).
Section 11.1
1. Note that a1 + a2 + Â· Â· Â· + an â‰¡1 + 2 + Â· Â· Â· + n (mod n).
2. Adapt the proof of item (b) of Proposition 11.3 to the present case.
3. Adapt the discussion of Example 11.4 to this case, this time using the result of
the previous problem.
Section 11.2
2. This amounts to noticing that aÂ·(b+c) = aÂ·b + c = a Â· (b + c) = a Â· b + a Â· c =
a Â· b + a Â· c = a Â· b + a Â· c.

22
Hints and Solutions
593
3. If a = c and b = d, then a â‰¡c (mod n) and b â‰¡d (mod n), so that a âˆ’b â‰¡
c âˆ’d (mod n). But this is the same as saying that a = c and b = d imply
a âˆ’b = c âˆ’d, which is exactly what we wanted to verify.
4. The units of Z12 are 1, 5, 7 and 11 (note that Ï•(12) = 4). Since 1
2 = 5
2 = 7
2 =
11
2 = 1, there is nothing left to do.
5. Adapt, to the present case, the discussion of the well deï¬niteness of the
operations of addition and multiplication in Zn.
6. For the ï¬rst part, if n > 1 is not prime, write n = ab, with 1 < a, b < n. For the
second, note that if a Â· b = 0 in Zp, then p | ab and, hence, p | a or p | b.
7. For the ï¬rst part, look at the particular case a Â· x = 1. For the second, multiply
both sides of a Â· x = b by aâˆ’1 and use the associativity of multiplication.
Section 12.1
2. By contradiction, if 23n â‰¡âˆ’1 (mod 17), then 22Â·3n â‰¡1 (mod 17). Now, use the
congruence 216 â‰¡1 (mod 17) to conclude that ord17(2) = 1 or 2, which is a
contradiction.
3. If m = ord n(a), then m | 2k and, by Eulerâ€™s theorem, m | Ï•(n). Hence, m |
gcd(2k, Ï•(n)) = 2d, where d = gcd(k, Ï•(n)/2) (recall that n > 2 â‡’Ï•(n)
evenâ€”cf. Problem 19, page 220). If m | d, then m | k, which contradicts the
given congruence. Therefore, m = 2dâ€² for some divisor dâ€² of d, and hence m is
even.
4. If n | (2n âˆ’1), then n is odd. If n > 1 and k = ordn(2), then 1 < k | n, Ï•(n).
Now choose, from the very beginning, the least possible natural number n > 1
such that n | (2n âˆ’1). Arrive at a contradiction by showing that k | (2k âˆ’1).
5. Let S denote the given product. Legendreâ€™s formula (6.10) assures that the
greatest power of 2 that divides n! has exponent
e2(n) =
+âˆ

j=1
 n
2j

<
+âˆ

j=1
n
2j = n;
therefore, e2(n) â‰¤n âˆ’1 and, hence, 2e2(n) | S. Now, let 2 < p â‰¤n be prime
and l be the exponent of the greatest power of p that divides S. Use the fact that
2n âˆ’2t â‰¡0 (mod pj) if and only if ordpj (2) | (n âˆ’t), together with the idea of
the proof of Legendreâ€™s formula, to conclude that
l =

jâ‰¥1
D
n
ordpj (2)
E
>

jâ‰¥1
( n
pj
)
= ep(n)).
6. Show that ki+1 â‰¡2ki (mod 2n + 1). Then, for item (a) conclude that f (n) = 0
if and only if the set {1, 2, 22, 23, . . .} contains a RRS modulo 2n + 1. For item
(b), show that

594
22
Hints and Solutions
f (1997) = 2 Â· 1997 âˆ’ord2Â·1997+1(2)
and compute ord2Â·1997+1(2) = 8Â·23 = 184 by using the equalities 2Â·1997+1 =
5 Â· 17 Â· 47, ord17(2) = 8 and ord47(2) = 23.
7. Assume that we have found q as in (a), so that p | (q âˆ’1). Arguing by
contradiction, suppose further that there exists n âˆˆN such that np â‰¡p (mod q).
Since p Ì¸= q, we have gcd(n, q) = 1, and Fermatâ€™s little theorem gives
1 â‰¡nqâˆ’1 â‰¡p
qâˆ’1
p (mod q), which is impossible. For (b), note that a â‰¡ppâˆ’1 +
ppâˆ’2 + Â· Â· Â· + p + 1 â‰¡p + 1 (mod p2), so that a has at least one prime factor q
for which q Ì¸â‰¡1 (mod p2). In turn, if k = ordq(p), then the fact that a | (pp âˆ’1)
gives k | p; if k = 1, we would have 0 â‰¡a â‰¡ppâˆ’1+ppâˆ’2+Â· Â· Â·+p+1 (mod q),
so that p = q, a contradiction.
Section 12.2
1. Compute 214 â‰¡âˆ’1 (mod 29) and, then, conclude that ord29(2) = 28.
2. Separately consider each one of the cases n = 2, 4, pk and 2pk, with p being
an odd prime and k âˆˆN.
3. Letting a be a primitive root modulo n, note that the aiâ€™s are congruent modulo
n, is some order, to a, a2, . . . , aÏ•(n), so that
a1a2 . . . aÏ•(n) â‰¡a
Ï•(n)(Ï•(n)+1)
2
(mod n).
Now, if n = 2 or 4, give a direct argument to show that a
Ï•(n)(Ï•(n)+1)
2
â‰¡
âˆ’1 (mod n); if n = pk or 2pk, for some odd prime p and some k âˆˆN,
use the fact that ordn(a) = Ï•(n) to conclude that a
Ï•(n)
2
â‰¡âˆ’1 (mod n)â€”be
careful: n | (a
Ï•(n)
2 + 1)(a
Ï•(n)
2 âˆ’1) does not necessarily imply n | (a
Ï•(n)
2 + 1) or
n | (a
Ï•(n)
2
âˆ’1).
4. Firstly, adapt the proof of Lemma 12.12 to the present case, showing (by
induction) that for every integer n â‰¥3 there exists an odd integer q such that
192nâˆ’2 = 2q + 1. Back to the posed problem, start by taking k1 = 1, and
k2 = 2. Then if 19kn âˆ’97 = 2nq and q is even, take kn+1 = kn; if q is odd,
take kn+1 = kn + 2nâˆ’2.
5. Ultimately, the solution of this problem also relies in a variation of the idea of
the proof of Lemma 12.12. Indeed, one wants to ï¬nd inï¬nitely many m âˆˆN
such that m2 + 7 â‰¡0(mod 2k). Start by showing that it sufï¬ces to establish the
existence, for every l âˆˆN, of ml âˆˆN such that m2
l +7 â‰¡0(mod 2l); then, prove
this last statement by induction on l. For the induction step, if m2
l + 7 = 2lnl,
with l â‰¥3 and nl odd, try ml+1 = aml and show that it is enough to have
a2 = 2lq + 1, with q odd; then, prove that a = 52lâˆ’3 works.

22
Hints and Solutions
595
6. If a3pqâˆ’1 â‰¡1 (mod 3pq), then a3pqâˆ’1 â‰¡1 (mod p); in particular, letting a be
a primitive root modulo p, we must have (p âˆ’1) | (3pq âˆ’1) and, analogously,
(q âˆ’1) | (3pq âˆ’1). From this, conclude that (p âˆ’1) | (3q âˆ’1) and (q âˆ’1) |
(3p âˆ’1), from where p = 11 and q = 17 or vice-versa. Finally, show that
a3Â·11Â·17âˆ’1 â‰¡1 (mod 3Â·11Â·17) for every natural number a relatively prime with
3 Â· 11 Â· 17. To show that p = 11 and q = 17 if p â‰¤q, one can argue in the
following manner: since p â‰¤q, we have
3p âˆ’1
q âˆ’1 â‰¤3q âˆ’1
q âˆ’1 = 3 +
2
q âˆ’1 â‰¤3 + 2
4,
so that 3pâˆ’1
qâˆ’1
= 1, 2 or 3; analysing each one of these cases separately, we
conclude that 3p âˆ’1 = 2(q âˆ’1) and, hence, 3qâˆ’1
pâˆ’1 = 9qâˆ’3
2qâˆ’4, a number greater
than 4 and less than 8; thus, 9qâˆ’3
2qâˆ’4 = 5, 6 or 7, and these possibilities lead to
q = 17 as the only actual one.
7. For item (d), take a separate look at each one of the cases ordp(x) = 1, 2, pâˆ’1
2
and p âˆ’1â€”here we used the fact that pâˆ’1
2
is also prime.
8. For (a) â‡’(b), write n = p1 . . . pk, with p1 < Â· Â· Â· < pk being primes such
that (pi âˆ’1) | (n âˆ’1); then, apply Fermatâ€™s little theorem to conclude that
an â‰¡a (mod pi), for every 1 â‰¤i â‰¤k. For (b) â‡’(a), take a prime divisor p
of n and let a be a primitive root modulo p2 to obtain a contradiction if p2 | n;
then, let a be a primitive root modulo p, to show that (p âˆ’1) | (n âˆ’1).
9.
sn â‰¡1 + qi
"
api(nâˆ’1) âˆ’anâˆ’1
anâˆ’1 âˆ’1
#
(mod pi).
For item (a), observe that
pqâˆ’1

j=0
pâˆ’1

l=0
(pj + l)nâˆ’1 â‰¡
pqâˆ’1

j=0
pâˆ’1

l=0
lnâˆ’1 â‰¡pq Â·
pâˆ’1

l=0
lnâˆ’1 â‰¡0 (mod p).
For item (b), use (a) to conclude that, if n = p2q, with p prime and q natural,
then sn â‰¡1 (mod p). Item i. goes through with a computation analogous to that
of the hint given to item (a). Item ii. follows immediately from i., together with
the fact that, modulo pi, we have {a, a2, . . . , apiâˆ’1} = {1, 2, . . . , pi âˆ’1}. Fpr
iii., if n | sn, then sn â‰¡0 (mod pi). However, since pi | (api(nâˆ’1) âˆ’anâˆ’1), the
formula in ii. guarantees that the only way of having sn â‰¡0 (mod pi) is to have
pi | (anâˆ’1âˆ’1). Then, pi âˆ’1 = ordpi(a) | (nâˆ’1) and, hence, (pi âˆ’1) | (qi âˆ’1)
(since n âˆ’1 = (pi âˆ’1)qi + (qi âˆ’1)). For item iv., if n | sn, then pi | sn, and
it follows from i. and iii. (more precisely from (pi âˆ’1) | (n âˆ’1)) that

596
22
Hints and Solutions
0 â‰¡sn = 1 + qi
piâˆ’1

l=1
lnâˆ’1 â‰¡1 + qi
piâˆ’1

l=1
1 â‰¡1 + qi(pi âˆ’1) (mod pi).
Hence, qi(pi âˆ’1) â‰¡âˆ’1 â‰¡pi âˆ’1 (mod pi), so that qi â‰¡1 (mod pi). Finally
in what concerns item v., it is enough to show that if pi(pi âˆ’1) | (qi âˆ’1)
for 1 â‰¤i â‰¤t, then pi | sn for 1 â‰¤i â‰¤t; to this end, it sufï¬ces to use
the congruence of item i., together with the fact (easily deducible from our
hypotheses) that (pi âˆ’1) | (n âˆ’1).
10. For item (a), if gcd(ak+1, n) > 1 then n | (ak+1), and hence a2k â‰¡1 (mod n);
this contradicts the fact that ordn(a) = 2pk. For i., it follows from akp â‰¡
âˆ’1 (mod n) that a2kp â‰¡1 (mod n), and thus d | 2kp = nâˆ’1. On the other hand,
if d | 2k, then a2k â‰¡1 (mod n) and, this way, n | (ak âˆ’1)(ak + 1); however,
since gcd(ak + 1, n) = 1, we get n | (ak âˆ’1) and then akp â‰¡1 (mod n), an
absurd. Now, if d | 2kp and d âˆ¤2k, it is immediate to see that gcd(d, p) > 1,
and hence that p | d; therefore, the last part of i. follows from Eulerâ€™s theorem.
For ii., it is pretty clear that p âˆ¤(2kp+1); therefore, the formula for Ï•(2kp+1)
assures that p | (q âˆ’1), for some prime divisor q of 2kp + 1; thus, it sufï¬ces to
let q âˆ’1 = lp, noticing that l > 1, for otherwise both p and q = p + 1 would
be odd primes, which is impossible. Finally, for iii., if 2kp + 1 = (lp + 1)u
then u â‰¡1 (mod p), so that u = hp + 1 for some h â‰¥1. If h â‰¥2, then
n = (lp + 1)(hp + 1) â‰¥(2p + 1)2 > 2(2p + 1)p + 1 â‰¥2kp + 1 = n, which
is impossible. Therefore, h = 0 or 1, and if h = 1 then (p + 1) | (2kp + 1), an
absurd (for p + 1 is even and 2kp + 1 is odd.
11. Show2 ï¬rst (by induction) that for every k âˆˆN there exists a natural number
mk of k digits, all of which equal to 1 or 2, such that 2k | mk. Now, note that
5 âˆ¤q1000, and use the fact that 2 is a primitive root modulo 51000 to ï¬nd k âˆˆN
with 2k â‰¡q1000 (mod 51000). Finally, writing 2k = a Â· 51000 + q1000, for some
a âˆˆN, show that 2k+1000 has the desired properties.
12. Item (a) follows from Fermatâ€™s little theorem, together with the fact that x4
1 +
x4
2 + x4
3 + x4
4 + x4
5 â‰¡0 (mod p) if and only if f (x1, . . . , x5) â‰¡1 (mod p).
Item (b) follows from the multinomial formula desenvolvimento multinomial
(cf. Problem 2, page 28) and from the result of (a).
Section 12.3
1. Use Eulerâ€™s criterion.
2. Adapt the proof of Example 12.24 to the present case to obtain inï¬nitely many
integer values of k having the desired property.
2This is based on the solution given by professor Carlos Gustavo Tamm de A. Moreira.

22
Hints and Solutions
597
3. Start by multiplying equality ax2 + bxy + cy2 = n by 4a and completing
squares.
4. First show that if such x and y did exist, then they would be relatively
prime with 122. Then, use the result of the previous problem to conclude
that 17 should be a quadratic residue modulo 61. Finally, apply the quadratic
reciprocity law and Proposition 12.23 to reach a contradiction.
5. For item (a), if every prime divisor of 2b2 + 3 was congruent to Â±1 modulo 8,
we would have 2b2 + 3 â‰¡Â±1 (mod 8); show that this is impossible. For (b), if
(2b2 + 3) | (a2 âˆ’2) and p is as in (a), then a2 â‰¡2 (mod p), so that 2 would
be a quadratic residue modulo p; use the result of Example 12.27 to reach a
contradiction.
6. Let Ln = 2x2. If n is odd, use item (b) of Problem 11, page 252, together
with the fact that Ln is even, to show that n â‰¡3 or 9 (mod 12). Then, apply
several times item (e) of this same problem to get Ln â‰¡L3 or L9 â‰¡4 (mod 8),
and show that this gives x2 â‰¡2 (mod 4), which is impossible. Now, assuming
that n is even, consider the following three separate cases: n â‰¡0 (mod 4),
n â‰¡6 (mod 8) or n â‰¡2 (mod 8). If n â‰¡0 (mod 4), write n = 2Â·3lÂ·k, with k âˆˆZ
such that 2 | k, 3 âˆ¤k. Argue as in the proof of Example 12.25 to obtain Ln â‰¡
âˆ’L0 = âˆ’2 (mod Lk) and, hence, x2 â‰¡âˆ’1 (mod Lk). Show that this furnishes
a contradiction, exactly as the one obtained in the proof of Example 12.25. If
n â‰¡6 (mod 8) but n = 6 (note that L6 = 18 = 2 Â· 32), write n = 6 + 2 Â· 3l Â· k,
with k âˆˆZ such that 4 | k and 3 âˆ¤k. Use item (d) of Problem 13, page 253, to
obtain Ln â‰¡âˆ’L6 = âˆ’18 (mod Lk), and hence x2 â‰¡âˆ’9 (mod Lk). Also as in
the proof of Example 12.25, conclude that one can take a prime divisor p of Lk
such that p â‰¡3 (mod 4), so that x2 â‰¡âˆ’9 (mod p). Then, show that 3 âˆ¤Lk, so
that gcd(p, 9) = 1 and, thus,
 âˆ’9
p

=
 9
p
 âˆ’1
p

=
 âˆ’1
p

= âˆ’1. Finally, in the
case n â‰¡2 (mod 8), just note that Lâˆ’n = Ln and âˆ’n â‰¡6 (mod 8).
7. Let Fn = x2. If n â‰¡1 (mod 4) but n Ì¸= 1, write n = 1 + 2 Â· 3l Â· k, with
k âˆˆZ such that 2 | k, 3 âˆ¤k. Use item (c) of Problem 13, page 253, to
get Fn â‰¡âˆ’F1 = âˆ’1 (mod Lk); then, arrive at a contradiction, exactly as in
the proof of Example 12.25. If n â‰¡3 (mod 4), use the fact that Fâˆ’n = Fn
and âˆ’n â‰¡1 (mod 4). If n is even, write n = 2m and apply item (a) of
Problem 13, page 253 to get Fn = FmLm. Then, distinguish two distinct
subcases: if gcd(n, 3) = 1, use Problem 12, page 252 to conclude that Lm is
also a perfect square; then, apply the result of Example 12.25. If gcd(n, 3) = 3,
use Problem 12, page 252, again to conclude that Lm is twice a perfect square;
then, apply the result of the previous problem.
8. Apply Gaussâ€™ lemma, as was done in Example 12.27, or the quadratic reci-
procity law.
9. For item (a), if every prime divisor of 2n âˆ’1 was congruent to Â±1 modulo 12,
we would have 2n âˆ’1 â‰¡Â±1 (mod 12); show that this is impossible. For (b), if
(2n âˆ’1) âˆ¤(3m âˆ’1) and p is as in (a), then 3m â‰¡1 (mod p) or, which is the
same, 3m+1 â‰¡3 (mod p); since m + 1 is even, it would follow that 3 would be

598
22
Hints and Solutions
a quadratic residue modulo p; now, use the result of the previous problem to
get a contradiction.
10. For item (a), use the quadratic reciprocity law. For item (b), use the result of
Corollary 12.20, together with the fact that p âˆ’1 is a power of 2.
11. For item (a) make induction on k â‰¥3, showing that if x2
k â‰¡a (mod 2k), then
x2
k+1 â‰¡a (mod 2k+1), with xk+1 = xk or xk +2kâˆ’1. For (b) make an analogous
induction; more precisely, if x2
k = pkq + a, let xk+1 = xk + pkt, with t âˆˆZ,
and impose the validity of the congruence x2
k+1 â‰¡a (mod pk+1) to deduce that
t must satisfy the linear congruence 2xkt â‰¡âˆ’q (mod p); ï¬nally, show that it is
always possible to choose such a t.
12. If x2 â‰¡a (mod n) for some integer x, then x2 â‰¡a (mod 2k) and x2 â‰¡
a (mod pki
i ), for 1 â‰¤i â‰¤t; it then sufï¬ces to apply the results of the
previous problem, together with Eulerâ€™s criterion. Conversely, if conditions (i)
and (ii) are satisï¬ed, apply once more the results of the previous problem and
Eulerâ€™s criterion to assure the existence of integers x0, x1, . . . , xt such that
x2
0 â‰¡a (mod 2k) and x2
i â‰¡a (mod pki
i ), for 1 â‰¤i â‰¤t; then, invoke the chinese
remainder theorem to get, out of the xiâ€™s, an integer x such that x2 â‰¡a (mod n).
13. Number the children in the counterclockwise sense and in a continuous way,
so that the child at positions 1, n + 1, 2n + 1, 3n + 1, . . . is the same one, and
analogously for the remaining children. Show that the teacher will give candies
to the children situated at positions k(k+1)
2
, for k âˆˆN, so that it sufï¬ces to
ï¬nd all natural values of n for which the congruence x(x+1)
2
â‰¡a (mod n) has a
solution for every integer 1 â‰¤a â‰¤n. Now, notice that if such a congruence has
a solution, then the same holds with the congruence (2x+1)2 â‰¡8a+1 (mod n).
Finally, use the results of Problem 12 to show that n must be a power of 2.
14. For â‡’, use Fermatâ€™s little theorem. For â‡, let Î± be a primitive root modulo
p, and j âˆˆN be such that n
d j â‰¡âˆ’1

mod pâˆ’1
d

; then, take k âˆˆN such that
Î±k â‰¡aj (mod p) and show that k | d and x0 = Î±k/d solves the congruence
xn â‰¡a (mod p).
15. Items (a) to (d) only require simple algebraic manipulations and elementary
properties of congruences. For the ï¬rst part of item (e), use Wilsonâ€™s theorem,
together with Eulerâ€™s criterion; for the second part assume, by the sake of
contradiction, that ri â‰¡rj (mod p) and use the fact that p âˆ¤(j2 âˆ’i2). For
the second part of (f), conclude that
pâˆ’1
2

j=1
rj â‰¡
pâˆ’1
2

j=1
j2 â‰¡0 (mod p),
where, in the last congruence, we used the fact that p â‰¥5.

22
Hints and Solutions
599
Section 12.3
1. Start by showing, with the aid of Proposition 10.9, that if such integers k, l,
x, y and z did exist, with l â‰¥1, then x, y and z would all be even. Then,
use this to reduce the analysis to the case l = 0, and use again the results of
Proposition 10.9.
2. By contradiction, suppose that a+b is even. Then, a+c2 = a2âˆ’b2 â‰¡0 (mod 4),
and hence a â‰¡âˆ’c2 (mod 4). From this, conclude that a(a âˆ’1) has a prime factor
congruent to 3 modulo 4 and which appears in its canonical decomposition with
odd exponent.
3. Observe that 1995 = 3 Â· 5 Â· 7 Â· 19, with 3, 7, 19 â‰¡3 (mod 4). On the other
hand, if d is a positive divisor of 1995 (the case d < 0 can be handled in a
totally analogous way), analyse separately the following four possibilities: d = 1,
d = 5, 1 < d | (3 Â· 7 Â· 19) and d = 5dâ€², with 1 < dâ€² < 3 Â· 7 Â· 19. For instance: (i)
if d = 5, then x2 + y2 = 5(x âˆ’y) if and only if (2x âˆ’5)2 + (2y + 5)2 = 50, so
that 2x âˆ’5 = Â±1, Â±7; (ii) if 1 < d | (3Â·7Â·19), then, since x2 +y2 â‰¡0 (mod d),
the argument sketched in item (ii) of the proof of Theorem 12.33 guarantees that
d | x and d | y; setting x = da and y = db, we obtain a2 + b2 = a âˆ’b, which
is equivalent to the ï¬rst of the four possibilities above.
4. Example 6.40 guarantees the existence of inï¬nitely many primes of the form 4k+
3; then, choose distinct primes q1, . . . , qn, all of which congruent to 3 modulo 4,
and apply the chinese remainder theorem, together with Theorem 12.33, to the
system of linear congruences x â‰¡âˆ’i + qi (mod q2
i ), for 1 â‰¤i â‰¤n.
5. For item (a), note that |S| = p+1
2 . For (b), use (a). Item (c) follows from (b),
together with the fact that y2
1 + y2
2 + y2
3 + y2
4 â‰¡mp (mod p). Finally, for (d),
start by using a descent argument to show that p can be written as a sum of four
squares; then, apply several times identity (12.10) to show that any n âˆˆN can be
written as a sum of four squares.
6. For item (a), assume that n has an odd divisor d > 1. Then, since (2d âˆ’1) |
(2n âˆ’1), we have that (2d âˆ’1) | (m2 +9), which is a sum of two perfect squares.
However, since 2d âˆ’1 is of the form 4k âˆ’1, he must have some prime divisor p
which is also of this form. It now follows from a slight modiï¬cation of the proof
of Theorem 12.31 that p | m and p | 3, and hence p = 3. Therefore, 3 | (2d âˆ’1),
which is an absurd, for 2d âˆ’1 â‰¡(âˆ’1)d âˆ’1 â‰¡âˆ’2 (mod 3) (recall that d is odd).
For item (b), start by observing that the case k = 1 is trivial. Now, assume that
(22kâˆ’1 âˆ’1) | (m2
kâˆ’1 + 9) and notice that (22kâˆ’1 + 1) | ((3 Â· 22kâˆ’2)2 + 9). Then,
with the aid of the chinese remainder theorem, choose mk âˆˆN such that
mk â‰¡mkâˆ’1 (mod 22kâˆ’1 âˆ’1) and mk â‰¡3 Â· 22kâˆ’2 (mod 22kâˆ’1 + 1).
It is immediate to verify that 22kâˆ’1 âˆ’1 and 22kâˆ’1 +1 divide m2
k +9; however, since
such numbers are relatively prime, we conclude that their product also divides
m2
k + 9.

600
22
Hints and Solutions
Section 13.1
2. For item (b), write |z + w|2 = (z + w)(z + w) and use the result of item (b) of
Lemma 13.2, together with (13.8).
3. For item (a), apply inequality |z + w| â‰¤|z| + |w|, with u âˆ’z in place of z
and z âˆ’v in place of w. For item (b), observe that the desired inequality is
equivalent to âˆ’|z âˆ’w| â‰¤|z| âˆ’|w| â‰¤|z âˆ’w|; then, in order to show that
|z|âˆ’|w| â‰¤|zâˆ’w|, apply inequality |z+w| â‰¤|z|+|w|, writing zâˆ’w in place
of z.
4. If z can be written as in the statement, use the second part of item (a) of
Problem 2 to conclude that |z| = 1. Conversely, suppose that |z| = 1. Impose
that z = 1âˆ’iw
1+iw, with w âˆˆC, to obtain w = i 1âˆ’z
1+z; then, use items (b) and (d) of
Lemma 13.2, together with the fact that |z| = 1, to conclude that w âˆˆR.
5. Expand both sides of the inequality |z âˆ’a|2 < |1 âˆ’az|2, with the aid of the
result of item (b) of Problem 2.
6. First note that
z âˆˆ â‡”|z âˆ’a|2 = R2 â‡”|z|2 âˆ’2Re(az) + |a|2 = R2.
Then, set w = 1
z to successively obtain
			 1
w âˆ’a
			
2
= R2, hence |a|2|aâˆ’1âˆ’w|2 =
R2|w|2, then |w|2(|a|2âˆ’R2)âˆ’2Re(aw)+1 = 0. Finally, write this last equality
as |w|2 âˆ’2Re

aw
|a|2âˆ’R2

+
1
|a|2âˆ’R2 = 0 and complete squares.
7. First note that zk+1 = zk

1 +
i
âˆš
k+1

. Then, compute |zk| in terms of k by
using telescoping products (cf. [8], for instance). Finally, note that zk+1 âˆ’zk =
zki
âˆš
k+1.
8. Review the deï¬nitions of addition and subtraction of vectors, in Chapter 8 of
[9].
9. Assume such a total ordering does exist and arrive at a contradiction. You may
wish to use that i2 = âˆ’1.
10. Checking items (a) to (e) is somewhat tedious, though elementary. In what
concerns (f), the ï¬rst part is immediate from the deï¬nition of multiplication
in H; for the second part, it sufï¬ces to use the identity |Î±Î²|2 = Î±Î²Î±Î², together
with the result of item (e). Item (g) follows from the second part of (f). Finally,
if Î± âˆˆH \ {0}, then Î± Â·
Î±
|Î±|2 = 1; therefore, if Î±Î² = 0 and Î± Ì¸= 0, then
0 =
Î±
|Î±|2 (Î±Î²) =
 Î±
|Î±|2 Î±

Î² = 1 Â· Î² = Î².
On the other hand, if Î±Î² = 1, then Î±Î² âˆ’Î± Î±
|Î±|2 = 0 or, which is the same,
Î±

Î² âˆ’
Î±
|Î±|2

= 0; however, since Î± Ì¸= 0, it follows that Î² =
Î±
|Î±|2 (here, we
wrote Î± âˆ’Î² to denote Î± +(âˆ’Î²), where âˆ’Î² = (âˆ’w)+(âˆ’x)i +(âˆ’y)j +(âˆ’z)k
if Î² = w + xi + yj + zk).

22
Hints and Solutions
601
11. In the complex plane, let a, b, c, d and e be the complex numbers associated
to the vertices of P and assume, without any loss of generality, that l10 =
|b âˆ’c|. Use a geometric argumento to show that we can suppose d = 0 and
e = 1. Then, observe that the stated hypotheses are equivalent to |a|2, |b|2, |c|2,
|a âˆ’1|2, |b âˆ’1|2, |c âˆ’1|2, |a âˆ’b|2 and |a âˆ’c|2 being all rationals. Conclude,
with the aid of the result of Problem 2, that Re(a), Re(b), Re(c), Re(ab) and
Re(ac) are rationals and, hence, that Im(a)2 = |a|2 âˆ’Re(a)2 is rational. Since
Re(ab) = Re(a)Re(b) âˆ’Im(a)Im(b)
= Re(a)Re(b) + Im(a)Im(b),
deduce that Im(a)Im(b) is rational; analogously, show that Im(a)Im(c) is also
rational. Now, since (once more from Problem 2) |b âˆ’c|2 = |b|2 + |c|2 âˆ’
2Re(bc), it sufï¬ces to show that Re(bc) is rational. To this end, note that
Re(bc) = Re(b)Re(c) + Im(b)Im(c),
and then it is enough to show that Im(b)Im(c) is rational. For what is left to do,
write
Im(b)Im(c) = Im(a)Im(b) Â· Im(a)Im(c)
Im(a)2
.
Section 13.2
1. Adapt, to the present case, the proof of Corollary 13.8.
2. Start by observing that Ï‰ + 1
Ï‰ = âˆ’1, Ï‰3k = 1, Ï‰3k+1 = Ï‰ and Ï‰3k+2 = Ï‰2 for
every k âˆˆZ.
3. Put 1 Â±
âˆš
3i in polar form and use the ï¬rst de Moivreâ€™s formula.
4. Take conjugates in the second equation to obtain z1 + z2 + z3 = 0. Then, use
the ï¬rst equation and item (d) of Lemma 13.2 to conclude that 1
z1 + 1
z2 + 1
z3 = 0
and, hence, that z1z2 + z1z3 + z2z3 = 0. Finally, observe that 0 = z1(z1z2 +
z1z3 + z2z3) = z2
1(z2 + z3) + 1 = âˆ’z3
1 + 1, with identical relations being true
for z2 and z3.
5. Adapting to the present case the solution given to Example 13.17, write zâˆ’1 =
RÏ‰(z + 1), where Ï‰ is an n-th root of unity, so that z = 1+RÏ‰
1âˆ’RÏ‰. Now, compute
z âˆ’
1 + R2
1 âˆ’R2

= âˆ’
2R
R2 âˆ’1
 Ï‰ âˆ’R
1 âˆ’RÏ‰

= âˆ’
2R
R2 âˆ’1

Ï‰ âˆ’R
Ï‰(Ï‰ âˆ’R)

and take modulus on both sides.
6. Write an = (nâˆ’Ï‰)(nâˆ’Ï‰2), with Ï‰ = cis 2Ï€
3 . Then, recall that 1+Ï‰+Ï‰2 = 0,
from which we obtain (k âˆ’1 âˆ’Ï‰)(k âˆ’Ï‰2) = (k + Ï‰2)(k âˆ’Ï‰2) = k2 âˆ’Ï‰ and,
analogously, (k âˆ’1 âˆ’Ï‰2)(k âˆ’Ï‰) = (k + Ï‰)(k âˆ’Ï‰) = k2 âˆ’Ï‰2.
7. Letting w2 = p2 âˆ’4q2, use Bhaskaraâ€™s formula to show that the roots of
the given equation have the same modulus if and only if Re(pw) = 0. Then,

602
22
Hints and Solutions
substitute p = r cis Î±, q = s cis Î² and w = t cis Î³ into Ï‰2 = p2 âˆ’4q2, with
r, s, t âˆˆR+, and conclude that |Î± âˆ’Î²| must be an integer multiple of Ï€.
8. Write z2 = zâ€²
2 + z1 and z3 = zâ€²
3 + z1 to reduce to the case z1 = 0; then, write
zâ€²â€²
2 = wzâ€²
2 and zâ€²â€²
3 = wzâ€²
3, for an appropriate complex number w of modulus 1,
to reduce to the case zâ€²
2 = 1.
9. Setting Ï‰ = cis 2Ï€
n , use the ï¬rst formula of de Moivre to compute the real and
imaginary parts of the left hand side of (13.20).
10. For item (a), adapt the hint given to the previous problem. Do the same with
item (b); you may ï¬nd it helpful to use that sin2 x = 1
2(1 âˆ’cos(2x)).
11. Perform twice the substitution z â†’Ï‰z + a in the stated equality.
12. Let O be the center and R the radius of the circle circumscribed to the
polygon. By looking to the plane as the complex plane, we can assume that
O corresponds to 0, A1 to R, A2 to RÏ‰, with Ï‰ = cis 2Ï€
2n , and P to z. Hence,
Ak = RÏ‰kâˆ’1 for 1 â‰¤k â‰¤2n, and
A2kP 2 = |RÏ‰2kâˆ’1 âˆ’z|2
= R2 + |z|2 âˆ’2Re

RÏ‰2kâˆ’1z

.
Analogously, A2kâˆ’1P 2 = R2 + |z|2 âˆ’2Re

RÏ‰2kâˆ’2z

, so that
n

k=1
A2kP 2 =
n

k=1
A2kâˆ’1P 2
if and only if
n

k=1
Re

RÏ‰2kâˆ’1z

=
n

k=1
Re

RÏ‰2kâˆ’2z

.
In turn, this is the same as asking that
Re

Rz
n

k=1
Ï‰2kâˆ’1
= Re

Rz
n

k=1
Ï‰2kâˆ’2
.
Finally, show that n
k=1 Ï‰2kâˆ’1 = n
k=1 Ï‰2kâˆ’2 = 0.
Section 13.3
1. For a given n âˆˆN, Un(C) is a ï¬nite subset of C satisfying both conditions.
2. Start by using the ï¬niteness of A to show that all of its elements are roots of
unity. Then, if z âˆˆA and zk = 1 for some natural k, show that k | n.
3. You may use item (d) of Problem 21, page 220, together with the fact that Ï•(n)
is even for n > 2 (cf. Problem 19, page 220).

22
Hints and Solutions
603
4. For item (a), since d divides both m and n, substituting each piece 1 Ã— m by m
d
pieces 1Ã—d and each piece 1Ã—n by n
d pieces 1Ã—d, we conclude that the rectangle
can be assembled by using only pieces 1 Ã— d. The rest follows from Klarnerâ€™s
theorem. For item (b), let q be a natural number such that q > mn. According
to item (a) of Problem 20, page 179, q can be written as q = mx + ny, with
x, y âˆˆN. Therefore, if p, q âˆˆN are such that q > mn, then we can assemble a
p Ã— q rectangle by forming p rows 1 Ã— q, with each row composed by x pieces
1 Ã— m and y pieces 1 Ã— n (x and y as above). However, if m, n âˆ¤p, q, then
Klarnerâ€™s theorem assures that one cannot assemble a p Ã— q rectangle by using
only pieces 1 Ã— m or only pieces 1 Ã— n.
5. Arguing as in the proof of Klarnerâ€™s theorem, write xiyj inside the 1 Ã— 1 square
of the chessboard situated at row i and column j, for 1 â‰¤i, j â‰¤8. After we
cover the board, assume that the 1 Ã— 1 square is the one situated at row k and
column l. Use double counting to get
(1 + x + x2)E(x, y) + (1 + y + y2)F(x, y) + xkyl
= (x + x2 + Â· Â· Â· + x8)(y + y2 + Â· Â· Â· + y8),
for some polynomial expressions E and F in x and y. Let Ï‰ = cis 2Ï€
3 . Substitute
x = y = Ï‰ to get Ï‰k+l = 1 and, hence k + l â‰¡0 (mod 3). Substitute x = Ï‰2,
y = Ï‰ to get Ï‰2k+l = 1 and, hence 2k + l â‰¡0 (mod 3). Finally, conclude that
k, l â‰¡0 (mod 3), and show that any one of the choices (k, l) = (3, 3), (3, 6),
(6, 3) or (6, 6) do correspond to actual possible positions of the 1 Ã— 1 square
(i.e., show that the remaining 63 squares of the chessboard can be ï¬lled with the
21 given rectangles 1 Ã— 3.
6. Adapt, to the present case, the proof of Klarnerâ€™s theorem.
7. Once more, adapt the proof of Klarnerâ€™s theorem to the present case.
8. Use the result of the previous problem.
Section 14.1
2. The results of items (a) and (b) are respectively Xn âˆ’an and Xn + an. As for
item (c) recall that, according to Example 4.12 of [8], every natural number can
be uniquely written, up to reordering, as a sum of powers of 2 with nonnegative,
pairwise distinct integer exponents.
3. For (X +1)m(X +1)n, note that each product that contributes to the coefï¬cient
of Xp comes from a product of the form aXk Â· bXpâˆ’k; now, note that a =
m
k

and b =
 n
pâˆ’k

.
4. Start by establishing the commutativity and distributivity. For the associativity
of multiplication, start by using the distributivity to show that, if f (gh1) =
(fg)h1 and f (gh2) = (fg)h2, then f

g(h1 + h2)

= (fg)(h1 + h2). Then,
iterate such a reasoning to show that it sufï¬ces to establish the (obvious)
equality aXm
bXn Â· cXp
=

aXm Â· bXn
Â· cXp, for all a, b, c âˆˆK and
m, n, p âˆˆZ+.

604
22
Hints and Solutions
5. By contraposition, show that if f, g âˆˆK[X] \ {0}, then fg Ì¸= 0. To this end,
write f (X) = m
i=k aiXi and g(X) = n
j=l bjXj, with ak, bl Ì¸= 0, and
examine the coefï¬cient of Xk+l in fg.
6. Letting g(X) = f (X) + 1
2, we are left to ï¬nding g, of degree 2001, such that
g(X)+g(1âˆ’X) = 0 or, which is the same, g(X) = âˆ’g(1âˆ’X). Setting g(X) =
(Xâˆ’a)2001, we must have (Xâˆ’a)2001 = âˆ’(1âˆ’Xâˆ’a)2001 = (X+a âˆ’1)2001.
7. Apply the multisection formula.
8. Adapt the proof of Theorem 14.10 to the present case.
9. Apply the result of the previous problem to
f (X) = (X + 1)m =
m

k=0
m
k

Xk,
n = 4, r = 1 and z =
âˆš
2.
10. Let a0 be the constant term of f and write f (Xm) = g(X)h(X), with
g, h âˆˆR[X] \ R being such that their nonvanishing coefï¬cients are positive.
Let g(X) = k
i=0 biXi and h(X) = l
j=0 cjXj. Since a0 Ì¸= 0 and a0 = b0c0,
we have b0, c0 Ì¸= 0. Therefore, b0, c0 > 0, and hence a0 > 0. Suppose, for the
sake of contradiction, that g has a term of the form btXt, with bt > 0 and m âˆ¤t.
Then, the coefï¬cient of Xt in f (Xm) is

i+j=t
i,jâ‰¥0
bicj =

i+j=t
i>0,jâ‰¥0
bicj + btc0 > 0.
Now, reach a contradiction and ï¬nish the proof.
Section 14.2
1. Compute (X2 + X + 1)n by writing X2 + X + 1 = (X2 âˆ’X + 1) + 2X. Then,
use the uniqueness part of the division algorithm.
2. Write Xm + 1 = Xm âˆ’1 + 2 = (Xn)m/n âˆ’1 + 2. Then, use the result of item
(a) of Problem 2, page 355, to show that Xn âˆ’1 divides (Xn)m/n âˆ’1.
3. Start by noticing that
X2m âˆ’1 = (X2mâˆ’1 + 1)(X2mâˆ’1 âˆ’1)
= (X2mâˆ’1 + 1)(X2mâˆ’2 + 1)(X2mâˆ’2 âˆ’1) = Â· Â· Â· ,
so that X2n + 1 divides X2m âˆ’1.
4. With Î± = âˆ’b
a in Example 14.15, we get
f (X) =

X + b
a

q(X) + f

âˆ’b
a

= (aX + b)aâˆ’1q(X) + f

âˆ’b
a

.

22
Hints and Solutions
605
5. Write f (X) = (X + 2)q1(X) âˆ’1 = (X âˆ’2)q2(X) + 3, with q1, q2 âˆˆQ[X].
Then, write q1(X) = (X âˆ’2)q(X) + r, with r âˆˆQ, to get f (X) = (X2 âˆ’
4)q(X)+(X +2)r âˆ’1. Finally, use the uniqueness part of the division algorithm
to conclude that r = 1.
6. Write f (X) = (X + 1)(X2 + 1)q(X) + (aX2 + bX + c), for some a, b, c âˆˆR.
Then, show that the remainders of the divisions of aX2 + bX + c by X + 1 and
X2 + 1 are respectively equal to a âˆ’b + c and bX + (c âˆ’a). Finally, apply
the uniqueness part of the division algorithm twice to obtain a linear system of
equations in a, b and c.
7. Assume, without loss of generality, that m â‰¥n. Follow the division algorithm
to obtain the quotient Xmâˆ’n âˆ’Xmâˆ’2n + Â· Â· Â· + (âˆ’1)qâˆ’1Xn+r and the remainder
(âˆ’1)qXr + 1. Alternatively, if q is odd write
Xm + 1 = Xnq+r + 1 =

Xnq + 1

Xr + (âˆ’Xr + 1)
and factor Xnq + 1 = (Xn)q + 1; if q is even, write
Xm + 1 = Xnq+r + 1 =

Xnq âˆ’1

Xr + (Xr + 1)
and factor Xnq âˆ’1 = (X2n)q/2 âˆ’1.
Section 15.1
1. Firstly, show that it sufï¬ces to consider the case in which f is of the form
f (X) = aXn, for some a âˆˆK \ {0}, and g is nonconstant. Now, in order to
show that 
f â—¦g = Ëœf â—¦Ëœg, use Corollary 15.14.
2. For item (a), use the binomial formula; for (b), write f (X) = cnXn + Â· Â· Â· +
c1X + c0 and use (a) to infer the existence of rational numbers A and B such
that f (a Â± bâˆšr) = A Â± Bâˆšr. Then, apply the result of problem 1.3.3 of [8].
3. Use the result of the previous problem to conclude that the given polynomial is
divisible by X2 âˆ’2X âˆ’1.
4. Use the division algorithm to write f (X) = (aX + b)q(X) + r, for some
constant r. Then, perform the substitution X â†’âˆ’b
a .
5. Start by observing that, if such an f does exist, then f (y)2 = 1 âˆ’y2 for every
0 â‰¤y â‰¤1 and, hence, for every y âˆˆR. Then, conclude that âˆ‚f = 1 and arrive
at a contradiction.
6. Use the root test for Â±i, together with the ï¬rst de Moivre formula.
7. If n > 1, write Xn+1 âˆ’Xn +1 = Xnâˆ’1(X2 âˆ’X +1)âˆ’(Xnâˆ’1 âˆ’1) to conclude
that it is necessary and sufï¬cient to have Xnâˆ’1 âˆ’1 divisible by X2 âˆ’X + 1.
Since X2âˆ’X+1 = (X+Ï‰)(X+Ï‰2), with Ï‰ Ì¸= âˆ’1 being a cubic root of 1, we
are searching for the naturals n > 1 such that (âˆ’Ï‰)nâˆ’1 = 1 and (âˆ’Ï‰2)nâˆ’1 = 1.
8. Assume that the given polynomial has an integer root, say r, so that
r4 âˆ’1994r3 + (1993 + m)r2 âˆ’11r + m = 0.

606
22
Hints and Solutions
Look at such an equality modulo 2 to conclude that both m and r are even. Now,
suppose that a and b are distinct integer roots of the polynomial. Termwise
subtract the equalities
a4 âˆ’1994a3 + (1993 + m)a2 âˆ’11a + m = 0
and
b4 âˆ’1994b3 + (1993 + m)b2 âˆ’11b + m = 0,
and factor a âˆ’b out of the result to obtain
(a + b)(a2 + b2) âˆ’1994(a2 + ab + b2) + (1993 + m)(a + b) = 11.
Then, reach a contradiction.
9. Write X2 âˆ’X âˆ’1 = (X âˆ’u)(X âˆ’v), with u =
1+
âˆš
5
2
and v =
1âˆ’
âˆš
5
2
.
Invoke the root test to conclude that it sufï¬ces to ï¬nd all a, b âˆˆR such that
au17+bu16+1 = 0 and av17+bv16 +1 = 0. Multiply the ï¬rst relation by u16,
the second by v16 and subtract the results to obtain a = u16âˆ’v16
uâˆ’v
. Now, letting
xn = unâˆ’vn
uâˆ’v , use (3.4) to conclude that (xn)nâ‰¥1 is the Fibonacci sequence. Then,
conclude that a = 987 and compute the value of b in an analogous way.
10. Write p(X) = X(Xâˆ’Î±2) . . . (Xâˆ’Î±n), with Î±2, . . . , Î±n being pairwise distinct
nonzero integers. For d âˆˆZ, show that p(p(d)) = 0 if and only if d = Î±i
for some 1 â‰¤i â‰¤n or p(d) = Î±i for some 2 â‰¤i â‰¤n. In this last case, we
have d Ì¸= 0; moreover, writing Î± = Î±i, show that there exists q âˆˆZâˆ—such that
d(d âˆ’Î±)q = Î±. Conclude that dq + 1 = âˆ’1 and, hence, that d = Î±
2 . Finally,
use this to deduce that (d âˆ’Î±2) . . . (d âˆ’Î±n) = 2, and use the fact that n > 4 to
reach a contradiction.
11. Up to reordering, there are two distinct cases: (i) f (p1) = f (p2) = f (p3) = 3
and f (p4) = âˆ’3; (ii) f (p1) = f (p2) = 3 and f (p3) = f (p4) = âˆ’3. In case
(i), show that f (X) = a(X âˆ’p1)(X âˆ’p2)(X âˆ’p3) + 3 and, then, use the
condition f (p4) = âˆ’3, together with the fact that the piâ€™s are distinct primes,
to reach a contradiction. In case (ii), show that f (X) = a(Xâˆ’p1)(Xâˆ’p2)(Xâˆ’
q) + 3 and compute f (0) to conclude that q =
3âˆ’d
ap1p2 ; then, use the conditions
f (p3) = f (p4) = âˆ’3 to reach a contradiction.
12. Use the root test to conclude that p(X) = 5 + (X âˆ’a)(X âˆ’b)(X âˆ’c)(X âˆ’
d)q(X) for some q âˆˆZ[X]. Then, assume that there exists m âˆˆZ as in the
statement and let x = m in the corresponding polynomial functions to reach a
contradiction.
13. If Ï‰ = cis 2Ï€
3 , then Ï‰ and Ï‰2 are cubic roots of unity and are the roots of
X2 + X + 1. Use these two facts to ï¬nd out the natural numbers k for which
Ï‰2k + 1 + (Ï‰ + 1)2k = 0 and (Ï‰2)2k + 1 + (Ï‰2 + 1)2k = 0.
14. Start by deï¬ning f (X) = n
i=1 Xai and g(X) = n
i=1 Xbi, and computing
f (X)2 = f (X2) + 2
n

i<j
Xai+aj and g(X)2 = g(X2) + 2
n

i<j
Xbi+bj .

22
Hints and Solutions
607
Then, use the stated conditions to show that 1 is a root of f âˆ’g and (f (X) +
g(X))(f (X)âˆ’g(X)) = f (X2)âˆ’g(X2). Writing f (X)âˆ’g(X) = (Xâˆ’1)kh(X),
with k âˆˆN and h âˆˆZ[X] such that h(1) Ì¸= 0, obtain f (X2) âˆ’g(X2) =
(X2 âˆ’1)kh(X2) and, hence,
(f (X) + g(X))h(X) = (X + 1)kh(X2).
Finally, evaluate both sides at x = 1 to get n = 2kâˆ’1.
Section 15.2
1. Were a an integer root of f , show that the fact that f (0) is odd, together with the
rational roots test, would give a to be odd. Then, show that if a is odd, then f (a)
and f (1) have distinct parities, so that f (a) would be odd and, hence, we could
not have f (a) = 0.
2. Letting r be the common difference of the arithmetic progression, write x =
y âˆ’r, z = y + r and conclude that the polynomial X5 âˆ’10X4 âˆ’20X2 âˆ’2 has
the rational root x/r. Then, apply the test for rational roots to get a contradiction.
3. Since {2 cos Î¸; Î¸ âˆˆR} = [âˆ’2, 2], which is an inï¬nite set, Corollary 15.10
guarantees that there is at most one polynomial fn âˆˆR[X] satisfying the stated
condition.
4. Start by observing that the desired property holds if and only if znfn(z + 1
z) =
z2n+1 for every z âˆˆC\{0}. However, letting fn(X) = n
j=0 ajXj, the equality
above is equivalent to the polynomial equality n
j=0 ajXnâˆ’j(X2 +1)j = X2n +
1. Thus, it sufï¬ces to establish the desired equality for at least n + 1 distinct
complex values of z. To this end, letting z = cis Î¸, we get 1
z = cis (âˆ’Î¸) and,
hence,
fn(z + 1
z ) = fn(2 cos Î¸) = 2 cos(nÎ¸) = cis (nÎ¸) + cis (âˆ’nÎ¸) = zn + 1
zn .
5. For item (a), note that one also has x = 2y2 âˆ’1, and hence 2(y2 âˆ’x2) = x âˆ’y.
Thus, either x = y or 2(y+x) = âˆ’1, whence 2x2âˆ’xâˆ’1 = 0 or 4x2+2xâˆ’1 = 0.
For item (b), if x = cos Î¸, then 2x2âˆ’1 = cos(2Î¸) and 2(2x2âˆ’1)2âˆ’1 = cos(4Î¸).
Hence, we are left to solving cos(4Î¸) = cos Î¸, and basic Trigonometry gives
x = cos Î¸ = cos 0, cos
 2Ï€
3

, cos
 Ï€
10

or cos
 3Ï€
10

. Finally, compare these value
with those found in item (a) to get cos
 Ï€
10

= âˆ’1+
âˆš
5
4
.
6. Let Î± =
3:
a +
âˆš
b+
3:
a âˆ’
âˆš
b. Use the fact that (u+v)3 = u3+v3+3uv(u+v)
to compute Î±3 = 2a+3
3âˆš
a2 âˆ’b Î±. For item (a), write (Î±3âˆ’2a)3 = 27(a2âˆ’b)Î±3
and apply the rational roots test to the polynomial X9âˆ’6aX6âˆ’(15a2âˆ’27b)X3âˆ’
8a3. For item (b), write a2 âˆ’b = n3, with n âˆˆZ, to get Î±3 âˆ’3nÎ± âˆ’2a = 0.
In order to get the result of i., search rational roots in the polynomial X3 âˆ’

608
22
Hints and Solutions
3nX âˆ’2a. For ii., ï¬rst write Î± = 2m, with m âˆˆZ, to get a = 4m3 âˆ’3mn
and b = a2 âˆ’n3 = (4m3 âˆ’3mn)2 âˆ’n3. Now, write Î± = 2m + 1 to get
2a = (2m + 1)(4m2 + 4m + 1 âˆ’3n); hence, n must be even, say n = 2nâ€² + 1,
with nâ€² âˆˆZ, so that a = (2m + 1)(2m2 + 2m âˆ’3nâ€²) and b = a2 âˆ’n3 =
[(2m + 1)(2m2 + 2m âˆ’3nâ€²)]2 âˆ’8(nâ€²)3.
7. If (2 + i)n = (2 âˆ’i)n, show that
 3
5 + 4
5i
n = 1, so that 3
5 + 4
5i = Ï‰k for some
integer 1 â‰¤k < n, with Ï‰ = cis 2Ï€
n . Conclude that cos 2kÏ€
n
= 3
5 and apply the
result of Theorem 15.21.
8. For item (a), let fn(X) be the product of all 2n factors of the form
X âˆ’

Â± âˆša1 Â± âˆša2 Â± Â· Â· Â· Â± âˆšan

.
Then, fn is certainly monic and has the given number as one of its roots. We
make induction on n to show that fn âˆˆZ[X], noting that this is a straightforward
computation for n = 1. Assuming its validity for n = k, let a1, a2, . . . , ak, ak+1
be given as in the statement of the problem. Then,
fk+1(X) =

 
X + âˆšak+1 Â± âˆša1 Â± Â· Â· Â· Â± âˆšak


 
X âˆ’âˆšak+1 Â± âˆša1 Â± Â· Â· Â· Â± âˆšak

= fk

X + âˆšak+1

fk

X âˆ’âˆšak+1

,
with the above products ranging over all 2k possible choices of + and âˆ’signs.
Now, direct computation gives
fk

X Â± âˆšak+1

= gk(X) Â± âˆšak+1hk(X),
for some gk, hk âˆˆZ[X], with gk monic, âˆ‚gk = 2k and âˆ‚hk â‰¤2k âˆ’1. Thus, we
obtain
fk+1(X) =

gk(X) + âˆšak+1hk(X)

gk(X) âˆ’âˆšak+1hk(X)

= gk(X)2 âˆ’ak+1hk(X)2,
and it is now clear that fk+1 has integer coefï¬cients. For item (c), the rational
roots test, together with (a), shows that the given number is either an integer
or an irrational. However, the estimates 1.4 <
âˆš
2 < 1.5, 1.7 <
âˆš
3 < 1.8,
2.2 <
âˆš
5 < 2.3, 2.6 <
âˆš
7 < 2.7 and 3.3 <
âˆš
11 < 3.4 give 11.2 <
âˆš
2 +
âˆš
3 +
âˆš
5 +
âˆš
7 +
âˆš
11 < 11.7, so that it is not an integer.
9. On the contrary, suppose the two polynomials have a common root z, which is
not rational (for X5 âˆ’X âˆ’1 has no rational root). Then,

22
Hints and Solutions
609
z + 1 = z(z2)2 = z(âˆ’az âˆ’b)2 = z(a2z2 + 2abz + b2)
= (âˆ’az âˆ’b)a2z + 2ab(âˆ’az âˆ’b) + b2z
= âˆ’a3(âˆ’az âˆ’b) âˆ’3a2bz âˆ’2ab2 + b2z,
so that (1 âˆ’a4 + 3a2b âˆ’b2)z = a3b âˆ’2ab2 âˆ’1. However, since a, b âˆˆQ but
z /âˆˆQ, this gives
a4 âˆ’3a2b + b2 = a3b âˆ’2ab2 = 1.
(22.5)
The second equality gives a Ì¸= 0, hence b2 = a3bâˆ’1
2a
. Substituting such a relation
in the ï¬rst equality, one gets a4 âˆ’3a2b + a3bâˆ’1
2a
= 1, then b = 2a5âˆ’2aâˆ’1
5a3
. Putting
this back into the second equality of (22.5), we ï¬nally obtain
a32a5 âˆ’2a âˆ’1
5a3

âˆ’2a
2a5 âˆ’2a âˆ’1
5a3
2
= 1.
This is equivalent to a10+3a6âˆ’11a5âˆ’4a2âˆ’4aâˆ’1 = 0, which is an absurd, for
the rational root test assures that the polynomial X10+3X6âˆ’11X5âˆ’4X2âˆ’4Xâˆ’1
has no rational root.
Section 15.3
1. Show that the deduction of Bhaskaraâ€™s formula (cf. Section 2.3 of [8], for
instance) still holds in the realm of complex numbers.
2. For the ï¬rst part, the roots of u3 = u3
0 are u0, u0Ï‰ and u0Ï‰2; now, review the
discussion of Example 15.22. For the second part, if u0 + v0 = u0Ï‰ + v0Ï‰2,
show that u0 + v0(Ï‰ + 1) = 0 and, hence, that u2
0 = a(Ï‰ + 1). Then, use
the fact that u6
0 + bu3
0 âˆ’a3 = 0 to obtain the relation bu0(Ï‰ + 1) = 2a2.
Finally, square it and substitute u2
0 = a(Ï‰ +1) to arrive at 4a3 +b2 = 0. Argue
in an analogous way to investigate the equalities u0 + v0 = u0Ï‰2 + v0Ï‰ and
u0Ï‰ + v0Ï‰2 = u0Ï‰2 + v0Ï‰.
3. Item (b) follows from applying elementary algebra to the equality of item (a),
together with the fact that z4 +az3 +bz2 +cz +d = 0. For (d), Example 15.22
shows that one can always ï¬nd w as in the ï¬rst part of item (c), and hence solve
the quadratic equations displayed in the second part of item (c). Upon doing
this, show that z will be a complex root of X4 + aX3 + bX2 + cX + d.
4. For the ï¬rst part, write f (z) = anzn + Â· Â· Â· + a1z + a0, with a0, a1, . . . , an âˆˆR
and use items (b) and (c) of Lemma 13.2 to conjugate both sides of the equality
f (z) = 0. For the second, make induction on the degree of f ; for the induction
step, note that, for z âˆˆC\R, one has (X âˆ’z)(X âˆ’z) = X2 âˆ’2Re(z)X +|z|2 âˆˆ
R[X].

610
22
Hints and Solutions
5. Use the result of the previous Problem 4.
6. Use the proof of the previous problem to write f (X) = u(X)v(X), with
u(X) = 0k
j=1(X âˆ’zj) and v(X) = 0k
j=1(X âˆ’zj) for some z1, . . . ,
zk âˆˆC \ R. Now, note that if u(X) = g(X) âˆ’ih(X) for some g, h âˆˆR[X],
then v(X) = g(X) + ih(X).
7. Writing f (X) = anXn + anâˆ’1Xnâˆ’1 + Â· Â· Â· + a1X + a0, with an Ì¸= 0, it follows
from f (Î±) = 0 that
Î±n = âˆ’anâˆ’1
an
Â· Î±nâˆ’1 âˆ’Â· Â· Â· âˆ’a1
an
Î± âˆ’a0
an
.
Now, argue by induction to prove (15.8) for m â‰¥n. For the case m = âˆ’1,
expand the equality Î±âˆ’1f (Î±) = 0 in terms of the coefï¬cients of f ; for the
general case m < 0, use induction again.
8. Apply the triangle inequality to get, for |z| â‰¥1,
|an||z|n â‰¤|anâˆ’1||z|nâˆ’1 + Â· Â· Â· + |a1||z| + |a0| â‰¤nA|z|nâˆ’1 â‰¤nA|z|nâˆ’1.
9. Letting z = Î±+Î²i be a complex root of f such that Î± > 2, adapt the hint given
to the previous problem (i.e., apply the triangle inequality) to obtain |anzn +
anâˆ’1znâˆ’1| < k|z|nâˆ’1
|z|âˆ’1 . Subsequently, use this to show that |z| < 1 +
k
|anz+anâˆ’1|
and, then, substitute z = Î± + iÎ².
10. For the case of degree 4, if z âˆˆC is a root of f , then z Ì¸= 0 and a

z2 + 1
z2

+
b

z + 1
z

+ c = 0; then, let w = z + 1
z and apply the result of Problem 4,
page 378, for n = 2. For the case of degree 6, argue analogously, starting with
f (X) = aX6 + bX5 + cX4 + dX3 + cX2 + bX + a, with a Ì¸= 0.
11. Use the stated conditions to get (X + 1)f (X) âˆ’X = aX(X âˆ’1) . . . (X âˆ’n).
Then, compute a by evaluating both sides at âˆ’1.
12. As in Example 15.26, substitute X by 1 in the factorised form of Xnâˆ’1+Xnâˆ’2+
Â· Â· Â· + X + 1; then, use some Trigonometry to show that, if Ï‰ = cis 2Ï€
n , then
|1 âˆ’Ï‰k| = 2 sin kÏ€
n for 1 â‰¤k â‰¤n.
13. Use the result of the previous problem, together with the relation sin(Ï€ âˆ’x) =
sin x.
14. If z âˆˆC is a root of p, show that z2 and z âˆ’1 are also roots. Then, use the
ï¬niteness of the number of roots to successively conclude that |z| = 1, |zâˆ’1| =
1 and z = Ï‰ or z = Ï‰, where Ï‰ = cis 2Ï€
3 . Finally, apply the result of Problem 4.
Section 15.4
1. Use the result of Corollary 15.32, pretty much along the same lines of
Example 15.33, to show that 8a3 âˆ’25a2 âˆ’180a + 608 = 0. Then, conclude
that a = 4.

22
Hints and Solutions
611
2. Write f (X) = g(X)2h(X) and, then, compute f â€².
3. Use item (b) of Proposition 15.29 to show that f â€²(z) = n
j=1
f (z)
zâˆ’zj .
4. Adapt, to the present case, the hint given to the previous problem.
5. For item (a), let f (X) = Xn âˆ’1 = 0nâˆ’1
j=0(X âˆ’Ï‰j) and check that
(Ï‰j âˆ’1) . . . (Ï‰j âˆ’Ï‰jâˆ’1)(Ï‰j âˆ’Ï‰j+1) . . . (Ï‰j âˆ’Ï‰nâˆ’1) = f â€²(Ï‰j) = nÏ‰(nâˆ’1)j.
For item (b), note ï¬rst that the substitution X
â†’
0 in (15.7) gives
Ï‰Ï‰2 . . . Ï‰nâˆ’1 = (âˆ’1)nâˆ’1n. Then,
P =
nâˆ’1

k=0
(Ï‰k âˆ’1) . . . (Ï‰k âˆ’Ï‰kâˆ’1)(Ï‰k+1 âˆ’Ï‰k) . . . (Ï‰nâˆ’1 âˆ’Ï‰k)
=
nâˆ’1

k=0
(âˆ’1)nâˆ’1âˆ’k(Ï‰k âˆ’1) . . . (Ï‰k âˆ’Ï‰kâˆ’1)(Ï‰k âˆ’Ï‰k+1) . . . (Ï‰k âˆ’Ï‰nâˆ’1)
= (âˆ’1)
n(nâˆ’1)
2
nâˆ’1

k=0
nÏ‰(nâˆ’1)k = (âˆ’1)
(nâˆ’1)(nâˆ’2)
2
nn.
6. For item (a), set bn = AÎ±nâˆ’1 + BÎ²nâˆ’1 + CÎ³ nâˆ’1 for every n â‰¥1, with A, B
and C being the solutions of the linear system
â§
â¨
â©
A + B + C = a1
Î±A + Î²B + Î³ C = a2
Î±2A + Î²2B + Î³ 2C = a3
,
show that (bn)nâ‰¥1 satisï¬es bk+3 = ubk+2 + vbk+1 + wbk for every k â‰¥1, and
that ak = bk for 1 â‰¤k â‰¤3. Then, show that an = bn for every n â‰¥1. Items
(b) and (c) can be dealt with in similar ways, except for the fact that, in order to
establish the equality bk+3 = ubk+2 + vbk+1 + wbk, you will have to use the
fact that X3 âˆ’uX2 âˆ’vX âˆ’w has multiple roots.
7. First of all, ï¬nd the roots of X3 âˆ’6X2 +12X âˆ’8 (look for integer roots). Then,
apply the result of the previous problem.
8. Letting f (X) = 0n
k=1

1 + 1
k Xk
, show that f (1) = n + 1 and
f (X) = 1 +

âˆ…Ì¸=SâŠ‚In
1
Ï€(S)XÏƒ(S).
Now, compute f â€²(1) and, with the aid of the result of Problem 4, f â€²(1)
f (1) .
9. It sufï¬ces to show that, if some half-plane of the complex plane contains the
roots of f , then it also contains those of f â€². By the sake of contradiction,

612
22
Hints and Solutions
suppose that there exists a line r such that one of the half-planes it determines
contains a root w of f â€², whereas the other contains all of the roots of f . Let
u âˆˆC have modulus 1 and such that the vector u is perpendicular to r; if
f (X) = a(X âˆ’z1) . . . (X âˆ’zn) and Î¸ and Î¸j respectively denote arguments of
u and zj âˆ’w, use the result of Problem 3 to show that
Re
â›
â
n

j=1
|zj âˆ’w|âˆ’1 cos(Î¸j âˆ’Î¸)
â
â = 0.
Then, note that (zj âˆ’w)/u has an argument belonging to the interval (âˆ’Ï€
2 , Ï€
2 ),
and use the equality above to reach a contradiction.
10. If f (X) = n
k=0 ckXk, with ck âˆˆZ, then f (X) = n
k=0 ck

a + (X âˆ’a)
k.
Expand all of the binomials (a + (X âˆ’a))k and compare the result with (15.9),
for z = a.
11. Make induction on k â‰¥1. For the induction step, if mk âˆˆN is such that
f (mk) â‰¡0 (mod pk) and f â€²(mk) Ì¸â‰¡0 (mod p), let mk+1 = mk + xpk, with
x âˆˆZ to be found. Then, use Taylorâ€™s formula (15.9), together with the result
of the previous problem, to show that
f (mk+1) â‰¡f (mk) + f â€²(mk)xpk (mod pk+1).
Subsequently, show that it is possible to choose x so that f (mk+1)
â‰¡
0 (mod pk+1). Finally, since mk+1 â‰¡mk (mod p) and f â€² âˆˆZ[X], we have
f â€²(mk+1) â‰¡f â€²(mk) Ì¸â‰¡0 (mod p).
12. Start by showing that one can assume that the center of the square is the origin
of the cartesian plane. Then, if (u, v) is one of its vertices, note that the other
ones are (âˆ’v, u), (âˆ’u, âˆ’v) and (v, âˆ’u). Substitute these points in the deï¬ning
equation for the graph, i.e., y = f (x), to obtain au2 + c = 0, v = u3 + bu and
av2+c = 0, u = âˆ’v3âˆ’bv. Conclude that a(uâˆ’v)(u+v) = 0 and, hence, that
either a = c = 0 or u = Â±v and au2 + c = 0. Discard the possibility u = Â±v
and successively obtain a = c = 0 and u2(u2 + b)3 + b(u2 + b) + 1 = 0.
Conclude that the polynomial X2(X2 + b)3 + b(X2 + b) + 1 = 0 has only two
real roots, so that X(X +b)3 +b(X +b)+1 = 0 has only one real root Î± = u2
(apart from multiplicities). Thus, show that such a root must be a multiple one,
and therefore that (X +b)3 +3X(X +b)2 +b = 0. Letting A = Î± +b, perform
some simple algebraic manipulations to arrive at (16 âˆ’2b2)bA = 2b2 âˆ’16, so
that b2 = 8 or bA = âˆ’1. Discard the possibility bA = âˆ’1 and conclude that,
if b2 = 8, then (bA)2 âˆ’4(bA) âˆ’8 = 0. Finally, if â„“stands for the length of the
sides of the square, show that

22
Hints and Solutions
613
â„“2 = 2

u2 + u2(u2 + b)2
= 2(A âˆ’b)(A2 + 1)
= 2(bA âˆ’b2)

(bA)2 + b2
b3
= 2(bA âˆ’8)

(bA)2 + 8

8b
= (bA)2 âˆ’4(bA) âˆ’32
b
=
âˆš
72.
Section 16.1
1. Adapt, to the present case, the proof of Proposition 16.1.
2. For item (a), adapt the argument of the solution of Example 16.3. For item (b),
start by writing
(X âˆ’Y)5 + (Y âˆ’Z)5 + (Z âˆ’X)5 = (X âˆ’Y)(Y âˆ’Z)(Z âˆ’X)f (X, Y, Z),
with f of degree 2. Then, use the equality âˆ’y5 + (y âˆ’z)5 + z5 = âˆ’yz(y âˆ’
z)f (0, y, z) to show that f (0, Y, Z) = 5(Y 2 âˆ’YZ + Z2) and, analogously, that
f (X, 0, Z) = 5(X2 âˆ’XZ + Z2) and f (X, Y, 0) = 5(X2 âˆ’XY + Y 2). Finally,
show that
f (X, Y, Z) = 5(X2 + Y 2 + Z2 âˆ’XY âˆ’XZ âˆ’YZ).
3. Letting f = f (X, Y, Z) stand for the given polynomial, adapt the reasoning used
in the solution of Example 16.3 to obtain
f (X, Y, Z) = (X + Y)(X + Z)(Y + Z)g(X, Y, Z),
with g âˆˆR[X, Y, Z] of degree 2. Now, use the equality f (0, y, z) = yzg(0, y, z)
to show that g(0, Y, Z) = Y 2+YZ+Z2 and, likewise, g(X, 0, Z) = X2+XZ+
Z2 and g(X, Y, 0) = X2 + XY + Y 2. Finally, obtain
g(X, Y, Z) = X2 + Y 2 + Z2 + XY + XZ + YZ.
Section 16.2
1. Use the symmetry of f and g to show that, for a ï¬xed permutation Ïƒ of In,
we have h(x1, . . . , xn) = h(xÏƒ(1), . . . , xÏƒ(n)) for inï¬nitely many elements
x1, . . . , xn âˆˆK. Then, use the result of Problem 1, page 398, as well as that of
Proposition 16.1.
3. For item (a), apply the deï¬nition twice. For (b), just note that all factors Xiâˆ’Xj,
for 1 â‰¤i < j â‰¤n, will appear in f Ïƒ as Â±(Xi âˆ’Xj). For (c), use the result of

614
22
Hints and Solutions
(a). Item (d) follows straightforwardly from (c). For item (e), and writing Ï„ in
place of Ï„kl for the sake of simplicity, we have
f Ï„ =

1â‰¤i<jâ‰¤n

XÏ„(i) âˆ’XÏ„(j)

=

1â‰¤i<jâ‰¤n
i,jÌ¸=k,l

XÏ„(i) âˆ’XÏ„(j)

Â·

k<jÌ¸=l

XÏ„(k) âˆ’XÏ„(j)

Â·
Â·

l<j

XÏ„(l) âˆ’XÏ„(j)

Â·

i<k

XÏ„(i) âˆ’XÏ„(k)

Â·
Â·

kÌ¸=i<l

XÏ„(i) âˆ’XÏ„(l)

Â·

XÏ„(k) âˆ’XÏ„(l)

Finally, for (f), show that the map Ïƒ â†’Ïƒ â—¦Ï„12 is a bijection from An to Sn\An.
4. If Sn stands for the set of all permutations of In and Ï„ âˆˆSn, use the fact that
Ïƒ â†’Ï„Ïƒ deï¬nes a bijection on Sn.
5. Adapt the argument given to the proof of Example 16.7.
6. Letting a2 + b2 + c2 = k, we have a3 + 3a2 = 3k âˆ’25, so that a is a root
of f (X) = X3 + 3X2 + (25 âˆ’3k); analogously,b and c are roots of such a
polynomial. Now, factorise f and use Girard-ViÃ¨te relations to conclude that
a + b + c = âˆ’3 and ab + ac + bc = 0, and hence that a2 + b2 + c2 = 9.
7. Letting z1, z2, z3 be the complex roots of the given polynomial, we want to ï¬nd
the coefï¬cients of f (X) = (X âˆ’z3
1)(X âˆ’z3
2)(X âˆ’z3
3) in terms of a, b and c. To
this end, use Girard-ViÃ¨te relations, together with the result of Example 16.3.
For instance, letting g(X) = X3 + aX2 + bX + c, we have g(X) = (X âˆ’
z1)(X âˆ’z2)(X âˆ’z3) and, hence,
z3
1 + z3
2 + z3
3 = (z1 + z2 + z3)3 âˆ’3(z1 + z2)(z1 + z3)(z2 + z3)
= (âˆ’a)3 âˆ’3(âˆ’a âˆ’z3)(âˆ’a âˆ’z2)(âˆ’a âˆ’z1)
= âˆ’a3 âˆ’3g(âˆ’a) = âˆ’a3 + 3ab âˆ’3c.
8. First of all, show that if a, b and c are such roots, then the hypothesis of a, b and
c being positive assures that a, b and c are the lengths of the sides of a triangle if
and only if (a+bâˆ’c)(a+câˆ’b)(b+câˆ’a) > 0. Then, substitute a+b+c = âˆ’p
at the left hand side, expand it and use the fact that ab + ac + bc = q and
abc = âˆ’r.
9. If f (X) = (X âˆ’a)(X âˆ’b)(X âˆ’c), then f (X) = X3 âˆ’p, with p = abc Ì¸= 0.
Now, argue as in the hint given to Problem 7, page 386.
10. Apply the result of Example 16.7 to the polynomial g(X) = X100 + 2X99 +
3X98 + Â· Â· Â· + a98X2 + a99X + a100. Then, show that its roots are the inverses
of the roots of f .

22
Hints and Solutions
615
11. Letting ax + by = c denote the equation of a straightline satisfying the stated
conditions, substitute y = âˆ’b
a x âˆ’c
a in the equation deï¬ning the graph of f
and, then, use Girard-ViÃ¨te relations.
12. Let (x âˆ’a)2 + (y âˆ’b)2 = R2 be the equation of the circle. Substitute y = 1
x
and, then, use Girard-ViÃ¨te relations.
13. For item (a), apply Corollary 15.32. For (b), use the fact that a3 = a2 + a + 1,
and analogously for b and c. Finally, for (c) use (b) and Girard-ViÃ¨te relations.
14. For item (a), use induction. For item (b), apply the result of (a), noticing that
f (X) = Xn + s1Xnâˆ’1 + s2Xnâˆ’2 + Â· Â· Â· + snâˆ’1X + sn.
15. Make induction on n â‰¥2 to conclude that x1 = x2 = . . . = xn = 1. For the
induction step, if
f (X) = (X âˆ’x1)(X âˆ’x2) Â· Â· Â· (X âˆ’xn)
= Xn + anâˆ’1Xnâˆ’1 + Â· Â· Â· + a1X + a0,
note that
0 = f (x1) + f (x2) + Â· Â· Â· + f (xn)
= n + anâˆ’1n + Â· Â· Â· + a1n + a0n = nf (1).
16. Firstly, show that the roots of f are negative. Then, apply Girard-ViÃ¨te
relations, together with the inequality between the arithmetic and geometric
means, to deduce that ak â‰¥
n
k

for 1 â‰¤k â‰¤n âˆ’1.
17. Letting x1, . . . , xn denote the roots of f , use Girard-ViÃ¨te relations to conclude
that
n

i=1
x2
i =

n

i=1
xi
2
âˆ’2

1â‰¤i<jâ‰¤n
xixj = 3
and 0n
i=1 x2
i
= 1. Then, apply the inequality between the arithmetic and
geometric means to show that n â‰¤3. Finally, separately consider each of
the cases n = 1, 2 and 3; in the case n = 3, you may wish to use some
Calculus (namely, the study of the ï¬rst variation and/or the intermediate value
theorem) to ï¬nd out which of the possible polynomials have only real roots. In
this respect, see [8] or the material of Sect. 17.1.
Section 16.3
1. For 1 â‰¤k â‰¤n, use Newtonâ€™s theorem and Girard-ViÃ¨te relations. For k â‰¥n + 1,
use item (a) of Proposition 16.17.

616
22
Hints and Solutions
2. Use item (b) of Proposition 16.17 to prove by induction on j that, for 1 â‰¤j â‰¤n,
the j-th elementary symmetric sums of a1, . . . , an and b1, . . . , bn coincide. Then,
compare the coefï¬cients of the polynomials 0n
j=1(X âˆ’aj) and 0n
j=1(X âˆ’bj).
3. Apply item (b) of Proposition 16.17 to prove, by induction on j, that sj =
n
j

for 1 â‰¤j â‰¤k.
4. For item (a), factorise Xm âˆ’zm over C and use the result to factorise g over C.
For (b), use Newtonâ€™s theorem to show that the elementary symmetric sums of
zm
1 , . . . , zm
n are integers. Finally, for (c), just note that g(X) = h(Xm), for some
h âˆˆZ[X].
5. For item (a), let f (X) = Xn + anâˆ’1Xnâˆ’1 + Â· Â· Â· + a1X + a0 be a polynomial
with integer coefï¬cients and such that all of its complex roots have modulus 1;
use Girard-ViÃ¨te relations to show that |anâˆ’k| â‰¤
n
k

for 0 < k â‰¤n. For item (b),
let Î±1, . . . , Î±n be the complex roots of f . Use Newtonâ€™s theorem to show that,
for each integer k â‰¥1, the polynomial fk(X) = (X âˆ’Î±2k
1 ) . . . (X âˆ’Î±2k
n ) has
integer coefï¬cients. Then, apply the result of (a) to assure the existence of natural
numbers k < l such that fk = fl. Finally, use such an equality to show that Î±j is
a root of unity, for 1 â‰¤j â‰¤n.
Section 17.1
1. For each nonreal complex root z = a +bi of f , write the factor (X âˆ’z)(X âˆ’z)
of f as in the proof of Lemma 17.1. Letting c be the leading coefï¬cient of
f , x1, . . . , xk its real roots and z1, z1, . . . , zl, zl the nonreal ones, with zj =
aj + ibj, we have
f (X) = c
k
j=1
(X âˆ’xj)
l
i=1
(X âˆ’zi)(X âˆ’zi)
= c
k
j=1
(X âˆ’xj)
l
i=1

(X âˆ’ai)2 + b2
i

.
Use this way of writing f to estimate |f (m)|, and notice that |f (m)| Ì¸= 0, 1.
2. If Î± < a < Î² are the roots of f closest to a, apply Bolzanoâ€™s theorem to
intervals of the form (a, b) or (b, a) contained in the interval (Î±, Î²).
3. Arguing by contradiction, assume that f â€²(a) > 0 (the case f â€²(a) < 0 is
completely analogous) and apply item (a) of Corollary 17.7, together with the
result of the previous problem.
4. Apply Bolzanoâ€™s theorem, Corollary 17.7 and the result of the previous
problem, noticing that f â€²(x) = 0 â‡”x = 0 or 8
5, and f (âˆ’1), f ( 8
5) < 0 <
f (0).

22
Hints and Solutions
617
5. Take n0 âˆˆN greater that the largest real roots of f and f â€². Use Bolzanoâ€™s
theorem, together with the fact that f (x) > 0 for sufï¬ciently large x (cf.
estimates analogous to those preceding (15.5)) to show that f (x) > 0 for
x > n0. Then, use Corollary 17.7 to show that f (u) > f (v) for u > v > n0.
6. Assume, without loss of generality, that f has positive leading coefï¬cient.
According to the previous problem, take n0 âˆˆN such that u > v > n0 â‡’
f (u) > f (v) > 0. Let m > n0 be an integer for which f (m) = p, a prime
number. If f (X) = anXn + anâˆ’1Xnâˆ’1 + Â· Â· Â· + a1X + a0, then
f (m + p2) = an(p2 + m)n + Â· Â· Â· + a1(p2 + m) + a0
= p2l + (akmk + Â· Â· Â· + a1m + a0)
= p2l + f (m) = f (m)(f (m)l + 1).
Now, check that the choice of m gives f (m + p2) > f (m), and conclude that
f (m + p2) is composite.
7. Firstly, show that the given condition is equivalent to x11 âˆ’x = y11 âˆ’y. Then,
prove that, for any c âˆˆR the polynomial f (x) = X11 âˆ’X âˆ’c has at most
three distinct real roots; to this end, you shall need to use Corollary 17.7 and
Problem 3, in a way analogous to that of the hint to Problem 4.
8. Since Î» Ì¸= 0, show that f (Î») = 1, where f (X) = (X âˆ’a1)(X âˆ’a2)(X âˆ’
a3)(X âˆ’a4). Then, show that f decreases in (âˆ’âˆ, a1), so that f (0) = 1 gives
Î» â‰¥a1. Finally, note that if a1 â‰¤Î» â‰¤a2, then f (Î») â‰¤0.
9. Let f (X) = aX4 + bX3 + cX2 + dX + e, and take t > 1 such that t2 is a real
root of aX2+(câˆ’b)X+(eâˆ’d). Show that f (t)f (âˆ’t) = (bt2+d)(1âˆ’t2) < 0
and, then, apply the theorem of Bolzano.
10. Set f (X) = n
i=1 aiXi, g(X) = n
i,j=1
aiaj
i+j Xi+j and conclude that xgâ€²(x) =
f (x)2 â‰¥0, for every x â‰¥0. Then, use Corollary 17.7 to obtain g(1) â‰¥g(0) =
0, with equality if and only if g is constant.
11. Start by showing that f has three distinct real roots Î± < Î² < Î³ , with âˆ’2 <
Î± < âˆ’1,0 < Î² < 1 and 1 < Î³ < 2. Then, note that f (f (x)) = 0 if and only
if f (x) = Î±, Î² or Î³ . Finally, ï¬nd out the numbers of distinct real roots of each
one of the polynomials f (X) âˆ’Î±, f (X) âˆ’Î² and f (X) âˆ’Î³ .
12. Set g(x) = f (x) + f â€²(x) + f â€²â€²(x) + Â· Â· Â· + f (n)(x) and assume, by the sake
of contradiction, that g attains negative values. Then, f Ì¸= 0 and the condition
f (x) â‰¥0 for x âˆˆR assures that n is even and f has positive leading coefï¬cient.
Hence, lim|x|â†’+âˆf (x) = +âˆ, and Weierstrassâ€™ theorem (Teorema 8.26 of
[8]) guarantees the existence of x0 âˆˆR such that g attains its minimum value
at x0, with g(x0) < 0. It follows from Problem 3 that gâ€²(x0) = 0. However,
since gâ€²(x0) = f â€²(x0) + f â€²â€²(x0) + Â· Â· Â· + f (n)(x0), we have 0 > g(x0) =
f (x0) + gâ€²(x0) = f (x0) â‰¥0, which is a contradiction.
13. Firstly, show that B can play in such a way that, when exactly three coefï¬cients
are left to be chosen, at least two of them are coefï¬cients of powers Xr, with
an odd r. Then, after A plays, we shall have f (X) = g(X) + akXk + akXl,
with g being a completely determined real polynomial, 1 â‰¤k, l â‰¤2nâˆ’1 being

618
22
Hints and Solutions
distinct integers such that ak and al are still left to be chosen and l odd. Since
f (2) = g(2) + 2kak + 2lal and f (âˆ’1) = g(âˆ’1) + (âˆ’1)kak âˆ’al, we shall have
f (2) + 2lf (âˆ’1) = g(2) + 2lg(âˆ’1) + (2k + (âˆ’1)k2l)ak, so that B can play by
choosing ak = âˆ’g(2)+2lg(âˆ’1)
2k+(âˆ’1)k2l . Finally, conclude that Bolzanoâ€™s theorem assures
the existence of at least one real root for f , no matter how A plays next.
14. Without loss of generality, we can assume that the leading coefï¬cient of the
polynomial f originally written in the blackboard is positive. Let Î± be the
smallest and Î² be the greatest real root of f (possibly with Î± = Î²). If Î± < Î²,
show that f â€²(Î±) > 0 or f â€²(Î²) > 0; if f â€²(Î²) > 0 (the case f â€²(Î±) > 0 can be
dealt with analogously), conclude that the next polynomial to be written either
has no root in the interval [Î², +âˆ) or has a root in the interval (Î², +âˆ). If
Î± = Î², conclude that f (X) = (X âˆ’Î±)3 and show that both f + f â€² and f âˆ’f â€²
fall into the ï¬rst case.
15. Setting bi = âˆ’ai for 1 â‰¤i â‰¤n, show that the condition f (x) â‰¥1 is equivalent
to p(x)
q(x) â‰¤0, with q(X) = 0n
i=1(X âˆ’bi) and
p(X) =
n

i=1
(X âˆ’bi) +
n

i=1
â›
âbi

jÌ¸=i
(X âˆ’bj)
â
â .
Show that p has a root x1 in the interval (b1, +âˆ); then, use Bolzanoâ€™s
theorem to show that p also has a root xi in each of the intervals (bi, biâˆ’1),
for 2 â‰¤i â‰¤n. By distinguishing the cases n even and n odd, show that
the sum of the lengths of the solution intervals of the inequality p(x)
q(x) â‰¤0
is
		n
i=1 xi âˆ’n
i=1 bi
		. Finally, apply Girard-ViÃ¨te relations to show that
n
i=1 xi = 0.
Section 17.2
1. Firstly, use the deï¬nition of the derivative of a polynomial to show that if g, h âˆˆ
R[X] are such that gâ€² = hâ€², then there exists c âˆˆR for which f = g + c. Now,
letting f â€²(X) = a(X+b)nâˆ’1, show that f (X) = a
n(X+b)n +c, for some c âˆˆR.
Finally, use the hypothesis on f to conclude that f (X) = (X + Î±)n, for some
Î± âˆˆR.
2. For the sake of contradiction, assume that the given polynomial has only real
roots. Then, use Newtonâ€™s inequalities, together with Girard-ViÃ¨te relations, to
conclude that 3a2 â‰¥8b, 4b2 â‰¥9ac and 3c2 â‰¥8bd.
3. Writing Hj = Hj(a, b, c, d), the given inequality is equivalent to H1H2 â‰¥H3.
Now, it follows from Newtonâ€™s inequalities that H1 â‰¥H2
H1 â‰¥H3
H2 .

22
Hints and Solutions
619
Section 17.3
1. First of all, note that V (f ) = V (f (âˆ’X)) â‰¤n. Then, apply Descartesâ€™ rule twice
to conclude that V (f ) + V (f (âˆ’X)) = 2n.
2. Example 17.17 assures that f has precisely one positive root. It now sufï¬ces
to apply Bolzanoâ€™s theorem to show that f

2 âˆ’
1
2nâˆ’1

and f

2 âˆ’1
2n

have
distinct signs. To this end, letting f denote the given polynomial and g(X) =
(X âˆ’1)f (X), note that g(X) = Xn+1 âˆ’2Xn + 1; then, use that 1 < 2 âˆ’
1
2nâˆ’1 <
2 âˆ’1
2n to show that it sufï¬ces to prove that g

2 âˆ’
1
2nâˆ’1

and g

2 âˆ’1
2n

have
distinct signs.
3. If f (X) = aX3 +bX2 +cX+d, we want to compute the number of real roots of
g = 2ff â€²â€² âˆ’(f â€²)2. Assume, without loss of generality, that a = 1. Moreover, if
Î± < Î² < Î³ are the roots of f , show that changing g(X) by h(X) = g(X+Î²), we
can assume (also without loss of generality) that Î² = 0 and, hence, that c < 0
and d = 0. Under such simpliï¬cations, an immediate computation furnishes
g(X) = 3X4 + 4bX3 + 6cX2 âˆ’c2. It now sufï¬ces to apply Descartesâ€™ rule to
conclude that g has exactly one positive root and exactly one negative root.
Section 18.1
1. For item (i), use the fact that âˆ‚fj = j to conclude that an = bn; then, argue by
induction. For (ii), take n = âˆ‚f and argue by induction on n; for the induction
step, start by choosing an to be equal to the leading coefï¬cient of f .
2. For k = 0 and k = 1 the result is obvious. For k â‰¥2, show that
X
k

(x) = 0 if
0 â‰¤x â‰¤k âˆ’1,
X
k

(x) =
x
k

if x â‰¥k and
X
k

(x) = (âˆ’1)kâˆ’xâˆ’1+k
k

if x < 0.
3. Apply the Lagrange interpolation theorem.
4. Apply the Lagrange interpolation theorem.
5. Adapt, to the present case, the proof of Proposition 18.6.
6. Let Ï‰
=
cis 2Ï€
n . For 1
â‰¤
k
â‰¤
n âˆ’1, substitute x
=
Ï‰k into the
polynomial functions corresponding to p and to the pjâ€™s, and use the result of
Proposition 18.6.
7. For item (a), look at the sum at the right hand side as the result of a Lagrange
interpolation. Item (b) follows directly from the factorisation obtained in (a).
Finally, for item (c), start by writing

kâ‰¥1
1
k(k + 1) . . . (k + n) = 1
n!

kâ‰¥1
n

j=0
(âˆ’1)j
n
j

1
k + j .
Then, for a ï¬xed l â‰¥n, show that 1
l appears in the last sum above with coefï¬cient
n
j=0(âˆ’1)jn
j

= 0.
8. For each prime p in the set A = {3, 5, 7, 11, 13, 17}, let Î±p denote the common
value of the sums ak + ak+p + ak+2p + Â· Â· Â· when k varies from 1 to p, and

620
22
Hints and Solutions
Ï‰p = cis 2Ï€
p . If f (X) = a50X50 + Â· Â· Â· + a2X2 + a1X, apply the general version
of the multisection formula (cf. Problem 8, page 355, or Example 18.7) for r =
0, 1, . . . , p âˆ’1 in order to obtain a Vandermonde system of equations in the p
unknowns f (Ï‰j
p), for 0 â‰¤j â‰¤p âˆ’1. Then, use the result of Proposition 18.6 to
conclude that the solution of such a system is f (1) = pÎ±p and f (Ï‰p) = Â· Â· Â· =
f (Ï‰pâˆ’1
p
) = 0, thus obtaining p âˆ’1 distinct and nonzero roots for f . Finally,
notice that 
pâˆˆA(p âˆ’1) = 50 and that 0 is also a root of f to obtain f = 0.
Section 18.2
2. Let us make induction on k â‰¥1, the case k = 1 being immediate. By induction
hypothesis, assume that the formula holds for a certain k âˆˆN. For k + 1, we
have:
f (x + (k + 1)h) = f (x + kh) + (1
hf )(x + kh)
= f (x + kh) +
k

j=0
k
j

(kâˆ’j
h
(1
hf ))(x)
=
k

j=0
k
j

(kâˆ’j
h
f )(x) +
k

j=0
k
j

(k+1âˆ’j
h
f )(x)
=
k

j=0
k
j

(kâˆ’j
h
f )(x) + (k+1
h
f )(x)
+
k

j=1
k
j

(kâˆ’(jâˆ’1)
h
f )(x).
Now, by performing a change of indices in the last sum above and applying
Stifelâ€™s relation, we obtain f (x + (k + 1)h) successively equal to
k

j=0
k
j

(kâˆ’j
h
f )(x) + (k+1
h
f )(x) +
kâˆ’1

j=0

k
j + 1

(kâˆ’jf )(x)
= (k+1
h
f )(x) +
kâˆ’1

j=0
k
j

+

k
j + 1

((k+1)âˆ’(j+1)
h
f )(x) + (0
hf )(x)
=
k+1

j=0
k + 1
j

(k+1âˆ’j
h
f )(x).

22
Hints and Solutions
621
3. Adapt, to the present case, the solutions of Examples 18.15 and 18.15.
4. Since âˆ‚f = n, Proposition 18.14 assures that n+1f = 0. Hence, it follows from
item (e) of Proposition 18.13 that
0 = (n+1f )(0) =
n+1

j=0
(âˆ’1)j
n + 1
j

f (n + 1 âˆ’j)
=
n+1

j=1
(âˆ’1)j
n + 1
j

Â·
1
 n+1
n+1âˆ’j
 + f (n + 1)
=
n+1

j=1
(âˆ’1)j + f (n + 1),
so that
f (n + 1) = âˆ’
n+1

j=1
(âˆ’1)j =
0, if n â‰¡1 (mod 2)
1, if n â‰¡0 (mod 2) .
5. Use item (e) of Proposition 18.13 to get the equality
0 = (991
1
f )(992) =
991

j=0
(âˆ’1)j
991
j

f (1983 âˆ’j).
Then, use the fact that, for every n âˆˆN, we have
n

j=1
n
j

F2n+1âˆ’j = F2n+1 âˆ’1
(cf. problem 18 of Section 4.3 of [8], for instance).
6. The given conditions assure that (k
1f )(0) > 0 for 0 â‰¤k â‰¤3 and (4
1f )(n) > 0
for each n âˆˆN. Now show that, for every m âˆˆN, we have
(mâˆ’1
1
f )(n) =
nâˆ’1

k=0
(m
1 f )(k) + (mâˆ’1
1
f )(0).
Finally, use this formula to successively show that (3
1f )(n) > 0, (2
1f )(n) >
0, (1f )(n) > 0 and f (n) = (0
1f )(n) > 0, for every n âˆˆN.

622
22
Hints and Solutions
Section 19.1
2. Firstly, show that pÎ³1
1 . . . pÎ³k
k divides both f and g in Q[X]. Secondly, show that
if h âˆˆQ[X]\{0} is monic and divides f in Q[X], then h = pÎ´1
1 . . . pÎ´k
k q
Î´â€²
1
1 . . . q
Î´â€²
l
l ,
with 0 â‰¤Î´i â‰¤Î±i for 1 â‰¤i â‰¤k, and 0 â‰¤Î´â€²
i â‰¤Î±â€²
i for 1 â‰¤i â‰¤l.
3. Adapt, to the present case, the proof of Euclidâ€™s algorithm for integers.
4. Apply Euclidâ€™s algorithm to ï¬nd X2 âˆ’3 as the answer.
5. Argue by contraposition.
7. Start by using Corollary 15.24, together with the result of Problem 4, page 386,
along the same lines of item (b) of Example 19.7.
8. Compute derivatives to show that f nâˆ’1f â€² + gnâˆ’1gâ€² = hnâˆ’1hâ€²; then, multiply
by h on both sides to obtain (f â€²h âˆ’f hâ€²)f nâˆ’1 = (ghâ€² âˆ’gâ€²h)gnâˆ’1. Use the fact
that f and h have no nontrivial common factors, together with Theorem 19.2
and the result of the previous problem to show that f â€²h âˆ’f hâ€² Ì¸= 0; accordingly,
show that ghâ€²âˆ’gâ€²h Ì¸= 0. Assume, without loss of generality, that âˆ‚f â‰¥âˆ‚g. Then,
apply again the result of the previous problem to the equality (f â€²hâˆ’f hâ€²)f nâˆ’1 =
(ghâ€² âˆ’gâ€²h)gnâˆ’1, conclude that f nâˆ’1 | (ghâ€² âˆ’gâ€²h) in R[X]. Finally, use this last
relation, together with f n + gn = hn, to obtain the following degree estimates
(n âˆ’1)âˆ‚f â‰¤âˆ‚g + âˆ‚h âˆ’1 â‰¤âˆ‚f + 2âˆ‚g âˆ’1
and conclude the solution of the problem.
9. For item (a), make induction on k, using the result of Corollary 19.4 to show that
there exist Ëœf1, fk âˆˆK[X] such that
f
g =
Ëœf1
gÎ±1
1 . . . gÎ±kâˆ’1
kâˆ’1
+ fk
gÎ±k
k
,
with Ëœf1 = 0 or âˆ‚Ëœf1 < âˆ‚(gÎ±1
1 . . . gÎ±kâˆ’1
kâˆ’1 ) and fk = 0 or âˆ‚fk < âˆ‚(gÎ±k
k ). For
item (b), start by dividing f by gk, thus getting f = gkq + r, with r = 0 or
0 â‰¤âˆ‚r < âˆ‚(gk); then, divide r by gkâˆ’1 and proceed inductively.
Section 19.2
1. For the uniqueness part of item (b), let a, b, c, d be nonzero integers with
gcd(a, b) = gcd(c, d) = 1, and g, h âˆˆZ[X] \ Z be primitives, with (a/b)g =
(c/d)h. Calculate contents in both sides of (ad)g = (bc)h.
2. Since f is reducible over Q, there exist monic and nonconstant polynomials
g1, h1 âˆˆQ[X] such that f
= g1h1. Take a, b, c, d âˆˆZ \ {0} such that
gcd(a, b) = gcd(c, d) = 1 and g1 =
a
bg, h1 =
c
d g, with g, h âˆˆZ[X]
monic and nonconstant. Take contents and apply Gaussâ€™ lemma to the equality
bdf (X) = acg(X)h(X) to conclude that bd = ac.

22
Hints and Solutions
623
3. First of all, note that d is primitive. Now, for (a) â‡’(b), let f , g and d
have canonical factorisations f = Â±f n1
1 . . . f nk
k , g = Â±gm1
1
. . . gml
l
and d =
ha1
1 . . . hak
k . Show that if dâ€² | f, g in Z[X], then the canonical factorisation of dâ€²
is dâ€² = h
aâ€²
1
1 . . . h
aâ€²
k
k , with aâ€²
i â‰¤ai for 1 â‰¤i â‰¤k. For (b) â‡’(a), argue in an
analogous way.
Section 19.3
1. For the veriï¬cation of the listed properties, follow the corresponding veriï¬ca-
tion for polynomials in K[X], with K = Q, R or C.
2. Apply Fermatâ€™s little theorem.
3. For the ï¬rst claim, note that
f (a) = 0 â‡’f (a) = 0 â‡’f (a) = 0.
For the second, use the root test to write
f (X) = (X âˆ’a1) . . . (X âˆ’ak)g(X),
for some nonzero g
âˆˆZp[X] with no roots in Zp. Then, perform the
substitution X â†’a and apply the second part of Problem 6, page 281 to
conclude that, for some index 1 â‰¤j â‰¤k, we have a âˆ’aj = 0.
4. If a âˆˆQ is a rational root of f , the rational roots test shows that a âˆˆZ and
a | 84. In order to eliminate some of the left possibilities, project f into Z3[X]
and Z5[X] to conclude, with the aid of the previous problem, that a â‰¡0 (mod 3)
and a â‰¡4 (mod 5), and hence that a = âˆ’6, âˆ’21 ou 84.
5. Make induction on âˆ‚f ; for the induction step, apply the result of Example 6.42.
6. Assume that fg is not primitive and choose a prime p that divides all of its
coefï¬cients. From the equality f g = fg = 0 in Zp[X], conclude that f = 0
or g = 0 and reach a contradiction.
7. Let a be a primitive root modulo p. For item (a), show that (ak)d Ì¸â‰¡1 (mod p),
for every integer 1 â‰¤k â‰¤p âˆ’1. For (b), show that (a
k(pâˆ’1)
d
)d â‰¡1 (mod p) for
every integer 1 â‰¤k â‰¤d, and then conclude that
Xd âˆ’1 =
d
k=1

X âˆ’a
k(pâˆ’1)
d

.
8. Use the result of Proposition 19.18, together with Girard-ViÃ¨te relations.

624
22
Hints and Solutions
9. Show that, modulo 17, we have
X3 âˆ’3X2 + 1 = (X âˆ’4)(X âˆ’5)(X + 6).
Then, let sk = ak + bk + ck and tk = 4k + 5k + (âˆ’6)k and conclude, with the
aid of the methods of Sect. 16.2, that
sk+3 âˆ’3sk+2 + sk = 0
s1 = 3, s2 = 0, s3 = âˆ’1
and
tk+3 âˆ’3tk+2 + tk = 0
t1 = 3, t2 = 0, t3 = âˆ’1 .
Finally, use the above to show that sn âˆˆZ for every n âˆˆN and sn â‰¡
tn (mod 17).
10. For item (a), project on Z2[X] and apply the result of Problem 5 with p = 2.
For (b), start by writing the binary representation of 2m âˆ’1; then, project on
Z2[X] and apply the result of Problem 5; ï¬nally, argue by induction on m.
For the coming problem, the reader may ï¬nd it useful to review the statement
of Problem 11, page 163.
11. For the proof of Lucasâ€™ theorem, compute in Zp[X], with the aid of Exam-
ple 19.15:
(X + 1)m = (X + 1)mkpk . . . (X + 1)m1p(X + 1)m0
= (Xpk + 1)mk . . . (Xp + 1)m1(X + 1)m0
Now, use the uniqueness of representation in base p to conclude that the
coefï¬cient of Xn in the right hand side is exactly
mk
nk

. . .
m1
n1
 m0
n0

.
For (a), if p |
m
n

then p |
mj
nj

for some 0 â‰¤j â‰¤k; in turn, if nj â‰¤mj, then
nj â‰¤mj < p, and the fact that p is prime avoids
mj
nj

=
mj !
nj !(mj âˆ’nj )! to have a
prime factor p. Item, (b) follows from (a) and the uniqueness of representation
in base p, since we ought to have 0 â‰¤nj â‰¤mj for 0 â‰¤j â‰¤k, which gives
exactly mj + 1 possibilities for nj. Finally, for item (c) note that pk+1 âˆ’1 =
(p âˆ’1)pk + Â· Â· Â· + (p âˆ’1)p + (p âˆ’1), so that m0 = m1 = . . . = mk = p âˆ’1.
Hence, from (b) there are pk+1 binomial numbers of the form
pk+1âˆ’1
n

which
are not divisible by p; thus, no binomial number is left to be divisible by p.
12. First of all, note that the equality Xpâˆ’1 = (Xâˆ’1)(Xpâˆ’1+Xpâˆ’2+Â· Â· Â·+X+1)
gives, in Zp[X],
(X âˆ’1)p = (X âˆ’1)(Xpâˆ’1 + Xpâˆ’2 + Â· Â· Â· + X + 1),

22
Hints and Solutions
625
so that (X âˆ’1)pâˆ’1 = Xpâˆ’1 +Xpâˆ’2 +Â· Â· Â·+X +1. Therefore, bi expanding the
binomial at the left hand side and comparing coefï¬cients, we get (âˆ’1)lpâˆ’1
l

â‰¡
1 (mod p). Now, if l = pk(p âˆ’1), then Lucasâ€™ theorem gives
pk(p âˆ’1)
l

=
pk(p âˆ’1)
pkq

â‰¡
p âˆ’1
q

â‰¡(âˆ’1)q (mod p).
For what is left to do, note that item (b) of the previous problem assures that
exactly p binomial numbers of the form
pk(pâˆ’1)
l

are not divisible by p; since
we have already found p such numbers (for q can vary from 0 to p âˆ’1), the
remaining ones are multiples of p.
Section 19.4
1. Firstly, show that the given polynomial has no integer roots. Then, invoke
Gaussâ€™ lemma and examine the possibility X4âˆ’X2 +1 = (X2+aX+b)(X2 +
cX + d), with a, b, c, d âˆˆZ.
2. Gaussâ€™ lemma assures that it sufï¬ces to show that f cannot be written as the
product of two nonconstant polynomials with integer coefï¬cients. To this end,
ï¬rst note that f has no integer roots; hence, if it can be written as the product
of two nonconstant polynomials with integer coefï¬cients, we must have
f (X) = (X2 + aX + b)(X3 + cX2 + dX + e),
for some a, b, c, d, e âˆˆZ. Expanding the products at the right hand side
and comparing coefï¬cients, conclude that be = 2, so that (b, e) = (1, 2),
(âˆ’1, âˆ’2), (2, 1) or (âˆ’2, âˆ’1). Then, check that each of these possibilities leads
to a contradiction when compared with the remaining relations involving a, b,
c, d and e.
3. Write f (Xn) = g(X)h(X), with g, h âˆˆR[X] \ R as in the statement of the
problem and n > 1 (the case n = 1 is trivial). If g(X) = bkXk+bk+1Xk+1+Â· Â· Â·
and h(X) = clXl + cl+1Xl+1 + Â· Â· Â· , with bk, cl Ì¸= 0, and changing g and h
respectively by g(X) = bk +bk+1X +Â· Â· Â· and h(X) = clXk+l +cl+1Xk+l+1 +
Â· Â· Â· , we can suppose that g(0), h(0) Ì¸= 0. Therefore, from the beginning let
g(X) = b0 + b1X + Â· Â· Â· and h(X) = clXl + cl+1Xl+1 + Â· Â· Â· , with b0, cl Ì¸= 0.
Use the fact that f (Xn) = g(X)h(X) to show that n | l. Then, cancel the terms
of minimal degree at both sides of the equality f (Xn) = g(X)h(X) and argue
by induction on âˆ‚f to show that g(X) = g1(Xn) and h(X) = h1(Xn), for some
g1, h1 âˆˆR[X] \ R as prescribed in the statement of the problem
4. Once more from Gaussâ€™ lemma, we examine when it does happen that f =
gh, with g, h âˆˆZ monic and nonconstant. Adapting the idea of the proof of
Example 19.32, we have 1 = f (0) = g(0)h(0), so that g(0) = h(0) = Â±1;

626
22
Hints and Solutions
hence, a1, a2, . . . , an are pairwise distinct roots of g âˆ’h. If g âˆ’h Ì¸= 0, then
âˆ‚(g âˆ’h) â‰¤max{âˆ‚g, âˆ‚h} < âˆ‚f = n, so that g âˆ’h must have less than n distinct
roots. Therefore, g âˆ’h = 0, and hence f = g2, or
g(X)2 âˆ’1 = (X âˆ’a1) . . . (X âˆ’an).
In particular, n = 2k for some k âˆˆN, and the unique factorisation in Z[X]
gives, without loss of generality,
g(X) âˆ’1 = (X âˆ’a1) . . . (X âˆ’ak) and g(X) + 1 = (X âˆ’ak+1) . . . (X âˆ’a2k),
with a1 < a2 < Â· Â· Â· < ak and ak+1 < ak+2 < Â· Â· Â· < a2k. Therefore,
2 = (X âˆ’ak+1) . . . (X âˆ’a2k) âˆ’(X âˆ’a1) . . . (X âˆ’ak)
and, by evaluating the equality above at a1, a2, . . . , ak, respectively, we obtain
(ai âˆ’ak+1) . . . (ai âˆ’a2k) = 2
for 1 â‰¤i â‰¤k. From this point, conclude that if k â‰¥3 then at least two of
the numbers ak+1, ak+2, . . . , a2k would be equal, which is not the case. Finally,
look separately at the cases k = 1 and k = 2 to get the listed polynomials.
5. Apply Eisensteinâ€™s criterion in conjunction with the result of item (a) of
Problem 8, page 469.
6. For the sake of contradiction, assume that f = gh, with g, h âˆˆZ[X] \ Z, and
examine the equality f (X) = g(X)h(X) in Zp[X].
7. As in Example 19.28, it sufï¬ces to establish the irreducibility of g(X) = f (X+
1). To this end, start by applying several times the result of Problem 5, page 469,
to show that, in Zp[X], one has
g(X) =

Xpkâˆ’1 + 1
pâˆ’1 +

Xpkâˆ’1 + 1
pâˆ’2 + Â· Â· Â· +

Xpkâˆ’1 + 1

+ 1.
Then, also as in Example 19.28, use the fact that
p

j=1
(Y + 1)pâˆ’j =
p

j=1

p
j âˆ’1

Y pâˆ’j = Y pâˆ’1
to get g(X) = Xpkâˆ’1(pâˆ’1). Then, look at the constant coefï¬cient of g(X) =
f (X + 1) to conclude that
g(X) = Xm + amâˆ’1Xmâˆ’1 + Â· Â· Â· + a1X + p,
with m = pkâˆ’1(p âˆ’1) and a1, a2, . . . , amâˆ’1 âˆˆZ being multiples of p. Finally,
apply Eisensteinâ€™s criterion.
8. Thanks to Gaussâ€™ lemma, we only need to show that f is irreducible in Z[X].
By contradiction, assume we have f = gh, with g, h âˆˆZ[X] \ Z and (with no

22
Hints and Solutions
627
loss of generality, since f (0) = p) g(0) = Â±1. Use Girard-ViÃ¨te relations to
conclude that g, and thus f , has a complex root z of modulus less than 1. Then,
substitute the expression for f in the equality f (z) = 0 and use the hypotheses
on the coefï¬cients of f to reach a contradiction.
9. Let z1, . . . , zn be the complex roots of f . If |zj| â‰¤1 for some 1 â‰¤j â‰¤n, then
|a0| = |a1zj + Â· Â· Â· + anzn
j|
â‰¤|a1||zj| + Â· Â· Â· + |an||zj|n
â‰¤|a1| + Â· Â· Â· + |an|,
which is an absurd; therefore, |zj| > 1 for 1 â‰¤j â‰¤n. Now, suppose that
f = gh, with g, h âˆˆZ[X] \ Z, say g(X) = b0 + b1X + Â· Â· Â· + brXr and
h(X) = c0 + c1X + Â· Â· Â· + csXs, with r, s â‰¥1 and br, cs Ì¸= 0. By renumbering
the zjâ€™s, if necessary, we can assume that the roots of g are z1, . . . , zr. Then,
Girard-ViÃ¨te relations give
|b0| = |br||z1| . . . |zr| > |br| and |c0| = |cs||zr+1| . . . |zn| > |cs|.
Hence, |b0| â‰¥|br| + 1 and |c0| â‰¤|cs| + 1, so that
|a0| = |b0||c0| â‰¥(|br| + 1)(|cs| + 1)
= |br||cs| + |br| + |cs| + 1
â‰¥|br||cs| + 2
:
|br||cs| + 1
= (
:
|br||cs| + 1)2
= (
:
|an| + 1)2.
This way, âˆš|a0| â‰¥âˆš|an| + 1, which is an absurd.
11. For item (a), use an argument analogous to that of the proof of Lemma 17.1.
For item (b), suppose that f = gh, with g, h âˆˆZ[X] \ Z. Then, it follows from
(a) that all of the coefï¬cients of g1(X) = g

X + m âˆ’1
2

have a single sign.
Hence, g2(X) := g1(âˆ’X) has nonzero coefï¬cients of alternating signs, so that
|g2(x)| < |g1(x)| for every x > 0 and, thus,
g

âˆ’x + m âˆ’1
2

< g

x + m âˆ’1
2

for every x > 0; in particular, |g(m âˆ’1)| < |g(m)|. Conclude that |g(m)| â‰¥2
and, analogously, |h(m)| â‰¥2. Finally, use the fact that f (m) is prime to reach
a contradiction.
12. Combine PÃ³lya-SzegÃ¶â€™s theorem (cf. previous problem) with the result of
Problem 9, page 386.

628
22
Hints and Solutions
Section 20.1
1. If f (X) = anXn +Â· Â· Â·+a1X +a0 âˆˆQ[X]\Q has Î± as one of its roots, look at
g(X) = an
rn Xn +
an
rnâˆ’1 Xnâˆ’1 + Â· Â· Â· + a1
r X + a0 âˆˆQ[X] \ Q.
2. The ï¬rst de Moivreâ€™s formula gives (cos 2kÏ€
n
+ i sin 2kÏ€
n )n = 1. Expand the
binomial at the left hand side and apply identity sin2 2kÏ€
n
+ cos2 2kÏ€
n
= 1 to
ï¬nd nonzero polynomials with rational coefï¬cients having cos 2kÏ€
n
and sin 2kÏ€
n
as roots. Alternatively, for cos 2kÏ€
n
use the result of Example 15.27, together
with cos 2kÏ€
n
= 2 cos2 kÏ€
n âˆ’1 and Theorems 20.9 and 20.12; for sin 2kÏ€
n , use
Trigonometry, together with the fact that cos 2kÏ€
n
is algebraic.
3. Apply Eisensteinâ€™s criterion (cf. Corollary 19.27).
4. First use Gaussâ€™ Theorem 19.14 to show that there exists g âˆˆZ[X] \ Z,
irreducible over Z and such that g(Î±) = 0. The, use Gaussâ€™ Lemma 19.13
to conclude that g is also irreducible over Q, so that g = pÎ±.
5. For item (a), apply Remark 20.10 several times, together with the fact that
pâˆšaj (X) = X âˆ’âˆšaj or X2 âˆ’aj, according to whether âˆšaj âˆˆN or âˆšaj /âˆˆN.
For (b), use (a) and the rational roots test (cf. Proposition 15.16).
6. Problem 2, page 475, shows that f is irreducible over Q. Now, suppose that
there exist relatively prime integers a and b and a natural number n > 1 such
that f (Î±) = 0, with Î± =
n;
| a
b|. Let
g(X) = bXn âˆ’a = b(X âˆ’Î±)(X âˆ’Î±Ï‰) . . . (X âˆ’Î±Ï‰nâˆ’1),
with Ï‰ = cis 2Ï€
n . Corollary 20.4 shows that f = pÎ±; hence, item (b) of
Proposition 20.3 guarantees that f divides g in Q[X] and, hence, in Z[X] (for
f âˆˆZ[X] is monic). Thus, it follows from Problem 4, page 386, the existence
of integers 1 â‰¤k < l â‰¤n âˆ’1 such that
f (X) = (X âˆ’Î±)(X âˆ’Î±Ï‰k)(X âˆ’Î±Ï‰k)(X âˆ’Î±Ï‰l)(X âˆ’Î±Ï‰l).
By examining the independent term of f , conclude that âˆ’Î±5 = 2 and, then,
Î± = âˆ’
5âˆš
2. How, arrive at a contradiction.
7. If Î± = Î±1, . . . , Î±m are the roots of pÎ± and Î² = Î²1, . . . , Î²n are those of pÎ², the
natural candidate to be looked at is
h(X) =

1â‰¤iâ‰¤m
1â‰¤jâ‰¤n
(X âˆ’Î±iÎ²j) = (Î±1 . . . Î±m)n
m

i=1
pÎ²
 1
Î±i
X

.
Now, note that Î±1 . . . Î±m = Â±pÎ±(0) âˆˆQ.

22
Hints and Solutions
629
8. Item (a) is almost immediate. For multiplication, start by taking f, g âˆˆQ[X] \
{0} and writing f q = pÎ±q + r, with r = 0 or âˆ‚r < âˆ‚pÎ± = n; then, show that
f (Î±)g(Î±) = r(Î±), so that f (Î±)g(Î±) âˆˆQ(Î±). For (b), let Î² = f (Î±) = g(Î±),
with f, g âˆˆQ[X] such that f = 0 or âˆ‚f â‰¤n âˆ’1 and likewise for g; note that
(f âˆ’g)(Î±) = 0, and successively conclude that pÎ± | (f âˆ’g) and f âˆ’g = 0.
Finally, for (c), show that gcd(f, pÎ±) = 1 follows from the irreducibility of
pÎ±. Therefore, Corollary 19.4 gives fg + pÎ±q = 1, for some g, q âˆˆQ[X]
satisfying g = 0 or âˆ‚g < âˆ‚pÎ± = n and q = 0 or âˆ‚q < âˆ‚f . Then, evaluate this
equality at Î± to show that 1
Î² âˆˆQ(Î±).
9. For the ï¬rst part, note that p 3âˆš
2(X) = X3 âˆ’2, so that Q(
3âˆš
2) = {a + b
3âˆš
2 +
c
3âˆš
4; a, b, c âˆˆQ}. The second part can be solved following the steps in the
hint given to Problem 8, page 200. Alternatively, follow the steps listed in the
hint given to item (c) of the previous problem; more precisely, letting f (X) =
1 + X + 2X2 (so that 1 +
3âˆš
2 + 2
3âˆš
4 = f (
3âˆš
2)), use Euclidâ€™s algorithm to ï¬nd
g, q âˆˆQ[X] such that fg + p 3âˆš
2q = 1 and then note that f (
3âˆš
2)g(
3âˆš
2) = 1.
10. Start by showing that Ï†(0) = 0 for any such Ï†. Then, use (ii) to show that
Ï†(1) = 0 or Ï†(1) = 1. If Ï†(1) = 0, conclude that Ï† â‰¡0; if Ï†(1) = 1, show
successively that Ï†(m) = m for every m âˆˆZ and Ï†(r) = r for every r âˆˆQ.
Now, letting pÎ±(X) = Xn + anâˆ’1Xnâˆ’1 + Â· Â· Â· + a1X + a0, note that
0 = Ï†(0) = Ï†(pÎ±(Î±)) = Ï†(Î±)n + anâˆ’1Ï†(Î±)nâˆ’1 + Â· Â· Â· + a1Ï†(Î±) + a0,
so that Î² = Ï†(Î±) is also a root of pÎ±. In turn, show that, for any f âˆˆQ[X]\{0}
satisfying âˆ‚f â‰¤n âˆ’1, we have Ï†(f (Î±)) = f (Ï†(Î±)) = f (Î²), so that Ï† is
completely determined by the fact that Ï†(Î±) = Î². Conversely, for any such
root Î² of pÎ±, let Ï† : Q(Î±) â†’be given by Ï†(f (Î±)) = f (Î²), for any f âˆˆQ[X]
satisfying f â‰¡0 or âˆ‚f â‰¤n âˆ’1. It is straightforward to show that (i) holds. For
(ii), let f, g âˆˆQ[X] \ {0} be given and write fg = pÎ±q + r, with q, r âˆˆQ[X]
such that r â‰¡0 or âˆ‚r â‰¤n âˆ’1. Then, show that
Ï†(f (Î±)g(Î±)) = Ï†((fg)(Î±)) = Ï†(r(Î±)) = r(Î²)
= f (Î²)g(Î²) = Ï†(f (Î±))Ï†(g(Î±)).
Section 20.2
1. Use item (a) of Proposition 20.14 for n = pkâˆ’1 and n = pk.
2. A typical root of 2n is Ï‰ = cis 2kÏ€
2n , for some integer 1 â‰¤k â‰¤2n such that
gcd(k, 2n) = 1. Now, use the fact that âˆ’Ï‰ is also of this form to conclude that
âˆ’Ï‰ is a root of 2n too. Then, show that 2n is a product of factors of the form
(X âˆ’Ï‰)(X + Ï‰).

630
22
Hints and Solutions
3. If m and n have a nonconstant common factor in C[X], then, being the
minimal polynomials of any of its common roots, they are identical. Then, letting
m = n = f , item (a) of Proposition 20.14 shows that f 2 divides Xmn âˆ’1,
which is impossible.
4. Firstly, with n and d as in the statement, note that Ï•(n) = Ï•(d) Â· n
d , so that
âˆ‚n = âˆ‚f , where f (X) = d(Xn/d). Now, if Ï‰ = cis 2kÏ€
n , with 1 â‰¤k â‰¤d and
gcd(k, d) = 1, and Î· âˆˆC is an n
d -th root of Ï‰, show that Î· is an n-th primitive
root of unity. Finally, conclude that n and f have the same roots.
5. Dirichletâ€™s theorem allows us to choose d âˆˆN tal such that 1 + kd = p, a prime
number. Now, look at the arithmetic progression
1
(pâˆ’1)!,
1+d
(pâˆ’1)!, . . . , 1+(kâˆ’1)d
(pâˆ’1)! .
6. The general version of Dirichletâ€™s theorem assures that the arithmetic progression
(n + 2, 2n + 2, 3n + 2, . . .) contains inï¬nitely many primes. Letting p = kn +
2 > a be one such prime and g be a primitive root modulo p, the fact that
{g, g2, . . . , gpâˆ’1} is a RRS modulo p assures the existence of an integer 1 â‰¤
t â‰¤p âˆ’1 such that gt â‰¡a (mod p). Now, apply BÃ©zoutâ€™s theorem to guarantee
the existence of natural numbers u and v such that nu = t + (p âˆ’1)v, so that
(gu)n â‰¡a (mod p).
7. Firstly, consider the case of an odd a. Since a is not a perfect square, there
exist natural numbers b and t, and distinct odd primes q1, . . . , qt such that
a = b2q1 . . . qt. Then, Proposition 12.23 guarantees that it sufï¬ces to ï¬nd
inï¬nitely many prime numbers p for which

q1
p

. . .

qt
p

= âˆ’1. In turn,
Quadratic Reciprocity Law assures that such a relation is equivalent to
t
j=1
 p
qj

= (âˆ’1)
1+
 pâˆ’1
2

( sâˆ’t
2 ),
with s = t
j=1 qj. Now, apply Dirichletâ€™s theorem, choosing p = 4kq1 . . . qt +
1.
8. Let  = a2 âˆ’4b. Multiplying both sides of the given equation by 4 and
completing squares, show that the hypotheses of the problem guarantee that the
quadratic congruence x2 â‰¡ (mod n) has a solution for every n âˆˆN. If  is not
a perfect square, write  = Î±Î²2, with Î±, Î² âˆˆZ and |Î±| > 1 being square free.
Then, use the result of the previous problem to reach a contradiction.
Section 20.3
1. We parallel the proof of the cancellation law for addition:
a Â· c = b Â· c â‡’(a Â· c) Â· câˆ’1 = (b Â· c) Â· câˆ’1
â‡’a Â· (c Â· câˆ’1) = b Â· (c Â· câˆ’1)
â‡’a Â· 1 = b Â· 1 â‡’a = b,

22
Hints and Solutions
631
2. If Î±pn = Î± and Î²pn = Î², then
(Î± + Î²)pn = Î±pn + Î²pn = Î± + Î²,
so that Î± + Î² âˆˆRn. Argue in the same way to show that Î±Î² âˆˆRn and (if Î± Ì¸= 0)
Î±âˆ’1 âˆˆRn. Then, show that Rn is a ï¬eld.
3. For the ï¬rst part, use (20.10). For the second, use (20.9), together with the fact
that f11(X) . . . f1a1(X) = Xp âˆ’X and
Xp2 âˆ’X = (Xp)p âˆ’Xp + Xp âˆ’X
= (Xp âˆ’X)p + Xp âˆ’X
= (Xp âˆ’X)

(Xp âˆ’X)pâˆ’1 + 1

.
4. Certainly every f âˆˆK[X] of degree 1 is irreducible. Now, if f1, f2, . . . , fk âˆˆ
K[X] are irreducible (there are at least two such polynomials, X and X âˆ’1), let
f = f1f2 . . . fk + 1, choose an irreducible factor g âˆˆK[X] of f and show that
g Ì¸= f1, f2, . . . , fk.
Section 20.4
1. Note that the decimal expansion of Î± is not periodic.
2. For the sake of contradiction, if Î± + Î² = r, with r âˆˆQ, and f (Î±) = 0 for
f (X) = anXn + Â· Â· Â· + a1X + a0 âˆˆQ[X] \ {0}, then
an(r âˆ’Î²)n + Â· Â· Â· + a1(r âˆ’Î²) + a0 = 0.
Use this equality to show that Î² would be algebraic.
3. If
nâˆšÎ± was algebraic, then several applications of Theorem 20.12 assure that the
same would be true of
 nâˆšÎ±

= Î±. If Î±n were algebraic, and f âˆˆQ[X] \ {0}
satisï¬es f (Î±n) = 0, ï¬nd g âˆˆQ[X] \ {0} such that g(Î±) = 0.
4. For the second part, if Q[Î±] was a subï¬eld of C there would exist n âˆˆN and
a0, a1, . . . , an âˆˆQ such that an Ì¸= 0 and 1
Î± = a0 + a1Î± + Â· Â· Â· + anÎ±n. Show that
this would force Î± to be algebraic.
5. Let Î± âˆˆR and, for 1 â‰¤k â‰¤2016, let Ak be the point of the cartesian plane
whose coordinates are the real and imaginary parts of (Î± + iÎ±2)Ï‰kâˆ’1, with Ï‰ =
cos 2Ï€
2016 + i sin 2Ï€
2016. Then A1A2 . . . A2016 is a regular 2016-gon, and it sufï¬ces
to show that it is possible to choose Î± in such a way that Ak /âˆˆS for every k.
Let  be one of the circles in S, with center O = (a, b) and radius r, so that
a, b, r âˆˆQ. Letting cos 2(kâˆ’1)Ï€
2016
= c and sin 2(kâˆ’1)Ï€
2016
= s, we have
(Î± + Î±2i)(c + si) = (cÎ± âˆ’sÎ±2) + (sÎ± + cÎ±2)i.

632
22
Hints and Solutions
Then, Ak âˆˆ â‡”AkO = r or, which is the same, if and only if

(cÎ± âˆ’sÎ±2) âˆ’a
2 +

(sÎ± + cÎ±2) âˆ’b
2 âˆ’r2 = 0.
In turn, this last equality is equivalent to
Î±4 + (1 âˆ’2bc + 2as)Î±2 + (2ac âˆ’2bs)Î± + (a2 + b2 âˆ’r) = 0.
However, since c and s are algebraic over Q (cf. Problem 2, page 486), we
conclude from the above remark that Î± should be algebraic over Q. Therefore,
by choosing Î± âˆˆR to be transcendental, we conclude that Ak /âˆˆS for every k.
Section 21.1
1. For every integer k â‰¥0, set f (k)(x) = akeâˆ’x sin x + bkeâˆ’x cos x, so that
f (k+1)(x) = âˆ’(ak + bk)eâˆ’x sin x + (ak âˆ’bk)eâˆ’x cos x
and, hence, ak+1 = âˆ’(ak + bk), bk+1 = ak âˆ’bk. Then, conclude that bk+2 +
2bk+1 + 2bk = 0 for k â‰¥0.
2. The characteristic polynomial of the involved recurrence relations is f (X) =
kXk âˆ’Xkâˆ’1 âˆ’Â· Â· Â· âˆ’X âˆ’1. If Î± âˆˆC is a root of f such that |Î±| Ì¸= 1, we have
k|Î±|k = |Î±kâˆ’1 + Â· Â· Â· + Î± + 1|
â‰¤|Î±|kâˆ’1 + Â· Â· Â· + |Î±| + 1
= |Î±|k âˆ’1
|Î±| âˆ’1 ,
so that k|Î±|k+1 âˆ’(k + 1)|Î±|k + 1 â‰¤0. Study the ï¬rst variation of g(X) =
(X âˆ’1)f (X) = kXk+1 âˆ’(k + 1)Xk + 1 to conclude that |Î±| < 1. If Î± âˆˆC is a
root of f such that |Î±| = 1, review the above estimates to obtain
k = k|Î±|k = |Î±kâˆ’1 + Â· Â· Â· + Î± + 1|
â‰¤|Î±|kâˆ’1 + Â· Â· Â· + |Î±| + 1 = k
and, hence, to conclude (from the condition for equality in the triangle inequality
for complex numbers, cf. Problem 3, page 326) that Î±j = Î»j Â·1, for some Î»j > 0.
Up to this point, we have shown that, apart from 1, all of the other complex
roots of f have modulus less than 1. Moreover, they are all simple roots, for

22
Hints and Solutions
633
gâ€²(X) = k(k + 1)Xkâˆ’1(X âˆ’1) implies that the only multiple root of g is 1, with
multiplicity 2. Now, use Theorem 21.3 to obtain, for m > k,
xm = u1 + u2Î±mâˆ’1
2
+ Â· Â· Â· + ukÎ±mâˆ’1
k
,
with Î±1 = 1, Î±2, . . . , Î±k being the complex roots of f . Then, conclude that
xm
m
âˆ’â†’u1. In order to compute u1, note that
â§
âªâªâ¨
âªâªâ©
u1 + u2 + Â· Â· Â· + uk = a1
u1 + u2Î±2 + Â· Â· Â· + ukÎ±k = a2
Â· Â· Â·
u1 + u2Î±kâˆ’1
2
+ Â· Â· Â· + ukÎ±kâˆ’1
k
= ak
and f (X) = (X âˆ’1)h(X), with f (X) = (X âˆ’1)(kXkâˆ’1 + (k âˆ’1)Xkâˆ’2 + Â· Â· Â· +
2X + 1). Finally, in the above system, multiply the j-th equation (from top to
bottom) by j and add the results to reach
k(k + 1)
2
u1 +
k

j=2
ujh(Î±j) = kak + (k âˆ’1)akâˆ’1 + Â· Â· Â· + 2a2 + a1.
Argue analogously to ym.
3. If f (X) = X3 âˆ’3X2 + 1, start by showing that f has real roots a > b > c, such
that âˆ’6
10 < c < âˆ’5
10, 6
10 < b < 7
10 and 0 < bn +cn < 1 for every integer n â‰¥2.
If an = an + bn + cn for n â‰¥1, show that a1, a2, a3 âˆˆZ and ak+3 = 3ak+2 âˆ’ak
for k â‰¥1; then, conclude from what we did above that âŒŠanâŒ‹= an âˆ’1. Finally,
use the linear recurrence relation satisï¬ed by the sequence (an)nâ‰¥1 to show that
ak+17 â‰¡ak (mod 17); alternatively, invoke the result of Problem 9, page 469.
Section 21.2
1. For the second part, suppose that |z| > R and let Ïµ = |z| âˆ’R. Use the deï¬nition
of convergence to ï¬nd an n âˆˆN such that |zn âˆ’z| < Ïµ, and deduce that |zn| > R,
which is a contradiction.
2. Use the result of the previous problem.
3. Adapt the reasoning presented in the proof of Proposition 21.15.
4. Apply the result of items (a) and (b) of the previous problem to the sequence of
partial sums of the series 
kâ‰¥1(azk + bwk).
5. Adapt, to the present case, the proof of Proposition 3.7.
7. Start by observing that, if (zn)nâ‰¥1 is a sequence in X such that zn â†’z, with
z âˆˆX, then the triangle inequality gives
		|f (zn)| âˆ’|f (z)|
		 â‰¤|f (zn) âˆ’f (z)|.
8. Start by observing that, if (zn)nâ‰¥1 is a sequence in X such that zn â†’z, then
|zn âˆ’z| < B for every sufï¬ciently large index n; hence, |f (zn) âˆ’f (z)| â‰¤

634
22
Hints and Solutions
A|zn âˆ’z|, also for every sufï¬ciently large index n. Now, given Ïµ > 0, note that
|f (zn) âˆ’f (z)| < Ïµ if |zn âˆ’z| < Ïµ
A; then, use the convergence of (zn)nâ‰¥1 to z.
9. Case m = 1 is the content of Example 21.12. For m = 2 and |z| <
1
|a|, we get
from the initial case that
1
(1 âˆ’az)2 =
â›
â
kâ‰¥0
akzk
â
â 
â›
â
lâ‰¥0
alzl
â
â =

k,lâ‰¥0
ak+lzk+l
=

nâ‰¥0
(n + 1)anzn.
By induction, if
1
(1 âˆ’az)mâˆ’1 =

nâ‰¥0
n + m âˆ’2
m âˆ’2

anzn,
then
1
(1 âˆ’az)m =
1
1 âˆ’az Â·
1
(1 âˆ’az)mâˆ’1
=

kâ‰¥0
akzk Â·

lâ‰¥0
l + m âˆ’2
m âˆ’2

alzl
=

k,lâ‰¥0
l + m âˆ’2
m âˆ’2

ak+lzk+l
=

nâ‰¥0
n + m âˆ’1
m âˆ’1

anzn,
where, in the last equality above, we have used the columnsâ€™ theorem of Pascal
triangle (cf. Proposition 4.17 of [8]).
Section 21.3
1. Use Theorem 21.22, together with the fact that the characteristic polynomial of
the given sequence is
X2k âˆ’2Xk + 1 = (Xk âˆ’1)2 =
k
j=1
(X âˆ’Ï‰j)2.
2. An easy inspection shows that the characteristic polynomial of (an)nâ‰¥1 is (X âˆ’
1)(X âˆ’2)2. Thus, Theorem 21.22 gives an = A+(B +C(nâˆ’1))2nâˆ’1, for some
real constants A, B and C. Since an
2n = 1
2(B + C(n âˆ’1)), we must have C = 0
and B
2 = 3. Finally, a1 = 1 gives A + B = 1.

Glossary
Problems tagged with a countryâ€™s name refer to any round of the corresponding
national mathematical olympiad. For example, a problem tagged â€œBrazilâ€ means
that it appeared in some round of some edition of the Brazilian Mathemati-
cal Olympiad. Problems proposed in other mathematical competitions, or which
appeared in mathematical journals, are tagged with a speciï¬c set of initials, as listed
below:
AIME
American Invitational Mathematics Examination
APMO
Asian-Paciï¬c Mathematical Olympiad
Austrian-Polish
Austrian-Polish Mathematical Olympiad
BMO
Balkan Mathematical Olympiad
Crux
Crux Mathematicorum, a mathematical journal of the Cana-
dian Mathematical Society
EKMC
EÃ¶tvÃ¶s-KÃ¼rschÃ¡k Mathematics Competition (Hungary)
IMO
International Mathematical Olympiad
IMO shortlist
Problem proposed to the IMO, though not used
MiklÃ³s-Schweitzer
The MiklÃ³s-Schweitzer Mathematics Competition (Hun-
gary)
OCM
State of CearÃ¡ Mathematical Olympiad
OCS
South Cone Mathematical Olympiad
OBMU
Brazilian Mathematical Olympiad for University Students
OIM
Iberoamerican Mathematical Olympiad
ORM
Rioplatense Mathematical Olympiad
Putnam
The William Lowell Mathematics Competition
Saint Petersburg
Mathematical competition of the city of Saint Petersburg,
Russia
TT
The Tournament of the Towns
Â© Springer International Publishing AG, part of Springer Nature 2018
A. Caminha Muniz Neto, An Excursion through Elementary Mathematics, Volume III,
Problem Books in Mathematics, https://doi.org/10.1007/978-3-319-77977-5
635

Bibliography
1. M. Aigner, G. Ziegler, Proofs from THE BOOK (Springer, Heidelberg, 2010)
2. G. Andrews, Number Theory (Dover, Mineola, 1994)
3. T. Apostol, Calculus, Vol. 1 (Wiley, New York, 1967)
4. T. Apostol, Calculus, Vol. 2 (Wiley, New York, 1967)
5. T. Apostol, Introduction to Analytic Number Theory (Springer, New York, 1976)
6. R. Ash, Basic Abstract Algebra: for Graduate Students and Advances Undergraduates (Dover,
Mineola, 2006)
7. A. Caminha, Uma prova elementar de que os nÃºmeros complexos algÃ©bricos sobre Q formam
um corpo. MatemÃ¡tica UniversitÃ¡ria 52/53, 14â€“17 (2015) (in Portuguese)
8. A. Caminha, An Excursion Through Elementary Mathematics I - Real Numbers and Functions
(Springer, New York, 2017)
9. A. Caminha, An Excursion Through Elementary Mathematics II - Euclidean Geometry
(Springer, New York, 2018)
10. J.H.E. Cohn, Square Fibonacci numbers, etc. Fibon. Quart. 2, 109â€“113 (1964)
11. J.B. Conway, Functions of One Complex Variable I (Springer, New York, 1978)
12. R. Courant, H. Robbins, What Is Mathematics (Oxford University Press, Oxford, 1996)
13. R. Diestel, Graph Theory (Springer, New York, 2000)
14. R. Dilworth, A decomposition theorem for partially ordered sets. Ann. Math. 51, 161â€“166
(1950)
15. P. ErdÃ¶s, E. Szekeres, A combinatorial problem in geometry. Compos. Math. 2, 463â€“470 (1935)
16. S.B. Feitosa, TurÃ¡nâ€™s Theorem (in Portuguese) (Classnotes, 2006)
17. D.G. de Figueiredo, NÃºmeros Irracionais e Transcendentes (in Portuguese) (SBM, Rio de
Janeiro, 2002)
18. W. Fulton, Algebraic Curves. Freely available at http://www.math.lsa.umich.edu/ wfulton
19. F. Galvin, A proof of Dilworthâ€™s chain decomposition theorem. Am. Math. Monthly 101, 352â€“
353 (1994)
20. C.R. Hadlock, Field Theory and its Classical Problems (Washington, MAA, 2000)
21. P. Halmos, Naive Set Theory (Springer, New York, 1974)
22. N. Hartsï¬eld, G. Ringel, Pearls in Graph Theory (Academic Press, San Diego, 1990)
23. R. Honsberger, Mathematical Gems III (Washington, MAA, 1985)
24. D.A. Klarner, F. GÃ¶bel, Packing boxes with congruent ï¬gures. Indag. Math. 31, 465â€“472
(1969)
25. Y. Kohayakawa, C.G.T. de A. Moreira, TÃ³picos em CombinatÃ³ria ContemporÃ¢nea (in Por-
tuguese) (IMPA, Rio de Janeiro, 2001)
26. A.G. Kurosch, Curso de Algebra Superior (in Spanish) (MIR, Moscow, 1968)
Â© Springer International Publishing AG, part of Springer Nature 2018
A. Caminha Muniz Neto, An Excursion through Elementary Mathematics, Volume III,
Problem Books in Mathematics, https://doi.org/10.1007/978-3-319-77977-5
637

638
Bibliography
27. E. Landau, Elementary Number Theory (AMS, Providence, 1999)
28. S. Lang, Algebra (Springer, New York, 2002)
29. H.N. Lima, Limites e FunÃ§Ãµes AritmÃ©ticas (in Portuguese). Preprint
30. L. Mirsky, A dual of Dilworthâ€™s decomposition theorem. Am. Math. Monthly. 78, 876â€“877
(1971)
31. M. Reid, Undergraduate Algebraic Geometry (Cambridge University Press, Cambridge, 1988)
32. J. Roberts, Elementary Number Theory: a Problem Oriented Approach. (MIT Press, Cam-
bridge, 1977)
33. W. Rudin, Principles of Mathematical Analysis, 3rd edn. (McGraw-Hill, Inc., New York, 1976)
34. E. Scheinerman, Mathematics: A Discrete Introduction, 3rd edn. (Brooks Cole, Boston, 2012)
35. S. Singh, Fermatâ€™s Enigma: The Epic Quest to Solve the Worldâ€™s Greatest Mathematical
Problem (Anchor Books, New York, 1998)
36. E. Stein, R. Shakarchi, Fourier Analysis: An Introduction (Princeton University Press, Prince-
ton, 2003)
37. I. Stewart, D. Tall, Algebraic Number Theory and Fermatâ€™s Last Theorem, 4th edn. (CRC Press,
Boca Raton, 2015)
38. M.B.W. Tent, Prince of Mathematics: Carl Friedrich Gauss (A.K. Peters Ltd, Wellesley, 2006)
39. P. TurÃ¡n, An extremal problem in graph theory. Mat. Fiz. Lapok 41, 435â€“452 (1941)
40. J.H. Van Lint, R.M. Wilson, Combinatorics (Cambridge University Press, Cambridge, 2001)
41. H. Wilf, Generatingfunctionology (Academic, San Diego, 1990)

Index
A
Abel, Niels H., 385
Abundant number, 218
Addition
identity for, 351
of polynomials, 349, 396
of quaternions, 327
Adjacency matrix, 129
Algebra, Fundamental Theorem of, 380
Algebraic form of complex numbers, 319
Algebraic number, degree of an, 500
Algorithm, 116
Dijkstraâ€™s, 150
division, 159
Euclidâ€™s, 173
for polynomials, division, 356
greedy, 147
input data of an, 116
invarian associated to an, 116
iteration of an, 116
of Euclid, 456
of Havel-Hakimi, 131
of Horner-Ruï¬nni, 366, 412
of Kruskal, 147
of walk reduction, 566
output of an, 116
polynomial, 182
Antichain, 113
AP
of order 1, 525
of order m, 525
Argument
of a complex number, 329
of a complex number, principal, 329
Arithmetic
function, 209
multiplicative function, 209
Arrangement
with repetitions, 6
without repetition, 24
Axis
imaginary, 322
real, 322
B
BÃ©zout
Ã‰tienne, 165, 452
theorem of, 165, 452
Ball, 60
center of a, 60
radius of a, 60
Basis, 441
binomial, 442
Bernstein
polynomials, 377, 384
Sergei, 377
Binomial
basis, 442
number, generalized, 75
polynomial, 442
series expansion, 76
BollobÃ¡s
BÃ©la, 53
theorem of, 54, 544
Bolzano
Bernhard, 418
theorem of, 418
Â© Springer International Publishing AG, part of Springer Nature 2018
A. Caminha Muniz Neto, An Excursion through Elementary Mathematics, Volume III,
Problem Books in Mathematics, https://doi.org/10.1007/978-3-319-77977-5
639

640
Index
C
Canonical
decomposition, 185
factorisation, 185
factorisation in Z[X], 461
projection, 462
Cardano, Gerolamo, 379
Cartesian product, 3
Catalan
EugÃ¨ne, 87
number, 87, 90
recurrence of, 87
Cauchy sequence, 512
Cayley
Arthur, 148
theorem of, 148
Center of a ball, 60
CesÃ ro, Ernesto, 233
Chain, 113
length of a, 113
maximum element of a, 113
Characteristic
function, 9
sequence, 9
Chebyshev
Pafnuty, 222, 230
theorem of, 230
Chevalley
Claude, 296
theorem of, 296
Choice, unordered, 25
Christian
Goldbach, 232
Circle, unit, 335
Class
equivalence, 50
of congruence, 269
Clique, 127, 152
number, 152
Closed
disk, 509
set, 509
Coefï¬cient, leading, 352
Combinations, 25
Complement of a subset, 2
Complete
bipartite graph, 133
digraph, 135
residue system, 270
Complex number
algebraic form of, 319
argument of a, 329
conjugate of a, 321
imaginary part of a, 322
modulus of a, 321
polar form of a, 329
principal argument of a, 329
real part of a, 322
roots of a, 332
trigonometric form of a, 329
Complex numbers, 319
addition of, 320
difference, 320
multiplication of, 320
quotient of, 321
sequence of, 326, 336
series of, 512
triangle inequality for, 325, 326
Complex plane, 322
Congruence
as an equivalence relation, 244
class, 269
elementary properties of, 245
linear, 263
relation, 269
relation of, 55
Conjugate
of a complex number, 321
of a quaternion, 328
Connected
component, 137
graph, 136
Constant
polynomial, 348
term, 352
Content of a polynomial, 458
Convergence
disk, 515
of a series, 513
Counting
fundamental principle of, 4
injective functions, 23
recursive, 14
Criterion
of divisibility by 11, 163
of divisibility by 3 and 9, 162
of Eisenstein, 472
of Euler, 298
CRS, 270
Cycle, 140
hamiltonian, 140
in a graph, 140
D
dâ€™Alembert, Jean-Baptiste le Rond, 380
de Bruijn, Nicolaas, 111

Index
641
de Moivre
Abraham, 33, 331
ï¬rst formula of, 331
second formula of, 332
Degree, 352
in, 135
maximum, 151
minimum, 136
of a vertex, 127
of a polynomial, 395
of an algebraic number, 500
out, 135
properties of, 352
del Ferro, Scipioni, 379
Derangement, 36, 91
Derivative
of a polynomial, 387
of a polynomial, kâˆ’th, 390
of polynomials, properties of the, 387
Descartes
RenÃ©, 432
rule of, 432
Descent method of Fermat, 195
Difference
between two sets, 2
of polynomials, 351
symmetric, 108
Digraph, 135
complete, 135, 144
path in a, 144
walk in a, 144
Dijkstra
algorithm of, 150
Edsger, 150
Dilworth
Robert, 111
theorem of, 115, 135
Diophantus of Alexandria, 171
Dirac
Gabriel, 141
theorem of, 141
Dirichlet
Gustav L., 183, 202, 490
lemma of, 202
theorem of, 490
Discrete optimization, 121
Disk
closed, 509
convergence, 515
open, 509
Divisibility
by 11, criterion of, 163
by 3 and 9, criteria of, 162
by 9, criterion of, 246
elementary properties of, 158
relation, 112
relation of, 157
Division
algorithm, 159
quotient of a, 160
remainder of a, 160
Division algorithm
quotient in the, 357
remainder in the, 357
Divisor
common, 165, 451
dof an integer, 157
greatest common, 165, 451
positive, 157
E
Edge
cutting, 143
excision of an, 130
of a graph, 126
orientation of an, 135
Eisenstein
criterion, 472
Ferdinand, 306, 472
Element
maximal, 115
Element of a chain, maximum, 113
Equation
diophantine, 171
diophantine linear, 172
of Fermat, 197
of Pell, 201
of Pythagoras, 193
Equivalence
class, 50
relation, 50
relation induced by a function, 50
Eratosthenes
of Cyrene, 181
sieve of, 181
theorem of, 181
ErdÃ¶s, Paul, 58, 99, 111
Euclid
algorithm of, 173, 456
lemma of, 180
theorem of, 182
Euler
criterion of, 298
function Ï• of, 215
identity of, 312
Leonhard, 11, 104, 127

642
Index
Euler (cont.)
theorem of, 104, 127, 138, 200, 215, 218,
225, 256, 275, 314
Event, 233
F
Factorisation
canonical, 185, 456
in Z[X], canonical, 461
Factorised form, 495
Family, 8
Fermat
descent method of, 195
equation of, 197
last theorem for polynomials, 457
last theorem of, 197
little theorem of, 57, 254
number of, 164
Pierre S. de, 57, 164
Pierre Simon de, 193
primes, 190
theorem of, 311, 312
Ferrari, Lodovico, 384
Fibonacci, 16
problem, 16
sequence, 16, 69, 178
sequence of, 252
sequence, extended, 301, 309
Field, 280, 493
algebraically closed, 495
Finite differences
of functions, 445
of polynomials, 447
Finite set, 1
number of elements of a, 1
Fontana, NiccolÃ², 379
Formula
for binomial expansion, 28
for Ï•(n), 216
MÃ¶bius inversion, 213, 498
multisection, 353
of de Moivre, ï¬rst, 331
of Legendre, 188
of multinomial expansion, 28
of Taylor, 392
second de Moivreâ€™, 332
Fractionary part, 178, 202, 550
Frey, Gerhard, 197
FTA, 184, 380
Function
arithmetic, 209
arithmetic multiplicative, 209
characteristic, 9
choice, 52
continuous, 514
Eulerâ€™s Ï•, 215
exponential generating, 91
formula for the Euler, 216
multiplicativity of Eulerâ€™s, 215
of MÃ¶bius, 212
polynomial, 363, 464
projection, 51
surjective, 38, 92
Functions
counting injective, 23
ï¬nite differences of, 445
Fundamental Theorem
of Algebra, 380
of Arithmetic, 184
on Symmetric Polynomials, 409
G
Gallai, Tibor, 111
Galois, Ã‰variste, 385
Gauss
Johann C. F., 302, 380
lemma, 302
lemma of, 458
Quadratic Reciprocity Law of, 306
theorem of, 380, 394
Generating function
complex, 517
ordinary, 67
Geometric series, 68
Girard, Albert, 399
Girard-ViÃ¨te formulas, 399
Goldbach
conjecture, 232
Graph, 126
râˆ’regular, 133
acyclic, 145
bipartite, 133, 140
complement of a, 132
complete, 127
complete bipartite, 133
connected, 136
connected components of a, 137
cycle in a, 140
directed, 135
disconnected, 136
edges of a, 126
eulerian, 137
hamiltonian, 140, 144
labelled, 130
of Petersen, 133, 144
path in a, 139

Index
643
self-complementary, 132
simple, 126
subgraph of a, 130
trivial, 127
TurÃ¡n, 153
unlabelled, 130
vertices of a, 126
weighted, 146
Graphs, isomorphic, 128
Greatest common divisor, 165
for polynomials, 453
H
Hadamard
Jacques, 221
theorem of, 221
Hakimi, Seifollah L., 131
Hamilton
quaternions of, 327
William R., 140, 327
Hamming
metric of, 61
Richard, 61
Havel, Vaclav J., 131
Hermite, Charles, 503
Homothety, 338
center of a, 338
ratio of a, 338
Horner-Rufï¬ni
algorithm of, 412
identities of, 412
Horner-Ruï¬nni algorithm, 366
I
Identities
of Horner-Rufï¬ni, 412
of Jacobi, 413, 415
Identity
for addition, 351
for multiplication, 352
of Euler, 312
of Lagrange, 43
of Vandermonde, 48, 355
Imaginary
axis, 322
number, pure, 322
part, 322
In degree, 135
Inclusion-exclusion
for two sets, 3
principle, 33
Indeterminate, 363
Induced order, 112
Inequalities
of McLaurin, 427
of Newton, 425
Inequality
for complex numbers, triangle, 325, 326
triangle, 59
Integer
closest, 164
closest to x, 79
divisor of an, 157
even, 157
multiple of an, 157
odd, 157
square free, 190
Integer part, 41, 97, 159
Integers
congruent, 243
pairwise coprime, 165
relatively prime, 165
Invariant, 116
Inverse
modulo n, 263
multiplicative, 279
Irreducible fraction, 167
J
Jacobi
Carl G. J., 413
identities of, 413, 415
K
KÃ¶nig
DÃ©nes, 134
theorem of, 134
Kaplansky
ï¬rst lemma of, 20, 26, 29
Irving, 26, 41
second lemma of, 29
Ko, Chao, 58
Kronecker
delta of, 435
Leopold, 435
Kruskal
algorithm of, 147
Joseph, 147
L
Lagrange
identity of, 43
interpolating polynomials, 436

644
Index
Lagrange (cont.)
interpolating theorem, 436
Joseph L., 43, 314
Joseph Louis, 369
mean value theorem of, 420
theorem of, 314, 369
LamÃ©
Gabriel, 180
theorem of, 180
LCM, 176
Leading coefï¬cient, 352
Leaf, 145
Least common multiple, 176
Legendre
Adrien-Marie, 188, 300
formula of, 188
symbol of, 300
Lemma
Euclidâ€™s, 180
of Dirichlet, 202
of Gauss, 302, 458
of Kaplansky, ï¬rst, 20, 26, 29
of Kaplansky, second, 29
of Sperner, 49
sign preserving, 423
Leonardo de Pisa
see Fibonacci, 16
Liber Abaci, 16
Limit of a convergent sequence, 510
Lindemann, Ferdinand, 503
Linear
combination, 166
congruence, 263
congruence, root of a, 263
recurrence relation, 505
recurrence relation, order of a, 505
recurrent sequence, 505
system, Vandermonde, 439
Liouville
Joseph, 219, 500
theorem of, 219, 500
Lucas
Ã‰douard, 41, 469
problem, 41
sequence of, 252
sequence, extended, 301, 309
theorem of, 469
M
MÃ¶bius
function of, 212
inversion formula, 213, 498
Matching, 134
maximal, 134
Matrix, adjacency, 129
Maximal
element, 115
matching, 134
McLaurin
Colin, 427
inequalities, 427
Metric
Hamming, 61
in a set, 59
of symmetric difference, 63
Mirsky
Leon, 111
theorem of, 113
Modulus of a complex number, 321
Monic polynomial, 352
Multiple
least common, 176
of an integer, 157
Multiplication
identity for, 352
of polynomials, 349, 396
of quaternions, 327
Multiset, 30, 373
N
Newton
binomial theorem of, 76
inequalities of, 425
Isaac, 76, 409
theorem of, 409
Node, 145
Norm of a quaternion, 328
Number
abundant, 218
algebraic, 477
chromatic, 151
clique, 152
complex, 319
composite, 180
independence, 155
of Catalan, 87, 90
of Fermat, 164
of second kind, Stirling, 20,
29
perfect, 218
prime, 57, 180
pure imaginary, 322
transcendental, 477

Index
645
O
Open
disk, 509
set, 509
Order
lexicographic, 9, 409
modulo n, 284
of a linear recurrence relation, 505
Ordered pair, 7
Out degree, 135
P
PÃ³lya, George, 476
PÃ³lya-SzegÃ¶, theorem of, 476
Pairwise coprime integers, 165
Part, fractionary, 202, 550
Partition
induced by a function, 27
of a natural number, 11
of a set, ordered, 7
Path, 139
in a digraph, 144
Pell
equation of, 201
John, 201
Perfect
cube, 164
number, 218
square, 160
Permutation, 24
circular, 53
even, 406
with repeated elements, 27
Petersen
graph, 133, 144
Polar form, 329
Polynomial
kâˆ’th derivative of a, 390
over Zp, 462
binomial, 442
characteristic, 505
constant, 348
content of a, 458
cyclotomic, 487
degree of a, 352, 395
derivative of a, 387
elementary symmetric, 399
factorised form of a, 382, 383
function, 363, 464
homogeneous, 406
identically zero, 348
in n indeterminates, 395
irreducible, 454, 458
leading coefï¬cient of a, 352
monic, 352
primitive, 458
reciprocal, 386
reducible, 454, 458
root of a, 364
symmetric, 399
symmetrization of a, 407
variation of a, 429
Polynomials
addition of, 349, 396
associated, 451
Bernstein, 377, 384
difference of, 351
division algorithm for, 356
equal, 348
equality of, 397
ï¬nite differences of, 447
Fundamental Theorem on Symmetric, 409
Lagrange interpolating, 436
multiplication of, 349, 396
properties of the derivative of, 387
relatively prime, 453
Power series, 71
convergence of a, 71
differentiation of a, 72
product of two, 72
Power set, 8
Prime
number, 57, 180
number theorem, 221
relatively, 165
Primitive root modulo n, 287
Principle
additive, 2
bijective, 2
Dirichletâ€™s, 95
multiplicative, 4
of counting, fundamental, 4
of inclusion-exclusion, 3, 33
pigeonholeâ€™s, 95
Probability, 233
distribution, 233
Problem of Fibonacci, 16
Projection over Zp[X], 462
Pythagoras
equation of, 193
of Samos, 195
Pythagorean triple, 194
Q
Quadratic
nonresidue modulo n, 297

646
Index
Quadratic (cont.)
Reciprocity Law of, 306
residue modulo n, 297
Quaternion
conjugate of a, 328
norm of a, 328
Quaternions, 327
addition of, 327
multiplication of, 327
Quocient
in the division algorithm, 357
Quotient, 160
R
RÃ´lle
Michel, 421
theorem ofe, 421
Radius of a ball, 60
Rado, Richard, 58
Real
axis, 322
part of a complex number, 322
Recurrence relation, 14
linear, 505
of Catalan, 87
order of a linear, 505
second order linear, 74
Reï¬‚exive relation, 50
Relation, 49
congruence, 269
divisibility, 112
equivalence, 50
inclusion, 112
induced by a function, equivalence, 50
of congruence, 55
of divisibility, 157
of Stifel, 25
partial order, 112, 327
recurrence, 14
reï¬‚exive, 50
symmetric, 50
total order, 112, 327
transitive, 50
Remainder, 160
in the division algorithm, 357
Representation
in base a, 163
Representation, binary, 10
Residue
modulo n, quadratic, 297
modulo p, nâˆ’th, 310
Root
multiple, 368
multiplicity of a, 368
of a complex number, nâˆ’th, 332
of a linear congruence, 263
of a polynomial, 364
of unity, nâˆ’th, 335
simple, 368
test, 364
Roots, elementary symmetric sum of the, 400
Rotation, 338
angle of a, 338
center of a, 338
S
Sampling space, 233
Sequence
Cauchy, 512
characteristic, 9
convergent, 510
divergent, 519
extended Fibonacci, 301, 309
extended Lucas, 301, 309
Fibonacci, 69, 178, 252
limit of a convergent, 510
linear recurrent, 505
Lucas, 252
of complex numbers, 326, 336
of Fibonacci, 16
subsequence of a, 510
Series
absolutely convergent, 513
convergence of a, 513
expansion, binomial, 76
geometric, 68
of complex numbers, 512
partial sum of a, 512
power, 515
sum of a, 513
Set
characteristic function of a, 9
characteristic sequence of a, 9
closed, 509
ï¬nite, 1
independent, 150
number of elements of a ï¬nite, 1
of vertices, independent, 133
open, 509
ordered partition of a, 7
partially ordered, 112
power, 8
quotient, 51
totally ordered, 112
Sets
difference between two, 2

Index
647
disjoint, 2
incomparable with respect to inclusion, 53
Shimura, Goro, 197
Space, sampling, 233
Sperner
Emanuel, 49, 57
lemma of, 49
theorem of, 57
Stifelâ€™s relation, 25
Stirling
James, 20
number of second kind, 20
Subï¬eld of C, 483
Subgraph
induced, 132
of a graph, 130
spanning, 130
Subsequence, 510
Subset, complement of a, 2
Sum of positive divisors, 211
Sylvester, James, 111
Symmetric
difference, 62
difference, metric of, 63
polynomial, 399
polynomial, elementary, 399
relation, 50
sums, elementary symmetric sums of the
roots, 400
System
complete residue, 270
intersecting, 13, 58
of distinct representatives, 51
reduced residue, 274
SzegÃ¶, GÃ¡bor, 476
Szekeres, Esther, 99
T
Taniyama, Yutaka, 197
Tartaglia, 379
Taylor
Brook, 392
formula, 392
Richard, 197
Theorem
chinese remainder, 265
Euler, 256
Fermat little, 254
Lagrange interpolating, 436
Liouvilleâ€™s, 219
Newtonâ€™s binomial, 76
of Algebra, Fundamental, 380
of Arithmetic, Fundamental, 184
of BÃ©zout, 165, 452
of BollobÃ¡s, 54, 544
of Bolzano, 418
of Cayley, 148
of Chebyshev, 230
of Chevalley, 296
of Dilworth, 115, 135
of Dirac, 141
of Dirichlet, 490
of Eratosthenes, 181
of ErdÃ¶s-Ko-Rado, 58
of ErdÃ¶s-Szekeres, 99, 114
of Euclid, 182
of Euler, 104, 127, 138, 200, 215, 218, 225,
275, 314
of Fermat, 311, 312
of Fermat for polynomials, last, 457
of Fermat, last, 197
of Fermat, little, 57
of Gauss, 380, 394
of Hadamard, 221
of Jacobi, 413
of KÃ¶nig, 134
of Lagrange, 314, 369
of Lagrange, mean value, 420
of LamÃ©, 180
of Lucas, 469
of Mirsky, 113
of Newton, 409
of PÃ³lya-SzegÃ¶, 476
of RÃ´lle, 421
of RouchÃ©, 474
of Sophie Germain, 261
of Sylvester-Gallai, 111
of TurÃ¡n, 153
of Weierstrass, 518
of Wilson, 264, 295
on Symmetric Polynomials, Fundamental,
409
partial fractions decomposition, 457
Prime Number, 221
Tournament, 135, 144
Tower of Hanoi game, 20
Transitive relation, 50
Transposition, 406
Tree, 145
leaf of a, 145
minimal spanning, 147
node of a, 145
spanning, 147
Triangle inequality, 325
Trigonometric form, 329

648
Index
TurÃ¡n
Paul, 153
theorem of, 153
U
Unit
circle, 335
imaginary, 319
in Zn, 279
Unordered choices, 25
V
Vandermonde
Alexandre-TheÃ³phile, 48, 355,
439
linear system of, 439
Variation of a polynomial, 429
Vertex
cover, 134
cover, minimal, 134
degree of a, 127
excision of a, 130
of a graph, 126
Vertices
adjacent, 126
independent set of, 133
neighbor, 126
non adjacent, 126
ViÃ¨te, FranÃ§ois, 399
W
Walk, 136
closed, 136
eulerian, 137
in a digraph, 144
length of a, 136
semi-eulerian, 143
Weierstrass
Karl, 518
theorem of, 518
Weight
of a graph, 146
of an edge, 146
Wiles, Andrew, 197
Wilson
John, 264
theorem of, 264, 295

