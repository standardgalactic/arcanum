

A Gateway to
MODERN
MATHEMATICS
Adventures in Iteration I
For our entire range of books please use search strings "Orient BlackSwan",
"Universities Press India" and "Permanent Black" in store.

Ramanujan Mathematical Society
Little Mathematical Treasures
Editorial Policy
In times past, mathematics was studied and researched by a select few—an
elite class who valued the subject for its intellectual elegance and perhaps also
for its philosophic connotations. But today it is studied and practised by an
extremely large number of individuals, for mathematics has acquired a pivotal
role in the sustenance of a technologically advanced society.
Broadly speaking, there are two distinct groups of students to whom
expository material in mathematics may be addressed:
a. students who have a deep interest in mathematics and wish to pursue a
career involving research and teaching of mathematics;
b. students who are good at mathematics but wish to pursue a career in
some other discipline.
Clearly such students require suitable material (in addition to contact with
inspiring teachers and practising mathematicians) to nurture their talent in
the subject.
To this list we may add professionals in industry and government and
teachers in mathematics and other disciplines who require a good
understanding of certain areas of mathematics for their professional work.
The proposed series is addressed to mathematically mature readers and to
bright students in their last two years of school education. It is envisaged that
the books will contain expository material not generally included in standard
school or college texts. New developments in mathematics will be presented
attractively using mathematical tools familiar at the high school and
undergraduate levels. There will be problem sets scattered through the texts
which will serve to draw the reader into a closer hands-on study of the

subject. Readers will be invited to grapple with the subject, and so experience
the creative joy of discovery and contact with beauty.
A thing of beauty is a joy forever So it is with mathematics. The discoveries of
Archimedes, Apollonius and Diophantus have been sources of joy from very
ancient times. It is our hope that these books will serve our readers in a
similar manner.
Proposals for publication of a book in the series is invited with a draft of the
proposed book. The decision of the Editorial Board will be final.


Universities Press (India) Private Limited
Registered Office
3-6-747/1/A & 3-6-754/1, Himayatnagar, Hyderabad 500 029 (A.P.), INDIA
e-mail: info@universitiespress.com
Distributed by
Orient Blackswan Private Limited
Registered Office
3-6-752 Himayatnagar, Hyderabad 500 029 (A.P.), INDIA
e-mail: info@orientblackswan.com
Other Offices
Bangalore, Bhopal, Bhubaneshwar, Chennai,
Ernakulam, Guwahati, Hyderabad, Jaipur, Kolkata,
Lucknow, Mumbai, New Delhi, Noida, Patna
© Universities Press (India) Private Limited 2009
First published 2009
Reprinted 2010
eISBN 978-81-7371-960-8
e-edition:First Published 2015
ePUB Conversion: Techastra Solutions Pvt. Ltd.

All rights reserved. No part of this publication may be reproduced,
distributed, or transmitted in any form or by any means, including
photocopying, recording, or other electronic or mechanical methods, without
the prior written permission of the publisher, except in the case of brief
quotations embodied in critical reviews and certain other noncommercial
uses permitted by copyright law. For permission requests write to the
publisher.

Cover
Half Title
Title Page
Copyright
Contents
Preface
1 What are Iterations?
1.1 A card trick
1.2 The riffle shuffle
1.3 Feedback
2 Terms and Symbols
3 Examples of Iterations
3.1 The GCD algorithm
3.2 Squares
3.3 Square roots
4 The Four-Numbers Game
4.1 The iteration
4.2 Exercises
4.3 Concluding remarks
5 Sums of Squares
5.1 The iteration
Contents

5.2 Exercises
5.3 Further comments
6 Fixed Points and Cycles
6.1 Fixed points
6.2 Cycles
7 The Kaprekar Constant
7.1 The Kaprekar iteration
7.2 Exercises
7.3 Concluding remarks
7.4 Recent results
7.5 Biographical details
8 Self-Born Numbers
8.1 The iteration
8.2 Exercises
8.3 Self-born numbers
8.4 Junction numbers
9 Self Referential Numbers
9.1 The iteration
9.2 Exercises
10 Cyclical Functions
10.1 Iterations on functions
10.2 Constructing cyclical functions
10.3 Fractional iterates
10.4 Iterated square root of the negative identity function
10.5 Exercises

11 A Miscellany-I
11.1 Appetizers
11.2 The Collatz iteration
11.3 A two-digit iteration
11.4 Amicable numbers
11.5 The Fibonacci sequence
11.6 A route to square roots
11.7 More on square roots
11.8 Cube roots
12 A Miscellany-II
12.1 SP numbers
12.2 The SSQ iteration revisited
12.3 Averages
13 Geometric Iterations
13.1 Introduction
13.2 Perpendiculars
13.3 Angle bisectors
13.4 Medians
13.5 Pedal triangles
13.6 Altitudes
13.7 Pretty pictures
13.7.1 Nested Squares
13.7.2 Nested Triangles
13.8 Fractals
13.9 Map-in-a-map

13.10 Appendix—analysis of the medians-iteration
14 Techniques of Proof
14.1 The SSQ iteration
14.2 The SCB and SFT iterations
14.3 The four-numbers iteration
15 Solving Equations
15.1 An iterative approach
15.2 It looks much too arbitrary!
16 Cobwebbing
16.1 Various examples
16.2 Dependence on slope
16.3 The case when slope equals ± 1
16.4 The iteration x → 1 – 3x2 / 4
16.5 Two more case studies
16.6 Concluding remarks
17 Memorable Problems from the IMOs
17.1 Problem IMO 1986/2
17.2 Problem IMO 1987/4
17.3 Problem IMO 1988/6
17.4 Descendants of IMO 1988/6
17.5 Exercises
18 Miscellaneous Problems
A Further Reading
B Solutions

Preface
This book is about iterative processes, i.e., processes that are done repetitively
(“reiterated”); such processes often result in sequences which are rich in
patterns, making them ideal for investigation. It is written for the student who
loves to tinker around with numbers and equations, and with mathematical
ideas in general; tinker around just as a child, does when he or she wanders
into a wooded region and begins to explore the many marvels and mysteries
that are to be found in undisturbed places.
The world of mathematics too is full of wonders but, sadly, many children
never see them at all, or even suspect that they exist. The fact that
mathematics is a living science and that one can make discoveries and
actually contribute to the growth of the subject is hardly ever pointed out at
the school level. And yet, the actual fact is that mathematics is alive, and not
merely a collection of formulas and theorems dating from Greek and Vedic
times. New discoveries are constantly being made in the subject every year;
new areas of research develop constantly. Problems dating from many
centuries get solved; alongside this, new questions get asked, new problems
posed. The culture of the subject is such that mathematicians can speak to
one another across barriers of space and time—not just decades, but centuries
—with ease and familiarity, with no fear of not being understood. To give just
a few instances: in the last decade of the twentieth century, the Princeton
mathematician Andrew Wiles dramatically laid to rest a question that had
been lying unresolved (not for want of trying!) for more than three hundred
years—the famous Fermat conjecture:
No cube can be written as the sum of two smaller cubes, no fourth
power can be written as the sum of two smaller fourth powers, and so
on for all higher powers.
In the last decade of the eighteenth century, Karl F.Gauss (1779–1855),
regarded as one of the greatest mathematicians of all time, alongside
Archimedes (3rd century BC) and Isaac Newton (1642–1722), then but a

teenager, announced a solution to a question that had been asked more than
two thousand years earlier by the Greeks, concerning the possibility of a
ruler-and-compass construction of a regular polygon with a specified number
of sides. (Gauss answered the question completely: he gave a criterion for
finding the numbers n for which a regular n-sided polygon is constructive.)
The famous four-colour theorem, which states that every map can be
properly coloured using no more than four colours was first conjectured in
the 1860s (by a lawyer!) and finally proved in 1976, by Kenneth Appel and
Wolfgang Haken: a culmination of more than a century of effort by many
generations of mathematicians. The notebooks of the enigmatic mathematical
genius from India, Srinivasa Ramanujan (1887–1920), are filled with
tantalizing statements that continue to hold deep interest today for a large
number of working mathematicians.
Mathematics is, like the air, free for the taking. Just as no one owns a sunset
—it is there for everyone to see—so it is with mathematics: it is there for the
enjoyment of all. Can this feeling be experienced by those who come into
contact with the subject? This is the essential spirit embodied in this book.
********************************
This book is the first of a two-volume work on the subject of iterations. It is
set at an elementary level, and the background knowledge required is
modest,: an understanding of elementary algebra, arithmetic and geometry
(briefly, the topics covered in most schools in grades 8–10), and an ease in
dealing with numbers. Readers may need to refresh their memory of the
technique used for computing the greatest common divisor (“GCD”) of two
given integers. The focus in general is on the discovery of patterns rather than
on proofs and derivations. (Those who progress from Volume I to Volume II
will find that it is set at a higher level, with formal proof receiving its due
place, and substantial usage being made of calculus and complex numbers.)
The book will be found useful by students who are preparing for the
Regional Mathematics Olympaid (RMO) and the Indian National
Mathematics Olympiad (INMO). It is suitable for self-study by students in
the age range 13–18 years, and by lay readers, who will enjoy learning about a
topic of great current interest. It can also be used by teachers in a school
mathematics club.

The book presupposes a certain degree of mathematical maturity on the
part of the reader—an elusive quality that means, roughly, the ability to grasp
mathematical concepts and to think mathematically. It is the earnest and
committed belief of this author that working through this book will itself
greatly enhance the young learner’s mathematical maturity.
Many of the exercises involve computation, and it would help greatly if the
student had access to a computer. Many students today are familiar with
programming in PASCAL, C+ + and BASIC (probably the easiest language to
learn and use, though it has been criticized for encouraging poor
programming style!). Writing programs to solve the exercises should prove a
simple task. (Indeed, many of the exercises provide excellent practice material
for the writing of programs.)
Above all, the book is about having fun with figures. Enjoy yourself!
Preview of book
Iterations are introduced in an informal manner in Chapter 1, and this is
followed in Chapter 2 by a list of all technical terms used in the book. Chapter
3 presents some illustrative examples. Chapters 4-12 offer numerous
iterations from arithmetic and algebra, such as the well known four-numbers
iteration, the Kaprekar iteration, and so on. In Chapter 13, the focus shifts to
Euclidean geometry, Chapter 14 discusses techniques of proof in the context
of iterations, and Chapter 15 presents a possible path along which iterations
present themselves very naturally (in the context of solution of equations). In
Chapter 16, the material is placed in a graphical framework (“cobwebbing”),
and this sheds light on some empirical discoveries made earlier. Chapters 17
and 18 contain problems which the reader is invited to tackle.
Appendix A gives a short reading list, and Appendix B gives complete
solutions to all the problems in the book.
Acknowledgements
Grateful acknowledgements of thanks are due, for the assistance that I
received from numerous individuals: to Professor Phoolan Prasad, Dr. Jayant
Kirtane and Mr. Siddhartha Menon, for going through early versions of the

book and offering helpful and critical comments; to Mr. and Mrs. Mohan
Subramaniam, for their help, generously given, in procuring the LATEX
Software; to Mr. K Seshadri, for technical help with the computer systems; to
Professor E Sampathkumar for his enthusiastic support in publishing this
book; to my friends in the “Olympiad cell,” C R Pranesachar (“CRP”), B J
Venkatachala (“BJV”) and C S Yogananda (“CSY”), with whom I have had
numerous iterated adventures; and to Padmapriya, my wife, for her iterated
support.
Dedication
I dedicate this book to my ε, Karunya, to her Ma Padmapriya, and to my
parents, Ashok and Lata Shirali.

Chapter 1
What Are Iterations?
1.1   A card trick
From a card pack remove any twenty-one cards. Ask a friend to mentally
select any one of these cards. Announce to your friend that you plan to find
out the selected card.
Call the selected card ‘X’ for short. Place the cards, face up, in an array
measuring 7 × 3, in the order shown by the numbers below (the cards are laid
out in the array row by row; the column numbers have been shown in the top
row):
Ask your friend to tell you the column in which X lies. Next, gather up the
cards, column by column, so that the column containing X is the second one
to be picked up. For instance, if X were at position number 7, your friend
would say ‘column I'. You would then pick up the columns in the order
(II,I,III) or (III, I,II) .
Now repeat the whole process: lay out the cards, row-wise, in the order
indicated above: row number 1, then row number 2, …, till row number 7.
Once again ask your friend to tell you the column containing X, then pick up
the cards column by column just as you did earlier.

Lay out the cards for a third time, do the gathering up yet again, and then
lay out the cards once more (row-wise)—this would be the fourth time you
are doing so. And now—here is the surprise!—you will find that X is in
position number 11. There is no uncertainty about it; it will always end up in
that position. Now all you have to do is say “Abracadabra” or something like
that, and produce the card!
This is a neat card trick to play, and you may enjoy figuring out how it
works. Unlike most such tricks, no sleight of hand is involved: palming the
cards, hiding them up your sleeve, and so on. Other than putting on a
“magician’s voice”, very little skill is needed to perform the trick.
If you enjoy experimentation, you may want to investigate what role the
pair of numbers 3 and 7 play in this trick. What if we used, instead, the
numbers 5 and 7? Or 5 and 6? Or 4 and 5? Or 3 and 4? In what way does the
result change if we alter the numbers?—and does the trick work at all?
Observe that what you are doing as you perform this trick is to repeat a
certain process several times: you start with some arrangement of cards, “do”
something to it, do it again, and so on. After four such cycles, the card ends
up in some fixed position. The ‘answer’ comes out the same, no matter how
you started out.
We plan now to do a study of such processes, in which some fixed action is
repeated several times over. Such processes are known as ITERATIONS. If you
look up a dictionary, you will find that the word reiterate means ‘to repeat
something over again’. That is exactly what we are doing here.
1.2   The riffle shuffle
Here is another illustration of an iteration that uses a card pack; it is based on
a technique of shuffling known as the riffle shuffle. The purpose of any shuffle,
clearly, is to mix up the cards thoroughly. In a riffle shuffle, well known to
professional card players, the shuffler divides the card pack into two halves,
holds one half in each hand, then ‘drops’ the cards alternately, one at a time,
from the bottoms of the two packs; one card from the left hand, then one
from the right hand, then again one of the left hand, and so on, till the last
card. Professionals can execute the shuffle at bewildering speed, making for a
very attractive effect.

To illustrate its action, assume that the card pack has ten cards, numbered
1, 2, 3, …, 10, and arranged in this order (reading from top to bottom). A
riffle shuffle would place them in the following order:
l, 6, 2, 7, 3, 8, 4, 9, 5, 10.
To see why, it helps to write the numbers 1, 2, 3, …, 10 in the following
manner:
If we follow this with a second riffle shuffle, we obtain the following
arrangement:
1, 8, 6, 4, 2, 9, 7, 5, 3, 10,
and a third shuffle produces:
1, 9, 8, 7, 6, 5, 4, 3, 2, 10.
The shuffles can be continued, and something curious happens if we do so.
Perhaps you could do the shuffles on your own and find out what happens.
Magicians are familiar with such curiosities and sometimes base their card
tricks on them.
1.3   Feedback
An ‘iteration’ in mathematics refers to a process that is done over and over
again; each time the process is done, the ‘output’ or result is fed back to the
starting point. This ‘feeding back’ is the crucial part, and every iteration has
this ingredient in it. A good visual image is provided by the laboratory
process of purification by distillation: the distilled liquid is put through the
distillation process again and again so as to increase or decrease the
concentration of some particular component.
Here is a more familiar example, involving sound. You must have heard, at

some time or the other, the painful howl of the sound system during a music
performance. What happens is that sound from the speakers is picked up
('heard') by the microphone, magnified by the amplifier, emitted again from
the speakers, picked up yet again by the microphone, …. This cycle happens
repeatedly, and the result is the howl.

Chapter 2
Terms and Symbols
As you read through this book, you will encounter many new terms and
symbols. A list of such words has been given below, along with their
meanings. Please look up the list whenever you come across an unfamiliar
word.
Function     A function is essentially a machine that converts an input (that
which goes ‘into’ the machine) into an output (that which comes ‘out’ of the
machine). The following sketch conveys the idea pictorially:
INPUT → FUNCTION  → OUTPUT.
In the most familiar examples, the input and output are both numbers. In the
microphone example mentioned above, the input and output are both
sounds.
We often use symbols such as f,g,h,… to denote functions. To denote the
output of a function f from an input of x we use the symbol f(x). We depict
this visually as follows:
The symbol ‘ f(x)’ is pronounced ‘ f of x′.
Example 1.    The function f that squares whatever input it receives is written
symbolically as f(x) = x2; so f(5) = 25,f(7) = 49,…. Visually we may write:
Another symbolic form that we shall often use is : f : x↦x2; here the symbol

‘↦’ (pronounced “maps to”) indicates that f “maps” x to x2.
Domain of a function     The set of allowable values that can be taken by the
input is the domain of the function.  The domain of a function f is typically
denoted by the symbol domain (f), or simply by dom (f).
The domain can be any arbitrary set; the only requirement is that the
function should be able to act meaningfully on every element in the set.
Example 2.    Consider the reciprocal function R(x) which takes x to 1∕x. (This
is written as: R(x) = 1∕x, or as R : x↦1∕x. ) Here we exclude 0 from the domain
of R, because 1/0 is not defined.
Example 3.    Consider the function which takes x to log2x. Here we exclude
from the domain all numbers less than or equal to 0, because log2x is not
defined for x ≤ 0. (The base could be 10 instead of 2, or for that matter any
positive number not equal to 1.)
Range of a Function    The set of all possible output values that can
produced by the function, when the input takes every possible value in the
domain, is the range of the function.
Example 4.    For positive integers n, let f(n) denote the units digit of n2, e.g.,
f(12) = 4, since 122 = 144. (All references are to base-10.) The domain of f is
the set of positive integers N, and the range is the set
{0,1,4,5,6,9}.
Example 5.    For positive integers n, let g(n) denote the units digit of 3n,e. g .,
g(6) = 9 , since 36 = 729. The domain of g is N, as earlier, and the range is the
set
{1, 3, 7, 9}.
Example 6.    Consider the function R(x) given by R(x) = 1∕x. Let domain (f)
be the set of real numbers between 1 and 2; the usual notation for this set is
[1, 2]. Then the range is the set of real number between 1/2 and 1, denoted by
|1∕2,1 ] .
Iteration, Iterative Process Any action which is performed repeatedly will

be referred to as an iteration. The action itself is called the iterative step. The
specific rule used to do the iteration is the iterative function. (Later we shall
suppress the word ‘iterative’ and simply say ‘function’.)
Sometimes the action is also referred to as a “mapping” or a
“transformation”.
input     That which goes “into” each iterative step is called the input. (If
↦f(x), then x is the input)
output     That which comes “out” of each iterative step is called the output.
(If x↦f(x), then f(x) is the output.)
Example 7.    For the riffle shuffle example presented earlier, the iterative
function is the riffle shuffle itself, and for the input
(1, 6, 2, 7, 3, 8, 4, 9, 5, 10),
the output is
(1, 8, 6, 4, 2, 9, 7, 5, 3, 10).
Example 8.    Suppose the iterative step is: add 2 to the input. The function is
in this case described symbolically by:
f(x) = x + 2.
Here an input of 4 produces an output of 6, an input of 10 produces an
output of 12, and so on.
Seed Value  The input value with which we start the iteration is the seed of
the iteration.
Iterative Sequence, Orbit     The sequence which is generated by an iterative
function together with a seed is an iteration sequence. Other words used to
describe an iterative sequence are orbit and trajectory.
Example 9.    For the iterative function f(x) = x + 2, the iterative sequence
produced by the seed x = 5 is
5, 7, 9, 11, 13, 15, 17, 19, 21, 23, ....

Example 10.    For the function f(x) = x3, the iterative sequence produced by
the seed value x = 3 is
3,   27,   19683,   7625597484987,
443426488243037769948249630619149892803, ….
(Here 33 = 27,273 = 19683, 196833 =7625597484987, and so on.)
Example 11.    For the function f(x) = 1 - x, the orbit of the seed x = 0 is
0,1,0,1,0,1,0,1,….
Notation for Sequences, Orbits  Sequences are often placed within angular
brackets (‘〈’ and ‘〉’ ). For example, we write:
〈5,7,9,11,13,15,17,19,…〉.
The orbit of the seed number x produced by the function f is usually shown
in the following manner:
〈x,f(x),f(f(x)),f(f(f(x))),…〉,
the dots indicating that there are infinitely more entries to come. A
convenient short-form for this that we use repeatedly is:
〈x;f〉.
Example 12.    For the iterative function f(x) = 3x(1 - x) and the seed x = 0.5,
the orbit 〈x;f〉 is ,
〈 0.5,   0.75,   0.5625,   0.7383, … 〉.
GCD     The GCD, or greatest common divisor, of two given integers is
defined to be the largest integer that divides the two integers,
Example 13.    gcd(10,24) = 2, and gcd(28,42) = 14.
Algorithm    An action or series of actions that is performed on an input
with a specific aim in mind (i.e., with the intention of producing a desired
output) is called an algorithm.
Example 14.    The long-division square-root algorithm and the Euclidean
GCD algorithm (to be discussed in Chapter 2) are both examples of

algorithms.
Symbol for Absolute Value    The absolute value of a number x is written as
|x| and is defined as follows: |x| = x if x ≥ 0, and |x| = -x if x < 0.
Example 15.    |- 3| = |3| = 3, and |- 7| = |7| = 7.
Limit of a Sequence    A sequence of numbers
〈a1,a2,a3,...,an,…〉
is said to have a limit L if, given any positive number h, however small, from
some point onwards all members of the sequence lie between L - h and L + h.
That is, from some point onwards, all the members of the sequence lie at a
distance of no more than from L. When this happens, the sequence is said to
converge to L.
Example 16.    The sequence of reciprocals of the positive integers,
1, 1 2, 1 3, 1 4, 1 5,…
converges to 0, and the sequence composed entirely of 1's,
1, 1, 1, 1, 1, 1, ...,
converges to 1.
Some examples of limits of iteration sequences are given below.
Example 17.    For the function f(x) = x2 and the seed value x = 0.2, the
iteration sequence 〈x;f〉 is
〈 0.2,    0.04,    0.0016,    0.00000256, … 〉,
and the sequence visibly converges to 0. Note however that the sequence
never quite reaches the limiting value.
Example 18.    For the function f(x) = 1 + x∕2 and the seed value x = 1, the
iteration sequence is
1,3 2,7 4,15 8 ,31 16, 63 32,127 64 ,…,.
and the sequence converges to 2. As in the earlier example, no member of the
sequence actually equals the limit. Note that this sequence can be written in
the more instructive form

1, 1 + 1 2,1 + 1 2 + 1 4,1 + 1 2 + 1 4 + 1 8,1 + 1 2 + 1 4 + 1 8 + 1 16,….
Example 19.    For the function f(x) = 1 - x and the seed value x = 0, the
iteration sequence is
〈0,1,0,1,0,1,0,1,0,1,…〉.
The sequence has no limit in this instance.
Example 20.    For the function f(x) = x3 and the seed value x = 2, the
interaction sequence is
〈2,8,512,134217728,…〉.
The sequence clearly increases without limit—the next term is equal to
2417851639229258349412352;
whew ! This is sometimes expressed by writing: the limit of the sequence is
infinity.
Remark . The idea of a limit is a subtle one, and you may find it somewhat
confusing in the beginning. We will meet the concept quite often in the pages
to follow, though informally. Much later, when you are studying calculus, you
will find that a proper, formal understanding of the concept of limit is
indispensable.
Rem (a÷b) . Let a,b be integers, with b non-zero. The remainder left when a is
divided by b is denoted by Rem (a ÷ b)( Rem’ for ‘remainder’). This is a very
convenient symbol that we shall use quite often.
Example 21.    Rem (20 ÷ 7) = 6, Rem (12 ÷ 3) = 0.
Fixed Point  Let f be an iteration function. A number a such that f(a) = a is
called a fixed point of f, because f “fixes” a. The orbit 〈a;f〉 in this case is
〈a,a,a,a,a,a,…〉.
Example 22.    If the function is f (x) = x2 – 2, then 2 is a fixed point, because
f(2) = 22 - 2 = 2.
Attracting Fixes Point, Attractor  A fixed point α for a given iteration
function f is described as an attractor if for all seeds x0 sufficiently close to α,
the sequence 〈x0;f〉 converges to α. The fixed point may be said.to exert a

strong ‘gravitational pull’ on all nearby points.
Example 23.    Let f(x) = 6 -1 2x; then 4 is an attracting fixed point. Thus,
starting at the seed value 0, we get the orbit
〈0,6,3,4.5,3.75,4.125,3.9375,4.03125,3.984375 , … 〉.
The orbit converges to 4.
Repelling Fixed Point, Repeller     A fixed point α for a given iteration
function f is described as a repeller if for all seeds x0 sufficiently close to α but
not equal to α, the sequence 〈x0;f〉 fails to converge to α. (Of course, if x0 = α
then there is no problem—the sequence of iterates simply stays fixed at the
same point, α. )
Example 24.    Let f(x) = 6 - 2x; then 2 is a repelling fixed point. Thus, starting
at the seed value 0, we get the orbit
〈0,6, - 6,18, - 30,66, - 126,258, - 510,1026,…〉.
The orbit diverges.
Remark.     Later (in Chapters 15 and 16, and again in Volume II) we shall
find it necessary to distinguish between attractors and weak attractors, and
between repellers and weak repellers.
Cycle     An iteration sequence that returns to its starting value after a certain
number of steps is called a cycle. The number of entries in the cycle is the
length of the cycle.
Example 25.    For the function f(x) = 1 - x, the orbit of 2 is
〈2, - 1,2, - 1,2, - 1,2, - 1,…〉.
The "string" 〈2,-1〉 is a cycle with a length of 2.
Example 26.    Let the iterative function be the following:
Add 1 to the input, divide the sum by 3, and let the output be the
remainder thus obtained.
In symbols: if the input is x, then the output is given by f(x) = Rem ((x + 1) ÷
3). Choose an input, say x = 2; the orbit 〈2; f 〉 is then
〈2,0,1,2,0,1,2,…〉.

The string (0,1,2〉 is a cycle with a length of 3.
2-cycle    A cycle with a length of 2 is called a 2-cycle. (The first example
presented above shows a 2-cycle.) A 2-cycle therefore has the form
〈a,b〉,
with a≠b.
n-cycle    A cycle with a length of n, where n is some positive integer, is called
a
n-cycle. A fixed point can be thought of as a 1-cycle. A 3-cycle has the form
〈a,b,c〉,
where a,b and c are unequal.
SSQ(n)    The sum of the squares of the digits of the integer n is denoted by
the symbol SSQ (n). (All computations are with reference to base-10.)
Example 27.     SSQ(23) = 22 + 32 = 13. The iteration using this function
produces some pretty results, as we shall see in a later chapter.
SUM(n)    The sum of the digits of the integer n is denoted by the symbol
SUM (n).
Example 28.     SUM(125) =8, SUM(139) =13.
Composition of Functions    Let f and g such that the quantity f(g(x)) can be
meaningfully computed for each input x (note that g acts first, and then f acts
on the output given by g):
Then a new function can be defined in which the output f(g(x)) is produced
“in a single step”. This function is denoted by the symbol f ∘ g:
We say that f ∘ g has been produced by composing the functions f and g (in
the given order: g first, then f).
Example 29.     Let f(x) = x2,g(x) = x + 1, the domains of both f and g being

the set of positive integers N. Then
f ∘ g(x) = (x + 1)2,g ∘ f(x) = x2 + 1.
Thus, f ∘ g(10) = f(11) = 121, and g ∘ f(10) = g(100) = 101. Note that f ∘ g(10)
is not the same as g ∘ f(10).
In general, for arbitrary functions f and g, it will be the case that f ∘ g and g
∘ f are distinct functions. In some instances, however, it happens that f ∘ g = g
∘ f; that is, f ∘ g(x) = g ∘ f(x) for every possible value of x. In this case we say
that f and g commute.
Example 30.     The functions f(x) = x2 and g(x) = x3 commute, because for
any x,
f ∘ g(x) = (x3)2 = x6,g ∘ f(x) = (x2)3 = x6.
More generally, any two power functions commute.
Remark.    We can compose functions in arbitrarily complicated ways. For
example, for the functions f(x) = x2 and g(x) = x + 1, we have:
f ∘ g ∘ f(x) = (x2 + 1)2,
g ∘ g ∘ g(x) = x + 3,
g ∘ g ∘ f ∘ g(x) = (x + 1)2 + 2,
and so on.
Square Root of a Function    Let two functions a and b be related in such a
way that b ∘ b = a, that is, b(b(x)) = a(x) for all values of x. Then b is called a
square root of a.
Example 31.     For the function a(x) = x + 2, the function b(x) = x + 1 is a
square root, because for any x,
b(b(x)) = b(x + 1) = (x + 1) + 1 = x + 2 = a(x).
Some functions do not have square roots at all (we could call them "rootless"),
and some have more than one square root.
Binomial Theorem for positive Integral Indices    This states that if n is a
positive integer, then the expansion of (1 + x)n is given by

1 + nx + n(n - 1) 2! x2 + n(n - 1)(n - 2) 3! x3 + n(n - 1)(n - 2)(n - 3) 4! x4 + ⋯,
where 2! = 2,3! = 6,4! = 24, and in general, n! (pronounced n factorial”) is
given by
n! = 1 × 2 × 3 ×⋯ × (n - 1) × n.
Note that (1 + x)n is a polynomial in x of degree n. (The sequence of factors
n,n - 1,n - 2,…, reaches zero at some stage—because n is a positive integer—
and the expression then terminates.)
Example 32.    We have the following binomial expansions:
(1 + x)2 = 1 + 2x + x2,
(1 + x)3 = 1 + 3x + 3x2 + x3,
(1 + x)4 = 1 + 4x + 6x2 + 4x3 + x4,
(1 + x)5 = 1 + 5x + 10x2 +10x3 + 5x4 + x5.
Binomial Theorem for Arbitrary Indices     This states that if n is any real
number, and –1 ﹤ x ﹤ 1,then (1 + x)nmay be expanded in powers of x as
follows:
1 + nx + n(n - 1) 2! x2 + n(n - 1)(n - 2) 3! x3 + n(n - 1)(n - 2)(n - 3) 4! x4 + ⋯.
If n is not a positive integer or 0, the sequence of terms goes on indefinitely,
and the series is now an infinite series. The condition –1 ﹤x ﹤1 cannot be
dispensed with.
Example 33.    With n = 1∕2 and n = 1∕3, we get infinite series for (1 + x)1∕2 and
(1 + x)1∕3, respectively, valid for –l < x < 1:
(1 + x)1∕2 = 1 + x 2 -x2 8 + x2 16 -5x4 128 + 7x5 256 -⋯,
(1 + x)1∕3 = 1 + x 3 -x2 9 + 5x3 81 -10x4 243 + 22x5 729 -⋯.
Lattice Point    A point in the coordinate plane both of whose coordinates
are integers is known as a lattice point.
Example 34.    The points with coordinates (2, 3), (5, –1) and (10,0) are lattice
points, whereas (2, 0.5) is not a lattice point.
Monic Polynomial    A one-variable polynomial in which the leading term

(i.e., the term with highest degree) has a coefficient of 1 is known as a monic
polynomial.
Example 35.      The polynomials f,g given by
f(x) = x3 - 3x + 1,g(x) = x100 + 5x37 + x + 1,
are monic, whereas 2x3- x2 + x + 1 is not monic. Note that the product of two
monic polynomials in the same variable is monic.
⋆ ⋆ ⋆ ⋆ ⋆ ⋆ ⋆ ⋆ ⋆ ⋆ ⋆ ⋆ ⋆ ⋆ ⋆ ⋆ ⋆ ⋆ ⋆
In Chapter 13 we shall study a variety of iterations set in a purely geometric
context. Various geometric terms will be met in that chapter, e.g.,
median and centroid of a triangle;
incenter and incircle of a triangle;
altitude and orthocenter of a triangle;
pedal triangle of a point within a triangle;
oriented area of a polygon;
triangle of reference, and barycentric coordinates.
As these terms will not be encountered outside Chapter 13, we defer the
definitions to that chapter itself.

Chapter 3
Examples of Iterations
3.1   The GCD algorithm
A nice example of an iterative process at work is seen in the division
algorithm to extract the gcd (‘greatest common divisor’) of two given integers.
(Recall that the gcd of two integers a,b, denoted by the symbol gcd(a,b), is
defined to k the largest integer that divides both a and b. For example,
gcd(92,115) = 23 and gcd(111,185) = 37. )
The gcd algorithm goes back to Greek times, and a description can be found
in Euclid’s classic text, THE ELEMENTS; indeed, the algorithm is still referred to
as the EUCLIDEAN ALGORITHM. Here is a worked example to remind you how it
works.
Example 1.    To find the gcd of 25 and 165, the calculations are set out as
shown below.
165 = (6 × 25) + 15,
25 = (1 × 15) + 10,
15 = (1 × 10) + 5,
10 = (2 × 5) (no remainder left).
Therefore, gcd(25,165) = 5. Do you follow what exactly is “happening”?
How the GCD algorithm works
What “happens” is this the algorithm accepts two non-negative integers as
INPUT and then replaces them, using an iterative rule (which we shall

describe shortly), by two other integers, referred to as the OUTPUT. This is
done in such a manner that the output pair is smaller than the input pair, yet
has the same gcd. More precisely: the larger integer in the output pair is
strictly smaller than the larger integer in the input pair. This procedure is
repeated several times. Eventually we obtain a number pair in which one of
the numbers is zero and the other number is the gcd.
Here is a description of the iterative rule
Write the input pair as (a,b), where a and b are non-negative integers
and a ≥ b..
Divide a by b, and denote the remainder in the division by c.
Declare the pair (b,c) to be the output.
Example 2.    The input (100, 80) produces the output (80, 20); the input (100,
16) produces the output (16, 4); and so on.
Now repeat the process with the new pair as input. Continue this till at
some stage the remainder is zero. In other words, repeatedly replace the pair
(larger number, smaller number)
by the pair
(smaller number, remainder),
until at some point the division is exact.
Example 3.    To illustrate the iteration, we examine its action on the input
pair (289, 34). Dividing 289 by 34, we obtain a quotient of 8 and a remainder
of 17:
289 = (34 × 8) + 17.
The new pair is therefore (34, 17). Next, dividing 34 by 17, we obtain quotient
of 2 and a remainder of 0:
34 = (2 × 17) + 0,
so the next pair is (17, 0). As the zero-remainder stage has now been reached,
we declare the gcd of the two numbers to be 17. As a check, note that 289 = 17

× 17 and 34 = 2 × 17, and 17 and 2 are coprime. (Integers that share no factor
greater than 1 are said to be coprime.)
A pictorial manner of representing the basic operation involved is given
below:
where the symbol ‘Rem (a ÷ b)’ refers to the remainder left in the division a ÷
b.
Example 4.     Rem (100 ÷ 19) = 5, Rem (1000 ÷ 17) = 14.
Computer implementation of the GCD algorithm
For those familiar with “pseudo-code”, in which computer programs are
often written, the gcd algorithm is presented as follows:
Step 0: Read the positive integers a and b.
Step 1: Compute c = Rem (a ÷ b).
Step 2: If c = 0 then print the value of b and stop. The printed
number is the gcd.
Step 3: If c > 0 then replace (a,b) by (b,c).
Step 4: Go back to Step 1.
The instruction in Step 4 (Go Back to Step 1’) is the iterative part of the
algorithm; it recurs as long as c≠0.
Here is a computer program, written in BASIC, that performs the actions
described above.
REM a, b are positive integers
INPUT a,b
c = a - b* INT (a∕b)
WHILE c > 0
a = b : b = c : c = a - b* INT(a/b)

WEND
PRINT "GCD of " ; a ; " and " ; b ; " = " ; b
To illustrate how the algorithm works, we study its effect on the two input
pairs (17, 10) and (82, 64), The results are shown below, with the values of a,b
and c listed on the right at each stage.
Example 5.     (a,b) = (17,10)
Therefore, gcd(17,10) = 1.
Example 6.     (a,b) = (82,64)
Therefore, gcd(82,64) = 2.
Exercises
3.1.1 At the conclusion of Step 2, is it always true that c < b?
3.1.2 Apply the gcd algorithm to the following number pairs: (a) (100, 63) (b)
(100, 78) (c) (100, 17).
3.2   Squares
In this section, we study the following iteration:

Replace the input number by its square.
So if the input is x, then the output is x2. An initial input of 2 gives rise to the
numbers shown below:
and so on. Visually:
2↦4↦16↦256↦65536↦4294967296↦⋯.
Note how rapidly the numbers increase. This will obviously happen whenever
the starting number exceeds 1: the resulting sequence "explodes"—that is, the
numbers in the sequence increase with great rapidity and without limit. If,
however, the starting number lies between–1 and 1, then the resulting
sequence races with great speed towards a rather obvious limit. For example,
a starting value of 0.1 gives rise to the following sequence:
〈0.1,0.01, 0.0001, 0.00000001, 0.0000000000000001,… 〉 ,
and it is easy to guess the limit (it is clearly 0). Note, though, that the
sequence never quite gets to this limit—it is always a ‘little bit’ greater than
this number.
Exercises
3.2.1 Suppose that with an initial input of x, the process of squaring is
repeated n times, where n is some positive integer. Find a formula for
the final number thus obtained, in terms of x and n.
3.2.2 Show that if the initial input exceeds 1, then the numbers in the
iteration sequence increase without limit, that is, the limit of the
sequence is infinite.
(Here is one way of doing the problem. We start by stating that if h is

any positive quantity, and n is any positive integer greater than 1, then
(1 + h)n. > 1 + nh.
Example 7.     If h = 0.5 and n= 10, then (1 + h)n = 1.510 ≈ 57.6650,1+
nh = 1 + 5 = 6,. and of course, 57.6650 > 6.
The inequality is not too difficult to prove. Let n = 2; then (1 + h)n = (1
+ h)2 = 1 + 2h + h2. Since h2 is positive, 1 + 2h + h2 is greater than 1 +
2h. so (1 + h)2 > 1 + 2h.
We now use this result to prove the result for the next case, n = 3. Thus:
(1 + h)3 = (1 + h)2 ⋅ (1 + h)
> (1 + 2h) ⋅ (1 + h)
= 1 + 3h + 2h2
> 1 + 3h.
The results (1 + h)4 > 1 + 4h,(1 + h)5 > 1 + 5h,…, follow similarly.
Though this does not show that (1 + h)n > 1 + nh for all positive
integers n, the reader will readily see how the proof can be written
down.
Now consider our iteration sequence, in which each number after the
first is the square of the previous one (x↦x2). After n repetitions of the
squaring process, we obtain the number x2n
Write h for x - 1; then h is positive, since x > 1. Now write x2n as (1 +
h)2n , and apply the inequality stated above. Here is what we obtain:
x2n = (1 + h)2n > 1 + 2nh.
Since 2nh doubles each time n increases by 1, it follows that 2nh
increases without limit, so the quantity x2n too increases without limit.
Therefore the limit of the sequence is infinite.)
3.2.3 Show that if the initial input value lies between–l and 1, then the limit of
the iteration sequence is 0. (Hint: Use the result of the previous
exercise.)
3.2.4 With an initial input of 10, how many repetitions of this process would

be needed in order to produce an integer that has more than a
thousand digits? Ten thousand digits?
3.2.5 With an initial input of 2, how many repetitions of this process would
be needed in order to produce an integer that has more than a
thousand digits? Ten thousand digits?
3.2.6 What happens if in this iteration we replace the word ‘square’ by the
word ‘cube’?
3.3    Square roots
In the last section a calculator would have proved useful. In the next iteration,
access to a calculator or computer is essential.
We start with any positive number as input. The iterative rule is:
Replace the number by its square root.
So if the input is x, then the output is x; we write x↦x. On a calculator, we
enter the number x into the display and then repeatedly press the SQUARE
ROOT key (the one marked ). (On some calculators the '=' or 'EXE' key must
be pressed each time for the computation to proceed.) Here is the result of the
first few rounds of the iteration when we start with an initial input of 10:
(Read the numbers row-wise: starting with 10, we obtain 3.1623, followed by
1.7783, 1.3335, 1.1548, 1.0746 and so on.)
Note that the sequence seems to be heading towards a definite destination.
Alas, however, it will never quite get to this destination. (Do you see why?)
Exercises
3.3.1 What is the limit referred to above? Will the limit remain the same if we
change the starting number? Experiment with different starting

numbers before stating any conclusion.
3.3.2 What happens if we replace the word ‘square root’ by ‘cube root’?
3.3.3 What is the relation between this iteration and the previous one?
⋆ ⋆ ⋆ ⋆ ⋆ ⋆ ⋆ ⋆ ⋆ ⋆ ⋆ ⋆ ⋆ ⋆ ⋆ ⋆ ⋆ ⋆ ⋆
In the pages to follow, you will see many examples of iterations. Each
iteration gives rise to a certain sequence, and the task before you is to
investigate the patterns hidden within the sequence. Have fun!

Chapter 4
The Four-Numbers Game
4.1   The iteration
Choose any four integers and arrange them in any order. For example, we
may choose 41, 13, 92 and 7 and arrange them in the order given. An ordered
foursome of numbers is referred to by mathematicians a QUADRUPLE, and it is
usually enclosed in parenthesis thus: (41, 13, 92, 7). We use this quadruple as
the seed of the iteration, replacing it by another quadruple according to the
following rule:
(a,b,c,d)↦(|a - b|,|b - c|,|c - d|,|d - a|).
(The double-bar symbol ‘ ||’ stands for ABSOLUTE VALUE: |- 3| = 3,|- 19| = 19, |3
- 7| = 4, and so on. Note the cyclic order in which differences are taken.)
Example 1.    The quadruple (41, 13, 92, 7) yields (28, 79, 85, 34), because
|41 - 13| = 28,|13 - 92| = 79,
|92 - 7| = 85,|7 - 41| = 34.
Since we take only absolute differences, the output can never contain a
negative number.
We now iterate the operation. Here is the result:
Stage
Quadruple
1
(41, 13, 92, 7 )
2
(28, 19, 85, 34)

3
(51, 6, 51, 6)
4
(45, 45, 45, 45)
5
(0, 0, 0, 0)
Note that once we reach the quadruple (0,0,0,0), we remain there; we are
“stuck”!
Let us do the iteration with some other seed, say (19,27,63,90). Here is the
result:
Stage
Quadruple
1
(19,27,63,90)
2
(8,36,27,71)
3
(28, 9, 44, 63)
4
(19,35,19, 35)
5
(16, 16, 16, 16)
6
(0, 0, 0, 0)
We are stuck once again. Surely something curious is happening?
4.2   Exercises
4.2.1 Try out the procedure on each of the following seeds:
(i) (1, 17, 63, 6)
(ii) (91, 117, 13, 60)
(iii) (236,40, 67, 3)

(iv) (47, 3, 102, 200)
What do you notice? Do you end up with the same result in each case
(namely, (0,0, 0,0 ) )?
Remark.   If this is indeed so, we have found a type of problem where it
does not matter if you make a mistake halfway through—you still end
up with the right answer!
4.2.2 Identify the quadruples that reach (0,0,0,0) after (i) one round (ii) two
rounds (iii) three rounds of the iteration.
4.2.3 Here is a simple computer program in BASIC that will help you to do
some of these exercises on the computer.
REM Four numbers game
INPUT a,b,c,d
x = a : y = b : z = c : w = d
count = 0
WHILE x + y + z + w > 0
xl = ABS (x -y) : yl = ABS (y -z)
zl = ABS (z-w) : wl = ABS (w -x)
count = count + 1
x = xl: y = yl: z = zl: w = wl
WEND
PRINT "( 0, 0, 0, 0 ) reached in " ; count ; " steps”
What role is played by the statement “while x + y + z + w > 0?”
4.2.4 What if we work with TRIPLES rather than with quadruples?
Example 2.    Starting with the triple (3, 17, 40), we get:
Stage
Triple
1
(3, 17, 40)

2
(14, 23, 37)
3
(6, 14, 23)
4
(8, 9, 17)
5
(1, 8, 9)
6
(7, 1, 8)
and so on. In symbols:
(a,b,c)↦ |a - b|,|b - c|,|c - a|.
Try out the iteration on the following seeds:
(i) (2, 13, 17);
(ii) (3, 19, 50);
(iii) (100, 201, 18).
What do you notice? Does each triple ultimately reach (0,0,0)?
4.2.5 Make a list of the triples that:
(i) ultimately reach (0,0,0);
(ii) ultimately reach (1,0,1) and then keep ‘cycling’ round and round;
(iii) cycle round some other terminal triple.
What patterns do you find? (Caution: You will need to experiment with
many triple before drawing any conclusions.)
4.2.6 What happens in the case of 5-tuples and 6-tuples? Experiment around
on your own—you may discover a few surprising facts!
4.3   Concluding remarks
It is important to realize that at this stage, we cannot be certain that no matter
which quadruple we start with, we shall inevitably reach (0, 0, 0, 0) after some

iterations; it is only a HYPOTHESIS (that is, a surmise, or a guess). It is
important to keep this point in mind. You may wish to work on this question:
How can one know the truth “for sure” ? We shall be taking up such questions
somewhat later, in Chapter 14.

Chapter 5
Sums of Squares
5.1   The iteration
Given an integer n (the input), we produce another integer (the output) by
adding the squares of the digits of n. (Throughout, we work only in base-10,
that is, the “decimal system.”) Let SSQ (n) denote this sum (for example,
SSQ(15) = 26 and SSQ(32) = 13 ) ; then the iteration is as shown below:
n↦SSQ(n).
Example 1.    61↦62 + 12 = 37,37↦32 + 72 = 58, and so on. If we tabulate the
orbits of different seeds, we soon notice some curious results.
If we start with 0, we get stuck there (02 = 0); we only produce more 0's.
Likewise, if we start with 1, we produce only 1′s.
More interesting results are obtained when we start with 2: we get 4,
followed by 16, then 37 and after that:
58, 89, 145, 42, 20, 4;
we have now returned to the number 4! Obviously from this point on we shall
remain in cycle:
4↦16↦37↦58↦89↦145↦42↦20↦4,
and we are back at the starting point. Do you see why we use the term CYCLE?
5.2   Exercises
5.2.1 Start with each of the following seeds and see if you reach any cycle: (i) 5
(ii) 6 (iii) 8 (iv) 11 (v) 12.

5.2.2 You will probably have discovered something surprising: the cycle listed
above,
〈4,16,37,58,89,145,42,20〉,
seems to occur for just about any seed! The only other cycles seem to be
〈1〉 and 〈0〉, though there is not much to be said about 〈0〉; it can arise
only from a seed of 0.
   Identify as many seeds as you can that ultimately reach the cycle 〈1〉;
there are quite a few of these seeds! See if you can capture all such seeds
that are less than 100.
5.2.3 *  Challenge!—Find procedure for generating all seeds that eventually
reach the cycle 〈1〉.
5.2.4 What if we work with cubes instead of squares?—that is, we add the
cubes of the digits rather than the squares:
n↦ sum of the cubes of the digits of n.
Example 2.    21↦23 + 13 = 9,9↦93 = 729. The numbers to follow are: 73
+ 23 + 93 = 1080,13 + 03 + 83 + 03 = 513,53 + 13 + 33 = 153, 13 + 53 +
33 = 153,…. Thus:
21↦9↦729↦1080↦513↦153↦153↦153 ↦⋯.
What a pleasant surprise!—we have found a number that equals the
sum of the cubes of its digits:
153 = 13 + 53 + 33.
Try the iteration out on different seeds and list down the cycles you
find. Find as many numbers as possible that equal the sums of the
cubes of their digits. (There are only a few numbers that share this
property with 153.)
5.2.5 Let us try the experiment with fourth powers instead of cubes. Now we
get: 21↦24 + 14 = 17,17↦14 + 74 = 2402, etc., and the numbers to
follow are 16 + 256 + 0 + 16 = 288, then 16 + 4096 + 4096 = 8208;
following this we get 4096 + 16 + 0 + 4096 = 8208, and the number
stays fixed at 8208 thereafter. We have found a number that equals the

sum of the fourth powers of its digits !
8208 = 84 + 24 + 04 + 84.
Try to find further examples of this property.
5.2.6 *  Challenge!—Show that there do not exist any numbers (other than 0
and 1 ) that are equal to the sums of the squares of their digits.
5.3   Further comments
The following comment echoes the one made at the end of the last chapter:
for the SSQ iteration too, we do not at this point know for sure that every seed
results in one of the cycles 〈0〉,〈1〉 and 〈4,16,…,20〉. Not knowing “for sure”
means that at this stage our knowledge is incomplete and not quite certain; it
is only a hypothesis to say that we shall inevitably end up in one of the three
cycles. It is true that the hypothesis has been verified in every case examined
till now, but there is always a possibility of its failing in some exceptional
instance. (Mathematicians refer to such instances in general as
“counterexamples”.) To make sure that no counterexamples exist, a very
different type of analysis needs to be done. Those who are keen on see how
this more challenging problem is tackled will need to wait till Chapter 14.

Chapter 6
Fixed Points and Cycles
6.1    Fixed points
Earlier we found that for the sum-of-cubes iteration,
153↦153;
for the sum-of-fourth-powers iteration,
8208↦8208;
and for the four numbers iteration,
(0,0,0,0)↦(0,0,0,0).
Observe that in each case, the output is identical to the input. When this
happens, the input is referred to as a FIXED POINT for the iteration under
study. A formal definition of the term “fixed point” is given below.
Fixed Point    A fixed point for the iteration x↦f(x) is any solution of the
equation f(x) = x. (If a is any solution of this equation, then f “fixes” a, hence
the choice of the word.
Observe that we said any fixed point. It is possible for a function to have
many fixed points.
Example 1.    For the function f(x) = x2, the fixed points are 0 and 1, because
the solution set of the equation x2 = x is {0,1}.
Example 2.     The function f(x) = x + 1 has no fixed point.
Example 3.     The functions f(x) = x2 + 1 and g(x) = x4 + 1 have no fixed
points. (This is true only because we confine our attention to the REAL

NUMBERS. If we enlarge our canvas to include COMPLEX NUMBERS, then f and g
do have fixed points. )
Example 4.     The SSQ function ( n↦ sum of the squares of the digits of n) has
just one fixed point, namely 0. (Naturally, this statement needs proof.)
1-cycle    If a is a fixed point for the function f, then 〈a〉 is a 1-cycle for the
iteration x↦f(x).
Exercises
6.1.1 Consider the function f that takes x to x2 – 2; thus 10 ↦98,7↦47, and so
on. What are the fixed points of f?
6.1.2 What are the fixed points of the function f given by f(x) = 2x –x2?
6.1.3 What are the fixed points of the following functions f?
(a)   f(x) = x2 – 12   (b) f(x) = x3 – 3x?
6.1.4 Prove that the function f(x) = x2 + 1 has no (real) fixed points.
Hint. Show that x2 + 1 > x for all real values of x.
6.1.5 Prove that the function g(x) = x4 + 1 has no (real) fixed points.
6.2   Cycles
Just as we have l-cycles, we also have 2-cycles, 3-cycles, and so on.
2-cycles: if a and f(a) are unequal, but the second iterate yields the
original number, i.e., f(f(a)) = a, then we get a 2-cycle:
〈a,f(a)〉;
3-cycles: if a,f(a) and f(f(a)) are unequal, but the third iterate yields the
original number, i.e., f(f(f(a))) = a, then we get a 3-cycle:
〈a,f(a),f(f(a))〉;
4-cycles: if a,f(a),f(f(a)) and f(f(f(a))) are all unequal,but the fourth iterate
yields the original number, i.e., f(f(f(f(a)))) = a, then we get a 4-cycle:
〈a,f(a),f(f(a)),f(f(f(a)))〉;

and so on. The sketches below convey these ideas in a visual and more
appealing language.
l-cycle:      a↦a;
2-cycle:      a↦f(a)↦a;
3-cycle:      a↦f(a)↦f(f(a))↦a;
4-cycle:      a↦f(a)↦f(f(a))↦f(f(f(a)))↦a.
Repeating decimals
Repeating cycles have surely been seen earlier by the reader, for they often
arise in simple situations. For instance, consider the phenomenon of
recurring decimals. Displayed below are some familiar instances of recurring
decimals.
 1/3 = 0.333333...
1/7 = 0. 142857142857...
5/12 = 0.416666...
1/13 = 0.076923076923...
The repeating portion for 1/7 is the ‘string’ 142857; note that its length is 6.
Where is the ‘cycle’ in this example? To find it, examine the division 1.0000
… ÷ 7. You will find that the remainders go through the cycle
〈3, 2, 6,4, 5, 1〉;
that is, 1 is followed by 3, then 3 is followed by 2, and so on.
Exercises
6.2.1 Find by computation the lengths of the repeating portions of the
decimals corresponding to the fractions (i) 1/19 (ii) 1/21 (iii) 1/29.
6.2.2 Find the fraction a∕b whose decimal expansion is
a b = 0.415757575757….
(The repeating portion is the string 57.)

6.2.3 Find a fraction a∕b whose repeating portion has a length of (i) 5 (ii) 16.
Cycles in the sequence of units digits
Another example of a cycle is found in the sequence of units digits of the
powers of 2. To obtain the sequence, we first list the successive powers of 2:
2, 4, 8, 16, 32, 64, 128, 256, 512, 1024, 2048, 4096, ....
then retain only the units digits of these numbers:
2, 4, 8, 6, 2, 4, 8, 6, 2, 4, 8, 6, ....
We note that the cycle 〈2, 4, 8, 6〉repeats indefinitely.
   Likewise, if we list the successive powers of 3:
3, 9, 27, 81, 243, 729, 2187, 6561, 19683, ...,
then retain only their units digits:
3, 9, 7, 1, 3, 9, 7, 1, 3, ...,
we find that the cycle 〈 3, 9, 7, 1〉 recurs indefinitely. It is an easy matter to
construct a large number of such examples.
Exercises
6.2.4 Find the cycles in the units digits of (i) the powers of 7 (ii) the powers of
8.
6.2.5 Explain why the cycle〈 2,4, 8, 6 〉 occurs in the sequence of units digits
of the powers of 2.
6.2.6 Explain why the cycle 〈3,9,7,1〉 occurs in the sequence of units digits of
the powers of 3.
6.2.7 (Challenge!) Explain the phenomenon of recurring decimals.
More precisely, explain why for any two positive integers a,b the
decimal obtained in the division a ÷ b will necessarily repeat exactly
from some point on. (If the division is exact, then the repeating portion
will be a single 0, that is, the decimal will have the appearance...000....
For example, if a = 43, b = 25, then a ÷ b = 1.72000….)

Chapter 7
The Kaprekar Constant
The mathematics of great amateurs    The iteration we study in this chapter
is associated with the name of a famous amateur mathematician (by
profession he was a teacher in a high school) from the state of Maharashtra in
India, Shri D. R. Kaprekar. What does “amateur mathematician” mean?
Perhaps it refers to a person who loves doing mathematics for its own sake.
Kaprekar loved playing with numbers, and he loved conducting
investigations and uncovering unusual properties of numbers. Thus he came
to discover what we now refer to as the ‘Kaprekar iteration’ and the ‘Kaprekar
constant’. Indeed, he discovered many phenomena of the type that we shall
describe below.
Remark.  It is perhaps not so very difficult to discover things the way
Kaprekar did;what is required, more than anything else, is a deep love of one’s
subject, and qualities such as perseverance and tenacity: the ability to stay with
an investigation once one has started it, without giving up halfway through.
Perhaps this quality—that of tenacity—is one that any truly great person
possesses. Readers who are familiar with the work of the great astronomer
Johannes Kepler, and know of the stupendous labour that went into the
discovery of the laws of planetary motion (Kepler’s laws), would surely agree
with this observation.
7.1   The Kaprekar iteration
Here is how the Kaprekar iteration works: starting with any whole-number
seed x(initially we shall work with 4-digit numbers, written in base-10),we
rearrange its digits so as to make the largest possible number, xmax. Next, we

rearrange the digits of x so as to make the smallest possible number, xmin.
Clearly, the digits of xmin will be in reverse order as compared with xmax.
Example 1.     If x = 2810, then xmax = 8210 and xmin = 0128. (This is the
same as 128, but for reasons that will be clear shortly, we prefer to write it as
0128.)
The Kaprekar function is now defined by the following rule:
Replace x by xmax – xmax
Write K for the Kaprekar function; then K xmax – xmax. In words,
K(x) equals the difference between the largest number that can be
formed by rearranging the digits of x and the smallest such number.
The Kaprekar iteration consists of iterating this operation. To avoid
ambiguities in the application of the function, we choose to impose the
following rule with regard to the output:
If the output has fewer digits than the input, then we pad it from the front
(the “left side”) with a suitable number of zeroes so that the input and the
output have the same number of digits. (Note that this does not alter its
value as a number.)
In other words, we restore its number of digits. With this rule, every number
in the chain will have the same number of digits.
Example 2.    Let x = 1039; then xmax = 9310,xmin = 0139(= 139), and
therefore, K(1039) = xmax - xmin = 9310 - 0139 = 9171. Thus,
1039↦9310 - 0139 = 9171.
Applying the Kaprekar operation to 9171, we get
K(9171) = 9711 - 1179 = 8532.
Next, K(8532) = 8532 - 2358 = 6174, and so on. The net result of the
operations can be written compactly as
K(K(K(1039))) = 6174,
or, more appealingly, as:

1039 → 9171↦8532↦6174↦⋯.
Why “pad” the output with zeroes?    You may wonder about the need to
pad the output number with zeroes on the left side so as to make the output
and input have the same number of digits. The point is that without such a
rule,situations could arise where the application of the K function becomes
unclear.
Example 3.    For the input value x = 1112, we obtain
K(1112) = 2111 - 1112 = 999,
which is a 3-digit number, whereas 1112 has four digits. The question now is,
what is K(K( 1112))? If we apply the Kaprekar operation directly to 999, we
obtain 999 - 999 = 0, whereas if we apply the rule and write K(1112) as 0999,
we get 9990 - 0999 = 8991, which is of the same length as the number 1112.
So do we write K (1112) as 999 or as 0999? Our preference will be for the
latter, i.e., for padding the output with 0’s. However this is on purely aesthetic
grounds: it seems “nicer” to preserve the number of digits in the output as the
iteration progresses. Note that the other rule ("no padding”) also provides us
with a perfectly valid iteration.
7.2    Exercises
7.2.1 Apply the Kaprekar iteration to 1039. Do you reach a cycle or fixed
point?
7.2.2 Repeat the exercise for the seeds (i) 8619 (ii) 1234 (iii) 1235 (iv) 9000 (v)
8000. What do you notice? Can you make a guess as to the general
behaviour of the Kaprekar iteration?
7.2.3 What is the largest possible value of K(x) if is a 4-digit number?
7.2.4 One of the fixed points of the K iteration is the number 0000. Which
seeds reach this fixed point in one step? In two steps? In three steps?
7.2.5 The other fixed point that you will have found is the number 6174. (It is
a fixed point because if x = 6174, then xmax = 7641 and xmin = 1467,
therefore,xmax - xmin = 7641 - 1467 = 6174 = x; so K(6174) = 6174.) 
Are there any fixed points other than these two (0000 and 6174)?
Experiment with different seeds before drawing any conclusion.

The fixed point 6174 is known as the KAPREKAR CONSTANT .
7.2.6 Experiment with 3-digit seeds. with the understanding that all numbers
involved in the computation are written as 3-digit numbers.
Example 4.    x = 157 leads to xmax = 751 and xmin = 157, and
therefore, K(x) = xmax - xmin = 751 - 157 = 594.
Try out the Kaprekar iteration on different seeds. Are there any
Kaprekar constants to be found here?
7.2.7 Prove that the 3-digit Kaprekar iteration has precisely two fixed points. 
(You could argue as follows. Let the digits of x be a,b and c, where a ≥ b
≥ c.
Then
xmax = 100a + 10b + c
xmin = 100c + 10b + a
K(x) = (100a + 10b + c) - (100c + 10b + a)
= 99a - 99c = 99(a - c).
Thus K(x) is always a multiple of 99, and so a fixed point of K is
necessarily a multiple of 99. Now there are just ten 3-digit multiples of
99, and it is an easy matter to check whether any of them is a fixed
point of K. This procedure will obviously give us all the fixed points we
seek.)
7.2.8 Try out the 5-digit case on your own; see if there are any more such
constants to be found. Keep a careful record of the patterns that you
discover.
7.2.9 Suppose that we did not insist on padding the front of the number with
0’s so as to preserve the number of digits. What can be said about this
iteration?
7.3   Concluding remarks
Projects for the student  For those who have access to a computer and are
able to write simple computer programs in BASIC or PASCAL, the

computational work can be lessened considerably by working on a computer.
Problems that are computationally difficult but are of intrinsic interest can be
taken up, for example:
For the 4-digit Kaprekar iteration, find the largest number of steps
needed to reach the Kaprekar constant 6174.
Investigate which are the most “resilient” numbers—the ones whose
orbits take the longest to reach the Kaprekar constant.
Investigate whether there are Kaprekar constants for 6-digit numbers
and for 7-digit numbers.
What about extensions to bases other than 10? Investigate this problem
too.
7.4    Recent results
In 1978 two mathematicians (H. Hasse and G. D. Pritchett) extended
Kaprekar’s work to bases other than base 10 and came up with the following
pretty finding: A Kaprekar constant exists for 4-digit numbers in base B if and
only if B is a number of the from 5 × 2k where k is 0 or an odd positive number,
i.e., if and if B is one of the numbers
5,10,40,160,640,....
Moreover, if B is one of these numbers, then the Kaprekar constant may be
obtained as follows. Let c = B∕5; then the 4-digit Kaprekar constant is the
number whose digits, reading from left to right, are 3c,c - 1,4c - 1 and 2c,
respectively; i.e., the number
K = 3c,c - 1,4c - 1,2c¯.
Some examples are given below.
For B = 10, we get c = 2 and K = 6174. (This agrees with what we already
know.)
For B = 5, we get c = 1 and K = 3032. For example, the seed x = (1342)5
yields:

(1342)5↦(4321)5 - (1234)5 = (3032)5.
The constant has been reached in a single step.
For other bases, there is no single number to which all orbits converge; there
are, instead, multiple fixed points (we could, if we wish, call them “Kaprekar
constants”) and “Kaprekar cycles”. Thus:
In base 2 there are two fixed points, namely (0111)2 and (1001)2. Every
orbit converges to one of these two fixed points.
In base 4 there is a fixed points(3021)4, but there is also a Kaprekar 2-
cycle:
(2022)4,(1332)4 .
In base 3 we have the Kaprekar 2-cycle
(1221)3,(1012)3 .
In base 6 we even have a Kaprekar 6-cycle!—
(3043)6,(3552)6,(3133)6,(1554)6,(4042)6,(4132)6 .
In base 7 we have the Kaprekar 3-cycle
(3054)7,(5052)7,(5232)7 .
In base 9 we have the Kaprekar 3-cycle
(5074)9,(7072)9,(7432)9 .
If the base B is divisible by 5 but has a prime factor other than 2 and 5,
then the number K given by
K = 3c,c - 1,4c - 1,2c¯    (where c = B∕5)
is a fixed point, but there are Kaprekar cycles too.
The reader is invited to find more such results, via further experimentation.
7.5    Biographical details
It may be appropriate to add at this point a few biographical details
concerning Kaprekar.

D. R. Kaprekar was born in 1905, in the district of Thana, close to Mumbai.
He completed his high school education in 1923, and then joined the
Fergusson College (Pune) for his college studies. He became a teacher after
graduation, and taught in schools from 1930 till 1962. For more than sixty
years he pursued his passion: recreational number theory. He published
numerous booklets on his pet interests; many of these were printed at his own
expense. He contributed many articles to mathematics journals in the
country, and in 1975 his work on the ‘Kaprekar constant’ became known to
readers outside the country through the columns of Martin Gardner in the
SCIENTIFIC AMERICAN.
  Among the problems that Kaprekar worked on, mention may be made of
the Tary-Escot problem, which asks for sets of numbers A and B of equal
cardinality, say
A = {a1,a2,…,an},B = {b1,b2,…,bn},
such that we have the following relations:
a1 + a2 + ⋯ + an = b1 + b2 + ⋯ + bn,
a12 + a 22 + ⋯ + a n2 = b 12 + b 22 + ⋯ + b n2,
a13 + a 23 + ⋯ + a n3 = b 13 + b 23 + ⋯ + b n3,
⋯⋯⋯⋯ = ⋯⋯⋯⋯
a1k + a 2k + ⋯ + a nk = b 1k + b 2k + ⋯ + b nk,
for some given positive integer k. In more compact notation, we must have
∑ i=1na it = ∑ i=1nb it
for t = 1,2,…,k. The following notation is frequently used by researchers
working on this problem: the above relation is written as
{a1,a2,…,aI} = k{b1,b2,…,bn}.
Ideally, the sets A and B should be as small as possible. Here are two very
interesting Tary-Escot identities found by Kaprekar:
{4, 20, 42, 3, 41, 25 } = 3{5,21,43,2,40,24};.
{6, 32, 45, 8, 45, 39 } = 3{9,35,48,5,42,36}.

In both these examples, remarkably, the digits of the numbers on the right are
the same as those of the numbers on the left—but in reverse order!
It is perhaps very appropriate to quote these examples here, as they
illustrate the joyful exuberance with which Kaprekar conducted his many
number-theoretic researches.

Chapter 8
Self-Born Numbers
8.1    The iteration
In an earlier chapter, we studied the function SSQ(x) whose output for an
integer input x is the sum of the squares of the digits of x. We now study a
similar function which once again is associated with the name of Kaprekar.
(For those familiar with Kaprekar’s work, this will be seen to be a
“typical”Kaprekar iteration.)
For any positive integer x, given in base-10 notation, let SUM (x) denote
the sum of the digits of x. For example we have SUM (253) = 2 + 5 + 3 = 10.
We study the function g which acts as follows:
g(x) = x + SUM(x).
In other words, for an input of x, the output is g(x) = x + SUM(x).
Example 1.
g(25) = 25 + 2 + 5 = 32;
g(32) = 32 + 8 + 2 = 37;
g(453) = 453 + 4 + 5 + 3 = 465; and so on.
We now compute, for various a's, the sequences Ka defined as follows:
Ka = 〈a;g〉.
With a = 1, the computations are as set out below:
1,1+1 = 2,2+2 = 4,4+4 = 8,8+8 = 16,16+1+6 = 23,23+2+3 = 28,28+2+8

= 38,38+3+8 = 49,49+4+9 = 62,62+6+2 = 70,70+7+0 = 77,77+7+7 =
91,….
We obtain, therefore:
K1 = 〈1,2,4,8,16,23,28,38,49,62,70,77,91,101,103,107,…〉.
Obviously 2 generates the same orbit, except for the initial ‘ 1’. In like manner
we obtain:
K3 = 〈3,6,12,15,21,24,30,33,39,51,57,69,84,96,111,…〉,
K5 = {5,10,11,13,17,25,32,37,47,58,71,79,85,98,115,…〉,
and so on. It is clear that we can generate infinitely many such sequences,
using different seeds.
  If we form the union of all such sequences, discarding only their seeds, we
obtain a set, say S,which consists of all positive integers that can be obtained
as output from g for some choice of input.This is the RANGE of g:
S = {g(x) : x ∈N}.
What kind of set is S? Does it contain all of N?
It certainly contains a good proportion of it. For example, 50 ∈ S, because
g(43) = 43 + 4 + 3 = 50, and 100 ∈ S, because g(86) = 86 + 8 + 6 = 100. On
the other hand, there are many numbers that are not in S.
We claim that 53 is one such number; that is, there is no positive integer x
for which x + SUM (x) = 53.
Exercise
8.1.1    Prove this claim.
Proof.  We give the proof here, but perhaps you should try the problem on
your own before reading on.
Since SUM(x) ≥ 0 for all positive integers x, the equation x+ SUM (x) = 53
implies that
x ≤ 53.
On the other hand, for positive integers less than or equal to 53, the largest

possible sum-of-digits that we can get is for 49, whose SUM value is 13.Thus:
if x ≤ 53, then SUM (x) ≤ 13.
Since x+ SUM (x) = 53, we conclude that
x ≥ 40.
Combining the two inequalities, we conclude that:
if x+ SUM (x) = 53, then 40 ≤ x ≤ 53.
We now proceed to construct a table of values of g(x) for 40 ≤ x ≤ 53:
Note that 53 does not appear in the second row. It follows that 53∉S.
8.2     Exercises
8.2.1 Solve each of the following equations for x:
(i) g(x) = 60;
(ii) g(x) = 148;
(iii) g(x) = 162;
(iv) g(x) = 281;
(v) g(x) = 948.
8.2.2 Using a computer, or otherwise, find all the positive integers below 100
that are not in S.
8.3   Self-born numbers
Kaprekar coined a name for the integers not in S. He called them self-born—a
beautifully poetic name! The law of information of the sequence of these
numbers is unclear; perhaps you could do some research on the problem!
Two more examples of such numbers are given below.
The number 1000000 or 106 (i.e., one million) is self-born. (This,

according to Kaprekar, is why millionaires are given so much
importance!) 
To show why 106 is self-born, we argue as we did for the number 53. The
steps are, in brief:
If x+ SUM (x) = 106 then x < 106,∴ SUM (x) ≤ 54,∴ x ≥ 106 - 54,
i.e., x ≥ 999946. Also, clearly, x ≤ 999999.
If 999946 ≤ x ≤ 999999 then SUM (x) ≥ 41 (for the lowest SUM for
numbers between 999946 and 999999 is 41), ∴x ≤ 999959. Since
the largest SUM for numbers that lie between 999946 and 999959 is
50, we see that x ≥ 999950.
So x lies between 999950 and 999959. One finds quickly that g(x) is
odd for all x in this interval. Therefore, none of these x-values yield
g(x) = 106 (which is even). We deduce that 106 is self-born.
The well known “cyclic” number 142857 is self-born. (The reader is
invited to prove this claim.)
8.4    Junction numbers
Suppose that g(x) = g(y) = N; then under action by g, both x and y yield N.
That is, N has two “generators”. Numbers with more than one generator are
called junction numbers by Kaprekar. According to him, the smallest junction
number is 101 (with two generators, 91 and 100); the smallest junction
number with three generators is
10000000000001,
with 12 zeroes in the “middle” of the number; and the smallest junction
number with four generators is
1000000000000000000000102,
with 21 zeroes in a block inside the number. (Whew !)

Chapter 9
Self Referential Numbers
9.1   The iteration
The iteration we study now deals with self referential numbers, a curious
family of numbers that seem to describe themselves! The best way to describe
the iteration is by means of an example.
Example 1.    Take any positive integer, e.g., 32. The digits of this number are
2 and 3; there is a single 2 and a single 3. We read out the digits aloud, in
increasing order (in this case, 2 first and 3 next) like this: “one two and one
three”. Next we convert the words of this sentence into digits, i.e., we write ‘
1213’ (the ‘and’ is ignored!) and treat this string of digits itself as a number.
This number is taken to be the output obtained from the input 32:
32↦1213.
We refer to the function that produces this output as f; thus, f(32) = 1213.
Here are a few further examples that show how f acts:
f(12) = 1112              (one 1, one 2”),
f(64) = 1416              (one 4, one 6”),
f(136) = 111316         (one 1, one 3, one 6”),
f(1416) = 211416         (two l’s, one 4, one 6”),
f(1117) = 3117              (“three 1’s, one 7”).
Note that the digits are read off in increasing order, and we make no
reference to digits which do not occur in the number.

Does the iteration give rise to any features of interest, e.g., cycles and fixed
points? Before going into this question, we first define the term “self
referential”
Self Referential Number    A fixed point of the function described above is
called a self referential number; it satisfies the equation f(x) = x.
Another label we could use for such a number is self descriptive, because
the number seems to be “describing” itself. However, we shall stick to the
term SELF REFERENTIAL, because the number seems to ‘refer” to itself.
It may seem at first quite hard to find such numbers—indeed, it is not clear
that they exist at all; but read on! The examples discussed below should clarify
matters.
Example 2.    Let x = 22; then f(22) = 22('two 2’s’), so 22 is self referential.
Note that 1 is not self referential, because f(1) = 11≠1; nor is 0, because f(0)
= 10≠0. You are invited to find a few self referential numbers by yourself
before proceeding further.
Using the function f to find self referential numbers
We now use the function f as an iterative function—we select some seed
number x and then study its orbit 〈x;f〉. A curious discovery awaits us: if we
try out different seeds, in a majority of the cases the sequence quickly
converges to a fixed point of f, that is, to a self referential number.
Example 3.    We examine the sequence 〈1;f〉.
f(1) = 11,
f(11) = 21,
f(21) = 1112,
f(1112) = 3112,
f(3112) = 211312,
f(211312) = 312213,
f(312213) = 212223,

f(212223) = 114213,
f(114213) = 31121314,
f(31121314) = 41122314,
f(41122314) = 31221324,
f(31221324) = 21322314,
f(21322314) = 21322314,
and that’s it! We have:
f(21322314) = 21322314,
so 21322314 is self referential. What a surprise!
9.2    Exercises
9.2.1 Using the seeds x = 3,x = 4 and x = 9, see if the sequences 〈x;f〉 give rise
to self referential numbers.
9.2.2 Repeat the exercise with the seeds x = 20,x = 25,x = 95. Tabulate your
results.
9.2.3 Repeat the experiment with the seeds x = 40,x = 50. (You may find the
results rather surprising.)
9.2.4 Find other seeds that behave like 40 and 95.    
A lot of experimentation will be needed to answer this question! See if
you can get a computer to do the work for you. This itself is no simple
feat—it requires the writing of a good computer program.
9.2.5 *  Challenge ! Explain why the phenomenon occurs at all, i.e., why for
any seed x, the sequence 〈x;f〉 converges to a self referential number or
a self referential cycle. (See Chapter 14 for some ideas on how this
might be done.)

Chapter 10
Cyclical Functions
10.1   Iterations on functions
We now look for repeating cycles of a rather different variety, exhibited not
by some specific numbers but by the functions themselves. As stated earlier, a
function is essentially a machine that converts an input into an output. What
would ‘cyclic behaviour’ mean in this context? Simply this: the function must
be such that the action of continually feeding its output back as input into itself
must produce, after some steps, the same number with which we began.
Moreover, this must happen regardless of the choice of initial seed. We shall
refer to such a function as a cyclical function.
Visually, one might represent this as follows:
Here the “…” means a certain number of f′s. The point is that when the
input, x, is passed through all these machines, after some steps we obtain the
original value x once again. This must hold no matter which input we start
with.
Do there exist cyclical functions at all?
The surprising answer is that there are very many such functions; indeed,
infinitely many!
Example 1. Consider the function R ( ‘R’ for ‘reciprocal’) defined thus for x ≠
0:
R(x) = 1 x.

Thus R yields 2 from 1∕2; and now if 1/2 is fed back into R, we get 2, because
R 1 2 = 1 1∕2 = 2.
Visually, we have:
2↦1 2↦2.
This will of course happen for any non-zero input x:
R(x)=1x,∴R1x=11/x=x.
We write this more compactly as follows:
R(R(x)) = x     for all x≠0.
This is read aloud as "R of R of x equals x for all non-zero x.” (Note that the
phrase ‘for non-zero x’ must be included: the function would not ‘know’ what
to do with an input of 0, because 1/0 is an undefined quantity.)
Still more compact is the following symbolism:
R ∘ R = I.
By ‘R ∘ R’ (read this as ‘R of R′) we mean that R is applied twice over, and by
‘I’ we mean the identity function—the function for which the output always
equals the input ( I(x) = x for all values of x).
What are the cycles of R? It is easy to see that the only fixed points are 1
and - 1, because the equation 1∕x = x leads to x2 = 1, whose solution set is {1, -
1}. We conclude that for the function R(x) = 1∕x,
each non-zero number other than 1 or-l belongs to a cycle of length 2;
and.
there are precisely two l-cycles, namely 〈1〉 and 〈-1〉.
Example 2.    Consider the function g given by
g(x) = 1 - x.
Observe that g takes 2 to - 1 (because 1 - 2 = -1), and –1 back to 2 (because 1 -
(-1) = 2):
2↦1 - 2 = -1↦1 - (-1) = 2.

The same thing happens for any input x, because
x↦1 - x↦1 - (1 - x) = x,
or, written differently,
g(g(x)) = 1 - g(x) = 1 - (1 - x) = x.
In terms of the new symbolism, g ∘ g = I.
Note that g has just one 1-cycle; for if g(x) = x then 1 - x = x, ∴ x = 1∕2.
Thus, apart from a solitary 1-cycle, namely 〈1∕2〉, every other number belongs
to a 2-cycle.
For a still simpler example, consider the function h given by h(x) = -x. Here
〈0〉 is a l-cycle, because - 0 = 0, and it is the only 1-cycle (please verify this on
your own). As earlier, the relation h(h(x)) = x is true for every value of x.
Exercises
10.1.1 Verify that 〈0〉 is the only l-cycle. of the function h given by h(x) = -x.
10.1.2 Produce two more 2-cycle functions.
10.1.3 Produce a 2-cycle function k with no fixed points. Here we must have
k(x)≠x    for every x,
but on the other hand,
k(k(x)) = x    for every x.
(Warning: This is a tricky problem !)
10.1.4 Consider a function h defined as follows:
h(x) = 1 -1 x    for x≠0,x≠1.
i. Why is it necessary to impose the two restrictions, x≠0,x≠1?
ii. What cycles are produced by this function? Experiment with a few
numbers and make a guess based on your results. Verify your claim
using simple algebra.
10.1.5 Find the cycle behaviour of the function m defined thus:

m(x) = x x - 1    for x≠0,x≠ - 1.
10.1.6 Repeat the analysis for the function n, where
n(x) = 1 1 - x    for x≠0,x≠ - 1.
The results of these exercises are indeed very curious; we see examples of
cyclical functions with cycle lengths of 2, 3 and 6. How might we go about
finding more such functions?
10.2   Constructing cyclical functions
It can be quite tricky to construct a cyclical function with a specified cycle
length! For instance, how would you construct a function with a cycle length
of 4 or 5? The latter is quite challenging to find if one considers only "nice"
functions, that is, functions defined by simple algebraic expressions.
Here is another example of a 2-cycle function p:
p(x) = x - 1if[x]isodd x + 1 i f [x]i s e v e n .
Here [x] (denoted by int(x) ’ in BASIC and by. floor (x) in other languages) is
the largest integer less than or equal to x. It is referred to by computer science
students as the FLOOR FUNCTION. (Would you consider this a "nice"
function?.)
Example 3.    [5.9] = 5,[8.71] = 8,[-8.71] = -9,[π] = 3.
Remark.    Note that we have defined p by means of a rule rather than
through a formula. Actually, rules and formulas are not very different from
one another! Both in essence tell you what to do with a given input. Indeed, in
mathematics, the words "formula" , "rule" and "algorithm" all convey much
the same meaning.
Here is an example to show how p acts. We.take an input value, say 7.3.
Since [7.3] = 7, which is odd, we have:
p(7.3) = 7.3 - 1 = 6.3,
and since [6.3] = 6, which is even, we have:
p(6.3) = 6.3 + 1 = 7.3.

Thus we have
7.3↦6.3↦7.3,
or:
p ∘ p(7.3) = 7.3,
and this fits in with how we wanted p to ‘behave’.
Exercises
10.2.1 Compute the values of p(3.1),p(-7.3),p(0).
10.2.2 Show that p has no fixed point (i.e., p(x)≠x for all x), but p ∘ p = I.
10.2.3 Find all the values of x for which p(x) = 3.3.
10.2.4 Use the ideas presented above to construct a 5-cycle function f(that is,
we have f ∘ f ∘ f ∘ f ∘ f = I, which may also be written as f(5) = I, but
f≠I).
10.2.5 Show how one can construct an n-cycle function for any given positive
integer n.
10.3    Fractional iterates
An interesting concept that now arises is that of "iterated square root of a
function”. We illustrate the concept with an example.
If f(x) = x - 1, then f(f(x)) = (x - 1) - 1 = x - 2. Writing h(x) = x - 2, we have
f(f(x)) = h(x) for all x, that is:
f ∘ f = h.
Writing f ∘ f as f(2) for short, we have:
f(2) = h.
Thus f can be called an "iterated square root" of h, and we can write f = h(1∕2).
Remark.    It is important not to confuse this notation with the more
common one of squaring a number or expression; that is, with expressions
such as 52 = 25. The notation here refers to an operation being applied twice

over. That is why we have used the notation f(2) and not f2, which could
suggest the squaring operation. However, owing to the possibility of
confusion, we shall not employ this symbolism very often.
Iterated Square Root of a Function  Given a function a that maps R into R if
a function b (also defined on R) exists, such that b ∘ b = a (i.e., b(b(x)) = a(x)
for all values of x), then b is called an iterated square root of a.
Note that we have not said 'the iterated square root’; it is possible for a
function to have more than one iterated square root, or to have no iterated
square root at all.
Example 4.    Let a(x) = 1 1 - x and b(x) = 1 -1 x; then b ∘ b = a.
To see why, we apply the function b twice over:
x↦1 -1 x = x - 1 x ↦1 - x x - 1 = - 1 x - 1 = 1 1 - x = a(x),
so b is indeed an iterated square root of a.
Example 5.    The identity function I(x) = x has as iterated square roots each of
the following functions:
b1(x) = 1 x,b2(x) = 1 - x,b3(x) = -x.
Are there any other iterated square roots of I(x)?
Exercises
10.3.1 Verify the statement made in Example 5, above.
10.3.2 Determine possible iterated square roots for each of the following
functions. Assume that the domain in each case is the set of real
numbers.
i. a(x) = x + 1
ii. a(x) = x + 2
iii. a(x) = 4x
iv. a(x) = 2x
10.3.3 What might be a good definition for "iterated cube root" of a function?

Does the function f, where f(x) = -x, have an iterated cube root?
10.4 Iterated square root of the negative identity function
We now describe a rather tricky procedure for constructing an iterated square
root of the "negative identity" function J(x) given by:
J(x) = -x.
Let the iterated square root be called b. We show below how to compute b(x)
for any given x; this will serve to define b.
1. If x = 0, we assign to b the value 0, that is, b(0) = 0.
2. If x > 0, we find the unique integer n for which
10n ≤ x < 10n+1,
that is, we find the two successive powers of 10 between which x lies. The
value of b(x) is now calculated as shown below:
bx=10xifnis even-x/10ifnis odd.
3. If x < 0, we go through the procedure described above, but with - x in
place of x. That is, we find the unique integer n for which
10-n ≤-x < 10-n+1,
and the value of b(x) is calculated thus:
b(x) = 10x ifniseven - x∕10 if nis odd .
Then b satisfies the relation b(b (x) ) = -x for all x, i.e., b(2) = -I. (Note that
this implies the relation b(4) = I.) To see why, we experiment with a few
numbers.
Example 6.    Let x = 2. Then x > 0; since 100 < 2 < 101 we get n = 0, an even
number; so b(2) = 10 × 2 = 20.
Next, 20 > 0; since 101 < 20< 102 we get n = 1, an odd number; so b(20) =
-20∕10= -2. Therefore b(b(2)) = -2, in agreement with the claim made. Note
the route taken by the initial input of 2:
2↦20↦ - 2.

10.5    Exercises
10.5.1 Show that the function b described abovee satisfies the relation b(b(x))
= -x for all real values of x.
10.5.2 Find iterated square roots for each of the following functions:
i. a(x) = x2; domain: all real numbers.
ii. a(x) = x 2x + 1; domain: all real numbers x≠ -1 2.
iii. a(x) = 1 x; domain: all non-zero real numbers.
10.5.3 Let Z denote the set of integers. Construct a function f from Z into Z
such that f(4)(x) = -x for all x in Z; that is,
f ∘ f ∘ f ∘ f(x) = -xforallx ∈Z.
Comment: The corresponding problem for R rather than Z is much
more difficult.
10.5.4 *  In this problem R refers to the set of real numbers.
Consider the function g with domain R, given by
g(x) = x2 - 2.
Prove that there does not exist any function f from R into R such that
f ∘ f = g,
that is, such that for all real numbers x, we have f(f(x)) = x2 - 2.
This means that g has no iterated square root function if we restrict
ourselves to functions from R into R.
10.5.5 *  In this problem N refers to the set of positive integers.
Consider the function g with domain N, given by
g(n) = n + 1987.
Prove that there does not exist any function f from N into N such that
f ∘ f = g,
i.e., such that for all positive integers n we have f(f(n)) = n + 1987.

This means that g has no iterated square root function if we restrict
ourselves to functions from N into N.
(This problem is from the International Mathematical Olympiad held
in Cuba in 1987.)

Chapter 11
A Miscellany–I
This chapter and the following one present several miscellaneous iterations
and study the rich mathematical patterns which arise from them.
11.1    Appetizers
11.1.1 For each function f listed below, compute the first ten terms of the
sequences 〈x;f〉 produced by the seeds x = 1,x = 2,x = 10. Suggest what
the limiting behaviour of each sequence might be.
i. f(x) = 1 + x 2.
ii. f(x) = 1 + x.
iii. f(x) = 1 + 2x.
iv. f(x) = 1 + 1 x2.
v. f(x) = 1000 + x3.
11.1.2 *  Try proving or disproving the conjectures made above.
11.1.3 The function f that we study in this problem acts on number pairs
rather than single numbers, and its action is as follows:
f(x,y) = y, y + 1 x .
For instance:
f(1,2) = (2,3),f(10,20) = 20,21 20.
To make sure that the arithmetic is “proper”, we impose the following

restrictions on x,y:
x≠0,y≠ - 1.
(To see why the restrictions are needed, compute the orbits of (1,0) and
(1, - 1); what do you find?)
Compute the orbits of the seeds (1, 2), (1, 3), (1, 4) and (1, 5). What do
you find? Based on your observations, formulate a hypothesis, then
check the hypothesis using simple algebra.
11.1.4 Should any additional restrictions be placed on the seed (x,y) to ensure
that no “improper arithmetic” occurs during the iteration? (One
possibility is the condition x,y > 0. This may be too strong, however.)
See if you can find all the necessary restrictions.
11.2 The Collatz iteration
Here is a particularly famous iteration whose peculiarity is that it is easy to
define but extremely difficult to analyse. Its behaviour is so complex that its
cycle structure has yet to be unravelled! The iteration uses the “Collatz”
function C (so-named after Lothar Collatz, the mathematician who first
studied it) which acts on positive integers as follows:
C(x) = x∕2 ifxiseven 3x + 1 if xis odd .
Example 1   .
C(10) = 5, since 10 is even, and C(3) = 10, since 3 is odd.
The orbit 〈10;C〉 is found to be
〈10,5,16,8,4,2,1,4,2,1,4,2,1,…〉.
Observe that we have reached the 3-cycle 〈4,2,1〉.
The orbit 〈23;C〉 is found to be
〈23,70,35,106,53,160,80,40,20,10,5,16,8,4,2,1,4,2,1….〉.
We have reached the very same 3-cycle, 〈4,2,1〉.
If we start with a seed of 47, a surprise is in store for us. The 3-cycle
〈4,2,1〉 is reached yet again, but after a very long time indeed:

〈 47, 142, 71, 214, 107, 322, 161, 484, 242, 121, 364,182, 91, 274,
137, 412, 206, 103, 310,155, 466, 233, 700, 350, 175, 526, 263, 790,
395, 1186, 593, 1790, 890, 445, 1336, 668, 334,167, 502, 251, 754,
377, 1132, 566, 283, 850, 425, 1276, 638, 319, 958, 479, 1438, 719,
2158, 1079, 3238, 1619, 4858, 2429, 7288, 3644, 1822, 911, 2734,
1367, 4102, 2051, 6154, 3077 ,9232, 4616, 2308, 1154, 577, 1732,
866, 433, 1300, 650, 325, 976, 488, 244, 122, 61, 184, 92, 46, 23,
70, 35, 106, 53, 160, 80, 40, 20, 10, 5, 16, 8, 4, 2, 1, 4, 2, 1, 4, 2, 1,
… 〉 (whew!).
How might we go about listing the cycles of the Collatz function? Before
plunging into the investigation, read the following rather surprising news:
The set of cycles of C is not known at the present time!
There is strong numerical evidence, however, that 〈4,2,1〉 is the only cycle,
and moreover that every orbit eventually reaches this cycle. Another way of
expressing this is the following: for any positive integer n, there exists a value
of k > 0 such that
C(k)(n) = 1,
where, of course, C(k) denotes the k-fold iterate of C. For some seeds the
orbit proceeds for millions of terms before reaching the cycle—the situation
can be much ‘worse’ than for 47. As of now, however, no one has found a seed
for which the cycle 〈4, 2, 1 〉 is not reached, nor has anyone proved that this
will always happen.
Exercise
11.2.1 Find the seed number in the set {1, 2, 3, …, 1000} that takes the longest
to reach the cycle 〈4, 2, 1 〉. (Use a computer!)
Brief history of the Collatz problem
The Collatz problem, also known as the “3x + 1” problem, and by other
names too, has acquired great notoriety in the community of mathematicians.
It seems to have first surfaced in the years immediately preceding World War
II, but it was in the 1950s that it grew in fame—possibly because it was

mentioned during a public lecture by the well known geometer H. S. M.
Coxeter; interestingly, he offered a prize of $50 for its first valid proof, and a
prize of $100 for the first counterexample! Needless to say, the prizes have not
been claimed by anyone till now. The great mathematician Paul Erdős is
reported to have made the following comment on the problem: “Mathematics
is not yet ripe enough for such problems.”
Collatz’s cousins
The 3x + 1 problem has a few ‘cousins’—problems which bear a close
resemblance to the Collatz problem but, strangely, are very different with
regard to their intrinsic difficulty. We describe here one such ‘cousin’. Let f be
the function defined on N thus: for x ∈N,
f(x) = x∕2 ifx ≡ 0(mod4), 3x + 1 ifx ≡ 1(mod4), 2x - 1 ifx ≡ 2(mod4), (x +
1)∕4ifx ≡ 3(mod4).
The definition certainly looks rather more complicated than the original one!
Here are two typical orbits produced¯ when we iterate f on N.
〈 11;f 〉 = 〈11,3,1,4,2,3,1,4,2,3,1,…〉,
〈 5;f 〉 = 〈5,16,8,4,2,3,1,4,2,3,1,…〉.
Observe that in both cases we reach the 4-cycle 〈4, 2, 3, 1〉. Further
experimentation suggests that this is the only f-cycle; and, as with the Collatz
iteration, every orbit seems to reach this cycle. This is indeed so, but it is
relatively easy to prove. Here is how we may proceed.
We first check what happens when we iterate f on seeds of the forms 4k,4k
+ 1,4k + 2,4k + 3. We argue as follows.
If x is even, then x is of one of the forms 4k,4k + 2.
If x = 4k, then f(x) = 2k = x∕2.
If x = 4k + 2, then f(x) = 8k + 3, which is of the form 3 (mod4), therefore
f(2)(x) = 8k + 3 + 1 4 = 2k + 1; i.e., f(2)(x) = x 2.
So if x is an even number, then either f(1)(x) = x∕2 or f(2)(x)=x2. That is,
in either one step or in two steps the orbit of xre aches x∕2.

If x is odd, then x is of one of the forms 4k + 1,4k + 3.
If x = 4k + 1, then f(x) = 12k + 4, which is of the form 0(mod4), implying
that
f(2)(x) = f(12k + 4) = 6k + 2,
and since 6k + 2 is an even number we conclude that either f(3)(x) = 3k
+ 1, or f(4)(x) = 3k + 1. (The former happens if 6k + 2 is 0(mod4), the
latter if 6k + 2 ≡ 2(mod4).) So if x = 4k + 1 then in either three steps or
in four steps the orbit of x reaches (3x + 1)∕4.
Finally, if x = 4k + 3 then f(x) = k + 1 = (x + 1)∕4.
It follows from this that the cycles of f may be matched in a one-to-one
manner with the cycles of the following function g which also acts on N: for x
∈N,
g(x) = x∕2 ifx ≡ 0(mod2), (3x + 1)∕4ifx ≡ 1(mod4), (x - 1)∕4 ifx ≡ 2(mod4),
Note the subtle point: f is not the same as g, but lts cycles correspond exactly to
those of g; its long-term behaviour is similar to that of g.
Now we examine the definition of g. It is clear that if x is even or if x ≡
3(mod4) then f(x) < x (the inequality is strict); and if x ≡ 2(mod4), then since
3x + 1 4 ≤ x, with equality only when x = 1,
we have g(x) ≤ x. We deduce from this that 1 is the sole fixed point of f, and
that g(x) < x for all x > 1. The immediate deduction from this is that for any
seed x ∈N, the sequence
x,g(x),g(g(x)),g(g(g(x))),…
strictly decreases till it reaches the fixed point 1, after which it stays constant.
This means that the only cycle of g is the l-cycle ⟨1⟩. This in tum implies that
the only cycle of the original function f is {1,4, 2, 3}. And since every orbit of g
reaches 1, every orbit of f must reach the cycle ⟨ 1, 4, 2, 3⟩. So our conjecture
about the cycles of f is resolved. Indeed, it yielded rather easily to analysis. But
this is not the case with the Collatz iteration.
References

Here are a few references to the Collatz problem.
1. Coxeter, H S M. Cyclic Sequences and Frieze Patterns (The Fourth Felix
Behrend Memorial Lecture), 1970.
2. Gardner, Martin. Mathematical Games, Scientific American, 226 (June
1972) 114–118.
3. Lagarias, J. The 3x + 1 Problem and its Generalizations, American
Mathematical Monthly, Volume 92, Number 1 (January 1985), 3-22.
4. Trigg, C L, Dodge, C W and Meyers, L F. Comments on Problem 133,
Eureka (now Crux Mathematicorum) Volume 2, Number 7 (August-
September 1976), 144-150.
11.3    A two-digit iteration
In this section, we restrict our attention to the set
S = {0,1,2,3,…,98,99}.
The function f that we study has S as its domain and is defined thus: given an
integer n in S, we write n as 10a + b, where a,b are the digits of n (note that a
= 0 for a l-digit number), and then define f(n) to be |a2 - b2|, where || refers to
absolute value.
Example 2.    f(31) = |32 - 12| = 8;f(63) = |62 - 32| = 27;f(7) = |02 - 72| = 49;
etc.
Note that f(n) ∈ S for all n ∈ S (for f(n) < 99 for all n ∈ S; indeed, the
largest value taken by f on S is clearly f(90) = 81), so it makes sense to iterate f
on the set S:. We now proceed to determine the cycles of f, using an idea
which we have not discussed till now.
Computing the cycles of f
We start by computing the range of f, written f(S) for short, by letting f act on
the entire set S and listing the numbers thus produced. The computation can
be done using the following computer program (in BASIC).
REM A Two Digit Iteration

FOR a = 0 to 9
FOR b = 0 to 9
X = 10*a + b : y = ABS (a˄2 - b˄2)
PRINT x, y
NEXT b
NEXT a
The set of y’s is the range we seek. After removing duplicated elements and
sorting the remaining numbers (i.e., arranging them in ascending order), we
obtain the set displayed below.
Range
(f)
=
{0,1,3,4,5,7,8,9,11,12,13,15,16,17,20,21,24,25,27,28,32,33,
35,36,39,40,45,48,49,55,56,60,63,64,65,72,77,80,81}.
This set is f(S); we call it S1 for short. Observe that S1 has fewer elements than
S. (Check: |S| = 100, whereas |S1| = 39.)
We now let f act on S1, list the numbers produced, and once again go
through the exercise of removing duplicated elements and sorting the leftover
numbers. The result is the set S2 = f(S1) displayed below.
S2
=
{0,1,3,4,5,8,9,11,12,16,20,21,24,25,27,35,36,45,48,49,60,63,64,65,72,8
Observe that S2 has fewer elements than S1. (Check: |S2| = 26, whereas |S1| =
39.)
We continue in this manner and compute the sets
S3 = f(S2),S4 = f(S3),S5 = f(S4),....
Initially we observe a steady contraction in size: |S3| = 20,|S4| = 15,|S5| = 12
and |S6| = 10:
S3 = {0,1,3,4,9,11,12,16,20,21,25,27,35,36,45,48,63,64,65,81},
S4 = {0,1,3,4,9,11,16,20,21,27,35,45,48,63,81},

S5 = {0,1,3,4,9,16,27,35,45,48,63,81},
S6 = {0,1,9,16,27,35,45,48,63,81},
S7 = {0,1,9,16,27,35,45,48,63,81}.
But now observe that S7 is identical to S6 in all its elements! This being so, we
do not need to proceed any further; no further ‘contraction’ can possibly take
place. Writing T = S7, we see. that f(T) = T. So T is a “fixed set”.
We now claim that the cycles of f are all to be found within the elements of
T. Therefore to list the cycles of f we only need to list the f-values of all the
elements in T:
Now, by hooking up appropriate pairs of numbers, the cycles of f. are
immediately revealed:
⟨0⟩;⟨1⟩;⟨9,81,63,27,45⟩;⟨16,35⟩;⟨48⟩.
So fhas three l-cycles, a 2-cycle and, surprisingly, a 5-cycle.
Exercises
11.3.1 Why does this technique (illustrated above) “work”? Why does it yield
all the cycles of f?
11.3.2 Try the technique on the function g acting on the set S = {1,2,3,
…,98,99} (the set of positive integers less than 100), and defined t1hus:
if n = 10a + b, where a,b are the digits of n, then
g(n) = |a2 - b2| + |a - b|.
Does it yield all the cycles as promised? (It does !—there are two l-
cycles and one 9-cycle.)
11.4 Amicable numbers
In this section, we dwell briefly on a concept first studied by the Greeks, that
of perfectness of a number. We srm by defining a function D that acts on the

positive integers N thus: D(1) = 1, and if n is greater than 1, then D(n) = the
sum of the proper divisors of n. (We include 1 as a proper divisor; of course,
n itself is not a proper divisor of, itself.) For example,
D(6) = 1 + 2 + 3 = 6,D(10) = 1 + 2 + 5 = 8,D(20) = 1 + 2 + 4 + 5 + 10 = 22.
Let n be called PERFECT if D(n) = n. Thus, 6 is perfect, because D(6) = 6.
Note that our definition would require 1 too to be called perfect, as D(1) = 1;
however, 1 is not ordinarily regarded as perfect, and we follow this
convention.
The Greeks were intrigued by the idea of perfectness, and Euclid’s great
book, THE ELEMENTS, has the following very pretty result:
Let P be a prime number of the form 2k - 1,⋅ then the number 1 2P(P +
1) is perfect.
The proof is given in the book, and in an elegant form!
In modem times, primes of the form 2k - 1 have come to be known as
Mersenne primes, after the French monk Father Marin Mersenne (1588–
1648; he was also a number theorist!). It is easy to give examples of such
primes, and of the perfect numbers associated with them:
a. k = 2 yields the Mersenne prime P = 3 and the perfect number 3 × 2 = 6.
b. k = 3 yields the Mersenne prime P = 7 and the perfect number 7 × 4 = 28
(a quick check: 28 has as divisors the numbers 1, 2, 4, 7 and 14; and 1 + 2
+ 4 + 7 + 14 = 28).
c. k = 5 yields the Mersenne prime P = 31 and the perfect number 3 1 × 16
= 496. (Please verify for yourself that 496 is perfect.)
Note that for 2k - 1 to be prime, k itself must be prime (but, unfortunately,
this condition does not suffice).
From perfectness to amicability; ibn Qorrah’s rule
If we iterate the sum-of-proper-divisors function, D, on the natural numbers
N, then the l-cycles correspond to the perfect numbers. Are there larger
cycles? The Greeks had an amusing term for pairs of numbers that form a 2-

cycle: they called them an AMICABLE PAIR, because the sum of the proper
divisors of each number is equal to the other number. Pythagoras went so far
as to declare that friends ought to relate to one another in the same manner
that amicable numbers do! The example quoted by the Greeks w as the pair
{220, 284}:
D(220) = 1 + 2 + 4 + 5 + 10 + 11 + 22 + 44 + 55 + 110 = 284,
D(284) = 1 + 2 + 4 + 71 + 142 = 220.
This was probably the only example the Greeks had of amicable numbers, and
it was left to future generations of mathematicians to list more such pairs. The
great mathematician Leonhard Euler (1707-1783; the name is pronounced as
“Oiler”) listed no less than sixty pairs! The Arabian mathematician ibn
Qorrah gave the following elegant rule to determine further pairs of amicable
numbers:
Let n ∈N be such that the three numbers
a = 3 ⋅ 2n - 1,b = 2a + 1,c = ab + a + b
are all prime; let M = 2n+1 ab, N = 2n+1c. Then {M,N} is an amicable
pair.
Example 3.    With n = 1, we obtain a = 5,b = 11,c = 71, and these all happen
to be prime. These give M = 4 × 55 = 220,N = 4 × 71 = 284, and we obtain the
amicable pair {220, 284} listed above.
Example 4.    With n = 2, we obtain a = 11,b = 23,c = 287, but 287 is not
prime (287 = 7 × 41), so we get nothing here.
Example 5.    With n = 3, we obtain a = 23,b = 47,c = 1151, and these are once
again all prime. These give M = 16 × 1081 = 17296,N = 16 × 1151 = 18416,
and we obtain the amicable pair {17296, 18416}.
Checking for amicability
To check that ⟨17296, 18416⟩ is a 2-cycle would seem tedious, but the task is
simplified greatly by using the following rule. Let n = pa × qb × rc ×⋯. where
p,q,r, . . . are the distinct primes that divide n, and a,b,c are positive integers.
Let

P = 1 + p + p2 + p3 + ⋯ + pa,
Q = 1 + q + q2 + q3 + ⋯ + qb,
R = 1 + r + r2 + r3 + ⋯ + rc,
and so on. Then D(n) = (P × Q × R ×⋯) - n.
Example 6    To compute D(1728), observe that the prime factorization of
1728 is given by 1728 = 123 = 26 × 33. We now have:
P = 1 + 2 + 22 + ⋯ + 26 = 127,
Q = 1 + 3 + 32 + 33 + 34 = 121,
therefore D(1728) = (127 × 121) - 1728 = 1 3639.
We are now in a position to verify that ⟨17296, 18416⟩ is a 2-cycle. Since
17296 = 24 × 23 × 47 and 18416 = 24 × 1151, we obtain:
D(17296) = (31 × 24 × 48) - 17296 = 18416,
D(18416) = (31 × 1152) - 18416 = 17296,
and the verification is complete.
Unfortunately there are not too many values of n for which the numbers
a,b,c as given by ibn Qorrah are all prime. A computer search conducted for
values of n below 100 reveals that the only successful values are n = 1,3 and 6.
We have already listed the amicable pairs produced by n = 1 and 3; the one
corresponding to n = 6 is {9363584, 9437056}.
Searching for more 2-cycles
Searching for 2-cycles empirically is not easy, but the technique presented in
the last section (Two digit ireration”) suggests a way out. We define a
function a that operates on sets and is computed thus. Let X be a set of
positive integers. We first compute D(X), the set of D-values of the integers in
X. For example,
D({6,10.20}) = {6,8,22};
D({10,20,30,40}) = {8,22,42,50}.
The set a(X) is now computed as follows:

a(X) = D(X) ∩ X.
Example 7.    To compute a(T), where
T = {1,2,3,4,5,6,7,8,9,10},
we first compute D(T); we get:
D(T) = {1,3,4,6,7,8}
(the duplicates have been removed). Since D(T) is a subset of T, we get D(T)
∩ T = D(T), and so
a(T) = {1,3,4,6,7,8}.
As usual, we define a(2) = a ∘ a,a(3) = a ∘ a ∘ a,… ; that is, a(k) is the kth
iterate of a. ( a(1) is the same as a.) If we iterate a on T, here is what we find:
a(1)(T) = {1,3,4,6,7,8},
a(2)(T) = {1,3,6,7},
a(3)(T) = {1,6},
a(4)(T) = {1,6}.
Since no change has occurred at the last step, that is, a(3)(T) = a(4)(T), it
follows that a({1,6}) = {1,6}. This means that each element in the set {1, 6} is
part of a cycle. We already know this to be true, since D(1) = 1,D(6) = 6.
So the trick is to iterate a on a very large set, and check whether after a
suitable number of iterations we obtain a set which remains unchanged after
action by a; in other words, a “D-invariant set” (one which undergoes no
change when D acts on it). This is excessively. tedious to do by hand, but
easily accomplished by using a computer algebra package such
asMATHEMATICA. We start with the set
{ 1, 2, 3 , 4, …, 99999, 100000 } ,
and apply a repeatedly. MATHEMATICA ultimately yields the following
invariant set S:
{1, 6, 28, 220, 284, 496, 1184, 1210, 2620, 2924, 5020, 5564, 6232, 6368,
8128, 10744, 10856, 12285, 12496, 14264, 14288, 14536, 14595, 15472,
17296, 18416, 63020, 66928, 66992, 67095, 69615, 71145, 76084,

79750, 87633, 88730 } .
We may infer now that each element of S is pan of a cycle; and indeed, we do
find cycles in abundance! There are five l-cycles, corresponding to 1 and to
the perfect numbers 6, 28, 496 and 8128. Next, there are numerous 2-cycles,
and these correspond to pairs of amicable numbers:
{220, 284}, {1184, 1210}, {5564, 5020},
{6232, 6368}, {10744, 10856}, {12285, 14595},
{17296, 18416}, {63020, 76084}, {66928, 66992},
{67095, 71145}, {69615, 87633}, {79750, 88730}.
There is even a 5-cycle!—
⟨12496,14288,15472,14536,14264⟩.
Note that no 3-cycle or 4-cycle has, been found; perhaps we need to sm with a
much larger set (say all the integers from 1 till 106) in order to find such
cycles.
Exercises
11.4.1 What are the integers n for which D(n) = 1?
11.4.2 Verify that the rule for computing D(n) yields the correct values for n
= 10,20,30,40 and 50.
11.4.3 Why does the rule work?
11.4.4 Define the terms abundant and deficient thus: if D(n) exceeds n, then n
is ‘abundant’, and if D(n) is less than n, then n is ‘deficient’.
Show that if n is abundant, then so is use this to conclude that the
number of abundant integers is infinite.
11.4.5 Are there any integers n for which D(n) = 2?
11.4.6 Prove Euclid’s assertion: if P is a prime number of the form 2k - 1, then
P(P + 1)∕2 is perfect.
11.4.7 Prove the following stronger assertion, due to Euler.
Every even perfect number is of the from 1 2P(P + 1) where P is a

mersenne prime, i.e., a prime number of the from 2k - 1.
The two results (Euclid’s and Euler’s) acting in tandem show that there
is a one-to-one correspondence between the Mersenne primes and the
even perfect numbers.
11.4.8 Verify that {6232, 6368} is an amicable pair.
11.4.9 Verify that {9363584, 9437056} is amicable. You will need the
following factorizations:
a. 9363584 = 2 7 × 191 × 383;
b. 9437056 = 27 × 73727.
11.4.10 Prove ibn Qorrah’s claim: that the pair {2n+1ab,2n+1c} is amicable if
the three numbers a = 3 ⋅ 2n - 1,b = 2a + 1 and c = ab + a + b are all
primes.
Proof.    We give the proof here, but you should try the problem on your own
before reading on. We shall establish somewhat more.
Let M = 2kab and N = 2kc, where k is non-negative and a,b,c are odd primes
with a≠b. We seek conditions on k,a,b,c that make {M,N} an amicable pair.
Using the rule given earlier, we obtain:
D(M) = 2k+ṉ - 1(a + 1)(b + 1) - 2kab,
D(N) = 2k+1 - 1(c + 1) - 2kC .
Therefore the relations D(M) = N,D(N) = M hold if and only if
2k+1 - 1(a + 1)(b + 1) = 2k(ab + c),
2k+1 - 1(c + 1) = 2k(ab + c).
From these we deduce that c + 1 = (a + 1)(b + 1), that is, c = ab + a + b. This
condition is forced on us. Assuming that this holds, we see that {M,N} is
amicable if and only if
2k+1 - 1(a + 1)(b + 1) = 2k(2ab + a + b).
After a bit of manipulation, this simplifies to:

❑
ab - 1 a + b + 2 = 2k - 1.
So if we find prime numbers a,b and c = ab + a + b for which this holds, then
we obtain the amicable pair {2kab,2kc⋅}.
Progress, is achieved by imposing an extra condition: b = 2a + 1. We then get
a + b + 2 = 3(a + 1) and ab - 1 = a(2a + 1) - 1 = 2a2 + a - 1, which factorizes:
2a2 + a - 1 = (2a - 1)(a + 1).
The factor (a + 1) cancels out, and we obtain (2a - 1)∕3 = 2k - 1, which further
simplifies to
a = 3 ⋅ 2k-1 - 1.
Thus we seek positive integers k such that a = 3 ⋅ 2k-1 - 1,b = 2a + 1 and c =
ab + a + b are all prime. This is just ibn Qorrah’s rule.
11.5    The Fibonacci sequence
Let a function f be defined thus for non-zero real numbers:
f(x) = 1 + 1 x,
and consider the orbit ⟨1;f⟩. The computations are done as shown below:
f(1) = 1 + 1 1 = 2 1,
f 2 1 = 1 + 1 2 = 3 2,
f 3 2 = 1 + 2 3 = 5 3,
and so on. Continuing the calculations, we obtain the orbit shown below:
1 1, 2 1, 3 2,5 3,8 5,13 8 ,21 13,34 21 ,55 34,89 55,144 89 ,233 144, 377 233,….
Note that the numerator of each fraction is the denominator of the next
fraction. Do you see why this happens?
If we list down the sequence of denominators of these fractions, here is
what we obtain:
⟨1,1,2,3,5,8,13,21,34,55,89,144,…⟩.
This is called the FIBONACCI SEQUENCE; it is perhaps the most famous
sequence in all of mathematics! Its defining property is that after the first two

terms, each term is the sum of the two terms preceding it. If we denote the
nth term of the Fibonacci sequence by Fn, then the sequence may be defined
thus: F1 = 1,F2 = 1, and
Fn = Fn-1 + Fn-2 for n > 2.
Using this notation the figures given above may be displayed in tabular form
thus:
The name ‘Fibonacci sequence’ honours the Italian mathematician
Fibonacci (1170–1250), also known as ‘Leonardo of Pisa’, who introduced the
sequence in a problem concerning the breeding of rabbits. (If we assume that
the rabbits breed according to a certain definite rule, then the number of
rabbits during each epoch turns out to be a Fibonacci number.) Fibonacci’s
great achievement was the writing of an extremely influential book called the
LIBER ABACI in which he introduced the Hindu-Arabic place value system of
numeration to the rest of Europe. Indeed, he described its working in great
detail, resulting in the gradual adoption of the system by the community at
large. (This turned out to have major consequences.) Fibonacci lived in pre-
Renaissance times, and his work was one of the strands that led to the
Renaissance.
If you study the Fibonacci sequence very closely, you will soon discover
what makes it so special—its patterns are so numerous that they could occupy
entire books! There are very few sequences that are so rich in patterns, or
which arise in so many different ways in so many varied branches of
mathematics. We give below a small sample of these patterns.
A. Let a, b, c be any three consecutive Fibonacci numbers; then b2 - ac is
equal to ± 1. 
For example, for the triple (5,8,13), with a = 5,b = 8 and c = 13, we get b2
- ac = 82 - 5 ⋅ 13 = 84 - 65 = -1.
B. Let a,b,c,d be any four consecutive Fibonacci numbers; then ad - bc is
always equal to ± 1. 
For example, for the quadruple (8,13,21,34), with a = 8,b = 13,c = 21 and

d = 34, we get ad - bc = 272 - 273 = -1.
C. Let a,b,c be any two consecutive Fibonacci numbers; then a2 + b2 is itself
a Fibonacci number. 
For example, from the pair (3,5) we obtain 32 + 52 = 9 + 25 = 34, and
from the pair (8,13) we obtain 82 + 132 = 64 + 169 = 233; both 34 and
233 are Fibonacci numbers.
D. Let a,b,c be any three consecutive Fibonacci numbers; then c2 - a2 is
itself a Fibonacci number. 
For example, from the triple (3, 5, 8) we obtain 82 - 32 = 55, and from
(5,8,13) we obtain 1 32 - 52 = 144; both 55 and 144 are Fibonacci
numbers.
E. Let a,b,c,d be any four consecutive Fibonacci numbers, and let x = ad, y
= 2bc,z = x2 + y2. Then z is an integer—and a Fibonacci number at that.
(As a by-product, we obtain a “Pythagorean triple”—i.e., an integer triple
(x,y,z) such that x2 + y2 = z2.) 
For example, from the quadruple (2, 3, 5, 8) we obtain
x = 16,y = 30,z = 256 + 900 = 34;
and from (3,5,8,13) we obtain
x = 39,y = 80,z = 1521 + 6400 = 89.
Observe that both 34 and 89 are Fibonacci numbers.
F. Let a and b be any two Fibonacci numbers; then their gcd is itself a
Fibonacci number. Indeed, we find the following remarkable
relationship:
gcd(Fm,Fn) = Fgcd(m,n).
For example, let m = 12 and n = 18; then gcd(m,n) = 6. Next,
F12 = 144 = 24 × 32,F 18 = 2584 = 23 × 17 × 19.
Therefore, gcd(F12,F18) = 23 = 8. And, indeed, we have F6 = 8.
G. Instead of writing the original sequence as a sequence of fractions, i.e., as
1 1,2 1,3 2,5 3,8 5,13 8 ,21 13,34 21,55 34,…,

we write it as a sequence of decimal fractions:
⟨1,2,1.5,1.67,1.6,1.625,1.615,1.619,…⟩.
In this form, it visibly has a limit, and calculations give its value as
roughly 1.618. Alongside the Fibonacci sequence, this number too
occupies a very prominent place in the “Mathematical Hall of Fame”; it
is the Golden Ratio, and it has been known since Greek times.
In the Parthenon building, a part of the Acropolis complex built more
than two thousand years ago near present-day Athens, the length to
height ratio is just this number. The Greeks considered the ratio to be
very pleasing to the eye and the best for aesthetic appearances.
Interestingly, so did the Renaissance genius Leonardo da Vinci (who was
a scientist, engineer, painter and sculptor all in one!); looking through
his notebooks one finds rough sketches of various figures (e.g., the
human body, the human hand, the form of a horse), each framed by a
rectangle of this shape.
The Golden Ratio can be found in ‘closed-form'—i.e., expressed in terms
of known quantities; it turns out to be equal to 1 2(5 + 1).
H. The orbit listed above,
1 1,2 1,3 2, 5 3,8 5,13 8 ,21 13,34 21,55 34,89 55,…
was obtained from the seed x = 1. What happens if we use other seeds?
Clearly x = 2 will give the same limiting ratio. (Why?) Experiment with
other seeds: x = 3,x = 4,x = 5….. What do you notice?
You may not find it easy to prove the properties listed above, as the
proofs typically need a technique of proof known as “proof by
induction:’ which you may not know at this stage. Do try, however—you
may come up with new proofs! Try also to discover more such
properties—there are surely many more waiting to be discovered.
11.6    A route to square roots
In the previous section, we used the function
f(x) = 1 + 1 x = x + 1 x .

The function g we use now looks similar, but the results are quite different:
g(x) = 1 + 1 x + 1 = x + 2 x + 1.
Here is the orbit ⟨1;g⟩:
1 1,3 2,7 5,17 12,41 29,99 70,239 169,577 408,….
As with the Fibonacci sequence, this sequence has many pretty properties
hidden within it, all waiting to be discovered! Here are a few for you to
examine.
A. Consider the sequence of numerators:
⟨1,3,7,17,41,99,239,…⟩.
If a,b,c are any three consecutive numbers of this sequence, then a + 2b =
c and b2 - ac = ±2.
For example, for the triple (a,b,c) = (17,41,99) we have:
a + 2b = 17 + (2 × 41) = 99 = c,
b2 - ac = 1681 - 1683 = -2.
B. Consider now the sequence of denominators:
1,2,5,12,29,70,169,408,….
Amazingly, very similar properties hold for this sequence! That is, if
a,b,c are any three consecutive numbers of the sequence, then
a + 2b = c and b2 - ac = ±1.
For example, for the triple (12, 29, 70) we have:
a + 2b = 12 + (2 × 29) = 70 = c,
b2 - ac = 292 - (12 × 70) = 841 - 840 = 1.
C. Next, let a∕b be any fraction of the original sequence (a and b are positive
integers); then:
a2 - 2b2 = ±1.
For example, for the fractions 17/12 and 4ṉ∕29,

172 - (2 × 122) = 289 - 288 = +1,
412 - (2 × 292) = 1681 - 1682 = -1.
D. As in the earlier exercise, we express the terms of the original sequence,
1 1,3 2,7 5,17 12, 41 29,99 70,239 169,577 408,1393 985 ,…
as decimal fractions, and obtain:
⟨1,1.5,1.4,1.42,1.414,1.4143,1.4142…⟩,
in which form it is seen quite visibly to have a limit. You may be
astonished to learn that the limit is 2 (approximate value: 1.41421356). Is
this not a wonderful discovery?
Try to find out why these properties hold. (In other words, prove them!)
You may need to use the “Method of Induction” referred to earlier.
⋆ ⋆ ⋆ ⋆ ⋆ ⋆ ⋆ ⋆ ⋆ ⋆ ⋆ ⋆ ⋆ ⋆ ⋆ ⋆ ⋆ ⋆ ⋆
You may have noticed the curious commonality of properties of the
sequences studied in this and the previous section. What lies behind this
commonality? Try to find out its hidden cause. In pursuing the investigation,
you may want to investigate other such sequences, for instance, those arising
from functions such as:
f1(x) = 3x + 1 x + 1 ,f2(x) = 5x + 1 x + 1 ,f3(x) = x + 3 x + 1,
and so on.
11.7     More on square roots
In this section we discuss two ways of computing square roots. The first one is
the traditional ‘long division’ algorithm (not too well known these days,
unfortunately!). The second one uses a curious and elegant relationship
between the geometric mean of two numbers and their arithmetic and
harmonic means.
The long-division method for computing square roots
We work throughout in base-10. Let the square root of an integer N be

required (N > 0). Suppose that I ≤N < I + 1 for some non-negative integer I.
Let k be the first digit in the decimal part of N; then N = I.k…, with more
digits to come after the 'k'. We assume that I can be easily found via
inspection; we now wish to find k. Once it is found, the digit following 'k' can
be found by working with the number 100N instead of N (for the square root
of 100N will be of the form Ik.m … for some digit m).
Now the statement that N = I.k… means that
I + k 10 ≤N < I + k + 1 10 ,
or (equivalently) that 10I + k ≤ 10N < 10I + (k + 1). By squaring we now get:
100I2 + 20Ik + k2 ≤ N < 100I2 + 20I(k + 1) + (k + 1)2,
∴ k(20I + k) ≤ 100(N - I2) < (k + 1)(20I + k + 1).
Therefore, k is the largest with the property that k(20I + k) ≤ 100(N - I2). This
characterization allows us to find k. Once it is known, the same step can be
done again to find the next digit following k, and so on.
Example 8.    Say we wish to compute 150. Let N = 150. Then 122 < N < 132,
so I = 12 and N - I2 = 6. We must now compute the largest digit k for which
k(240 + k) ≤ 600. We easily find that k = 2 (since 2 × 242 = 484 < 600,
whereas 3 × 243 > 600). Therefore, 150 = 12.2….
Now we set N = 15000. We have just found out that 1222 ≤ N < 1232; so I =
122. This gives N - I2 = 15000 - 1222 = 116, so 100(N - I2) = 11600. We must
now compute the largest digit k for which k(2440 + k) ≤ 11600. We easily find
that k = 4; this is so because 4 × 2444 < 1 1600, whereas 5 × 2445 > 11600. So
15000 = 122.4…, ∴150 = 12.24…. We may continue in this manner and find
as many decimal digits as desired; we get 150 = 12.2474....
The reader should compute a few square roots by this method, say 200 and
250.
Remark.    The reader may wonder whether there is any similar algorithm for
computing cube roots; i.e., of the “long-division” type. There is; readers
familiar with ‘Vedic mathematics’ may recall studying such algorithms.
However, they are much more complicated to work through than the
algorithm for square roots.

Square roots via the arithmetic and harmonic means
Another curious iterative method for the computation of square roots is the
following.
Given two positive numbers a and b, we associate three kinds of means
with them—the arithmetic mean (AM), geometric mean (GM) and harmonic
mean (HM), defined as follows:
AM = a + b 2 , GM = ab, HM = 2ab a + b.
Note that the HM of a list of numbers is the reciprocal of the AM of their
reciprocals.
So if a = 1 and b = 9 then AM = 5, GM = 3, HM = 1.8. .Observe that HM <
GM < AM. It tums out that if a and b are unequal, then these inequalities
always hold. (If a = b then all three means coincide.) It is easy to show
algebraically why this is so. The inequality HM < GM, i.e.,
2ab a + b < ab,
can be written after some simplification as
a + b 2 > ab,    or    AM > GM,
and this may in tum be written, after squaring and simplifying, as
a2 + 2ab + b2 > 4ab,    or    a2 - 2ab + b2 > 0.
But this is clearly true, as a2 - 2ab + b2 = (a - b)2, and a non-zero square is
always positive.
⋆ ⋆ ⋆ ⋆ ⋆ ⋆ ⋆ ⋆ ⋆ ⋆ ⋆ ⋆ ⋆ ⋆ ⋆ ⋆ ⋆ ⋆ ⋆
The computations of the AM and HM involve only RATIONAL
OPERATIONS (addition, subtraction, multiplication and division), whereas
computation of the GM involves a square root (considered to be a non-
rational operation). Rather curiously, we may zero in on the GM by
computing only AMs and HMs, as follows. Given two positive numbers a and
b, say with a < b, we define the pairs (a0,b0),(a1,b1),(a2,b2),… thus: a0 = a,b0
= b, and for all i ≥ 0,ai+1 = HM of ai and bi, and bi+1 = AM of ai and bi. Note
that the scheme is iterative in nature; at each step, we use only the preceding
pair of numbers.

It will be found that the gap between ai and bi steadily decreases, and at
quite a rapid rate too; and “in the limit” both ai and bi tend to the common
value ab, i.e., to the GM.
Example 9.    Let a=1 and b = 9. The computations are displayed as follows.
Observe that a5 and b5 are practically the same.
⋆ ⋆ ⋆ ⋆ ⋆ ⋆ ⋆ ⋆ ⋆ ⋆ ⋆ ⋆ ⋆ ⋆ ⋆ ⋆ ⋆ ⋆ ⋆
To prove that ai and bi get steadily closer to ab as i gets larger and larger,
we argue as follows. Since
a1 = 2ab a + b,b1 = a + b 2 ,
we get a1 × b1 = a × b. Since a2,b2 are defined in terms of a1,b1 in the same
way as a1,b1 are defined in terms of a,b we similarly get a2 × b2 = a1 × b1.
Extending this result in the obvious way, we see that
ai × bi = a × b    for all n.
So the product ai × bi is an INVARIANT; it stays the same all through the
iteration.
Now consider the difference b1 - a1; we have
b1 - a1 = a + b 2 - 2ab a + b
= (a + b)2 - 4ab 2(a + b)
= b - a 2 ⋅b - a b + a.
Since (b - a)∕(b + a) is non-negative and less than 1, we get:
0 ≤ b1 - a1 < b - a 2 .
Similarly we get 0 ≤ b2 - a2 < (b1 - a1)∕2, and therefore

0 ≤ b2 - a2 < b - a 4 .
In general we have 0 ≤ bi - ai < (b - a)∕2i. Since 2i grows without bound as i
increases, we conclude that “in the limit”, ai and bi become equal; and as their
product is ab, it follows that each of the limiting values is ab, i.e., the GM.
A graphical approach
The argument followed above has a nice graphical interpretation. Let n = ab,
and consider the curve whose equation is xy = n, i.e., y = n∕x (see Figure 11.1).
Of relevance to us is the portion of the curve which lies in the first quadrant.
Note that the point P0 with coordinates (a,b) lies on the curve. Let Q0 be the
point with coordinates (b,b); then Q0 lies to the right of P since b > a.
Let P0Q1 be the normal from P0 to the line y = x; the foot of the normal
has coordinates
a + b 2 ,a + b 2 .
Let the horizontal line through Q1 meet the curve at P1. Then P1 has
coordinates
2ab a + b′a + b 2 .
The movement from P0 to P1 is taken to be the first round of the iteration. We
now continue the iteration and get a sequence of points P0,P1,P2,… on the
curve, and Q0,Q1,Q2,… on the line y = x.
Let the line Q1P1 be extended beyond P1 to R, where it meets the line x =
a; then R has coordinates (a,(a + b)∕2). It is clear via similar triangles that RQ1
= P0Q0∕2; also, P1Q1 < RQ1; therefore we get
P1Q1 < P0Q0 2 .
Similarly we get P2Q2 < P1Q1∕2, and so P2Q2 < P0Q0∕4; and so on. So the gap
between Pi and Qi decreases rapidly, and “in the limit” Pi and Qi coincide.
The point of coincidence is the point where the curve xy = n and the line y = x
meet in the first quadrant—the point (n,n).
⋆ ⋆ ⋆ ⋆ ⋆ ⋆ ⋆ ⋆ ⋆ ⋆ ⋆ ⋆ ⋆ ⋆ ⋆ ⋆ ⋆ ⋆ ⋆
So to compute n for some given positive number n, we compute the pairs

(a0,b0),(a1,b1),(a2,b2),…, where
a0= l, b0= n; and for i ≥ 0,
ai+1 = HM of {ai, bi}, bi+1= AM of {ai, bi}.
Figure 11.1.    Square roots via the arithmetic mean and harmonic mean
A few iterations will suffice to yield a fairly accurate value of n.
The arithmetic-geometric mean
We have just seen how the GM of two positive numbers a and b may be
estimated via repeated AM-HM computations. So we might say that the
geometric mean is an arithmetic-harmonic mean, or GM = AHM.
What happens if, instead, we do repeated computations of AM and GM? In

other words, given two positive numbers a and b, if we define a0 = a,b0 = b,
and for i ≥ 0,
ai+1 = GM of {ai,bi},bi+1 = AM of {ai,bj},
what can be said about the pairs (ai,bi) as i increases? Computationally we
find that the gap between ai and bi decreases at a very rapid rate. For instance
here is the result when a = 1 and b = 9:
It is quite easy to show that as i grows without limit, the numbers ai and bi
approach some common limiting value. This number is the arithmetic -
geometric mean (AGM) of a and b; we write it as AGM (a,b). So AGM (1, 9)
is approximately 3.936.
In the case of the arithmetic-harmonic mean we obtained a very simple and
neat result: the arithmetic-harmonic mean is the same as the geometric mean.
But no such simple result holds for the AGM. On the contrary, the following
most surprising equality holds (a knowledge of calculus is needed to even
understand the statement!): if a,b > 0 then
AGM (a,b) = π2∫0π/2(a2cos2θ+b2sin2θ)-1/2dθ .
The result is due to the “prince of mathematicians”, Karl Friedrich Gauss.
There is, unfortunately, no question of proving it here. The reader is referred
to B Sury’s article, The Arithmetico-Geometric Mean of Gauss, in the journal
RESONANCE (August 2000).
11.8    Cube roots
The ideas developed in the preceding section may be extended quite easily to
the case of cube roots. The function governing the iteration needs only a
small modification. Thus, given two positive numbers a and b, we define the

pairs (ai,bi) for i ≥ 0 thus: a0 = a,b0 = b, and for i ≥ 0,
ai+1 = ai + bi 2 ,bi+1 = . ab ((ai + bi)∕2)2.
Example 10.    Let a = 1 and b = 8; the pairs (ai,bi) then take the following
values.
Observe that as i increases, ai and bi both approach 2. However the rate at
which the common value of 2 is approached is not as impressive as in the case
of square roots. In the general case, as i increases without limit, ai and bi both
approach the cube root of a2b.
⋆ ⋆ ⋆ ⋆ ⋆ ⋆ ⋆ ⋆ ⋆ ⋆ ⋆ ⋆ ⋆ ⋆ ⋆ ⋆ ⋆ ⋆ ⋆
As earlier, this iteration admits of a nice graphical interpretation; see
Figure 11.2. Let a2b = n. We consider the curve y = n∕x2; then the point P0 =
(a,b) lies on the curve. We now locate points Q0,P1,Q1,P2,…, in that order, as
follows: Q0 is the foot of the normal from P0 to the line y = x;P1 is the point
on the curve ‘vertically’ below Q0 (so its x-coordinate is the same as that of
Q0) ;Q1 is the foot of the normal from P1 to the line y = x;P2 is the point on
the curve vertically below Q1;…. It will be seen (and to prove this is easy) that
the points P1,P2,P3, ... approach the point of intersection of the line y = x and
the curve y = n∕x2, i.e., the point with coordinates (n1∕3,n1∕3).

Figure 11.2.    Cube roots via iteration
Extension to higher roots
Having seen how cube roots can be computed, the extension to higher roots is
immediate. Let k ≥ 2 be a fixed integer. Given two positive numbers a and b,
we compute the pairs (ai,bi) for i ≥ 0 thus: a0 = a,b0 = b, and for i ≥ 0,
ai+1 = ai + bi 2 ,bi+1 = ak-1b ((ai + bi)∕2)k-1.
As i grows without bound, the numbers ai and bi begin to approach a
common limit whose value is
ak-ṉb1∕k
The graphical interpretation is clear: we work on the curve y = n∕xk-1 where n
= ak-1b. As the iteration progresses, we approach the point of intersection of

the curve and the line y = x.
So by setting a = 1 and b = n we can estimate the kth root of n. Note
however that for large values of k, the speed at which the values converge to
the answer is not too impressive.
Remark.    We shall see in Volume II that the procedures described above are
special cases of the Newton-Raphson method, also known as Newton’s method,
as applied to the computation of square roots and cube roots. This is an
algorithm of great utility in solving equations numerically (as different from
solving them in “closed form”).

Chapter 12
A Miscellany–II
In this chapter we meet another mixed bag of iterations.
12.1   SP numbers
In the March 1999 issue of THE MATHEMATICAL GAZETTE, in an interesting
article titled “SP Numbers”, the author defines a positive integer n to be a SP
number if it equals the product of the sum of its digits and the product of its
digits (with the number written in base-10). For example, 1 is trivially a SP
number,and so are 135 and 144, because:
135 = (1 + 3 + 5) × (1 × 3 × 5),
144 = (1 + 4 + 4) × (1 × 4 × 4).
Are there any other SP numbers? The author shows that these are (surprise!)
the only SP numbers. A companion article in the same issue establishes the
same conclusion in a different manner.
Our purpose here will be study the problem through some of the
machinery developed earlier. We define a function SP which acts on positive
integers via their base-10 representation, as follows:
SP (n) = sum of digits of n× product of digits of n.
The problem then is to find the fixed points of SP. We may ask, more
generally, for the cycle structure of SP.
We first show that if n has more than 85 digits, then SP (n) < n; that is,
if n > 1084, then SP (n) < n.

Proof.    Denote by k the number of digits that n has; then
10k-1 ≤ n < 10k.
Now note that (a) the sum of the digits of n cannot exceed 9k, and (b) the
product of the digits of n cannot exceed 9k. (These limits are attained only
when n is of the form 999... 99.) Therefore:
SP (n) ≤ 9k × 9k.
We shall now show that if k ≥ 85, then 9k × 9k < 10k-1. With this established,
it will follow that if k ≥ 85, then SP (n) < 10k-1 and therefore that SP (n) < n.
Claim.    If k ≥ 85then-9k × 9k < 10k-1.
Proof.    The inequality to be proved may be written in the form 90k × 9k <
10k, which we rewrite as (10∕9)k > 90k, So we must establish the following:
If k ≥ 85, then 1 k 10 9 k > 90.
Let the function f be defined on N by.
f(k) = 1 k 10 9 k
Then f(1) ≈ 1.111,f(2) ≈ 0.6173,f(3) ≈ 0.4572, and so on. Now consider the
quantity f (k + 1)∕f(k). We get, after some computation:
f(k + 1) f(k) = k k + 1 ×10 9 = 10k 9k + 9.
For the quantity 10k∕(9k + 9) to be more than 1 we must have 10k > 9k + 9, or
k > 9. So if k > 9 then f(k + 1) > f(k). In other words, the sequence
f(10),f(11),f(l2),f(13),f(14),...
steadily increases.
Using the computer we now construct the following table of data.
The ‘strict increase’ can be visibly seen in the table. Observe that f(85) > 90. It
follows that if k > 85, then f(k) > 90. In other word, f(k) greater than 90 for k ≥
85, and therefore 9k × 9k < 10k-1.fork ≥ 85. This implies, as pointed out
earlier, that if n > 1084, then SP (n) < n.

The implication of this is that all SP-fixed points can be found among the
integers below 1084. This may not seem too helpful a result!—but it does
provide a starting point.
Remark.    The upper bound of 1084 can be brought down to 1060 without
too much effort.
⋆ ⋆ ⋆ ⋆ ⋆ ⋆ ⋆ ⋆ ⋆ ⋆ ⋆ ⋆ ⋆ ⋆ ⋆ ⋆ ⋆ ⋆ ⋆
To make progress, we allow the function SP to act on sets (and not merely
on single numbers), and define a function g which acts as follows: if X is any
set of numbers, then
g(X) = SP(X) ∩ X.
Example 1.    Let X = {11,12,13,14,15}. Then
SP(X) = {2,6,12,20,30},g(X) = {};
so g(X) = ∅, the empty set.
If we iterate the function g on the set
1,2,3,…,1084 - 1,
then ultimately we will obtain all the fixed points and all the cycles of SP.
Unfortunately the set is much too large, and even with a powerful computer
we will not make appreciable progress.
The result of iterating g on the set S, where
S = {1,2,3,…,197,198,199},
is shown in Table 12.1. For convenience we write g(m) to mean that g is
applied m times in a row; thus
g(2)(X) = g(g(X)),g(3)(X) = g(g(g(X))),
and so on ( g(1) is the same as g).
Since g(8)(S) = g(7)(S), it follows that {1, 135, 144} is an SP-invariant set,
implying that each of its elements is part of a cycle.This agrees with what we
already know; indeed, 1, 135 and 144 are fixed points.
Completing the search

The analysis at this stage gets a bit complicated, and we shall only quote some
results from the two articles referred to above, where various conditions are
shown to hold for any SP number. Specifically, denoting the sum of the digits
of n by S, the product of the digits by P, and the number of digits of n by k,
the following are established.
Table 12.1. Result of iterating on {1,2,…,198,199}
a. Since no digit of n is 0, and the prime numbers below 10 are 2, 3, 5 and
7, p must be of the form 2a × 3b × 7d or 3b × 5 × 7d.
b. If 3 is a divisor of P. then 3 is a divisor of n too, ∴ 3 is a divisor of S,
making 9 a divisor of n and therefore of S as well.
c. If 3 is a divisor of P, then S ≥ 9k - 27 (the proof of this is quite involved,
but the result obviously simplifies the search very greatly).
d. From the preceding results we see that there are only six cases to
consider: (i) S = 9k (ii) S = 9k - 9 (iii) S = 9k - 18 (iv) S = 9k - 27 (v) P =
2a × 7d (vi) P = 5c × 7d. 
It is shown that there are no SP numbers with S = 9k; at most 1056 SP
numbers with S = 9k - 9; at most 6480 SP numbers with S = 9k - 18; at

most 16786 SP numbers with S = 9k - 27; at most 4848 SP numbers with
P = 2a × 7d; and precisely one SP number with P = 5c × 7d, namely n =
1.
The potential candidates are now small in number. and a computer search
becomes feasible (the number of candidates to be tested is of the order of a
hundred thousand. and nothing like 1060, which would make the task
hopeless). After a relatively short length of time the computer produces a list
of all SP numbers. The list turns out to be rather small (perhaps
disappointingly so!)—it has just the numbers 1,135 and 144.
Table 12.2.   Result of iterating b on {1,2,3,…,99,100}
Remark. Unfortunately, this analysis reveals nothing about any higher order
cycles of SP (even whether they exist).
What about S+P numbers?
Much the same analysis can be conducted for what we may call the “S + P”
function. Write S(n) for the sum of the digits, and P(n) for the product of the
digits of n (with n written in base-10), and let a(n) = S(n) + P(n). What can be

said about the cycle structure of a?
Define a function b which acts on sets of numbers thus: b(X) = a(X) ∩ X
(we allow a too to act on sets of numbers). If we iterate b on the set S of
integers below 100, we obtain Table 12.2.
Observe that b(4)(S) = b(5)(S). This means that something interesting may
be found in the a-invariant set T, where
T = {1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16,
17, 18, 19, 29, 39, 49, 59, 69, 79, 89, 99}.
By computing the a-value of each number in T, we find that n = a(n) (i.e., n =
S(n) + P(n) ) for
n ∈{19,29,39,49,59,69,79,89,99}.
This, then, is the list of fixed points of a. Amazingly, we find that the other
elements in T are pm of a single cycle! So we obtain an 18-cycle:
1,2,4,8,16,13,7,14,9,18,17,15,11,3,6,12,5,10.
Whew!
Curiously, the cycle displayed above is identical to the cycle of remainders
of the powers of 2 (mod 19). That is, if we compute the remainders when we
divide the numbers
20,21,22,23,...,215,216,217
by 19, we obtain exactly the same numbers as those listed above, and in the
very same order. A pretty coincidence?—not quite! The reader is invited to
inquire further.
And what about S-squared plus P-squared numbers?
We could go on in this vein in and ask whether there are any numbers n such
that
n = S(n)2 + P(n)2.
It appears that there is only one such integer, namely 41. But we leave the
analysis to the reader. (The author’s computer search revealed precisely one

fixed point and no higher-order cycles.)
12.2    The SSQ iteration revisited
In Chapter 5 we studied the SSQ iteration,
n↦ sum of the squares of the base ten digits of n.
Here is more material about this iteration, taken from an interesting article by
Alan Beardon in the November 1998 issue of THE MATHEMATICAL GAZETTE.
The author generalizes the function to cover different number bases by
defining the function FB to act on N as follows: if the number n has the base-
B expansion
n = a0 + a1B + a2B2 + ⋯ + a rBr,
where the aj (the digits of n in base B) satisfy the condition 0 ≥ aj ≤ B - 1 and
ar > 0, then
FB(n) = a02 + a 12 + a 22 + ⋯ + a r2.
Thus SSQ is identical to F10.
Happy numbers and sad numbers
Observe that 1 is a fixed point for each FB. The author defines a number n to
be happy if by iterating FB on n we ultimately reach 1; i.e., if FB(k)(n) = 1 for
some number k. If it gets trapped in a cycle of length greater than 1, then n is
said to be sad.
For the case B = 10 we had found earlier that there is just one fixed point
(1), and that every number is either happy or sad. What can be said for other
bases? Is it true that every number is either happy or sad no matter what base
we choose? For which base does it happen that 1 is the sole fixed point? Is
there a base for which there are precisely two fixed points? (The answer: no.)
The author uncovers a great deal of curious facts of this kind.
An easy result for base 2
The author prefaces his analysis with the following easy result: In base 2, every
number is happy. This holds because in base 2, each aj is 0 or 1, resulting in

the pleasing identity aj2 = aj for all j. Now consider a number n > 1. Then r ≥
1, so 2r > 1, and therefore
F2(n) = a02 + a 12 + a 22 + ⋯ + a r2
= a0 + a1 + a2 + ⋯ + ar
< a0 + a1 ⋅ 2 + a2 ⋅ 22 + ⋯ + a r ⋅ 2r = n.
So F2(n) < n for all n > 1, implying that for n > 1, the sequence
n,F2(n),F2(F2(n)),F2(F2(F2(n))),...
decreases strictly till 1 is reached (which must necessarily happen), after
which no more changes can happen. So every n reaches 1 under repeated
iteration.
Some isolated facts
Here are a few isolated facts concerning the maps FB for B = 3,4,5,7 and 20.
The case B = 3. The map F3 has three fixed points (1, 5 and 8), and one
2-cycle (〈2,4〉). 
Verification. To check that 5 is a fixed point, observe that 5 = (12)3 and
that 12 + 22 = 5; and to check that 〈2,4〉 is a 2-cycle, observe that 2 =
(2)3 and 4 = (11)3, therefore we get
2↦22 = 4↦12 + 12 = 2.
The case B = 4. The map F4 has one fixed point 1, and no cycles.
The case B = 5. The map F5 has three fixed points (1, 13 and 18), and one
3-cycle (〈4,16,10〉).
Verification. 13 = (23)5, so F5(13) = 22 + 32 = 13. For the 3-cycle,
observe that 4 = (4)5,16 = (31)5 and 10 = (20)5, and that 42 = 16,32 + 12
= 10,22 = 4.
The case B = 7. The map F7 has five fixed points (1, 10, 25, 32 and 45),
and two 4-cycles (〈2,4,16,8〉 and 〈17,13,37,29〉).
The verification is left to the reader.
The case B = 20. The map F20 has just one fixed point (1), and one 26-

cycle.
The author now proceeds to make some sense of these facts, and to find a
general approach that knits them together.
Various claims
Let n be, in base B, a number with r digits, i.e.,
n = a0 + a1B + a2B2 + ⋯ + a r-1Br-1
with 0 ≤ aj ≤ B - 1 and ar-1 > 0. The author proceeds to establish the following
results concerning the fixed points of FB. In each statement n refers to a
positive number written in base B.
Claim 1. Suppose that n has at least four digits; then FB(n) has fewer digits
than n. In other words, if n ≥ B3, then FB(n) < n.
Claim 2. If n has at most three digits, then so does FB(n).
Claim 3. The cycles of FB all consist of numbers with at most three digits.
In other words, the following set contains all the cycles of FB:
{1,2,3,⋯,B3 - 1}
This result may be substantially improved, yielding Claim 4.
Claim 4. The following set contains all the cycles of FB:
{1,2,3,...,2B2 - 1}.
When applied to the case B = 10 (corresponding to our original SSQ
iteration), the result implies that the cycles of SSQ all lie in the set {1, 2,3,
…,199 } . And indeed this is so: there is just one fixed point 1, and one 8-cycle
〈4,16,37,58,89,145,42,20〉,
whose entries all lie below 199.
Claim 5. If n is a fixed point of FB and n > 1, then n is a two digit number; that
is,
n ∈{B,B + 1,B + 2,...,B2 - 1}.

This result quickly yields a practical method for finding all the fixed points of
FB: we simply have to consider all n of the form a + bB with a,b ∈{0,1,2,…,B
- 1}, and check whether or not a2 + b2 = a + bB.
⋆ ⋆ ⋆ ⋆ ⋆ ⋆ ⋆ ⋆ ⋆ ⋆ ⋆ ⋆ ⋆ ⋆ ⋆ ⋆ ⋆ ⋆ ⋆
In fact the result implies a great deal more. The relation a2 + b2 = a + bB may
be written as
4a2 - 4a + 4b2 - 4bB = 0,
and then as
2a - 12 + 2b - B2 = 1 + B2.
This means that each fixed point of FB yields an expression for 1 + B2 as a sum
of two squares, and conversely. What a surprising revelation!
For example, consider B = 10 (this corresponds to the original SSQ
iteration). Then 1 + B2 = 101, and there is just one way of writing 101 as a
sum of two squares:
101 = 1 + J00 = 12 + 102.
Allowing for signs, we get:
101 = (±1)2 + (±10)2.
Examining the equation (2a - 1)2 + (2b - B)2 = 1 + B2, we arrive at the
following possibilities:
2a - 1 = ±1,2b - 10 = ±10,
2a - 1 = ±10.2b - 10 = ±1.
The second possibility does not yield anything (2a - 1 must be an odd
number, and so cannot equal ± 10). Since a.b ∈{0.1,2,…,9}, the first
possibility yields a = 0 or 1, and b = 0. This corresponds to the fixed points 0
and 1. (Generally do not list 0 as a fixed point, because 0∈N.)
Or consider the case B = 7, with 1 + B2 = 50. There are two ways of writing
50 as a sum of two squares:
50 = 12 + 72 = 52 + 52.

Allowing for signs, we get the following representations:
50 = (±1)2 + (±7)2 = (±5)2 + (±5)2.
Examining the equation (2a - 1)2 + (2b - B)2 = 1 + B2, we arrive at the
following possibilities:
2a - 1 = ±7,2b - 7 = ±1;
2a - 1 = ±1,2b - 7 = ±7;
2a - 1 = ±5,2b - 7 = ±5.
Solving these equations, and keeping in mind the restriction a,b ∈{0,1,
…,5,6}, we obtain the five fixed points of F7, namely: 1, 10, 25, 32 and 45.
Claim 6. If 1 + B2 is prime, then the map FB has just one fixed point.
Conversely, if FB has just one fixed point, then 1 + B2 is prime.
This happens when B = 2,4,6 and 10; and for many more values of B. In
each of these instances, the only fixed point of FB is 1.
Remark. It is conjectured that there are infinitely many values of B for which
1 + B2 is prime; but no proof has yet been found! Here is a list of values of B
below 100 for which 1 + B2 is prime:
2,4,6,10,14,16,20,24,26,36,40,54,56,66,74,84,90,94.
Claim 7. The number of fixed points FB is odd.
In fact much more can be said; for example:
the number of fixed points of FB is 3 precisely when 1 + B2 is a product
of two distinct primes (i.e., B is of the form p × q for distinct primes p
and q; this happens, for example, when B = 3 or B = 5);
the number of fixed points of FB is 5 precisely when 1 + B2 is of the form
p × q2 for distinct primes p and q (this happens, for example, when B =
7; then we get 1 + B2 = 50 = 2 × 52).
The reader is urged to read the original article for the proofs of these
interesting results.

12.3    Averages
The iteration discussed here may vaguely remind you of the four-number
iteration. It too is done on TUPLES of numbers: triples, quadruples, 5-tuples,
6-tuples, etc.; more generally, on n-tuples. The iteration involves nothing
more complicated than computing averages, but the results hold some pretty
surprises.
For ease of description, we describe what to do in the case of a quadruple.
Say we are given a starting quadruple (a,x0,y0,b). As the iteration proceeds,
the first and last members of the quadruple stay the same, whereas the second
and third change repeatedly. Write (a,xn,yn,b) for the quadruple at the nth
stage; then we have the following rule:
xn+1 = a + yn 2 ,yn+1 = xn + b 2 .
That is, xn+1 is the simple arithmetic average of a and yn, and yn+1 is the
simple arithmetic average of b and xn. The iteration may therefore be written
as follows:
(a,xn,yn,b)↦ a,a + yn 2 , xn + b 2 ,d.
We do the averaging repeatedly; what happens?
The above description referred to quadruples. For 5-tuples, we have
(a,xn,yn,zn,b)↦ a,a + yn 2 , xn + zn 2 , yn + b 2 ,b,
and similarly for higher order tuples. The rule is: the first and last entries
always stay the same; for the other entries, replace each one by the simple
arithmetic average of its immediate neighbours.
Examples
A few examples will show how the averaging works.
Example 2.    We work with triples here. Let the starting triple be (2, 1, 10); we
get:
(2,1,10)↦(2,6,10)↦(2,6,10)↦(2,6,10)↦⋯.
We have zeroed in on a fixed point in a single step! It is easy to see that this

will happen regardless of which triple we start with. Indeed we have:
(a,x0,b)↦(a,a + b 2 ,b)↦(a,a + b 2 ,b)↦⋯.
The choice of x0 here has no relevance at all. Note that any triple of the form
(a,(a + b)∕2,b) is a fixed point; so there are infinitely many fixed points.
This example has not yielded any surprises, but if we increase the number
of entries, then things become a lot more interesting.
Example 3.    Now we work with quadruples. Starting with (2,1,7,11), we get
the following sequence of quadruples (read it from left to right, top to
bottom):
(2, 1, 7, 11),
(2.0, 4.0, 7.75, 11.0),
(2.0, 4.7 5, 7.937, 11.0),
(2.0, 4.937, 7.984, 11.0),
(2.0, 4.984, 7.996, 11.0),
(2.0, 4.996, 7.999, 11.0),
(2.0, 4.999, 8.0, 11.0),
(2.0, 5.0, 9.0, 11.0),
(2.0, 4.5, 6.0, 11.0),
(2.0, 4.875, 7.5, 11.0),
(2.0, 4.969, 7.975, 11.0),
(2.0, 4.992, 7.969, 11.0),
(2,0, 4.998, 7.992, 11.0),
(2.0, 5.0, 7.999, 11.0),
(2.0, 5.0, 9.0, 11.0),
…
We have reached a fixed point: the quadruple (2, 5, 8, 11).
Example 4.    The starting quadruple is (3,0,5,24). We get:
(3, 0, 5, 24),
(3.0, 7.5, 14.0, 24.0),
(3.0, 9.375, 16.25, 24.0),
(3.0, 9.844, 16.81, 24.0),
(3.0, 9.961, 16.95, 24.0),
(3.0, 9.99, 16.99, 24.0),
(3.0, 9.998, 17 .0, 24.0),
(3.0, 9.999, 17 .0, 24.0),
(3.0, 10.0, 17.0, 24.0),
(3.0, 4.0, 12.0, 24.0),
(3.0, 8.5, 15.75, 24.0),
(3.0, 9.625, 16.69, 24.0),
(3.0, 9.906, 16.92, 24,0),
(3.0, 9.977, 16.98, 24.0),
(3.0, 9.994, 17.0, 24.0),
(3.0, 9.999, 17.0, 24.0),
(3.0, 10.0, 17.0, 24.0),
…

We have reached the fixed point (3, 10, 17, 24).
Example 5.    The starting quadruple is (0,0,0,75). We get:
(0, 0, 0, 75),
(0, 18.75, 37.5, 75.0),
(0, 23.4, 46.97, 75.0),
(0, 24.61, 49.22, 75.0),
(0, 24.9, 49.9, 75.0),
(0, 24.98, 49.95, 75.0),
(0, 24.99, 49.99, 75.0),
(0, 25.0, 50.0, 75.0),
(0, 25.0, 50.0, 75.0),
(0, 0, 37.5, 75.0),
(0, 18.75, 46.97, 75.0),
(0, 23.4, 49.22, 75.0),
(0, 24.61, 49.9, 75.0),
(0, 24.9, 49.95, 75.0),
(0, 24.98, 49.99, 75.0),
(0, 24.99, 50.0, 75.0),
(0, 25.0, 50.0, 75.0),
…
We have reached the fixed point (0,25,50,75).
Remark.   In each of the above examples there is convergence to a quadruple
whose entries increase by fixed amounts from the first number to the last
number; i.e., a quadruple whose entries form an A.P. (arithmetic progression).
Does this always happen?
Example 6.    We now work with 5-tuples.with (1,1,11,7,21) as the seed, we
get:
(1, 1, 11, 7, 21),
(1.0, 2.5, 11.0, 12.5, 21.0),
(1.0, 4.25, 11.0, 14.25, 2 1.0),
(1.0, 5.125, 11.0, 15. 12, 21.0),
(1.0, 5.562, I I .0, 15.56, 21 .0) ,
(1.0, 5.781, 11.0, 15.78, 21.0),
(1.0, 5.891, 11.0, 15.89, 21.0),
(1.0, 5.945, 11.0, 15.95, 21.0),
(1.0, 5.973, 11.0, 15.97, 21.0),
(1.0, 5.986, 11.0, 15.99, 21.0),
(1.0, 5.993, 11.0, 15.99, 21.0),
(1.0, 6.0, 4.0, 16.0, 21.0),
(1.0, 6.0, 7 .5, 16.0, 21.0),
(1.0, 6.0, 9.25, 16.0,21.0),
(1.0, 6.0, 10.12, 16.0, 21.0),
(1.0, 6.0, 10.56, 16.0, 21.0),
(1.0, 6.0, 10.78, 16.0, 21.0),
(1.0, 6.0, 10.89, 16.0, 21.0),
(1.0, 6.0, 10.95, 16.0, 21.0),
(1.0, 6.0, 10.97, 16.0, 21.0),
(1.0, 6.0, 10.99, 16.0, 21.0),
(1.0, 6.0, 10.99, 16.0, 21.0),

(1.0, 5.997, 11.0, 16.0, 21.0),
(1.0, 5.998, 11.0, 16.0, 21.0),
(1.0, 5.999, 11.0, 16.0, 21.0),
(1.0, 6.0, 11.0, 16.0, 21.0),
(1.0, 6.0, 11.0, 16.0, 21.0),
(1.0, 6.0, 11.0, 16.0, 21.0),
(1.0, 6.0, 11.0, 16.0, 21.0),
…
We have reached the fixed point (1, 6, 11, 16, 21). Observe that the entries are
yet again in A.P.
Conclusion
In each instance we find convergence to a tuple whose entries are in A.P. So if
the seed is the n-tuple (a,x0,y0,…,b) then, writing d = (b - a)∕(n - 1), the orbit
appears in each case to converge to the tuple
(a,a + d,a + 2d,…,a + (n - 2)d,b),
whose ith entry is a + (i - 1)d.
The reader is invited to investigate the matter further.
Project work
Instead of working with tuples, what if we work with MATRICES? The
averaging now takes place in a higher dimension; given a matrix, we replace
each element by the simple average of its immediate neighbours, with
“neighbourliness” defined as follows: two elements are neighbours if they
share the same row and lie in adjacent columns, or if they lie in the same
column and lie in adjacent rows. Thus, for a matrix A, the elements ai,j and
ar,s are neighbours if either i = r and j - s = ±1, or if j = s and i - r = ±1. (Stated
more compactly: elements ai,j and ar,s are neighbours precisely when (i - r)2
+ (j - s)2 = 1. ) Observe that comer elements have two neighbours, border
elements not lying at a comer have three neighbours, and “interior”elements
have four neighbours.
Another possibility is: the comer elements could be left as they are,
unchanged, and the averaging is done only for the remaining elements. There
are clearly many such possibilities. Each would give rise to its own iteration.

Will we find the same behaviour as in the one-dimensional case? That is,
will we find convergence to a matrix whose entries form an A.P in some
sense? This question could form the basis for an interesting project. The
reader is urged to investigate the matter further.
Remark. Various physical models can be connected with this iteration;
e.g.,the numbers in the matrix could be the temperatures at various points of
a conducting plate, and the averaging process could be a representation of the
way in which the temperature equalizes itself through heat exchange.

Chapter 13
Geometric Iterations
13.1   Introduction
In this chapter the focus of study, which till now has been confined to
arithmetic and algebra, shifts to geometry. We start by giving a few
illustrations that show how iterations arise in geometry.
Reflections.  Let f denote reflection in a line ℓ (so that ℓ acts like a mirror).
Then f ∘ f = I, because two successive reflections in the same line take us right
back to the starting point; here I denotes the identity operation, which in
geometry means “do nothing, let the point stay where it is”. So reflection in a
line is a 2-cycle function.
Half-turns.  Let H denote a half-turn (a rotation through 180∘) about a fixed
point O; then H ∘ H = I (for two successive half-turns about the same point
are equivalent to a 360∘ turn and therefore to the identity map I). So a half-
turn too is a 2-cycle function.
On the other hand, two successive half-turns about two distinct points, P and
Q, are equivalent to a displacement through the vector 2PQ⃗.
More generally, if θ is any angle (θ≠0∘,θ≠360∘) then the effect of two
successive rotations f,g, with f centered at P and through an angle θ, and g
centered at Q and through an angle –θ, is a displacement. This fact comes of
use when we have to move heavy furniture!
Quarter-turns. Let Q denote a quarter-turn about a fixed, point O; then Q ∘
Q = H and Q(4) = H ∘ H = I. Here we have an example of a 4-cycle function.
An identity involving half-turns. For any quadrilateral ABCD, let P,Q,R,S be

the midpoints of the sides AB,BC,CD,DA respectivey. Then we have the
curious relation
HP ∘ HQ ∘ HR ∘ HS = I.
i.e., HP ∘ HQ ∘ HR ∘ HS(X) = X for all points X.
Frieze patterns. Here is an illustration from art. Let a design ℬ (a “motif”) be
selected, and let the sequence 〈ℬ;f〉 be sketched for some appropriate
function f. This simple action can result in rich geometrical patterns,
depending on the choice of ℬ and f. Many of the famous artifacts of Islamic
art (e.g., those found in the Alhambra fortress in Granada, Spain, or in parts
of the Islamic world) can be studied and appreciated from this perspective.
We give an example of such a sequence. Choose the motif to be the clubs
symbol, ♣, and let f be, ‘move the motif one unit to the right’. Then the
sequence 〈♣;f〉 is an infinite strip:
⋯♣♣♣♣♣♣♣♣♣⋯
Designs of this type are known as frieze patterns, and they are often seen on
temple walls, saree borders, pullovers, and so on.
Wall-paper patterns and crystals.    The idea of a repeating one-dimensional
pattern can easily be extended to two dimensions, resulting in wall-paper
patterns. The three-dimension version of this is obviously a crystal; here a
structure gets repeated in some definite manner in three dimensions. Other
objects not typically referred to as crystals may possess such repetitive
structures; for example, the DNA double helix, and in general other spiral
forms that occur in nature.
We now study a few iterations involving geometric themes; en route we
shall discover some pretty mathematics!
13.2    Perpendiculars
Let △ABC be acute-angled, and let P0 be a point on BC. We locate another
point P1 on BC (i.e., on the same side) by dropping perpendiculars as follows:
P0Q, from P0 to AB; QR, from Q to CA; and then RP1, from R back to BC.
The position of P1 clearly depends on that of P0, so we write P1 = f(P0),
where f is a function that ‘acts’ on the points on line BC, permuting them

amongst themselves (see Figure 13.1). We regard the movement from P0 to
P1 as the first round of an iteration.
We now repeat this sequence of actions: we drop perpendiculars in turn to
AB, to CA, to BC,…, and obtain the points
P2 = f(P1),P3 = f(P2),P4 = f(P3),....
Figure 13.1.   After 1 round
Figure 13.2.   After 2 rounds
with the points P2,P3,P4,… all lying on BC. Figure 13.2 shows the path taken
during the first two rounds of the iteration.
After a few.iterations, we notice something curious—the path starts to close
in on itself. More precisely, the path converges to a triangular path inscribed
in △ABC. Note that this means that the sequence of points 〈P0,P1,P2,P3,…〉
tends to some limiting position on BC. Figure 13.3 displays the limiting path

as an inscribed triangle (shown in a thick line). Observe that the inscribed
triangle is similar to the original triangle (its sides are perpendicular to the
sides of the original triangle, so the angles of the two triangles have the same
measures; this explains the similarity).
It is natural to ask what happens when we change the position of P.
Experimentation reveals that we reach the very same inscribed triangle each
time! Figure 13.4 shows the path followed for another choice of P.
You may wonder what happens if the foot of the perpendicular lies not on
the side on which it is dropped, but on its extension. The answer is that it
does not matter. In Figure 13.5 the choice of figure is such that for the first
few iterations, the feet of the perpendiculars lie on the extensions of the sides.
After a few iterations, however, the situation “corrects” itself: the feet of the
perpendiculars once again lie upon the sides, and we reach the very same
inscribed triangle.
⋆ ⋆ ⋆ ⋆ ⋆ ⋆ ⋆ ⋆ ⋆ ⋆ ⋆ ⋆ ⋆ ⋆ ⋆ ⋆ ⋆ ⋆ ⋆
Till now our iteration has followed a clockwise direction: we dropped a
perpendicular first to AB, then to CA, then to BC,…. But we could also opt
for an anticlockwise direction, dropping a perpendicular first to CA, then to
AB, then to BC,…. What happens if we do it this way?
Figure 13.3.   Limiting path–1

Figure 13.4.   Limiting path–2
Figure 13.5.   Starting from a “wrong point”
Figure 13.6.   

Figure 13.7.  
Not surprisingly, we reach an inscribed triangle yet again; but, most
pleasingly, the triangle turns out to be congruent to (and yet distinct from)
the one got earlier! (See Figure 13.6.)
A surprising connection
An examination of the figure reveals that corresponding sides of these two
triangles are parallel to one another (this owes to the perpendicularity
relations noted earlier). Pairs of such objects are said to be homothetic to one
another. If we draw the joins of corresponding pairs of points belonging to
homothetic figures, the joins meet in a point called the homothetic center of
the two figures. For example, an enlargement mapping yields pairs of
homothetic figures, and the center of homothety is simply the center of the
enlargement. A half-turn also yields pairs of homothetic figures, and the
center of homothety in this case is the center or “pivot” of the half-turn ; it
bisects the joins of corresponding pairs of points. (Comment: A half-turn is
the same as an enlargement with scale factor equal to –1. Note that a half-turn
is the only homothety in which the input figure is congruent to the output
figure.)
In the current example the two figures are congruent to one another, so the
homothety is a half-turn . The homothetic center turn s out to be a “known”
point— it is the symmedian point of the triangle. The point is constructively
defined as follows: we locate G, the centroid of the triangle, draw the medians
GA,GB and. GC, then reflect them, respectively, in the lines internally

bisecting the angles at A,B and C. The reflected segments are known as
symmedians, and they meet in the symmedian point of the triangle.
Another way of finding the same point is as follows: draw the circumcircle
of triangle ABC, then draw tangents to the circle at A,B and C. Let the triangle
enclosed by the tangents be XY Z, with the vertices labelled so that X is
opposite A (i.e., the tangents at B and C meet at X), Y is opposite B and Z is
opposite C; then the lines AX, BY and CZ meet in the symmedian point.
Exercises
13.2.1  Prove that the inscribed triangle referred to above is similar to the
original triangle.
13.2.2   What happens if the original triangle is right-angled? How many
iterations are needed in this case to reach the limiting path?
13.2.3  What happens if the original triangle is obtuse-angled?
13.2.4  What happens if we work with a convex quadrilateral instead of a
triangle?
13.2.5  Prove that the sequence
〈P,f(P),f(f(P)),...,〉
converges to a limiting point, which moreover is the same for all points
P on BC. (Hint: Use trigonometry to find the distances from B to the
sequence of iterates of P.)
Explanations
We now justify the claim made that the two inscribed triangles obtained “in
the limit” above are congruent and homothetic to one another, the center of
homothety being the symmedian point. Our proof will be based on
computation.
We note firstly that the sides of the inscribed triangles are respectively
perpendicular, in some order, to the sides of the parent triangle, implying that
each triangle is similar to the parent triangle. Therefore, the two triangles are
similar to one another; and homothetic too, as their sides are parallel to one

another.
In Figure 13.8, the two inscribed triangles are labelled A′B′C′ and A″B″C″,
respectively; for convenience, we refer to them as T′ and T″, respectively, and
to △ABC as T. The labelling of T′ and T″ has been done in the obvious
manner, to draw attention to their similarity (note how their angles
correspond to one another). Thus we have angle equalities such as
∠B′A′C′ = ∠BAC = ∠B″A″C″,∠A′B′C′ = ∠ABC = ∠A″B″C″
and so on.
Figure 13.8.   Study of the two homothetic triangles
We first show that triangles T′ and T″ are congruent to one another. Write
a′,b′,c′ for the sides of T′, and a″,b″,c” for the sides of T″. Using elementary
trigonometry we obtain the following relations:
a = BC = BB′ + B′C = c′ sinB + a′ tanC′
b = AC = AC′ + C′C = b′ tanA + a′ sinC,
c = AB = AA′ + A′B = b′ sinA + c′ tanB.
The relations may be displayed in matrix form thus:
cotC 0 cscBcscC cotA0 0 cscAcotB ⋅a′ b′ c′ = a b c .

Using well known formulas such as
cosA = b2 + c2 - a2 2bc ,sinA = a 2R,
where R is the radius of the circumcircle of the triangle, and doing a bit of
simplification, the equations take the form shown below (here Δ = abc∕4R
denotes the area of the triangle):
1 4Δ⋅a2 + b2 - c2 0 2ca 2ab b2 + c2 - a2 0 0 2bc c2 + a2 - b2 ⋅a′ b′ c′ = ab c
The equations may be solved for a′,b′,c′, and we get a most pleasing result:
a′ b′ c′ = 4Δ a2 + b2 + c2⋅ab c
Using the (certainly not too well known!) fact that
4Δ a2 + b2 + c2 = tanω,
where ω is the Brocard angle of the triangle, we may write this as
a′ b′ c′ = tanω⋅ab c
The symmetry of the result tells us immediately that the very same equations
will be obtained for a″,b″,c″. It follows that a′ = a″,b′ = b″ and c′ = c″, and
the congruence of the two inscribed triangles follows.
As segments B″C″ and C′B′ are congruent and parallel to one another,
their center of homothety, K, lies at the center of rectangle B″C″B′C′. This
means in particular that the perpendicular distance of K from side BC is
1 2a′ = 1 2tanω ⋅ a = ka,    where k = 1 2tanω.
We find similarly that the distances of K from sides CA and AB are kb and kc
respectively. The ratios of the distances of K from the sides BC,CA,AB are
therefore as a : b : c. But this is precisely the property which characterizes the
symmedian point! The claim we made earlier therefore stands justified.
13.3   Angle bisectors
The iteration we study next deals with angle bisectors. We start by defining
the relevant terms.
Incenter of a Triangle  The internal angle bisectors of a triangle meet in a
point—the incenter of the triangle, or the center of the circle that fits snug

within the triangle. The circle is the incircle of the triangle. (To see why the
bisectors meet in a point, use the fact that each point on an angle bisector is
equidistant from the two arms of the angle; see Figure 13.9.)
Figure 13.9.   
Figure 13.10.  
The iteration
Let A,B,C be three distinct points on a circle Γ, and let △ABC be called T0;
this triangle will serve as the seed of the iteration. Let the angle bisectors of T0
be drawn. and let them be extended beyond the sides of the triangle to meet
the circle Γ. Let T1 be the triangle whose vertices are the three points of
intersection so formed. (See Figure 13.10; the angle bisectors are shown in a
dotted line; T1 is △A′B′C′. )

Take the actions done so far to be one round of an iteration f; that is, take
T1 = f(T0) to be the output produced with T0 as input. Let T2,T3,… be
computed as follows:
T2 = f(T1),T3 = f(T2),T4 = f(T3),....
(Thus, to get T3 from T2, the angle bisectors of T2 are drawn and extended
till they meet Γ. The three points of intersection are the vertices of T3; and so
on.) What happens now? Figures 13.11 and 13.12 show the results of the
iteration after 5 and 10 rounds respectively.
Observations
An interesting fact emerges when we examine these sketches: as we continue
the iterations, the triangles start to look more and more equilateral in shape,
and this happens regardless of the shape of the original triangle. Figures 13.13
shows the result of 10 rounds of the iteration using a differently shaped
triangle as seed; the original triangle is shown in a light line and the final
triangle in a thick line.
Figure 13.11.   After 5 rounds

Figure 13.12.   After 10 rounds
Note that the triangle itself does not stay fixed: T100 is distinct from T101,
but they are both close to being equilateral. But T100 and T102 are “almost”
the same triangle (they very nearly coincide), and likewise for T101 and T103.
Analysis
To see why convergence takes place, we compute the angles of T1 and check
whether they are closer to one another than the angles of T0. This is easy to
do.
In Figure 13.14, T0 is △ABC and T1 is △DEF. We compute the angles of
T1 in terms of the angles of T0, using the well known theorem concerning
“angles in the same segment.” (If P,Q are points on an arc XY of a circle, then
∠XPY = ∠XQY. ) We argue as follows. We have, ∠FDE = ∠FDA +
∠ADE. Next,
∠FDA = ∠FCA = C 2 ,∠ADE = ∠ABE = B 2 ,
therefore ∠FDE = 1 2(B + C) = 90 -1 2A. Similarly we get, ∠FED = 90 -1 2B
and ∠DFE = 90 -1 2C. Therefore the angles of △DEF are
90∘-A 2 ,90∘-B 2 ,90∘-C 2 .
(Check that the angle sum is 180∘.) So we have an iteration on triples that acts
as follows:
(x,y,z)↦ 90 -x 2,90 -y 2,90 -y 2.

Figure 13.13.   A different T0
Figure 13.14.   Angle computations
Consider the function f given by f(x) = 90 -1 2x. Let any number x0 be
chosen, and let its f-orbit 〈x0;f〉 be computed. Does the sequence converge to
a limit? We do a few trials to find out.
x0 = 20 60.31,59.84,… The sequence produced is: 20, 80, 50, 65, 57.5,
61.25, 59.38,
x0 = 40 60.16,59.92,… The sequence produced is: 40, 70, 55, 62.5, 58.75,
60.63, 59.69,
x0 = 5 59.14,60.43,59.78,… The sequence produced is: 5, 87.5, 46.25,
66.88, 56.56, 61.72,
The figures clearly suggest that regardless of the seed chosen, the sequence

converges to a limiting value of 60. Indeed this is so, and the exercise set
below asks you to find a proof. As the iteration is the same for each angle of
the triangle, it follows that each angle converges to 60∘, and so the triangles
do indeed converge to an equilateral shape.
Degree of ‘non-equilateralness’ of a triangle
Here is one way (the exercise set asks you to find another way!) of showing
that the f-orbit of any starting number converges to a limiting value of 60. We
have already seen that if T0 has angles x∘,y∘,z∘, then T1 has angles
90 -x 2∘, 90 -y 2∘, 90 -z 2∘
Consider the differences between the angles of T0; they are
|x - y|∘,|y - z|∘ and |z - x|∘
respectively. In the case of T1, the differences come out to be
|x - y|∘ 2 , |y - z|∘ 2 and |z - x|∘ 2 ,
respectively. So the differences have all been halved.
Given any triangle, the extent to which it is not equilateral can be measured; it
seems reasonable, surely, to describe a triangle with angles of 55∘,60∘,65∘ as
“closer to being equilateral” than one with angles of 10∘,60∘,110∘. Given a
triangle T with angles α,β,γ, a possible index for measuring how close it is to
being equilateral is the quantity δ (T) given by
δ(T ) = |α - β| + |β - γ| + |γ - α|.
Observe that δ ≥ 0 for all triangles, and moreover that δ(T ) = 0 if and only if
α = β = γ; that is, if and only if T is equilateral.
In terms of this measure, the result obtained above can be stated succinctly
as:
δ(T1) = 1 2δ(T0).
Similarly, δ(T2,) = δ(T1)∕2, and so on. Since the δ-value is halved each time, it
follows that δ(Tn) tends to 0 as n increases indefinitely. so the T’s do indeed
tend towards the equilateral shape.

Exercises
13.3.1 Let I0,I1,I2,… be, respectively, the incenters of the triangles T0,T1,T2,
…. Does the sequence
〈I0,I1,I2,…〉
possess a limit?—i.e., do the incenters converge to a point? If so, what is
this point?
13.3.2  Find another proof for the claim that for the iteration function given
by f(x) = 90 -1 2x, the f-orbit corresponding to any seed converges to
60.
13.4   Medians
From angle bisectors we move on medians. Here are two definitions.
Figure 13.15.  

Figure 13.16.  
Median of a Triangle; Centroid    The line segment connecting a vertex of a
triangle to the mid-point of the opposite side is called a median of the
triangle. The three medians of any triangle meet in a point, called the centroid
of the triangle; see Figure 13.15.
The iteration
We start with triangle T0, with vertices A,B and C, inscribed in a circle Γ. Let
its medians be drawn, and let them be extended, as was done with the angle
bisectors, to meet Γ. Let T1 be the triangle whose vertices are the three points
of intersection; see Figure 13.16.
Let the actions performed so far be considered as one round of an iteration
f; take T1 = f(T0) to be the output produced from the input T0.
Since T0 and T1 share the same circumcircle, the iteration can be
continued. So we get
T2 = f(T1),T3 = f(T2),T4 = f(T3),...,
and so on. (To produce T3 from T2, the medians of T2 are drawn and
extended till they meet Γ; the three points of intersection are the vertices of
T3.)
What happens now? Figures 13.17 and 13.18 show the results of the iteration
after 5 and 15 rounds respectively. (In each case T0 has been drawn in a light
line and the final Ti in a heavy line.)
Remarkably, we find exactly the same thing happening as in the angle-
bisector iteration: the triangles start to look more and more equilateral in
shape. And as earlier, this happens regardless of the shape of the seed triangle.
Figure 13.19 shows the result after 15 rounds of the iteration, with a
differently shaped triangle as seed.

Figure 13.17.   After 5 rounds
Figure 13.18.   After 15 rounds
Figure 13.19.   After 15 rounds, with another T0
⋆ ⋆ ⋆ ⋆ ⋆ ⋆ ⋆ ⋆ ⋆ ⋆ ⋆ ⋆ ⋆ ⋆ ⋆ ⋆ ⋆ ⋆ ⋆
In order to do an analysis of this problem, we must compute the angles of

T1 and check whether they are in some sense closer to one another than the
angles of the parent triangle; or we could work with the sides rather than the
angles. This was easy to do in the case of the angle-bisector iteration.
Unfortunately the analysis in this case is rather more involved. The ambitious
reader may want to try finding a proof independently, before proceeding to
the analysis given at the end of this chapter (in the Appendix).
Exercises
13.4.1 Let Gi denote the centroid of Ti,i = 0,1,2,…, and consider the sequence
〈G0,G1,G2,G3,…〉.
Does the sequence possess a limit? That is, do the centroids converge to
some limiting position?
13.4.2 Instead of drawing medians, we could draw lines according to the
following scheme.
Let k denote a fixed number, 0 < k < 1. Labelling T0 as ABC, we locate
points P on BC,Q on CA and R on AB according to the rule
BP PC = CQ QA = AR RB = k,
draw the lines AP,BQ,CR, then extend them to meet the circle Γ; the
three points of intersection are then the vertices of T1. Likewise we
generate T2 from T1,T3 from T2, and so on.
Let Gi be the centroid of Ti. Does the sequence 〈G0,G1,G2,…〉
converge to a point? Does convergence depend on the choice of k? Use
a computer to do experiments and make a guess based on your
findings. (Observe that k = 0.5 corresponds to the original iteration.)
Numerical analysis
As mentioned earlier, the analysis of the medians iteration is rather involved.
We shall give the full details later. For now, we shall only show how the
iteration can be described in algebraic terms; this then allows a numerical
investigation.

Figure 13.20.   A subsidiary result: B′C′ : C′A′ : A′B′ = AP ⋅ BC : BP ⋅ CA :
CP ⋅ AB
We first establish a subsidiary result. In Figure 13.20, we see a triangle
ABC, inscribed in its circumcircle Γ, with an interior point P. The lines AP,BP
and CP, when extended, meet the circumcircle again in the points A′,B′ and
C′, respectively. We shall show that
B′C′ : C′A′ : A′B′ = AP ⋅ BC : BP ⋅ CA : CP ⋅ AB.
The proof is as follows. From the chord theorem, we get:
AP ⋅ PA′ = BP ⋅ PB′ = CP ⋅ PC′.
Let k be the common value of these three products. From the similarity of
triangles B′PC′ and CPB, we get:
B′C′ BC = PB′ PC , ∴B′C = BC ⋅ PB′ PC = k ⋅ BC BP ⋅ CP = k ⋅ AP ⋅ BC
AP ⋅ BP ⋅ CP.
It follows that B′C′ : C′A′ : A′B′ = AP ⋅ BC : BP ⋅ CA : CP ⋅ AB, as claimed.
⋆ ⋆ ⋆ ⋆ ⋆ ⋆ ⋆ ⋆ ⋆ ⋆ ⋆ ⋆ ⋆ ⋆ ⋆ ⋆ ⋆ ⋆ ⋆
If P happens to be the centroid of triangle ABC, then the lengths AP,BP,CP
are two-thirds of the lengths of the medians through A,B,C, respectively.
Writing ma,mb,mc for the lengths of these three medians, and a′,b,c′ for the
lengths of the sides of triangle A′B′C′, we see that
a′ : b′ : c′ = am a : bmb : cmc,

certainly a pretty and compact result!
From APOLLONIUS’S THEOREM we know that
ma2 = b2 2 + c2 2 -a2 4 ,mb2 = c2 2 + a2 2 -b2 4 ,mc2 = a2 2 + b2 2 -c2 4 .
Using these relations, we are now able to make a numerical study of the
convergence profile of the medians-iteration. Writing the relations a′ : b′ : c′
= ama : bmb : cmc as
a′2 : b′2 : c′2 = a2m a2 : b2m b2 : c2m c2,
we see that a′2 : b′2 : c′2 is the same as
a2(2b2 + 2c2 - a2) : b2(2c2 + 2a2 - b2) : c2(2a2 + 2b2 - c2).
It will be evident now that it is more convenient to deal with the squares of
the sides of the triangle than with the sides themselves. Further, as it is only
the ratios that the sides bear to one another that are of relevance to us, we
define quantities x,y,z,x ′,y′,z′ as follows:
x = a2 a2 + b2 + c2,y = b2 a2 + b2 + c2,z = b2 a2 + b2 + c2,
and
x′ = a′2 a′2 + b′2 + c′2,y′ = b′2 a′2 + b′2 + c′2,z′ = b′2 a′2 + b′2 + c′2;
then x + y + z = 1 = x′ + y′ + z′,x : y : z = a2 : b2 : c2, and    x′ : y′ : z′ = a′2 : b′2
: c′2.
Now we describe what iteration “does” to the triple (x,y,z). From the above
we see that the iteration maps (x,y,z) to the triple (x′,y′,z′), where
x′ = x(2y + 2z - x) 4(xy + yz + zx) - (x2 + y2 + z2),
y′ = y(2z + 2x - y) 4(xy + yz + zx) - (x2 + y2 + z2),
z′ = z(2x + 2y - z) 4(xy + yz + zx) - (x2 + y2 + z2).
The common denominator here is the sum
x(2y+2z-x)+y(2z+2x-y)+z(2x+2y-z) = 4(xy+yz+zx)-(x2+y2+z2).
The important consequence of this formulation is that we have at hand a fully
numerical version of the iteration. We now test it out.

Example 1.    Consider a triangle with sides a = 3,b = 4,c = 5. As a2 : b2 : c2 = 9
: 16 : 25 and 9 + 16 + 25 = 50, the starting triple is (x0,y0,z0) =
(0.18,0.32,0.50). The subsequent triples, computed via the formula displayed
above, are:
(0.1800, 0.3200, 0.5000),    (0.3108, 0.3936, 0.2956),
(0.3374, 0.3279, 0.3347),    (0.3333, 0.3333, 0.3333),
(0.3333, 0.3333, 0.3334),    (0.3333, 0.3333, 0.3333).
The speed with the triple (0.3333, 0.3333, 0.3333) (which corresponds to the
equilateral triangle) is reached is most impressive! (There is a small amount
of round-off error in the displays: the last two triples sum to 0.9999 rather
than to 1.)
Figure 13.21.   The pedal triangle
Example 2.    Now consider a triangle with sides a = 2,b = 5,c = 6. We get the
following result:
(0.0615, 0.3846, 0.5538),    (0.1789, 0.5210, 0.3001),
(0.3194, 0.2778, 0.4028),    (0.3410, 0.3322, 0.3268),
(0.3333, 0.3334, 0.3333),    (0.3333, 0.3333, 0.3333).
Once again the swift rate of convergence is in full view.
⋆ ⋆ ⋆ ⋆ ⋆ ⋆ ⋆ ⋆ ⋆ ⋆ ⋆ ⋆ ⋆ ⋆ ⋆ ⋆ ⋆ ⋆ ⋆

The full proof that the sequence of iterates converges to an equilateral
shape is given at the end of the chapter.
13.5    Pedal triangles
We start with an acute angled triangle T0, with vertices A,B,C, and a point P
lying within the region enclosed by the triangle. Let perpendiculars be
dropped from P to each side of T0, and let the feet of these perpendiculars be
the vertices of a new triangle T1. This triangle is the pedal triangle of P
relative to T0. Note that T1 is “inscribed” in T0, for its vertices lie on the sides
of T0, one to each side (see Figure 13.21).
As P lies within T1, we can repeat these actions and construct the pedal
triangle of P relative to T1, by dropping perpendiculars from P to the sides of
T1 and joining the feet of the perpendiculars to one another. In this manner
we obtain another triangle T2, and P lies within this triangle too. We now
construct the pedal triangle of P relative to T2, obtain another triangle, T3,
and we continue thus, obtaining a sequence 〈T0,T1,T2,T3,…〉, in which each
Ti is inscribed within the preceding one. The triangles shrink in size very
rapidly, and soon the eye is unable to distinguish the triangles from the point
P itself. Figure 13.22 shows the T’s till T3.

Figure 13.22.  Inscribed pedal triangles
There is a nice feature about the sequence that could easily escape the eye: T3
is similar to T0! Examine the figure carefully; you should be able to see the
similarity on your own. (The two triangles are in fact homothetic to one
another, and P is the center of homothety.)
Exercises
13.5.1 Prove that T3 is similar to T0. (Hint. Compute the angles of T1. Do not
draw the pedal triangles after T1, else the figure becomes too
confusing!)

Figure 13.23.  
Figure 13.24.  
13.6      Altitudes
Having studied iterations associated with the angle bisectors and the medians
of a triangle, it is natural to consider the case of altitudes. The iteration turn s
out to be quite exotic, producing complete chaos! The earlier iterations were
both fairly “well behaved.” in terms of yielding predictable results, but that is
not the case here. Before we start we need two definitions.
Altitude, Orthocenter    The line drawn from a vertex of a triangle
perpendicular to the opposite side is called an altitude of the triangle. The
three altitudes of a triangle always meet in a point, called the orthocenter of
the triangle. The orthocenter can lie either inside or outside the triangle (see
Figures 13.23 and 13.24).

The iteration
We start the iteration with triangle ABC inscribed in a circle Γ; call the
triangle T0, and let its orthocenter be H0. The altitudes of T0 are drawn and
extended till they meet Γ. Let T1 be the triangle whose vertices are the three
new points of intersection, and let H1 be its orthocenter. Take T1 to be the
output arising from the input T0.
We now iterate these actions: we draw the altitudes of T1, extend them till
they meet Γ, and join the three points of intersection to one another; then the
resulting triangle is T2, and its orthocenter is H2. We continue in this
manner, obtaining a sequence of triangles,
Figure 13.25.   Altitude iteration, after 2 rounds
〈T0,T1,T2,T3,…〉,
and a corresponding sequence of orthocenters,
〈H0,H1,H2,H3,…〉.
Having studied in some detail the iterations with angle bisectors and medians,
we may now be tempted to guess that the sequence of orthocenters will
converge to a point. But we are in for a surprise!
Figure 13.25 shows the result after 2 rounds of the iteration (the
orthocenters are shown, but some details have been hidden so as to avoid a
visual mess).

Figure 13.26 shows the result after 25 rounds of the iteration (the labelling
of the Hi’s has been suppressed, for obvious reasons; likewise for the
construction lines used). Note the dust-like scatter.
Figure 13.27 shows the result after 85 rounds. There appears now to be a
random scatter! (There is a curious star-like effect, with streaks in six
directions symmetrically placed about the circle; but this is hard to explain.) If
we continue the iterations still further, we find a circular region entirely
covered with dots. A careful analysis reveals that the radius of this circle is
three times the radius of the circumcircle of T0.
Remark.    For some choices of the starting triangle T0, a dust-like effect is
not obtained; instead, we get a cycle. The reader may want to investigate
under what conditions this will happen.
Figure 13.26.   After 25 rounds
Exercises
13.6.1 For which triangles does the orthocenter lie (i) within the triangle (ii)
on one side of the triangle (iii) one side of the triangle? Can the
orthocenter ever lie in the interior of a side of the triangle?
13.6.2 Show that the altitudes of a triangle meet in a point.
13.6.3 In the iteration just considered, do the Ti’s converge to any limiting
shape?

13.6.4 Consider all possible triangles inscribed in a circle Γ, and let ℋ denote
the set of their orthocenters. Show that ℋ occupies a circular region
whose radius is three times that of Γ. You will need to use the
following well known result due to Euler:
For any triangle, the circumcenter O centroid G and orthocenter
H lie on a straight line the “Euler line” of the triangle, with H
between O and G and moreover, OH = 3OG.
13.6.5 It had been noted above that “for some choices of the starting triangle
T0, a dust-like effect is not obtained; instead, we get a cycle.”
Investigate under what conditions this will happen.
Figure 13.27.   After 85 rounds
13.7    Pretty pictures
Next we show how simple iterative actions can give rise to very attractive
pictures.

13.7.1    Nested Squares
Let k be a number lying between 0 and 1. Let S0 be a square, and let its
vertices be labelled in cyclic order as A,B,C,D. Let points P,Q,R,S,
respectively, be located on the sides AB, BC,CD,DA of S0, according to the
following rule:
AP AB = BQ BC = CR CD = DS DA = k.
(If k = 0.5, then P,Q,R,S are the mid-points of the sides of S0.) The segments
PQ,QR,RS,SP are drawn, giving another square, S1, which we take to be the
output of a function with input S0. Observe that S1 is smaller than S0 and is
wholly contained within it; it has the same center as its parent square, but has
been turn ed through a small angle. To draw S2 we temporarily rename S1 as
ABCD and locate points P,Q,R,S on its sides as per our rule; then S2 is the
square PQRS;
Figure 13.28.   Nested squares
and so on. We thus obtain a sequence of squares
〈S0,S1,S2,S3,…〉,
in which each square lies inside all the preceding ones. It is easy to see that the
squares converge to the center of symmetry of the square. The picture that
results is a pretty one; two such pictures have been portrayed in Figure 13.28.
Exercises

13.7.1 Prove that Si is a square for each i.
13.7.2 What picture results when k = 0.5?
13.7.3 Which values of k generate the nicest pictures? (You will need to do
some experimentation to find out!)
13.7.4 If you work with non-square quadrilaterals instead of squares, what do
you find?
13.7.5 If you carefully study the pictures generated above, you will see many
spiralling curves. This is actually an optical effect: even though we have
not drawn any curve, it so happens that the lines that we have drawn
are all tangent to a particular curve, and it is this curve that we “see. So
in this sense the curve is not merely an illusion but has been created by
the lines. (The lines are said to envelope the curve.)
List some daily life situations in which straight lines create the effect of
a curve. (Hint. Think of the “tea-cup curve.”)
13.7.6 Four men (A,B,C,D) are stationed at the comers of a square, one at
each vertex, and at a given instant they start walking towards one
other: A towards B,B towards C,C towards D and D towards A, all at
the same speed. As they are all in movement, each one must
continuously alter his direction of movement. What paths do the men
trace out? Where do they meet?
13.7.7 A dog spots a rabbit and starts to chase it; the rabbit heads straight for
its burrow. What sort of path does the dog follow? (Experiment with
different possibilities. If the dog and rabbit run in the same direction,
then the path is simply a straight line. What happens if the rabbit
initially starts in a direction which is perpendicular to the dog’s path?)
13.7.2      Nested Triangles
We do exactly the same thing with triangles. Let T0 be a equilateral triangle
and let k be any number lying between 0 and 1. We label the vertices of T0 as
A,B,C, then locate points P,Q,R on the sides of T0 using the following rule:
BP BC = CQ CA = AR AB = k;

then we declare T1 to be △PQR. We find that T1 is equilateral, but of smaller
size that T0; it has the same center of symmetry as its parent triangle, and is
wholly contained within it. We similarly generate T2 from T1,T3 from T2,
and so on. The sequence
〈T0,T1,T2,T3,…〉
then consists of nested triangles, one within the other, converging to the
center of symmetry of the triangle. Figure 13.29 shows two sample pictures.
This example and the previous one ("nested squares") form the basis
of,many pretty Nail-and-thread art pieces that can be found in the craft center
of a school.
Exercises
13.7.8 Suppose that T0 is not equilateral. What can be said about T1,T2,T3,
… ? Are the triangles further down the sequence ‘more equilateral’
than the earlier ones?
13.8    Fractals
Fractals constitute a relatively modem discovery; they date to the latter half of
the 20th century and may be said to have originated in the work of the French
mathematician and geometer Benoit Mandelbrot. In the bargain a new class
of mathematical objects has emerged, one that holds considerable relevance
to the study of the natural world. The concept is a relatively simple one, but it
is remarkable how far it takes us. We illustrate the idea with a simple example
—that of the snowflake curve.

Figure 13.29.   Nested triangles
Figure 13.30.   Action of f on a line segment
⋆ ⋆ ⋆ ⋆ ⋆ ⋆ ⋆ ⋆ ⋆ ⋆ ⋆ ⋆ ⋆ ⋆ ⋆ ⋆ ⋆ ⋆ ⋆
We first describe how the function f acts. Let a line segment ℓ = AB be
given, and let f act on ℓ thus: we locate the points X,Y which trisect AB (with
X nearer to A than to B, so the points occur on ℓ in the order A,X,Y,B), and
then locate Z such that △XYZ is equilateral. The ambiguity regarding the
side of ℓ on which Z is located is resolved thus: in △XYZ, the vertex order
(X,Y,Z) is required to be anticlockwise. Following this, segment XY is deleted
and replaced by segments XZ and Y Z (see Figure 13.30).
Now let a geometric figure G0 be given, composed only of line segments;
for instance, G0 could be a polygon. We let f act on each edge of G0, and
obtain a new geometric figure, say G1. The same treatment is given to G1,
and so on, and we thus obtain a sequence of geometric figures,
〈G0,G1,G2,G3,…〉,
each of which is composed only of line segments, which get smaller and
smaller as we go down the sequence. The following sequence of figures shows
what happens when G0 is an equilateral triangle. Note the beauty of the
figures! It is possible in the minds’ eye to imagine what happens ‘in the limit’,
but it is impossible to draw it. The limiting object is known as the snowflake
curve— for obvious reasons, as this is what the object resembles it its broad
outline and symmetry. (We have stopped at G5 because, as you will readily
see, drawing even the next shape is going to be rather tedious.)
Is it not remarkable how such a simple rule can give rise to so pretty a
shape?
13.9    Map-in-a-map

A USAMO problem Our last example of iterations in geometry will be based
on the following elegant problem which appeared in the USA mathematical
olympiad (USAMO) of 1978.
We are given two square maps of the same country, drawn to different
scales. The smaller map is placed on and within the boundary of the
larger one. Show that there is precisely one point on the small map
which represents the same place of the country as the point of the large
map that lies directly below it. Give a way of locating this point.
The use of the word "square" may suggest that the result holds only for maps
which are square in shape, but this is clearly no restriction, for any map can
be embedded in a larger map that is square in shape.
Notation
Let ABCD denote the larger map, and A′B′C′D′ the smaller one. We use the
prime symbol (′) to show the correspondence between the maps: if X is any
point on the large map, then the point on the small map corresponding to X
will be denoted by X′. We also write X′ = f(X), where f is the function
describing how the two maps correspond to one another (in Figure 13.32, A′
= f(A),B′ = f(B), and so on).
Next, we denote by r the scale factor of the small map relative to the large
map (0 < r < 1). The scaling applies uniformly to all parts of the map, so if two
distinct points P and Q of the large map correspond to (distinct) points P′
and Q′ of the small map, then P′Q′ = r ⋅ PQ < PQ. So if "dist" represents the
distance function, with dist (P,Q) = the distance between the points P and Q,
then the function f has the property that
dist (f(P),f(Q)) = r⋅ dist (P,Q) < dist (P,Q),

Figure 13.31.   Stages 0 to 5 of the snowflake curve

Figure 13.32.   Map-in-a-map
for all points P≠Q of the large map. Note in particular that for all points P≠Q
of the large map, the distance between f(P) and f(Q) is strictly less than the
distance between P and Q.
The problem asks us to show that there is one and only one point O of the
large map such that f(O) = O (i.e., f has one and only one fixed point), and to
show how the point can be located geometrically.
Solution to the problem
Observe that the ‘only one’ pan is easy: there certainly cannot be more than
one such point. For if P and Q were both fixed points (P≠Q), then we would
have P = f(P) and Q = f(Q), i.e., P′ = P and Q′ = Q, implying that P′Q′ = PQ;
but this contradicts the relation P′Q′ < PQ obtained above. So there can be at
most one fixed point.
When f is applied to the entire square M = ABCD, we get the smaller
square M′. What happens if we apply f to M′? We obviously get a square M″
which lies within M′ and bears exactly the same relation to M′ as M′ does to
M. The scale of M″ is r times that of M′, and therefore r2 times that of M. If
we are given only M and M′, we can easily construct M″ using Euclidean
tools. For, point A″ must lie inside M′ and be located such that △A″A′B
′~△A′AB. We can easily do this using the tools of Euclidean geometry.

This can clearly be continued indefinitely: we can apply f to M″ and get M
‴, and so on. The squares thus obtained shrink at a geometric rate, and each
lies within the preceding square. So we get a “nested” sequence of squares (see
Figure 13.33).
Figure 13.33.   Nested maps
If we focus attention (see Figure 13.34) on the f-iterates of the vertex A
alone, we see that the sequence of iterates
A,A′,A″,A‴,A′′′′,...
quite visibly converges to a limiting point O. This is the fixed point of f.
Locating the fixed point geometrically
It is possible to find the fixed point O without too much work. Indeed, we
need only two iterates, A′ and A″. (If we are not given A″, then we first
construct it as indicated above.) We give below a geometric procedure for
locating O.
Observe firstly that for any three points P,Q and R, the image of △PQR
under f, namely △P′Q′R′, is similar to △PQR. Since O is a fixed point (O′ =
O), we infer that △OAA′ is similar to △OA′A″, and ∠OA′A″ = ∠OAA′.
Therefore A′A″ is tangent (at A′) to the circumcircle of △OAA′. This circle
can readily be drawn, even though we do not know where 0 lies; for its center
must lie on the line through A′ perpendicular to A′A″, and it must also lie on
the perpendicular bisector of segment AA′.

Next, we have ∠OA′A = ∠OA″A′, therefore AA′ is tangent (at A′) to the
circumcircle of △OA″A′. This circle too can be drawn readily, even though
we have not yet found O, by applying the same logic: its center must lie on the
line through A′ perpendicular to AA′ and also on the perpendicular bisector
of segment A′A″.
The two circles meet at A′ and O, therefore O is located; see Figure 13.35.
Figure 13.34.   Successive iterates of A

Figure 13.35.   Locating the fixed point A
Closing remarks
The subject of this section is related to what is known as fixed point theory, a
very active area of mathematics today—it has whole journals and websites
devoted to it! Fixed point theory is part of a subject called topology.
The map-in-a-map result is a special case of an extremely important result
in this field called Brouwer’s fixed point theorem. The theorem has all kinds of
nice applications in subjects that would seem very far removed from
mathematics; for example, economics. The theorem was discovered by a
Dutch mathematician, L E J Brouwer (1881–1966).
The “map” result is an application of Brouwer’s theorem in two
dimensions. Even the one dimensional case of the theorem is elegant:
Let f be a continuous map from a finite interval I into itself; then f has a
fixed point.
The two dimensional version of the theorem states the following:
Let f be a continuous function from a convex, bounded set S into itself;

then fhos a fixed point.
The word “continuous” in these two statements here has a technical meaning
which we will not go into. In the context of our “map” result, what it means is
that while we are allowed to shrink the map as much as we wish, and place it
inside the larger map at any orientation, even upside down, we are not
permitted to tear it. Tearing the map would qualify as a “discontinuous”
operation.
The theorem may be similar extended to cover the case of three
dimensions.
Here is a pretty application of the theorem; it is called the coffee cup
theorem. It says that if you take a cup of coffee and stir the coffee with a
spoon, then at the end there is some coffee particle that is in exactly the same
place that it was before the stirring. If you “push” this particle out of its
position, then somewhere else in the cup a particle will end up in its original
position!
Exercises
13.9.1 Consider the case when the sides of the small map are parallel
respectively to the sides of the large map. Two subcases of interest are:
(a) A′B′∥AB, B′C′∥BC; (b) A′B′⊥ AB,B′C′⊥ BC.
Find simpler ways of locating the fixed point O in these two subcases.
13.9.2 What happens if the small map juts outside the large map? Does a
fixed point necessarily exist?

Figure 13.36.  
13.9.3 I take a walk as follows: from my house I walk 1 km East, then 1/2 km
North, then 1/4 km West, then 1/8 km South, then 1/16 km East, then
1/32 km North, and so on. Where do I find myself eventually? (Give a
geometric argument for locating the limiting position.)
13.10    Appendix—analysis of the medians-iteration
We now take up the analysis of the medians iteration studied in Section 13.4.
We had said then that the analysis was rather challenging. We now give the
full details. Our approach will be.to translate the geometric iteration into an
algebraic one, and then recast it into a geometric context using the idea of
BARYCENTRIC COORDINATES. (For those who are unfamiliar with this term, a
full definition is given below.)
⋆ ⋆ ⋆ ⋆ ⋆ ⋆ ⋆ ⋆ ⋆ ⋆ ⋆ ⋆ ⋆ ⋆ ⋆ ⋆ ⋆ ⋆ ⋆
In Figure 13.36, AD,BE,CF are the medians of triangle ABC, and their
lengths are ma,mb,mc, respectively. The medians, when extended, meet the
circumcircle Γ at points A′,B′,C′. Let the sides of triangle ABC be a,b,c, and
let the lengths of the medians be ma,mb,mc, respectively. Then a′ : b′ : c′ =

(13.1)
ama : bmb : cmc (this was proved earlier). It follows that
a′2 : b′2 : c′2 = a2(2b2 + 2c2 - a2) : b2(2c2 + 2a2 - b2) : c2(2a2 + 2b2 - c2).
Let x : y : z = a2 : b2 : c2 and x′ : y′ : z′ = a′2 : b′2 : c′2. Then, we have:
x′ : y′ : z′ = x(2y + 2z - x) : y(2z + 2x - y) : z(2x + 2y - z).
Noting that the sum of the numbers in the triple on the right side is:
x(2y+2z-x)+y(2z+2x-y)+z(2x+2y-z) = 4(xy+yz+zκ)-(x2+y2+z2),
we define a mapping on triples of real numbers whose sum is 1, as follows. If
(x,y,z) is such a triple, i.e., with x + y + z = 1, then its image is (x′,y′,z′) =
f(x,y,z), where
x′ = x(2y + 2z - x) 4(xy + yz + zx) - (x2 + y2 + z2), y′ = x(2z + 2x - y) 4(xy + yz
+ zx) - (x2 + y2 + z2), z′ = x(2x + 2y - z) 4(xy + yz + zx) - (x2 + y2 + z2),
We need to show that the iterates tend to the triple (1/3, 1/3, 1/3).
Transformation of problem, using barycentric coordinates
Let us regard (x,y,z) as the barycentric coordinates of a point P with reference
to some fixed equilateral triangle T. Before going on, we define what this
means.
Oriented area    Given a polygon P with its boundary (usually denoted by ∂P)
traversed in an anticlockwise or clockwise direction, its oriented area
(denoted by [P]) is its ordinary area affixed with a positive sign if the direction
is anticlockwise, and a negative sign if the direction is clockwise.
From the definition, it follows that [ABC] = -[ACB] for any triangle ABC,
for the “sense” of the closed path A → B → C → A is opposite to that of the path
A → C → B→ A.
Barycentric coordinates     Given a fixed triangle T with vertices A,B,C (we
shall call it as the triangle of reference), for any point P in the plane of the
triangle, let
x : y : z = [PBC] : [PCA] : [PAB ] .
We shall assume that the labelling of triangle ABC is done in an anticlockwise

order (so [ABC] is positive). The location of P is uniquely determined once
the ratios x : y : z are known (this follows from elementary geometry). We call
the triple (x,y,z), or the ratios x : y : z, the barycentric coordinates of P.
Examples: The barycentric coordinates of vertex A are (1,0,0), those of the
mid-point of side BC are (1/2, 1/2, 0 ) , and those of the centroid of the
triangle are (1/3, 1/3, 1/3). The only triple that does not correspond to any
point in the plane is (0,0,0).
Note that the triple (kx,ky,kz) corresponds to the same point as (x,y,z). (So
the centroid may also be described by the triple (1, 1, 1), and the mid-point of
side BC by the triple (1, 1, 0 ) . ) If x,y,z all have the same sign, then the point
P lies inside the triangle, and if x < 0,y > 0,z > 0, then P lies within the angle
determined by the rays AB⃗ and AC⃗ but on the opposite side of BC as
compared with A.
⋆ ⋆ ⋆ ⋆ ⋆ ⋆ ⋆ ⋆ ⋆ ⋆ ⋆ ⋆ ⋆ ⋆ ⋆ ⋆ ⋆ ⋆ ⋆
Coming back to our iteration, we see that the image of a point P,
determined by a triple (x,y,z), is a point P′, determined by the triple (x′,y′,z′),
where x′,y′,z′ are computed using equation (13.1). We need to check whether
the iterates of P under this mapping tend to the centroid G of the triangle of
reference, T.
We assign the following coordinates to the vertices of T = △UV W:
U = (0,3),V = (-1,0),W = (1,0).
Then. the centroid of T is G = (0,1∕3), and the coordinates of the point P
corresponding to the triple (x,y,z) are
x ⋅ U + y ⋅ V + z ⋅ W x + y + z = z - y x + y + z, x3 x + y + z
We first establish two preliminary results (“lemmas”).
Lemma 1. The equation of the incircle of T is x2 + y2 + z2 = 2(xy + yz + zx).
Points within the incircle have x2 + y2 + z2 < 2(xy + yz + zx); points
outside the incircle have x2 + y2 + z2 > 2(xy + yz + zx).
For, the square of the distance between P and G is
PG2 = z - y x + y + z2 + x3 x + y + z - 1 32

❑
❑
= 4(x2 + y2 + z2 - xy - yz - zx) 3(x + y + z)2 .
Since the radius of the incircle is 1∕3, we compute the quantity PG2 -
1∕3:
PG2 -1 3 = 4(x2 + y2 + z2 - xy - yz - zx) 3(x + y + z)2 -1 3
= x2 + y2 + z2 - 2(xy + yz + zx) (x + y + z)2 .
So x2 + P + z2 - 2(xy + yz + zx) is negative, zero or positive, according
to whether P is within, on, or outside the incircle of the triangle.
Lemma 2. The equation of the circumcircle of T is xy + yz + zx = 0. Points
within 
the 
circumcircle 
have 
xy 
+ 
yz 
+ 
zx 
>
0, and points outside the circumcircle have xy + yz + zx < 0.
Since the radius of the circumcircle of the triangle is 2∕3, we compute
the quantity PG2 - 4∕3, using the expression for PG2 from above. After
simplification, we get:
PG2 -4 3 = 4(x2 + y2 + z2 - xy - yz - zx) 3(x + y + z)2 -4 3 =
-4(xy + yz + zx) (x + y + z)2 .
Therefore, xy + yz + zx is positive, zero or negative, according to
whether P is within, on, or outside the circumcircle.
Theorem 13.1    If P lies within the incircle, the image point P ' lies closer to the
center of the incircle than P, i. e ., GP′ < GP. If P lies on the incircle, then so
does P′; i. e the distance from G stays fixed. If P lies outside the incircle, then P ′
too lies outside the incircle. If P lies on the circumcircle, then so does P′.
Proof.    The coordinates of the image point P ′, with x ′,y′,z′ given by
equations (13.1), are
(y - z) ⋅ (2x - y - z) 4(xy + yz + zx) - (x2 + y2 + z2) , x ⋅ (x - 2y + 2z)3 4(xy +
yz + zx) - (x2 + y2 + z2).
The square of the distance between P′ and G(i.e.,P′G2) is therefore given by
(y - z) ⋅ (2x - y - z) 4(xy + yz + zx) - (x2 + y2 + z2)2 + 1 3 ⋅2x2 - y2 - z2 - 2xy -
2xz + 4yz 4(xy + yz + zx) - (x2 + y2 + z2)2.
This simplifies (after some effort!) to

(13.2)
(13.3)
P′ G2 = 4 3 ⋅ (x2 + y2 + z2 - xy - yz - zx)2 [4(xy + yz + zx) - (x2 + y2 + z2)]2.
Therefore,
P′G2 -1 3 = (x + y + z)2 ⋅ (x2 + y2 + +z2 - 2xy - 2yz - 2zx) [4(xy + yz + zx) -
(x2 + y2 + z2)]2 .
Observe that if x;y : z = 1 : 1 : 1, then P′G = 0, i.e., P′ = G. Further , if P≠G,
then
P′G2 PG2 - 1 = 9 ⋅(x2 + y2 + z2 - 2xy - 2yz - 2zx) ⋅ (xy + yz + zx) [4(xy + yz +
zx) - (x2 + y2 + z2)]2 .
From equations (13.2) and (13.3), we see that the following possibilities can
arise.
If P lies within the incircle, then we have
xy + yz + zx > 0,x2 + y2 + z2 < 2(xy + yz + zx),
so P′G < PG. Therefore, points within the incircle are pulled towards the
center of the triangle.
If P lies on the incircle, then
x2 + y2 + z2 = 2(xy + yz + zx),
giving P′G2 - 1∕3 = 0; therefore, P′ too lies on the incircle.
If P lies outside the incircle, i.e.,
x2 + y2 + z2 > 2(xy + yz + zx),
then P′G2 - 1∕3 > 0, which means that P′ too lies outside the incircle.
If P lies outside the in circle but within the circumcircle, then
xy + yz + zx > 0,x2 + y2 + z2 > 2(xy + yz + zx),
so P′G > PG. Therefore, points in this region are pushed away from the
center of the triangle.
If P lies on the circumcircle, then P′G = PG, therefore, P′ too lies on the
circumcircle.
If P lies outside the circumcircle, then P′G < PG. So such points are once

(13.4)
(13.5)
(13.6)
again pulled towards the center of the triangle.
Convergence of the iteration.    Let the quantity t be defined by
t = x2 + y2 + z2 xy + yz + zx.
Note that we cannot have t < 1, as x,y,z are real. We now write the relation
P′G2 PG2 = (x + y + z)2 ⋅ (x2 + y2 + z2 - xy - yz - zx) [4(xy + yz + zx) - (x2 +
y2 + z2)]2
in terms of t. Since
(x + y + z)2 = (xy + yz + zx) ⋅ (t + 2),
x2 + y2 + z2 - xy - yz - zx = (xy + yz + zx) ⋅ (t - 1),
4(xy + yz + zx) - (x2 + y2 + z2) = (xy + yz + zx) ⋅ (4 - t),
we get:
P′G2 PG2 = (t + 2) ⋅ (t - 1) (4 - t)2 .
Let g(t) = (t + 2) ⋅ (t - 1)∕(4 - t)2. Then g(2) = 1; this confirms what we already
know: that points on the incircle stay on the incircle.
A table of values of g is of interest:
We see that as t drops from 2 to 1, g(t) decreases from 1 to 0; moreover, the
slope of g(t) at t = 0 is 0. This explains why the iterates converge to the
equilateral shape so rapidly.
Does the starting point always lie within the incircle? We must check that at
the start of the iteration, the point P does lie inside the incircle. But this is
easy. Recall that at the start we had
x : y : z = a2 : b2 : c2.
Therefore, to show that x2 + y2 + z2 < 2(xy + yz + zx) we must show that
a4 + b4 + c4 < 2(a2b2 + b2c2 + c2a2).

❑
In other words, we must show that
a4 + b4 + c4 - 2(a2b2 + b2c2 + c2a2) < 0.
Rather conveniently for us, the expression on the side factorizes exactly, as
-(a + b + c) ⋅ (a + b - c) ⋅ (b + c - a) ⋅ (c + a - b).
In this factorization, the quantities a + b - c,b + c - a and c + a - b are all
positive (strictly), by virtue of the triangle inequality ("any two sides of a
triangle are together greater than the third side”); also, trivially, a + b + c is
positive. It follows that the quantity
a4 + b4 + c4 - 2(a2b2 + b2c2 + c2a2)
is negative, and therefore, the inequality a4 + b4 + c4 < 2(a2b2 + b2c2 + c2a2)
is true.
This means that the triple (x,y,z) with which we start the iteration satisfies the
relation
x2 + y2 + z2 < 2(xy + yz + zx).
So, at the start of the iteration, the point P lies strictly within the incircle, and
the iteration pulls if towards the center of the triangle, at an ever increasing
rate. ,
⋆ ⋆ ⋆ ⋆ ⋆ ⋆ ⋆ ⋆ ⋆ ⋆ ⋆ ⋆ ⋆ ⋆ ⋆ ⋆ ⋆ ⋆ ⋆
We may anticipate from the above that the triangles for which convergence
is slow are those for which the ratio (a2 + b2 + c2)∕(ab + bc + ca) is close to 2;
the closer the ratio is to 2, the slower the convergence. This will be the case for
an isosceles triangle whose base is small in relation to the equal sides; for
example, a triangle with sides a = 100 = b and c = 1, with ratio 20001∕10200 ≈
1.961.
Let us try the iteration using this triangle. The initial values of x,y,z are
given by:
X = 1002 1002 + 1002 + 12 ≈ 0.499975,y ≈ 0.499975,z ≈ 0.00005.
Starting with this triple, the first few iterates are the following:
(0.49998, 0.49998, 0.00005),
(0.49990, 0.49990, 0.00020),

(0.49960, 0.49960, 0.00080),
(0.49380, 0.49380, 0.01240),
(0.43254, 0.43254, 0.13492),
(0.33729, 0.337 29, 0.32542),
(0.33333, 0.33333, 0.33333),
(0.49841, 0.49841, 0.00317),
(0.47731, 0.47731, 0.04538),
(0.36922, 0.36922, 0.26157),
(0. 33338, 0.33338,0.33324),
(0.33333, 0.33333 ,0.33333).
We see that even with such a skewed starting triple, convergence to the
equilateral shape is very rapid.
Remark. As noted above, if the point P lies in the annular region between the
incircle and the circumcircle of T, then P′G > PG; it is “pushed away” from
the center of the triangle. And if P lies outside the circumcircle, then P′G <
PG; it is “pulled back” towards the center of the triangle.
This has the following remarkable consequence: if the starting point lies
out-side the incircle of T, then its iterates cannot converge to any position
whatever. Instead, they are forced to “wander around” aimlessly outside the
incircle; neither can they enter within the circle, nor can they recede very far
from it—a strange situation, indeed !

Chapter 14
Techniques of Proof
We outline here a general methodology for investigating iteration problems
and for proving results. The material is a little more advanced than that in the
earlier chapters. We study in detail two iterations discussed earlier: the SSQ
iteration, and the four-numbers iteration. We had noticed at the time that for
both the iterations, irrespective of which seed is chosen, orbits show
predictable behaviour: in the SSQ iteration all orbits seem to converge either
to the fixed point 1 or to the 8-cycle
〈4,16,37,58,89,145,42,20〉,
and in the four-numbers iteration—still simpler—all orbits seem to converge
to the fixed point (0,0,0,0). We remarked at the end of the chapter that
experimental observation does not make for proof; we cannot be certain that
the observed behaviour will hold in each and every instance. What we shall
study now is a way of “being certain”.
14.1   The SSQ iteration
Recall that if n is a positive integer, then SSQ(n) denotes the sum of the
squares of the digits of n (when n is written in base-10); e.g., SSQ(35) = 32 +
52 = 34. Let n be a number with k digits; then, clearly,
SSQ (n) ≤ 81k,
because the largest SSQ values occur for numbers that consist solely 9’s. Note
that equality holds precisely when n = 10k - 1. We write this assertion
compactly as follows:
If n < 10k, then SSQ (n) ≤ 81k.

As a corollary we conclude that:
If n < 1010, then SSQ (n) ≤ 810.
Now among the numbers between 1 and 810, the number with the largest
SSQ is 799. Since SSQ(799) = 72 + 92 + 92 = 211, we conclude that:
If n < 1010 then SSQ (SSQ (n)) ≤ 211.
The notation SSQ(SSQ(n)) looks clumsy, so we use a superscript:
we use SSQ(2) (n) to stand for SSQ(SSQ(n));
we use SSQ(3) (n) to stand for SSQ (SSQ (SSQ(n)) );
and so on—the superscript in brackets indicates the number of times that the
SSQ operation is applied. So we have:
If n < 1010 then SSQ(2)(n) ≤ 211.
Continuing, we note that among the numbers between 1 and 211, the number
with largest SSQ is 199, with SSQ (199) = 12 + 92 + 92 = 163, therefore:
If n < 1010 then SSQ(3)(n) ≤ 163.
One last round of such reasoning is needed: among the numbers between 1
and 163, the largest SSQ occurs for 99, with SSQ(99) = 92 + 92 = 162.
Therefore:
If n < 1010 then SSQ(4)(n) ≤ 162.
Since 162 is greater than 99, we cannot guarantee any more reduction in the
SSQ value by further iterations; the “ceiling” continues to remain at 162. For
convenience, we let S denote the set of numbers {1,2,3,…,161,162}.
We may now confidently assert the following.
a. If n < 1010, then after at most four iterations we reach a number in the
set S.
b. If 1 ≤ n ≤ 162, then 1 ≤ SSQ (n) ≤ 162; i.e., if n ∈ S, then SSQ (n) ∈ S.
In other words, once we reach a number in the set S, we stay within this
set.

These observations provide the lead for the next step. The point to note is that
this reasoning applies to any initial input, no matter how large. When the
input number n is very large, SSQ (n) will be correspondingly small in
comparison with n. For instance:
If n < 101000 then SSQ (n) ≤ 81000.
Since 81000 < 1010, the argument used earlier shows that if n < 101000, then
in at most five iterations we reach a number in the set S.
The following general conclusion now becomes unavoidable:
For any choice of input, no matter how large, repeated application of
SSQ eventually produces a number in the set S.
We also know (see item (b), above) that once we reach a number in the set S,
application of SSQ does not take us out of the set; so the conclusion may be
stated in a stronger form:
For any choice of input, no matter how large, repeated application of
SSQ eventually traps us inside the set S.
Now this set is finite: it has just 162 elements. As we apply SSQ over and over
again, starting at some number in S, it must happen sooner or later that we
encounter a number reached earlier. From this point on the sequence must
repeat, and this means that we have reached a cycle! So:
No matter what input we start with, we must eventually reach a cycle.
Note that this argument yields no information on the length or
composition of the cycle, or a bout the number of cycles. Such information
can be obtained only after a more detailed analysis. This, however, is easy to
do. We start with the element 1 and trace its orbit; in this case the orbit
consists of just the number 1 itself. (We stop the computation once the orbit
closes.) Next, we select a number in S which does not lie in 〈1; SSQ 〉 , say the
element 2, and compute its orbit, 〈2; SSQ 〉 :
〈2,4,16,37,58,89,…〉.
Once again we select a number in S that does not appear in any of the orbits
computed till now (say the number 3), and trace its orbit, 〈 3; SSQ 〉 :

〈3,9,81,65,61,…〉.
Noting that 5 has not appeared in any orbit computed till now, we now
compute the orbit 〈5; SSQ 〉 ; and so on; we proceed systematically in this
manner. It should be clear that when the integers between 1 and 162 have all
been accounted for, all the cycles of the SSQ function will have been found.
The task may appear a bit tedious—but not if we have access to a computer!
We shall not pursue the analysis further at this point; you are invited to do
so.
General comments
The proof technique used above is quite general and applies to many different
types of iterations. Let f denote the function being iterated. In essence, the
technique requires that we identify a finite (and hopefully small) set S such
that the following features hold:
a. regardless of where exactly we start, the output will at some stage belong
to S; that is, for any x, it will happen that f(k)(x) ∈ S for some finite
number k; and
b. when the input belongs to S, then so does the output (i.e., if x ∈ S, then
f(x) ∈ S ) .
If these conditions maintain, then we are assured of reaching a cycle, no
matter where we start the iteration.
“BIack holes”
Let us change the metaphor in describing the above features. In essence we
seem to be looking for a set S that exerts a strong “gravitational pull” on
orbits; they get drawn towards and into it, irresistibly. If an orbit “falls” into S,
then there is no question of its ever “getting out” again. Do these phrases
remind us of certain well known objects in astronomy? Surely, yes: they
remind us black holes! In their honor, then, if for a particular iteration f we
find a set S with the features just described, we shall call it a “black hole set.”
A more accepted (and more somber!) term for such a set is basin of attraction.

14.2   The SCB and SFT iterations
A somewhat different approach to the listing of cycles was used in the section
titled “Two-digit iteration”, in Chapter 11. It can be used with profit in many
instances, especially when the sets involved are provably finite, and good
computing facilities are at hand. Here is an application of this technique.
Rather than consider the SSQ function which we have just discussed in detail,
we consider two related functions:
the SCB function, where SCB (x) is the sum of the cubes of the digits of x
when written in base-l0, e.g., SCB(123) = 13 + 23 + 33 = 36; and
the SFT function, where SFT(x) is the sum of the fourth powers of the
digits of x when written in base-10, e.g., SFT(123) = 14 + 24 + 34 = 98.
Our objective will be to find all the cycles of SCB and SFT.
Finding black hole sets for SCB and SFT
We start by finding values of M and N such that
if 1 ≤ x ≤ M, then 1 ≤ SCB(x) ≤ M, and if x > M, then SCB(x) < x;
if 1 ≤ x ≤ N, then 1 ≤ SFT(x) ≤ N, and if x > N, then SFT(x) < x.
Possible values are M = 3000 and N = 30000, because:
for numbers below 3000, the largest SCB value is achieved for 2999, with
SCB(2999) = 2195 < 3000; and further, if x > 3000, then SCB(x) < x;
for numbers below 30000, the largest SFT value is achieved for 29999,
with SFT(29999) = 26260 < 30000; and further, if x > 30000, then SFT (x)
< x.
It follows that:
for the function SCB, the set S1 = {1,2,3,…,3000} is suitable; and
for the function SFT, the set S2 = {1,2,3,…, 30000 } is suitable.

Extending the domains of SCB and SFT
Next, we allow SCB and SFT to operate on sets rather than just single
numbers; thus we allow operations such as
SCB({15,20,25,30}) = {126,8,133,27},
SFT ({15,20,25,30}) = {626,16,641,81}.
We also define new functions FCB and FFT which (like SCB and SFT)
operate on set as follows: if X is a set of whole numbers, then
FCB(X) = X∩ SCB(X), and
FFT(X) = X∩ SFT(X).
For example, if X = {1,2,3,4,…, 18,19,20}, then
FCB(X) = {1,2,8,9},     FFT(X) = {1,2,16,17}.
Listing the cycles of SCB
The last step is simplicity itself: we compute the orbit 〈S1; SCB 〉 . That is, we
apply FCB to S1 iteratively till we get an “FCB-invariant set”—a set which
remains the same under action by FCB. (This is where heavy computing
machinery is required! The author used MATHEMATICA to do the work.)
After 20 iterations of FCB on S1 we get the following set X:
X = {1,55,133,136,153,160,217,244,250,352,370,371,407,919,1459},
and this is FCB-invariant. Applying SCB to X gives back the same set, but
with the elements listed in another order:
{1,250,55,244,153,217,352,136,133,160,370,371,407,1459,919}.
The cycles of SCB are recovered from the two lists simply by tracing the orbits
of the various numbers in X; by doing so, we get the following cycles:

These, then, are all the cycles of SCB; there are no cycles of order greater than
3.
Listing the cycles of SFT
We do exactly the same for SFT: we compute the orbit 〈S2; FFT 〉. That is, we
apply SFT to S2 iteratively till we get an "FFT-invariant set”—a set which
remains the same under action by FFT. Using MATHEMATICA we do 60
iterations of SFT on S2, and get the following set Y :
Y = {1,1138,1634,2178,4179,4338,4514,6514,6725,8208,9219,9474,13139},
and this is FFT-invariant. Applying SFT to Y gives back the same set, but with
the elements listed in a different order:
{1,4179,1634,6514,9219,4514,1138,2178,4338,8208,13139,9474,6725}.
It is now an easy exercise to trace out the cycles of SFT; we get the following
list.
These, then, are all the cycles of SFT. (The 7-cycle certainly comes as a
surprise!)
Exercises
14.2.1   Consider the technique described above, which we have used to list
the cycles of SCB and SFT. What makes it work?
14.2.2  Do these ideas throw fresh light on the topic of self referential
numbers? Can a black hole set S be identified for this iteration?
14.2.3   Explain why the card trick described at the start of the book (in
Chapter 1) “works”. (You must explain why the chosen card
invariably ends up exactly in the middle of the pack after four
iterations.)

14.2.4   Apply, the techniques described in this chapter to find the cycles for
the following iterations (use suitable computing facilities; the more
powerful the better!):
f1(n) = sum of the fifth powers of the digits of n when it is written in
base-10, e.g., f1(123) = 15 + 25 + 35 = 276.
If n = (abc…)10, written in base-10, then
f2(n) = (a + 1) × (b + 1) × (c + 1) ×⋯.
For example, f2(123) = 2 × 3 × 4 = 24.
It turns out that f2 has precisely two cycles—a 1-cycle and a 9-cycle.
14.3   The four-numbers iteration
Another theme used in the analysis of iterations is illustrated by the four-
numbers game where the iterative function is
(a,b,c,d)↦(|a - b|,|b - c|,|c - d|,|d - a|).
Define the life of a quadruple to be the number of steps it takes to reach
(0,0,0,0).
Example 1.   The life of (3,4,6,1) is 4, because the trajectory followed by this
seed is:
(3,4,6,1)↦(1,2,5,2)↦(1,3,3,1)↦(2,2,2,2)↦(0,0,0,0)↦⋯.
If (0,0,0,0) cannot be reached from some quadruple, then the life of that
quadruple is considered to be infinite. Our task is therefore to show that every
quadruple of integers has finite life.
We start by noting that for any four numbers a,b,c,d, the life of
(2a,2b,2c,2d) is the same as that of (a,b,c,d). This is so in the orbit of
(2a,2b,2c,2d), every entry is double the corresponding entry in the orbit of
(a,b,c,d), so (0,0,0,0) is reached (if at all) after the same number of steps. More
generally, the life of (ka,kb,kc,kd) is the same as that of (a,b,c,d), for any
positive integer k. To convince yourself of this, compare the orbits of (3,4,6,1)
and (9,12,18,3) (the second quadruple is "3 times" the first one.)

Next, define the height of a quadruple of numbers to be its largest number.
For example.
height (3, 4, 6, 1 ) = 6. height (13,6,19,40)= 40.
The height of (0,0,0,0) is 0. and this is clearly the only quadruple with zero
height. (We consider only quadruples of non-negative integers.)
Exercises
14.3.1 Show that the height of the offspring does not exceed the height of the
parent. In other words, show that if we have (a, b, c, d) → (e, f, g, h)
then
height (e, f, g, h) ≤ height (a, b, c, d).
14.3.2 Let any quadruple of integers be chosen as seed. Show that in at most
four steps we reach a quadruple in which the numbers are all even.
Example 2.  Let the seed be (25,12,10,40) : Its orbit is:
(25,12,10,40)↦(13,2,30,15)(11,28,15,2)
↦(17,13,13,9)↦(4,0,4,8)↦⋯,
so we have reached an all-even-numbers quadruple in four steps.
What you must show is that more than four steps are never needed,
no matter what quadruple we start with.
We now make use of observations made earlier. Suppose that staring with
the quadruple (a,b,c,d), where a,b,c,d are positive integers, within four steps
or less we reach the quadruple (2e, 2f, 2g, 2h) whose entries are all even. We
have already noted that the life of (2e, 2f, 2g, 2h) is the same as that of (e, f, g,
h). What relationship holds between the life of (a, b, c, d) and that of (e, f, g,
h).?
Exercise
14.3.3 Suppose that (a,b,c,d) reaches (2e, 2f, 2g, 2h) in four (or fewer) steps.
Show that the height of (e, f, g, h) is at most half the height of
(a,b,c,d).

Since our interest is only in the life of the quadruple, once we reach a
quadruple whose entries are all even, no essential difference is brought about
if we halve all its entries; that is, if we replace (2e, 2f, 2g, 2h) by (e, f, g, h). The
exercise therefore tells us that in four steps at most, we achieve a halving (or
better) of the height.
Exercise
14.3.4 Show how these observations enable us to conclude that every
quadruple of integers eventually reaches (0,0,0,0).
⋆ ⋆ ⋆ ⋆ ⋆ ⋆ ⋆ ⋆ ⋆ ⋆ ⋆ ⋆ ⋆ ⋆ ⋆ ⋆ ⋆
[You could argue in the following manner. Suppose that the height
of the starting quadruple is less than 1000. Then in at most four
steps, we reach a quadruple with height less than 500, and in at most
four more steps, one with height less than 250. Continuing this line
of argument, we see that in at most forty steps we reach a quadruple
with height less than 1. This can happen only when all the entries are
0, so we have reached our desired destination. What role has the
number 1000 played in this argument? How should the argument be
framed if the numbers in the starting quadruple are 5-digit
numbers?]
Alternative treatment
Another form of presenting the argument is the following. We define a
function f(x) for positive values of x as follows. Consider the quadruples
whose entries are non-negative integers less than x. From amongst these,
select the one with the longest life; its life is then taken to be the value of f(x).
(Note that x itself does not have to be an integer.) For example:
f(1) = 0; for if each number of the quadruple is a non-negative integer
less than 1, the quadruple must be (0,0,0,0), whose life is 0.
f(2) = 4, because within the set of quadruples with largest entry less than
2, the “worst one” (the one with longest life) is (1,0,0,0), whose life is 4.

Exercises
14.3.5 Compute the values of f(0.9),f(1.5),f(3) and f(4).
14.3.6 Show that if x and y are positive numbers with x ≤ y then f(x) ≤ f(y).
14.3.7 Show that if x < 1 then f(x) = 0.
14.3.8 Show that to prove that every quadruple reaches the fixed point
(0,0,0,0) at some stage, it is enough to prove that f(x) has a finite
value for every positive number x.
14.3.9 Show that f(x) ≤ f x 2 + 4 for any x > 0.
14.3.10 Use the inequality proved above to show that f(x) is finite for every
positive number x.
14.3.11 From an earlier chapter you know that if we worked with triples
rather than quadruples, the behaviour of the iteration is quite
different—we do not always reach the fixed point (0,0,0). Where
does the analysis outlined above fail when it is applied to triples? The
operation in this case is:
(a,b,c)↦(|a - b|,|b - c|,|c - a|).
14.3.12 What happens if we introduce fractions into the picture (in other
words, if we consider quadruples of fractions rather than only
integers)? Here is an example with fractions:
2 3, 3 7, 5 12, 3 19↦ 5 21, 1 84, 59 228, 29 57.
Does every quadruple of fractions have finite life?
14.3.13 *  Can the above analysis be extended to quadruples of real numbers?
Prove that it cannot; that is, show that there exist real numbers
a,b,c,d for which the quadruple (a,b,c,d) does not have finite life.
14.3.14 Consider once again the problem of explaining why decimals recur:
i.e., of explaining why for any two positive integers a,b, the decimal
obtained from the division a ÷ b necessarily repeats. (The
“terminating” case may be regarded as one where the repeating
portion has a length of 1; e.g., in the case of 43 ÷ 25 = 1.7200… where
the 0 repeats indefinitely. Also, as the same example shows, the

repeating portion need not start right after the decimal point).
Do the ideas described in this chapter throw fresh light on this
problem?
Concluding comments
It should be clear by now that there is no single “standard” technique for
proving assertions about iterations; contrast the different styles of reasoning
used for the SSQ iteration and the four-numbers iteration. It appears that one
has to mould the approach very finely to the particularities of the iteration
being studied.

Chapter 15
Solving Equations
You may have wondered about how the study of iterations began at all. An
early encounter with iterations comes in the area of solving of equations. This
is the subject of the present chapter.
Linear and quadratic equations in one unknown
The idea of a linear equation in one unknown is surely a familiar one, e.g.,
equations such as 3x + 2 = 8 in the unknown x. Such equations are easy to
solve. For example, the equation 3x + 2 = 8 is solved as follows: 3x + 2 = 8, ∴
3x = 8 - 2 = 6, ∴ x = 2.
Quadratic equations in a single unknown, so-called because of their
squared terms, can also be solved in a standard manner. For example, the
equation x2 - 4x + 3 = 0, in the unknown x, is solved by the standard
technique of “completing the square”: x2 - 4x + 3 = 0, ∴ x2 - 4x + 4 = 1 (by
“completing the square”), x - 2 = ±1 (taking square roots), ∴ x = 1 or x = 3.
Please verify that both x = 1 and x = 3 are solutions of the original equation.
Polynomial equations of higher degree
You may not be familiar with the fact that similar methods (but rather more
complicated) are available for solving third degree and fourth degree
equations (also known respectively as cubic equations and biquadratic
equations or quartic equations); that is, equations such as
x3 - 10x + 1 = 0,x4 - x3 - 100x + 7 = 0.
These methods were found by the “Italian school,” comprising of the trio of

mathematicians Niccolo Tartaglia (1499–1557), Gerolamo Cardano (1501–
1576) and Lodovico Ferrar (1522–1565), and date back to the fifteenth
century, in fact to the early years of the Renaissance. Though these methods
are not too well known at the school level, descriptions can be found in
standard texts, so they can be considered as well known. (We add here, in
passing, that their biographies make for fascinating reading; see
[DUNHAM].)
Other kinds of equations
However not all equations can be solved so simply. Here is one such equation,
in which both exponential and polynomial terms occur:
2x + x2 - 17 = 0.
There is unfortunately no formula that will yield the solution of this equation;
note that guessing is not considered as a formula! In such instances,
mathematicians fall back on graphical approaches, if a rough approximation
is all that is required, or on iterative approaches, if more exact results are
needed. There is nothing much to discuss as regards the graphing alternative;
one simply draws the graph and does the relevant measurements. But as
regards the iteration alternative, a rich scenario awaits us.
15.1  An iterative approach
We illustrate the idea of equation solving via iteration with some simple
examples. The approach in each case will be to make an initial ‘guess’ x0 for
the solution of the given equation, and then to use an appropriately chosen
function f to iterate upon x0.
Example 1. Consider the linear equation 3x + 2 = 8. We rewrite it by
transposing terms as 2x = 8 - 2 - x, i.e., as 2x = 6 - x, and then, after division
by 2, as
x = 6 - x 2 .
Writing f(x) for (6 - x)∕2, the equation reads: x = f(x). So the problem is to find
the fixed points of f! We now construct an iteration sequence 〈x0;f〉 starting
with some convenient seed, say x0 = 0. (This represents the initial ‘guess’.) A

few terms of the orbit are displayed below.
The sequence appears to be converging in an up-and-down manner to a limit
of 2, and this is indeed a fixed point of f, because
f(2) = 6 - 2 2 = 2.
Note that 2 is just the solution which we seek! So the iteration has brought us
very close to the exact answer. By going further down the sequence, we can
improve the accuracy of our estimate to any extent that we may wish to.
(Fifteen iterations yield the estimate 2.00006.)
At first encounter, this may seem to be an absurdly complicated method to
solve an extremely simple equation! (Has life become so simple that we must
now look for ways to complicate it?) However there are more convincing
examples.
Example 2. Consider the quadratic equation x2 - 4x + 3 = 0. By moving some
terms to the other side, we write it as x2 = 4x - 3, and then (after dividing by
x) as:
x = 4 -3 x.
Write f(x) for 4 - 3∕x; we seek a fixed point of f. As in Example 1, we compute
the orbit 〈x0;f〉 of any convenient seed, say x0 = 2; this is our ‘guess’ for the
solution. (We cannot choose x0 = 0 as the expression 4 - 3∕x is undefined
when x = 0.) The resulting sequence is displayed below.
The sequence appears quite visibly to be converging to a limit of 3 (ten
iterations yield the number 2.99997). This number is a fixed point of f,
because
f(3) = 4 -3 3 = 4 - 1 = 3.
If we had chosen the initial estimate to be x0 = 4 we would have obtained:

As earlier, we see a clear convergence to a limit of 3. A few more iterations
will take us much closer to the limit.
It is curious that we have obtained one solution of the equation x2 - 4x + 3
= 0 (though tn approximate form). Is there a choice of seed that will yield the
other solution, x = 1?
Example 3.   Consider the equation x2 = 2. The positive solution of this
equation is x = 2, so solving the equation is the same thing as numerically
finding the square root of 2. To solve the equation by the iterative technique,
we first rewrite it as x∕2 = 1∕x, then (by writing x∕2 as x - x∕2) as x - x∕2 = 1∕x,
and finally as
x = x 2 + 1 x.
Write f(x) for x∕2 + 1∕x; our task is then to find a fixed point of f. The initial
terms of the orbit 〈x0;f〉, with an initial guess of x0 = 1, are displayed here: x1
= 3∕2 = 1.5, and
x2 = 17 12 ≈ 1.417,
x3 = 17 24 + 12 17 = 577 408 ≈ 1.4142,
x4 = 577 816 + 408 577 = 665857 470832 ≈ 1.41421,....
We see that the sequence does seem to converge to 2, and quite rapidly too.
Question. How might the method be adapted to give the square roots of
numbers other than 2?
Example 4.   Consider the cubic equation x3 - x - 100 = 0. We write the
equation first as x3 = x + 100 and then, after taking cube roots, as
x = (x + 100)1∕3
Denote the function (x + 100)1∕3 by f(x); we seek a fixed point of f. As the
computations involve cube roots, we use a calculator or computer. Some
terms of the orbit 〈 1; f 〉 are displayed below.

The sequence appears to be converging very rapidly to the limit 4.7134.
Working to five decimal places (rather than the three decimal places shown
above) gives the limit as 4.71339, and this is indeed “very nearly” a solution of
the given equation, for
4.7133 93 ≈ 104.71339 = 100 + 4.71339.
If we choose the initial estimate to be x0 = 100 (which looks like a terrible
guess!), we obtain the sequence
Remarkably, even after starting so far away from the desired solution, we have
succeeded in reaching its vicinity in just four steps.
Example 5.   We consider a fourth degree equation this time:
x4 - x3 - x2 - x - 1 = 0.
We rewrite the equation first as x4 = x3 + x2 + x + 1, and then as
x = (x3 + x2 + x + 1)1∕4
Let f(x) denote the function (x3 + x2 + x + 1)1∕4; we seek a fixed point of f.
Some terms of the orbit 〈1;f〉 (we have chosen a initial guess of x0 = 1 for the
solution) are displayed below:
The sequence appears to be converging to a limit of about 1.9276. If we
substitute 1.9276 for x in the expression x4 - x3 - x2 - x - 1, we obtain
0.0000481, which looks “reasonably close” to 0, so 1.9276 can be taken as a
good approximation to the solution. Further computations show that a better
approximation is 1.927562. (Note that there are other solutions to the

equation; to be specific, there is a solution close to - 0.7748. How could we
find these solutions iteratively? What should be the choice of seed?)
The rate of convergence was rather slow in this example. However by
rewriting the equation in different ways, the rate can be speeded up
considerably.
Example 6. The equations considered till now have all been reducible to
“nice.” polynomial equations. But the iteration approach yields results even
for equations where exponential and polynomial occur together. For instance,
let us consider the equation
10x = x2 + 96,
whose solution may be found by simple guesswork to be x = 2. We could now
ask whether we can find its solution in some systematic way. Indeed we can;
but we must first rewrite the equation as
x = log10(x2 + 96).
Let f(x) = log10(x2 + 96). Iterating f on an initial seed value of x0 = 0, we get
the following results:
x1 = 1.9823,x2 = 1.9997,
x3 = 1.999995,x4 = 1.99999991,….
It is quite evident that the sequence has a limit of 2. So here too the iteration
approach has yielded the desired result.
Exercises
15.1.1 Use the iteration method to solve the following two equations:
a. x5 - x - 1000 = 0;
b. x7 - x4 - x - 10000 = 0.
15.1.2 Find ways of rewriting the equation
x4 - x3 - x2 - x - 1 = 0
so that the iterative approach yields a solution faster than in Example

5, above. You may want to use the following BASIC program to assist
you in your computations.
REM To solve x∧4 -x∧3 -x∧2 -x - 1 = 0
CLS
DEFDBL X-Y
nmax = 20 : x = 1
PRINT "f(x) = x∧4 -x∧3 -x∧2 -x - 1"
PRINT
PRINT "x","f(x)"
FOR i = 1 TO nmax
  y = x∧4 -x∧3 -x∧2 -x - 1
  x = (x∧3 + x∧2 + x + 1)∧(1∕4)
PRINT x,y
NEXT i
The line x = (x∧3 + x∧2 + x + 1)∧(1∕4)” is under your control;
explore what happens when different expressions are substituted for
the expression on the right side.
15.1.3 Estimate the solution of the equation x1∕2 - x1∕3 = 100 to an accuracy
of four decimal places. (First write the equation in a more convenient
form.)
15.1.4 *  Estimate the solution of the equation xx+1 = (x + 1)x to an
accuracy of four decimal places.
15.2   It looks much too arbitrary!
You may protest at this point, with some outrage, that the manner of writing
the equation so as to obtain a “good” iteration function f(x) seems much too
unclear, and indeed appears perfectly arbitrary. For instance, the equation 3x
+ 2 = 8 could as well have been written as

x = 6 - 2x,
in which form the iteration method fails miserably. To see why, let us
examine compute the sequence 〈1; f〉:
〈1,4, - 2,10, - 14,34, - 62,…〉.
We are clearly not getting even remotely close to the answer (which is 2 in
this case). Even if we start very close to the answer, say at 2.01, things do not
seem to go right; we get the sequence
〈2.01,1.98,2.04,1.92,2.16,1.68,2.64,…〉.
Observe that we are steadily drawing away from the desired answer, instead
of towards it.
The equation x2 - 4x + 3 = 0
The method also fails miserably for the equation x2 - 4x + 3 = 0 if we write it
in the form
x = x2 - 3x + 3.
To see why, write g(x) for x2 - 3x + 3. Some terms of the orbit 〈4; g 〉 are
displayed below:
x0 = 4,x1 = 7,x2 = 31,x3 = 840,x4 = 703083,....
We are caught in runaway inflation! Better results are obtained with x0 = 2:
x0 = 2,x1 = 4 - 6 + 3 = 1,x2 = 1,x3 = 1,....
As we have landed right on one of the solutions of the equation, the question
of convergence does not arise. With x0 = 2.1, however, convergence is
exasperatingly slow, and there is even a hint of a 2-cycle! Some terms of the
orbit 〈2.1;g〉 are displayed below.
Strangely. we do not seem to be “getting anywhere’ at all! Further
computations only confirm this suspicion: we find that x100 ≈ 0.9433 and

x101 ≈ 1.0599. Does the orbit really converge to a 2-cycle? Actually it does not
—but to see why we need to take a much closer look at the function g.
Chapter 16 has some material on how this rather challenging question can be
tackled. (It is again studied in Volume II.)
✫ ✫ ✫ ✫ ✫ ✫ ✫ ✫ ✫ ✫ ✫ ✫ ✫ ✫ ✫ ✫ ✫ ✫ ✫
However, successful results are obtained once again by writing the
equation first as 4x = x2 + 3, and then as
x = x2 + 3 4 .
Let k(x) = (x2 + 3)∕4. Some terms of the orbit 〈2.0;k〉 are displayed below.
The sequence appears to be converging to a limit of 1. Note that this time we
have stumbled, unexpectedly, upon the other solution of the equation!
The equation x2 - 2x + 1 = 0
Another interesting example is provided by the equation
x2 - 2x + 1 = 0,
whose only solution is x = 1 (strictly speaking, this is a “double” root—two
roots have coalesced into one). We write the equation as x = h(x), where
h(x) = x2 + 1 2 .
We shall compute the orbits of 0.9 and 1.1 under iteration by h. A few sample
values are given below.
With a seed value of x0 = 0.9 we find that
and we observe an extremely slow (but definite) convergence to the desired
solution of 1. But if the seed value is x0 = 1.1 then we get totally different
results!

The sequence explodes! If we choose a seed value of x0 = 1.01 we see exactly
the same phenomenon, though more computation is required:
These are indeed curious results !
The equation x2 = 2
In Example 3, if we write the equation as x = 2∕x and choose the iteration
function to be f(x) = 2∕x, the result is rather amusing: the sequence 〈2;f〉 is
〈2,1,2,1,2,1,…〉.
We are caught in a 2-cycle!
The equation 10x = x2 + 96
Lastly, we consider the equation of Example 6; we could also write the
equation a.s
x = 10x - 96.
If we start the iteration with x0 = 2 then of course we stay at the same point
for ever. If however we use the seed value x0 = 3, then we get
x1 = 103 - 96 = 904 = 30.0666,
x2 = 1030.0666 - 96 ≈ 1015,
and we have already lost the game! The same thing happens even if we use a
seed value of 2.1, or 2.01, or 2.001.
Why is the outcome so unpredictable?
A question that poses itself quite naturally at this point is:
Why should the outcome of an iteration be so dependent on how the

equation is written? Why does the iterative method work so
spectacularly well in some instances, and so disastrously in others.?
Much research has been done on this and related questions. Some light will
be shed on the matter in Chapter 16, which examines the issue from a
graphical viewpoint. (It is again studied in Volume II, using calculus.)

Chapter 16
Cobwebbing
In this chapter we describe how graphs can help in understanding the
limiting behaviour of the iteration sequence
x,f(x),f(2)(x) = f ∘ f(x),f(3)(x) = f ∘ f ∘ f(x),...,
where f is a given function defined on set of the real numbers R; specifically,
whether the sequence of iterates converges or not. We shall see how the
condition for convergence has a natural and simple graphical interpretation.
Our approach will to some extent help answer the questions posed in Chapter
15, where we had asked why, in using iterative methods for solving equations,
we meet great success in some situations, and total failure in other situations;
we had wondered then whether we could have anticipated what was going to
happen. Strictly speaking, we need the calculus for our study, but we shall
make do without it for now. (A calculus based study will be done in Volume
II.)
We assume for simplicity. that the iteration function f is smooth; i.e., it does
not have points where the graph is broken or “poky”. We also assume that f
has at least one fixed point. (If not, then the orbit 〈x0;f〉 will not converge for
any x0.)
We now compute the orbit 〈x0;f〉 for some choice of seed x0 and trace its
progress on a graph. The effect is best seen by studying specific examples, and
we proceed to do just this.
Notation. Throughout our discussion we shall use the symbol α to denote a
fixed point of f (so f(α) = α), the symbols ℐ and ℱ to refer to the graphs of y =
x,y = f(x) respectively, where f is the iteration function under study; the two

graphs intersect one another at the point (α,α). (If there is more than one
fixed point, we use β,γ, etc., to refer to them.)
Figure 16.1. Graphs of y = 6 -X 2 and y = x
16.1  Various examples
Example 1.   Let the iteration function be
f(x) = 6 -x 2.
Solving the equation x = f(x) we get the solution x = 4; so the fixed point is α
= 4.
With x0 = 1, the orbit 〈x0;f〉 is
〈1.0,5.5,3.25,4.375,…〉.
The relevant diagram is displayed in Figure 16.1; ℐ and ℱ are the lines y = x
and y = 6 -1 2x, respectively; they meet at (α,α) = (4,4).
The seed x0 = 1 corresponds to the starting point A on ℱ . Since x1 = 5.5,
we seek the point on ℱ with x-coordinate 5.5; we locate this by moving
horizontally from A to B (on ℐ ), then moving vertically (“downwards”) from
B to C (on ℱ ). The first step of the iteration is thus the passage from A to C
(via B).
We now repeat the process: we move horizontally from C to D, then

vertically (“upwards”) from D to E, with D on ℐ and E on ℱ the second step
of the iteration is the passage from C to E, via D. The mechanism of the
procedure should be clear by now. The iteration now takes us to (4.375,
3.813), then to (3.813, 4.094), and so on. A few more steps will serve to
demonstrate, visually and quite convincingly, that the sequence of moves
takes us rapidly to the point (α,α) = (4,4) where ℱ meets ℐ .
Figure 16.2. Cobwebbing with y = 3 - 2x
Remark. The “cobwebby” appearance of the graph should suggest vividly
why the technique is referred to as COBWEBBING. It should be clear that
cobwebbing can be done for any function f; we draw the graphs ℱ and ℐ ,
select a starting point A on ℱ, draw a horizontal line through A to meet ℐ at
B, then a vertical line through B to meet ℱ at C; then we repeat the procedure,
starting from C. The question now is: under what circumstances will this
iterated procedure take us to the point P(α,α) where ℱ meets ℐ ?
Example 2. Here is an example where convergence does not take place. Let
f(x) = 3 - 2x.
Solving the equation x = f(x), we get the solution x = 1; the fixed point is α =
1.
Let x0 = 0.8; then the starting point on ℱ. is A = (0.8,1.4). The iteration
now takes us in succession to the following points on ℱ : C = (1.4,0.2), then to

E = (0.2,2.6),(2.6, - 2.2),(-2.2,7.4), and so on. It is visually quite clear that we
are moving away from the desired point P(α,α) = (1,1); see Figure 16.2.
Example 3. In Chapter 15, we observed how iterative techniques can be used
to numerically solve certain types of equations, e.g., the equation
x3 + x - 100 = 0.
We take a fresh look at this particular equation. We first write it as x = f(x),
with f(x) = 100 - x3. The relevant graphs are shown in Figure 16.3 (the axes
are not drawn to the same scale). The point P = (α,α) which is the point of
intersection of ℱ and ℐ is close to (4.6, 4.6), because 4. 63 + 4.6 = 101.936 ≈
100.
If we start the iteration with x0 = 4, we soon find ourselves in distant lands:
x1 = 100 - 43 = 36,x 2 = 100 - 363 = -46556,....
Even if we start much closer, say with x0 = 4.5, we move away very rapidly:
x1 = 100 - 4.53 = 8.875,x 2 = 100 - (8.875)3 ≈-599.045.
and |x3| is still larger. So here the iteration takes us away from the desired
point P = (α,α) rather than towards it, even when we start very close to P. The
reader may verify that this happens even if the seed value is x0 = 4.6.
However the equation can be written in other forms, e.g, as x3 = 100 - x
and therefore as x = g(x), where
g(x) = 100 - x3.
The graph of g is shown in Figure 16.4 (as earlier, the two axes have different
scales), along with a small fragment of the cobweb. (The portion of the graph
beyond x = 10 has not been shown, as it does not feature in the cobweb.)
We start the iteration with x0 = 0 and obtain the following sequence.
x1 = 1003 ≈ 4.6416,
x2 ≈95.35843 ≈ 4.5686,
x3 ≈96.43143 ≈ 4.5857,
x4 ≈95.41433 ≈ 4.5695….

The spiral zeroes very rapidly to the point of intersection, and we find the
solution of the equation to be approximately 4.56978.
16.2   Dependence on slope
Visually, it is not hard to anticipate that convergence depends quite critically
on the slope of ℱ at the point P(α,α) where ℱ meets ℐ . If the slope exceeds 1
in absolute value, then the angle between ℱ and ℐ is too big, and each step
carries us further away from P rather than towards it. (If we ever get close to P
—"by chance.” so to speak—we get repelled away.) In Figure 16.5 we see a
depiction of this behaviour.
On the other hand if the slope is less than 1 in absolute value, then the
angle enclosed between ℱ and ℐ is acute, and convergence to the fixed point
P does indeed take place; see Figure 16.6.
Figure 16.3. Cobwebbing with f(x) = 100 - x3

Figure 16.4. Cobwebbing with g(x) = (100 - x)1/3
Figure 16.5. |slope| > 1

Figure 16.6. |slope| < 1
What if the slope of f at P is 0?
These comments lead us to anticipate that the smaller the slope of f at P, in
absolute value, the faster will be the rate of convergence. We might expect
therefore that a slope of zero at P(α,α) will make for very impressive results;
and indeed this is the case. The next example demonstrates this behaviour
most powerfully.
Example 4.   We consider the function f given by:
f(x) = x 2 + 1 x.
The equation f(x) = x yields
x = x 2 + 1 x, ∴ x 2 = 1 x, ∴ x2 = 2,
so x = ±2. Let α denote the positive solution, α = 2. It may be shown, via the
use of calculus, that the slope of f at α is 0. (In Figure 16.7 we have sketched
the graph of f, and we are able to visually confirm that the slope of f at the
point of intersection of the two graphs is 0.)
Let x0 = 1; the iterates of x0 under action by f are computed below.
x0 = 1.
x1 = 1.5,
x2 ≈ 1.41667.
x3 ≈ 1.41422.

Figure 16.7. The iteration x↦x 2 + 1 x
x4 ≈ 1.41421356,
x5 ≈ 1.4142135623730950488.
It tums out that x5 agrees with 2 to all the digits shown above! If we carry the
computations to still greater accuracy, we find the following:
x5 ≈ 1.4142135623730950488016896,
2 ≈ 1.4142135623730950488016887,
and |x5 -2|≈ 10-24. The rate of convergence is astonishing! The underlying
reason is simply the fact that the slope of f(x) = x∕2 + 1∕x at x = 2 is 0.
Remark. It may be shown that the rate of convergence here is “quadratic”;
that is, the error at each stage is roughly equal to the square of the error at the
preceding stage. This accounts for the extremely rapid convergence observed
above.
16.3   The case when slope equals ± 1
We still need to find out what happens when the slope is equal to 1 in
absolute value.

Figure 16.8. Trapped in a 2-cycle
If the slope of f at P is - 1, then the angle between ℱ and ℐ is 90∘, so we can
expect at least an approximation to a 2-cycle. This is so because ℱ and ℐ
intersect roughly like the diagonals of a square. The cobweb now resembles
the sides of the square, and we simply move around the boundary of the
square, without any significant progress towards the center, P; so we could get
trapped in a 2-cycle. (See Figure 16.8.) This happens, for instance, if f(x) = 1 -
x and x0 is any seed other than the fixed point 1/2; e.g., x0 = 1∕3 yields the 2-
cycle 〈1∕3,2∕3〉. But this will not always happen.
16.4  The iteration x↦1 - 3x2∕4
A much more interesting example is provided by the function
f(x) = 1 -3x2 4 .
We proceed to study this iteration in some detail. The equation f(x) = x yields
x = 1 -3x2 4 ,∴3x2 + 4x - 4 = 0, ∴(3x - 2)(x + 2) = 0.
The solutions are x = 2∕3 and x = -2. Our interest lies in the positive solution,
and we write α = 2∕3.
The use of calculus shows that the slope of f at 2/3 is - 1. Let us see if the
expected behaviour takes place. Here is the outcome when x0 = 0.9 (we give
only a few selected values):

x10 = 0.845,x11 = 0.465,
x30 = 0.8,x31 = 0.52,
x100 = 0.751,x101 = 0.577.
There is a definite suggestion of a 2-cycle, but the appearances are deceptive;
in fact there is slow convergence to 2/3 (only, it is very slow). The reason
however is not immediately obvious. Here is one way of seeing why—by
examining the second iterate f2. We find that
f2(x) = 1 -3 4 1 -3x2 4 2 = -27x4 - 72x2 - 16 64 ,
and the equation x = f2(x) simplifies, after much simplification, to
27x4 - 72x2 + 64x - 16 = 0.
Factorization now yields the equation
(x + 2)(3x - 2)3 = 0,
whose solutions are x = -2 and x = 2∕3. These are however just the fixed points
of f! So f2 has no fixed points other than those of f, and therefore f has no 2-
cycle.
The graph reveals what is happening. Denoting the graph of f2 by ℱ2, we
find (see Figure 16.9) that ℱ2 is tangent to ℐ at x = 2∕3; and that—this is
crucially important—it lies above ℐ on the left side and below it on the right
side. Visually, it is not hard to see from the graph that if we start the cobweb
at a point to the right of P, the point of intersection, we shall slowly drift
towards P. Exactly the same thing happens when we start at a point to the left
of P. It follows from this that 2/3 is “weakly attracting” from both sides.
Proof of convergence
The fact that the orbit 〈x0;f〉 converges to 2/3 may be shown rigorously as
follows. (The logic is fairly intricate, so brace yourself before plunging ahead!)
We first perform a shift of origin: we work with the sequence 〈un〉 defined
by un = xn - 2∕3 rather than with 〈xn〉; this means that we have to show that
the sequence 〈un〉 converges to 0. The equation connecting un+1 with un is
given by

un+1 + 2 3 = 1 -3 4 un + 2 32, ∴u n+1 = -un -3un2 4 .
Figure 16.9. Graph of f2(x) = -27x4 - 72x2 - 16 64
So the iteration on u is governed by the function g, where
g(u) = -u -3u2 4 .
The fixed points of g are 0 and - 8∕3 (corresponding to the fixed points 0 and –
2 of f); our interest of course lies in the first value.
The two-step iteration on u, i.e., un↦un+2, or u↦g(g(u)), is governed by
the function g2 = g ∘ g given by
g2(u) = --u -3u2 4 -3 4 -u -3u2 4 2 = u -9u3 8 -27u4 64 .
We now establish two basic results.
If 0 < u < 1 2 then 0 < g2(u) < u.
The relation g2(u) < u is clear, as the quantities 9u3∕8 and 27 u4∕64
exceed 0 (since u > 0). To show why g2(u) > 0, we rewrite the relation as
u(64 - 72u2 - 27u3) 64 > 0.
The numerator of the above fraction factorizes in a convenient manner,

and
we rewrite the inequality as
u(3u + 4)(9u2 + 12u - 16) < 0.
If 0 < u < 1∕2, then the factors u and 3u + 4 exceed 0. The roots of the
quadratic factor 9u2 + 12u - 16 (i.e., the points where it takes a value of
0) are
- 12 ±122 + 576 18 , i.e., - 2.1574 and 0.824.
So the quantity 9u2 + 12u - 16 is negative when –2.1574 < u < 0.824. As
the interval from 0 to 1/2 lies within this interval, it follows that 9u2 +
12u - 16 is negative for 0 < u < 1∕2. This yields the stated result.
If -1 2 < u < 0, then u < g2(u) < 0.
This holds because u(3u + 4) and 9u2 + 12u - 16 are both negative when
- 1∕2 < u < 0.
It follows from these two claims that if u0 lies between 0 and 1/2, then the
sequence
u0,u2,u4,u6,u8,...
is steadily decreasing (monotonic decreasing, to use the technical term); also,
the sequence can never go below 0. (it is “bounded below by 0,” to use the
technical term). It is known from higher analysis (we shall say a bit more
about such matters in Volume II) that such a sequence must have a limit, and
here the limit can only be 0. Likewise, if we have - 1∕2 < u0 < 0 then the
sequence
u0,u2,u4,u6,u8,...
is steadily increasing (monotonic increasing), and it is bounded above by 0;
there- fore it has a limit, and the limit must be 0. So if |u0| < 1∕2 then the
iterates of u0 under iteration by g converge to 0, implying that the iterates of
x0 under iteration by f converge to 2/3.
16.5  Two more case studies

In Chapter 15 we had closely analyzed the two iterations
x↦g(x) = x2 - 3x + 3,x↦h(x) = x2 + 1 2 .
Figure 16.10. Graph of g2(x) = x4 - 6x3 + 12x2 - 9x + 3
We now take a closer look at these two iterations.
Observe that α = 1 is a fixed point for both g and h (for g(1) = 1,h(1) = 1).
The use of calculus shows that the slope of g at α is - 1, whereas the slope of h
at this point is 1. We observed earlier that the orbit 〈2.1;g〉 “hovers
contentedly” about the fixed point 1, with little apparent movement either
towards or away from this point. For the function h we observed that the
orbit 〈0.9;h〉 shows a very slow convergence to 1, whereas the orbit 〈1.1;h〉
shows a very slow divergence away from 1. Let us see now whether these
observations could have been anticipated from the respective graphs.
We sketch the graphs of the second iterates (g2 and h2); see Figure 16.10
and Figure 16.11. We find in each case that the graph of the second iterate is
tangent to the line y = x at the point (α,α). But there is a crucial difference
between the two graphs!
For the function g(x) = x2 - 3x + 3, we find that the graph of g2 lies above ℐ

to the left of P, and below ℐ to the right of P (Figure 16.10). So the slow
convergence of the cobweb towards P is a natural and inevitable outcome.
On the other hand, for the function h(x) = (x2 + 1)∕2, we find that the
graph of h2 lies above ℐ on both sides of P (Figure 16.11). So it is natural to
expect that if we start to the left of P, there will be a slow convergence of the
cobweb towards P, whereas if we start to the right of P, there will be a slow
divergence away from P.
Figure 16.11. Graph of h2(x) = x4 + 2x2 + 5 8
The reader should devise more examples of this sort, where the slope of the
iteration function f at the point where y = x (i.e., where it intersects ℐ ) is - 1.
16.6   Concluding remarks
It is indeed quite remarkable that we are able to anticipate so accurately just
how these iterations behave, simply by studying the relevant graphs.
Given our comparative success in this area, there is one further item that
we may feel justified in asking for—an estimate for the speed of convergence,

in the cases where convergence take place. It turns that this too can be done.
But this requires much more analytical machinery (some calculus, and a
deeper understanding of limits). We shall take up the matter in Volume II.

Chapter 17
Memorable Problems from the IMOs
In this chapter we present some memorable problems which have appeared in
the International Mathematical Olympiad.
17.1   Problem IMO 1986/2
Here is a pretty problem in geometry from IMO 1986 (held in Warsaw,
Poland):
A triangle A1A2A3 and a point P0 are given in a plane. We define As =
As-3 for integers s ≥ 4, and construct a sequence of points
P0,P1,P2,P3,P4,…
such that Pk+1 is the image of Pk under a clockwise rotation centered
at the vertex Ak, through an angle of 120∘(k = 0,1,2,…). Prove that if
P1986 = P0, then the triangle A1A2A3 is equilateral.
Solution
As it happens, the only reason why the integer 1986 is used in the problem is
that 1986 is divisible by 3! (Those who are familiar with the IMO will know
that problem posers often use the year of the examination in this manner.)
We need some results from the geometry of transformations; specifically,
about the way that rotations and translations compose with one another. The
main facts needed are given below.
Let A and B be two given points and α and β two given angles. Let f and
g be the rotations centered at A and B respectively, through angles of α

and β (the angles are signed; angles measured in the counter-clockwise
direction are considered to be positive, and angles measured in the
clockwise direction are considered to be negative). Then for the
composite map g ∘ f (which means, “first do f, then do g”), the following
is true: If α + β is a multiple of 360o, i.e., a multiple of a complete rotation,
then g ∘ f is a translation; otherwise, g ∘ f is a rotation centered at the
unique fixed point of the map g ∘ f.
This result may be extended inductively to the case of several such
rotation mappings: if the algebraic sum of the angles of rotation is a
multiple of 360∘, then the composite map is a translation; and in all
other instances it is a rotation.
If f,g are translations, then g ∘ f is a translation.
These results are easily proved, but we shall not go into the proofs here. (The
interested reader is referred to I M Yaglom’s highly readable three volume set
on this topic, Geometric Transformations I,II,III, published by the
Mathematical Association of America.)
In the present problem, let f,g and h refer respectively to the rotations
centered at A1,A2 and A3, each through an angle of 120∘ (i.e., 1/3 of a full
turn), measured clockwise. Let T be the composite operation h ∘ g ∘ f; then T
is a translation, because the sum of the angles of rotation is 360° and
corresponds to a full turn. Clearly
P1986 = T(662)(P 0),
where T(662) refers to the operation T repeated 662 times (note that 662 =
1986∕3 ) . Since T is a translation, so is T(662). The equality P1986 = P0
implies that P0 is a fixed point of this translation. But a translation cannot
have a fixed point unless it is just the identity map (i.e., unless it is a “trivial”
translation). It follows that T(662) is the identity map, and therefore so is T
itself.
This means that h is the inverse of the composite map g ∘ f. But g ∘ f is a
rotation, through 240o, about the unique fixed point of g ∘ f. It is readily
shown that the fixed point of gof is the vertex of the equilateral triangle
constructed on A1A2 as base and oriented suitably. (Please prove this for

yourself.) The map h must be centered at this very vertex, because h = (g ∘ f)
(-1). It follows that △A1A2A3 is equilateral.
17.2   Problem IMO 1987/4
This problem was posed in the International Mathematical Olympiad (IMO)
of 1987, held thaι year in Havana, Cuba. (It was also given as Problem 10.5.5
in Chapter 10.)
Show that there does not exist any function f from the set of natural
numbers, N, into itself, such that f(f(n)) = n + 1987 for all n ∈N.
Solution
Let k be any odd positive integer. We shall show that there is no function f
from N into itself such that f(f(n)) = n + k for all n ∈N. This will settle the
problem at hand, as 1987 is odd.
Let g(n) denote the function n + k. We shall suppose, with the intention of
setting up a “proof by contradiction,” that there does exist a function f from N
into itself such that f∘ = g. We now argue as follows.
The map f must be injective, that is, f cannot map two distinct numbers
to the same number; for if f(m) = f(n), then we get
f(f(m)) = f(f(n)), ∴m + k = n + k, ∴m = n.
Consider the orbits of g. These are k in number, and they may be
depicted diagrammatically thus:
Each of these k orbits extends to infinity on the right side. Note that
there is no path leading into the numbers 1, 2, ..., k. Accordingly, we
shall refer to these orbits as singly-infinite. Clearly these k singly-infinite
orbits exhaust all the elements of N.

Consider the orbits of f. They could be of three types:
– finite, that is, the orbit is a cycle; the cycle cannot have any edges or
trails “sticking out” of it because f is injective;
– singly-infinite, starting from a seed value with no path leading into it;
– doubly-infinite, extending indefinitely in both directions.
Consider now the orbits of f ∘ f. Under two-fold iteration, each singly-
infinite and doubly-infinite orbit of f splits into two orbits of the same
type, consisting of alternate elements of the original orbit. Each EVEN
CYCLE (i.e., a cycle containing an even number of elements) splits into
two cycles, and each ODD CYCLE (i.e., a cycle containing an odd number
of elements) remains a single cycle. (If the cycle is odd, then by taking
every second element we end up enumerating all the elements, only in
some different order.)
It follows that for f ∘ f, the following numbers, if finite, are all even: the
number of singly-infinite orbits; the number of doubly-infinite orbits;
and the number of even cycles having a given cardinality.
Therefore, if the functional equation f ∘ f = g is to be solvable for f, then
g must necessarily satisfy this condition: Each of the following numbers
—if finite—must be even: the number of orbits that are singly-infinite,
doubly-infinite, or finite and of a fixed even length.
The function g being considered in the present problem has k orbits of
the singly-infinite variety, and no orbits of either of the other two
varieties. It follows that if k is odd, such a function cannot exist.
This is a remarkable proof—it is based on considerations of parity and
nothing else!
Generalization
The reader may wish to try proving the following generalization due to N
Martin (MATHEMATICS MAGAZINE, December 1989, page 345, Problem 1308):
Let g be a bijection of N, and let k be any odd positive integer. Then
there does not exist any function f from N into itself, such that

f(f(n)) = g(n) + kforalln ∈N.
17.3   Problem IMO 1988/6
In the IMO of 1988 (held in Canberra, Australia), the following problem
appeared as # 6; it had been proposed by the Federal Republic of Germany.
Let a,b be positive integers such that the quantity
c = a2 + b2 ab + 1
is an integer; show that c is a square.
A numerical instance of the hypothesis of the problem is given by (a,b) =
(2,8), with c = 4; note that 4 is a square.
The paucity of correct responses received subsequently earned for the
problem the title “The Most Difficult Problem Ever Posed At An IMO”. (But
an update is needed on this; readers who are familiar with the olympiads will
know that Problem 6 of IMO 1993 (Istanbul, Turkey) and Problem 5 of IMO
1996 (Mumbai, India) are now strong contenders for the title!) Here we offer
a solution to a generalized version of the problem, and then we consider a few
related problems.
We shall prove the following stronger result which implies the above one.
Theorem 17.1  Let a,b and c be positive integers such that
1 ≤ a2 + b2 - abc ≤ c + 1.
Then the quantity a2 + b2 - abc is a square.
Remark. The case a2 + b2 - abc = c is equivalent to problem IMO 1988/6.
Proof of Theorem 17.1
Let d denote the value of a2 + b2 - abc; then 1 ≤ d ≤ c + 1. We need to show
that d is a square. We anchor the proof on the possible values taken by c.
If c = 1, then d = 1 or 2.
If d = 1, there is nothing to prove (for 1 is a square). The case d = 2
cannot happen, as may be shown by a simple parity-based argument: a2

+ b2 - ab is odd if at least one of a,b is odd, and is a multiple of 4 if a,b
are both even.
If c = 2, then the result follows trivially, for now d = a2 + b2 - 2ab = (a -
b)2.
From this stage onwards we shall assume that c > 2.
If d = 1, there is nothing to prove. If d > 1, we consider the curve Γd ⊂R2
defined by
Γd := {(x,y) : x2 + y2 - cxy = d}.
This is the equation of a hyperbola symmetric in the lines y = ±x. To see why
it is a hyperbola, note that the discriminant is c2 - 4, which is positive since c
> 2, and the quadratic expression x2 + y2 - cxy - d cannot be factorized into
linear factors, so the locus is certainly not the union of two straight lines.
Our interest lies in the lattice points on Γd, of which (a,b) is one such. (A
lattice point is one whose x- and y-coordinates are both integers.) The crucial
observation that we make is the following:
From any one lattice point of Γd, we can iteratively generate infinitely
many such points.
The “iterative generation” is accomplished as described below.
Let A(u,v) be any lattice point on the upper branch of Γd; then v > u. We
move vertically down from A to the line y = x (see Figure 17.1), meeting it at
B(u,u); then we move horizontally from B to Γd, meeting it at C. To find the
coordinates of C, note that the image of A under reflection in the line y = x is
the point A′(v,u) which lies on the lower branch of the curve. So one point of
intersection of the curve and the line y = u is (v,u); that is, one root of the
quadratic equation

Figure 17.1.  Iterative generation of lattice points on the hyperbola x2 + y2 -
cxy = d
x2 - cux + (u2 - d) = 0
is x = v. Since the sum of the roots of the equation is c u, the other root must
be x = cu - v, implying that C = (c u - v,u). Since c ,u,v are integers, it follows
that C is a lattice point. Note that C and A lie on the same branch of the
curve.
So we have moved from (u,v) to (c u - v,u); this is the step which we iterate.
Each such step carries us from one lattice point of Γd to another one, and on
the same branch. As the curve has positive slope at every point, the
movement results in a strict decrease in both coordinates. The iteration
results in an eventual passage into the third quadrant.

❑
An example will make the procedure more transparent. Consider the
solution x = 16,y = 42,c = 3 to the relation
1 ≤ x2 + y2 - cxy ≤ c + 1,x,y,c ∈N.
The value of d = x2 + y2 - cxy is 4 in this case, so the equation of the curve Γd
is x2 + y2 - 3xy = 4. Starting from (16, 42), the path taken by the iteration is
the following:
(16,42)↦(6,16)↦(2,6)↦(0,2)↦(-2,0)↦(-6,-2)↦⋯.
Observe the steady drift into the third quadrant.
⋆ ⋆ ⋆ ⋆ ⋆ ⋆ ⋆ ⋆ ⋆ ⋆ ⋆ ⋆ ⋆ ⋆ ⋆ ⋆ ⋆ ⋆ ⋆
Since d ≤ c + 1, the curve cannot have any lattice points in the interiors of
the second and fourth quadrants; for if (x,y) were such a lattice point, then we
would have
xy ≤-1,x2 + y2 ≥ 2,
implying that 2 ≤ x2 + y2 = cxy + d ≤ 1, which is clearly absurd.
Now it follows from the nature of the iteration that we cannot jump from
the interior of the first quadrant to the interior of the third quadrant in a
single step; for if v > u > 0 then the signs of the second coordinates in (u,v)
and (cu – v, u) are both positive. Also, we are barred from entering the
interior of the second quadrant. Therefore in order to reach the interior of the
third quadrant, we must step upon both the x-axis and the y-axis, i.e., on the
points
0,d, -d,0,
which consequently must be lattice points. It follows that d is a square.
Remark.  The features of the defining equation x2 + y2 - cxy = d that make
this proof "work" are the following:
the equation is quadratic (i.e., with degree 2);
the equation has integral coefficients and is monic; and
the equation is symmetric in x and y.

One often sees these properties made use of in number-theoretic contexts.
(Cubic curves have their own special features, and these can be exploited too.)
A corollary
The following assertion is an easy corollary to Theorem 17.1:
Corollary 17.1  If a,b are a pair of positive integers such that the quantity
c = a2 + b2 + 1 ab + 1
is an integer, then c is of the form k2 + 1 with k ∈N.
Examples of pairs of positive integers satisfying the stated condition are (r,r +
1), for any r ∈N, with c = 2;(2,10), with c = 5;(30,3), with c = 10; and (68, 4),
with c = 17. Observe that the numbers 2, 5, 10 and 17 are all of the form k2 +
1.
More generally, one can assert that, for any given integer q, if the quantity
c = a2 + b2 + q ab + 1
is an integer, then c is of the form k2 + q for some integer k.
More such corollaries can be formulated, and we invite the reader to do so.
17.4   Descendants of IMO 1988/6
Problem 1988/6 has spawned numerous offspring ! We consider some of
them here.
Theorem 17.2  If a,b ∈N are such that the quantity
c = a2 + b2 ab - 1
is an integer, then c = 5.
Examples of pairs (a,b) for which (a2 + b2)∕(ab - 1) is an integer are (1, 2), (1,
3), (2, 9) and (3, 14); note that c = 5 in each case.
Proof of Theorem 17.2
Let Γc denote the curve

{(x,y) : x2 + y2 - cxy + c = 0}.
Observe that if Γc is to be non-empty, then we must have c ≥ 3; for if c = 1 or
2, then x2 + y2 - cxy > -c for all x,y > 0. Thus we may assume that c ≥ 3.
Under this condition, Γc is a hyperbola with asymptotes
y = (c + c2 - 4)x 2 ,y = (c -c2 - 4)x 2 .
Figure 17.2.  Iteratively generating lattice points on the hyperbola x2 + y2 - cxy
+ c = 0
The curve is symmetric with respect to the lines y = ±x; it has two branches,
one each in the first and third quadrants. One branch is shown in Figure 17.2
(this is the branch we shall be concerned with.)
The lattice points on Γc correspond exactly to the pairs of positive integers
(a,b) for which a2 + b2 = c(ab - 1). It is easy to verify that

❑
(u,v) ∈ Γc ⇔ (cu - v,u) ∈ Γc.
This is just the reflection iteration as applied to this problem; as in Theorem
17.1, the basic step consists of a movement from (u,v) to (cu – v,u) via the
intermediate point (u,u) (this acts as the “stepping stone”). By iterating the
procedure, we obtain from any one lattice point on Γc infinitely many such
points.
For example, consider the point (9, 43) on Γ5; its orbit is given below:
(9,43)↦(2,9)↦(1,2)↦(3,1)↦(14,3)↦(67,14)↦⋯.
Observe that the orbit stays on the first-quadrant branch of the curve during
the course of the iteration. This will clearly always be the case (jumping from
one branch to the other is not possible), and it implies that at some point the
orbit “turns” around the first-quadrant vertex of Γc, namely the point
c c - 2, c c - 2.
If the curve is imagined to be the orbit of a comet, then this point would
correspond to the perihelion of the orbit!
Since c ≥ 3, the vertex lies in the interior of the segment connecting the
lattice points (1, 1) and (2, 2). A close look at the geometry of the iteration
will show that in order to turn “around the corner,” we must at some stage
use (1, 1) as one of the stepping stones, for it happens to be the only lattice
point available for the task. This implies that the line x = 1 intersects Γc at
lattice points. Therefore the roots of the quadratic equation
y2 - cy + (c + 1) = 0
are both integral. Since the discriminant of this quadratic equation is c2 - 4c -
4, it follows that c2 - 4c - 4 is a square. Now c2 - 4c + 4 = (c - 2)2 is a square
too, so we have at hand a pair of squares differing by 8.
It may be shown that the only pair of squares that differ by 8 are 1 and 9;
for, if we have u2 - v2 = 8, then u - v and u + v are complementary factors of
8, so (u + v,u - v) = ±(8,1),±(1,8),±(4,2) or ± (2,4). The first two possibilities
do not work out, as they yield values of u and v that are not integral; the other
possibilities yield the stated assertion. We conclude that (c - 2)2 = 9, ∴c - 2 =
±3. Since c > 0, we get c = 5.

Theorem 17.3   If a,b ∈N are such that the quantity
c = a2 + b2 + 1 ab
is an integer, then c = 3.
Examples of pairs (a,b) for which (a2 + b2 + 1)∕ab is an integer are (1,1),(2,1),
(5,2) and (13,5); note that c = 3 in each case.
Theorem 17.4  If a,b ∈N are such that the quantity
c = a2 + b2 + 6 ab
is an integer, then c = 8.
Examples of pairs (a,b) for which (a2 + b2 + 6)∕ab is an integer are (1, 1), (7,
1), (55, 7) and (438, 55); note that c = 8 in each case.
Theorem 17.5   If a,b ∈N are such that the quantity
c = a2 + b2 + 10 ab
is an integer, then c = 12.
Examples of pairs (a,b) for which (a2 + b2 + 10)∕ab is an integer are (1, 1), (11,
1) and (131, 11); note that c = 12 in each case.
Theorem 17.6  If a,b ∈N are such that the quantity
c = a2 + b2 + 8 ab
is an integer, then c = 6,10 or 14.
Examples of pairs (a,b) for which (a2 + b2 + 8)∕ab is an integer are (1, 1), (2,
2), (3, 1), (6, 2), (9, 1), (17, 3) and (22, 6); note that c = 6,10 or 14 in each case.
⋆ ⋆ ⋆ ⋆ ⋆ ⋆ ⋆ ⋆ ⋆ ⋆ ⋆ ⋆ ⋆ ⋆ ⋆ ⋆ ⋆ ⋆ ⋆
We leave the proofs of Theorems 17.3, 17.4, 17.5 and 17.6 to the reader; the
same strategy may be followed as earlier, in each case.
Theorem 17. 7   If a and b are positive integers such that a2 + b2 - a is divisible
by 2ab, then a is a perfect square.
Examples of pairs (a,b) for which a2 + b2 - a is divisible by 2ab are (1,2k) for
any k ∈N,(4,6),(9,6),(9,12),(16,12) and (16, 20); note that a is a perfect square

in each case.
This result once appeared as a problem in the British Mathematical
Olympiad (BMO).
Proof of Theorem 17.7
Though the strategy we use in this proof is essentially the same as earlier, the
exposition will be a bit different; we shall not refer explicitly to the associated
graph.
Let a and b be positive integers such that a2 + b2 - a is divisible by 2ab; say
a2 + b2 - a = 2kab     (k is some integer).
Note that we cannot have k = 0, because a2 + b2 - a = a(a - 1) + b2, which is
positive. If k = 1, then we get a = a2 + b2 - 2ab = (a - b)2, which is a square, as
required.
So we may assume in our analysis that k > 1. In the exposition below, k
refers to any fixed positive integer exceeding 1 for which there exist positive
integers a and b such that 2ab is a divisor of a2 + b2 - a.
We cannot have a = b; for this equality leads to - a = (2k - 2)a2, which is
absurd as the quantity on the left side is negative whereas the quantity on the
right side is positive. Therefore, a≠b.
Next, observe that
a|a2 - a - 2kab = b2, ∴a|b2,
b|b2 - 2kab = a - a2, ∴b|a2 - a.
So both b2∕a and (a2 - a)∕b are non-negative integers. This implies in
particular that if b = 1 then a = 1 too; but this does not fit, so we must have b
> 1.
Now the relation x2 + y2 - 2kxy - x = 0 may be regarded as a quadratic
equation in either x or y by writing it as
x2 - (2ky + 1)x + y2 = 0,    or    y2 - (2kx)y + (x2 - x) = 0.
If we regard the first equation as a quadratic equation in x, then the product

of its roots is y2. Similarly, if we regard the second equation as a quadratic
equation in y, the product of its roots is x2 - x. It follows that if the integer
pair (x,y) satisfies the relation x2 + y2 - 2kxy - x = 0, then so do the pairs
y2 x ,y, x, x2 - x y .
The divisibility relations derived earlier show that these are in fact pairs of
integers. Of significance too is the fact that if 0 < x < y then
y2 x > x,0 ≤ x2 - x y < y,
and if 0 < y < r then
0 < y2 x < x,x2 - x y ≥ x.
Let H and V denote maps (‘H’ for ‘horizontal’, ‘ V ’ for venical’; think of the
associated graph) which operate on the non-negative solutions (x,y) of the
relation x2 + y2 - 2kxy - x = 0, as follows: if y > 0 (in which case we must also
have x > 0), then
(x,y)→H y2 x ,y,(x,y)→V x, x2 - x y .
If y = 0 then we must have x = 1 or 0, so we complete the definition by
writing:
(1, 0 ) →H(0,0),(1, 0 ) →V(1,2k),
(0,0)→H(1,0),(0,0)→V(0,0).
Note that these maps are self-inverse: H ∘ H = V ∘ V = the identity map.
(Such maps are known as involutions.)
The map V ∘ H is given by (x,y) →V oH (x′,y′) where
x′ = y2 x ,y′ = y4∕x2 - y2∕x y = y3 x2 -y x,
and the map H ∘ V is given by (x,y) →HoV (x″,y″) where
x″ = (x2 - x)2∕y2 x = x(x - 1)2 y2 ,y″ = x2 - x y .
So the iteration f that we apply to the non-negative solution pairs (x,y) of the
relation x2 + y2 - 2kxy - x = 0 works as follows:
if 0 ≤ y < x then f = V ∘ H; the output is the pair (x′,y′);

❑
if 1 ≤ x < y then f = H ∘ V ; the output is the pair (x″,y″);
if both x and y are 0, then the output is (0,0).
So we have at hand a valid iteration scheme. The crucial point is that given
any solution pair (x,y) with x > 1 (note that this condition forces y to be
positive), we can apply f and get another solution pair (x1,y1) with 0 < x1 < x.
This step can be repeated, provided that x1 > 1. The iteration may be
continued in this manner, and we get a sequence of steadily decreasing
positive integers. Clearly, this cannot be continued indefinitely; the iteration
must come to a halt at some point. This will happen when we reach a pair of
the form (1, yk ) for some positive integer yk. But we have
(1,yk) →V (1,0)→H(0,0).
Therefore, to any non-negative solution (x,y) of the relation x2 + y2 - 2kxy - x
= 0, we can apply some sequence of H’ s and V ’s which will take us to the pair
(0, 0).
Now we simply back-track—by applying the reverse sequence of V ’s and
H’s to the pair (0,0); we get
(0,0)→H(1,0)→V(1,2k)→H(4k2,2k)→V⋯.
Observe that the first member of each pair is a square. This will always be the
case; for if x is a square and x|y2, then y2∕x too is a square.
The reverse sequence must reach the starting pair (a,b) at some point, and
this means that a is a square. Our analysis has, incidentally, found a way of
enumerating all solutions of the given equation.
17.5   Exercises
17.5.1 Prove Theorem 17.3.
17.5.2 Prove Theorem 17.4.
17.5.3 Prove Theorem 17.5.
17.5.4 Prove Theorem 17.6.

Chapter 18
Miscellaneous Problems
In conclusion, we consider a few challenging iteration problems which have
appeared in the Olympiads and the problems sections of journals such as
CRUX MATHEMATICORUM (published by the Canadian Mathematical Society,
CRUX for short; we note in passing that CRUX has a very active and popular
Olympiad Corner featuring problems from Olympiads the world over.) In a
few of the problems there may seem to no iteration involved; but that is by
design: the problems have been posed in such a way as to mask the
connection! (For olympiad problem posers, this is of course a well known
stratagem!)
The approaches used to solve the problems encompass a lot of diversity
and possess considerable instructional value; we urge the reader to make a
close study of the techniques used.
Please try to solve the problems on your own!
Problem 1 (Spanish Mathematical Olympiad, 1973)
Find the real numbers x1,x2,…,xn satisfying the following equations:
x12 + 3x 1 + 1 = x2,
x22 + 3x 2 + 1 = x3,
x32 + 3x 3 + 1 = x4,
⋯⋯⋯ = ⋯
xn-12 + 3x n-1 + 1 = xn,

xn2 + 3x n + 1 = x1.
Problem 2
Find all triples (x,y,z) of real numbers such that y = 4x3 - 3x,z = 4y3 - 3y and x
= 4z3 - 3z.
Problem 3 (from CRUX)
Let functions f,f1,f2,… be defined on N as follows: f(n) = (SUM(n))2 is the
square of the sum of the digits of n (written in base-10), and for integers k ≥
1,fk(n) is the k-fold iterate of f acting on n; i.e.,
fk(n) = f(k)(n) = f(f(f(⋯f(n))))︸ ktimes.
For example, f1(25) = 49,f2(25) = f(49) = 169, and so on.
Problem. Compute f1991(21990). (The problem is from CRUX.)
Problem 4
Let f be a function from R into R defined as follows: f(x) = x2- 2. Show that
there is no function g from R into R such that g ∘ g = f; in other words, that
there is no real-valued function g such that g(g(x)) = x2 - 2 for all x ∈ R.
This problem was posed in Chapter 10 (Problem 10.5.4).
Problem 5 (Irish Mathematical Olympiad, 1991)
Three operations a,b and c are defined as follows:
a(n) = 10n (for all n ∈N);
b(n) = 10n + 4 (for all n ∈N);
c(n) = n∕2 (for even n ∈N).
Prove that starting from 4, every natural number can be obtained by
performing a finite number of the operations a,b and c in some order.
Problem 6 (Putnam Competition, December 2000)

Let f(x) be a polynomial with integer coefficients. Suppose that f has a cycle C
containing an integer entry. Show that the length of C is either 1 or 2.
You may now turn the page for the solutions!
Figure 18.1.  Graphs of y = x2 + 3x + 1 and y = x
Solution of Problem 1
We shall show that this is essentially an iteration problem in disguise and
solve it accordingly. Write f for the following function which acts on R:
f(x) = x2 + 3x + 1.
Then the given system is equivalent to:
x2 = f(x1),x3 = f(x2),...,xn =f(x1),x1 = f(xn).
So the problem is to find the n-cycles of f, for any given positive integer n.
Now observe that
f(x) = (x2 + 2x + 1) + x = (x + 1)2 + x ≥ x.
The inequality sign holds because (x + 1)2 is a square and so is non-negative.

(See Figure 18.1 for the graphical expression of this inequality.) Equality
holds if and only if x + 1 = 0, i.e., iff x = -1. It follows from this that
f(x) ≥ x,
f(f(x)) ≥ f(x) ≥ x,
f(f(f(x))) ≥ f(f(x)) ≥ f(x) ≥ x,...,
Figure 18.2.  Graphs of y = 4x3 - 3x and y = x
and the equality sign holds in this chain of inequalities if and only if x = -1. So
by iterating f on any starting number x≠ - 1, we will have
x < f(x) ≤ f(f(x)) ≤ f(f(f(x))) ≤ f(f(f(f(x)))) ≤⋯,
implying that if x≠ - 1, then x < fn(x) for every n ∈ N. Therefore if x = fn(x),
then it must be that x = -1, in which case x = fn(x) for every n.
So f has precisely one 1-cycle, 〈-1〉, and no higher order cycles. Therefore
for any given n ≥ 1, the only solution to the given system of equations is
x1 = x2 = ⋯ = xn-1 = xn = -1.
Solution to Problem 2

Let P(x) denote the polynomial 4x3 - 3x. The question asks in effect for the 1-
cycles and 3-cycles of P. The 1-cycles are easily found; the equation x = P(x)
or x = 4x3 - 3x yields x = 0.1,-1, so there are precisely three 1-cycles.
To find the 3-cycles, note that if x > 1 then 4x3 > 4x,   ∴P(x) > x; and if x <
-1 then 4x3 < 4x, ∴P(x) < x. Moreover, P maps the interval I = [-1,1] on
itself. These claims are easy to verify using the graph of P (see Figure 18.2), so
we do not give any formal proofs. From them we infer that the cycles of P (if
any) are entirely contained in the set I.
We now draw on the trigonometric formula
cos3t = 4cos3t - 3cost,
and the fact that cosx decreases steadily from 1 to –1 as x increases from 0 to
π. For any number x ∈ [-1,1], there exists a unique number t in the interval J
= [0,π] such that x = cost. Supposing that x ∈ I is part of a 3-cycle, we write x
= cost where t ∈ J; then we have
P(x) = cos3t,P ∘ P(x) = cos9t,P ∘ P ∘ P(x) = cos27t.
Since x belongs to a 3-cycle, we have cos27t = cost. All we need to do now is
to solve this equation over J! The only possibilities are:
27t - t = 0,2π,4π,6π,…; i.e., 26t is an even multiple of 2π, so:
t = 0, π 13,2π 13 ,3π 13 ,⋯, 12π 13 ,π;
27t + t = 0,2π,4π,6π,…; i.e., 28t is an even multiple of 2π, so:
t = 0, π 14,2π 14 ,3π 14 ,…,13π 14 ,π.
The desired x-values are simply the cosines of these numbers. Since cosθ =
cos(2π - θ) for any θ, the distinct values of x so obtained are, respectively,
x = cos0,cos π 13,cos 2π 13 ,…,cos 12π 13 ,cos 13π 13 ,
x = cos0,cos π 14,cos 2π 14 ,…,cos 13π 14 ,cos 14π 14 .
The 1-cycles correspond to t = 0,π∕2 and π (giving x = 1,0 and − 1
respectively), and the other t-values yield 3-cycles. So the 3-cycles are all of
the form 〈x,y,z〉, where x = cosnπ∕13 with n = 1,2,3,…,12, or x = cosnπ∕14
with n = 1,2,3,...,...,13, and y = P(x),z = P(y). There are 24 x-values, and they

yield eight 3-cycles (they obviously get grouped into sets of three each).
For example, x = cosπ∕13 yields the 3-cycle
cos π 13,cos 3π 13 ,cos 9π 13 ≈〈0.970942,0.748511, - 0.568065〉,
and x = cos3π∕14 yields the 3-cycle
cos 3π 14 ,cos 9π 14 ,cos 27π 14 ≈〈0.781831,-0.433884,0.974928〉.
Solution of Problem 3
We shall solve the problem by finding the cycle structure of f.
Let an = fn(21990); then a0 = 21990. We are required to compute a1991.
Observe that since SUM (k) ≡ k (mod 9) for any integer k, we have
f(k) ≡ k2(mod9) for all integers k ≥ 1.
From this it follows that for all n ≥ 1,
an+1 ≡ an2(mod9).
Next, note that, modulo 9, we have:
21 ≡ 2,22 ≡ 4,23 ≡ 8,24 ≡ 7,25 ≡ 5,26 ≡ 1,
27 ≡ 2,28 ≡ 4,29 ≡ 8,210 ≡ 7,211 ≡ 5,212 ≡ 1,
and so on. So the remainders of the powers of 2, listed modulo 9, form the 6-
cycle 〈2,4,8,7,5,1〉. Since 1990 is of the form 4 (mod 6), we get:
21990 ≡ 7(mod 9).
So a0 ≡ 7 ≡-2(mod9). Since an+1 ≡ an2(mod9) we have, modulo 9:
a1 ≡ 4,a2 ≡ 7,a3 ≡ 4,a4 ≡ 7,
a5 ≡ 4,a6 ≡ 7,a7 ≡ 4,a8 ≡ 7,….
The pattern is immediately visible; we see that for n ≥ 1,
an ≡ 4(mod9)ifnisodd, 7(mod 9) if nis even .
Now we observe the following inequalities:
a0 = 21990 < 10600,

∴ a1 < (9 × 600)2 < 108,
∴ a2 < (9 × 8)62 < 104,
∴ a3 < (9 × 4)2 = 1296,
∴ a4 < (9 × 3)2 = 729.
We conclude from this that an < 729 for all n ≥ 4.
The largest SUM for integers not exceeding 729 occurs for the integer 699,
whose SUM is 24, so:
SUM(an) < 24 for all n ≥ 4.
This implies that an < 576 for all n ≥ 5. The largest SUM for integers not
exceeding 576 occurs for the integer 499, whose SUM is 22, so:
SUM (an) < 22 for all n ≥ 5.
This implies that an < 484 for all n ≥ 6. The largest SUM for integers not
exceeding 484 occurs for the integer 399, whose SUM is 21, so:
SUM (an) < 21 for all n ≥ 6.
It follows that an < 441 for all n ≥ 7.
We have indeed achieved a huge reduction in size: starting from 21990
(which has six hundred digits!), we have reached numbers not exceeding 441.
It should be clear that once we reach a number below 441, we shall never go
above that figure. So the set of integers below 441 is a “black hole set” or a
“basin of attraction” for the function f.
In fact, a whole lot more can be said. We showed above that an ≡ 4 (mod
9) if n is odd, and an ≡ 7 (mod 9) if n is even. We deduce from this that
SUM (an) ≡ 4(mod9)ifnisodd, 7(mod 9) if nis even .
Since further we know that SUM(an) < 21 for all n ≥ 6, we see that for n ≥ 6, if
n is odd, then SUM (n) = 4 or 13, and if n is even, then SUM(n) = 7 or 16.
Since an+1 = (SUM(an)) 2 we further get:
ifn ≥ 7iseven,an = 16or169, ifn ≥ 7isodd,an = 49or256.
Finally, since (4 + 9)2 = 169 and (2 + 5 + 6)2 = 169, we get:

ifn ≥ 8iseven,an = 169. ifn ≥ 8isodd,an = 256.
This means that f has precisely one cycle!—the 2-cycle 〈169,256〉. Since every
orbit must fall into this cycle sooner or later, it follows that f1991(21990) =
256.
Solution to Problem 4
We start by making a few general observations. Our approach is much the
same as the one used to solve the IMO 1987 problem in the preceding
chapter.
Let f : R →R be any function. Consider the relation between the cycles of f
and those of f ∘ f. As pointed out in Chapter 17, under action by f, each even
cycle C of f splits into two subsets of equal cardinality, say C1 and C2, each of
which is a cycle of f ∘ f (moreover, C1 and C2 consist of alternate elements of
C). On the other hand, an odd cycle C remains intact under action by f; for,
by selecting the alternate elements of the cycle, we end up selecting all the
elements. So C is a cycle of f ∘ f as well as of f.
Moreover, every cycle of f ∘ f arises in this manner. We deduce from this
the crucial finding that every even cycle of f ∘f has a mate, namely another
cycle with the same number of elements, such that the two can be woven
together to give a cycle of f. So for each fixed even number k, the number of
cycles of f ∘ f with k elements must be an even number. Accordingly, we
arrive at the following general principle.
If for a given function g : R →R and some even integer k , it is the case
that the number of k-cycles of g is odd, then there cannot exist any
function f : R →R such that g = f ∘ f.
We apply this general principle to the problem at hand. Let g(x) = x2 - 2.
Solving the equation x = g(x) we find the 1-cycles of g to be 〈-1〉 and 〈2〉. For
the 2-cycles we examine the equation x = (x2 - 2)2 - 2. The equation simplifies
to
x4 - 4x2 - x + 2 = 0, ∴ (x - 2)(x + 1)(x2 + x - 1) = 0.
The solution set of this is {-1,2,α,-1∕α}, where
α = 5 - 1 2 .

We have already seen that - 1 and 2 correspond to the 1-cycles of g. (Observe
how the odd cycles of g ∘ g correspond to the odd cycles of g.) On the other
hand,
g(α) = α2 - 2 = -α - 1 = -1 α,
g -1 α = 1 α2 - 2 = 1 α - 1 = α,
so 〈α,-1∕α〉 is a genuine 2-cycle of g; and it is the only 2-cycle; therefore, the
number of 2-cycles is odd. Invoking the general principle proved above, we
see that there does not exist any function f from R into itself such that f ∘ f =
g. This proves the assertion.
Remark. Note that this is a parity based argument. Simple considerations can
yield far-reaching results!
Solution to Problem 5
We turn the problem “upside down” and formulate it as a “Collatz-type”
problem, as follows.
Let the function f be defined on N0 = N ∪{0} thus:
f(n) = n∕10 if n is a multiple of 10; (n - 4)∕10if n is of the from 4(mod 10); 2n
else.
Show that for any integer n, the orbit of n under iteration by f contains
the number 4.
Examples of f-orbits are:
11↦22↦44↦4↦⋯;
13↦26↦52↦104↦10↦1↦2↦4↦⋯;
18↦36↦72↦144↦14↦1↦2↦4↦⋯.
Observe that we have “hit” 4 in each case.
Strictly speaking, this problem is not logically equivalent to the original
one, but it does imply the desired result. (If we reverse the path taken by any
number n to 4, we get the desired route.)

We first claim that the only fixed point of f is 0. To see why, observe that if
n is a non-zero multiple of 10 or of the form 4 (mod 10), then f(n) < n; and if
n is non-zero and not a multiple of 10, nor of the form 4 (mod10), then f(n) >
n.
Since f(4) = 0, and 0 is the only fixed point of f, we may further reformulate
the assertion to be proved thus: The orbit of any positive integer n under action
by f ultimately reaches the 1-cycle 〈0〉. This is the assertion that we shall
prove.
Table 18.1 displays, for n ≡ 0,1,2,…,8 and 9 (mod 10), a relevant member
of the orbit of n, along with its parity; we have written fr for the r-fold iterate
of f, with f1 = f.
The crucial observation that can be made from the table is this: If n ≡ 0,1,2,
..., 7 or 8 (mod 10), then in 4 steps at most we will reach an even number which
is strictly smaller than 4n∕5.
If n ≡ 9(mod10), however, the conclusion does not hold; we have f5(n) =
(8n - 2)∕5, which exceeds n. However note that f5(n) is even. So the following
holds: If n is of the form 9 (mod 10), then in 5 steps we reach an even number
n1 which is strictly smaller than 8n∕5. We shall use this observation to proceed.
Clearly, n1 ≡ 0,2,4,6 or 8 (mod 10). We consider the various possibilities.
If n1 ≡ 0 or 4 (mod 10), then in 1 more step we reach a number n2 for
which the following holds: n2 ≤ n∕10 < 8n∕50 < n.

Table 18.1.  Tracing the path taken by n
If n1 ≡ 2,6 or 8 (mod10), then in 4 more steps at most we reach an even
number n2 for which the following holds: n2 < 4n1∕5 < 32n∕25. (This
follows from the observation made above.)
In the latter case we cannot be sure that n2 is less than n; more iterations are
required, so we consider the different forms that n2 can take. We have now:
If n2 ≡ 0 or 4 (mod 10), then in 1 more step we reach a number n3 for
which the following holds: n3 ≤ n2∕10 < 32n∕250 < n.
If n2 ≡ 2,6 or 8 (mod 10), then in 4 more steps at most we reach an even
number n3 for which the following holds: n3 < 4n2∕5 < 128n∕125.
In the latter case we continue to be “above” n; so we consider the different
forms that n3 can take. We have:
If n3 ≡ 0 or 4 (mod 10), then in 1 more step we reach a number n4 for
which the following holds: n4 ≤ n3∕10 < 128n∕1250 < n.
If n3 ≡ 2,6 or 8 (mod 10), then in 4 more steps at most we reach an even
number n4 for which the following holds: n4 < 512n∕625 < n.

So for all n, in at most 5 + 4 + 4 + 4 = 17 steps we reach a number n′ which is
strictly smaller than n. This allows for a neat finish to the analysis. We use the
following lemma (in the statement, N0 means N ∪{0}).
Lemma 18.1  Let g be a mapping from N0 into N0, with g(0) = 0. Suppose that
there exists a positive integer k such that for every n for which g(n) is positive,
we have g(n + i) < g(n) for some i in the set {1, 2, …,k } ; then, under g-
iteration, every orbit ultimately reaches 0.
The proof is not hard. Steady reduction occurs every k steps at most, so,
starting at n where g(n) > 0, in at most kg(n) steps we must hit 0.
The function f in our problem has all the features required by the lemma,
with k = 17. The result follows: every orbit reaches 0 at some stage.
Solution of Problem 6
The claim that for a polynomial f(x) with integer coefficients, the length of a
f-cycle C containing an integer entry can only be 1 or 2 looks surprising, but
it can be proved rather easily. We only need the following result: If f(x) is a
polynomial with integer coefficients, and a and b are unequal integers, then a -
b is a divisor of f(a) - f(b). This is so because a - b is a divisor of an - bn for
every positive integer n.
Let C be f-cycle containing an integer entry; then the entries of f are all
integers. Let the cycle be 〈a1,a2,a3,…,ak〉, for some integer k ≥ 1. Of course,
the ai’s are unequal. By definition, we have
f(a1) = a2,f(a2) = a3,⋯,f(ak-1) = ak,f(ak) = a1.
We shall suppose that k ≥ 3, and derive a contradiction.
Let b1 = a2 - a1,b2 = a3 - a2,⋯,bk-1 = ak - ak-1,bk = a1 - ak. Then the bi are
all non-zero integers. Using the divisibility result quoted earlier we get
b1|b2,b2|b3,bk-1|bk,bk|b1,
and therefore,
|b1|≤|b2|≤|b3|≤⋯ ≤|bk|≤|b1|.
Since the initial and last terms in this string of inequalities are identical, the

❑
various ‘ ≤’ signs must all become equalities; so we get
|b1| = |b2| = |b3| = ⋯ = |bk|.
So we have:
|a2 - a1| = |a3 - a1| = |a4 - a3| = ⋯ = |ak - ak-1| = |a1 - ak|.
Since a1,a2,a3,⋯,ak are all unequal, this implies that
a2 - a1 = a3 - a2 = a4 - a3 = ⋯ = ak - ak-1 = a1 - ak.
Let a2 - a1 = d; then we get a2 = a1 + d,a3 = a1 + 2d, and so on; and finally, ak
= a1 + (k - 1)d, which means that
a1 - ak = -(k - 1)d, ∴d = -(k - 1)d.
But this equation is clearly impossible. So we cannot have k ≥ 3. It follows
that k = 1 or 2.
Note that k = 1 or 2 does not give rise to any contradiction. The former
merely means that f has an integral fixed point, and this is clearly possible.
The latter means that we have
f(a1) = a2,f(a2) = a1.
There is no difficulty with this either. For example, we can have f(x) = -x, for
which 〈a,-a〉 is a 2-cycle for any real non-zero number a, and in particular for
any positive integer a.

Appendix A
Further Reading
There are unfortunately relatively few books on the topic of iteration
which are suitable for students at the high-school level. The reader will
notice that many of the references are for the topic of fractals rather than
on iteration per se. (Some of the pieces are from journals rather than
books.)
[DAVIS]
Davis, C and Knuth, D E. Number representations and
dragon curves, in JOURNAL OF RECREATIONAL
MATHEMATICS, Volume 3, pages 66–81 and 133–149.
[DUNHAM]
Dunham, William. JOURNEY THROUGH GENIUS
(Mathematical Association of America).
[GLEICK]
Gleick, James. CHAOS: MAKING A NEW SCIENCE (Viking,
New York, 1987).
This was a best seller in its time, and presents a popular
account of the manner in which the theory of chaos
developed; highly recommended.
[HOFSTADTER]
Hofstadter, Douglas. Strange Attractors: mathematical
patterns delicately poised between order and chaos, in
SCIENTIFIC AMERICAN, Volume 245 (November), pages
281–291.

[MANDELBROT]
Mandelbrot, Benoit. THE FRACTAL GEOMETRY OF NATURE
(W H Freeman, 1982).
This is a very famous and much acclaimed book, and it
presents a new way of viewing nature, beginning with the
much-quoted words “Clouds are not spheres, mountains
are not cones, coastlines are not circles, and bark is not
smooth, nor does lightning travel in a straight line”.
[SMITAL]
Smital, Jaroslav. FUNCTIONS AND FUNCTIONAL EQUATIONS
(Poland).
This is a more advanced text, but is extremely well-written
and informative.
[VILENKIN]
Vilenkin, N Ya. THE METHOD OF SUCCESSIVE
APPROXIMATIONS (MIR Publishers, Moscow). 
This is part of the ‘Little Mathematics Library’ (a series of
books published in the former Soviet Union) and is an
excellent buy. It discusses in detail the theme introduced
in Chapter 15: that of solving equations using the
iteration. In particular, it answers the question asked in
the chapter, namely: When does the technique of iteration
work, and when does it fail ?

Appendix B
Solutions
3.1.1 Yes; c < b, because the remainder is always less than the quotient.
3.1.2 The orbits are:
i. (100, 63), (63, 37), (37, 26), (26, 11), (11,4), (4, 3), (3, 1), (1,0). The gcd is
1.
ii. (100, 78), (78, 22), (22, 12), (12, 10), (10, 2), (2,0). The gcd is 2.
iii. (100, 17), (17, 15), (15, 2), (2, 1), (1, 0). The gcd is 1.
3.2.1 The output after n repetitions of the operation is x2n
3.2.3 We use the following result which was proved in the text: if x > 1, then
x2n tends to infinity with n.
If 0 < x < 1, then 1∕x > 1 and we apply this result to the quantity (1∕x)2n = 1∕n;
this will tend to infinity with n, so x2n must tend to 0. It follows that when 0 <
x < 1 then the quantity x2n tends to 0 as n tends to infinity. If–1 < x < 0, then
x2 lies between 0 and 1, and the same argument applies from this point on;
the limit is 0 in this case too.
3.2.4 The output after the procedure has been repeated n times is 102n , so we
need to find the least n for which 102n > 10 1000. The answer is n = 10,
because 210 = 1024 > 1000 and 29 = 512 < 1000. Similarly, 102n > 1010000
when n = 144 because 214 = 16384, whereas 213 = 8192 < 1000.
3.2.5 As earlier, we need to find the least value of n for which 22n > 101000.
To solve this inequality for n, note that

2212 = 24096 > 24000 = 161000 > 101000,
while
2211 = 22048 < 23000 = 81000 < 101000
This means that the answer is n = 12.
Similarly, to find the least n for which 22n > 1010000, we note that
2216 = 265536 > 260000 = 6410000 > 1010000,
while
2215 = 232768 < 233000 = (233)1000 < (1010)1000 = 1010000,
because 233 = (211)3 = 20483 < 21003 = 9261000000 < 1010; therefore the
answer is n = 16.
3.2.6 The output after n iterations is x3n
3.3.1 The limit is 1. To prove this is a bit tricky, though; to do so, we shall use
the fact that for a > 0,
1 < 1 + a < 1 + a 2.
(The first inequality is obvious, and the second one becomes clear after
squaring both sides, for 1 + a < 1 + a + a2∕4. ) Let the initial number be written
as 1 + a, where a >0. Then the number obtained after n extraction of the
square root is
(1 + a)1∕2n (= an,say).
Invoking the inequality 1 < 1 + a < 1 + a∕2 repeatedly, we obtain
1 < an < 1 + a 2n.
As n increases without limit, the quantity a∕2n shrinks to 0 very rapidly, so 1 +
a∕2n converges to 1. This shows that the limit of anis 1.
The argument for the case a <0 is similar, and the details are left to the reader.
3.3.2 The argument in this case is very similar; the limit is 1, no matter what
input is chosen. The proof uses the inequality.
1 < 1 + a3 < 1 + a 3

which holds for all a > 0.
3.3.3 The function x →x is clearly the inverse of the functionx→x2 ; thus the
sequences produced by the two functions are reversals of one another.
4.2.1 The trajectories are as displayed below.
4.2.2 The quadruples that reach (0,0,0,0) after just one round of the iteration
are all of the form (k,k,k,k) for some number k; those that take two rounds to
reach (0,0,0,0) are all of the form (a,b,a,b), for some numbers a,b(a≠b); and
those that reach (0,0,0,0) after three rounds are of the form (k,k + a,k + b,k +
|a - b|), where a,b,k are any numbers with b≠0,2a. For example, with k = 1,a =
3,b = 4, we obtain the quadruple (1,4,5,2), whose orbit is:
(1,4,5,2)↦(3,1,3,1)↦(2,2,2,2)↦(0,0,0,0).
(You should try to justify these claims on your own.)
4.2.3 Line 80 evaluates the sum of the elements of the quadruple, and line 90
checks if the quadruple (0,0,0,0) has been reached, because if s > 0, then some
number of the quadruple is non-zero, so more iterations are needed.
(Remember that after the first round, the quadruple has no negative numbers,
so there.is no danger of zero arising as a result of cancellation.)
4.2.4 The trajectories are as displayed below.
i. (2,13,17),(11,4,15),(7,11,4),(4,7,3),(3,4,1),(1,3,2),(2,1,1),(1,0,1),(1,1,0),
(0,1,1),(1,0,1),⋯. We have reached a 3-cycle.
ii. (3,19,50),(16,31,47),(15,16,31),(1,15,16),(14,1,15),(13,14,1),(1,13,12),

(12,1,11),⋯. Ultimately we reach a 3-cycle.
iii. (100,201,18),(101,183,82),(82,101,19),(19,82,63),(63,19,44),(44,25,19),
(19,6,25),(13,19,6),(6,13,7),(7,6,1),(1,5,6),⋯. Once again a 3-cycle!
4.2.5 The triples that ultimately reach (0,0,0) are of the form (a,a,a) for some
number a.
If a,b,c are not all equal, let k denote the gcd of the three numbers |a - b|,|b -
c|,|c - a|. Then the orbit eventually reaches the 3-cycle
(k,k,0)↦(0,k,k)↦(k,0,k)↦….
Note that this also holds if two out of a,b,c are equal. For example, if a = 10,b
= 10,c = 98, then the three differences are 88, 88 and 0, whose gcd is 88. Thus
the orbit reaches the triple (88,88,0) and then stays in a 3-cycle.
4.2.6 You will find that a law similar to that stated above holds. If the initial 5-
tuple is. (a,b,c,d,e), and the numbers a,b,c,d,e are not all equal, let k denote the
gcd of the five numbers |a - b|,|b - c|,|c - d|,|d - e| and |e - a|. Then the orbit
eventually reaches a tuple composed only of k’s and 0’s, after which it stays in
a cycle.
A similar law holds for 6-tuples.
5.2.1 The orbits are:
i. 〈 5,25,29,85,89,145,42,20,4,16,37,58,89,…〉 .
ii. 〈 6,36,45,41,17,50,25,29,85,89,…〉 .
iii. 〈 8,64,52,29,85,89,…〉 .
iv. 〈 11,2,4,16,37,58,89,…〉 .
v. 〈 12,5,25,29,85,89,…〉 .
Note how the same cycle is reached in each case.
5.2.2 Listed below is a simple computer program in BASIC that will capture
all seeds that lie between two specified limits (nmin, nmax) and that finally
reach the cycle 〈 1〉 .

CLS
INPUT nmin, nmax
REM nmin and nmax should be less than 1000
FOR number = nmin TO, nmax
n = number
WHILE n > 1 AND n <> 20
a = n MOD 10: n1 = (n -a) / 10
b = n1 MOD 10: n2 = (n1- b) /10
c = n2 MOD 10
n = a^ 2 + b^ 2 + c ^ 2
IF n = 1 THEN PRINT number
WEND
NEXT number
The condition “ n <> 20” has been included to detect whether the orbit
reaches the cycle containing 20, namely, 〈20,4,16,37,58,…〉.
On running the program with nmin = 1,nmax =100, we find that the seeds
that eventually reach 〈1〉 are:
1,7,10,13,19,23,28,31,32,44,49,68,70,79,82,86,91,94 and 97.
The list is surprisingly large!
5.2.3 Obviously, the numbers that reach 1 after just one iteration are
1,10,100,1000,…; that is, the powers of 10. The numbers that reach 1 after two
iterations are those that reach a positive power of 10 after one iteration. To
list these down, we try to find all possible ways of expressing 10, 100,1000, … ,
as sums of squares of digits. For example: 10 = 12 + 12 + 22 + 22 = 12 + 32,
and so on. Of course, we can include 02 as many times as we wish. This
immediately shows that the numbers 1122, 2121, 2211, 13, 31, 103, 301,
10201020, …, all reach 10 after one iteration, and hence reach 1 after two
iterations. It follows that there are infinitely many numbers that reach 1 after

two iterations! Similarly, we list down all the ways in which 100 can be
written as a sum of squares of digits, for example 100 = 62 + 82, or
100 = 32 + 32 + ⋯ + 32︸ eleven times + 1,
which shows that the numbers 68 and 333333333331 (with eleven 3’s and one
1) reach 100 in one step and hence 1 in two steps. This procedure can be
generalized in a fairly obvious way.
5.2.4 The only other numbers that have this property are: 1, 370, 371 and 407.
How will you show that there are no four digit numbers with the property?
5.2.5 The other numbers that have this property are 1, 1634 and 9474.
(Check: 14 + 64 + 34 + 44 = 1 + 1296 + 81 + 256 = 1634, as claimed; similarly
for 9474.)
5.2.6 The detailed exposition in Chapter 14 (Section 14.1) may suggest a
solution for this problem. Or we may proceed directly as follows.
If n is a k-digit number, then certainly SSQ (n) ≤ 81k. So we have:
If 10k-1 < k ≤ 10k, then SSQ (n) ≤ 81k.
It is easily shown that for k ≥ 4 we have 81k < 10k-1. It follows that if n has
four or more digits, then SSQ (n) < n. So there are no solutions to the
equation n = SSQ (n) if n has four or more digits. So to check for solutions,
we need to consider the cases when n has one, two or three digits.
If n has one or two digits, we write n = 10a + b where a and b are digits. (If a =
0 then n is a single digit number.) Then we have: n = SSQ (n), therefore
10a + b = a2 + b2, ∴b2 - b = a(10 - a).
Since b2 - b is even for any integer b, it follows that a is even; i.e., a = 0,2,4,6
or 8. Therefore:
b2 - b ∈{0,16,24}.
The values taken by b2 - b for b = 0,1,2,…,9 are
0, 0, 2, 6, 12, 20, 30, 42, 56, 72.
The numbers 16 and 24 do not feature anywhere in this list, so we get: a =
0,b2 - b = 0, ∴b = 0 or 1, ∴n = 0 or 1. So the only solutions with one or two

digits to the equation n = SSQ (n) are 0 and 1.
If n has three digits, then SSQ (n) ≤ 81 × 3 = 243, so if n = SSQ (n) then n ≤
243. If n ≤ 243, then we get: SSQ (n) ≤ 81 × 2 = 162, so n ≤ 162. So the first
digit of n must be 1.
Now write (n = 100 + 10b + c, where b,c are digits. We get: n = SSQ (n), so
100 + 10b + c = 1 + b2 + c2. This yields:
c2 - c = 99 + b(10 - b), ∴c2 - c ≥ 99.
But this is clearly not possible if c is a digit. So there is no three digit number
n for which n = SSQ (n). The stated conclusion now follows.
6.1.1 The equation x2 - 2 = x can be written as (x - 2)(x + 1) = 0, so its
solutions are 2 and –1. These are the fixed points of f.
6.1.2 The equation 2x - x2 = x simplifies to x2 = x, whose solutions are 0 and
1. The set of fixed points is therefore {0,1}.
6.1.3
i. x2 - 12 = x simplifies to (x - 4)(x + 3) = 0, so the set of fixed points is
{-3,4}.
ii. x3 - 3x = x yields the equation x3 = 4x or, equivalently, x(x - 2)(x + 2) =
0. The set of fixed points is {-2,0,2}.
6.1.4 The important fact is that x2 ≥ 0 for all (real) values of x. Therefore x2 +
1 ≥ 1 for all x. If x < 1 then we have
x2 + 1 ≥ 1 > x,
so x2 + 1 > x. If x = 1, then x2 + 1 = 2, so x2 + 1 > x. Finally, if x > 1, then x2 >
x, so x2 + 1 > x. Therefore x2 + 1 > x in each case, so f has no fixed points.
Here is another proof for the case when x ≥ 0. Consider the expression (x -
1)2 = (x2 + 1) - 2κ. Since a square is never negative, (x - 1)2 ≥ 0, that is, x2 + 1
> 2x. But 2x ≥ x (since x ≥ 0), so the inequality follows.
6.1.5 The proof mimics the one given above, and we leave the details to the
reader.
6.2.1

1 19 = 0.052631578947368421¯052631578947368421¯…
1 21 = 0.047619¯047619¯047619¯ ] …
1 29 =
0.0344827586206896551724137931¯0344827586206896551724137931¯…
6.2.2 The required fraction is 41 100 + 1 100 57 99 = 4116 9900 = 343 825.
6.2.3 Here are two fractions of the required type.
1 41 = 0.02439¯02439¯02439¯…
1 17 = 0.0588235294117647¯0588235294117647¯…
6.2.4 The cycles are:
Powers of 7 : 〈7,9,3,1〉 (a cycle of length 4),
Powers of 8 : 〈8,4,2,6〉 (a cycle of length 4).
6.2.5 A units digit of 2 must necessarily be followed by a units digit of 4 as 2 ×
2 = 4 ) ; next, 4 must be followed by 8 (because 4 × 2 = 8), 8 must be followed
by 6 (because 8 × 2 has units digit 6), and finally, 6 must be followed by 2
(because 6 × 2 has units digit 2), thus closing the cycle.
6.2.6 We reason in the same manner: 3 is followed by 9 (3 × 3 = 9),9 is
followed by 7(9 × 3 has last digit 7), 7 is followed by 1, and 1 is followed by 3,
thus closing the cycle.
6.2.7 Argue in the following manner. Suppose that we are doing the division a
÷ b. If the division works out exactly at some point, then we obtain a decimal
with infinitely many 0’s, and the problem is solved. If not, then the remainder
at each stage of the division is positive, so it is one of the numbers 1, 2, 3, …, b
- 1. There are only b - 1 of these remainders, so after some point a remainder
will be encountered that has already been met earlier. From this point on, the
decimal must recur. If you work out an example, say the division 12 ÷ 7, you
will see immediately how this logic solves the problem.
7.2.1 The orbit is: 〈1039,9171,8532,6174,…〉.
7.2.2 The orbits are, respectively:
i. 〈8619,8172,7443,3996,6264,4176,6174…〉;

ii. 〈1234,3087,8532,6174,…〉;
iii. 〈1235,4086,8172,7443,3996,6264,4176,6174,…〉;
iv. 〈9000,8991,8092,8532,6174,…〉;
v. 〈8000,7992,7173,6354,3087,8532,6174,…〉.
7.2.3 Let n have digits a,b,c,d where a ≥ b ≥ c ≥ d. Then
K(n) = 999(a - d) + 90(b - c).
Now a - d ≤ 9 and b - c ≤ 9 (because a,b,c,d are digits), so we obtain
K(n) ≤ 999 ⋅ 9 + 90 ⋅ 9 = 9801.
that is, K(n) ≤ 9801 for all n. Thus 9801 serves as an upper bound for K(n).
The bound is reached if and only if a - d = b - c = 9, that is, a = b = 9,c = d = 0.
The numbers n for which K(n) attains its maximum value of 9801 are
therefore 99, 909, 9009, 9090 and 9900.
7.2.4 Any number of the form aaaa¯ reaches 0000¯ in one step, and it is clear
that these numbers are.the only ones that reach 0000¯ in one step.
To find the numbers that reach 0000¯ after two or more iterations, we need to
find n such that K(n) = aaaa¯ for some a. To make progress we use a result
from divisibility theory: a number is divisible by 9 if and only if the sum of its
digits is divisible by 9. This implies that if integers m,n have the same sum of
digits, then m - n is divisible by 9, and in turn that K(n) is divisible by 9 for all
n. On the other hand, aaaa¯ is divisible by 9 iff 4a (its sum of digits) is
divisible by 9, and this holds only for a = 9. But the equation K(n) = 9999 can
never hold, because K(n) ≤ 9801 for all 4-digit numbers n. So we reach a
curious result: the numbers that ultimately reach 0000¯ do so after just one
iteration, and they are precisely the numbers of the form aaaa¯ for some digit
a.
7.2.5 The only fixed points for the 4-digit Kaprekar iteration are 0000 and
6174.
7.2.6, 7.2.7 The only fixed points for the 3-digit Kaprekar iteration are 000
and 495. (The proof of this assertion has been discussed in outline in the
text.)

7.2.8 The 5-digit Kaprekar iteration behaves quite differently from the 4-digit
Kaprekar iteration—we find 2-cycles as well as 4-cycles:
〈59994,53955〉;
〈61974,82962,75933,63954〉;
〈62964,71973,83952,74943〉.
There appears to be no fixed point (other than 00000). Probably many other
interesting facts can be uncovered. (The cycles listed above were found using
a computer.)
In the case of the 6-digit Kaprekar iteration, we even find a 7-cycle! The cycle
is:
〈840852,860832,862632,642654,420876,851742〉.
7.2.9 In this case what happens is that occasionally the iteration comes to a
quick halt. For instance, with a seed of 7776, we obtain K(7776) = 7776 - 6777
= 999. With no padding we would have K(K(7776)) = 0, and our investigation
would now run out of material to investigate!
Note that this will happen only very occasionally: for four-digit numbers n,
the iterate K(n) is a 3-digit number only when the digits of n are a,a,a,a ± 1 in
some order (for some a), and it so happens that for all such n we have K(n) =
999. So the following statement can be made: the set of seeds n for which the
two iterations give different results is
{n : 1000 ≤ n ≤ 9999 : some iterate of n equals 999}.
It is not too hard to enumerate this set. Remembering that K(n) is a multiple
of 9 for all n, we see that we must first enumerate the digit a for which 4a ± 1
is a multiple of 9, i.e., for which 4a ≡±1(mod9). Multiplying both sides of the
congruence by - 2 we obtain a ≡±2(mod9) or a ∈{2,7}. Continuing, we find
that the only n for which (K(K(n)) = 999 is the set
{2223,2232,2322,3222,6777,7677,7767,7776}.
We must now enumerate the n’s for which K(n) is one of these eight
numbers. A computer search however fails to produce any such n, so we
conclude that the set of n for which the two iterations (with and without

padding) behave differently is just the 8-element set listed above.
8.1.1 This has been proved in the text.
8.2.1
i. g(48) = 60
ii. g(137) = 148
iii. g(153) = 162
iv. g(271) = 281
v. g(933) = 948
8.2.2 Here is the list, obtained with the help of a computer:
1, 3, 5, 7, 9, 20, 31,42, 53,64, 75, 86.97.
Note the suggestive pattern!
9.2.1    The orbits are:
i. 3,13,1113,3113,2123,112213,312213,212223,114213,31121314,41122314,3
We have reached the fixed point 21322314.
ii. 4,14,1114,3114,211314,31121314,41122314,31221324,21322314,21322314
We have reached the same fixed point!
iii. 9,19,1119,3119,211319,31121319,41122319,3122131419,4122231419,3132
We have reached a different fixed point this time—the self-referential
number 3122331419.
9.2.2 A fixed point is reached in each case:
i. 20,1012,102112,103122,10212213,10313213,10311233,10311233,....
ii. 25,1215,211215,312215,21221315,31321315,31123315,31123315,....
iii. 95,1519,211519,31121519,4112131519,4112131519,....
9.2.3 Cycles are reached with these seeds:

i. 40,1014,102114,10311214,1041121314,1051121324,104122131415,105122
We have found a 2-cycle, namely:
〈104122232415,103142132415〉.
ii. 50,1015,102115,10311215,1041121315,105112131415,106112131425,1051
This time we have reached a 3-cycle!
〈10414213142516,10412213341516,10512223241516〉.
9.2.4 A MATHEMATICA program to do the calculations is given below.
selfdescribe [a-List :] :=
(b = Sort [a];c = Union[b,{}];
d = Length [c];
f[i-];= Count [b,c[[i]]];g = {};
Do [g = Join [g,{f[i],c[[i]]}], {i,1,d} ],g )
final [a-List,n-] := NestList [selfdescribe, a,n]
Using the program, we find that the seed 160 gives rise to the following 2-
cycle:
〈1051421314152617,1061221324251617〉.
The seed 129 also gives rise to a 2-cycle:
〈314213241519,412223241519〉.
The seed 314159 gives rise to a 3-cycle:
〈51222314251619,41421314251619,51221334151619〉.
Clearly a lot more such data can be produced by further experimentation.
9.2.5 Please refer to the solution to Problem 14.2.2.
10.1.1 If h(x) = x, then - x = x, therefore x = 0. This means that 〈-1〉 is the
only l-cycle.
10.1.2 Any function of the type h(x) = a - x, where a is any number, is a 2-
cycle function.

10.1.3 Here is one such function: let k(x) be defined so that
k(x) = x + 1if[x]isodd,x - 1if [x]is even .
Then k(x) is a 2-cycle function, but it has no l-cycle. Any odd integer may be
substituted for the ‘1’.
10.1.4 Iterating the function, we obtain:
x↦1 -1 x = x - 1 X ↦1 - x x - 1 = 1 1 - x↦1 -1 - x 1 = x,
and we see that the cycle has closed. Thus every number is caught in a 3-cycle.
unless it happens to be a fixed point. Are there any fixed points? To check, we
examine the equation x = (x - 1)∕x, which simplifies to x2 - x + 1 = 0. However
this equation has no solutions in real numbers. (Proof: x2 - x + 1 = (x - 1∕2)2 +
3∕4, so - x2 - x + 1 ≥ 3∕4 for all real values of x. In particular we can never have
x2 - x + 1 = 0.) We conclude that there are no fixed points, so each number is
part of a 3-cycle. Thus the given function is a 3-cycle function.
To see why we need to have x≠0,1, simply examine the denominators of the
expressions listed above. No zeroes can appear here. so the restrictions are
needed just as listed.
10.1.5 The function m(x) is a 2-cycle function:
x↦ x x - 1↦ x∕(x - 1) x∕(x - 1) - 1 = x.
10.1.6 The orbit in this case is:
x↦ 1 1 - x↦ 1 1 - 1∕(1 - x) = x - 1 x ↦ 1 1 - (x - 1)∕x = x.
It follows that n(x) is a 3-cycle function.
10.2.1 p(3.1) = 2.1,p(-7.3) = -6.3,p(0) = 1.
10.2.2 Let x = k + z, where k = [x] is the integral part of x and z is the
fractional part of x; thus. 0 ≤ z < 1.
If k is odd, then p(x) = k - 1 + z. The integral part of k - 1 + z is k - 1. which is
even, so p(k - 1 + z) = (k - 1 + z) + 1 = k + z = x, that is, p(p(x)) = x. The
argument for the case when k is even is practically the same and we do not
give it here. Since [x] and [p(x)] have opposite parity (that is, if one of them is
odd then the other is even). it is not possible for p(x) and x to be equal. Thus
p(x)≠x for all values of x and p has no 1-cycles.

10.2.3 p(x) = 3.3 holds only when x = 2.3.
10.2.4 Let x = k + z, where k = [x] is the integer pan of x, and let k leave
remainder r when divided by 5. We compute the value of p(x) by the
following rule:
p(x) = x + 1ifr = 0,1,2,3;x - 4if r = 4.
Here is a typical orbit: 10.7↦11.7↦12.7↦13.7↦14.7↦10.7↦⋯.
It is not too hard to see why p is a 5-cycle function. Please fill in the details on
your own.
10.2.5 For an input value of x, let k = [x] be the integral part of x, and let r be
the remainder when k is divided by n. We compute the value of f(x) as shown
below:
f(x) = x + 1 ifr = 0,1,2,…,n - 2;x - n + 1 if r = n - 1.
We leave as an exercise the verification that f is an n-cycle function.
10.3.1 This is clear , because 1∕(1∕x) = x,1 - (1 - x) = x,-(-x) = x.
10.3.2 Possible square roots are listed alongside the functions.
i. a(x) = x + 1; possible square root: b(x) = x + 1∕2.
ii. a(x) = x + 2; possible square root: b(x) = x + 1.
iii. a(x) = 4x; possible square root: b(x) = 2x.
iv. a(x) = 2x; possible square root: b(x) = x2.
10.3.3 Given a function a, a function b such that b ∘ b ∘ b = a (also written as
bbb = a or b(3) = a or b(b(b(x))) = a(x) for all values of x) can be referred to as
a cube root of a.
For the function f, where f(x) = -x,f is itself a cube root! (Thus the function is
its own cube root.) Other cube roots can be manufactured using the same
technique as was used for the square root of the same function (as shown
earlier in the text).
10.5.1 This will become clear when we examine the orbit of x. We give the
argument only for positive values of x.

Let n be the unique integer such that 10n ≤ x < 10n+1. Suppose that n is even;
then x↦10x. Next, for the number 10x the corresponding number n′ is n + 1,
which is odd since n is even. Therefore 10x↦ - (10x∕10) = -x, and so b has
taken x to - x in two steps in this case. Continuing, we find that b takes - x to x
in another two steps.
We argue in a similar manner to cover the other possibilities.
10.5.2
i. a(x) = x2 (domain: all real numbers).
One possibility is the function g(x) = x2. With this choice,
g(g(x)) = x2 2 = x2,
that is, g ∘ g = a.
ii. a(x) = x∕(2x + 1) (domain: all numbers x≠ - 1∕2).
One possibility is the function g(x) = x∕(x + 1). This leads to:
x↦ x x + 1↦ x∕(x + 1) x∕(x + 1) + 1 = x 2x + 1,
and so g ∘ g is the given function a. Note that we must exclude both - 1
and - 1∕2 from the domain of g.
iii. a(x) = 1∕x (domain: the set of non-zero real numbers).
Let f be any function from R into R such that f(f(x)) = -x for all x. We
have already indicated in the text how to construct one such function f,
and we shall make use of this function now. Define the function a by
g(x) = 10f(log 10x) ifx > 0, - 10f(log10(-x)) ifx > 0,
(Note that g(0) must of necessity remain undefined; this is because 1∕x is
not defined for x = 0. )
We claim that g(g(x)) = 1∕x for all x≠0. This is easy to prove. Assume that
x > 0. Then g(x) = 10f(log10x), so log10g(x) = f(log10x). It follows that
g(g(x)) = 10f(log 10g(x))
= 10f(f(log 10x)

= 10- log 10x = 1 x,
by the definition of the logarithm function. The case when x < 0 is
handled similarly, and we omit the details. It follows that g ∘g = a.
10.5.3 Define f (0) to be 0; for n > 0 let
f(n) = n + 1 ifn≢0(mod4), - n + 3 if n ≡ 0(mod 4);
and for n < 0 let f(n) = -f(-n). Here is a picture of how f acts:
1 → 2 → 3 → 4 →-1 →-2 →-3 →-4 → 1,
5 → 6 → 7 → 8 →-5 →-6 →-7 →-8 → 5,....
The proof that f(4)(n) = -n for all integers n is left to the reader.
10.5.4 This problem is solved in Chapter 18.
10.5.5 This problem is solved in Chapter 17.
11.1.1 We have listed below the iteration sequences resulting from the seed
value x = 1.
i. Function: 
f(x) 
= 
1 
+ 
x∕2; 
orbit:
⟨1,1.5,1.75,1.875,1.938,1.969,1.984,1.992,1.996,1.998,1.999,...⟩.
The limit of the sequence is 2.
ii. f(x) 
= 
1 
+ 
x; 
orbit:
⟨1,1.4142,1.5538,1.5981,1.6118,1.6161,1.6174,1.6179,1.618,1.618,...⟩.
The limit of this sequence is approximately 1.618034…, as may be seen
by extending the calculations further. This is the so-called golden ratio,
and it can be expressed in the nicer (and more illuminating) form (5 +
1)∕2.
iii. f(x) 
= 
1 
+ 
2x; 
orbit:
⟨1,1.732,2.113,2.286.2.361,2.392,2.405,2.41,2.413,2.4136,2.4139,…⟩.
The limit of the sequence is approximately 2.41421536…, and it can also
be expressed as 2 + 1.
iv. f(x) 
= 
1 
+ 
1∕x2; 
orbit:

⟨1,2,1.25,1.64,1.372,1.531,1.426,1.492,1.449,1.476,1.459,1.47,...,⟩.
The limit of the sequence is approximately 1.46557…, and it can also be
expressed as
1 3 + 29 + 393 54 1∕3 + 29 - 393 54 1∕3 ,
only, this form may not be particularly illuminating!
v. f(x) = 1000 + x3; orbit: ⟨1,10.0033,10.0332,10.03333,…⟩.
The limit of the sequence is approximately 10.03333… and it can be
expressed as
500 + 20249997 9 1∕3 + 500 -20249997 9 1∕3
but, as earlier this may not be not too illuminating!
11.1.2
i. f(x) = 1 + x∕2.
If there is a limit at all, say, L, then it must satisfy the equation L = 1 +
L∕2, whose solution is L = 2. (We had already observed that the limit
appears to be 2.) To show that the sequence of iterates converges to 2,
note that from the defining relation f(x) = 1 + x∕2, we obtain
f(x) - 2 = x 2 - 1 = 1 2(x - 2).
This shows that the gap between f(x) and 2 is 1/2 the gap between x and
2. It follows that the gap diminishes to 0 as the iteration progresses, and
so the limit is 2, as stated.
ii. f(x) = 1 + x.
If there is a limit at all, say L, then it must satisfy the equation L = 1 + L
or L2 - L - 1 = 0. This has two solutions, namely:
L = 1 ±5 2 .
Since we start with a positive seed (x = 1) all the iterates are positive and
so convergence will be, if at all, to (1 + 5)∕2 and not to the negative root.
Write, for convenience, α = (1 + 5)∕2. We first claim that if

0 < x < α then x < 1 + x < α.
This is not too hard to prove and we leave the details to the reader.
(Hint: Examine the graphs of y = (1 + 5)∕2 and y = x.) Next, we show that
if 0 < x < α then α -1 + x α - x < α - 1 α .
The hint given above serves to show the way out here too: the graph of y
= 1 + x is concave (arching upwards). Let A,P and B be the points (0,1),
(x,1 + x) and (α,α) respectively; here 0 < x < α, so P lies in-between A and
B on the curve. Since the curve is concave, the slope of PB is less than
that of AB. This immediately leads to the inequality stated above.
Now α ≈ 1.618 < 2, so (α - 1)∕α < 1∕2. It follows that
if 0 < x < α then α -1 + x α - x < 1 2.
Thus the gap between α and f(x) is less than half the gap between α and
x. It follows that the iterates converge to α, as claimed.
iii. f(x) = 1 + 2x.
If there is a limit at all, say L, then it must satisfy the equation L = 1 + 2L
or L2 - 2L - 1 = 0, whose solution is L = 1 ±2. As in (ii), we argue that
convergence, if it takes place at all, must be to 1 + 2. From this point on,
the argument proceeds just as in (ii). Write for convenience β = 1 + 2
and observe that if 0 < x < β then x < 1 + x < β. Next, note that the curve
y = 1 + 2x is concave, so if A,P and B denote the points (0,1),(x,1 + x)
and (β,β) respectively, where 0 < x < β, then the slope of PB is less than
the slope of AB. It follows that
if 0 < x < β then β -1 + x β - x < β - 1 β .
Now
β β - 1 = 2 2 + 1 = 2 -2 ≈ 0.59 < 0.6,
so (referring to the gap between β and x as the ‘error’), the error shrinks
at each iteration to 3/5 or less of its old value. This shows that the error
diminishes to 0 as the iteration progresses, and so the iterates converge
to 1 + 2 as claimed.
iv. f(x) = 1 + 1∕x2.

If there is a limit at all, say L, then it must satisfy the equation L = 1 +
1∕L2 or L3 - L2 - 1 = 0. The real solution of this equation is
L = 1 3 + 29 + 393 54 1∕3 + 29 - 393 54 1∕3 ≈ 1.46557.
Let α denote this number. The reader will have noted that the orbit ⟨1; f ⟩
is an oscillatory one: it does not go steadily in one direction but oscillates
about α. To show convergence to α we shall have to prove some
inequality for the error term |x - α|, just as we did for (ii) and (iii), above.
This tums out to be rather more complicated that for the earlier cases.
We observe firstly that if 1 ≤ x < α then α < f(x) ≤ 2, while if x > α then 1
< f(x) < α. Since we start with a seed of 1, this shows that each iterate lies
between 1 and 2. Now if 1 ≤ x < 2 then 1.25 < f(x) ≤ 2. This in turn
implies that 1.25 ≤ f(f(x)) < 1.64 and, continuing, 1.37 < f(f(f(f(x))) <
1.64. Thus from the third iterate onwards, each x-value lies between 1.37
and 1.64. Now the graph of y = 1 + 1∕x2 is convex, that is, arching
downwards, so in the interval 1.37 ≤ x ≤ 1.64, the point where the curve
is steepest (in absolute value, ignoring the sign of the slope) must be one
of the two end-points; indeed, the point is clearly x = 1.37. To compute
the slope of the curve at this point we use calculus. (Its use can be
avoided, but this makes matters more complicated.) With f(x) = 1 + 1∕x2,
we obtain f′(x) = -2∕x3 and so f′(1.37) = -2∕1.373 ≈-0.78; thus |f′(1.37)| <
0.8. It follows that for any x with 1.37 ≤ x ≤ 1.64,
α - f(x) α - x < 0.8.
Thus the error |x - α| shrinks to 4/5 or less of its old value at each stage.
It follows that the error diminishes to 0, and so the iterates tend to α, as
claimed.
v. f(x) = 1000 + x3.
If there is a limit at all, say L, then it must satisfy the equation L3 = 1000
+ L, whose sole real solution is
α = 500 + 20249997 9 1∕3 + 500 -20249997 9 1∕3
(α ≈ 10.03333). To show that the iterates converge to α, we follow the
strategy of (ii), (iii), above. This works because the curve y = 1000 + x3
slopes upwards and is concave, just like the curves y = 1 + x and y = 1 +

2x. The details are omitted, as the style of proof is substantially the same.
For more on this type of convergence proof, the reader should study Chapter
16.
11.1.3 The orbit of the pair (x,y) is as shown below:
(x,y)↦ y, y + 1 x
↦ y + 1 x , x + y + 1 xy
↦ x + y + 1 xy , x + 1 y
↦ x + 1 y ,x
↦(x,y)
and the cycle has closed. (The factorization xy + x + y + 1 = (x + 1)(y + 1)
turns out to be useful at one point.) A sample orbit, using numbers instead of
symbols:
(1,2)↦(2,3)↦(3,2)↦(2,1)↦(1,1)↦(1,2).
11.1.4 Clearly, what we need to avoid is division by zero. This means that
none of the quantities x,x + 1,y,y + 1,x + y + 1 should.be zero. Therefore the
following restrictions are needed:
x≠0,- 1,y≠0,- 1,x + y + 1≠0.
11.2.1 Here is a program in BASIC that will help you do this problem.
REM   collatz
CLS
FOR n  =  2  TO  1000
X  =  n:   count  =  0
WHILE  x  >  1
y  =  x  MOD  2
IF  y  =  O  THEN  x  = x / 2
 IF  Y  =  1  THEN  x  =  3  *  x  +  1

count  =  count  +  1
WEND
PRINT  "(";  n;  ",  ";   count;  "), "
NEXT  n
On running the program, we find that the largest number of steps needed to
reach 1 occurs for the seed 871 (178 steps). For seeds in the range 1… 100, the
maximum number of steps occurs for the seed 97 (118 steps).
11.3.1 By the definition of cycle, if we apply f to a set C of numbers that form
a cycle, we get back the set C itself. Thus if D is the union of all such sets,
then. f(D) = D. This means that if we start with a large set S, large enough to
contain all of D, then we can be certain that f(S) too will contain all of D.
Further, any set E for which the relation f(E) = E holds must consist entirely
of numbers that form part of some cycle.
Now consider the sequence S,S1 = f(S),S2 = f(S1),…. The set of images
obtained when a function is applied to a finite set can never be larger than the
set itself, so the cardinalities of the Si form a non-increasing sequence:
|S|≥|S1|≥|S2|≥⋯.
On the other hand the set D is contained in each Si, so |Sj|≥|D| for all i. So we
have a sequence of positive integers whose initial term is the size of S, which
never increases, and whose terms are all ≥|D|. At some stage, therefore, two
successive terms must become equal, which means that we will have at hand a
set T for which f(T) = T. As per the comment made earlier, this set comprises
all the elements that form part of some cycle. The cycles can now be
unraveled from T in a straightforward manner.
11.3.2 On running through the computations, we obtain the following. Let S
be the set {0,1,2,3,…,99}, and let S1 = g(S),S2 = g(S1),S3 = g(S2),…. Then:
S1 
=
{0,2,4,6,8,10,12,14,16,18,20,22,24,26,28,30,34,36,40,42,44,48,50,52,54,56,60,66,
S2 = {0,2,4,6,8,10,12,14,16,18,20,24,30,36,40,42,50,52,56,66,70,72,90};
S3 = {0,2,4,6,12,14,18,20,24,30,40,42,50,56,70,72,90};

S4 = {0,4,6,12,14,18,20,30,42,50,56,70,90};
S5 = {0,4,6,12,14,18,20,30,42,56,70,90};
S6 = {0,4,6,12,14,18,20,42,56,70,90};
S7 = {0,4,6,12,14,18,20,42,56,70,90} = S6.
Thus the set of numbers that belong to some cycle is the set
T = {0,4,6,12,14,18,20,42,56,70,90}.
Applying g to these numbers gives the same numbers but in the following
order:
0,20,42,4,18,70,6,14,12,56,90.
It follows that g has two 1-cycles, 〈0〉 and 〈90〉, and one 9-cycle:
〈4,20,6,42,14,18,70,56,12〉.
11.4.1 Clearly D(n) = 1 if and only if n has no proper divisors other than 1,
which means that n = 1 or a prime. The required numbers are therefore 1, 2,
3, 5, 7, 11, 13, ….
11.4.2 Using the prime factorizations of the numbers (10 = 2 × 5,20 = 22 ×
5,30 = 2 × 3 × 5,40 = 23 × 5,50 = 2 × 52), we obtain:
D(10) = (1 + 2) × (1 + 5) - 10 = 8,
D(20) = (1 + 2 + 4) × (1 + 5) - 20 = 22,
D(30) = (1 + 2) × (1 + 3) × (1 + 5) - 30 = 42,
D(40) = (1 + 2 + 4 + 8) × (1 + 5) - 40 = 50,
D(50) = (1 + 2) × (1 + 5 + 25) - 50 = 43.
It is easy to check that the stated values are correct.
11.4.3 The rule works because when we take the product P × Q × R ×⋯, we
obtain all possible divisors of n, including n itself, which therefore must be
subtracted out. For instance, consider n = 50; multiplying out the expression
(1 + 2) × (1 + 5 + 25) we obtain 1 + 2 + 5 + 10 + 25 + 50, and the six
summands are precisely the six divisors of 50.

11.4.4 Suppose that n is odd. Then 2n has the prime factor 2, so
D(2n) = (1 + 2) × (D(n) + n) - 2n = 3D(n) - n,
and it follows that if D(n) > n, then D(2n) > 2n; the stated inequality thus
holds.
Next, suppose that n is even, say n = 2a-1pbqc…, where p,q,… are odd
primes and a > 1. Then 2n = 2apbqc…. Using the identity 1 + 2 + 22 + ⋯ + 2k-
1 = 2k - 1 and writing for convenience
X = (1 + p + p2 + ⋯ + pb) × (1 + q + q2 + ⋯ + qc) ×⋯,
we obtain
D(n) = X(2a - 1) - n,
D(2n) = X(2a+1 - 1) - 2n.
Now 2a+1 - 1 > 2(2a - 1), so D(2n) > 2(D(n) + n) - 2n, that is, D(2n) > 2D(n).
Since D(n) > n it follows that D(2n) > 2n.
Since 12 is abundant (because 1 + 2 + 3 + 4 + 6 > 12 ) , it follows that each
member of the sequence 24, 48, 96, 192, 384, … is abundant. Thus there are
infinitely many abundant numbers.
Note that the number of deficient numbers too is infinite, because D(p) = 1 <
p for every prime p, and (of course) there are infinitely many primes.
11.4.5 The equation D(n) = 2 can never hold.
11.4.6 With P of the stated form and n = P(P + 1)∕2, we have N = 2k-1(2k - 1)
and the rule gives
D(N) = 1 + 2 + 22 + ⋯ + 2k-1 ×1 + 2k - 1 - N,
that is, D(N) = (2k - 1)2k - (2k - 1)2k-1 = (2k - 1)2k-1 = N. Thus N is perfect.
11.4.7 We are told that N is even, so we write N = 2aB where B is odd and a >
0. Using the rule described in the text, we obtain
D(N) = (2a+1 - 1)(D(B) + B) - 2aB.
Since N is perfect, D(N) = N = 2aB, so
(2a+1 - 1)(D(B) + B) = 2a+1B.

Therefore we have
D(B) + B B = 2a+1 2a+1 - 1,D(B) B = 1 2a+1 - 1.
The fraction on the right has no cancellable terms, so we must have
D(B) = c,B = c ⋅ (2a+1-1)
for some integer c > 0. If c > 1, then since c is a proper factor of B, we must
have D(B) ≥ c + 1 > c, a contradiction. Therefore c = 1. It follows that B =
2a+1 - 1 and that D(B) = 1,which means that B is prime. Thus N takes the
form P(P + 1)∕2 where P = 2a+1 - 1 is a Mersenne prime. This is exactly what
Euler had asserted.
Figure B.1.   Iteration with perpendiculars
11.4.8 We have, 6232 = 23 ⋅ 19 ⋅ 41 and 6368 = 25 ⋅ 199, so
D(6232) = (15 ⋅ 20 ⋅ 42) - 6232 = 6368,
D(6368) = (63 ⋅ 200) - 6368 = 6232.
11.4.9 We have, 9363584 = 27 ⋅ 191 ⋅ 383 and 9437056 = 27 ⋅ 73727, so
D(9363584) = (255 ⋅ 192 ⋅ 384) - 9363584 = 9437056,
D(9437056) = (255 ⋅ 73728) - 9437056 = 9363584.
11.4.10 This has already been done in the text.
13.2.1 The sides of the inscribed triangle are (respectively) at right angles to
the sides of △ABC and therefore enclose the same angles. It follows that the

two triangles are similar.
13.2.2 If △ABC is right-angled, we reach the limiting shape at the very first
stage. 
13.2.3 If △ABC is obtuse-angled, then the limiting shape juts outside it.
13.2.4 Empirically we find that exactly the same thing happens: we reach a
limiting shape, which in this case is a quadrilateral with one vertex on each
side of the original quadrilateral.
13.2.5 We consider the iteration where the movement is in a clockwise
direction—i.e., we drop perpendiculars in turn to AB, to CA, to BC,… (see
Figure B. 1). We now have:
BP = x, ∴BQ = xcosB,
∴AQ = c - xcosB, ∴AR = (c - xcosB)cosA,
∴CR = b - (c - xcosB)cosA,
∴CP′ = (b - (c - xcosB)cosA)cosC,
∴BP′ = a -(b - (c - xcosB)cosA)cosC,
∴BP′ = a - bcosC + ccosAcosC - xcosAcosBcosC.
Since a - bcosC = ccosB, the last equation simplifies to
BP′ = c(cosB + cosAcosC) - xcosAcosBcosC.
So the iteration follows the rule given below:
x↦c(cosB + cosAcosC) - xcosAcosBcosC.
Write α = cosA,β = cosB,γ = cosC; the mapping is then:
x↦c(β + αγ) - (αβγ) ⋅ x.
Since |αβγ| < 1 (true because α,β,γ are cosines of angles), it follows that the
iteration converges, with x → x0 where
x0 = c β + αγ αβγ .
We conclude that the sequence 〈P,f(P),f(f(P))…〉 converges to a point P*
with BP* = x0.

13.3.1 Since the triangles Ti tend to the equilateral shape, their incenters Ij
converge to the center of the circumcircle of △ABC.
13.3.2 From the relation f(x) = 90 - x∕2 we deduce that
f(x) - 60 = 30 - x∕2 = 60 - x 2 ,
that is, |f(x) - 60| = |x - 60|∕2. So the gap between x and 60 gets halved after
each iteration, and the x-values converge to 60.
13.4.1 As noted in the text, the triangles Ti tend to the equilateral shape,
therefore their centroids Gi converge to the center of the circumcircle of
△ABC. However convergence is hard to prove.
13.4.2 The same result holds as in 13.4.1, but as earlier convergence is hard to
establish.
13.5.1 (Please draw a figure for yourself!) Now label T0 as △ABC,T1 as
△A1B1C1,T2 as △A2B2C2 and T3 as △A3B3C3. The proof that T3 ~T0
works out very simply after joining AP, for it turns out that ∠PAB =
∠PA3B3 and ∠PAC = ∠P443C3. (To see why, examine the many cyclic
quadrilaterals concealed in the figure: PA1BC1,PA2B1C2,PA3B2Cγ,…. Now
make repeated use of the theorem which states that angles in the same
segment of a circle are equal.) Therefore ∠BAC = ∠B3A3C3, and likewise
for the other two angles. Thus T0 ~T3 as claimed.
The result can be extended. For a convex n-sided polygon P0 and a fixed
interior point P, construct P1 by joining (in sequence) the feet of the
perpendiculars from P to the sides of P0. Likewise construct P2 by dropping
perpendiculars from P to the sides of P1; and so on, … Then Pn is similar to
P0.
13.6.1 The classes are: (i) acute-angled triangles (ii) right-angled triangles (iii)
obtuse-angled triangles. In (ii) the orthocenter invariably lies at the vertex
corresponding to the right angle; the orthocenter can never be situated in the
interior of a side.
13.6.2 The Ti’s do not converge to a limiting shape in this iteration.
13.6.3 Through each vertex of the given △ABC, draw a line parallel to the
side opposite it. The three lines enclose a triangle, say △XY Z. This triangle is

homothetic to △ABC and A,B,C lie at the mid-points of its sides. The
altitudes. of △ABC are now seen to be the perpendicular bisectors of the
sides of △XY Z and therefore concur at the circumcenter of △XY Z.
13.6.4 We first prove Euler’s theorem: for any triangle ABC the orthocenter
(H), the centroid (G) and circumcenter (O) are collinear with OH = 3OG.
Let the mid-points of BC,CA, AB be A′,B′,C′; then O is the orthocenter of
△A′B′C′; the triangles ABC,A′B′C′ share the same centroid, namely, G; and
AG∕GA′ = BG∕GB′ = CG∕GC′ = 2.
Consider the homothety with center G and scale factor - 1∕2 (that is, the
image of any point X under the homothety is the point X′ with GX′ = XG∕2
and with G lying on segment XX′; in vector terminology, GX′ = -GX∕2 〉 . The
homothety maps △ABC to △A′B′C′ and the orthocenter of △ABC to that
of △A′B′C′. That is, it maps H to O, and it follows from this that GO = -
GH/2. This proves Euler’s theorem.
We also prove the following rather trivial result: let G be an arbitrary point
lying within the interior of Γ. Then there exists a triangle within Γ whose
centroid is G.
Proof: Let O be the center of Γ and let the ray OG meet Γ at A. Extend AG to
A′ where GA′ = AG∕2, and draw a line through A′ perpendicular to AA′. Let
this line meet Γ at B,C. Then △ABC has centroid G.
These two results imply the statement to be proved. We leave the details to
the reader.
13.7.1 If ABCD is a square and P,Q,R,S are located on the sides
AB,BC,CD,DA so that AP∕PB = BQ∕QC = CR∕RD = DS∕SA = k, then △SAP is
congruent to △PBQ and SP = PQ,SP ⊥ PQ. This is enough to conclude that
PQRS is a square.
13.7.2 A sequence of ‘nested diamonds’ results.
13.7.3 This, naturally, will depend upon the, eye of the beholder, but to the
author the nicest pictures are obtained with k close to 0 or 1, but not too close;
k = 0.1 or k = 0.9 seem just right. (With k = 0.01 or smaller the picture is too
dense, and with k = 0.3 or so there is too much ‘white space’.)

13.7.4 The same results hold: convergence to a point. (The successive
quadrilaterals are not necessarily similar to one another.)
13.7.5 A curve can be thought of in two different ways: as made up of its
points, or as enveloped by its tangent. The curve described in the problem is an
example of a curve being enveloped by tangents. We list a few more
illustrative examples.
The caustic curve seen in a tea-cup or a vessel half filled with milk when
a light-source is held near it (the curve is seen on the surface of the
liquid) provides a particularly nice example of a curve enveloped by its
tangents. It is well known that the curve is a cusped one.
Another fine example is provided by the drawing often made by children
while doodling in their notebooks: let ℓ,ℓ′ be lines meeting at a point O;
let n be a positive integer (say n = 20 or so) and let h be a small positive
number; let A1,A2,A3,…, An be distinct points on ℓ and let B1,B2,B3,
…,Bn be distinct points on ℓ′, with
OA1 = A1A2 = ⋯ = OB1 = B1B2 = ⋯ = h.
Let the lines A1Bn,A2Bn-1,A3Bn-2,…,AiBn-1-i,… be drawn. The
various lines will be seen to very gracefully envelope a curve; the larger
the value of n and the smaller the value of h, the nicer the effect. (In fact
the curve is a parabola, but this needs proof.)
Another such curve is seen in an artifact frequently made in the Crafts
department of a school, in its embroidery section. Let C be a circle, let n
be a positive integer (say n = 20 ) and let points A1,A2,A3,…,An be
marked symmetrically on C, with A1A2 = A2A3 = ⋯ = An-1An = AnA1.
Let line segments be drawn according to the following scheme: we join
A1A2,A2A4,A3A6,A4A8,…,AjA2i,…. The various lines will be seen to
envelope a cusped curve. Modifications are easy to make, by choosing
different pairs of points to join. (In the embroidery section, the lines are
threads of different colours, and the points are nails around which the
threads are looped. The overall effect is a very pretty one.)
A rainbow is an excellent example of a caustic, but we leave the details to
the reader.

13.7.6 The connection of this problem with the iteration being studied should
be clear: at each instant, the positions occupied by the four men are the
vertices of a square, and the square progressively narrows down to the center
of the square. Each man traces out a spiral Which proceeds from a vertex of
the square towards its center. The spirals belong to a family called
equiangular spirals. A nice property of the configuration is that the length of
the portion of the curve between a vertex of the square and the center is the
same as the side of the square.
13.7.8 There is no convergence towards ‘equilateral-ness’. (This is easy to
check empirically.)
13.9.1 If A′B′∥AB and B′C′∥BC, then the lines AA′,BB′,CC′ and DD′
concur at a point, say O; this is the desired fixed point.
If A′B′⊥ AB and B′C′⊥ BC, then we draw two circles, one with AA′ as
diameter, the other with BB′ as diameter. These circles will intersect in two
points, of which only one, say O, will lie inside M′; this is the desired fixed
point.
13.9.2 The fixed point does exist, but it may not lie inside the given map, M.
To see why, make the original map part of a larger map N, large enough so
that its image, N′ , does lie inside N. A fixed point will now certainly exist, but
it may not lie inside M . (That is, it may lie in the region inside N but outside
M.)
13.9.3 Let the positive x-axis represent East, and the positive y-axis North.
Call the origin O, and the terminal point T(x,y); let A be the point (1, 0 ) ,
reached after the first step (1 km East). Then AT must have half the length of
OT and be rotated 90° relative to it. Since OT→ = (x,y) and AT→ = (x - 1,y), we
get
(x - 1,y) = 1 2 ⋅ (-y,x), ∴x - 1 = -y 2,y = x 2, ∴x = 4 5,y = 2 5.
So the terminal position is T(4∕5,2∕5).
14.2.1 The analysis is done in much the same manner as was done in Problem
11.3.1, and we leave the details to the reader.
14.2.2 We start by analyzing a slightly different problem, in which we deal
with lists of numbers of a fixed length (tuples”) of a fixed length), say m + 1.

Specifically, we deal with the following iteration which we call SR. For any (m
+ 1)-tuple of numbers, say a, let SR (a) be computed thus: for each i in the set
{0,1,2,…,m} we count the number of i’s in a, then add k to this number ( k
being some fixed number). Let the resulting number be c(i).Then the tuple
SR(a) is given by
SR(a) = (c(0),c(1),c(2),…,c(m)).
Note that SR(a) is a tuple of the same length as a. This invites us to compute
the orbit 〈a; SR 〉 and to study the properties of this iteration.
Example 1   . With m = 3,k = 1 and a = (1,0,1,2) , we obtain SR(a) = (2,3,2,1).
Further iterations give:
(2,3,2,1)↦(1,2,3,2)↦(1,2,3,2)↦⋯.
Note that a fixed point has been reached.
The MATHEMATICA commands we have used to do the computations are
displayed below.
selfrefer[a_List,m_,k_] :=
(f[i_] := Count [a,i] ;b = {};
Do [b = Join [b,{f[i]}],{i,0,m} ] ;
c =b+k;c )
SR ⌊a-LiSt⌋ := selfrefer [a,     6,    1]
Here is the result of iterating SR on (1, 1. 1, 1. 1, 1.2) (the MATHEMATICA
command is:
Nest List |SR,a,{1,1,1.1,1,1.1,2},10 |;
the "10" indicates the number of iterations):
(1,1,1,1,1,1,2),(1,7,2,1,1,1,1),(1,6,2,1,1,1,1),
(1,6,2,1,1,1,2),(1,5,3,1,1,1,2),(1,5,2,2,1,2,1),
(1,4,4,1,1,2,1),(1,5,2,1,3,1,1),(1,5,2,2,1,2,1),
(1,4,4,1,1,2,1),(1,5,2,1,3,1,1),(1,5,2,2,1,2,1),….

❑
Note that a 3-cycle has been reached.
Empirically we find that we reach a fixed point or a cycle for any starting
tuple whatever, and we now show why this must always happen.
For any tuple a, the following is rule: the number of i’s in a is one of the
numbers 0,1,2, …, m + 1, therefore c(i) is one of the numbers k,k + 1,k + 2,
…,k + m + 1. Thus for each i,c(i) assumes only one of a list of m + 2 values.
The total number of (m + 1)-tuples in which each entry is one of these m + 2
numbers is clearly (m + 2)m+1, which though large is a finite number. Let S
denote the set of tuples (a0,a1,a2,…,am) where for each i,ai is one of the
numbers k,k + 1,k + 2,…,k + m + 1. Then SR (a) ∈ S for any (m + 1)-tuple a
and SR is amapping of S into itself. It follows that S plays the role of the
‘black-hole’ set referred to earlier in the text. Following the same logic used,
we infer that we shall inevitably reach a cycle in all cases.
We shall leave the reader with the task of making the connection between this
iteration and the one presented earlier in the text. The alert reader will notice
that the present iteration is a far better behaved one: the definition is precise,
and there is no possibility of ambiguity. In the earlier case, there would be
scope for ambiguity if for some i the number of i’s in the current number
were to exceed 9, for then the digital representation of the iterate would be
unclear. In the iteration presented here we would not be faced with ambiguity
even if such a thing happened, as the iteration is not a digit-based one.
14.2.3 The logic used for this problem is once again be of the type used in
Problem 11.3.1.
For x = 1,2,3,…,20,21 let f(x) denote the position number of the card that was
originally at position number x, after one iteration of the procedure. It is easy
to check that f assigns values as per the following table. (For instance, a card
originally in position 1 will move to position 8, and so on.)
Let S denote the set {1, 2.3…., 20, 21}, and let S1 = f(S),S2 = f(S1).S3 = f(S2)

….. We now have:
S1 = {8,9,10,11,12,13,14},
S2 = {10,11,12},
S3 = {11}.
Thus in just 3 iterations, f maps S to {11}, a single-element set! Thus the
chosen card necessarily ends up at position number 11 after 3 iterations, and
the trick becomes transparent.
14.2.4
● The procedure we shall use to solve this problem is essentially the same as
that used in the text to tabulate the cycles of the SCB and SFT functions.
Denote by f the function that computes the sum of the fifth powers of the
digits of the positive integer x, and let f act on sets of integers as well as single
integers. Next, denote by g the function that acts thus: for any set of positive
integers X,
g(X) = f(X) ∩ X.
We first look for an integer N such that for all x < N we have f(x) < N. After
some experimentation, it turns out that N = 300000 works. (Proof: In the
interval from 1 till 300000 the integer with the largest f-value is 299999, and
f(299999) = 295277 < 29999. )
Let S denote the set {1,2, 3, …,300000}, and let g operate iteratively on S. As
earlier, what we need to find is a g-invariant subset of S. As S is a rather large
set, in order to make progress we need access to powerful computing
machinery. The author’s facilities proved unequal to the task and therefore
did not permit him to carry out a complete analysis. Thus only partial results
are reported below.
FIXED POINTS:  We find that after 10 iterations on {1,2,3,…,30000 }, we reach
the set
T = {0,1, 4150,4151 }
which is easily checked to be g-invariant; indeed, each element of T is a fixed
point of f.

For instance, f(4150) = 1024 + 1 + 3125 + 0 = 4150. Thus f has at least these
four fixed points.
We also obtain the following cycles of f, including a cycle of length 28 (! ) .
2-CYCLE:〈58618,76438〉.
10-CYCLE: 〈18107, 49577, 96812, 99626, 133682, 41063, 9044, 61097, 83633,
41273〉.
22-CYCLE:
〈9045,63198,99837,167916,91410,60075,27708,66414,17601,24585,40074,1885
28-CYCLE:
〈244,2080,32800,33043,1753,20176,24616,16609,74602,25639,70225,19996,184
The reader is invited to unravel the full cycle structure of f.
● We follow the approach of Problem 11.3.1 yet again. Let f denote the
function under consideration (thus f(23) = 12,f(35) = 24, and so on) and let f
act on sets as well; for instance,
f({10,11,12}) = {2,4,6},f(25,30,35} ) = {18,4,24}.
Next, we define a function g that acts on sets of positive integers thus: for any
such set X, let g(X) = f(X) ∩ X. For instance, we have
g({1,2,3,4,5}) = {2,3,4,5,6}∩{1,2,3,4,5} = {2,3,4,5}.
We now let g act iteratively on a large enough set, say the set
S = {1,2,3,…,9999},
that is, we study the orbit 〈S;g〉. It turns out that after only 10 iterations or so
we reach an invariant set, namely the set
T = {2,3,4,5,6,7,8,9,10,18}.
From this g-invariant set, we extract one fixed point and one 9-cycle:
〈18〉;〈2,3,4,5,6,7,8,9,10〉.
The numerical evidence suggests that these are the only cycles of f. Perhaps
the reader could. investigate what happens if we start with a larger set S, say
the set of integers till 99999

14.3.1 This is clear; if a,b,c,d are all positive, then |a - b|≤ max{a,b},|b - c|≤
max{b,c}, and so on. Therefore
max{e,f,g,h}≤ max{a,b,c,d}.
14.3.2 This is shown by examining all possible cases. Write 'E' for ‘even
number’ and 'O' for ‘odd number’; then it is easy to see that:
(O,O,O,O)↦(E,E.,E,E),
(E,O,E,O)↦(O,O,O,O),
(E,O,E,E)↦(O,O,E,E),
(O,O,E,E)↦(E,O,E,O),
and so on. Tracing out the orbits, we see that we always reach (E,E,E,E)
within at most four steps.
14.3.3 This is the clear, because height (e,f,g,h) = 1 2(
height (2e,2f,2g,2h) ) ≤ height (a,b,c,d).
14.3.4 The hint given in the text should suffice for this.
14.3.5
i. f(0.9) = 0
ii. f(1.5) = 4 (attained by the quadruples (1, 0,0,0 ) and (1, 1, 1,0)).
iii. f(3) = 4 (attained by several quadruples, e.g., (2,0,0,0 ) ,(2,2,1,0), and so
on).
iv. f(4) = 6 (attained by (0, 0, 1, 3) and (0,2,3,3)).
Further experimentation yields f(5) = 7, attained by (0,1,2,4) and (0,2,3,4).
14.3.6 All quadruples considered during the computation of f(x) are also
considered during the computation of f(y), because x ≤ y, so we must have
f(x) ≤ f(y).
14.3.7 As mentioned earlier, if the largest entry is less than 1, then all the
entries must be 0, which means that the life is 0.
14.3.8 This is obvious!

14.3.9 As shown earlier, starting from any quadruple (a,b,c,d), within four
steps at most we reach a quadruple all of whose entries are even numbers, say
(2e,2f,2g,2h). The life of (2e,2f,2g,2h) is equal to that of (e,f,g,h), so we see that
life ((a,b,c,d)) ≤ 1ife((e,f,g,h)) + 4.
Now if the quantities a,b,c,d are all less than x, then the quantities 2e,2f,2g,2h
too are less than x, and therefore the quantities e,f,g,h are all less than x∕2.
This shows that f(x) ≤ f(x∕2) + 4, as required.
14.3.10 Using the inequality f(x) ≤ f(x∕2) + 4 over again, we see that:
f(x) ≤ f x 4 + 4 ≤ f x 8 + 8 ≤ f x 16 + 12 ≤…….
The quantities f(x∕2),f(x∕4),f(x∕8),… shrink to zero rapidly, and the result
follows. Observe that this argument also proves the following result: If x < 2n,
then f(x) < 4n.
14.3.11 The argument fails at a crucial point: it is not true that after every so
many steps (whatever the number), each number in the triple is even (or a
multiple of three, or whatever). So the possibility of reducing the height of the
triple does not exist, as it did in the case of quadruples.
14.3.12 The answer is: yes. For, we can express all the fractions in terms of a
common denominator, and then simply remove the denominator from the
picture. Consider the following example:
2 3,3 7, 5 12, 3 19↦ 5 21, 1 84, 59 228,29 57.
Since the least common multiple of 3, 7, 12 and 19 is 7 × 12 × 19 = 1596, and
2∕3 = 1024/1596, 3∕7 = 684∕1596,5∕12 = 665∕1596,3∕19 = 252∕1596, the
computation por-trayed above is essentially the same as:
(1024, 684, 665, 252) ↦(340,19,413,772).
The earlier argument thus applies, and we conclude that each quadruple of
rational numbers has finite life.
14.3.13 The answer to this is: no. That is, it is possible to find quadruples of
numbers, at least one being irrational, whose life is not finite. One such
quadruple is constructed in the following manner. Let α be the positive real
number that satisfies the equation

α3 = α2 + α + 1.
Then the quadruple (1,α,α2,α3) has infinite life. (It can be shown that α is
irrational; its value is approximately 1.83928….) To see why, we examine its
orbit:
(1,α,α2,α3)↦(α - 1,α2 - α,α3 - α2,α3 - 1).
Now α3 - 1 = (α - 1)(α2 + α + 1), so the factor (α - 1), being common to all
four numbers in the quadruple, can be factored out. By the choice of α, we
have the relation α3 = α2 + α + 1, so the quadruple can be written in the form
(α - 1) × (1,α,α2,α3). Let L denote the life of (1,α,α2,α3). The relation just
found states that L = L + 1, which is an impossible equation (it cannot be
satisfied by any finite number). Conclusion: L is infinite!
14.3.14 This question has already been answered (see Problem 6.2.7). The
crucial point is that the remainders that can arise in the division a ÷ b form a
finite set: {0,1,2,…,b - 1}. Therefore some remainder will necessarily repeat
after some point, and once this happens the decimal recurs.
15.1.1
i. To solve the equation x5 - x - 1000=0, we write it in the form x = (x +
1000)1∕5.
We now let f be the function given by
f(x) = (x + 1000)1∕5
and search for a fixed point of f. A computer search provides the
following orbit, using the seed x = 0.
〈0,3.9811,3.9842,3.9842,3.9842,…〉.
Thus we have found a fixed point (≈ 3.984). This is one solution to the
given equation.
ii. We write the equation in the form x = (x4+ x + 10000)1∕7. . Let g be the
function given by
g(x) = (x4 + x + 1000) 1∕7.
Using the seed x = 0, we obtain the orbit shown below:

〈0,3.7276,3.738,3.7381,3.7381,...,〉.
We have found a solution (≈ 3.738).
15.1.2 A particularly good choice for the iteration is
x↦x - y 4x3 - 3x2 - 2κ → 1.
Line 80 in this case would read:
80 x = x -y∕(4*x∧3 - 3*x∧2 - 2*x -1)
15.1.3 We write the equation as x = (x1/3+100)2 and search for a fixed point
of the function h, where
h(x) = (x1∕3 + 100)2
The seed x = 0 gives the following orbit, with numbers rounded off to the
closest integer:
〈0,10000,14773,15509,15610,15623,15625,15625,15625,15625,…〉.
We have obtained a fixed point of h, namely.the number 15625. Note that this
is an exact solution to our problem. (Proof: 15625 = 125,156253 = 25,125 - 25
= 100. )
15.1.4 We write the equation as x = (x + 1)x∕(x+1) and search for a fixed point
of the function k, where
k(x) = (x + 1)x∕(x+1).
The seed has to be chosen with care; x = 0 would not be a good choice. We
use 
the 
seed 
x 
= 
2. 
The 
result 
is 
as 
follows.
〈2,2.08,2.14,2.18,2.21,2.23,2.25,2.26,2.27,2.275,2.28,2.283,2.286,2.288,2.289,2.2
…〉.
There seems to be a solution close to 2.29., we run a second iteration using
the 
seed 
x 
= 
2.3. 
Here 
is 
the 
result:
〈2.3,2.298,2.297,2.2’96,2.295,2.2947,2.2943,2.294,2.2938,2.2936,2.2935,2.2934,
… 〉 .
A good approximation to the limit, obtained by using more efficient methods,
is 2.2931662.

⋆ ⋆ ⋆ ⋆ ⋆ ⋆ ⋆ ⋆ ⋆ ⋆ ⋆⋆⋆ ⋆ ⋆ ⋆ ⋆ ⋆⋆
We leave the solutions of 17.5.1, 17.5.2, 17.5.3 and 17.5.4 to the reader, as
the proofs of the three theorems are highly similar to the proofs of Theorems
17.1 and 17.2.

